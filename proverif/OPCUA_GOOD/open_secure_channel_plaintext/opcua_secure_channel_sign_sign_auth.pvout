Linear part:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Completing equations...
Completed equations:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Convergent part:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Completing equations...
Completed equations:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_512: bool = (Cli = A) in
    (
        {10}if v_512 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_513: bool = (Disco = A) in
            (
                {14}if v_513 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_514: bool = (Sess = A) in
                    (
                        {17}if v_514 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=Sign,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let m1: bitstring = (OpenSecureChannelRequest,pkCli,Nc) in
                            {23}event beginCli(Cli,Sess,Nc);
                            {24}out(c, (pkCli,m1,sign(h(m1),skCli)));
                            {25}in(c, (em2: bitstring,sigM2: bitstring));
                            {26}let m2: bitstring = em2 in
                            {27}if (verify(h(m2),sigM2,pkSess) <> true) then
                                0
                            else
                                {28}let (=OpenSecureChannelResponse,Ns: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                                {29}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {30}event endCli(Sess,Cli,Ns)
                        )
                        else
                            {31}let v_515: bool = (Sess = B) in
                            (
                                {32}if v_515 then
                                (
                                    {33}let pkSess_516: bitstring = pub(skB) in
                                    {34}out(c, GetEndpointRequest);
                                    {35}in(c, (=GetEndpointResponse,=pkSess_516,=Sign,SP_517: bitstring,UP_518: bitstring));
                                    {36}new Nc_519: bitstring;
                                    {37}let m1_520: bitstring = (OpenSecureChannelRequest,pkCli,Nc_519) in
                                    {38}event beginCli(Cli,Sess,Nc_519);
                                    {39}out(c, (pkCli,m1_520,sign(h(m1_520),skCli)));
                                    {40}in(c, (em2_521: bitstring,sigM2_522: bitstring));
                                    {41}let m2_523: bitstring = em2_521 in
                                    {42}if (verify(h(m2_523),sigM2_522,pkSess_516) <> true) then
                                        0
                                    else
                                        {43}let (=OpenSecureChannelResponse,Ns_524: bitstring,ST_525: bitstring,TTL_526: bitstring) = m2_523 in
                                        {44}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {45}event endCli(Sess,Cli,Ns_524)
                                )
                                else
                                    {46}let v_527: bool = (Sess = C) in
                                    (
                                        {47}if v_527 then
                                        (
                                            {48}let pkSess_528: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (=GetEndpointResponse,=pkSess_528,=Sign,SP_529: bitstring,UP_530: bitstring));
                                            {51}new Nc_531: bitstring;
                                            {52}let m1_532: bitstring = (OpenSecureChannelRequest,pkCli,Nc_531) in
                                            {53}event beginCli(Cli,Sess,Nc_531);
                                            {54}out(c, (pkCli,m1_532,sign(h(m1_532),skCli)));
                                            {55}in(c, (em2_533: bitstring,sigM2_534: bitstring));
                                            {56}let m2_535: bitstring = em2_533 in
                                            {57}if (verify(h(m2_535),sigM2_534,pkSess_528) <> true) then
                                                0
                                            else
                                                {58}let (=OpenSecureChannelResponse,Ns_536: bitstring,ST_537: bitstring,TTL_538: bitstring) = m2_535 in
                                                {59}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {60}event endCli(Sess,Cli,Ns_536)
                                        )
                                        else
                                            {61}let pkSess_539: bitstring = pub(sk(Sess)) in
                                            {62}out(c, GetEndpointRequest);
                                            {63}in(c, (=GetEndpointResponse,=pkSess_539,=Sign,SP_540: bitstring,UP_541: bitstring));
                                            {64}new Nc_542: bitstring;
                                            {65}let m1_543: bitstring = (OpenSecureChannelRequest,pkCli,Nc_542) in
                                            {66}event beginCli(Cli,Sess,Nc_542);
                                            {67}out(c, (pkCli,m1_543,sign(h(m1_543),skCli)));
                                            {68}in(c, (em2_544: bitstring,sigM2_545: bitstring));
                                            {69}let m2_546: bitstring = em2_544 in
                                            {70}if (verify(h(m2_546),sigM2_545,pkSess_539) <> true) then
                                                0
                                            else
                                                {71}let (=OpenSecureChannelResponse,Ns_547: bitstring,ST_548: bitstring,TTL_549: bitstring) = m2_546 in
                                                {72}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {73}event endCli(Sess,Cli,Ns_547)
                                    )
                                    else
                                        {74}let pkSess_550: bitstring = fail-any in
                                        {75}out(c, GetEndpointRequest);
                                        {76}in(c, (=GetEndpointResponse,=pkSess_550,=Sign,SP_551: bitstring,UP_552: bitstring));
                                        {77}new Nc_553: bitstring;
                                        {78}let m1_554: bitstring = (OpenSecureChannelRequest,pkCli,Nc_553) in
                                        {79}event beginCli(Cli,Sess,Nc_553);
                                        {80}out(c, (pkCli,m1_554,sign(h(m1_554),skCli)));
                                        {81}in(c, (em2_555: bitstring,sigM2_556: bitstring));
                                        {82}let m2_557: bitstring = em2_555 in
                                        {83}if (verify(h(m2_557),sigM2_556,pkSess_550) <> true) then
                                            0
                                        else
                                            {84}let (=OpenSecureChannelResponse,Ns_558: bitstring,ST_559: bitstring,TTL_560: bitstring) = m2_557 in
                                            {85}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {86}event endCli(Sess,Cli,Ns_558)
                            )
                            else
                                {87}let pkSess_561: bitstring = fail-any in
                                {88}out(c, GetEndpointRequest);
                                {89}in(c, (=GetEndpointResponse,=pkSess_561,=Sign,SP_562: bitstring,UP_563: bitstring));
                                {90}new Nc_564: bitstring;
                                {91}let m1_565: bitstring = (OpenSecureChannelRequest,pkCli,Nc_564) in
                                {92}event beginCli(Cli,Sess,Nc_564);
                                {93}out(c, (pkCli,m1_565,sign(h(m1_565),skCli)));
                                {94}in(c, (em2_566: bitstring,sigM2_567: bitstring));
                                {95}let m2_568: bitstring = em2_566 in
                                {96}if (verify(h(m2_568),sigM2_567,pkSess_561) <> true) then
                                    0
                                else
                                    {97}let (=OpenSecureChannelResponse,Ns_569: bitstring,ST_570: bitstring,TTL_571: bitstring) = m2_568 in
                                    {98}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {99}event endCli(Sess,Cli,Ns_569)
                    )
                    else
                        {100}let pkSess_572: bitstring = fail-any in
                        {101}out(c, GetEndpointRequest);
                        {102}in(c, (=GetEndpointResponse,=pkSess_572,=Sign,SP_573: bitstring,UP_574: bitstring));
                        {103}new Nc_575: bitstring;
                        {104}let m1_576: bitstring = (OpenSecureChannelRequest,pkCli,Nc_575) in
                        {105}event beginCli(Cli,Sess,Nc_575);
                        {106}out(c, (pkCli,m1_576,sign(h(m1_576),skCli)));
                        {107}in(c, (em2_577: bitstring,sigM2_578: bitstring));
                        {108}let m2_579: bitstring = em2_577 in
                        {109}if (verify(h(m2_579),sigM2_578,pkSess_572) <> true) then
                            0
                        else
                            {110}let (=OpenSecureChannelResponse,Ns_580: bitstring,ST_581: bitstring,TTL_582: bitstring) = m2_579 in
                            {111}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {112}event endCli(Sess,Cli,Ns_580)
                )
                else
                    {113}let v_583: bool = (Disco = B) in
                    (
                        {114}if v_583 then
                        (
                            {115}let pkDisco_584: bitstring = pub(skB) in
                            {116}let v_585: bool = (Sess = A) in
                            (
                                {117}if v_585 then
                                (
                                    {118}let pkSess_586: bitstring = pub(skA) in
                                    {119}out(c, GetEndpointRequest);
                                    {120}in(c, (=GetEndpointResponse,=pkSess_586,=Sign,SP_587: bitstring,UP_588: bitstring));
                                    {121}new Nc_589: bitstring;
                                    {122}let m1_590: bitstring = (OpenSecureChannelRequest,pkCli,Nc_589) in
                                    {123}event beginCli(Cli,Sess,Nc_589);
                                    {124}out(c, (pkCli,m1_590,sign(h(m1_590),skCli)));
                                    {125}in(c, (em2_591: bitstring,sigM2_592: bitstring));
                                    {126}let m2_593: bitstring = em2_591 in
                                    {127}if (verify(h(m2_593),sigM2_592,pkSess_586) <> true) then
                                        0
                                    else
                                        {128}let (=OpenSecureChannelResponse,Ns_594: bitstring,ST_595: bitstring,TTL_596: bitstring) = m2_593 in
                                        {129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {130}event endCli(Sess,Cli,Ns_594)
                                )
                                else
                                    {131}let v_597: bool = (Sess = B) in
                                    (
                                        {132}if v_597 then
                                        (
                                            {133}let pkSess_598: bitstring = pub(skB) in
                                            {134}out(c, GetEndpointRequest);
                                            {135}in(c, (=GetEndpointResponse,=pkSess_598,=Sign,SP_599: bitstring,UP_600: bitstring));
                                            {136}new Nc_601: bitstring;
                                            {137}let m1_602: bitstring = (OpenSecureChannelRequest,pkCli,Nc_601) in
                                            {138}event beginCli(Cli,Sess,Nc_601);
                                            {139}out(c, (pkCli,m1_602,sign(h(m1_602),skCli)));
                                            {140}in(c, (em2_603: bitstring,sigM2_604: bitstring));
                                            {141}let m2_605: bitstring = em2_603 in
                                            {142}if (verify(h(m2_605),sigM2_604,pkSess_598) <> true) then
                                                0
                                            else
                                                {143}let (=OpenSecureChannelResponse,Ns_606: bitstring,ST_607: bitstring,TTL_608: bitstring) = m2_605 in
                                                {144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {145}event endCli(Sess,Cli,Ns_606)
                                        )
                                        else
                                            {146}let v_609: bool = (Sess = C) in
                                            (
                                                {147}if v_609 then
                                                (
                                                    {148}let pkSess_610: bitstring = pub(skC) in
                                                    {149}out(c, GetEndpointRequest);
                                                    {150}in(c, (=GetEndpointResponse,=pkSess_610,=Sign,SP_611: bitstring,UP_612: bitstring));
                                                    {151}new Nc_613: bitstring;
                                                    {152}let m1_614: bitstring = (OpenSecureChannelRequest,pkCli,Nc_613) in
                                                    {153}event beginCli(Cli,Sess,Nc_613);
                                                    {154}out(c, (pkCli,m1_614,sign(h(m1_614),skCli)));
                                                    {155}in(c, (em2_615: bitstring,sigM2_616: bitstring));
                                                    {156}let m2_617: bitstring = em2_615 in
                                                    {157}if (verify(h(m2_617),sigM2_616,pkSess_610) <> true) then
                                                        0
                                                    else
                                                        {158}let (=OpenSecureChannelResponse,Ns_618: bitstring,ST_619: bitstring,TTL_620: bitstring) = m2_617 in
                                                        {159}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {160}event endCli(Sess,Cli,Ns_618)
                                                )
                                                else
                                                    {161}let pkSess_621: bitstring = pub(sk(Sess)) in
                                                    {162}out(c, GetEndpointRequest);
                                                    {163}in(c, (=GetEndpointResponse,=pkSess_621,=Sign,SP_622: bitstring,UP_623: bitstring));
                                                    {164}new Nc_624: bitstring;
                                                    {165}let m1_625: bitstring = (OpenSecureChannelRequest,pkCli,Nc_624) in
                                                    {166}event beginCli(Cli,Sess,Nc_624);
                                                    {167}out(c, (pkCli,m1_625,sign(h(m1_625),skCli)));
                                                    {168}in(c, (em2_626: bitstring,sigM2_627: bitstring));
                                                    {169}let m2_628: bitstring = em2_626 in
                                                    {170}if (verify(h(m2_628),sigM2_627,pkSess_621) <> true) then
                                                        0
                                                    else
                                                        {171}let (=OpenSecureChannelResponse,Ns_629: bitstring,ST_630: bitstring,TTL_631: bitstring) = m2_628 in
                                                        {172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {173}event endCli(Sess,Cli,Ns_629)
                                            )
                                            else
                                                {174}let pkSess_632: bitstring = fail-any in
                                                {175}out(c, GetEndpointRequest);
                                                {176}in(c, (=GetEndpointResponse,=pkSess_632,=Sign,SP_633: bitstring,UP_634: bitstring));
                                                {177}new Nc_635: bitstring;
                                                {178}let m1_636: bitstring = (OpenSecureChannelRequest,pkCli,Nc_635) in
                                                {179}event beginCli(Cli,Sess,Nc_635);
                                                {180}out(c, (pkCli,m1_636,sign(h(m1_636),skCli)));
                                                {181}in(c, (em2_637: bitstring,sigM2_638: bitstring));
                                                {182}let m2_639: bitstring = em2_637 in
                                                {183}if (verify(h(m2_639),sigM2_638,pkSess_632) <> true) then
                                                    0
                                                else
                                                    {184}let (=OpenSecureChannelResponse,Ns_640: bitstring,ST_641: bitstring,TTL_642: bitstring) = m2_639 in
                                                    {185}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {186}event endCli(Sess,Cli,Ns_640)
                                    )
                                    else
                                        {187}let pkSess_643: bitstring = fail-any in
                                        {188}out(c, GetEndpointRequest);
                                        {189}in(c, (=GetEndpointResponse,=pkSess_643,=Sign,SP_644: bitstring,UP_645: bitstring));
                                        {190}new Nc_646: bitstring;
                                        {191}let m1_647: bitstring = (OpenSecureChannelRequest,pkCli,Nc_646) in
                                        {192}event beginCli(Cli,Sess,Nc_646);
                                        {193}out(c, (pkCli,m1_647,sign(h(m1_647),skCli)));
                                        {194}in(c, (em2_648: bitstring,sigM2_649: bitstring));
                                        {195}let m2_650: bitstring = em2_648 in
                                        {196}if (verify(h(m2_650),sigM2_649,pkSess_643) <> true) then
                                            0
                                        else
                                            {197}let (=OpenSecureChannelResponse,Ns_651: bitstring,ST_652: bitstring,TTL_653: bitstring) = m2_650 in
                                            {198}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {199}event endCli(Sess,Cli,Ns_651)
                            )
                            else
                                {200}let pkSess_654: bitstring = fail-any in
                                {201}out(c, GetEndpointRequest);
                                {202}in(c, (=GetEndpointResponse,=pkSess_654,=Sign,SP_655: bitstring,UP_656: bitstring));
                                {203}new Nc_657: bitstring;
                                {204}let m1_658: bitstring = (OpenSecureChannelRequest,pkCli,Nc_657) in
                                {205}event beginCli(Cli,Sess,Nc_657);
                                {206}out(c, (pkCli,m1_658,sign(h(m1_658),skCli)));
                                {207}in(c, (em2_659: bitstring,sigM2_660: bitstring));
                                {208}let m2_661: bitstring = em2_659 in
                                {209}if (verify(h(m2_661),sigM2_660,pkSess_654) <> true) then
                                    0
                                else
                                    {210}let (=OpenSecureChannelResponse,Ns_662: bitstring,ST_663: bitstring,TTL_664: bitstring) = m2_661 in
                                    {211}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {212}event endCli(Sess,Cli,Ns_662)
                        )
                        else
                            {213}let v_665: bool = (Disco = C) in
                            (
                                {214}if v_665 then
                                (
                                    {215}let pkDisco_666: bitstring = pub(skC) in
                                    {216}let v_667: bool = (Sess = A) in
                                    (
                                        {217}if v_667 then
                                        (
                                            {218}let pkSess_668: bitstring = pub(skA) in
                                            {219}out(c, GetEndpointRequest);
                                            {220}in(c, (=GetEndpointResponse,=pkSess_668,=Sign,SP_669: bitstring,UP_670: bitstring));
                                            {221}new Nc_671: bitstring;
                                            {222}let m1_672: bitstring = (OpenSecureChannelRequest,pkCli,Nc_671) in
                                            {223}event beginCli(Cli,Sess,Nc_671);
                                            {224}out(c, (pkCli,m1_672,sign(h(m1_672),skCli)));
                                            {225}in(c, (em2_673: bitstring,sigM2_674: bitstring));
                                            {226}let m2_675: bitstring = em2_673 in
                                            {227}if (verify(h(m2_675),sigM2_674,pkSess_668) <> true) then
                                                0
                                            else
                                                {228}let (=OpenSecureChannelResponse,Ns_676: bitstring,ST_677: bitstring,TTL_678: bitstring) = m2_675 in
                                                {229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {230}event endCli(Sess,Cli,Ns_676)
                                        )
                                        else
                                            {231}let v_679: bool = (Sess = B) in
                                            (
                                                {232}if v_679 then
                                                (
                                                    {233}let pkSess_680: bitstring = pub(skB) in
                                                    {234}out(c, GetEndpointRequest);
                                                    {235}in(c, (=GetEndpointResponse,=pkSess_680,=Sign,SP_681: bitstring,UP_682: bitstring));
                                                    {236}new Nc_683: bitstring;
                                                    {237}let m1_684: bitstring = (OpenSecureChannelRequest,pkCli,Nc_683) in
                                                    {238}event beginCli(Cli,Sess,Nc_683);
                                                    {239}out(c, (pkCli,m1_684,sign(h(m1_684),skCli)));
                                                    {240}in(c, (em2_685: bitstring,sigM2_686: bitstring));
                                                    {241}let m2_687: bitstring = em2_685 in
                                                    {242}if (verify(h(m2_687),sigM2_686,pkSess_680) <> true) then
                                                        0
                                                    else
                                                        {243}let (=OpenSecureChannelResponse,Ns_688: bitstring,ST_689: bitstring,TTL_690: bitstring) = m2_687 in
                                                        {244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {245}event endCli(Sess,Cli,Ns_688)
                                                )
                                                else
                                                    {246}let v_691: bool = (Sess = C) in
                                                    (
                                                        {247}if v_691 then
                                                        (
                                                            {248}let pkSess_692: bitstring = pub(skC) in
                                                            {249}out(c, GetEndpointRequest);
                                                            {250}in(c, (=GetEndpointResponse,=pkSess_692,=Sign,SP_693: bitstring,UP_694: bitstring));
                                                            {251}new Nc_695: bitstring;
                                                            {252}let m1_696: bitstring = (OpenSecureChannelRequest,pkCli,Nc_695) in
                                                            {253}event beginCli(Cli,Sess,Nc_695);
                                                            {254}out(c, (pkCli,m1_696,sign(h(m1_696),skCli)));
                                                            {255}in(c, (em2_697: bitstring,sigM2_698: bitstring));
                                                            {256}let m2_699: bitstring = em2_697 in
                                                            {257}if (verify(h(m2_699),sigM2_698,pkSess_692) <> true) then
                                                                0
                                                            else
                                                                {258}let (=OpenSecureChannelResponse,Ns_700: bitstring,ST_701: bitstring,TTL_702: bitstring) = m2_699 in
                                                                {259}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {260}event endCli(Sess,Cli,Ns_700)
                                                        )
                                                        else
                                                            {261}let pkSess_703: bitstring = pub(sk(Sess)) in
                                                            {262}out(c, GetEndpointRequest);
                                                            {263}in(c, (=GetEndpointResponse,=pkSess_703,=Sign,SP_704: bitstring,UP_705: bitstring));
                                                            {264}new Nc_706: bitstring;
                                                            {265}let m1_707: bitstring = (OpenSecureChannelRequest,pkCli,Nc_706) in
                                                            {266}event beginCli(Cli,Sess,Nc_706);
                                                            {267}out(c, (pkCli,m1_707,sign(h(m1_707),skCli)));
                                                            {268}in(c, (em2_708: bitstring,sigM2_709: bitstring));
                                                            {269}let m2_710: bitstring = em2_708 in
                                                            {270}if (verify(h(m2_710),sigM2_709,pkSess_703) <> true) then
                                                                0
                                                            else
                                                                {271}let (=OpenSecureChannelResponse,Ns_711: bitstring,ST_712: bitstring,TTL_713: bitstring) = m2_710 in
                                                                {272}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {273}event endCli(Sess,Cli,Ns_711)
                                                    )
                                                    else
                                                        {274}let pkSess_714: bitstring = fail-any in
                                                        {275}out(c, GetEndpointRequest);
                                                        {276}in(c, (=GetEndpointResponse,=pkSess_714,=Sign,SP_715: bitstring,UP_716: bitstring));
                                                        {277}new Nc_717: bitstring;
                                                        {278}let m1_718: bitstring = (OpenSecureChannelRequest,pkCli,Nc_717) in
                                                        {279}event beginCli(Cli,Sess,Nc_717);
                                                        {280}out(c, (pkCli,m1_718,sign(h(m1_718),skCli)));
                                                        {281}in(c, (em2_719: bitstring,sigM2_720: bitstring));
                                                        {282}let m2_721: bitstring = em2_719 in
                                                        {283}if (verify(h(m2_721),sigM2_720,pkSess_714) <> true) then
                                                            0
                                                        else
                                                            {284}let (=OpenSecureChannelResponse,Ns_722: bitstring,ST_723: bitstring,TTL_724: bitstring) = m2_721 in
                                                            {285}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {286}event endCli(Sess,Cli,Ns_722)
                                            )
                                            else
                                                {287}let pkSess_725: bitstring = fail-any in
                                                {288}out(c, GetEndpointRequest);
                                                {289}in(c, (=GetEndpointResponse,=pkSess_725,=Sign,SP_726: bitstring,UP_727: bitstring));
                                                {290}new Nc_728: bitstring;
                                                {291}let m1_729: bitstring = (OpenSecureChannelRequest,pkCli,Nc_728) in
                                                {292}event beginCli(Cli,Sess,Nc_728);
                                                {293}out(c, (pkCli,m1_729,sign(h(m1_729),skCli)));
                                                {294}in(c, (em2_730: bitstring,sigM2_731: bitstring));
                                                {295}let m2_732: bitstring = em2_730 in
                                                {296}if (verify(h(m2_732),sigM2_731,pkSess_725) <> true) then
                                                    0
                                                else
                                                    {297}let (=OpenSecureChannelResponse,Ns_733: bitstring,ST_734: bitstring,TTL_735: bitstring) = m2_732 in
                                                    {298}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {299}event endCli(Sess,Cli,Ns_733)
                                    )
                                    else
                                        {300}let pkSess_736: bitstring = fail-any in
                                        {301}out(c, GetEndpointRequest);
                                        {302}in(c, (=GetEndpointResponse,=pkSess_736,=Sign,SP_737: bitstring,UP_738: bitstring));
                                        {303}new Nc_739: bitstring;
                                        {304}let m1_740: bitstring = (OpenSecureChannelRequest,pkCli,Nc_739) in
                                        {305}event beginCli(Cli,Sess,Nc_739);
                                        {306}out(c, (pkCli,m1_740,sign(h(m1_740),skCli)));
                                        {307}in(c, (em2_741: bitstring,sigM2_742: bitstring));
                                        {308}let m2_743: bitstring = em2_741 in
                                        {309}if (verify(h(m2_743),sigM2_742,pkSess_736) <> true) then
                                            0
                                        else
                                            {310}let (=OpenSecureChannelResponse,Ns_744: bitstring,ST_745: bitstring,TTL_746: bitstring) = m2_743 in
                                            {311}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {312}event endCli(Sess,Cli,Ns_744)
                                )
                                else
                                    {313}let pkDisco_747: bitstring = pub(sk(Disco)) in
                                    {314}let v_748: bool = (Sess = A) in
                                    (
                                        {315}if v_748 then
                                        (
                                            {316}let pkSess_749: bitstring = pub(skA) in
                                            {317}out(c, GetEndpointRequest);
                                            {318}in(c, (=GetEndpointResponse,=pkSess_749,=Sign,SP_750: bitstring,UP_751: bitstring));
                                            {319}new Nc_752: bitstring;
                                            {320}let m1_753: bitstring = (OpenSecureChannelRequest,pkCli,Nc_752) in
                                            {321}event beginCli(Cli,Sess,Nc_752);
                                            {322}out(c, (pkCli,m1_753,sign(h(m1_753),skCli)));
                                            {323}in(c, (em2_754: bitstring,sigM2_755: bitstring));
                                            {324}let m2_756: bitstring = em2_754 in
                                            {325}if (verify(h(m2_756),sigM2_755,pkSess_749) <> true) then
                                                0
                                            else
                                                {326}let (=OpenSecureChannelResponse,Ns_757: bitstring,ST_758: bitstring,TTL_759: bitstring) = m2_756 in
                                                {327}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {328}event endCli(Sess,Cli,Ns_757)
                                        )
                                        else
                                            {329}let v_760: bool = (Sess = B) in
                                            (
                                                {330}if v_760 then
                                                (
                                                    {331}let pkSess_761: bitstring = pub(skB) in
                                                    {332}out(c, GetEndpointRequest);
                                                    {333}in(c, (=GetEndpointResponse,=pkSess_761,=Sign,SP_762: bitstring,UP_763: bitstring));
                                                    {334}new Nc_764: bitstring;
                                                    {335}let m1_765: bitstring = (OpenSecureChannelRequest,pkCli,Nc_764) in
                                                    {336}event beginCli(Cli,Sess,Nc_764);
                                                    {337}out(c, (pkCli,m1_765,sign(h(m1_765),skCli)));
                                                    {338}in(c, (em2_766: bitstring,sigM2_767: bitstring));
                                                    {339}let m2_768: bitstring = em2_766 in
                                                    {340}if (verify(h(m2_768),sigM2_767,pkSess_761) <> true) then
                                                        0
                                                    else
                                                        {341}let (=OpenSecureChannelResponse,Ns_769: bitstring,ST_770: bitstring,TTL_771: bitstring) = m2_768 in
                                                        {342}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {343}event endCli(Sess,Cli,Ns_769)
                                                )
                                                else
                                                    {344}let v_772: bool = (Sess = C) in
                                                    (
                                                        {345}if v_772 then
                                                        (
                                                            {346}let pkSess_773: bitstring = pub(skC) in
                                                            {347}out(c, GetEndpointRequest);
                                                            {348}in(c, (=GetEndpointResponse,=pkSess_773,=Sign,SP_774: bitstring,UP_775: bitstring));
                                                            {349}new Nc_776: bitstring;
                                                            {350}let m1_777: bitstring = (OpenSecureChannelRequest,pkCli,Nc_776) in
                                                            {351}event beginCli(Cli,Sess,Nc_776);
                                                            {352}out(c, (pkCli,m1_777,sign(h(m1_777),skCli)));
                                                            {353}in(c, (em2_778: bitstring,sigM2_779: bitstring));
                                                            {354}let m2_780: bitstring = em2_778 in
                                                            {355}if (verify(h(m2_780),sigM2_779,pkSess_773) <> true) then
                                                                0
                                                            else
                                                                {356}let (=OpenSecureChannelResponse,Ns_781: bitstring,ST_782: bitstring,TTL_783: bitstring) = m2_780 in
                                                                {357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {358}event endCli(Sess,Cli,Ns_781)
                                                        )
                                                        else
                                                            {359}let pkSess_784: bitstring = pub(sk(Sess)) in
                                                            {360}out(c, GetEndpointRequest);
                                                            {361}in(c, (=GetEndpointResponse,=pkSess_784,=Sign,SP_785: bitstring,UP_786: bitstring));
                                                            {362}new Nc_787: bitstring;
                                                            {363}let m1_788: bitstring = (OpenSecureChannelRequest,pkCli,Nc_787) in
                                                            {364}event beginCli(Cli,Sess,Nc_787);
                                                            {365}out(c, (pkCli,m1_788,sign(h(m1_788),skCli)));
                                                            {366}in(c, (em2_789: bitstring,sigM2_790: bitstring));
                                                            {367}let m2_791: bitstring = em2_789 in
                                                            {368}if (verify(h(m2_791),sigM2_790,pkSess_784) <> true) then
                                                                0
                                                            else
                                                                {369}let (=OpenSecureChannelResponse,Ns_792: bitstring,ST_793: bitstring,TTL_794: bitstring) = m2_791 in
                                                                {370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {371}event endCli(Sess,Cli,Ns_792)
                                                    )
                                                    else
                                                        {372}let pkSess_795: bitstring = fail-any in
                                                        {373}out(c, GetEndpointRequest);
                                                        {374}in(c, (=GetEndpointResponse,=pkSess_795,=Sign,SP_796: bitstring,UP_797: bitstring));
                                                        {375}new Nc_798: bitstring;
                                                        {376}let m1_799: bitstring = (OpenSecureChannelRequest,pkCli,Nc_798) in
                                                        {377}event beginCli(Cli,Sess,Nc_798);
                                                        {378}out(c, (pkCli,m1_799,sign(h(m1_799),skCli)));
                                                        {379}in(c, (em2_800: bitstring,sigM2_801: bitstring));
                                                        {380}let m2_802: bitstring = em2_800 in
                                                        {381}if (verify(h(m2_802),sigM2_801,pkSess_795) <> true) then
                                                            0
                                                        else
                                                            {382}let (=OpenSecureChannelResponse,Ns_803: bitstring,ST_804: bitstring,TTL_805: bitstring) = m2_802 in
                                                            {383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {384}event endCli(Sess,Cli,Ns_803)
                                            )
                                            else
                                                {385}let pkSess_806: bitstring = fail-any in
                                                {386}out(c, GetEndpointRequest);
                                                {387}in(c, (=GetEndpointResponse,=pkSess_806,=Sign,SP_807: bitstring,UP_808: bitstring));
                                                {388}new Nc_809: bitstring;
                                                {389}let m1_810: bitstring = (OpenSecureChannelRequest,pkCli,Nc_809) in
                                                {390}event beginCli(Cli,Sess,Nc_809);
                                                {391}out(c, (pkCli,m1_810,sign(h(m1_810),skCli)));
                                                {392}in(c, (em2_811: bitstring,sigM2_812: bitstring));
                                                {393}let m2_813: bitstring = em2_811 in
                                                {394}if (verify(h(m2_813),sigM2_812,pkSess_806) <> true) then
                                                    0
                                                else
                                                    {395}let (=OpenSecureChannelResponse,Ns_814: bitstring,ST_815: bitstring,TTL_816: bitstring) = m2_813 in
                                                    {396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {397}event endCli(Sess,Cli,Ns_814)
                                    )
                                    else
                                        {398}let pkSess_817: bitstring = fail-any in
                                        {399}out(c, GetEndpointRequest);
                                        {400}in(c, (=GetEndpointResponse,=pkSess_817,=Sign,SP_818: bitstring,UP_819: bitstring));
                                        {401}new Nc_820: bitstring;
                                        {402}let m1_821: bitstring = (OpenSecureChannelRequest,pkCli,Nc_820) in
                                        {403}event beginCli(Cli,Sess,Nc_820);
                                        {404}out(c, (pkCli,m1_821,sign(h(m1_821),skCli)));
                                        {405}in(c, (em2_822: bitstring,sigM2_823: bitstring));
                                        {406}let m2_824: bitstring = em2_822 in
                                        {407}if (verify(h(m2_824),sigM2_823,pkSess_817) <> true) then
                                            0
                                        else
                                            {408}let (=OpenSecureChannelResponse,Ns_825: bitstring,ST_826: bitstring,TTL_827: bitstring) = m2_824 in
                                            {409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {410}event endCli(Sess,Cli,Ns_825)
                            )
                            else
                                {411}let pkDisco_828: bitstring = fail-any in
                                {412}let v_829: bool = (Sess = A) in
                                (
                                    {413}if v_829 then
                                    (
                                        {414}let pkSess_830: bitstring = pub(skA) in
                                        {415}out(c, GetEndpointRequest);
                                        {416}in(c, (=GetEndpointResponse,=pkSess_830,=Sign,SP_831: bitstring,UP_832: bitstring));
                                        {417}new Nc_833: bitstring;
                                        {418}let m1_834: bitstring = (OpenSecureChannelRequest,pkCli,Nc_833) in
                                        {419}event beginCli(Cli,Sess,Nc_833);
                                        {420}out(c, (pkCli,m1_834,sign(h(m1_834),skCli)));
                                        {421}in(c, (em2_835: bitstring,sigM2_836: bitstring));
                                        {422}let m2_837: bitstring = em2_835 in
                                        {423}if (verify(h(m2_837),sigM2_836,pkSess_830) <> true) then
                                            0
                                        else
                                            {424}let (=OpenSecureChannelResponse,Ns_838: bitstring,ST_839: bitstring,TTL_840: bitstring) = m2_837 in
                                            {425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {426}event endCli(Sess,Cli,Ns_838)
                                    )
                                    else
                                        {427}let v_841: bool = (Sess = B) in
                                        (
                                            {428}if v_841 then
                                            (
                                                {429}let pkSess_842: bitstring = pub(skB) in
                                                {430}out(c, GetEndpointRequest);
                                                {431}in(c, (=GetEndpointResponse,=pkSess_842,=Sign,SP_843: bitstring,UP_844: bitstring));
                                                {432}new Nc_845: bitstring;
                                                {433}let m1_846: bitstring = (OpenSecureChannelRequest,pkCli,Nc_845) in
                                                {434}event beginCli(Cli,Sess,Nc_845);
                                                {435}out(c, (pkCli,m1_846,sign(h(m1_846),skCli)));
                                                {436}in(c, (em2_847: bitstring,sigM2_848: bitstring));
                                                {437}let m2_849: bitstring = em2_847 in
                                                {438}if (verify(h(m2_849),sigM2_848,pkSess_842) <> true) then
                                                    0
                                                else
                                                    {439}let (=OpenSecureChannelResponse,Ns_850: bitstring,ST_851: bitstring,TTL_852: bitstring) = m2_849 in
                                                    {440}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {441}event endCli(Sess,Cli,Ns_850)
                                            )
                                            else
                                                {442}let v_853: bool = (Sess = C) in
                                                (
                                                    {443}if v_853 then
                                                    (
                                                        {444}let pkSess_854: bitstring = pub(skC) in
                                                        {445}out(c, GetEndpointRequest);
                                                        {446}in(c, (=GetEndpointResponse,=pkSess_854,=Sign,SP_855: bitstring,UP_856: bitstring));
                                                        {447}new Nc_857: bitstring;
                                                        {448}let m1_858: bitstring = (OpenSecureChannelRequest,pkCli,Nc_857) in
                                                        {449}event beginCli(Cli,Sess,Nc_857);
                                                        {450}out(c, (pkCli,m1_858,sign(h(m1_858),skCli)));
                                                        {451}in(c, (em2_859: bitstring,sigM2_860: bitstring));
                                                        {452}let m2_861: bitstring = em2_859 in
                                                        {453}if (verify(h(m2_861),sigM2_860,pkSess_854) <> true) then
                                                            0
                                                        else
                                                            {454}let (=OpenSecureChannelResponse,Ns_862: bitstring,ST_863: bitstring,TTL_864: bitstring) = m2_861 in
                                                            {455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {456}event endCli(Sess,Cli,Ns_862)
                                                    )
                                                    else
                                                        {457}let pkSess_865: bitstring = pub(sk(Sess)) in
                                                        {458}out(c, GetEndpointRequest);
                                                        {459}in(c, (=GetEndpointResponse,=pkSess_865,=Sign,SP_866: bitstring,UP_867: bitstring));
                                                        {460}new Nc_868: bitstring;
                                                        {461}let m1_869: bitstring = (OpenSecureChannelRequest,pkCli,Nc_868) in
                                                        {462}event beginCli(Cli,Sess,Nc_868);
                                                        {463}out(c, (pkCli,m1_869,sign(h(m1_869),skCli)));
                                                        {464}in(c, (em2_870: bitstring,sigM2_871: bitstring));
                                                        {465}let m2_872: bitstring = em2_870 in
                                                        {466}if (verify(h(m2_872),sigM2_871,pkSess_865) <> true) then
                                                            0
                                                        else
                                                            {467}let (=OpenSecureChannelResponse,Ns_873: bitstring,ST_874: bitstring,TTL_875: bitstring) = m2_872 in
                                                            {468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {469}event endCli(Sess,Cli,Ns_873)
                                                )
                                                else
                                                    {470}let pkSess_876: bitstring = fail-any in
                                                    {471}out(c, GetEndpointRequest);
                                                    {472}in(c, (=GetEndpointResponse,=pkSess_876,=Sign,SP_877: bitstring,UP_878: bitstring));
                                                    {473}new Nc_879: bitstring;
                                                    {474}let m1_880: bitstring = (OpenSecureChannelRequest,pkCli,Nc_879) in
                                                    {475}event beginCli(Cli,Sess,Nc_879);
                                                    {476}out(c, (pkCli,m1_880,sign(h(m1_880),skCli)));
                                                    {477}in(c, (em2_881: bitstring,sigM2_882: bitstring));
                                                    {478}let m2_883: bitstring = em2_881 in
                                                    {479}if (verify(h(m2_883),sigM2_882,pkSess_876) <> true) then
                                                        0
                                                    else
                                                        {480}let (=OpenSecureChannelResponse,Ns_884: bitstring,ST_885: bitstring,TTL_886: bitstring) = m2_883 in
                                                        {481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {482}event endCli(Sess,Cli,Ns_884)
                                        )
                                        else
                                            {483}let pkSess_887: bitstring = fail-any in
                                            {484}out(c, GetEndpointRequest);
                                            {485}in(c, (=GetEndpointResponse,=pkSess_887,=Sign,SP_888: bitstring,UP_889: bitstring));
                                            {486}new Nc_890: bitstring;
                                            {487}let m1_891: bitstring = (OpenSecureChannelRequest,pkCli,Nc_890) in
                                            {488}event beginCli(Cli,Sess,Nc_890);
                                            {489}out(c, (pkCli,m1_891,sign(h(m1_891),skCli)));
                                            {490}in(c, (em2_892: bitstring,sigM2_893: bitstring));
                                            {491}let m2_894: bitstring = em2_892 in
                                            {492}if (verify(h(m2_894),sigM2_893,pkSess_887) <> true) then
                                                0
                                            else
                                                {493}let (=OpenSecureChannelResponse,Ns_895: bitstring,ST_896: bitstring,TTL_897: bitstring) = m2_894 in
                                                {494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {495}event endCli(Sess,Cli,Ns_895)
                                )
                                else
                                    {496}let pkSess_898: bitstring = fail-any in
                                    {497}out(c, GetEndpointRequest);
                                    {498}in(c, (=GetEndpointResponse,=pkSess_898,=Sign,SP_899: bitstring,UP_900: bitstring));
                                    {499}new Nc_901: bitstring;
                                    {500}let m1_902: bitstring = (OpenSecureChannelRequest,pkCli,Nc_901) in
                                    {501}event beginCli(Cli,Sess,Nc_901);
                                    {502}out(c, (pkCli,m1_902,sign(h(m1_902),skCli)));
                                    {503}in(c, (em2_903: bitstring,sigM2_904: bitstring));
                                    {504}let m2_905: bitstring = em2_903 in
                                    {505}if (verify(h(m2_905),sigM2_904,pkSess_898) <> true) then
                                        0
                                    else
                                        {506}let (=OpenSecureChannelResponse,Ns_906: bitstring,ST_907: bitstring,TTL_908: bitstring) = m2_905 in
                                        {507}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {508}event endCli(Sess,Cli,Ns_906)
                    )
                    else
                        {509}let pkDisco_909: bitstring = fail-any in
                        {510}let v_910: bool = (Sess = A) in
                        (
                            {511}if v_910 then
                            (
                                {512}let pkSess_911: bitstring = pub(skA) in
                                {513}out(c, GetEndpointRequest);
                                {514}in(c, (=GetEndpointResponse,=pkSess_911,=Sign,SP_912: bitstring,UP_913: bitstring));
                                {515}new Nc_914: bitstring;
                                {516}let m1_915: bitstring = (OpenSecureChannelRequest,pkCli,Nc_914) in
                                {517}event beginCli(Cli,Sess,Nc_914);
                                {518}out(c, (pkCli,m1_915,sign(h(m1_915),skCli)));
                                {519}in(c, (em2_916: bitstring,sigM2_917: bitstring));
                                {520}let m2_918: bitstring = em2_916 in
                                {521}if (verify(h(m2_918),sigM2_917,pkSess_911) <> true) then
                                    0
                                else
                                    {522}let (=OpenSecureChannelResponse,Ns_919: bitstring,ST_920: bitstring,TTL_921: bitstring) = m2_918 in
                                    {523}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {524}event endCli(Sess,Cli,Ns_919)
                            )
                            else
                                {525}let v_922: bool = (Sess = B) in
                                (
                                    {526}if v_922 then
                                    (
                                        {527}let pkSess_923: bitstring = pub(skB) in
                                        {528}out(c, GetEndpointRequest);
                                        {529}in(c, (=GetEndpointResponse,=pkSess_923,=Sign,SP_924: bitstring,UP_925: bitstring));
                                        {530}new Nc_926: bitstring;
                                        {531}let m1_927: bitstring = (OpenSecureChannelRequest,pkCli,Nc_926) in
                                        {532}event beginCli(Cli,Sess,Nc_926);
                                        {533}out(c, (pkCli,m1_927,sign(h(m1_927),skCli)));
                                        {534}in(c, (em2_928: bitstring,sigM2_929: bitstring));
                                        {535}let m2_930: bitstring = em2_928 in
                                        {536}if (verify(h(m2_930),sigM2_929,pkSess_923) <> true) then
                                            0
                                        else
                                            {537}let (=OpenSecureChannelResponse,Ns_931: bitstring,ST_932: bitstring,TTL_933: bitstring) = m2_930 in
                                            {538}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {539}event endCli(Sess,Cli,Ns_931)
                                    )
                                    else
                                        {540}let v_934: bool = (Sess = C) in
                                        (
                                            {541}if v_934 then
                                            (
                                                {542}let pkSess_935: bitstring = pub(skC) in
                                                {543}out(c, GetEndpointRequest);
                                                {544}in(c, (=GetEndpointResponse,=pkSess_935,=Sign,SP_936: bitstring,UP_937: bitstring));
                                                {545}new Nc_938: bitstring;
                                                {546}let m1_939: bitstring = (OpenSecureChannelRequest,pkCli,Nc_938) in
                                                {547}event beginCli(Cli,Sess,Nc_938);
                                                {548}out(c, (pkCli,m1_939,sign(h(m1_939),skCli)));
                                                {549}in(c, (em2_940: bitstring,sigM2_941: bitstring));
                                                {550}let m2_942: bitstring = em2_940 in
                                                {551}if (verify(h(m2_942),sigM2_941,pkSess_935) <> true) then
                                                    0
                                                else
                                                    {552}let (=OpenSecureChannelResponse,Ns_943: bitstring,ST_944: bitstring,TTL_945: bitstring) = m2_942 in
                                                    {553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {554}event endCli(Sess,Cli,Ns_943)
                                            )
                                            else
                                                {555}let pkSess_946: bitstring = pub(sk(Sess)) in
                                                {556}out(c, GetEndpointRequest);
                                                {557}in(c, (=GetEndpointResponse,=pkSess_946,=Sign,SP_947: bitstring,UP_948: bitstring));
                                                {558}new Nc_949: bitstring;
                                                {559}let m1_950: bitstring = (OpenSecureChannelRequest,pkCli,Nc_949) in
                                                {560}event beginCli(Cli,Sess,Nc_949);
                                                {561}out(c, (pkCli,m1_950,sign(h(m1_950),skCli)));
                                                {562}in(c, (em2_951: bitstring,sigM2_952: bitstring));
                                                {563}let m2_953: bitstring = em2_951 in
                                                {564}if (verify(h(m2_953),sigM2_952,pkSess_946) <> true) then
                                                    0
                                                else
                                                    {565}let (=OpenSecureChannelResponse,Ns_954: bitstring,ST_955: bitstring,TTL_956: bitstring) = m2_953 in
                                                    {566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {567}event endCli(Sess,Cli,Ns_954)
                                        )
                                        else
                                            {568}let pkSess_957: bitstring = fail-any in
                                            {569}out(c, GetEndpointRequest);
                                            {570}in(c, (=GetEndpointResponse,=pkSess_957,=Sign,SP_958: bitstring,UP_959: bitstring));
                                            {571}new Nc_960: bitstring;
                                            {572}let m1_961: bitstring = (OpenSecureChannelRequest,pkCli,Nc_960) in
                                            {573}event beginCli(Cli,Sess,Nc_960);
                                            {574}out(c, (pkCli,m1_961,sign(h(m1_961),skCli)));
                                            {575}in(c, (em2_962: bitstring,sigM2_963: bitstring));
                                            {576}let m2_964: bitstring = em2_962 in
                                            {577}if (verify(h(m2_964),sigM2_963,pkSess_957) <> true) then
                                                0
                                            else
                                                {578}let (=OpenSecureChannelResponse,Ns_965: bitstring,ST_966: bitstring,TTL_967: bitstring) = m2_964 in
                                                {579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {580}event endCli(Sess,Cli,Ns_965)
                                )
                                else
                                    {581}let pkSess_968: bitstring = fail-any in
                                    {582}out(c, GetEndpointRequest);
                                    {583}in(c, (=GetEndpointResponse,=pkSess_968,=Sign,SP_969: bitstring,UP_970: bitstring));
                                    {584}new Nc_971: bitstring;
                                    {585}let m1_972: bitstring = (OpenSecureChannelRequest,pkCli,Nc_971) in
                                    {586}event beginCli(Cli,Sess,Nc_971);
                                    {587}out(c, (pkCli,m1_972,sign(h(m1_972),skCli)));
                                    {588}in(c, (em2_973: bitstring,sigM2_974: bitstring));
                                    {589}let m2_975: bitstring = em2_973 in
                                    {590}if (verify(h(m2_975),sigM2_974,pkSess_968) <> true) then
                                        0
                                    else
                                        {591}let (=OpenSecureChannelResponse,Ns_976: bitstring,ST_977: bitstring,TTL_978: bitstring) = m2_975 in
                                        {592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {593}event endCli(Sess,Cli,Ns_976)
                        )
                        else
                            {594}let pkSess_979: bitstring = fail-any in
                            {595}out(c, GetEndpointRequest);
                            {596}in(c, (=GetEndpointResponse,=pkSess_979,=Sign,SP_980: bitstring,UP_981: bitstring));
                            {597}new Nc_982: bitstring;
                            {598}let m1_983: bitstring = (OpenSecureChannelRequest,pkCli,Nc_982) in
                            {599}event beginCli(Cli,Sess,Nc_982);
                            {600}out(c, (pkCli,m1_983,sign(h(m1_983),skCli)));
                            {601}in(c, (em2_984: bitstring,sigM2_985: bitstring));
                            {602}let m2_986: bitstring = em2_984 in
                            {603}if (verify(h(m2_986),sigM2_985,pkSess_979) <> true) then
                                0
                            else
                                {604}let (=OpenSecureChannelResponse,Ns_987: bitstring,ST_988: bitstring,TTL_989: bitstring) = m2_986 in
                                {605}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {606}event endCli(Sess,Cli,Ns_987)
            )
            else
                {607}let pkDisco_990: bitstring = fail-any in
                {608}let v_991: bool = (Sess = A) in
                (
                    {609}if v_991 then
                    (
                        {610}let pkSess_992: bitstring = pub(skA) in
                        {611}out(c, GetEndpointRequest);
                        {612}in(c, (=GetEndpointResponse,=pkSess_992,=Sign,SP_993: bitstring,UP_994: bitstring));
                        {613}new Nc_995: bitstring;
                        {614}let m1_996: bitstring = (OpenSecureChannelRequest,pkCli,Nc_995) in
                        {615}event beginCli(Cli,Sess,Nc_995);
                        {616}out(c, (pkCli,m1_996,sign(h(m1_996),skCli)));
                        {617}in(c, (em2_997: bitstring,sigM2_998: bitstring));
                        {618}let m2_999: bitstring = em2_997 in
                        {619}if (verify(h(m2_999),sigM2_998,pkSess_992) <> true) then
                            0
                        else
                            {620}let (=OpenSecureChannelResponse,Ns_1000: bitstring,ST_1001: bitstring,TTL_1002: bitstring) = m2_999 in
                            {621}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {622}event endCli(Sess,Cli,Ns_1000)
                    )
                    else
                        {623}let v_1003: bool = (Sess = B) in
                        (
                            {624}if v_1003 then
                            (
                                {625}let pkSess_1004: bitstring = pub(skB) in
                                {626}out(c, GetEndpointRequest);
                                {627}in(c, (=GetEndpointResponse,=pkSess_1004,=Sign,SP_1005: bitstring,UP_1006: bitstring));
                                {628}new Nc_1007: bitstring;
                                {629}let m1_1008: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1007) in
                                {630}event beginCli(Cli,Sess,Nc_1007);
                                {631}out(c, (pkCli,m1_1008,sign(h(m1_1008),skCli)));
                                {632}in(c, (em2_1009: bitstring,sigM2_1010: bitstring));
                                {633}let m2_1011: bitstring = em2_1009 in
                                {634}if (verify(h(m2_1011),sigM2_1010,pkSess_1004) <> true) then
                                    0
                                else
                                    {635}let (=OpenSecureChannelResponse,Ns_1012: bitstring,ST_1013: bitstring,TTL_1014: bitstring) = m2_1011 in
                                    {636}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {637}event endCli(Sess,Cli,Ns_1012)
                            )
                            else
                                {638}let v_1015: bool = (Sess = C) in
                                (
                                    {639}if v_1015 then
                                    (
                                        {640}let pkSess_1016: bitstring = pub(skC) in
                                        {641}out(c, GetEndpointRequest);
                                        {642}in(c, (=GetEndpointResponse,=pkSess_1016,=Sign,SP_1017: bitstring,UP_1018: bitstring));
                                        {643}new Nc_1019: bitstring;
                                        {644}let m1_1020: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1019) in
                                        {645}event beginCli(Cli,Sess,Nc_1019);
                                        {646}out(c, (pkCli,m1_1020,sign(h(m1_1020),skCli)));
                                        {647}in(c, (em2_1021: bitstring,sigM2_1022: bitstring));
                                        {648}let m2_1023: bitstring = em2_1021 in
                                        {649}if (verify(h(m2_1023),sigM2_1022,pkSess_1016) <> true) then
                                            0
                                        else
                                            {650}let (=OpenSecureChannelResponse,Ns_1024: bitstring,ST_1025: bitstring,TTL_1026: bitstring) = m2_1023 in
                                            {651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {652}event endCli(Sess,Cli,Ns_1024)
                                    )
                                    else
                                        {653}let pkSess_1027: bitstring = pub(sk(Sess)) in
                                        {654}out(c, GetEndpointRequest);
                                        {655}in(c, (=GetEndpointResponse,=pkSess_1027,=Sign,SP_1028: bitstring,UP_1029: bitstring));
                                        {656}new Nc_1030: bitstring;
                                        {657}let m1_1031: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1030) in
                                        {658}event beginCli(Cli,Sess,Nc_1030);
                                        {659}out(c, (pkCli,m1_1031,sign(h(m1_1031),skCli)));
                                        {660}in(c, (em2_1032: bitstring,sigM2_1033: bitstring));
                                        {661}let m2_1034: bitstring = em2_1032 in
                                        {662}if (verify(h(m2_1034),sigM2_1033,pkSess_1027) <> true) then
                                            0
                                        else
                                            {663}let (=OpenSecureChannelResponse,Ns_1035: bitstring,ST_1036: bitstring,TTL_1037: bitstring) = m2_1034 in
                                            {664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {665}event endCli(Sess,Cli,Ns_1035)
                                )
                                else
                                    {666}let pkSess_1038: bitstring = fail-any in
                                    {667}out(c, GetEndpointRequest);
                                    {668}in(c, (=GetEndpointResponse,=pkSess_1038,=Sign,SP_1039: bitstring,UP_1040: bitstring));
                                    {669}new Nc_1041: bitstring;
                                    {670}let m1_1042: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1041) in
                                    {671}event beginCli(Cli,Sess,Nc_1041);
                                    {672}out(c, (pkCli,m1_1042,sign(h(m1_1042),skCli)));
                                    {673}in(c, (em2_1043: bitstring,sigM2_1044: bitstring));
                                    {674}let m2_1045: bitstring = em2_1043 in
                                    {675}if (verify(h(m2_1045),sigM2_1044,pkSess_1038) <> true) then
                                        0
                                    else
                                        {676}let (=OpenSecureChannelResponse,Ns_1046: bitstring,ST_1047: bitstring,TTL_1048: bitstring) = m2_1045 in
                                        {677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {678}event endCli(Sess,Cli,Ns_1046)
                        )
                        else
                            {679}let pkSess_1049: bitstring = fail-any in
                            {680}out(c, GetEndpointRequest);
                            {681}in(c, (=GetEndpointResponse,=pkSess_1049,=Sign,SP_1050: bitstring,UP_1051: bitstring));
                            {682}new Nc_1052: bitstring;
                            {683}let m1_1053: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1052) in
                            {684}event beginCli(Cli,Sess,Nc_1052);
                            {685}out(c, (pkCli,m1_1053,sign(h(m1_1053),skCli)));
                            {686}in(c, (em2_1054: bitstring,sigM2_1055: bitstring));
                            {687}let m2_1056: bitstring = em2_1054 in
                            {688}if (verify(h(m2_1056),sigM2_1055,pkSess_1049) <> true) then
                                0
                            else
                                {689}let (=OpenSecureChannelResponse,Ns_1057: bitstring,ST_1058: bitstring,TTL_1059: bitstring) = m2_1056 in
                                {690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {691}event endCli(Sess,Cli,Ns_1057)
                )
                else
                    {692}let pkSess_1060: bitstring = fail-any in
                    {693}out(c, GetEndpointRequest);
                    {694}in(c, (=GetEndpointResponse,=pkSess_1060,=Sign,SP_1061: bitstring,UP_1062: bitstring));
                    {695}new Nc_1063: bitstring;
                    {696}let m1_1064: bitstring = (OpenSecureChannelRequest,pkCli,Nc_1063) in
                    {697}event beginCli(Cli,Sess,Nc_1063);
                    {698}out(c, (pkCli,m1_1064,sign(h(m1_1064),skCli)));
                    {699}in(c, (em2_1065: bitstring,sigM2_1066: bitstring));
                    {700}let m2_1067: bitstring = em2_1065 in
                    {701}if (verify(h(m2_1067),sigM2_1066,pkSess_1060) <> true) then
                        0
                    else
                        {702}let (=OpenSecureChannelResponse,Ns_1068: bitstring,ST_1069: bitstring,TTL_1070: bitstring) = m2_1067 in
                        {703}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {704}event endCli(Sess,Cli,Ns_1068)
        )
        else
            {705}let v_1071: bool = (Cli = B) in
            (
                {706}if v_1071 then
                (
                    {707}let skCli_1072: bitstring = skB in
                    {708}let pkCli_1073: bitstring = pub(skCli_1072) in
                    {709}let v_1074: bool = (Disco = A) in
                    (
                        {710}if v_1074 then
                        (
                            {711}let pkDisco_1075: bitstring = pub(skA) in
                            {712}let v_1076: bool = (Sess = A) in
                            (
                                {713}if v_1076 then
                                (
                                    {714}let pkSess_1077: bitstring = pub(skA) in
                                    {715}out(c, GetEndpointRequest);
                                    {716}in(c, (=GetEndpointResponse,=pkSess_1077,=Sign,SP_1078: bitstring,UP_1079: bitstring));
                                    {717}new Nc_1080: bitstring;
                                    {718}let m1_1081: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1080) in
                                    {719}event beginCli(Cli,Sess,Nc_1080);
                                    {720}out(c, (pkCli_1073,m1_1081,sign(h(m1_1081),skCli_1072)));
                                    {721}in(c, (em2_1082: bitstring,sigM2_1083: bitstring));
                                    {722}let m2_1084: bitstring = em2_1082 in
                                    {723}if (verify(h(m2_1084),sigM2_1083,pkSess_1077) <> true) then
                                        0
                                    else
                                        {724}let (=OpenSecureChannelResponse,Ns_1085: bitstring,ST_1086: bitstring,TTL_1087: bitstring) = m2_1084 in
                                        {725}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {726}event endCli(Sess,Cli,Ns_1085)
                                )
                                else
                                    {727}let v_1088: bool = (Sess = B) in
                                    (
                                        {728}if v_1088 then
                                        (
                                            {729}let pkSess_1089: bitstring = pub(skB) in
                                            {730}out(c, GetEndpointRequest);
                                            {731}in(c, (=GetEndpointResponse,=pkSess_1089,=Sign,SP_1090: bitstring,UP_1091: bitstring));
                                            {732}new Nc_1092: bitstring;
                                            {733}let m1_1093: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1092) in
                                            {734}event beginCli(Cli,Sess,Nc_1092);
                                            {735}out(c, (pkCli_1073,m1_1093,sign(h(m1_1093),skCli_1072)));
                                            {736}in(c, (em2_1094: bitstring,sigM2_1095: bitstring));
                                            {737}let m2_1096: bitstring = em2_1094 in
                                            {738}if (verify(h(m2_1096),sigM2_1095,pkSess_1089) <> true) then
                                                0
                                            else
                                                {739}let (=OpenSecureChannelResponse,Ns_1097: bitstring,ST_1098: bitstring,TTL_1099: bitstring) = m2_1096 in
                                                {740}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {741}event endCli(Sess,Cli,Ns_1097)
                                        )
                                        else
                                            {742}let v_1100: bool = (Sess = C) in
                                            (
                                                {743}if v_1100 then
                                                (
                                                    {744}let pkSess_1101: bitstring = pub(skC) in
                                                    {745}out(c, GetEndpointRequest);
                                                    {746}in(c, (=GetEndpointResponse,=pkSess_1101,=Sign,SP_1102: bitstring,UP_1103: bitstring));
                                                    {747}new Nc_1104: bitstring;
                                                    {748}let m1_1105: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1104) in
                                                    {749}event beginCli(Cli,Sess,Nc_1104);
                                                    {750}out(c, (pkCli_1073,m1_1105,sign(h(m1_1105),skCli_1072)));
                                                    {751}in(c, (em2_1106: bitstring,sigM2_1107: bitstring));
                                                    {752}let m2_1108: bitstring = em2_1106 in
                                                    {753}if (verify(h(m2_1108),sigM2_1107,pkSess_1101) <> true) then
                                                        0
                                                    else
                                                        {754}let (=OpenSecureChannelResponse,Ns_1109: bitstring,ST_1110: bitstring,TTL_1111: bitstring) = m2_1108 in
                                                        {755}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {756}event endCli(Sess,Cli,Ns_1109)
                                                )
                                                else
                                                    {757}let pkSess_1112: bitstring = pub(sk(Sess)) in
                                                    {758}out(c, GetEndpointRequest);
                                                    {759}in(c, (=GetEndpointResponse,=pkSess_1112,=Sign,SP_1113: bitstring,UP_1114: bitstring));
                                                    {760}new Nc_1115: bitstring;
                                                    {761}let m1_1116: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1115) in
                                                    {762}event beginCli(Cli,Sess,Nc_1115);
                                                    {763}out(c, (pkCli_1073,m1_1116,sign(h(m1_1116),skCli_1072)));
                                                    {764}in(c, (em2_1117: bitstring,sigM2_1118: bitstring));
                                                    {765}let m2_1119: bitstring = em2_1117 in
                                                    {766}if (verify(h(m2_1119),sigM2_1118,pkSess_1112) <> true) then
                                                        0
                                                    else
                                                        {767}let (=OpenSecureChannelResponse,Ns_1120: bitstring,ST_1121: bitstring,TTL_1122: bitstring) = m2_1119 in
                                                        {768}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {769}event endCli(Sess,Cli,Ns_1120)
                                            )
                                            else
                                                {770}let pkSess_1123: bitstring = fail-any in
                                                {771}out(c, GetEndpointRequest);
                                                {772}in(c, (=GetEndpointResponse,=pkSess_1123,=Sign,SP_1124: bitstring,UP_1125: bitstring));
                                                {773}new Nc_1126: bitstring;
                                                {774}let m1_1127: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1126) in
                                                {775}event beginCli(Cli,Sess,Nc_1126);
                                                {776}out(c, (pkCli_1073,m1_1127,sign(h(m1_1127),skCli_1072)));
                                                {777}in(c, (em2_1128: bitstring,sigM2_1129: bitstring));
                                                {778}let m2_1130: bitstring = em2_1128 in
                                                {779}if (verify(h(m2_1130),sigM2_1129,pkSess_1123) <> true) then
                                                    0
                                                else
                                                    {780}let (=OpenSecureChannelResponse,Ns_1131: bitstring,ST_1132: bitstring,TTL_1133: bitstring) = m2_1130 in
                                                    {781}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {782}event endCli(Sess,Cli,Ns_1131)
                                    )
                                    else
                                        {783}let pkSess_1134: bitstring = fail-any in
                                        {784}out(c, GetEndpointRequest);
                                        {785}in(c, (=GetEndpointResponse,=pkSess_1134,=Sign,SP_1135: bitstring,UP_1136: bitstring));
                                        {786}new Nc_1137: bitstring;
                                        {787}let m1_1138: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1137) in
                                        {788}event beginCli(Cli,Sess,Nc_1137);
                                        {789}out(c, (pkCli_1073,m1_1138,sign(h(m1_1138),skCli_1072)));
                                        {790}in(c, (em2_1139: bitstring,sigM2_1140: bitstring));
                                        {791}let m2_1141: bitstring = em2_1139 in
                                        {792}if (verify(h(m2_1141),sigM2_1140,pkSess_1134) <> true) then
                                            0
                                        else
                                            {793}let (=OpenSecureChannelResponse,Ns_1142: bitstring,ST_1143: bitstring,TTL_1144: bitstring) = m2_1141 in
                                            {794}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {795}event endCli(Sess,Cli,Ns_1142)
                            )
                            else
                                {796}let pkSess_1145: bitstring = fail-any in
                                {797}out(c, GetEndpointRequest);
                                {798}in(c, (=GetEndpointResponse,=pkSess_1145,=Sign,SP_1146: bitstring,UP_1147: bitstring));
                                {799}new Nc_1148: bitstring;
                                {800}let m1_1149: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1148) in
                                {801}event beginCli(Cli,Sess,Nc_1148);
                                {802}out(c, (pkCli_1073,m1_1149,sign(h(m1_1149),skCli_1072)));
                                {803}in(c, (em2_1150: bitstring,sigM2_1151: bitstring));
                                {804}let m2_1152: bitstring = em2_1150 in
                                {805}if (verify(h(m2_1152),sigM2_1151,pkSess_1145) <> true) then
                                    0
                                else
                                    {806}let (=OpenSecureChannelResponse,Ns_1153: bitstring,ST_1154: bitstring,TTL_1155: bitstring) = m2_1152 in
                                    {807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {808}event endCli(Sess,Cli,Ns_1153)
                        )
                        else
                            {809}let v_1156: bool = (Disco = B) in
                            (
                                {810}if v_1156 then
                                (
                                    {811}let pkDisco_1157: bitstring = pub(skB) in
                                    {812}let v_1158: bool = (Sess = A) in
                                    (
                                        {813}if v_1158 then
                                        (
                                            {814}let pkSess_1159: bitstring = pub(skA) in
                                            {815}out(c, GetEndpointRequest);
                                            {816}in(c, (=GetEndpointResponse,=pkSess_1159,=Sign,SP_1160: bitstring,UP_1161: bitstring));
                                            {817}new Nc_1162: bitstring;
                                            {818}let m1_1163: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1162) in
                                            {819}event beginCli(Cli,Sess,Nc_1162);
                                            {820}out(c, (pkCli_1073,m1_1163,sign(h(m1_1163),skCli_1072)));
                                            {821}in(c, (em2_1164: bitstring,sigM2_1165: bitstring));
                                            {822}let m2_1166: bitstring = em2_1164 in
                                            {823}if (verify(h(m2_1166),sigM2_1165,pkSess_1159) <> true) then
                                                0
                                            else
                                                {824}let (=OpenSecureChannelResponse,Ns_1167: bitstring,ST_1168: bitstring,TTL_1169: bitstring) = m2_1166 in
                                                {825}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {826}event endCli(Sess,Cli,Ns_1167)
                                        )
                                        else
                                            {827}let v_1170: bool = (Sess = B) in
                                            (
                                                {828}if v_1170 then
                                                (
                                                    {829}let pkSess_1171: bitstring = pub(skB) in
                                                    {830}out(c, GetEndpointRequest);
                                                    {831}in(c, (=GetEndpointResponse,=pkSess_1171,=Sign,SP_1172: bitstring,UP_1173: bitstring));
                                                    {832}new Nc_1174: bitstring;
                                                    {833}let m1_1175: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1174) in
                                                    {834}event beginCli(Cli,Sess,Nc_1174);
                                                    {835}out(c, (pkCli_1073,m1_1175,sign(h(m1_1175),skCli_1072)));
                                                    {836}in(c, (em2_1176: bitstring,sigM2_1177: bitstring));
                                                    {837}let m2_1178: bitstring = em2_1176 in
                                                    {838}if (verify(h(m2_1178),sigM2_1177,pkSess_1171) <> true) then
                                                        0
                                                    else
                                                        {839}let (=OpenSecureChannelResponse,Ns_1179: bitstring,ST_1180: bitstring,TTL_1181: bitstring) = m2_1178 in
                                                        {840}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {841}event endCli(Sess,Cli,Ns_1179)
                                                )
                                                else
                                                    {842}let v_1182: bool = (Sess = C) in
                                                    (
                                                        {843}if v_1182 then
                                                        (
                                                            {844}let pkSess_1183: bitstring = pub(skC) in
                                                            {845}out(c, GetEndpointRequest);
                                                            {846}in(c, (=GetEndpointResponse,=pkSess_1183,=Sign,SP_1184: bitstring,UP_1185: bitstring));
                                                            {847}new Nc_1186: bitstring;
                                                            {848}let m1_1187: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1186) in
                                                            {849}event beginCli(Cli,Sess,Nc_1186);
                                                            {850}out(c, (pkCli_1073,m1_1187,sign(h(m1_1187),skCli_1072)));
                                                            {851}in(c, (em2_1188: bitstring,sigM2_1189: bitstring));
                                                            {852}let m2_1190: bitstring = em2_1188 in
                                                            {853}if (verify(h(m2_1190),sigM2_1189,pkSess_1183) <> true) then
                                                                0
                                                            else
                                                                {854}let (=OpenSecureChannelResponse,Ns_1191: bitstring,ST_1192: bitstring,TTL_1193: bitstring) = m2_1190 in
                                                                {855}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {856}event endCli(Sess,Cli,Ns_1191)
                                                        )
                                                        else
                                                            {857}let pkSess_1194: bitstring = pub(sk(Sess)) in
                                                            {858}out(c, GetEndpointRequest);
                                                            {859}in(c, (=GetEndpointResponse,=pkSess_1194,=Sign,SP_1195: bitstring,UP_1196: bitstring));
                                                            {860}new Nc_1197: bitstring;
                                                            {861}let m1_1198: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1197) in
                                                            {862}event beginCli(Cli,Sess,Nc_1197);
                                                            {863}out(c, (pkCli_1073,m1_1198,sign(h(m1_1198),skCli_1072)));
                                                            {864}in(c, (em2_1199: bitstring,sigM2_1200: bitstring));
                                                            {865}let m2_1201: bitstring = em2_1199 in
                                                            {866}if (verify(h(m2_1201),sigM2_1200,pkSess_1194) <> true) then
                                                                0
                                                            else
                                                                {867}let (=OpenSecureChannelResponse,Ns_1202: bitstring,ST_1203: bitstring,TTL_1204: bitstring) = m2_1201 in
                                                                {868}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {869}event endCli(Sess,Cli,Ns_1202)
                                                    )
                                                    else
                                                        {870}let pkSess_1205: bitstring = fail-any in
                                                        {871}out(c, GetEndpointRequest);
                                                        {872}in(c, (=GetEndpointResponse,=pkSess_1205,=Sign,SP_1206: bitstring,UP_1207: bitstring));
                                                        {873}new Nc_1208: bitstring;
                                                        {874}let m1_1209: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1208) in
                                                        {875}event beginCli(Cli,Sess,Nc_1208);
                                                        {876}out(c, (pkCli_1073,m1_1209,sign(h(m1_1209),skCli_1072)));
                                                        {877}in(c, (em2_1210: bitstring,sigM2_1211: bitstring));
                                                        {878}let m2_1212: bitstring = em2_1210 in
                                                        {879}if (verify(h(m2_1212),sigM2_1211,pkSess_1205) <> true) then
                                                            0
                                                        else
                                                            {880}let (=OpenSecureChannelResponse,Ns_1213: bitstring,ST_1214: bitstring,TTL_1215: bitstring) = m2_1212 in
                                                            {881}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {882}event endCli(Sess,Cli,Ns_1213)
                                            )
                                            else
                                                {883}let pkSess_1216: bitstring = fail-any in
                                                {884}out(c, GetEndpointRequest);
                                                {885}in(c, (=GetEndpointResponse,=pkSess_1216,=Sign,SP_1217: bitstring,UP_1218: bitstring));
                                                {886}new Nc_1219: bitstring;
                                                {887}let m1_1220: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1219) in
                                                {888}event beginCli(Cli,Sess,Nc_1219);
                                                {889}out(c, (pkCli_1073,m1_1220,sign(h(m1_1220),skCli_1072)));
                                                {890}in(c, (em2_1221: bitstring,sigM2_1222: bitstring));
                                                {891}let m2_1223: bitstring = em2_1221 in
                                                {892}if (verify(h(m2_1223),sigM2_1222,pkSess_1216) <> true) then
                                                    0
                                                else
                                                    {893}let (=OpenSecureChannelResponse,Ns_1224: bitstring,ST_1225: bitstring,TTL_1226: bitstring) = m2_1223 in
                                                    {894}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {895}event endCli(Sess,Cli,Ns_1224)
                                    )
                                    else
                                        {896}let pkSess_1227: bitstring = fail-any in
                                        {897}out(c, GetEndpointRequest);
                                        {898}in(c, (=GetEndpointResponse,=pkSess_1227,=Sign,SP_1228: bitstring,UP_1229: bitstring));
                                        {899}new Nc_1230: bitstring;
                                        {900}let m1_1231: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1230) in
                                        {901}event beginCli(Cli,Sess,Nc_1230);
                                        {902}out(c, (pkCli_1073,m1_1231,sign(h(m1_1231),skCli_1072)));
                                        {903}in(c, (em2_1232: bitstring,sigM2_1233: bitstring));
                                        {904}let m2_1234: bitstring = em2_1232 in
                                        {905}if (verify(h(m2_1234),sigM2_1233,pkSess_1227) <> true) then
                                            0
                                        else
                                            {906}let (=OpenSecureChannelResponse,Ns_1235: bitstring,ST_1236: bitstring,TTL_1237: bitstring) = m2_1234 in
                                            {907}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {908}event endCli(Sess,Cli,Ns_1235)
                                )
                                else
                                    {909}let v_1238: bool = (Disco = C) in
                                    (
                                        {910}if v_1238 then
                                        (
                                            {911}let pkDisco_1239: bitstring = pub(skC) in
                                            {912}let v_1240: bool = (Sess = A) in
                                            (
                                                {913}if v_1240 then
                                                (
                                                    {914}let pkSess_1241: bitstring = pub(skA) in
                                                    {915}out(c, GetEndpointRequest);
                                                    {916}in(c, (=GetEndpointResponse,=pkSess_1241,=Sign,SP_1242: bitstring,UP_1243: bitstring));
                                                    {917}new Nc_1244: bitstring;
                                                    {918}let m1_1245: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1244) in
                                                    {919}event beginCli(Cli,Sess,Nc_1244);
                                                    {920}out(c, (pkCli_1073,m1_1245,sign(h(m1_1245),skCli_1072)));
                                                    {921}in(c, (em2_1246: bitstring,sigM2_1247: bitstring));
                                                    {922}let m2_1248: bitstring = em2_1246 in
                                                    {923}if (verify(h(m2_1248),sigM2_1247,pkSess_1241) <> true) then
                                                        0
                                                    else
                                                        {924}let (=OpenSecureChannelResponse,Ns_1249: bitstring,ST_1250: bitstring,TTL_1251: bitstring) = m2_1248 in
                                                        {925}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {926}event endCli(Sess,Cli,Ns_1249)
                                                )
                                                else
                                                    {927}let v_1252: bool = (Sess = B) in
                                                    (
                                                        {928}if v_1252 then
                                                        (
                                                            {929}let pkSess_1253: bitstring = pub(skB) in
                                                            {930}out(c, GetEndpointRequest);
                                                            {931}in(c, (=GetEndpointResponse,=pkSess_1253,=Sign,SP_1254: bitstring,UP_1255: bitstring));
                                                            {932}new Nc_1256: bitstring;
                                                            {933}let m1_1257: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1256) in
                                                            {934}event beginCli(Cli,Sess,Nc_1256);
                                                            {935}out(c, (pkCli_1073,m1_1257,sign(h(m1_1257),skCli_1072)));
                                                            {936}in(c, (em2_1258: bitstring,sigM2_1259: bitstring));
                                                            {937}let m2_1260: bitstring = em2_1258 in
                                                            {938}if (verify(h(m2_1260),sigM2_1259,pkSess_1253) <> true) then
                                                                0
                                                            else
                                                                {939}let (=OpenSecureChannelResponse,Ns_1261: bitstring,ST_1262: bitstring,TTL_1263: bitstring) = m2_1260 in
                                                                {940}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {941}event endCli(Sess,Cli,Ns_1261)
                                                        )
                                                        else
                                                            {942}let v_1264: bool = (Sess = C) in
                                                            (
                                                                {943}if v_1264 then
                                                                (
                                                                    {944}let pkSess_1265: bitstring = pub(skC) in
                                                                    {945}out(c, GetEndpointRequest);
                                                                    {946}in(c, (=GetEndpointResponse,=pkSess_1265,=Sign,SP_1266: bitstring,UP_1267: bitstring));
                                                                    {947}new Nc_1268: bitstring;
                                                                    {948}let m1_1269: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1268) in
                                                                    {949}event beginCli(Cli,Sess,Nc_1268);
                                                                    {950}out(c, (pkCli_1073,m1_1269,sign(h(m1_1269),skCli_1072)));
                                                                    {951}in(c, (em2_1270: bitstring,sigM2_1271: bitstring));
                                                                    {952}let m2_1272: bitstring = em2_1270 in
                                                                    {953}if (verify(h(m2_1272),sigM2_1271,pkSess_1265) <> true) then
                                                                        0
                                                                    else
                                                                        {954}let (=OpenSecureChannelResponse,Ns_1273: bitstring,ST_1274: bitstring,TTL_1275: bitstring) = m2_1272 in
                                                                        {955}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {956}event endCli(Sess,Cli,Ns_1273)
                                                                )
                                                                else
                                                                    {957}let pkSess_1276: bitstring = pub(sk(Sess)) in
                                                                    {958}out(c, GetEndpointRequest);
                                                                    {959}in(c, (=GetEndpointResponse,=pkSess_1276,=Sign,SP_1277: bitstring,UP_1278: bitstring));
                                                                    {960}new Nc_1279: bitstring;
                                                                    {961}let m1_1280: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1279) in
                                                                    {962}event beginCli(Cli,Sess,Nc_1279);
                                                                    {963}out(c, (pkCli_1073,m1_1280,sign(h(m1_1280),skCli_1072)));
                                                                    {964}in(c, (em2_1281: bitstring,sigM2_1282: bitstring));
                                                                    {965}let m2_1283: bitstring = em2_1281 in
                                                                    {966}if (verify(h(m2_1283),sigM2_1282,pkSess_1276) <> true) then
                                                                        0
                                                                    else
                                                                        {967}let (=OpenSecureChannelResponse,Ns_1284: bitstring,ST_1285: bitstring,TTL_1286: bitstring) = m2_1283 in
                                                                        {968}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {969}event endCli(Sess,Cli,Ns_1284)
                                                            )
                                                            else
                                                                {970}let pkSess_1287: bitstring = fail-any in
                                                                {971}out(c, GetEndpointRequest);
                                                                {972}in(c, (=GetEndpointResponse,=pkSess_1287,=Sign,SP_1288: bitstring,UP_1289: bitstring));
                                                                {973}new Nc_1290: bitstring;
                                                                {974}let m1_1291: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1290) in
                                                                {975}event beginCli(Cli,Sess,Nc_1290);
                                                                {976}out(c, (pkCli_1073,m1_1291,sign(h(m1_1291),skCli_1072)));
                                                                {977}in(c, (em2_1292: bitstring,sigM2_1293: bitstring));
                                                                {978}let m2_1294: bitstring = em2_1292 in
                                                                {979}if (verify(h(m2_1294),sigM2_1293,pkSess_1287) <> true) then
                                                                    0
                                                                else
                                                                    {980}let (=OpenSecureChannelResponse,Ns_1295: bitstring,ST_1296: bitstring,TTL_1297: bitstring) = m2_1294 in
                                                                    {981}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {982}event endCli(Sess,Cli,Ns_1295)
                                                    )
                                                    else
                                                        {983}let pkSess_1298: bitstring = fail-any in
                                                        {984}out(c, GetEndpointRequest);
                                                        {985}in(c, (=GetEndpointResponse,=pkSess_1298,=Sign,SP_1299: bitstring,UP_1300: bitstring));
                                                        {986}new Nc_1301: bitstring;
                                                        {987}let m1_1302: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1301) in
                                                        {988}event beginCli(Cli,Sess,Nc_1301);
                                                        {989}out(c, (pkCli_1073,m1_1302,sign(h(m1_1302),skCli_1072)));
                                                        {990}in(c, (em2_1303: bitstring,sigM2_1304: bitstring));
                                                        {991}let m2_1305: bitstring = em2_1303 in
                                                        {992}if (verify(h(m2_1305),sigM2_1304,pkSess_1298) <> true) then
                                                            0
                                                        else
                                                            {993}let (=OpenSecureChannelResponse,Ns_1306: bitstring,ST_1307: bitstring,TTL_1308: bitstring) = m2_1305 in
                                                            {994}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {995}event endCli(Sess,Cli,Ns_1306)
                                            )
                                            else
                                                {996}let pkSess_1309: bitstring = fail-any in
                                                {997}out(c, GetEndpointRequest);
                                                {998}in(c, (=GetEndpointResponse,=pkSess_1309,=Sign,SP_1310: bitstring,UP_1311: bitstring));
                                                {999}new Nc_1312: bitstring;
                                                {1000}let m1_1313: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1312) in
                                                {1001}event beginCli(Cli,Sess,Nc_1312);
                                                {1002}out(c, (pkCli_1073,m1_1313,sign(h(m1_1313),skCli_1072)));
                                                {1003}in(c, (em2_1314: bitstring,sigM2_1315: bitstring));
                                                {1004}let m2_1316: bitstring = em2_1314 in
                                                {1005}if (verify(h(m2_1316),sigM2_1315,pkSess_1309) <> true) then
                                                    0
                                                else
                                                    {1006}let (=OpenSecureChannelResponse,Ns_1317: bitstring,ST_1318: bitstring,TTL_1319: bitstring) = m2_1316 in
                                                    {1007}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1008}event endCli(Sess,Cli,Ns_1317)
                                        )
                                        else
                                            {1009}let pkDisco_1320: bitstring = pub(sk(Disco)) in
                                            {1010}let v_1321: bool = (Sess = A) in
                                            (
                                                {1011}if v_1321 then
                                                (
                                                    {1012}let pkSess_1322: bitstring = pub(skA) in
                                                    {1013}out(c, GetEndpointRequest);
                                                    {1014}in(c, (=GetEndpointResponse,=pkSess_1322,=Sign,SP_1323: bitstring,UP_1324: bitstring));
                                                    {1015}new Nc_1325: bitstring;
                                                    {1016}let m1_1326: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1325) in
                                                    {1017}event beginCli(Cli,Sess,Nc_1325);
                                                    {1018}out(c, (pkCli_1073,m1_1326,sign(h(m1_1326),skCli_1072)));
                                                    {1019}in(c, (em2_1327: bitstring,sigM2_1328: bitstring));
                                                    {1020}let m2_1329: bitstring = em2_1327 in
                                                    {1021}if (verify(h(m2_1329),sigM2_1328,pkSess_1322) <> true) then
                                                        0
                                                    else
                                                        {1022}let (=OpenSecureChannelResponse,Ns_1330: bitstring,ST_1331: bitstring,TTL_1332: bitstring) = m2_1329 in
                                                        {1023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1024}event endCli(Sess,Cli,Ns_1330)
                                                )
                                                else
                                                    {1025}let v_1333: bool = (Sess = B) in
                                                    (
                                                        {1026}if v_1333 then
                                                        (
                                                            {1027}let pkSess_1334: bitstring = pub(skB) in
                                                            {1028}out(c, GetEndpointRequest);
                                                            {1029}in(c, (=GetEndpointResponse,=pkSess_1334,=Sign,SP_1335: bitstring,UP_1336: bitstring));
                                                            {1030}new Nc_1337: bitstring;
                                                            {1031}let m1_1338: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1337) in
                                                            {1032}event beginCli(Cli,Sess,Nc_1337);
                                                            {1033}out(c, (pkCli_1073,m1_1338,sign(h(m1_1338),skCli_1072)));
                                                            {1034}in(c, (em2_1339: bitstring,sigM2_1340: bitstring));
                                                            {1035}let m2_1341: bitstring = em2_1339 in
                                                            {1036}if (verify(h(m2_1341),sigM2_1340,pkSess_1334) <> true) then
                                                                0
                                                            else
                                                                {1037}let (=OpenSecureChannelResponse,Ns_1342: bitstring,ST_1343: bitstring,TTL_1344: bitstring) = m2_1341 in
                                                                {1038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1039}event endCli(Sess,Cli,Ns_1342)
                                                        )
                                                        else
                                                            {1040}let v_1345: bool = (Sess = C) in
                                                            (
                                                                {1041}if v_1345 then
                                                                (
                                                                    {1042}let pkSess_1346: bitstring = pub(skC) in
                                                                    {1043}out(c, GetEndpointRequest);
                                                                    {1044}in(c, (=GetEndpointResponse,=pkSess_1346,=Sign,SP_1347: bitstring,UP_1348: bitstring));
                                                                    {1045}new Nc_1349: bitstring;
                                                                    {1046}let m1_1350: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1349) in
                                                                    {1047}event beginCli(Cli,Sess,Nc_1349);
                                                                    {1048}out(c, (pkCli_1073,m1_1350,sign(h(m1_1350),skCli_1072)));
                                                                    {1049}in(c, (em2_1351: bitstring,sigM2_1352: bitstring));
                                                                    {1050}let m2_1353: bitstring = em2_1351 in
                                                                    {1051}if (verify(h(m2_1353),sigM2_1352,pkSess_1346) <> true) then
                                                                        0
                                                                    else
                                                                        {1052}let (=OpenSecureChannelResponse,Ns_1354: bitstring,ST_1355: bitstring,TTL_1356: bitstring) = m2_1353 in
                                                                        {1053}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1054}event endCli(Sess,Cli,Ns_1354)
                                                                )
                                                                else
                                                                    {1055}let pkSess_1357: bitstring = pub(sk(Sess)) in
                                                                    {1056}out(c, GetEndpointRequest);
                                                                    {1057}in(c, (=GetEndpointResponse,=pkSess_1357,=Sign,SP_1358: bitstring,UP_1359: bitstring));
                                                                    {1058}new Nc_1360: bitstring;
                                                                    {1059}let m1_1361: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1360) in
                                                                    {1060}event beginCli(Cli,Sess,Nc_1360);
                                                                    {1061}out(c, (pkCli_1073,m1_1361,sign(h(m1_1361),skCli_1072)));
                                                                    {1062}in(c, (em2_1362: bitstring,sigM2_1363: bitstring));
                                                                    {1063}let m2_1364: bitstring = em2_1362 in
                                                                    {1064}if (verify(h(m2_1364),sigM2_1363,pkSess_1357) <> true) then
                                                                        0
                                                                    else
                                                                        {1065}let (=OpenSecureChannelResponse,Ns_1365: bitstring,ST_1366: bitstring,TTL_1367: bitstring) = m2_1364 in
                                                                        {1066}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1067}event endCli(Sess,Cli,Ns_1365)
                                                            )
                                                            else
                                                                {1068}let pkSess_1368: bitstring = fail-any in
                                                                {1069}out(c, GetEndpointRequest);
                                                                {1070}in(c, (=GetEndpointResponse,=pkSess_1368,=Sign,SP_1369: bitstring,UP_1370: bitstring));
                                                                {1071}new Nc_1371: bitstring;
                                                                {1072}let m1_1372: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1371) in
                                                                {1073}event beginCli(Cli,Sess,Nc_1371);
                                                                {1074}out(c, (pkCli_1073,m1_1372,sign(h(m1_1372),skCli_1072)));
                                                                {1075}in(c, (em2_1373: bitstring,sigM2_1374: bitstring));
                                                                {1076}let m2_1375: bitstring = em2_1373 in
                                                                {1077}if (verify(h(m2_1375),sigM2_1374,pkSess_1368) <> true) then
                                                                    0
                                                                else
                                                                    {1078}let (=OpenSecureChannelResponse,Ns_1376: bitstring,ST_1377: bitstring,TTL_1378: bitstring) = m2_1375 in
                                                                    {1079}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1080}event endCli(Sess,Cli,Ns_1376)
                                                    )
                                                    else
                                                        {1081}let pkSess_1379: bitstring = fail-any in
                                                        {1082}out(c, GetEndpointRequest);
                                                        {1083}in(c, (=GetEndpointResponse,=pkSess_1379,=Sign,SP_1380: bitstring,UP_1381: bitstring));
                                                        {1084}new Nc_1382: bitstring;
                                                        {1085}let m1_1383: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1382) in
                                                        {1086}event beginCli(Cli,Sess,Nc_1382);
                                                        {1087}out(c, (pkCli_1073,m1_1383,sign(h(m1_1383),skCli_1072)));
                                                        {1088}in(c, (em2_1384: bitstring,sigM2_1385: bitstring));
                                                        {1089}let m2_1386: bitstring = em2_1384 in
                                                        {1090}if (verify(h(m2_1386),sigM2_1385,pkSess_1379) <> true) then
                                                            0
                                                        else
                                                            {1091}let (=OpenSecureChannelResponse,Ns_1387: bitstring,ST_1388: bitstring,TTL_1389: bitstring) = m2_1386 in
                                                            {1092}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1093}event endCli(Sess,Cli,Ns_1387)
                                            )
                                            else
                                                {1094}let pkSess_1390: bitstring = fail-any in
                                                {1095}out(c, GetEndpointRequest);
                                                {1096}in(c, (=GetEndpointResponse,=pkSess_1390,=Sign,SP_1391: bitstring,UP_1392: bitstring));
                                                {1097}new Nc_1393: bitstring;
                                                {1098}let m1_1394: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1393) in
                                                {1099}event beginCli(Cli,Sess,Nc_1393);
                                                {1100}out(c, (pkCli_1073,m1_1394,sign(h(m1_1394),skCli_1072)));
                                                {1101}in(c, (em2_1395: bitstring,sigM2_1396: bitstring));
                                                {1102}let m2_1397: bitstring = em2_1395 in
                                                {1103}if (verify(h(m2_1397),sigM2_1396,pkSess_1390) <> true) then
                                                    0
                                                else
                                                    {1104}let (=OpenSecureChannelResponse,Ns_1398: bitstring,ST_1399: bitstring,TTL_1400: bitstring) = m2_1397 in
                                                    {1105}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1106}event endCli(Sess,Cli,Ns_1398)
                                    )
                                    else
                                        {1107}let pkDisco_1401: bitstring = fail-any in
                                        {1108}let v_1402: bool = (Sess = A) in
                                        (
                                            {1109}if v_1402 then
                                            (
                                                {1110}let pkSess_1403: bitstring = pub(skA) in
                                                {1111}out(c, GetEndpointRequest);
                                                {1112}in(c, (=GetEndpointResponse,=pkSess_1403,=Sign,SP_1404: bitstring,UP_1405: bitstring));
                                                {1113}new Nc_1406: bitstring;
                                                {1114}let m1_1407: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1406) in
                                                {1115}event beginCli(Cli,Sess,Nc_1406);
                                                {1116}out(c, (pkCli_1073,m1_1407,sign(h(m1_1407),skCli_1072)));
                                                {1117}in(c, (em2_1408: bitstring,sigM2_1409: bitstring));
                                                {1118}let m2_1410: bitstring = em2_1408 in
                                                {1119}if (verify(h(m2_1410),sigM2_1409,pkSess_1403) <> true) then
                                                    0
                                                else
                                                    {1120}let (=OpenSecureChannelResponse,Ns_1411: bitstring,ST_1412: bitstring,TTL_1413: bitstring) = m2_1410 in
                                                    {1121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1122}event endCli(Sess,Cli,Ns_1411)
                                            )
                                            else
                                                {1123}let v_1414: bool = (Sess = B) in
                                                (
                                                    {1124}if v_1414 then
                                                    (
                                                        {1125}let pkSess_1415: bitstring = pub(skB) in
                                                        {1126}out(c, GetEndpointRequest);
                                                        {1127}in(c, (=GetEndpointResponse,=pkSess_1415,=Sign,SP_1416: bitstring,UP_1417: bitstring));
                                                        {1128}new Nc_1418: bitstring;
                                                        {1129}let m1_1419: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1418) in
                                                        {1130}event beginCli(Cli,Sess,Nc_1418);
                                                        {1131}out(c, (pkCli_1073,m1_1419,sign(h(m1_1419),skCli_1072)));
                                                        {1132}in(c, (em2_1420: bitstring,sigM2_1421: bitstring));
                                                        {1133}let m2_1422: bitstring = em2_1420 in
                                                        {1134}if (verify(h(m2_1422),sigM2_1421,pkSess_1415) <> true) then
                                                            0
                                                        else
                                                            {1135}let (=OpenSecureChannelResponse,Ns_1423: bitstring,ST_1424: bitstring,TTL_1425: bitstring) = m2_1422 in
                                                            {1136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1137}event endCli(Sess,Cli,Ns_1423)
                                                    )
                                                    else
                                                        {1138}let v_1426: bool = (Sess = C) in
                                                        (
                                                            {1139}if v_1426 then
                                                            (
                                                                {1140}let pkSess_1427: bitstring = pub(skC) in
                                                                {1141}out(c, GetEndpointRequest);
                                                                {1142}in(c, (=GetEndpointResponse,=pkSess_1427,=Sign,SP_1428: bitstring,UP_1429: bitstring));
                                                                {1143}new Nc_1430: bitstring;
                                                                {1144}let m1_1431: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1430) in
                                                                {1145}event beginCli(Cli,Sess,Nc_1430);
                                                                {1146}out(c, (pkCli_1073,m1_1431,sign(h(m1_1431),skCli_1072)));
                                                                {1147}in(c, (em2_1432: bitstring,sigM2_1433: bitstring));
                                                                {1148}let m2_1434: bitstring = em2_1432 in
                                                                {1149}if (verify(h(m2_1434),sigM2_1433,pkSess_1427) <> true) then
                                                                    0
                                                                else
                                                                    {1150}let (=OpenSecureChannelResponse,Ns_1435: bitstring,ST_1436: bitstring,TTL_1437: bitstring) = m2_1434 in
                                                                    {1151}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1152}event endCli(Sess,Cli,Ns_1435)
                                                            )
                                                            else
                                                                {1153}let pkSess_1438: bitstring = pub(sk(Sess)) in
                                                                {1154}out(c, GetEndpointRequest);
                                                                {1155}in(c, (=GetEndpointResponse,=pkSess_1438,=Sign,SP_1439: bitstring,UP_1440: bitstring));
                                                                {1156}new Nc_1441: bitstring;
                                                                {1157}let m1_1442: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1441) in
                                                                {1158}event beginCli(Cli,Sess,Nc_1441);
                                                                {1159}out(c, (pkCli_1073,m1_1442,sign(h(m1_1442),skCli_1072)));
                                                                {1160}in(c, (em2_1443: bitstring,sigM2_1444: bitstring));
                                                                {1161}let m2_1445: bitstring = em2_1443 in
                                                                {1162}if (verify(h(m2_1445),sigM2_1444,pkSess_1438) <> true) then
                                                                    0
                                                                else
                                                                    {1163}let (=OpenSecureChannelResponse,Ns_1446: bitstring,ST_1447: bitstring,TTL_1448: bitstring) = m2_1445 in
                                                                    {1164}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1165}event endCli(Sess,Cli,Ns_1446)
                                                        )
                                                        else
                                                            {1166}let pkSess_1449: bitstring = fail-any in
                                                            {1167}out(c, GetEndpointRequest);
                                                            {1168}in(c, (=GetEndpointResponse,=pkSess_1449,=Sign,SP_1450: bitstring,UP_1451: bitstring));
                                                            {1169}new Nc_1452: bitstring;
                                                            {1170}let m1_1453: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1452) in
                                                            {1171}event beginCli(Cli,Sess,Nc_1452);
                                                            {1172}out(c, (pkCli_1073,m1_1453,sign(h(m1_1453),skCli_1072)));
                                                            {1173}in(c, (em2_1454: bitstring,sigM2_1455: bitstring));
                                                            {1174}let m2_1456: bitstring = em2_1454 in
                                                            {1175}if (verify(h(m2_1456),sigM2_1455,pkSess_1449) <> true) then
                                                                0
                                                            else
                                                                {1176}let (=OpenSecureChannelResponse,Ns_1457: bitstring,ST_1458: bitstring,TTL_1459: bitstring) = m2_1456 in
                                                                {1177}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1178}event endCli(Sess,Cli,Ns_1457)
                                                )
                                                else
                                                    {1179}let pkSess_1460: bitstring = fail-any in
                                                    {1180}out(c, GetEndpointRequest);
                                                    {1181}in(c, (=GetEndpointResponse,=pkSess_1460,=Sign,SP_1461: bitstring,UP_1462: bitstring));
                                                    {1182}new Nc_1463: bitstring;
                                                    {1183}let m1_1464: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1463) in
                                                    {1184}event beginCli(Cli,Sess,Nc_1463);
                                                    {1185}out(c, (pkCli_1073,m1_1464,sign(h(m1_1464),skCli_1072)));
                                                    {1186}in(c, (em2_1465: bitstring,sigM2_1466: bitstring));
                                                    {1187}let m2_1467: bitstring = em2_1465 in
                                                    {1188}if (verify(h(m2_1467),sigM2_1466,pkSess_1460) <> true) then
                                                        0
                                                    else
                                                        {1189}let (=OpenSecureChannelResponse,Ns_1468: bitstring,ST_1469: bitstring,TTL_1470: bitstring) = m2_1467 in
                                                        {1190}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1191}event endCli(Sess,Cli,Ns_1468)
                                        )
                                        else
                                            {1192}let pkSess_1471: bitstring = fail-any in
                                            {1193}out(c, GetEndpointRequest);
                                            {1194}in(c, (=GetEndpointResponse,=pkSess_1471,=Sign,SP_1472: bitstring,UP_1473: bitstring));
                                            {1195}new Nc_1474: bitstring;
                                            {1196}let m1_1475: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1474) in
                                            {1197}event beginCli(Cli,Sess,Nc_1474);
                                            {1198}out(c, (pkCli_1073,m1_1475,sign(h(m1_1475),skCli_1072)));
                                            {1199}in(c, (em2_1476: bitstring,sigM2_1477: bitstring));
                                            {1200}let m2_1478: bitstring = em2_1476 in
                                            {1201}if (verify(h(m2_1478),sigM2_1477,pkSess_1471) <> true) then
                                                0
                                            else
                                                {1202}let (=OpenSecureChannelResponse,Ns_1479: bitstring,ST_1480: bitstring,TTL_1481: bitstring) = m2_1478 in
                                                {1203}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1204}event endCli(Sess,Cli,Ns_1479)
                            )
                            else
                                {1205}let pkDisco_1482: bitstring = fail-any in
                                {1206}let v_1483: bool = (Sess = A) in
                                (
                                    {1207}if v_1483 then
                                    (
                                        {1208}let pkSess_1484: bitstring = pub(skA) in
                                        {1209}out(c, GetEndpointRequest);
                                        {1210}in(c, (=GetEndpointResponse,=pkSess_1484,=Sign,SP_1485: bitstring,UP_1486: bitstring));
                                        {1211}new Nc_1487: bitstring;
                                        {1212}let m1_1488: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1487) in
                                        {1213}event beginCli(Cli,Sess,Nc_1487);
                                        {1214}out(c, (pkCli_1073,m1_1488,sign(h(m1_1488),skCli_1072)));
                                        {1215}in(c, (em2_1489: bitstring,sigM2_1490: bitstring));
                                        {1216}let m2_1491: bitstring = em2_1489 in
                                        {1217}if (verify(h(m2_1491),sigM2_1490,pkSess_1484) <> true) then
                                            0
                                        else
                                            {1218}let (=OpenSecureChannelResponse,Ns_1492: bitstring,ST_1493: bitstring,TTL_1494: bitstring) = m2_1491 in
                                            {1219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1220}event endCli(Sess,Cli,Ns_1492)
                                    )
                                    else
                                        {1221}let v_1495: bool = (Sess = B) in
                                        (
                                            {1222}if v_1495 then
                                            (
                                                {1223}let pkSess_1496: bitstring = pub(skB) in
                                                {1224}out(c, GetEndpointRequest);
                                                {1225}in(c, (=GetEndpointResponse,=pkSess_1496,=Sign,SP_1497: bitstring,UP_1498: bitstring));
                                                {1226}new Nc_1499: bitstring;
                                                {1227}let m1_1500: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1499) in
                                                {1228}event beginCli(Cli,Sess,Nc_1499);
                                                {1229}out(c, (pkCli_1073,m1_1500,sign(h(m1_1500),skCli_1072)));
                                                {1230}in(c, (em2_1501: bitstring,sigM2_1502: bitstring));
                                                {1231}let m2_1503: bitstring = em2_1501 in
                                                {1232}if (verify(h(m2_1503),sigM2_1502,pkSess_1496) <> true) then
                                                    0
                                                else
                                                    {1233}let (=OpenSecureChannelResponse,Ns_1504: bitstring,ST_1505: bitstring,TTL_1506: bitstring) = m2_1503 in
                                                    {1234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1235}event endCli(Sess,Cli,Ns_1504)
                                            )
                                            else
                                                {1236}let v_1507: bool = (Sess = C) in
                                                (
                                                    {1237}if v_1507 then
                                                    (
                                                        {1238}let pkSess_1508: bitstring = pub(skC) in
                                                        {1239}out(c, GetEndpointRequest);
                                                        {1240}in(c, (=GetEndpointResponse,=pkSess_1508,=Sign,SP_1509: bitstring,UP_1510: bitstring));
                                                        {1241}new Nc_1511: bitstring;
                                                        {1242}let m1_1512: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1511) in
                                                        {1243}event beginCli(Cli,Sess,Nc_1511);
                                                        {1244}out(c, (pkCli_1073,m1_1512,sign(h(m1_1512),skCli_1072)));
                                                        {1245}in(c, (em2_1513: bitstring,sigM2_1514: bitstring));
                                                        {1246}let m2_1515: bitstring = em2_1513 in
                                                        {1247}if (verify(h(m2_1515),sigM2_1514,pkSess_1508) <> true) then
                                                            0
                                                        else
                                                            {1248}let (=OpenSecureChannelResponse,Ns_1516: bitstring,ST_1517: bitstring,TTL_1518: bitstring) = m2_1515 in
                                                            {1249}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1250}event endCli(Sess,Cli,Ns_1516)
                                                    )
                                                    else
                                                        {1251}let pkSess_1519: bitstring = pub(sk(Sess)) in
                                                        {1252}out(c, GetEndpointRequest);
                                                        {1253}in(c, (=GetEndpointResponse,=pkSess_1519,=Sign,SP_1520: bitstring,UP_1521: bitstring));
                                                        {1254}new Nc_1522: bitstring;
                                                        {1255}let m1_1523: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1522) in
                                                        {1256}event beginCli(Cli,Sess,Nc_1522);
                                                        {1257}out(c, (pkCli_1073,m1_1523,sign(h(m1_1523),skCli_1072)));
                                                        {1258}in(c, (em2_1524: bitstring,sigM2_1525: bitstring));
                                                        {1259}let m2_1526: bitstring = em2_1524 in
                                                        {1260}if (verify(h(m2_1526),sigM2_1525,pkSess_1519) <> true) then
                                                            0
                                                        else
                                                            {1261}let (=OpenSecureChannelResponse,Ns_1527: bitstring,ST_1528: bitstring,TTL_1529: bitstring) = m2_1526 in
                                                            {1262}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1263}event endCli(Sess,Cli,Ns_1527)
                                                )
                                                else
                                                    {1264}let pkSess_1530: bitstring = fail-any in
                                                    {1265}out(c, GetEndpointRequest);
                                                    {1266}in(c, (=GetEndpointResponse,=pkSess_1530,=Sign,SP_1531: bitstring,UP_1532: bitstring));
                                                    {1267}new Nc_1533: bitstring;
                                                    {1268}let m1_1534: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1533) in
                                                    {1269}event beginCli(Cli,Sess,Nc_1533);
                                                    {1270}out(c, (pkCli_1073,m1_1534,sign(h(m1_1534),skCli_1072)));
                                                    {1271}in(c, (em2_1535: bitstring,sigM2_1536: bitstring));
                                                    {1272}let m2_1537: bitstring = em2_1535 in
                                                    {1273}if (verify(h(m2_1537),sigM2_1536,pkSess_1530) <> true) then
                                                        0
                                                    else
                                                        {1274}let (=OpenSecureChannelResponse,Ns_1538: bitstring,ST_1539: bitstring,TTL_1540: bitstring) = m2_1537 in
                                                        {1275}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1276}event endCli(Sess,Cli,Ns_1538)
                                        )
                                        else
                                            {1277}let pkSess_1541: bitstring = fail-any in
                                            {1278}out(c, GetEndpointRequest);
                                            {1279}in(c, (=GetEndpointResponse,=pkSess_1541,=Sign,SP_1542: bitstring,UP_1543: bitstring));
                                            {1280}new Nc_1544: bitstring;
                                            {1281}let m1_1545: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1544) in
                                            {1282}event beginCli(Cli,Sess,Nc_1544);
                                            {1283}out(c, (pkCli_1073,m1_1545,sign(h(m1_1545),skCli_1072)));
                                            {1284}in(c, (em2_1546: bitstring,sigM2_1547: bitstring));
                                            {1285}let m2_1548: bitstring = em2_1546 in
                                            {1286}if (verify(h(m2_1548),sigM2_1547,pkSess_1541) <> true) then
                                                0
                                            else
                                                {1287}let (=OpenSecureChannelResponse,Ns_1549: bitstring,ST_1550: bitstring,TTL_1551: bitstring) = m2_1548 in
                                                {1288}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1289}event endCli(Sess,Cli,Ns_1549)
                                )
                                else
                                    {1290}let pkSess_1552: bitstring = fail-any in
                                    {1291}out(c, GetEndpointRequest);
                                    {1292}in(c, (=GetEndpointResponse,=pkSess_1552,=Sign,SP_1553: bitstring,UP_1554: bitstring));
                                    {1293}new Nc_1555: bitstring;
                                    {1294}let m1_1556: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1555) in
                                    {1295}event beginCli(Cli,Sess,Nc_1555);
                                    {1296}out(c, (pkCli_1073,m1_1556,sign(h(m1_1556),skCli_1072)));
                                    {1297}in(c, (em2_1557: bitstring,sigM2_1558: bitstring));
                                    {1298}let m2_1559: bitstring = em2_1557 in
                                    {1299}if (verify(h(m2_1559),sigM2_1558,pkSess_1552) <> true) then
                                        0
                                    else
                                        {1300}let (=OpenSecureChannelResponse,Ns_1560: bitstring,ST_1561: bitstring,TTL_1562: bitstring) = m2_1559 in
                                        {1301}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1302}event endCli(Sess,Cli,Ns_1560)
                    )
                    else
                        {1303}let pkDisco_1563: bitstring = fail-any in
                        {1304}let v_1564: bool = (Sess = A) in
                        (
                            {1305}if v_1564 then
                            (
                                {1306}let pkSess_1565: bitstring = pub(skA) in
                                {1307}out(c, GetEndpointRequest);
                                {1308}in(c, (=GetEndpointResponse,=pkSess_1565,=Sign,SP_1566: bitstring,UP_1567: bitstring));
                                {1309}new Nc_1568: bitstring;
                                {1310}let m1_1569: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1568) in
                                {1311}event beginCli(Cli,Sess,Nc_1568);
                                {1312}out(c, (pkCli_1073,m1_1569,sign(h(m1_1569),skCli_1072)));
                                {1313}in(c, (em2_1570: bitstring,sigM2_1571: bitstring));
                                {1314}let m2_1572: bitstring = em2_1570 in
                                {1315}if (verify(h(m2_1572),sigM2_1571,pkSess_1565) <> true) then
                                    0
                                else
                                    {1316}let (=OpenSecureChannelResponse,Ns_1573: bitstring,ST_1574: bitstring,TTL_1575: bitstring) = m2_1572 in
                                    {1317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1318}event endCli(Sess,Cli,Ns_1573)
                            )
                            else
                                {1319}let v_1576: bool = (Sess = B) in
                                (
                                    {1320}if v_1576 then
                                    (
                                        {1321}let pkSess_1577: bitstring = pub(skB) in
                                        {1322}out(c, GetEndpointRequest);
                                        {1323}in(c, (=GetEndpointResponse,=pkSess_1577,=Sign,SP_1578: bitstring,UP_1579: bitstring));
                                        {1324}new Nc_1580: bitstring;
                                        {1325}let m1_1581: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1580) in
                                        {1326}event beginCli(Cli,Sess,Nc_1580);
                                        {1327}out(c, (pkCli_1073,m1_1581,sign(h(m1_1581),skCli_1072)));
                                        {1328}in(c, (em2_1582: bitstring,sigM2_1583: bitstring));
                                        {1329}let m2_1584: bitstring = em2_1582 in
                                        {1330}if (verify(h(m2_1584),sigM2_1583,pkSess_1577) <> true) then
                                            0
                                        else
                                            {1331}let (=OpenSecureChannelResponse,Ns_1585: bitstring,ST_1586: bitstring,TTL_1587: bitstring) = m2_1584 in
                                            {1332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1333}event endCli(Sess,Cli,Ns_1585)
                                    )
                                    else
                                        {1334}let v_1588: bool = (Sess = C) in
                                        (
                                            {1335}if v_1588 then
                                            (
                                                {1336}let pkSess_1589: bitstring = pub(skC) in
                                                {1337}out(c, GetEndpointRequest);
                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1589,=Sign,SP_1590: bitstring,UP_1591: bitstring));
                                                {1339}new Nc_1592: bitstring;
                                                {1340}let m1_1593: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1592) in
                                                {1341}event beginCli(Cli,Sess,Nc_1592);
                                                {1342}out(c, (pkCli_1073,m1_1593,sign(h(m1_1593),skCli_1072)));
                                                {1343}in(c, (em2_1594: bitstring,sigM2_1595: bitstring));
                                                {1344}let m2_1596: bitstring = em2_1594 in
                                                {1345}if (verify(h(m2_1596),sigM2_1595,pkSess_1589) <> true) then
                                                    0
                                                else
                                                    {1346}let (=OpenSecureChannelResponse,Ns_1597: bitstring,ST_1598: bitstring,TTL_1599: bitstring) = m2_1596 in
                                                    {1347}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1348}event endCli(Sess,Cli,Ns_1597)
                                            )
                                            else
                                                {1349}let pkSess_1600: bitstring = pub(sk(Sess)) in
                                                {1350}out(c, GetEndpointRequest);
                                                {1351}in(c, (=GetEndpointResponse,=pkSess_1600,=Sign,SP_1601: bitstring,UP_1602: bitstring));
                                                {1352}new Nc_1603: bitstring;
                                                {1353}let m1_1604: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1603) in
                                                {1354}event beginCli(Cli,Sess,Nc_1603);
                                                {1355}out(c, (pkCli_1073,m1_1604,sign(h(m1_1604),skCli_1072)));
                                                {1356}in(c, (em2_1605: bitstring,sigM2_1606: bitstring));
                                                {1357}let m2_1607: bitstring = em2_1605 in
                                                {1358}if (verify(h(m2_1607),sigM2_1606,pkSess_1600) <> true) then
                                                    0
                                                else
                                                    {1359}let (=OpenSecureChannelResponse,Ns_1608: bitstring,ST_1609: bitstring,TTL_1610: bitstring) = m2_1607 in
                                                    {1360}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1361}event endCli(Sess,Cli,Ns_1608)
                                        )
                                        else
                                            {1362}let pkSess_1611: bitstring = fail-any in
                                            {1363}out(c, GetEndpointRequest);
                                            {1364}in(c, (=GetEndpointResponse,=pkSess_1611,=Sign,SP_1612: bitstring,UP_1613: bitstring));
                                            {1365}new Nc_1614: bitstring;
                                            {1366}let m1_1615: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1614) in
                                            {1367}event beginCli(Cli,Sess,Nc_1614);
                                            {1368}out(c, (pkCli_1073,m1_1615,sign(h(m1_1615),skCli_1072)));
                                            {1369}in(c, (em2_1616: bitstring,sigM2_1617: bitstring));
                                            {1370}let m2_1618: bitstring = em2_1616 in
                                            {1371}if (verify(h(m2_1618),sigM2_1617,pkSess_1611) <> true) then
                                                0
                                            else
                                                {1372}let (=OpenSecureChannelResponse,Ns_1619: bitstring,ST_1620: bitstring,TTL_1621: bitstring) = m2_1618 in
                                                {1373}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1374}event endCli(Sess,Cli,Ns_1619)
                                )
                                else
                                    {1375}let pkSess_1622: bitstring = fail-any in
                                    {1376}out(c, GetEndpointRequest);
                                    {1377}in(c, (=GetEndpointResponse,=pkSess_1622,=Sign,SP_1623: bitstring,UP_1624: bitstring));
                                    {1378}new Nc_1625: bitstring;
                                    {1379}let m1_1626: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1625) in
                                    {1380}event beginCli(Cli,Sess,Nc_1625);
                                    {1381}out(c, (pkCli_1073,m1_1626,sign(h(m1_1626),skCli_1072)));
                                    {1382}in(c, (em2_1627: bitstring,sigM2_1628: bitstring));
                                    {1383}let m2_1629: bitstring = em2_1627 in
                                    {1384}if (verify(h(m2_1629),sigM2_1628,pkSess_1622) <> true) then
                                        0
                                    else
                                        {1385}let (=OpenSecureChannelResponse,Ns_1630: bitstring,ST_1631: bitstring,TTL_1632: bitstring) = m2_1629 in
                                        {1386}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1387}event endCli(Sess,Cli,Ns_1630)
                        )
                        else
                            {1388}let pkSess_1633: bitstring = fail-any in
                            {1389}out(c, GetEndpointRequest);
                            {1390}in(c, (=GetEndpointResponse,=pkSess_1633,=Sign,SP_1634: bitstring,UP_1635: bitstring));
                            {1391}new Nc_1636: bitstring;
                            {1392}let m1_1637: bitstring = (OpenSecureChannelRequest,pkCli_1073,Nc_1636) in
                            {1393}event beginCli(Cli,Sess,Nc_1636);
                            {1394}out(c, (pkCli_1073,m1_1637,sign(h(m1_1637),skCli_1072)));
                            {1395}in(c, (em2_1638: bitstring,sigM2_1639: bitstring));
                            {1396}let m2_1640: bitstring = em2_1638 in
                            {1397}if (verify(h(m2_1640),sigM2_1639,pkSess_1633) <> true) then
                                0
                            else
                                {1398}let (=OpenSecureChannelResponse,Ns_1641: bitstring,ST_1642: bitstring,TTL_1643: bitstring) = m2_1640 in
                                {1399}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1400}event endCli(Sess,Cli,Ns_1641)
                )
                else
                    {1401}let =true = (Cli = C) in
                    (
                        {1402}let skCli_1644: bitstring = skC in
                        {1403}let pkCli_1645: bitstring = pub(skCli_1644) in
                        {1404}let v_1646: bool = (Disco = A) in
                        (
                            {1405}if v_1646 then
                            (
                                {1406}let pkDisco_1647: bitstring = pub(skA) in
                                {1407}let v_1648: bool = (Sess = A) in
                                (
                                    {1408}if v_1648 then
                                    (
                                        {1409}let pkSess_1649: bitstring = pub(skA) in
                                        {1410}out(c, GetEndpointRequest);
                                        {1411}in(c, (=GetEndpointResponse,=pkSess_1649,=Sign,SP_1650: bitstring,UP_1651: bitstring));
                                        {1412}new Nc_1652: bitstring;
                                        {1413}let m1_1653: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1652) in
                                        {1414}event beginCli(Cli,Sess,Nc_1652);
                                        {1415}out(c, (pkCli_1645,m1_1653,sign(h(m1_1653),skCli_1644)));
                                        {1416}in(c, (em2_1654: bitstring,sigM2_1655: bitstring));
                                        {1417}let m2_1656: bitstring = em2_1654 in
                                        {1418}if (verify(h(m2_1656),sigM2_1655,pkSess_1649) <> true) then
                                            0
                                        else
                                            {1419}let (=OpenSecureChannelResponse,Ns_1657: bitstring,ST_1658: bitstring,TTL_1659: bitstring) = m2_1656 in
                                            {1420}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1421}event endCli(Sess,Cli,Ns_1657)
                                    )
                                    else
                                        {1422}let v_1660: bool = (Sess = B) in
                                        (
                                            {1423}if v_1660 then
                                            (
                                                {1424}let pkSess_1661: bitstring = pub(skB) in
                                                {1425}out(c, GetEndpointRequest);
                                                {1426}in(c, (=GetEndpointResponse,=pkSess_1661,=Sign,SP_1662: bitstring,UP_1663: bitstring));
                                                {1427}new Nc_1664: bitstring;
                                                {1428}let m1_1665: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1664) in
                                                {1429}event beginCli(Cli,Sess,Nc_1664);
                                                {1430}out(c, (pkCli_1645,m1_1665,sign(h(m1_1665),skCli_1644)));
                                                {1431}in(c, (em2_1666: bitstring,sigM2_1667: bitstring));
                                                {1432}let m2_1668: bitstring = em2_1666 in
                                                {1433}if (verify(h(m2_1668),sigM2_1667,pkSess_1661) <> true) then
                                                    0
                                                else
                                                    {1434}let (=OpenSecureChannelResponse,Ns_1669: bitstring,ST_1670: bitstring,TTL_1671: bitstring) = m2_1668 in
                                                    {1435}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1436}event endCli(Sess,Cli,Ns_1669)
                                            )
                                            else
                                                {1437}let v_1672: bool = (Sess = C) in
                                                (
                                                    {1438}if v_1672 then
                                                    (
                                                        {1439}let pkSess_1673: bitstring = pub(skC) in
                                                        {1440}out(c, GetEndpointRequest);
                                                        {1441}in(c, (=GetEndpointResponse,=pkSess_1673,=Sign,SP_1674: bitstring,UP_1675: bitstring));
                                                        {1442}new Nc_1676: bitstring;
                                                        {1443}let m1_1677: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1676) in
                                                        {1444}event beginCli(Cli,Sess,Nc_1676);
                                                        {1445}out(c, (pkCli_1645,m1_1677,sign(h(m1_1677),skCli_1644)));
                                                        {1446}in(c, (em2_1678: bitstring,sigM2_1679: bitstring));
                                                        {1447}let m2_1680: bitstring = em2_1678 in
                                                        {1448}if (verify(h(m2_1680),sigM2_1679,pkSess_1673) <> true) then
                                                            0
                                                        else
                                                            {1449}let (=OpenSecureChannelResponse,Ns_1681: bitstring,ST_1682: bitstring,TTL_1683: bitstring) = m2_1680 in
                                                            {1450}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1451}event endCli(Sess,Cli,Ns_1681)
                                                    )
                                                    else
                                                        {1452}let pkSess_1684: bitstring = pub(sk(Sess)) in
                                                        {1453}out(c, GetEndpointRequest);
                                                        {1454}in(c, (=GetEndpointResponse,=pkSess_1684,=Sign,SP_1685: bitstring,UP_1686: bitstring));
                                                        {1455}new Nc_1687: bitstring;
                                                        {1456}let m1_1688: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1687) in
                                                        {1457}event beginCli(Cli,Sess,Nc_1687);
                                                        {1458}out(c, (pkCli_1645,m1_1688,sign(h(m1_1688),skCli_1644)));
                                                        {1459}in(c, (em2_1689: bitstring,sigM2_1690: bitstring));
                                                        {1460}let m2_1691: bitstring = em2_1689 in
                                                        {1461}if (verify(h(m2_1691),sigM2_1690,pkSess_1684) <> true) then
                                                            0
                                                        else
                                                            {1462}let (=OpenSecureChannelResponse,Ns_1692: bitstring,ST_1693: bitstring,TTL_1694: bitstring) = m2_1691 in
                                                            {1463}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1464}event endCli(Sess,Cli,Ns_1692)
                                                )
                                                else
                                                    {1465}let pkSess_1695: bitstring = fail-any in
                                                    {1466}out(c, GetEndpointRequest);
                                                    {1467}in(c, (=GetEndpointResponse,=pkSess_1695,=Sign,SP_1696: bitstring,UP_1697: bitstring));
                                                    {1468}new Nc_1698: bitstring;
                                                    {1469}let m1_1699: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1698) in
                                                    {1470}event beginCli(Cli,Sess,Nc_1698);
                                                    {1471}out(c, (pkCli_1645,m1_1699,sign(h(m1_1699),skCli_1644)));
                                                    {1472}in(c, (em2_1700: bitstring,sigM2_1701: bitstring));
                                                    {1473}let m2_1702: bitstring = em2_1700 in
                                                    {1474}if (verify(h(m2_1702),sigM2_1701,pkSess_1695) <> true) then
                                                        0
                                                    else
                                                        {1475}let (=OpenSecureChannelResponse,Ns_1703: bitstring,ST_1704: bitstring,TTL_1705: bitstring) = m2_1702 in
                                                        {1476}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1477}event endCli(Sess,Cli,Ns_1703)
                                        )
                                        else
                                            {1478}let pkSess_1706: bitstring = fail-any in
                                            {1479}out(c, GetEndpointRequest);
                                            {1480}in(c, (=GetEndpointResponse,=pkSess_1706,=Sign,SP_1707: bitstring,UP_1708: bitstring));
                                            {1481}new Nc_1709: bitstring;
                                            {1482}let m1_1710: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1709) in
                                            {1483}event beginCli(Cli,Sess,Nc_1709);
                                            {1484}out(c, (pkCli_1645,m1_1710,sign(h(m1_1710),skCli_1644)));
                                            {1485}in(c, (em2_1711: bitstring,sigM2_1712: bitstring));
                                            {1486}let m2_1713: bitstring = em2_1711 in
                                            {1487}if (verify(h(m2_1713),sigM2_1712,pkSess_1706) <> true) then
                                                0
                                            else
                                                {1488}let (=OpenSecureChannelResponse,Ns_1714: bitstring,ST_1715: bitstring,TTL_1716: bitstring) = m2_1713 in
                                                {1489}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1490}event endCli(Sess,Cli,Ns_1714)
                                )
                                else
                                    {1491}let pkSess_1717: bitstring = fail-any in
                                    {1492}out(c, GetEndpointRequest);
                                    {1493}in(c, (=GetEndpointResponse,=pkSess_1717,=Sign,SP_1718: bitstring,UP_1719: bitstring));
                                    {1494}new Nc_1720: bitstring;
                                    {1495}let m1_1721: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1720) in
                                    {1496}event beginCli(Cli,Sess,Nc_1720);
                                    {1497}out(c, (pkCli_1645,m1_1721,sign(h(m1_1721),skCli_1644)));
                                    {1498}in(c, (em2_1722: bitstring,sigM2_1723: bitstring));
                                    {1499}let m2_1724: bitstring = em2_1722 in
                                    {1500}if (verify(h(m2_1724),sigM2_1723,pkSess_1717) <> true) then
                                        0
                                    else
                                        {1501}let (=OpenSecureChannelResponse,Ns_1725: bitstring,ST_1726: bitstring,TTL_1727: bitstring) = m2_1724 in
                                        {1502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1503}event endCli(Sess,Cli,Ns_1725)
                            )
                            else
                                {1504}let v_1728: bool = (Disco = B) in
                                (
                                    {1505}if v_1728 then
                                    (
                                        {1506}let pkDisco_1729: bitstring = pub(skB) in
                                        {1507}let v_1730: bool = (Sess = A) in
                                        (
                                            {1508}if v_1730 then
                                            (
                                                {1509}let pkSess_1731: bitstring = pub(skA) in
                                                {1510}out(c, GetEndpointRequest);
                                                {1511}in(c, (=GetEndpointResponse,=pkSess_1731,=Sign,SP_1732: bitstring,UP_1733: bitstring));
                                                {1512}new Nc_1734: bitstring;
                                                {1513}let m1_1735: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1734) in
                                                {1514}event beginCli(Cli,Sess,Nc_1734);
                                                {1515}out(c, (pkCli_1645,m1_1735,sign(h(m1_1735),skCli_1644)));
                                                {1516}in(c, (em2_1736: bitstring,sigM2_1737: bitstring));
                                                {1517}let m2_1738: bitstring = em2_1736 in
                                                {1518}if (verify(h(m2_1738),sigM2_1737,pkSess_1731) <> true) then
                                                    0
                                                else
                                                    {1519}let (=OpenSecureChannelResponse,Ns_1739: bitstring,ST_1740: bitstring,TTL_1741: bitstring) = m2_1738 in
                                                    {1520}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1521}event endCli(Sess,Cli,Ns_1739)
                                            )
                                            else
                                                {1522}let v_1742: bool = (Sess = B) in
                                                (
                                                    {1523}if v_1742 then
                                                    (
                                                        {1524}let pkSess_1743: bitstring = pub(skB) in
                                                        {1525}out(c, GetEndpointRequest);
                                                        {1526}in(c, (=GetEndpointResponse,=pkSess_1743,=Sign,SP_1744: bitstring,UP_1745: bitstring));
                                                        {1527}new Nc_1746: bitstring;
                                                        {1528}let m1_1747: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1746) in
                                                        {1529}event beginCli(Cli,Sess,Nc_1746);
                                                        {1530}out(c, (pkCli_1645,m1_1747,sign(h(m1_1747),skCli_1644)));
                                                        {1531}in(c, (em2_1748: bitstring,sigM2_1749: bitstring));
                                                        {1532}let m2_1750: bitstring = em2_1748 in
                                                        {1533}if (verify(h(m2_1750),sigM2_1749,pkSess_1743) <> true) then
                                                            0
                                                        else
                                                            {1534}let (=OpenSecureChannelResponse,Ns_1751: bitstring,ST_1752: bitstring,TTL_1753: bitstring) = m2_1750 in
                                                            {1535}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1536}event endCli(Sess,Cli,Ns_1751)
                                                    )
                                                    else
                                                        {1537}let v_1754: bool = (Sess = C) in
                                                        (
                                                            {1538}if v_1754 then
                                                            (
                                                                {1539}let pkSess_1755: bitstring = pub(skC) in
                                                                {1540}out(c, GetEndpointRequest);
                                                                {1541}in(c, (=GetEndpointResponse,=pkSess_1755,=Sign,SP_1756: bitstring,UP_1757: bitstring));
                                                                {1542}new Nc_1758: bitstring;
                                                                {1543}let m1_1759: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1758) in
                                                                {1544}event beginCli(Cli,Sess,Nc_1758);
                                                                {1545}out(c, (pkCli_1645,m1_1759,sign(h(m1_1759),skCli_1644)));
                                                                {1546}in(c, (em2_1760: bitstring,sigM2_1761: bitstring));
                                                                {1547}let m2_1762: bitstring = em2_1760 in
                                                                {1548}if (verify(h(m2_1762),sigM2_1761,pkSess_1755) <> true) then
                                                                    0
                                                                else
                                                                    {1549}let (=OpenSecureChannelResponse,Ns_1763: bitstring,ST_1764: bitstring,TTL_1765: bitstring) = m2_1762 in
                                                                    {1550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1551}event endCli(Sess,Cli,Ns_1763)
                                                            )
                                                            else
                                                                {1552}let pkSess_1766: bitstring = pub(sk(Sess)) in
                                                                {1553}out(c, GetEndpointRequest);
                                                                {1554}in(c, (=GetEndpointResponse,=pkSess_1766,=Sign,SP_1767: bitstring,UP_1768: bitstring));
                                                                {1555}new Nc_1769: bitstring;
                                                                {1556}let m1_1770: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1769) in
                                                                {1557}event beginCli(Cli,Sess,Nc_1769);
                                                                {1558}out(c, (pkCli_1645,m1_1770,sign(h(m1_1770),skCli_1644)));
                                                                {1559}in(c, (em2_1771: bitstring,sigM2_1772: bitstring));
                                                                {1560}let m2_1773: bitstring = em2_1771 in
                                                                {1561}if (verify(h(m2_1773),sigM2_1772,pkSess_1766) <> true) then
                                                                    0
                                                                else
                                                                    {1562}let (=OpenSecureChannelResponse,Ns_1774: bitstring,ST_1775: bitstring,TTL_1776: bitstring) = m2_1773 in
                                                                    {1563}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1564}event endCli(Sess,Cli,Ns_1774)
                                                        )
                                                        else
                                                            {1565}let pkSess_1777: bitstring = fail-any in
                                                            {1566}out(c, GetEndpointRequest);
                                                            {1567}in(c, (=GetEndpointResponse,=pkSess_1777,=Sign,SP_1778: bitstring,UP_1779: bitstring));
                                                            {1568}new Nc_1780: bitstring;
                                                            {1569}let m1_1781: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1780) in
                                                            {1570}event beginCli(Cli,Sess,Nc_1780);
                                                            {1571}out(c, (pkCli_1645,m1_1781,sign(h(m1_1781),skCli_1644)));
                                                            {1572}in(c, (em2_1782: bitstring,sigM2_1783: bitstring));
                                                            {1573}let m2_1784: bitstring = em2_1782 in
                                                            {1574}if (verify(h(m2_1784),sigM2_1783,pkSess_1777) <> true) then
                                                                0
                                                            else
                                                                {1575}let (=OpenSecureChannelResponse,Ns_1785: bitstring,ST_1786: bitstring,TTL_1787: bitstring) = m2_1784 in
                                                                {1576}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1577}event endCli(Sess,Cli,Ns_1785)
                                                )
                                                else
                                                    {1578}let pkSess_1788: bitstring = fail-any in
                                                    {1579}out(c, GetEndpointRequest);
                                                    {1580}in(c, (=GetEndpointResponse,=pkSess_1788,=Sign,SP_1789: bitstring,UP_1790: bitstring));
                                                    {1581}new Nc_1791: bitstring;
                                                    {1582}let m1_1792: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1791) in
                                                    {1583}event beginCli(Cli,Sess,Nc_1791);
                                                    {1584}out(c, (pkCli_1645,m1_1792,sign(h(m1_1792),skCli_1644)));
                                                    {1585}in(c, (em2_1793: bitstring,sigM2_1794: bitstring));
                                                    {1586}let m2_1795: bitstring = em2_1793 in
                                                    {1587}if (verify(h(m2_1795),sigM2_1794,pkSess_1788) <> true) then
                                                        0
                                                    else
                                                        {1588}let (=OpenSecureChannelResponse,Ns_1796: bitstring,ST_1797: bitstring,TTL_1798: bitstring) = m2_1795 in
                                                        {1589}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1590}event endCli(Sess,Cli,Ns_1796)
                                        )
                                        else
                                            {1591}let pkSess_1799: bitstring = fail-any in
                                            {1592}out(c, GetEndpointRequest);
                                            {1593}in(c, (=GetEndpointResponse,=pkSess_1799,=Sign,SP_1800: bitstring,UP_1801: bitstring));
                                            {1594}new Nc_1802: bitstring;
                                            {1595}let m1_1803: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1802) in
                                            {1596}event beginCli(Cli,Sess,Nc_1802);
                                            {1597}out(c, (pkCli_1645,m1_1803,sign(h(m1_1803),skCli_1644)));
                                            {1598}in(c, (em2_1804: bitstring,sigM2_1805: bitstring));
                                            {1599}let m2_1806: bitstring = em2_1804 in
                                            {1600}if (verify(h(m2_1806),sigM2_1805,pkSess_1799) <> true) then
                                                0
                                            else
                                                {1601}let (=OpenSecureChannelResponse,Ns_1807: bitstring,ST_1808: bitstring,TTL_1809: bitstring) = m2_1806 in
                                                {1602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1603}event endCli(Sess,Cli,Ns_1807)
                                    )
                                    else
                                        {1604}let v_1810: bool = (Disco = C) in
                                        (
                                            {1605}if v_1810 then
                                            (
                                                {1606}let pkDisco_1811: bitstring = pub(skC) in
                                                {1607}let v_1812: bool = (Sess = A) in
                                                (
                                                    {1608}if v_1812 then
                                                    (
                                                        {1609}let pkSess_1813: bitstring = pub(skA) in
                                                        {1610}out(c, GetEndpointRequest);
                                                        {1611}in(c, (=GetEndpointResponse,=pkSess_1813,=Sign,SP_1814: bitstring,UP_1815: bitstring));
                                                        {1612}new Nc_1816: bitstring;
                                                        {1613}let m1_1817: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1816) in
                                                        {1614}event beginCli(Cli,Sess,Nc_1816);
                                                        {1615}out(c, (pkCli_1645,m1_1817,sign(h(m1_1817),skCli_1644)));
                                                        {1616}in(c, (em2_1818: bitstring,sigM2_1819: bitstring));
                                                        {1617}let m2_1820: bitstring = em2_1818 in
                                                        {1618}if (verify(h(m2_1820),sigM2_1819,pkSess_1813) <> true) then
                                                            0
                                                        else
                                                            {1619}let (=OpenSecureChannelResponse,Ns_1821: bitstring,ST_1822: bitstring,TTL_1823: bitstring) = m2_1820 in
                                                            {1620}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1621}event endCli(Sess,Cli,Ns_1821)
                                                    )
                                                    else
                                                        {1622}let v_1824: bool = (Sess = B) in
                                                        (
                                                            {1623}if v_1824 then
                                                            (
                                                                {1624}let pkSess_1825: bitstring = pub(skB) in
                                                                {1625}out(c, GetEndpointRequest);
                                                                {1626}in(c, (=GetEndpointResponse,=pkSess_1825,=Sign,SP_1826: bitstring,UP_1827: bitstring));
                                                                {1627}new Nc_1828: bitstring;
                                                                {1628}let m1_1829: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1828) in
                                                                {1629}event beginCli(Cli,Sess,Nc_1828);
                                                                {1630}out(c, (pkCli_1645,m1_1829,sign(h(m1_1829),skCli_1644)));
                                                                {1631}in(c, (em2_1830: bitstring,sigM2_1831: bitstring));
                                                                {1632}let m2_1832: bitstring = em2_1830 in
                                                                {1633}if (verify(h(m2_1832),sigM2_1831,pkSess_1825) <> true) then
                                                                    0
                                                                else
                                                                    {1634}let (=OpenSecureChannelResponse,Ns_1833: bitstring,ST_1834: bitstring,TTL_1835: bitstring) = m2_1832 in
                                                                    {1635}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1636}event endCli(Sess,Cli,Ns_1833)
                                                            )
                                                            else
                                                                {1637}let v_1836: bool = (Sess = C) in
                                                                (
                                                                    {1638}if v_1836 then
                                                                    (
                                                                        {1639}let pkSess_1837: bitstring = pub(skC) in
                                                                        {1640}out(c, GetEndpointRequest);
                                                                        {1641}in(c, (=GetEndpointResponse,=pkSess_1837,=Sign,SP_1838: bitstring,UP_1839: bitstring));
                                                                        {1642}new Nc_1840: bitstring;
                                                                        {1643}let m1_1841: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1840) in
                                                                        {1644}event beginCli(Cli,Sess,Nc_1840);
                                                                        {1645}out(c, (pkCli_1645,m1_1841,sign(h(m1_1841),skCli_1644)));
                                                                        {1646}in(c, (em2_1842: bitstring,sigM2_1843: bitstring));
                                                                        {1647}let m2_1844: bitstring = em2_1842 in
                                                                        {1648}if (verify(h(m2_1844),sigM2_1843,pkSess_1837) <> true) then
                                                                            0
                                                                        else
                                                                            {1649}let (=OpenSecureChannelResponse,Ns_1845: bitstring,ST_1846: bitstring,TTL_1847: bitstring) = m2_1844 in
                                                                            {1650}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1651}event endCli(Sess,Cli,Ns_1845)
                                                                    )
                                                                    else
                                                                        {1652}let pkSess_1848: bitstring = pub(sk(Sess)) in
                                                                        {1653}out(c, GetEndpointRequest);
                                                                        {1654}in(c, (=GetEndpointResponse,=pkSess_1848,=Sign,SP_1849: bitstring,UP_1850: bitstring));
                                                                        {1655}new Nc_1851: bitstring;
                                                                        {1656}let m1_1852: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1851) in
                                                                        {1657}event beginCli(Cli,Sess,Nc_1851);
                                                                        {1658}out(c, (pkCli_1645,m1_1852,sign(h(m1_1852),skCli_1644)));
                                                                        {1659}in(c, (em2_1853: bitstring,sigM2_1854: bitstring));
                                                                        {1660}let m2_1855: bitstring = em2_1853 in
                                                                        {1661}if (verify(h(m2_1855),sigM2_1854,pkSess_1848) <> true) then
                                                                            0
                                                                        else
                                                                            {1662}let (=OpenSecureChannelResponse,Ns_1856: bitstring,ST_1857: bitstring,TTL_1858: bitstring) = m2_1855 in
                                                                            {1663}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1664}event endCli(Sess,Cli,Ns_1856)
                                                                )
                                                                else
                                                                    {1665}let pkSess_1859: bitstring = fail-any in
                                                                    {1666}out(c, GetEndpointRequest);
                                                                    {1667}in(c, (=GetEndpointResponse,=pkSess_1859,=Sign,SP_1860: bitstring,UP_1861: bitstring));
                                                                    {1668}new Nc_1862: bitstring;
                                                                    {1669}let m1_1863: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1862) in
                                                                    {1670}event beginCli(Cli,Sess,Nc_1862);
                                                                    {1671}out(c, (pkCli_1645,m1_1863,sign(h(m1_1863),skCli_1644)));
                                                                    {1672}in(c, (em2_1864: bitstring,sigM2_1865: bitstring));
                                                                    {1673}let m2_1866: bitstring = em2_1864 in
                                                                    {1674}if (verify(h(m2_1866),sigM2_1865,pkSess_1859) <> true) then
                                                                        0
                                                                    else
                                                                        {1675}let (=OpenSecureChannelResponse,Ns_1867: bitstring,ST_1868: bitstring,TTL_1869: bitstring) = m2_1866 in
                                                                        {1676}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1677}event endCli(Sess,Cli,Ns_1867)
                                                        )
                                                        else
                                                            {1678}let pkSess_1870: bitstring = fail-any in
                                                            {1679}out(c, GetEndpointRequest);
                                                            {1680}in(c, (=GetEndpointResponse,=pkSess_1870,=Sign,SP_1871: bitstring,UP_1872: bitstring));
                                                            {1681}new Nc_1873: bitstring;
                                                            {1682}let m1_1874: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1873) in
                                                            {1683}event beginCli(Cli,Sess,Nc_1873);
                                                            {1684}out(c, (pkCli_1645,m1_1874,sign(h(m1_1874),skCli_1644)));
                                                            {1685}in(c, (em2_1875: bitstring,sigM2_1876: bitstring));
                                                            {1686}let m2_1877: bitstring = em2_1875 in
                                                            {1687}if (verify(h(m2_1877),sigM2_1876,pkSess_1870) <> true) then
                                                                0
                                                            else
                                                                {1688}let (=OpenSecureChannelResponse,Ns_1878: bitstring,ST_1879: bitstring,TTL_1880: bitstring) = m2_1877 in
                                                                {1689}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1690}event endCli(Sess,Cli,Ns_1878)
                                                )
                                                else
                                                    {1691}let pkSess_1881: bitstring = fail-any in
                                                    {1692}out(c, GetEndpointRequest);
                                                    {1693}in(c, (=GetEndpointResponse,=pkSess_1881,=Sign,SP_1882: bitstring,UP_1883: bitstring));
                                                    {1694}new Nc_1884: bitstring;
                                                    {1695}let m1_1885: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1884) in
                                                    {1696}event beginCli(Cli,Sess,Nc_1884);
                                                    {1697}out(c, (pkCli_1645,m1_1885,sign(h(m1_1885),skCli_1644)));
                                                    {1698}in(c, (em2_1886: bitstring,sigM2_1887: bitstring));
                                                    {1699}let m2_1888: bitstring = em2_1886 in
                                                    {1700}if (verify(h(m2_1888),sigM2_1887,pkSess_1881) <> true) then
                                                        0
                                                    else
                                                        {1701}let (=OpenSecureChannelResponse,Ns_1889: bitstring,ST_1890: bitstring,TTL_1891: bitstring) = m2_1888 in
                                                        {1702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1703}event endCli(Sess,Cli,Ns_1889)
                                            )
                                            else
                                                {1704}let pkDisco_1892: bitstring = pub(sk(Disco)) in
                                                {1705}let v_1893: bool = (Sess = A) in
                                                (
                                                    {1706}if v_1893 then
                                                    (
                                                        {1707}let pkSess_1894: bitstring = pub(skA) in
                                                        {1708}out(c, GetEndpointRequest);
                                                        {1709}in(c, (=GetEndpointResponse,=pkSess_1894,=Sign,SP_1895: bitstring,UP_1896: bitstring));
                                                        {1710}new Nc_1897: bitstring;
                                                        {1711}let m1_1898: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1897) in
                                                        {1712}event beginCli(Cli,Sess,Nc_1897);
                                                        {1713}out(c, (pkCli_1645,m1_1898,sign(h(m1_1898),skCli_1644)));
                                                        {1714}in(c, (em2_1899: bitstring,sigM2_1900: bitstring));
                                                        {1715}let m2_1901: bitstring = em2_1899 in
                                                        {1716}if (verify(h(m2_1901),sigM2_1900,pkSess_1894) <> true) then
                                                            0
                                                        else
                                                            {1717}let (=OpenSecureChannelResponse,Ns_1902: bitstring,ST_1903: bitstring,TTL_1904: bitstring) = m2_1901 in
                                                            {1718}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1719}event endCli(Sess,Cli,Ns_1902)
                                                    )
                                                    else
                                                        {1720}let v_1905: bool = (Sess = B) in
                                                        (
                                                            {1721}if v_1905 then
                                                            (
                                                                {1722}let pkSess_1906: bitstring = pub(skB) in
                                                                {1723}out(c, GetEndpointRequest);
                                                                {1724}in(c, (=GetEndpointResponse,=pkSess_1906,=Sign,SP_1907: bitstring,UP_1908: bitstring));
                                                                {1725}new Nc_1909: bitstring;
                                                                {1726}let m1_1910: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1909) in
                                                                {1727}event beginCli(Cli,Sess,Nc_1909);
                                                                {1728}out(c, (pkCli_1645,m1_1910,sign(h(m1_1910),skCli_1644)));
                                                                {1729}in(c, (em2_1911: bitstring,sigM2_1912: bitstring));
                                                                {1730}let m2_1913: bitstring = em2_1911 in
                                                                {1731}if (verify(h(m2_1913),sigM2_1912,pkSess_1906) <> true) then
                                                                    0
                                                                else
                                                                    {1732}let (=OpenSecureChannelResponse,Ns_1914: bitstring,ST_1915: bitstring,TTL_1916: bitstring) = m2_1913 in
                                                                    {1733}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1734}event endCli(Sess,Cli,Ns_1914)
                                                            )
                                                            else
                                                                {1735}let v_1917: bool = (Sess = C) in
                                                                (
                                                                    {1736}if v_1917 then
                                                                    (
                                                                        {1737}let pkSess_1918: bitstring = pub(skC) in
                                                                        {1738}out(c, GetEndpointRequest);
                                                                        {1739}in(c, (=GetEndpointResponse,=pkSess_1918,=Sign,SP_1919: bitstring,UP_1920: bitstring));
                                                                        {1740}new Nc_1921: bitstring;
                                                                        {1741}let m1_1922: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1921) in
                                                                        {1742}event beginCli(Cli,Sess,Nc_1921);
                                                                        {1743}out(c, (pkCli_1645,m1_1922,sign(h(m1_1922),skCli_1644)));
                                                                        {1744}in(c, (em2_1923: bitstring,sigM2_1924: bitstring));
                                                                        {1745}let m2_1925: bitstring = em2_1923 in
                                                                        {1746}if (verify(h(m2_1925),sigM2_1924,pkSess_1918) <> true) then
                                                                            0
                                                                        else
                                                                            {1747}let (=OpenSecureChannelResponse,Ns_1926: bitstring,ST_1927: bitstring,TTL_1928: bitstring) = m2_1925 in
                                                                            {1748}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1749}event endCli(Sess,Cli,Ns_1926)
                                                                    )
                                                                    else
                                                                        {1750}let pkSess_1929: bitstring = pub(sk(Sess)) in
                                                                        {1751}out(c, GetEndpointRequest);
                                                                        {1752}in(c, (=GetEndpointResponse,=pkSess_1929,=Sign,SP_1930: bitstring,UP_1931: bitstring));
                                                                        {1753}new Nc_1932: bitstring;
                                                                        {1754}let m1_1933: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1932) in
                                                                        {1755}event beginCli(Cli,Sess,Nc_1932);
                                                                        {1756}out(c, (pkCli_1645,m1_1933,sign(h(m1_1933),skCli_1644)));
                                                                        {1757}in(c, (em2_1934: bitstring,sigM2_1935: bitstring));
                                                                        {1758}let m2_1936: bitstring = em2_1934 in
                                                                        {1759}if (verify(h(m2_1936),sigM2_1935,pkSess_1929) <> true) then
                                                                            0
                                                                        else
                                                                            {1760}let (=OpenSecureChannelResponse,Ns_1937: bitstring,ST_1938: bitstring,TTL_1939: bitstring) = m2_1936 in
                                                                            {1761}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1762}event endCli(Sess,Cli,Ns_1937)
                                                                )
                                                                else
                                                                    {1763}let pkSess_1940: bitstring = fail-any in
                                                                    {1764}out(c, GetEndpointRequest);
                                                                    {1765}in(c, (=GetEndpointResponse,=pkSess_1940,=Sign,SP_1941: bitstring,UP_1942: bitstring));
                                                                    {1766}new Nc_1943: bitstring;
                                                                    {1767}let m1_1944: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1943) in
                                                                    {1768}event beginCli(Cli,Sess,Nc_1943);
                                                                    {1769}out(c, (pkCli_1645,m1_1944,sign(h(m1_1944),skCli_1644)));
                                                                    {1770}in(c, (em2_1945: bitstring,sigM2_1946: bitstring));
                                                                    {1771}let m2_1947: bitstring = em2_1945 in
                                                                    {1772}if (verify(h(m2_1947),sigM2_1946,pkSess_1940) <> true) then
                                                                        0
                                                                    else
                                                                        {1773}let (=OpenSecureChannelResponse,Ns_1948: bitstring,ST_1949: bitstring,TTL_1950: bitstring) = m2_1947 in
                                                                        {1774}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1775}event endCli(Sess,Cli,Ns_1948)
                                                        )
                                                        else
                                                            {1776}let pkSess_1951: bitstring = fail-any in
                                                            {1777}out(c, GetEndpointRequest);
                                                            {1778}in(c, (=GetEndpointResponse,=pkSess_1951,=Sign,SP_1952: bitstring,UP_1953: bitstring));
                                                            {1779}new Nc_1954: bitstring;
                                                            {1780}let m1_1955: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1954) in
                                                            {1781}event beginCli(Cli,Sess,Nc_1954);
                                                            {1782}out(c, (pkCli_1645,m1_1955,sign(h(m1_1955),skCli_1644)));
                                                            {1783}in(c, (em2_1956: bitstring,sigM2_1957: bitstring));
                                                            {1784}let m2_1958: bitstring = em2_1956 in
                                                            {1785}if (verify(h(m2_1958),sigM2_1957,pkSess_1951) <> true) then
                                                                0
                                                            else
                                                                {1786}let (=OpenSecureChannelResponse,Ns_1959: bitstring,ST_1960: bitstring,TTL_1961: bitstring) = m2_1958 in
                                                                {1787}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1788}event endCli(Sess,Cli,Ns_1959)
                                                )
                                                else
                                                    {1789}let pkSess_1962: bitstring = fail-any in
                                                    {1790}out(c, GetEndpointRequest);
                                                    {1791}in(c, (=GetEndpointResponse,=pkSess_1962,=Sign,SP_1963: bitstring,UP_1964: bitstring));
                                                    {1792}new Nc_1965: bitstring;
                                                    {1793}let m1_1966: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1965) in
                                                    {1794}event beginCli(Cli,Sess,Nc_1965);
                                                    {1795}out(c, (pkCli_1645,m1_1966,sign(h(m1_1966),skCli_1644)));
                                                    {1796}in(c, (em2_1967: bitstring,sigM2_1968: bitstring));
                                                    {1797}let m2_1969: bitstring = em2_1967 in
                                                    {1798}if (verify(h(m2_1969),sigM2_1968,pkSess_1962) <> true) then
                                                        0
                                                    else
                                                        {1799}let (=OpenSecureChannelResponse,Ns_1970: bitstring,ST_1971: bitstring,TTL_1972: bitstring) = m2_1969 in
                                                        {1800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1801}event endCli(Sess,Cli,Ns_1970)
                                        )
                                        else
                                            {1802}let pkDisco_1973: bitstring = fail-any in
                                            {1803}let v_1974: bool = (Sess = A) in
                                            (
                                                {1804}if v_1974 then
                                                (
                                                    {1805}let pkSess_1975: bitstring = pub(skA) in
                                                    {1806}out(c, GetEndpointRequest);
                                                    {1807}in(c, (=GetEndpointResponse,=pkSess_1975,=Sign,SP_1976: bitstring,UP_1977: bitstring));
                                                    {1808}new Nc_1978: bitstring;
                                                    {1809}let m1_1979: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1978) in
                                                    {1810}event beginCli(Cli,Sess,Nc_1978);
                                                    {1811}out(c, (pkCli_1645,m1_1979,sign(h(m1_1979),skCli_1644)));
                                                    {1812}in(c, (em2_1980: bitstring,sigM2_1981: bitstring));
                                                    {1813}let m2_1982: bitstring = em2_1980 in
                                                    {1814}if (verify(h(m2_1982),sigM2_1981,pkSess_1975) <> true) then
                                                        0
                                                    else
                                                        {1815}let (=OpenSecureChannelResponse,Ns_1983: bitstring,ST_1984: bitstring,TTL_1985: bitstring) = m2_1982 in
                                                        {1816}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1817}event endCli(Sess,Cli,Ns_1983)
                                                )
                                                else
                                                    {1818}let v_1986: bool = (Sess = B) in
                                                    (
                                                        {1819}if v_1986 then
                                                        (
                                                            {1820}let pkSess_1987: bitstring = pub(skB) in
                                                            {1821}out(c, GetEndpointRequest);
                                                            {1822}in(c, (=GetEndpointResponse,=pkSess_1987,=Sign,SP_1988: bitstring,UP_1989: bitstring));
                                                            {1823}new Nc_1990: bitstring;
                                                            {1824}let m1_1991: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_1990) in
                                                            {1825}event beginCli(Cli,Sess,Nc_1990);
                                                            {1826}out(c, (pkCli_1645,m1_1991,sign(h(m1_1991),skCli_1644)));
                                                            {1827}in(c, (em2_1992: bitstring,sigM2_1993: bitstring));
                                                            {1828}let m2_1994: bitstring = em2_1992 in
                                                            {1829}if (verify(h(m2_1994),sigM2_1993,pkSess_1987) <> true) then
                                                                0
                                                            else
                                                                {1830}let (=OpenSecureChannelResponse,Ns_1995: bitstring,ST_1996: bitstring,TTL_1997: bitstring) = m2_1994 in
                                                                {1831}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1832}event endCli(Sess,Cli,Ns_1995)
                                                        )
                                                        else
                                                            {1833}let v_1998: bool = (Sess = C) in
                                                            (
                                                                {1834}if v_1998 then
                                                                (
                                                                    {1835}let pkSess_1999: bitstring = pub(skC) in
                                                                    {1836}out(c, GetEndpointRequest);
                                                                    {1837}in(c, (=GetEndpointResponse,=pkSess_1999,=Sign,SP_2000: bitstring,UP_2001: bitstring));
                                                                    {1838}new Nc_2002: bitstring;
                                                                    {1839}let m1_2003: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2002) in
                                                                    {1840}event beginCli(Cli,Sess,Nc_2002);
                                                                    {1841}out(c, (pkCli_1645,m1_2003,sign(h(m1_2003),skCli_1644)));
                                                                    {1842}in(c, (em2_2004: bitstring,sigM2_2005: bitstring));
                                                                    {1843}let m2_2006: bitstring = em2_2004 in
                                                                    {1844}if (verify(h(m2_2006),sigM2_2005,pkSess_1999) <> true) then
                                                                        0
                                                                    else
                                                                        {1845}let (=OpenSecureChannelResponse,Ns_2007: bitstring,ST_2008: bitstring,TTL_2009: bitstring) = m2_2006 in
                                                                        {1846}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1847}event endCli(Sess,Cli,Ns_2007)
                                                                )
                                                                else
                                                                    {1848}let pkSess_2010: bitstring = pub(sk(Sess)) in
                                                                    {1849}out(c, GetEndpointRequest);
                                                                    {1850}in(c, (=GetEndpointResponse,=pkSess_2010,=Sign,SP_2011: bitstring,UP_2012: bitstring));
                                                                    {1851}new Nc_2013: bitstring;
                                                                    {1852}let m1_2014: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2013) in
                                                                    {1853}event beginCli(Cli,Sess,Nc_2013);
                                                                    {1854}out(c, (pkCli_1645,m1_2014,sign(h(m1_2014),skCli_1644)));
                                                                    {1855}in(c, (em2_2015: bitstring,sigM2_2016: bitstring));
                                                                    {1856}let m2_2017: bitstring = em2_2015 in
                                                                    {1857}if (verify(h(m2_2017),sigM2_2016,pkSess_2010) <> true) then
                                                                        0
                                                                    else
                                                                        {1858}let (=OpenSecureChannelResponse,Ns_2018: bitstring,ST_2019: bitstring,TTL_2020: bitstring) = m2_2017 in
                                                                        {1859}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1860}event endCli(Sess,Cli,Ns_2018)
                                                            )
                                                            else
                                                                {1861}let pkSess_2021: bitstring = fail-any in
                                                                {1862}out(c, GetEndpointRequest);
                                                                {1863}in(c, (=GetEndpointResponse,=pkSess_2021,=Sign,SP_2022: bitstring,UP_2023: bitstring));
                                                                {1864}new Nc_2024: bitstring;
                                                                {1865}let m1_2025: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2024) in
                                                                {1866}event beginCli(Cli,Sess,Nc_2024);
                                                                {1867}out(c, (pkCli_1645,m1_2025,sign(h(m1_2025),skCli_1644)));
                                                                {1868}in(c, (em2_2026: bitstring,sigM2_2027: bitstring));
                                                                {1869}let m2_2028: bitstring = em2_2026 in
                                                                {1870}if (verify(h(m2_2028),sigM2_2027,pkSess_2021) <> true) then
                                                                    0
                                                                else
                                                                    {1871}let (=OpenSecureChannelResponse,Ns_2029: bitstring,ST_2030: bitstring,TTL_2031: bitstring) = m2_2028 in
                                                                    {1872}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1873}event endCli(Sess,Cli,Ns_2029)
                                                    )
                                                    else
                                                        {1874}let pkSess_2032: bitstring = fail-any in
                                                        {1875}out(c, GetEndpointRequest);
                                                        {1876}in(c, (=GetEndpointResponse,=pkSess_2032,=Sign,SP_2033: bitstring,UP_2034: bitstring));
                                                        {1877}new Nc_2035: bitstring;
                                                        {1878}let m1_2036: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2035) in
                                                        {1879}event beginCli(Cli,Sess,Nc_2035);
                                                        {1880}out(c, (pkCli_1645,m1_2036,sign(h(m1_2036),skCli_1644)));
                                                        {1881}in(c, (em2_2037: bitstring,sigM2_2038: bitstring));
                                                        {1882}let m2_2039: bitstring = em2_2037 in
                                                        {1883}if (verify(h(m2_2039),sigM2_2038,pkSess_2032) <> true) then
                                                            0
                                                        else
                                                            {1884}let (=OpenSecureChannelResponse,Ns_2040: bitstring,ST_2041: bitstring,TTL_2042: bitstring) = m2_2039 in
                                                            {1885}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1886}event endCli(Sess,Cli,Ns_2040)
                                            )
                                            else
                                                {1887}let pkSess_2043: bitstring = fail-any in
                                                {1888}out(c, GetEndpointRequest);
                                                {1889}in(c, (=GetEndpointResponse,=pkSess_2043,=Sign,SP_2044: bitstring,UP_2045: bitstring));
                                                {1890}new Nc_2046: bitstring;
                                                {1891}let m1_2047: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2046) in
                                                {1892}event beginCli(Cli,Sess,Nc_2046);
                                                {1893}out(c, (pkCli_1645,m1_2047,sign(h(m1_2047),skCli_1644)));
                                                {1894}in(c, (em2_2048: bitstring,sigM2_2049: bitstring));
                                                {1895}let m2_2050: bitstring = em2_2048 in
                                                {1896}if (verify(h(m2_2050),sigM2_2049,pkSess_2043) <> true) then
                                                    0
                                                else
                                                    {1897}let (=OpenSecureChannelResponse,Ns_2051: bitstring,ST_2052: bitstring,TTL_2053: bitstring) = m2_2050 in
                                                    {1898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1899}event endCli(Sess,Cli,Ns_2051)
                                )
                                else
                                    {1900}let pkDisco_2054: bitstring = fail-any in
                                    {1901}let v_2055: bool = (Sess = A) in
                                    (
                                        {1902}if v_2055 then
                                        (
                                            {1903}let pkSess_2056: bitstring = pub(skA) in
                                            {1904}out(c, GetEndpointRequest);
                                            {1905}in(c, (=GetEndpointResponse,=pkSess_2056,=Sign,SP_2057: bitstring,UP_2058: bitstring));
                                            {1906}new Nc_2059: bitstring;
                                            {1907}let m1_2060: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2059) in
                                            {1908}event beginCli(Cli,Sess,Nc_2059);
                                            {1909}out(c, (pkCli_1645,m1_2060,sign(h(m1_2060),skCli_1644)));
                                            {1910}in(c, (em2_2061: bitstring,sigM2_2062: bitstring));
                                            {1911}let m2_2063: bitstring = em2_2061 in
                                            {1912}if (verify(h(m2_2063),sigM2_2062,pkSess_2056) <> true) then
                                                0
                                            else
                                                {1913}let (=OpenSecureChannelResponse,Ns_2064: bitstring,ST_2065: bitstring,TTL_2066: bitstring) = m2_2063 in
                                                {1914}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1915}event endCli(Sess,Cli,Ns_2064)
                                        )
                                        else
                                            {1916}let v_2067: bool = (Sess = B) in
                                            (
                                                {1917}if v_2067 then
                                                (
                                                    {1918}let pkSess_2068: bitstring = pub(skB) in
                                                    {1919}out(c, GetEndpointRequest);
                                                    {1920}in(c, (=GetEndpointResponse,=pkSess_2068,=Sign,SP_2069: bitstring,UP_2070: bitstring));
                                                    {1921}new Nc_2071: bitstring;
                                                    {1922}let m1_2072: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2071) in
                                                    {1923}event beginCli(Cli,Sess,Nc_2071);
                                                    {1924}out(c, (pkCli_1645,m1_2072,sign(h(m1_2072),skCli_1644)));
                                                    {1925}in(c, (em2_2073: bitstring,sigM2_2074: bitstring));
                                                    {1926}let m2_2075: bitstring = em2_2073 in
                                                    {1927}if (verify(h(m2_2075),sigM2_2074,pkSess_2068) <> true) then
                                                        0
                                                    else
                                                        {1928}let (=OpenSecureChannelResponse,Ns_2076: bitstring,ST_2077: bitstring,TTL_2078: bitstring) = m2_2075 in
                                                        {1929}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1930}event endCli(Sess,Cli,Ns_2076)
                                                )
                                                else
                                                    {1931}let v_2079: bool = (Sess = C) in
                                                    (
                                                        {1932}if v_2079 then
                                                        (
                                                            {1933}let pkSess_2080: bitstring = pub(skC) in
                                                            {1934}out(c, GetEndpointRequest);
                                                            {1935}in(c, (=GetEndpointResponse,=pkSess_2080,=Sign,SP_2081: bitstring,UP_2082: bitstring));
                                                            {1936}new Nc_2083: bitstring;
                                                            {1937}let m1_2084: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2083) in
                                                            {1938}event beginCli(Cli,Sess,Nc_2083);
                                                            {1939}out(c, (pkCli_1645,m1_2084,sign(h(m1_2084),skCli_1644)));
                                                            {1940}in(c, (em2_2085: bitstring,sigM2_2086: bitstring));
                                                            {1941}let m2_2087: bitstring = em2_2085 in
                                                            {1942}if (verify(h(m2_2087),sigM2_2086,pkSess_2080) <> true) then
                                                                0
                                                            else
                                                                {1943}let (=OpenSecureChannelResponse,Ns_2088: bitstring,ST_2089: bitstring,TTL_2090: bitstring) = m2_2087 in
                                                                {1944}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1945}event endCli(Sess,Cli,Ns_2088)
                                                        )
                                                        else
                                                            {1946}let pkSess_2091: bitstring = pub(sk(Sess)) in
                                                            {1947}out(c, GetEndpointRequest);
                                                            {1948}in(c, (=GetEndpointResponse,=pkSess_2091,=Sign,SP_2092: bitstring,UP_2093: bitstring));
                                                            {1949}new Nc_2094: bitstring;
                                                            {1950}let m1_2095: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2094) in
                                                            {1951}event beginCli(Cli,Sess,Nc_2094);
                                                            {1952}out(c, (pkCli_1645,m1_2095,sign(h(m1_2095),skCli_1644)));
                                                            {1953}in(c, (em2_2096: bitstring,sigM2_2097: bitstring));
                                                            {1954}let m2_2098: bitstring = em2_2096 in
                                                            {1955}if (verify(h(m2_2098),sigM2_2097,pkSess_2091) <> true) then
                                                                0
                                                            else
                                                                {1956}let (=OpenSecureChannelResponse,Ns_2099: bitstring,ST_2100: bitstring,TTL_2101: bitstring) = m2_2098 in
                                                                {1957}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1958}event endCli(Sess,Cli,Ns_2099)
                                                    )
                                                    else
                                                        {1959}let pkSess_2102: bitstring = fail-any in
                                                        {1960}out(c, GetEndpointRequest);
                                                        {1961}in(c, (=GetEndpointResponse,=pkSess_2102,=Sign,SP_2103: bitstring,UP_2104: bitstring));
                                                        {1962}new Nc_2105: bitstring;
                                                        {1963}let m1_2106: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2105) in
                                                        {1964}event beginCli(Cli,Sess,Nc_2105);
                                                        {1965}out(c, (pkCli_1645,m1_2106,sign(h(m1_2106),skCli_1644)));
                                                        {1966}in(c, (em2_2107: bitstring,sigM2_2108: bitstring));
                                                        {1967}let m2_2109: bitstring = em2_2107 in
                                                        {1968}if (verify(h(m2_2109),sigM2_2108,pkSess_2102) <> true) then
                                                            0
                                                        else
                                                            {1969}let (=OpenSecureChannelResponse,Ns_2110: bitstring,ST_2111: bitstring,TTL_2112: bitstring) = m2_2109 in
                                                            {1970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1971}event endCli(Sess,Cli,Ns_2110)
                                            )
                                            else
                                                {1972}let pkSess_2113: bitstring = fail-any in
                                                {1973}out(c, GetEndpointRequest);
                                                {1974}in(c, (=GetEndpointResponse,=pkSess_2113,=Sign,SP_2114: bitstring,UP_2115: bitstring));
                                                {1975}new Nc_2116: bitstring;
                                                {1976}let m1_2117: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2116) in
                                                {1977}event beginCli(Cli,Sess,Nc_2116);
                                                {1978}out(c, (pkCli_1645,m1_2117,sign(h(m1_2117),skCli_1644)));
                                                {1979}in(c, (em2_2118: bitstring,sigM2_2119: bitstring));
                                                {1980}let m2_2120: bitstring = em2_2118 in
                                                {1981}if (verify(h(m2_2120),sigM2_2119,pkSess_2113) <> true) then
                                                    0
                                                else
                                                    {1982}let (=OpenSecureChannelResponse,Ns_2121: bitstring,ST_2122: bitstring,TTL_2123: bitstring) = m2_2120 in
                                                    {1983}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1984}event endCli(Sess,Cli,Ns_2121)
                                    )
                                    else
                                        {1985}let pkSess_2124: bitstring = fail-any in
                                        {1986}out(c, GetEndpointRequest);
                                        {1987}in(c, (=GetEndpointResponse,=pkSess_2124,=Sign,SP_2125: bitstring,UP_2126: bitstring));
                                        {1988}new Nc_2127: bitstring;
                                        {1989}let m1_2128: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2127) in
                                        {1990}event beginCli(Cli,Sess,Nc_2127);
                                        {1991}out(c, (pkCli_1645,m1_2128,sign(h(m1_2128),skCli_1644)));
                                        {1992}in(c, (em2_2129: bitstring,sigM2_2130: bitstring));
                                        {1993}let m2_2131: bitstring = em2_2129 in
                                        {1994}if (verify(h(m2_2131),sigM2_2130,pkSess_2124) <> true) then
                                            0
                                        else
                                            {1995}let (=OpenSecureChannelResponse,Ns_2132: bitstring,ST_2133: bitstring,TTL_2134: bitstring) = m2_2131 in
                                            {1996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1997}event endCli(Sess,Cli,Ns_2132)
                        )
                        else
                            {1998}let pkDisco_2135: bitstring = fail-any in
                            {1999}let v_2136: bool = (Sess = A) in
                            (
                                {2000}if v_2136 then
                                (
                                    {2001}let pkSess_2137: bitstring = pub(skA) in
                                    {2002}out(c, GetEndpointRequest);
                                    {2003}in(c, (=GetEndpointResponse,=pkSess_2137,=Sign,SP_2138: bitstring,UP_2139: bitstring));
                                    {2004}new Nc_2140: bitstring;
                                    {2005}let m1_2141: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2140) in
                                    {2006}event beginCli(Cli,Sess,Nc_2140);
                                    {2007}out(c, (pkCli_1645,m1_2141,sign(h(m1_2141),skCli_1644)));
                                    {2008}in(c, (em2_2142: bitstring,sigM2_2143: bitstring));
                                    {2009}let m2_2144: bitstring = em2_2142 in
                                    {2010}if (verify(h(m2_2144),sigM2_2143,pkSess_2137) <> true) then
                                        0
                                    else
                                        {2011}let (=OpenSecureChannelResponse,Ns_2145: bitstring,ST_2146: bitstring,TTL_2147: bitstring) = m2_2144 in
                                        {2012}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2013}event endCli(Sess,Cli,Ns_2145)
                                )
                                else
                                    {2014}let v_2148: bool = (Sess = B) in
                                    (
                                        {2015}if v_2148 then
                                        (
                                            {2016}let pkSess_2149: bitstring = pub(skB) in
                                            {2017}out(c, GetEndpointRequest);
                                            {2018}in(c, (=GetEndpointResponse,=pkSess_2149,=Sign,SP_2150: bitstring,UP_2151: bitstring));
                                            {2019}new Nc_2152: bitstring;
                                            {2020}let m1_2153: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2152) in
                                            {2021}event beginCli(Cli,Sess,Nc_2152);
                                            {2022}out(c, (pkCli_1645,m1_2153,sign(h(m1_2153),skCli_1644)));
                                            {2023}in(c, (em2_2154: bitstring,sigM2_2155: bitstring));
                                            {2024}let m2_2156: bitstring = em2_2154 in
                                            {2025}if (verify(h(m2_2156),sigM2_2155,pkSess_2149) <> true) then
                                                0
                                            else
                                                {2026}let (=OpenSecureChannelResponse,Ns_2157: bitstring,ST_2158: bitstring,TTL_2159: bitstring) = m2_2156 in
                                                {2027}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2028}event endCli(Sess,Cli,Ns_2157)
                                        )
                                        else
                                            {2029}let v_2160: bool = (Sess = C) in
                                            (
                                                {2030}if v_2160 then
                                                (
                                                    {2031}let pkSess_2161: bitstring = pub(skC) in
                                                    {2032}out(c, GetEndpointRequest);
                                                    {2033}in(c, (=GetEndpointResponse,=pkSess_2161,=Sign,SP_2162: bitstring,UP_2163: bitstring));
                                                    {2034}new Nc_2164: bitstring;
                                                    {2035}let m1_2165: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2164) in
                                                    {2036}event beginCli(Cli,Sess,Nc_2164);
                                                    {2037}out(c, (pkCli_1645,m1_2165,sign(h(m1_2165),skCli_1644)));
                                                    {2038}in(c, (em2_2166: bitstring,sigM2_2167: bitstring));
                                                    {2039}let m2_2168: bitstring = em2_2166 in
                                                    {2040}if (verify(h(m2_2168),sigM2_2167,pkSess_2161) <> true) then
                                                        0
                                                    else
                                                        {2041}let (=OpenSecureChannelResponse,Ns_2169: bitstring,ST_2170: bitstring,TTL_2171: bitstring) = m2_2168 in
                                                        {2042}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2043}event endCli(Sess,Cli,Ns_2169)
                                                )
                                                else
                                                    {2044}let pkSess_2172: bitstring = pub(sk(Sess)) in
                                                    {2045}out(c, GetEndpointRequest);
                                                    {2046}in(c, (=GetEndpointResponse,=pkSess_2172,=Sign,SP_2173: bitstring,UP_2174: bitstring));
                                                    {2047}new Nc_2175: bitstring;
                                                    {2048}let m1_2176: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2175) in
                                                    {2049}event beginCli(Cli,Sess,Nc_2175);
                                                    {2050}out(c, (pkCli_1645,m1_2176,sign(h(m1_2176),skCli_1644)));
                                                    {2051}in(c, (em2_2177: bitstring,sigM2_2178: bitstring));
                                                    {2052}let m2_2179: bitstring = em2_2177 in
                                                    {2053}if (verify(h(m2_2179),sigM2_2178,pkSess_2172) <> true) then
                                                        0
                                                    else
                                                        {2054}let (=OpenSecureChannelResponse,Ns_2180: bitstring,ST_2181: bitstring,TTL_2182: bitstring) = m2_2179 in
                                                        {2055}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2056}event endCli(Sess,Cli,Ns_2180)
                                            )
                                            else
                                                {2057}let pkSess_2183: bitstring = fail-any in
                                                {2058}out(c, GetEndpointRequest);
                                                {2059}in(c, (=GetEndpointResponse,=pkSess_2183,=Sign,SP_2184: bitstring,UP_2185: bitstring));
                                                {2060}new Nc_2186: bitstring;
                                                {2061}let m1_2187: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2186) in
                                                {2062}event beginCli(Cli,Sess,Nc_2186);
                                                {2063}out(c, (pkCli_1645,m1_2187,sign(h(m1_2187),skCli_1644)));
                                                {2064}in(c, (em2_2188: bitstring,sigM2_2189: bitstring));
                                                {2065}let m2_2190: bitstring = em2_2188 in
                                                {2066}if (verify(h(m2_2190),sigM2_2189,pkSess_2183) <> true) then
                                                    0
                                                else
                                                    {2067}let (=OpenSecureChannelResponse,Ns_2191: bitstring,ST_2192: bitstring,TTL_2193: bitstring) = m2_2190 in
                                                    {2068}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2069}event endCli(Sess,Cli,Ns_2191)
                                    )
                                    else
                                        {2070}let pkSess_2194: bitstring = fail-any in
                                        {2071}out(c, GetEndpointRequest);
                                        {2072}in(c, (=GetEndpointResponse,=pkSess_2194,=Sign,SP_2195: bitstring,UP_2196: bitstring));
                                        {2073}new Nc_2197: bitstring;
                                        {2074}let m1_2198: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2197) in
                                        {2075}event beginCli(Cli,Sess,Nc_2197);
                                        {2076}out(c, (pkCli_1645,m1_2198,sign(h(m1_2198),skCli_1644)));
                                        {2077}in(c, (em2_2199: bitstring,sigM2_2200: bitstring));
                                        {2078}let m2_2201: bitstring = em2_2199 in
                                        {2079}if (verify(h(m2_2201),sigM2_2200,pkSess_2194) <> true) then
                                            0
                                        else
                                            {2080}let (=OpenSecureChannelResponse,Ns_2202: bitstring,ST_2203: bitstring,TTL_2204: bitstring) = m2_2201 in
                                            {2081}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2082}event endCli(Sess,Cli,Ns_2202)
                            )
                            else
                                {2083}let pkSess_2205: bitstring = fail-any in
                                {2084}out(c, GetEndpointRequest);
                                {2085}in(c, (=GetEndpointResponse,=pkSess_2205,=Sign,SP_2206: bitstring,UP_2207: bitstring));
                                {2086}new Nc_2208: bitstring;
                                {2087}let m1_2209: bitstring = (OpenSecureChannelRequest,pkCli_1645,Nc_2208) in
                                {2088}event beginCli(Cli,Sess,Nc_2208);
                                {2089}out(c, (pkCli_1645,m1_2209,sign(h(m1_2209),skCli_1644)));
                                {2090}in(c, (em2_2210: bitstring,sigM2_2211: bitstring));
                                {2091}let m2_2212: bitstring = em2_2210 in
                                {2092}if (verify(h(m2_2212),sigM2_2211,pkSess_2205) <> true) then
                                    0
                                else
                                    {2093}let (=OpenSecureChannelResponse,Ns_2213: bitstring,ST_2214: bitstring,TTL_2215: bitstring) = m2_2212 in
                                    {2094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2095}event endCli(Sess,Cli,Ns_2213)
                    )
                    else
                        {2096}let skCli_2216: bitstring = fail-any in
                        {2097}let pkCli_2217: bitstring = pub(skCli_2216) in
                        {2098}let v_2218: bool = (Disco = A) in
                        (
                            {2099}if v_2218 then
                            (
                                {2100}let pkDisco_2219: bitstring = pub(skA) in
                                {2101}let v_2220: bool = (Sess = A) in
                                (
                                    {2102}if v_2220 then
                                    (
                                        {2103}let pkSess_2221: bitstring = pub(skA) in
                                        {2104}out(c, GetEndpointRequest);
                                        {2105}in(c, (=GetEndpointResponse,=pkSess_2221,=Sign,SP_2222: bitstring,UP_2223: bitstring));
                                        {2106}new Nc_2224: bitstring;
                                        {2107}let m1_2225: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2224) in
                                        {2108}event beginCli(Cli,Sess,Nc_2224);
                                        {2109}out(c, (pkCli_2217,m1_2225,sign(h(m1_2225),skCli_2216)));
                                        {2110}in(c, (em2_2226: bitstring,sigM2_2227: bitstring));
                                        {2111}let m2_2228: bitstring = em2_2226 in
                                        {2112}if (verify(h(m2_2228),sigM2_2227,pkSess_2221) <> true) then
                                            0
                                        else
                                            {2113}let (=OpenSecureChannelResponse,Ns_2229: bitstring,ST_2230: bitstring,TTL_2231: bitstring) = m2_2228 in
                                            {2114}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2115}event endCli(Sess,Cli,Ns_2229)
                                    )
                                    else
                                        {2116}let v_2232: bool = (Sess = B) in
                                        (
                                            {2117}if v_2232 then
                                            (
                                                {2118}let pkSess_2233: bitstring = pub(skB) in
                                                {2119}out(c, GetEndpointRequest);
                                                {2120}in(c, (=GetEndpointResponse,=pkSess_2233,=Sign,SP_2234: bitstring,UP_2235: bitstring));
                                                {2121}new Nc_2236: bitstring;
                                                {2122}let m1_2237: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2236) in
                                                {2123}event beginCli(Cli,Sess,Nc_2236);
                                                {2124}out(c, (pkCli_2217,m1_2237,sign(h(m1_2237),skCli_2216)));
                                                {2125}in(c, (em2_2238: bitstring,sigM2_2239: bitstring));
                                                {2126}let m2_2240: bitstring = em2_2238 in
                                                {2127}if (verify(h(m2_2240),sigM2_2239,pkSess_2233) <> true) then
                                                    0
                                                else
                                                    {2128}let (=OpenSecureChannelResponse,Ns_2241: bitstring,ST_2242: bitstring,TTL_2243: bitstring) = m2_2240 in
                                                    {2129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2130}event endCli(Sess,Cli,Ns_2241)
                                            )
                                            else
                                                {2131}let v_2244: bool = (Sess = C) in
                                                (
                                                    {2132}if v_2244 then
                                                    (
                                                        {2133}let pkSess_2245: bitstring = pub(skC) in
                                                        {2134}out(c, GetEndpointRequest);
                                                        {2135}in(c, (=GetEndpointResponse,=pkSess_2245,=Sign,SP_2246: bitstring,UP_2247: bitstring));
                                                        {2136}new Nc_2248: bitstring;
                                                        {2137}let m1_2249: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2248) in
                                                        {2138}event beginCli(Cli,Sess,Nc_2248);
                                                        {2139}out(c, (pkCli_2217,m1_2249,sign(h(m1_2249),skCli_2216)));
                                                        {2140}in(c, (em2_2250: bitstring,sigM2_2251: bitstring));
                                                        {2141}let m2_2252: bitstring = em2_2250 in
                                                        {2142}if (verify(h(m2_2252),sigM2_2251,pkSess_2245) <> true) then
                                                            0
                                                        else
                                                            {2143}let (=OpenSecureChannelResponse,Ns_2253: bitstring,ST_2254: bitstring,TTL_2255: bitstring) = m2_2252 in
                                                            {2144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2145}event endCli(Sess,Cli,Ns_2253)
                                                    )
                                                    else
                                                        {2146}let pkSess_2256: bitstring = pub(sk(Sess)) in
                                                        {2147}out(c, GetEndpointRequest);
                                                        {2148}in(c, (=GetEndpointResponse,=pkSess_2256,=Sign,SP_2257: bitstring,UP_2258: bitstring));
                                                        {2149}new Nc_2259: bitstring;
                                                        {2150}let m1_2260: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2259) in
                                                        {2151}event beginCli(Cli,Sess,Nc_2259);
                                                        {2152}out(c, (pkCli_2217,m1_2260,sign(h(m1_2260),skCli_2216)));
                                                        {2153}in(c, (em2_2261: bitstring,sigM2_2262: bitstring));
                                                        {2154}let m2_2263: bitstring = em2_2261 in
                                                        {2155}if (verify(h(m2_2263),sigM2_2262,pkSess_2256) <> true) then
                                                            0
                                                        else
                                                            {2156}let (=OpenSecureChannelResponse,Ns_2264: bitstring,ST_2265: bitstring,TTL_2266: bitstring) = m2_2263 in
                                                            {2157}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2158}event endCli(Sess,Cli,Ns_2264)
                                                )
                                                else
                                                    {2159}let pkSess_2267: bitstring = fail-any in
                                                    {2160}out(c, GetEndpointRequest);
                                                    {2161}in(c, (=GetEndpointResponse,=pkSess_2267,=Sign,SP_2268: bitstring,UP_2269: bitstring));
                                                    {2162}new Nc_2270: bitstring;
                                                    {2163}let m1_2271: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2270) in
                                                    {2164}event beginCli(Cli,Sess,Nc_2270);
                                                    {2165}out(c, (pkCli_2217,m1_2271,sign(h(m1_2271),skCli_2216)));
                                                    {2166}in(c, (em2_2272: bitstring,sigM2_2273: bitstring));
                                                    {2167}let m2_2274: bitstring = em2_2272 in
                                                    {2168}if (verify(h(m2_2274),sigM2_2273,pkSess_2267) <> true) then
                                                        0
                                                    else
                                                        {2169}let (=OpenSecureChannelResponse,Ns_2275: bitstring,ST_2276: bitstring,TTL_2277: bitstring) = m2_2274 in
                                                        {2170}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2171}event endCli(Sess,Cli,Ns_2275)
                                        )
                                        else
                                            {2172}let pkSess_2278: bitstring = fail-any in
                                            {2173}out(c, GetEndpointRequest);
                                            {2174}in(c, (=GetEndpointResponse,=pkSess_2278,=Sign,SP_2279: bitstring,UP_2280: bitstring));
                                            {2175}new Nc_2281: bitstring;
                                            {2176}let m1_2282: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2281) in
                                            {2177}event beginCli(Cli,Sess,Nc_2281);
                                            {2178}out(c, (pkCli_2217,m1_2282,sign(h(m1_2282),skCli_2216)));
                                            {2179}in(c, (em2_2283: bitstring,sigM2_2284: bitstring));
                                            {2180}let m2_2285: bitstring = em2_2283 in
                                            {2181}if (verify(h(m2_2285),sigM2_2284,pkSess_2278) <> true) then
                                                0
                                            else
                                                {2182}let (=OpenSecureChannelResponse,Ns_2286: bitstring,ST_2287: bitstring,TTL_2288: bitstring) = m2_2285 in
                                                {2183}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2184}event endCli(Sess,Cli,Ns_2286)
                                )
                                else
                                    {2185}let pkSess_2289: bitstring = fail-any in
                                    {2186}out(c, GetEndpointRequest);
                                    {2187}in(c, (=GetEndpointResponse,=pkSess_2289,=Sign,SP_2290: bitstring,UP_2291: bitstring));
                                    {2188}new Nc_2292: bitstring;
                                    {2189}let m1_2293: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2292) in
                                    {2190}event beginCli(Cli,Sess,Nc_2292);
                                    {2191}out(c, (pkCli_2217,m1_2293,sign(h(m1_2293),skCli_2216)));
                                    {2192}in(c, (em2_2294: bitstring,sigM2_2295: bitstring));
                                    {2193}let m2_2296: bitstring = em2_2294 in
                                    {2194}if (verify(h(m2_2296),sigM2_2295,pkSess_2289) <> true) then
                                        0
                                    else
                                        {2195}let (=OpenSecureChannelResponse,Ns_2297: bitstring,ST_2298: bitstring,TTL_2299: bitstring) = m2_2296 in
                                        {2196}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2197}event endCli(Sess,Cli,Ns_2297)
                            )
                            else
                                {2198}let v_2300: bool = (Disco = B) in
                                (
                                    {2199}if v_2300 then
                                    (
                                        {2200}let pkDisco_2301: bitstring = pub(skB) in
                                        {2201}let v_2302: bool = (Sess = A) in
                                        (
                                            {2202}if v_2302 then
                                            (
                                                {2203}let pkSess_2303: bitstring = pub(skA) in
                                                {2204}out(c, GetEndpointRequest);
                                                {2205}in(c, (=GetEndpointResponse,=pkSess_2303,=Sign,SP_2304: bitstring,UP_2305: bitstring));
                                                {2206}new Nc_2306: bitstring;
                                                {2207}let m1_2307: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2306) in
                                                {2208}event beginCli(Cli,Sess,Nc_2306);
                                                {2209}out(c, (pkCli_2217,m1_2307,sign(h(m1_2307),skCli_2216)));
                                                {2210}in(c, (em2_2308: bitstring,sigM2_2309: bitstring));
                                                {2211}let m2_2310: bitstring = em2_2308 in
                                                {2212}if (verify(h(m2_2310),sigM2_2309,pkSess_2303) <> true) then
                                                    0
                                                else
                                                    {2213}let (=OpenSecureChannelResponse,Ns_2311: bitstring,ST_2312: bitstring,TTL_2313: bitstring) = m2_2310 in
                                                    {2214}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2215}event endCli(Sess,Cli,Ns_2311)
                                            )
                                            else
                                                {2216}let v_2314: bool = (Sess = B) in
                                                (
                                                    {2217}if v_2314 then
                                                    (
                                                        {2218}let pkSess_2315: bitstring = pub(skB) in
                                                        {2219}out(c, GetEndpointRequest);
                                                        {2220}in(c, (=GetEndpointResponse,=pkSess_2315,=Sign,SP_2316: bitstring,UP_2317: bitstring));
                                                        {2221}new Nc_2318: bitstring;
                                                        {2222}let m1_2319: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2318) in
                                                        {2223}event beginCli(Cli,Sess,Nc_2318);
                                                        {2224}out(c, (pkCli_2217,m1_2319,sign(h(m1_2319),skCli_2216)));
                                                        {2225}in(c, (em2_2320: bitstring,sigM2_2321: bitstring));
                                                        {2226}let m2_2322: bitstring = em2_2320 in
                                                        {2227}if (verify(h(m2_2322),sigM2_2321,pkSess_2315) <> true) then
                                                            0
                                                        else
                                                            {2228}let (=OpenSecureChannelResponse,Ns_2323: bitstring,ST_2324: bitstring,TTL_2325: bitstring) = m2_2322 in
                                                            {2229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2230}event endCli(Sess,Cli,Ns_2323)
                                                    )
                                                    else
                                                        {2231}let v_2326: bool = (Sess = C) in
                                                        (
                                                            {2232}if v_2326 then
                                                            (
                                                                {2233}let pkSess_2327: bitstring = pub(skC) in
                                                                {2234}out(c, GetEndpointRequest);
                                                                {2235}in(c, (=GetEndpointResponse,=pkSess_2327,=Sign,SP_2328: bitstring,UP_2329: bitstring));
                                                                {2236}new Nc_2330: bitstring;
                                                                {2237}let m1_2331: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2330) in
                                                                {2238}event beginCli(Cli,Sess,Nc_2330);
                                                                {2239}out(c, (pkCli_2217,m1_2331,sign(h(m1_2331),skCli_2216)));
                                                                {2240}in(c, (em2_2332: bitstring,sigM2_2333: bitstring));
                                                                {2241}let m2_2334: bitstring = em2_2332 in
                                                                {2242}if (verify(h(m2_2334),sigM2_2333,pkSess_2327) <> true) then
                                                                    0
                                                                else
                                                                    {2243}let (=OpenSecureChannelResponse,Ns_2335: bitstring,ST_2336: bitstring,TTL_2337: bitstring) = m2_2334 in
                                                                    {2244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2245}event endCli(Sess,Cli,Ns_2335)
                                                            )
                                                            else
                                                                {2246}let pkSess_2338: bitstring = pub(sk(Sess)) in
                                                                {2247}out(c, GetEndpointRequest);
                                                                {2248}in(c, (=GetEndpointResponse,=pkSess_2338,=Sign,SP_2339: bitstring,UP_2340: bitstring));
                                                                {2249}new Nc_2341: bitstring;
                                                                {2250}let m1_2342: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2341) in
                                                                {2251}event beginCli(Cli,Sess,Nc_2341);
                                                                {2252}out(c, (pkCli_2217,m1_2342,sign(h(m1_2342),skCli_2216)));
                                                                {2253}in(c, (em2_2343: bitstring,sigM2_2344: bitstring));
                                                                {2254}let m2_2345: bitstring = em2_2343 in
                                                                {2255}if (verify(h(m2_2345),sigM2_2344,pkSess_2338) <> true) then
                                                                    0
                                                                else
                                                                    {2256}let (=OpenSecureChannelResponse,Ns_2346: bitstring,ST_2347: bitstring,TTL_2348: bitstring) = m2_2345 in
                                                                    {2257}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2258}event endCli(Sess,Cli,Ns_2346)
                                                        )
                                                        else
                                                            {2259}let pkSess_2349: bitstring = fail-any in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2349,=Sign,SP_2350: bitstring,UP_2351: bitstring));
                                                            {2262}new Nc_2352: bitstring;
                                                            {2263}let m1_2353: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2352) in
                                                            {2264}event beginCli(Cli,Sess,Nc_2352);
                                                            {2265}out(c, (pkCli_2217,m1_2353,sign(h(m1_2353),skCli_2216)));
                                                            {2266}in(c, (em2_2354: bitstring,sigM2_2355: bitstring));
                                                            {2267}let m2_2356: bitstring = em2_2354 in
                                                            {2268}if (verify(h(m2_2356),sigM2_2355,pkSess_2349) <> true) then
                                                                0
                                                            else
                                                                {2269}let (=OpenSecureChannelResponse,Ns_2357: bitstring,ST_2358: bitstring,TTL_2359: bitstring) = m2_2356 in
                                                                {2270}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2271}event endCli(Sess,Cli,Ns_2357)
                                                )
                                                else
                                                    {2272}let pkSess_2360: bitstring = fail-any in
                                                    {2273}out(c, GetEndpointRequest);
                                                    {2274}in(c, (=GetEndpointResponse,=pkSess_2360,=Sign,SP_2361: bitstring,UP_2362: bitstring));
                                                    {2275}new Nc_2363: bitstring;
                                                    {2276}let m1_2364: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2363) in
                                                    {2277}event beginCli(Cli,Sess,Nc_2363);
                                                    {2278}out(c, (pkCli_2217,m1_2364,sign(h(m1_2364),skCli_2216)));
                                                    {2279}in(c, (em2_2365: bitstring,sigM2_2366: bitstring));
                                                    {2280}let m2_2367: bitstring = em2_2365 in
                                                    {2281}if (verify(h(m2_2367),sigM2_2366,pkSess_2360) <> true) then
                                                        0
                                                    else
                                                        {2282}let (=OpenSecureChannelResponse,Ns_2368: bitstring,ST_2369: bitstring,TTL_2370: bitstring) = m2_2367 in
                                                        {2283}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2284}event endCli(Sess,Cli,Ns_2368)
                                        )
                                        else
                                            {2285}let pkSess_2371: bitstring = fail-any in
                                            {2286}out(c, GetEndpointRequest);
                                            {2287}in(c, (=GetEndpointResponse,=pkSess_2371,=Sign,SP_2372: bitstring,UP_2373: bitstring));
                                            {2288}new Nc_2374: bitstring;
                                            {2289}let m1_2375: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2374) in
                                            {2290}event beginCli(Cli,Sess,Nc_2374);
                                            {2291}out(c, (pkCli_2217,m1_2375,sign(h(m1_2375),skCli_2216)));
                                            {2292}in(c, (em2_2376: bitstring,sigM2_2377: bitstring));
                                            {2293}let m2_2378: bitstring = em2_2376 in
                                            {2294}if (verify(h(m2_2378),sigM2_2377,pkSess_2371) <> true) then
                                                0
                                            else
                                                {2295}let (=OpenSecureChannelResponse,Ns_2379: bitstring,ST_2380: bitstring,TTL_2381: bitstring) = m2_2378 in
                                                {2296}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2297}event endCli(Sess,Cli,Ns_2379)
                                    )
                                    else
                                        {2298}let v_2382: bool = (Disco = C) in
                                        (
                                            {2299}if v_2382 then
                                            (
                                                {2300}let pkDisco_2383: bitstring = pub(skC) in
                                                {2301}let v_2384: bool = (Sess = A) in
                                                (
                                                    {2302}if v_2384 then
                                                    (
                                                        {2303}let pkSess_2385: bitstring = pub(skA) in
                                                        {2304}out(c, GetEndpointRequest);
                                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2385,=Sign,SP_2386: bitstring,UP_2387: bitstring));
                                                        {2306}new Nc_2388: bitstring;
                                                        {2307}let m1_2389: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2388) in
                                                        {2308}event beginCli(Cli,Sess,Nc_2388);
                                                        {2309}out(c, (pkCli_2217,m1_2389,sign(h(m1_2389),skCli_2216)));
                                                        {2310}in(c, (em2_2390: bitstring,sigM2_2391: bitstring));
                                                        {2311}let m2_2392: bitstring = em2_2390 in
                                                        {2312}if (verify(h(m2_2392),sigM2_2391,pkSess_2385) <> true) then
                                                            0
                                                        else
                                                            {2313}let (=OpenSecureChannelResponse,Ns_2393: bitstring,ST_2394: bitstring,TTL_2395: bitstring) = m2_2392 in
                                                            {2314}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2315}event endCli(Sess,Cli,Ns_2393)
                                                    )
                                                    else
                                                        {2316}let v_2396: bool = (Sess = B) in
                                                        (
                                                            {2317}if v_2396 then
                                                            (
                                                                {2318}let pkSess_2397: bitstring = pub(skB) in
                                                                {2319}out(c, GetEndpointRequest);
                                                                {2320}in(c, (=GetEndpointResponse,=pkSess_2397,=Sign,SP_2398: bitstring,UP_2399: bitstring));
                                                                {2321}new Nc_2400: bitstring;
                                                                {2322}let m1_2401: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2400) in
                                                                {2323}event beginCli(Cli,Sess,Nc_2400);
                                                                {2324}out(c, (pkCli_2217,m1_2401,sign(h(m1_2401),skCli_2216)));
                                                                {2325}in(c, (em2_2402: bitstring,sigM2_2403: bitstring));
                                                                {2326}let m2_2404: bitstring = em2_2402 in
                                                                {2327}if (verify(h(m2_2404),sigM2_2403,pkSess_2397) <> true) then
                                                                    0
                                                                else
                                                                    {2328}let (=OpenSecureChannelResponse,Ns_2405: bitstring,ST_2406: bitstring,TTL_2407: bitstring) = m2_2404 in
                                                                    {2329}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2330}event endCli(Sess,Cli,Ns_2405)
                                                            )
                                                            else
                                                                {2331}let v_2408: bool = (Sess = C) in
                                                                (
                                                                    {2332}if v_2408 then
                                                                    (
                                                                        {2333}let pkSess_2409: bitstring = pub(skC) in
                                                                        {2334}out(c, GetEndpointRequest);
                                                                        {2335}in(c, (=GetEndpointResponse,=pkSess_2409,=Sign,SP_2410: bitstring,UP_2411: bitstring));
                                                                        {2336}new Nc_2412: bitstring;
                                                                        {2337}let m1_2413: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2412) in
                                                                        {2338}event beginCli(Cli,Sess,Nc_2412);
                                                                        {2339}out(c, (pkCli_2217,m1_2413,sign(h(m1_2413),skCli_2216)));
                                                                        {2340}in(c, (em2_2414: bitstring,sigM2_2415: bitstring));
                                                                        {2341}let m2_2416: bitstring = em2_2414 in
                                                                        {2342}if (verify(h(m2_2416),sigM2_2415,pkSess_2409) <> true) then
                                                                            0
                                                                        else
                                                                            {2343}let (=OpenSecureChannelResponse,Ns_2417: bitstring,ST_2418: bitstring,TTL_2419: bitstring) = m2_2416 in
                                                                            {2344}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2345}event endCli(Sess,Cli,Ns_2417)
                                                                    )
                                                                    else
                                                                        {2346}let pkSess_2420: bitstring = pub(sk(Sess)) in
                                                                        {2347}out(c, GetEndpointRequest);
                                                                        {2348}in(c, (=GetEndpointResponse,=pkSess_2420,=Sign,SP_2421: bitstring,UP_2422: bitstring));
                                                                        {2349}new Nc_2423: bitstring;
                                                                        {2350}let m1_2424: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2423) in
                                                                        {2351}event beginCli(Cli,Sess,Nc_2423);
                                                                        {2352}out(c, (pkCli_2217,m1_2424,sign(h(m1_2424),skCli_2216)));
                                                                        {2353}in(c, (em2_2425: bitstring,sigM2_2426: bitstring));
                                                                        {2354}let m2_2427: bitstring = em2_2425 in
                                                                        {2355}if (verify(h(m2_2427),sigM2_2426,pkSess_2420) <> true) then
                                                                            0
                                                                        else
                                                                            {2356}let (=OpenSecureChannelResponse,Ns_2428: bitstring,ST_2429: bitstring,TTL_2430: bitstring) = m2_2427 in
                                                                            {2357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2358}event endCli(Sess,Cli,Ns_2428)
                                                                )
                                                                else
                                                                    {2359}let pkSess_2431: bitstring = fail-any in
                                                                    {2360}out(c, GetEndpointRequest);
                                                                    {2361}in(c, (=GetEndpointResponse,=pkSess_2431,=Sign,SP_2432: bitstring,UP_2433: bitstring));
                                                                    {2362}new Nc_2434: bitstring;
                                                                    {2363}let m1_2435: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2434) in
                                                                    {2364}event beginCli(Cli,Sess,Nc_2434);
                                                                    {2365}out(c, (pkCli_2217,m1_2435,sign(h(m1_2435),skCli_2216)));
                                                                    {2366}in(c, (em2_2436: bitstring,sigM2_2437: bitstring));
                                                                    {2367}let m2_2438: bitstring = em2_2436 in
                                                                    {2368}if (verify(h(m2_2438),sigM2_2437,pkSess_2431) <> true) then
                                                                        0
                                                                    else
                                                                        {2369}let (=OpenSecureChannelResponse,Ns_2439: bitstring,ST_2440: bitstring,TTL_2441: bitstring) = m2_2438 in
                                                                        {2370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2371}event endCli(Sess,Cli,Ns_2439)
                                                        )
                                                        else
                                                            {2372}let pkSess_2442: bitstring = fail-any in
                                                            {2373}out(c, GetEndpointRequest);
                                                            {2374}in(c, (=GetEndpointResponse,=pkSess_2442,=Sign,SP_2443: bitstring,UP_2444: bitstring));
                                                            {2375}new Nc_2445: bitstring;
                                                            {2376}let m1_2446: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2445) in
                                                            {2377}event beginCli(Cli,Sess,Nc_2445);
                                                            {2378}out(c, (pkCli_2217,m1_2446,sign(h(m1_2446),skCli_2216)));
                                                            {2379}in(c, (em2_2447: bitstring,sigM2_2448: bitstring));
                                                            {2380}let m2_2449: bitstring = em2_2447 in
                                                            {2381}if (verify(h(m2_2449),sigM2_2448,pkSess_2442) <> true) then
                                                                0
                                                            else
                                                                {2382}let (=OpenSecureChannelResponse,Ns_2450: bitstring,ST_2451: bitstring,TTL_2452: bitstring) = m2_2449 in
                                                                {2383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2384}event endCli(Sess,Cli,Ns_2450)
                                                )
                                                else
                                                    {2385}let pkSess_2453: bitstring = fail-any in
                                                    {2386}out(c, GetEndpointRequest);
                                                    {2387}in(c, (=GetEndpointResponse,=pkSess_2453,=Sign,SP_2454: bitstring,UP_2455: bitstring));
                                                    {2388}new Nc_2456: bitstring;
                                                    {2389}let m1_2457: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2456) in
                                                    {2390}event beginCli(Cli,Sess,Nc_2456);
                                                    {2391}out(c, (pkCli_2217,m1_2457,sign(h(m1_2457),skCli_2216)));
                                                    {2392}in(c, (em2_2458: bitstring,sigM2_2459: bitstring));
                                                    {2393}let m2_2460: bitstring = em2_2458 in
                                                    {2394}if (verify(h(m2_2460),sigM2_2459,pkSess_2453) <> true) then
                                                        0
                                                    else
                                                        {2395}let (=OpenSecureChannelResponse,Ns_2461: bitstring,ST_2462: bitstring,TTL_2463: bitstring) = m2_2460 in
                                                        {2396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2397}event endCli(Sess,Cli,Ns_2461)
                                            )
                                            else
                                                {2398}let pkDisco_2464: bitstring = pub(sk(Disco)) in
                                                {2399}let v_2465: bool = (Sess = A) in
                                                (
                                                    {2400}if v_2465 then
                                                    (
                                                        {2401}let pkSess_2466: bitstring = pub(skA) in
                                                        {2402}out(c, GetEndpointRequest);
                                                        {2403}in(c, (=GetEndpointResponse,=pkSess_2466,=Sign,SP_2467: bitstring,UP_2468: bitstring));
                                                        {2404}new Nc_2469: bitstring;
                                                        {2405}let m1_2470: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2469) in
                                                        {2406}event beginCli(Cli,Sess,Nc_2469);
                                                        {2407}out(c, (pkCli_2217,m1_2470,sign(h(m1_2470),skCli_2216)));
                                                        {2408}in(c, (em2_2471: bitstring,sigM2_2472: bitstring));
                                                        {2409}let m2_2473: bitstring = em2_2471 in
                                                        {2410}if (verify(h(m2_2473),sigM2_2472,pkSess_2466) <> true) then
                                                            0
                                                        else
                                                            {2411}let (=OpenSecureChannelResponse,Ns_2474: bitstring,ST_2475: bitstring,TTL_2476: bitstring) = m2_2473 in
                                                            {2412}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2413}event endCli(Sess,Cli,Ns_2474)
                                                    )
                                                    else
                                                        {2414}let v_2477: bool = (Sess = B) in
                                                        (
                                                            {2415}if v_2477 then
                                                            (
                                                                {2416}let pkSess_2478: bitstring = pub(skB) in
                                                                {2417}out(c, GetEndpointRequest);
                                                                {2418}in(c, (=GetEndpointResponse,=pkSess_2478,=Sign,SP_2479: bitstring,UP_2480: bitstring));
                                                                {2419}new Nc_2481: bitstring;
                                                                {2420}let m1_2482: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2481) in
                                                                {2421}event beginCli(Cli,Sess,Nc_2481);
                                                                {2422}out(c, (pkCli_2217,m1_2482,sign(h(m1_2482),skCli_2216)));
                                                                {2423}in(c, (em2_2483: bitstring,sigM2_2484: bitstring));
                                                                {2424}let m2_2485: bitstring = em2_2483 in
                                                                {2425}if (verify(h(m2_2485),sigM2_2484,pkSess_2478) <> true) then
                                                                    0
                                                                else
                                                                    {2426}let (=OpenSecureChannelResponse,Ns_2486: bitstring,ST_2487: bitstring,TTL_2488: bitstring) = m2_2485 in
                                                                    {2427}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2428}event endCli(Sess,Cli,Ns_2486)
                                                            )
                                                            else
                                                                {2429}let v_2489: bool = (Sess = C) in
                                                                (
                                                                    {2430}if v_2489 then
                                                                    (
                                                                        {2431}let pkSess_2490: bitstring = pub(skC) in
                                                                        {2432}out(c, GetEndpointRequest);
                                                                        {2433}in(c, (=GetEndpointResponse,=pkSess_2490,=Sign,SP_2491: bitstring,UP_2492: bitstring));
                                                                        {2434}new Nc_2493: bitstring;
                                                                        {2435}let m1_2494: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2493) in
                                                                        {2436}event beginCli(Cli,Sess,Nc_2493);
                                                                        {2437}out(c, (pkCli_2217,m1_2494,sign(h(m1_2494),skCli_2216)));
                                                                        {2438}in(c, (em2_2495: bitstring,sigM2_2496: bitstring));
                                                                        {2439}let m2_2497: bitstring = em2_2495 in
                                                                        {2440}if (verify(h(m2_2497),sigM2_2496,pkSess_2490) <> true) then
                                                                            0
                                                                        else
                                                                            {2441}let (=OpenSecureChannelResponse,Ns_2498: bitstring,ST_2499: bitstring,TTL_2500: bitstring) = m2_2497 in
                                                                            {2442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2443}event endCli(Sess,Cli,Ns_2498)
                                                                    )
                                                                    else
                                                                        {2444}let pkSess_2501: bitstring = pub(sk(Sess)) in
                                                                        {2445}out(c, GetEndpointRequest);
                                                                        {2446}in(c, (=GetEndpointResponse,=pkSess_2501,=Sign,SP_2502: bitstring,UP_2503: bitstring));
                                                                        {2447}new Nc_2504: bitstring;
                                                                        {2448}let m1_2505: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2504) in
                                                                        {2449}event beginCli(Cli,Sess,Nc_2504);
                                                                        {2450}out(c, (pkCli_2217,m1_2505,sign(h(m1_2505),skCli_2216)));
                                                                        {2451}in(c, (em2_2506: bitstring,sigM2_2507: bitstring));
                                                                        {2452}let m2_2508: bitstring = em2_2506 in
                                                                        {2453}if (verify(h(m2_2508),sigM2_2507,pkSess_2501) <> true) then
                                                                            0
                                                                        else
                                                                            {2454}let (=OpenSecureChannelResponse,Ns_2509: bitstring,ST_2510: bitstring,TTL_2511: bitstring) = m2_2508 in
                                                                            {2455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2456}event endCli(Sess,Cli,Ns_2509)
                                                                )
                                                                else
                                                                    {2457}let pkSess_2512: bitstring = fail-any in
                                                                    {2458}out(c, GetEndpointRequest);
                                                                    {2459}in(c, (=GetEndpointResponse,=pkSess_2512,=Sign,SP_2513: bitstring,UP_2514: bitstring));
                                                                    {2460}new Nc_2515: bitstring;
                                                                    {2461}let m1_2516: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2515) in
                                                                    {2462}event beginCli(Cli,Sess,Nc_2515);
                                                                    {2463}out(c, (pkCli_2217,m1_2516,sign(h(m1_2516),skCli_2216)));
                                                                    {2464}in(c, (em2_2517: bitstring,sigM2_2518: bitstring));
                                                                    {2465}let m2_2519: bitstring = em2_2517 in
                                                                    {2466}if (verify(h(m2_2519),sigM2_2518,pkSess_2512) <> true) then
                                                                        0
                                                                    else
                                                                        {2467}let (=OpenSecureChannelResponse,Ns_2520: bitstring,ST_2521: bitstring,TTL_2522: bitstring) = m2_2519 in
                                                                        {2468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2469}event endCli(Sess,Cli,Ns_2520)
                                                        )
                                                        else
                                                            {2470}let pkSess_2523: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (=GetEndpointResponse,=pkSess_2523,=Sign,SP_2524: bitstring,UP_2525: bitstring));
                                                            {2473}new Nc_2526: bitstring;
                                                            {2474}let m1_2527: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2526) in
                                                            {2475}event beginCli(Cli,Sess,Nc_2526);
                                                            {2476}out(c, (pkCli_2217,m1_2527,sign(h(m1_2527),skCli_2216)));
                                                            {2477}in(c, (em2_2528: bitstring,sigM2_2529: bitstring));
                                                            {2478}let m2_2530: bitstring = em2_2528 in
                                                            {2479}if (verify(h(m2_2530),sigM2_2529,pkSess_2523) <> true) then
                                                                0
                                                            else
                                                                {2480}let (=OpenSecureChannelResponse,Ns_2531: bitstring,ST_2532: bitstring,TTL_2533: bitstring) = m2_2530 in
                                                                {2481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2482}event endCli(Sess,Cli,Ns_2531)
                                                )
                                                else
                                                    {2483}let pkSess_2534: bitstring = fail-any in
                                                    {2484}out(c, GetEndpointRequest);
                                                    {2485}in(c, (=GetEndpointResponse,=pkSess_2534,=Sign,SP_2535: bitstring,UP_2536: bitstring));
                                                    {2486}new Nc_2537: bitstring;
                                                    {2487}let m1_2538: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2537) in
                                                    {2488}event beginCli(Cli,Sess,Nc_2537);
                                                    {2489}out(c, (pkCli_2217,m1_2538,sign(h(m1_2538),skCli_2216)));
                                                    {2490}in(c, (em2_2539: bitstring,sigM2_2540: bitstring));
                                                    {2491}let m2_2541: bitstring = em2_2539 in
                                                    {2492}if (verify(h(m2_2541),sigM2_2540,pkSess_2534) <> true) then
                                                        0
                                                    else
                                                        {2493}let (=OpenSecureChannelResponse,Ns_2542: bitstring,ST_2543: bitstring,TTL_2544: bitstring) = m2_2541 in
                                                        {2494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2495}event endCli(Sess,Cli,Ns_2542)
                                        )
                                        else
                                            {2496}let pkDisco_2545: bitstring = fail-any in
                                            {2497}let v_2546: bool = (Sess = A) in
                                            (
                                                {2498}if v_2546 then
                                                (
                                                    {2499}let pkSess_2547: bitstring = pub(skA) in
                                                    {2500}out(c, GetEndpointRequest);
                                                    {2501}in(c, (=GetEndpointResponse,=pkSess_2547,=Sign,SP_2548: bitstring,UP_2549: bitstring));
                                                    {2502}new Nc_2550: bitstring;
                                                    {2503}let m1_2551: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2550) in
                                                    {2504}event beginCli(Cli,Sess,Nc_2550);
                                                    {2505}out(c, (pkCli_2217,m1_2551,sign(h(m1_2551),skCli_2216)));
                                                    {2506}in(c, (em2_2552: bitstring,sigM2_2553: bitstring));
                                                    {2507}let m2_2554: bitstring = em2_2552 in
                                                    {2508}if (verify(h(m2_2554),sigM2_2553,pkSess_2547) <> true) then
                                                        0
                                                    else
                                                        {2509}let (=OpenSecureChannelResponse,Ns_2555: bitstring,ST_2556: bitstring,TTL_2557: bitstring) = m2_2554 in
                                                        {2510}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2511}event endCli(Sess,Cli,Ns_2555)
                                                )
                                                else
                                                    {2512}let v_2558: bool = (Sess = B) in
                                                    (
                                                        {2513}if v_2558 then
                                                        (
                                                            {2514}let pkSess_2559: bitstring = pub(skB) in
                                                            {2515}out(c, GetEndpointRequest);
                                                            {2516}in(c, (=GetEndpointResponse,=pkSess_2559,=Sign,SP_2560: bitstring,UP_2561: bitstring));
                                                            {2517}new Nc_2562: bitstring;
                                                            {2518}let m1_2563: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2562) in
                                                            {2519}event beginCli(Cli,Sess,Nc_2562);
                                                            {2520}out(c, (pkCli_2217,m1_2563,sign(h(m1_2563),skCli_2216)));
                                                            {2521}in(c, (em2_2564: bitstring,sigM2_2565: bitstring));
                                                            {2522}let m2_2566: bitstring = em2_2564 in
                                                            {2523}if (verify(h(m2_2566),sigM2_2565,pkSess_2559) <> true) then
                                                                0
                                                            else
                                                                {2524}let (=OpenSecureChannelResponse,Ns_2567: bitstring,ST_2568: bitstring,TTL_2569: bitstring) = m2_2566 in
                                                                {2525}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2526}event endCli(Sess,Cli,Ns_2567)
                                                        )
                                                        else
                                                            {2527}let v_2570: bool = (Sess = C) in
                                                            (
                                                                {2528}if v_2570 then
                                                                (
                                                                    {2529}let pkSess_2571: bitstring = pub(skC) in
                                                                    {2530}out(c, GetEndpointRequest);
                                                                    {2531}in(c, (=GetEndpointResponse,=pkSess_2571,=Sign,SP_2572: bitstring,UP_2573: bitstring));
                                                                    {2532}new Nc_2574: bitstring;
                                                                    {2533}let m1_2575: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2574) in
                                                                    {2534}event beginCli(Cli,Sess,Nc_2574);
                                                                    {2535}out(c, (pkCli_2217,m1_2575,sign(h(m1_2575),skCli_2216)));
                                                                    {2536}in(c, (em2_2576: bitstring,sigM2_2577: bitstring));
                                                                    {2537}let m2_2578: bitstring = em2_2576 in
                                                                    {2538}if (verify(h(m2_2578),sigM2_2577,pkSess_2571) <> true) then
                                                                        0
                                                                    else
                                                                        {2539}let (=OpenSecureChannelResponse,Ns_2579: bitstring,ST_2580: bitstring,TTL_2581: bitstring) = m2_2578 in
                                                                        {2540}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2541}event endCli(Sess,Cli,Ns_2579)
                                                                )
                                                                else
                                                                    {2542}let pkSess_2582: bitstring = pub(sk(Sess)) in
                                                                    {2543}out(c, GetEndpointRequest);
                                                                    {2544}in(c, (=GetEndpointResponse,=pkSess_2582,=Sign,SP_2583: bitstring,UP_2584: bitstring));
                                                                    {2545}new Nc_2585: bitstring;
                                                                    {2546}let m1_2586: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2585) in
                                                                    {2547}event beginCli(Cli,Sess,Nc_2585);
                                                                    {2548}out(c, (pkCli_2217,m1_2586,sign(h(m1_2586),skCli_2216)));
                                                                    {2549}in(c, (em2_2587: bitstring,sigM2_2588: bitstring));
                                                                    {2550}let m2_2589: bitstring = em2_2587 in
                                                                    {2551}if (verify(h(m2_2589),sigM2_2588,pkSess_2582) <> true) then
                                                                        0
                                                                    else
                                                                        {2552}let (=OpenSecureChannelResponse,Ns_2590: bitstring,ST_2591: bitstring,TTL_2592: bitstring) = m2_2589 in
                                                                        {2553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2554}event endCli(Sess,Cli,Ns_2590)
                                                            )
                                                            else
                                                                {2555}let pkSess_2593: bitstring = fail-any in
                                                                {2556}out(c, GetEndpointRequest);
                                                                {2557}in(c, (=GetEndpointResponse,=pkSess_2593,=Sign,SP_2594: bitstring,UP_2595: bitstring));
                                                                {2558}new Nc_2596: bitstring;
                                                                {2559}let m1_2597: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2596) in
                                                                {2560}event beginCli(Cli,Sess,Nc_2596);
                                                                {2561}out(c, (pkCli_2217,m1_2597,sign(h(m1_2597),skCli_2216)));
                                                                {2562}in(c, (em2_2598: bitstring,sigM2_2599: bitstring));
                                                                {2563}let m2_2600: bitstring = em2_2598 in
                                                                {2564}if (verify(h(m2_2600),sigM2_2599,pkSess_2593) <> true) then
                                                                    0
                                                                else
                                                                    {2565}let (=OpenSecureChannelResponse,Ns_2601: bitstring,ST_2602: bitstring,TTL_2603: bitstring) = m2_2600 in
                                                                    {2566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2567}event endCli(Sess,Cli,Ns_2601)
                                                    )
                                                    else
                                                        {2568}let pkSess_2604: bitstring = fail-any in
                                                        {2569}out(c, GetEndpointRequest);
                                                        {2570}in(c, (=GetEndpointResponse,=pkSess_2604,=Sign,SP_2605: bitstring,UP_2606: bitstring));
                                                        {2571}new Nc_2607: bitstring;
                                                        {2572}let m1_2608: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2607) in
                                                        {2573}event beginCli(Cli,Sess,Nc_2607);
                                                        {2574}out(c, (pkCli_2217,m1_2608,sign(h(m1_2608),skCli_2216)));
                                                        {2575}in(c, (em2_2609: bitstring,sigM2_2610: bitstring));
                                                        {2576}let m2_2611: bitstring = em2_2609 in
                                                        {2577}if (verify(h(m2_2611),sigM2_2610,pkSess_2604) <> true) then
                                                            0
                                                        else
                                                            {2578}let (=OpenSecureChannelResponse,Ns_2612: bitstring,ST_2613: bitstring,TTL_2614: bitstring) = m2_2611 in
                                                            {2579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2580}event endCli(Sess,Cli,Ns_2612)
                                            )
                                            else
                                                {2581}let pkSess_2615: bitstring = fail-any in
                                                {2582}out(c, GetEndpointRequest);
                                                {2583}in(c, (=GetEndpointResponse,=pkSess_2615,=Sign,SP_2616: bitstring,UP_2617: bitstring));
                                                {2584}new Nc_2618: bitstring;
                                                {2585}let m1_2619: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2618) in
                                                {2586}event beginCli(Cli,Sess,Nc_2618);
                                                {2587}out(c, (pkCli_2217,m1_2619,sign(h(m1_2619),skCli_2216)));
                                                {2588}in(c, (em2_2620: bitstring,sigM2_2621: bitstring));
                                                {2589}let m2_2622: bitstring = em2_2620 in
                                                {2590}if (verify(h(m2_2622),sigM2_2621,pkSess_2615) <> true) then
                                                    0
                                                else
                                                    {2591}let (=OpenSecureChannelResponse,Ns_2623: bitstring,ST_2624: bitstring,TTL_2625: bitstring) = m2_2622 in
                                                    {2592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2593}event endCli(Sess,Cli,Ns_2623)
                                )
                                else
                                    {2594}let pkDisco_2626: bitstring = fail-any in
                                    {2595}let v_2627: bool = (Sess = A) in
                                    (
                                        {2596}if v_2627 then
                                        (
                                            {2597}let pkSess_2628: bitstring = pub(skA) in
                                            {2598}out(c, GetEndpointRequest);
                                            {2599}in(c, (=GetEndpointResponse,=pkSess_2628,=Sign,SP_2629: bitstring,UP_2630: bitstring));
                                            {2600}new Nc_2631: bitstring;
                                            {2601}let m1_2632: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2631) in
                                            {2602}event beginCli(Cli,Sess,Nc_2631);
                                            {2603}out(c, (pkCli_2217,m1_2632,sign(h(m1_2632),skCli_2216)));
                                            {2604}in(c, (em2_2633: bitstring,sigM2_2634: bitstring));
                                            {2605}let m2_2635: bitstring = em2_2633 in
                                            {2606}if (verify(h(m2_2635),sigM2_2634,pkSess_2628) <> true) then
                                                0
                                            else
                                                {2607}let (=OpenSecureChannelResponse,Ns_2636: bitstring,ST_2637: bitstring,TTL_2638: bitstring) = m2_2635 in
                                                {2608}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2609}event endCli(Sess,Cli,Ns_2636)
                                        )
                                        else
                                            {2610}let v_2639: bool = (Sess = B) in
                                            (
                                                {2611}if v_2639 then
                                                (
                                                    {2612}let pkSess_2640: bitstring = pub(skB) in
                                                    {2613}out(c, GetEndpointRequest);
                                                    {2614}in(c, (=GetEndpointResponse,=pkSess_2640,=Sign,SP_2641: bitstring,UP_2642: bitstring));
                                                    {2615}new Nc_2643: bitstring;
                                                    {2616}let m1_2644: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2643) in
                                                    {2617}event beginCli(Cli,Sess,Nc_2643);
                                                    {2618}out(c, (pkCli_2217,m1_2644,sign(h(m1_2644),skCli_2216)));
                                                    {2619}in(c, (em2_2645: bitstring,sigM2_2646: bitstring));
                                                    {2620}let m2_2647: bitstring = em2_2645 in
                                                    {2621}if (verify(h(m2_2647),sigM2_2646,pkSess_2640) <> true) then
                                                        0
                                                    else
                                                        {2622}let (=OpenSecureChannelResponse,Ns_2648: bitstring,ST_2649: bitstring,TTL_2650: bitstring) = m2_2647 in
                                                        {2623}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2624}event endCli(Sess,Cli,Ns_2648)
                                                )
                                                else
                                                    {2625}let v_2651: bool = (Sess = C) in
                                                    (
                                                        {2626}if v_2651 then
                                                        (
                                                            {2627}let pkSess_2652: bitstring = pub(skC) in
                                                            {2628}out(c, GetEndpointRequest);
                                                            {2629}in(c, (=GetEndpointResponse,=pkSess_2652,=Sign,SP_2653: bitstring,UP_2654: bitstring));
                                                            {2630}new Nc_2655: bitstring;
                                                            {2631}let m1_2656: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2655) in
                                                            {2632}event beginCli(Cli,Sess,Nc_2655);
                                                            {2633}out(c, (pkCli_2217,m1_2656,sign(h(m1_2656),skCli_2216)));
                                                            {2634}in(c, (em2_2657: bitstring,sigM2_2658: bitstring));
                                                            {2635}let m2_2659: bitstring = em2_2657 in
                                                            {2636}if (verify(h(m2_2659),sigM2_2658,pkSess_2652) <> true) then
                                                                0
                                                            else
                                                                {2637}let (=OpenSecureChannelResponse,Ns_2660: bitstring,ST_2661: bitstring,TTL_2662: bitstring) = m2_2659 in
                                                                {2638}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2639}event endCli(Sess,Cli,Ns_2660)
                                                        )
                                                        else
                                                            {2640}let pkSess_2663: bitstring = pub(sk(Sess)) in
                                                            {2641}out(c, GetEndpointRequest);
                                                            {2642}in(c, (=GetEndpointResponse,=pkSess_2663,=Sign,SP_2664: bitstring,UP_2665: bitstring));
                                                            {2643}new Nc_2666: bitstring;
                                                            {2644}let m1_2667: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2666) in
                                                            {2645}event beginCli(Cli,Sess,Nc_2666);
                                                            {2646}out(c, (pkCli_2217,m1_2667,sign(h(m1_2667),skCli_2216)));
                                                            {2647}in(c, (em2_2668: bitstring,sigM2_2669: bitstring));
                                                            {2648}let m2_2670: bitstring = em2_2668 in
                                                            {2649}if (verify(h(m2_2670),sigM2_2669,pkSess_2663) <> true) then
                                                                0
                                                            else
                                                                {2650}let (=OpenSecureChannelResponse,Ns_2671: bitstring,ST_2672: bitstring,TTL_2673: bitstring) = m2_2670 in
                                                                {2651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2652}event endCli(Sess,Cli,Ns_2671)
                                                    )
                                                    else
                                                        {2653}let pkSess_2674: bitstring = fail-any in
                                                        {2654}out(c, GetEndpointRequest);
                                                        {2655}in(c, (=GetEndpointResponse,=pkSess_2674,=Sign,SP_2675: bitstring,UP_2676: bitstring));
                                                        {2656}new Nc_2677: bitstring;
                                                        {2657}let m1_2678: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2677) in
                                                        {2658}event beginCli(Cli,Sess,Nc_2677);
                                                        {2659}out(c, (pkCli_2217,m1_2678,sign(h(m1_2678),skCli_2216)));
                                                        {2660}in(c, (em2_2679: bitstring,sigM2_2680: bitstring));
                                                        {2661}let m2_2681: bitstring = em2_2679 in
                                                        {2662}if (verify(h(m2_2681),sigM2_2680,pkSess_2674) <> true) then
                                                            0
                                                        else
                                                            {2663}let (=OpenSecureChannelResponse,Ns_2682: bitstring,ST_2683: bitstring,TTL_2684: bitstring) = m2_2681 in
                                                            {2664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2665}event endCli(Sess,Cli,Ns_2682)
                                            )
                                            else
                                                {2666}let pkSess_2685: bitstring = fail-any in
                                                {2667}out(c, GetEndpointRequest);
                                                {2668}in(c, (=GetEndpointResponse,=pkSess_2685,=Sign,SP_2686: bitstring,UP_2687: bitstring));
                                                {2669}new Nc_2688: bitstring;
                                                {2670}let m1_2689: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2688) in
                                                {2671}event beginCli(Cli,Sess,Nc_2688);
                                                {2672}out(c, (pkCli_2217,m1_2689,sign(h(m1_2689),skCli_2216)));
                                                {2673}in(c, (em2_2690: bitstring,sigM2_2691: bitstring));
                                                {2674}let m2_2692: bitstring = em2_2690 in
                                                {2675}if (verify(h(m2_2692),sigM2_2691,pkSess_2685) <> true) then
                                                    0
                                                else
                                                    {2676}let (=OpenSecureChannelResponse,Ns_2693: bitstring,ST_2694: bitstring,TTL_2695: bitstring) = m2_2692 in
                                                    {2677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2678}event endCli(Sess,Cli,Ns_2693)
                                    )
                                    else
                                        {2679}let pkSess_2696: bitstring = fail-any in
                                        {2680}out(c, GetEndpointRequest);
                                        {2681}in(c, (=GetEndpointResponse,=pkSess_2696,=Sign,SP_2697: bitstring,UP_2698: bitstring));
                                        {2682}new Nc_2699: bitstring;
                                        {2683}let m1_2700: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2699) in
                                        {2684}event beginCli(Cli,Sess,Nc_2699);
                                        {2685}out(c, (pkCli_2217,m1_2700,sign(h(m1_2700),skCli_2216)));
                                        {2686}in(c, (em2_2701: bitstring,sigM2_2702: bitstring));
                                        {2687}let m2_2703: bitstring = em2_2701 in
                                        {2688}if (verify(h(m2_2703),sigM2_2702,pkSess_2696) <> true) then
                                            0
                                        else
                                            {2689}let (=OpenSecureChannelResponse,Ns_2704: bitstring,ST_2705: bitstring,TTL_2706: bitstring) = m2_2703 in
                                            {2690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2691}event endCli(Sess,Cli,Ns_2704)
                        )
                        else
                            {2692}let pkDisco_2707: bitstring = fail-any in
                            {2693}let v_2708: bool = (Sess = A) in
                            (
                                {2694}if v_2708 then
                                (
                                    {2695}let pkSess_2709: bitstring = pub(skA) in
                                    {2696}out(c, GetEndpointRequest);
                                    {2697}in(c, (=GetEndpointResponse,=pkSess_2709,=Sign,SP_2710: bitstring,UP_2711: bitstring));
                                    {2698}new Nc_2712: bitstring;
                                    {2699}let m1_2713: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2712) in
                                    {2700}event beginCli(Cli,Sess,Nc_2712);
                                    {2701}out(c, (pkCli_2217,m1_2713,sign(h(m1_2713),skCli_2216)));
                                    {2702}in(c, (em2_2714: bitstring,sigM2_2715: bitstring));
                                    {2703}let m2_2716: bitstring = em2_2714 in
                                    {2704}if (verify(h(m2_2716),sigM2_2715,pkSess_2709) <> true) then
                                        0
                                    else
                                        {2705}let (=OpenSecureChannelResponse,Ns_2717: bitstring,ST_2718: bitstring,TTL_2719: bitstring) = m2_2716 in
                                        {2706}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2707}event endCli(Sess,Cli,Ns_2717)
                                )
                                else
                                    {2708}let v_2720: bool = (Sess = B) in
                                    (
                                        {2709}if v_2720 then
                                        (
                                            {2710}let pkSess_2721: bitstring = pub(skB) in
                                            {2711}out(c, GetEndpointRequest);
                                            {2712}in(c, (=GetEndpointResponse,=pkSess_2721,=Sign,SP_2722: bitstring,UP_2723: bitstring));
                                            {2713}new Nc_2724: bitstring;
                                            {2714}let m1_2725: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2724) in
                                            {2715}event beginCli(Cli,Sess,Nc_2724);
                                            {2716}out(c, (pkCli_2217,m1_2725,sign(h(m1_2725),skCli_2216)));
                                            {2717}in(c, (em2_2726: bitstring,sigM2_2727: bitstring));
                                            {2718}let m2_2728: bitstring = em2_2726 in
                                            {2719}if (verify(h(m2_2728),sigM2_2727,pkSess_2721) <> true) then
                                                0
                                            else
                                                {2720}let (=OpenSecureChannelResponse,Ns_2729: bitstring,ST_2730: bitstring,TTL_2731: bitstring) = m2_2728 in
                                                {2721}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2722}event endCli(Sess,Cli,Ns_2729)
                                        )
                                        else
                                            {2723}let v_2732: bool = (Sess = C) in
                                            (
                                                {2724}if v_2732 then
                                                (
                                                    {2725}let pkSess_2733: bitstring = pub(skC) in
                                                    {2726}out(c, GetEndpointRequest);
                                                    {2727}in(c, (=GetEndpointResponse,=pkSess_2733,=Sign,SP_2734: bitstring,UP_2735: bitstring));
                                                    {2728}new Nc_2736: bitstring;
                                                    {2729}let m1_2737: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2736) in
                                                    {2730}event beginCli(Cli,Sess,Nc_2736);
                                                    {2731}out(c, (pkCli_2217,m1_2737,sign(h(m1_2737),skCli_2216)));
                                                    {2732}in(c, (em2_2738: bitstring,sigM2_2739: bitstring));
                                                    {2733}let m2_2740: bitstring = em2_2738 in
                                                    {2734}if (verify(h(m2_2740),sigM2_2739,pkSess_2733) <> true) then
                                                        0
                                                    else
                                                        {2735}let (=OpenSecureChannelResponse,Ns_2741: bitstring,ST_2742: bitstring,TTL_2743: bitstring) = m2_2740 in
                                                        {2736}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2737}event endCli(Sess,Cli,Ns_2741)
                                                )
                                                else
                                                    {2738}let pkSess_2744: bitstring = pub(sk(Sess)) in
                                                    {2739}out(c, GetEndpointRequest);
                                                    {2740}in(c, (=GetEndpointResponse,=pkSess_2744,=Sign,SP_2745: bitstring,UP_2746: bitstring));
                                                    {2741}new Nc_2747: bitstring;
                                                    {2742}let m1_2748: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2747) in
                                                    {2743}event beginCli(Cli,Sess,Nc_2747);
                                                    {2744}out(c, (pkCli_2217,m1_2748,sign(h(m1_2748),skCli_2216)));
                                                    {2745}in(c, (em2_2749: bitstring,sigM2_2750: bitstring));
                                                    {2746}let m2_2751: bitstring = em2_2749 in
                                                    {2747}if (verify(h(m2_2751),sigM2_2750,pkSess_2744) <> true) then
                                                        0
                                                    else
                                                        {2748}let (=OpenSecureChannelResponse,Ns_2752: bitstring,ST_2753: bitstring,TTL_2754: bitstring) = m2_2751 in
                                                        {2749}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2750}event endCli(Sess,Cli,Ns_2752)
                                            )
                                            else
                                                {2751}let pkSess_2755: bitstring = fail-any in
                                                {2752}out(c, GetEndpointRequest);
                                                {2753}in(c, (=GetEndpointResponse,=pkSess_2755,=Sign,SP_2756: bitstring,UP_2757: bitstring));
                                                {2754}new Nc_2758: bitstring;
                                                {2755}let m1_2759: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2758) in
                                                {2756}event beginCli(Cli,Sess,Nc_2758);
                                                {2757}out(c, (pkCli_2217,m1_2759,sign(h(m1_2759),skCli_2216)));
                                                {2758}in(c, (em2_2760: bitstring,sigM2_2761: bitstring));
                                                {2759}let m2_2762: bitstring = em2_2760 in
                                                {2760}if (verify(h(m2_2762),sigM2_2761,pkSess_2755) <> true) then
                                                    0
                                                else
                                                    {2761}let (=OpenSecureChannelResponse,Ns_2763: bitstring,ST_2764: bitstring,TTL_2765: bitstring) = m2_2762 in
                                                    {2762}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2763}event endCli(Sess,Cli,Ns_2763)
                                    )
                                    else
                                        {2764}let pkSess_2766: bitstring = fail-any in
                                        {2765}out(c, GetEndpointRequest);
                                        {2766}in(c, (=GetEndpointResponse,=pkSess_2766,=Sign,SP_2767: bitstring,UP_2768: bitstring));
                                        {2767}new Nc_2769: bitstring;
                                        {2768}let m1_2770: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2769) in
                                        {2769}event beginCli(Cli,Sess,Nc_2769);
                                        {2770}out(c, (pkCli_2217,m1_2770,sign(h(m1_2770),skCli_2216)));
                                        {2771}in(c, (em2_2771: bitstring,sigM2_2772: bitstring));
                                        {2772}let m2_2773: bitstring = em2_2771 in
                                        {2773}if (verify(h(m2_2773),sigM2_2772,pkSess_2766) <> true) then
                                            0
                                        else
                                            {2774}let (=OpenSecureChannelResponse,Ns_2774: bitstring,ST_2775: bitstring,TTL_2776: bitstring) = m2_2773 in
                                            {2775}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2776}event endCli(Sess,Cli,Ns_2774)
                            )
                            else
                                {2777}let pkSess_2777: bitstring = fail-any in
                                {2778}out(c, GetEndpointRequest);
                                {2779}in(c, (=GetEndpointResponse,=pkSess_2777,=Sign,SP_2778: bitstring,UP_2779: bitstring));
                                {2780}new Nc_2780: bitstring;
                                {2781}let m1_2781: bitstring = (OpenSecureChannelRequest,pkCli_2217,Nc_2780) in
                                {2782}event beginCli(Cli,Sess,Nc_2780);
                                {2783}out(c, (pkCli_2217,m1_2781,sign(h(m1_2781),skCli_2216)));
                                {2784}in(c, (em2_2782: bitstring,sigM2_2783: bitstring));
                                {2785}let m2_2784: bitstring = em2_2782 in
                                {2786}if (verify(h(m2_2784),sigM2_2783,pkSess_2777) <> true) then
                                    0
                                else
                                    {2787}let (=OpenSecureChannelResponse,Ns_2785: bitstring,ST_2786: bitstring,TTL_2787: bitstring) = m2_2784 in
                                    {2788}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2789}event endCli(Sess,Cli,Ns_2785)
            )
            else
                {2790}let skCli_2788: bitstring = fail-any in
                {2791}let pkCli_2789: bitstring = pub(skCli_2788) in
                {2792}let v_2790: bool = (Disco = A) in
                (
                    {2793}if v_2790 then
                    (
                        {2794}let pkDisco_2791: bitstring = pub(skA) in
                        {2795}let v_2792: bool = (Sess = A) in
                        (
                            {2796}if v_2792 then
                            (
                                {2797}let pkSess_2793: bitstring = pub(skA) in
                                {2798}out(c, GetEndpointRequest);
                                {2799}in(c, (=GetEndpointResponse,=pkSess_2793,=Sign,SP_2794: bitstring,UP_2795: bitstring));
                                {2800}new Nc_2796: bitstring;
                                {2801}let m1_2797: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2796) in
                                {2802}event beginCli(Cli,Sess,Nc_2796);
                                {2803}out(c, (pkCli_2789,m1_2797,sign(h(m1_2797),skCli_2788)));
                                {2804}in(c, (em2_2798: bitstring,sigM2_2799: bitstring));
                                {2805}let m2_2800: bitstring = em2_2798 in
                                {2806}if (verify(h(m2_2800),sigM2_2799,pkSess_2793) <> true) then
                                    0
                                else
                                    {2807}let (=OpenSecureChannelResponse,Ns_2801: bitstring,ST_2802: bitstring,TTL_2803: bitstring) = m2_2800 in
                                    {2808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2809}event endCli(Sess,Cli,Ns_2801)
                            )
                            else
                                {2810}let v_2804: bool = (Sess = B) in
                                (
                                    {2811}if v_2804 then
                                    (
                                        {2812}let pkSess_2805: bitstring = pub(skB) in
                                        {2813}out(c, GetEndpointRequest);
                                        {2814}in(c, (=GetEndpointResponse,=pkSess_2805,=Sign,SP_2806: bitstring,UP_2807: bitstring));
                                        {2815}new Nc_2808: bitstring;
                                        {2816}let m1_2809: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2808) in
                                        {2817}event beginCli(Cli,Sess,Nc_2808);
                                        {2818}out(c, (pkCli_2789,m1_2809,sign(h(m1_2809),skCli_2788)));
                                        {2819}in(c, (em2_2810: bitstring,sigM2_2811: bitstring));
                                        {2820}let m2_2812: bitstring = em2_2810 in
                                        {2821}if (verify(h(m2_2812),sigM2_2811,pkSess_2805) <> true) then
                                            0
                                        else
                                            {2822}let (=OpenSecureChannelResponse,Ns_2813: bitstring,ST_2814: bitstring,TTL_2815: bitstring) = m2_2812 in
                                            {2823}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2824}event endCli(Sess,Cli,Ns_2813)
                                    )
                                    else
                                        {2825}let v_2816: bool = (Sess = C) in
                                        (
                                            {2826}if v_2816 then
                                            (
                                                {2827}let pkSess_2817: bitstring = pub(skC) in
                                                {2828}out(c, GetEndpointRequest);
                                                {2829}in(c, (=GetEndpointResponse,=pkSess_2817,=Sign,SP_2818: bitstring,UP_2819: bitstring));
                                                {2830}new Nc_2820: bitstring;
                                                {2831}let m1_2821: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2820) in
                                                {2832}event beginCli(Cli,Sess,Nc_2820);
                                                {2833}out(c, (pkCli_2789,m1_2821,sign(h(m1_2821),skCli_2788)));
                                                {2834}in(c, (em2_2822: bitstring,sigM2_2823: bitstring));
                                                {2835}let m2_2824: bitstring = em2_2822 in
                                                {2836}if (verify(h(m2_2824),sigM2_2823,pkSess_2817) <> true) then
                                                    0
                                                else
                                                    {2837}let (=OpenSecureChannelResponse,Ns_2825: bitstring,ST_2826: bitstring,TTL_2827: bitstring) = m2_2824 in
                                                    {2838}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2839}event endCli(Sess,Cli,Ns_2825)
                                            )
                                            else
                                                {2840}let pkSess_2828: bitstring = pub(sk(Sess)) in
                                                {2841}out(c, GetEndpointRequest);
                                                {2842}in(c, (=GetEndpointResponse,=pkSess_2828,=Sign,SP_2829: bitstring,UP_2830: bitstring));
                                                {2843}new Nc_2831: bitstring;
                                                {2844}let m1_2832: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2831) in
                                                {2845}event beginCli(Cli,Sess,Nc_2831);
                                                {2846}out(c, (pkCli_2789,m1_2832,sign(h(m1_2832),skCli_2788)));
                                                {2847}in(c, (em2_2833: bitstring,sigM2_2834: bitstring));
                                                {2848}let m2_2835: bitstring = em2_2833 in
                                                {2849}if (verify(h(m2_2835),sigM2_2834,pkSess_2828) <> true) then
                                                    0
                                                else
                                                    {2850}let (=OpenSecureChannelResponse,Ns_2836: bitstring,ST_2837: bitstring,TTL_2838: bitstring) = m2_2835 in
                                                    {2851}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2852}event endCli(Sess,Cli,Ns_2836)
                                        )
                                        else
                                            {2853}let pkSess_2839: bitstring = fail-any in
                                            {2854}out(c, GetEndpointRequest);
                                            {2855}in(c, (=GetEndpointResponse,=pkSess_2839,=Sign,SP_2840: bitstring,UP_2841: bitstring));
                                            {2856}new Nc_2842: bitstring;
                                            {2857}let m1_2843: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2842) in
                                            {2858}event beginCli(Cli,Sess,Nc_2842);
                                            {2859}out(c, (pkCli_2789,m1_2843,sign(h(m1_2843),skCli_2788)));
                                            {2860}in(c, (em2_2844: bitstring,sigM2_2845: bitstring));
                                            {2861}let m2_2846: bitstring = em2_2844 in
                                            {2862}if (verify(h(m2_2846),sigM2_2845,pkSess_2839) <> true) then
                                                0
                                            else
                                                {2863}let (=OpenSecureChannelResponse,Ns_2847: bitstring,ST_2848: bitstring,TTL_2849: bitstring) = m2_2846 in
                                                {2864}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2865}event endCli(Sess,Cli,Ns_2847)
                                )
                                else
                                    {2866}let pkSess_2850: bitstring = fail-any in
                                    {2867}out(c, GetEndpointRequest);
                                    {2868}in(c, (=GetEndpointResponse,=pkSess_2850,=Sign,SP_2851: bitstring,UP_2852: bitstring));
                                    {2869}new Nc_2853: bitstring;
                                    {2870}let m1_2854: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2853) in
                                    {2871}event beginCli(Cli,Sess,Nc_2853);
                                    {2872}out(c, (pkCli_2789,m1_2854,sign(h(m1_2854),skCli_2788)));
                                    {2873}in(c, (em2_2855: bitstring,sigM2_2856: bitstring));
                                    {2874}let m2_2857: bitstring = em2_2855 in
                                    {2875}if (verify(h(m2_2857),sigM2_2856,pkSess_2850) <> true) then
                                        0
                                    else
                                        {2876}let (=OpenSecureChannelResponse,Ns_2858: bitstring,ST_2859: bitstring,TTL_2860: bitstring) = m2_2857 in
                                        {2877}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2878}event endCli(Sess,Cli,Ns_2858)
                        )
                        else
                            {2879}let pkSess_2861: bitstring = fail-any in
                            {2880}out(c, GetEndpointRequest);
                            {2881}in(c, (=GetEndpointResponse,=pkSess_2861,=Sign,SP_2862: bitstring,UP_2863: bitstring));
                            {2882}new Nc_2864: bitstring;
                            {2883}let m1_2865: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2864) in
                            {2884}event beginCli(Cli,Sess,Nc_2864);
                            {2885}out(c, (pkCli_2789,m1_2865,sign(h(m1_2865),skCli_2788)));
                            {2886}in(c, (em2_2866: bitstring,sigM2_2867: bitstring));
                            {2887}let m2_2868: bitstring = em2_2866 in
                            {2888}if (verify(h(m2_2868),sigM2_2867,pkSess_2861) <> true) then
                                0
                            else
                                {2889}let (=OpenSecureChannelResponse,Ns_2869: bitstring,ST_2870: bitstring,TTL_2871: bitstring) = m2_2868 in
                                {2890}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2891}event endCli(Sess,Cli,Ns_2869)
                    )
                    else
                        {2892}let v_2872: bool = (Disco = B) in
                        (
                            {2893}if v_2872 then
                            (
                                {2894}let pkDisco_2873: bitstring = pub(skB) in
                                {2895}let v_2874: bool = (Sess = A) in
                                (
                                    {2896}if v_2874 then
                                    (
                                        {2897}let pkSess_2875: bitstring = pub(skA) in
                                        {2898}out(c, GetEndpointRequest);
                                        {2899}in(c, (=GetEndpointResponse,=pkSess_2875,=Sign,SP_2876: bitstring,UP_2877: bitstring));
                                        {2900}new Nc_2878: bitstring;
                                        {2901}let m1_2879: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2878) in
                                        {2902}event beginCli(Cli,Sess,Nc_2878);
                                        {2903}out(c, (pkCli_2789,m1_2879,sign(h(m1_2879),skCli_2788)));
                                        {2904}in(c, (em2_2880: bitstring,sigM2_2881: bitstring));
                                        {2905}let m2_2882: bitstring = em2_2880 in
                                        {2906}if (verify(h(m2_2882),sigM2_2881,pkSess_2875) <> true) then
                                            0
                                        else
                                            {2907}let (=OpenSecureChannelResponse,Ns_2883: bitstring,ST_2884: bitstring,TTL_2885: bitstring) = m2_2882 in
                                            {2908}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2909}event endCli(Sess,Cli,Ns_2883)
                                    )
                                    else
                                        {2910}let v_2886: bool = (Sess = B) in
                                        (
                                            {2911}if v_2886 then
                                            (
                                                {2912}let pkSess_2887: bitstring = pub(skB) in
                                                {2913}out(c, GetEndpointRequest);
                                                {2914}in(c, (=GetEndpointResponse,=pkSess_2887,=Sign,SP_2888: bitstring,UP_2889: bitstring));
                                                {2915}new Nc_2890: bitstring;
                                                {2916}let m1_2891: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2890) in
                                                {2917}event beginCli(Cli,Sess,Nc_2890);
                                                {2918}out(c, (pkCli_2789,m1_2891,sign(h(m1_2891),skCli_2788)));
                                                {2919}in(c, (em2_2892: bitstring,sigM2_2893: bitstring));
                                                {2920}let m2_2894: bitstring = em2_2892 in
                                                {2921}if (verify(h(m2_2894),sigM2_2893,pkSess_2887) <> true) then
                                                    0
                                                else
                                                    {2922}let (=OpenSecureChannelResponse,Ns_2895: bitstring,ST_2896: bitstring,TTL_2897: bitstring) = m2_2894 in
                                                    {2923}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2924}event endCli(Sess,Cli,Ns_2895)
                                            )
                                            else
                                                {2925}let v_2898: bool = (Sess = C) in
                                                (
                                                    {2926}if v_2898 then
                                                    (
                                                        {2927}let pkSess_2899: bitstring = pub(skC) in
                                                        {2928}out(c, GetEndpointRequest);
                                                        {2929}in(c, (=GetEndpointResponse,=pkSess_2899,=Sign,SP_2900: bitstring,UP_2901: bitstring));
                                                        {2930}new Nc_2902: bitstring;
                                                        {2931}let m1_2903: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2902) in
                                                        {2932}event beginCli(Cli,Sess,Nc_2902);
                                                        {2933}out(c, (pkCli_2789,m1_2903,sign(h(m1_2903),skCli_2788)));
                                                        {2934}in(c, (em2_2904: bitstring,sigM2_2905: bitstring));
                                                        {2935}let m2_2906: bitstring = em2_2904 in
                                                        {2936}if (verify(h(m2_2906),sigM2_2905,pkSess_2899) <> true) then
                                                            0
                                                        else
                                                            {2937}let (=OpenSecureChannelResponse,Ns_2907: bitstring,ST_2908: bitstring,TTL_2909: bitstring) = m2_2906 in
                                                            {2938}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2939}event endCli(Sess,Cli,Ns_2907)
                                                    )
                                                    else
                                                        {2940}let pkSess_2910: bitstring = pub(sk(Sess)) in
                                                        {2941}out(c, GetEndpointRequest);
                                                        {2942}in(c, (=GetEndpointResponse,=pkSess_2910,=Sign,SP_2911: bitstring,UP_2912: bitstring));
                                                        {2943}new Nc_2913: bitstring;
                                                        {2944}let m1_2914: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2913) in
                                                        {2945}event beginCli(Cli,Sess,Nc_2913);
                                                        {2946}out(c, (pkCli_2789,m1_2914,sign(h(m1_2914),skCli_2788)));
                                                        {2947}in(c, (em2_2915: bitstring,sigM2_2916: bitstring));
                                                        {2948}let m2_2917: bitstring = em2_2915 in
                                                        {2949}if (verify(h(m2_2917),sigM2_2916,pkSess_2910) <> true) then
                                                            0
                                                        else
                                                            {2950}let (=OpenSecureChannelResponse,Ns_2918: bitstring,ST_2919: bitstring,TTL_2920: bitstring) = m2_2917 in
                                                            {2951}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2952}event endCli(Sess,Cli,Ns_2918)
                                                )
                                                else
                                                    {2953}let pkSess_2921: bitstring = fail-any in
                                                    {2954}out(c, GetEndpointRequest);
                                                    {2955}in(c, (=GetEndpointResponse,=pkSess_2921,=Sign,SP_2922: bitstring,UP_2923: bitstring));
                                                    {2956}new Nc_2924: bitstring;
                                                    {2957}let m1_2925: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2924) in
                                                    {2958}event beginCli(Cli,Sess,Nc_2924);
                                                    {2959}out(c, (pkCli_2789,m1_2925,sign(h(m1_2925),skCli_2788)));
                                                    {2960}in(c, (em2_2926: bitstring,sigM2_2927: bitstring));
                                                    {2961}let m2_2928: bitstring = em2_2926 in
                                                    {2962}if (verify(h(m2_2928),sigM2_2927,pkSess_2921) <> true) then
                                                        0
                                                    else
                                                        {2963}let (=OpenSecureChannelResponse,Ns_2929: bitstring,ST_2930: bitstring,TTL_2931: bitstring) = m2_2928 in
                                                        {2964}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2965}event endCli(Sess,Cli,Ns_2929)
                                        )
                                        else
                                            {2966}let pkSess_2932: bitstring = fail-any in
                                            {2967}out(c, GetEndpointRequest);
                                            {2968}in(c, (=GetEndpointResponse,=pkSess_2932,=Sign,SP_2933: bitstring,UP_2934: bitstring));
                                            {2969}new Nc_2935: bitstring;
                                            {2970}let m1_2936: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2935) in
                                            {2971}event beginCli(Cli,Sess,Nc_2935);
                                            {2972}out(c, (pkCli_2789,m1_2936,sign(h(m1_2936),skCli_2788)));
                                            {2973}in(c, (em2_2937: bitstring,sigM2_2938: bitstring));
                                            {2974}let m2_2939: bitstring = em2_2937 in
                                            {2975}if (verify(h(m2_2939),sigM2_2938,pkSess_2932) <> true) then
                                                0
                                            else
                                                {2976}let (=OpenSecureChannelResponse,Ns_2940: bitstring,ST_2941: bitstring,TTL_2942: bitstring) = m2_2939 in
                                                {2977}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2978}event endCli(Sess,Cli,Ns_2940)
                                )
                                else
                                    {2979}let pkSess_2943: bitstring = fail-any in
                                    {2980}out(c, GetEndpointRequest);
                                    {2981}in(c, (=GetEndpointResponse,=pkSess_2943,=Sign,SP_2944: bitstring,UP_2945: bitstring));
                                    {2982}new Nc_2946: bitstring;
                                    {2983}let m1_2947: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2946) in
                                    {2984}event beginCli(Cli,Sess,Nc_2946);
                                    {2985}out(c, (pkCli_2789,m1_2947,sign(h(m1_2947),skCli_2788)));
                                    {2986}in(c, (em2_2948: bitstring,sigM2_2949: bitstring));
                                    {2987}let m2_2950: bitstring = em2_2948 in
                                    {2988}if (verify(h(m2_2950),sigM2_2949,pkSess_2943) <> true) then
                                        0
                                    else
                                        {2989}let (=OpenSecureChannelResponse,Ns_2951: bitstring,ST_2952: bitstring,TTL_2953: bitstring) = m2_2950 in
                                        {2990}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2991}event endCli(Sess,Cli,Ns_2951)
                            )
                            else
                                {2992}let v_2954: bool = (Disco = C) in
                                (
                                    {2993}if v_2954 then
                                    (
                                        {2994}let pkDisco_2955: bitstring = pub(skC) in
                                        {2995}let v_2956: bool = (Sess = A) in
                                        (
                                            {2996}if v_2956 then
                                            (
                                                {2997}let pkSess_2957: bitstring = pub(skA) in
                                                {2998}out(c, GetEndpointRequest);
                                                {2999}in(c, (=GetEndpointResponse,=pkSess_2957,=Sign,SP_2958: bitstring,UP_2959: bitstring));
                                                {3000}new Nc_2960: bitstring;
                                                {3001}let m1_2961: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2960) in
                                                {3002}event beginCli(Cli,Sess,Nc_2960);
                                                {3003}out(c, (pkCli_2789,m1_2961,sign(h(m1_2961),skCli_2788)));
                                                {3004}in(c, (em2_2962: bitstring,sigM2_2963: bitstring));
                                                {3005}let m2_2964: bitstring = em2_2962 in
                                                {3006}if (verify(h(m2_2964),sigM2_2963,pkSess_2957) <> true) then
                                                    0
                                                else
                                                    {3007}let (=OpenSecureChannelResponse,Ns_2965: bitstring,ST_2966: bitstring,TTL_2967: bitstring) = m2_2964 in
                                                    {3008}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3009}event endCli(Sess,Cli,Ns_2965)
                                            )
                                            else
                                                {3010}let v_2968: bool = (Sess = B) in
                                                (
                                                    {3011}if v_2968 then
                                                    (
                                                        {3012}let pkSess_2969: bitstring = pub(skB) in
                                                        {3013}out(c, GetEndpointRequest);
                                                        {3014}in(c, (=GetEndpointResponse,=pkSess_2969,=Sign,SP_2970: bitstring,UP_2971: bitstring));
                                                        {3015}new Nc_2972: bitstring;
                                                        {3016}let m1_2973: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2972) in
                                                        {3017}event beginCli(Cli,Sess,Nc_2972);
                                                        {3018}out(c, (pkCli_2789,m1_2973,sign(h(m1_2973),skCli_2788)));
                                                        {3019}in(c, (em2_2974: bitstring,sigM2_2975: bitstring));
                                                        {3020}let m2_2976: bitstring = em2_2974 in
                                                        {3021}if (verify(h(m2_2976),sigM2_2975,pkSess_2969) <> true) then
                                                            0
                                                        else
                                                            {3022}let (=OpenSecureChannelResponse,Ns_2977: bitstring,ST_2978: bitstring,TTL_2979: bitstring) = m2_2976 in
                                                            {3023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3024}event endCli(Sess,Cli,Ns_2977)
                                                    )
                                                    else
                                                        {3025}let v_2980: bool = (Sess = C) in
                                                        (
                                                            {3026}if v_2980 then
                                                            (
                                                                {3027}let pkSess_2981: bitstring = pub(skC) in
                                                                {3028}out(c, GetEndpointRequest);
                                                                {3029}in(c, (=GetEndpointResponse,=pkSess_2981,=Sign,SP_2982: bitstring,UP_2983: bitstring));
                                                                {3030}new Nc_2984: bitstring;
                                                                {3031}let m1_2985: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2984) in
                                                                {3032}event beginCli(Cli,Sess,Nc_2984);
                                                                {3033}out(c, (pkCli_2789,m1_2985,sign(h(m1_2985),skCli_2788)));
                                                                {3034}in(c, (em2_2986: bitstring,sigM2_2987: bitstring));
                                                                {3035}let m2_2988: bitstring = em2_2986 in
                                                                {3036}if (verify(h(m2_2988),sigM2_2987,pkSess_2981) <> true) then
                                                                    0
                                                                else
                                                                    {3037}let (=OpenSecureChannelResponse,Ns_2989: bitstring,ST_2990: bitstring,TTL_2991: bitstring) = m2_2988 in
                                                                    {3038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3039}event endCli(Sess,Cli,Ns_2989)
                                                            )
                                                            else
                                                                {3040}let pkSess_2992: bitstring = pub(sk(Sess)) in
                                                                {3041}out(c, GetEndpointRequest);
                                                                {3042}in(c, (=GetEndpointResponse,=pkSess_2992,=Sign,SP_2993: bitstring,UP_2994: bitstring));
                                                                {3043}new Nc_2995: bitstring;
                                                                {3044}let m1_2996: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_2995) in
                                                                {3045}event beginCli(Cli,Sess,Nc_2995);
                                                                {3046}out(c, (pkCli_2789,m1_2996,sign(h(m1_2996),skCli_2788)));
                                                                {3047}in(c, (em2_2997: bitstring,sigM2_2998: bitstring));
                                                                {3048}let m2_2999: bitstring = em2_2997 in
                                                                {3049}if (verify(h(m2_2999),sigM2_2998,pkSess_2992) <> true) then
                                                                    0
                                                                else
                                                                    {3050}let (=OpenSecureChannelResponse,Ns_3000: bitstring,ST_3001: bitstring,TTL_3002: bitstring) = m2_2999 in
                                                                    {3051}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3052}event endCli(Sess,Cli,Ns_3000)
                                                        )
                                                        else
                                                            {3053}let pkSess_3003: bitstring = fail-any in
                                                            {3054}out(c, GetEndpointRequest);
                                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3003,=Sign,SP_3004: bitstring,UP_3005: bitstring));
                                                            {3056}new Nc_3006: bitstring;
                                                            {3057}let m1_3007: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3006) in
                                                            {3058}event beginCli(Cli,Sess,Nc_3006);
                                                            {3059}out(c, (pkCli_2789,m1_3007,sign(h(m1_3007),skCli_2788)));
                                                            {3060}in(c, (em2_3008: bitstring,sigM2_3009: bitstring));
                                                            {3061}let m2_3010: bitstring = em2_3008 in
                                                            {3062}if (verify(h(m2_3010),sigM2_3009,pkSess_3003) <> true) then
                                                                0
                                                            else
                                                                {3063}let (=OpenSecureChannelResponse,Ns_3011: bitstring,ST_3012: bitstring,TTL_3013: bitstring) = m2_3010 in
                                                                {3064}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3065}event endCli(Sess,Cli,Ns_3011)
                                                )
                                                else
                                                    {3066}let pkSess_3014: bitstring = fail-any in
                                                    {3067}out(c, GetEndpointRequest);
                                                    {3068}in(c, (=GetEndpointResponse,=pkSess_3014,=Sign,SP_3015: bitstring,UP_3016: bitstring));
                                                    {3069}new Nc_3017: bitstring;
                                                    {3070}let m1_3018: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3017) in
                                                    {3071}event beginCli(Cli,Sess,Nc_3017);
                                                    {3072}out(c, (pkCli_2789,m1_3018,sign(h(m1_3018),skCli_2788)));
                                                    {3073}in(c, (em2_3019: bitstring,sigM2_3020: bitstring));
                                                    {3074}let m2_3021: bitstring = em2_3019 in
                                                    {3075}if (verify(h(m2_3021),sigM2_3020,pkSess_3014) <> true) then
                                                        0
                                                    else
                                                        {3076}let (=OpenSecureChannelResponse,Ns_3022: bitstring,ST_3023: bitstring,TTL_3024: bitstring) = m2_3021 in
                                                        {3077}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3078}event endCli(Sess,Cli,Ns_3022)
                                        )
                                        else
                                            {3079}let pkSess_3025: bitstring = fail-any in
                                            {3080}out(c, GetEndpointRequest);
                                            {3081}in(c, (=GetEndpointResponse,=pkSess_3025,=Sign,SP_3026: bitstring,UP_3027: bitstring));
                                            {3082}new Nc_3028: bitstring;
                                            {3083}let m1_3029: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3028) in
                                            {3084}event beginCli(Cli,Sess,Nc_3028);
                                            {3085}out(c, (pkCli_2789,m1_3029,sign(h(m1_3029),skCli_2788)));
                                            {3086}in(c, (em2_3030: bitstring,sigM2_3031: bitstring));
                                            {3087}let m2_3032: bitstring = em2_3030 in
                                            {3088}if (verify(h(m2_3032),sigM2_3031,pkSess_3025) <> true) then
                                                0
                                            else
                                                {3089}let (=OpenSecureChannelResponse,Ns_3033: bitstring,ST_3034: bitstring,TTL_3035: bitstring) = m2_3032 in
                                                {3090}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3091}event endCli(Sess,Cli,Ns_3033)
                                    )
                                    else
                                        {3092}let pkDisco_3036: bitstring = pub(sk(Disco)) in
                                        {3093}let v_3037: bool = (Sess = A) in
                                        (
                                            {3094}if v_3037 then
                                            (
                                                {3095}let pkSess_3038: bitstring = pub(skA) in
                                                {3096}out(c, GetEndpointRequest);
                                                {3097}in(c, (=GetEndpointResponse,=pkSess_3038,=Sign,SP_3039: bitstring,UP_3040: bitstring));
                                                {3098}new Nc_3041: bitstring;
                                                {3099}let m1_3042: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3041) in
                                                {3100}event beginCli(Cli,Sess,Nc_3041);
                                                {3101}out(c, (pkCli_2789,m1_3042,sign(h(m1_3042),skCli_2788)));
                                                {3102}in(c, (em2_3043: bitstring,sigM2_3044: bitstring));
                                                {3103}let m2_3045: bitstring = em2_3043 in
                                                {3104}if (verify(h(m2_3045),sigM2_3044,pkSess_3038) <> true) then
                                                    0
                                                else
                                                    {3105}let (=OpenSecureChannelResponse,Ns_3046: bitstring,ST_3047: bitstring,TTL_3048: bitstring) = m2_3045 in
                                                    {3106}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3107}event endCli(Sess,Cli,Ns_3046)
                                            )
                                            else
                                                {3108}let v_3049: bool = (Sess = B) in
                                                (
                                                    {3109}if v_3049 then
                                                    (
                                                        {3110}let pkSess_3050: bitstring = pub(skB) in
                                                        {3111}out(c, GetEndpointRequest);
                                                        {3112}in(c, (=GetEndpointResponse,=pkSess_3050,=Sign,SP_3051: bitstring,UP_3052: bitstring));
                                                        {3113}new Nc_3053: bitstring;
                                                        {3114}let m1_3054: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3053) in
                                                        {3115}event beginCli(Cli,Sess,Nc_3053);
                                                        {3116}out(c, (pkCli_2789,m1_3054,sign(h(m1_3054),skCli_2788)));
                                                        {3117}in(c, (em2_3055: bitstring,sigM2_3056: bitstring));
                                                        {3118}let m2_3057: bitstring = em2_3055 in
                                                        {3119}if (verify(h(m2_3057),sigM2_3056,pkSess_3050) <> true) then
                                                            0
                                                        else
                                                            {3120}let (=OpenSecureChannelResponse,Ns_3058: bitstring,ST_3059: bitstring,TTL_3060: bitstring) = m2_3057 in
                                                            {3121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3122}event endCli(Sess,Cli,Ns_3058)
                                                    )
                                                    else
                                                        {3123}let v_3061: bool = (Sess = C) in
                                                        (
                                                            {3124}if v_3061 then
                                                            (
                                                                {3125}let pkSess_3062: bitstring = pub(skC) in
                                                                {3126}out(c, GetEndpointRequest);
                                                                {3127}in(c, (=GetEndpointResponse,=pkSess_3062,=Sign,SP_3063: bitstring,UP_3064: bitstring));
                                                                {3128}new Nc_3065: bitstring;
                                                                {3129}let m1_3066: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3065) in
                                                                {3130}event beginCli(Cli,Sess,Nc_3065);
                                                                {3131}out(c, (pkCli_2789,m1_3066,sign(h(m1_3066),skCli_2788)));
                                                                {3132}in(c, (em2_3067: bitstring,sigM2_3068: bitstring));
                                                                {3133}let m2_3069: bitstring = em2_3067 in
                                                                {3134}if (verify(h(m2_3069),sigM2_3068,pkSess_3062) <> true) then
                                                                    0
                                                                else
                                                                    {3135}let (=OpenSecureChannelResponse,Ns_3070: bitstring,ST_3071: bitstring,TTL_3072: bitstring) = m2_3069 in
                                                                    {3136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3137}event endCli(Sess,Cli,Ns_3070)
                                                            )
                                                            else
                                                                {3138}let pkSess_3073: bitstring = pub(sk(Sess)) in
                                                                {3139}out(c, GetEndpointRequest);
                                                                {3140}in(c, (=GetEndpointResponse,=pkSess_3073,=Sign,SP_3074: bitstring,UP_3075: bitstring));
                                                                {3141}new Nc_3076: bitstring;
                                                                {3142}let m1_3077: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3076) in
                                                                {3143}event beginCli(Cli,Sess,Nc_3076);
                                                                {3144}out(c, (pkCli_2789,m1_3077,sign(h(m1_3077),skCli_2788)));
                                                                {3145}in(c, (em2_3078: bitstring,sigM2_3079: bitstring));
                                                                {3146}let m2_3080: bitstring = em2_3078 in
                                                                {3147}if (verify(h(m2_3080),sigM2_3079,pkSess_3073) <> true) then
                                                                    0
                                                                else
                                                                    {3148}let (=OpenSecureChannelResponse,Ns_3081: bitstring,ST_3082: bitstring,TTL_3083: bitstring) = m2_3080 in
                                                                    {3149}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3150}event endCli(Sess,Cli,Ns_3081)
                                                        )
                                                        else
                                                            {3151}let pkSess_3084: bitstring = fail-any in
                                                            {3152}out(c, GetEndpointRequest);
                                                            {3153}in(c, (=GetEndpointResponse,=pkSess_3084,=Sign,SP_3085: bitstring,UP_3086: bitstring));
                                                            {3154}new Nc_3087: bitstring;
                                                            {3155}let m1_3088: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3087) in
                                                            {3156}event beginCli(Cli,Sess,Nc_3087);
                                                            {3157}out(c, (pkCli_2789,m1_3088,sign(h(m1_3088),skCli_2788)));
                                                            {3158}in(c, (em2_3089: bitstring,sigM2_3090: bitstring));
                                                            {3159}let m2_3091: bitstring = em2_3089 in
                                                            {3160}if (verify(h(m2_3091),sigM2_3090,pkSess_3084) <> true) then
                                                                0
                                                            else
                                                                {3161}let (=OpenSecureChannelResponse,Ns_3092: bitstring,ST_3093: bitstring,TTL_3094: bitstring) = m2_3091 in
                                                                {3162}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3163}event endCli(Sess,Cli,Ns_3092)
                                                )
                                                else
                                                    {3164}let pkSess_3095: bitstring = fail-any in
                                                    {3165}out(c, GetEndpointRequest);
                                                    {3166}in(c, (=GetEndpointResponse,=pkSess_3095,=Sign,SP_3096: bitstring,UP_3097: bitstring));
                                                    {3167}new Nc_3098: bitstring;
                                                    {3168}let m1_3099: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3098) in
                                                    {3169}event beginCli(Cli,Sess,Nc_3098);
                                                    {3170}out(c, (pkCli_2789,m1_3099,sign(h(m1_3099),skCli_2788)));
                                                    {3171}in(c, (em2_3100: bitstring,sigM2_3101: bitstring));
                                                    {3172}let m2_3102: bitstring = em2_3100 in
                                                    {3173}if (verify(h(m2_3102),sigM2_3101,pkSess_3095) <> true) then
                                                        0
                                                    else
                                                        {3174}let (=OpenSecureChannelResponse,Ns_3103: bitstring,ST_3104: bitstring,TTL_3105: bitstring) = m2_3102 in
                                                        {3175}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3176}event endCli(Sess,Cli,Ns_3103)
                                        )
                                        else
                                            {3177}let pkSess_3106: bitstring = fail-any in
                                            {3178}out(c, GetEndpointRequest);
                                            {3179}in(c, (=GetEndpointResponse,=pkSess_3106,=Sign,SP_3107: bitstring,UP_3108: bitstring));
                                            {3180}new Nc_3109: bitstring;
                                            {3181}let m1_3110: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3109) in
                                            {3182}event beginCli(Cli,Sess,Nc_3109);
                                            {3183}out(c, (pkCli_2789,m1_3110,sign(h(m1_3110),skCli_2788)));
                                            {3184}in(c, (em2_3111: bitstring,sigM2_3112: bitstring));
                                            {3185}let m2_3113: bitstring = em2_3111 in
                                            {3186}if (verify(h(m2_3113),sigM2_3112,pkSess_3106) <> true) then
                                                0
                                            else
                                                {3187}let (=OpenSecureChannelResponse,Ns_3114: bitstring,ST_3115: bitstring,TTL_3116: bitstring) = m2_3113 in
                                                {3188}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3189}event endCli(Sess,Cli,Ns_3114)
                                )
                                else
                                    {3190}let pkDisco_3117: bitstring = fail-any in
                                    {3191}let v_3118: bool = (Sess = A) in
                                    (
                                        {3192}if v_3118 then
                                        (
                                            {3193}let pkSess_3119: bitstring = pub(skA) in
                                            {3194}out(c, GetEndpointRequest);
                                            {3195}in(c, (=GetEndpointResponse,=pkSess_3119,=Sign,SP_3120: bitstring,UP_3121: bitstring));
                                            {3196}new Nc_3122: bitstring;
                                            {3197}let m1_3123: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3122) in
                                            {3198}event beginCli(Cli,Sess,Nc_3122);
                                            {3199}out(c, (pkCli_2789,m1_3123,sign(h(m1_3123),skCli_2788)));
                                            {3200}in(c, (em2_3124: bitstring,sigM2_3125: bitstring));
                                            {3201}let m2_3126: bitstring = em2_3124 in
                                            {3202}if (verify(h(m2_3126),sigM2_3125,pkSess_3119) <> true) then
                                                0
                                            else
                                                {3203}let (=OpenSecureChannelResponse,Ns_3127: bitstring,ST_3128: bitstring,TTL_3129: bitstring) = m2_3126 in
                                                {3204}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3205}event endCli(Sess,Cli,Ns_3127)
                                        )
                                        else
                                            {3206}let v_3130: bool = (Sess = B) in
                                            (
                                                {3207}if v_3130 then
                                                (
                                                    {3208}let pkSess_3131: bitstring = pub(skB) in
                                                    {3209}out(c, GetEndpointRequest);
                                                    {3210}in(c, (=GetEndpointResponse,=pkSess_3131,=Sign,SP_3132: bitstring,UP_3133: bitstring));
                                                    {3211}new Nc_3134: bitstring;
                                                    {3212}let m1_3135: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3134) in
                                                    {3213}event beginCli(Cli,Sess,Nc_3134);
                                                    {3214}out(c, (pkCli_2789,m1_3135,sign(h(m1_3135),skCli_2788)));
                                                    {3215}in(c, (em2_3136: bitstring,sigM2_3137: bitstring));
                                                    {3216}let m2_3138: bitstring = em2_3136 in
                                                    {3217}if (verify(h(m2_3138),sigM2_3137,pkSess_3131) <> true) then
                                                        0
                                                    else
                                                        {3218}let (=OpenSecureChannelResponse,Ns_3139: bitstring,ST_3140: bitstring,TTL_3141: bitstring) = m2_3138 in
                                                        {3219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3220}event endCli(Sess,Cli,Ns_3139)
                                                )
                                                else
                                                    {3221}let v_3142: bool = (Sess = C) in
                                                    (
                                                        {3222}if v_3142 then
                                                        (
                                                            {3223}let pkSess_3143: bitstring = pub(skC) in
                                                            {3224}out(c, GetEndpointRequest);
                                                            {3225}in(c, (=GetEndpointResponse,=pkSess_3143,=Sign,SP_3144: bitstring,UP_3145: bitstring));
                                                            {3226}new Nc_3146: bitstring;
                                                            {3227}let m1_3147: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3146) in
                                                            {3228}event beginCli(Cli,Sess,Nc_3146);
                                                            {3229}out(c, (pkCli_2789,m1_3147,sign(h(m1_3147),skCli_2788)));
                                                            {3230}in(c, (em2_3148: bitstring,sigM2_3149: bitstring));
                                                            {3231}let m2_3150: bitstring = em2_3148 in
                                                            {3232}if (verify(h(m2_3150),sigM2_3149,pkSess_3143) <> true) then
                                                                0
                                                            else
                                                                {3233}let (=OpenSecureChannelResponse,Ns_3151: bitstring,ST_3152: bitstring,TTL_3153: bitstring) = m2_3150 in
                                                                {3234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3235}event endCli(Sess,Cli,Ns_3151)
                                                        )
                                                        else
                                                            {3236}let pkSess_3154: bitstring = pub(sk(Sess)) in
                                                            {3237}out(c, GetEndpointRequest);
                                                            {3238}in(c, (=GetEndpointResponse,=pkSess_3154,=Sign,SP_3155: bitstring,UP_3156: bitstring));
                                                            {3239}new Nc_3157: bitstring;
                                                            {3240}let m1_3158: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3157) in
                                                            {3241}event beginCli(Cli,Sess,Nc_3157);
                                                            {3242}out(c, (pkCli_2789,m1_3158,sign(h(m1_3158),skCli_2788)));
                                                            {3243}in(c, (em2_3159: bitstring,sigM2_3160: bitstring));
                                                            {3244}let m2_3161: bitstring = em2_3159 in
                                                            {3245}if (verify(h(m2_3161),sigM2_3160,pkSess_3154) <> true) then
                                                                0
                                                            else
                                                                {3246}let (=OpenSecureChannelResponse,Ns_3162: bitstring,ST_3163: bitstring,TTL_3164: bitstring) = m2_3161 in
                                                                {3247}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3248}event endCli(Sess,Cli,Ns_3162)
                                                    )
                                                    else
                                                        {3249}let pkSess_3165: bitstring = fail-any in
                                                        {3250}out(c, GetEndpointRequest);
                                                        {3251}in(c, (=GetEndpointResponse,=pkSess_3165,=Sign,SP_3166: bitstring,UP_3167: bitstring));
                                                        {3252}new Nc_3168: bitstring;
                                                        {3253}let m1_3169: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3168) in
                                                        {3254}event beginCli(Cli,Sess,Nc_3168);
                                                        {3255}out(c, (pkCli_2789,m1_3169,sign(h(m1_3169),skCli_2788)));
                                                        {3256}in(c, (em2_3170: bitstring,sigM2_3171: bitstring));
                                                        {3257}let m2_3172: bitstring = em2_3170 in
                                                        {3258}if (verify(h(m2_3172),sigM2_3171,pkSess_3165) <> true) then
                                                            0
                                                        else
                                                            {3259}let (=OpenSecureChannelResponse,Ns_3173: bitstring,ST_3174: bitstring,TTL_3175: bitstring) = m2_3172 in
                                                            {3260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3261}event endCli(Sess,Cli,Ns_3173)
                                            )
                                            else
                                                {3262}let pkSess_3176: bitstring = fail-any in
                                                {3263}out(c, GetEndpointRequest);
                                                {3264}in(c, (=GetEndpointResponse,=pkSess_3176,=Sign,SP_3177: bitstring,UP_3178: bitstring));
                                                {3265}new Nc_3179: bitstring;
                                                {3266}let m1_3180: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3179) in
                                                {3267}event beginCli(Cli,Sess,Nc_3179);
                                                {3268}out(c, (pkCli_2789,m1_3180,sign(h(m1_3180),skCli_2788)));
                                                {3269}in(c, (em2_3181: bitstring,sigM2_3182: bitstring));
                                                {3270}let m2_3183: bitstring = em2_3181 in
                                                {3271}if (verify(h(m2_3183),sigM2_3182,pkSess_3176) <> true) then
                                                    0
                                                else
                                                    {3272}let (=OpenSecureChannelResponse,Ns_3184: bitstring,ST_3185: bitstring,TTL_3186: bitstring) = m2_3183 in
                                                    {3273}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3274}event endCli(Sess,Cli,Ns_3184)
                                    )
                                    else
                                        {3275}let pkSess_3187: bitstring = fail-any in
                                        {3276}out(c, GetEndpointRequest);
                                        {3277}in(c, (=GetEndpointResponse,=pkSess_3187,=Sign,SP_3188: bitstring,UP_3189: bitstring));
                                        {3278}new Nc_3190: bitstring;
                                        {3279}let m1_3191: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3190) in
                                        {3280}event beginCli(Cli,Sess,Nc_3190);
                                        {3281}out(c, (pkCli_2789,m1_3191,sign(h(m1_3191),skCli_2788)));
                                        {3282}in(c, (em2_3192: bitstring,sigM2_3193: bitstring));
                                        {3283}let m2_3194: bitstring = em2_3192 in
                                        {3284}if (verify(h(m2_3194),sigM2_3193,pkSess_3187) <> true) then
                                            0
                                        else
                                            {3285}let (=OpenSecureChannelResponse,Ns_3195: bitstring,ST_3196: bitstring,TTL_3197: bitstring) = m2_3194 in
                                            {3286}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3287}event endCli(Sess,Cli,Ns_3195)
                        )
                        else
                            {3288}let pkDisco_3198: bitstring = fail-any in
                            {3289}let v_3199: bool = (Sess = A) in
                            (
                                {3290}if v_3199 then
                                (
                                    {3291}let pkSess_3200: bitstring = pub(skA) in
                                    {3292}out(c, GetEndpointRequest);
                                    {3293}in(c, (=GetEndpointResponse,=pkSess_3200,=Sign,SP_3201: bitstring,UP_3202: bitstring));
                                    {3294}new Nc_3203: bitstring;
                                    {3295}let m1_3204: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3203) in
                                    {3296}event beginCli(Cli,Sess,Nc_3203);
                                    {3297}out(c, (pkCli_2789,m1_3204,sign(h(m1_3204),skCli_2788)));
                                    {3298}in(c, (em2_3205: bitstring,sigM2_3206: bitstring));
                                    {3299}let m2_3207: bitstring = em2_3205 in
                                    {3300}if (verify(h(m2_3207),sigM2_3206,pkSess_3200) <> true) then
                                        0
                                    else
                                        {3301}let (=OpenSecureChannelResponse,Ns_3208: bitstring,ST_3209: bitstring,TTL_3210: bitstring) = m2_3207 in
                                        {3302}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3303}event endCli(Sess,Cli,Ns_3208)
                                )
                                else
                                    {3304}let v_3211: bool = (Sess = B) in
                                    (
                                        {3305}if v_3211 then
                                        (
                                            {3306}let pkSess_3212: bitstring = pub(skB) in
                                            {3307}out(c, GetEndpointRequest);
                                            {3308}in(c, (=GetEndpointResponse,=pkSess_3212,=Sign,SP_3213: bitstring,UP_3214: bitstring));
                                            {3309}new Nc_3215: bitstring;
                                            {3310}let m1_3216: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3215) in
                                            {3311}event beginCli(Cli,Sess,Nc_3215);
                                            {3312}out(c, (pkCli_2789,m1_3216,sign(h(m1_3216),skCli_2788)));
                                            {3313}in(c, (em2_3217: bitstring,sigM2_3218: bitstring));
                                            {3314}let m2_3219: bitstring = em2_3217 in
                                            {3315}if (verify(h(m2_3219),sigM2_3218,pkSess_3212) <> true) then
                                                0
                                            else
                                                {3316}let (=OpenSecureChannelResponse,Ns_3220: bitstring,ST_3221: bitstring,TTL_3222: bitstring) = m2_3219 in
                                                {3317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3318}event endCli(Sess,Cli,Ns_3220)
                                        )
                                        else
                                            {3319}let v_3223: bool = (Sess = C) in
                                            (
                                                {3320}if v_3223 then
                                                (
                                                    {3321}let pkSess_3224: bitstring = pub(skC) in
                                                    {3322}out(c, GetEndpointRequest);
                                                    {3323}in(c, (=GetEndpointResponse,=pkSess_3224,=Sign,SP_3225: bitstring,UP_3226: bitstring));
                                                    {3324}new Nc_3227: bitstring;
                                                    {3325}let m1_3228: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3227) in
                                                    {3326}event beginCli(Cli,Sess,Nc_3227);
                                                    {3327}out(c, (pkCli_2789,m1_3228,sign(h(m1_3228),skCli_2788)));
                                                    {3328}in(c, (em2_3229: bitstring,sigM2_3230: bitstring));
                                                    {3329}let m2_3231: bitstring = em2_3229 in
                                                    {3330}if (verify(h(m2_3231),sigM2_3230,pkSess_3224) <> true) then
                                                        0
                                                    else
                                                        {3331}let (=OpenSecureChannelResponse,Ns_3232: bitstring,ST_3233: bitstring,TTL_3234: bitstring) = m2_3231 in
                                                        {3332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3333}event endCli(Sess,Cli,Ns_3232)
                                                )
                                                else
                                                    {3334}let pkSess_3235: bitstring = pub(sk(Sess)) in
                                                    {3335}out(c, GetEndpointRequest);
                                                    {3336}in(c, (=GetEndpointResponse,=pkSess_3235,=Sign,SP_3236: bitstring,UP_3237: bitstring));
                                                    {3337}new Nc_3238: bitstring;
                                                    {3338}let m1_3239: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3238) in
                                                    {3339}event beginCli(Cli,Sess,Nc_3238);
                                                    {3340}out(c, (pkCli_2789,m1_3239,sign(h(m1_3239),skCli_2788)));
                                                    {3341}in(c, (em2_3240: bitstring,sigM2_3241: bitstring));
                                                    {3342}let m2_3242: bitstring = em2_3240 in
                                                    {3343}if (verify(h(m2_3242),sigM2_3241,pkSess_3235) <> true) then
                                                        0
                                                    else
                                                        {3344}let (=OpenSecureChannelResponse,Ns_3243: bitstring,ST_3244: bitstring,TTL_3245: bitstring) = m2_3242 in
                                                        {3345}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3346}event endCli(Sess,Cli,Ns_3243)
                                            )
                                            else
                                                {3347}let pkSess_3246: bitstring = fail-any in
                                                {3348}out(c, GetEndpointRequest);
                                                {3349}in(c, (=GetEndpointResponse,=pkSess_3246,=Sign,SP_3247: bitstring,UP_3248: bitstring));
                                                {3350}new Nc_3249: bitstring;
                                                {3351}let m1_3250: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3249) in
                                                {3352}event beginCli(Cli,Sess,Nc_3249);
                                                {3353}out(c, (pkCli_2789,m1_3250,sign(h(m1_3250),skCli_2788)));
                                                {3354}in(c, (em2_3251: bitstring,sigM2_3252: bitstring));
                                                {3355}let m2_3253: bitstring = em2_3251 in
                                                {3356}if (verify(h(m2_3253),sigM2_3252,pkSess_3246) <> true) then
                                                    0
                                                else
                                                    {3357}let (=OpenSecureChannelResponse,Ns_3254: bitstring,ST_3255: bitstring,TTL_3256: bitstring) = m2_3253 in
                                                    {3358}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3359}event endCli(Sess,Cli,Ns_3254)
                                    )
                                    else
                                        {3360}let pkSess_3257: bitstring = fail-any in
                                        {3361}out(c, GetEndpointRequest);
                                        {3362}in(c, (=GetEndpointResponse,=pkSess_3257,=Sign,SP_3258: bitstring,UP_3259: bitstring));
                                        {3363}new Nc_3260: bitstring;
                                        {3364}let m1_3261: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3260) in
                                        {3365}event beginCli(Cli,Sess,Nc_3260);
                                        {3366}out(c, (pkCli_2789,m1_3261,sign(h(m1_3261),skCli_2788)));
                                        {3367}in(c, (em2_3262: bitstring,sigM2_3263: bitstring));
                                        {3368}let m2_3264: bitstring = em2_3262 in
                                        {3369}if (verify(h(m2_3264),sigM2_3263,pkSess_3257) <> true) then
                                            0
                                        else
                                            {3370}let (=OpenSecureChannelResponse,Ns_3265: bitstring,ST_3266: bitstring,TTL_3267: bitstring) = m2_3264 in
                                            {3371}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3372}event endCli(Sess,Cli,Ns_3265)
                            )
                            else
                                {3373}let pkSess_3268: bitstring = fail-any in
                                {3374}out(c, GetEndpointRequest);
                                {3375}in(c, (=GetEndpointResponse,=pkSess_3268,=Sign,SP_3269: bitstring,UP_3270: bitstring));
                                {3376}new Nc_3271: bitstring;
                                {3377}let m1_3272: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3271) in
                                {3378}event beginCli(Cli,Sess,Nc_3271);
                                {3379}out(c, (pkCli_2789,m1_3272,sign(h(m1_3272),skCli_2788)));
                                {3380}in(c, (em2_3273: bitstring,sigM2_3274: bitstring));
                                {3381}let m2_3275: bitstring = em2_3273 in
                                {3382}if (verify(h(m2_3275),sigM2_3274,pkSess_3268) <> true) then
                                    0
                                else
                                    {3383}let (=OpenSecureChannelResponse,Ns_3276: bitstring,ST_3277: bitstring,TTL_3278: bitstring) = m2_3275 in
                                    {3384}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3385}event endCli(Sess,Cli,Ns_3276)
                )
                else
                    {3386}let pkDisco_3279: bitstring = fail-any in
                    {3387}let v_3280: bool = (Sess = A) in
                    (
                        {3388}if v_3280 then
                        (
                            {3389}let pkSess_3281: bitstring = pub(skA) in
                            {3390}out(c, GetEndpointRequest);
                            {3391}in(c, (=GetEndpointResponse,=pkSess_3281,=Sign,SP_3282: bitstring,UP_3283: bitstring));
                            {3392}new Nc_3284: bitstring;
                            {3393}let m1_3285: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3284) in
                            {3394}event beginCli(Cli,Sess,Nc_3284);
                            {3395}out(c, (pkCli_2789,m1_3285,sign(h(m1_3285),skCli_2788)));
                            {3396}in(c, (em2_3286: bitstring,sigM2_3287: bitstring));
                            {3397}let m2_3288: bitstring = em2_3286 in
                            {3398}if (verify(h(m2_3288),sigM2_3287,pkSess_3281) <> true) then
                                0
                            else
                                {3399}let (=OpenSecureChannelResponse,Ns_3289: bitstring,ST_3290: bitstring,TTL_3291: bitstring) = m2_3288 in
                                {3400}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3401}event endCli(Sess,Cli,Ns_3289)
                        )
                        else
                            {3402}let v_3292: bool = (Sess = B) in
                            (
                                {3403}if v_3292 then
                                (
                                    {3404}let pkSess_3293: bitstring = pub(skB) in
                                    {3405}out(c, GetEndpointRequest);
                                    {3406}in(c, (=GetEndpointResponse,=pkSess_3293,=Sign,SP_3294: bitstring,UP_3295: bitstring));
                                    {3407}new Nc_3296: bitstring;
                                    {3408}let m1_3297: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3296) in
                                    {3409}event beginCli(Cli,Sess,Nc_3296);
                                    {3410}out(c, (pkCli_2789,m1_3297,sign(h(m1_3297),skCli_2788)));
                                    {3411}in(c, (em2_3298: bitstring,sigM2_3299: bitstring));
                                    {3412}let m2_3300: bitstring = em2_3298 in
                                    {3413}if (verify(h(m2_3300),sigM2_3299,pkSess_3293) <> true) then
                                        0
                                    else
                                        {3414}let (=OpenSecureChannelResponse,Ns_3301: bitstring,ST_3302: bitstring,TTL_3303: bitstring) = m2_3300 in
                                        {3415}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3416}event endCli(Sess,Cli,Ns_3301)
                                )
                                else
                                    {3417}let v_3304: bool = (Sess = C) in
                                    (
                                        {3418}if v_3304 then
                                        (
                                            {3419}let pkSess_3305: bitstring = pub(skC) in
                                            {3420}out(c, GetEndpointRequest);
                                            {3421}in(c, (=GetEndpointResponse,=pkSess_3305,=Sign,SP_3306: bitstring,UP_3307: bitstring));
                                            {3422}new Nc_3308: bitstring;
                                            {3423}let m1_3309: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3308) in
                                            {3424}event beginCli(Cli,Sess,Nc_3308);
                                            {3425}out(c, (pkCli_2789,m1_3309,sign(h(m1_3309),skCli_2788)));
                                            {3426}in(c, (em2_3310: bitstring,sigM2_3311: bitstring));
                                            {3427}let m2_3312: bitstring = em2_3310 in
                                            {3428}if (verify(h(m2_3312),sigM2_3311,pkSess_3305) <> true) then
                                                0
                                            else
                                                {3429}let (=OpenSecureChannelResponse,Ns_3313: bitstring,ST_3314: bitstring,TTL_3315: bitstring) = m2_3312 in
                                                {3430}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3431}event endCli(Sess,Cli,Ns_3313)
                                        )
                                        else
                                            {3432}let pkSess_3316: bitstring = pub(sk(Sess)) in
                                            {3433}out(c, GetEndpointRequest);
                                            {3434}in(c, (=GetEndpointResponse,=pkSess_3316,=Sign,SP_3317: bitstring,UP_3318: bitstring));
                                            {3435}new Nc_3319: bitstring;
                                            {3436}let m1_3320: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3319) in
                                            {3437}event beginCli(Cli,Sess,Nc_3319);
                                            {3438}out(c, (pkCli_2789,m1_3320,sign(h(m1_3320),skCli_2788)));
                                            {3439}in(c, (em2_3321: bitstring,sigM2_3322: bitstring));
                                            {3440}let m2_3323: bitstring = em2_3321 in
                                            {3441}if (verify(h(m2_3323),sigM2_3322,pkSess_3316) <> true) then
                                                0
                                            else
                                                {3442}let (=OpenSecureChannelResponse,Ns_3324: bitstring,ST_3325: bitstring,TTL_3326: bitstring) = m2_3323 in
                                                {3443}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3444}event endCli(Sess,Cli,Ns_3324)
                                    )
                                    else
                                        {3445}let pkSess_3327: bitstring = fail-any in
                                        {3446}out(c, GetEndpointRequest);
                                        {3447}in(c, (=GetEndpointResponse,=pkSess_3327,=Sign,SP_3328: bitstring,UP_3329: bitstring));
                                        {3448}new Nc_3330: bitstring;
                                        {3449}let m1_3331: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3330) in
                                        {3450}event beginCli(Cli,Sess,Nc_3330);
                                        {3451}out(c, (pkCli_2789,m1_3331,sign(h(m1_3331),skCli_2788)));
                                        {3452}in(c, (em2_3332: bitstring,sigM2_3333: bitstring));
                                        {3453}let m2_3334: bitstring = em2_3332 in
                                        {3454}if (verify(h(m2_3334),sigM2_3333,pkSess_3327) <> true) then
                                            0
                                        else
                                            {3455}let (=OpenSecureChannelResponse,Ns_3335: bitstring,ST_3336: bitstring,TTL_3337: bitstring) = m2_3334 in
                                            {3456}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3457}event endCli(Sess,Cli,Ns_3335)
                            )
                            else
                                {3458}let pkSess_3338: bitstring = fail-any in
                                {3459}out(c, GetEndpointRequest);
                                {3460}in(c, (=GetEndpointResponse,=pkSess_3338,=Sign,SP_3339: bitstring,UP_3340: bitstring));
                                {3461}new Nc_3341: bitstring;
                                {3462}let m1_3342: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3341) in
                                {3463}event beginCli(Cli,Sess,Nc_3341);
                                {3464}out(c, (pkCli_2789,m1_3342,sign(h(m1_3342),skCli_2788)));
                                {3465}in(c, (em2_3343: bitstring,sigM2_3344: bitstring));
                                {3466}let m2_3345: bitstring = em2_3343 in
                                {3467}if (verify(h(m2_3345),sigM2_3344,pkSess_3338) <> true) then
                                    0
                                else
                                    {3468}let (=OpenSecureChannelResponse,Ns_3346: bitstring,ST_3347: bitstring,TTL_3348: bitstring) = m2_3345 in
                                    {3469}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3470}event endCli(Sess,Cli,Ns_3346)
                    )
                    else
                        {3471}let pkSess_3349: bitstring = fail-any in
                        {3472}out(c, GetEndpointRequest);
                        {3473}in(c, (=GetEndpointResponse,=pkSess_3349,=Sign,SP_3350: bitstring,UP_3351: bitstring));
                        {3474}new Nc_3352: bitstring;
                        {3475}let m1_3353: bitstring = (OpenSecureChannelRequest,pkCli_2789,Nc_3352) in
                        {3476}event beginCli(Cli,Sess,Nc_3352);
                        {3477}out(c, (pkCli_2789,m1_3353,sign(h(m1_3353),skCli_2788)));
                        {3478}in(c, (em2_3354: bitstring,sigM2_3355: bitstring));
                        {3479}let m2_3356: bitstring = em2_3354 in
                        {3480}if (verify(h(m2_3356),sigM2_3355,pkSess_3349) <> true) then
                            0
                        else
                            {3481}let (=OpenSecureChannelResponse,Ns_3357: bitstring,ST_3358: bitstring,TTL_3359: bitstring) = m2_3356 in
                            {3482}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3483}event endCli(Sess,Cli,Ns_3357)
    )
    else
        {3484}let skCli_3360: bitstring = fail-any in
        {3485}let pkCli_3361: bitstring = pub(skCli_3360) in
        {3486}let v_3362: bool = (Disco = A) in
        (
            {3487}if v_3362 then
            (
                {3488}let pkDisco_3363: bitstring = pub(skA) in
                {3489}let v_3364: bool = (Sess = A) in
                (
                    {3490}if v_3364 then
                    (
                        {3491}let pkSess_3365: bitstring = pub(skA) in
                        {3492}out(c, GetEndpointRequest);
                        {3493}in(c, (=GetEndpointResponse,=pkSess_3365,=Sign,SP_3366: bitstring,UP_3367: bitstring));
                        {3494}new Nc_3368: bitstring;
                        {3495}let m1_3369: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3368) in
                        {3496}event beginCli(Cli,Sess,Nc_3368);
                        {3497}out(c, (pkCli_3361,m1_3369,sign(h(m1_3369),skCli_3360)));
                        {3498}in(c, (em2_3370: bitstring,sigM2_3371: bitstring));
                        {3499}let m2_3372: bitstring = em2_3370 in
                        {3500}if (verify(h(m2_3372),sigM2_3371,pkSess_3365) <> true) then
                            0
                        else
                            {3501}let (=OpenSecureChannelResponse,Ns_3373: bitstring,ST_3374: bitstring,TTL_3375: bitstring) = m2_3372 in
                            {3502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3503}event endCli(Sess,Cli,Ns_3373)
                    )
                    else
                        {3504}let v_3376: bool = (Sess = B) in
                        (
                            {3505}if v_3376 then
                            (
                                {3506}let pkSess_3377: bitstring = pub(skB) in
                                {3507}out(c, GetEndpointRequest);
                                {3508}in(c, (=GetEndpointResponse,=pkSess_3377,=Sign,SP_3378: bitstring,UP_3379: bitstring));
                                {3509}new Nc_3380: bitstring;
                                {3510}let m1_3381: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3380) in
                                {3511}event beginCli(Cli,Sess,Nc_3380);
                                {3512}out(c, (pkCli_3361,m1_3381,sign(h(m1_3381),skCli_3360)));
                                {3513}in(c, (em2_3382: bitstring,sigM2_3383: bitstring));
                                {3514}let m2_3384: bitstring = em2_3382 in
                                {3515}if (verify(h(m2_3384),sigM2_3383,pkSess_3377) <> true) then
                                    0
                                else
                                    {3516}let (=OpenSecureChannelResponse,Ns_3385: bitstring,ST_3386: bitstring,TTL_3387: bitstring) = m2_3384 in
                                    {3517}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3518}event endCli(Sess,Cli,Ns_3385)
                            )
                            else
                                {3519}let v_3388: bool = (Sess = C) in
                                (
                                    {3520}if v_3388 then
                                    (
                                        {3521}let pkSess_3389: bitstring = pub(skC) in
                                        {3522}out(c, GetEndpointRequest);
                                        {3523}in(c, (=GetEndpointResponse,=pkSess_3389,=Sign,SP_3390: bitstring,UP_3391: bitstring));
                                        {3524}new Nc_3392: bitstring;
                                        {3525}let m1_3393: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3392) in
                                        {3526}event beginCli(Cli,Sess,Nc_3392);
                                        {3527}out(c, (pkCli_3361,m1_3393,sign(h(m1_3393),skCli_3360)));
                                        {3528}in(c, (em2_3394: bitstring,sigM2_3395: bitstring));
                                        {3529}let m2_3396: bitstring = em2_3394 in
                                        {3530}if (verify(h(m2_3396),sigM2_3395,pkSess_3389) <> true) then
                                            0
                                        else
                                            {3531}let (=OpenSecureChannelResponse,Ns_3397: bitstring,ST_3398: bitstring,TTL_3399: bitstring) = m2_3396 in
                                            {3532}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3533}event endCli(Sess,Cli,Ns_3397)
                                    )
                                    else
                                        {3534}let pkSess_3400: bitstring = pub(sk(Sess)) in
                                        {3535}out(c, GetEndpointRequest);
                                        {3536}in(c, (=GetEndpointResponse,=pkSess_3400,=Sign,SP_3401: bitstring,UP_3402: bitstring));
                                        {3537}new Nc_3403: bitstring;
                                        {3538}let m1_3404: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3403) in
                                        {3539}event beginCli(Cli,Sess,Nc_3403);
                                        {3540}out(c, (pkCli_3361,m1_3404,sign(h(m1_3404),skCli_3360)));
                                        {3541}in(c, (em2_3405: bitstring,sigM2_3406: bitstring));
                                        {3542}let m2_3407: bitstring = em2_3405 in
                                        {3543}if (verify(h(m2_3407),sigM2_3406,pkSess_3400) <> true) then
                                            0
                                        else
                                            {3544}let (=OpenSecureChannelResponse,Ns_3408: bitstring,ST_3409: bitstring,TTL_3410: bitstring) = m2_3407 in
                                            {3545}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3546}event endCli(Sess,Cli,Ns_3408)
                                )
                                else
                                    {3547}let pkSess_3411: bitstring = fail-any in
                                    {3548}out(c, GetEndpointRequest);
                                    {3549}in(c, (=GetEndpointResponse,=pkSess_3411,=Sign,SP_3412: bitstring,UP_3413: bitstring));
                                    {3550}new Nc_3414: bitstring;
                                    {3551}let m1_3415: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3414) in
                                    {3552}event beginCli(Cli,Sess,Nc_3414);
                                    {3553}out(c, (pkCli_3361,m1_3415,sign(h(m1_3415),skCli_3360)));
                                    {3554}in(c, (em2_3416: bitstring,sigM2_3417: bitstring));
                                    {3555}let m2_3418: bitstring = em2_3416 in
                                    {3556}if (verify(h(m2_3418),sigM2_3417,pkSess_3411) <> true) then
                                        0
                                    else
                                        {3557}let (=OpenSecureChannelResponse,Ns_3419: bitstring,ST_3420: bitstring,TTL_3421: bitstring) = m2_3418 in
                                        {3558}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3559}event endCli(Sess,Cli,Ns_3419)
                        )
                        else
                            {3560}let pkSess_3422: bitstring = fail-any in
                            {3561}out(c, GetEndpointRequest);
                            {3562}in(c, (=GetEndpointResponse,=pkSess_3422,=Sign,SP_3423: bitstring,UP_3424: bitstring));
                            {3563}new Nc_3425: bitstring;
                            {3564}let m1_3426: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3425) in
                            {3565}event beginCli(Cli,Sess,Nc_3425);
                            {3566}out(c, (pkCli_3361,m1_3426,sign(h(m1_3426),skCli_3360)));
                            {3567}in(c, (em2_3427: bitstring,sigM2_3428: bitstring));
                            {3568}let m2_3429: bitstring = em2_3427 in
                            {3569}if (verify(h(m2_3429),sigM2_3428,pkSess_3422) <> true) then
                                0
                            else
                                {3570}let (=OpenSecureChannelResponse,Ns_3430: bitstring,ST_3431: bitstring,TTL_3432: bitstring) = m2_3429 in
                                {3571}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3572}event endCli(Sess,Cli,Ns_3430)
                )
                else
                    {3573}let pkSess_3433: bitstring = fail-any in
                    {3574}out(c, GetEndpointRequest);
                    {3575}in(c, (=GetEndpointResponse,=pkSess_3433,=Sign,SP_3434: bitstring,UP_3435: bitstring));
                    {3576}new Nc_3436: bitstring;
                    {3577}let m1_3437: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3436) in
                    {3578}event beginCli(Cli,Sess,Nc_3436);
                    {3579}out(c, (pkCli_3361,m1_3437,sign(h(m1_3437),skCli_3360)));
                    {3580}in(c, (em2_3438: bitstring,sigM2_3439: bitstring));
                    {3581}let m2_3440: bitstring = em2_3438 in
                    {3582}if (verify(h(m2_3440),sigM2_3439,pkSess_3433) <> true) then
                        0
                    else
                        {3583}let (=OpenSecureChannelResponse,Ns_3441: bitstring,ST_3442: bitstring,TTL_3443: bitstring) = m2_3440 in
                        {3584}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3585}event endCli(Sess,Cli,Ns_3441)
            )
            else
                {3586}let v_3444: bool = (Disco = B) in
                (
                    {3587}if v_3444 then
                    (
                        {3588}let pkDisco_3445: bitstring = pub(skB) in
                        {3589}let v_3446: bool = (Sess = A) in
                        (
                            {3590}if v_3446 then
                            (
                                {3591}let pkSess_3447: bitstring = pub(skA) in
                                {3592}out(c, GetEndpointRequest);
                                {3593}in(c, (=GetEndpointResponse,=pkSess_3447,=Sign,SP_3448: bitstring,UP_3449: bitstring));
                                {3594}new Nc_3450: bitstring;
                                {3595}let m1_3451: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3450) in
                                {3596}event beginCli(Cli,Sess,Nc_3450);
                                {3597}out(c, (pkCli_3361,m1_3451,sign(h(m1_3451),skCli_3360)));
                                {3598}in(c, (em2_3452: bitstring,sigM2_3453: bitstring));
                                {3599}let m2_3454: bitstring = em2_3452 in
                                {3600}if (verify(h(m2_3454),sigM2_3453,pkSess_3447) <> true) then
                                    0
                                else
                                    {3601}let (=OpenSecureChannelResponse,Ns_3455: bitstring,ST_3456: bitstring,TTL_3457: bitstring) = m2_3454 in
                                    {3602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3603}event endCli(Sess,Cli,Ns_3455)
                            )
                            else
                                {3604}let v_3458: bool = (Sess = B) in
                                (
                                    {3605}if v_3458 then
                                    (
                                        {3606}let pkSess_3459: bitstring = pub(skB) in
                                        {3607}out(c, GetEndpointRequest);
                                        {3608}in(c, (=GetEndpointResponse,=pkSess_3459,=Sign,SP_3460: bitstring,UP_3461: bitstring));
                                        {3609}new Nc_3462: bitstring;
                                        {3610}let m1_3463: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3462) in
                                        {3611}event beginCli(Cli,Sess,Nc_3462);
                                        {3612}out(c, (pkCli_3361,m1_3463,sign(h(m1_3463),skCli_3360)));
                                        {3613}in(c, (em2_3464: bitstring,sigM2_3465: bitstring));
                                        {3614}let m2_3466: bitstring = em2_3464 in
                                        {3615}if (verify(h(m2_3466),sigM2_3465,pkSess_3459) <> true) then
                                            0
                                        else
                                            {3616}let (=OpenSecureChannelResponse,Ns_3467: bitstring,ST_3468: bitstring,TTL_3469: bitstring) = m2_3466 in
                                            {3617}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3618}event endCli(Sess,Cli,Ns_3467)
                                    )
                                    else
                                        {3619}let v_3470: bool = (Sess = C) in
                                        (
                                            {3620}if v_3470 then
                                            (
                                                {3621}let pkSess_3471: bitstring = pub(skC) in
                                                {3622}out(c, GetEndpointRequest);
                                                {3623}in(c, (=GetEndpointResponse,=pkSess_3471,=Sign,SP_3472: bitstring,UP_3473: bitstring));
                                                {3624}new Nc_3474: bitstring;
                                                {3625}let m1_3475: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3474) in
                                                {3626}event beginCli(Cli,Sess,Nc_3474);
                                                {3627}out(c, (pkCli_3361,m1_3475,sign(h(m1_3475),skCli_3360)));
                                                {3628}in(c, (em2_3476: bitstring,sigM2_3477: bitstring));
                                                {3629}let m2_3478: bitstring = em2_3476 in
                                                {3630}if (verify(h(m2_3478),sigM2_3477,pkSess_3471) <> true) then
                                                    0
                                                else
                                                    {3631}let (=OpenSecureChannelResponse,Ns_3479: bitstring,ST_3480: bitstring,TTL_3481: bitstring) = m2_3478 in
                                                    {3632}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3633}event endCli(Sess,Cli,Ns_3479)
                                            )
                                            else
                                                {3634}let pkSess_3482: bitstring = pub(sk(Sess)) in
                                                {3635}out(c, GetEndpointRequest);
                                                {3636}in(c, (=GetEndpointResponse,=pkSess_3482,=Sign,SP_3483: bitstring,UP_3484: bitstring));
                                                {3637}new Nc_3485: bitstring;
                                                {3638}let m1_3486: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3485) in
                                                {3639}event beginCli(Cli,Sess,Nc_3485);
                                                {3640}out(c, (pkCli_3361,m1_3486,sign(h(m1_3486),skCli_3360)));
                                                {3641}in(c, (em2_3487: bitstring,sigM2_3488: bitstring));
                                                {3642}let m2_3489: bitstring = em2_3487 in
                                                {3643}if (verify(h(m2_3489),sigM2_3488,pkSess_3482) <> true) then
                                                    0
                                                else
                                                    {3644}let (=OpenSecureChannelResponse,Ns_3490: bitstring,ST_3491: bitstring,TTL_3492: bitstring) = m2_3489 in
                                                    {3645}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3646}event endCli(Sess,Cli,Ns_3490)
                                        )
                                        else
                                            {3647}let pkSess_3493: bitstring = fail-any in
                                            {3648}out(c, GetEndpointRequest);
                                            {3649}in(c, (=GetEndpointResponse,=pkSess_3493,=Sign,SP_3494: bitstring,UP_3495: bitstring));
                                            {3650}new Nc_3496: bitstring;
                                            {3651}let m1_3497: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3496) in
                                            {3652}event beginCli(Cli,Sess,Nc_3496);
                                            {3653}out(c, (pkCli_3361,m1_3497,sign(h(m1_3497),skCli_3360)));
                                            {3654}in(c, (em2_3498: bitstring,sigM2_3499: bitstring));
                                            {3655}let m2_3500: bitstring = em2_3498 in
                                            {3656}if (verify(h(m2_3500),sigM2_3499,pkSess_3493) <> true) then
                                                0
                                            else
                                                {3657}let (=OpenSecureChannelResponse,Ns_3501: bitstring,ST_3502: bitstring,TTL_3503: bitstring) = m2_3500 in
                                                {3658}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3659}event endCli(Sess,Cli,Ns_3501)
                                )
                                else
                                    {3660}let pkSess_3504: bitstring = fail-any in
                                    {3661}out(c, GetEndpointRequest);
                                    {3662}in(c, (=GetEndpointResponse,=pkSess_3504,=Sign,SP_3505: bitstring,UP_3506: bitstring));
                                    {3663}new Nc_3507: bitstring;
                                    {3664}let m1_3508: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3507) in
                                    {3665}event beginCli(Cli,Sess,Nc_3507);
                                    {3666}out(c, (pkCli_3361,m1_3508,sign(h(m1_3508),skCli_3360)));
                                    {3667}in(c, (em2_3509: bitstring,sigM2_3510: bitstring));
                                    {3668}let m2_3511: bitstring = em2_3509 in
                                    {3669}if (verify(h(m2_3511),sigM2_3510,pkSess_3504) <> true) then
                                        0
                                    else
                                        {3670}let (=OpenSecureChannelResponse,Ns_3512: bitstring,ST_3513: bitstring,TTL_3514: bitstring) = m2_3511 in
                                        {3671}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3672}event endCli(Sess,Cli,Ns_3512)
                        )
                        else
                            {3673}let pkSess_3515: bitstring = fail-any in
                            {3674}out(c, GetEndpointRequest);
                            {3675}in(c, (=GetEndpointResponse,=pkSess_3515,=Sign,SP_3516: bitstring,UP_3517: bitstring));
                            {3676}new Nc_3518: bitstring;
                            {3677}let m1_3519: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3518) in
                            {3678}event beginCli(Cli,Sess,Nc_3518);
                            {3679}out(c, (pkCli_3361,m1_3519,sign(h(m1_3519),skCli_3360)));
                            {3680}in(c, (em2_3520: bitstring,sigM2_3521: bitstring));
                            {3681}let m2_3522: bitstring = em2_3520 in
                            {3682}if (verify(h(m2_3522),sigM2_3521,pkSess_3515) <> true) then
                                0
                            else
                                {3683}let (=OpenSecureChannelResponse,Ns_3523: bitstring,ST_3524: bitstring,TTL_3525: bitstring) = m2_3522 in
                                {3684}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3685}event endCli(Sess,Cli,Ns_3523)
                    )
                    else
                        {3686}let v_3526: bool = (Disco = C) in
                        (
                            {3687}if v_3526 then
                            (
                                {3688}let pkDisco_3527: bitstring = pub(skC) in
                                {3689}let v_3528: bool = (Sess = A) in
                                (
                                    {3690}if v_3528 then
                                    (
                                        {3691}let pkSess_3529: bitstring = pub(skA) in
                                        {3692}out(c, GetEndpointRequest);
                                        {3693}in(c, (=GetEndpointResponse,=pkSess_3529,=Sign,SP_3530: bitstring,UP_3531: bitstring));
                                        {3694}new Nc_3532: bitstring;
                                        {3695}let m1_3533: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3532) in
                                        {3696}event beginCli(Cli,Sess,Nc_3532);
                                        {3697}out(c, (pkCli_3361,m1_3533,sign(h(m1_3533),skCli_3360)));
                                        {3698}in(c, (em2_3534: bitstring,sigM2_3535: bitstring));
                                        {3699}let m2_3536: bitstring = em2_3534 in
                                        {3700}if (verify(h(m2_3536),sigM2_3535,pkSess_3529) <> true) then
                                            0
                                        else
                                            {3701}let (=OpenSecureChannelResponse,Ns_3537: bitstring,ST_3538: bitstring,TTL_3539: bitstring) = m2_3536 in
                                            {3702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3703}event endCli(Sess,Cli,Ns_3537)
                                    )
                                    else
                                        {3704}let v_3540: bool = (Sess = B) in
                                        (
                                            {3705}if v_3540 then
                                            (
                                                {3706}let pkSess_3541: bitstring = pub(skB) in
                                                {3707}out(c, GetEndpointRequest);
                                                {3708}in(c, (=GetEndpointResponse,=pkSess_3541,=Sign,SP_3542: bitstring,UP_3543: bitstring));
                                                {3709}new Nc_3544: bitstring;
                                                {3710}let m1_3545: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3544) in
                                                {3711}event beginCli(Cli,Sess,Nc_3544);
                                                {3712}out(c, (pkCli_3361,m1_3545,sign(h(m1_3545),skCli_3360)));
                                                {3713}in(c, (em2_3546: bitstring,sigM2_3547: bitstring));
                                                {3714}let m2_3548: bitstring = em2_3546 in
                                                {3715}if (verify(h(m2_3548),sigM2_3547,pkSess_3541) <> true) then
                                                    0
                                                else
                                                    {3716}let (=OpenSecureChannelResponse,Ns_3549: bitstring,ST_3550: bitstring,TTL_3551: bitstring) = m2_3548 in
                                                    {3717}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3718}event endCli(Sess,Cli,Ns_3549)
                                            )
                                            else
                                                {3719}let v_3552: bool = (Sess = C) in
                                                (
                                                    {3720}if v_3552 then
                                                    (
                                                        {3721}let pkSess_3553: bitstring = pub(skC) in
                                                        {3722}out(c, GetEndpointRequest);
                                                        {3723}in(c, (=GetEndpointResponse,=pkSess_3553,=Sign,SP_3554: bitstring,UP_3555: bitstring));
                                                        {3724}new Nc_3556: bitstring;
                                                        {3725}let m1_3557: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3556) in
                                                        {3726}event beginCli(Cli,Sess,Nc_3556);
                                                        {3727}out(c, (pkCli_3361,m1_3557,sign(h(m1_3557),skCli_3360)));
                                                        {3728}in(c, (em2_3558: bitstring,sigM2_3559: bitstring));
                                                        {3729}let m2_3560: bitstring = em2_3558 in
                                                        {3730}if (verify(h(m2_3560),sigM2_3559,pkSess_3553) <> true) then
                                                            0
                                                        else
                                                            {3731}let (=OpenSecureChannelResponse,Ns_3561: bitstring,ST_3562: bitstring,TTL_3563: bitstring) = m2_3560 in
                                                            {3732}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3733}event endCli(Sess,Cli,Ns_3561)
                                                    )
                                                    else
                                                        {3734}let pkSess_3564: bitstring = pub(sk(Sess)) in
                                                        {3735}out(c, GetEndpointRequest);
                                                        {3736}in(c, (=GetEndpointResponse,=pkSess_3564,=Sign,SP_3565: bitstring,UP_3566: bitstring));
                                                        {3737}new Nc_3567: bitstring;
                                                        {3738}let m1_3568: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3567) in
                                                        {3739}event beginCli(Cli,Sess,Nc_3567);
                                                        {3740}out(c, (pkCli_3361,m1_3568,sign(h(m1_3568),skCli_3360)));
                                                        {3741}in(c, (em2_3569: bitstring,sigM2_3570: bitstring));
                                                        {3742}let m2_3571: bitstring = em2_3569 in
                                                        {3743}if (verify(h(m2_3571),sigM2_3570,pkSess_3564) <> true) then
                                                            0
                                                        else
                                                            {3744}let (=OpenSecureChannelResponse,Ns_3572: bitstring,ST_3573: bitstring,TTL_3574: bitstring) = m2_3571 in
                                                            {3745}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3746}event endCli(Sess,Cli,Ns_3572)
                                                )
                                                else
                                                    {3747}let pkSess_3575: bitstring = fail-any in
                                                    {3748}out(c, GetEndpointRequest);
                                                    {3749}in(c, (=GetEndpointResponse,=pkSess_3575,=Sign,SP_3576: bitstring,UP_3577: bitstring));
                                                    {3750}new Nc_3578: bitstring;
                                                    {3751}let m1_3579: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3578) in
                                                    {3752}event beginCli(Cli,Sess,Nc_3578);
                                                    {3753}out(c, (pkCli_3361,m1_3579,sign(h(m1_3579),skCli_3360)));
                                                    {3754}in(c, (em2_3580: bitstring,sigM2_3581: bitstring));
                                                    {3755}let m2_3582: bitstring = em2_3580 in
                                                    {3756}if (verify(h(m2_3582),sigM2_3581,pkSess_3575) <> true) then
                                                        0
                                                    else
                                                        {3757}let (=OpenSecureChannelResponse,Ns_3583: bitstring,ST_3584: bitstring,TTL_3585: bitstring) = m2_3582 in
                                                        {3758}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3759}event endCli(Sess,Cli,Ns_3583)
                                        )
                                        else
                                            {3760}let pkSess_3586: bitstring = fail-any in
                                            {3761}out(c, GetEndpointRequest);
                                            {3762}in(c, (=GetEndpointResponse,=pkSess_3586,=Sign,SP_3587: bitstring,UP_3588: bitstring));
                                            {3763}new Nc_3589: bitstring;
                                            {3764}let m1_3590: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3589) in
                                            {3765}event beginCli(Cli,Sess,Nc_3589);
                                            {3766}out(c, (pkCli_3361,m1_3590,sign(h(m1_3590),skCli_3360)));
                                            {3767}in(c, (em2_3591: bitstring,sigM2_3592: bitstring));
                                            {3768}let m2_3593: bitstring = em2_3591 in
                                            {3769}if (verify(h(m2_3593),sigM2_3592,pkSess_3586) <> true) then
                                                0
                                            else
                                                {3770}let (=OpenSecureChannelResponse,Ns_3594: bitstring,ST_3595: bitstring,TTL_3596: bitstring) = m2_3593 in
                                                {3771}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3772}event endCli(Sess,Cli,Ns_3594)
                                )
                                else
                                    {3773}let pkSess_3597: bitstring = fail-any in
                                    {3774}out(c, GetEndpointRequest);
                                    {3775}in(c, (=GetEndpointResponse,=pkSess_3597,=Sign,SP_3598: bitstring,UP_3599: bitstring));
                                    {3776}new Nc_3600: bitstring;
                                    {3777}let m1_3601: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3600) in
                                    {3778}event beginCli(Cli,Sess,Nc_3600);
                                    {3779}out(c, (pkCli_3361,m1_3601,sign(h(m1_3601),skCli_3360)));
                                    {3780}in(c, (em2_3602: bitstring,sigM2_3603: bitstring));
                                    {3781}let m2_3604: bitstring = em2_3602 in
                                    {3782}if (verify(h(m2_3604),sigM2_3603,pkSess_3597) <> true) then
                                        0
                                    else
                                        {3783}let (=OpenSecureChannelResponse,Ns_3605: bitstring,ST_3606: bitstring,TTL_3607: bitstring) = m2_3604 in
                                        {3784}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3785}event endCli(Sess,Cli,Ns_3605)
                            )
                            else
                                {3786}let pkDisco_3608: bitstring = pub(sk(Disco)) in
                                {3787}let v_3609: bool = (Sess = A) in
                                (
                                    {3788}if v_3609 then
                                    (
                                        {3789}let pkSess_3610: bitstring = pub(skA) in
                                        {3790}out(c, GetEndpointRequest);
                                        {3791}in(c, (=GetEndpointResponse,=pkSess_3610,=Sign,SP_3611: bitstring,UP_3612: bitstring));
                                        {3792}new Nc_3613: bitstring;
                                        {3793}let m1_3614: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3613) in
                                        {3794}event beginCli(Cli,Sess,Nc_3613);
                                        {3795}out(c, (pkCli_3361,m1_3614,sign(h(m1_3614),skCli_3360)));
                                        {3796}in(c, (em2_3615: bitstring,sigM2_3616: bitstring));
                                        {3797}let m2_3617: bitstring = em2_3615 in
                                        {3798}if (verify(h(m2_3617),sigM2_3616,pkSess_3610) <> true) then
                                            0
                                        else
                                            {3799}let (=OpenSecureChannelResponse,Ns_3618: bitstring,ST_3619: bitstring,TTL_3620: bitstring) = m2_3617 in
                                            {3800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3801}event endCli(Sess,Cli,Ns_3618)
                                    )
                                    else
                                        {3802}let v_3621: bool = (Sess = B) in
                                        (
                                            {3803}if v_3621 then
                                            (
                                                {3804}let pkSess_3622: bitstring = pub(skB) in
                                                {3805}out(c, GetEndpointRequest);
                                                {3806}in(c, (=GetEndpointResponse,=pkSess_3622,=Sign,SP_3623: bitstring,UP_3624: bitstring));
                                                {3807}new Nc_3625: bitstring;
                                                {3808}let m1_3626: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3625) in
                                                {3809}event beginCli(Cli,Sess,Nc_3625);
                                                {3810}out(c, (pkCli_3361,m1_3626,sign(h(m1_3626),skCli_3360)));
                                                {3811}in(c, (em2_3627: bitstring,sigM2_3628: bitstring));
                                                {3812}let m2_3629: bitstring = em2_3627 in
                                                {3813}if (verify(h(m2_3629),sigM2_3628,pkSess_3622) <> true) then
                                                    0
                                                else
                                                    {3814}let (=OpenSecureChannelResponse,Ns_3630: bitstring,ST_3631: bitstring,TTL_3632: bitstring) = m2_3629 in
                                                    {3815}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3816}event endCli(Sess,Cli,Ns_3630)
                                            )
                                            else
                                                {3817}let v_3633: bool = (Sess = C) in
                                                (
                                                    {3818}if v_3633 then
                                                    (
                                                        {3819}let pkSess_3634: bitstring = pub(skC) in
                                                        {3820}out(c, GetEndpointRequest);
                                                        {3821}in(c, (=GetEndpointResponse,=pkSess_3634,=Sign,SP_3635: bitstring,UP_3636: bitstring));
                                                        {3822}new Nc_3637: bitstring;
                                                        {3823}let m1_3638: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3637) in
                                                        {3824}event beginCli(Cli,Sess,Nc_3637);
                                                        {3825}out(c, (pkCli_3361,m1_3638,sign(h(m1_3638),skCli_3360)));
                                                        {3826}in(c, (em2_3639: bitstring,sigM2_3640: bitstring));
                                                        {3827}let m2_3641: bitstring = em2_3639 in
                                                        {3828}if (verify(h(m2_3641),sigM2_3640,pkSess_3634) <> true) then
                                                            0
                                                        else
                                                            {3829}let (=OpenSecureChannelResponse,Ns_3642: bitstring,ST_3643: bitstring,TTL_3644: bitstring) = m2_3641 in
                                                            {3830}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3831}event endCli(Sess,Cli,Ns_3642)
                                                    )
                                                    else
                                                        {3832}let pkSess_3645: bitstring = pub(sk(Sess)) in
                                                        {3833}out(c, GetEndpointRequest);
                                                        {3834}in(c, (=GetEndpointResponse,=pkSess_3645,=Sign,SP_3646: bitstring,UP_3647: bitstring));
                                                        {3835}new Nc_3648: bitstring;
                                                        {3836}let m1_3649: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3648) in
                                                        {3837}event beginCli(Cli,Sess,Nc_3648);
                                                        {3838}out(c, (pkCli_3361,m1_3649,sign(h(m1_3649),skCli_3360)));
                                                        {3839}in(c, (em2_3650: bitstring,sigM2_3651: bitstring));
                                                        {3840}let m2_3652: bitstring = em2_3650 in
                                                        {3841}if (verify(h(m2_3652),sigM2_3651,pkSess_3645) <> true) then
                                                            0
                                                        else
                                                            {3842}let (=OpenSecureChannelResponse,Ns_3653: bitstring,ST_3654: bitstring,TTL_3655: bitstring) = m2_3652 in
                                                            {3843}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3844}event endCli(Sess,Cli,Ns_3653)
                                                )
                                                else
                                                    {3845}let pkSess_3656: bitstring = fail-any in
                                                    {3846}out(c, GetEndpointRequest);
                                                    {3847}in(c, (=GetEndpointResponse,=pkSess_3656,=Sign,SP_3657: bitstring,UP_3658: bitstring));
                                                    {3848}new Nc_3659: bitstring;
                                                    {3849}let m1_3660: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3659) in
                                                    {3850}event beginCli(Cli,Sess,Nc_3659);
                                                    {3851}out(c, (pkCli_3361,m1_3660,sign(h(m1_3660),skCli_3360)));
                                                    {3852}in(c, (em2_3661: bitstring,sigM2_3662: bitstring));
                                                    {3853}let m2_3663: bitstring = em2_3661 in
                                                    {3854}if (verify(h(m2_3663),sigM2_3662,pkSess_3656) <> true) then
                                                        0
                                                    else
                                                        {3855}let (=OpenSecureChannelResponse,Ns_3664: bitstring,ST_3665: bitstring,TTL_3666: bitstring) = m2_3663 in
                                                        {3856}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3857}event endCli(Sess,Cli,Ns_3664)
                                        )
                                        else
                                            {3858}let pkSess_3667: bitstring = fail-any in
                                            {3859}out(c, GetEndpointRequest);
                                            {3860}in(c, (=GetEndpointResponse,=pkSess_3667,=Sign,SP_3668: bitstring,UP_3669: bitstring));
                                            {3861}new Nc_3670: bitstring;
                                            {3862}let m1_3671: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3670) in
                                            {3863}event beginCli(Cli,Sess,Nc_3670);
                                            {3864}out(c, (pkCli_3361,m1_3671,sign(h(m1_3671),skCli_3360)));
                                            {3865}in(c, (em2_3672: bitstring,sigM2_3673: bitstring));
                                            {3866}let m2_3674: bitstring = em2_3672 in
                                            {3867}if (verify(h(m2_3674),sigM2_3673,pkSess_3667) <> true) then
                                                0
                                            else
                                                {3868}let (=OpenSecureChannelResponse,Ns_3675: bitstring,ST_3676: bitstring,TTL_3677: bitstring) = m2_3674 in
                                                {3869}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3870}event endCli(Sess,Cli,Ns_3675)
                                )
                                else
                                    {3871}let pkSess_3678: bitstring = fail-any in
                                    {3872}out(c, GetEndpointRequest);
                                    {3873}in(c, (=GetEndpointResponse,=pkSess_3678,=Sign,SP_3679: bitstring,UP_3680: bitstring));
                                    {3874}new Nc_3681: bitstring;
                                    {3875}let m1_3682: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3681) in
                                    {3876}event beginCli(Cli,Sess,Nc_3681);
                                    {3877}out(c, (pkCli_3361,m1_3682,sign(h(m1_3682),skCli_3360)));
                                    {3878}in(c, (em2_3683: bitstring,sigM2_3684: bitstring));
                                    {3879}let m2_3685: bitstring = em2_3683 in
                                    {3880}if (verify(h(m2_3685),sigM2_3684,pkSess_3678) <> true) then
                                        0
                                    else
                                        {3881}let (=OpenSecureChannelResponse,Ns_3686: bitstring,ST_3687: bitstring,TTL_3688: bitstring) = m2_3685 in
                                        {3882}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3883}event endCli(Sess,Cli,Ns_3686)
                        )
                        else
                            {3884}let pkDisco_3689: bitstring = fail-any in
                            {3885}let v_3690: bool = (Sess = A) in
                            (
                                {3886}if v_3690 then
                                (
                                    {3887}let pkSess_3691: bitstring = pub(skA) in
                                    {3888}out(c, GetEndpointRequest);
                                    {3889}in(c, (=GetEndpointResponse,=pkSess_3691,=Sign,SP_3692: bitstring,UP_3693: bitstring));
                                    {3890}new Nc_3694: bitstring;
                                    {3891}let m1_3695: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3694) in
                                    {3892}event beginCli(Cli,Sess,Nc_3694);
                                    {3893}out(c, (pkCli_3361,m1_3695,sign(h(m1_3695),skCli_3360)));
                                    {3894}in(c, (em2_3696: bitstring,sigM2_3697: bitstring));
                                    {3895}let m2_3698: bitstring = em2_3696 in
                                    {3896}if (verify(h(m2_3698),sigM2_3697,pkSess_3691) <> true) then
                                        0
                                    else
                                        {3897}let (=OpenSecureChannelResponse,Ns_3699: bitstring,ST_3700: bitstring,TTL_3701: bitstring) = m2_3698 in
                                        {3898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3899}event endCli(Sess,Cli,Ns_3699)
                                )
                                else
                                    {3900}let v_3702: bool = (Sess = B) in
                                    (
                                        {3901}if v_3702 then
                                        (
                                            {3902}let pkSess_3703: bitstring = pub(skB) in
                                            {3903}out(c, GetEndpointRequest);
                                            {3904}in(c, (=GetEndpointResponse,=pkSess_3703,=Sign,SP_3704: bitstring,UP_3705: bitstring));
                                            {3905}new Nc_3706: bitstring;
                                            {3906}let m1_3707: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3706) in
                                            {3907}event beginCli(Cli,Sess,Nc_3706);
                                            {3908}out(c, (pkCli_3361,m1_3707,sign(h(m1_3707),skCli_3360)));
                                            {3909}in(c, (em2_3708: bitstring,sigM2_3709: bitstring));
                                            {3910}let m2_3710: bitstring = em2_3708 in
                                            {3911}if (verify(h(m2_3710),sigM2_3709,pkSess_3703) <> true) then
                                                0
                                            else
                                                {3912}let (=OpenSecureChannelResponse,Ns_3711: bitstring,ST_3712: bitstring,TTL_3713: bitstring) = m2_3710 in
                                                {3913}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3914}event endCli(Sess,Cli,Ns_3711)
                                        )
                                        else
                                            {3915}let v_3714: bool = (Sess = C) in
                                            (
                                                {3916}if v_3714 then
                                                (
                                                    {3917}let pkSess_3715: bitstring = pub(skC) in
                                                    {3918}out(c, GetEndpointRequest);
                                                    {3919}in(c, (=GetEndpointResponse,=pkSess_3715,=Sign,SP_3716: bitstring,UP_3717: bitstring));
                                                    {3920}new Nc_3718: bitstring;
                                                    {3921}let m1_3719: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3718) in
                                                    {3922}event beginCli(Cli,Sess,Nc_3718);
                                                    {3923}out(c, (pkCli_3361,m1_3719,sign(h(m1_3719),skCli_3360)));
                                                    {3924}in(c, (em2_3720: bitstring,sigM2_3721: bitstring));
                                                    {3925}let m2_3722: bitstring = em2_3720 in
                                                    {3926}if (verify(h(m2_3722),sigM2_3721,pkSess_3715) <> true) then
                                                        0
                                                    else
                                                        {3927}let (=OpenSecureChannelResponse,Ns_3723: bitstring,ST_3724: bitstring,TTL_3725: bitstring) = m2_3722 in
                                                        {3928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3929}event endCli(Sess,Cli,Ns_3723)
                                                )
                                                else
                                                    {3930}let pkSess_3726: bitstring = pub(sk(Sess)) in
                                                    {3931}out(c, GetEndpointRequest);
                                                    {3932}in(c, (=GetEndpointResponse,=pkSess_3726,=Sign,SP_3727: bitstring,UP_3728: bitstring));
                                                    {3933}new Nc_3729: bitstring;
                                                    {3934}let m1_3730: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3729) in
                                                    {3935}event beginCli(Cli,Sess,Nc_3729);
                                                    {3936}out(c, (pkCli_3361,m1_3730,sign(h(m1_3730),skCli_3360)));
                                                    {3937}in(c, (em2_3731: bitstring,sigM2_3732: bitstring));
                                                    {3938}let m2_3733: bitstring = em2_3731 in
                                                    {3939}if (verify(h(m2_3733),sigM2_3732,pkSess_3726) <> true) then
                                                        0
                                                    else
                                                        {3940}let (=OpenSecureChannelResponse,Ns_3734: bitstring,ST_3735: bitstring,TTL_3736: bitstring) = m2_3733 in
                                                        {3941}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3942}event endCli(Sess,Cli,Ns_3734)
                                            )
                                            else
                                                {3943}let pkSess_3737: bitstring = fail-any in
                                                {3944}out(c, GetEndpointRequest);
                                                {3945}in(c, (=GetEndpointResponse,=pkSess_3737,=Sign,SP_3738: bitstring,UP_3739: bitstring));
                                                {3946}new Nc_3740: bitstring;
                                                {3947}let m1_3741: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3740) in
                                                {3948}event beginCli(Cli,Sess,Nc_3740);
                                                {3949}out(c, (pkCli_3361,m1_3741,sign(h(m1_3741),skCli_3360)));
                                                {3950}in(c, (em2_3742: bitstring,sigM2_3743: bitstring));
                                                {3951}let m2_3744: bitstring = em2_3742 in
                                                {3952}if (verify(h(m2_3744),sigM2_3743,pkSess_3737) <> true) then
                                                    0
                                                else
                                                    {3953}let (=OpenSecureChannelResponse,Ns_3745: bitstring,ST_3746: bitstring,TTL_3747: bitstring) = m2_3744 in
                                                    {3954}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3955}event endCli(Sess,Cli,Ns_3745)
                                    )
                                    else
                                        {3956}let pkSess_3748: bitstring = fail-any in
                                        {3957}out(c, GetEndpointRequest);
                                        {3958}in(c, (=GetEndpointResponse,=pkSess_3748,=Sign,SP_3749: bitstring,UP_3750: bitstring));
                                        {3959}new Nc_3751: bitstring;
                                        {3960}let m1_3752: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3751) in
                                        {3961}event beginCli(Cli,Sess,Nc_3751);
                                        {3962}out(c, (pkCli_3361,m1_3752,sign(h(m1_3752),skCli_3360)));
                                        {3963}in(c, (em2_3753: bitstring,sigM2_3754: bitstring));
                                        {3964}let m2_3755: bitstring = em2_3753 in
                                        {3965}if (verify(h(m2_3755),sigM2_3754,pkSess_3748) <> true) then
                                            0
                                        else
                                            {3966}let (=OpenSecureChannelResponse,Ns_3756: bitstring,ST_3757: bitstring,TTL_3758: bitstring) = m2_3755 in
                                            {3967}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3968}event endCli(Sess,Cli,Ns_3756)
                            )
                            else
                                {3969}let pkSess_3759: bitstring = fail-any in
                                {3970}out(c, GetEndpointRequest);
                                {3971}in(c, (=GetEndpointResponse,=pkSess_3759,=Sign,SP_3760: bitstring,UP_3761: bitstring));
                                {3972}new Nc_3762: bitstring;
                                {3973}let m1_3763: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3762) in
                                {3974}event beginCli(Cli,Sess,Nc_3762);
                                {3975}out(c, (pkCli_3361,m1_3763,sign(h(m1_3763),skCli_3360)));
                                {3976}in(c, (em2_3764: bitstring,sigM2_3765: bitstring));
                                {3977}let m2_3766: bitstring = em2_3764 in
                                {3978}if (verify(h(m2_3766),sigM2_3765,pkSess_3759) <> true) then
                                    0
                                else
                                    {3979}let (=OpenSecureChannelResponse,Ns_3767: bitstring,ST_3768: bitstring,TTL_3769: bitstring) = m2_3766 in
                                    {3980}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3981}event endCli(Sess,Cli,Ns_3767)
                )
                else
                    {3982}let pkDisco_3770: bitstring = fail-any in
                    {3983}let v_3771: bool = (Sess = A) in
                    (
                        {3984}if v_3771 then
                        (
                            {3985}let pkSess_3772: bitstring = pub(skA) in
                            {3986}out(c, GetEndpointRequest);
                            {3987}in(c, (=GetEndpointResponse,=pkSess_3772,=Sign,SP_3773: bitstring,UP_3774: bitstring));
                            {3988}new Nc_3775: bitstring;
                            {3989}let m1_3776: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3775) in
                            {3990}event beginCli(Cli,Sess,Nc_3775);
                            {3991}out(c, (pkCli_3361,m1_3776,sign(h(m1_3776),skCli_3360)));
                            {3992}in(c, (em2_3777: bitstring,sigM2_3778: bitstring));
                            {3993}let m2_3779: bitstring = em2_3777 in
                            {3994}if (verify(h(m2_3779),sigM2_3778,pkSess_3772) <> true) then
                                0
                            else
                                {3995}let (=OpenSecureChannelResponse,Ns_3780: bitstring,ST_3781: bitstring,TTL_3782: bitstring) = m2_3779 in
                                {3996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3997}event endCli(Sess,Cli,Ns_3780)
                        )
                        else
                            {3998}let v_3783: bool = (Sess = B) in
                            (
                                {3999}if v_3783 then
                                (
                                    {4000}let pkSess_3784: bitstring = pub(skB) in
                                    {4001}out(c, GetEndpointRequest);
                                    {4002}in(c, (=GetEndpointResponse,=pkSess_3784,=Sign,SP_3785: bitstring,UP_3786: bitstring));
                                    {4003}new Nc_3787: bitstring;
                                    {4004}let m1_3788: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3787) in
                                    {4005}event beginCli(Cli,Sess,Nc_3787);
                                    {4006}out(c, (pkCli_3361,m1_3788,sign(h(m1_3788),skCli_3360)));
                                    {4007}in(c, (em2_3789: bitstring,sigM2_3790: bitstring));
                                    {4008}let m2_3791: bitstring = em2_3789 in
                                    {4009}if (verify(h(m2_3791),sigM2_3790,pkSess_3784) <> true) then
                                        0
                                    else
                                        {4010}let (=OpenSecureChannelResponse,Ns_3792: bitstring,ST_3793: bitstring,TTL_3794: bitstring) = m2_3791 in
                                        {4011}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4012}event endCli(Sess,Cli,Ns_3792)
                                )
                                else
                                    {4013}let v_3795: bool = (Sess = C) in
                                    (
                                        {4014}if v_3795 then
                                        (
                                            {4015}let pkSess_3796: bitstring = pub(skC) in
                                            {4016}out(c, GetEndpointRequest);
                                            {4017}in(c, (=GetEndpointResponse,=pkSess_3796,=Sign,SP_3797: bitstring,UP_3798: bitstring));
                                            {4018}new Nc_3799: bitstring;
                                            {4019}let m1_3800: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3799) in
                                            {4020}event beginCli(Cli,Sess,Nc_3799);
                                            {4021}out(c, (pkCli_3361,m1_3800,sign(h(m1_3800),skCli_3360)));
                                            {4022}in(c, (em2_3801: bitstring,sigM2_3802: bitstring));
                                            {4023}let m2_3803: bitstring = em2_3801 in
                                            {4024}if (verify(h(m2_3803),sigM2_3802,pkSess_3796) <> true) then
                                                0
                                            else
                                                {4025}let (=OpenSecureChannelResponse,Ns_3804: bitstring,ST_3805: bitstring,TTL_3806: bitstring) = m2_3803 in
                                                {4026}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4027}event endCli(Sess,Cli,Ns_3804)
                                        )
                                        else
                                            {4028}let pkSess_3807: bitstring = pub(sk(Sess)) in
                                            {4029}out(c, GetEndpointRequest);
                                            {4030}in(c, (=GetEndpointResponse,=pkSess_3807,=Sign,SP_3808: bitstring,UP_3809: bitstring));
                                            {4031}new Nc_3810: bitstring;
                                            {4032}let m1_3811: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3810) in
                                            {4033}event beginCli(Cli,Sess,Nc_3810);
                                            {4034}out(c, (pkCli_3361,m1_3811,sign(h(m1_3811),skCli_3360)));
                                            {4035}in(c, (em2_3812: bitstring,sigM2_3813: bitstring));
                                            {4036}let m2_3814: bitstring = em2_3812 in
                                            {4037}if (verify(h(m2_3814),sigM2_3813,pkSess_3807) <> true) then
                                                0
                                            else
                                                {4038}let (=OpenSecureChannelResponse,Ns_3815: bitstring,ST_3816: bitstring,TTL_3817: bitstring) = m2_3814 in
                                                {4039}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4040}event endCli(Sess,Cli,Ns_3815)
                                    )
                                    else
                                        {4041}let pkSess_3818: bitstring = fail-any in
                                        {4042}out(c, GetEndpointRequest);
                                        {4043}in(c, (=GetEndpointResponse,=pkSess_3818,=Sign,SP_3819: bitstring,UP_3820: bitstring));
                                        {4044}new Nc_3821: bitstring;
                                        {4045}let m1_3822: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3821) in
                                        {4046}event beginCli(Cli,Sess,Nc_3821);
                                        {4047}out(c, (pkCli_3361,m1_3822,sign(h(m1_3822),skCli_3360)));
                                        {4048}in(c, (em2_3823: bitstring,sigM2_3824: bitstring));
                                        {4049}let m2_3825: bitstring = em2_3823 in
                                        {4050}if (verify(h(m2_3825),sigM2_3824,pkSess_3818) <> true) then
                                            0
                                        else
                                            {4051}let (=OpenSecureChannelResponse,Ns_3826: bitstring,ST_3827: bitstring,TTL_3828: bitstring) = m2_3825 in
                                            {4052}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4053}event endCli(Sess,Cli,Ns_3826)
                            )
                            else
                                {4054}let pkSess_3829: bitstring = fail-any in
                                {4055}out(c, GetEndpointRequest);
                                {4056}in(c, (=GetEndpointResponse,=pkSess_3829,=Sign,SP_3830: bitstring,UP_3831: bitstring));
                                {4057}new Nc_3832: bitstring;
                                {4058}let m1_3833: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3832) in
                                {4059}event beginCli(Cli,Sess,Nc_3832);
                                {4060}out(c, (pkCli_3361,m1_3833,sign(h(m1_3833),skCli_3360)));
                                {4061}in(c, (em2_3834: bitstring,sigM2_3835: bitstring));
                                {4062}let m2_3836: bitstring = em2_3834 in
                                {4063}if (verify(h(m2_3836),sigM2_3835,pkSess_3829) <> true) then
                                    0
                                else
                                    {4064}let (=OpenSecureChannelResponse,Ns_3837: bitstring,ST_3838: bitstring,TTL_3839: bitstring) = m2_3836 in
                                    {4065}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4066}event endCli(Sess,Cli,Ns_3837)
                    )
                    else
                        {4067}let pkSess_3840: bitstring = fail-any in
                        {4068}out(c, GetEndpointRequest);
                        {4069}in(c, (=GetEndpointResponse,=pkSess_3840,=Sign,SP_3841: bitstring,UP_3842: bitstring));
                        {4070}new Nc_3843: bitstring;
                        {4071}let m1_3844: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3843) in
                        {4072}event beginCli(Cli,Sess,Nc_3843);
                        {4073}out(c, (pkCli_3361,m1_3844,sign(h(m1_3844),skCli_3360)));
                        {4074}in(c, (em2_3845: bitstring,sigM2_3846: bitstring));
                        {4075}let m2_3847: bitstring = em2_3845 in
                        {4076}if (verify(h(m2_3847),sigM2_3846,pkSess_3840) <> true) then
                            0
                        else
                            {4077}let (=OpenSecureChannelResponse,Ns_3848: bitstring,ST_3849: bitstring,TTL_3850: bitstring) = m2_3847 in
                            {4078}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4079}event endCli(Sess,Cli,Ns_3848)
        )
        else
            {4080}let pkDisco_3851: bitstring = fail-any in
            {4081}let v_3852: bool = (Sess = A) in
            (
                {4082}if v_3852 then
                (
                    {4083}let pkSess_3853: bitstring = pub(skA) in
                    {4084}out(c, GetEndpointRequest);
                    {4085}in(c, (=GetEndpointResponse,=pkSess_3853,=Sign,SP_3854: bitstring,UP_3855: bitstring));
                    {4086}new Nc_3856: bitstring;
                    {4087}let m1_3857: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3856) in
                    {4088}event beginCli(Cli,Sess,Nc_3856);
                    {4089}out(c, (pkCli_3361,m1_3857,sign(h(m1_3857),skCli_3360)));
                    {4090}in(c, (em2_3858: bitstring,sigM2_3859: bitstring));
                    {4091}let m2_3860: bitstring = em2_3858 in
                    {4092}if (verify(h(m2_3860),sigM2_3859,pkSess_3853) <> true) then
                        0
                    else
                        {4093}let (=OpenSecureChannelResponse,Ns_3861: bitstring,ST_3862: bitstring,TTL_3863: bitstring) = m2_3860 in
                        {4094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4095}event endCli(Sess,Cli,Ns_3861)
                )
                else
                    {4096}let v_3864: bool = (Sess = B) in
                    (
                        {4097}if v_3864 then
                        (
                            {4098}let pkSess_3865: bitstring = pub(skB) in
                            {4099}out(c, GetEndpointRequest);
                            {4100}in(c, (=GetEndpointResponse,=pkSess_3865,=Sign,SP_3866: bitstring,UP_3867: bitstring));
                            {4101}new Nc_3868: bitstring;
                            {4102}let m1_3869: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3868) in
                            {4103}event beginCli(Cli,Sess,Nc_3868);
                            {4104}out(c, (pkCli_3361,m1_3869,sign(h(m1_3869),skCli_3360)));
                            {4105}in(c, (em2_3870: bitstring,sigM2_3871: bitstring));
                            {4106}let m2_3872: bitstring = em2_3870 in
                            {4107}if (verify(h(m2_3872),sigM2_3871,pkSess_3865) <> true) then
                                0
                            else
                                {4108}let (=OpenSecureChannelResponse,Ns_3873: bitstring,ST_3874: bitstring,TTL_3875: bitstring) = m2_3872 in
                                {4109}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4110}event endCli(Sess,Cli,Ns_3873)
                        )
                        else
                            {4111}let v_3876: bool = (Sess = C) in
                            (
                                {4112}if v_3876 then
                                (
                                    {4113}let pkSess_3877: bitstring = pub(skC) in
                                    {4114}out(c, GetEndpointRequest);
                                    {4115}in(c, (=GetEndpointResponse,=pkSess_3877,=Sign,SP_3878: bitstring,UP_3879: bitstring));
                                    {4116}new Nc_3880: bitstring;
                                    {4117}let m1_3881: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3880) in
                                    {4118}event beginCli(Cli,Sess,Nc_3880);
                                    {4119}out(c, (pkCli_3361,m1_3881,sign(h(m1_3881),skCli_3360)));
                                    {4120}in(c, (em2_3882: bitstring,sigM2_3883: bitstring));
                                    {4121}let m2_3884: bitstring = em2_3882 in
                                    {4122}if (verify(h(m2_3884),sigM2_3883,pkSess_3877) <> true) then
                                        0
                                    else
                                        {4123}let (=OpenSecureChannelResponse,Ns_3885: bitstring,ST_3886: bitstring,TTL_3887: bitstring) = m2_3884 in
                                        {4124}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4125}event endCli(Sess,Cli,Ns_3885)
                                )
                                else
                                    {4126}let pkSess_3888: bitstring = pub(sk(Sess)) in
                                    {4127}out(c, GetEndpointRequest);
                                    {4128}in(c, (=GetEndpointResponse,=pkSess_3888,=Sign,SP_3889: bitstring,UP_3890: bitstring));
                                    {4129}new Nc_3891: bitstring;
                                    {4130}let m1_3892: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3891) in
                                    {4131}event beginCli(Cli,Sess,Nc_3891);
                                    {4132}out(c, (pkCli_3361,m1_3892,sign(h(m1_3892),skCli_3360)));
                                    {4133}in(c, (em2_3893: bitstring,sigM2_3894: bitstring));
                                    {4134}let m2_3895: bitstring = em2_3893 in
                                    {4135}if (verify(h(m2_3895),sigM2_3894,pkSess_3888) <> true) then
                                        0
                                    else
                                        {4136}let (=OpenSecureChannelResponse,Ns_3896: bitstring,ST_3897: bitstring,TTL_3898: bitstring) = m2_3895 in
                                        {4137}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4138}event endCli(Sess,Cli,Ns_3896)
                            )
                            else
                                {4139}let pkSess_3899: bitstring = fail-any in
                                {4140}out(c, GetEndpointRequest);
                                {4141}in(c, (=GetEndpointResponse,=pkSess_3899,=Sign,SP_3900: bitstring,UP_3901: bitstring));
                                {4142}new Nc_3902: bitstring;
                                {4143}let m1_3903: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3902) in
                                {4144}event beginCli(Cli,Sess,Nc_3902);
                                {4145}out(c, (pkCli_3361,m1_3903,sign(h(m1_3903),skCli_3360)));
                                {4146}in(c, (em2_3904: bitstring,sigM2_3905: bitstring));
                                {4147}let m2_3906: bitstring = em2_3904 in
                                {4148}if (verify(h(m2_3906),sigM2_3905,pkSess_3899) <> true) then
                                    0
                                else
                                    {4149}let (=OpenSecureChannelResponse,Ns_3907: bitstring,ST_3908: bitstring,TTL_3909: bitstring) = m2_3906 in
                                    {4150}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4151}event endCli(Sess,Cli,Ns_3907)
                    )
                    else
                        {4152}let pkSess_3910: bitstring = fail-any in
                        {4153}out(c, GetEndpointRequest);
                        {4154}in(c, (=GetEndpointResponse,=pkSess_3910,=Sign,SP_3911: bitstring,UP_3912: bitstring));
                        {4155}new Nc_3913: bitstring;
                        {4156}let m1_3914: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3913) in
                        {4157}event beginCli(Cli,Sess,Nc_3913);
                        {4158}out(c, (pkCli_3361,m1_3914,sign(h(m1_3914),skCli_3360)));
                        {4159}in(c, (em2_3915: bitstring,sigM2_3916: bitstring));
                        {4160}let m2_3917: bitstring = em2_3915 in
                        {4161}if (verify(h(m2_3917),sigM2_3916,pkSess_3910) <> true) then
                            0
                        else
                            {4162}let (=OpenSecureChannelResponse,Ns_3918: bitstring,ST_3919: bitstring,TTL_3920: bitstring) = m2_3917 in
                            {4163}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4164}event endCli(Sess,Cli,Ns_3918)
            )
            else
                {4165}let pkSess_3921: bitstring = fail-any in
                {4166}out(c, GetEndpointRequest);
                {4167}in(c, (=GetEndpointResponse,=pkSess_3921,=Sign,SP_3922: bitstring,UP_3923: bitstring));
                {4168}new Nc_3924: bitstring;
                {4169}let m1_3925: bitstring = (OpenSecureChannelRequest,pkCli_3361,Nc_3924) in
                {4170}event beginCli(Cli,Sess,Nc_3924);
                {4171}out(c, (pkCli_3361,m1_3925,sign(h(m1_3925),skCli_3360)));
                {4172}in(c, (em2_3926: bitstring,sigM2_3927: bitstring));
                {4173}let m2_3928: bitstring = em2_3926 in
                {4174}if (verify(h(m2_3928),sigM2_3927,pkSess_3921) <> true) then
                    0
                else
                    {4175}let (=OpenSecureChannelResponse,Ns_3929: bitstring,ST_3930: bitstring,TTL_3931: bitstring) = m2_3928 in
                    {4176}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {4177}event endCli(Sess,Cli,Ns_3929)
) | (
    {4178}!
    {4179}in(c, (Cli_3932: host,Disco_3933: host,Sess_3934: host));
    {4180}let v_3935: bool = (Disco_3933 = A) in
    (
        {4181}if v_3935 then
        (
            {4182}let skDisco: bitstring = skA in
            {4183}let pkDisco_3936: bitstring = pub(skDisco) in
            {4184}let v_3937: bool = (Cli_3932 = A) in
            (
                {4185}if v_3937 then
                (
                    {4186}let pkCli_3938: bitstring = pub(skA) in
                    {4187}let v_3939: bool = (Sess_3934 = A) in
                    (
                        {4188}if v_3939 then
                        (
                            {4189}let pkSess_3940: bitstring = pub(skA) in
                            {4190}in(c, =GetEndpointRequest);
                            {4191}new SP_3941: bitstring;
                            {4192}new UP_3942: bitstring;
                            {4193}out(c, (GetEndpointResponse,pkSess_3940,Sign,SP_3941,UP_3942))
                        )
                        else
                            {4194}let v_3943: bool = (Sess_3934 = B) in
                            (
                                {4195}if v_3943 then
                                (
                                    {4196}let pkSess_3944: bitstring = pub(skB) in
                                    {4197}in(c, =GetEndpointRequest);
                                    {4198}new SP_3945: bitstring;
                                    {4199}new UP_3946: bitstring;
                                    {4200}out(c, (GetEndpointResponse,pkSess_3944,Sign,SP_3945,UP_3946))
                                )
                                else
                                    {4201}let v_3947: bool = (Sess_3934 = C) in
                                    (
                                        {4202}if v_3947 then
                                        (
                                            {4203}let pkSess_3948: bitstring = pub(skC) in
                                            {4204}in(c, =GetEndpointRequest);
                                            {4205}new SP_3949: bitstring;
                                            {4206}new UP_3950: bitstring;
                                            {4207}out(c, (GetEndpointResponse,pkSess_3948,Sign,SP_3949,UP_3950))
                                        )
                                        else
                                            {4208}let pkSess_3951: bitstring = pub(sk(Sess_3934)) in
                                            {4209}in(c, =GetEndpointRequest);
                                            {4210}new SP_3952: bitstring;
                                            {4211}new UP_3953: bitstring;
                                            {4212}out(c, (GetEndpointResponse,pkSess_3951,Sign,SP_3952,UP_3953))
                                    )
                                    else
                                        {4213}let pkSess_3954: bitstring = fail-any in
                                        {4214}in(c, =GetEndpointRequest);
                                        {4215}new SP_3955: bitstring;
                                        {4216}new UP_3956: bitstring;
                                        {4217}out(c, (GetEndpointResponse,pkSess_3954,Sign,SP_3955,UP_3956))
                            )
                            else
                                {4218}let pkSess_3957: bitstring = fail-any in
                                {4219}in(c, =GetEndpointRequest);
                                {4220}new SP_3958: bitstring;
                                {4221}new UP_3959: bitstring;
                                {4222}out(c, (GetEndpointResponse,pkSess_3957,Sign,SP_3958,UP_3959))
                    )
                    else
                        {4223}let pkSess_3960: bitstring = fail-any in
                        {4224}in(c, =GetEndpointRequest);
                        {4225}new SP_3961: bitstring;
                        {4226}new UP_3962: bitstring;
                        {4227}out(c, (GetEndpointResponse,pkSess_3960,Sign,SP_3961,UP_3962))
                )
                else
                    {4228}let v_3963: bool = (Cli_3932 = B) in
                    (
                        {4229}if v_3963 then
                        (
                            {4230}let pkCli_3964: bitstring = pub(skB) in
                            {4231}let v_3965: bool = (Sess_3934 = A) in
                            (
                                {4232}if v_3965 then
                                (
                                    {4233}let pkSess_3966: bitstring = pub(skA) in
                                    {4234}in(c, =GetEndpointRequest);
                                    {4235}new SP_3967: bitstring;
                                    {4236}new UP_3968: bitstring;
                                    {4237}out(c, (GetEndpointResponse,pkSess_3966,Sign,SP_3967,UP_3968))
                                )
                                else
                                    {4238}let v_3969: bool = (Sess_3934 = B) in
                                    (
                                        {4239}if v_3969 then
                                        (
                                            {4240}let pkSess_3970: bitstring = pub(skB) in
                                            {4241}in(c, =GetEndpointRequest);
                                            {4242}new SP_3971: bitstring;
                                            {4243}new UP_3972: bitstring;
                                            {4244}out(c, (GetEndpointResponse,pkSess_3970,Sign,SP_3971,UP_3972))
                                        )
                                        else
                                            {4245}let v_3973: bool = (Sess_3934 = C) in
                                            (
                                                {4246}if v_3973 then
                                                (
                                                    {4247}let pkSess_3974: bitstring = pub(skC) in
                                                    {4248}in(c, =GetEndpointRequest);
                                                    {4249}new SP_3975: bitstring;
                                                    {4250}new UP_3976: bitstring;
                                                    {4251}out(c, (GetEndpointResponse,pkSess_3974,Sign,SP_3975,UP_3976))
                                                )
                                                else
                                                    {4252}let pkSess_3977: bitstring = pub(sk(Sess_3934)) in
                                                    {4253}in(c, =GetEndpointRequest);
                                                    {4254}new SP_3978: bitstring;
                                                    {4255}new UP_3979: bitstring;
                                                    {4256}out(c, (GetEndpointResponse,pkSess_3977,Sign,SP_3978,UP_3979))
                                            )
                                            else
                                                {4257}let pkSess_3980: bitstring = fail-any in
                                                {4258}in(c, =GetEndpointRequest);
                                                {4259}new SP_3981: bitstring;
                                                {4260}new UP_3982: bitstring;
                                                {4261}out(c, (GetEndpointResponse,pkSess_3980,Sign,SP_3981,UP_3982))
                                    )
                                    else
                                        {4262}let pkSess_3983: bitstring = fail-any in
                                        {4263}in(c, =GetEndpointRequest);
                                        {4264}new SP_3984: bitstring;
                                        {4265}new UP_3985: bitstring;
                                        {4266}out(c, (GetEndpointResponse,pkSess_3983,Sign,SP_3984,UP_3985))
                            )
                            else
                                {4267}let pkSess_3986: bitstring = fail-any in
                                {4268}in(c, =GetEndpointRequest);
                                {4269}new SP_3987: bitstring;
                                {4270}new UP_3988: bitstring;
                                {4271}out(c, (GetEndpointResponse,pkSess_3986,Sign,SP_3987,UP_3988))
                        )
                        else
                            {4272}let v_3989: bool = (Cli_3932 = C) in
                            (
                                {4273}if v_3989 then
                                (
                                    {4274}let pkCli_3990: bitstring = pub(skC) in
                                    {4275}let v_3991: bool = (Sess_3934 = A) in
                                    (
                                        {4276}if v_3991 then
                                        (
                                            {4277}let pkSess_3992: bitstring = pub(skA) in
                                            {4278}in(c, =GetEndpointRequest);
                                            {4279}new SP_3993: bitstring;
                                            {4280}new UP_3994: bitstring;
                                            {4281}out(c, (GetEndpointResponse,pkSess_3992,Sign,SP_3993,UP_3994))
                                        )
                                        else
                                            {4282}let v_3995: bool = (Sess_3934 = B) in
                                            (
                                                {4283}if v_3995 then
                                                (
                                                    {4284}let pkSess_3996: bitstring = pub(skB) in
                                                    {4285}in(c, =GetEndpointRequest);
                                                    {4286}new SP_3997: bitstring;
                                                    {4287}new UP_3998: bitstring;
                                                    {4288}out(c, (GetEndpointResponse,pkSess_3996,Sign,SP_3997,UP_3998))
                                                )
                                                else
                                                    {4289}let v_3999: bool = (Sess_3934 = C) in
                                                    (
                                                        {4290}if v_3999 then
                                                        (
                                                            {4291}let pkSess_4000: bitstring = pub(skC) in
                                                            {4292}in(c, =GetEndpointRequest);
                                                            {4293}new SP_4001: bitstring;
                                                            {4294}new UP_4002: bitstring;
                                                            {4295}out(c, (GetEndpointResponse,pkSess_4000,Sign,SP_4001,UP_4002))
                                                        )
                                                        else
                                                            {4296}let pkSess_4003: bitstring = pub(sk(Sess_3934)) in
                                                            {4297}in(c, =GetEndpointRequest);
                                                            {4298}new SP_4004: bitstring;
                                                            {4299}new UP_4005: bitstring;
                                                            {4300}out(c, (GetEndpointResponse,pkSess_4003,Sign,SP_4004,UP_4005))
                                                    )
                                                    else
                                                        {4301}let pkSess_4006: bitstring = fail-any in
                                                        {4302}in(c, =GetEndpointRequest);
                                                        {4303}new SP_4007: bitstring;
                                                        {4304}new UP_4008: bitstring;
                                                        {4305}out(c, (GetEndpointResponse,pkSess_4006,Sign,SP_4007,UP_4008))
                                            )
                                            else
                                                {4306}let pkSess_4009: bitstring = fail-any in
                                                {4307}in(c, =GetEndpointRequest);
                                                {4308}new SP_4010: bitstring;
                                                {4309}new UP_4011: bitstring;
                                                {4310}out(c, (GetEndpointResponse,pkSess_4009,Sign,SP_4010,UP_4011))
                                    )
                                    else
                                        {4311}let pkSess_4012: bitstring = fail-any in
                                        {4312}in(c, =GetEndpointRequest);
                                        {4313}new SP_4013: bitstring;
                                        {4314}new UP_4014: bitstring;
                                        {4315}out(c, (GetEndpointResponse,pkSess_4012,Sign,SP_4013,UP_4014))
                                )
                                else
                                    {4316}let pkCli_4015: bitstring = pub(sk(Cli_3932)) in
                                    {4317}let v_4016: bool = (Sess_3934 = A) in
                                    (
                                        {4318}if v_4016 then
                                        (
                                            {4319}let pkSess_4017: bitstring = pub(skA) in
                                            {4320}in(c, =GetEndpointRequest);
                                            {4321}new SP_4018: bitstring;
                                            {4322}new UP_4019: bitstring;
                                            {4323}out(c, (GetEndpointResponse,pkSess_4017,Sign,SP_4018,UP_4019))
                                        )
                                        else
                                            {4324}let v_4020: bool = (Sess_3934 = B) in
                                            (
                                                {4325}if v_4020 then
                                                (
                                                    {4326}let pkSess_4021: bitstring = pub(skB) in
                                                    {4327}in(c, =GetEndpointRequest);
                                                    {4328}new SP_4022: bitstring;
                                                    {4329}new UP_4023: bitstring;
                                                    {4330}out(c, (GetEndpointResponse,pkSess_4021,Sign,SP_4022,UP_4023))
                                                )
                                                else
                                                    {4331}let v_4024: bool = (Sess_3934 = C) in
                                                    (
                                                        {4332}if v_4024 then
                                                        (
                                                            {4333}let pkSess_4025: bitstring = pub(skC) in
                                                            {4334}in(c, =GetEndpointRequest);
                                                            {4335}new SP_4026: bitstring;
                                                            {4336}new UP_4027: bitstring;
                                                            {4337}out(c, (GetEndpointResponse,pkSess_4025,Sign,SP_4026,UP_4027))
                                                        )
                                                        else
                                                            {4338}let pkSess_4028: bitstring = pub(sk(Sess_3934)) in
                                                            {4339}in(c, =GetEndpointRequest);
                                                            {4340}new SP_4029: bitstring;
                                                            {4341}new UP_4030: bitstring;
                                                            {4342}out(c, (GetEndpointResponse,pkSess_4028,Sign,SP_4029,UP_4030))
                                                    )
                                                    else
                                                        {4343}let pkSess_4031: bitstring = fail-any in
                                                        {4344}in(c, =GetEndpointRequest);
                                                        {4345}new SP_4032: bitstring;
                                                        {4346}new UP_4033: bitstring;
                                                        {4347}out(c, (GetEndpointResponse,pkSess_4031,Sign,SP_4032,UP_4033))
                                            )
                                            else
                                                {4348}let pkSess_4034: bitstring = fail-any in
                                                {4349}in(c, =GetEndpointRequest);
                                                {4350}new SP_4035: bitstring;
                                                {4351}new UP_4036: bitstring;
                                                {4352}out(c, (GetEndpointResponse,pkSess_4034,Sign,SP_4035,UP_4036))
                                    )
                                    else
                                        {4353}let pkSess_4037: bitstring = fail-any in
                                        {4354}in(c, =GetEndpointRequest);
                                        {4355}new SP_4038: bitstring;
                                        {4356}new UP_4039: bitstring;
                                        {4357}out(c, (GetEndpointResponse,pkSess_4037,Sign,SP_4038,UP_4039))
                            )
                            else
                                {4358}let pkCli_4040: bitstring = fail-any in
                                {4359}let v_4041: bool = (Sess_3934 = A) in
                                (
                                    {4360}if v_4041 then
                                    (
                                        {4361}let pkSess_4042: bitstring = pub(skA) in
                                        {4362}in(c, =GetEndpointRequest);
                                        {4363}new SP_4043: bitstring;
                                        {4364}new UP_4044: bitstring;
                                        {4365}out(c, (GetEndpointResponse,pkSess_4042,Sign,SP_4043,UP_4044))
                                    )
                                    else
                                        {4366}let v_4045: bool = (Sess_3934 = B) in
                                        (
                                            {4367}if v_4045 then
                                            (
                                                {4368}let pkSess_4046: bitstring = pub(skB) in
                                                {4369}in(c, =GetEndpointRequest);
                                                {4370}new SP_4047: bitstring;
                                                {4371}new UP_4048: bitstring;
                                                {4372}out(c, (GetEndpointResponse,pkSess_4046,Sign,SP_4047,UP_4048))
                                            )
                                            else
                                                {4373}let v_4049: bool = (Sess_3934 = C) in
                                                (
                                                    {4374}if v_4049 then
                                                    (
                                                        {4375}let pkSess_4050: bitstring = pub(skC) in
                                                        {4376}in(c, =GetEndpointRequest);
                                                        {4377}new SP_4051: bitstring;
                                                        {4378}new UP_4052: bitstring;
                                                        {4379}out(c, (GetEndpointResponse,pkSess_4050,Sign,SP_4051,UP_4052))
                                                    )
                                                    else
                                                        {4380}let pkSess_4053: bitstring = pub(sk(Sess_3934)) in
                                                        {4381}in(c, =GetEndpointRequest);
                                                        {4382}new SP_4054: bitstring;
                                                        {4383}new UP_4055: bitstring;
                                                        {4384}out(c, (GetEndpointResponse,pkSess_4053,Sign,SP_4054,UP_4055))
                                                )
                                                else
                                                    {4385}let pkSess_4056: bitstring = fail-any in
                                                    {4386}in(c, =GetEndpointRequest);
                                                    {4387}new SP_4057: bitstring;
                                                    {4388}new UP_4058: bitstring;
                                                    {4389}out(c, (GetEndpointResponse,pkSess_4056,Sign,SP_4057,UP_4058))
                                        )
                                        else
                                            {4390}let pkSess_4059: bitstring = fail-any in
                                            {4391}in(c, =GetEndpointRequest);
                                            {4392}new SP_4060: bitstring;
                                            {4393}new UP_4061: bitstring;
                                            {4394}out(c, (GetEndpointResponse,pkSess_4059,Sign,SP_4060,UP_4061))
                                )
                                else
                                    {4395}let pkSess_4062: bitstring = fail-any in
                                    {4396}in(c, =GetEndpointRequest);
                                    {4397}new SP_4063: bitstring;
                                    {4398}new UP_4064: bitstring;
                                    {4399}out(c, (GetEndpointResponse,pkSess_4062,Sign,SP_4063,UP_4064))
                    )
                    else
                        {4400}let pkCli_4065: bitstring = fail-any in
                        {4401}let v_4066: bool = (Sess_3934 = A) in
                        (
                            {4402}if v_4066 then
                            (
                                {4403}let pkSess_4067: bitstring = pub(skA) in
                                {4404}in(c, =GetEndpointRequest);
                                {4405}new SP_4068: bitstring;
                                {4406}new UP_4069: bitstring;
                                {4407}out(c, (GetEndpointResponse,pkSess_4067,Sign,SP_4068,UP_4069))
                            )
                            else
                                {4408}let v_4070: bool = (Sess_3934 = B) in
                                (
                                    {4409}if v_4070 then
                                    (
                                        {4410}let pkSess_4071: bitstring = pub(skB) in
                                        {4411}in(c, =GetEndpointRequest);
                                        {4412}new SP_4072: bitstring;
                                        {4413}new UP_4073: bitstring;
                                        {4414}out(c, (GetEndpointResponse,pkSess_4071,Sign,SP_4072,UP_4073))
                                    )
                                    else
                                        {4415}let v_4074: bool = (Sess_3934 = C) in
                                        (
                                            {4416}if v_4074 then
                                            (
                                                {4417}let pkSess_4075: bitstring = pub(skC) in
                                                {4418}in(c, =GetEndpointRequest);
                                                {4419}new SP_4076: bitstring;
                                                {4420}new UP_4077: bitstring;
                                                {4421}out(c, (GetEndpointResponse,pkSess_4075,Sign,SP_4076,UP_4077))
                                            )
                                            else
                                                {4422}let pkSess_4078: bitstring = pub(sk(Sess_3934)) in
                                                {4423}in(c, =GetEndpointRequest);
                                                {4424}new SP_4079: bitstring;
                                                {4425}new UP_4080: bitstring;
                                                {4426}out(c, (GetEndpointResponse,pkSess_4078,Sign,SP_4079,UP_4080))
                                        )
                                        else
                                            {4427}let pkSess_4081: bitstring = fail-any in
                                            {4428}in(c, =GetEndpointRequest);
                                            {4429}new SP_4082: bitstring;
                                            {4430}new UP_4083: bitstring;
                                            {4431}out(c, (GetEndpointResponse,pkSess_4081,Sign,SP_4082,UP_4083))
                                )
                                else
                                    {4432}let pkSess_4084: bitstring = fail-any in
                                    {4433}in(c, =GetEndpointRequest);
                                    {4434}new SP_4085: bitstring;
                                    {4435}new UP_4086: bitstring;
                                    {4436}out(c, (GetEndpointResponse,pkSess_4084,Sign,SP_4085,UP_4086))
                        )
                        else
                            {4437}let pkSess_4087: bitstring = fail-any in
                            {4438}in(c, =GetEndpointRequest);
                            {4439}new SP_4088: bitstring;
                            {4440}new UP_4089: bitstring;
                            {4441}out(c, (GetEndpointResponse,pkSess_4087,Sign,SP_4088,UP_4089))
            )
            else
                {4442}let pkCli_4090: bitstring = fail-any in
                {4443}let v_4091: bool = (Sess_3934 = A) in
                (
                    {4444}if v_4091 then
                    (
                        {4445}let pkSess_4092: bitstring = pub(skA) in
                        {4446}in(c, =GetEndpointRequest);
                        {4447}new SP_4093: bitstring;
                        {4448}new UP_4094: bitstring;
                        {4449}out(c, (GetEndpointResponse,pkSess_4092,Sign,SP_4093,UP_4094))
                    )
                    else
                        {4450}let v_4095: bool = (Sess_3934 = B) in
                        (
                            {4451}if v_4095 then
                            (
                                {4452}let pkSess_4096: bitstring = pub(skB) in
                                {4453}in(c, =GetEndpointRequest);
                                {4454}new SP_4097: bitstring;
                                {4455}new UP_4098: bitstring;
                                {4456}out(c, (GetEndpointResponse,pkSess_4096,Sign,SP_4097,UP_4098))
                            )
                            else
                                {4457}let v_4099: bool = (Sess_3934 = C) in
                                (
                                    {4458}if v_4099 then
                                    (
                                        {4459}let pkSess_4100: bitstring = pub(skC) in
                                        {4460}in(c, =GetEndpointRequest);
                                        {4461}new SP_4101: bitstring;
                                        {4462}new UP_4102: bitstring;
                                        {4463}out(c, (GetEndpointResponse,pkSess_4100,Sign,SP_4101,UP_4102))
                                    )
                                    else
                                        {4464}let pkSess_4103: bitstring = pub(sk(Sess_3934)) in
                                        {4465}in(c, =GetEndpointRequest);
                                        {4466}new SP_4104: bitstring;
                                        {4467}new UP_4105: bitstring;
                                        {4468}out(c, (GetEndpointResponse,pkSess_4103,Sign,SP_4104,UP_4105))
                                )
                                else
                                    {4469}let pkSess_4106: bitstring = fail-any in
                                    {4470}in(c, =GetEndpointRequest);
                                    {4471}new SP_4107: bitstring;
                                    {4472}new UP_4108: bitstring;
                                    {4473}out(c, (GetEndpointResponse,pkSess_4106,Sign,SP_4107,UP_4108))
                        )
                        else
                            {4474}let pkSess_4109: bitstring = fail-any in
                            {4475}in(c, =GetEndpointRequest);
                            {4476}new SP_4110: bitstring;
                            {4477}new UP_4111: bitstring;
                            {4478}out(c, (GetEndpointResponse,pkSess_4109,Sign,SP_4110,UP_4111))
                )
                else
                    {4479}let pkSess_4112: bitstring = fail-any in
                    {4480}in(c, =GetEndpointRequest);
                    {4481}new SP_4113: bitstring;
                    {4482}new UP_4114: bitstring;
                    {4483}out(c, (GetEndpointResponse,pkSess_4112,Sign,SP_4113,UP_4114))
        )
        else
            {4484}let v_4115: bool = (Disco_3933 = B) in
            (
                {4485}if v_4115 then
                (
                    {4486}let skDisco_4116: bitstring = skB in
                    {4487}let pkDisco_4117: bitstring = pub(skDisco_4116) in
                    {4488}let v_4118: bool = (Cli_3932 = A) in
                    (
                        {4489}if v_4118 then
                        (
                            {4490}let pkCli_4119: bitstring = pub(skA) in
                            {4491}let v_4120: bool = (Sess_3934 = A) in
                            (
                                {4492}if v_4120 then
                                (
                                    {4493}let pkSess_4121: bitstring = pub(skA) in
                                    {4494}in(c, =GetEndpointRequest);
                                    {4495}new SP_4122: bitstring;
                                    {4496}new UP_4123: bitstring;
                                    {4497}out(c, (GetEndpointResponse,pkSess_4121,Sign,SP_4122,UP_4123))
                                )
                                else
                                    {4498}let v_4124: bool = (Sess_3934 = B) in
                                    (
                                        {4499}if v_4124 then
                                        (
                                            {4500}let pkSess_4125: bitstring = pub(skB) in
                                            {4501}in(c, =GetEndpointRequest);
                                            {4502}new SP_4126: bitstring;
                                            {4503}new UP_4127: bitstring;
                                            {4504}out(c, (GetEndpointResponse,pkSess_4125,Sign,SP_4126,UP_4127))
                                        )
                                        else
                                            {4505}let v_4128: bool = (Sess_3934 = C) in
                                            (
                                                {4506}if v_4128 then
                                                (
                                                    {4507}let pkSess_4129: bitstring = pub(skC) in
                                                    {4508}in(c, =GetEndpointRequest);
                                                    {4509}new SP_4130: bitstring;
                                                    {4510}new UP_4131: bitstring;
                                                    {4511}out(c, (GetEndpointResponse,pkSess_4129,Sign,SP_4130,UP_4131))
                                                )
                                                else
                                                    {4512}let pkSess_4132: bitstring = pub(sk(Sess_3934)) in
                                                    {4513}in(c, =GetEndpointRequest);
                                                    {4514}new SP_4133: bitstring;
                                                    {4515}new UP_4134: bitstring;
                                                    {4516}out(c, (GetEndpointResponse,pkSess_4132,Sign,SP_4133,UP_4134))
                                            )
                                            else
                                                {4517}let pkSess_4135: bitstring = fail-any in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4136: bitstring;
                                                {4520}new UP_4137: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4135,Sign,SP_4136,UP_4137))
                                    )
                                    else
                                        {4522}let pkSess_4138: bitstring = fail-any in
                                        {4523}in(c, =GetEndpointRequest);
                                        {4524}new SP_4139: bitstring;
                                        {4525}new UP_4140: bitstring;
                                        {4526}out(c, (GetEndpointResponse,pkSess_4138,Sign,SP_4139,UP_4140))
                            )
                            else
                                {4527}let pkSess_4141: bitstring = fail-any in
                                {4528}in(c, =GetEndpointRequest);
                                {4529}new SP_4142: bitstring;
                                {4530}new UP_4143: bitstring;
                                {4531}out(c, (GetEndpointResponse,pkSess_4141,Sign,SP_4142,UP_4143))
                        )
                        else
                            {4532}let v_4144: bool = (Cli_3932 = B) in
                            (
                                {4533}if v_4144 then
                                (
                                    {4534}let pkCli_4145: bitstring = pub(skB) in
                                    {4535}let v_4146: bool = (Sess_3934 = A) in
                                    (
                                        {4536}if v_4146 then
                                        (
                                            {4537}let pkSess_4147: bitstring = pub(skA) in
                                            {4538}in(c, =GetEndpointRequest);
                                            {4539}new SP_4148: bitstring;
                                            {4540}new UP_4149: bitstring;
                                            {4541}out(c, (GetEndpointResponse,pkSess_4147,Sign,SP_4148,UP_4149))
                                        )
                                        else
                                            {4542}let v_4150: bool = (Sess_3934 = B) in
                                            (
                                                {4543}if v_4150 then
                                                (
                                                    {4544}let pkSess_4151: bitstring = pub(skB) in
                                                    {4545}in(c, =GetEndpointRequest);
                                                    {4546}new SP_4152: bitstring;
                                                    {4547}new UP_4153: bitstring;
                                                    {4548}out(c, (GetEndpointResponse,pkSess_4151,Sign,SP_4152,UP_4153))
                                                )
                                                else
                                                    {4549}let v_4154: bool = (Sess_3934 = C) in
                                                    (
                                                        {4550}if v_4154 then
                                                        (
                                                            {4551}let pkSess_4155: bitstring = pub(skC) in
                                                            {4552}in(c, =GetEndpointRequest);
                                                            {4553}new SP_4156: bitstring;
                                                            {4554}new UP_4157: bitstring;
                                                            {4555}out(c, (GetEndpointResponse,pkSess_4155,Sign,SP_4156,UP_4157))
                                                        )
                                                        else
                                                            {4556}let pkSess_4158: bitstring = pub(sk(Sess_3934)) in
                                                            {4557}in(c, =GetEndpointRequest);
                                                            {4558}new SP_4159: bitstring;
                                                            {4559}new UP_4160: bitstring;
                                                            {4560}out(c, (GetEndpointResponse,pkSess_4158,Sign,SP_4159,UP_4160))
                                                    )
                                                    else
                                                        {4561}let pkSess_4161: bitstring = fail-any in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4162: bitstring;
                                                        {4564}new UP_4163: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4161,Sign,SP_4162,UP_4163))
                                            )
                                            else
                                                {4566}let pkSess_4164: bitstring = fail-any in
                                                {4567}in(c, =GetEndpointRequest);
                                                {4568}new SP_4165: bitstring;
                                                {4569}new UP_4166: bitstring;
                                                {4570}out(c, (GetEndpointResponse,pkSess_4164,Sign,SP_4165,UP_4166))
                                    )
                                    else
                                        {4571}let pkSess_4167: bitstring = fail-any in
                                        {4572}in(c, =GetEndpointRequest);
                                        {4573}new SP_4168: bitstring;
                                        {4574}new UP_4169: bitstring;
                                        {4575}out(c, (GetEndpointResponse,pkSess_4167,Sign,SP_4168,UP_4169))
                                )
                                else
                                    {4576}let v_4170: bool = (Cli_3932 = C) in
                                    (
                                        {4577}if v_4170 then
                                        (
                                            {4578}let pkCli_4171: bitstring = pub(skC) in
                                            {4579}let v_4172: bool = (Sess_3934 = A) in
                                            (
                                                {4580}if v_4172 then
                                                (
                                                    {4581}let pkSess_4173: bitstring = pub(skA) in
                                                    {4582}in(c, =GetEndpointRequest);
                                                    {4583}new SP_4174: bitstring;
                                                    {4584}new UP_4175: bitstring;
                                                    {4585}out(c, (GetEndpointResponse,pkSess_4173,Sign,SP_4174,UP_4175))
                                                )
                                                else
                                                    {4586}let v_4176: bool = (Sess_3934 = B) in
                                                    (
                                                        {4587}if v_4176 then
                                                        (
                                                            {4588}let pkSess_4177: bitstring = pub(skB) in
                                                            {4589}in(c, =GetEndpointRequest);
                                                            {4590}new SP_4178: bitstring;
                                                            {4591}new UP_4179: bitstring;
                                                            {4592}out(c, (GetEndpointResponse,pkSess_4177,Sign,SP_4178,UP_4179))
                                                        )
                                                        else
                                                            {4593}let v_4180: bool = (Sess_3934 = C) in
                                                            (
                                                                {4594}if v_4180 then
                                                                (
                                                                    {4595}let pkSess_4181: bitstring = pub(skC) in
                                                                    {4596}in(c, =GetEndpointRequest);
                                                                    {4597}new SP_4182: bitstring;
                                                                    {4598}new UP_4183: bitstring;
                                                                    {4599}out(c, (GetEndpointResponse,pkSess_4181,Sign,SP_4182,UP_4183))
                                                                )
                                                                else
                                                                    {4600}let pkSess_4184: bitstring = pub(sk(Sess_3934)) in
                                                                    {4601}in(c, =GetEndpointRequest);
                                                                    {4602}new SP_4185: bitstring;
                                                                    {4603}new UP_4186: bitstring;
                                                                    {4604}out(c, (GetEndpointResponse,pkSess_4184,Sign,SP_4185,UP_4186))
                                                            )
                                                            else
                                                                {4605}let pkSess_4187: bitstring = fail-any in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4188: bitstring;
                                                                {4608}new UP_4189: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4187,Sign,SP_4188,UP_4189))
                                                    )
                                                    else
                                                        {4610}let pkSess_4190: bitstring = fail-any in
                                                        {4611}in(c, =GetEndpointRequest);
                                                        {4612}new SP_4191: bitstring;
                                                        {4613}new UP_4192: bitstring;
                                                        {4614}out(c, (GetEndpointResponse,pkSess_4190,Sign,SP_4191,UP_4192))
                                            )
                                            else
                                                {4615}let pkSess_4193: bitstring = fail-any in
                                                {4616}in(c, =GetEndpointRequest);
                                                {4617}new SP_4194: bitstring;
                                                {4618}new UP_4195: bitstring;
                                                {4619}out(c, (GetEndpointResponse,pkSess_4193,Sign,SP_4194,UP_4195))
                                        )
                                        else
                                            {4620}let pkCli_4196: bitstring = pub(sk(Cli_3932)) in
                                            {4621}let v_4197: bool = (Sess_3934 = A) in
                                            (
                                                {4622}if v_4197 then
                                                (
                                                    {4623}let pkSess_4198: bitstring = pub(skA) in
                                                    {4624}in(c, =GetEndpointRequest);
                                                    {4625}new SP_4199: bitstring;
                                                    {4626}new UP_4200: bitstring;
                                                    {4627}out(c, (GetEndpointResponse,pkSess_4198,Sign,SP_4199,UP_4200))
                                                )
                                                else
                                                    {4628}let v_4201: bool = (Sess_3934 = B) in
                                                    (
                                                        {4629}if v_4201 then
                                                        (
                                                            {4630}let pkSess_4202: bitstring = pub(skB) in
                                                            {4631}in(c, =GetEndpointRequest);
                                                            {4632}new SP_4203: bitstring;
                                                            {4633}new UP_4204: bitstring;
                                                            {4634}out(c, (GetEndpointResponse,pkSess_4202,Sign,SP_4203,UP_4204))
                                                        )
                                                        else
                                                            {4635}let v_4205: bool = (Sess_3934 = C) in
                                                            (
                                                                {4636}if v_4205 then
                                                                (
                                                                    {4637}let pkSess_4206: bitstring = pub(skC) in
                                                                    {4638}in(c, =GetEndpointRequest);
                                                                    {4639}new SP_4207: bitstring;
                                                                    {4640}new UP_4208: bitstring;
                                                                    {4641}out(c, (GetEndpointResponse,pkSess_4206,Sign,SP_4207,UP_4208))
                                                                )
                                                                else
                                                                    {4642}let pkSess_4209: bitstring = pub(sk(Sess_3934)) in
                                                                    {4643}in(c, =GetEndpointRequest);
                                                                    {4644}new SP_4210: bitstring;
                                                                    {4645}new UP_4211: bitstring;
                                                                    {4646}out(c, (GetEndpointResponse,pkSess_4209,Sign,SP_4210,UP_4211))
                                                            )
                                                            else
                                                                {4647}let pkSess_4212: bitstring = fail-any in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4213: bitstring;
                                                                {4650}new UP_4214: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4212,Sign,SP_4213,UP_4214))
                                                    )
                                                    else
                                                        {4652}let pkSess_4215: bitstring = fail-any in
                                                        {4653}in(c, =GetEndpointRequest);
                                                        {4654}new SP_4216: bitstring;
                                                        {4655}new UP_4217: bitstring;
                                                        {4656}out(c, (GetEndpointResponse,pkSess_4215,Sign,SP_4216,UP_4217))
                                            )
                                            else
                                                {4657}let pkSess_4218: bitstring = fail-any in
                                                {4658}in(c, =GetEndpointRequest);
                                                {4659}new SP_4219: bitstring;
                                                {4660}new UP_4220: bitstring;
                                                {4661}out(c, (GetEndpointResponse,pkSess_4218,Sign,SP_4219,UP_4220))
                                    )
                                    else
                                        {4662}let pkCli_4221: bitstring = fail-any in
                                        {4663}let v_4222: bool = (Sess_3934 = A) in
                                        (
                                            {4664}if v_4222 then
                                            (
                                                {4665}let pkSess_4223: bitstring = pub(skA) in
                                                {4666}in(c, =GetEndpointRequest);
                                                {4667}new SP_4224: bitstring;
                                                {4668}new UP_4225: bitstring;
                                                {4669}out(c, (GetEndpointResponse,pkSess_4223,Sign,SP_4224,UP_4225))
                                            )
                                            else
                                                {4670}let v_4226: bool = (Sess_3934 = B) in
                                                (
                                                    {4671}if v_4226 then
                                                    (
                                                        {4672}let pkSess_4227: bitstring = pub(skB) in
                                                        {4673}in(c, =GetEndpointRequest);
                                                        {4674}new SP_4228: bitstring;
                                                        {4675}new UP_4229: bitstring;
                                                        {4676}out(c, (GetEndpointResponse,pkSess_4227,Sign,SP_4228,UP_4229))
                                                    )
                                                    else
                                                        {4677}let v_4230: bool = (Sess_3934 = C) in
                                                        (
                                                            {4678}if v_4230 then
                                                            (
                                                                {4679}let pkSess_4231: bitstring = pub(skC) in
                                                                {4680}in(c, =GetEndpointRequest);
                                                                {4681}new SP_4232: bitstring;
                                                                {4682}new UP_4233: bitstring;
                                                                {4683}out(c, (GetEndpointResponse,pkSess_4231,Sign,SP_4232,UP_4233))
                                                            )
                                                            else
                                                                {4684}let pkSess_4234: bitstring = pub(sk(Sess_3934)) in
                                                                {4685}in(c, =GetEndpointRequest);
                                                                {4686}new SP_4235: bitstring;
                                                                {4687}new UP_4236: bitstring;
                                                                {4688}out(c, (GetEndpointResponse,pkSess_4234,Sign,SP_4235,UP_4236))
                                                        )
                                                        else
                                                            {4689}let pkSess_4237: bitstring = fail-any in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4238: bitstring;
                                                            {4692}new UP_4239: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4237,Sign,SP_4238,UP_4239))
                                                )
                                                else
                                                    {4694}let pkSess_4240: bitstring = fail-any in
                                                    {4695}in(c, =GetEndpointRequest);
                                                    {4696}new SP_4241: bitstring;
                                                    {4697}new UP_4242: bitstring;
                                                    {4698}out(c, (GetEndpointResponse,pkSess_4240,Sign,SP_4241,UP_4242))
                                        )
                                        else
                                            {4699}let pkSess_4243: bitstring = fail-any in
                                            {4700}in(c, =GetEndpointRequest);
                                            {4701}new SP_4244: bitstring;
                                            {4702}new UP_4245: bitstring;
                                            {4703}out(c, (GetEndpointResponse,pkSess_4243,Sign,SP_4244,UP_4245))
                            )
                            else
                                {4704}let pkCli_4246: bitstring = fail-any in
                                {4705}let v_4247: bool = (Sess_3934 = A) in
                                (
                                    {4706}if v_4247 then
                                    (
                                        {4707}let pkSess_4248: bitstring = pub(skA) in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SP_4249: bitstring;
                                        {4710}new UP_4250: bitstring;
                                        {4711}out(c, (GetEndpointResponse,pkSess_4248,Sign,SP_4249,UP_4250))
                                    )
                                    else
                                        {4712}let v_4251: bool = (Sess_3934 = B) in
                                        (
                                            {4713}if v_4251 then
                                            (
                                                {4714}let pkSess_4252: bitstring = pub(skB) in
                                                {4715}in(c, =GetEndpointRequest);
                                                {4716}new SP_4253: bitstring;
                                                {4717}new UP_4254: bitstring;
                                                {4718}out(c, (GetEndpointResponse,pkSess_4252,Sign,SP_4253,UP_4254))
                                            )
                                            else
                                                {4719}let v_4255: bool = (Sess_3934 = C) in
                                                (
                                                    {4720}if v_4255 then
                                                    (
                                                        {4721}let pkSess_4256: bitstring = pub(skC) in
                                                        {4722}in(c, =GetEndpointRequest);
                                                        {4723}new SP_4257: bitstring;
                                                        {4724}new UP_4258: bitstring;
                                                        {4725}out(c, (GetEndpointResponse,pkSess_4256,Sign,SP_4257,UP_4258))
                                                    )
                                                    else
                                                        {4726}let pkSess_4259: bitstring = pub(sk(Sess_3934)) in
                                                        {4727}in(c, =GetEndpointRequest);
                                                        {4728}new SP_4260: bitstring;
                                                        {4729}new UP_4261: bitstring;
                                                        {4730}out(c, (GetEndpointResponse,pkSess_4259,Sign,SP_4260,UP_4261))
                                                )
                                                else
                                                    {4731}let pkSess_4262: bitstring = fail-any in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4263: bitstring;
                                                    {4734}new UP_4264: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4262,Sign,SP_4263,UP_4264))
                                        )
                                        else
                                            {4736}let pkSess_4265: bitstring = fail-any in
                                            {4737}in(c, =GetEndpointRequest);
                                            {4738}new SP_4266: bitstring;
                                            {4739}new UP_4267: bitstring;
                                            {4740}out(c, (GetEndpointResponse,pkSess_4265,Sign,SP_4266,UP_4267))
                                )
                                else
                                    {4741}let pkSess_4268: bitstring = fail-any in
                                    {4742}in(c, =GetEndpointRequest);
                                    {4743}new SP_4269: bitstring;
                                    {4744}new UP_4270: bitstring;
                                    {4745}out(c, (GetEndpointResponse,pkSess_4268,Sign,SP_4269,UP_4270))
                    )
                    else
                        {4746}let pkCli_4271: bitstring = fail-any in
                        {4747}let v_4272: bool = (Sess_3934 = A) in
                        (
                            {4748}if v_4272 then
                            (
                                {4749}let pkSess_4273: bitstring = pub(skA) in
                                {4750}in(c, =GetEndpointRequest);
                                {4751}new SP_4274: bitstring;
                                {4752}new UP_4275: bitstring;
                                {4753}out(c, (GetEndpointResponse,pkSess_4273,Sign,SP_4274,UP_4275))
                            )
                            else
                                {4754}let v_4276: bool = (Sess_3934 = B) in
                                (
                                    {4755}if v_4276 then
                                    (
                                        {4756}let pkSess_4277: bitstring = pub(skB) in
                                        {4757}in(c, =GetEndpointRequest);
                                        {4758}new SP_4278: bitstring;
                                        {4759}new UP_4279: bitstring;
                                        {4760}out(c, (GetEndpointResponse,pkSess_4277,Sign,SP_4278,UP_4279))
                                    )
                                    else
                                        {4761}let v_4280: bool = (Sess_3934 = C) in
                                        (
                                            {4762}if v_4280 then
                                            (
                                                {4763}let pkSess_4281: bitstring = pub(skC) in
                                                {4764}in(c, =GetEndpointRequest);
                                                {4765}new SP_4282: bitstring;
                                                {4766}new UP_4283: bitstring;
                                                {4767}out(c, (GetEndpointResponse,pkSess_4281,Sign,SP_4282,UP_4283))
                                            )
                                            else
                                                {4768}let pkSess_4284: bitstring = pub(sk(Sess_3934)) in
                                                {4769}in(c, =GetEndpointRequest);
                                                {4770}new SP_4285: bitstring;
                                                {4771}new UP_4286: bitstring;
                                                {4772}out(c, (GetEndpointResponse,pkSess_4284,Sign,SP_4285,UP_4286))
                                        )
                                        else
                                            {4773}let pkSess_4287: bitstring = fail-any in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4288: bitstring;
                                            {4776}new UP_4289: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4287,Sign,SP_4288,UP_4289))
                                )
                                else
                                    {4778}let pkSess_4290: bitstring = fail-any in
                                    {4779}in(c, =GetEndpointRequest);
                                    {4780}new SP_4291: bitstring;
                                    {4781}new UP_4292: bitstring;
                                    {4782}out(c, (GetEndpointResponse,pkSess_4290,Sign,SP_4291,UP_4292))
                        )
                        else
                            {4783}let pkSess_4293: bitstring = fail-any in
                            {4784}in(c, =GetEndpointRequest);
                            {4785}new SP_4294: bitstring;
                            {4786}new UP_4295: bitstring;
                            {4787}out(c, (GetEndpointResponse,pkSess_4293,Sign,SP_4294,UP_4295))
                )
                else
                    {4788}let =true = (Disco_3933 = C) in
                    (
                        {4789}let skDisco_4296: bitstring = skC in
                        {4790}let pkDisco_4297: bitstring = pub(skDisco_4296) in
                        {4791}let v_4298: bool = (Cli_3932 = A) in
                        (
                            {4792}if v_4298 then
                            (
                                {4793}let pkCli_4299: bitstring = pub(skA) in
                                {4794}let v_4300: bool = (Sess_3934 = A) in
                                (
                                    {4795}if v_4300 then
                                    (
                                        {4796}let pkSess_4301: bitstring = pub(skA) in
                                        {4797}in(c, =GetEndpointRequest);
                                        {4798}new SP_4302: bitstring;
                                        {4799}new UP_4303: bitstring;
                                        {4800}out(c, (GetEndpointResponse,pkSess_4301,Sign,SP_4302,UP_4303))
                                    )
                                    else
                                        {4801}let v_4304: bool = (Sess_3934 = B) in
                                        (
                                            {4802}if v_4304 then
                                            (
                                                {4803}let pkSess_4305: bitstring = pub(skB) in
                                                {4804}in(c, =GetEndpointRequest);
                                                {4805}new SP_4306: bitstring;
                                                {4806}new UP_4307: bitstring;
                                                {4807}out(c, (GetEndpointResponse,pkSess_4305,Sign,SP_4306,UP_4307))
                                            )
                                            else
                                                {4808}let v_4308: bool = (Sess_3934 = C) in
                                                (
                                                    {4809}if v_4308 then
                                                    (
                                                        {4810}let pkSess_4309: bitstring = pub(skC) in
                                                        {4811}in(c, =GetEndpointRequest);
                                                        {4812}new SP_4310: bitstring;
                                                        {4813}new UP_4311: bitstring;
                                                        {4814}out(c, (GetEndpointResponse,pkSess_4309,Sign,SP_4310,UP_4311))
                                                    )
                                                    else
                                                        {4815}let pkSess_4312: bitstring = pub(sk(Sess_3934)) in
                                                        {4816}in(c, =GetEndpointRequest);
                                                        {4817}new SP_4313: bitstring;
                                                        {4818}new UP_4314: bitstring;
                                                        {4819}out(c, (GetEndpointResponse,pkSess_4312,Sign,SP_4313,UP_4314))
                                                )
                                                else
                                                    {4820}let pkSess_4315: bitstring = fail-any in
                                                    {4821}in(c, =GetEndpointRequest);
                                                    {4822}new SP_4316: bitstring;
                                                    {4823}new UP_4317: bitstring;
                                                    {4824}out(c, (GetEndpointResponse,pkSess_4315,Sign,SP_4316,UP_4317))
                                        )
                                        else
                                            {4825}let pkSess_4318: bitstring = fail-any in
                                            {4826}in(c, =GetEndpointRequest);
                                            {4827}new SP_4319: bitstring;
                                            {4828}new UP_4320: bitstring;
                                            {4829}out(c, (GetEndpointResponse,pkSess_4318,Sign,SP_4319,UP_4320))
                                )
                                else
                                    {4830}let pkSess_4321: bitstring = fail-any in
                                    {4831}in(c, =GetEndpointRequest);
                                    {4832}new SP_4322: bitstring;
                                    {4833}new UP_4323: bitstring;
                                    {4834}out(c, (GetEndpointResponse,pkSess_4321,Sign,SP_4322,UP_4323))
                            )
                            else
                                {4835}let v_4324: bool = (Cli_3932 = B) in
                                (
                                    {4836}if v_4324 then
                                    (
                                        {4837}let pkCli_4325: bitstring = pub(skB) in
                                        {4838}let v_4326: bool = (Sess_3934 = A) in
                                        (
                                            {4839}if v_4326 then
                                            (
                                                {4840}let pkSess_4327: bitstring = pub(skA) in
                                                {4841}in(c, =GetEndpointRequest);
                                                {4842}new SP_4328: bitstring;
                                                {4843}new UP_4329: bitstring;
                                                {4844}out(c, (GetEndpointResponse,pkSess_4327,Sign,SP_4328,UP_4329))
                                            )
                                            else
                                                {4845}let v_4330: bool = (Sess_3934 = B) in
                                                (
                                                    {4846}if v_4330 then
                                                    (
                                                        {4847}let pkSess_4331: bitstring = pub(skB) in
                                                        {4848}in(c, =GetEndpointRequest);
                                                        {4849}new SP_4332: bitstring;
                                                        {4850}new UP_4333: bitstring;
                                                        {4851}out(c, (GetEndpointResponse,pkSess_4331,Sign,SP_4332,UP_4333))
                                                    )
                                                    else
                                                        {4852}let v_4334: bool = (Sess_3934 = C) in
                                                        (
                                                            {4853}if v_4334 then
                                                            (
                                                                {4854}let pkSess_4335: bitstring = pub(skC) in
                                                                {4855}in(c, =GetEndpointRequest);
                                                                {4856}new SP_4336: bitstring;
                                                                {4857}new UP_4337: bitstring;
                                                                {4858}out(c, (GetEndpointResponse,pkSess_4335,Sign,SP_4336,UP_4337))
                                                            )
                                                            else
                                                                {4859}let pkSess_4338: bitstring = pub(sk(Sess_3934)) in
                                                                {4860}in(c, =GetEndpointRequest);
                                                                {4861}new SP_4339: bitstring;
                                                                {4862}new UP_4340: bitstring;
                                                                {4863}out(c, (GetEndpointResponse,pkSess_4338,Sign,SP_4339,UP_4340))
                                                        )
                                                        else
                                                            {4864}let pkSess_4341: bitstring = fail-any in
                                                            {4865}in(c, =GetEndpointRequest);
                                                            {4866}new SP_4342: bitstring;
                                                            {4867}new UP_4343: bitstring;
                                                            {4868}out(c, (GetEndpointResponse,pkSess_4341,Sign,SP_4342,UP_4343))
                                                )
                                                else
                                                    {4869}let pkSess_4344: bitstring = fail-any in
                                                    {4870}in(c, =GetEndpointRequest);
                                                    {4871}new SP_4345: bitstring;
                                                    {4872}new UP_4346: bitstring;
                                                    {4873}out(c, (GetEndpointResponse,pkSess_4344,Sign,SP_4345,UP_4346))
                                        )
                                        else
                                            {4874}let pkSess_4347: bitstring = fail-any in
                                            {4875}in(c, =GetEndpointRequest);
                                            {4876}new SP_4348: bitstring;
                                            {4877}new UP_4349: bitstring;
                                            {4878}out(c, (GetEndpointResponse,pkSess_4347,Sign,SP_4348,UP_4349))
                                    )
                                    else
                                        {4879}let v_4350: bool = (Cli_3932 = C) in
                                        (
                                            {4880}if v_4350 then
                                            (
                                                {4881}let pkCli_4351: bitstring = pub(skC) in
                                                {4882}let v_4352: bool = (Sess_3934 = A) in
                                                (
                                                    {4883}if v_4352 then
                                                    (
                                                        {4884}let pkSess_4353: bitstring = pub(skA) in
                                                        {4885}in(c, =GetEndpointRequest);
                                                        {4886}new SP_4354: bitstring;
                                                        {4887}new UP_4355: bitstring;
                                                        {4888}out(c, (GetEndpointResponse,pkSess_4353,Sign,SP_4354,UP_4355))
                                                    )
                                                    else
                                                        {4889}let v_4356: bool = (Sess_3934 = B) in
                                                        (
                                                            {4890}if v_4356 then
                                                            (
                                                                {4891}let pkSess_4357: bitstring = pub(skB) in
                                                                {4892}in(c, =GetEndpointRequest);
                                                                {4893}new SP_4358: bitstring;
                                                                {4894}new UP_4359: bitstring;
                                                                {4895}out(c, (GetEndpointResponse,pkSess_4357,Sign,SP_4358,UP_4359))
                                                            )
                                                            else
                                                                {4896}let v_4360: bool = (Sess_3934 = C) in
                                                                (
                                                                    {4897}if v_4360 then
                                                                    (
                                                                        {4898}let pkSess_4361: bitstring = pub(skC) in
                                                                        {4899}in(c, =GetEndpointRequest);
                                                                        {4900}new SP_4362: bitstring;
                                                                        {4901}new UP_4363: bitstring;
                                                                        {4902}out(c, (GetEndpointResponse,pkSess_4361,Sign,SP_4362,UP_4363))
                                                                    )
                                                                    else
                                                                        {4903}let pkSess_4364: bitstring = pub(sk(Sess_3934)) in
                                                                        {4904}in(c, =GetEndpointRequest);
                                                                        {4905}new SP_4365: bitstring;
                                                                        {4906}new UP_4366: bitstring;
                                                                        {4907}out(c, (GetEndpointResponse,pkSess_4364,Sign,SP_4365,UP_4366))
                                                                )
                                                                else
                                                                    {4908}let pkSess_4367: bitstring = fail-any in
                                                                    {4909}in(c, =GetEndpointRequest);
                                                                    {4910}new SP_4368: bitstring;
                                                                    {4911}new UP_4369: bitstring;
                                                                    {4912}out(c, (GetEndpointResponse,pkSess_4367,Sign,SP_4368,UP_4369))
                                                        )
                                                        else
                                                            {4913}let pkSess_4370: bitstring = fail-any in
                                                            {4914}in(c, =GetEndpointRequest);
                                                            {4915}new SP_4371: bitstring;
                                                            {4916}new UP_4372: bitstring;
                                                            {4917}out(c, (GetEndpointResponse,pkSess_4370,Sign,SP_4371,UP_4372))
                                                )
                                                else
                                                    {4918}let pkSess_4373: bitstring = fail-any in
                                                    {4919}in(c, =GetEndpointRequest);
                                                    {4920}new SP_4374: bitstring;
                                                    {4921}new UP_4375: bitstring;
                                                    {4922}out(c, (GetEndpointResponse,pkSess_4373,Sign,SP_4374,UP_4375))
                                            )
                                            else
                                                {4923}let pkCli_4376: bitstring = pub(sk(Cli_3932)) in
                                                {4924}let v_4377: bool = (Sess_3934 = A) in
                                                (
                                                    {4925}if v_4377 then
                                                    (
                                                        {4926}let pkSess_4378: bitstring = pub(skA) in
                                                        {4927}in(c, =GetEndpointRequest);
                                                        {4928}new SP_4379: bitstring;
                                                        {4929}new UP_4380: bitstring;
                                                        {4930}out(c, (GetEndpointResponse,pkSess_4378,Sign,SP_4379,UP_4380))
                                                    )
                                                    else
                                                        {4931}let v_4381: bool = (Sess_3934 = B) in
                                                        (
                                                            {4932}if v_4381 then
                                                            (
                                                                {4933}let pkSess_4382: bitstring = pub(skB) in
                                                                {4934}in(c, =GetEndpointRequest);
                                                                {4935}new SP_4383: bitstring;
                                                                {4936}new UP_4384: bitstring;
                                                                {4937}out(c, (GetEndpointResponse,pkSess_4382,Sign,SP_4383,UP_4384))
                                                            )
                                                            else
                                                                {4938}let v_4385: bool = (Sess_3934 = C) in
                                                                (
                                                                    {4939}if v_4385 then
                                                                    (
                                                                        {4940}let pkSess_4386: bitstring = pub(skC) in
                                                                        {4941}in(c, =GetEndpointRequest);
                                                                        {4942}new SP_4387: bitstring;
                                                                        {4943}new UP_4388: bitstring;
                                                                        {4944}out(c, (GetEndpointResponse,pkSess_4386,Sign,SP_4387,UP_4388))
                                                                    )
                                                                    else
                                                                        {4945}let pkSess_4389: bitstring = pub(sk(Sess_3934)) in
                                                                        {4946}in(c, =GetEndpointRequest);
                                                                        {4947}new SP_4390: bitstring;
                                                                        {4948}new UP_4391: bitstring;
                                                                        {4949}out(c, (GetEndpointResponse,pkSess_4389,Sign,SP_4390,UP_4391))
                                                                )
                                                                else
                                                                    {4950}let pkSess_4392: bitstring = fail-any in
                                                                    {4951}in(c, =GetEndpointRequest);
                                                                    {4952}new SP_4393: bitstring;
                                                                    {4953}new UP_4394: bitstring;
                                                                    {4954}out(c, (GetEndpointResponse,pkSess_4392,Sign,SP_4393,UP_4394))
                                                        )
                                                        else
                                                            {4955}let pkSess_4395: bitstring = fail-any in
                                                            {4956}in(c, =GetEndpointRequest);
                                                            {4957}new SP_4396: bitstring;
                                                            {4958}new UP_4397: bitstring;
                                                            {4959}out(c, (GetEndpointResponse,pkSess_4395,Sign,SP_4396,UP_4397))
                                                )
                                                else
                                                    {4960}let pkSess_4398: bitstring = fail-any in
                                                    {4961}in(c, =GetEndpointRequest);
                                                    {4962}new SP_4399: bitstring;
                                                    {4963}new UP_4400: bitstring;
                                                    {4964}out(c, (GetEndpointResponse,pkSess_4398,Sign,SP_4399,UP_4400))
                                        )
                                        else
                                            {4965}let pkCli_4401: bitstring = fail-any in
                                            {4966}let v_4402: bool = (Sess_3934 = A) in
                                            (
                                                {4967}if v_4402 then
                                                (
                                                    {4968}let pkSess_4403: bitstring = pub(skA) in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4404: bitstring;
                                                    {4971}new UP_4405: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4403,Sign,SP_4404,UP_4405))
                                                )
                                                else
                                                    {4973}let v_4406: bool = (Sess_3934 = B) in
                                                    (
                                                        {4974}if v_4406 then
                                                        (
                                                            {4975}let pkSess_4407: bitstring = pub(skB) in
                                                            {4976}in(c, =GetEndpointRequest);
                                                            {4977}new SP_4408: bitstring;
                                                            {4978}new UP_4409: bitstring;
                                                            {4979}out(c, (GetEndpointResponse,pkSess_4407,Sign,SP_4408,UP_4409))
                                                        )
                                                        else
                                                            {4980}let v_4410: bool = (Sess_3934 = C) in
                                                            (
                                                                {4981}if v_4410 then
                                                                (
                                                                    {4982}let pkSess_4411: bitstring = pub(skC) in
                                                                    {4983}in(c, =GetEndpointRequest);
                                                                    {4984}new SP_4412: bitstring;
                                                                    {4985}new UP_4413: bitstring;
                                                                    {4986}out(c, (GetEndpointResponse,pkSess_4411,Sign,SP_4412,UP_4413))
                                                                )
                                                                else
                                                                    {4987}let pkSess_4414: bitstring = pub(sk(Sess_3934)) in
                                                                    {4988}in(c, =GetEndpointRequest);
                                                                    {4989}new SP_4415: bitstring;
                                                                    {4990}new UP_4416: bitstring;
                                                                    {4991}out(c, (GetEndpointResponse,pkSess_4414,Sign,SP_4415,UP_4416))
                                                            )
                                                            else
                                                                {4992}let pkSess_4417: bitstring = fail-any in
                                                                {4993}in(c, =GetEndpointRequest);
                                                                {4994}new SP_4418: bitstring;
                                                                {4995}new UP_4419: bitstring;
                                                                {4996}out(c, (GetEndpointResponse,pkSess_4417,Sign,SP_4418,UP_4419))
                                                    )
                                                    else
                                                        {4997}let pkSess_4420: bitstring = fail-any in
                                                        {4998}in(c, =GetEndpointRequest);
                                                        {4999}new SP_4421: bitstring;
                                                        {5000}new UP_4422: bitstring;
                                                        {5001}out(c, (GetEndpointResponse,pkSess_4420,Sign,SP_4421,UP_4422))
                                            )
                                            else
                                                {5002}let pkSess_4423: bitstring = fail-any in
                                                {5003}in(c, =GetEndpointRequest);
                                                {5004}new SP_4424: bitstring;
                                                {5005}new UP_4425: bitstring;
                                                {5006}out(c, (GetEndpointResponse,pkSess_4423,Sign,SP_4424,UP_4425))
                                )
                                else
                                    {5007}let pkCli_4426: bitstring = fail-any in
                                    {5008}let v_4427: bool = (Sess_3934 = A) in
                                    (
                                        {5009}if v_4427 then
                                        (
                                            {5010}let pkSess_4428: bitstring = pub(skA) in
                                            {5011}in(c, =GetEndpointRequest);
                                            {5012}new SP_4429: bitstring;
                                            {5013}new UP_4430: bitstring;
                                            {5014}out(c, (GetEndpointResponse,pkSess_4428,Sign,SP_4429,UP_4430))
                                        )
                                        else
                                            {5015}let v_4431: bool = (Sess_3934 = B) in
                                            (
                                                {5016}if v_4431 then
                                                (
                                                    {5017}let pkSess_4432: bitstring = pub(skB) in
                                                    {5018}in(c, =GetEndpointRequest);
                                                    {5019}new SP_4433: bitstring;
                                                    {5020}new UP_4434: bitstring;
                                                    {5021}out(c, (GetEndpointResponse,pkSess_4432,Sign,SP_4433,UP_4434))
                                                )
                                                else
                                                    {5022}let v_4435: bool = (Sess_3934 = C) in
                                                    (
                                                        {5023}if v_4435 then
                                                        (
                                                            {5024}let pkSess_4436: bitstring = pub(skC) in
                                                            {5025}in(c, =GetEndpointRequest);
                                                            {5026}new SP_4437: bitstring;
                                                            {5027}new UP_4438: bitstring;
                                                            {5028}out(c, (GetEndpointResponse,pkSess_4436,Sign,SP_4437,UP_4438))
                                                        )
                                                        else
                                                            {5029}let pkSess_4439: bitstring = pub(sk(Sess_3934)) in
                                                            {5030}in(c, =GetEndpointRequest);
                                                            {5031}new SP_4440: bitstring;
                                                            {5032}new UP_4441: bitstring;
                                                            {5033}out(c, (GetEndpointResponse,pkSess_4439,Sign,SP_4440,UP_4441))
                                                    )
                                                    else
                                                        {5034}let pkSess_4442: bitstring = fail-any in
                                                        {5035}in(c, =GetEndpointRequest);
                                                        {5036}new SP_4443: bitstring;
                                                        {5037}new UP_4444: bitstring;
                                                        {5038}out(c, (GetEndpointResponse,pkSess_4442,Sign,SP_4443,UP_4444))
                                            )
                                            else
                                                {5039}let pkSess_4445: bitstring = fail-any in
                                                {5040}in(c, =GetEndpointRequest);
                                                {5041}new SP_4446: bitstring;
                                                {5042}new UP_4447: bitstring;
                                                {5043}out(c, (GetEndpointResponse,pkSess_4445,Sign,SP_4446,UP_4447))
                                    )
                                    else
                                        {5044}let pkSess_4448: bitstring = fail-any in
                                        {5045}in(c, =GetEndpointRequest);
                                        {5046}new SP_4449: bitstring;
                                        {5047}new UP_4450: bitstring;
                                        {5048}out(c, (GetEndpointResponse,pkSess_4448,Sign,SP_4449,UP_4450))
                        )
                        else
                            {5049}let pkCli_4451: bitstring = fail-any in
                            {5050}let v_4452: bool = (Sess_3934 = A) in
                            (
                                {5051}if v_4452 then
                                (
                                    {5052}let pkSess_4453: bitstring = pub(skA) in
                                    {5053}in(c, =GetEndpointRequest);
                                    {5054}new SP_4454: bitstring;
                                    {5055}new UP_4455: bitstring;
                                    {5056}out(c, (GetEndpointResponse,pkSess_4453,Sign,SP_4454,UP_4455))
                                )
                                else
                                    {5057}let v_4456: bool = (Sess_3934 = B) in
                                    (
                                        {5058}if v_4456 then
                                        (
                                            {5059}let pkSess_4457: bitstring = pub(skB) in
                                            {5060}in(c, =GetEndpointRequest);
                                            {5061}new SP_4458: bitstring;
                                            {5062}new UP_4459: bitstring;
                                            {5063}out(c, (GetEndpointResponse,pkSess_4457,Sign,SP_4458,UP_4459))
                                        )
                                        else
                                            {5064}let v_4460: bool = (Sess_3934 = C) in
                                            (
                                                {5065}if v_4460 then
                                                (
                                                    {5066}let pkSess_4461: bitstring = pub(skC) in
                                                    {5067}in(c, =GetEndpointRequest);
                                                    {5068}new SP_4462: bitstring;
                                                    {5069}new UP_4463: bitstring;
                                                    {5070}out(c, (GetEndpointResponse,pkSess_4461,Sign,SP_4462,UP_4463))
                                                )
                                                else
                                                    {5071}let pkSess_4464: bitstring = pub(sk(Sess_3934)) in
                                                    {5072}in(c, =GetEndpointRequest);
                                                    {5073}new SP_4465: bitstring;
                                                    {5074}new UP_4466: bitstring;
                                                    {5075}out(c, (GetEndpointResponse,pkSess_4464,Sign,SP_4465,UP_4466))
                                            )
                                            else
                                                {5076}let pkSess_4467: bitstring = fail-any in
                                                {5077}in(c, =GetEndpointRequest);
                                                {5078}new SP_4468: bitstring;
                                                {5079}new UP_4469: bitstring;
                                                {5080}out(c, (GetEndpointResponse,pkSess_4467,Sign,SP_4468,UP_4469))
                                    )
                                    else
                                        {5081}let pkSess_4470: bitstring = fail-any in
                                        {5082}in(c, =GetEndpointRequest);
                                        {5083}new SP_4471: bitstring;
                                        {5084}new UP_4472: bitstring;
                                        {5085}out(c, (GetEndpointResponse,pkSess_4470,Sign,SP_4471,UP_4472))
                            )
                            else
                                {5086}let pkSess_4473: bitstring = fail-any in
                                {5087}in(c, =GetEndpointRequest);
                                {5088}new SP_4474: bitstring;
                                {5089}new UP_4475: bitstring;
                                {5090}out(c, (GetEndpointResponse,pkSess_4473,Sign,SP_4474,UP_4475))
                    )
                    else
                        {5091}let skDisco_4476: bitstring = fail-any in
                        {5092}let pkDisco_4477: bitstring = pub(skDisco_4476) in
                        {5093}let v_4478: bool = (Cli_3932 = A) in
                        (
                            {5094}if v_4478 then
                            (
                                {5095}let pkCli_4479: bitstring = pub(skA) in
                                {5096}let v_4480: bool = (Sess_3934 = A) in
                                (
                                    {5097}if v_4480 then
                                    (
                                        {5098}let pkSess_4481: bitstring = pub(skA) in
                                        {5099}in(c, =GetEndpointRequest);
                                        {5100}new SP_4482: bitstring;
                                        {5101}new UP_4483: bitstring;
                                        {5102}out(c, (GetEndpointResponse,pkSess_4481,Sign,SP_4482,UP_4483))
                                    )
                                    else
                                        {5103}let v_4484: bool = (Sess_3934 = B) in
                                        (
                                            {5104}if v_4484 then
                                            (
                                                {5105}let pkSess_4485: bitstring = pub(skB) in
                                                {5106}in(c, =GetEndpointRequest);
                                                {5107}new SP_4486: bitstring;
                                                {5108}new UP_4487: bitstring;
                                                {5109}out(c, (GetEndpointResponse,pkSess_4485,Sign,SP_4486,UP_4487))
                                            )
                                            else
                                                {5110}let v_4488: bool = (Sess_3934 = C) in
                                                (
                                                    {5111}if v_4488 then
                                                    (
                                                        {5112}let pkSess_4489: bitstring = pub(skC) in
                                                        {5113}in(c, =GetEndpointRequest);
                                                        {5114}new SP_4490: bitstring;
                                                        {5115}new UP_4491: bitstring;
                                                        {5116}out(c, (GetEndpointResponse,pkSess_4489,Sign,SP_4490,UP_4491))
                                                    )
                                                    else
                                                        {5117}let pkSess_4492: bitstring = pub(sk(Sess_3934)) in
                                                        {5118}in(c, =GetEndpointRequest);
                                                        {5119}new SP_4493: bitstring;
                                                        {5120}new UP_4494: bitstring;
                                                        {5121}out(c, (GetEndpointResponse,pkSess_4492,Sign,SP_4493,UP_4494))
                                                )
                                                else
                                                    {5122}let pkSess_4495: bitstring = fail-any in
                                                    {5123}in(c, =GetEndpointRequest);
                                                    {5124}new SP_4496: bitstring;
                                                    {5125}new UP_4497: bitstring;
                                                    {5126}out(c, (GetEndpointResponse,pkSess_4495,Sign,SP_4496,UP_4497))
                                        )
                                        else
                                            {5127}let pkSess_4498: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SP_4499: bitstring;
                                            {5130}new UP_4500: bitstring;
                                            {5131}out(c, (GetEndpointResponse,pkSess_4498,Sign,SP_4499,UP_4500))
                                )
                                else
                                    {5132}let pkSess_4501: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SP_4502: bitstring;
                                    {5135}new UP_4503: bitstring;
                                    {5136}out(c, (GetEndpointResponse,pkSess_4501,Sign,SP_4502,UP_4503))
                            )
                            else
                                {5137}let v_4504: bool = (Cli_3932 = B) in
                                (
                                    {5138}if v_4504 then
                                    (
                                        {5139}let pkCli_4505: bitstring = pub(skB) in
                                        {5140}let v_4506: bool = (Sess_3934 = A) in
                                        (
                                            {5141}if v_4506 then
                                            (
                                                {5142}let pkSess_4507: bitstring = pub(skA) in
                                                {5143}in(c, =GetEndpointRequest);
                                                {5144}new SP_4508: bitstring;
                                                {5145}new UP_4509: bitstring;
                                                {5146}out(c, (GetEndpointResponse,pkSess_4507,Sign,SP_4508,UP_4509))
                                            )
                                            else
                                                {5147}let v_4510: bool = (Sess_3934 = B) in
                                                (
                                                    {5148}if v_4510 then
                                                    (
                                                        {5149}let pkSess_4511: bitstring = pub(skB) in
                                                        {5150}in(c, =GetEndpointRequest);
                                                        {5151}new SP_4512: bitstring;
                                                        {5152}new UP_4513: bitstring;
                                                        {5153}out(c, (GetEndpointResponse,pkSess_4511,Sign,SP_4512,UP_4513))
                                                    )
                                                    else
                                                        {5154}let v_4514: bool = (Sess_3934 = C) in
                                                        (
                                                            {5155}if v_4514 then
                                                            (
                                                                {5156}let pkSess_4515: bitstring = pub(skC) in
                                                                {5157}in(c, =GetEndpointRequest);
                                                                {5158}new SP_4516: bitstring;
                                                                {5159}new UP_4517: bitstring;
                                                                {5160}out(c, (GetEndpointResponse,pkSess_4515,Sign,SP_4516,UP_4517))
                                                            )
                                                            else
                                                                {5161}let pkSess_4518: bitstring = pub(sk(Sess_3934)) in
                                                                {5162}in(c, =GetEndpointRequest);
                                                                {5163}new SP_4519: bitstring;
                                                                {5164}new UP_4520: bitstring;
                                                                {5165}out(c, (GetEndpointResponse,pkSess_4518,Sign,SP_4519,UP_4520))
                                                        )
                                                        else
                                                            {5166}let pkSess_4521: bitstring = fail-any in
                                                            {5167}in(c, =GetEndpointRequest);
                                                            {5168}new SP_4522: bitstring;
                                                            {5169}new UP_4523: bitstring;
                                                            {5170}out(c, (GetEndpointResponse,pkSess_4521,Sign,SP_4522,UP_4523))
                                                )
                                                else
                                                    {5171}let pkSess_4524: bitstring = fail-any in
                                                    {5172}in(c, =GetEndpointRequest);
                                                    {5173}new SP_4525: bitstring;
                                                    {5174}new UP_4526: bitstring;
                                                    {5175}out(c, (GetEndpointResponse,pkSess_4524,Sign,SP_4525,UP_4526))
                                        )
                                        else
                                            {5176}let pkSess_4527: bitstring = fail-any in
                                            {5177}in(c, =GetEndpointRequest);
                                            {5178}new SP_4528: bitstring;
                                            {5179}new UP_4529: bitstring;
                                            {5180}out(c, (GetEndpointResponse,pkSess_4527,Sign,SP_4528,UP_4529))
                                    )
                                    else
                                        {5181}let v_4530: bool = (Cli_3932 = C) in
                                        (
                                            {5182}if v_4530 then
                                            (
                                                {5183}let pkCli_4531: bitstring = pub(skC) in
                                                {5184}let v_4532: bool = (Sess_3934 = A) in
                                                (
                                                    {5185}if v_4532 then
                                                    (
                                                        {5186}let pkSess_4533: bitstring = pub(skA) in
                                                        {5187}in(c, =GetEndpointRequest);
                                                        {5188}new SP_4534: bitstring;
                                                        {5189}new UP_4535: bitstring;
                                                        {5190}out(c, (GetEndpointResponse,pkSess_4533,Sign,SP_4534,UP_4535))
                                                    )
                                                    else
                                                        {5191}let v_4536: bool = (Sess_3934 = B) in
                                                        (
                                                            {5192}if v_4536 then
                                                            (
                                                                {5193}let pkSess_4537: bitstring = pub(skB) in
                                                                {5194}in(c, =GetEndpointRequest);
                                                                {5195}new SP_4538: bitstring;
                                                                {5196}new UP_4539: bitstring;
                                                                {5197}out(c, (GetEndpointResponse,pkSess_4537,Sign,SP_4538,UP_4539))
                                                            )
                                                            else
                                                                {5198}let v_4540: bool = (Sess_3934 = C) in
                                                                (
                                                                    {5199}if v_4540 then
                                                                    (
                                                                        {5200}let pkSess_4541: bitstring = pub(skC) in
                                                                        {5201}in(c, =GetEndpointRequest);
                                                                        {5202}new SP_4542: bitstring;
                                                                        {5203}new UP_4543: bitstring;
                                                                        {5204}out(c, (GetEndpointResponse,pkSess_4541,Sign,SP_4542,UP_4543))
                                                                    )
                                                                    else
                                                                        {5205}let pkSess_4544: bitstring = pub(sk(Sess_3934)) in
                                                                        {5206}in(c, =GetEndpointRequest);
                                                                        {5207}new SP_4545: bitstring;
                                                                        {5208}new UP_4546: bitstring;
                                                                        {5209}out(c, (GetEndpointResponse,pkSess_4544,Sign,SP_4545,UP_4546))
                                                                )
                                                                else
                                                                    {5210}let pkSess_4547: bitstring = fail-any in
                                                                    {5211}in(c, =GetEndpointRequest);
                                                                    {5212}new SP_4548: bitstring;
                                                                    {5213}new UP_4549: bitstring;
                                                                    {5214}out(c, (GetEndpointResponse,pkSess_4547,Sign,SP_4548,UP_4549))
                                                        )
                                                        else
                                                            {5215}let pkSess_4550: bitstring = fail-any in
                                                            {5216}in(c, =GetEndpointRequest);
                                                            {5217}new SP_4551: bitstring;
                                                            {5218}new UP_4552: bitstring;
                                                            {5219}out(c, (GetEndpointResponse,pkSess_4550,Sign,SP_4551,UP_4552))
                                                )
                                                else
                                                    {5220}let pkSess_4553: bitstring = fail-any in
                                                    {5221}in(c, =GetEndpointRequest);
                                                    {5222}new SP_4554: bitstring;
                                                    {5223}new UP_4555: bitstring;
                                                    {5224}out(c, (GetEndpointResponse,pkSess_4553,Sign,SP_4554,UP_4555))
                                            )
                                            else
                                                {5225}let pkCli_4556: bitstring = pub(sk(Cli_3932)) in
                                                {5226}let v_4557: bool = (Sess_3934 = A) in
                                                (
                                                    {5227}if v_4557 then
                                                    (
                                                        {5228}let pkSess_4558: bitstring = pub(skA) in
                                                        {5229}in(c, =GetEndpointRequest);
                                                        {5230}new SP_4559: bitstring;
                                                        {5231}new UP_4560: bitstring;
                                                        {5232}out(c, (GetEndpointResponse,pkSess_4558,Sign,SP_4559,UP_4560))
                                                    )
                                                    else
                                                        {5233}let v_4561: bool = (Sess_3934 = B) in
                                                        (
                                                            {5234}if v_4561 then
                                                            (
                                                                {5235}let pkSess_4562: bitstring = pub(skB) in
                                                                {5236}in(c, =GetEndpointRequest);
                                                                {5237}new SP_4563: bitstring;
                                                                {5238}new UP_4564: bitstring;
                                                                {5239}out(c, (GetEndpointResponse,pkSess_4562,Sign,SP_4563,UP_4564))
                                                            )
                                                            else
                                                                {5240}let v_4565: bool = (Sess_3934 = C) in
                                                                (
                                                                    {5241}if v_4565 then
                                                                    (
                                                                        {5242}let pkSess_4566: bitstring = pub(skC) in
                                                                        {5243}in(c, =GetEndpointRequest);
                                                                        {5244}new SP_4567: bitstring;
                                                                        {5245}new UP_4568: bitstring;
                                                                        {5246}out(c, (GetEndpointResponse,pkSess_4566,Sign,SP_4567,UP_4568))
                                                                    )
                                                                    else
                                                                        {5247}let pkSess_4569: bitstring = pub(sk(Sess_3934)) in
                                                                        {5248}in(c, =GetEndpointRequest);
                                                                        {5249}new SP_4570: bitstring;
                                                                        {5250}new UP_4571: bitstring;
                                                                        {5251}out(c, (GetEndpointResponse,pkSess_4569,Sign,SP_4570,UP_4571))
                                                                )
                                                                else
                                                                    {5252}let pkSess_4572: bitstring = fail-any in
                                                                    {5253}in(c, =GetEndpointRequest);
                                                                    {5254}new SP_4573: bitstring;
                                                                    {5255}new UP_4574: bitstring;
                                                                    {5256}out(c, (GetEndpointResponse,pkSess_4572,Sign,SP_4573,UP_4574))
                                                        )
                                                        else
                                                            {5257}let pkSess_4575: bitstring = fail-any in
                                                            {5258}in(c, =GetEndpointRequest);
                                                            {5259}new SP_4576: bitstring;
                                                            {5260}new UP_4577: bitstring;
                                                            {5261}out(c, (GetEndpointResponse,pkSess_4575,Sign,SP_4576,UP_4577))
                                                )
                                                else
                                                    {5262}let pkSess_4578: bitstring = fail-any in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_4579: bitstring;
                                                    {5265}new UP_4580: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_4578,Sign,SP_4579,UP_4580))
                                        )
                                        else
                                            {5267}let pkCli_4581: bitstring = fail-any in
                                            {5268}let v_4582: bool = (Sess_3934 = A) in
                                            (
                                                {5269}if v_4582 then
                                                (
                                                    {5270}let pkSess_4583: bitstring = pub(skA) in
                                                    {5271}in(c, =GetEndpointRequest);
                                                    {5272}new SP_4584: bitstring;
                                                    {5273}new UP_4585: bitstring;
                                                    {5274}out(c, (GetEndpointResponse,pkSess_4583,Sign,SP_4584,UP_4585))
                                                )
                                                else
                                                    {5275}let v_4586: bool = (Sess_3934 = B) in
                                                    (
                                                        {5276}if v_4586 then
                                                        (
                                                            {5277}let pkSess_4587: bitstring = pub(skB) in
                                                            {5278}in(c, =GetEndpointRequest);
                                                            {5279}new SP_4588: bitstring;
                                                            {5280}new UP_4589: bitstring;
                                                            {5281}out(c, (GetEndpointResponse,pkSess_4587,Sign,SP_4588,UP_4589))
                                                        )
                                                        else
                                                            {5282}let v_4590: bool = (Sess_3934 = C) in
                                                            (
                                                                {5283}if v_4590 then
                                                                (
                                                                    {5284}let pkSess_4591: bitstring = pub(skC) in
                                                                    {5285}in(c, =GetEndpointRequest);
                                                                    {5286}new SP_4592: bitstring;
                                                                    {5287}new UP_4593: bitstring;
                                                                    {5288}out(c, (GetEndpointResponse,pkSess_4591,Sign,SP_4592,UP_4593))
                                                                )
                                                                else
                                                                    {5289}let pkSess_4594: bitstring = pub(sk(Sess_3934)) in
                                                                    {5290}in(c, =GetEndpointRequest);
                                                                    {5291}new SP_4595: bitstring;
                                                                    {5292}new UP_4596: bitstring;
                                                                    {5293}out(c, (GetEndpointResponse,pkSess_4594,Sign,SP_4595,UP_4596))
                                                            )
                                                            else
                                                                {5294}let pkSess_4597: bitstring = fail-any in
                                                                {5295}in(c, =GetEndpointRequest);
                                                                {5296}new SP_4598: bitstring;
                                                                {5297}new UP_4599: bitstring;
                                                                {5298}out(c, (GetEndpointResponse,pkSess_4597,Sign,SP_4598,UP_4599))
                                                    )
                                                    else
                                                        {5299}let pkSess_4600: bitstring = fail-any in
                                                        {5300}in(c, =GetEndpointRequest);
                                                        {5301}new SP_4601: bitstring;
                                                        {5302}new UP_4602: bitstring;
                                                        {5303}out(c, (GetEndpointResponse,pkSess_4600,Sign,SP_4601,UP_4602))
                                            )
                                            else
                                                {5304}let pkSess_4603: bitstring = fail-any in
                                                {5305}in(c, =GetEndpointRequest);
                                                {5306}new SP_4604: bitstring;
                                                {5307}new UP_4605: bitstring;
                                                {5308}out(c, (GetEndpointResponse,pkSess_4603,Sign,SP_4604,UP_4605))
                                )
                                else
                                    {5309}let pkCli_4606: bitstring = fail-any in
                                    {5310}let v_4607: bool = (Sess_3934 = A) in
                                    (
                                        {5311}if v_4607 then
                                        (
                                            {5312}let pkSess_4608: bitstring = pub(skA) in
                                            {5313}in(c, =GetEndpointRequest);
                                            {5314}new SP_4609: bitstring;
                                            {5315}new UP_4610: bitstring;
                                            {5316}out(c, (GetEndpointResponse,pkSess_4608,Sign,SP_4609,UP_4610))
                                        )
                                        else
                                            {5317}let v_4611: bool = (Sess_3934 = B) in
                                            (
                                                {5318}if v_4611 then
                                                (
                                                    {5319}let pkSess_4612: bitstring = pub(skB) in
                                                    {5320}in(c, =GetEndpointRequest);
                                                    {5321}new SP_4613: bitstring;
                                                    {5322}new UP_4614: bitstring;
                                                    {5323}out(c, (GetEndpointResponse,pkSess_4612,Sign,SP_4613,UP_4614))
                                                )
                                                else
                                                    {5324}let v_4615: bool = (Sess_3934 = C) in
                                                    (
                                                        {5325}if v_4615 then
                                                        (
                                                            {5326}let pkSess_4616: bitstring = pub(skC) in
                                                            {5327}in(c, =GetEndpointRequest);
                                                            {5328}new SP_4617: bitstring;
                                                            {5329}new UP_4618: bitstring;
                                                            {5330}out(c, (GetEndpointResponse,pkSess_4616,Sign,SP_4617,UP_4618))
                                                        )
                                                        else
                                                            {5331}let pkSess_4619: bitstring = pub(sk(Sess_3934)) in
                                                            {5332}in(c, =GetEndpointRequest);
                                                            {5333}new SP_4620: bitstring;
                                                            {5334}new UP_4621: bitstring;
                                                            {5335}out(c, (GetEndpointResponse,pkSess_4619,Sign,SP_4620,UP_4621))
                                                    )
                                                    else
                                                        {5336}let pkSess_4622: bitstring = fail-any in
                                                        {5337}in(c, =GetEndpointRequest);
                                                        {5338}new SP_4623: bitstring;
                                                        {5339}new UP_4624: bitstring;
                                                        {5340}out(c, (GetEndpointResponse,pkSess_4622,Sign,SP_4623,UP_4624))
                                            )
                                            else
                                                {5341}let pkSess_4625: bitstring = fail-any in
                                                {5342}in(c, =GetEndpointRequest);
                                                {5343}new SP_4626: bitstring;
                                                {5344}new UP_4627: bitstring;
                                                {5345}out(c, (GetEndpointResponse,pkSess_4625,Sign,SP_4626,UP_4627))
                                    )
                                    else
                                        {5346}let pkSess_4628: bitstring = fail-any in
                                        {5347}in(c, =GetEndpointRequest);
                                        {5348}new SP_4629: bitstring;
                                        {5349}new UP_4630: bitstring;
                                        {5350}out(c, (GetEndpointResponse,pkSess_4628,Sign,SP_4629,UP_4630))
                        )
                        else
                            {5351}let pkCli_4631: bitstring = fail-any in
                            {5352}let v_4632: bool = (Sess_3934 = A) in
                            (
                                {5353}if v_4632 then
                                (
                                    {5354}let pkSess_4633: bitstring = pub(skA) in
                                    {5355}in(c, =GetEndpointRequest);
                                    {5356}new SP_4634: bitstring;
                                    {5357}new UP_4635: bitstring;
                                    {5358}out(c, (GetEndpointResponse,pkSess_4633,Sign,SP_4634,UP_4635))
                                )
                                else
                                    {5359}let v_4636: bool = (Sess_3934 = B) in
                                    (
                                        {5360}if v_4636 then
                                        (
                                            {5361}let pkSess_4637: bitstring = pub(skB) in
                                            {5362}in(c, =GetEndpointRequest);
                                            {5363}new SP_4638: bitstring;
                                            {5364}new UP_4639: bitstring;
                                            {5365}out(c, (GetEndpointResponse,pkSess_4637,Sign,SP_4638,UP_4639))
                                        )
                                        else
                                            {5366}let v_4640: bool = (Sess_3934 = C) in
                                            (
                                                {5367}if v_4640 then
                                                (
                                                    {5368}let pkSess_4641: bitstring = pub(skC) in
                                                    {5369}in(c, =GetEndpointRequest);
                                                    {5370}new SP_4642: bitstring;
                                                    {5371}new UP_4643: bitstring;
                                                    {5372}out(c, (GetEndpointResponse,pkSess_4641,Sign,SP_4642,UP_4643))
                                                )
                                                else
                                                    {5373}let pkSess_4644: bitstring = pub(sk(Sess_3934)) in
                                                    {5374}in(c, =GetEndpointRequest);
                                                    {5375}new SP_4645: bitstring;
                                                    {5376}new UP_4646: bitstring;
                                                    {5377}out(c, (GetEndpointResponse,pkSess_4644,Sign,SP_4645,UP_4646))
                                            )
                                            else
                                                {5378}let pkSess_4647: bitstring = fail-any in
                                                {5379}in(c, =GetEndpointRequest);
                                                {5380}new SP_4648: bitstring;
                                                {5381}new UP_4649: bitstring;
                                                {5382}out(c, (GetEndpointResponse,pkSess_4647,Sign,SP_4648,UP_4649))
                                    )
                                    else
                                        {5383}let pkSess_4650: bitstring = fail-any in
                                        {5384}in(c, =GetEndpointRequest);
                                        {5385}new SP_4651: bitstring;
                                        {5386}new UP_4652: bitstring;
                                        {5387}out(c, (GetEndpointResponse,pkSess_4650,Sign,SP_4651,UP_4652))
                            )
                            else
                                {5388}let pkSess_4653: bitstring = fail-any in
                                {5389}in(c, =GetEndpointRequest);
                                {5390}new SP_4654: bitstring;
                                {5391}new UP_4655: bitstring;
                                {5392}out(c, (GetEndpointResponse,pkSess_4653,Sign,SP_4654,UP_4655))
            )
            else
                {5393}let skDisco_4656: bitstring = fail-any in
                {5394}let pkDisco_4657: bitstring = pub(skDisco_4656) in
                {5395}let v_4658: bool = (Cli_3932 = A) in
                (
                    {5396}if v_4658 then
                    (
                        {5397}let pkCli_4659: bitstring = pub(skA) in
                        {5398}let v_4660: bool = (Sess_3934 = A) in
                        (
                            {5399}if v_4660 then
                            (
                                {5400}let pkSess_4661: bitstring = pub(skA) in
                                {5401}in(c, =GetEndpointRequest);
                                {5402}new SP_4662: bitstring;
                                {5403}new UP_4663: bitstring;
                                {5404}out(c, (GetEndpointResponse,pkSess_4661,Sign,SP_4662,UP_4663))
                            )
                            else
                                {5405}let v_4664: bool = (Sess_3934 = B) in
                                (
                                    {5406}if v_4664 then
                                    (
                                        {5407}let pkSess_4665: bitstring = pub(skB) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SP_4666: bitstring;
                                        {5410}new UP_4667: bitstring;
                                        {5411}out(c, (GetEndpointResponse,pkSess_4665,Sign,SP_4666,UP_4667))
                                    )
                                    else
                                        {5412}let v_4668: bool = (Sess_3934 = C) in
                                        (
                                            {5413}if v_4668 then
                                            (
                                                {5414}let pkSess_4669: bitstring = pub(skC) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SP_4670: bitstring;
                                                {5417}new UP_4671: bitstring;
                                                {5418}out(c, (GetEndpointResponse,pkSess_4669,Sign,SP_4670,UP_4671))
                                            )
                                            else
                                                {5419}let pkSess_4672: bitstring = pub(sk(Sess_3934)) in
                                                {5420}in(c, =GetEndpointRequest);
                                                {5421}new SP_4673: bitstring;
                                                {5422}new UP_4674: bitstring;
                                                {5423}out(c, (GetEndpointResponse,pkSess_4672,Sign,SP_4673,UP_4674))
                                        )
                                        else
                                            {5424}let pkSess_4675: bitstring = fail-any in
                                            {5425}in(c, =GetEndpointRequest);
                                            {5426}new SP_4676: bitstring;
                                            {5427}new UP_4677: bitstring;
                                            {5428}out(c, (GetEndpointResponse,pkSess_4675,Sign,SP_4676,UP_4677))
                                )
                                else
                                    {5429}let pkSess_4678: bitstring = fail-any in
                                    {5430}in(c, =GetEndpointRequest);
                                    {5431}new SP_4679: bitstring;
                                    {5432}new UP_4680: bitstring;
                                    {5433}out(c, (GetEndpointResponse,pkSess_4678,Sign,SP_4679,UP_4680))
                        )
                        else
                            {5434}let pkSess_4681: bitstring = fail-any in
                            {5435}in(c, =GetEndpointRequest);
                            {5436}new SP_4682: bitstring;
                            {5437}new UP_4683: bitstring;
                            {5438}out(c, (GetEndpointResponse,pkSess_4681,Sign,SP_4682,UP_4683))
                    )
                    else
                        {5439}let v_4684: bool = (Cli_3932 = B) in
                        (
                            {5440}if v_4684 then
                            (
                                {5441}let pkCli_4685: bitstring = pub(skB) in
                                {5442}let v_4686: bool = (Sess_3934 = A) in
                                (
                                    {5443}if v_4686 then
                                    (
                                        {5444}let pkSess_4687: bitstring = pub(skA) in
                                        {5445}in(c, =GetEndpointRequest);
                                        {5446}new SP_4688: bitstring;
                                        {5447}new UP_4689: bitstring;
                                        {5448}out(c, (GetEndpointResponse,pkSess_4687,Sign,SP_4688,UP_4689))
                                    )
                                    else
                                        {5449}let v_4690: bool = (Sess_3934 = B) in
                                        (
                                            {5450}if v_4690 then
                                            (
                                                {5451}let pkSess_4691: bitstring = pub(skB) in
                                                {5452}in(c, =GetEndpointRequest);
                                                {5453}new SP_4692: bitstring;
                                                {5454}new UP_4693: bitstring;
                                                {5455}out(c, (GetEndpointResponse,pkSess_4691,Sign,SP_4692,UP_4693))
                                            )
                                            else
                                                {5456}let v_4694: bool = (Sess_3934 = C) in
                                                (
                                                    {5457}if v_4694 then
                                                    (
                                                        {5458}let pkSess_4695: bitstring = pub(skC) in
                                                        {5459}in(c, =GetEndpointRequest);
                                                        {5460}new SP_4696: bitstring;
                                                        {5461}new UP_4697: bitstring;
                                                        {5462}out(c, (GetEndpointResponse,pkSess_4695,Sign,SP_4696,UP_4697))
                                                    )
                                                    else
                                                        {5463}let pkSess_4698: bitstring = pub(sk(Sess_3934)) in
                                                        {5464}in(c, =GetEndpointRequest);
                                                        {5465}new SP_4699: bitstring;
                                                        {5466}new UP_4700: bitstring;
                                                        {5467}out(c, (GetEndpointResponse,pkSess_4698,Sign,SP_4699,UP_4700))
                                                )
                                                else
                                                    {5468}let pkSess_4701: bitstring = fail-any in
                                                    {5469}in(c, =GetEndpointRequest);
                                                    {5470}new SP_4702: bitstring;
                                                    {5471}new UP_4703: bitstring;
                                                    {5472}out(c, (GetEndpointResponse,pkSess_4701,Sign,SP_4702,UP_4703))
                                        )
                                        else
                                            {5473}let pkSess_4704: bitstring = fail-any in
                                            {5474}in(c, =GetEndpointRequest);
                                            {5475}new SP_4705: bitstring;
                                            {5476}new UP_4706: bitstring;
                                            {5477}out(c, (GetEndpointResponse,pkSess_4704,Sign,SP_4705,UP_4706))
                                )
                                else
                                    {5478}let pkSess_4707: bitstring = fail-any in
                                    {5479}in(c, =GetEndpointRequest);
                                    {5480}new SP_4708: bitstring;
                                    {5481}new UP_4709: bitstring;
                                    {5482}out(c, (GetEndpointResponse,pkSess_4707,Sign,SP_4708,UP_4709))
                            )
                            else
                                {5483}let v_4710: bool = (Cli_3932 = C) in
                                (
                                    {5484}if v_4710 then
                                    (
                                        {5485}let pkCli_4711: bitstring = pub(skC) in
                                        {5486}let v_4712: bool = (Sess_3934 = A) in
                                        (
                                            {5487}if v_4712 then
                                            (
                                                {5488}let pkSess_4713: bitstring = pub(skA) in
                                                {5489}in(c, =GetEndpointRequest);
                                                {5490}new SP_4714: bitstring;
                                                {5491}new UP_4715: bitstring;
                                                {5492}out(c, (GetEndpointResponse,pkSess_4713,Sign,SP_4714,UP_4715))
                                            )
                                            else
                                                {5493}let v_4716: bool = (Sess_3934 = B) in
                                                (
                                                    {5494}if v_4716 then
                                                    (
                                                        {5495}let pkSess_4717: bitstring = pub(skB) in
                                                        {5496}in(c, =GetEndpointRequest);
                                                        {5497}new SP_4718: bitstring;
                                                        {5498}new UP_4719: bitstring;
                                                        {5499}out(c, (GetEndpointResponse,pkSess_4717,Sign,SP_4718,UP_4719))
                                                    )
                                                    else
                                                        {5500}let v_4720: bool = (Sess_3934 = C) in
                                                        (
                                                            {5501}if v_4720 then
                                                            (
                                                                {5502}let pkSess_4721: bitstring = pub(skC) in
                                                                {5503}in(c, =GetEndpointRequest);
                                                                {5504}new SP_4722: bitstring;
                                                                {5505}new UP_4723: bitstring;
                                                                {5506}out(c, (GetEndpointResponse,pkSess_4721,Sign,SP_4722,UP_4723))
                                                            )
                                                            else
                                                                {5507}let pkSess_4724: bitstring = pub(sk(Sess_3934)) in
                                                                {5508}in(c, =GetEndpointRequest);
                                                                {5509}new SP_4725: bitstring;
                                                                {5510}new UP_4726: bitstring;
                                                                {5511}out(c, (GetEndpointResponse,pkSess_4724,Sign,SP_4725,UP_4726))
                                                        )
                                                        else
                                                            {5512}let pkSess_4727: bitstring = fail-any in
                                                            {5513}in(c, =GetEndpointRequest);
                                                            {5514}new SP_4728: bitstring;
                                                            {5515}new UP_4729: bitstring;
                                                            {5516}out(c, (GetEndpointResponse,pkSess_4727,Sign,SP_4728,UP_4729))
                                                )
                                                else
                                                    {5517}let pkSess_4730: bitstring = fail-any in
                                                    {5518}in(c, =GetEndpointRequest);
                                                    {5519}new SP_4731: bitstring;
                                                    {5520}new UP_4732: bitstring;
                                                    {5521}out(c, (GetEndpointResponse,pkSess_4730,Sign,SP_4731,UP_4732))
                                        )
                                        else
                                            {5522}let pkSess_4733: bitstring = fail-any in
                                            {5523}in(c, =GetEndpointRequest);
                                            {5524}new SP_4734: bitstring;
                                            {5525}new UP_4735: bitstring;
                                            {5526}out(c, (GetEndpointResponse,pkSess_4733,Sign,SP_4734,UP_4735))
                                    )
                                    else
                                        {5527}let pkCli_4736: bitstring = pub(sk(Cli_3932)) in
                                        {5528}let v_4737: bool = (Sess_3934 = A) in
                                        (
                                            {5529}if v_4737 then
                                            (
                                                {5530}let pkSess_4738: bitstring = pub(skA) in
                                                {5531}in(c, =GetEndpointRequest);
                                                {5532}new SP_4739: bitstring;
                                                {5533}new UP_4740: bitstring;
                                                {5534}out(c, (GetEndpointResponse,pkSess_4738,Sign,SP_4739,UP_4740))
                                            )
                                            else
                                                {5535}let v_4741: bool = (Sess_3934 = B) in
                                                (
                                                    {5536}if v_4741 then
                                                    (
                                                        {5537}let pkSess_4742: bitstring = pub(skB) in
                                                        {5538}in(c, =GetEndpointRequest);
                                                        {5539}new SP_4743: bitstring;
                                                        {5540}new UP_4744: bitstring;
                                                        {5541}out(c, (GetEndpointResponse,pkSess_4742,Sign,SP_4743,UP_4744))
                                                    )
                                                    else
                                                        {5542}let v_4745: bool = (Sess_3934 = C) in
                                                        (
                                                            {5543}if v_4745 then
                                                            (
                                                                {5544}let pkSess_4746: bitstring = pub(skC) in
                                                                {5545}in(c, =GetEndpointRequest);
                                                                {5546}new SP_4747: bitstring;
                                                                {5547}new UP_4748: bitstring;
                                                                {5548}out(c, (GetEndpointResponse,pkSess_4746,Sign,SP_4747,UP_4748))
                                                            )
                                                            else
                                                                {5549}let pkSess_4749: bitstring = pub(sk(Sess_3934)) in
                                                                {5550}in(c, =GetEndpointRequest);
                                                                {5551}new SP_4750: bitstring;
                                                                {5552}new UP_4751: bitstring;
                                                                {5553}out(c, (GetEndpointResponse,pkSess_4749,Sign,SP_4750,UP_4751))
                                                        )
                                                        else
                                                            {5554}let pkSess_4752: bitstring = fail-any in
                                                            {5555}in(c, =GetEndpointRequest);
                                                            {5556}new SP_4753: bitstring;
                                                            {5557}new UP_4754: bitstring;
                                                            {5558}out(c, (GetEndpointResponse,pkSess_4752,Sign,SP_4753,UP_4754))
                                                )
                                                else
                                                    {5559}let pkSess_4755: bitstring = fail-any in
                                                    {5560}in(c, =GetEndpointRequest);
                                                    {5561}new SP_4756: bitstring;
                                                    {5562}new UP_4757: bitstring;
                                                    {5563}out(c, (GetEndpointResponse,pkSess_4755,Sign,SP_4756,UP_4757))
                                        )
                                        else
                                            {5564}let pkSess_4758: bitstring = fail-any in
                                            {5565}in(c, =GetEndpointRequest);
                                            {5566}new SP_4759: bitstring;
                                            {5567}new UP_4760: bitstring;
                                            {5568}out(c, (GetEndpointResponse,pkSess_4758,Sign,SP_4759,UP_4760))
                                )
                                else
                                    {5569}let pkCli_4761: bitstring = fail-any in
                                    {5570}let v_4762: bool = (Sess_3934 = A) in
                                    (
                                        {5571}if v_4762 then
                                        (
                                            {5572}let pkSess_4763: bitstring = pub(skA) in
                                            {5573}in(c, =GetEndpointRequest);
                                            {5574}new SP_4764: bitstring;
                                            {5575}new UP_4765: bitstring;
                                            {5576}out(c, (GetEndpointResponse,pkSess_4763,Sign,SP_4764,UP_4765))
                                        )
                                        else
                                            {5577}let v_4766: bool = (Sess_3934 = B) in
                                            (
                                                {5578}if v_4766 then
                                                (
                                                    {5579}let pkSess_4767: bitstring = pub(skB) in
                                                    {5580}in(c, =GetEndpointRequest);
                                                    {5581}new SP_4768: bitstring;
                                                    {5582}new UP_4769: bitstring;
                                                    {5583}out(c, (GetEndpointResponse,pkSess_4767,Sign,SP_4768,UP_4769))
                                                )
                                                else
                                                    {5584}let v_4770: bool = (Sess_3934 = C) in
                                                    (
                                                        {5585}if v_4770 then
                                                        (
                                                            {5586}let pkSess_4771: bitstring = pub(skC) in
                                                            {5587}in(c, =GetEndpointRequest);
                                                            {5588}new SP_4772: bitstring;
                                                            {5589}new UP_4773: bitstring;
                                                            {5590}out(c, (GetEndpointResponse,pkSess_4771,Sign,SP_4772,UP_4773))
                                                        )
                                                        else
                                                            {5591}let pkSess_4774: bitstring = pub(sk(Sess_3934)) in
                                                            {5592}in(c, =GetEndpointRequest);
                                                            {5593}new SP_4775: bitstring;
                                                            {5594}new UP_4776: bitstring;
                                                            {5595}out(c, (GetEndpointResponse,pkSess_4774,Sign,SP_4775,UP_4776))
                                                    )
                                                    else
                                                        {5596}let pkSess_4777: bitstring = fail-any in
                                                        {5597}in(c, =GetEndpointRequest);
                                                        {5598}new SP_4778: bitstring;
                                                        {5599}new UP_4779: bitstring;
                                                        {5600}out(c, (GetEndpointResponse,pkSess_4777,Sign,SP_4778,UP_4779))
                                            )
                                            else
                                                {5601}let pkSess_4780: bitstring = fail-any in
                                                {5602}in(c, =GetEndpointRequest);
                                                {5603}new SP_4781: bitstring;
                                                {5604}new UP_4782: bitstring;
                                                {5605}out(c, (GetEndpointResponse,pkSess_4780,Sign,SP_4781,UP_4782))
                                    )
                                    else
                                        {5606}let pkSess_4783: bitstring = fail-any in
                                        {5607}in(c, =GetEndpointRequest);
                                        {5608}new SP_4784: bitstring;
                                        {5609}new UP_4785: bitstring;
                                        {5610}out(c, (GetEndpointResponse,pkSess_4783,Sign,SP_4784,UP_4785))
                        )
                        else
                            {5611}let pkCli_4786: bitstring = fail-any in
                            {5612}let v_4787: bool = (Sess_3934 = A) in
                            (
                                {5613}if v_4787 then
                                (
                                    {5614}let pkSess_4788: bitstring = pub(skA) in
                                    {5615}in(c, =GetEndpointRequest);
                                    {5616}new SP_4789: bitstring;
                                    {5617}new UP_4790: bitstring;
                                    {5618}out(c, (GetEndpointResponse,pkSess_4788,Sign,SP_4789,UP_4790))
                                )
                                else
                                    {5619}let v_4791: bool = (Sess_3934 = B) in
                                    (
                                        {5620}if v_4791 then
                                        (
                                            {5621}let pkSess_4792: bitstring = pub(skB) in
                                            {5622}in(c, =GetEndpointRequest);
                                            {5623}new SP_4793: bitstring;
                                            {5624}new UP_4794: bitstring;
                                            {5625}out(c, (GetEndpointResponse,pkSess_4792,Sign,SP_4793,UP_4794))
                                        )
                                        else
                                            {5626}let v_4795: bool = (Sess_3934 = C) in
                                            (
                                                {5627}if v_4795 then
                                                (
                                                    {5628}let pkSess_4796: bitstring = pub(skC) in
                                                    {5629}in(c, =GetEndpointRequest);
                                                    {5630}new SP_4797: bitstring;
                                                    {5631}new UP_4798: bitstring;
                                                    {5632}out(c, (GetEndpointResponse,pkSess_4796,Sign,SP_4797,UP_4798))
                                                )
                                                else
                                                    {5633}let pkSess_4799: bitstring = pub(sk(Sess_3934)) in
                                                    {5634}in(c, =GetEndpointRequest);
                                                    {5635}new SP_4800: bitstring;
                                                    {5636}new UP_4801: bitstring;
                                                    {5637}out(c, (GetEndpointResponse,pkSess_4799,Sign,SP_4800,UP_4801))
                                            )
                                            else
                                                {5638}let pkSess_4802: bitstring = fail-any in
                                                {5639}in(c, =GetEndpointRequest);
                                                {5640}new SP_4803: bitstring;
                                                {5641}new UP_4804: bitstring;
                                                {5642}out(c, (GetEndpointResponse,pkSess_4802,Sign,SP_4803,UP_4804))
                                    )
                                    else
                                        {5643}let pkSess_4805: bitstring = fail-any in
                                        {5644}in(c, =GetEndpointRequest);
                                        {5645}new SP_4806: bitstring;
                                        {5646}new UP_4807: bitstring;
                                        {5647}out(c, (GetEndpointResponse,pkSess_4805,Sign,SP_4806,UP_4807))
                            )
                            else
                                {5648}let pkSess_4808: bitstring = fail-any in
                                {5649}in(c, =GetEndpointRequest);
                                {5650}new SP_4809: bitstring;
                                {5651}new UP_4810: bitstring;
                                {5652}out(c, (GetEndpointResponse,pkSess_4808,Sign,SP_4809,UP_4810))
                )
                else
                    {5653}let pkCli_4811: bitstring = fail-any in
                    {5654}let v_4812: bool = (Sess_3934 = A) in
                    (
                        {5655}if v_4812 then
                        (
                            {5656}let pkSess_4813: bitstring = pub(skA) in
                            {5657}in(c, =GetEndpointRequest);
                            {5658}new SP_4814: bitstring;
                            {5659}new UP_4815: bitstring;
                            {5660}out(c, (GetEndpointResponse,pkSess_4813,Sign,SP_4814,UP_4815))
                        )
                        else
                            {5661}let v_4816: bool = (Sess_3934 = B) in
                            (
                                {5662}if v_4816 then
                                (
                                    {5663}let pkSess_4817: bitstring = pub(skB) in
                                    {5664}in(c, =GetEndpointRequest);
                                    {5665}new SP_4818: bitstring;
                                    {5666}new UP_4819: bitstring;
                                    {5667}out(c, (GetEndpointResponse,pkSess_4817,Sign,SP_4818,UP_4819))
                                )
                                else
                                    {5668}let v_4820: bool = (Sess_3934 = C) in
                                    (
                                        {5669}if v_4820 then
                                        (
                                            {5670}let pkSess_4821: bitstring = pub(skC) in
                                            {5671}in(c, =GetEndpointRequest);
                                            {5672}new SP_4822: bitstring;
                                            {5673}new UP_4823: bitstring;
                                            {5674}out(c, (GetEndpointResponse,pkSess_4821,Sign,SP_4822,UP_4823))
                                        )
                                        else
                                            {5675}let pkSess_4824: bitstring = pub(sk(Sess_3934)) in
                                            {5676}in(c, =GetEndpointRequest);
                                            {5677}new SP_4825: bitstring;
                                            {5678}new UP_4826: bitstring;
                                            {5679}out(c, (GetEndpointResponse,pkSess_4824,Sign,SP_4825,UP_4826))
                                    )
                                    else
                                        {5680}let pkSess_4827: bitstring = fail-any in
                                        {5681}in(c, =GetEndpointRequest);
                                        {5682}new SP_4828: bitstring;
                                        {5683}new UP_4829: bitstring;
                                        {5684}out(c, (GetEndpointResponse,pkSess_4827,Sign,SP_4828,UP_4829))
                            )
                            else
                                {5685}let pkSess_4830: bitstring = fail-any in
                                {5686}in(c, =GetEndpointRequest);
                                {5687}new SP_4831: bitstring;
                                {5688}new UP_4832: bitstring;
                                {5689}out(c, (GetEndpointResponse,pkSess_4830,Sign,SP_4831,UP_4832))
                    )
                    else
                        {5690}let pkSess_4833: bitstring = fail-any in
                        {5691}in(c, =GetEndpointRequest);
                        {5692}new SP_4834: bitstring;
                        {5693}new UP_4835: bitstring;
                        {5694}out(c, (GetEndpointResponse,pkSess_4833,Sign,SP_4834,UP_4835))
    )
    else
        {5695}let skDisco_4836: bitstring = fail-any in
        {5696}let pkDisco_4837: bitstring = pub(skDisco_4836) in
        {5697}let v_4838: bool = (Cli_3932 = A) in
        (
            {5698}if v_4838 then
            (
                {5699}let pkCli_4839: bitstring = pub(skA) in
                {5700}let v_4840: bool = (Sess_3934 = A) in
                (
                    {5701}if v_4840 then
                    (
                        {5702}let pkSess_4841: bitstring = pub(skA) in
                        {5703}in(c, =GetEndpointRequest);
                        {5704}new SP_4842: bitstring;
                        {5705}new UP_4843: bitstring;
                        {5706}out(c, (GetEndpointResponse,pkSess_4841,Sign,SP_4842,UP_4843))
                    )
                    else
                        {5707}let v_4844: bool = (Sess_3934 = B) in
                        (
                            {5708}if v_4844 then
                            (
                                {5709}let pkSess_4845: bitstring = pub(skB) in
                                {5710}in(c, =GetEndpointRequest);
                                {5711}new SP_4846: bitstring;
                                {5712}new UP_4847: bitstring;
                                {5713}out(c, (GetEndpointResponse,pkSess_4845,Sign,SP_4846,UP_4847))
                            )
                            else
                                {5714}let v_4848: bool = (Sess_3934 = C) in
                                (
                                    {5715}if v_4848 then
                                    (
                                        {5716}let pkSess_4849: bitstring = pub(skC) in
                                        {5717}in(c, =GetEndpointRequest);
                                        {5718}new SP_4850: bitstring;
                                        {5719}new UP_4851: bitstring;
                                        {5720}out(c, (GetEndpointResponse,pkSess_4849,Sign,SP_4850,UP_4851))
                                    )
                                    else
                                        {5721}let pkSess_4852: bitstring = pub(sk(Sess_3934)) in
                                        {5722}in(c, =GetEndpointRequest);
                                        {5723}new SP_4853: bitstring;
                                        {5724}new UP_4854: bitstring;
                                        {5725}out(c, (GetEndpointResponse,pkSess_4852,Sign,SP_4853,UP_4854))
                                )
                                else
                                    {5726}let pkSess_4855: bitstring = fail-any in
                                    {5727}in(c, =GetEndpointRequest);
                                    {5728}new SP_4856: bitstring;
                                    {5729}new UP_4857: bitstring;
                                    {5730}out(c, (GetEndpointResponse,pkSess_4855,Sign,SP_4856,UP_4857))
                        )
                        else
                            {5731}let pkSess_4858: bitstring = fail-any in
                            {5732}in(c, =GetEndpointRequest);
                            {5733}new SP_4859: bitstring;
                            {5734}new UP_4860: bitstring;
                            {5735}out(c, (GetEndpointResponse,pkSess_4858,Sign,SP_4859,UP_4860))
                )
                else
                    {5736}let pkSess_4861: bitstring = fail-any in
                    {5737}in(c, =GetEndpointRequest);
                    {5738}new SP_4862: bitstring;
                    {5739}new UP_4863: bitstring;
                    {5740}out(c, (GetEndpointResponse,pkSess_4861,Sign,SP_4862,UP_4863))
            )
            else
                {5741}let v_4864: bool = (Cli_3932 = B) in
                (
                    {5742}if v_4864 then
                    (
                        {5743}let pkCli_4865: bitstring = pub(skB) in
                        {5744}let v_4866: bool = (Sess_3934 = A) in
                        (
                            {5745}if v_4866 then
                            (
                                {5746}let pkSess_4867: bitstring = pub(skA) in
                                {5747}in(c, =GetEndpointRequest);
                                {5748}new SP_4868: bitstring;
                                {5749}new UP_4869: bitstring;
                                {5750}out(c, (GetEndpointResponse,pkSess_4867,Sign,SP_4868,UP_4869))
                            )
                            else
                                {5751}let v_4870: bool = (Sess_3934 = B) in
                                (
                                    {5752}if v_4870 then
                                    (
                                        {5753}let pkSess_4871: bitstring = pub(skB) in
                                        {5754}in(c, =GetEndpointRequest);
                                        {5755}new SP_4872: bitstring;
                                        {5756}new UP_4873: bitstring;
                                        {5757}out(c, (GetEndpointResponse,pkSess_4871,Sign,SP_4872,UP_4873))
                                    )
                                    else
                                        {5758}let v_4874: bool = (Sess_3934 = C) in
                                        (
                                            {5759}if v_4874 then
                                            (
                                                {5760}let pkSess_4875: bitstring = pub(skC) in
                                                {5761}in(c, =GetEndpointRequest);
                                                {5762}new SP_4876: bitstring;
                                                {5763}new UP_4877: bitstring;
                                                {5764}out(c, (GetEndpointResponse,pkSess_4875,Sign,SP_4876,UP_4877))
                                            )
                                            else
                                                {5765}let pkSess_4878: bitstring = pub(sk(Sess_3934)) in
                                                {5766}in(c, =GetEndpointRequest);
                                                {5767}new SP_4879: bitstring;
                                                {5768}new UP_4880: bitstring;
                                                {5769}out(c, (GetEndpointResponse,pkSess_4878,Sign,SP_4879,UP_4880))
                                        )
                                        else
                                            {5770}let pkSess_4881: bitstring = fail-any in
                                            {5771}in(c, =GetEndpointRequest);
                                            {5772}new SP_4882: bitstring;
                                            {5773}new UP_4883: bitstring;
                                            {5774}out(c, (GetEndpointResponse,pkSess_4881,Sign,SP_4882,UP_4883))
                                )
                                else
                                    {5775}let pkSess_4884: bitstring = fail-any in
                                    {5776}in(c, =GetEndpointRequest);
                                    {5777}new SP_4885: bitstring;
                                    {5778}new UP_4886: bitstring;
                                    {5779}out(c, (GetEndpointResponse,pkSess_4884,Sign,SP_4885,UP_4886))
                        )
                        else
                            {5780}let pkSess_4887: bitstring = fail-any in
                            {5781}in(c, =GetEndpointRequest);
                            {5782}new SP_4888: bitstring;
                            {5783}new UP_4889: bitstring;
                            {5784}out(c, (GetEndpointResponse,pkSess_4887,Sign,SP_4888,UP_4889))
                    )
                    else
                        {5785}let v_4890: bool = (Cli_3932 = C) in
                        (
                            {5786}if v_4890 then
                            (
                                {5787}let pkCli_4891: bitstring = pub(skC) in
                                {5788}let v_4892: bool = (Sess_3934 = A) in
                                (
                                    {5789}if v_4892 then
                                    (
                                        {5790}let pkSess_4893: bitstring = pub(skA) in
                                        {5791}in(c, =GetEndpointRequest);
                                        {5792}new SP_4894: bitstring;
                                        {5793}new UP_4895: bitstring;
                                        {5794}out(c, (GetEndpointResponse,pkSess_4893,Sign,SP_4894,UP_4895))
                                    )
                                    else
                                        {5795}let v_4896: bool = (Sess_3934 = B) in
                                        (
                                            {5796}if v_4896 then
                                            (
                                                {5797}let pkSess_4897: bitstring = pub(skB) in
                                                {5798}in(c, =GetEndpointRequest);
                                                {5799}new SP_4898: bitstring;
                                                {5800}new UP_4899: bitstring;
                                                {5801}out(c, (GetEndpointResponse,pkSess_4897,Sign,SP_4898,UP_4899))
                                            )
                                            else
                                                {5802}let v_4900: bool = (Sess_3934 = C) in
                                                (
                                                    {5803}if v_4900 then
                                                    (
                                                        {5804}let pkSess_4901: bitstring = pub(skC) in
                                                        {5805}in(c, =GetEndpointRequest);
                                                        {5806}new SP_4902: bitstring;
                                                        {5807}new UP_4903: bitstring;
                                                        {5808}out(c, (GetEndpointResponse,pkSess_4901,Sign,SP_4902,UP_4903))
                                                    )
                                                    else
                                                        {5809}let pkSess_4904: bitstring = pub(sk(Sess_3934)) in
                                                        {5810}in(c, =GetEndpointRequest);
                                                        {5811}new SP_4905: bitstring;
                                                        {5812}new UP_4906: bitstring;
                                                        {5813}out(c, (GetEndpointResponse,pkSess_4904,Sign,SP_4905,UP_4906))
                                                )
                                                else
                                                    {5814}let pkSess_4907: bitstring = fail-any in
                                                    {5815}in(c, =GetEndpointRequest);
                                                    {5816}new SP_4908: bitstring;
                                                    {5817}new UP_4909: bitstring;
                                                    {5818}out(c, (GetEndpointResponse,pkSess_4907,Sign,SP_4908,UP_4909))
                                        )
                                        else
                                            {5819}let pkSess_4910: bitstring = fail-any in
                                            {5820}in(c, =GetEndpointRequest);
                                            {5821}new SP_4911: bitstring;
                                            {5822}new UP_4912: bitstring;
                                            {5823}out(c, (GetEndpointResponse,pkSess_4910,Sign,SP_4911,UP_4912))
                                )
                                else
                                    {5824}let pkSess_4913: bitstring = fail-any in
                                    {5825}in(c, =GetEndpointRequest);
                                    {5826}new SP_4914: bitstring;
                                    {5827}new UP_4915: bitstring;
                                    {5828}out(c, (GetEndpointResponse,pkSess_4913,Sign,SP_4914,UP_4915))
                            )
                            else
                                {5829}let pkCli_4916: bitstring = pub(sk(Cli_3932)) in
                                {5830}let v_4917: bool = (Sess_3934 = A) in
                                (
                                    {5831}if v_4917 then
                                    (
                                        {5832}let pkSess_4918: bitstring = pub(skA) in
                                        {5833}in(c, =GetEndpointRequest);
                                        {5834}new SP_4919: bitstring;
                                        {5835}new UP_4920: bitstring;
                                        {5836}out(c, (GetEndpointResponse,pkSess_4918,Sign,SP_4919,UP_4920))
                                    )
                                    else
                                        {5837}let v_4921: bool = (Sess_3934 = B) in
                                        (
                                            {5838}if v_4921 then
                                            (
                                                {5839}let pkSess_4922: bitstring = pub(skB) in
                                                {5840}in(c, =GetEndpointRequest);
                                                {5841}new SP_4923: bitstring;
                                                {5842}new UP_4924: bitstring;
                                                {5843}out(c, (GetEndpointResponse,pkSess_4922,Sign,SP_4923,UP_4924))
                                            )
                                            else
                                                {5844}let v_4925: bool = (Sess_3934 = C) in
                                                (
                                                    {5845}if v_4925 then
                                                    (
                                                        {5846}let pkSess_4926: bitstring = pub(skC) in
                                                        {5847}in(c, =GetEndpointRequest);
                                                        {5848}new SP_4927: bitstring;
                                                        {5849}new UP_4928: bitstring;
                                                        {5850}out(c, (GetEndpointResponse,pkSess_4926,Sign,SP_4927,UP_4928))
                                                    )
                                                    else
                                                        {5851}let pkSess_4929: bitstring = pub(sk(Sess_3934)) in
                                                        {5852}in(c, =GetEndpointRequest);
                                                        {5853}new SP_4930: bitstring;
                                                        {5854}new UP_4931: bitstring;
                                                        {5855}out(c, (GetEndpointResponse,pkSess_4929,Sign,SP_4930,UP_4931))
                                                )
                                                else
                                                    {5856}let pkSess_4932: bitstring = fail-any in
                                                    {5857}in(c, =GetEndpointRequest);
                                                    {5858}new SP_4933: bitstring;
                                                    {5859}new UP_4934: bitstring;
                                                    {5860}out(c, (GetEndpointResponse,pkSess_4932,Sign,SP_4933,UP_4934))
                                        )
                                        else
                                            {5861}let pkSess_4935: bitstring = fail-any in
                                            {5862}in(c, =GetEndpointRequest);
                                            {5863}new SP_4936: bitstring;
                                            {5864}new UP_4937: bitstring;
                                            {5865}out(c, (GetEndpointResponse,pkSess_4935,Sign,SP_4936,UP_4937))
                                )
                                else
                                    {5866}let pkSess_4938: bitstring = fail-any in
                                    {5867}in(c, =GetEndpointRequest);
                                    {5868}new SP_4939: bitstring;
                                    {5869}new UP_4940: bitstring;
                                    {5870}out(c, (GetEndpointResponse,pkSess_4938,Sign,SP_4939,UP_4940))
                        )
                        else
                            {5871}let pkCli_4941: bitstring = fail-any in
                            {5872}let v_4942: bool = (Sess_3934 = A) in
                            (
                                {5873}if v_4942 then
                                (
                                    {5874}let pkSess_4943: bitstring = pub(skA) in
                                    {5875}in(c, =GetEndpointRequest);
                                    {5876}new SP_4944: bitstring;
                                    {5877}new UP_4945: bitstring;
                                    {5878}out(c, (GetEndpointResponse,pkSess_4943,Sign,SP_4944,UP_4945))
                                )
                                else
                                    {5879}let v_4946: bool = (Sess_3934 = B) in
                                    (
                                        {5880}if v_4946 then
                                        (
                                            {5881}let pkSess_4947: bitstring = pub(skB) in
                                            {5882}in(c, =GetEndpointRequest);
                                            {5883}new SP_4948: bitstring;
                                            {5884}new UP_4949: bitstring;
                                            {5885}out(c, (GetEndpointResponse,pkSess_4947,Sign,SP_4948,UP_4949))
                                        )
                                        else
                                            {5886}let v_4950: bool = (Sess_3934 = C) in
                                            (
                                                {5887}if v_4950 then
                                                (
                                                    {5888}let pkSess_4951: bitstring = pub(skC) in
                                                    {5889}in(c, =GetEndpointRequest);
                                                    {5890}new SP_4952: bitstring;
                                                    {5891}new UP_4953: bitstring;
                                                    {5892}out(c, (GetEndpointResponse,pkSess_4951,Sign,SP_4952,UP_4953))
                                                )
                                                else
                                                    {5893}let pkSess_4954: bitstring = pub(sk(Sess_3934)) in
                                                    {5894}in(c, =GetEndpointRequest);
                                                    {5895}new SP_4955: bitstring;
                                                    {5896}new UP_4956: bitstring;
                                                    {5897}out(c, (GetEndpointResponse,pkSess_4954,Sign,SP_4955,UP_4956))
                                            )
                                            else
                                                {5898}let pkSess_4957: bitstring = fail-any in
                                                {5899}in(c, =GetEndpointRequest);
                                                {5900}new SP_4958: bitstring;
                                                {5901}new UP_4959: bitstring;
                                                {5902}out(c, (GetEndpointResponse,pkSess_4957,Sign,SP_4958,UP_4959))
                                    )
                                    else
                                        {5903}let pkSess_4960: bitstring = fail-any in
                                        {5904}in(c, =GetEndpointRequest);
                                        {5905}new SP_4961: bitstring;
                                        {5906}new UP_4962: bitstring;
                                        {5907}out(c, (GetEndpointResponse,pkSess_4960,Sign,SP_4961,UP_4962))
                            )
                            else
                                {5908}let pkSess_4963: bitstring = fail-any in
                                {5909}in(c, =GetEndpointRequest);
                                {5910}new SP_4964: bitstring;
                                {5911}new UP_4965: bitstring;
                                {5912}out(c, (GetEndpointResponse,pkSess_4963,Sign,SP_4964,UP_4965))
                )
                else
                    {5913}let pkCli_4966: bitstring = fail-any in
                    {5914}let v_4967: bool = (Sess_3934 = A) in
                    (
                        {5915}if v_4967 then
                        (
                            {5916}let pkSess_4968: bitstring = pub(skA) in
                            {5917}in(c, =GetEndpointRequest);
                            {5918}new SP_4969: bitstring;
                            {5919}new UP_4970: bitstring;
                            {5920}out(c, (GetEndpointResponse,pkSess_4968,Sign,SP_4969,UP_4970))
                        )
                        else
                            {5921}let v_4971: bool = (Sess_3934 = B) in
                            (
                                {5922}if v_4971 then
                                (
                                    {5923}let pkSess_4972: bitstring = pub(skB) in
                                    {5924}in(c, =GetEndpointRequest);
                                    {5925}new SP_4973: bitstring;
                                    {5926}new UP_4974: bitstring;
                                    {5927}out(c, (GetEndpointResponse,pkSess_4972,Sign,SP_4973,UP_4974))
                                )
                                else
                                    {5928}let v_4975: bool = (Sess_3934 = C) in
                                    (
                                        {5929}if v_4975 then
                                        (
                                            {5930}let pkSess_4976: bitstring = pub(skC) in
                                            {5931}in(c, =GetEndpointRequest);
                                            {5932}new SP_4977: bitstring;
                                            {5933}new UP_4978: bitstring;
                                            {5934}out(c, (GetEndpointResponse,pkSess_4976,Sign,SP_4977,UP_4978))
                                        )
                                        else
                                            {5935}let pkSess_4979: bitstring = pub(sk(Sess_3934)) in
                                            {5936}in(c, =GetEndpointRequest);
                                            {5937}new SP_4980: bitstring;
                                            {5938}new UP_4981: bitstring;
                                            {5939}out(c, (GetEndpointResponse,pkSess_4979,Sign,SP_4980,UP_4981))
                                    )
                                    else
                                        {5940}let pkSess_4982: bitstring = fail-any in
                                        {5941}in(c, =GetEndpointRequest);
                                        {5942}new SP_4983: bitstring;
                                        {5943}new UP_4984: bitstring;
                                        {5944}out(c, (GetEndpointResponse,pkSess_4982,Sign,SP_4983,UP_4984))
                            )
                            else
                                {5945}let pkSess_4985: bitstring = fail-any in
                                {5946}in(c, =GetEndpointRequest);
                                {5947}new SP_4986: bitstring;
                                {5948}new UP_4987: bitstring;
                                {5949}out(c, (GetEndpointResponse,pkSess_4985,Sign,SP_4986,UP_4987))
                    )
                    else
                        {5950}let pkSess_4988: bitstring = fail-any in
                        {5951}in(c, =GetEndpointRequest);
                        {5952}new SP_4989: bitstring;
                        {5953}new UP_4990: bitstring;
                        {5954}out(c, (GetEndpointResponse,pkSess_4988,Sign,SP_4989,UP_4990))
        )
        else
            {5955}let pkCli_4991: bitstring = fail-any in
            {5956}let v_4992: bool = (Sess_3934 = A) in
            (
                {5957}if v_4992 then
                (
                    {5958}let pkSess_4993: bitstring = pub(skA) in
                    {5959}in(c, =GetEndpointRequest);
                    {5960}new SP_4994: bitstring;
                    {5961}new UP_4995: bitstring;
                    {5962}out(c, (GetEndpointResponse,pkSess_4993,Sign,SP_4994,UP_4995))
                )
                else
                    {5963}let v_4996: bool = (Sess_3934 = B) in
                    (
                        {5964}if v_4996 then
                        (
                            {5965}let pkSess_4997: bitstring = pub(skB) in
                            {5966}in(c, =GetEndpointRequest);
                            {5967}new SP_4998: bitstring;
                            {5968}new UP_4999: bitstring;
                            {5969}out(c, (GetEndpointResponse,pkSess_4997,Sign,SP_4998,UP_4999))
                        )
                        else
                            {5970}let v_5000: bool = (Sess_3934 = C) in
                            (
                                {5971}if v_5000 then
                                (
                                    {5972}let pkSess_5001: bitstring = pub(skC) in
                                    {5973}in(c, =GetEndpointRequest);
                                    {5974}new SP_5002: bitstring;
                                    {5975}new UP_5003: bitstring;
                                    {5976}out(c, (GetEndpointResponse,pkSess_5001,Sign,SP_5002,UP_5003))
                                )
                                else
                                    {5977}let pkSess_5004: bitstring = pub(sk(Sess_3934)) in
                                    {5978}in(c, =GetEndpointRequest);
                                    {5979}new SP_5005: bitstring;
                                    {5980}new UP_5006: bitstring;
                                    {5981}out(c, (GetEndpointResponse,pkSess_5004,Sign,SP_5005,UP_5006))
                            )
                            else
                                {5982}let pkSess_5007: bitstring = fail-any in
                                {5983}in(c, =GetEndpointRequest);
                                {5984}new SP_5008: bitstring;
                                {5985}new UP_5009: bitstring;
                                {5986}out(c, (GetEndpointResponse,pkSess_5007,Sign,SP_5008,UP_5009))
                    )
                    else
                        {5987}let pkSess_5010: bitstring = fail-any in
                        {5988}in(c, =GetEndpointRequest);
                        {5989}new SP_5011: bitstring;
                        {5990}new UP_5012: bitstring;
                        {5991}out(c, (GetEndpointResponse,pkSess_5010,Sign,SP_5011,UP_5012))
            )
            else
                {5992}let pkSess_5013: bitstring = fail-any in
                {5993}in(c, =GetEndpointRequest);
                {5994}new SP_5014: bitstring;
                {5995}new UP_5015: bitstring;
                {5996}out(c, (GetEndpointResponse,pkSess_5013,Sign,SP_5014,UP_5015))
) | (
    {5997}!
    {5998}in(c, (Cli_5016: host,Disco_5017: host,Sess_5018: host));
    {5999}let v_5019: bool = (Sess_5018 = A) in
    (
        {6000}if v_5019 then
        (
            {6001}let skSess: bitstring = skA in
            {6002}let pkSess_5020: bitstring = pub(skSess) in
            {6003}let v_5021: bool = (Cli_5016 = A) in
            (
                {6004}if v_5021 then
                (
                    {6005}let pkCli_5022: bitstring = pub(skA) in
                    {6006}let v_5023: bool = (Disco_5017 = A) in
                    (
                        {6007}if v_5023 then
                        (
                            {6008}let pkDisco_5024: bitstring = pub(skA) in
                            {6009}in(c, (=pkCli_5022,em1: bitstring,sigM1: bitstring));
                            {6010}let m1_5025: bitstring = em1 in
                            {6011}if (verify(h(m1_5025),sigM1,pkCli_5022) <> true) then
                                0
                            else
                                {6012}let (=OpenSecureChannelRequest,=pkCli_5022,Nc_5026: bitstring) = m1_5025 in
                                {6013}new Ns_5027: bitstring;
                                {6014}new ST_5028: bitstring;
                                {6015}new TTL_5029: bitstring;
                                {6016}let m2_5030: bitstring = (OpenSecureChannelResponse,Ns_5027,ST_5028,TTL_5029) in
                                {6017}event beginSrv(Sess_5018,Cli_5016,Ns_5027);
                                {6018}out(c, (m2_5030,sign(h(m2_5030),skSess)));
                                {6019}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {6020}event endSrv(Cli_5016,Sess_5018,Nc_5026)
                        )
                        else
                            {6021}let v_5031: bool = (Disco_5017 = B) in
                            (
                                {6022}if v_5031 then
                                (
                                    {6023}let pkDisco_5032: bitstring = pub(skB) in
                                    {6024}in(c, (=pkCli_5022,em1_5033: bitstring,sigM1_5034: bitstring));
                                    {6025}let m1_5035: bitstring = em1_5033 in
                                    {6026}if (verify(h(m1_5035),sigM1_5034,pkCli_5022) <> true) then
                                        0
                                    else
                                        {6027}let (=OpenSecureChannelRequest,=pkCli_5022,Nc_5036: bitstring) = m1_5035 in
                                        {6028}new Ns_5037: bitstring;
                                        {6029}new ST_5038: bitstring;
                                        {6030}new TTL_5039: bitstring;
                                        {6031}let m2_5040: bitstring = (OpenSecureChannelResponse,Ns_5037,ST_5038,TTL_5039) in
                                        {6032}event beginSrv(Sess_5018,Cli_5016,Ns_5037);
                                        {6033}out(c, (m2_5040,sign(h(m2_5040),skSess)));
                                        {6034}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {6035}event endSrv(Cli_5016,Sess_5018,Nc_5036)
                                )
                                else
                                    {6036}let v_5041: bool = (Disco_5017 = C) in
                                    (
                                        {6037}if v_5041 then
                                        (
                                            {6038}let pkDisco_5042: bitstring = pub(skC) in
                                            {6039}in(c, (=pkCli_5022,em1_5043: bitstring,sigM1_5044: bitstring));
                                            {6040}let m1_5045: bitstring = em1_5043 in
                                            {6041}if (verify(h(m1_5045),sigM1_5044,pkCli_5022) <> true) then
                                                0
                                            else
                                                {6042}let (=OpenSecureChannelRequest,=pkCli_5022,Nc_5046: bitstring) = m1_5045 in
                                                {6043}new Ns_5047: bitstring;
                                                {6044}new ST_5048: bitstring;
                                                {6045}new TTL_5049: bitstring;
                                                {6046}let m2_5050: bitstring = (OpenSecureChannelResponse,Ns_5047,ST_5048,TTL_5049) in
                                                {6047}event beginSrv(Sess_5018,Cli_5016,Ns_5047);
                                                {6048}out(c, (m2_5050,sign(h(m2_5050),skSess)));
                                                {6049}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6050}event endSrv(Cli_5016,Sess_5018,Nc_5046)
                                        )
                                        else
                                            {6051}let pkDisco_5051: bitstring = pub(sk(Disco_5017)) in
                                            {6052}in(c, (=pkCli_5022,em1_5052: bitstring,sigM1_5053: bitstring));
                                            {6053}let m1_5054: bitstring = em1_5052 in
                                            {6054}if (verify(h(m1_5054),sigM1_5053,pkCli_5022) <> true) then
                                                0
                                            else
                                                {6055}let (=OpenSecureChannelRequest,=pkCli_5022,Nc_5055: bitstring) = m1_5054 in
                                                {6056}new Ns_5056: bitstring;
                                                {6057}new ST_5057: bitstring;
                                                {6058}new TTL_5058: bitstring;
                                                {6059}let m2_5059: bitstring = (OpenSecureChannelResponse,Ns_5056,ST_5057,TTL_5058) in
                                                {6060}event beginSrv(Sess_5018,Cli_5016,Ns_5056);
                                                {6061}out(c, (m2_5059,sign(h(m2_5059),skSess)));
                                                {6062}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6063}event endSrv(Cli_5016,Sess_5018,Nc_5055)
                                    )
                                    else
                                        {6064}let pkDisco_5060: bitstring = fail-any in
                                        {6065}in(c, (=pkCli_5022,em1_5061: bitstring,sigM1_5062: bitstring));
                                        {6066}let m1_5063: bitstring = em1_5061 in
                                        {6067}if (verify(h(m1_5063),sigM1_5062,pkCli_5022) <> true) then
                                            0
                                        else
                                            {6068}let (=OpenSecureChannelRequest,=pkCli_5022,Nc_5064: bitstring) = m1_5063 in
                                            {6069}new Ns_5065: bitstring;
                                            {6070}new ST_5066: bitstring;
                                            {6071}new TTL_5067: bitstring;
                                            {6072}let m2_5068: bitstring = (OpenSecureChannelResponse,Ns_5065,ST_5066,TTL_5067) in
                                            {6073}event beginSrv(Sess_5018,Cli_5016,Ns_5065);
                                            {6074}out(c, (m2_5068,sign(h(m2_5068),skSess)));
                                            {6075}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6076}event endSrv(Cli_5016,Sess_5018,Nc_5064)
                            )
                            else
                                {6077}let pkDisco_5069: bitstring = fail-any in
                                {6078}in(c, (=pkCli_5022,em1_5070: bitstring,sigM1_5071: bitstring));
                                {6079}let m1_5072: bitstring = em1_5070 in
                                {6080}if (verify(h(m1_5072),sigM1_5071,pkCli_5022) <> true) then
                                    0
                                else
                                    {6081}let (=OpenSecureChannelRequest,=pkCli_5022,Nc_5073: bitstring) = m1_5072 in
                                    {6082}new Ns_5074: bitstring;
                                    {6083}new ST_5075: bitstring;
                                    {6084}new TTL_5076: bitstring;
                                    {6085}let m2_5077: bitstring = (OpenSecureChannelResponse,Ns_5074,ST_5075,TTL_5076) in
                                    {6086}event beginSrv(Sess_5018,Cli_5016,Ns_5074);
                                    {6087}out(c, (m2_5077,sign(h(m2_5077),skSess)));
                                    {6088}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {6089}event endSrv(Cli_5016,Sess_5018,Nc_5073)
                    )
                    else
                        {6090}let pkDisco_5078: bitstring = fail-any in
                        {6091}in(c, (=pkCli_5022,em1_5079: bitstring,sigM1_5080: bitstring));
                        {6092}let m1_5081: bitstring = em1_5079 in
                        {6093}if (verify(h(m1_5081),sigM1_5080,pkCli_5022) <> true) then
                            0
                        else
                            {6094}let (=OpenSecureChannelRequest,=pkCli_5022,Nc_5082: bitstring) = m1_5081 in
                            {6095}new Ns_5083: bitstring;
                            {6096}new ST_5084: bitstring;
                            {6097}new TTL_5085: bitstring;
                            {6098}let m2_5086: bitstring = (OpenSecureChannelResponse,Ns_5083,ST_5084,TTL_5085) in
                            {6099}event beginSrv(Sess_5018,Cli_5016,Ns_5083);
                            {6100}out(c, (m2_5086,sign(h(m2_5086),skSess)));
                            {6101}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                            {6102}event endSrv(Cli_5016,Sess_5018,Nc_5082)
                )
                else
                    {6103}let v_5087: bool = (Cli_5016 = B) in
                    (
                        {6104}if v_5087 then
                        (
                            {6105}let pkCli_5088: bitstring = pub(skB) in
                            {6106}let v_5089: bool = (Disco_5017 = A) in
                            (
                                {6107}if v_5089 then
                                (
                                    {6108}let pkDisco_5090: bitstring = pub(skA) in
                                    {6109}in(c, (=pkCli_5088,em1_5091: bitstring,sigM1_5092: bitstring));
                                    {6110}let m1_5093: bitstring = em1_5091 in
                                    {6111}if (verify(h(m1_5093),sigM1_5092,pkCli_5088) <> true) then
                                        0
                                    else
                                        {6112}let (=OpenSecureChannelRequest,=pkCli_5088,Nc_5094: bitstring) = m1_5093 in
                                        {6113}new Ns_5095: bitstring;
                                        {6114}new ST_5096: bitstring;
                                        {6115}new TTL_5097: bitstring;
                                        {6116}let m2_5098: bitstring = (OpenSecureChannelResponse,Ns_5095,ST_5096,TTL_5097) in
                                        {6117}event beginSrv(Sess_5018,Cli_5016,Ns_5095);
                                        {6118}out(c, (m2_5098,sign(h(m2_5098),skSess)));
                                        {6119}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {6120}event endSrv(Cli_5016,Sess_5018,Nc_5094)
                                )
                                else
                                    {6121}let v_5099: bool = (Disco_5017 = B) in
                                    (
                                        {6122}if v_5099 then
                                        (
                                            {6123}let pkDisco_5100: bitstring = pub(skB) in
                                            {6124}in(c, (=pkCli_5088,em1_5101: bitstring,sigM1_5102: bitstring));
                                            {6125}let m1_5103: bitstring = em1_5101 in
                                            {6126}if (verify(h(m1_5103),sigM1_5102,pkCli_5088) <> true) then
                                                0
                                            else
                                                {6127}let (=OpenSecureChannelRequest,=pkCli_5088,Nc_5104: bitstring) = m1_5103 in
                                                {6128}new Ns_5105: bitstring;
                                                {6129}new ST_5106: bitstring;
                                                {6130}new TTL_5107: bitstring;
                                                {6131}let m2_5108: bitstring = (OpenSecureChannelResponse,Ns_5105,ST_5106,TTL_5107) in
                                                {6132}event beginSrv(Sess_5018,Cli_5016,Ns_5105);
                                                {6133}out(c, (m2_5108,sign(h(m2_5108),skSess)));
                                                {6134}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6135}event endSrv(Cli_5016,Sess_5018,Nc_5104)
                                        )
                                        else
                                            {6136}let v_5109: bool = (Disco_5017 = C) in
                                            (
                                                {6137}if v_5109 then
                                                (
                                                    {6138}let pkDisco_5110: bitstring = pub(skC) in
                                                    {6139}in(c, (=pkCli_5088,em1_5111: bitstring,sigM1_5112: bitstring));
                                                    {6140}let m1_5113: bitstring = em1_5111 in
                                                    {6141}if (verify(h(m1_5113),sigM1_5112,pkCli_5088) <> true) then
                                                        0
                                                    else
                                                        {6142}let (=OpenSecureChannelRequest,=pkCli_5088,Nc_5114: bitstring) = m1_5113 in
                                                        {6143}new Ns_5115: bitstring;
                                                        {6144}new ST_5116: bitstring;
                                                        {6145}new TTL_5117: bitstring;
                                                        {6146}let m2_5118: bitstring = (OpenSecureChannelResponse,Ns_5115,ST_5116,TTL_5117) in
                                                        {6147}event beginSrv(Sess_5018,Cli_5016,Ns_5115);
                                                        {6148}out(c, (m2_5118,sign(h(m2_5118),skSess)));
                                                        {6149}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6150}event endSrv(Cli_5016,Sess_5018,Nc_5114)
                                                )
                                                else
                                                    {6151}let pkDisco_5119: bitstring = pub(sk(Disco_5017)) in
                                                    {6152}in(c, (=pkCli_5088,em1_5120: bitstring,sigM1_5121: bitstring));
                                                    {6153}let m1_5122: bitstring = em1_5120 in
                                                    {6154}if (verify(h(m1_5122),sigM1_5121,pkCli_5088) <> true) then
                                                        0
                                                    else
                                                        {6155}let (=OpenSecureChannelRequest,=pkCli_5088,Nc_5123: bitstring) = m1_5122 in
                                                        {6156}new Ns_5124: bitstring;
                                                        {6157}new ST_5125: bitstring;
                                                        {6158}new TTL_5126: bitstring;
                                                        {6159}let m2_5127: bitstring = (OpenSecureChannelResponse,Ns_5124,ST_5125,TTL_5126) in
                                                        {6160}event beginSrv(Sess_5018,Cli_5016,Ns_5124);
                                                        {6161}out(c, (m2_5127,sign(h(m2_5127),skSess)));
                                                        {6162}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6163}event endSrv(Cli_5016,Sess_5018,Nc_5123)
                                            )
                                            else
                                                {6164}let pkDisco_5128: bitstring = fail-any in
                                                {6165}in(c, (=pkCli_5088,em1_5129: bitstring,sigM1_5130: bitstring));
                                                {6166}let m1_5131: bitstring = em1_5129 in
                                                {6167}if (verify(h(m1_5131),sigM1_5130,pkCli_5088) <> true) then
                                                    0
                                                else
                                                    {6168}let (=OpenSecureChannelRequest,=pkCli_5088,Nc_5132: bitstring) = m1_5131 in
                                                    {6169}new Ns_5133: bitstring;
                                                    {6170}new ST_5134: bitstring;
                                                    {6171}new TTL_5135: bitstring;
                                                    {6172}let m2_5136: bitstring = (OpenSecureChannelResponse,Ns_5133,ST_5134,TTL_5135) in
                                                    {6173}event beginSrv(Sess_5018,Cli_5016,Ns_5133);
                                                    {6174}out(c, (m2_5136,sign(h(m2_5136),skSess)));
                                                    {6175}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6176}event endSrv(Cli_5016,Sess_5018,Nc_5132)
                                    )
                                    else
                                        {6177}let pkDisco_5137: bitstring = fail-any in
                                        {6178}in(c, (=pkCli_5088,em1_5138: bitstring,sigM1_5139: bitstring));
                                        {6179}let m1_5140: bitstring = em1_5138 in
                                        {6180}if (verify(h(m1_5140),sigM1_5139,pkCli_5088) <> true) then
                                            0
                                        else
                                            {6181}let (=OpenSecureChannelRequest,=pkCli_5088,Nc_5141: bitstring) = m1_5140 in
                                            {6182}new Ns_5142: bitstring;
                                            {6183}new ST_5143: bitstring;
                                            {6184}new TTL_5144: bitstring;
                                            {6185}let m2_5145: bitstring = (OpenSecureChannelResponse,Ns_5142,ST_5143,TTL_5144) in
                                            {6186}event beginSrv(Sess_5018,Cli_5016,Ns_5142);
                                            {6187}out(c, (m2_5145,sign(h(m2_5145),skSess)));
                                            {6188}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6189}event endSrv(Cli_5016,Sess_5018,Nc_5141)
                            )
                            else
                                {6190}let pkDisco_5146: bitstring = fail-any in
                                {6191}in(c, (=pkCli_5088,em1_5147: bitstring,sigM1_5148: bitstring));
                                {6192}let m1_5149: bitstring = em1_5147 in
                                {6193}if (verify(h(m1_5149),sigM1_5148,pkCli_5088) <> true) then
                                    0
                                else
                                    {6194}let (=OpenSecureChannelRequest,=pkCli_5088,Nc_5150: bitstring) = m1_5149 in
                                    {6195}new Ns_5151: bitstring;
                                    {6196}new ST_5152: bitstring;
                                    {6197}new TTL_5153: bitstring;
                                    {6198}let m2_5154: bitstring = (OpenSecureChannelResponse,Ns_5151,ST_5152,TTL_5153) in
                                    {6199}event beginSrv(Sess_5018,Cli_5016,Ns_5151);
                                    {6200}out(c, (m2_5154,sign(h(m2_5154),skSess)));
                                    {6201}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {6202}event endSrv(Cli_5016,Sess_5018,Nc_5150)
                        )
                        else
                            {6203}let v_5155: bool = (Cli_5016 = C) in
                            (
                                {6204}if v_5155 then
                                (
                                    {6205}let pkCli_5156: bitstring = pub(skC) in
                                    {6206}let v_5157: bool = (Disco_5017 = A) in
                                    (
                                        {6207}if v_5157 then
                                        (
                                            {6208}let pkDisco_5158: bitstring = pub(skA) in
                                            {6209}in(c, (=pkCli_5156,em1_5159: bitstring,sigM1_5160: bitstring));
                                            {6210}let m1_5161: bitstring = em1_5159 in
                                            {6211}if (verify(h(m1_5161),sigM1_5160,pkCli_5156) <> true) then
                                                0
                                            else
                                                {6212}let (=OpenSecureChannelRequest,=pkCli_5156,Nc_5162: bitstring) = m1_5161 in
                                                {6213}new Ns_5163: bitstring;
                                                {6214}new ST_5164: bitstring;
                                                {6215}new TTL_5165: bitstring;
                                                {6216}let m2_5166: bitstring = (OpenSecureChannelResponse,Ns_5163,ST_5164,TTL_5165) in
                                                {6217}event beginSrv(Sess_5018,Cli_5016,Ns_5163);
                                                {6218}out(c, (m2_5166,sign(h(m2_5166),skSess)));
                                                {6219}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6220}event endSrv(Cli_5016,Sess_5018,Nc_5162)
                                        )
                                        else
                                            {6221}let v_5167: bool = (Disco_5017 = B) in
                                            (
                                                {6222}if v_5167 then
                                                (
                                                    {6223}let pkDisco_5168: bitstring = pub(skB) in
                                                    {6224}in(c, (=pkCli_5156,em1_5169: bitstring,sigM1_5170: bitstring));
                                                    {6225}let m1_5171: bitstring = em1_5169 in
                                                    {6226}if (verify(h(m1_5171),sigM1_5170,pkCli_5156) <> true) then
                                                        0
                                                    else
                                                        {6227}let (=OpenSecureChannelRequest,=pkCli_5156,Nc_5172: bitstring) = m1_5171 in
                                                        {6228}new Ns_5173: bitstring;
                                                        {6229}new ST_5174: bitstring;
                                                        {6230}new TTL_5175: bitstring;
                                                        {6231}let m2_5176: bitstring = (OpenSecureChannelResponse,Ns_5173,ST_5174,TTL_5175) in
                                                        {6232}event beginSrv(Sess_5018,Cli_5016,Ns_5173);
                                                        {6233}out(c, (m2_5176,sign(h(m2_5176),skSess)));
                                                        {6234}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6235}event endSrv(Cli_5016,Sess_5018,Nc_5172)
                                                )
                                                else
                                                    {6236}let v_5177: bool = (Disco_5017 = C) in
                                                    (
                                                        {6237}if v_5177 then
                                                        (
                                                            {6238}let pkDisco_5178: bitstring = pub(skC) in
                                                            {6239}in(c, (=pkCli_5156,em1_5179: bitstring,sigM1_5180: bitstring));
                                                            {6240}let m1_5181: bitstring = em1_5179 in
                                                            {6241}if (verify(h(m1_5181),sigM1_5180,pkCli_5156) <> true) then
                                                                0
                                                            else
                                                                {6242}let (=OpenSecureChannelRequest,=pkCli_5156,Nc_5182: bitstring) = m1_5181 in
                                                                {6243}new Ns_5183: bitstring;
                                                                {6244}new ST_5184: bitstring;
                                                                {6245}new TTL_5185: bitstring;
                                                                {6246}let m2_5186: bitstring = (OpenSecureChannelResponse,Ns_5183,ST_5184,TTL_5185) in
                                                                {6247}event beginSrv(Sess_5018,Cli_5016,Ns_5183);
                                                                {6248}out(c, (m2_5186,sign(h(m2_5186),skSess)));
                                                                {6249}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {6250}event endSrv(Cli_5016,Sess_5018,Nc_5182)
                                                        )
                                                        else
                                                            {6251}let pkDisco_5187: bitstring = pub(sk(Disco_5017)) in
                                                            {6252}in(c, (=pkCli_5156,em1_5188: bitstring,sigM1_5189: bitstring));
                                                            {6253}let m1_5190: bitstring = em1_5188 in
                                                            {6254}if (verify(h(m1_5190),sigM1_5189,pkCli_5156) <> true) then
                                                                0
                                                            else
                                                                {6255}let (=OpenSecureChannelRequest,=pkCli_5156,Nc_5191: bitstring) = m1_5190 in
                                                                {6256}new Ns_5192: bitstring;
                                                                {6257}new ST_5193: bitstring;
                                                                {6258}new TTL_5194: bitstring;
                                                                {6259}let m2_5195: bitstring = (OpenSecureChannelResponse,Ns_5192,ST_5193,TTL_5194) in
                                                                {6260}event beginSrv(Sess_5018,Cli_5016,Ns_5192);
                                                                {6261}out(c, (m2_5195,sign(h(m2_5195),skSess)));
                                                                {6262}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {6263}event endSrv(Cli_5016,Sess_5018,Nc_5191)
                                                    )
                                                    else
                                                        {6264}let pkDisco_5196: bitstring = fail-any in
                                                        {6265}in(c, (=pkCli_5156,em1_5197: bitstring,sigM1_5198: bitstring));
                                                        {6266}let m1_5199: bitstring = em1_5197 in
                                                        {6267}if (verify(h(m1_5199),sigM1_5198,pkCli_5156) <> true) then
                                                            0
                                                        else
                                                            {6268}let (=OpenSecureChannelRequest,=pkCli_5156,Nc_5200: bitstring) = m1_5199 in
                                                            {6269}new Ns_5201: bitstring;
                                                            {6270}new ST_5202: bitstring;
                                                            {6271}new TTL_5203: bitstring;
                                                            {6272}let m2_5204: bitstring = (OpenSecureChannelResponse,Ns_5201,ST_5202,TTL_5203) in
                                                            {6273}event beginSrv(Sess_5018,Cli_5016,Ns_5201);
                                                            {6274}out(c, (m2_5204,sign(h(m2_5204),skSess)));
                                                            {6275}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {6276}event endSrv(Cli_5016,Sess_5018,Nc_5200)
                                            )
                                            else
                                                {6277}let pkDisco_5205: bitstring = fail-any in
                                                {6278}in(c, (=pkCli_5156,em1_5206: bitstring,sigM1_5207: bitstring));
                                                {6279}let m1_5208: bitstring = em1_5206 in
                                                {6280}if (verify(h(m1_5208),sigM1_5207,pkCli_5156) <> true) then
                                                    0
                                                else
                                                    {6281}let (=OpenSecureChannelRequest,=pkCli_5156,Nc_5209: bitstring) = m1_5208 in
                                                    {6282}new Ns_5210: bitstring;
                                                    {6283}new ST_5211: bitstring;
                                                    {6284}new TTL_5212: bitstring;
                                                    {6285}let m2_5213: bitstring = (OpenSecureChannelResponse,Ns_5210,ST_5211,TTL_5212) in
                                                    {6286}event beginSrv(Sess_5018,Cli_5016,Ns_5210);
                                                    {6287}out(c, (m2_5213,sign(h(m2_5213),skSess)));
                                                    {6288}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6289}event endSrv(Cli_5016,Sess_5018,Nc_5209)
                                    )
                                    else
                                        {6290}let pkDisco_5214: bitstring = fail-any in
                                        {6291}in(c, (=pkCli_5156,em1_5215: bitstring,sigM1_5216: bitstring));
                                        {6292}let m1_5217: bitstring = em1_5215 in
                                        {6293}if (verify(h(m1_5217),sigM1_5216,pkCli_5156) <> true) then
                                            0
                                        else
                                            {6294}let (=OpenSecureChannelRequest,=pkCli_5156,Nc_5218: bitstring) = m1_5217 in
                                            {6295}new Ns_5219: bitstring;
                                            {6296}new ST_5220: bitstring;
                                            {6297}new TTL_5221: bitstring;
                                            {6298}let m2_5222: bitstring = (OpenSecureChannelResponse,Ns_5219,ST_5220,TTL_5221) in
                                            {6299}event beginSrv(Sess_5018,Cli_5016,Ns_5219);
                                            {6300}out(c, (m2_5222,sign(h(m2_5222),skSess)));
                                            {6301}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6302}event endSrv(Cli_5016,Sess_5018,Nc_5218)
                                )
                                else
                                    {6303}let pkCli_5223: bitstring = pub(sk(Cli_5016)) in
                                    {6304}let v_5224: bool = (Disco_5017 = A) in
                                    (
                                        {6305}if v_5224 then
                                        (
                                            {6306}let pkDisco_5225: bitstring = pub(skA) in
                                            {6307}in(c, (=pkCli_5223,em1_5226: bitstring,sigM1_5227: bitstring));
                                            {6308}let m1_5228: bitstring = em1_5226 in
                                            {6309}if (verify(h(m1_5228),sigM1_5227,pkCli_5223) <> true) then
                                                0
                                            else
                                                {6310}let (=OpenSecureChannelRequest,=pkCli_5223,Nc_5229: bitstring) = m1_5228 in
                                                {6311}new Ns_5230: bitstring;
                                                {6312}new ST_5231: bitstring;
                                                {6313}new TTL_5232: bitstring;
                                                {6314}let m2_5233: bitstring = (OpenSecureChannelResponse,Ns_5230,ST_5231,TTL_5232) in
                                                {6315}event beginSrv(Sess_5018,Cli_5016,Ns_5230);
                                                {6316}out(c, (m2_5233,sign(h(m2_5233),skSess)));
                                                {6317}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6318}event endSrv(Cli_5016,Sess_5018,Nc_5229)
                                        )
                                        else
                                            {6319}let v_5234: bool = (Disco_5017 = B) in
                                            (
                                                {6320}if v_5234 then
                                                (
                                                    {6321}let pkDisco_5235: bitstring = pub(skB) in
                                                    {6322}in(c, (=pkCli_5223,em1_5236: bitstring,sigM1_5237: bitstring));
                                                    {6323}let m1_5238: bitstring = em1_5236 in
                                                    {6324}if (verify(h(m1_5238),sigM1_5237,pkCli_5223) <> true) then
                                                        0
                                                    else
                                                        {6325}let (=OpenSecureChannelRequest,=pkCli_5223,Nc_5239: bitstring) = m1_5238 in
                                                        {6326}new Ns_5240: bitstring;
                                                        {6327}new ST_5241: bitstring;
                                                        {6328}new TTL_5242: bitstring;
                                                        {6329}let m2_5243: bitstring = (OpenSecureChannelResponse,Ns_5240,ST_5241,TTL_5242) in
                                                        {6330}event beginSrv(Sess_5018,Cli_5016,Ns_5240);
                                                        {6331}out(c, (m2_5243,sign(h(m2_5243),skSess)));
                                                        {6332}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6333}event endSrv(Cli_5016,Sess_5018,Nc_5239)
                                                )
                                                else
                                                    {6334}let v_5244: bool = (Disco_5017 = C) in
                                                    (
                                                        {6335}if v_5244 then
                                                        (
                                                            {6336}let pkDisco_5245: bitstring = pub(skC) in
                                                            {6337}in(c, (=pkCli_5223,em1_5246: bitstring,sigM1_5247: bitstring));
                                                            {6338}let m1_5248: bitstring = em1_5246 in
                                                            {6339}if (verify(h(m1_5248),sigM1_5247,pkCli_5223) <> true) then
                                                                0
                                                            else
                                                                {6340}let (=OpenSecureChannelRequest,=pkCli_5223,Nc_5249: bitstring) = m1_5248 in
                                                                {6341}new Ns_5250: bitstring;
                                                                {6342}new ST_5251: bitstring;
                                                                {6343}new TTL_5252: bitstring;
                                                                {6344}let m2_5253: bitstring = (OpenSecureChannelResponse,Ns_5250,ST_5251,TTL_5252) in
                                                                {6345}event beginSrv(Sess_5018,Cli_5016,Ns_5250);
                                                                {6346}out(c, (m2_5253,sign(h(m2_5253),skSess)));
                                                                {6347}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {6348}event endSrv(Cli_5016,Sess_5018,Nc_5249)
                                                        )
                                                        else
                                                            {6349}let pkDisco_5254: bitstring = pub(sk(Disco_5017)) in
                                                            {6350}in(c, (=pkCli_5223,em1_5255: bitstring,sigM1_5256: bitstring));
                                                            {6351}let m1_5257: bitstring = em1_5255 in
                                                            {6352}if (verify(h(m1_5257),sigM1_5256,pkCli_5223) <> true) then
                                                                0
                                                            else
                                                                {6353}let (=OpenSecureChannelRequest,=pkCli_5223,Nc_5258: bitstring) = m1_5257 in
                                                                {6354}new Ns_5259: bitstring;
                                                                {6355}new ST_5260: bitstring;
                                                                {6356}new TTL_5261: bitstring;
                                                                {6357}let m2_5262: bitstring = (OpenSecureChannelResponse,Ns_5259,ST_5260,TTL_5261) in
                                                                {6358}event beginSrv(Sess_5018,Cli_5016,Ns_5259);
                                                                {6359}out(c, (m2_5262,sign(h(m2_5262),skSess)));
                                                                {6360}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {6361}event endSrv(Cli_5016,Sess_5018,Nc_5258)
                                                    )
                                                    else
                                                        {6362}let pkDisco_5263: bitstring = fail-any in
                                                        {6363}in(c, (=pkCli_5223,em1_5264: bitstring,sigM1_5265: bitstring));
                                                        {6364}let m1_5266: bitstring = em1_5264 in
                                                        {6365}if (verify(h(m1_5266),sigM1_5265,pkCli_5223) <> true) then
                                                            0
                                                        else
                                                            {6366}let (=OpenSecureChannelRequest,=pkCli_5223,Nc_5267: bitstring) = m1_5266 in
                                                            {6367}new Ns_5268: bitstring;
                                                            {6368}new ST_5269: bitstring;
                                                            {6369}new TTL_5270: bitstring;
                                                            {6370}let m2_5271: bitstring = (OpenSecureChannelResponse,Ns_5268,ST_5269,TTL_5270) in
                                                            {6371}event beginSrv(Sess_5018,Cli_5016,Ns_5268);
                                                            {6372}out(c, (m2_5271,sign(h(m2_5271),skSess)));
                                                            {6373}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {6374}event endSrv(Cli_5016,Sess_5018,Nc_5267)
                                            )
                                            else
                                                {6375}let pkDisco_5272: bitstring = fail-any in
                                                {6376}in(c, (=pkCli_5223,em1_5273: bitstring,sigM1_5274: bitstring));
                                                {6377}let m1_5275: bitstring = em1_5273 in
                                                {6378}if (verify(h(m1_5275),sigM1_5274,pkCli_5223) <> true) then
                                                    0
                                                else
                                                    {6379}let (=OpenSecureChannelRequest,=pkCli_5223,Nc_5276: bitstring) = m1_5275 in
                                                    {6380}new Ns_5277: bitstring;
                                                    {6381}new ST_5278: bitstring;
                                                    {6382}new TTL_5279: bitstring;
                                                    {6383}let m2_5280: bitstring = (OpenSecureChannelResponse,Ns_5277,ST_5278,TTL_5279) in
                                                    {6384}event beginSrv(Sess_5018,Cli_5016,Ns_5277);
                                                    {6385}out(c, (m2_5280,sign(h(m2_5280),skSess)));
                                                    {6386}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6387}event endSrv(Cli_5016,Sess_5018,Nc_5276)
                                    )
                                    else
                                        {6388}let pkDisco_5281: bitstring = fail-any in
                                        {6389}in(c, (=pkCli_5223,em1_5282: bitstring,sigM1_5283: bitstring));
                                        {6390}let m1_5284: bitstring = em1_5282 in
                                        {6391}if (verify(h(m1_5284),sigM1_5283,pkCli_5223) <> true) then
                                            0
                                        else
                                            {6392}let (=OpenSecureChannelRequest,=pkCli_5223,Nc_5285: bitstring) = m1_5284 in
                                            {6393}new Ns_5286: bitstring;
                                            {6394}new ST_5287: bitstring;
                                            {6395}new TTL_5288: bitstring;
                                            {6396}let m2_5289: bitstring = (OpenSecureChannelResponse,Ns_5286,ST_5287,TTL_5288) in
                                            {6397}event beginSrv(Sess_5018,Cli_5016,Ns_5286);
                                            {6398}out(c, (m2_5289,sign(h(m2_5289),skSess)));
                                            {6399}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6400}event endSrv(Cli_5016,Sess_5018,Nc_5285)
                            )
                            else
                                {6401}let pkCli_5290: bitstring = fail-any in
                                {6402}let v_5291: bool = (Disco_5017 = A) in
                                (
                                    {6403}if v_5291 then
                                    (
                                        {6404}let pkDisco_5292: bitstring = pub(skA) in
                                        {6405}in(c, (=pkCli_5290,em1_5293: bitstring,sigM1_5294: bitstring));
                                        {6406}let m1_5295: bitstring = em1_5293 in
                                        {6407}if (verify(h(m1_5295),sigM1_5294,pkCli_5290) <> true) then
                                            0
                                        else
                                            {6408}let (=OpenSecureChannelRequest,=pkCli_5290,Nc_5296: bitstring) = m1_5295 in
                                            {6409}new Ns_5297: bitstring;
                                            {6410}new ST_5298: bitstring;
                                            {6411}new TTL_5299: bitstring;
                                            {6412}let m2_5300: bitstring = (OpenSecureChannelResponse,Ns_5297,ST_5298,TTL_5299) in
                                            {6413}event beginSrv(Sess_5018,Cli_5016,Ns_5297);
                                            {6414}out(c, (m2_5300,sign(h(m2_5300),skSess)));
                                            {6415}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6416}event endSrv(Cli_5016,Sess_5018,Nc_5296)
                                    )
                                    else
                                        {6417}let v_5301: bool = (Disco_5017 = B) in
                                        (
                                            {6418}if v_5301 then
                                            (
                                                {6419}let pkDisco_5302: bitstring = pub(skB) in
                                                {6420}in(c, (=pkCli_5290,em1_5303: bitstring,sigM1_5304: bitstring));
                                                {6421}let m1_5305: bitstring = em1_5303 in
                                                {6422}if (verify(h(m1_5305),sigM1_5304,pkCli_5290) <> true) then
                                                    0
                                                else
                                                    {6423}let (=OpenSecureChannelRequest,=pkCli_5290,Nc_5306: bitstring) = m1_5305 in
                                                    {6424}new Ns_5307: bitstring;
                                                    {6425}new ST_5308: bitstring;
                                                    {6426}new TTL_5309: bitstring;
                                                    {6427}let m2_5310: bitstring = (OpenSecureChannelResponse,Ns_5307,ST_5308,TTL_5309) in
                                                    {6428}event beginSrv(Sess_5018,Cli_5016,Ns_5307);
                                                    {6429}out(c, (m2_5310,sign(h(m2_5310),skSess)));
                                                    {6430}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6431}event endSrv(Cli_5016,Sess_5018,Nc_5306)
                                            )
                                            else
                                                {6432}let v_5311: bool = (Disco_5017 = C) in
                                                (
                                                    {6433}if v_5311 then
                                                    (
                                                        {6434}let pkDisco_5312: bitstring = pub(skC) in
                                                        {6435}in(c, (=pkCli_5290,em1_5313: bitstring,sigM1_5314: bitstring));
                                                        {6436}let m1_5315: bitstring = em1_5313 in
                                                        {6437}if (verify(h(m1_5315),sigM1_5314,pkCli_5290) <> true) then
                                                            0
                                                        else
                                                            {6438}let (=OpenSecureChannelRequest,=pkCli_5290,Nc_5316: bitstring) = m1_5315 in
                                                            {6439}new Ns_5317: bitstring;
                                                            {6440}new ST_5318: bitstring;
                                                            {6441}new TTL_5319: bitstring;
                                                            {6442}let m2_5320: bitstring = (OpenSecureChannelResponse,Ns_5317,ST_5318,TTL_5319) in
                                                            {6443}event beginSrv(Sess_5018,Cli_5016,Ns_5317);
                                                            {6444}out(c, (m2_5320,sign(h(m2_5320),skSess)));
                                                            {6445}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {6446}event endSrv(Cli_5016,Sess_5018,Nc_5316)
                                                    )
                                                    else
                                                        {6447}let pkDisco_5321: bitstring = pub(sk(Disco_5017)) in
                                                        {6448}in(c, (=pkCli_5290,em1_5322: bitstring,sigM1_5323: bitstring));
                                                        {6449}let m1_5324: bitstring = em1_5322 in
                                                        {6450}if (verify(h(m1_5324),sigM1_5323,pkCli_5290) <> true) then
                                                            0
                                                        else
                                                            {6451}let (=OpenSecureChannelRequest,=pkCli_5290,Nc_5325: bitstring) = m1_5324 in
                                                            {6452}new Ns_5326: bitstring;
                                                            {6453}new ST_5327: bitstring;
                                                            {6454}new TTL_5328: bitstring;
                                                            {6455}let m2_5329: bitstring = (OpenSecureChannelResponse,Ns_5326,ST_5327,TTL_5328) in
                                                            {6456}event beginSrv(Sess_5018,Cli_5016,Ns_5326);
                                                            {6457}out(c, (m2_5329,sign(h(m2_5329),skSess)));
                                                            {6458}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {6459}event endSrv(Cli_5016,Sess_5018,Nc_5325)
                                                )
                                                else
                                                    {6460}let pkDisco_5330: bitstring = fail-any in
                                                    {6461}in(c, (=pkCli_5290,em1_5331: bitstring,sigM1_5332: bitstring));
                                                    {6462}let m1_5333: bitstring = em1_5331 in
                                                    {6463}if (verify(h(m1_5333),sigM1_5332,pkCli_5290) <> true) then
                                                        0
                                                    else
                                                        {6464}let (=OpenSecureChannelRequest,=pkCli_5290,Nc_5334: bitstring) = m1_5333 in
                                                        {6465}new Ns_5335: bitstring;
                                                        {6466}new ST_5336: bitstring;
                                                        {6467}new TTL_5337: bitstring;
                                                        {6468}let m2_5338: bitstring = (OpenSecureChannelResponse,Ns_5335,ST_5336,TTL_5337) in
                                                        {6469}event beginSrv(Sess_5018,Cli_5016,Ns_5335);
                                                        {6470}out(c, (m2_5338,sign(h(m2_5338),skSess)));
                                                        {6471}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6472}event endSrv(Cli_5016,Sess_5018,Nc_5334)
                                        )
                                        else
                                            {6473}let pkDisco_5339: bitstring = fail-any in
                                            {6474}in(c, (=pkCli_5290,em1_5340: bitstring,sigM1_5341: bitstring));
                                            {6475}let m1_5342: bitstring = em1_5340 in
                                            {6476}if (verify(h(m1_5342),sigM1_5341,pkCli_5290) <> true) then
                                                0
                                            else
                                                {6477}let (=OpenSecureChannelRequest,=pkCli_5290,Nc_5343: bitstring) = m1_5342 in
                                                {6478}new Ns_5344: bitstring;
                                                {6479}new ST_5345: bitstring;
                                                {6480}new TTL_5346: bitstring;
                                                {6481}let m2_5347: bitstring = (OpenSecureChannelResponse,Ns_5344,ST_5345,TTL_5346) in
                                                {6482}event beginSrv(Sess_5018,Cli_5016,Ns_5344);
                                                {6483}out(c, (m2_5347,sign(h(m2_5347),skSess)));
                                                {6484}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6485}event endSrv(Cli_5016,Sess_5018,Nc_5343)
                                )
                                else
                                    {6486}let pkDisco_5348: bitstring = fail-any in
                                    {6487}in(c, (=pkCli_5290,em1_5349: bitstring,sigM1_5350: bitstring));
                                    {6488}let m1_5351: bitstring = em1_5349 in
                                    {6489}if (verify(h(m1_5351),sigM1_5350,pkCli_5290) <> true) then
                                        0
                                    else
                                        {6490}let (=OpenSecureChannelRequest,=pkCli_5290,Nc_5352: bitstring) = m1_5351 in
                                        {6491}new Ns_5353: bitstring;
                                        {6492}new ST_5354: bitstring;
                                        {6493}new TTL_5355: bitstring;
                                        {6494}let m2_5356: bitstring = (OpenSecureChannelResponse,Ns_5353,ST_5354,TTL_5355) in
                                        {6495}event beginSrv(Sess_5018,Cli_5016,Ns_5353);
                                        {6496}out(c, (m2_5356,sign(h(m2_5356),skSess)));
                                        {6497}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {6498}event endSrv(Cli_5016,Sess_5018,Nc_5352)
                    )
                    else
                        {6499}let pkCli_5357: bitstring = fail-any in
                        {6500}let v_5358: bool = (Disco_5017 = A) in
                        (
                            {6501}if v_5358 then
                            (
                                {6502}let pkDisco_5359: bitstring = pub(skA) in
                                {6503}in(c, (=pkCli_5357,em1_5360: bitstring,sigM1_5361: bitstring));
                                {6504}let m1_5362: bitstring = em1_5360 in
                                {6505}if (verify(h(m1_5362),sigM1_5361,pkCli_5357) <> true) then
                                    0
                                else
                                    {6506}let (=OpenSecureChannelRequest,=pkCli_5357,Nc_5363: bitstring) = m1_5362 in
                                    {6507}new Ns_5364: bitstring;
                                    {6508}new ST_5365: bitstring;
                                    {6509}new TTL_5366: bitstring;
                                    {6510}let m2_5367: bitstring = (OpenSecureChannelResponse,Ns_5364,ST_5365,TTL_5366) in
                                    {6511}event beginSrv(Sess_5018,Cli_5016,Ns_5364);
                                    {6512}out(c, (m2_5367,sign(h(m2_5367),skSess)));
                                    {6513}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {6514}event endSrv(Cli_5016,Sess_5018,Nc_5363)
                            )
                            else
                                {6515}let v_5368: bool = (Disco_5017 = B) in
                                (
                                    {6516}if v_5368 then
                                    (
                                        {6517}let pkDisco_5369: bitstring = pub(skB) in
                                        {6518}in(c, (=pkCli_5357,em1_5370: bitstring,sigM1_5371: bitstring));
                                        {6519}let m1_5372: bitstring = em1_5370 in
                                        {6520}if (verify(h(m1_5372),sigM1_5371,pkCli_5357) <> true) then
                                            0
                                        else
                                            {6521}let (=OpenSecureChannelRequest,=pkCli_5357,Nc_5373: bitstring) = m1_5372 in
                                            {6522}new Ns_5374: bitstring;
                                            {6523}new ST_5375: bitstring;
                                            {6524}new TTL_5376: bitstring;
                                            {6525}let m2_5377: bitstring = (OpenSecureChannelResponse,Ns_5374,ST_5375,TTL_5376) in
                                            {6526}event beginSrv(Sess_5018,Cli_5016,Ns_5374);
                                            {6527}out(c, (m2_5377,sign(h(m2_5377),skSess)));
                                            {6528}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6529}event endSrv(Cli_5016,Sess_5018,Nc_5373)
                                    )
                                    else
                                        {6530}let v_5378: bool = (Disco_5017 = C) in
                                        (
                                            {6531}if v_5378 then
                                            (
                                                {6532}let pkDisco_5379: bitstring = pub(skC) in
                                                {6533}in(c, (=pkCli_5357,em1_5380: bitstring,sigM1_5381: bitstring));
                                                {6534}let m1_5382: bitstring = em1_5380 in
                                                {6535}if (verify(h(m1_5382),sigM1_5381,pkCli_5357) <> true) then
                                                    0
                                                else
                                                    {6536}let (=OpenSecureChannelRequest,=pkCli_5357,Nc_5383: bitstring) = m1_5382 in
                                                    {6537}new Ns_5384: bitstring;
                                                    {6538}new ST_5385: bitstring;
                                                    {6539}new TTL_5386: bitstring;
                                                    {6540}let m2_5387: bitstring = (OpenSecureChannelResponse,Ns_5384,ST_5385,TTL_5386) in
                                                    {6541}event beginSrv(Sess_5018,Cli_5016,Ns_5384);
                                                    {6542}out(c, (m2_5387,sign(h(m2_5387),skSess)));
                                                    {6543}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6544}event endSrv(Cli_5016,Sess_5018,Nc_5383)
                                            )
                                            else
                                                {6545}let pkDisco_5388: bitstring = pub(sk(Disco_5017)) in
                                                {6546}in(c, (=pkCli_5357,em1_5389: bitstring,sigM1_5390: bitstring));
                                                {6547}let m1_5391: bitstring = em1_5389 in
                                                {6548}if (verify(h(m1_5391),sigM1_5390,pkCli_5357) <> true) then
                                                    0
                                                else
                                                    {6549}let (=OpenSecureChannelRequest,=pkCli_5357,Nc_5392: bitstring) = m1_5391 in
                                                    {6550}new Ns_5393: bitstring;
                                                    {6551}new ST_5394: bitstring;
                                                    {6552}new TTL_5395: bitstring;
                                                    {6553}let m2_5396: bitstring = (OpenSecureChannelResponse,Ns_5393,ST_5394,TTL_5395) in
                                                    {6554}event beginSrv(Sess_5018,Cli_5016,Ns_5393);
                                                    {6555}out(c, (m2_5396,sign(h(m2_5396),skSess)));
                                                    {6556}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6557}event endSrv(Cli_5016,Sess_5018,Nc_5392)
                                        )
                                        else
                                            {6558}let pkDisco_5397: bitstring = fail-any in
                                            {6559}in(c, (=pkCli_5357,em1_5398: bitstring,sigM1_5399: bitstring));
                                            {6560}let m1_5400: bitstring = em1_5398 in
                                            {6561}if (verify(h(m1_5400),sigM1_5399,pkCli_5357) <> true) then
                                                0
                                            else
                                                {6562}let (=OpenSecureChannelRequest,=pkCli_5357,Nc_5401: bitstring) = m1_5400 in
                                                {6563}new Ns_5402: bitstring;
                                                {6564}new ST_5403: bitstring;
                                                {6565}new TTL_5404: bitstring;
                                                {6566}let m2_5405: bitstring = (OpenSecureChannelResponse,Ns_5402,ST_5403,TTL_5404) in
                                                {6567}event beginSrv(Sess_5018,Cli_5016,Ns_5402);
                                                {6568}out(c, (m2_5405,sign(h(m2_5405),skSess)));
                                                {6569}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6570}event endSrv(Cli_5016,Sess_5018,Nc_5401)
                                )
                                else
                                    {6571}let pkDisco_5406: bitstring = fail-any in
                                    {6572}in(c, (=pkCli_5357,em1_5407: bitstring,sigM1_5408: bitstring));
                                    {6573}let m1_5409: bitstring = em1_5407 in
                                    {6574}if (verify(h(m1_5409),sigM1_5408,pkCli_5357) <> true) then
                                        0
                                    else
                                        {6575}let (=OpenSecureChannelRequest,=pkCli_5357,Nc_5410: bitstring) = m1_5409 in
                                        {6576}new Ns_5411: bitstring;
                                        {6577}new ST_5412: bitstring;
                                        {6578}new TTL_5413: bitstring;
                                        {6579}let m2_5414: bitstring = (OpenSecureChannelResponse,Ns_5411,ST_5412,TTL_5413) in
                                        {6580}event beginSrv(Sess_5018,Cli_5016,Ns_5411);
                                        {6581}out(c, (m2_5414,sign(h(m2_5414),skSess)));
                                        {6582}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {6583}event endSrv(Cli_5016,Sess_5018,Nc_5410)
                        )
                        else
                            {6584}let pkDisco_5415: bitstring = fail-any in
                            {6585}in(c, (=pkCli_5357,em1_5416: bitstring,sigM1_5417: bitstring));
                            {6586}let m1_5418: bitstring = em1_5416 in
                            {6587}if (verify(h(m1_5418),sigM1_5417,pkCli_5357) <> true) then
                                0
                            else
                                {6588}let (=OpenSecureChannelRequest,=pkCli_5357,Nc_5419: bitstring) = m1_5418 in
                                {6589}new Ns_5420: bitstring;
                                {6590}new ST_5421: bitstring;
                                {6591}new TTL_5422: bitstring;
                                {6592}let m2_5423: bitstring = (OpenSecureChannelResponse,Ns_5420,ST_5421,TTL_5422) in
                                {6593}event beginSrv(Sess_5018,Cli_5016,Ns_5420);
                                {6594}out(c, (m2_5423,sign(h(m2_5423),skSess)));
                                {6595}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {6596}event endSrv(Cli_5016,Sess_5018,Nc_5419)
            )
            else
                {6597}let pkCli_5424: bitstring = fail-any in
                {6598}let v_5425: bool = (Disco_5017 = A) in
                (
                    {6599}if v_5425 then
                    (
                        {6600}let pkDisco_5426: bitstring = pub(skA) in
                        {6601}in(c, (=pkCli_5424,em1_5427: bitstring,sigM1_5428: bitstring));
                        {6602}let m1_5429: bitstring = em1_5427 in
                        {6603}if (verify(h(m1_5429),sigM1_5428,pkCli_5424) <> true) then
                            0
                        else
                            {6604}let (=OpenSecureChannelRequest,=pkCli_5424,Nc_5430: bitstring) = m1_5429 in
                            {6605}new Ns_5431: bitstring;
                            {6606}new ST_5432: bitstring;
                            {6607}new TTL_5433: bitstring;
                            {6608}let m2_5434: bitstring = (OpenSecureChannelResponse,Ns_5431,ST_5432,TTL_5433) in
                            {6609}event beginSrv(Sess_5018,Cli_5016,Ns_5431);
                            {6610}out(c, (m2_5434,sign(h(m2_5434),skSess)));
                            {6611}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                            {6612}event endSrv(Cli_5016,Sess_5018,Nc_5430)
                    )
                    else
                        {6613}let v_5435: bool = (Disco_5017 = B) in
                        (
                            {6614}if v_5435 then
                            (
                                {6615}let pkDisco_5436: bitstring = pub(skB) in
                                {6616}in(c, (=pkCli_5424,em1_5437: bitstring,sigM1_5438: bitstring));
                                {6617}let m1_5439: bitstring = em1_5437 in
                                {6618}if (verify(h(m1_5439),sigM1_5438,pkCli_5424) <> true) then
                                    0
                                else
                                    {6619}let (=OpenSecureChannelRequest,=pkCli_5424,Nc_5440: bitstring) = m1_5439 in
                                    {6620}new Ns_5441: bitstring;
                                    {6621}new ST_5442: bitstring;
                                    {6622}new TTL_5443: bitstring;
                                    {6623}let m2_5444: bitstring = (OpenSecureChannelResponse,Ns_5441,ST_5442,TTL_5443) in
                                    {6624}event beginSrv(Sess_5018,Cli_5016,Ns_5441);
                                    {6625}out(c, (m2_5444,sign(h(m2_5444),skSess)));
                                    {6626}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {6627}event endSrv(Cli_5016,Sess_5018,Nc_5440)
                            )
                            else
                                {6628}let v_5445: bool = (Disco_5017 = C) in
                                (
                                    {6629}if v_5445 then
                                    (
                                        {6630}let pkDisco_5446: bitstring = pub(skC) in
                                        {6631}in(c, (=pkCli_5424,em1_5447: bitstring,sigM1_5448: bitstring));
                                        {6632}let m1_5449: bitstring = em1_5447 in
                                        {6633}if (verify(h(m1_5449),sigM1_5448,pkCli_5424) <> true) then
                                            0
                                        else
                                            {6634}let (=OpenSecureChannelRequest,=pkCli_5424,Nc_5450: bitstring) = m1_5449 in
                                            {6635}new Ns_5451: bitstring;
                                            {6636}new ST_5452: bitstring;
                                            {6637}new TTL_5453: bitstring;
                                            {6638}let m2_5454: bitstring = (OpenSecureChannelResponse,Ns_5451,ST_5452,TTL_5453) in
                                            {6639}event beginSrv(Sess_5018,Cli_5016,Ns_5451);
                                            {6640}out(c, (m2_5454,sign(h(m2_5454),skSess)));
                                            {6641}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6642}event endSrv(Cli_5016,Sess_5018,Nc_5450)
                                    )
                                    else
                                        {6643}let pkDisco_5455: bitstring = pub(sk(Disco_5017)) in
                                        {6644}in(c, (=pkCli_5424,em1_5456: bitstring,sigM1_5457: bitstring));
                                        {6645}let m1_5458: bitstring = em1_5456 in
                                        {6646}if (verify(h(m1_5458),sigM1_5457,pkCli_5424) <> true) then
                                            0
                                        else
                                            {6647}let (=OpenSecureChannelRequest,=pkCli_5424,Nc_5459: bitstring) = m1_5458 in
                                            {6648}new Ns_5460: bitstring;
                                            {6649}new ST_5461: bitstring;
                                            {6650}new TTL_5462: bitstring;
                                            {6651}let m2_5463: bitstring = (OpenSecureChannelResponse,Ns_5460,ST_5461,TTL_5462) in
                                            {6652}event beginSrv(Sess_5018,Cli_5016,Ns_5460);
                                            {6653}out(c, (m2_5463,sign(h(m2_5463),skSess)));
                                            {6654}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6655}event endSrv(Cli_5016,Sess_5018,Nc_5459)
                                )
                                else
                                    {6656}let pkDisco_5464: bitstring = fail-any in
                                    {6657}in(c, (=pkCli_5424,em1_5465: bitstring,sigM1_5466: bitstring));
                                    {6658}let m1_5467: bitstring = em1_5465 in
                                    {6659}if (verify(h(m1_5467),sigM1_5466,pkCli_5424) <> true) then
                                        0
                                    else
                                        {6660}let (=OpenSecureChannelRequest,=pkCli_5424,Nc_5468: bitstring) = m1_5467 in
                                        {6661}new Ns_5469: bitstring;
                                        {6662}new ST_5470: bitstring;
                                        {6663}new TTL_5471: bitstring;
                                        {6664}let m2_5472: bitstring = (OpenSecureChannelResponse,Ns_5469,ST_5470,TTL_5471) in
                                        {6665}event beginSrv(Sess_5018,Cli_5016,Ns_5469);
                                        {6666}out(c, (m2_5472,sign(h(m2_5472),skSess)));
                                        {6667}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {6668}event endSrv(Cli_5016,Sess_5018,Nc_5468)
                        )
                        else
                            {6669}let pkDisco_5473: bitstring = fail-any in
                            {6670}in(c, (=pkCli_5424,em1_5474: bitstring,sigM1_5475: bitstring));
                            {6671}let m1_5476: bitstring = em1_5474 in
                            {6672}if (verify(h(m1_5476),sigM1_5475,pkCli_5424) <> true) then
                                0
                            else
                                {6673}let (=OpenSecureChannelRequest,=pkCli_5424,Nc_5477: bitstring) = m1_5476 in
                                {6674}new Ns_5478: bitstring;
                                {6675}new ST_5479: bitstring;
                                {6676}new TTL_5480: bitstring;
                                {6677}let m2_5481: bitstring = (OpenSecureChannelResponse,Ns_5478,ST_5479,TTL_5480) in
                                {6678}event beginSrv(Sess_5018,Cli_5016,Ns_5478);
                                {6679}out(c, (m2_5481,sign(h(m2_5481),skSess)));
                                {6680}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {6681}event endSrv(Cli_5016,Sess_5018,Nc_5477)
                )
                else
                    {6682}let pkDisco_5482: bitstring = fail-any in
                    {6683}in(c, (=pkCli_5424,em1_5483: bitstring,sigM1_5484: bitstring));
                    {6684}let m1_5485: bitstring = em1_5483 in
                    {6685}if (verify(h(m1_5485),sigM1_5484,pkCli_5424) <> true) then
                        0
                    else
                        {6686}let (=OpenSecureChannelRequest,=pkCli_5424,Nc_5486: bitstring) = m1_5485 in
                        {6687}new Ns_5487: bitstring;
                        {6688}new ST_5488: bitstring;
                        {6689}new TTL_5489: bitstring;
                        {6690}let m2_5490: bitstring = (OpenSecureChannelResponse,Ns_5487,ST_5488,TTL_5489) in
                        {6691}event beginSrv(Sess_5018,Cli_5016,Ns_5487);
                        {6692}out(c, (m2_5490,sign(h(m2_5490),skSess)));
                        {6693}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                        {6694}event endSrv(Cli_5016,Sess_5018,Nc_5486)
        )
        else
            {6695}let v_5491: bool = (Sess_5018 = B) in
            (
                {6696}if v_5491 then
                (
                    {6697}let skSess_5492: bitstring = skB in
                    {6698}let pkSess_5493: bitstring = pub(skSess_5492) in
                    {6699}let v_5494: bool = (Cli_5016 = A) in
                    (
                        {6700}if v_5494 then
                        (
                            {6701}let pkCli_5495: bitstring = pub(skA) in
                            {6702}let v_5496: bool = (Disco_5017 = A) in
                            (
                                {6703}if v_5496 then
                                (
                                    {6704}let pkDisco_5497: bitstring = pub(skA) in
                                    {6705}in(c, (=pkCli_5495,em1_5498: bitstring,sigM1_5499: bitstring));
                                    {6706}let m1_5500: bitstring = em1_5498 in
                                    {6707}if (verify(h(m1_5500),sigM1_5499,pkCli_5495) <> true) then
                                        0
                                    else
                                        {6708}let (=OpenSecureChannelRequest,=pkCli_5495,Nc_5501: bitstring) = m1_5500 in
                                        {6709}new Ns_5502: bitstring;
                                        {6710}new ST_5503: bitstring;
                                        {6711}new TTL_5504: bitstring;
                                        {6712}let m2_5505: bitstring = (OpenSecureChannelResponse,Ns_5502,ST_5503,TTL_5504) in
                                        {6713}event beginSrv(Sess_5018,Cli_5016,Ns_5502);
                                        {6714}out(c, (m2_5505,sign(h(m2_5505),skSess_5492)));
                                        {6715}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {6716}event endSrv(Cli_5016,Sess_5018,Nc_5501)
                                )
                                else
                                    {6717}let v_5506: bool = (Disco_5017 = B) in
                                    (
                                        {6718}if v_5506 then
                                        (
                                            {6719}let pkDisco_5507: bitstring = pub(skB) in
                                            {6720}in(c, (=pkCli_5495,em1_5508: bitstring,sigM1_5509: bitstring));
                                            {6721}let m1_5510: bitstring = em1_5508 in
                                            {6722}if (verify(h(m1_5510),sigM1_5509,pkCli_5495) <> true) then
                                                0
                                            else
                                                {6723}let (=OpenSecureChannelRequest,=pkCli_5495,Nc_5511: bitstring) = m1_5510 in
                                                {6724}new Ns_5512: bitstring;
                                                {6725}new ST_5513: bitstring;
                                                {6726}new TTL_5514: bitstring;
                                                {6727}let m2_5515: bitstring = (OpenSecureChannelResponse,Ns_5512,ST_5513,TTL_5514) in
                                                {6728}event beginSrv(Sess_5018,Cli_5016,Ns_5512);
                                                {6729}out(c, (m2_5515,sign(h(m2_5515),skSess_5492)));
                                                {6730}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6731}event endSrv(Cli_5016,Sess_5018,Nc_5511)
                                        )
                                        else
                                            {6732}let v_5516: bool = (Disco_5017 = C) in
                                            (
                                                {6733}if v_5516 then
                                                (
                                                    {6734}let pkDisco_5517: bitstring = pub(skC) in
                                                    {6735}in(c, (=pkCli_5495,em1_5518: bitstring,sigM1_5519: bitstring));
                                                    {6736}let m1_5520: bitstring = em1_5518 in
                                                    {6737}if (verify(h(m1_5520),sigM1_5519,pkCli_5495) <> true) then
                                                        0
                                                    else
                                                        {6738}let (=OpenSecureChannelRequest,=pkCli_5495,Nc_5521: bitstring) = m1_5520 in
                                                        {6739}new Ns_5522: bitstring;
                                                        {6740}new ST_5523: bitstring;
                                                        {6741}new TTL_5524: bitstring;
                                                        {6742}let m2_5525: bitstring = (OpenSecureChannelResponse,Ns_5522,ST_5523,TTL_5524) in
                                                        {6743}event beginSrv(Sess_5018,Cli_5016,Ns_5522);
                                                        {6744}out(c, (m2_5525,sign(h(m2_5525),skSess_5492)));
                                                        {6745}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6746}event endSrv(Cli_5016,Sess_5018,Nc_5521)
                                                )
                                                else
                                                    {6747}let pkDisco_5526: bitstring = pub(sk(Disco_5017)) in
                                                    {6748}in(c, (=pkCli_5495,em1_5527: bitstring,sigM1_5528: bitstring));
                                                    {6749}let m1_5529: bitstring = em1_5527 in
                                                    {6750}if (verify(h(m1_5529),sigM1_5528,pkCli_5495) <> true) then
                                                        0
                                                    else
                                                        {6751}let (=OpenSecureChannelRequest,=pkCli_5495,Nc_5530: bitstring) = m1_5529 in
                                                        {6752}new Ns_5531: bitstring;
                                                        {6753}new ST_5532: bitstring;
                                                        {6754}new TTL_5533: bitstring;
                                                        {6755}let m2_5534: bitstring = (OpenSecureChannelResponse,Ns_5531,ST_5532,TTL_5533) in
                                                        {6756}event beginSrv(Sess_5018,Cli_5016,Ns_5531);
                                                        {6757}out(c, (m2_5534,sign(h(m2_5534),skSess_5492)));
                                                        {6758}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6759}event endSrv(Cli_5016,Sess_5018,Nc_5530)
                                            )
                                            else
                                                {6760}let pkDisco_5535: bitstring = fail-any in
                                                {6761}in(c, (=pkCli_5495,em1_5536: bitstring,sigM1_5537: bitstring));
                                                {6762}let m1_5538: bitstring = em1_5536 in
                                                {6763}if (verify(h(m1_5538),sigM1_5537,pkCli_5495) <> true) then
                                                    0
                                                else
                                                    {6764}let (=OpenSecureChannelRequest,=pkCli_5495,Nc_5539: bitstring) = m1_5538 in
                                                    {6765}new Ns_5540: bitstring;
                                                    {6766}new ST_5541: bitstring;
                                                    {6767}new TTL_5542: bitstring;
                                                    {6768}let m2_5543: bitstring = (OpenSecureChannelResponse,Ns_5540,ST_5541,TTL_5542) in
                                                    {6769}event beginSrv(Sess_5018,Cli_5016,Ns_5540);
                                                    {6770}out(c, (m2_5543,sign(h(m2_5543),skSess_5492)));
                                                    {6771}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6772}event endSrv(Cli_5016,Sess_5018,Nc_5539)
                                    )
                                    else
                                        {6773}let pkDisco_5544: bitstring = fail-any in
                                        {6774}in(c, (=pkCli_5495,em1_5545: bitstring,sigM1_5546: bitstring));
                                        {6775}let m1_5547: bitstring = em1_5545 in
                                        {6776}if (verify(h(m1_5547),sigM1_5546,pkCli_5495) <> true) then
                                            0
                                        else
                                            {6777}let (=OpenSecureChannelRequest,=pkCli_5495,Nc_5548: bitstring) = m1_5547 in
                                            {6778}new Ns_5549: bitstring;
                                            {6779}new ST_5550: bitstring;
                                            {6780}new TTL_5551: bitstring;
                                            {6781}let m2_5552: bitstring = (OpenSecureChannelResponse,Ns_5549,ST_5550,TTL_5551) in
                                            {6782}event beginSrv(Sess_5018,Cli_5016,Ns_5549);
                                            {6783}out(c, (m2_5552,sign(h(m2_5552),skSess_5492)));
                                            {6784}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6785}event endSrv(Cli_5016,Sess_5018,Nc_5548)
                            )
                            else
                                {6786}let pkDisco_5553: bitstring = fail-any in
                                {6787}in(c, (=pkCli_5495,em1_5554: bitstring,sigM1_5555: bitstring));
                                {6788}let m1_5556: bitstring = em1_5554 in
                                {6789}if (verify(h(m1_5556),sigM1_5555,pkCli_5495) <> true) then
                                    0
                                else
                                    {6790}let (=OpenSecureChannelRequest,=pkCli_5495,Nc_5557: bitstring) = m1_5556 in
                                    {6791}new Ns_5558: bitstring;
                                    {6792}new ST_5559: bitstring;
                                    {6793}new TTL_5560: bitstring;
                                    {6794}let m2_5561: bitstring = (OpenSecureChannelResponse,Ns_5558,ST_5559,TTL_5560) in
                                    {6795}event beginSrv(Sess_5018,Cli_5016,Ns_5558);
                                    {6796}out(c, (m2_5561,sign(h(m2_5561),skSess_5492)));
                                    {6797}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {6798}event endSrv(Cli_5016,Sess_5018,Nc_5557)
                        )
                        else
                            {6799}let v_5562: bool = (Cli_5016 = B) in
                            (
                                {6800}if v_5562 then
                                (
                                    {6801}let pkCli_5563: bitstring = pub(skB) in
                                    {6802}let v_5564: bool = (Disco_5017 = A) in
                                    (
                                        {6803}if v_5564 then
                                        (
                                            {6804}let pkDisco_5565: bitstring = pub(skA) in
                                            {6805}in(c, (=pkCli_5563,em1_5566: bitstring,sigM1_5567: bitstring));
                                            {6806}let m1_5568: bitstring = em1_5566 in
                                            {6807}if (verify(h(m1_5568),sigM1_5567,pkCli_5563) <> true) then
                                                0
                                            else
                                                {6808}let (=OpenSecureChannelRequest,=pkCli_5563,Nc_5569: bitstring) = m1_5568 in
                                                {6809}new Ns_5570: bitstring;
                                                {6810}new ST_5571: bitstring;
                                                {6811}new TTL_5572: bitstring;
                                                {6812}let m2_5573: bitstring = (OpenSecureChannelResponse,Ns_5570,ST_5571,TTL_5572) in
                                                {6813}event beginSrv(Sess_5018,Cli_5016,Ns_5570);
                                                {6814}out(c, (m2_5573,sign(h(m2_5573),skSess_5492)));
                                                {6815}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {6816}event endSrv(Cli_5016,Sess_5018,Nc_5569)
                                        )
                                        else
                                            {6817}let v_5574: bool = (Disco_5017 = B) in
                                            (
                                                {6818}if v_5574 then
                                                (
                                                    {6819}let pkDisco_5575: bitstring = pub(skB) in
                                                    {6820}in(c, (=pkCli_5563,em1_5576: bitstring,sigM1_5577: bitstring));
                                                    {6821}let m1_5578: bitstring = em1_5576 in
                                                    {6822}if (verify(h(m1_5578),sigM1_5577,pkCli_5563) <> true) then
                                                        0
                                                    else
                                                        {6823}let (=OpenSecureChannelRequest,=pkCli_5563,Nc_5579: bitstring) = m1_5578 in
                                                        {6824}new Ns_5580: bitstring;
                                                        {6825}new ST_5581: bitstring;
                                                        {6826}new TTL_5582: bitstring;
                                                        {6827}let m2_5583: bitstring = (OpenSecureChannelResponse,Ns_5580,ST_5581,TTL_5582) in
                                                        {6828}event beginSrv(Sess_5018,Cli_5016,Ns_5580);
                                                        {6829}out(c, (m2_5583,sign(h(m2_5583),skSess_5492)));
                                                        {6830}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6831}event endSrv(Cli_5016,Sess_5018,Nc_5579)
                                                )
                                                else
                                                    {6832}let v_5584: bool = (Disco_5017 = C) in
                                                    (
                                                        {6833}if v_5584 then
                                                        (
                                                            {6834}let pkDisco_5585: bitstring = pub(skC) in
                                                            {6835}in(c, (=pkCli_5563,em1_5586: bitstring,sigM1_5587: bitstring));
                                                            {6836}let m1_5588: bitstring = em1_5586 in
                                                            {6837}if (verify(h(m1_5588),sigM1_5587,pkCli_5563) <> true) then
                                                                0
                                                            else
                                                                {6838}let (=OpenSecureChannelRequest,=pkCli_5563,Nc_5589: bitstring) = m1_5588 in
                                                                {6839}new Ns_5590: bitstring;
                                                                {6840}new ST_5591: bitstring;
                                                                {6841}new TTL_5592: bitstring;
                                                                {6842}let m2_5593: bitstring = (OpenSecureChannelResponse,Ns_5590,ST_5591,TTL_5592) in
                                                                {6843}event beginSrv(Sess_5018,Cli_5016,Ns_5590);
                                                                {6844}out(c, (m2_5593,sign(h(m2_5593),skSess_5492)));
                                                                {6845}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {6846}event endSrv(Cli_5016,Sess_5018,Nc_5589)
                                                        )
                                                        else
                                                            {6847}let pkDisco_5594: bitstring = pub(sk(Disco_5017)) in
                                                            {6848}in(c, (=pkCli_5563,em1_5595: bitstring,sigM1_5596: bitstring));
                                                            {6849}let m1_5597: bitstring = em1_5595 in
                                                            {6850}if (verify(h(m1_5597),sigM1_5596,pkCli_5563) <> true) then
                                                                0
                                                            else
                                                                {6851}let (=OpenSecureChannelRequest,=pkCli_5563,Nc_5598: bitstring) = m1_5597 in
                                                                {6852}new Ns_5599: bitstring;
                                                                {6853}new ST_5600: bitstring;
                                                                {6854}new TTL_5601: bitstring;
                                                                {6855}let m2_5602: bitstring = (OpenSecureChannelResponse,Ns_5599,ST_5600,TTL_5601) in
                                                                {6856}event beginSrv(Sess_5018,Cli_5016,Ns_5599);
                                                                {6857}out(c, (m2_5602,sign(h(m2_5602),skSess_5492)));
                                                                {6858}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {6859}event endSrv(Cli_5016,Sess_5018,Nc_5598)
                                                    )
                                                    else
                                                        {6860}let pkDisco_5603: bitstring = fail-any in
                                                        {6861}in(c, (=pkCli_5563,em1_5604: bitstring,sigM1_5605: bitstring));
                                                        {6862}let m1_5606: bitstring = em1_5604 in
                                                        {6863}if (verify(h(m1_5606),sigM1_5605,pkCli_5563) <> true) then
                                                            0
                                                        else
                                                            {6864}let (=OpenSecureChannelRequest,=pkCli_5563,Nc_5607: bitstring) = m1_5606 in
                                                            {6865}new Ns_5608: bitstring;
                                                            {6866}new ST_5609: bitstring;
                                                            {6867}new TTL_5610: bitstring;
                                                            {6868}let m2_5611: bitstring = (OpenSecureChannelResponse,Ns_5608,ST_5609,TTL_5610) in
                                                            {6869}event beginSrv(Sess_5018,Cli_5016,Ns_5608);
                                                            {6870}out(c, (m2_5611,sign(h(m2_5611),skSess_5492)));
                                                            {6871}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {6872}event endSrv(Cli_5016,Sess_5018,Nc_5607)
                                            )
                                            else
                                                {6873}let pkDisco_5612: bitstring = fail-any in
                                                {6874}in(c, (=pkCli_5563,em1_5613: bitstring,sigM1_5614: bitstring));
                                                {6875}let m1_5615: bitstring = em1_5613 in
                                                {6876}if (verify(h(m1_5615),sigM1_5614,pkCli_5563) <> true) then
                                                    0
                                                else
                                                    {6877}let (=OpenSecureChannelRequest,=pkCli_5563,Nc_5616: bitstring) = m1_5615 in
                                                    {6878}new Ns_5617: bitstring;
                                                    {6879}new ST_5618: bitstring;
                                                    {6880}new TTL_5619: bitstring;
                                                    {6881}let m2_5620: bitstring = (OpenSecureChannelResponse,Ns_5617,ST_5618,TTL_5619) in
                                                    {6882}event beginSrv(Sess_5018,Cli_5016,Ns_5617);
                                                    {6883}out(c, (m2_5620,sign(h(m2_5620),skSess_5492)));
                                                    {6884}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6885}event endSrv(Cli_5016,Sess_5018,Nc_5616)
                                    )
                                    else
                                        {6886}let pkDisco_5621: bitstring = fail-any in
                                        {6887}in(c, (=pkCli_5563,em1_5622: bitstring,sigM1_5623: bitstring));
                                        {6888}let m1_5624: bitstring = em1_5622 in
                                        {6889}if (verify(h(m1_5624),sigM1_5623,pkCli_5563) <> true) then
                                            0
                                        else
                                            {6890}let (=OpenSecureChannelRequest,=pkCli_5563,Nc_5625: bitstring) = m1_5624 in
                                            {6891}new Ns_5626: bitstring;
                                            {6892}new ST_5627: bitstring;
                                            {6893}new TTL_5628: bitstring;
                                            {6894}let m2_5629: bitstring = (OpenSecureChannelResponse,Ns_5626,ST_5627,TTL_5628) in
                                            {6895}event beginSrv(Sess_5018,Cli_5016,Ns_5626);
                                            {6896}out(c, (m2_5629,sign(h(m2_5629),skSess_5492)));
                                            {6897}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {6898}event endSrv(Cli_5016,Sess_5018,Nc_5625)
                                )
                                else
                                    {6899}let v_5630: bool = (Cli_5016 = C) in
                                    (
                                        {6900}if v_5630 then
                                        (
                                            {6901}let pkCli_5631: bitstring = pub(skC) in
                                            {6902}let v_5632: bool = (Disco_5017 = A) in
                                            (
                                                {6903}if v_5632 then
                                                (
                                                    {6904}let pkDisco_5633: bitstring = pub(skA) in
                                                    {6905}in(c, (=pkCli_5631,em1_5634: bitstring,sigM1_5635: bitstring));
                                                    {6906}let m1_5636: bitstring = em1_5634 in
                                                    {6907}if (verify(h(m1_5636),sigM1_5635,pkCli_5631) <> true) then
                                                        0
                                                    else
                                                        {6908}let (=OpenSecureChannelRequest,=pkCli_5631,Nc_5637: bitstring) = m1_5636 in
                                                        {6909}new Ns_5638: bitstring;
                                                        {6910}new ST_5639: bitstring;
                                                        {6911}new TTL_5640: bitstring;
                                                        {6912}let m2_5641: bitstring = (OpenSecureChannelResponse,Ns_5638,ST_5639,TTL_5640) in
                                                        {6913}event beginSrv(Sess_5018,Cli_5016,Ns_5638);
                                                        {6914}out(c, (m2_5641,sign(h(m2_5641),skSess_5492)));
                                                        {6915}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {6916}event endSrv(Cli_5016,Sess_5018,Nc_5637)
                                                )
                                                else
                                                    {6917}let v_5642: bool = (Disco_5017 = B) in
                                                    (
                                                        {6918}if v_5642 then
                                                        (
                                                            {6919}let pkDisco_5643: bitstring = pub(skB) in
                                                            {6920}in(c, (=pkCli_5631,em1_5644: bitstring,sigM1_5645: bitstring));
                                                            {6921}let m1_5646: bitstring = em1_5644 in
                                                            {6922}if (verify(h(m1_5646),sigM1_5645,pkCli_5631) <> true) then
                                                                0
                                                            else
                                                                {6923}let (=OpenSecureChannelRequest,=pkCli_5631,Nc_5647: bitstring) = m1_5646 in
                                                                {6924}new Ns_5648: bitstring;
                                                                {6925}new ST_5649: bitstring;
                                                                {6926}new TTL_5650: bitstring;
                                                                {6927}let m2_5651: bitstring = (OpenSecureChannelResponse,Ns_5648,ST_5649,TTL_5650) in
                                                                {6928}event beginSrv(Sess_5018,Cli_5016,Ns_5648);
                                                                {6929}out(c, (m2_5651,sign(h(m2_5651),skSess_5492)));
                                                                {6930}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {6931}event endSrv(Cli_5016,Sess_5018,Nc_5647)
                                                        )
                                                        else
                                                            {6932}let v_5652: bool = (Disco_5017 = C) in
                                                            (
                                                                {6933}if v_5652 then
                                                                (
                                                                    {6934}let pkDisco_5653: bitstring = pub(skC) in
                                                                    {6935}in(c, (=pkCli_5631,em1_5654: bitstring,sigM1_5655: bitstring));
                                                                    {6936}let m1_5656: bitstring = em1_5654 in
                                                                    {6937}if (verify(h(m1_5656),sigM1_5655,pkCli_5631) <> true) then
                                                                        0
                                                                    else
                                                                        {6938}let (=OpenSecureChannelRequest,=pkCli_5631,Nc_5657: bitstring) = m1_5656 in
                                                                        {6939}new Ns_5658: bitstring;
                                                                        {6940}new ST_5659: bitstring;
                                                                        {6941}new TTL_5660: bitstring;
                                                                        {6942}let m2_5661: bitstring = (OpenSecureChannelResponse,Ns_5658,ST_5659,TTL_5660) in
                                                                        {6943}event beginSrv(Sess_5018,Cli_5016,Ns_5658);
                                                                        {6944}out(c, (m2_5661,sign(h(m2_5661),skSess_5492)));
                                                                        {6945}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {6946}event endSrv(Cli_5016,Sess_5018,Nc_5657)
                                                                )
                                                                else
                                                                    {6947}let pkDisco_5662: bitstring = pub(sk(Disco_5017)) in
                                                                    {6948}in(c, (=pkCli_5631,em1_5663: bitstring,sigM1_5664: bitstring));
                                                                    {6949}let m1_5665: bitstring = em1_5663 in
                                                                    {6950}if (verify(h(m1_5665),sigM1_5664,pkCli_5631) <> true) then
                                                                        0
                                                                    else
                                                                        {6951}let (=OpenSecureChannelRequest,=pkCli_5631,Nc_5666: bitstring) = m1_5665 in
                                                                        {6952}new Ns_5667: bitstring;
                                                                        {6953}new ST_5668: bitstring;
                                                                        {6954}new TTL_5669: bitstring;
                                                                        {6955}let m2_5670: bitstring = (OpenSecureChannelResponse,Ns_5667,ST_5668,TTL_5669) in
                                                                        {6956}event beginSrv(Sess_5018,Cli_5016,Ns_5667);
                                                                        {6957}out(c, (m2_5670,sign(h(m2_5670),skSess_5492)));
                                                                        {6958}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {6959}event endSrv(Cli_5016,Sess_5018,Nc_5666)
                                                            )
                                                            else
                                                                {6960}let pkDisco_5671: bitstring = fail-any in
                                                                {6961}in(c, (=pkCli_5631,em1_5672: bitstring,sigM1_5673: bitstring));
                                                                {6962}let m1_5674: bitstring = em1_5672 in
                                                                {6963}if (verify(h(m1_5674),sigM1_5673,pkCli_5631) <> true) then
                                                                    0
                                                                else
                                                                    {6964}let (=OpenSecureChannelRequest,=pkCli_5631,Nc_5675: bitstring) = m1_5674 in
                                                                    {6965}new Ns_5676: bitstring;
                                                                    {6966}new ST_5677: bitstring;
                                                                    {6967}new TTL_5678: bitstring;
                                                                    {6968}let m2_5679: bitstring = (OpenSecureChannelResponse,Ns_5676,ST_5677,TTL_5678) in
                                                                    {6969}event beginSrv(Sess_5018,Cli_5016,Ns_5676);
                                                                    {6970}out(c, (m2_5679,sign(h(m2_5679),skSess_5492)));
                                                                    {6971}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {6972}event endSrv(Cli_5016,Sess_5018,Nc_5675)
                                                    )
                                                    else
                                                        {6973}let pkDisco_5680: bitstring = fail-any in
                                                        {6974}in(c, (=pkCli_5631,em1_5681: bitstring,sigM1_5682: bitstring));
                                                        {6975}let m1_5683: bitstring = em1_5681 in
                                                        {6976}if (verify(h(m1_5683),sigM1_5682,pkCli_5631) <> true) then
                                                            0
                                                        else
                                                            {6977}let (=OpenSecureChannelRequest,=pkCli_5631,Nc_5684: bitstring) = m1_5683 in
                                                            {6978}new Ns_5685: bitstring;
                                                            {6979}new ST_5686: bitstring;
                                                            {6980}new TTL_5687: bitstring;
                                                            {6981}let m2_5688: bitstring = (OpenSecureChannelResponse,Ns_5685,ST_5686,TTL_5687) in
                                                            {6982}event beginSrv(Sess_5018,Cli_5016,Ns_5685);
                                                            {6983}out(c, (m2_5688,sign(h(m2_5688),skSess_5492)));
                                                            {6984}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {6985}event endSrv(Cli_5016,Sess_5018,Nc_5684)
                                            )
                                            else
                                                {6986}let pkDisco_5689: bitstring = fail-any in
                                                {6987}in(c, (=pkCli_5631,em1_5690: bitstring,sigM1_5691: bitstring));
                                                {6988}let m1_5692: bitstring = em1_5690 in
                                                {6989}if (verify(h(m1_5692),sigM1_5691,pkCli_5631) <> true) then
                                                    0
                                                else
                                                    {6990}let (=OpenSecureChannelRequest,=pkCli_5631,Nc_5693: bitstring) = m1_5692 in
                                                    {6991}new Ns_5694: bitstring;
                                                    {6992}new ST_5695: bitstring;
                                                    {6993}new TTL_5696: bitstring;
                                                    {6994}let m2_5697: bitstring = (OpenSecureChannelResponse,Ns_5694,ST_5695,TTL_5696) in
                                                    {6995}event beginSrv(Sess_5018,Cli_5016,Ns_5694);
                                                    {6996}out(c, (m2_5697,sign(h(m2_5697),skSess_5492)));
                                                    {6997}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {6998}event endSrv(Cli_5016,Sess_5018,Nc_5693)
                                        )
                                        else
                                            {6999}let pkCli_5698: bitstring = pub(sk(Cli_5016)) in
                                            {7000}let v_5699: bool = (Disco_5017 = A) in
                                            (
                                                {7001}if v_5699 then
                                                (
                                                    {7002}let pkDisco_5700: bitstring = pub(skA) in
                                                    {7003}in(c, (=pkCli_5698,em1_5701: bitstring,sigM1_5702: bitstring));
                                                    {7004}let m1_5703: bitstring = em1_5701 in
                                                    {7005}if (verify(h(m1_5703),sigM1_5702,pkCli_5698) <> true) then
                                                        0
                                                    else
                                                        {7006}let (=OpenSecureChannelRequest,=pkCli_5698,Nc_5704: bitstring) = m1_5703 in
                                                        {7007}new Ns_5705: bitstring;
                                                        {7008}new ST_5706: bitstring;
                                                        {7009}new TTL_5707: bitstring;
                                                        {7010}let m2_5708: bitstring = (OpenSecureChannelResponse,Ns_5705,ST_5706,TTL_5707) in
                                                        {7011}event beginSrv(Sess_5018,Cli_5016,Ns_5705);
                                                        {7012}out(c, (m2_5708,sign(h(m2_5708),skSess_5492)));
                                                        {7013}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7014}event endSrv(Cli_5016,Sess_5018,Nc_5704)
                                                )
                                                else
                                                    {7015}let v_5709: bool = (Disco_5017 = B) in
                                                    (
                                                        {7016}if v_5709 then
                                                        (
                                                            {7017}let pkDisco_5710: bitstring = pub(skB) in
                                                            {7018}in(c, (=pkCli_5698,em1_5711: bitstring,sigM1_5712: bitstring));
                                                            {7019}let m1_5713: bitstring = em1_5711 in
                                                            {7020}if (verify(h(m1_5713),sigM1_5712,pkCli_5698) <> true) then
                                                                0
                                                            else
                                                                {7021}let (=OpenSecureChannelRequest,=pkCli_5698,Nc_5714: bitstring) = m1_5713 in
                                                                {7022}new Ns_5715: bitstring;
                                                                {7023}new ST_5716: bitstring;
                                                                {7024}new TTL_5717: bitstring;
                                                                {7025}let m2_5718: bitstring = (OpenSecureChannelResponse,Ns_5715,ST_5716,TTL_5717) in
                                                                {7026}event beginSrv(Sess_5018,Cli_5016,Ns_5715);
                                                                {7027}out(c, (m2_5718,sign(h(m2_5718),skSess_5492)));
                                                                {7028}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7029}event endSrv(Cli_5016,Sess_5018,Nc_5714)
                                                        )
                                                        else
                                                            {7030}let v_5719: bool = (Disco_5017 = C) in
                                                            (
                                                                {7031}if v_5719 then
                                                                (
                                                                    {7032}let pkDisco_5720: bitstring = pub(skC) in
                                                                    {7033}in(c, (=pkCli_5698,em1_5721: bitstring,sigM1_5722: bitstring));
                                                                    {7034}let m1_5723: bitstring = em1_5721 in
                                                                    {7035}if (verify(h(m1_5723),sigM1_5722,pkCli_5698) <> true) then
                                                                        0
                                                                    else
                                                                        {7036}let (=OpenSecureChannelRequest,=pkCli_5698,Nc_5724: bitstring) = m1_5723 in
                                                                        {7037}new Ns_5725: bitstring;
                                                                        {7038}new ST_5726: bitstring;
                                                                        {7039}new TTL_5727: bitstring;
                                                                        {7040}let m2_5728: bitstring = (OpenSecureChannelResponse,Ns_5725,ST_5726,TTL_5727) in
                                                                        {7041}event beginSrv(Sess_5018,Cli_5016,Ns_5725);
                                                                        {7042}out(c, (m2_5728,sign(h(m2_5728),skSess_5492)));
                                                                        {7043}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {7044}event endSrv(Cli_5016,Sess_5018,Nc_5724)
                                                                )
                                                                else
                                                                    {7045}let pkDisco_5729: bitstring = pub(sk(Disco_5017)) in
                                                                    {7046}in(c, (=pkCli_5698,em1_5730: bitstring,sigM1_5731: bitstring));
                                                                    {7047}let m1_5732: bitstring = em1_5730 in
                                                                    {7048}if (verify(h(m1_5732),sigM1_5731,pkCli_5698) <> true) then
                                                                        0
                                                                    else
                                                                        {7049}let (=OpenSecureChannelRequest,=pkCli_5698,Nc_5733: bitstring) = m1_5732 in
                                                                        {7050}new Ns_5734: bitstring;
                                                                        {7051}new ST_5735: bitstring;
                                                                        {7052}new TTL_5736: bitstring;
                                                                        {7053}let m2_5737: bitstring = (OpenSecureChannelResponse,Ns_5734,ST_5735,TTL_5736) in
                                                                        {7054}event beginSrv(Sess_5018,Cli_5016,Ns_5734);
                                                                        {7055}out(c, (m2_5737,sign(h(m2_5737),skSess_5492)));
                                                                        {7056}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {7057}event endSrv(Cli_5016,Sess_5018,Nc_5733)
                                                            )
                                                            else
                                                                {7058}let pkDisco_5738: bitstring = fail-any in
                                                                {7059}in(c, (=pkCli_5698,em1_5739: bitstring,sigM1_5740: bitstring));
                                                                {7060}let m1_5741: bitstring = em1_5739 in
                                                                {7061}if (verify(h(m1_5741),sigM1_5740,pkCli_5698) <> true) then
                                                                    0
                                                                else
                                                                    {7062}let (=OpenSecureChannelRequest,=pkCli_5698,Nc_5742: bitstring) = m1_5741 in
                                                                    {7063}new Ns_5743: bitstring;
                                                                    {7064}new ST_5744: bitstring;
                                                                    {7065}new TTL_5745: bitstring;
                                                                    {7066}let m2_5746: bitstring = (OpenSecureChannelResponse,Ns_5743,ST_5744,TTL_5745) in
                                                                    {7067}event beginSrv(Sess_5018,Cli_5016,Ns_5743);
                                                                    {7068}out(c, (m2_5746,sign(h(m2_5746),skSess_5492)));
                                                                    {7069}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7070}event endSrv(Cli_5016,Sess_5018,Nc_5742)
                                                    )
                                                    else
                                                        {7071}let pkDisco_5747: bitstring = fail-any in
                                                        {7072}in(c, (=pkCli_5698,em1_5748: bitstring,sigM1_5749: bitstring));
                                                        {7073}let m1_5750: bitstring = em1_5748 in
                                                        {7074}if (verify(h(m1_5750),sigM1_5749,pkCli_5698) <> true) then
                                                            0
                                                        else
                                                            {7075}let (=OpenSecureChannelRequest,=pkCli_5698,Nc_5751: bitstring) = m1_5750 in
                                                            {7076}new Ns_5752: bitstring;
                                                            {7077}new ST_5753: bitstring;
                                                            {7078}new TTL_5754: bitstring;
                                                            {7079}let m2_5755: bitstring = (OpenSecureChannelResponse,Ns_5752,ST_5753,TTL_5754) in
                                                            {7080}event beginSrv(Sess_5018,Cli_5016,Ns_5752);
                                                            {7081}out(c, (m2_5755,sign(h(m2_5755),skSess_5492)));
                                                            {7082}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7083}event endSrv(Cli_5016,Sess_5018,Nc_5751)
                                            )
                                            else
                                                {7084}let pkDisco_5756: bitstring = fail-any in
                                                {7085}in(c, (=pkCli_5698,em1_5757: bitstring,sigM1_5758: bitstring));
                                                {7086}let m1_5759: bitstring = em1_5757 in
                                                {7087}if (verify(h(m1_5759),sigM1_5758,pkCli_5698) <> true) then
                                                    0
                                                else
                                                    {7088}let (=OpenSecureChannelRequest,=pkCli_5698,Nc_5760: bitstring) = m1_5759 in
                                                    {7089}new Ns_5761: bitstring;
                                                    {7090}new ST_5762: bitstring;
                                                    {7091}new TTL_5763: bitstring;
                                                    {7092}let m2_5764: bitstring = (OpenSecureChannelResponse,Ns_5761,ST_5762,TTL_5763) in
                                                    {7093}event beginSrv(Sess_5018,Cli_5016,Ns_5761);
                                                    {7094}out(c, (m2_5764,sign(h(m2_5764),skSess_5492)));
                                                    {7095}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7096}event endSrv(Cli_5016,Sess_5018,Nc_5760)
                                    )
                                    else
                                        {7097}let pkCli_5765: bitstring = fail-any in
                                        {7098}let v_5766: bool = (Disco_5017 = A) in
                                        (
                                            {7099}if v_5766 then
                                            (
                                                {7100}let pkDisco_5767: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_5765,em1_5768: bitstring,sigM1_5769: bitstring));
                                                {7102}let m1_5770: bitstring = em1_5768 in
                                                {7103}if (verify(h(m1_5770),sigM1_5769,pkCli_5765) <> true) then
                                                    0
                                                else
                                                    {7104}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5771: bitstring) = m1_5770 in
                                                    {7105}new Ns_5772: bitstring;
                                                    {7106}new ST_5773: bitstring;
                                                    {7107}new TTL_5774: bitstring;
                                                    {7108}let m2_5775: bitstring = (OpenSecureChannelResponse,Ns_5772,ST_5773,TTL_5774) in
                                                    {7109}event beginSrv(Sess_5018,Cli_5016,Ns_5772);
                                                    {7110}out(c, (m2_5775,sign(h(m2_5775),skSess_5492)));
                                                    {7111}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7112}event endSrv(Cli_5016,Sess_5018,Nc_5771)
                                            )
                                            else
                                                {7113}let v_5776: bool = (Disco_5017 = B) in
                                                (
                                                    {7114}if v_5776 then
                                                    (
                                                        {7115}let pkDisco_5777: bitstring = pub(skB) in
                                                        {7116}in(c, (=pkCli_5765,em1_5778: bitstring,sigM1_5779: bitstring));
                                                        {7117}let m1_5780: bitstring = em1_5778 in
                                                        {7118}if (verify(h(m1_5780),sigM1_5779,pkCli_5765) <> true) then
                                                            0
                                                        else
                                                            {7119}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5781: bitstring) = m1_5780 in
                                                            {7120}new Ns_5782: bitstring;
                                                            {7121}new ST_5783: bitstring;
                                                            {7122}new TTL_5784: bitstring;
                                                            {7123}let m2_5785: bitstring = (OpenSecureChannelResponse,Ns_5782,ST_5783,TTL_5784) in
                                                            {7124}event beginSrv(Sess_5018,Cli_5016,Ns_5782);
                                                            {7125}out(c, (m2_5785,sign(h(m2_5785),skSess_5492)));
                                                            {7126}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7127}event endSrv(Cli_5016,Sess_5018,Nc_5781)
                                                    )
                                                    else
                                                        {7128}let v_5786: bool = (Disco_5017 = C) in
                                                        (
                                                            {7129}if v_5786 then
                                                            (
                                                                {7130}let pkDisco_5787: bitstring = pub(skC) in
                                                                {7131}in(c, (=pkCli_5765,em1_5788: bitstring,sigM1_5789: bitstring));
                                                                {7132}let m1_5790: bitstring = em1_5788 in
                                                                {7133}if (verify(h(m1_5790),sigM1_5789,pkCli_5765) <> true) then
                                                                    0
                                                                else
                                                                    {7134}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5791: bitstring) = m1_5790 in
                                                                    {7135}new Ns_5792: bitstring;
                                                                    {7136}new ST_5793: bitstring;
                                                                    {7137}new TTL_5794: bitstring;
                                                                    {7138}let m2_5795: bitstring = (OpenSecureChannelResponse,Ns_5792,ST_5793,TTL_5794) in
                                                                    {7139}event beginSrv(Sess_5018,Cli_5016,Ns_5792);
                                                                    {7140}out(c, (m2_5795,sign(h(m2_5795),skSess_5492)));
                                                                    {7141}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7142}event endSrv(Cli_5016,Sess_5018,Nc_5791)
                                                            )
                                                            else
                                                                {7143}let pkDisco_5796: bitstring = pub(sk(Disco_5017)) in
                                                                {7144}in(c, (=pkCli_5765,em1_5797: bitstring,sigM1_5798: bitstring));
                                                                {7145}let m1_5799: bitstring = em1_5797 in
                                                                {7146}if (verify(h(m1_5799),sigM1_5798,pkCli_5765) <> true) then
                                                                    0
                                                                else
                                                                    {7147}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5800: bitstring) = m1_5799 in
                                                                    {7148}new Ns_5801: bitstring;
                                                                    {7149}new ST_5802: bitstring;
                                                                    {7150}new TTL_5803: bitstring;
                                                                    {7151}let m2_5804: bitstring = (OpenSecureChannelResponse,Ns_5801,ST_5802,TTL_5803) in
                                                                    {7152}event beginSrv(Sess_5018,Cli_5016,Ns_5801);
                                                                    {7153}out(c, (m2_5804,sign(h(m2_5804),skSess_5492)));
                                                                    {7154}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7155}event endSrv(Cli_5016,Sess_5018,Nc_5800)
                                                        )
                                                        else
                                                            {7156}let pkDisco_5805: bitstring = fail-any in
                                                            {7157}in(c, (=pkCli_5765,em1_5806: bitstring,sigM1_5807: bitstring));
                                                            {7158}let m1_5808: bitstring = em1_5806 in
                                                            {7159}if (verify(h(m1_5808),sigM1_5807,pkCli_5765) <> true) then
                                                                0
                                                            else
                                                                {7160}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5809: bitstring) = m1_5808 in
                                                                {7161}new Ns_5810: bitstring;
                                                                {7162}new ST_5811: bitstring;
                                                                {7163}new TTL_5812: bitstring;
                                                                {7164}let m2_5813: bitstring = (OpenSecureChannelResponse,Ns_5810,ST_5811,TTL_5812) in
                                                                {7165}event beginSrv(Sess_5018,Cli_5016,Ns_5810);
                                                                {7166}out(c, (m2_5813,sign(h(m2_5813),skSess_5492)));
                                                                {7167}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7168}event endSrv(Cli_5016,Sess_5018,Nc_5809)
                                                )
                                                else
                                                    {7169}let pkDisco_5814: bitstring = fail-any in
                                                    {7170}in(c, (=pkCli_5765,em1_5815: bitstring,sigM1_5816: bitstring));
                                                    {7171}let m1_5817: bitstring = em1_5815 in
                                                    {7172}if (verify(h(m1_5817),sigM1_5816,pkCli_5765) <> true) then
                                                        0
                                                    else
                                                        {7173}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5818: bitstring) = m1_5817 in
                                                        {7174}new Ns_5819: bitstring;
                                                        {7175}new ST_5820: bitstring;
                                                        {7176}new TTL_5821: bitstring;
                                                        {7177}let m2_5822: bitstring = (OpenSecureChannelResponse,Ns_5819,ST_5820,TTL_5821) in
                                                        {7178}event beginSrv(Sess_5018,Cli_5016,Ns_5819);
                                                        {7179}out(c, (m2_5822,sign(h(m2_5822),skSess_5492)));
                                                        {7180}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7181}event endSrv(Cli_5016,Sess_5018,Nc_5818)
                                        )
                                        else
                                            {7182}let pkDisco_5823: bitstring = fail-any in
                                            {7183}in(c, (=pkCli_5765,em1_5824: bitstring,sigM1_5825: bitstring));
                                            {7184}let m1_5826: bitstring = em1_5824 in
                                            {7185}if (verify(h(m1_5826),sigM1_5825,pkCli_5765) <> true) then
                                                0
                                            else
                                                {7186}let (=OpenSecureChannelRequest,=pkCli_5765,Nc_5827: bitstring) = m1_5826 in
                                                {7187}new Ns_5828: bitstring;
                                                {7188}new ST_5829: bitstring;
                                                {7189}new TTL_5830: bitstring;
                                                {7190}let m2_5831: bitstring = (OpenSecureChannelResponse,Ns_5828,ST_5829,TTL_5830) in
                                                {7191}event beginSrv(Sess_5018,Cli_5016,Ns_5828);
                                                {7192}out(c, (m2_5831,sign(h(m2_5831),skSess_5492)));
                                                {7193}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {7194}event endSrv(Cli_5016,Sess_5018,Nc_5827)
                            )
                            else
                                {7195}let pkCli_5832: bitstring = fail-any in
                                {7196}let v_5833: bool = (Disco_5017 = A) in
                                (
                                    {7197}if v_5833 then
                                    (
                                        {7198}let pkDisco_5834: bitstring = pub(skA) in
                                        {7199}in(c, (=pkCli_5832,em1_5835: bitstring,sigM1_5836: bitstring));
                                        {7200}let m1_5837: bitstring = em1_5835 in
                                        {7201}if (verify(h(m1_5837),sigM1_5836,pkCli_5832) <> true) then
                                            0
                                        else
                                            {7202}let (=OpenSecureChannelRequest,=pkCli_5832,Nc_5838: bitstring) = m1_5837 in
                                            {7203}new Ns_5839: bitstring;
                                            {7204}new ST_5840: bitstring;
                                            {7205}new TTL_5841: bitstring;
                                            {7206}let m2_5842: bitstring = (OpenSecureChannelResponse,Ns_5839,ST_5840,TTL_5841) in
                                            {7207}event beginSrv(Sess_5018,Cli_5016,Ns_5839);
                                            {7208}out(c, (m2_5842,sign(h(m2_5842),skSess_5492)));
                                            {7209}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {7210}event endSrv(Cli_5016,Sess_5018,Nc_5838)
                                    )
                                    else
                                        {7211}let v_5843: bool = (Disco_5017 = B) in
                                        (
                                            {7212}if v_5843 then
                                            (
                                                {7213}let pkDisco_5844: bitstring = pub(skB) in
                                                {7214}in(c, (=pkCli_5832,em1_5845: bitstring,sigM1_5846: bitstring));
                                                {7215}let m1_5847: bitstring = em1_5845 in
                                                {7216}if (verify(h(m1_5847),sigM1_5846,pkCli_5832) <> true) then
                                                    0
                                                else
                                                    {7217}let (=OpenSecureChannelRequest,=pkCli_5832,Nc_5848: bitstring) = m1_5847 in
                                                    {7218}new Ns_5849: bitstring;
                                                    {7219}new ST_5850: bitstring;
                                                    {7220}new TTL_5851: bitstring;
                                                    {7221}let m2_5852: bitstring = (OpenSecureChannelResponse,Ns_5849,ST_5850,TTL_5851) in
                                                    {7222}event beginSrv(Sess_5018,Cli_5016,Ns_5849);
                                                    {7223}out(c, (m2_5852,sign(h(m2_5852),skSess_5492)));
                                                    {7224}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7225}event endSrv(Cli_5016,Sess_5018,Nc_5848)
                                            )
                                            else
                                                {7226}let v_5853: bool = (Disco_5017 = C) in
                                                (
                                                    {7227}if v_5853 then
                                                    (
                                                        {7228}let pkDisco_5854: bitstring = pub(skC) in
                                                        {7229}in(c, (=pkCli_5832,em1_5855: bitstring,sigM1_5856: bitstring));
                                                        {7230}let m1_5857: bitstring = em1_5855 in
                                                        {7231}if (verify(h(m1_5857),sigM1_5856,pkCli_5832) <> true) then
                                                            0
                                                        else
                                                            {7232}let (=OpenSecureChannelRequest,=pkCli_5832,Nc_5858: bitstring) = m1_5857 in
                                                            {7233}new Ns_5859: bitstring;
                                                            {7234}new ST_5860: bitstring;
                                                            {7235}new TTL_5861: bitstring;
                                                            {7236}let m2_5862: bitstring = (OpenSecureChannelResponse,Ns_5859,ST_5860,TTL_5861) in
                                                            {7237}event beginSrv(Sess_5018,Cli_5016,Ns_5859);
                                                            {7238}out(c, (m2_5862,sign(h(m2_5862),skSess_5492)));
                                                            {7239}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7240}event endSrv(Cli_5016,Sess_5018,Nc_5858)
                                                    )
                                                    else
                                                        {7241}let pkDisco_5863: bitstring = pub(sk(Disco_5017)) in
                                                        {7242}in(c, (=pkCli_5832,em1_5864: bitstring,sigM1_5865: bitstring));
                                                        {7243}let m1_5866: bitstring = em1_5864 in
                                                        {7244}if (verify(h(m1_5866),sigM1_5865,pkCli_5832) <> true) then
                                                            0
                                                        else
                                                            {7245}let (=OpenSecureChannelRequest,=pkCli_5832,Nc_5867: bitstring) = m1_5866 in
                                                            {7246}new Ns_5868: bitstring;
                                                            {7247}new ST_5869: bitstring;
                                                            {7248}new TTL_5870: bitstring;
                                                            {7249}let m2_5871: bitstring = (OpenSecureChannelResponse,Ns_5868,ST_5869,TTL_5870) in
                                                            {7250}event beginSrv(Sess_5018,Cli_5016,Ns_5868);
                                                            {7251}out(c, (m2_5871,sign(h(m2_5871),skSess_5492)));
                                                            {7252}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7253}event endSrv(Cli_5016,Sess_5018,Nc_5867)
                                                )
                                                else
                                                    {7254}let pkDisco_5872: bitstring = fail-any in
                                                    {7255}in(c, (=pkCli_5832,em1_5873: bitstring,sigM1_5874: bitstring));
                                                    {7256}let m1_5875: bitstring = em1_5873 in
                                                    {7257}if (verify(h(m1_5875),sigM1_5874,pkCli_5832) <> true) then
                                                        0
                                                    else
                                                        {7258}let (=OpenSecureChannelRequest,=pkCli_5832,Nc_5876: bitstring) = m1_5875 in
                                                        {7259}new Ns_5877: bitstring;
                                                        {7260}new ST_5878: bitstring;
                                                        {7261}new TTL_5879: bitstring;
                                                        {7262}let m2_5880: bitstring = (OpenSecureChannelResponse,Ns_5877,ST_5878,TTL_5879) in
                                                        {7263}event beginSrv(Sess_5018,Cli_5016,Ns_5877);
                                                        {7264}out(c, (m2_5880,sign(h(m2_5880),skSess_5492)));
                                                        {7265}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7266}event endSrv(Cli_5016,Sess_5018,Nc_5876)
                                        )
                                        else
                                            {7267}let pkDisco_5881: bitstring = fail-any in
                                            {7268}in(c, (=pkCli_5832,em1_5882: bitstring,sigM1_5883: bitstring));
                                            {7269}let m1_5884: bitstring = em1_5882 in
                                            {7270}if (verify(h(m1_5884),sigM1_5883,pkCli_5832) <> true) then
                                                0
                                            else
                                                {7271}let (=OpenSecureChannelRequest,=pkCli_5832,Nc_5885: bitstring) = m1_5884 in
                                                {7272}new Ns_5886: bitstring;
                                                {7273}new ST_5887: bitstring;
                                                {7274}new TTL_5888: bitstring;
                                                {7275}let m2_5889: bitstring = (OpenSecureChannelResponse,Ns_5886,ST_5887,TTL_5888) in
                                                {7276}event beginSrv(Sess_5018,Cli_5016,Ns_5886);
                                                {7277}out(c, (m2_5889,sign(h(m2_5889),skSess_5492)));
                                                {7278}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {7279}event endSrv(Cli_5016,Sess_5018,Nc_5885)
                                )
                                else
                                    {7280}let pkDisco_5890: bitstring = fail-any in
                                    {7281}in(c, (=pkCli_5832,em1_5891: bitstring,sigM1_5892: bitstring));
                                    {7282}let m1_5893: bitstring = em1_5891 in
                                    {7283}if (verify(h(m1_5893),sigM1_5892,pkCli_5832) <> true) then
                                        0
                                    else
                                        {7284}let (=OpenSecureChannelRequest,=pkCli_5832,Nc_5894: bitstring) = m1_5893 in
                                        {7285}new Ns_5895: bitstring;
                                        {7286}new ST_5896: bitstring;
                                        {7287}new TTL_5897: bitstring;
                                        {7288}let m2_5898: bitstring = (OpenSecureChannelResponse,Ns_5895,ST_5896,TTL_5897) in
                                        {7289}event beginSrv(Sess_5018,Cli_5016,Ns_5895);
                                        {7290}out(c, (m2_5898,sign(h(m2_5898),skSess_5492)));
                                        {7291}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {7292}event endSrv(Cli_5016,Sess_5018,Nc_5894)
                    )
                    else
                        {7293}let pkCli_5899: bitstring = fail-any in
                        {7294}let v_5900: bool = (Disco_5017 = A) in
                        (
                            {7295}if v_5900 then
                            (
                                {7296}let pkDisco_5901: bitstring = pub(skA) in
                                {7297}in(c, (=pkCli_5899,em1_5902: bitstring,sigM1_5903: bitstring));
                                {7298}let m1_5904: bitstring = em1_5902 in
                                {7299}if (verify(h(m1_5904),sigM1_5903,pkCli_5899) <> true) then
                                    0
                                else
                                    {7300}let (=OpenSecureChannelRequest,=pkCli_5899,Nc_5905: bitstring) = m1_5904 in
                                    {7301}new Ns_5906: bitstring;
                                    {7302}new ST_5907: bitstring;
                                    {7303}new TTL_5908: bitstring;
                                    {7304}let m2_5909: bitstring = (OpenSecureChannelResponse,Ns_5906,ST_5907,TTL_5908) in
                                    {7305}event beginSrv(Sess_5018,Cli_5016,Ns_5906);
                                    {7306}out(c, (m2_5909,sign(h(m2_5909),skSess_5492)));
                                    {7307}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {7308}event endSrv(Cli_5016,Sess_5018,Nc_5905)
                            )
                            else
                                {7309}let v_5910: bool = (Disco_5017 = B) in
                                (
                                    {7310}if v_5910 then
                                    (
                                        {7311}let pkDisco_5911: bitstring = pub(skB) in
                                        {7312}in(c, (=pkCli_5899,em1_5912: bitstring,sigM1_5913: bitstring));
                                        {7313}let m1_5914: bitstring = em1_5912 in
                                        {7314}if (verify(h(m1_5914),sigM1_5913,pkCli_5899) <> true) then
                                            0
                                        else
                                            {7315}let (=OpenSecureChannelRequest,=pkCli_5899,Nc_5915: bitstring) = m1_5914 in
                                            {7316}new Ns_5916: bitstring;
                                            {7317}new ST_5917: bitstring;
                                            {7318}new TTL_5918: bitstring;
                                            {7319}let m2_5919: bitstring = (OpenSecureChannelResponse,Ns_5916,ST_5917,TTL_5918) in
                                            {7320}event beginSrv(Sess_5018,Cli_5016,Ns_5916);
                                            {7321}out(c, (m2_5919,sign(h(m2_5919),skSess_5492)));
                                            {7322}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {7323}event endSrv(Cli_5016,Sess_5018,Nc_5915)
                                    )
                                    else
                                        {7324}let v_5920: bool = (Disco_5017 = C) in
                                        (
                                            {7325}if v_5920 then
                                            (
                                                {7326}let pkDisco_5921: bitstring = pub(skC) in
                                                {7327}in(c, (=pkCli_5899,em1_5922: bitstring,sigM1_5923: bitstring));
                                                {7328}let m1_5924: bitstring = em1_5922 in
                                                {7329}if (verify(h(m1_5924),sigM1_5923,pkCli_5899) <> true) then
                                                    0
                                                else
                                                    {7330}let (=OpenSecureChannelRequest,=pkCli_5899,Nc_5925: bitstring) = m1_5924 in
                                                    {7331}new Ns_5926: bitstring;
                                                    {7332}new ST_5927: bitstring;
                                                    {7333}new TTL_5928: bitstring;
                                                    {7334}let m2_5929: bitstring = (OpenSecureChannelResponse,Ns_5926,ST_5927,TTL_5928) in
                                                    {7335}event beginSrv(Sess_5018,Cli_5016,Ns_5926);
                                                    {7336}out(c, (m2_5929,sign(h(m2_5929),skSess_5492)));
                                                    {7337}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7338}event endSrv(Cli_5016,Sess_5018,Nc_5925)
                                            )
                                            else
                                                {7339}let pkDisco_5930: bitstring = pub(sk(Disco_5017)) in
                                                {7340}in(c, (=pkCli_5899,em1_5931: bitstring,sigM1_5932: bitstring));
                                                {7341}let m1_5933: bitstring = em1_5931 in
                                                {7342}if (verify(h(m1_5933),sigM1_5932,pkCli_5899) <> true) then
                                                    0
                                                else
                                                    {7343}let (=OpenSecureChannelRequest,=pkCli_5899,Nc_5934: bitstring) = m1_5933 in
                                                    {7344}new Ns_5935: bitstring;
                                                    {7345}new ST_5936: bitstring;
                                                    {7346}new TTL_5937: bitstring;
                                                    {7347}let m2_5938: bitstring = (OpenSecureChannelResponse,Ns_5935,ST_5936,TTL_5937) in
                                                    {7348}event beginSrv(Sess_5018,Cli_5016,Ns_5935);
                                                    {7349}out(c, (m2_5938,sign(h(m2_5938),skSess_5492)));
                                                    {7350}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7351}event endSrv(Cli_5016,Sess_5018,Nc_5934)
                                        )
                                        else
                                            {7352}let pkDisco_5939: bitstring = fail-any in
                                            {7353}in(c, (=pkCli_5899,em1_5940: bitstring,sigM1_5941: bitstring));
                                            {7354}let m1_5942: bitstring = em1_5940 in
                                            {7355}if (verify(h(m1_5942),sigM1_5941,pkCli_5899) <> true) then
                                                0
                                            else
                                                {7356}let (=OpenSecureChannelRequest,=pkCli_5899,Nc_5943: bitstring) = m1_5942 in
                                                {7357}new Ns_5944: bitstring;
                                                {7358}new ST_5945: bitstring;
                                                {7359}new TTL_5946: bitstring;
                                                {7360}let m2_5947: bitstring = (OpenSecureChannelResponse,Ns_5944,ST_5945,TTL_5946) in
                                                {7361}event beginSrv(Sess_5018,Cli_5016,Ns_5944);
                                                {7362}out(c, (m2_5947,sign(h(m2_5947),skSess_5492)));
                                                {7363}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {7364}event endSrv(Cli_5016,Sess_5018,Nc_5943)
                                )
                                else
                                    {7365}let pkDisco_5948: bitstring = fail-any in
                                    {7366}in(c, (=pkCli_5899,em1_5949: bitstring,sigM1_5950: bitstring));
                                    {7367}let m1_5951: bitstring = em1_5949 in
                                    {7368}if (verify(h(m1_5951),sigM1_5950,pkCli_5899) <> true) then
                                        0
                                    else
                                        {7369}let (=OpenSecureChannelRequest,=pkCli_5899,Nc_5952: bitstring) = m1_5951 in
                                        {7370}new Ns_5953: bitstring;
                                        {7371}new ST_5954: bitstring;
                                        {7372}new TTL_5955: bitstring;
                                        {7373}let m2_5956: bitstring = (OpenSecureChannelResponse,Ns_5953,ST_5954,TTL_5955) in
                                        {7374}event beginSrv(Sess_5018,Cli_5016,Ns_5953);
                                        {7375}out(c, (m2_5956,sign(h(m2_5956),skSess_5492)));
                                        {7376}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {7377}event endSrv(Cli_5016,Sess_5018,Nc_5952)
                        )
                        else
                            {7378}let pkDisco_5957: bitstring = fail-any in
                            {7379}in(c, (=pkCli_5899,em1_5958: bitstring,sigM1_5959: bitstring));
                            {7380}let m1_5960: bitstring = em1_5958 in
                            {7381}if (verify(h(m1_5960),sigM1_5959,pkCli_5899) <> true) then
                                0
                            else
                                {7382}let (=OpenSecureChannelRequest,=pkCli_5899,Nc_5961: bitstring) = m1_5960 in
                                {7383}new Ns_5962: bitstring;
                                {7384}new ST_5963: bitstring;
                                {7385}new TTL_5964: bitstring;
                                {7386}let m2_5965: bitstring = (OpenSecureChannelResponse,Ns_5962,ST_5963,TTL_5964) in
                                {7387}event beginSrv(Sess_5018,Cli_5016,Ns_5962);
                                {7388}out(c, (m2_5965,sign(h(m2_5965),skSess_5492)));
                                {7389}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {7390}event endSrv(Cli_5016,Sess_5018,Nc_5961)
                )
                else
                    {7391}let =true = (Sess_5018 = C) in
                    (
                        {7392}let skSess_5966: bitstring = skC in
                        {7393}let pkSess_5967: bitstring = pub(skSess_5966) in
                        {7394}let v_5968: bool = (Cli_5016 = A) in
                        (
                            {7395}if v_5968 then
                            (
                                {7396}let pkCli_5969: bitstring = pub(skA) in
                                {7397}let v_5970: bool = (Disco_5017 = A) in
                                (
                                    {7398}if v_5970 then
                                    (
                                        {7399}let pkDisco_5971: bitstring = pub(skA) in
                                        {7400}in(c, (=pkCli_5969,em1_5972: bitstring,sigM1_5973: bitstring));
                                        {7401}let m1_5974: bitstring = em1_5972 in
                                        {7402}if (verify(h(m1_5974),sigM1_5973,pkCli_5969) <> true) then
                                            0
                                        else
                                            {7403}let (=OpenSecureChannelRequest,=pkCli_5969,Nc_5975: bitstring) = m1_5974 in
                                            {7404}new Ns_5976: bitstring;
                                            {7405}new ST_5977: bitstring;
                                            {7406}new TTL_5978: bitstring;
                                            {7407}let m2_5979: bitstring = (OpenSecureChannelResponse,Ns_5976,ST_5977,TTL_5978) in
                                            {7408}event beginSrv(Sess_5018,Cli_5016,Ns_5976);
                                            {7409}out(c, (m2_5979,sign(h(m2_5979),skSess_5966)));
                                            {7410}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {7411}event endSrv(Cli_5016,Sess_5018,Nc_5975)
                                    )
                                    else
                                        {7412}let v_5980: bool = (Disco_5017 = B) in
                                        (
                                            {7413}if v_5980 then
                                            (
                                                {7414}let pkDisco_5981: bitstring = pub(skB) in
                                                {7415}in(c, (=pkCli_5969,em1_5982: bitstring,sigM1_5983: bitstring));
                                                {7416}let m1_5984: bitstring = em1_5982 in
                                                {7417}if (verify(h(m1_5984),sigM1_5983,pkCli_5969) <> true) then
                                                    0
                                                else
                                                    {7418}let (=OpenSecureChannelRequest,=pkCli_5969,Nc_5985: bitstring) = m1_5984 in
                                                    {7419}new Ns_5986: bitstring;
                                                    {7420}new ST_5987: bitstring;
                                                    {7421}new TTL_5988: bitstring;
                                                    {7422}let m2_5989: bitstring = (OpenSecureChannelResponse,Ns_5986,ST_5987,TTL_5988) in
                                                    {7423}event beginSrv(Sess_5018,Cli_5016,Ns_5986);
                                                    {7424}out(c, (m2_5989,sign(h(m2_5989),skSess_5966)));
                                                    {7425}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7426}event endSrv(Cli_5016,Sess_5018,Nc_5985)
                                            )
                                            else
                                                {7427}let v_5990: bool = (Disco_5017 = C) in
                                                (
                                                    {7428}if v_5990 then
                                                    (
                                                        {7429}let pkDisco_5991: bitstring = pub(skC) in
                                                        {7430}in(c, (=pkCli_5969,em1_5992: bitstring,sigM1_5993: bitstring));
                                                        {7431}let m1_5994: bitstring = em1_5992 in
                                                        {7432}if (verify(h(m1_5994),sigM1_5993,pkCli_5969) <> true) then
                                                            0
                                                        else
                                                            {7433}let (=OpenSecureChannelRequest,=pkCli_5969,Nc_5995: bitstring) = m1_5994 in
                                                            {7434}new Ns_5996: bitstring;
                                                            {7435}new ST_5997: bitstring;
                                                            {7436}new TTL_5998: bitstring;
                                                            {7437}let m2_5999: bitstring = (OpenSecureChannelResponse,Ns_5996,ST_5997,TTL_5998) in
                                                            {7438}event beginSrv(Sess_5018,Cli_5016,Ns_5996);
                                                            {7439}out(c, (m2_5999,sign(h(m2_5999),skSess_5966)));
                                                            {7440}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7441}event endSrv(Cli_5016,Sess_5018,Nc_5995)
                                                    )
                                                    else
                                                        {7442}let pkDisco_6000: bitstring = pub(sk(Disco_5017)) in
                                                        {7443}in(c, (=pkCli_5969,em1_6001: bitstring,sigM1_6002: bitstring));
                                                        {7444}let m1_6003: bitstring = em1_6001 in
                                                        {7445}if (verify(h(m1_6003),sigM1_6002,pkCli_5969) <> true) then
                                                            0
                                                        else
                                                            {7446}let (=OpenSecureChannelRequest,=pkCli_5969,Nc_6004: bitstring) = m1_6003 in
                                                            {7447}new Ns_6005: bitstring;
                                                            {7448}new ST_6006: bitstring;
                                                            {7449}new TTL_6007: bitstring;
                                                            {7450}let m2_6008: bitstring = (OpenSecureChannelResponse,Ns_6005,ST_6006,TTL_6007) in
                                                            {7451}event beginSrv(Sess_5018,Cli_5016,Ns_6005);
                                                            {7452}out(c, (m2_6008,sign(h(m2_6008),skSess_5966)));
                                                            {7453}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7454}event endSrv(Cli_5016,Sess_5018,Nc_6004)
                                                )
                                                else
                                                    {7455}let pkDisco_6009: bitstring = fail-any in
                                                    {7456}in(c, (=pkCli_5969,em1_6010: bitstring,sigM1_6011: bitstring));
                                                    {7457}let m1_6012: bitstring = em1_6010 in
                                                    {7458}if (verify(h(m1_6012),sigM1_6011,pkCli_5969) <> true) then
                                                        0
                                                    else
                                                        {7459}let (=OpenSecureChannelRequest,=pkCli_5969,Nc_6013: bitstring) = m1_6012 in
                                                        {7460}new Ns_6014: bitstring;
                                                        {7461}new ST_6015: bitstring;
                                                        {7462}new TTL_6016: bitstring;
                                                        {7463}let m2_6017: bitstring = (OpenSecureChannelResponse,Ns_6014,ST_6015,TTL_6016) in
                                                        {7464}event beginSrv(Sess_5018,Cli_5016,Ns_6014);
                                                        {7465}out(c, (m2_6017,sign(h(m2_6017),skSess_5966)));
                                                        {7466}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7467}event endSrv(Cli_5016,Sess_5018,Nc_6013)
                                        )
                                        else
                                            {7468}let pkDisco_6018: bitstring = fail-any in
                                            {7469}in(c, (=pkCli_5969,em1_6019: bitstring,sigM1_6020: bitstring));
                                            {7470}let m1_6021: bitstring = em1_6019 in
                                            {7471}if (verify(h(m1_6021),sigM1_6020,pkCli_5969) <> true) then
                                                0
                                            else
                                                {7472}let (=OpenSecureChannelRequest,=pkCli_5969,Nc_6022: bitstring) = m1_6021 in
                                                {7473}new Ns_6023: bitstring;
                                                {7474}new ST_6024: bitstring;
                                                {7475}new TTL_6025: bitstring;
                                                {7476}let m2_6026: bitstring = (OpenSecureChannelResponse,Ns_6023,ST_6024,TTL_6025) in
                                                {7477}event beginSrv(Sess_5018,Cli_5016,Ns_6023);
                                                {7478}out(c, (m2_6026,sign(h(m2_6026),skSess_5966)));
                                                {7479}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {7480}event endSrv(Cli_5016,Sess_5018,Nc_6022)
                                )
                                else
                                    {7481}let pkDisco_6027: bitstring = fail-any in
                                    {7482}in(c, (=pkCli_5969,em1_6028: bitstring,sigM1_6029: bitstring));
                                    {7483}let m1_6030: bitstring = em1_6028 in
                                    {7484}if (verify(h(m1_6030),sigM1_6029,pkCli_5969) <> true) then
                                        0
                                    else
                                        {7485}let (=OpenSecureChannelRequest,=pkCli_5969,Nc_6031: bitstring) = m1_6030 in
                                        {7486}new Ns_6032: bitstring;
                                        {7487}new ST_6033: bitstring;
                                        {7488}new TTL_6034: bitstring;
                                        {7489}let m2_6035: bitstring = (OpenSecureChannelResponse,Ns_6032,ST_6033,TTL_6034) in
                                        {7490}event beginSrv(Sess_5018,Cli_5016,Ns_6032);
                                        {7491}out(c, (m2_6035,sign(h(m2_6035),skSess_5966)));
                                        {7492}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {7493}event endSrv(Cli_5016,Sess_5018,Nc_6031)
                            )
                            else
                                {7494}let v_6036: bool = (Cli_5016 = B) in
                                (
                                    {7495}if v_6036 then
                                    (
                                        {7496}let pkCli_6037: bitstring = pub(skB) in
                                        {7497}let v_6038: bool = (Disco_5017 = A) in
                                        (
                                            {7498}if v_6038 then
                                            (
                                                {7499}let pkDisco_6039: bitstring = pub(skA) in
                                                {7500}in(c, (=pkCli_6037,em1_6040: bitstring,sigM1_6041: bitstring));
                                                {7501}let m1_6042: bitstring = em1_6040 in
                                                {7502}if (verify(h(m1_6042),sigM1_6041,pkCli_6037) <> true) then
                                                    0
                                                else
                                                    {7503}let (=OpenSecureChannelRequest,=pkCli_6037,Nc_6043: bitstring) = m1_6042 in
                                                    {7504}new Ns_6044: bitstring;
                                                    {7505}new ST_6045: bitstring;
                                                    {7506}new TTL_6046: bitstring;
                                                    {7507}let m2_6047: bitstring = (OpenSecureChannelResponse,Ns_6044,ST_6045,TTL_6046) in
                                                    {7508}event beginSrv(Sess_5018,Cli_5016,Ns_6044);
                                                    {7509}out(c, (m2_6047,sign(h(m2_6047),skSess_5966)));
                                                    {7510}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7511}event endSrv(Cli_5016,Sess_5018,Nc_6043)
                                            )
                                            else
                                                {7512}let v_6048: bool = (Disco_5017 = B) in
                                                (
                                                    {7513}if v_6048 then
                                                    (
                                                        {7514}let pkDisco_6049: bitstring = pub(skB) in
                                                        {7515}in(c, (=pkCli_6037,em1_6050: bitstring,sigM1_6051: bitstring));
                                                        {7516}let m1_6052: bitstring = em1_6050 in
                                                        {7517}if (verify(h(m1_6052),sigM1_6051,pkCli_6037) <> true) then
                                                            0
                                                        else
                                                            {7518}let (=OpenSecureChannelRequest,=pkCli_6037,Nc_6053: bitstring) = m1_6052 in
                                                            {7519}new Ns_6054: bitstring;
                                                            {7520}new ST_6055: bitstring;
                                                            {7521}new TTL_6056: bitstring;
                                                            {7522}let m2_6057: bitstring = (OpenSecureChannelResponse,Ns_6054,ST_6055,TTL_6056) in
                                                            {7523}event beginSrv(Sess_5018,Cli_5016,Ns_6054);
                                                            {7524}out(c, (m2_6057,sign(h(m2_6057),skSess_5966)));
                                                            {7525}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7526}event endSrv(Cli_5016,Sess_5018,Nc_6053)
                                                    )
                                                    else
                                                        {7527}let v_6058: bool = (Disco_5017 = C) in
                                                        (
                                                            {7528}if v_6058 then
                                                            (
                                                                {7529}let pkDisco_6059: bitstring = pub(skC) in
                                                                {7530}in(c, (=pkCli_6037,em1_6060: bitstring,sigM1_6061: bitstring));
                                                                {7531}let m1_6062: bitstring = em1_6060 in
                                                                {7532}if (verify(h(m1_6062),sigM1_6061,pkCli_6037) <> true) then
                                                                    0
                                                                else
                                                                    {7533}let (=OpenSecureChannelRequest,=pkCli_6037,Nc_6063: bitstring) = m1_6062 in
                                                                    {7534}new Ns_6064: bitstring;
                                                                    {7535}new ST_6065: bitstring;
                                                                    {7536}new TTL_6066: bitstring;
                                                                    {7537}let m2_6067: bitstring = (OpenSecureChannelResponse,Ns_6064,ST_6065,TTL_6066) in
                                                                    {7538}event beginSrv(Sess_5018,Cli_5016,Ns_6064);
                                                                    {7539}out(c, (m2_6067,sign(h(m2_6067),skSess_5966)));
                                                                    {7540}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7541}event endSrv(Cli_5016,Sess_5018,Nc_6063)
                                                            )
                                                            else
                                                                {7542}let pkDisco_6068: bitstring = pub(sk(Disco_5017)) in
                                                                {7543}in(c, (=pkCli_6037,em1_6069: bitstring,sigM1_6070: bitstring));
                                                                {7544}let m1_6071: bitstring = em1_6069 in
                                                                {7545}if (verify(h(m1_6071),sigM1_6070,pkCli_6037) <> true) then
                                                                    0
                                                                else
                                                                    {7546}let (=OpenSecureChannelRequest,=pkCli_6037,Nc_6072: bitstring) = m1_6071 in
                                                                    {7547}new Ns_6073: bitstring;
                                                                    {7548}new ST_6074: bitstring;
                                                                    {7549}new TTL_6075: bitstring;
                                                                    {7550}let m2_6076: bitstring = (OpenSecureChannelResponse,Ns_6073,ST_6074,TTL_6075) in
                                                                    {7551}event beginSrv(Sess_5018,Cli_5016,Ns_6073);
                                                                    {7552}out(c, (m2_6076,sign(h(m2_6076),skSess_5966)));
                                                                    {7553}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7554}event endSrv(Cli_5016,Sess_5018,Nc_6072)
                                                        )
                                                        else
                                                            {7555}let pkDisco_6077: bitstring = fail-any in
                                                            {7556}in(c, (=pkCli_6037,em1_6078: bitstring,sigM1_6079: bitstring));
                                                            {7557}let m1_6080: bitstring = em1_6078 in
                                                            {7558}if (verify(h(m1_6080),sigM1_6079,pkCli_6037) <> true) then
                                                                0
                                                            else
                                                                {7559}let (=OpenSecureChannelRequest,=pkCli_6037,Nc_6081: bitstring) = m1_6080 in
                                                                {7560}new Ns_6082: bitstring;
                                                                {7561}new ST_6083: bitstring;
                                                                {7562}new TTL_6084: bitstring;
                                                                {7563}let m2_6085: bitstring = (OpenSecureChannelResponse,Ns_6082,ST_6083,TTL_6084) in
                                                                {7564}event beginSrv(Sess_5018,Cli_5016,Ns_6082);
                                                                {7565}out(c, (m2_6085,sign(h(m2_6085),skSess_5966)));
                                                                {7566}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7567}event endSrv(Cli_5016,Sess_5018,Nc_6081)
                                                )
                                                else
                                                    {7568}let pkDisco_6086: bitstring = fail-any in
                                                    {7569}in(c, (=pkCli_6037,em1_6087: bitstring,sigM1_6088: bitstring));
                                                    {7570}let m1_6089: bitstring = em1_6087 in
                                                    {7571}if (verify(h(m1_6089),sigM1_6088,pkCli_6037) <> true) then
                                                        0
                                                    else
                                                        {7572}let (=OpenSecureChannelRequest,=pkCli_6037,Nc_6090: bitstring) = m1_6089 in
                                                        {7573}new Ns_6091: bitstring;
                                                        {7574}new ST_6092: bitstring;
                                                        {7575}new TTL_6093: bitstring;
                                                        {7576}let m2_6094: bitstring = (OpenSecureChannelResponse,Ns_6091,ST_6092,TTL_6093) in
                                                        {7577}event beginSrv(Sess_5018,Cli_5016,Ns_6091);
                                                        {7578}out(c, (m2_6094,sign(h(m2_6094),skSess_5966)));
                                                        {7579}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7580}event endSrv(Cli_5016,Sess_5018,Nc_6090)
                                        )
                                        else
                                            {7581}let pkDisco_6095: bitstring = fail-any in
                                            {7582}in(c, (=pkCli_6037,em1_6096: bitstring,sigM1_6097: bitstring));
                                            {7583}let m1_6098: bitstring = em1_6096 in
                                            {7584}if (verify(h(m1_6098),sigM1_6097,pkCli_6037) <> true) then
                                                0
                                            else
                                                {7585}let (=OpenSecureChannelRequest,=pkCli_6037,Nc_6099: bitstring) = m1_6098 in
                                                {7586}new Ns_6100: bitstring;
                                                {7587}new ST_6101: bitstring;
                                                {7588}new TTL_6102: bitstring;
                                                {7589}let m2_6103: bitstring = (OpenSecureChannelResponse,Ns_6100,ST_6101,TTL_6102) in
                                                {7590}event beginSrv(Sess_5018,Cli_5016,Ns_6100);
                                                {7591}out(c, (m2_6103,sign(h(m2_6103),skSess_5966)));
                                                {7592}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {7593}event endSrv(Cli_5016,Sess_5018,Nc_6099)
                                    )
                                    else
                                        {7594}let v_6104: bool = (Cli_5016 = C) in
                                        (
                                            {7595}if v_6104 then
                                            (
                                                {7596}let pkCli_6105: bitstring = pub(skC) in
                                                {7597}let v_6106: bool = (Disco_5017 = A) in
                                                (
                                                    {7598}if v_6106 then
                                                    (
                                                        {7599}let pkDisco_6107: bitstring = pub(skA) in
                                                        {7600}in(c, (=pkCli_6105,em1_6108: bitstring,sigM1_6109: bitstring));
                                                        {7601}let m1_6110: bitstring = em1_6108 in
                                                        {7602}if (verify(h(m1_6110),sigM1_6109,pkCli_6105) <> true) then
                                                            0
                                                        else
                                                            {7603}let (=OpenSecureChannelRequest,=pkCli_6105,Nc_6111: bitstring) = m1_6110 in
                                                            {7604}new Ns_6112: bitstring;
                                                            {7605}new ST_6113: bitstring;
                                                            {7606}new TTL_6114: bitstring;
                                                            {7607}let m2_6115: bitstring = (OpenSecureChannelResponse,Ns_6112,ST_6113,TTL_6114) in
                                                            {7608}event beginSrv(Sess_5018,Cli_5016,Ns_6112);
                                                            {7609}out(c, (m2_6115,sign(h(m2_6115),skSess_5966)));
                                                            {7610}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7611}event endSrv(Cli_5016,Sess_5018,Nc_6111)
                                                    )
                                                    else
                                                        {7612}let v_6116: bool = (Disco_5017 = B) in
                                                        (
                                                            {7613}if v_6116 then
                                                            (
                                                                {7614}let pkDisco_6117: bitstring = pub(skB) in
                                                                {7615}in(c, (=pkCli_6105,em1_6118: bitstring,sigM1_6119: bitstring));
                                                                {7616}let m1_6120: bitstring = em1_6118 in
                                                                {7617}if (verify(h(m1_6120),sigM1_6119,pkCli_6105) <> true) then
                                                                    0
                                                                else
                                                                    {7618}let (=OpenSecureChannelRequest,=pkCli_6105,Nc_6121: bitstring) = m1_6120 in
                                                                    {7619}new Ns_6122: bitstring;
                                                                    {7620}new ST_6123: bitstring;
                                                                    {7621}new TTL_6124: bitstring;
                                                                    {7622}let m2_6125: bitstring = (OpenSecureChannelResponse,Ns_6122,ST_6123,TTL_6124) in
                                                                    {7623}event beginSrv(Sess_5018,Cli_5016,Ns_6122);
                                                                    {7624}out(c, (m2_6125,sign(h(m2_6125),skSess_5966)));
                                                                    {7625}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7626}event endSrv(Cli_5016,Sess_5018,Nc_6121)
                                                            )
                                                            else
                                                                {7627}let v_6126: bool = (Disco_5017 = C) in
                                                                (
                                                                    {7628}if v_6126 then
                                                                    (
                                                                        {7629}let pkDisco_6127: bitstring = pub(skC) in
                                                                        {7630}in(c, (=pkCli_6105,em1_6128: bitstring,sigM1_6129: bitstring));
                                                                        {7631}let m1_6130: bitstring = em1_6128 in
                                                                        {7632}if (verify(h(m1_6130),sigM1_6129,pkCli_6105) <> true) then
                                                                            0
                                                                        else
                                                                            {7633}let (=OpenSecureChannelRequest,=pkCli_6105,Nc_6131: bitstring) = m1_6130 in
                                                                            {7634}new Ns_6132: bitstring;
                                                                            {7635}new ST_6133: bitstring;
                                                                            {7636}new TTL_6134: bitstring;
                                                                            {7637}let m2_6135: bitstring = (OpenSecureChannelResponse,Ns_6132,ST_6133,TTL_6134) in
                                                                            {7638}event beginSrv(Sess_5018,Cli_5016,Ns_6132);
                                                                            {7639}out(c, (m2_6135,sign(h(m2_6135),skSess_5966)));
                                                                            {7640}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {7641}event endSrv(Cli_5016,Sess_5018,Nc_6131)
                                                                    )
                                                                    else
                                                                        {7642}let pkDisco_6136: bitstring = pub(sk(Disco_5017)) in
                                                                        {7643}in(c, (=pkCli_6105,em1_6137: bitstring,sigM1_6138: bitstring));
                                                                        {7644}let m1_6139: bitstring = em1_6137 in
                                                                        {7645}if (verify(h(m1_6139),sigM1_6138,pkCli_6105) <> true) then
                                                                            0
                                                                        else
                                                                            {7646}let (=OpenSecureChannelRequest,=pkCli_6105,Nc_6140: bitstring) = m1_6139 in
                                                                            {7647}new Ns_6141: bitstring;
                                                                            {7648}new ST_6142: bitstring;
                                                                            {7649}new TTL_6143: bitstring;
                                                                            {7650}let m2_6144: bitstring = (OpenSecureChannelResponse,Ns_6141,ST_6142,TTL_6143) in
                                                                            {7651}event beginSrv(Sess_5018,Cli_5016,Ns_6141);
                                                                            {7652}out(c, (m2_6144,sign(h(m2_6144),skSess_5966)));
                                                                            {7653}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {7654}event endSrv(Cli_5016,Sess_5018,Nc_6140)
                                                                )
                                                                else
                                                                    {7655}let pkDisco_6145: bitstring = fail-any in
                                                                    {7656}in(c, (=pkCli_6105,em1_6146: bitstring,sigM1_6147: bitstring));
                                                                    {7657}let m1_6148: bitstring = em1_6146 in
                                                                    {7658}if (verify(h(m1_6148),sigM1_6147,pkCli_6105) <> true) then
                                                                        0
                                                                    else
                                                                        {7659}let (=OpenSecureChannelRequest,=pkCli_6105,Nc_6149: bitstring) = m1_6148 in
                                                                        {7660}new Ns_6150: bitstring;
                                                                        {7661}new ST_6151: bitstring;
                                                                        {7662}new TTL_6152: bitstring;
                                                                        {7663}let m2_6153: bitstring = (OpenSecureChannelResponse,Ns_6150,ST_6151,TTL_6152) in
                                                                        {7664}event beginSrv(Sess_5018,Cli_5016,Ns_6150);
                                                                        {7665}out(c, (m2_6153,sign(h(m2_6153),skSess_5966)));
                                                                        {7666}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {7667}event endSrv(Cli_5016,Sess_5018,Nc_6149)
                                                        )
                                                        else
                                                            {7668}let pkDisco_6154: bitstring = fail-any in
                                                            {7669}in(c, (=pkCli_6105,em1_6155: bitstring,sigM1_6156: bitstring));
                                                            {7670}let m1_6157: bitstring = em1_6155 in
                                                            {7671}if (verify(h(m1_6157),sigM1_6156,pkCli_6105) <> true) then
                                                                0
                                                            else
                                                                {7672}let (=OpenSecureChannelRequest,=pkCli_6105,Nc_6158: bitstring) = m1_6157 in
                                                                {7673}new Ns_6159: bitstring;
                                                                {7674}new ST_6160: bitstring;
                                                                {7675}new TTL_6161: bitstring;
                                                                {7676}let m2_6162: bitstring = (OpenSecureChannelResponse,Ns_6159,ST_6160,TTL_6161) in
                                                                {7677}event beginSrv(Sess_5018,Cli_5016,Ns_6159);
                                                                {7678}out(c, (m2_6162,sign(h(m2_6162),skSess_5966)));
                                                                {7679}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7680}event endSrv(Cli_5016,Sess_5018,Nc_6158)
                                                )
                                                else
                                                    {7681}let pkDisco_6163: bitstring = fail-any in
                                                    {7682}in(c, (=pkCli_6105,em1_6164: bitstring,sigM1_6165: bitstring));
                                                    {7683}let m1_6166: bitstring = em1_6164 in
                                                    {7684}if (verify(h(m1_6166),sigM1_6165,pkCli_6105) <> true) then
                                                        0
                                                    else
                                                        {7685}let (=OpenSecureChannelRequest,=pkCli_6105,Nc_6167: bitstring) = m1_6166 in
                                                        {7686}new Ns_6168: bitstring;
                                                        {7687}new ST_6169: bitstring;
                                                        {7688}new TTL_6170: bitstring;
                                                        {7689}let m2_6171: bitstring = (OpenSecureChannelResponse,Ns_6168,ST_6169,TTL_6170) in
                                                        {7690}event beginSrv(Sess_5018,Cli_5016,Ns_6168);
                                                        {7691}out(c, (m2_6171,sign(h(m2_6171),skSess_5966)));
                                                        {7692}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7693}event endSrv(Cli_5016,Sess_5018,Nc_6167)
                                            )
                                            else
                                                {7694}let pkCli_6172: bitstring = pub(sk(Cli_5016)) in
                                                {7695}let v_6173: bool = (Disco_5017 = A) in
                                                (
                                                    {7696}if v_6173 then
                                                    (
                                                        {7697}let pkDisco_6174: bitstring = pub(skA) in
                                                        {7698}in(c, (=pkCli_6172,em1_6175: bitstring,sigM1_6176: bitstring));
                                                        {7699}let m1_6177: bitstring = em1_6175 in
                                                        {7700}if (verify(h(m1_6177),sigM1_6176,pkCli_6172) <> true) then
                                                            0
                                                        else
                                                            {7701}let (=OpenSecureChannelRequest,=pkCli_6172,Nc_6178: bitstring) = m1_6177 in
                                                            {7702}new Ns_6179: bitstring;
                                                            {7703}new ST_6180: bitstring;
                                                            {7704}new TTL_6181: bitstring;
                                                            {7705}let m2_6182: bitstring = (OpenSecureChannelResponse,Ns_6179,ST_6180,TTL_6181) in
                                                            {7706}event beginSrv(Sess_5018,Cli_5016,Ns_6179);
                                                            {7707}out(c, (m2_6182,sign(h(m2_6182),skSess_5966)));
                                                            {7708}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7709}event endSrv(Cli_5016,Sess_5018,Nc_6178)
                                                    )
                                                    else
                                                        {7710}let v_6183: bool = (Disco_5017 = B) in
                                                        (
                                                            {7711}if v_6183 then
                                                            (
                                                                {7712}let pkDisco_6184: bitstring = pub(skB) in
                                                                {7713}in(c, (=pkCli_6172,em1_6185: bitstring,sigM1_6186: bitstring));
                                                                {7714}let m1_6187: bitstring = em1_6185 in
                                                                {7715}if (verify(h(m1_6187),sigM1_6186,pkCli_6172) <> true) then
                                                                    0
                                                                else
                                                                    {7716}let (=OpenSecureChannelRequest,=pkCli_6172,Nc_6188: bitstring) = m1_6187 in
                                                                    {7717}new Ns_6189: bitstring;
                                                                    {7718}new ST_6190: bitstring;
                                                                    {7719}new TTL_6191: bitstring;
                                                                    {7720}let m2_6192: bitstring = (OpenSecureChannelResponse,Ns_6189,ST_6190,TTL_6191) in
                                                                    {7721}event beginSrv(Sess_5018,Cli_5016,Ns_6189);
                                                                    {7722}out(c, (m2_6192,sign(h(m2_6192),skSess_5966)));
                                                                    {7723}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7724}event endSrv(Cli_5016,Sess_5018,Nc_6188)
                                                            )
                                                            else
                                                                {7725}let v_6193: bool = (Disco_5017 = C) in
                                                                (
                                                                    {7726}if v_6193 then
                                                                    (
                                                                        {7727}let pkDisco_6194: bitstring = pub(skC) in
                                                                        {7728}in(c, (=pkCli_6172,em1_6195: bitstring,sigM1_6196: bitstring));
                                                                        {7729}let m1_6197: bitstring = em1_6195 in
                                                                        {7730}if (verify(h(m1_6197),sigM1_6196,pkCli_6172) <> true) then
                                                                            0
                                                                        else
                                                                            {7731}let (=OpenSecureChannelRequest,=pkCli_6172,Nc_6198: bitstring) = m1_6197 in
                                                                            {7732}new Ns_6199: bitstring;
                                                                            {7733}new ST_6200: bitstring;
                                                                            {7734}new TTL_6201: bitstring;
                                                                            {7735}let m2_6202: bitstring = (OpenSecureChannelResponse,Ns_6199,ST_6200,TTL_6201) in
                                                                            {7736}event beginSrv(Sess_5018,Cli_5016,Ns_6199);
                                                                            {7737}out(c, (m2_6202,sign(h(m2_6202),skSess_5966)));
                                                                            {7738}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {7739}event endSrv(Cli_5016,Sess_5018,Nc_6198)
                                                                    )
                                                                    else
                                                                        {7740}let pkDisco_6203: bitstring = pub(sk(Disco_5017)) in
                                                                        {7741}in(c, (=pkCli_6172,em1_6204: bitstring,sigM1_6205: bitstring));
                                                                        {7742}let m1_6206: bitstring = em1_6204 in
                                                                        {7743}if (verify(h(m1_6206),sigM1_6205,pkCli_6172) <> true) then
                                                                            0
                                                                        else
                                                                            {7744}let (=OpenSecureChannelRequest,=pkCli_6172,Nc_6207: bitstring) = m1_6206 in
                                                                            {7745}new Ns_6208: bitstring;
                                                                            {7746}new ST_6209: bitstring;
                                                                            {7747}new TTL_6210: bitstring;
                                                                            {7748}let m2_6211: bitstring = (OpenSecureChannelResponse,Ns_6208,ST_6209,TTL_6210) in
                                                                            {7749}event beginSrv(Sess_5018,Cli_5016,Ns_6208);
                                                                            {7750}out(c, (m2_6211,sign(h(m2_6211),skSess_5966)));
                                                                            {7751}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {7752}event endSrv(Cli_5016,Sess_5018,Nc_6207)
                                                                )
                                                                else
                                                                    {7753}let pkDisco_6212: bitstring = fail-any in
                                                                    {7754}in(c, (=pkCli_6172,em1_6213: bitstring,sigM1_6214: bitstring));
                                                                    {7755}let m1_6215: bitstring = em1_6213 in
                                                                    {7756}if (verify(h(m1_6215),sigM1_6214,pkCli_6172) <> true) then
                                                                        0
                                                                    else
                                                                        {7757}let (=OpenSecureChannelRequest,=pkCli_6172,Nc_6216: bitstring) = m1_6215 in
                                                                        {7758}new Ns_6217: bitstring;
                                                                        {7759}new ST_6218: bitstring;
                                                                        {7760}new TTL_6219: bitstring;
                                                                        {7761}let m2_6220: bitstring = (OpenSecureChannelResponse,Ns_6217,ST_6218,TTL_6219) in
                                                                        {7762}event beginSrv(Sess_5018,Cli_5016,Ns_6217);
                                                                        {7763}out(c, (m2_6220,sign(h(m2_6220),skSess_5966)));
                                                                        {7764}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {7765}event endSrv(Cli_5016,Sess_5018,Nc_6216)
                                                        )
                                                        else
                                                            {7766}let pkDisco_6221: bitstring = fail-any in
                                                            {7767}in(c, (=pkCli_6172,em1_6222: bitstring,sigM1_6223: bitstring));
                                                            {7768}let m1_6224: bitstring = em1_6222 in
                                                            {7769}if (verify(h(m1_6224),sigM1_6223,pkCli_6172) <> true) then
                                                                0
                                                            else
                                                                {7770}let (=OpenSecureChannelRequest,=pkCli_6172,Nc_6225: bitstring) = m1_6224 in
                                                                {7771}new Ns_6226: bitstring;
                                                                {7772}new ST_6227: bitstring;
                                                                {7773}new TTL_6228: bitstring;
                                                                {7774}let m2_6229: bitstring = (OpenSecureChannelResponse,Ns_6226,ST_6227,TTL_6228) in
                                                                {7775}event beginSrv(Sess_5018,Cli_5016,Ns_6226);
                                                                {7776}out(c, (m2_6229,sign(h(m2_6229),skSess_5966)));
                                                                {7777}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7778}event endSrv(Cli_5016,Sess_5018,Nc_6225)
                                                )
                                                else
                                                    {7779}let pkDisco_6230: bitstring = fail-any in
                                                    {7780}in(c, (=pkCli_6172,em1_6231: bitstring,sigM1_6232: bitstring));
                                                    {7781}let m1_6233: bitstring = em1_6231 in
                                                    {7782}if (verify(h(m1_6233),sigM1_6232,pkCli_6172) <> true) then
                                                        0
                                                    else
                                                        {7783}let (=OpenSecureChannelRequest,=pkCli_6172,Nc_6234: bitstring) = m1_6233 in
                                                        {7784}new Ns_6235: bitstring;
                                                        {7785}new ST_6236: bitstring;
                                                        {7786}new TTL_6237: bitstring;
                                                        {7787}let m2_6238: bitstring = (OpenSecureChannelResponse,Ns_6235,ST_6236,TTL_6237) in
                                                        {7788}event beginSrv(Sess_5018,Cli_5016,Ns_6235);
                                                        {7789}out(c, (m2_6238,sign(h(m2_6238),skSess_5966)));
                                                        {7790}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7791}event endSrv(Cli_5016,Sess_5018,Nc_6234)
                                        )
                                        else
                                            {7792}let pkCli_6239: bitstring = fail-any in
                                            {7793}let v_6240: bool = (Disco_5017 = A) in
                                            (
                                                {7794}if v_6240 then
                                                (
                                                    {7795}let pkDisco_6241: bitstring = pub(skA) in
                                                    {7796}in(c, (=pkCli_6239,em1_6242: bitstring,sigM1_6243: bitstring));
                                                    {7797}let m1_6244: bitstring = em1_6242 in
                                                    {7798}if (verify(h(m1_6244),sigM1_6243,pkCli_6239) <> true) then
                                                        0
                                                    else
                                                        {7799}let (=OpenSecureChannelRequest,=pkCli_6239,Nc_6245: bitstring) = m1_6244 in
                                                        {7800}new Ns_6246: bitstring;
                                                        {7801}new ST_6247: bitstring;
                                                        {7802}new TTL_6248: bitstring;
                                                        {7803}let m2_6249: bitstring = (OpenSecureChannelResponse,Ns_6246,ST_6247,TTL_6248) in
                                                        {7804}event beginSrv(Sess_5018,Cli_5016,Ns_6246);
                                                        {7805}out(c, (m2_6249,sign(h(m2_6249),skSess_5966)));
                                                        {7806}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7807}event endSrv(Cli_5016,Sess_5018,Nc_6245)
                                                )
                                                else
                                                    {7808}let v_6250: bool = (Disco_5017 = B) in
                                                    (
                                                        {7809}if v_6250 then
                                                        (
                                                            {7810}let pkDisco_6251: bitstring = pub(skB) in
                                                            {7811}in(c, (=pkCli_6239,em1_6252: bitstring,sigM1_6253: bitstring));
                                                            {7812}let m1_6254: bitstring = em1_6252 in
                                                            {7813}if (verify(h(m1_6254),sigM1_6253,pkCli_6239) <> true) then
                                                                0
                                                            else
                                                                {7814}let (=OpenSecureChannelRequest,=pkCli_6239,Nc_6255: bitstring) = m1_6254 in
                                                                {7815}new Ns_6256: bitstring;
                                                                {7816}new ST_6257: bitstring;
                                                                {7817}new TTL_6258: bitstring;
                                                                {7818}let m2_6259: bitstring = (OpenSecureChannelResponse,Ns_6256,ST_6257,TTL_6258) in
                                                                {7819}event beginSrv(Sess_5018,Cli_5016,Ns_6256);
                                                                {7820}out(c, (m2_6259,sign(h(m2_6259),skSess_5966)));
                                                                {7821}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7822}event endSrv(Cli_5016,Sess_5018,Nc_6255)
                                                        )
                                                        else
                                                            {7823}let v_6260: bool = (Disco_5017 = C) in
                                                            (
                                                                {7824}if v_6260 then
                                                                (
                                                                    {7825}let pkDisco_6261: bitstring = pub(skC) in
                                                                    {7826}in(c, (=pkCli_6239,em1_6262: bitstring,sigM1_6263: bitstring));
                                                                    {7827}let m1_6264: bitstring = em1_6262 in
                                                                    {7828}if (verify(h(m1_6264),sigM1_6263,pkCli_6239) <> true) then
                                                                        0
                                                                    else
                                                                        {7829}let (=OpenSecureChannelRequest,=pkCli_6239,Nc_6265: bitstring) = m1_6264 in
                                                                        {7830}new Ns_6266: bitstring;
                                                                        {7831}new ST_6267: bitstring;
                                                                        {7832}new TTL_6268: bitstring;
                                                                        {7833}let m2_6269: bitstring = (OpenSecureChannelResponse,Ns_6266,ST_6267,TTL_6268) in
                                                                        {7834}event beginSrv(Sess_5018,Cli_5016,Ns_6266);
                                                                        {7835}out(c, (m2_6269,sign(h(m2_6269),skSess_5966)));
                                                                        {7836}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {7837}event endSrv(Cli_5016,Sess_5018,Nc_6265)
                                                                )
                                                                else
                                                                    {7838}let pkDisco_6270: bitstring = pub(sk(Disco_5017)) in
                                                                    {7839}in(c, (=pkCli_6239,em1_6271: bitstring,sigM1_6272: bitstring));
                                                                    {7840}let m1_6273: bitstring = em1_6271 in
                                                                    {7841}if (verify(h(m1_6273),sigM1_6272,pkCli_6239) <> true) then
                                                                        0
                                                                    else
                                                                        {7842}let (=OpenSecureChannelRequest,=pkCli_6239,Nc_6274: bitstring) = m1_6273 in
                                                                        {7843}new Ns_6275: bitstring;
                                                                        {7844}new ST_6276: bitstring;
                                                                        {7845}new TTL_6277: bitstring;
                                                                        {7846}let m2_6278: bitstring = (OpenSecureChannelResponse,Ns_6275,ST_6276,TTL_6277) in
                                                                        {7847}event beginSrv(Sess_5018,Cli_5016,Ns_6275);
                                                                        {7848}out(c, (m2_6278,sign(h(m2_6278),skSess_5966)));
                                                                        {7849}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {7850}event endSrv(Cli_5016,Sess_5018,Nc_6274)
                                                            )
                                                            else
                                                                {7851}let pkDisco_6279: bitstring = fail-any in
                                                                {7852}in(c, (=pkCli_6239,em1_6280: bitstring,sigM1_6281: bitstring));
                                                                {7853}let m1_6282: bitstring = em1_6280 in
                                                                {7854}if (verify(h(m1_6282),sigM1_6281,pkCli_6239) <> true) then
                                                                    0
                                                                else
                                                                    {7855}let (=OpenSecureChannelRequest,=pkCli_6239,Nc_6283: bitstring) = m1_6282 in
                                                                    {7856}new Ns_6284: bitstring;
                                                                    {7857}new ST_6285: bitstring;
                                                                    {7858}new TTL_6286: bitstring;
                                                                    {7859}let m2_6287: bitstring = (OpenSecureChannelResponse,Ns_6284,ST_6285,TTL_6286) in
                                                                    {7860}event beginSrv(Sess_5018,Cli_5016,Ns_6284);
                                                                    {7861}out(c, (m2_6287,sign(h(m2_6287),skSess_5966)));
                                                                    {7862}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {7863}event endSrv(Cli_5016,Sess_5018,Nc_6283)
                                                    )
                                                    else
                                                        {7864}let pkDisco_6288: bitstring = fail-any in
                                                        {7865}in(c, (=pkCli_6239,em1_6289: bitstring,sigM1_6290: bitstring));
                                                        {7866}let m1_6291: bitstring = em1_6289 in
                                                        {7867}if (verify(h(m1_6291),sigM1_6290,pkCli_6239) <> true) then
                                                            0
                                                        else
                                                            {7868}let (=OpenSecureChannelRequest,=pkCli_6239,Nc_6292: bitstring) = m1_6291 in
                                                            {7869}new Ns_6293: bitstring;
                                                            {7870}new ST_6294: bitstring;
                                                            {7871}new TTL_6295: bitstring;
                                                            {7872}let m2_6296: bitstring = (OpenSecureChannelResponse,Ns_6293,ST_6294,TTL_6295) in
                                                            {7873}event beginSrv(Sess_5018,Cli_5016,Ns_6293);
                                                            {7874}out(c, (m2_6296,sign(h(m2_6296),skSess_5966)));
                                                            {7875}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7876}event endSrv(Cli_5016,Sess_5018,Nc_6292)
                                            )
                                            else
                                                {7877}let pkDisco_6297: bitstring = fail-any in
                                                {7878}in(c, (=pkCli_6239,em1_6298: bitstring,sigM1_6299: bitstring));
                                                {7879}let m1_6300: bitstring = em1_6298 in
                                                {7880}if (verify(h(m1_6300),sigM1_6299,pkCli_6239) <> true) then
                                                    0
                                                else
                                                    {7881}let (=OpenSecureChannelRequest,=pkCli_6239,Nc_6301: bitstring) = m1_6300 in
                                                    {7882}new Ns_6302: bitstring;
                                                    {7883}new ST_6303: bitstring;
                                                    {7884}new TTL_6304: bitstring;
                                                    {7885}let m2_6305: bitstring = (OpenSecureChannelResponse,Ns_6302,ST_6303,TTL_6304) in
                                                    {7886}event beginSrv(Sess_5018,Cli_5016,Ns_6302);
                                                    {7887}out(c, (m2_6305,sign(h(m2_6305),skSess_5966)));
                                                    {7888}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7889}event endSrv(Cli_5016,Sess_5018,Nc_6301)
                                )
                                else
                                    {7890}let pkCli_6306: bitstring = fail-any in
                                    {7891}let v_6307: bool = (Disco_5017 = A) in
                                    (
                                        {7892}if v_6307 then
                                        (
                                            {7893}let pkDisco_6308: bitstring = pub(skA) in
                                            {7894}in(c, (=pkCli_6306,em1_6309: bitstring,sigM1_6310: bitstring));
                                            {7895}let m1_6311: bitstring = em1_6309 in
                                            {7896}if (verify(h(m1_6311),sigM1_6310,pkCli_6306) <> true) then
                                                0
                                            else
                                                {7897}let (=OpenSecureChannelRequest,=pkCli_6306,Nc_6312: bitstring) = m1_6311 in
                                                {7898}new Ns_6313: bitstring;
                                                {7899}new ST_6314: bitstring;
                                                {7900}new TTL_6315: bitstring;
                                                {7901}let m2_6316: bitstring = (OpenSecureChannelResponse,Ns_6313,ST_6314,TTL_6315) in
                                                {7902}event beginSrv(Sess_5018,Cli_5016,Ns_6313);
                                                {7903}out(c, (m2_6316,sign(h(m2_6316),skSess_5966)));
                                                {7904}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {7905}event endSrv(Cli_5016,Sess_5018,Nc_6312)
                                        )
                                        else
                                            {7906}let v_6317: bool = (Disco_5017 = B) in
                                            (
                                                {7907}if v_6317 then
                                                (
                                                    {7908}let pkDisco_6318: bitstring = pub(skB) in
                                                    {7909}in(c, (=pkCli_6306,em1_6319: bitstring,sigM1_6320: bitstring));
                                                    {7910}let m1_6321: bitstring = em1_6319 in
                                                    {7911}if (verify(h(m1_6321),sigM1_6320,pkCli_6306) <> true) then
                                                        0
                                                    else
                                                        {7912}let (=OpenSecureChannelRequest,=pkCli_6306,Nc_6322: bitstring) = m1_6321 in
                                                        {7913}new Ns_6323: bitstring;
                                                        {7914}new ST_6324: bitstring;
                                                        {7915}new TTL_6325: bitstring;
                                                        {7916}let m2_6326: bitstring = (OpenSecureChannelResponse,Ns_6323,ST_6324,TTL_6325) in
                                                        {7917}event beginSrv(Sess_5018,Cli_5016,Ns_6323);
                                                        {7918}out(c, (m2_6326,sign(h(m2_6326),skSess_5966)));
                                                        {7919}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {7920}event endSrv(Cli_5016,Sess_5018,Nc_6322)
                                                )
                                                else
                                                    {7921}let v_6327: bool = (Disco_5017 = C) in
                                                    (
                                                        {7922}if v_6327 then
                                                        (
                                                            {7923}let pkDisco_6328: bitstring = pub(skC) in
                                                            {7924}in(c, (=pkCli_6306,em1_6329: bitstring,sigM1_6330: bitstring));
                                                            {7925}let m1_6331: bitstring = em1_6329 in
                                                            {7926}if (verify(h(m1_6331),sigM1_6330,pkCli_6306) <> true) then
                                                                0
                                                            else
                                                                {7927}let (=OpenSecureChannelRequest,=pkCli_6306,Nc_6332: bitstring) = m1_6331 in
                                                                {7928}new Ns_6333: bitstring;
                                                                {7929}new ST_6334: bitstring;
                                                                {7930}new TTL_6335: bitstring;
                                                                {7931}let m2_6336: bitstring = (OpenSecureChannelResponse,Ns_6333,ST_6334,TTL_6335) in
                                                                {7932}event beginSrv(Sess_5018,Cli_5016,Ns_6333);
                                                                {7933}out(c, (m2_6336,sign(h(m2_6336),skSess_5966)));
                                                                {7934}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7935}event endSrv(Cli_5016,Sess_5018,Nc_6332)
                                                        )
                                                        else
                                                            {7936}let pkDisco_6337: bitstring = pub(sk(Disco_5017)) in
                                                            {7937}in(c, (=pkCli_6306,em1_6338: bitstring,sigM1_6339: bitstring));
                                                            {7938}let m1_6340: bitstring = em1_6338 in
                                                            {7939}if (verify(h(m1_6340),sigM1_6339,pkCli_6306) <> true) then
                                                                0
                                                            else
                                                                {7940}let (=OpenSecureChannelRequest,=pkCli_6306,Nc_6341: bitstring) = m1_6340 in
                                                                {7941}new Ns_6342: bitstring;
                                                                {7942}new ST_6343: bitstring;
                                                                {7943}new TTL_6344: bitstring;
                                                                {7944}let m2_6345: bitstring = (OpenSecureChannelResponse,Ns_6342,ST_6343,TTL_6344) in
                                                                {7945}event beginSrv(Sess_5018,Cli_5016,Ns_6342);
                                                                {7946}out(c, (m2_6345,sign(h(m2_6345),skSess_5966)));
                                                                {7947}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {7948}event endSrv(Cli_5016,Sess_5018,Nc_6341)
                                                    )
                                                    else
                                                        {7949}let pkDisco_6346: bitstring = fail-any in
                                                        {7950}in(c, (=pkCli_6306,em1_6347: bitstring,sigM1_6348: bitstring));
                                                        {7951}let m1_6349: bitstring = em1_6347 in
                                                        {7952}if (verify(h(m1_6349),sigM1_6348,pkCli_6306) <> true) then
                                                            0
                                                        else
                                                            {7953}let (=OpenSecureChannelRequest,=pkCli_6306,Nc_6350: bitstring) = m1_6349 in
                                                            {7954}new Ns_6351: bitstring;
                                                            {7955}new ST_6352: bitstring;
                                                            {7956}new TTL_6353: bitstring;
                                                            {7957}let m2_6354: bitstring = (OpenSecureChannelResponse,Ns_6351,ST_6352,TTL_6353) in
                                                            {7958}event beginSrv(Sess_5018,Cli_5016,Ns_6351);
                                                            {7959}out(c, (m2_6354,sign(h(m2_6354),skSess_5966)));
                                                            {7960}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {7961}event endSrv(Cli_5016,Sess_5018,Nc_6350)
                                            )
                                            else
                                                {7962}let pkDisco_6355: bitstring = fail-any in
                                                {7963}in(c, (=pkCli_6306,em1_6356: bitstring,sigM1_6357: bitstring));
                                                {7964}let m1_6358: bitstring = em1_6356 in
                                                {7965}if (verify(h(m1_6358),sigM1_6357,pkCli_6306) <> true) then
                                                    0
                                                else
                                                    {7966}let (=OpenSecureChannelRequest,=pkCli_6306,Nc_6359: bitstring) = m1_6358 in
                                                    {7967}new Ns_6360: bitstring;
                                                    {7968}new ST_6361: bitstring;
                                                    {7969}new TTL_6362: bitstring;
                                                    {7970}let m2_6363: bitstring = (OpenSecureChannelResponse,Ns_6360,ST_6361,TTL_6362) in
                                                    {7971}event beginSrv(Sess_5018,Cli_5016,Ns_6360);
                                                    {7972}out(c, (m2_6363,sign(h(m2_6363),skSess_5966)));
                                                    {7973}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {7974}event endSrv(Cli_5016,Sess_5018,Nc_6359)
                                    )
                                    else
                                        {7975}let pkDisco_6364: bitstring = fail-any in
                                        {7976}in(c, (=pkCli_6306,em1_6365: bitstring,sigM1_6366: bitstring));
                                        {7977}let m1_6367: bitstring = em1_6365 in
                                        {7978}if (verify(h(m1_6367),sigM1_6366,pkCli_6306) <> true) then
                                            0
                                        else
                                            {7979}let (=OpenSecureChannelRequest,=pkCli_6306,Nc_6368: bitstring) = m1_6367 in
                                            {7980}new Ns_6369: bitstring;
                                            {7981}new ST_6370: bitstring;
                                            {7982}new TTL_6371: bitstring;
                                            {7983}let m2_6372: bitstring = (OpenSecureChannelResponse,Ns_6369,ST_6370,TTL_6371) in
                                            {7984}event beginSrv(Sess_5018,Cli_5016,Ns_6369);
                                            {7985}out(c, (m2_6372,sign(h(m2_6372),skSess_5966)));
                                            {7986}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {7987}event endSrv(Cli_5016,Sess_5018,Nc_6368)
                        )
                        else
                            {7988}let pkCli_6373: bitstring = fail-any in
                            {7989}let v_6374: bool = (Disco_5017 = A) in
                            (
                                {7990}if v_6374 then
                                (
                                    {7991}let pkDisco_6375: bitstring = pub(skA) in
                                    {7992}in(c, (=pkCli_6373,em1_6376: bitstring,sigM1_6377: bitstring));
                                    {7993}let m1_6378: bitstring = em1_6376 in
                                    {7994}if (verify(h(m1_6378),sigM1_6377,pkCli_6373) <> true) then
                                        0
                                    else
                                        {7995}let (=OpenSecureChannelRequest,=pkCli_6373,Nc_6379: bitstring) = m1_6378 in
                                        {7996}new Ns_6380: bitstring;
                                        {7997}new ST_6381: bitstring;
                                        {7998}new TTL_6382: bitstring;
                                        {7999}let m2_6383: bitstring = (OpenSecureChannelResponse,Ns_6380,ST_6381,TTL_6382) in
                                        {8000}event beginSrv(Sess_5018,Cli_5016,Ns_6380);
                                        {8001}out(c, (m2_6383,sign(h(m2_6383),skSess_5966)));
                                        {8002}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {8003}event endSrv(Cli_5016,Sess_5018,Nc_6379)
                                )
                                else
                                    {8004}let v_6384: bool = (Disco_5017 = B) in
                                    (
                                        {8005}if v_6384 then
                                        (
                                            {8006}let pkDisco_6385: bitstring = pub(skB) in
                                            {8007}in(c, (=pkCli_6373,em1_6386: bitstring,sigM1_6387: bitstring));
                                            {8008}let m1_6388: bitstring = em1_6386 in
                                            {8009}if (verify(h(m1_6388),sigM1_6387,pkCli_6373) <> true) then
                                                0
                                            else
                                                {8010}let (=OpenSecureChannelRequest,=pkCli_6373,Nc_6389: bitstring) = m1_6388 in
                                                {8011}new Ns_6390: bitstring;
                                                {8012}new ST_6391: bitstring;
                                                {8013}new TTL_6392: bitstring;
                                                {8014}let m2_6393: bitstring = (OpenSecureChannelResponse,Ns_6390,ST_6391,TTL_6392) in
                                                {8015}event beginSrv(Sess_5018,Cli_5016,Ns_6390);
                                                {8016}out(c, (m2_6393,sign(h(m2_6393),skSess_5966)));
                                                {8017}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {8018}event endSrv(Cli_5016,Sess_5018,Nc_6389)
                                        )
                                        else
                                            {8019}let v_6394: bool = (Disco_5017 = C) in
                                            (
                                                {8020}if v_6394 then
                                                (
                                                    {8021}let pkDisco_6395: bitstring = pub(skC) in
                                                    {8022}in(c, (=pkCli_6373,em1_6396: bitstring,sigM1_6397: bitstring));
                                                    {8023}let m1_6398: bitstring = em1_6396 in
                                                    {8024}if (verify(h(m1_6398),sigM1_6397,pkCli_6373) <> true) then
                                                        0
                                                    else
                                                        {8025}let (=OpenSecureChannelRequest,=pkCli_6373,Nc_6399: bitstring) = m1_6398 in
                                                        {8026}new Ns_6400: bitstring;
                                                        {8027}new ST_6401: bitstring;
                                                        {8028}new TTL_6402: bitstring;
                                                        {8029}let m2_6403: bitstring = (OpenSecureChannelResponse,Ns_6400,ST_6401,TTL_6402) in
                                                        {8030}event beginSrv(Sess_5018,Cli_5016,Ns_6400);
                                                        {8031}out(c, (m2_6403,sign(h(m2_6403),skSess_5966)));
                                                        {8032}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8033}event endSrv(Cli_5016,Sess_5018,Nc_6399)
                                                )
                                                else
                                                    {8034}let pkDisco_6404: bitstring = pub(sk(Disco_5017)) in
                                                    {8035}in(c, (=pkCli_6373,em1_6405: bitstring,sigM1_6406: bitstring));
                                                    {8036}let m1_6407: bitstring = em1_6405 in
                                                    {8037}if (verify(h(m1_6407),sigM1_6406,pkCli_6373) <> true) then
                                                        0
                                                    else
                                                        {8038}let (=OpenSecureChannelRequest,=pkCli_6373,Nc_6408: bitstring) = m1_6407 in
                                                        {8039}new Ns_6409: bitstring;
                                                        {8040}new ST_6410: bitstring;
                                                        {8041}new TTL_6411: bitstring;
                                                        {8042}let m2_6412: bitstring = (OpenSecureChannelResponse,Ns_6409,ST_6410,TTL_6411) in
                                                        {8043}event beginSrv(Sess_5018,Cli_5016,Ns_6409);
                                                        {8044}out(c, (m2_6412,sign(h(m2_6412),skSess_5966)));
                                                        {8045}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8046}event endSrv(Cli_5016,Sess_5018,Nc_6408)
                                            )
                                            else
                                                {8047}let pkDisco_6413: bitstring = fail-any in
                                                {8048}in(c, (=pkCli_6373,em1_6414: bitstring,sigM1_6415: bitstring));
                                                {8049}let m1_6416: bitstring = em1_6414 in
                                                {8050}if (verify(h(m1_6416),sigM1_6415,pkCli_6373) <> true) then
                                                    0
                                                else
                                                    {8051}let (=OpenSecureChannelRequest,=pkCli_6373,Nc_6417: bitstring) = m1_6416 in
                                                    {8052}new Ns_6418: bitstring;
                                                    {8053}new ST_6419: bitstring;
                                                    {8054}new TTL_6420: bitstring;
                                                    {8055}let m2_6421: bitstring = (OpenSecureChannelResponse,Ns_6418,ST_6419,TTL_6420) in
                                                    {8056}event beginSrv(Sess_5018,Cli_5016,Ns_6418);
                                                    {8057}out(c, (m2_6421,sign(h(m2_6421),skSess_5966)));
                                                    {8058}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8059}event endSrv(Cli_5016,Sess_5018,Nc_6417)
                                    )
                                    else
                                        {8060}let pkDisco_6422: bitstring = fail-any in
                                        {8061}in(c, (=pkCli_6373,em1_6423: bitstring,sigM1_6424: bitstring));
                                        {8062}let m1_6425: bitstring = em1_6423 in
                                        {8063}if (verify(h(m1_6425),sigM1_6424,pkCli_6373) <> true) then
                                            0
                                        else
                                            {8064}let (=OpenSecureChannelRequest,=pkCli_6373,Nc_6426: bitstring) = m1_6425 in
                                            {8065}new Ns_6427: bitstring;
                                            {8066}new ST_6428: bitstring;
                                            {8067}new TTL_6429: bitstring;
                                            {8068}let m2_6430: bitstring = (OpenSecureChannelResponse,Ns_6427,ST_6428,TTL_6429) in
                                            {8069}event beginSrv(Sess_5018,Cli_5016,Ns_6427);
                                            {8070}out(c, (m2_6430,sign(h(m2_6430),skSess_5966)));
                                            {8071}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {8072}event endSrv(Cli_5016,Sess_5018,Nc_6426)
                            )
                            else
                                {8073}let pkDisco_6431: bitstring = fail-any in
                                {8074}in(c, (=pkCli_6373,em1_6432: bitstring,sigM1_6433: bitstring));
                                {8075}let m1_6434: bitstring = em1_6432 in
                                {8076}if (verify(h(m1_6434),sigM1_6433,pkCli_6373) <> true) then
                                    0
                                else
                                    {8077}let (=OpenSecureChannelRequest,=pkCli_6373,Nc_6435: bitstring) = m1_6434 in
                                    {8078}new Ns_6436: bitstring;
                                    {8079}new ST_6437: bitstring;
                                    {8080}new TTL_6438: bitstring;
                                    {8081}let m2_6439: bitstring = (OpenSecureChannelResponse,Ns_6436,ST_6437,TTL_6438) in
                                    {8082}event beginSrv(Sess_5018,Cli_5016,Ns_6436);
                                    {8083}out(c, (m2_6439,sign(h(m2_6439),skSess_5966)));
                                    {8084}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {8085}event endSrv(Cli_5016,Sess_5018,Nc_6435)
                    )
                    else
                        {8086}let skSess_6440: bitstring = fail-any in
                        {8087}let pkSess_6441: bitstring = pub(skSess_6440) in
                        {8088}let v_6442: bool = (Cli_5016 = A) in
                        (
                            {8089}if v_6442 then
                            (
                                {8090}let pkCli_6443: bitstring = pub(skA) in
                                {8091}let v_6444: bool = (Disco_5017 = A) in
                                (
                                    {8092}if v_6444 then
                                    (
                                        {8093}let pkDisco_6445: bitstring = pub(skA) in
                                        {8094}in(c, (=pkCli_6443,em1_6446: bitstring,sigM1_6447: bitstring));
                                        {8095}let m1_6448: bitstring = em1_6446 in
                                        {8096}if (verify(h(m1_6448),sigM1_6447,pkCli_6443) <> true) then
                                            0
                                        else
                                            {8097}let (=OpenSecureChannelRequest,=pkCli_6443,Nc_6449: bitstring) = m1_6448 in
                                            {8098}new Ns_6450: bitstring;
                                            {8099}new ST_6451: bitstring;
                                            {8100}new TTL_6452: bitstring;
                                            {8101}let m2_6453: bitstring = (OpenSecureChannelResponse,Ns_6450,ST_6451,TTL_6452) in
                                            {8102}event beginSrv(Sess_5018,Cli_5016,Ns_6450);
                                            {8103}out(c, (m2_6453,sign(h(m2_6453),skSess_6440)));
                                            {8104}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {8105}event endSrv(Cli_5016,Sess_5018,Nc_6449)
                                    )
                                    else
                                        {8106}let v_6454: bool = (Disco_5017 = B) in
                                        (
                                            {8107}if v_6454 then
                                            (
                                                {8108}let pkDisco_6455: bitstring = pub(skB) in
                                                {8109}in(c, (=pkCli_6443,em1_6456: bitstring,sigM1_6457: bitstring));
                                                {8110}let m1_6458: bitstring = em1_6456 in
                                                {8111}if (verify(h(m1_6458),sigM1_6457,pkCli_6443) <> true) then
                                                    0
                                                else
                                                    {8112}let (=OpenSecureChannelRequest,=pkCli_6443,Nc_6459: bitstring) = m1_6458 in
                                                    {8113}new Ns_6460: bitstring;
                                                    {8114}new ST_6461: bitstring;
                                                    {8115}new TTL_6462: bitstring;
                                                    {8116}let m2_6463: bitstring = (OpenSecureChannelResponse,Ns_6460,ST_6461,TTL_6462) in
                                                    {8117}event beginSrv(Sess_5018,Cli_5016,Ns_6460);
                                                    {8118}out(c, (m2_6463,sign(h(m2_6463),skSess_6440)));
                                                    {8119}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8120}event endSrv(Cli_5016,Sess_5018,Nc_6459)
                                            )
                                            else
                                                {8121}let v_6464: bool = (Disco_5017 = C) in
                                                (
                                                    {8122}if v_6464 then
                                                    (
                                                        {8123}let pkDisco_6465: bitstring = pub(skC) in
                                                        {8124}in(c, (=pkCli_6443,em1_6466: bitstring,sigM1_6467: bitstring));
                                                        {8125}let m1_6468: bitstring = em1_6466 in
                                                        {8126}if (verify(h(m1_6468),sigM1_6467,pkCli_6443) <> true) then
                                                            0
                                                        else
                                                            {8127}let (=OpenSecureChannelRequest,=pkCli_6443,Nc_6469: bitstring) = m1_6468 in
                                                            {8128}new Ns_6470: bitstring;
                                                            {8129}new ST_6471: bitstring;
                                                            {8130}new TTL_6472: bitstring;
                                                            {8131}let m2_6473: bitstring = (OpenSecureChannelResponse,Ns_6470,ST_6471,TTL_6472) in
                                                            {8132}event beginSrv(Sess_5018,Cli_5016,Ns_6470);
                                                            {8133}out(c, (m2_6473,sign(h(m2_6473),skSess_6440)));
                                                            {8134}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8135}event endSrv(Cli_5016,Sess_5018,Nc_6469)
                                                    )
                                                    else
                                                        {8136}let pkDisco_6474: bitstring = pub(sk(Disco_5017)) in
                                                        {8137}in(c, (=pkCli_6443,em1_6475: bitstring,sigM1_6476: bitstring));
                                                        {8138}let m1_6477: bitstring = em1_6475 in
                                                        {8139}if (verify(h(m1_6477),sigM1_6476,pkCli_6443) <> true) then
                                                            0
                                                        else
                                                            {8140}let (=OpenSecureChannelRequest,=pkCli_6443,Nc_6478: bitstring) = m1_6477 in
                                                            {8141}new Ns_6479: bitstring;
                                                            {8142}new ST_6480: bitstring;
                                                            {8143}new TTL_6481: bitstring;
                                                            {8144}let m2_6482: bitstring = (OpenSecureChannelResponse,Ns_6479,ST_6480,TTL_6481) in
                                                            {8145}event beginSrv(Sess_5018,Cli_5016,Ns_6479);
                                                            {8146}out(c, (m2_6482,sign(h(m2_6482),skSess_6440)));
                                                            {8147}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8148}event endSrv(Cli_5016,Sess_5018,Nc_6478)
                                                )
                                                else
                                                    {8149}let pkDisco_6483: bitstring = fail-any in
                                                    {8150}in(c, (=pkCli_6443,em1_6484: bitstring,sigM1_6485: bitstring));
                                                    {8151}let m1_6486: bitstring = em1_6484 in
                                                    {8152}if (verify(h(m1_6486),sigM1_6485,pkCli_6443) <> true) then
                                                        0
                                                    else
                                                        {8153}let (=OpenSecureChannelRequest,=pkCli_6443,Nc_6487: bitstring) = m1_6486 in
                                                        {8154}new Ns_6488: bitstring;
                                                        {8155}new ST_6489: bitstring;
                                                        {8156}new TTL_6490: bitstring;
                                                        {8157}let m2_6491: bitstring = (OpenSecureChannelResponse,Ns_6488,ST_6489,TTL_6490) in
                                                        {8158}event beginSrv(Sess_5018,Cli_5016,Ns_6488);
                                                        {8159}out(c, (m2_6491,sign(h(m2_6491),skSess_6440)));
                                                        {8160}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8161}event endSrv(Cli_5016,Sess_5018,Nc_6487)
                                        )
                                        else
                                            {8162}let pkDisco_6492: bitstring = fail-any in
                                            {8163}in(c, (=pkCli_6443,em1_6493: bitstring,sigM1_6494: bitstring));
                                            {8164}let m1_6495: bitstring = em1_6493 in
                                            {8165}if (verify(h(m1_6495),sigM1_6494,pkCli_6443) <> true) then
                                                0
                                            else
                                                {8166}let (=OpenSecureChannelRequest,=pkCli_6443,Nc_6496: bitstring) = m1_6495 in
                                                {8167}new Ns_6497: bitstring;
                                                {8168}new ST_6498: bitstring;
                                                {8169}new TTL_6499: bitstring;
                                                {8170}let m2_6500: bitstring = (OpenSecureChannelResponse,Ns_6497,ST_6498,TTL_6499) in
                                                {8171}event beginSrv(Sess_5018,Cli_5016,Ns_6497);
                                                {8172}out(c, (m2_6500,sign(h(m2_6500),skSess_6440)));
                                                {8173}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {8174}event endSrv(Cli_5016,Sess_5018,Nc_6496)
                                )
                                else
                                    {8175}let pkDisco_6501: bitstring = fail-any in
                                    {8176}in(c, (=pkCli_6443,em1_6502: bitstring,sigM1_6503: bitstring));
                                    {8177}let m1_6504: bitstring = em1_6502 in
                                    {8178}if (verify(h(m1_6504),sigM1_6503,pkCli_6443) <> true) then
                                        0
                                    else
                                        {8179}let (=OpenSecureChannelRequest,=pkCli_6443,Nc_6505: bitstring) = m1_6504 in
                                        {8180}new Ns_6506: bitstring;
                                        {8181}new ST_6507: bitstring;
                                        {8182}new TTL_6508: bitstring;
                                        {8183}let m2_6509: bitstring = (OpenSecureChannelResponse,Ns_6506,ST_6507,TTL_6508) in
                                        {8184}event beginSrv(Sess_5018,Cli_5016,Ns_6506);
                                        {8185}out(c, (m2_6509,sign(h(m2_6509),skSess_6440)));
                                        {8186}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {8187}event endSrv(Cli_5016,Sess_5018,Nc_6505)
                            )
                            else
                                {8188}let v_6510: bool = (Cli_5016 = B) in
                                (
                                    {8189}if v_6510 then
                                    (
                                        {8190}let pkCli_6511: bitstring = pub(skB) in
                                        {8191}let v_6512: bool = (Disco_5017 = A) in
                                        (
                                            {8192}if v_6512 then
                                            (
                                                {8193}let pkDisco_6513: bitstring = pub(skA) in
                                                {8194}in(c, (=pkCli_6511,em1_6514: bitstring,sigM1_6515: bitstring));
                                                {8195}let m1_6516: bitstring = em1_6514 in
                                                {8196}if (verify(h(m1_6516),sigM1_6515,pkCli_6511) <> true) then
                                                    0
                                                else
                                                    {8197}let (=OpenSecureChannelRequest,=pkCli_6511,Nc_6517: bitstring) = m1_6516 in
                                                    {8198}new Ns_6518: bitstring;
                                                    {8199}new ST_6519: bitstring;
                                                    {8200}new TTL_6520: bitstring;
                                                    {8201}let m2_6521: bitstring = (OpenSecureChannelResponse,Ns_6518,ST_6519,TTL_6520) in
                                                    {8202}event beginSrv(Sess_5018,Cli_5016,Ns_6518);
                                                    {8203}out(c, (m2_6521,sign(h(m2_6521),skSess_6440)));
                                                    {8204}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8205}event endSrv(Cli_5016,Sess_5018,Nc_6517)
                                            )
                                            else
                                                {8206}let v_6522: bool = (Disco_5017 = B) in
                                                (
                                                    {8207}if v_6522 then
                                                    (
                                                        {8208}let pkDisco_6523: bitstring = pub(skB) in
                                                        {8209}in(c, (=pkCli_6511,em1_6524: bitstring,sigM1_6525: bitstring));
                                                        {8210}let m1_6526: bitstring = em1_6524 in
                                                        {8211}if (verify(h(m1_6526),sigM1_6525,pkCli_6511) <> true) then
                                                            0
                                                        else
                                                            {8212}let (=OpenSecureChannelRequest,=pkCli_6511,Nc_6527: bitstring) = m1_6526 in
                                                            {8213}new Ns_6528: bitstring;
                                                            {8214}new ST_6529: bitstring;
                                                            {8215}new TTL_6530: bitstring;
                                                            {8216}let m2_6531: bitstring = (OpenSecureChannelResponse,Ns_6528,ST_6529,TTL_6530) in
                                                            {8217}event beginSrv(Sess_5018,Cli_5016,Ns_6528);
                                                            {8218}out(c, (m2_6531,sign(h(m2_6531),skSess_6440)));
                                                            {8219}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8220}event endSrv(Cli_5016,Sess_5018,Nc_6527)
                                                    )
                                                    else
                                                        {8221}let v_6532: bool = (Disco_5017 = C) in
                                                        (
                                                            {8222}if v_6532 then
                                                            (
                                                                {8223}let pkDisco_6533: bitstring = pub(skC) in
                                                                {8224}in(c, (=pkCli_6511,em1_6534: bitstring,sigM1_6535: bitstring));
                                                                {8225}let m1_6536: bitstring = em1_6534 in
                                                                {8226}if (verify(h(m1_6536),sigM1_6535,pkCli_6511) <> true) then
                                                                    0
                                                                else
                                                                    {8227}let (=OpenSecureChannelRequest,=pkCli_6511,Nc_6537: bitstring) = m1_6536 in
                                                                    {8228}new Ns_6538: bitstring;
                                                                    {8229}new ST_6539: bitstring;
                                                                    {8230}new TTL_6540: bitstring;
                                                                    {8231}let m2_6541: bitstring = (OpenSecureChannelResponse,Ns_6538,ST_6539,TTL_6540) in
                                                                    {8232}event beginSrv(Sess_5018,Cli_5016,Ns_6538);
                                                                    {8233}out(c, (m2_6541,sign(h(m2_6541),skSess_6440)));
                                                                    {8234}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {8235}event endSrv(Cli_5016,Sess_5018,Nc_6537)
                                                            )
                                                            else
                                                                {8236}let pkDisco_6542: bitstring = pub(sk(Disco_5017)) in
                                                                {8237}in(c, (=pkCli_6511,em1_6543: bitstring,sigM1_6544: bitstring));
                                                                {8238}let m1_6545: bitstring = em1_6543 in
                                                                {8239}if (verify(h(m1_6545),sigM1_6544,pkCli_6511) <> true) then
                                                                    0
                                                                else
                                                                    {8240}let (=OpenSecureChannelRequest,=pkCli_6511,Nc_6546: bitstring) = m1_6545 in
                                                                    {8241}new Ns_6547: bitstring;
                                                                    {8242}new ST_6548: bitstring;
                                                                    {8243}new TTL_6549: bitstring;
                                                                    {8244}let m2_6550: bitstring = (OpenSecureChannelResponse,Ns_6547,ST_6548,TTL_6549) in
                                                                    {8245}event beginSrv(Sess_5018,Cli_5016,Ns_6547);
                                                                    {8246}out(c, (m2_6550,sign(h(m2_6550),skSess_6440)));
                                                                    {8247}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {8248}event endSrv(Cli_5016,Sess_5018,Nc_6546)
                                                        )
                                                        else
                                                            {8249}let pkDisco_6551: bitstring = fail-any in
                                                            {8250}in(c, (=pkCli_6511,em1_6552: bitstring,sigM1_6553: bitstring));
                                                            {8251}let m1_6554: bitstring = em1_6552 in
                                                            {8252}if (verify(h(m1_6554),sigM1_6553,pkCli_6511) <> true) then
                                                                0
                                                            else
                                                                {8253}let (=OpenSecureChannelRequest,=pkCli_6511,Nc_6555: bitstring) = m1_6554 in
                                                                {8254}new Ns_6556: bitstring;
                                                                {8255}new ST_6557: bitstring;
                                                                {8256}new TTL_6558: bitstring;
                                                                {8257}let m2_6559: bitstring = (OpenSecureChannelResponse,Ns_6556,ST_6557,TTL_6558) in
                                                                {8258}event beginSrv(Sess_5018,Cli_5016,Ns_6556);
                                                                {8259}out(c, (m2_6559,sign(h(m2_6559),skSess_6440)));
                                                                {8260}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {8261}event endSrv(Cli_5016,Sess_5018,Nc_6555)
                                                )
                                                else
                                                    {8262}let pkDisco_6560: bitstring = fail-any in
                                                    {8263}in(c, (=pkCli_6511,em1_6561: bitstring,sigM1_6562: bitstring));
                                                    {8264}let m1_6563: bitstring = em1_6561 in
                                                    {8265}if (verify(h(m1_6563),sigM1_6562,pkCli_6511) <> true) then
                                                        0
                                                    else
                                                        {8266}let (=OpenSecureChannelRequest,=pkCli_6511,Nc_6564: bitstring) = m1_6563 in
                                                        {8267}new Ns_6565: bitstring;
                                                        {8268}new ST_6566: bitstring;
                                                        {8269}new TTL_6567: bitstring;
                                                        {8270}let m2_6568: bitstring = (OpenSecureChannelResponse,Ns_6565,ST_6566,TTL_6567) in
                                                        {8271}event beginSrv(Sess_5018,Cli_5016,Ns_6565);
                                                        {8272}out(c, (m2_6568,sign(h(m2_6568),skSess_6440)));
                                                        {8273}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8274}event endSrv(Cli_5016,Sess_5018,Nc_6564)
                                        )
                                        else
                                            {8275}let pkDisco_6569: bitstring = fail-any in
                                            {8276}in(c, (=pkCli_6511,em1_6570: bitstring,sigM1_6571: bitstring));
                                            {8277}let m1_6572: bitstring = em1_6570 in
                                            {8278}if (verify(h(m1_6572),sigM1_6571,pkCli_6511) <> true) then
                                                0
                                            else
                                                {8279}let (=OpenSecureChannelRequest,=pkCli_6511,Nc_6573: bitstring) = m1_6572 in
                                                {8280}new Ns_6574: bitstring;
                                                {8281}new ST_6575: bitstring;
                                                {8282}new TTL_6576: bitstring;
                                                {8283}let m2_6577: bitstring = (OpenSecureChannelResponse,Ns_6574,ST_6575,TTL_6576) in
                                                {8284}event beginSrv(Sess_5018,Cli_5016,Ns_6574);
                                                {8285}out(c, (m2_6577,sign(h(m2_6577),skSess_6440)));
                                                {8286}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {8287}event endSrv(Cli_5016,Sess_5018,Nc_6573)
                                    )
                                    else
                                        {8288}let v_6578: bool = (Cli_5016 = C) in
                                        (
                                            {8289}if v_6578 then
                                            (
                                                {8290}let pkCli_6579: bitstring = pub(skC) in
                                                {8291}let v_6580: bool = (Disco_5017 = A) in
                                                (
                                                    {8292}if v_6580 then
                                                    (
                                                        {8293}let pkDisco_6581: bitstring = pub(skA) in
                                                        {8294}in(c, (=pkCli_6579,em1_6582: bitstring,sigM1_6583: bitstring));
                                                        {8295}let m1_6584: bitstring = em1_6582 in
                                                        {8296}if (verify(h(m1_6584),sigM1_6583,pkCli_6579) <> true) then
                                                            0
                                                        else
                                                            {8297}let (=OpenSecureChannelRequest,=pkCli_6579,Nc_6585: bitstring) = m1_6584 in
                                                            {8298}new Ns_6586: bitstring;
                                                            {8299}new ST_6587: bitstring;
                                                            {8300}new TTL_6588: bitstring;
                                                            {8301}let m2_6589: bitstring = (OpenSecureChannelResponse,Ns_6586,ST_6587,TTL_6588) in
                                                            {8302}event beginSrv(Sess_5018,Cli_5016,Ns_6586);
                                                            {8303}out(c, (m2_6589,sign(h(m2_6589),skSess_6440)));
                                                            {8304}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8305}event endSrv(Cli_5016,Sess_5018,Nc_6585)
                                                    )
                                                    else
                                                        {8306}let v_6590: bool = (Disco_5017 = B) in
                                                        (
                                                            {8307}if v_6590 then
                                                            (
                                                                {8308}let pkDisco_6591: bitstring = pub(skB) in
                                                                {8309}in(c, (=pkCli_6579,em1_6592: bitstring,sigM1_6593: bitstring));
                                                                {8310}let m1_6594: bitstring = em1_6592 in
                                                                {8311}if (verify(h(m1_6594),sigM1_6593,pkCli_6579) <> true) then
                                                                    0
                                                                else
                                                                    {8312}let (=OpenSecureChannelRequest,=pkCli_6579,Nc_6595: bitstring) = m1_6594 in
                                                                    {8313}new Ns_6596: bitstring;
                                                                    {8314}new ST_6597: bitstring;
                                                                    {8315}new TTL_6598: bitstring;
                                                                    {8316}let m2_6599: bitstring = (OpenSecureChannelResponse,Ns_6596,ST_6597,TTL_6598) in
                                                                    {8317}event beginSrv(Sess_5018,Cli_5016,Ns_6596);
                                                                    {8318}out(c, (m2_6599,sign(h(m2_6599),skSess_6440)));
                                                                    {8319}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {8320}event endSrv(Cli_5016,Sess_5018,Nc_6595)
                                                            )
                                                            else
                                                                {8321}let v_6600: bool = (Disco_5017 = C) in
                                                                (
                                                                    {8322}if v_6600 then
                                                                    (
                                                                        {8323}let pkDisco_6601: bitstring = pub(skC) in
                                                                        {8324}in(c, (=pkCli_6579,em1_6602: bitstring,sigM1_6603: bitstring));
                                                                        {8325}let m1_6604: bitstring = em1_6602 in
                                                                        {8326}if (verify(h(m1_6604),sigM1_6603,pkCli_6579) <> true) then
                                                                            0
                                                                        else
                                                                            {8327}let (=OpenSecureChannelRequest,=pkCli_6579,Nc_6605: bitstring) = m1_6604 in
                                                                            {8328}new Ns_6606: bitstring;
                                                                            {8329}new ST_6607: bitstring;
                                                                            {8330}new TTL_6608: bitstring;
                                                                            {8331}let m2_6609: bitstring = (OpenSecureChannelResponse,Ns_6606,ST_6607,TTL_6608) in
                                                                            {8332}event beginSrv(Sess_5018,Cli_5016,Ns_6606);
                                                                            {8333}out(c, (m2_6609,sign(h(m2_6609),skSess_6440)));
                                                                            {8334}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {8335}event endSrv(Cli_5016,Sess_5018,Nc_6605)
                                                                    )
                                                                    else
                                                                        {8336}let pkDisco_6610: bitstring = pub(sk(Disco_5017)) in
                                                                        {8337}in(c, (=pkCli_6579,em1_6611: bitstring,sigM1_6612: bitstring));
                                                                        {8338}let m1_6613: bitstring = em1_6611 in
                                                                        {8339}if (verify(h(m1_6613),sigM1_6612,pkCli_6579) <> true) then
                                                                            0
                                                                        else
                                                                            {8340}let (=OpenSecureChannelRequest,=pkCli_6579,Nc_6614: bitstring) = m1_6613 in
                                                                            {8341}new Ns_6615: bitstring;
                                                                            {8342}new ST_6616: bitstring;
                                                                            {8343}new TTL_6617: bitstring;
                                                                            {8344}let m2_6618: bitstring = (OpenSecureChannelResponse,Ns_6615,ST_6616,TTL_6617) in
                                                                            {8345}event beginSrv(Sess_5018,Cli_5016,Ns_6615);
                                                                            {8346}out(c, (m2_6618,sign(h(m2_6618),skSess_6440)));
                                                                            {8347}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {8348}event endSrv(Cli_5016,Sess_5018,Nc_6614)
                                                                )
                                                                else
                                                                    {8349}let pkDisco_6619: bitstring = fail-any in
                                                                    {8350}in(c, (=pkCli_6579,em1_6620: bitstring,sigM1_6621: bitstring));
                                                                    {8351}let m1_6622: bitstring = em1_6620 in
                                                                    {8352}if (verify(h(m1_6622),sigM1_6621,pkCli_6579) <> true) then
                                                                        0
                                                                    else
                                                                        {8353}let (=OpenSecureChannelRequest,=pkCli_6579,Nc_6623: bitstring) = m1_6622 in
                                                                        {8354}new Ns_6624: bitstring;
                                                                        {8355}new ST_6625: bitstring;
                                                                        {8356}new TTL_6626: bitstring;
                                                                        {8357}let m2_6627: bitstring = (OpenSecureChannelResponse,Ns_6624,ST_6625,TTL_6626) in
                                                                        {8358}event beginSrv(Sess_5018,Cli_5016,Ns_6624);
                                                                        {8359}out(c, (m2_6627,sign(h(m2_6627),skSess_6440)));
                                                                        {8360}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {8361}event endSrv(Cli_5016,Sess_5018,Nc_6623)
                                                        )
                                                        else
                                                            {8362}let pkDisco_6628: bitstring = fail-any in
                                                            {8363}in(c, (=pkCli_6579,em1_6629: bitstring,sigM1_6630: bitstring));
                                                            {8364}let m1_6631: bitstring = em1_6629 in
                                                            {8365}if (verify(h(m1_6631),sigM1_6630,pkCli_6579) <> true) then
                                                                0
                                                            else
                                                                {8366}let (=OpenSecureChannelRequest,=pkCli_6579,Nc_6632: bitstring) = m1_6631 in
                                                                {8367}new Ns_6633: bitstring;
                                                                {8368}new ST_6634: bitstring;
                                                                {8369}new TTL_6635: bitstring;
                                                                {8370}let m2_6636: bitstring = (OpenSecureChannelResponse,Ns_6633,ST_6634,TTL_6635) in
                                                                {8371}event beginSrv(Sess_5018,Cli_5016,Ns_6633);
                                                                {8372}out(c, (m2_6636,sign(h(m2_6636),skSess_6440)));
                                                                {8373}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {8374}event endSrv(Cli_5016,Sess_5018,Nc_6632)
                                                )
                                                else
                                                    {8375}let pkDisco_6637: bitstring = fail-any in
                                                    {8376}in(c, (=pkCli_6579,em1_6638: bitstring,sigM1_6639: bitstring));
                                                    {8377}let m1_6640: bitstring = em1_6638 in
                                                    {8378}if (verify(h(m1_6640),sigM1_6639,pkCli_6579) <> true) then
                                                        0
                                                    else
                                                        {8379}let (=OpenSecureChannelRequest,=pkCli_6579,Nc_6641: bitstring) = m1_6640 in
                                                        {8380}new Ns_6642: bitstring;
                                                        {8381}new ST_6643: bitstring;
                                                        {8382}new TTL_6644: bitstring;
                                                        {8383}let m2_6645: bitstring = (OpenSecureChannelResponse,Ns_6642,ST_6643,TTL_6644) in
                                                        {8384}event beginSrv(Sess_5018,Cli_5016,Ns_6642);
                                                        {8385}out(c, (m2_6645,sign(h(m2_6645),skSess_6440)));
                                                        {8386}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8387}event endSrv(Cli_5016,Sess_5018,Nc_6641)
                                            )
                                            else
                                                {8388}let pkCli_6646: bitstring = pub(sk(Cli_5016)) in
                                                {8389}let v_6647: bool = (Disco_5017 = A) in
                                                (
                                                    {8390}if v_6647 then
                                                    (
                                                        {8391}let pkDisco_6648: bitstring = pub(skA) in
                                                        {8392}in(c, (=pkCli_6646,em1_6649: bitstring,sigM1_6650: bitstring));
                                                        {8393}let m1_6651: bitstring = em1_6649 in
                                                        {8394}if (verify(h(m1_6651),sigM1_6650,pkCli_6646) <> true) then
                                                            0
                                                        else
                                                            {8395}let (=OpenSecureChannelRequest,=pkCli_6646,Nc_6652: bitstring) = m1_6651 in
                                                            {8396}new Ns_6653: bitstring;
                                                            {8397}new ST_6654: bitstring;
                                                            {8398}new TTL_6655: bitstring;
                                                            {8399}let m2_6656: bitstring = (OpenSecureChannelResponse,Ns_6653,ST_6654,TTL_6655) in
                                                            {8400}event beginSrv(Sess_5018,Cli_5016,Ns_6653);
                                                            {8401}out(c, (m2_6656,sign(h(m2_6656),skSess_6440)));
                                                            {8402}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8403}event endSrv(Cli_5016,Sess_5018,Nc_6652)
                                                    )
                                                    else
                                                        {8404}let v_6657: bool = (Disco_5017 = B) in
                                                        (
                                                            {8405}if v_6657 then
                                                            (
                                                                {8406}let pkDisco_6658: bitstring = pub(skB) in
                                                                {8407}in(c, (=pkCli_6646,em1_6659: bitstring,sigM1_6660: bitstring));
                                                                {8408}let m1_6661: bitstring = em1_6659 in
                                                                {8409}if (verify(h(m1_6661),sigM1_6660,pkCli_6646) <> true) then
                                                                    0
                                                                else
                                                                    {8410}let (=OpenSecureChannelRequest,=pkCli_6646,Nc_6662: bitstring) = m1_6661 in
                                                                    {8411}new Ns_6663: bitstring;
                                                                    {8412}new ST_6664: bitstring;
                                                                    {8413}new TTL_6665: bitstring;
                                                                    {8414}let m2_6666: bitstring = (OpenSecureChannelResponse,Ns_6663,ST_6664,TTL_6665) in
                                                                    {8415}event beginSrv(Sess_5018,Cli_5016,Ns_6663);
                                                                    {8416}out(c, (m2_6666,sign(h(m2_6666),skSess_6440)));
                                                                    {8417}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {8418}event endSrv(Cli_5016,Sess_5018,Nc_6662)
                                                            )
                                                            else
                                                                {8419}let v_6667: bool = (Disco_5017 = C) in
                                                                (
                                                                    {8420}if v_6667 then
                                                                    (
                                                                        {8421}let pkDisco_6668: bitstring = pub(skC) in
                                                                        {8422}in(c, (=pkCli_6646,em1_6669: bitstring,sigM1_6670: bitstring));
                                                                        {8423}let m1_6671: bitstring = em1_6669 in
                                                                        {8424}if (verify(h(m1_6671),sigM1_6670,pkCli_6646) <> true) then
                                                                            0
                                                                        else
                                                                            {8425}let (=OpenSecureChannelRequest,=pkCli_6646,Nc_6672: bitstring) = m1_6671 in
                                                                            {8426}new Ns_6673: bitstring;
                                                                            {8427}new ST_6674: bitstring;
                                                                            {8428}new TTL_6675: bitstring;
                                                                            {8429}let m2_6676: bitstring = (OpenSecureChannelResponse,Ns_6673,ST_6674,TTL_6675) in
                                                                            {8430}event beginSrv(Sess_5018,Cli_5016,Ns_6673);
                                                                            {8431}out(c, (m2_6676,sign(h(m2_6676),skSess_6440)));
                                                                            {8432}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {8433}event endSrv(Cli_5016,Sess_5018,Nc_6672)
                                                                    )
                                                                    else
                                                                        {8434}let pkDisco_6677: bitstring = pub(sk(Disco_5017)) in
                                                                        {8435}in(c, (=pkCli_6646,em1_6678: bitstring,sigM1_6679: bitstring));
                                                                        {8436}let m1_6680: bitstring = em1_6678 in
                                                                        {8437}if (verify(h(m1_6680),sigM1_6679,pkCli_6646) <> true) then
                                                                            0
                                                                        else
                                                                            {8438}let (=OpenSecureChannelRequest,=pkCli_6646,Nc_6681: bitstring) = m1_6680 in
                                                                            {8439}new Ns_6682: bitstring;
                                                                            {8440}new ST_6683: bitstring;
                                                                            {8441}new TTL_6684: bitstring;
                                                                            {8442}let m2_6685: bitstring = (OpenSecureChannelResponse,Ns_6682,ST_6683,TTL_6684) in
                                                                            {8443}event beginSrv(Sess_5018,Cli_5016,Ns_6682);
                                                                            {8444}out(c, (m2_6685,sign(h(m2_6685),skSess_6440)));
                                                                            {8445}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                            {8446}event endSrv(Cli_5016,Sess_5018,Nc_6681)
                                                                )
                                                                else
                                                                    {8447}let pkDisco_6686: bitstring = fail-any in
                                                                    {8448}in(c, (=pkCli_6646,em1_6687: bitstring,sigM1_6688: bitstring));
                                                                    {8449}let m1_6689: bitstring = em1_6687 in
                                                                    {8450}if (verify(h(m1_6689),sigM1_6688,pkCli_6646) <> true) then
                                                                        0
                                                                    else
                                                                        {8451}let (=OpenSecureChannelRequest,=pkCli_6646,Nc_6690: bitstring) = m1_6689 in
                                                                        {8452}new Ns_6691: bitstring;
                                                                        {8453}new ST_6692: bitstring;
                                                                        {8454}new TTL_6693: bitstring;
                                                                        {8455}let m2_6694: bitstring = (OpenSecureChannelResponse,Ns_6691,ST_6692,TTL_6693) in
                                                                        {8456}event beginSrv(Sess_5018,Cli_5016,Ns_6691);
                                                                        {8457}out(c, (m2_6694,sign(h(m2_6694),skSess_6440)));
                                                                        {8458}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {8459}event endSrv(Cli_5016,Sess_5018,Nc_6690)
                                                        )
                                                        else
                                                            {8460}let pkDisco_6695: bitstring = fail-any in
                                                            {8461}in(c, (=pkCli_6646,em1_6696: bitstring,sigM1_6697: bitstring));
                                                            {8462}let m1_6698: bitstring = em1_6696 in
                                                            {8463}if (verify(h(m1_6698),sigM1_6697,pkCli_6646) <> true) then
                                                                0
                                                            else
                                                                {8464}let (=OpenSecureChannelRequest,=pkCli_6646,Nc_6699: bitstring) = m1_6698 in
                                                                {8465}new Ns_6700: bitstring;
                                                                {8466}new ST_6701: bitstring;
                                                                {8467}new TTL_6702: bitstring;
                                                                {8468}let m2_6703: bitstring = (OpenSecureChannelResponse,Ns_6700,ST_6701,TTL_6702) in
                                                                {8469}event beginSrv(Sess_5018,Cli_5016,Ns_6700);
                                                                {8470}out(c, (m2_6703,sign(h(m2_6703),skSess_6440)));
                                                                {8471}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {8472}event endSrv(Cli_5016,Sess_5018,Nc_6699)
                                                )
                                                else
                                                    {8473}let pkDisco_6704: bitstring = fail-any in
                                                    {8474}in(c, (=pkCli_6646,em1_6705: bitstring,sigM1_6706: bitstring));
                                                    {8475}let m1_6707: bitstring = em1_6705 in
                                                    {8476}if (verify(h(m1_6707),sigM1_6706,pkCli_6646) <> true) then
                                                        0
                                                    else
                                                        {8477}let (=OpenSecureChannelRequest,=pkCli_6646,Nc_6708: bitstring) = m1_6707 in
                                                        {8478}new Ns_6709: bitstring;
                                                        {8479}new ST_6710: bitstring;
                                                        {8480}new TTL_6711: bitstring;
                                                        {8481}let m2_6712: bitstring = (OpenSecureChannelResponse,Ns_6709,ST_6710,TTL_6711) in
                                                        {8482}event beginSrv(Sess_5018,Cli_5016,Ns_6709);
                                                        {8483}out(c, (m2_6712,sign(h(m2_6712),skSess_6440)));
                                                        {8484}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8485}event endSrv(Cli_5016,Sess_5018,Nc_6708)
                                        )
                                        else
                                            {8486}let pkCli_6713: bitstring = fail-any in
                                            {8487}let v_6714: bool = (Disco_5017 = A) in
                                            (
                                                {8488}if v_6714 then
                                                (
                                                    {8489}let pkDisco_6715: bitstring = pub(skA) in
                                                    {8490}in(c, (=pkCli_6713,em1_6716: bitstring,sigM1_6717: bitstring));
                                                    {8491}let m1_6718: bitstring = em1_6716 in
                                                    {8492}if (verify(h(m1_6718),sigM1_6717,pkCli_6713) <> true) then
                                                        0
                                                    else
                                                        {8493}let (=OpenSecureChannelRequest,=pkCli_6713,Nc_6719: bitstring) = m1_6718 in
                                                        {8494}new Ns_6720: bitstring;
                                                        {8495}new ST_6721: bitstring;
                                                        {8496}new TTL_6722: bitstring;
                                                        {8497}let m2_6723: bitstring = (OpenSecureChannelResponse,Ns_6720,ST_6721,TTL_6722) in
                                                        {8498}event beginSrv(Sess_5018,Cli_5016,Ns_6720);
                                                        {8499}out(c, (m2_6723,sign(h(m2_6723),skSess_6440)));
                                                        {8500}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8501}event endSrv(Cli_5016,Sess_5018,Nc_6719)
                                                )
                                                else
                                                    {8502}let v_6724: bool = (Disco_5017 = B) in
                                                    (
                                                        {8503}if v_6724 then
                                                        (
                                                            {8504}let pkDisco_6725: bitstring = pub(skB) in
                                                            {8505}in(c, (=pkCli_6713,em1_6726: bitstring,sigM1_6727: bitstring));
                                                            {8506}let m1_6728: bitstring = em1_6726 in
                                                            {8507}if (verify(h(m1_6728),sigM1_6727,pkCli_6713) <> true) then
                                                                0
                                                            else
                                                                {8508}let (=OpenSecureChannelRequest,=pkCli_6713,Nc_6729: bitstring) = m1_6728 in
                                                                {8509}new Ns_6730: bitstring;
                                                                {8510}new ST_6731: bitstring;
                                                                {8511}new TTL_6732: bitstring;
                                                                {8512}let m2_6733: bitstring = (OpenSecureChannelResponse,Ns_6730,ST_6731,TTL_6732) in
                                                                {8513}event beginSrv(Sess_5018,Cli_5016,Ns_6730);
                                                                {8514}out(c, (m2_6733,sign(h(m2_6733),skSess_6440)));
                                                                {8515}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {8516}event endSrv(Cli_5016,Sess_5018,Nc_6729)
                                                        )
                                                        else
                                                            {8517}let v_6734: bool = (Disco_5017 = C) in
                                                            (
                                                                {8518}if v_6734 then
                                                                (
                                                                    {8519}let pkDisco_6735: bitstring = pub(skC) in
                                                                    {8520}in(c, (=pkCli_6713,em1_6736: bitstring,sigM1_6737: bitstring));
                                                                    {8521}let m1_6738: bitstring = em1_6736 in
                                                                    {8522}if (verify(h(m1_6738),sigM1_6737,pkCli_6713) <> true) then
                                                                        0
                                                                    else
                                                                        {8523}let (=OpenSecureChannelRequest,=pkCli_6713,Nc_6739: bitstring) = m1_6738 in
                                                                        {8524}new Ns_6740: bitstring;
                                                                        {8525}new ST_6741: bitstring;
                                                                        {8526}new TTL_6742: bitstring;
                                                                        {8527}let m2_6743: bitstring = (OpenSecureChannelResponse,Ns_6740,ST_6741,TTL_6742) in
                                                                        {8528}event beginSrv(Sess_5018,Cli_5016,Ns_6740);
                                                                        {8529}out(c, (m2_6743,sign(h(m2_6743),skSess_6440)));
                                                                        {8530}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {8531}event endSrv(Cli_5016,Sess_5018,Nc_6739)
                                                                )
                                                                else
                                                                    {8532}let pkDisco_6744: bitstring = pub(sk(Disco_5017)) in
                                                                    {8533}in(c, (=pkCli_6713,em1_6745: bitstring,sigM1_6746: bitstring));
                                                                    {8534}let m1_6747: bitstring = em1_6745 in
                                                                    {8535}if (verify(h(m1_6747),sigM1_6746,pkCli_6713) <> true) then
                                                                        0
                                                                    else
                                                                        {8536}let (=OpenSecureChannelRequest,=pkCli_6713,Nc_6748: bitstring) = m1_6747 in
                                                                        {8537}new Ns_6749: bitstring;
                                                                        {8538}new ST_6750: bitstring;
                                                                        {8539}new TTL_6751: bitstring;
                                                                        {8540}let m2_6752: bitstring = (OpenSecureChannelResponse,Ns_6749,ST_6750,TTL_6751) in
                                                                        {8541}event beginSrv(Sess_5018,Cli_5016,Ns_6749);
                                                                        {8542}out(c, (m2_6752,sign(h(m2_6752),skSess_6440)));
                                                                        {8543}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                        {8544}event endSrv(Cli_5016,Sess_5018,Nc_6748)
                                                            )
                                                            else
                                                                {8545}let pkDisco_6753: bitstring = fail-any in
                                                                {8546}in(c, (=pkCli_6713,em1_6754: bitstring,sigM1_6755: bitstring));
                                                                {8547}let m1_6756: bitstring = em1_6754 in
                                                                {8548}if (verify(h(m1_6756),sigM1_6755,pkCli_6713) <> true) then
                                                                    0
                                                                else
                                                                    {8549}let (=OpenSecureChannelRequest,=pkCli_6713,Nc_6757: bitstring) = m1_6756 in
                                                                    {8550}new Ns_6758: bitstring;
                                                                    {8551}new ST_6759: bitstring;
                                                                    {8552}new TTL_6760: bitstring;
                                                                    {8553}let m2_6761: bitstring = (OpenSecureChannelResponse,Ns_6758,ST_6759,TTL_6760) in
                                                                    {8554}event beginSrv(Sess_5018,Cli_5016,Ns_6758);
                                                                    {8555}out(c, (m2_6761,sign(h(m2_6761),skSess_6440)));
                                                                    {8556}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {8557}event endSrv(Cli_5016,Sess_5018,Nc_6757)
                                                    )
                                                    else
                                                        {8558}let pkDisco_6762: bitstring = fail-any in
                                                        {8559}in(c, (=pkCli_6713,em1_6763: bitstring,sigM1_6764: bitstring));
                                                        {8560}let m1_6765: bitstring = em1_6763 in
                                                        {8561}if (verify(h(m1_6765),sigM1_6764,pkCli_6713) <> true) then
                                                            0
                                                        else
                                                            {8562}let (=OpenSecureChannelRequest,=pkCli_6713,Nc_6766: bitstring) = m1_6765 in
                                                            {8563}new Ns_6767: bitstring;
                                                            {8564}new ST_6768: bitstring;
                                                            {8565}new TTL_6769: bitstring;
                                                            {8566}let m2_6770: bitstring = (OpenSecureChannelResponse,Ns_6767,ST_6768,TTL_6769) in
                                                            {8567}event beginSrv(Sess_5018,Cli_5016,Ns_6767);
                                                            {8568}out(c, (m2_6770,sign(h(m2_6770),skSess_6440)));
                                                            {8569}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8570}event endSrv(Cli_5016,Sess_5018,Nc_6766)
                                            )
                                            else
                                                {8571}let pkDisco_6771: bitstring = fail-any in
                                                {8572}in(c, (=pkCli_6713,em1_6772: bitstring,sigM1_6773: bitstring));
                                                {8573}let m1_6774: bitstring = em1_6772 in
                                                {8574}if (verify(h(m1_6774),sigM1_6773,pkCli_6713) <> true) then
                                                    0
                                                else
                                                    {8575}let (=OpenSecureChannelRequest,=pkCli_6713,Nc_6775: bitstring) = m1_6774 in
                                                    {8576}new Ns_6776: bitstring;
                                                    {8577}new ST_6777: bitstring;
                                                    {8578}new TTL_6778: bitstring;
                                                    {8579}let m2_6779: bitstring = (OpenSecureChannelResponse,Ns_6776,ST_6777,TTL_6778) in
                                                    {8580}event beginSrv(Sess_5018,Cli_5016,Ns_6776);
                                                    {8581}out(c, (m2_6779,sign(h(m2_6779),skSess_6440)));
                                                    {8582}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8583}event endSrv(Cli_5016,Sess_5018,Nc_6775)
                                )
                                else
                                    {8584}let pkCli_6780: bitstring = fail-any in
                                    {8585}let v_6781: bool = (Disco_5017 = A) in
                                    (
                                        {8586}if v_6781 then
                                        (
                                            {8587}let pkDisco_6782: bitstring = pub(skA) in
                                            {8588}in(c, (=pkCli_6780,em1_6783: bitstring,sigM1_6784: bitstring));
                                            {8589}let m1_6785: bitstring = em1_6783 in
                                            {8590}if (verify(h(m1_6785),sigM1_6784,pkCli_6780) <> true) then
                                                0
                                            else
                                                {8591}let (=OpenSecureChannelRequest,=pkCli_6780,Nc_6786: bitstring) = m1_6785 in
                                                {8592}new Ns_6787: bitstring;
                                                {8593}new ST_6788: bitstring;
                                                {8594}new TTL_6789: bitstring;
                                                {8595}let m2_6790: bitstring = (OpenSecureChannelResponse,Ns_6787,ST_6788,TTL_6789) in
                                                {8596}event beginSrv(Sess_5018,Cli_5016,Ns_6787);
                                                {8597}out(c, (m2_6790,sign(h(m2_6790),skSess_6440)));
                                                {8598}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {8599}event endSrv(Cli_5016,Sess_5018,Nc_6786)
                                        )
                                        else
                                            {8600}let v_6791: bool = (Disco_5017 = B) in
                                            (
                                                {8601}if v_6791 then
                                                (
                                                    {8602}let pkDisco_6792: bitstring = pub(skB) in
                                                    {8603}in(c, (=pkCli_6780,em1_6793: bitstring,sigM1_6794: bitstring));
                                                    {8604}let m1_6795: bitstring = em1_6793 in
                                                    {8605}if (verify(h(m1_6795),sigM1_6794,pkCli_6780) <> true) then
                                                        0
                                                    else
                                                        {8606}let (=OpenSecureChannelRequest,=pkCli_6780,Nc_6796: bitstring) = m1_6795 in
                                                        {8607}new Ns_6797: bitstring;
                                                        {8608}new ST_6798: bitstring;
                                                        {8609}new TTL_6799: bitstring;
                                                        {8610}let m2_6800: bitstring = (OpenSecureChannelResponse,Ns_6797,ST_6798,TTL_6799) in
                                                        {8611}event beginSrv(Sess_5018,Cli_5016,Ns_6797);
                                                        {8612}out(c, (m2_6800,sign(h(m2_6800),skSess_6440)));
                                                        {8613}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8614}event endSrv(Cli_5016,Sess_5018,Nc_6796)
                                                )
                                                else
                                                    {8615}let v_6801: bool = (Disco_5017 = C) in
                                                    (
                                                        {8616}if v_6801 then
                                                        (
                                                            {8617}let pkDisco_6802: bitstring = pub(skC) in
                                                            {8618}in(c, (=pkCli_6780,em1_6803: bitstring,sigM1_6804: bitstring));
                                                            {8619}let m1_6805: bitstring = em1_6803 in
                                                            {8620}if (verify(h(m1_6805),sigM1_6804,pkCli_6780) <> true) then
                                                                0
                                                            else
                                                                {8621}let (=OpenSecureChannelRequest,=pkCli_6780,Nc_6806: bitstring) = m1_6805 in
                                                                {8622}new Ns_6807: bitstring;
                                                                {8623}new ST_6808: bitstring;
                                                                {8624}new TTL_6809: bitstring;
                                                                {8625}let m2_6810: bitstring = (OpenSecureChannelResponse,Ns_6807,ST_6808,TTL_6809) in
                                                                {8626}event beginSrv(Sess_5018,Cli_5016,Ns_6807);
                                                                {8627}out(c, (m2_6810,sign(h(m2_6810),skSess_6440)));
                                                                {8628}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {8629}event endSrv(Cli_5016,Sess_5018,Nc_6806)
                                                        )
                                                        else
                                                            {8630}let pkDisco_6811: bitstring = pub(sk(Disco_5017)) in
                                                            {8631}in(c, (=pkCli_6780,em1_6812: bitstring,sigM1_6813: bitstring));
                                                            {8632}let m1_6814: bitstring = em1_6812 in
                                                            {8633}if (verify(h(m1_6814),sigM1_6813,pkCli_6780) <> true) then
                                                                0
                                                            else
                                                                {8634}let (=OpenSecureChannelRequest,=pkCli_6780,Nc_6815: bitstring) = m1_6814 in
                                                                {8635}new Ns_6816: bitstring;
                                                                {8636}new ST_6817: bitstring;
                                                                {8637}new TTL_6818: bitstring;
                                                                {8638}let m2_6819: bitstring = (OpenSecureChannelResponse,Ns_6816,ST_6817,TTL_6818) in
                                                                {8639}event beginSrv(Sess_5018,Cli_5016,Ns_6816);
                                                                {8640}out(c, (m2_6819,sign(h(m2_6819),skSess_6440)));
                                                                {8641}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {8642}event endSrv(Cli_5016,Sess_5018,Nc_6815)
                                                    )
                                                    else
                                                        {8643}let pkDisco_6820: bitstring = fail-any in
                                                        {8644}in(c, (=pkCli_6780,em1_6821: bitstring,sigM1_6822: bitstring));
                                                        {8645}let m1_6823: bitstring = em1_6821 in
                                                        {8646}if (verify(h(m1_6823),sigM1_6822,pkCli_6780) <> true) then
                                                            0
                                                        else
                                                            {8647}let (=OpenSecureChannelRequest,=pkCli_6780,Nc_6824: bitstring) = m1_6823 in
                                                            {8648}new Ns_6825: bitstring;
                                                            {8649}new ST_6826: bitstring;
                                                            {8650}new TTL_6827: bitstring;
                                                            {8651}let m2_6828: bitstring = (OpenSecureChannelResponse,Ns_6825,ST_6826,TTL_6827) in
                                                            {8652}event beginSrv(Sess_5018,Cli_5016,Ns_6825);
                                                            {8653}out(c, (m2_6828,sign(h(m2_6828),skSess_6440)));
                                                            {8654}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8655}event endSrv(Cli_5016,Sess_5018,Nc_6824)
                                            )
                                            else
                                                {8656}let pkDisco_6829: bitstring = fail-any in
                                                {8657}in(c, (=pkCli_6780,em1_6830: bitstring,sigM1_6831: bitstring));
                                                {8658}let m1_6832: bitstring = em1_6830 in
                                                {8659}if (verify(h(m1_6832),sigM1_6831,pkCli_6780) <> true) then
                                                    0
                                                else
                                                    {8660}let (=OpenSecureChannelRequest,=pkCli_6780,Nc_6833: bitstring) = m1_6832 in
                                                    {8661}new Ns_6834: bitstring;
                                                    {8662}new ST_6835: bitstring;
                                                    {8663}new TTL_6836: bitstring;
                                                    {8664}let m2_6837: bitstring = (OpenSecureChannelResponse,Ns_6834,ST_6835,TTL_6836) in
                                                    {8665}event beginSrv(Sess_5018,Cli_5016,Ns_6834);
                                                    {8666}out(c, (m2_6837,sign(h(m2_6837),skSess_6440)));
                                                    {8667}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8668}event endSrv(Cli_5016,Sess_5018,Nc_6833)
                                    )
                                    else
                                        {8669}let pkDisco_6838: bitstring = fail-any in
                                        {8670}in(c, (=pkCli_6780,em1_6839: bitstring,sigM1_6840: bitstring));
                                        {8671}let m1_6841: bitstring = em1_6839 in
                                        {8672}if (verify(h(m1_6841),sigM1_6840,pkCli_6780) <> true) then
                                            0
                                        else
                                            {8673}let (=OpenSecureChannelRequest,=pkCli_6780,Nc_6842: bitstring) = m1_6841 in
                                            {8674}new Ns_6843: bitstring;
                                            {8675}new ST_6844: bitstring;
                                            {8676}new TTL_6845: bitstring;
                                            {8677}let m2_6846: bitstring = (OpenSecureChannelResponse,Ns_6843,ST_6844,TTL_6845) in
                                            {8678}event beginSrv(Sess_5018,Cli_5016,Ns_6843);
                                            {8679}out(c, (m2_6846,sign(h(m2_6846),skSess_6440)));
                                            {8680}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {8681}event endSrv(Cli_5016,Sess_5018,Nc_6842)
                        )
                        else
                            {8682}let pkCli_6847: bitstring = fail-any in
                            {8683}let v_6848: bool = (Disco_5017 = A) in
                            (
                                {8684}if v_6848 then
                                (
                                    {8685}let pkDisco_6849: bitstring = pub(skA) in
                                    {8686}in(c, (=pkCli_6847,em1_6850: bitstring,sigM1_6851: bitstring));
                                    {8687}let m1_6852: bitstring = em1_6850 in
                                    {8688}if (verify(h(m1_6852),sigM1_6851,pkCli_6847) <> true) then
                                        0
                                    else
                                        {8689}let (=OpenSecureChannelRequest,=pkCli_6847,Nc_6853: bitstring) = m1_6852 in
                                        {8690}new Ns_6854: bitstring;
                                        {8691}new ST_6855: bitstring;
                                        {8692}new TTL_6856: bitstring;
                                        {8693}let m2_6857: bitstring = (OpenSecureChannelResponse,Ns_6854,ST_6855,TTL_6856) in
                                        {8694}event beginSrv(Sess_5018,Cli_5016,Ns_6854);
                                        {8695}out(c, (m2_6857,sign(h(m2_6857),skSess_6440)));
                                        {8696}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {8697}event endSrv(Cli_5016,Sess_5018,Nc_6853)
                                )
                                else
                                    {8698}let v_6858: bool = (Disco_5017 = B) in
                                    (
                                        {8699}if v_6858 then
                                        (
                                            {8700}let pkDisco_6859: bitstring = pub(skB) in
                                            {8701}in(c, (=pkCli_6847,em1_6860: bitstring,sigM1_6861: bitstring));
                                            {8702}let m1_6862: bitstring = em1_6860 in
                                            {8703}if (verify(h(m1_6862),sigM1_6861,pkCli_6847) <> true) then
                                                0
                                            else
                                                {8704}let (=OpenSecureChannelRequest,=pkCli_6847,Nc_6863: bitstring) = m1_6862 in
                                                {8705}new Ns_6864: bitstring;
                                                {8706}new ST_6865: bitstring;
                                                {8707}new TTL_6866: bitstring;
                                                {8708}let m2_6867: bitstring = (OpenSecureChannelResponse,Ns_6864,ST_6865,TTL_6866) in
                                                {8709}event beginSrv(Sess_5018,Cli_5016,Ns_6864);
                                                {8710}out(c, (m2_6867,sign(h(m2_6867),skSess_6440)));
                                                {8711}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {8712}event endSrv(Cli_5016,Sess_5018,Nc_6863)
                                        )
                                        else
                                            {8713}let v_6868: bool = (Disco_5017 = C) in
                                            (
                                                {8714}if v_6868 then
                                                (
                                                    {8715}let pkDisco_6869: bitstring = pub(skC) in
                                                    {8716}in(c, (=pkCli_6847,em1_6870: bitstring,sigM1_6871: bitstring));
                                                    {8717}let m1_6872: bitstring = em1_6870 in
                                                    {8718}if (verify(h(m1_6872),sigM1_6871,pkCli_6847) <> true) then
                                                        0
                                                    else
                                                        {8719}let (=OpenSecureChannelRequest,=pkCli_6847,Nc_6873: bitstring) = m1_6872 in
                                                        {8720}new Ns_6874: bitstring;
                                                        {8721}new ST_6875: bitstring;
                                                        {8722}new TTL_6876: bitstring;
                                                        {8723}let m2_6877: bitstring = (OpenSecureChannelResponse,Ns_6874,ST_6875,TTL_6876) in
                                                        {8724}event beginSrv(Sess_5018,Cli_5016,Ns_6874);
                                                        {8725}out(c, (m2_6877,sign(h(m2_6877),skSess_6440)));
                                                        {8726}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8727}event endSrv(Cli_5016,Sess_5018,Nc_6873)
                                                )
                                                else
                                                    {8728}let pkDisco_6878: bitstring = pub(sk(Disco_5017)) in
                                                    {8729}in(c, (=pkCli_6847,em1_6879: bitstring,sigM1_6880: bitstring));
                                                    {8730}let m1_6881: bitstring = em1_6879 in
                                                    {8731}if (verify(h(m1_6881),sigM1_6880,pkCli_6847) <> true) then
                                                        0
                                                    else
                                                        {8732}let (=OpenSecureChannelRequest,=pkCli_6847,Nc_6882: bitstring) = m1_6881 in
                                                        {8733}new Ns_6883: bitstring;
                                                        {8734}new ST_6884: bitstring;
                                                        {8735}new TTL_6885: bitstring;
                                                        {8736}let m2_6886: bitstring = (OpenSecureChannelResponse,Ns_6883,ST_6884,TTL_6885) in
                                                        {8737}event beginSrv(Sess_5018,Cli_5016,Ns_6883);
                                                        {8738}out(c, (m2_6886,sign(h(m2_6886),skSess_6440)));
                                                        {8739}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8740}event endSrv(Cli_5016,Sess_5018,Nc_6882)
                                            )
                                            else
                                                {8741}let pkDisco_6887: bitstring = fail-any in
                                                {8742}in(c, (=pkCli_6847,em1_6888: bitstring,sigM1_6889: bitstring));
                                                {8743}let m1_6890: bitstring = em1_6888 in
                                                {8744}if (verify(h(m1_6890),sigM1_6889,pkCli_6847) <> true) then
                                                    0
                                                else
                                                    {8745}let (=OpenSecureChannelRequest,=pkCli_6847,Nc_6891: bitstring) = m1_6890 in
                                                    {8746}new Ns_6892: bitstring;
                                                    {8747}new ST_6893: bitstring;
                                                    {8748}new TTL_6894: bitstring;
                                                    {8749}let m2_6895: bitstring = (OpenSecureChannelResponse,Ns_6892,ST_6893,TTL_6894) in
                                                    {8750}event beginSrv(Sess_5018,Cli_5016,Ns_6892);
                                                    {8751}out(c, (m2_6895,sign(h(m2_6895),skSess_6440)));
                                                    {8752}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8753}event endSrv(Cli_5016,Sess_5018,Nc_6891)
                                    )
                                    else
                                        {8754}let pkDisco_6896: bitstring = fail-any in
                                        {8755}in(c, (=pkCli_6847,em1_6897: bitstring,sigM1_6898: bitstring));
                                        {8756}let m1_6899: bitstring = em1_6897 in
                                        {8757}if (verify(h(m1_6899),sigM1_6898,pkCli_6847) <> true) then
                                            0
                                        else
                                            {8758}let (=OpenSecureChannelRequest,=pkCli_6847,Nc_6900: bitstring) = m1_6899 in
                                            {8759}new Ns_6901: bitstring;
                                            {8760}new ST_6902: bitstring;
                                            {8761}new TTL_6903: bitstring;
                                            {8762}let m2_6904: bitstring = (OpenSecureChannelResponse,Ns_6901,ST_6902,TTL_6903) in
                                            {8763}event beginSrv(Sess_5018,Cli_5016,Ns_6901);
                                            {8764}out(c, (m2_6904,sign(h(m2_6904),skSess_6440)));
                                            {8765}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {8766}event endSrv(Cli_5016,Sess_5018,Nc_6900)
                            )
                            else
                                {8767}let pkDisco_6905: bitstring = fail-any in
                                {8768}in(c, (=pkCli_6847,em1_6906: bitstring,sigM1_6907: bitstring));
                                {8769}let m1_6908: bitstring = em1_6906 in
                                {8770}if (verify(h(m1_6908),sigM1_6907,pkCli_6847) <> true) then
                                    0
                                else
                                    {8771}let (=OpenSecureChannelRequest,=pkCli_6847,Nc_6909: bitstring) = m1_6908 in
                                    {8772}new Ns_6910: bitstring;
                                    {8773}new ST_6911: bitstring;
                                    {8774}new TTL_6912: bitstring;
                                    {8775}let m2_6913: bitstring = (OpenSecureChannelResponse,Ns_6910,ST_6911,TTL_6912) in
                                    {8776}event beginSrv(Sess_5018,Cli_5016,Ns_6910);
                                    {8777}out(c, (m2_6913,sign(h(m2_6913),skSess_6440)));
                                    {8778}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {8779}event endSrv(Cli_5016,Sess_5018,Nc_6909)
            )
            else
                {8780}let skSess_6914: bitstring = fail-any in
                {8781}let pkSess_6915: bitstring = pub(skSess_6914) in
                {8782}let v_6916: bool = (Cli_5016 = A) in
                (
                    {8783}if v_6916 then
                    (
                        {8784}let pkCli_6917: bitstring = pub(skA) in
                        {8785}let v_6918: bool = (Disco_5017 = A) in
                        (
                            {8786}if v_6918 then
                            (
                                {8787}let pkDisco_6919: bitstring = pub(skA) in
                                {8788}in(c, (=pkCli_6917,em1_6920: bitstring,sigM1_6921: bitstring));
                                {8789}let m1_6922: bitstring = em1_6920 in
                                {8790}if (verify(h(m1_6922),sigM1_6921,pkCli_6917) <> true) then
                                    0
                                else
                                    {8791}let (=OpenSecureChannelRequest,=pkCli_6917,Nc_6923: bitstring) = m1_6922 in
                                    {8792}new Ns_6924: bitstring;
                                    {8793}new ST_6925: bitstring;
                                    {8794}new TTL_6926: bitstring;
                                    {8795}let m2_6927: bitstring = (OpenSecureChannelResponse,Ns_6924,ST_6925,TTL_6926) in
                                    {8796}event beginSrv(Sess_5018,Cli_5016,Ns_6924);
                                    {8797}out(c, (m2_6927,sign(h(m2_6927),skSess_6914)));
                                    {8798}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {8799}event endSrv(Cli_5016,Sess_5018,Nc_6923)
                            )
                            else
                                {8800}let v_6928: bool = (Disco_5017 = B) in
                                (
                                    {8801}if v_6928 then
                                    (
                                        {8802}let pkDisco_6929: bitstring = pub(skB) in
                                        {8803}in(c, (=pkCli_6917,em1_6930: bitstring,sigM1_6931: bitstring));
                                        {8804}let m1_6932: bitstring = em1_6930 in
                                        {8805}if (verify(h(m1_6932),sigM1_6931,pkCli_6917) <> true) then
                                            0
                                        else
                                            {8806}let (=OpenSecureChannelRequest,=pkCli_6917,Nc_6933: bitstring) = m1_6932 in
                                            {8807}new Ns_6934: bitstring;
                                            {8808}new ST_6935: bitstring;
                                            {8809}new TTL_6936: bitstring;
                                            {8810}let m2_6937: bitstring = (OpenSecureChannelResponse,Ns_6934,ST_6935,TTL_6936) in
                                            {8811}event beginSrv(Sess_5018,Cli_5016,Ns_6934);
                                            {8812}out(c, (m2_6937,sign(h(m2_6937),skSess_6914)));
                                            {8813}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {8814}event endSrv(Cli_5016,Sess_5018,Nc_6933)
                                    )
                                    else
                                        {8815}let v_6938: bool = (Disco_5017 = C) in
                                        (
                                            {8816}if v_6938 then
                                            (
                                                {8817}let pkDisco_6939: bitstring = pub(skC) in
                                                {8818}in(c, (=pkCli_6917,em1_6940: bitstring,sigM1_6941: bitstring));
                                                {8819}let m1_6942: bitstring = em1_6940 in
                                                {8820}if (verify(h(m1_6942),sigM1_6941,pkCli_6917) <> true) then
                                                    0
                                                else
                                                    {8821}let (=OpenSecureChannelRequest,=pkCli_6917,Nc_6943: bitstring) = m1_6942 in
                                                    {8822}new Ns_6944: bitstring;
                                                    {8823}new ST_6945: bitstring;
                                                    {8824}new TTL_6946: bitstring;
                                                    {8825}let m2_6947: bitstring = (OpenSecureChannelResponse,Ns_6944,ST_6945,TTL_6946) in
                                                    {8826}event beginSrv(Sess_5018,Cli_5016,Ns_6944);
                                                    {8827}out(c, (m2_6947,sign(h(m2_6947),skSess_6914)));
                                                    {8828}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8829}event endSrv(Cli_5016,Sess_5018,Nc_6943)
                                            )
                                            else
                                                {8830}let pkDisco_6948: bitstring = pub(sk(Disco_5017)) in
                                                {8831}in(c, (=pkCli_6917,em1_6949: bitstring,sigM1_6950: bitstring));
                                                {8832}let m1_6951: bitstring = em1_6949 in
                                                {8833}if (verify(h(m1_6951),sigM1_6950,pkCli_6917) <> true) then
                                                    0
                                                else
                                                    {8834}let (=OpenSecureChannelRequest,=pkCli_6917,Nc_6952: bitstring) = m1_6951 in
                                                    {8835}new Ns_6953: bitstring;
                                                    {8836}new ST_6954: bitstring;
                                                    {8837}new TTL_6955: bitstring;
                                                    {8838}let m2_6956: bitstring = (OpenSecureChannelResponse,Ns_6953,ST_6954,TTL_6955) in
                                                    {8839}event beginSrv(Sess_5018,Cli_5016,Ns_6953);
                                                    {8840}out(c, (m2_6956,sign(h(m2_6956),skSess_6914)));
                                                    {8841}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8842}event endSrv(Cli_5016,Sess_5018,Nc_6952)
                                        )
                                        else
                                            {8843}let pkDisco_6957: bitstring = fail-any in
                                            {8844}in(c, (=pkCli_6917,em1_6958: bitstring,sigM1_6959: bitstring));
                                            {8845}let m1_6960: bitstring = em1_6958 in
                                            {8846}if (verify(h(m1_6960),sigM1_6959,pkCli_6917) <> true) then
                                                0
                                            else
                                                {8847}let (=OpenSecureChannelRequest,=pkCli_6917,Nc_6961: bitstring) = m1_6960 in
                                                {8848}new Ns_6962: bitstring;
                                                {8849}new ST_6963: bitstring;
                                                {8850}new TTL_6964: bitstring;
                                                {8851}let m2_6965: bitstring = (OpenSecureChannelResponse,Ns_6962,ST_6963,TTL_6964) in
                                                {8852}event beginSrv(Sess_5018,Cli_5016,Ns_6962);
                                                {8853}out(c, (m2_6965,sign(h(m2_6965),skSess_6914)));
                                                {8854}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {8855}event endSrv(Cli_5016,Sess_5018,Nc_6961)
                                )
                                else
                                    {8856}let pkDisco_6966: bitstring = fail-any in
                                    {8857}in(c, (=pkCli_6917,em1_6967: bitstring,sigM1_6968: bitstring));
                                    {8858}let m1_6969: bitstring = em1_6967 in
                                    {8859}if (verify(h(m1_6969),sigM1_6968,pkCli_6917) <> true) then
                                        0
                                    else
                                        {8860}let (=OpenSecureChannelRequest,=pkCli_6917,Nc_6970: bitstring) = m1_6969 in
                                        {8861}new Ns_6971: bitstring;
                                        {8862}new ST_6972: bitstring;
                                        {8863}new TTL_6973: bitstring;
                                        {8864}let m2_6974: bitstring = (OpenSecureChannelResponse,Ns_6971,ST_6972,TTL_6973) in
                                        {8865}event beginSrv(Sess_5018,Cli_5016,Ns_6971);
                                        {8866}out(c, (m2_6974,sign(h(m2_6974),skSess_6914)));
                                        {8867}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {8868}event endSrv(Cli_5016,Sess_5018,Nc_6970)
                        )
                        else
                            {8869}let pkDisco_6975: bitstring = fail-any in
                            {8870}in(c, (=pkCli_6917,em1_6976: bitstring,sigM1_6977: bitstring));
                            {8871}let m1_6978: bitstring = em1_6976 in
                            {8872}if (verify(h(m1_6978),sigM1_6977,pkCli_6917) <> true) then
                                0
                            else
                                {8873}let (=OpenSecureChannelRequest,=pkCli_6917,Nc_6979: bitstring) = m1_6978 in
                                {8874}new Ns_6980: bitstring;
                                {8875}new ST_6981: bitstring;
                                {8876}new TTL_6982: bitstring;
                                {8877}let m2_6983: bitstring = (OpenSecureChannelResponse,Ns_6980,ST_6981,TTL_6982) in
                                {8878}event beginSrv(Sess_5018,Cli_5016,Ns_6980);
                                {8879}out(c, (m2_6983,sign(h(m2_6983),skSess_6914)));
                                {8880}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {8881}event endSrv(Cli_5016,Sess_5018,Nc_6979)
                    )
                    else
                        {8882}let v_6984: bool = (Cli_5016 = B) in
                        (
                            {8883}if v_6984 then
                            (
                                {8884}let pkCli_6985: bitstring = pub(skB) in
                                {8885}let v_6986: bool = (Disco_5017 = A) in
                                (
                                    {8886}if v_6986 then
                                    (
                                        {8887}let pkDisco_6987: bitstring = pub(skA) in
                                        {8888}in(c, (=pkCli_6985,em1_6988: bitstring,sigM1_6989: bitstring));
                                        {8889}let m1_6990: bitstring = em1_6988 in
                                        {8890}if (verify(h(m1_6990),sigM1_6989,pkCli_6985) <> true) then
                                            0
                                        else
                                            {8891}let (=OpenSecureChannelRequest,=pkCli_6985,Nc_6991: bitstring) = m1_6990 in
                                            {8892}new Ns_6992: bitstring;
                                            {8893}new ST_6993: bitstring;
                                            {8894}new TTL_6994: bitstring;
                                            {8895}let m2_6995: bitstring = (OpenSecureChannelResponse,Ns_6992,ST_6993,TTL_6994) in
                                            {8896}event beginSrv(Sess_5018,Cli_5016,Ns_6992);
                                            {8897}out(c, (m2_6995,sign(h(m2_6995),skSess_6914)));
                                            {8898}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {8899}event endSrv(Cli_5016,Sess_5018,Nc_6991)
                                    )
                                    else
                                        {8900}let v_6996: bool = (Disco_5017 = B) in
                                        (
                                            {8901}if v_6996 then
                                            (
                                                {8902}let pkDisco_6997: bitstring = pub(skB) in
                                                {8903}in(c, (=pkCli_6985,em1_6998: bitstring,sigM1_6999: bitstring));
                                                {8904}let m1_7000: bitstring = em1_6998 in
                                                {8905}if (verify(h(m1_7000),sigM1_6999,pkCli_6985) <> true) then
                                                    0
                                                else
                                                    {8906}let (=OpenSecureChannelRequest,=pkCli_6985,Nc_7001: bitstring) = m1_7000 in
                                                    {8907}new Ns_7002: bitstring;
                                                    {8908}new ST_7003: bitstring;
                                                    {8909}new TTL_7004: bitstring;
                                                    {8910}let m2_7005: bitstring = (OpenSecureChannelResponse,Ns_7002,ST_7003,TTL_7004) in
                                                    {8911}event beginSrv(Sess_5018,Cli_5016,Ns_7002);
                                                    {8912}out(c, (m2_7005,sign(h(m2_7005),skSess_6914)));
                                                    {8913}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8914}event endSrv(Cli_5016,Sess_5018,Nc_7001)
                                            )
                                            else
                                                {8915}let v_7006: bool = (Disco_5017 = C) in
                                                (
                                                    {8916}if v_7006 then
                                                    (
                                                        {8917}let pkDisco_7007: bitstring = pub(skC) in
                                                        {8918}in(c, (=pkCli_6985,em1_7008: bitstring,sigM1_7009: bitstring));
                                                        {8919}let m1_7010: bitstring = em1_7008 in
                                                        {8920}if (verify(h(m1_7010),sigM1_7009,pkCli_6985) <> true) then
                                                            0
                                                        else
                                                            {8921}let (=OpenSecureChannelRequest,=pkCli_6985,Nc_7011: bitstring) = m1_7010 in
                                                            {8922}new Ns_7012: bitstring;
                                                            {8923}new ST_7013: bitstring;
                                                            {8924}new TTL_7014: bitstring;
                                                            {8925}let m2_7015: bitstring = (OpenSecureChannelResponse,Ns_7012,ST_7013,TTL_7014) in
                                                            {8926}event beginSrv(Sess_5018,Cli_5016,Ns_7012);
                                                            {8927}out(c, (m2_7015,sign(h(m2_7015),skSess_6914)));
                                                            {8928}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8929}event endSrv(Cli_5016,Sess_5018,Nc_7011)
                                                    )
                                                    else
                                                        {8930}let pkDisco_7016: bitstring = pub(sk(Disco_5017)) in
                                                        {8931}in(c, (=pkCli_6985,em1_7017: bitstring,sigM1_7018: bitstring));
                                                        {8932}let m1_7019: bitstring = em1_7017 in
                                                        {8933}if (verify(h(m1_7019),sigM1_7018,pkCli_6985) <> true) then
                                                            0
                                                        else
                                                            {8934}let (=OpenSecureChannelRequest,=pkCli_6985,Nc_7020: bitstring) = m1_7019 in
                                                            {8935}new Ns_7021: bitstring;
                                                            {8936}new ST_7022: bitstring;
                                                            {8937}new TTL_7023: bitstring;
                                                            {8938}let m2_7024: bitstring = (OpenSecureChannelResponse,Ns_7021,ST_7022,TTL_7023) in
                                                            {8939}event beginSrv(Sess_5018,Cli_5016,Ns_7021);
                                                            {8940}out(c, (m2_7024,sign(h(m2_7024),skSess_6914)));
                                                            {8941}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {8942}event endSrv(Cli_5016,Sess_5018,Nc_7020)
                                                )
                                                else
                                                    {8943}let pkDisco_7025: bitstring = fail-any in
                                                    {8944}in(c, (=pkCli_6985,em1_7026: bitstring,sigM1_7027: bitstring));
                                                    {8945}let m1_7028: bitstring = em1_7026 in
                                                    {8946}if (verify(h(m1_7028),sigM1_7027,pkCli_6985) <> true) then
                                                        0
                                                    else
                                                        {8947}let (=OpenSecureChannelRequest,=pkCli_6985,Nc_7029: bitstring) = m1_7028 in
                                                        {8948}new Ns_7030: bitstring;
                                                        {8949}new ST_7031: bitstring;
                                                        {8950}new TTL_7032: bitstring;
                                                        {8951}let m2_7033: bitstring = (OpenSecureChannelResponse,Ns_7030,ST_7031,TTL_7032) in
                                                        {8952}event beginSrv(Sess_5018,Cli_5016,Ns_7030);
                                                        {8953}out(c, (m2_7033,sign(h(m2_7033),skSess_6914)));
                                                        {8954}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {8955}event endSrv(Cli_5016,Sess_5018,Nc_7029)
                                        )
                                        else
                                            {8956}let pkDisco_7034: bitstring = fail-any in
                                            {8957}in(c, (=pkCli_6985,em1_7035: bitstring,sigM1_7036: bitstring));
                                            {8958}let m1_7037: bitstring = em1_7035 in
                                            {8959}if (verify(h(m1_7037),sigM1_7036,pkCli_6985) <> true) then
                                                0
                                            else
                                                {8960}let (=OpenSecureChannelRequest,=pkCli_6985,Nc_7038: bitstring) = m1_7037 in
                                                {8961}new Ns_7039: bitstring;
                                                {8962}new ST_7040: bitstring;
                                                {8963}new TTL_7041: bitstring;
                                                {8964}let m2_7042: bitstring = (OpenSecureChannelResponse,Ns_7039,ST_7040,TTL_7041) in
                                                {8965}event beginSrv(Sess_5018,Cli_5016,Ns_7039);
                                                {8966}out(c, (m2_7042,sign(h(m2_7042),skSess_6914)));
                                                {8967}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {8968}event endSrv(Cli_5016,Sess_5018,Nc_7038)
                                )
                                else
                                    {8969}let pkDisco_7043: bitstring = fail-any in
                                    {8970}in(c, (=pkCli_6985,em1_7044: bitstring,sigM1_7045: bitstring));
                                    {8971}let m1_7046: bitstring = em1_7044 in
                                    {8972}if (verify(h(m1_7046),sigM1_7045,pkCli_6985) <> true) then
                                        0
                                    else
                                        {8973}let (=OpenSecureChannelRequest,=pkCli_6985,Nc_7047: bitstring) = m1_7046 in
                                        {8974}new Ns_7048: bitstring;
                                        {8975}new ST_7049: bitstring;
                                        {8976}new TTL_7050: bitstring;
                                        {8977}let m2_7051: bitstring = (OpenSecureChannelResponse,Ns_7048,ST_7049,TTL_7050) in
                                        {8978}event beginSrv(Sess_5018,Cli_5016,Ns_7048);
                                        {8979}out(c, (m2_7051,sign(h(m2_7051),skSess_6914)));
                                        {8980}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {8981}event endSrv(Cli_5016,Sess_5018,Nc_7047)
                            )
                            else
                                {8982}let v_7052: bool = (Cli_5016 = C) in
                                (
                                    {8983}if v_7052 then
                                    (
                                        {8984}let pkCli_7053: bitstring = pub(skC) in
                                        {8985}let v_7054: bool = (Disco_5017 = A) in
                                        (
                                            {8986}if v_7054 then
                                            (
                                                {8987}let pkDisco_7055: bitstring = pub(skA) in
                                                {8988}in(c, (=pkCli_7053,em1_7056: bitstring,sigM1_7057: bitstring));
                                                {8989}let m1_7058: bitstring = em1_7056 in
                                                {8990}if (verify(h(m1_7058),sigM1_7057,pkCli_7053) <> true) then
                                                    0
                                                else
                                                    {8991}let (=OpenSecureChannelRequest,=pkCli_7053,Nc_7059: bitstring) = m1_7058 in
                                                    {8992}new Ns_7060: bitstring;
                                                    {8993}new ST_7061: bitstring;
                                                    {8994}new TTL_7062: bitstring;
                                                    {8995}let m2_7063: bitstring = (OpenSecureChannelResponse,Ns_7060,ST_7061,TTL_7062) in
                                                    {8996}event beginSrv(Sess_5018,Cli_5016,Ns_7060);
                                                    {8997}out(c, (m2_7063,sign(h(m2_7063),skSess_6914)));
                                                    {8998}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {8999}event endSrv(Cli_5016,Sess_5018,Nc_7059)
                                            )
                                            else
                                                {9000}let v_7064: bool = (Disco_5017 = B) in
                                                (
                                                    {9001}if v_7064 then
                                                    (
                                                        {9002}let pkDisco_7065: bitstring = pub(skB) in
                                                        {9003}in(c, (=pkCli_7053,em1_7066: bitstring,sigM1_7067: bitstring));
                                                        {9004}let m1_7068: bitstring = em1_7066 in
                                                        {9005}if (verify(h(m1_7068),sigM1_7067,pkCli_7053) <> true) then
                                                            0
                                                        else
                                                            {9006}let (=OpenSecureChannelRequest,=pkCli_7053,Nc_7069: bitstring) = m1_7068 in
                                                            {9007}new Ns_7070: bitstring;
                                                            {9008}new ST_7071: bitstring;
                                                            {9009}new TTL_7072: bitstring;
                                                            {9010}let m2_7073: bitstring = (OpenSecureChannelResponse,Ns_7070,ST_7071,TTL_7072) in
                                                            {9011}event beginSrv(Sess_5018,Cli_5016,Ns_7070);
                                                            {9012}out(c, (m2_7073,sign(h(m2_7073),skSess_6914)));
                                                            {9013}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {9014}event endSrv(Cli_5016,Sess_5018,Nc_7069)
                                                    )
                                                    else
                                                        {9015}let v_7074: bool = (Disco_5017 = C) in
                                                        (
                                                            {9016}if v_7074 then
                                                            (
                                                                {9017}let pkDisco_7075: bitstring = pub(skC) in
                                                                {9018}in(c, (=pkCli_7053,em1_7076: bitstring,sigM1_7077: bitstring));
                                                                {9019}let m1_7078: bitstring = em1_7076 in
                                                                {9020}if (verify(h(m1_7078),sigM1_7077,pkCli_7053) <> true) then
                                                                    0
                                                                else
                                                                    {9021}let (=OpenSecureChannelRequest,=pkCli_7053,Nc_7079: bitstring) = m1_7078 in
                                                                    {9022}new Ns_7080: bitstring;
                                                                    {9023}new ST_7081: bitstring;
                                                                    {9024}new TTL_7082: bitstring;
                                                                    {9025}let m2_7083: bitstring = (OpenSecureChannelResponse,Ns_7080,ST_7081,TTL_7082) in
                                                                    {9026}event beginSrv(Sess_5018,Cli_5016,Ns_7080);
                                                                    {9027}out(c, (m2_7083,sign(h(m2_7083),skSess_6914)));
                                                                    {9028}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {9029}event endSrv(Cli_5016,Sess_5018,Nc_7079)
                                                            )
                                                            else
                                                                {9030}let pkDisco_7084: bitstring = pub(sk(Disco_5017)) in
                                                                {9031}in(c, (=pkCli_7053,em1_7085: bitstring,sigM1_7086: bitstring));
                                                                {9032}let m1_7087: bitstring = em1_7085 in
                                                                {9033}if (verify(h(m1_7087),sigM1_7086,pkCli_7053) <> true) then
                                                                    0
                                                                else
                                                                    {9034}let (=OpenSecureChannelRequest,=pkCli_7053,Nc_7088: bitstring) = m1_7087 in
                                                                    {9035}new Ns_7089: bitstring;
                                                                    {9036}new ST_7090: bitstring;
                                                                    {9037}new TTL_7091: bitstring;
                                                                    {9038}let m2_7092: bitstring = (OpenSecureChannelResponse,Ns_7089,ST_7090,TTL_7091) in
                                                                    {9039}event beginSrv(Sess_5018,Cli_5016,Ns_7089);
                                                                    {9040}out(c, (m2_7092,sign(h(m2_7092),skSess_6914)));
                                                                    {9041}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {9042}event endSrv(Cli_5016,Sess_5018,Nc_7088)
                                                        )
                                                        else
                                                            {9043}let pkDisco_7093: bitstring = fail-any in
                                                            {9044}in(c, (=pkCli_7053,em1_7094: bitstring,sigM1_7095: bitstring));
                                                            {9045}let m1_7096: bitstring = em1_7094 in
                                                            {9046}if (verify(h(m1_7096),sigM1_7095,pkCli_7053) <> true) then
                                                                0
                                                            else
                                                                {9047}let (=OpenSecureChannelRequest,=pkCli_7053,Nc_7097: bitstring) = m1_7096 in
                                                                {9048}new Ns_7098: bitstring;
                                                                {9049}new ST_7099: bitstring;
                                                                {9050}new TTL_7100: bitstring;
                                                                {9051}let m2_7101: bitstring = (OpenSecureChannelResponse,Ns_7098,ST_7099,TTL_7100) in
                                                                {9052}event beginSrv(Sess_5018,Cli_5016,Ns_7098);
                                                                {9053}out(c, (m2_7101,sign(h(m2_7101),skSess_6914)));
                                                                {9054}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {9055}event endSrv(Cli_5016,Sess_5018,Nc_7097)
                                                )
                                                else
                                                    {9056}let pkDisco_7102: bitstring = fail-any in
                                                    {9057}in(c, (=pkCli_7053,em1_7103: bitstring,sigM1_7104: bitstring));
                                                    {9058}let m1_7105: bitstring = em1_7103 in
                                                    {9059}if (verify(h(m1_7105),sigM1_7104,pkCli_7053) <> true) then
                                                        0
                                                    else
                                                        {9060}let (=OpenSecureChannelRequest,=pkCli_7053,Nc_7106: bitstring) = m1_7105 in
                                                        {9061}new Ns_7107: bitstring;
                                                        {9062}new ST_7108: bitstring;
                                                        {9063}new TTL_7109: bitstring;
                                                        {9064}let m2_7110: bitstring = (OpenSecureChannelResponse,Ns_7107,ST_7108,TTL_7109) in
                                                        {9065}event beginSrv(Sess_5018,Cli_5016,Ns_7107);
                                                        {9066}out(c, (m2_7110,sign(h(m2_7110),skSess_6914)));
                                                        {9067}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9068}event endSrv(Cli_5016,Sess_5018,Nc_7106)
                                        )
                                        else
                                            {9069}let pkDisco_7111: bitstring = fail-any in
                                            {9070}in(c, (=pkCli_7053,em1_7112: bitstring,sigM1_7113: bitstring));
                                            {9071}let m1_7114: bitstring = em1_7112 in
                                            {9072}if (verify(h(m1_7114),sigM1_7113,pkCli_7053) <> true) then
                                                0
                                            else
                                                {9073}let (=OpenSecureChannelRequest,=pkCli_7053,Nc_7115: bitstring) = m1_7114 in
                                                {9074}new Ns_7116: bitstring;
                                                {9075}new ST_7117: bitstring;
                                                {9076}new TTL_7118: bitstring;
                                                {9077}let m2_7119: bitstring = (OpenSecureChannelResponse,Ns_7116,ST_7117,TTL_7118) in
                                                {9078}event beginSrv(Sess_5018,Cli_5016,Ns_7116);
                                                {9079}out(c, (m2_7119,sign(h(m2_7119),skSess_6914)));
                                                {9080}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9081}event endSrv(Cli_5016,Sess_5018,Nc_7115)
                                    )
                                    else
                                        {9082}let pkCli_7120: bitstring = pub(sk(Cli_5016)) in
                                        {9083}let v_7121: bool = (Disco_5017 = A) in
                                        (
                                            {9084}if v_7121 then
                                            (
                                                {9085}let pkDisco_7122: bitstring = pub(skA) in
                                                {9086}in(c, (=pkCli_7120,em1_7123: bitstring,sigM1_7124: bitstring));
                                                {9087}let m1_7125: bitstring = em1_7123 in
                                                {9088}if (verify(h(m1_7125),sigM1_7124,pkCli_7120) <> true) then
                                                    0
                                                else
                                                    {9089}let (=OpenSecureChannelRequest,=pkCli_7120,Nc_7126: bitstring) = m1_7125 in
                                                    {9090}new Ns_7127: bitstring;
                                                    {9091}new ST_7128: bitstring;
                                                    {9092}new TTL_7129: bitstring;
                                                    {9093}let m2_7130: bitstring = (OpenSecureChannelResponse,Ns_7127,ST_7128,TTL_7129) in
                                                    {9094}event beginSrv(Sess_5018,Cli_5016,Ns_7127);
                                                    {9095}out(c, (m2_7130,sign(h(m2_7130),skSess_6914)));
                                                    {9096}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9097}event endSrv(Cli_5016,Sess_5018,Nc_7126)
                                            )
                                            else
                                                {9098}let v_7131: bool = (Disco_5017 = B) in
                                                (
                                                    {9099}if v_7131 then
                                                    (
                                                        {9100}let pkDisco_7132: bitstring = pub(skB) in
                                                        {9101}in(c, (=pkCli_7120,em1_7133: bitstring,sigM1_7134: bitstring));
                                                        {9102}let m1_7135: bitstring = em1_7133 in
                                                        {9103}if (verify(h(m1_7135),sigM1_7134,pkCli_7120) <> true) then
                                                            0
                                                        else
                                                            {9104}let (=OpenSecureChannelRequest,=pkCli_7120,Nc_7136: bitstring) = m1_7135 in
                                                            {9105}new Ns_7137: bitstring;
                                                            {9106}new ST_7138: bitstring;
                                                            {9107}new TTL_7139: bitstring;
                                                            {9108}let m2_7140: bitstring = (OpenSecureChannelResponse,Ns_7137,ST_7138,TTL_7139) in
                                                            {9109}event beginSrv(Sess_5018,Cli_5016,Ns_7137);
                                                            {9110}out(c, (m2_7140,sign(h(m2_7140),skSess_6914)));
                                                            {9111}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {9112}event endSrv(Cli_5016,Sess_5018,Nc_7136)
                                                    )
                                                    else
                                                        {9113}let v_7141: bool = (Disco_5017 = C) in
                                                        (
                                                            {9114}if v_7141 then
                                                            (
                                                                {9115}let pkDisco_7142: bitstring = pub(skC) in
                                                                {9116}in(c, (=pkCli_7120,em1_7143: bitstring,sigM1_7144: bitstring));
                                                                {9117}let m1_7145: bitstring = em1_7143 in
                                                                {9118}if (verify(h(m1_7145),sigM1_7144,pkCli_7120) <> true) then
                                                                    0
                                                                else
                                                                    {9119}let (=OpenSecureChannelRequest,=pkCli_7120,Nc_7146: bitstring) = m1_7145 in
                                                                    {9120}new Ns_7147: bitstring;
                                                                    {9121}new ST_7148: bitstring;
                                                                    {9122}new TTL_7149: bitstring;
                                                                    {9123}let m2_7150: bitstring = (OpenSecureChannelResponse,Ns_7147,ST_7148,TTL_7149) in
                                                                    {9124}event beginSrv(Sess_5018,Cli_5016,Ns_7147);
                                                                    {9125}out(c, (m2_7150,sign(h(m2_7150),skSess_6914)));
                                                                    {9126}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {9127}event endSrv(Cli_5016,Sess_5018,Nc_7146)
                                                            )
                                                            else
                                                                {9128}let pkDisco_7151: bitstring = pub(sk(Disco_5017)) in
                                                                {9129}in(c, (=pkCli_7120,em1_7152: bitstring,sigM1_7153: bitstring));
                                                                {9130}let m1_7154: bitstring = em1_7152 in
                                                                {9131}if (verify(h(m1_7154),sigM1_7153,pkCli_7120) <> true) then
                                                                    0
                                                                else
                                                                    {9132}let (=OpenSecureChannelRequest,=pkCli_7120,Nc_7155: bitstring) = m1_7154 in
                                                                    {9133}new Ns_7156: bitstring;
                                                                    {9134}new ST_7157: bitstring;
                                                                    {9135}new TTL_7158: bitstring;
                                                                    {9136}let m2_7159: bitstring = (OpenSecureChannelResponse,Ns_7156,ST_7157,TTL_7158) in
                                                                    {9137}event beginSrv(Sess_5018,Cli_5016,Ns_7156);
                                                                    {9138}out(c, (m2_7159,sign(h(m2_7159),skSess_6914)));
                                                                    {9139}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                    {9140}event endSrv(Cli_5016,Sess_5018,Nc_7155)
                                                        )
                                                        else
                                                            {9141}let pkDisco_7160: bitstring = fail-any in
                                                            {9142}in(c, (=pkCli_7120,em1_7161: bitstring,sigM1_7162: bitstring));
                                                            {9143}let m1_7163: bitstring = em1_7161 in
                                                            {9144}if (verify(h(m1_7163),sigM1_7162,pkCli_7120) <> true) then
                                                                0
                                                            else
                                                                {9145}let (=OpenSecureChannelRequest,=pkCli_7120,Nc_7164: bitstring) = m1_7163 in
                                                                {9146}new Ns_7165: bitstring;
                                                                {9147}new ST_7166: bitstring;
                                                                {9148}new TTL_7167: bitstring;
                                                                {9149}let m2_7168: bitstring = (OpenSecureChannelResponse,Ns_7165,ST_7166,TTL_7167) in
                                                                {9150}event beginSrv(Sess_5018,Cli_5016,Ns_7165);
                                                                {9151}out(c, (m2_7168,sign(h(m2_7168),skSess_6914)));
                                                                {9152}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {9153}event endSrv(Cli_5016,Sess_5018,Nc_7164)
                                                )
                                                else
                                                    {9154}let pkDisco_7169: bitstring = fail-any in
                                                    {9155}in(c, (=pkCli_7120,em1_7170: bitstring,sigM1_7171: bitstring));
                                                    {9156}let m1_7172: bitstring = em1_7170 in
                                                    {9157}if (verify(h(m1_7172),sigM1_7171,pkCli_7120) <> true) then
                                                        0
                                                    else
                                                        {9158}let (=OpenSecureChannelRequest,=pkCli_7120,Nc_7173: bitstring) = m1_7172 in
                                                        {9159}new Ns_7174: bitstring;
                                                        {9160}new ST_7175: bitstring;
                                                        {9161}new TTL_7176: bitstring;
                                                        {9162}let m2_7177: bitstring = (OpenSecureChannelResponse,Ns_7174,ST_7175,TTL_7176) in
                                                        {9163}event beginSrv(Sess_5018,Cli_5016,Ns_7174);
                                                        {9164}out(c, (m2_7177,sign(h(m2_7177),skSess_6914)));
                                                        {9165}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9166}event endSrv(Cli_5016,Sess_5018,Nc_7173)
                                        )
                                        else
                                            {9167}let pkDisco_7178: bitstring = fail-any in
                                            {9168}in(c, (=pkCli_7120,em1_7179: bitstring,sigM1_7180: bitstring));
                                            {9169}let m1_7181: bitstring = em1_7179 in
                                            {9170}if (verify(h(m1_7181),sigM1_7180,pkCli_7120) <> true) then
                                                0
                                            else
                                                {9171}let (=OpenSecureChannelRequest,=pkCli_7120,Nc_7182: bitstring) = m1_7181 in
                                                {9172}new Ns_7183: bitstring;
                                                {9173}new ST_7184: bitstring;
                                                {9174}new TTL_7185: bitstring;
                                                {9175}let m2_7186: bitstring = (OpenSecureChannelResponse,Ns_7183,ST_7184,TTL_7185) in
                                                {9176}event beginSrv(Sess_5018,Cli_5016,Ns_7183);
                                                {9177}out(c, (m2_7186,sign(h(m2_7186),skSess_6914)));
                                                {9178}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9179}event endSrv(Cli_5016,Sess_5018,Nc_7182)
                                )
                                else
                                    {9180}let pkCli_7187: bitstring = fail-any in
                                    {9181}let v_7188: bool = (Disco_5017 = A) in
                                    (
                                        {9182}if v_7188 then
                                        (
                                            {9183}let pkDisco_7189: bitstring = pub(skA) in
                                            {9184}in(c, (=pkCli_7187,em1_7190: bitstring,sigM1_7191: bitstring));
                                            {9185}let m1_7192: bitstring = em1_7190 in
                                            {9186}if (verify(h(m1_7192),sigM1_7191,pkCli_7187) <> true) then
                                                0
                                            else
                                                {9187}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7193: bitstring) = m1_7192 in
                                                {9188}new Ns_7194: bitstring;
                                                {9189}new ST_7195: bitstring;
                                                {9190}new TTL_7196: bitstring;
                                                {9191}let m2_7197: bitstring = (OpenSecureChannelResponse,Ns_7194,ST_7195,TTL_7196) in
                                                {9192}event beginSrv(Sess_5018,Cli_5016,Ns_7194);
                                                {9193}out(c, (m2_7197,sign(h(m2_7197),skSess_6914)));
                                                {9194}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9195}event endSrv(Cli_5016,Sess_5018,Nc_7193)
                                        )
                                        else
                                            {9196}let v_7198: bool = (Disco_5017 = B) in
                                            (
                                                {9197}if v_7198 then
                                                (
                                                    {9198}let pkDisco_7199: bitstring = pub(skB) in
                                                    {9199}in(c, (=pkCli_7187,em1_7200: bitstring,sigM1_7201: bitstring));
                                                    {9200}let m1_7202: bitstring = em1_7200 in
                                                    {9201}if (verify(h(m1_7202),sigM1_7201,pkCli_7187) <> true) then
                                                        0
                                                    else
                                                        {9202}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7203: bitstring) = m1_7202 in
                                                        {9203}new Ns_7204: bitstring;
                                                        {9204}new ST_7205: bitstring;
                                                        {9205}new TTL_7206: bitstring;
                                                        {9206}let m2_7207: bitstring = (OpenSecureChannelResponse,Ns_7204,ST_7205,TTL_7206) in
                                                        {9207}event beginSrv(Sess_5018,Cli_5016,Ns_7204);
                                                        {9208}out(c, (m2_7207,sign(h(m2_7207),skSess_6914)));
                                                        {9209}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9210}event endSrv(Cli_5016,Sess_5018,Nc_7203)
                                                )
                                                else
                                                    {9211}let v_7208: bool = (Disco_5017 = C) in
                                                    (
                                                        {9212}if v_7208 then
                                                        (
                                                            {9213}let pkDisco_7209: bitstring = pub(skC) in
                                                            {9214}in(c, (=pkCli_7187,em1_7210: bitstring,sigM1_7211: bitstring));
                                                            {9215}let m1_7212: bitstring = em1_7210 in
                                                            {9216}if (verify(h(m1_7212),sigM1_7211,pkCli_7187) <> true) then
                                                                0
                                                            else
                                                                {9217}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7213: bitstring) = m1_7212 in
                                                                {9218}new Ns_7214: bitstring;
                                                                {9219}new ST_7215: bitstring;
                                                                {9220}new TTL_7216: bitstring;
                                                                {9221}let m2_7217: bitstring = (OpenSecureChannelResponse,Ns_7214,ST_7215,TTL_7216) in
                                                                {9222}event beginSrv(Sess_5018,Cli_5016,Ns_7214);
                                                                {9223}out(c, (m2_7217,sign(h(m2_7217),skSess_6914)));
                                                                {9224}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {9225}event endSrv(Cli_5016,Sess_5018,Nc_7213)
                                                        )
                                                        else
                                                            {9226}let pkDisco_7218: bitstring = pub(sk(Disco_5017)) in
                                                            {9227}in(c, (=pkCli_7187,em1_7219: bitstring,sigM1_7220: bitstring));
                                                            {9228}let m1_7221: bitstring = em1_7219 in
                                                            {9229}if (verify(h(m1_7221),sigM1_7220,pkCli_7187) <> true) then
                                                                0
                                                            else
                                                                {9230}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7222: bitstring) = m1_7221 in
                                                                {9231}new Ns_7223: bitstring;
                                                                {9232}new ST_7224: bitstring;
                                                                {9233}new TTL_7225: bitstring;
                                                                {9234}let m2_7226: bitstring = (OpenSecureChannelResponse,Ns_7223,ST_7224,TTL_7225) in
                                                                {9235}event beginSrv(Sess_5018,Cli_5016,Ns_7223);
                                                                {9236}out(c, (m2_7226,sign(h(m2_7226),skSess_6914)));
                                                                {9237}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                                {9238}event endSrv(Cli_5016,Sess_5018,Nc_7222)
                                                    )
                                                    else
                                                        {9239}let pkDisco_7227: bitstring = fail-any in
                                                        {9240}in(c, (=pkCli_7187,em1_7228: bitstring,sigM1_7229: bitstring));
                                                        {9241}let m1_7230: bitstring = em1_7228 in
                                                        {9242}if (verify(h(m1_7230),sigM1_7229,pkCli_7187) <> true) then
                                                            0
                                                        else
                                                            {9243}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7231: bitstring) = m1_7230 in
                                                            {9244}new Ns_7232: bitstring;
                                                            {9245}new ST_7233: bitstring;
                                                            {9246}new TTL_7234: bitstring;
                                                            {9247}let m2_7235: bitstring = (OpenSecureChannelResponse,Ns_7232,ST_7233,TTL_7234) in
                                                            {9248}event beginSrv(Sess_5018,Cli_5016,Ns_7232);
                                                            {9249}out(c, (m2_7235,sign(h(m2_7235),skSess_6914)));
                                                            {9250}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {9251}event endSrv(Cli_5016,Sess_5018,Nc_7231)
                                            )
                                            else
                                                {9252}let pkDisco_7236: bitstring = fail-any in
                                                {9253}in(c, (=pkCli_7187,em1_7237: bitstring,sigM1_7238: bitstring));
                                                {9254}let m1_7239: bitstring = em1_7237 in
                                                {9255}if (verify(h(m1_7239),sigM1_7238,pkCli_7187) <> true) then
                                                    0
                                                else
                                                    {9256}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7240: bitstring) = m1_7239 in
                                                    {9257}new Ns_7241: bitstring;
                                                    {9258}new ST_7242: bitstring;
                                                    {9259}new TTL_7243: bitstring;
                                                    {9260}let m2_7244: bitstring = (OpenSecureChannelResponse,Ns_7241,ST_7242,TTL_7243) in
                                                    {9261}event beginSrv(Sess_5018,Cli_5016,Ns_7241);
                                                    {9262}out(c, (m2_7244,sign(h(m2_7244),skSess_6914)));
                                                    {9263}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9264}event endSrv(Cli_5016,Sess_5018,Nc_7240)
                                    )
                                    else
                                        {9265}let pkDisco_7245: bitstring = fail-any in
                                        {9266}in(c, (=pkCli_7187,em1_7246: bitstring,sigM1_7247: bitstring));
                                        {9267}let m1_7248: bitstring = em1_7246 in
                                        {9268}if (verify(h(m1_7248),sigM1_7247,pkCli_7187) <> true) then
                                            0
                                        else
                                            {9269}let (=OpenSecureChannelRequest,=pkCli_7187,Nc_7249: bitstring) = m1_7248 in
                                            {9270}new Ns_7250: bitstring;
                                            {9271}new ST_7251: bitstring;
                                            {9272}new TTL_7252: bitstring;
                                            {9273}let m2_7253: bitstring = (OpenSecureChannelResponse,Ns_7250,ST_7251,TTL_7252) in
                                            {9274}event beginSrv(Sess_5018,Cli_5016,Ns_7250);
                                            {9275}out(c, (m2_7253,sign(h(m2_7253),skSess_6914)));
                                            {9276}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9277}event endSrv(Cli_5016,Sess_5018,Nc_7249)
                        )
                        else
                            {9278}let pkCli_7254: bitstring = fail-any in
                            {9279}let v_7255: bool = (Disco_5017 = A) in
                            (
                                {9280}if v_7255 then
                                (
                                    {9281}let pkDisco_7256: bitstring = pub(skA) in
                                    {9282}in(c, (=pkCli_7254,em1_7257: bitstring,sigM1_7258: bitstring));
                                    {9283}let m1_7259: bitstring = em1_7257 in
                                    {9284}if (verify(h(m1_7259),sigM1_7258,pkCli_7254) <> true) then
                                        0
                                    else
                                        {9285}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7260: bitstring) = m1_7259 in
                                        {9286}new Ns_7261: bitstring;
                                        {9287}new ST_7262: bitstring;
                                        {9288}new TTL_7263: bitstring;
                                        {9289}let m2_7264: bitstring = (OpenSecureChannelResponse,Ns_7261,ST_7262,TTL_7263) in
                                        {9290}event beginSrv(Sess_5018,Cli_5016,Ns_7261);
                                        {9291}out(c, (m2_7264,sign(h(m2_7264),skSess_6914)));
                                        {9292}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {9293}event endSrv(Cli_5016,Sess_5018,Nc_7260)
                                )
                                else
                                    {9294}let v_7265: bool = (Disco_5017 = B) in
                                    (
                                        {9295}if v_7265 then
                                        (
                                            {9296}let pkDisco_7266: bitstring = pub(skB) in
                                            {9297}in(c, (=pkCli_7254,em1_7267: bitstring,sigM1_7268: bitstring));
                                            {9298}let m1_7269: bitstring = em1_7267 in
                                            {9299}if (verify(h(m1_7269),sigM1_7268,pkCli_7254) <> true) then
                                                0
                                            else
                                                {9300}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7270: bitstring) = m1_7269 in
                                                {9301}new Ns_7271: bitstring;
                                                {9302}new ST_7272: bitstring;
                                                {9303}new TTL_7273: bitstring;
                                                {9304}let m2_7274: bitstring = (OpenSecureChannelResponse,Ns_7271,ST_7272,TTL_7273) in
                                                {9305}event beginSrv(Sess_5018,Cli_5016,Ns_7271);
                                                {9306}out(c, (m2_7274,sign(h(m2_7274),skSess_6914)));
                                                {9307}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9308}event endSrv(Cli_5016,Sess_5018,Nc_7270)
                                        )
                                        else
                                            {9309}let v_7275: bool = (Disco_5017 = C) in
                                            (
                                                {9310}if v_7275 then
                                                (
                                                    {9311}let pkDisco_7276: bitstring = pub(skC) in
                                                    {9312}in(c, (=pkCli_7254,em1_7277: bitstring,sigM1_7278: bitstring));
                                                    {9313}let m1_7279: bitstring = em1_7277 in
                                                    {9314}if (verify(h(m1_7279),sigM1_7278,pkCli_7254) <> true) then
                                                        0
                                                    else
                                                        {9315}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7280: bitstring) = m1_7279 in
                                                        {9316}new Ns_7281: bitstring;
                                                        {9317}new ST_7282: bitstring;
                                                        {9318}new TTL_7283: bitstring;
                                                        {9319}let m2_7284: bitstring = (OpenSecureChannelResponse,Ns_7281,ST_7282,TTL_7283) in
                                                        {9320}event beginSrv(Sess_5018,Cli_5016,Ns_7281);
                                                        {9321}out(c, (m2_7284,sign(h(m2_7284),skSess_6914)));
                                                        {9322}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9323}event endSrv(Cli_5016,Sess_5018,Nc_7280)
                                                )
                                                else
                                                    {9324}let pkDisco_7285: bitstring = pub(sk(Disco_5017)) in
                                                    {9325}in(c, (=pkCli_7254,em1_7286: bitstring,sigM1_7287: bitstring));
                                                    {9326}let m1_7288: bitstring = em1_7286 in
                                                    {9327}if (verify(h(m1_7288),sigM1_7287,pkCli_7254) <> true) then
                                                        0
                                                    else
                                                        {9328}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7289: bitstring) = m1_7288 in
                                                        {9329}new Ns_7290: bitstring;
                                                        {9330}new ST_7291: bitstring;
                                                        {9331}new TTL_7292: bitstring;
                                                        {9332}let m2_7293: bitstring = (OpenSecureChannelResponse,Ns_7290,ST_7291,TTL_7292) in
                                                        {9333}event beginSrv(Sess_5018,Cli_5016,Ns_7290);
                                                        {9334}out(c, (m2_7293,sign(h(m2_7293),skSess_6914)));
                                                        {9335}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9336}event endSrv(Cli_5016,Sess_5018,Nc_7289)
                                            )
                                            else
                                                {9337}let pkDisco_7294: bitstring = fail-any in
                                                {9338}in(c, (=pkCli_7254,em1_7295: bitstring,sigM1_7296: bitstring));
                                                {9339}let m1_7297: bitstring = em1_7295 in
                                                {9340}if (verify(h(m1_7297),sigM1_7296,pkCli_7254) <> true) then
                                                    0
                                                else
                                                    {9341}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7298: bitstring) = m1_7297 in
                                                    {9342}new Ns_7299: bitstring;
                                                    {9343}new ST_7300: bitstring;
                                                    {9344}new TTL_7301: bitstring;
                                                    {9345}let m2_7302: bitstring = (OpenSecureChannelResponse,Ns_7299,ST_7300,TTL_7301) in
                                                    {9346}event beginSrv(Sess_5018,Cli_5016,Ns_7299);
                                                    {9347}out(c, (m2_7302,sign(h(m2_7302),skSess_6914)));
                                                    {9348}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9349}event endSrv(Cli_5016,Sess_5018,Nc_7298)
                                    )
                                    else
                                        {9350}let pkDisco_7303: bitstring = fail-any in
                                        {9351}in(c, (=pkCli_7254,em1_7304: bitstring,sigM1_7305: bitstring));
                                        {9352}let m1_7306: bitstring = em1_7304 in
                                        {9353}if (verify(h(m1_7306),sigM1_7305,pkCli_7254) <> true) then
                                            0
                                        else
                                            {9354}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7307: bitstring) = m1_7306 in
                                            {9355}new Ns_7308: bitstring;
                                            {9356}new ST_7309: bitstring;
                                            {9357}new TTL_7310: bitstring;
                                            {9358}let m2_7311: bitstring = (OpenSecureChannelResponse,Ns_7308,ST_7309,TTL_7310) in
                                            {9359}event beginSrv(Sess_5018,Cli_5016,Ns_7308);
                                            {9360}out(c, (m2_7311,sign(h(m2_7311),skSess_6914)));
                                            {9361}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9362}event endSrv(Cli_5016,Sess_5018,Nc_7307)
                            )
                            else
                                {9363}let pkDisco_7312: bitstring = fail-any in
                                {9364}in(c, (=pkCli_7254,em1_7313: bitstring,sigM1_7314: bitstring));
                                {9365}let m1_7315: bitstring = em1_7313 in
                                {9366}if (verify(h(m1_7315),sigM1_7314,pkCli_7254) <> true) then
                                    0
                                else
                                    {9367}let (=OpenSecureChannelRequest,=pkCli_7254,Nc_7316: bitstring) = m1_7315 in
                                    {9368}new Ns_7317: bitstring;
                                    {9369}new ST_7318: bitstring;
                                    {9370}new TTL_7319: bitstring;
                                    {9371}let m2_7320: bitstring = (OpenSecureChannelResponse,Ns_7317,ST_7318,TTL_7319) in
                                    {9372}event beginSrv(Sess_5018,Cli_5016,Ns_7317);
                                    {9373}out(c, (m2_7320,sign(h(m2_7320),skSess_6914)));
                                    {9374}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {9375}event endSrv(Cli_5016,Sess_5018,Nc_7316)
                )
                else
                    {9376}let pkCli_7321: bitstring = fail-any in
                    {9377}let v_7322: bool = (Disco_5017 = A) in
                    (
                        {9378}if v_7322 then
                        (
                            {9379}let pkDisco_7323: bitstring = pub(skA) in
                            {9380}in(c, (=pkCli_7321,em1_7324: bitstring,sigM1_7325: bitstring));
                            {9381}let m1_7326: bitstring = em1_7324 in
                            {9382}if (verify(h(m1_7326),sigM1_7325,pkCli_7321) <> true) then
                                0
                            else
                                {9383}let (=OpenSecureChannelRequest,=pkCli_7321,Nc_7327: bitstring) = m1_7326 in
                                {9384}new Ns_7328: bitstring;
                                {9385}new ST_7329: bitstring;
                                {9386}new TTL_7330: bitstring;
                                {9387}let m2_7331: bitstring = (OpenSecureChannelResponse,Ns_7328,ST_7329,TTL_7330) in
                                {9388}event beginSrv(Sess_5018,Cli_5016,Ns_7328);
                                {9389}out(c, (m2_7331,sign(h(m2_7331),skSess_6914)));
                                {9390}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {9391}event endSrv(Cli_5016,Sess_5018,Nc_7327)
                        )
                        else
                            {9392}let v_7332: bool = (Disco_5017 = B) in
                            (
                                {9393}if v_7332 then
                                (
                                    {9394}let pkDisco_7333: bitstring = pub(skB) in
                                    {9395}in(c, (=pkCli_7321,em1_7334: bitstring,sigM1_7335: bitstring));
                                    {9396}let m1_7336: bitstring = em1_7334 in
                                    {9397}if (verify(h(m1_7336),sigM1_7335,pkCli_7321) <> true) then
                                        0
                                    else
                                        {9398}let (=OpenSecureChannelRequest,=pkCli_7321,Nc_7337: bitstring) = m1_7336 in
                                        {9399}new Ns_7338: bitstring;
                                        {9400}new ST_7339: bitstring;
                                        {9401}new TTL_7340: bitstring;
                                        {9402}let m2_7341: bitstring = (OpenSecureChannelResponse,Ns_7338,ST_7339,TTL_7340) in
                                        {9403}event beginSrv(Sess_5018,Cli_5016,Ns_7338);
                                        {9404}out(c, (m2_7341,sign(h(m2_7341),skSess_6914)));
                                        {9405}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {9406}event endSrv(Cli_5016,Sess_5018,Nc_7337)
                                )
                                else
                                    {9407}let v_7342: bool = (Disco_5017 = C) in
                                    (
                                        {9408}if v_7342 then
                                        (
                                            {9409}let pkDisco_7343: bitstring = pub(skC) in
                                            {9410}in(c, (=pkCli_7321,em1_7344: bitstring,sigM1_7345: bitstring));
                                            {9411}let m1_7346: bitstring = em1_7344 in
                                            {9412}if (verify(h(m1_7346),sigM1_7345,pkCli_7321) <> true) then
                                                0
                                            else
                                                {9413}let (=OpenSecureChannelRequest,=pkCli_7321,Nc_7347: bitstring) = m1_7346 in
                                                {9414}new Ns_7348: bitstring;
                                                {9415}new ST_7349: bitstring;
                                                {9416}new TTL_7350: bitstring;
                                                {9417}let m2_7351: bitstring = (OpenSecureChannelResponse,Ns_7348,ST_7349,TTL_7350) in
                                                {9418}event beginSrv(Sess_5018,Cli_5016,Ns_7348);
                                                {9419}out(c, (m2_7351,sign(h(m2_7351),skSess_6914)));
                                                {9420}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9421}event endSrv(Cli_5016,Sess_5018,Nc_7347)
                                        )
                                        else
                                            {9422}let pkDisco_7352: bitstring = pub(sk(Disco_5017)) in
                                            {9423}in(c, (=pkCli_7321,em1_7353: bitstring,sigM1_7354: bitstring));
                                            {9424}let m1_7355: bitstring = em1_7353 in
                                            {9425}if (verify(h(m1_7355),sigM1_7354,pkCli_7321) <> true) then
                                                0
                                            else
                                                {9426}let (=OpenSecureChannelRequest,=pkCli_7321,Nc_7356: bitstring) = m1_7355 in
                                                {9427}new Ns_7357: bitstring;
                                                {9428}new ST_7358: bitstring;
                                                {9429}new TTL_7359: bitstring;
                                                {9430}let m2_7360: bitstring = (OpenSecureChannelResponse,Ns_7357,ST_7358,TTL_7359) in
                                                {9431}event beginSrv(Sess_5018,Cli_5016,Ns_7357);
                                                {9432}out(c, (m2_7360,sign(h(m2_7360),skSess_6914)));
                                                {9433}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9434}event endSrv(Cli_5016,Sess_5018,Nc_7356)
                                    )
                                    else
                                        {9435}let pkDisco_7361: bitstring = fail-any in
                                        {9436}in(c, (=pkCli_7321,em1_7362: bitstring,sigM1_7363: bitstring));
                                        {9437}let m1_7364: bitstring = em1_7362 in
                                        {9438}if (verify(h(m1_7364),sigM1_7363,pkCli_7321) <> true) then
                                            0
                                        else
                                            {9439}let (=OpenSecureChannelRequest,=pkCli_7321,Nc_7365: bitstring) = m1_7364 in
                                            {9440}new Ns_7366: bitstring;
                                            {9441}new ST_7367: bitstring;
                                            {9442}new TTL_7368: bitstring;
                                            {9443}let m2_7369: bitstring = (OpenSecureChannelResponse,Ns_7366,ST_7367,TTL_7368) in
                                            {9444}event beginSrv(Sess_5018,Cli_5016,Ns_7366);
                                            {9445}out(c, (m2_7369,sign(h(m2_7369),skSess_6914)));
                                            {9446}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9447}event endSrv(Cli_5016,Sess_5018,Nc_7365)
                            )
                            else
                                {9448}let pkDisco_7370: bitstring = fail-any in
                                {9449}in(c, (=pkCli_7321,em1_7371: bitstring,sigM1_7372: bitstring));
                                {9450}let m1_7373: bitstring = em1_7371 in
                                {9451}if (verify(h(m1_7373),sigM1_7372,pkCli_7321) <> true) then
                                    0
                                else
                                    {9452}let (=OpenSecureChannelRequest,=pkCli_7321,Nc_7374: bitstring) = m1_7373 in
                                    {9453}new Ns_7375: bitstring;
                                    {9454}new ST_7376: bitstring;
                                    {9455}new TTL_7377: bitstring;
                                    {9456}let m2_7378: bitstring = (OpenSecureChannelResponse,Ns_7375,ST_7376,TTL_7377) in
                                    {9457}event beginSrv(Sess_5018,Cli_5016,Ns_7375);
                                    {9458}out(c, (m2_7378,sign(h(m2_7378),skSess_6914)));
                                    {9459}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {9460}event endSrv(Cli_5016,Sess_5018,Nc_7374)
                    )
                    else
                        {9461}let pkDisco_7379: bitstring = fail-any in
                        {9462}in(c, (=pkCli_7321,em1_7380: bitstring,sigM1_7381: bitstring));
                        {9463}let m1_7382: bitstring = em1_7380 in
                        {9464}if (verify(h(m1_7382),sigM1_7381,pkCli_7321) <> true) then
                            0
                        else
                            {9465}let (=OpenSecureChannelRequest,=pkCli_7321,Nc_7383: bitstring) = m1_7382 in
                            {9466}new Ns_7384: bitstring;
                            {9467}new ST_7385: bitstring;
                            {9468}new TTL_7386: bitstring;
                            {9469}let m2_7387: bitstring = (OpenSecureChannelResponse,Ns_7384,ST_7385,TTL_7386) in
                            {9470}event beginSrv(Sess_5018,Cli_5016,Ns_7384);
                            {9471}out(c, (m2_7387,sign(h(m2_7387),skSess_6914)));
                            {9472}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                            {9473}event endSrv(Cli_5016,Sess_5018,Nc_7383)
    )
    else
        {9474}let skSess_7388: bitstring = fail-any in
        {9475}let pkSess_7389: bitstring = pub(skSess_7388) in
        {9476}let v_7390: bool = (Cli_5016 = A) in
        (
            {9477}if v_7390 then
            (
                {9478}let pkCli_7391: bitstring = pub(skA) in
                {9479}let v_7392: bool = (Disco_5017 = A) in
                (
                    {9480}if v_7392 then
                    (
                        {9481}let pkDisco_7393: bitstring = pub(skA) in
                        {9482}in(c, (=pkCli_7391,em1_7394: bitstring,sigM1_7395: bitstring));
                        {9483}let m1_7396: bitstring = em1_7394 in
                        {9484}if (verify(h(m1_7396),sigM1_7395,pkCli_7391) <> true) then
                            0
                        else
                            {9485}let (=OpenSecureChannelRequest,=pkCli_7391,Nc_7397: bitstring) = m1_7396 in
                            {9486}new Ns_7398: bitstring;
                            {9487}new ST_7399: bitstring;
                            {9488}new TTL_7400: bitstring;
                            {9489}let m2_7401: bitstring = (OpenSecureChannelResponse,Ns_7398,ST_7399,TTL_7400) in
                            {9490}event beginSrv(Sess_5018,Cli_5016,Ns_7398);
                            {9491}out(c, (m2_7401,sign(h(m2_7401),skSess_7388)));
                            {9492}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                            {9493}event endSrv(Cli_5016,Sess_5018,Nc_7397)
                    )
                    else
                        {9494}let v_7402: bool = (Disco_5017 = B) in
                        (
                            {9495}if v_7402 then
                            (
                                {9496}let pkDisco_7403: bitstring = pub(skB) in
                                {9497}in(c, (=pkCli_7391,em1_7404: bitstring,sigM1_7405: bitstring));
                                {9498}let m1_7406: bitstring = em1_7404 in
                                {9499}if (verify(h(m1_7406),sigM1_7405,pkCli_7391) <> true) then
                                    0
                                else
                                    {9500}let (=OpenSecureChannelRequest,=pkCli_7391,Nc_7407: bitstring) = m1_7406 in
                                    {9501}new Ns_7408: bitstring;
                                    {9502}new ST_7409: bitstring;
                                    {9503}new TTL_7410: bitstring;
                                    {9504}let m2_7411: bitstring = (OpenSecureChannelResponse,Ns_7408,ST_7409,TTL_7410) in
                                    {9505}event beginSrv(Sess_5018,Cli_5016,Ns_7408);
                                    {9506}out(c, (m2_7411,sign(h(m2_7411),skSess_7388)));
                                    {9507}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {9508}event endSrv(Cli_5016,Sess_5018,Nc_7407)
                            )
                            else
                                {9509}let v_7412: bool = (Disco_5017 = C) in
                                (
                                    {9510}if v_7412 then
                                    (
                                        {9511}let pkDisco_7413: bitstring = pub(skC) in
                                        {9512}in(c, (=pkCli_7391,em1_7414: bitstring,sigM1_7415: bitstring));
                                        {9513}let m1_7416: bitstring = em1_7414 in
                                        {9514}if (verify(h(m1_7416),sigM1_7415,pkCli_7391) <> true) then
                                            0
                                        else
                                            {9515}let (=OpenSecureChannelRequest,=pkCli_7391,Nc_7417: bitstring) = m1_7416 in
                                            {9516}new Ns_7418: bitstring;
                                            {9517}new ST_7419: bitstring;
                                            {9518}new TTL_7420: bitstring;
                                            {9519}let m2_7421: bitstring = (OpenSecureChannelResponse,Ns_7418,ST_7419,TTL_7420) in
                                            {9520}event beginSrv(Sess_5018,Cli_5016,Ns_7418);
                                            {9521}out(c, (m2_7421,sign(h(m2_7421),skSess_7388)));
                                            {9522}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9523}event endSrv(Cli_5016,Sess_5018,Nc_7417)
                                    )
                                    else
                                        {9524}let pkDisco_7422: bitstring = pub(sk(Disco_5017)) in
                                        {9525}in(c, (=pkCli_7391,em1_7423: bitstring,sigM1_7424: bitstring));
                                        {9526}let m1_7425: bitstring = em1_7423 in
                                        {9527}if (verify(h(m1_7425),sigM1_7424,pkCli_7391) <> true) then
                                            0
                                        else
                                            {9528}let (=OpenSecureChannelRequest,=pkCli_7391,Nc_7426: bitstring) = m1_7425 in
                                            {9529}new Ns_7427: bitstring;
                                            {9530}new ST_7428: bitstring;
                                            {9531}new TTL_7429: bitstring;
                                            {9532}let m2_7430: bitstring = (OpenSecureChannelResponse,Ns_7427,ST_7428,TTL_7429) in
                                            {9533}event beginSrv(Sess_5018,Cli_5016,Ns_7427);
                                            {9534}out(c, (m2_7430,sign(h(m2_7430),skSess_7388)));
                                            {9535}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9536}event endSrv(Cli_5016,Sess_5018,Nc_7426)
                                )
                                else
                                    {9537}let pkDisco_7431: bitstring = fail-any in
                                    {9538}in(c, (=pkCli_7391,em1_7432: bitstring,sigM1_7433: bitstring));
                                    {9539}let m1_7434: bitstring = em1_7432 in
                                    {9540}if (verify(h(m1_7434),sigM1_7433,pkCli_7391) <> true) then
                                        0
                                    else
                                        {9541}let (=OpenSecureChannelRequest,=pkCli_7391,Nc_7435: bitstring) = m1_7434 in
                                        {9542}new Ns_7436: bitstring;
                                        {9543}new ST_7437: bitstring;
                                        {9544}new TTL_7438: bitstring;
                                        {9545}let m2_7439: bitstring = (OpenSecureChannelResponse,Ns_7436,ST_7437,TTL_7438) in
                                        {9546}event beginSrv(Sess_5018,Cli_5016,Ns_7436);
                                        {9547}out(c, (m2_7439,sign(h(m2_7439),skSess_7388)));
                                        {9548}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {9549}event endSrv(Cli_5016,Sess_5018,Nc_7435)
                        )
                        else
                            {9550}let pkDisco_7440: bitstring = fail-any in
                            {9551}in(c, (=pkCli_7391,em1_7441: bitstring,sigM1_7442: bitstring));
                            {9552}let m1_7443: bitstring = em1_7441 in
                            {9553}if (verify(h(m1_7443),sigM1_7442,pkCli_7391) <> true) then
                                0
                            else
                                {9554}let (=OpenSecureChannelRequest,=pkCli_7391,Nc_7444: bitstring) = m1_7443 in
                                {9555}new Ns_7445: bitstring;
                                {9556}new ST_7446: bitstring;
                                {9557}new TTL_7447: bitstring;
                                {9558}let m2_7448: bitstring = (OpenSecureChannelResponse,Ns_7445,ST_7446,TTL_7447) in
                                {9559}event beginSrv(Sess_5018,Cli_5016,Ns_7445);
                                {9560}out(c, (m2_7448,sign(h(m2_7448),skSess_7388)));
                                {9561}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {9562}event endSrv(Cli_5016,Sess_5018,Nc_7444)
                )
                else
                    {9563}let pkDisco_7449: bitstring = fail-any in
                    {9564}in(c, (=pkCli_7391,em1_7450: bitstring,sigM1_7451: bitstring));
                    {9565}let m1_7452: bitstring = em1_7450 in
                    {9566}if (verify(h(m1_7452),sigM1_7451,pkCli_7391) <> true) then
                        0
                    else
                        {9567}let (=OpenSecureChannelRequest,=pkCli_7391,Nc_7453: bitstring) = m1_7452 in
                        {9568}new Ns_7454: bitstring;
                        {9569}new ST_7455: bitstring;
                        {9570}new TTL_7456: bitstring;
                        {9571}let m2_7457: bitstring = (OpenSecureChannelResponse,Ns_7454,ST_7455,TTL_7456) in
                        {9572}event beginSrv(Sess_5018,Cli_5016,Ns_7454);
                        {9573}out(c, (m2_7457,sign(h(m2_7457),skSess_7388)));
                        {9574}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                        {9575}event endSrv(Cli_5016,Sess_5018,Nc_7453)
            )
            else
                {9576}let v_7458: bool = (Cli_5016 = B) in
                (
                    {9577}if v_7458 then
                    (
                        {9578}let pkCli_7459: bitstring = pub(skB) in
                        {9579}let v_7460: bool = (Disco_5017 = A) in
                        (
                            {9580}if v_7460 then
                            (
                                {9581}let pkDisco_7461: bitstring = pub(skA) in
                                {9582}in(c, (=pkCli_7459,em1_7462: bitstring,sigM1_7463: bitstring));
                                {9583}let m1_7464: bitstring = em1_7462 in
                                {9584}if (verify(h(m1_7464),sigM1_7463,pkCli_7459) <> true) then
                                    0
                                else
                                    {9585}let (=OpenSecureChannelRequest,=pkCli_7459,Nc_7465: bitstring) = m1_7464 in
                                    {9586}new Ns_7466: bitstring;
                                    {9587}new ST_7467: bitstring;
                                    {9588}new TTL_7468: bitstring;
                                    {9589}let m2_7469: bitstring = (OpenSecureChannelResponse,Ns_7466,ST_7467,TTL_7468) in
                                    {9590}event beginSrv(Sess_5018,Cli_5016,Ns_7466);
                                    {9591}out(c, (m2_7469,sign(h(m2_7469),skSess_7388)));
                                    {9592}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {9593}event endSrv(Cli_5016,Sess_5018,Nc_7465)
                            )
                            else
                                {9594}let v_7470: bool = (Disco_5017 = B) in
                                (
                                    {9595}if v_7470 then
                                    (
                                        {9596}let pkDisco_7471: bitstring = pub(skB) in
                                        {9597}in(c, (=pkCli_7459,em1_7472: bitstring,sigM1_7473: bitstring));
                                        {9598}let m1_7474: bitstring = em1_7472 in
                                        {9599}if (verify(h(m1_7474),sigM1_7473,pkCli_7459) <> true) then
                                            0
                                        else
                                            {9600}let (=OpenSecureChannelRequest,=pkCli_7459,Nc_7475: bitstring) = m1_7474 in
                                            {9601}new Ns_7476: bitstring;
                                            {9602}new ST_7477: bitstring;
                                            {9603}new TTL_7478: bitstring;
                                            {9604}let m2_7479: bitstring = (OpenSecureChannelResponse,Ns_7476,ST_7477,TTL_7478) in
                                            {9605}event beginSrv(Sess_5018,Cli_5016,Ns_7476);
                                            {9606}out(c, (m2_7479,sign(h(m2_7479),skSess_7388)));
                                            {9607}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9608}event endSrv(Cli_5016,Sess_5018,Nc_7475)
                                    )
                                    else
                                        {9609}let v_7480: bool = (Disco_5017 = C) in
                                        (
                                            {9610}if v_7480 then
                                            (
                                                {9611}let pkDisco_7481: bitstring = pub(skC) in
                                                {9612}in(c, (=pkCli_7459,em1_7482: bitstring,sigM1_7483: bitstring));
                                                {9613}let m1_7484: bitstring = em1_7482 in
                                                {9614}if (verify(h(m1_7484),sigM1_7483,pkCli_7459) <> true) then
                                                    0
                                                else
                                                    {9615}let (=OpenSecureChannelRequest,=pkCli_7459,Nc_7485: bitstring) = m1_7484 in
                                                    {9616}new Ns_7486: bitstring;
                                                    {9617}new ST_7487: bitstring;
                                                    {9618}new TTL_7488: bitstring;
                                                    {9619}let m2_7489: bitstring = (OpenSecureChannelResponse,Ns_7486,ST_7487,TTL_7488) in
                                                    {9620}event beginSrv(Sess_5018,Cli_5016,Ns_7486);
                                                    {9621}out(c, (m2_7489,sign(h(m2_7489),skSess_7388)));
                                                    {9622}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9623}event endSrv(Cli_5016,Sess_5018,Nc_7485)
                                            )
                                            else
                                                {9624}let pkDisco_7490: bitstring = pub(sk(Disco_5017)) in
                                                {9625}in(c, (=pkCli_7459,em1_7491: bitstring,sigM1_7492: bitstring));
                                                {9626}let m1_7493: bitstring = em1_7491 in
                                                {9627}if (verify(h(m1_7493),sigM1_7492,pkCli_7459) <> true) then
                                                    0
                                                else
                                                    {9628}let (=OpenSecureChannelRequest,=pkCli_7459,Nc_7494: bitstring) = m1_7493 in
                                                    {9629}new Ns_7495: bitstring;
                                                    {9630}new ST_7496: bitstring;
                                                    {9631}new TTL_7497: bitstring;
                                                    {9632}let m2_7498: bitstring = (OpenSecureChannelResponse,Ns_7495,ST_7496,TTL_7497) in
                                                    {9633}event beginSrv(Sess_5018,Cli_5016,Ns_7495);
                                                    {9634}out(c, (m2_7498,sign(h(m2_7498),skSess_7388)));
                                                    {9635}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9636}event endSrv(Cli_5016,Sess_5018,Nc_7494)
                                        )
                                        else
                                            {9637}let pkDisco_7499: bitstring = fail-any in
                                            {9638}in(c, (=pkCli_7459,em1_7500: bitstring,sigM1_7501: bitstring));
                                            {9639}let m1_7502: bitstring = em1_7500 in
                                            {9640}if (verify(h(m1_7502),sigM1_7501,pkCli_7459) <> true) then
                                                0
                                            else
                                                {9641}let (=OpenSecureChannelRequest,=pkCli_7459,Nc_7503: bitstring) = m1_7502 in
                                                {9642}new Ns_7504: bitstring;
                                                {9643}new ST_7505: bitstring;
                                                {9644}new TTL_7506: bitstring;
                                                {9645}let m2_7507: bitstring = (OpenSecureChannelResponse,Ns_7504,ST_7505,TTL_7506) in
                                                {9646}event beginSrv(Sess_5018,Cli_5016,Ns_7504);
                                                {9647}out(c, (m2_7507,sign(h(m2_7507),skSess_7388)));
                                                {9648}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9649}event endSrv(Cli_5016,Sess_5018,Nc_7503)
                                )
                                else
                                    {9650}let pkDisco_7508: bitstring = fail-any in
                                    {9651}in(c, (=pkCli_7459,em1_7509: bitstring,sigM1_7510: bitstring));
                                    {9652}let m1_7511: bitstring = em1_7509 in
                                    {9653}if (verify(h(m1_7511),sigM1_7510,pkCli_7459) <> true) then
                                        0
                                    else
                                        {9654}let (=OpenSecureChannelRequest,=pkCli_7459,Nc_7512: bitstring) = m1_7511 in
                                        {9655}new Ns_7513: bitstring;
                                        {9656}new ST_7514: bitstring;
                                        {9657}new TTL_7515: bitstring;
                                        {9658}let m2_7516: bitstring = (OpenSecureChannelResponse,Ns_7513,ST_7514,TTL_7515) in
                                        {9659}event beginSrv(Sess_5018,Cli_5016,Ns_7513);
                                        {9660}out(c, (m2_7516,sign(h(m2_7516),skSess_7388)));
                                        {9661}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {9662}event endSrv(Cli_5016,Sess_5018,Nc_7512)
                        )
                        else
                            {9663}let pkDisco_7517: bitstring = fail-any in
                            {9664}in(c, (=pkCli_7459,em1_7518: bitstring,sigM1_7519: bitstring));
                            {9665}let m1_7520: bitstring = em1_7518 in
                            {9666}if (verify(h(m1_7520),sigM1_7519,pkCli_7459) <> true) then
                                0
                            else
                                {9667}let (=OpenSecureChannelRequest,=pkCli_7459,Nc_7521: bitstring) = m1_7520 in
                                {9668}new Ns_7522: bitstring;
                                {9669}new ST_7523: bitstring;
                                {9670}new TTL_7524: bitstring;
                                {9671}let m2_7525: bitstring = (OpenSecureChannelResponse,Ns_7522,ST_7523,TTL_7524) in
                                {9672}event beginSrv(Sess_5018,Cli_5016,Ns_7522);
                                {9673}out(c, (m2_7525,sign(h(m2_7525),skSess_7388)));
                                {9674}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {9675}event endSrv(Cli_5016,Sess_5018,Nc_7521)
                    )
                    else
                        {9676}let v_7526: bool = (Cli_5016 = C) in
                        (
                            {9677}if v_7526 then
                            (
                                {9678}let pkCli_7527: bitstring = pub(skC) in
                                {9679}let v_7528: bool = (Disco_5017 = A) in
                                (
                                    {9680}if v_7528 then
                                    (
                                        {9681}let pkDisco_7529: bitstring = pub(skA) in
                                        {9682}in(c, (=pkCli_7527,em1_7530: bitstring,sigM1_7531: bitstring));
                                        {9683}let m1_7532: bitstring = em1_7530 in
                                        {9684}if (verify(h(m1_7532),sigM1_7531,pkCli_7527) <> true) then
                                            0
                                        else
                                            {9685}let (=OpenSecureChannelRequest,=pkCli_7527,Nc_7533: bitstring) = m1_7532 in
                                            {9686}new Ns_7534: bitstring;
                                            {9687}new ST_7535: bitstring;
                                            {9688}new TTL_7536: bitstring;
                                            {9689}let m2_7537: bitstring = (OpenSecureChannelResponse,Ns_7534,ST_7535,TTL_7536) in
                                            {9690}event beginSrv(Sess_5018,Cli_5016,Ns_7534);
                                            {9691}out(c, (m2_7537,sign(h(m2_7537),skSess_7388)));
                                            {9692}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9693}event endSrv(Cli_5016,Sess_5018,Nc_7533)
                                    )
                                    else
                                        {9694}let v_7538: bool = (Disco_5017 = B) in
                                        (
                                            {9695}if v_7538 then
                                            (
                                                {9696}let pkDisco_7539: bitstring = pub(skB) in
                                                {9697}in(c, (=pkCli_7527,em1_7540: bitstring,sigM1_7541: bitstring));
                                                {9698}let m1_7542: bitstring = em1_7540 in
                                                {9699}if (verify(h(m1_7542),sigM1_7541,pkCli_7527) <> true) then
                                                    0
                                                else
                                                    {9700}let (=OpenSecureChannelRequest,=pkCli_7527,Nc_7543: bitstring) = m1_7542 in
                                                    {9701}new Ns_7544: bitstring;
                                                    {9702}new ST_7545: bitstring;
                                                    {9703}new TTL_7546: bitstring;
                                                    {9704}let m2_7547: bitstring = (OpenSecureChannelResponse,Ns_7544,ST_7545,TTL_7546) in
                                                    {9705}event beginSrv(Sess_5018,Cli_5016,Ns_7544);
                                                    {9706}out(c, (m2_7547,sign(h(m2_7547),skSess_7388)));
                                                    {9707}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9708}event endSrv(Cli_5016,Sess_5018,Nc_7543)
                                            )
                                            else
                                                {9709}let v_7548: bool = (Disco_5017 = C) in
                                                (
                                                    {9710}if v_7548 then
                                                    (
                                                        {9711}let pkDisco_7549: bitstring = pub(skC) in
                                                        {9712}in(c, (=pkCli_7527,em1_7550: bitstring,sigM1_7551: bitstring));
                                                        {9713}let m1_7552: bitstring = em1_7550 in
                                                        {9714}if (verify(h(m1_7552),sigM1_7551,pkCli_7527) <> true) then
                                                            0
                                                        else
                                                            {9715}let (=OpenSecureChannelRequest,=pkCli_7527,Nc_7553: bitstring) = m1_7552 in
                                                            {9716}new Ns_7554: bitstring;
                                                            {9717}new ST_7555: bitstring;
                                                            {9718}new TTL_7556: bitstring;
                                                            {9719}let m2_7557: bitstring = (OpenSecureChannelResponse,Ns_7554,ST_7555,TTL_7556) in
                                                            {9720}event beginSrv(Sess_5018,Cli_5016,Ns_7554);
                                                            {9721}out(c, (m2_7557,sign(h(m2_7557),skSess_7388)));
                                                            {9722}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {9723}event endSrv(Cli_5016,Sess_5018,Nc_7553)
                                                    )
                                                    else
                                                        {9724}let pkDisco_7558: bitstring = pub(sk(Disco_5017)) in
                                                        {9725}in(c, (=pkCli_7527,em1_7559: bitstring,sigM1_7560: bitstring));
                                                        {9726}let m1_7561: bitstring = em1_7559 in
                                                        {9727}if (verify(h(m1_7561),sigM1_7560,pkCli_7527) <> true) then
                                                            0
                                                        else
                                                            {9728}let (=OpenSecureChannelRequest,=pkCli_7527,Nc_7562: bitstring) = m1_7561 in
                                                            {9729}new Ns_7563: bitstring;
                                                            {9730}new ST_7564: bitstring;
                                                            {9731}new TTL_7565: bitstring;
                                                            {9732}let m2_7566: bitstring = (OpenSecureChannelResponse,Ns_7563,ST_7564,TTL_7565) in
                                                            {9733}event beginSrv(Sess_5018,Cli_5016,Ns_7563);
                                                            {9734}out(c, (m2_7566,sign(h(m2_7566),skSess_7388)));
                                                            {9735}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {9736}event endSrv(Cli_5016,Sess_5018,Nc_7562)
                                                )
                                                else
                                                    {9737}let pkDisco_7567: bitstring = fail-any in
                                                    {9738}in(c, (=pkCli_7527,em1_7568: bitstring,sigM1_7569: bitstring));
                                                    {9739}let m1_7570: bitstring = em1_7568 in
                                                    {9740}if (verify(h(m1_7570),sigM1_7569,pkCli_7527) <> true) then
                                                        0
                                                    else
                                                        {9741}let (=OpenSecureChannelRequest,=pkCli_7527,Nc_7571: bitstring) = m1_7570 in
                                                        {9742}new Ns_7572: bitstring;
                                                        {9743}new ST_7573: bitstring;
                                                        {9744}new TTL_7574: bitstring;
                                                        {9745}let m2_7575: bitstring = (OpenSecureChannelResponse,Ns_7572,ST_7573,TTL_7574) in
                                                        {9746}event beginSrv(Sess_5018,Cli_5016,Ns_7572);
                                                        {9747}out(c, (m2_7575,sign(h(m2_7575),skSess_7388)));
                                                        {9748}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9749}event endSrv(Cli_5016,Sess_5018,Nc_7571)
                                        )
                                        else
                                            {9750}let pkDisco_7576: bitstring = fail-any in
                                            {9751}in(c, (=pkCli_7527,em1_7577: bitstring,sigM1_7578: bitstring));
                                            {9752}let m1_7579: bitstring = em1_7577 in
                                            {9753}if (verify(h(m1_7579),sigM1_7578,pkCli_7527) <> true) then
                                                0
                                            else
                                                {9754}let (=OpenSecureChannelRequest,=pkCli_7527,Nc_7580: bitstring) = m1_7579 in
                                                {9755}new Ns_7581: bitstring;
                                                {9756}new ST_7582: bitstring;
                                                {9757}new TTL_7583: bitstring;
                                                {9758}let m2_7584: bitstring = (OpenSecureChannelResponse,Ns_7581,ST_7582,TTL_7583) in
                                                {9759}event beginSrv(Sess_5018,Cli_5016,Ns_7581);
                                                {9760}out(c, (m2_7584,sign(h(m2_7584),skSess_7388)));
                                                {9761}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9762}event endSrv(Cli_5016,Sess_5018,Nc_7580)
                                )
                                else
                                    {9763}let pkDisco_7585: bitstring = fail-any in
                                    {9764}in(c, (=pkCli_7527,em1_7586: bitstring,sigM1_7587: bitstring));
                                    {9765}let m1_7588: bitstring = em1_7586 in
                                    {9766}if (verify(h(m1_7588),sigM1_7587,pkCli_7527) <> true) then
                                        0
                                    else
                                        {9767}let (=OpenSecureChannelRequest,=pkCli_7527,Nc_7589: bitstring) = m1_7588 in
                                        {9768}new Ns_7590: bitstring;
                                        {9769}new ST_7591: bitstring;
                                        {9770}new TTL_7592: bitstring;
                                        {9771}let m2_7593: bitstring = (OpenSecureChannelResponse,Ns_7590,ST_7591,TTL_7592) in
                                        {9772}event beginSrv(Sess_5018,Cli_5016,Ns_7590);
                                        {9773}out(c, (m2_7593,sign(h(m2_7593),skSess_7388)));
                                        {9774}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {9775}event endSrv(Cli_5016,Sess_5018,Nc_7589)
                            )
                            else
                                {9776}let pkCli_7594: bitstring = pub(sk(Cli_5016)) in
                                {9777}let v_7595: bool = (Disco_5017 = A) in
                                (
                                    {9778}if v_7595 then
                                    (
                                        {9779}let pkDisco_7596: bitstring = pub(skA) in
                                        {9780}in(c, (=pkCli_7594,em1_7597: bitstring,sigM1_7598: bitstring));
                                        {9781}let m1_7599: bitstring = em1_7597 in
                                        {9782}if (verify(h(m1_7599),sigM1_7598,pkCli_7594) <> true) then
                                            0
                                        else
                                            {9783}let (=OpenSecureChannelRequest,=pkCli_7594,Nc_7600: bitstring) = m1_7599 in
                                            {9784}new Ns_7601: bitstring;
                                            {9785}new ST_7602: bitstring;
                                            {9786}new TTL_7603: bitstring;
                                            {9787}let m2_7604: bitstring = (OpenSecureChannelResponse,Ns_7601,ST_7602,TTL_7603) in
                                            {9788}event beginSrv(Sess_5018,Cli_5016,Ns_7601);
                                            {9789}out(c, (m2_7604,sign(h(m2_7604),skSess_7388)));
                                            {9790}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9791}event endSrv(Cli_5016,Sess_5018,Nc_7600)
                                    )
                                    else
                                        {9792}let v_7605: bool = (Disco_5017 = B) in
                                        (
                                            {9793}if v_7605 then
                                            (
                                                {9794}let pkDisco_7606: bitstring = pub(skB) in
                                                {9795}in(c, (=pkCli_7594,em1_7607: bitstring,sigM1_7608: bitstring));
                                                {9796}let m1_7609: bitstring = em1_7607 in
                                                {9797}if (verify(h(m1_7609),sigM1_7608,pkCli_7594) <> true) then
                                                    0
                                                else
                                                    {9798}let (=OpenSecureChannelRequest,=pkCli_7594,Nc_7610: bitstring) = m1_7609 in
                                                    {9799}new Ns_7611: bitstring;
                                                    {9800}new ST_7612: bitstring;
                                                    {9801}new TTL_7613: bitstring;
                                                    {9802}let m2_7614: bitstring = (OpenSecureChannelResponse,Ns_7611,ST_7612,TTL_7613) in
                                                    {9803}event beginSrv(Sess_5018,Cli_5016,Ns_7611);
                                                    {9804}out(c, (m2_7614,sign(h(m2_7614),skSess_7388)));
                                                    {9805}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9806}event endSrv(Cli_5016,Sess_5018,Nc_7610)
                                            )
                                            else
                                                {9807}let v_7615: bool = (Disco_5017 = C) in
                                                (
                                                    {9808}if v_7615 then
                                                    (
                                                        {9809}let pkDisco_7616: bitstring = pub(skC) in
                                                        {9810}in(c, (=pkCli_7594,em1_7617: bitstring,sigM1_7618: bitstring));
                                                        {9811}let m1_7619: bitstring = em1_7617 in
                                                        {9812}if (verify(h(m1_7619),sigM1_7618,pkCli_7594) <> true) then
                                                            0
                                                        else
                                                            {9813}let (=OpenSecureChannelRequest,=pkCli_7594,Nc_7620: bitstring) = m1_7619 in
                                                            {9814}new Ns_7621: bitstring;
                                                            {9815}new ST_7622: bitstring;
                                                            {9816}new TTL_7623: bitstring;
                                                            {9817}let m2_7624: bitstring = (OpenSecureChannelResponse,Ns_7621,ST_7622,TTL_7623) in
                                                            {9818}event beginSrv(Sess_5018,Cli_5016,Ns_7621);
                                                            {9819}out(c, (m2_7624,sign(h(m2_7624),skSess_7388)));
                                                            {9820}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {9821}event endSrv(Cli_5016,Sess_5018,Nc_7620)
                                                    )
                                                    else
                                                        {9822}let pkDisco_7625: bitstring = pub(sk(Disco_5017)) in
                                                        {9823}in(c, (=pkCli_7594,em1_7626: bitstring,sigM1_7627: bitstring));
                                                        {9824}let m1_7628: bitstring = em1_7626 in
                                                        {9825}if (verify(h(m1_7628),sigM1_7627,pkCli_7594) <> true) then
                                                            0
                                                        else
                                                            {9826}let (=OpenSecureChannelRequest,=pkCli_7594,Nc_7629: bitstring) = m1_7628 in
                                                            {9827}new Ns_7630: bitstring;
                                                            {9828}new ST_7631: bitstring;
                                                            {9829}new TTL_7632: bitstring;
                                                            {9830}let m2_7633: bitstring = (OpenSecureChannelResponse,Ns_7630,ST_7631,TTL_7632) in
                                                            {9831}event beginSrv(Sess_5018,Cli_5016,Ns_7630);
                                                            {9832}out(c, (m2_7633,sign(h(m2_7633),skSess_7388)));
                                                            {9833}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                            {9834}event endSrv(Cli_5016,Sess_5018,Nc_7629)
                                                )
                                                else
                                                    {9835}let pkDisco_7634: bitstring = fail-any in
                                                    {9836}in(c, (=pkCli_7594,em1_7635: bitstring,sigM1_7636: bitstring));
                                                    {9837}let m1_7637: bitstring = em1_7635 in
                                                    {9838}if (verify(h(m1_7637),sigM1_7636,pkCli_7594) <> true) then
                                                        0
                                                    else
                                                        {9839}let (=OpenSecureChannelRequest,=pkCli_7594,Nc_7638: bitstring) = m1_7637 in
                                                        {9840}new Ns_7639: bitstring;
                                                        {9841}new ST_7640: bitstring;
                                                        {9842}new TTL_7641: bitstring;
                                                        {9843}let m2_7642: bitstring = (OpenSecureChannelResponse,Ns_7639,ST_7640,TTL_7641) in
                                                        {9844}event beginSrv(Sess_5018,Cli_5016,Ns_7639);
                                                        {9845}out(c, (m2_7642,sign(h(m2_7642),skSess_7388)));
                                                        {9846}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9847}event endSrv(Cli_5016,Sess_5018,Nc_7638)
                                        )
                                        else
                                            {9848}let pkDisco_7643: bitstring = fail-any in
                                            {9849}in(c, (=pkCli_7594,em1_7644: bitstring,sigM1_7645: bitstring));
                                            {9850}let m1_7646: bitstring = em1_7644 in
                                            {9851}if (verify(h(m1_7646),sigM1_7645,pkCli_7594) <> true) then
                                                0
                                            else
                                                {9852}let (=OpenSecureChannelRequest,=pkCli_7594,Nc_7647: bitstring) = m1_7646 in
                                                {9853}new Ns_7648: bitstring;
                                                {9854}new ST_7649: bitstring;
                                                {9855}new TTL_7650: bitstring;
                                                {9856}let m2_7651: bitstring = (OpenSecureChannelResponse,Ns_7648,ST_7649,TTL_7650) in
                                                {9857}event beginSrv(Sess_5018,Cli_5016,Ns_7648);
                                                {9858}out(c, (m2_7651,sign(h(m2_7651),skSess_7388)));
                                                {9859}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9860}event endSrv(Cli_5016,Sess_5018,Nc_7647)
                                )
                                else
                                    {9861}let pkDisco_7652: bitstring = fail-any in
                                    {9862}in(c, (=pkCli_7594,em1_7653: bitstring,sigM1_7654: bitstring));
                                    {9863}let m1_7655: bitstring = em1_7653 in
                                    {9864}if (verify(h(m1_7655),sigM1_7654,pkCli_7594) <> true) then
                                        0
                                    else
                                        {9865}let (=OpenSecureChannelRequest,=pkCli_7594,Nc_7656: bitstring) = m1_7655 in
                                        {9866}new Ns_7657: bitstring;
                                        {9867}new ST_7658: bitstring;
                                        {9868}new TTL_7659: bitstring;
                                        {9869}let m2_7660: bitstring = (OpenSecureChannelResponse,Ns_7657,ST_7658,TTL_7659) in
                                        {9870}event beginSrv(Sess_5018,Cli_5016,Ns_7657);
                                        {9871}out(c, (m2_7660,sign(h(m2_7660),skSess_7388)));
                                        {9872}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {9873}event endSrv(Cli_5016,Sess_5018,Nc_7656)
                        )
                        else
                            {9874}let pkCli_7661: bitstring = fail-any in
                            {9875}let v_7662: bool = (Disco_5017 = A) in
                            (
                                {9876}if v_7662 then
                                (
                                    {9877}let pkDisco_7663: bitstring = pub(skA) in
                                    {9878}in(c, (=pkCli_7661,em1_7664: bitstring,sigM1_7665: bitstring));
                                    {9879}let m1_7666: bitstring = em1_7664 in
                                    {9880}if (verify(h(m1_7666),sigM1_7665,pkCli_7661) <> true) then
                                        0
                                    else
                                        {9881}let (=OpenSecureChannelRequest,=pkCli_7661,Nc_7667: bitstring) = m1_7666 in
                                        {9882}new Ns_7668: bitstring;
                                        {9883}new ST_7669: bitstring;
                                        {9884}new TTL_7670: bitstring;
                                        {9885}let m2_7671: bitstring = (OpenSecureChannelResponse,Ns_7668,ST_7669,TTL_7670) in
                                        {9886}event beginSrv(Sess_5018,Cli_5016,Ns_7668);
                                        {9887}out(c, (m2_7671,sign(h(m2_7671),skSess_7388)));
                                        {9888}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {9889}event endSrv(Cli_5016,Sess_5018,Nc_7667)
                                )
                                else
                                    {9890}let v_7672: bool = (Disco_5017 = B) in
                                    (
                                        {9891}if v_7672 then
                                        (
                                            {9892}let pkDisco_7673: bitstring = pub(skB) in
                                            {9893}in(c, (=pkCli_7661,em1_7674: bitstring,sigM1_7675: bitstring));
                                            {9894}let m1_7676: bitstring = em1_7674 in
                                            {9895}if (verify(h(m1_7676),sigM1_7675,pkCli_7661) <> true) then
                                                0
                                            else
                                                {9896}let (=OpenSecureChannelRequest,=pkCli_7661,Nc_7677: bitstring) = m1_7676 in
                                                {9897}new Ns_7678: bitstring;
                                                {9898}new ST_7679: bitstring;
                                                {9899}new TTL_7680: bitstring;
                                                {9900}let m2_7681: bitstring = (OpenSecureChannelResponse,Ns_7678,ST_7679,TTL_7680) in
                                                {9901}event beginSrv(Sess_5018,Cli_5016,Ns_7678);
                                                {9902}out(c, (m2_7681,sign(h(m2_7681),skSess_7388)));
                                                {9903}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {9904}event endSrv(Cli_5016,Sess_5018,Nc_7677)
                                        )
                                        else
                                            {9905}let v_7682: bool = (Disco_5017 = C) in
                                            (
                                                {9906}if v_7682 then
                                                (
                                                    {9907}let pkDisco_7683: bitstring = pub(skC) in
                                                    {9908}in(c, (=pkCli_7661,em1_7684: bitstring,sigM1_7685: bitstring));
                                                    {9909}let m1_7686: bitstring = em1_7684 in
                                                    {9910}if (verify(h(m1_7686),sigM1_7685,pkCli_7661) <> true) then
                                                        0
                                                    else
                                                        {9911}let (=OpenSecureChannelRequest,=pkCli_7661,Nc_7687: bitstring) = m1_7686 in
                                                        {9912}new Ns_7688: bitstring;
                                                        {9913}new ST_7689: bitstring;
                                                        {9914}new TTL_7690: bitstring;
                                                        {9915}let m2_7691: bitstring = (OpenSecureChannelResponse,Ns_7688,ST_7689,TTL_7690) in
                                                        {9916}event beginSrv(Sess_5018,Cli_5016,Ns_7688);
                                                        {9917}out(c, (m2_7691,sign(h(m2_7691),skSess_7388)));
                                                        {9918}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9919}event endSrv(Cli_5016,Sess_5018,Nc_7687)
                                                )
                                                else
                                                    {9920}let pkDisco_7692: bitstring = pub(sk(Disco_5017)) in
                                                    {9921}in(c, (=pkCli_7661,em1_7693: bitstring,sigM1_7694: bitstring));
                                                    {9922}let m1_7695: bitstring = em1_7693 in
                                                    {9923}if (verify(h(m1_7695),sigM1_7694,pkCli_7661) <> true) then
                                                        0
                                                    else
                                                        {9924}let (=OpenSecureChannelRequest,=pkCli_7661,Nc_7696: bitstring) = m1_7695 in
                                                        {9925}new Ns_7697: bitstring;
                                                        {9926}new ST_7698: bitstring;
                                                        {9927}new TTL_7699: bitstring;
                                                        {9928}let m2_7700: bitstring = (OpenSecureChannelResponse,Ns_7697,ST_7698,TTL_7699) in
                                                        {9929}event beginSrv(Sess_5018,Cli_5016,Ns_7697);
                                                        {9930}out(c, (m2_7700,sign(h(m2_7700),skSess_7388)));
                                                        {9931}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                        {9932}event endSrv(Cli_5016,Sess_5018,Nc_7696)
                                            )
                                            else
                                                {9933}let pkDisco_7701: bitstring = fail-any in
                                                {9934}in(c, (=pkCli_7661,em1_7702: bitstring,sigM1_7703: bitstring));
                                                {9935}let m1_7704: bitstring = em1_7702 in
                                                {9936}if (verify(h(m1_7704),sigM1_7703,pkCli_7661) <> true) then
                                                    0
                                                else
                                                    {9937}let (=OpenSecureChannelRequest,=pkCli_7661,Nc_7705: bitstring) = m1_7704 in
                                                    {9938}new Ns_7706: bitstring;
                                                    {9939}new ST_7707: bitstring;
                                                    {9940}new TTL_7708: bitstring;
                                                    {9941}let m2_7709: bitstring = (OpenSecureChannelResponse,Ns_7706,ST_7707,TTL_7708) in
                                                    {9942}event beginSrv(Sess_5018,Cli_5016,Ns_7706);
                                                    {9943}out(c, (m2_7709,sign(h(m2_7709),skSess_7388)));
                                                    {9944}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                    {9945}event endSrv(Cli_5016,Sess_5018,Nc_7705)
                                    )
                                    else
                                        {9946}let pkDisco_7710: bitstring = fail-any in
                                        {9947}in(c, (=pkCli_7661,em1_7711: bitstring,sigM1_7712: bitstring));
                                        {9948}let m1_7713: bitstring = em1_7711 in
                                        {9949}if (verify(h(m1_7713),sigM1_7712,pkCli_7661) <> true) then
                                            0
                                        else
                                            {9950}let (=OpenSecureChannelRequest,=pkCli_7661,Nc_7714: bitstring) = m1_7713 in
                                            {9951}new Ns_7715: bitstring;
                                            {9952}new ST_7716: bitstring;
                                            {9953}new TTL_7717: bitstring;
                                            {9954}let m2_7718: bitstring = (OpenSecureChannelResponse,Ns_7715,ST_7716,TTL_7717) in
                                            {9955}event beginSrv(Sess_5018,Cli_5016,Ns_7715);
                                            {9956}out(c, (m2_7718,sign(h(m2_7718),skSess_7388)));
                                            {9957}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {9958}event endSrv(Cli_5016,Sess_5018,Nc_7714)
                            )
                            else
                                {9959}let pkDisco_7719: bitstring = fail-any in
                                {9960}in(c, (=pkCli_7661,em1_7720: bitstring,sigM1_7721: bitstring));
                                {9961}let m1_7722: bitstring = em1_7720 in
                                {9962}if (verify(h(m1_7722),sigM1_7721,pkCli_7661) <> true) then
                                    0
                                else
                                    {9963}let (=OpenSecureChannelRequest,=pkCli_7661,Nc_7723: bitstring) = m1_7722 in
                                    {9964}new Ns_7724: bitstring;
                                    {9965}new ST_7725: bitstring;
                                    {9966}new TTL_7726: bitstring;
                                    {9967}let m2_7727: bitstring = (OpenSecureChannelResponse,Ns_7724,ST_7725,TTL_7726) in
                                    {9968}event beginSrv(Sess_5018,Cli_5016,Ns_7724);
                                    {9969}out(c, (m2_7727,sign(h(m2_7727),skSess_7388)));
                                    {9970}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {9971}event endSrv(Cli_5016,Sess_5018,Nc_7723)
                )
                else
                    {9972}let pkCli_7728: bitstring = fail-any in
                    {9973}let v_7729: bool = (Disco_5017 = A) in
                    (
                        {9974}if v_7729 then
                        (
                            {9975}let pkDisco_7730: bitstring = pub(skA) in
                            {9976}in(c, (=pkCli_7728,em1_7731: bitstring,sigM1_7732: bitstring));
                            {9977}let m1_7733: bitstring = em1_7731 in
                            {9978}if (verify(h(m1_7733),sigM1_7732,pkCli_7728) <> true) then
                                0
                            else
                                {9979}let (=OpenSecureChannelRequest,=pkCli_7728,Nc_7734: bitstring) = m1_7733 in
                                {9980}new Ns_7735: bitstring;
                                {9981}new ST_7736: bitstring;
                                {9982}new TTL_7737: bitstring;
                                {9983}let m2_7738: bitstring = (OpenSecureChannelResponse,Ns_7735,ST_7736,TTL_7737) in
                                {9984}event beginSrv(Sess_5018,Cli_5016,Ns_7735);
                                {9985}out(c, (m2_7738,sign(h(m2_7738),skSess_7388)));
                                {9986}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {9987}event endSrv(Cli_5016,Sess_5018,Nc_7734)
                        )
                        else
                            {9988}let v_7739: bool = (Disco_5017 = B) in
                            (
                                {9989}if v_7739 then
                                (
                                    {9990}let pkDisco_7740: bitstring = pub(skB) in
                                    {9991}in(c, (=pkCli_7728,em1_7741: bitstring,sigM1_7742: bitstring));
                                    {9992}let m1_7743: bitstring = em1_7741 in
                                    {9993}if (verify(h(m1_7743),sigM1_7742,pkCli_7728) <> true) then
                                        0
                                    else
                                        {9994}let (=OpenSecureChannelRequest,=pkCli_7728,Nc_7744: bitstring) = m1_7743 in
                                        {9995}new Ns_7745: bitstring;
                                        {9996}new ST_7746: bitstring;
                                        {9997}new TTL_7747: bitstring;
                                        {9998}let m2_7748: bitstring = (OpenSecureChannelResponse,Ns_7745,ST_7746,TTL_7747) in
                                        {9999}event beginSrv(Sess_5018,Cli_5016,Ns_7745);
                                        {10000}out(c, (m2_7748,sign(h(m2_7748),skSess_7388)));
                                        {10001}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {10002}event endSrv(Cli_5016,Sess_5018,Nc_7744)
                                )
                                else
                                    {10003}let v_7749: bool = (Disco_5017 = C) in
                                    (
                                        {10004}if v_7749 then
                                        (
                                            {10005}let pkDisco_7750: bitstring = pub(skC) in
                                            {10006}in(c, (=pkCli_7728,em1_7751: bitstring,sigM1_7752: bitstring));
                                            {10007}let m1_7753: bitstring = em1_7751 in
                                            {10008}if (verify(h(m1_7753),sigM1_7752,pkCli_7728) <> true) then
                                                0
                                            else
                                                {10009}let (=OpenSecureChannelRequest,=pkCli_7728,Nc_7754: bitstring) = m1_7753 in
                                                {10010}new Ns_7755: bitstring;
                                                {10011}new ST_7756: bitstring;
                                                {10012}new TTL_7757: bitstring;
                                                {10013}let m2_7758: bitstring = (OpenSecureChannelResponse,Ns_7755,ST_7756,TTL_7757) in
                                                {10014}event beginSrv(Sess_5018,Cli_5016,Ns_7755);
                                                {10015}out(c, (m2_7758,sign(h(m2_7758),skSess_7388)));
                                                {10016}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {10017}event endSrv(Cli_5016,Sess_5018,Nc_7754)
                                        )
                                        else
                                            {10018}let pkDisco_7759: bitstring = pub(sk(Disco_5017)) in
                                            {10019}in(c, (=pkCli_7728,em1_7760: bitstring,sigM1_7761: bitstring));
                                            {10020}let m1_7762: bitstring = em1_7760 in
                                            {10021}if (verify(h(m1_7762),sigM1_7761,pkCli_7728) <> true) then
                                                0
                                            else
                                                {10022}let (=OpenSecureChannelRequest,=pkCli_7728,Nc_7763: bitstring) = m1_7762 in
                                                {10023}new Ns_7764: bitstring;
                                                {10024}new ST_7765: bitstring;
                                                {10025}new TTL_7766: bitstring;
                                                {10026}let m2_7767: bitstring = (OpenSecureChannelResponse,Ns_7764,ST_7765,TTL_7766) in
                                                {10027}event beginSrv(Sess_5018,Cli_5016,Ns_7764);
                                                {10028}out(c, (m2_7767,sign(h(m2_7767),skSess_7388)));
                                                {10029}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                                {10030}event endSrv(Cli_5016,Sess_5018,Nc_7763)
                                    )
                                    else
                                        {10031}let pkDisco_7768: bitstring = fail-any in
                                        {10032}in(c, (=pkCli_7728,em1_7769: bitstring,sigM1_7770: bitstring));
                                        {10033}let m1_7771: bitstring = em1_7769 in
                                        {10034}if (verify(h(m1_7771),sigM1_7770,pkCli_7728) <> true) then
                                            0
                                        else
                                            {10035}let (=OpenSecureChannelRequest,=pkCli_7728,Nc_7772: bitstring) = m1_7771 in
                                            {10036}new Ns_7773: bitstring;
                                            {10037}new ST_7774: bitstring;
                                            {10038}new TTL_7775: bitstring;
                                            {10039}let m2_7776: bitstring = (OpenSecureChannelResponse,Ns_7773,ST_7774,TTL_7775) in
                                            {10040}event beginSrv(Sess_5018,Cli_5016,Ns_7773);
                                            {10041}out(c, (m2_7776,sign(h(m2_7776),skSess_7388)));
                                            {10042}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                            {10043}event endSrv(Cli_5016,Sess_5018,Nc_7772)
                            )
                            else
                                {10044}let pkDisco_7777: bitstring = fail-any in
                                {10045}in(c, (=pkCli_7728,em1_7778: bitstring,sigM1_7779: bitstring));
                                {10046}let m1_7780: bitstring = em1_7778 in
                                {10047}if (verify(h(m1_7780),sigM1_7779,pkCli_7728) <> true) then
                                    0
                                else
                                    {10048}let (=OpenSecureChannelRequest,=pkCli_7728,Nc_7781: bitstring) = m1_7780 in
                                    {10049}new Ns_7782: bitstring;
                                    {10050}new ST_7783: bitstring;
                                    {10051}new TTL_7784: bitstring;
                                    {10052}let m2_7785: bitstring = (OpenSecureChannelResponse,Ns_7782,ST_7783,TTL_7784) in
                                    {10053}event beginSrv(Sess_5018,Cli_5016,Ns_7782);
                                    {10054}out(c, (m2_7785,sign(h(m2_7785),skSess_7388)));
                                    {10055}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {10056}event endSrv(Cli_5016,Sess_5018,Nc_7781)
                    )
                    else
                        {10057}let pkDisco_7786: bitstring = fail-any in
                        {10058}in(c, (=pkCli_7728,em1_7787: bitstring,sigM1_7788: bitstring));
                        {10059}let m1_7789: bitstring = em1_7787 in
                        {10060}if (verify(h(m1_7789),sigM1_7788,pkCli_7728) <> true) then
                            0
                        else
                            {10061}let (=OpenSecureChannelRequest,=pkCli_7728,Nc_7790: bitstring) = m1_7789 in
                            {10062}new Ns_7791: bitstring;
                            {10063}new ST_7792: bitstring;
                            {10064}new TTL_7793: bitstring;
                            {10065}let m2_7794: bitstring = (OpenSecureChannelResponse,Ns_7791,ST_7792,TTL_7793) in
                            {10066}event beginSrv(Sess_5018,Cli_5016,Ns_7791);
                            {10067}out(c, (m2_7794,sign(h(m2_7794),skSess_7388)));
                            {10068}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                            {10069}event endSrv(Cli_5016,Sess_5018,Nc_7790)
        )
        else
            {10070}let pkCli_7795: bitstring = fail-any in
            {10071}let v_7796: bool = (Disco_5017 = A) in
            (
                {10072}if v_7796 then
                (
                    {10073}let pkDisco_7797: bitstring = pub(skA) in
                    {10074}in(c, (=pkCli_7795,em1_7798: bitstring,sigM1_7799: bitstring));
                    {10075}let m1_7800: bitstring = em1_7798 in
                    {10076}if (verify(h(m1_7800),sigM1_7799,pkCli_7795) <> true) then
                        0
                    else
                        {10077}let (=OpenSecureChannelRequest,=pkCli_7795,Nc_7801: bitstring) = m1_7800 in
                        {10078}new Ns_7802: bitstring;
                        {10079}new ST_7803: bitstring;
                        {10080}new TTL_7804: bitstring;
                        {10081}let m2_7805: bitstring = (OpenSecureChannelResponse,Ns_7802,ST_7803,TTL_7804) in
                        {10082}event beginSrv(Sess_5018,Cli_5016,Ns_7802);
                        {10083}out(c, (m2_7805,sign(h(m2_7805),skSess_7388)));
                        {10084}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                        {10085}event endSrv(Cli_5016,Sess_5018,Nc_7801)
                )
                else
                    {10086}let v_7806: bool = (Disco_5017 = B) in
                    (
                        {10087}if v_7806 then
                        (
                            {10088}let pkDisco_7807: bitstring = pub(skB) in
                            {10089}in(c, (=pkCli_7795,em1_7808: bitstring,sigM1_7809: bitstring));
                            {10090}let m1_7810: bitstring = em1_7808 in
                            {10091}if (verify(h(m1_7810),sigM1_7809,pkCli_7795) <> true) then
                                0
                            else
                                {10092}let (=OpenSecureChannelRequest,=pkCli_7795,Nc_7811: bitstring) = m1_7810 in
                                {10093}new Ns_7812: bitstring;
                                {10094}new ST_7813: bitstring;
                                {10095}new TTL_7814: bitstring;
                                {10096}let m2_7815: bitstring = (OpenSecureChannelResponse,Ns_7812,ST_7813,TTL_7814) in
                                {10097}event beginSrv(Sess_5018,Cli_5016,Ns_7812);
                                {10098}out(c, (m2_7815,sign(h(m2_7815),skSess_7388)));
                                {10099}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                {10100}event endSrv(Cli_5016,Sess_5018,Nc_7811)
                        )
                        else
                            {10101}let v_7816: bool = (Disco_5017 = C) in
                            (
                                {10102}if v_7816 then
                                (
                                    {10103}let pkDisco_7817: bitstring = pub(skC) in
                                    {10104}in(c, (=pkCli_7795,em1_7818: bitstring,sigM1_7819: bitstring));
                                    {10105}let m1_7820: bitstring = em1_7818 in
                                    {10106}if (verify(h(m1_7820),sigM1_7819,pkCli_7795) <> true) then
                                        0
                                    else
                                        {10107}let (=OpenSecureChannelRequest,=pkCli_7795,Nc_7821: bitstring) = m1_7820 in
                                        {10108}new Ns_7822: bitstring;
                                        {10109}new ST_7823: bitstring;
                                        {10110}new TTL_7824: bitstring;
                                        {10111}let m2_7825: bitstring = (OpenSecureChannelResponse,Ns_7822,ST_7823,TTL_7824) in
                                        {10112}event beginSrv(Sess_5018,Cli_5016,Ns_7822);
                                        {10113}out(c, (m2_7825,sign(h(m2_7825),skSess_7388)));
                                        {10114}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {10115}event endSrv(Cli_5016,Sess_5018,Nc_7821)
                                )
                                else
                                    {10116}let pkDisco_7826: bitstring = pub(sk(Disco_5017)) in
                                    {10117}in(c, (=pkCli_7795,em1_7827: bitstring,sigM1_7828: bitstring));
                                    {10118}let m1_7829: bitstring = em1_7827 in
                                    {10119}if (verify(h(m1_7829),sigM1_7828,pkCli_7795) <> true) then
                                        0
                                    else
                                        {10120}let (=OpenSecureChannelRequest,=pkCli_7795,Nc_7830: bitstring) = m1_7829 in
                                        {10121}new Ns_7831: bitstring;
                                        {10122}new ST_7832: bitstring;
                                        {10123}new TTL_7833: bitstring;
                                        {10124}let m2_7834: bitstring = (OpenSecureChannelResponse,Ns_7831,ST_7832,TTL_7833) in
                                        {10125}event beginSrv(Sess_5018,Cli_5016,Ns_7831);
                                        {10126}out(c, (m2_7834,sign(h(m2_7834),skSess_7388)));
                                        {10127}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                        {10128}event endSrv(Cli_5016,Sess_5018,Nc_7830)
                            )
                            else
                                {10129}let pkDisco_7835: bitstring = fail-any in
                                {10130}in(c, (=pkCli_7795,em1_7836: bitstring,sigM1_7837: bitstring));
                                {10131}let m1_7838: bitstring = em1_7836 in
                                {10132}if (verify(h(m1_7838),sigM1_7837,pkCli_7795) <> true) then
                                    0
                                else
                                    {10133}let (=OpenSecureChannelRequest,=pkCli_7795,Nc_7839: bitstring) = m1_7838 in
                                    {10134}new Ns_7840: bitstring;
                                    {10135}new ST_7841: bitstring;
                                    {10136}new TTL_7842: bitstring;
                                    {10137}let m2_7843: bitstring = (OpenSecureChannelResponse,Ns_7840,ST_7841,TTL_7842) in
                                    {10138}event beginSrv(Sess_5018,Cli_5016,Ns_7840);
                                    {10139}out(c, (m2_7843,sign(h(m2_7843),skSess_7388)));
                                    {10140}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                                    {10141}event endSrv(Cli_5016,Sess_5018,Nc_7839)
                    )
                    else
                        {10142}let pkDisco_7844: bitstring = fail-any in
                        {10143}in(c, (=pkCli_7795,em1_7845: bitstring,sigM1_7846: bitstring));
                        {10144}let m1_7847: bitstring = em1_7845 in
                        {10145}if (verify(h(m1_7847),sigM1_7846,pkCli_7795) <> true) then
                            0
                        else
                            {10146}let (=OpenSecureChannelRequest,=pkCli_7795,Nc_7848: bitstring) = m1_7847 in
                            {10147}new Ns_7849: bitstring;
                            {10148}new ST_7850: bitstring;
                            {10149}new TTL_7851: bitstring;
                            {10150}let m2_7852: bitstring = (OpenSecureChannelResponse,Ns_7849,ST_7850,TTL_7851) in
                            {10151}event beginSrv(Sess_5018,Cli_5016,Ns_7849);
                            {10152}out(c, (m2_7852,sign(h(m2_7852),skSess_7388)));
                            {10153}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                            {10154}event endSrv(Cli_5016,Sess_5018,Nc_7848)
            )
            else
                {10155}let pkDisco_7853: bitstring = fail-any in
                {10156}in(c, (=pkCli_7795,em1_7854: bitstring,sigM1_7855: bitstring));
                {10157}let m1_7856: bitstring = em1_7854 in
                {10158}if (verify(h(m1_7856),sigM1_7855,pkCli_7795) <> true) then
                    0
                else
                    {10159}let (=OpenSecureChannelRequest,=pkCli_7795,Nc_7857: bitstring) = m1_7856 in
                    {10160}new Ns_7858: bitstring;
                    {10161}new ST_7859: bitstring;
                    {10162}new TTL_7860: bitstring;
                    {10163}let m2_7861: bitstring = (OpenSecureChannelResponse,Ns_7858,ST_7859,TTL_7860) in
                    {10164}event beginSrv(Sess_5018,Cli_5016,Ns_7858);
                    {10165}out(c, (m2_7861,sign(h(m2_7861),skSess_7388)));
                    {10166}if ((Cli_5016 = A) || ((Cli_5016 = B) || (Cli_5016 = C))) then
                    {10167}event endSrv(Cli_5016,Sess_5018,Nc_7857)
)

-- Query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
Completing...
200 rules inserted. The rule base contains 85 rules. 397 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 397 rules in the queue.
600 rules inserted. The rule base contains 277 rules. 395 rules in the queue.
800 rules inserted. The rule base contains 277 rules. 395 rules in the queue.
1000 rules inserted. The rule base contains 265 rules. 381 rules in the queue.
1200 rules inserted. The rule base contains 277 rules. 369 rules in the queue.
1400 rules inserted. The rule base contains 323 rules. 323 rules in the queue.
1600 rules inserted. The rule base contains 337 rules. 309 rules in the queue.
1800 rules inserted. The rule base contains 414 rules. 504 rules in the queue.
2000 rules inserted. The rule base contains 480 rules. 742 rules in the queue.
2200 rules inserted. The rule base contains 518 rules. 1616 rules in the queue.
2400 rules inserted. The rule base contains 526 rules. 1800 rules in the queue.
2600 rules inserted. The rule base contains 526 rules. 1800 rules in the queue.
2800 rules inserted. The rule base contains 534 rules. 1984 rules in the queue.
3000 rules inserted. The rule base contains 534 rules. 1984 rules in the queue.
3200 rules inserted. The rule base contains 538 rules. 2076 rules in the queue.
3400 rules inserted. The rule base contains 542 rules. 2168 rules in the queue.
3600 rules inserted. The rule base contains 544 rules. 2214 rules in the queue.
3800 rules inserted. The rule base contains 550 rules. 2352 rules in the queue.
4000 rules inserted. The rule base contains 550 rules. 2352 rules in the queue.
4200 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
4400 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
4600 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
4800 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
5000 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
5200 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
5400 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
5600 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
5800 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
6000 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
6200 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
6400 rules inserted. The rule base contains 574 rules. 2346 rules in the queue.
6600 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
6800 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
7000 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
7200 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
7400 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
7600 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
7800 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
8000 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
8200 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
8400 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
8600 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
8800 rules inserted. The rule base contains 598 rules. 2340 rules in the queue.
9000 rules inserted. The rule base contains 606 rules. 2338 rules in the queue.
9200 rules inserted. The rule base contains 606 rules. 2338 rules in the queue.
9400 rules inserted. The rule base contains 606 rules. 2338 rules in the queue.
9600 rules inserted. The rule base contains 614 rules. 2336 rules in the queue.
9800 rules inserted. The rule base contains 614 rules. 2336 rules in the queue.
10000 rules inserted. The rule base contains 622 rules. 2334 rules in the queue.
10200 rules inserted. The rule base contains 622 rules. 2334 rules in the queue.
10400 rules inserted. The rule base contains 630 rules. 2332 rules in the queue.
10600 rules inserted. The rule base contains 630 rules. 2332 rules in the queue.
10800 rules inserted. The rule base contains 630 rules. 2332 rules in the queue.
11000 rules inserted. The rule base contains 638 rules. 2330 rules in the queue.
11200 rules inserted. The rule base contains 673 rules. 2319 rules in the queue.
11400 rules inserted. The rule base contains 710 rules. 2312 rules in the queue.
11600 rules inserted. The rule base contains 726 rules. 2308 rules in the queue.
11800 rules inserted. The rule base contains 766 rules. 2298 rules in the queue.
12000 rules inserted. The rule base contains 804 rules. 2287 rules in the queue.
12200 rules inserted. The rule base contains 838 rules. 2280 rules in the queue.
12400 rules inserted. The rule base contains 870 rules. 2272 rules in the queue.
12600 rules inserted. The rule base contains 918 rules. 2260 rules in the queue.
12800 rules inserted. The rule base contains 950 rules. 2252 rules in the queue.
13000 rules inserted. The rule base contains 966 rules. 2248 rules in the queue.
13200 rules inserted. The rule base contains 1002 rules. 2239 rules in the queue.
13400 rules inserted. The rule base contains 1066 rules. 2223 rules in the queue.
13600 rules inserted. The rule base contains 1136 rules. 2204 rules in the queue.
13800 rules inserted. The rule base contains 1250 rules. 2177 rules in the queue.
14000 rules inserted. The rule base contains 1334 rules. 2156 rules in the queue.
14200 rules inserted. The rule base contains 1434 rules. 2131 rules in the queue.
14400 rules inserted. The rule base contains 1526 rules. 2108 rules in the queue.
14600 rules inserted. The rule base contains 1632 rules. 2080 rules in the queue.
14800 rules inserted. The rule base contains 1730 rules. 2057 rules in the queue.
15000 rules inserted. The rule base contains 1854 rules. 2026 rules in the queue.
15200 rules inserted. The rule base contains 1914 rules. 2011 rules in the queue.
15400 rules inserted. The rule base contains 2028 rules. 1981 rules in the queue.
15600 rules inserted. The rule base contains 2142 rules. 1954 rules in the queue.
15800 rules inserted. The rule base contains 2194 rules. 1941 rules in the queue.
16000 rules inserted. The rule base contains 2268 rules. 1921 rules in the queue.
16200 rules inserted. The rule base contains 2366 rules. 1898 rules in the queue.
16400 rules inserted. The rule base contains 2402 rules. 1889 rules in the queue.
16600 rules inserted. The rule base contains 2481 rules. 1867 rules in the queue.
16800 rules inserted. The rule base contains 2554 rules. 1851 rules in the queue.
17000 rules inserted. The rule base contains 2598 rules. 1840 rules in the queue.
17200 rules inserted. The rule base contains 2710 rules. 1812 rules in the queue.
17400 rules inserted. The rule base contains 2774 rules. 1796 rules in the queue.
17600 rules inserted. The rule base contains 2798 rules. 1790 rules in the queue.
17800 rules inserted. The rule base contains 2806 rules. 1788 rules in the queue.
18000 rules inserted. The rule base contains 2828 rules. 1781 rules in the queue.
18200 rules inserted. The rule base contains 2838 rules. 1780 rules in the queue.
18400 rules inserted. The rule base contains 2854 rules. 1776 rules in the queue.
18600 rules inserted. The rule base contains 2862 rules. 1774 rules in the queue.
18800 rules inserted. The rule base contains 2870 rules. 1772 rules in the queue.
19000 rules inserted. The rule base contains 2890 rules. 1767 rules in the queue.
19200 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
19400 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
19600 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
19800 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
20000 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
20200 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
20400 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
20600 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
20800 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
21000 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
21200 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
21400 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
21600 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
21800 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
22000 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
22200 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
22400 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
22600 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
22800 rules inserted. The rule base contains 2902 rules. 1764 rules in the queue.
23000 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
23200 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
23400 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
23600 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
23800 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
24000 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
24200 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
24400 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
24600 rules inserted. The rule base contains 2908 rules. 1758 rules in the queue.
24800 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
25000 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
25200 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
25400 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
25600 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
25800 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
26000 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
26200 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
26400 rules inserted. The rule base contains 2926 rules. 1740 rules in the queue.
26600 rules inserted. The rule base contains 2940 rules. 1726 rules in the queue.
26800 rules inserted. The rule base contains 2940 rules. 1726 rules in the queue.
27000 rules inserted. The rule base contains 2942 rules. 1724 rules in the queue.
27200 rules inserted. The rule base contains 2942 rules. 1724 rules in the queue.
27400 rules inserted. The rule base contains 2944 rules. 1722 rules in the queue.
27600 rules inserted. The rule base contains 2946 rules. 1720 rules in the queue.
27800 rules inserted. The rule base contains 2946 rules. 1720 rules in the queue.
28000 rules inserted. The rule base contains 2948 rules. 1718 rules in the queue.
28200 rules inserted. The rule base contains 2952 rules. 1714 rules in the queue.
28400 rules inserted. The rule base contains 2970 rules. 1696 rules in the queue.
28600 rules inserted. The rule base contains 2976 rules. 1690 rules in the queue.
28800 rules inserted. The rule base contains 2996 rules. 1670 rules in the queue.
29000 rules inserted. The rule base contains 3013 rules. 1653 rules in the queue.
29200 rules inserted. The rule base contains 3020 rules. 1646 rules in the queue.
29400 rules inserted. The rule base contains 3040 rules. 1626 rules in the queue.
29600 rules inserted. The rule base contains 3046 rules. 1620 rules in the queue.
29800 rules inserted. The rule base contains 3066 rules. 1600 rules in the queue.
30000 rules inserted. The rule base contains 3122 rules. 1544 rules in the queue.
30200 rules inserted. The rule base contains 3170 rules. 1496 rules in the queue.
30400 rules inserted. The rule base contains 3230 rules. 1436 rules in the queue.
30600 rules inserted. The rule base contains 3282 rules. 1384 rules in the queue.
30800 rules inserted. The rule base contains 3352 rules. 1314 rules in the queue.
31000 rules inserted. The rule base contains 3421 rules. 1245 rules in the queue.
31200 rules inserted. The rule base contains 3461 rules. 1205 rules in the queue.
31400 rules inserted. The rule base contains 3531 rules. 1135 rules in the queue.
31600 rules inserted. The rule base contains 3659 rules. 1007 rules in the queue.
31800 rules inserted. The rule base contains 3761 rules. 905 rules in the queue.
32000 rules inserted. The rule base contains 3894 rules. 772 rules in the queue.
32200 rules inserted. The rule base contains 4026 rules. 640 rules in the queue.
32400 rules inserted. The rule base contains 4144 rules. 522 rules in the queue.
32600 rules inserted. The rule base contains 4294 rules. 372 rules in the queue.
32800 rules inserted. The rule base contains 4466 rules. 200 rules in the queue.
33000 rules inserted. The rule base contains 4646 rules. 20 rules in the queue.
Starting query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
goal reachable: Sess_391649 <> C[] && Sess_391649 <> B[] && Sess_391649 <> A[] && begin(beginSrv(A[],C[],Ns_5173[sigM1_5170 = sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_1769[UP_1768 = UP_391647,SP_1767 = SP_391648,Sess = Sess_391649,Disco = B[],Cli = C[],!1 = @sid_391650])),skC[]),em1_5169 = (OpenSecureChannelRequest,pub(skC[]),Nc_1769[UP_1768 = UP_391647,SP_1767 = SP_391648,Sess = Sess_391649,Disco = B[],Cli = C[],!1 = @sid_391650]),Sess_5018 = A[],Disco_5017 = B[],Cli_5016 = C[],!1 = @sid_391651])) && attacker(SP_391648) && attacker(UP_391647) && attacker(Sess_391649) -> end(endCli(A[],B[],Ns_5173[sigM1_5170 = sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_1769[UP_1768 = UP_391647,SP_1767 = SP_391648,Sess = Sess_391649,Disco = B[],Cli = C[],!1 = @sid_391650])),skC[]),em1_5169 = (OpenSecureChannelRequest,pub(skC[]),Nc_1769[UP_1768 = UP_391647,SP_1767 = SP_391648,Sess = Sess_391649,Disco = B[],Cli = C[],!1 = @sid_391650]),Sess_5018 = A[],Disco_5017 = B[],Cli_5016 = C[],!1 = @sid_391651]))
Abbreviations:
Nc_400210 = Nc_1769[UP_1768 = UP_400169,SP_1767 = SP_400168,Sess = Sess_400167,Disco = B[],Cli = C[],!1 = @sid_400170]
Ns_400211 = Ns_5173[sigM1_5170 = sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[]),em1_5169 = (OpenSecureChannelRequest,pub(skC[]),Nc_400210),Sess_5018 = A[],Disco_5017 = B[],Cli_5016 = C[],!1 = @sid_400184]
ST_400212 = ST_5174[sigM1_5170 = sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[]),em1_5169 = (OpenSecureChannelRequest,pub(skC[]),Nc_400210),Sess_5018 = A[],Disco_5017 = B[],Cli_5016 = C[],!1 = @sid_400184]
TTL_400213 = TTL_5175[sigM1_5170 = sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[]),em1_5169 = (OpenSecureChannelRequest,pub(skC[]),Nc_400210),Sess_5018 = A[],Disco_5017 = B[],Cli_5016 = C[],!1 = @sid_400184]

1. The attacker initially knows A[].
attacker(A[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 1, the attacker may know A[].
By 1, the attacker may know A[].
Using the function 3-tuple the attacker may obtain (B[],A[],A[]).
attacker((B[],A[],A[])).

4. The attacker has some term UP_400205.
attacker(UP_400205).

5. The attacker has some term SP_400204.
attacker(SP_400204).

6. Using the function Sign the attacker may obtain Sign.
attacker(Sign).

7. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skA[]).
By 6, the attacker may know Sign.
By 5, the attacker may know SP_400204.
By 4, the attacker may know UP_400205.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skA[]),Sign,SP_400204,UP_400205).
attacker((GetEndpointResponse,pub(skA[]),Sign,SP_400204,UP_400205)).

10. The attacker initially knows C[].
attacker(C[]).

11. By 10, the attacker may know C[].
By 2, the attacker may know B[].
By 1, the attacker may know A[].
Using the function 3-tuple the attacker may obtain (C[],B[],A[]).
attacker((C[],B[],A[])).

12. We assume as hypothesis that
attacker(Sess_400167).

13. By 10, the attacker may know C[].
By 2, the attacker may know B[].
By 12, the attacker may know Sess_400167.
Using the function 3-tuple the attacker may obtain (C[],B[],Sess_400167).
attacker((C[],B[],Sess_400167)).

14. We assume as hypothesis that
attacker(UP_400169).

15. We assume as hypothesis that
attacker(SP_400168).

16. By 12, the attacker may know Sess_400167.
Using the function sk the attacker may obtain sk(Sess_400167).
attacker(sk(Sess_400167)).

17. By 16, the attacker may know sk(Sess_400167).
Using the function pub the attacker may obtain pub(sk(Sess_400167)).
attacker(pub(sk(Sess_400167))).

18. By 8, the attacker may know GetEndpointResponse.
By 17, the attacker may know pub(sk(Sess_400167)).
By 6, the attacker may know Sign.
By 15, the attacker may know SP_400168.
By 14, the attacker may know UP_400169.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(sk(Sess_400167)),Sign,SP_400168,UP_400169).
attacker((GetEndpointResponse,pub(sk(Sess_400167)),Sign,SP_400168,UP_400169)).

19. The message (C[],B[],Sess_400167) that the attacker may have by 13 may be received at input {8}.
The message (GetEndpointResponse,pub(sk(Sess_400167)),Sign,SP_400168,UP_400169) that the attacker may have by 18 may be received at input {1554}.
We have Sess_400167 <> C[] & Sess_400167 <> B[] & Sess_400167 <> A[].
So the message (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_400210),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[])) may be sent to the attacker at output {1558}.
attacker((pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_400210),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[]))).

20. By 19, the attacker may know (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_400210),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[])).
Using the function 3-proj-3-tuple the attacker may obtain sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[]).
attacker(sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[])).

21. By 19, the attacker may know (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_400210),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[])).
Using the function 2-proj-3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),Nc_400210).
attacker((OpenSecureChannelRequest,pub(skC[]),Nc_400210)).

22. By 21, the attacker may know (OpenSecureChannelRequest,pub(skC[]),Nc_400210).
Using the function 3-proj-3-tuple the attacker may obtain Nc_400210.
attacker(Nc_400210).

23. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

24. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

25. By 24, the attacker may know OpenSecureChannelRequest.
By 23, the attacker may know pub(skC[]).
By 22, the attacker may know Nc_400210.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),Nc_400210).
attacker((OpenSecureChannelRequest,pub(skC[]),Nc_400210)).

26. By 23, the attacker may know pub(skC[]).
By 25, the attacker may know (OpenSecureChannelRequest,pub(skC[]),Nc_400210).
By 20, the attacker may know sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[]).
Using the function 3-tuple the attacker may obtain (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_400210),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[])).
attacker((pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_400210),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[]))).

27. The message (C[],B[],A[]) that the attacker may have by 11 may be received at input {5998}.
The message (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_400210),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_400210)),skC[])) that the attacker may have by 26 may be received at input {6224}.
The event beginSrv(A[],C[],Ns_400211) may be executed at {6232}.
So the message ((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213),sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[])) may be sent to the attacker at output {6233}.
attacker(((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213),sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[]))).

28. By 27, the attacker may know ((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213),sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[])).
Using the function 2-proj-2-tuple the attacker may obtain sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[]).
attacker(sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[])).

29. By 27, the attacker may know ((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213),sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[])).
Using the function 1-proj-2-tuple the attacker may obtain (OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213).
attacker((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)).

30. By 29, the attacker may know (OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213).
Using the function 4-proj-4-tuple the attacker may obtain TTL_400213.
attacker(TTL_400213).

31. By 29, the attacker may know (OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213).
Using the function 3-proj-4-tuple the attacker may obtain ST_400212.
attacker(ST_400212).

32. By 29, the attacker may know (OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213).
Using the function 2-proj-4-tuple the attacker may obtain Ns_400211.
attacker(Ns_400211).

33. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

34. By 33, the attacker may know OpenSecureChannelResponse.
By 32, the attacker may know Ns_400211.
By 31, the attacker may know ST_400212.
By 30, the attacker may know TTL_400213.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213).
attacker((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)).

35. By 34, the attacker may know (OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213).
By 28, the attacker may know sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[]).
Using the function 2-tuple the attacker may obtain ((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213),sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[])).
attacker(((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213),sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[]))).

36. The message (B[],A[],A[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skA[]),Sign,SP_400204,UP_400205) that the attacker may have by 9 may be received at input {716}.
The message ((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213),sign(h((OpenSecureChannelResponse,Ns_400211,ST_400212,TTL_400213)),skA[])) that the attacker may have by 35 may be received at input {721}.
So event endCli(A[],B[],Ns_400211) may be executed at {726}.
end(endCli(A[],B[],Ns_400211)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,a_400215)) at {8} in copy a_400216

out(c, GetEndpointRequest) at {1553} in copy a_400216

in(c, (GetEndpointResponse,pub(sk(a_400215)),Sign,a_400214,a)) at {1554} in copy a_400216

new Nc_1769 creating Nc_400221 at {1555} in copy a_400216

event(beginCli(C,a_400215,Nc_400221)) at {1557} in copy a_400216

out(c, (pub(skC),(OpenSecureChannelRequest,pub(skC),Nc_400221),sign(h((OpenSecureChannelRequest,pub(skC),Nc_400221)),skC))) at {1558} in copy a_400216

in(c, (B,A,A)) at {8} in copy a_400220

out(c, GetEndpointRequest) at {715} in copy a_400220

in(c, (GetEndpointResponse,pub(skA),Sign,a_400218,a_400219)) at {716} in copy a_400220

new Nc_1080 creating Nc_444168 at {717} in copy a_400220

event(beginCli(B,A,Nc_444168)) at {719} in copy a_400220

out(c, (pub(skB),(OpenSecureChannelRequest,pub(skB),Nc_444168),sign(h((OpenSecureChannelRequest,pub(skB),Nc_444168)),skB))) at {720} in copy a_400220

in(c, (C,B,A)) at {5998} in copy a_400217

in(c, (pub(skC),(OpenSecureChannelRequest,pub(skC),Nc_400221),sign(h((OpenSecureChannelRequest,pub(skC),Nc_400221)),skC))) at {6224} in copy a_400217

new Ns_5173 creating Ns_400222 at {6228} in copy a_400217

new ST_5174 creating ST_400223 at {6229} in copy a_400217

new TTL_5175 creating TTL_400224 at {6230} in copy a_400217

event(beginSrv(A,C,Ns_400222)) at {6232} in copy a_400217

out(c, ((OpenSecureChannelResponse,Ns_400222,ST_400223,TTL_400224),sign(h((OpenSecureChannelResponse,Ns_400222,ST_400223,TTL_400224)),skA))) at {6233} in copy a_400217

event(endSrv(C,A,Nc_400221)) at {6235} in copy a_400217

in(c, ((OpenSecureChannelResponse,Ns_400222,ST_400223,TTL_400224),sign(h((OpenSecureChannelResponse,Ns_400222,ST_400223,TTL_400224)),skA))) at {721} in copy a_400220

event(endCli(A,B,Ns_400222)) at {726} in copy a_400220

The event endCli(A,B,Ns_400222) is executed.
A trace has been found.
RESULT event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N)) is false.
-- Query event(endSrv(X_449167,Y_449168,N_449169)) ==> event(beginCli(X_449167,Y_449168,N_449169))
Completing...
200 rules inserted. The rule base contains 76 rules. 397 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 397 rules in the queue.
600 rules inserted. The rule base contains 277 rules. 395 rules in the queue.
800 rules inserted. The rule base contains 277 rules. 395 rules in the queue.
1000 rules inserted. The rule base contains 266 rules. 380 rules in the queue.
1200 rules inserted. The rule base contains 277 rules. 369 rules in the queue.
1400 rules inserted. The rule base contains 331 rules. 315 rules in the queue.
1600 rules inserted. The rule base contains 337 rules. 309 rules in the queue.
1800 rules inserted. The rule base contains 414 rules. 522 rules in the queue.
2000 rules inserted. The rule base contains 480 rules. 781 rules in the queue.
2200 rules inserted. The rule base contains 518 rules. 1712 rules in the queue.
2400 rules inserted. The rule base contains 526 rules. 1908 rules in the queue.
2600 rules inserted. The rule base contains 526 rules. 1908 rules in the queue.
2800 rules inserted. The rule base contains 534 rules. 2104 rules in the queue.
3000 rules inserted. The rule base contains 534 rules. 2104 rules in the queue.
3200 rules inserted. The rule base contains 538 rules. 2202 rules in the queue.
3400 rules inserted. The rule base contains 542 rules. 2300 rules in the queue.
3600 rules inserted. The rule base contains 542 rules. 2300 rules in the queue.
3800 rules inserted. The rule base contains 548 rules. 2447 rules in the queue.
4000 rules inserted. The rule base contains 550 rules. 2496 rules in the queue.
4200 rules inserted. The rule base contains 550 rules. 2496 rules in the queue.
4400 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
4600 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
4800 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
5000 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
5200 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
5400 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
5600 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
5800 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
6000 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
6200 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
6400 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
6600 rules inserted. The rule base contains 574 rules. 2472 rules in the queue.
6800 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
7000 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
7200 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
7400 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
7600 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
7800 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
8000 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
8200 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
8400 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
8600 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
8800 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
9000 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
9200 rules inserted. The rule base contains 598 rules. 2448 rules in the queue.
9400 rules inserted. The rule base contains 607 rules. 2439 rules in the queue.
9600 rules inserted. The rule base contains 607 rules. 2439 rules in the queue.
9800 rules inserted. The rule base contains 607 rules. 2439 rules in the queue.
10000 rules inserted. The rule base contains 616 rules. 2430 rules in the queue.
10200 rules inserted. The rule base contains 616 rules. 2430 rules in the queue.
10400 rules inserted. The rule base contains 625 rules. 2421 rules in the queue.
10600 rules inserted. The rule base contains 625 rules. 2421 rules in the queue.
10800 rules inserted. The rule base contains 634 rules. 2412 rules in the queue.
11000 rules inserted. The rule base contains 634 rules. 2412 rules in the queue.
11200 rules inserted. The rule base contains 634 rules. 2412 rules in the queue.
11400 rules inserted. The rule base contains 643 rules. 2403 rules in the queue.
11600 rules inserted. The rule base contains 652 rules. 2394 rules in the queue.
11800 rules inserted. The rule base contains 704 rules. 2342 rules in the queue.
12000 rules inserted. The rule base contains 731 rules. 2315 rules in the queue.
12200 rules inserted. The rule base contains 749 rules. 2297 rules in the queue.
12400 rules inserted. The rule base contains 801 rules. 2245 rules in the queue.
12600 rules inserted. The rule base contains 828 rules. 2218 rules in the queue.
12800 rules inserted. The rule base contains 884 rules. 2162 rules in the queue.
13000 rules inserted. The rule base contains 907 rules. 2139 rules in the queue.
13200 rules inserted. The rule base contains 963 rules. 2083 rules in the queue.
13400 rules inserted. The rule base contains 986 rules. 2060 rules in the queue.
13600 rules inserted. The rule base contains 1004 rules. 2042 rules in the queue.
13800 rules inserted. The rule base contains 1065 rules. 1981 rules in the queue.
14000 rules inserted. The rule base contains 1126 rules. 1920 rules in the queue.
14200 rules inserted. The rule base contains 1270 rules. 1776 rules in the queue.
14400 rules inserted. The rule base contains 1356 rules. 1690 rules in the queue.
14600 rules inserted. The rule base contains 1466 rules. 1580 rules in the queue.
14800 rules inserted. The rule base contains 1595 rules. 1451 rules in the queue.
15000 rules inserted. The rule base contains 1714 rules. 1332 rules in the queue.
15200 rules inserted. The rule base contains 1825 rules. 1221 rules in the queue.
15400 rules inserted. The rule base contains 1956 rules. 1090 rules in the queue.
15600 rules inserted. The rule base contains 2056 rules. 990 rules in the queue.
15800 rules inserted. The rule base contains 2186 rules. 860 rules in the queue.
16000 rules inserted. The rule base contains 2354 rules. 692 rules in the queue.
16200 rules inserted. The rule base contains 2526 rules. 520 rules in the queue.
16400 rules inserted. The rule base contains 2698 rules. 348 rules in the queue.
16600 rules inserted. The rule base contains 2870 rules. 176 rules in the queue.
Starting query event(endSrv(X_449167,Y_449168,N_449169)) ==> event(beginCli(X_449167,Y_449168,N_449169))
goal reachable: Sess_661346 <> C[] && Sess_661346 <> B[] && Sess_661346 <> A[] && begin(beginCli(C[],Sess_661346,Nc_1769[UP_1768 = UP_661347,SP_1767 = SP_661348,Sess = Sess_661346,Disco = B[],Cli = C[],!1 = @sid_661349])) && attacker(SP_661348) && attacker(UP_661347) && attacker(Sess_661346) -> end(endSrv(C[],A[],Nc_1769[UP_1768 = UP_661347,SP_1767 = SP_661348,Sess = Sess_661346,Disco = B[],Cli = C[],!1 = @sid_661349]))
Abbreviations:
Nc_661904 = Nc_1769[UP_1768 = UP_661884,SP_1767 = SP_661885,Sess = Sess_661883,Disco = B[],Cli = C[],!1 = @sid_661886]

1. The attacker initially knows A[].
attacker(A[]).

2. The attacker initially knows C[].
attacker(C[]).

3. By 2, the attacker may know C[].
By 1, the attacker may know A[].
By 1, the attacker may know A[].
Using the function 3-tuple the attacker may obtain (C[],A[],A[]).
attacker((C[],A[],A[])).

4. We assume as hypothesis that
attacker(Sess_661883).

5. The attacker initially knows B[].
attacker(B[]).

6. By 2, the attacker may know C[].
By 5, the attacker may know B[].
By 4, the attacker may know Sess_661883.
Using the function 3-tuple the attacker may obtain (C[],B[],Sess_661883).
attacker((C[],B[],Sess_661883)).

7. We assume as hypothesis that
attacker(UP_661884).

8. We assume as hypothesis that
attacker(SP_661885).

9. Using the function Sign the attacker may obtain Sign.
attacker(Sign).

10. By 4, the attacker may know Sess_661883.
Using the function sk the attacker may obtain sk(Sess_661883).
attacker(sk(Sess_661883)).

11. By 10, the attacker may know sk(Sess_661883).
Using the function pub the attacker may obtain pub(sk(Sess_661883)).
attacker(pub(sk(Sess_661883))).

12. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

13. By 12, the attacker may know GetEndpointResponse.
By 11, the attacker may know pub(sk(Sess_661883)).
By 9, the attacker may know Sign.
By 8, the attacker may know SP_661885.
By 7, the attacker may know UP_661884.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(sk(Sess_661883)),Sign,SP_661885,UP_661884).
attacker((GetEndpointResponse,pub(sk(Sess_661883)),Sign,SP_661885,UP_661884)).

14. The message (C[],B[],Sess_661883) that the attacker may have by 6 may be received at input {8}.
The message (GetEndpointResponse,pub(sk(Sess_661883)),Sign,SP_661885,UP_661884) that the attacker may have by 13 may be received at input {1554}.
The event beginCli(C[],Sess_661883,Nc_661904) may be executed at {1557}.
We have Sess_661883 <> C[] & Sess_661883 <> B[] & Sess_661883 <> A[].
So the message (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_661904),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[])) may be sent to the attacker at output {1558}.
attacker((pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_661904),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[]))).

15. By 14, the attacker may know (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_661904),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[])).
Using the function 3-proj-3-tuple the attacker may obtain sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[]).
attacker(sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[])).

16. By 14, the attacker may know (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_661904),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[])).
Using the function 2-proj-3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),Nc_661904).
attacker((OpenSecureChannelRequest,pub(skC[]),Nc_661904)).

17. By 16, the attacker may know (OpenSecureChannelRequest,pub(skC[]),Nc_661904).
Using the function 3-proj-3-tuple the attacker may obtain Nc_661904.
attacker(Nc_661904).

18. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

19. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

20. By 19, the attacker may know OpenSecureChannelRequest.
By 18, the attacker may know pub(skC[]).
By 17, the attacker may know Nc_661904.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skC[]),Nc_661904).
attacker((OpenSecureChannelRequest,pub(skC[]),Nc_661904)).

21. By 18, the attacker may know pub(skC[]).
By 20, the attacker may know (OpenSecureChannelRequest,pub(skC[]),Nc_661904).
By 15, the attacker may know sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[]).
Using the function 3-tuple the attacker may obtain (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_661904),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[])).
attacker((pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_661904),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[]))).

22. The message (C[],A[],A[]) that the attacker may have by 3 may be received at input {5998}.
The message (pub(skC[]),(OpenSecureChannelRequest,pub(skC[]),Nc_661904),sign(h((OpenSecureChannelRequest,pub(skC[]),Nc_661904)),skC[])) that the attacker may have by 21 may be received at input {6209}.
So event endSrv(C[],A[],Nc_661904) may be executed at {6220}.
end(endSrv(C[],A[],Nc_661904)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,a_661907)) at {8} in copy a_661908

out(c, GetEndpointRequest) at {1553} in copy a_661908

in(c, (GetEndpointResponse,pub(sk(a_661907)),Sign,a_661906,a_661905)) at {1554} in copy a_661908

new Nc_1769 creating Nc_661910 at {1555} in copy a_661908

event(beginCli(C,a_661907,Nc_661910)) at {1557} in copy a_661908

out(c, (pub(skC),(OpenSecureChannelRequest,pub(skC),Nc_661910),sign(h((OpenSecureChannelRequest,pub(skC),Nc_661910)),skC))) at {1558} in copy a_661908

in(c, (C,A,A)) at {5998} in copy a_661909

in(c, (pub(skC),(OpenSecureChannelRequest,pub(skC),Nc_661910),sign(h((OpenSecureChannelRequest,pub(skC),Nc_661910)),skC))) at {6209} in copy a_661909

new Ns_5163 creating Ns_698654 at {6213} in copy a_661909

new ST_5164 creating ST_698655 at {6214} in copy a_661909

new TTL_5165 creating TTL_698656 at {6215} in copy a_661909

event(beginSrv(A,C,Ns_698654)) at {6217} in copy a_661909

out(c, ((OpenSecureChannelResponse,Ns_698654,ST_698655,TTL_698656),sign(h((OpenSecureChannelResponse,Ns_698654,ST_698655,TTL_698656)),skA))) at {6218} in copy a_661909

event(endSrv(C,A,Nc_661910)) at {6220} in copy a_661909

The event endSrv(C,A,Nc_661910) is executed.
A trace has been found.
RESULT event(endSrv(X_449167,Y_449168,N_449169)) ==> event(beginCli(X_449167,Y_449168,N_449169)) is false.
