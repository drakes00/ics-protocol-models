Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
{7}new skI: bitstring;
{8}out(c, skI);
(
    {9}!
    {10}in(c, (Cli: host,Disco: host,Sess: host));
    {11}let v_594: bool = (Cli = A) in
    (
        {12}if v_594 then
        (
            {13}let skCli: bitstring = skA in
            {14}let pkCli: bitstring = pub(skCli) in
            {15}let v_595: bool = (Disco = A) in
            (
                {16}if v_595 then
                (
                    {17}let pkDisco: bitstring = pub(skA) in
                    {18}let v_596: bool = (Sess = A) in
                    (
                        {19}if v_596 then
                        (
                            {20}let pkSess: bitstring = pub(skA) in
                            {21}out(c, GetEndpointRequest);
                            {22}in(c, (SPs: bitstring,=None,UP: bitstring,=pkSess));
                            {23}new SPc: bitstring;
                            {24}new Nc: bitstring;
                            {25}let m1: bitstring = (SPc,exp(g,Nc)) in
                            {26}out(c, (pkCli,m1));
                            {27}in(c, PartS: bitstring);
                            {28}let Kcli: bitstring = exp(PartS,Nc) in
                            {29}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {30}let v_597: bool = (Sess = B) in
                            (
                                {31}if v_597 then
                                (
                                    {32}let pkSess_598: bitstring = pub(skB) in
                                    {33}out(c, GetEndpointRequest);
                                    {34}in(c, (SPs_599: bitstring,=None,UP_600: bitstring,=pkSess_598));
                                    {35}new SPc_601: bitstring;
                                    {36}new Nc_602: bitstring;
                                    {37}let m1_603: bitstring = (SPc_601,exp(g,Nc_602)) in
                                    {38}out(c, (pkCli,m1_603));
                                    {39}in(c, PartS_604: bitstring);
                                    {40}let Kcli_605: bitstring = exp(PartS_604,Nc_602) in
                                    {41}out(c, senc(mCli(pkCli,pkSess_598),Kcli_605))
                                )
                                else
                                    {42}let v_606: bool = (Sess = C) in
                                    (
                                        {43}if v_606 then
                                        (
                                            {44}let pkSess_607: bitstring = pub(skC) in
                                            {45}out(c, GetEndpointRequest);
                                            {46}in(c, (SPs_608: bitstring,=None,UP_609: bitstring,=pkSess_607));
                                            {47}new SPc_610: bitstring;
                                            {48}new Nc_611: bitstring;
                                            {49}let m1_612: bitstring = (SPc_610,exp(g,Nc_611)) in
                                            {50}out(c, (pkCli,m1_612));
                                            {51}in(c, PartS_613: bitstring);
                                            {52}let Kcli_614: bitstring = exp(PartS_613,Nc_611) in
                                            {53}out(c, senc(mCli(pkCli,pkSess_607),Kcli_614))
                                        )
                                        else
                                            {54}let pkSess_615: bitstring = pub(skI) in
                                            {55}out(c, GetEndpointRequest);
                                            {56}in(c, (SPs_616: bitstring,=None,UP_617: bitstring,=pkSess_615));
                                            {57}new SPc_618: bitstring;
                                            {58}new Nc_619: bitstring;
                                            {59}let m1_620: bitstring = (SPc_618,exp(g,Nc_619)) in
                                            {60}out(c, (pkCli,m1_620));
                                            {61}in(c, PartS_621: bitstring);
                                            {62}let Kcli_622: bitstring = exp(PartS_621,Nc_619) in
                                            {63}out(c, senc(mCli(pkCli,pkSess_615),Kcli_622))
                                    )
                                    else
                                        {64}let pkSess_623: bitstring = fail-any in
                                        {65}out(c, GetEndpointRequest);
                                        {66}in(c, (SPs_624: bitstring,=None,UP_625: bitstring,=pkSess_623));
                                        {67}new SPc_626: bitstring;
                                        {68}new Nc_627: bitstring;
                                        {69}let m1_628: bitstring = (SPc_626,exp(g,Nc_627)) in
                                        {70}out(c, (pkCli,m1_628));
                                        {71}in(c, PartS_629: bitstring);
                                        {72}let Kcli_630: bitstring = exp(PartS_629,Nc_627) in
                                        {73}out(c, senc(mCli(pkCli,pkSess_623),Kcli_630))
                            )
                            else
                                {74}let pkSess_631: bitstring = fail-any in
                                {75}out(c, GetEndpointRequest);
                                {76}in(c, (SPs_632: bitstring,=None,UP_633: bitstring,=pkSess_631));
                                {77}new SPc_634: bitstring;
                                {78}new Nc_635: bitstring;
                                {79}let m1_636: bitstring = (SPc_634,exp(g,Nc_635)) in
                                {80}out(c, (pkCli,m1_636));
                                {81}in(c, PartS_637: bitstring);
                                {82}let Kcli_638: bitstring = exp(PartS_637,Nc_635) in
                                {83}out(c, senc(mCli(pkCli,pkSess_631),Kcli_638))
                    )
                    else
                        {84}let pkSess_639: bitstring = fail-any in
                        {85}out(c, GetEndpointRequest);
                        {86}in(c, (SPs_640: bitstring,=None,UP_641: bitstring,=pkSess_639));
                        {87}new SPc_642: bitstring;
                        {88}new Nc_643: bitstring;
                        {89}let m1_644: bitstring = (SPc_642,exp(g,Nc_643)) in
                        {90}out(c, (pkCli,m1_644));
                        {91}in(c, PartS_645: bitstring);
                        {92}let Kcli_646: bitstring = exp(PartS_645,Nc_643) in
                        {93}out(c, senc(mCli(pkCli,pkSess_639),Kcli_646))
                )
                else
                    {94}let v_647: bool = (Disco = B) in
                    (
                        {95}if v_647 then
                        (
                            {96}let pkDisco_648: bitstring = pub(skB) in
                            {97}let v_649: bool = (Sess = A) in
                            (
                                {98}if v_649 then
                                (
                                    {99}let pkSess_650: bitstring = pub(skA) in
                                    {100}out(c, GetEndpointRequest);
                                    {101}in(c, (SPs_651: bitstring,=None,UP_652: bitstring,=pkSess_650));
                                    {102}new SPc_653: bitstring;
                                    {103}new Nc_654: bitstring;
                                    {104}let m1_655: bitstring = (SPc_653,exp(g,Nc_654)) in
                                    {105}out(c, (pkCli,m1_655));
                                    {106}in(c, PartS_656: bitstring);
                                    {107}let Kcli_657: bitstring = exp(PartS_656,Nc_654) in
                                    {108}out(c, senc(mCli(pkCli,pkSess_650),Kcli_657))
                                )
                                else
                                    {109}let v_658: bool = (Sess = B) in
                                    (
                                        {110}if v_658 then
                                        (
                                            {111}let pkSess_659: bitstring = pub(skB) in
                                            {112}out(c, GetEndpointRequest);
                                            {113}in(c, (SPs_660: bitstring,=None,UP_661: bitstring,=pkSess_659));
                                            {114}new SPc_662: bitstring;
                                            {115}new Nc_663: bitstring;
                                            {116}let m1_664: bitstring = (SPc_662,exp(g,Nc_663)) in
                                            {117}out(c, (pkCli,m1_664));
                                            {118}in(c, PartS_665: bitstring);
                                            {119}let Kcli_666: bitstring = exp(PartS_665,Nc_663) in
                                            {120}out(c, senc(mCli(pkCli,pkSess_659),Kcli_666))
                                        )
                                        else
                                            {121}let v_667: bool = (Sess = C) in
                                            (
                                                {122}if v_667 then
                                                (
                                                    {123}let pkSess_668: bitstring = pub(skC) in
                                                    {124}out(c, GetEndpointRequest);
                                                    {125}in(c, (SPs_669: bitstring,=None,UP_670: bitstring,=pkSess_668));
                                                    {126}new SPc_671: bitstring;
                                                    {127}new Nc_672: bitstring;
                                                    {128}let m1_673: bitstring = (SPc_671,exp(g,Nc_672)) in
                                                    {129}out(c, (pkCli,m1_673));
                                                    {130}in(c, PartS_674: bitstring);
                                                    {131}let Kcli_675: bitstring = exp(PartS_674,Nc_672) in
                                                    {132}out(c, senc(mCli(pkCli,pkSess_668),Kcli_675))
                                                )
                                                else
                                                    {133}let pkSess_676: bitstring = pub(skI) in
                                                    {134}out(c, GetEndpointRequest);
                                                    {135}in(c, (SPs_677: bitstring,=None,UP_678: bitstring,=pkSess_676));
                                                    {136}new SPc_679: bitstring;
                                                    {137}new Nc_680: bitstring;
                                                    {138}let m1_681: bitstring = (SPc_679,exp(g,Nc_680)) in
                                                    {139}out(c, (pkCli,m1_681));
                                                    {140}in(c, PartS_682: bitstring);
                                                    {141}let Kcli_683: bitstring = exp(PartS_682,Nc_680) in
                                                    {142}out(c, senc(mCli(pkCli,pkSess_676),Kcli_683))
                                            )
                                            else
                                                {143}let pkSess_684: bitstring = fail-any in
                                                {144}out(c, GetEndpointRequest);
                                                {145}in(c, (SPs_685: bitstring,=None,UP_686: bitstring,=pkSess_684));
                                                {146}new SPc_687: bitstring;
                                                {147}new Nc_688: bitstring;
                                                {148}let m1_689: bitstring = (SPc_687,exp(g,Nc_688)) in
                                                {149}out(c, (pkCli,m1_689));
                                                {150}in(c, PartS_690: bitstring);
                                                {151}let Kcli_691: bitstring = exp(PartS_690,Nc_688) in
                                                {152}out(c, senc(mCli(pkCli,pkSess_684),Kcli_691))
                                    )
                                    else
                                        {153}let pkSess_692: bitstring = fail-any in
                                        {154}out(c, GetEndpointRequest);
                                        {155}in(c, (SPs_693: bitstring,=None,UP_694: bitstring,=pkSess_692));
                                        {156}new SPc_695: bitstring;
                                        {157}new Nc_696: bitstring;
                                        {158}let m1_697: bitstring = (SPc_695,exp(g,Nc_696)) in
                                        {159}out(c, (pkCli,m1_697));
                                        {160}in(c, PartS_698: bitstring);
                                        {161}let Kcli_699: bitstring = exp(PartS_698,Nc_696) in
                                        {162}out(c, senc(mCli(pkCli,pkSess_692),Kcli_699))
                            )
                            else
                                {163}let pkSess_700: bitstring = fail-any in
                                {164}out(c, GetEndpointRequest);
                                {165}in(c, (SPs_701: bitstring,=None,UP_702: bitstring,=pkSess_700));
                                {166}new SPc_703: bitstring;
                                {167}new Nc_704: bitstring;
                                {168}let m1_705: bitstring = (SPc_703,exp(g,Nc_704)) in
                                {169}out(c, (pkCli,m1_705));
                                {170}in(c, PartS_706: bitstring);
                                {171}let Kcli_707: bitstring = exp(PartS_706,Nc_704) in
                                {172}out(c, senc(mCli(pkCli,pkSess_700),Kcli_707))
                        )
                        else
                            {173}let v_708: bool = (Disco = C) in
                            (
                                {174}if v_708 then
                                (
                                    {175}let pkDisco_709: bitstring = pub(skC) in
                                    {176}let v_710: bool = (Sess = A) in
                                    (
                                        {177}if v_710 then
                                        (
                                            {178}let pkSess_711: bitstring = pub(skA) in
                                            {179}out(c, GetEndpointRequest);
                                            {180}in(c, (SPs_712: bitstring,=None,UP_713: bitstring,=pkSess_711));
                                            {181}new SPc_714: bitstring;
                                            {182}new Nc_715: bitstring;
                                            {183}let m1_716: bitstring = (SPc_714,exp(g,Nc_715)) in
                                            {184}out(c, (pkCli,m1_716));
                                            {185}in(c, PartS_717: bitstring);
                                            {186}let Kcli_718: bitstring = exp(PartS_717,Nc_715) in
                                            {187}out(c, senc(mCli(pkCli,pkSess_711),Kcli_718))
                                        )
                                        else
                                            {188}let v_719: bool = (Sess = B) in
                                            (
                                                {189}if v_719 then
                                                (
                                                    {190}let pkSess_720: bitstring = pub(skB) in
                                                    {191}out(c, GetEndpointRequest);
                                                    {192}in(c, (SPs_721: bitstring,=None,UP_722: bitstring,=pkSess_720));
                                                    {193}new SPc_723: bitstring;
                                                    {194}new Nc_724: bitstring;
                                                    {195}let m1_725: bitstring = (SPc_723,exp(g,Nc_724)) in
                                                    {196}out(c, (pkCli,m1_725));
                                                    {197}in(c, PartS_726: bitstring);
                                                    {198}let Kcli_727: bitstring = exp(PartS_726,Nc_724) in
                                                    {199}out(c, senc(mCli(pkCli,pkSess_720),Kcli_727))
                                                )
                                                else
                                                    {200}let v_728: bool = (Sess = C) in
                                                    (
                                                        {201}if v_728 then
                                                        (
                                                            {202}let pkSess_729: bitstring = pub(skC) in
                                                            {203}out(c, GetEndpointRequest);
                                                            {204}in(c, (SPs_730: bitstring,=None,UP_731: bitstring,=pkSess_729));
                                                            {205}new SPc_732: bitstring;
                                                            {206}new Nc_733: bitstring;
                                                            {207}let m1_734: bitstring = (SPc_732,exp(g,Nc_733)) in
                                                            {208}out(c, (pkCli,m1_734));
                                                            {209}in(c, PartS_735: bitstring);
                                                            {210}let Kcli_736: bitstring = exp(PartS_735,Nc_733) in
                                                            {211}out(c, senc(mCli(pkCli,pkSess_729),Kcli_736))
                                                        )
                                                        else
                                                            {212}let pkSess_737: bitstring = pub(skI) in
                                                            {213}out(c, GetEndpointRequest);
                                                            {214}in(c, (SPs_738: bitstring,=None,UP_739: bitstring,=pkSess_737));
                                                            {215}new SPc_740: bitstring;
                                                            {216}new Nc_741: bitstring;
                                                            {217}let m1_742: bitstring = (SPc_740,exp(g,Nc_741)) in
                                                            {218}out(c, (pkCli,m1_742));
                                                            {219}in(c, PartS_743: bitstring);
                                                            {220}let Kcli_744: bitstring = exp(PartS_743,Nc_741) in
                                                            {221}out(c, senc(mCli(pkCli,pkSess_737),Kcli_744))
                                                    )
                                                    else
                                                        {222}let pkSess_745: bitstring = fail-any in
                                                        {223}out(c, GetEndpointRequest);
                                                        {224}in(c, (SPs_746: bitstring,=None,UP_747: bitstring,=pkSess_745));
                                                        {225}new SPc_748: bitstring;
                                                        {226}new Nc_749: bitstring;
                                                        {227}let m1_750: bitstring = (SPc_748,exp(g,Nc_749)) in
                                                        {228}out(c, (pkCli,m1_750));
                                                        {229}in(c, PartS_751: bitstring);
                                                        {230}let Kcli_752: bitstring = exp(PartS_751,Nc_749) in
                                                        {231}out(c, senc(mCli(pkCli,pkSess_745),Kcli_752))
                                            )
                                            else
                                                {232}let pkSess_753: bitstring = fail-any in
                                                {233}out(c, GetEndpointRequest);
                                                {234}in(c, (SPs_754: bitstring,=None,UP_755: bitstring,=pkSess_753));
                                                {235}new SPc_756: bitstring;
                                                {236}new Nc_757: bitstring;
                                                {237}let m1_758: bitstring = (SPc_756,exp(g,Nc_757)) in
                                                {238}out(c, (pkCli,m1_758));
                                                {239}in(c, PartS_759: bitstring);
                                                {240}let Kcli_760: bitstring = exp(PartS_759,Nc_757) in
                                                {241}out(c, senc(mCli(pkCli,pkSess_753),Kcli_760))
                                    )
                                    else
                                        {242}let pkSess_761: bitstring = fail-any in
                                        {243}out(c, GetEndpointRequest);
                                        {244}in(c, (SPs_762: bitstring,=None,UP_763: bitstring,=pkSess_761));
                                        {245}new SPc_764: bitstring;
                                        {246}new Nc_765: bitstring;
                                        {247}let m1_766: bitstring = (SPc_764,exp(g,Nc_765)) in
                                        {248}out(c, (pkCli,m1_766));
                                        {249}in(c, PartS_767: bitstring);
                                        {250}let Kcli_768: bitstring = exp(PartS_767,Nc_765) in
                                        {251}out(c, senc(mCli(pkCli,pkSess_761),Kcli_768))
                                )
                                else
                                    {252}let pkDisco_769: bitstring = pub(skI) in
                                    {253}let v_770: bool = (Sess = A) in
                                    (
                                        {254}if v_770 then
                                        (
                                            {255}let pkSess_771: bitstring = pub(skA) in
                                            {256}out(c, GetEndpointRequest);
                                            {257}in(c, (SPs_772: bitstring,=None,UP_773: bitstring,=pkSess_771));
                                            {258}new SPc_774: bitstring;
                                            {259}new Nc_775: bitstring;
                                            {260}let m1_776: bitstring = (SPc_774,exp(g,Nc_775)) in
                                            {261}out(c, (pkCli,m1_776));
                                            {262}in(c, PartS_777: bitstring);
                                            {263}let Kcli_778: bitstring = exp(PartS_777,Nc_775) in
                                            {264}out(c, senc(mCli(pkCli,pkSess_771),Kcli_778))
                                        )
                                        else
                                            {265}let v_779: bool = (Sess = B) in
                                            (
                                                {266}if v_779 then
                                                (
                                                    {267}let pkSess_780: bitstring = pub(skB) in
                                                    {268}out(c, GetEndpointRequest);
                                                    {269}in(c, (SPs_781: bitstring,=None,UP_782: bitstring,=pkSess_780));
                                                    {270}new SPc_783: bitstring;
                                                    {271}new Nc_784: bitstring;
                                                    {272}let m1_785: bitstring = (SPc_783,exp(g,Nc_784)) in
                                                    {273}out(c, (pkCli,m1_785));
                                                    {274}in(c, PartS_786: bitstring);
                                                    {275}let Kcli_787: bitstring = exp(PartS_786,Nc_784) in
                                                    {276}out(c, senc(mCli(pkCli,pkSess_780),Kcli_787))
                                                )
                                                else
                                                    {277}let v_788: bool = (Sess = C) in
                                                    (
                                                        {278}if v_788 then
                                                        (
                                                            {279}let pkSess_789: bitstring = pub(skC) in
                                                            {280}out(c, GetEndpointRequest);
                                                            {281}in(c, (SPs_790: bitstring,=None,UP_791: bitstring,=pkSess_789));
                                                            {282}new SPc_792: bitstring;
                                                            {283}new Nc_793: bitstring;
                                                            {284}let m1_794: bitstring = (SPc_792,exp(g,Nc_793)) in
                                                            {285}out(c, (pkCli,m1_794));
                                                            {286}in(c, PartS_795: bitstring);
                                                            {287}let Kcli_796: bitstring = exp(PartS_795,Nc_793) in
                                                            {288}out(c, senc(mCli(pkCli,pkSess_789),Kcli_796))
                                                        )
                                                        else
                                                            {289}let pkSess_797: bitstring = pub(skI) in
                                                            {290}out(c, GetEndpointRequest);
                                                            {291}in(c, (SPs_798: bitstring,=None,UP_799: bitstring,=pkSess_797));
                                                            {292}new SPc_800: bitstring;
                                                            {293}new Nc_801: bitstring;
                                                            {294}let m1_802: bitstring = (SPc_800,exp(g,Nc_801)) in
                                                            {295}out(c, (pkCli,m1_802));
                                                            {296}in(c, PartS_803: bitstring);
                                                            {297}let Kcli_804: bitstring = exp(PartS_803,Nc_801) in
                                                            {298}out(c, senc(mCli(pkCli,pkSess_797),Kcli_804))
                                                    )
                                                    else
                                                        {299}let pkSess_805: bitstring = fail-any in
                                                        {300}out(c, GetEndpointRequest);
                                                        {301}in(c, (SPs_806: bitstring,=None,UP_807: bitstring,=pkSess_805));
                                                        {302}new SPc_808: bitstring;
                                                        {303}new Nc_809: bitstring;
                                                        {304}let m1_810: bitstring = (SPc_808,exp(g,Nc_809)) in
                                                        {305}out(c, (pkCli,m1_810));
                                                        {306}in(c, PartS_811: bitstring);
                                                        {307}let Kcli_812: bitstring = exp(PartS_811,Nc_809) in
                                                        {308}out(c, senc(mCli(pkCli,pkSess_805),Kcli_812))
                                            )
                                            else
                                                {309}let pkSess_813: bitstring = fail-any in
                                                {310}out(c, GetEndpointRequest);
                                                {311}in(c, (SPs_814: bitstring,=None,UP_815: bitstring,=pkSess_813));
                                                {312}new SPc_816: bitstring;
                                                {313}new Nc_817: bitstring;
                                                {314}let m1_818: bitstring = (SPc_816,exp(g,Nc_817)) in
                                                {315}out(c, (pkCli,m1_818));
                                                {316}in(c, PartS_819: bitstring);
                                                {317}let Kcli_820: bitstring = exp(PartS_819,Nc_817) in
                                                {318}out(c, senc(mCli(pkCli,pkSess_813),Kcli_820))
                                    )
                                    else
                                        {319}let pkSess_821: bitstring = fail-any in
                                        {320}out(c, GetEndpointRequest);
                                        {321}in(c, (SPs_822: bitstring,=None,UP_823: bitstring,=pkSess_821));
                                        {322}new SPc_824: bitstring;
                                        {323}new Nc_825: bitstring;
                                        {324}let m1_826: bitstring = (SPc_824,exp(g,Nc_825)) in
                                        {325}out(c, (pkCli,m1_826));
                                        {326}in(c, PartS_827: bitstring);
                                        {327}let Kcli_828: bitstring = exp(PartS_827,Nc_825) in
                                        {328}out(c, senc(mCli(pkCli,pkSess_821),Kcli_828))
                            )
                            else
                                {329}let pkDisco_829: bitstring = fail-any in
                                {330}let v_830: bool = (Sess = A) in
                                (
                                    {331}if v_830 then
                                    (
                                        {332}let pkSess_831: bitstring = pub(skA) in
                                        {333}out(c, GetEndpointRequest);
                                        {334}in(c, (SPs_832: bitstring,=None,UP_833: bitstring,=pkSess_831));
                                        {335}new SPc_834: bitstring;
                                        {336}new Nc_835: bitstring;
                                        {337}let m1_836: bitstring = (SPc_834,exp(g,Nc_835)) in
                                        {338}out(c, (pkCli,m1_836));
                                        {339}in(c, PartS_837: bitstring);
                                        {340}let Kcli_838: bitstring = exp(PartS_837,Nc_835) in
                                        {341}out(c, senc(mCli(pkCli,pkSess_831),Kcli_838))
                                    )
                                    else
                                        {342}let v_839: bool = (Sess = B) in
                                        (
                                            {343}if v_839 then
                                            (
                                                {344}let pkSess_840: bitstring = pub(skB) in
                                                {345}out(c, GetEndpointRequest);
                                                {346}in(c, (SPs_841: bitstring,=None,UP_842: bitstring,=pkSess_840));
                                                {347}new SPc_843: bitstring;
                                                {348}new Nc_844: bitstring;
                                                {349}let m1_845: bitstring = (SPc_843,exp(g,Nc_844)) in
                                                {350}out(c, (pkCli,m1_845));
                                                {351}in(c, PartS_846: bitstring);
                                                {352}let Kcli_847: bitstring = exp(PartS_846,Nc_844) in
                                                {353}out(c, senc(mCli(pkCli,pkSess_840),Kcli_847))
                                            )
                                            else
                                                {354}let v_848: bool = (Sess = C) in
                                                (
                                                    {355}if v_848 then
                                                    (
                                                        {356}let pkSess_849: bitstring = pub(skC) in
                                                        {357}out(c, GetEndpointRequest);
                                                        {358}in(c, (SPs_850: bitstring,=None,UP_851: bitstring,=pkSess_849));
                                                        {359}new SPc_852: bitstring;
                                                        {360}new Nc_853: bitstring;
                                                        {361}let m1_854: bitstring = (SPc_852,exp(g,Nc_853)) in
                                                        {362}out(c, (pkCli,m1_854));
                                                        {363}in(c, PartS_855: bitstring);
                                                        {364}let Kcli_856: bitstring = exp(PartS_855,Nc_853) in
                                                        {365}out(c, senc(mCli(pkCli,pkSess_849),Kcli_856))
                                                    )
                                                    else
                                                        {366}let pkSess_857: bitstring = pub(skI) in
                                                        {367}out(c, GetEndpointRequest);
                                                        {368}in(c, (SPs_858: bitstring,=None,UP_859: bitstring,=pkSess_857));
                                                        {369}new SPc_860: bitstring;
                                                        {370}new Nc_861: bitstring;
                                                        {371}let m1_862: bitstring = (SPc_860,exp(g,Nc_861)) in
                                                        {372}out(c, (pkCli,m1_862));
                                                        {373}in(c, PartS_863: bitstring);
                                                        {374}let Kcli_864: bitstring = exp(PartS_863,Nc_861) in
                                                        {375}out(c, senc(mCli(pkCli,pkSess_857),Kcli_864))
                                                )
                                                else
                                                    {376}let pkSess_865: bitstring = fail-any in
                                                    {377}out(c, GetEndpointRequest);
                                                    {378}in(c, (SPs_866: bitstring,=None,UP_867: bitstring,=pkSess_865));
                                                    {379}new SPc_868: bitstring;
                                                    {380}new Nc_869: bitstring;
                                                    {381}let m1_870: bitstring = (SPc_868,exp(g,Nc_869)) in
                                                    {382}out(c, (pkCli,m1_870));
                                                    {383}in(c, PartS_871: bitstring);
                                                    {384}let Kcli_872: bitstring = exp(PartS_871,Nc_869) in
                                                    {385}out(c, senc(mCli(pkCli,pkSess_865),Kcli_872))
                                        )
                                        else
                                            {386}let pkSess_873: bitstring = fail-any in
                                            {387}out(c, GetEndpointRequest);
                                            {388}in(c, (SPs_874: bitstring,=None,UP_875: bitstring,=pkSess_873));
                                            {389}new SPc_876: bitstring;
                                            {390}new Nc_877: bitstring;
                                            {391}let m1_878: bitstring = (SPc_876,exp(g,Nc_877)) in
                                            {392}out(c, (pkCli,m1_878));
                                            {393}in(c, PartS_879: bitstring);
                                            {394}let Kcli_880: bitstring = exp(PartS_879,Nc_877) in
                                            {395}out(c, senc(mCli(pkCli,pkSess_873),Kcli_880))
                                )
                                else
                                    {396}let pkSess_881: bitstring = fail-any in
                                    {397}out(c, GetEndpointRequest);
                                    {398}in(c, (SPs_882: bitstring,=None,UP_883: bitstring,=pkSess_881));
                                    {399}new SPc_884: bitstring;
                                    {400}new Nc_885: bitstring;
                                    {401}let m1_886: bitstring = (SPc_884,exp(g,Nc_885)) in
                                    {402}out(c, (pkCli,m1_886));
                                    {403}in(c, PartS_887: bitstring);
                                    {404}let Kcli_888: bitstring = exp(PartS_887,Nc_885) in
                                    {405}out(c, senc(mCli(pkCli,pkSess_881),Kcli_888))
                    )
                    else
                        {406}let pkDisco_889: bitstring = fail-any in
                        {407}let v_890: bool = (Sess = A) in
                        (
                            {408}if v_890 then
                            (
                                {409}let pkSess_891: bitstring = pub(skA) in
                                {410}out(c, GetEndpointRequest);
                                {411}in(c, (SPs_892: bitstring,=None,UP_893: bitstring,=pkSess_891));
                                {412}new SPc_894: bitstring;
                                {413}new Nc_895: bitstring;
                                {414}let m1_896: bitstring = (SPc_894,exp(g,Nc_895)) in
                                {415}out(c, (pkCli,m1_896));
                                {416}in(c, PartS_897: bitstring);
                                {417}let Kcli_898: bitstring = exp(PartS_897,Nc_895) in
                                {418}out(c, senc(mCli(pkCli,pkSess_891),Kcli_898))
                            )
                            else
                                {419}let v_899: bool = (Sess = B) in
                                (
                                    {420}if v_899 then
                                    (
                                        {421}let pkSess_900: bitstring = pub(skB) in
                                        {422}out(c, GetEndpointRequest);
                                        {423}in(c, (SPs_901: bitstring,=None,UP_902: bitstring,=pkSess_900));
                                        {424}new SPc_903: bitstring;
                                        {425}new Nc_904: bitstring;
                                        {426}let m1_905: bitstring = (SPc_903,exp(g,Nc_904)) in
                                        {427}out(c, (pkCli,m1_905));
                                        {428}in(c, PartS_906: bitstring);
                                        {429}let Kcli_907: bitstring = exp(PartS_906,Nc_904) in
                                        {430}out(c, senc(mCli(pkCli,pkSess_900),Kcli_907))
                                    )
                                    else
                                        {431}let v_908: bool = (Sess = C) in
                                        (
                                            {432}if v_908 then
                                            (
                                                {433}let pkSess_909: bitstring = pub(skC) in
                                                {434}out(c, GetEndpointRequest);
                                                {435}in(c, (SPs_910: bitstring,=None,UP_911: bitstring,=pkSess_909));
                                                {436}new SPc_912: bitstring;
                                                {437}new Nc_913: bitstring;
                                                {438}let m1_914: bitstring = (SPc_912,exp(g,Nc_913)) in
                                                {439}out(c, (pkCli,m1_914));
                                                {440}in(c, PartS_915: bitstring);
                                                {441}let Kcli_916: bitstring = exp(PartS_915,Nc_913) in
                                                {442}out(c, senc(mCli(pkCli,pkSess_909),Kcli_916))
                                            )
                                            else
                                                {443}let pkSess_917: bitstring = pub(skI) in
                                                {444}out(c, GetEndpointRequest);
                                                {445}in(c, (SPs_918: bitstring,=None,UP_919: bitstring,=pkSess_917));
                                                {446}new SPc_920: bitstring;
                                                {447}new Nc_921: bitstring;
                                                {448}let m1_922: bitstring = (SPc_920,exp(g,Nc_921)) in
                                                {449}out(c, (pkCli,m1_922));
                                                {450}in(c, PartS_923: bitstring);
                                                {451}let Kcli_924: bitstring = exp(PartS_923,Nc_921) in
                                                {452}out(c, senc(mCli(pkCli,pkSess_917),Kcli_924))
                                        )
                                        else
                                            {453}let pkSess_925: bitstring = fail-any in
                                            {454}out(c, GetEndpointRequest);
                                            {455}in(c, (SPs_926: bitstring,=None,UP_927: bitstring,=pkSess_925));
                                            {456}new SPc_928: bitstring;
                                            {457}new Nc_929: bitstring;
                                            {458}let m1_930: bitstring = (SPc_928,exp(g,Nc_929)) in
                                            {459}out(c, (pkCli,m1_930));
                                            {460}in(c, PartS_931: bitstring);
                                            {461}let Kcli_932: bitstring = exp(PartS_931,Nc_929) in
                                            {462}out(c, senc(mCli(pkCli,pkSess_925),Kcli_932))
                                )
                                else
                                    {463}let pkSess_933: bitstring = fail-any in
                                    {464}out(c, GetEndpointRequest);
                                    {465}in(c, (SPs_934: bitstring,=None,UP_935: bitstring,=pkSess_933));
                                    {466}new SPc_936: bitstring;
                                    {467}new Nc_937: bitstring;
                                    {468}let m1_938: bitstring = (SPc_936,exp(g,Nc_937)) in
                                    {469}out(c, (pkCli,m1_938));
                                    {470}in(c, PartS_939: bitstring);
                                    {471}let Kcli_940: bitstring = exp(PartS_939,Nc_937) in
                                    {472}out(c, senc(mCli(pkCli,pkSess_933),Kcli_940))
                        )
                        else
                            {473}let pkSess_941: bitstring = fail-any in
                            {474}out(c, GetEndpointRequest);
                            {475}in(c, (SPs_942: bitstring,=None,UP_943: bitstring,=pkSess_941));
                            {476}new SPc_944: bitstring;
                            {477}new Nc_945: bitstring;
                            {478}let m1_946: bitstring = (SPc_944,exp(g,Nc_945)) in
                            {479}out(c, (pkCli,m1_946));
                            {480}in(c, PartS_947: bitstring);
                            {481}let Kcli_948: bitstring = exp(PartS_947,Nc_945) in
                            {482}out(c, senc(mCli(pkCli,pkSess_941),Kcli_948))
            )
            else
                {483}let pkDisco_949: bitstring = fail-any in
                {484}let v_950: bool = (Sess = A) in
                (
                    {485}if v_950 then
                    (
                        {486}let pkSess_951: bitstring = pub(skA) in
                        {487}out(c, GetEndpointRequest);
                        {488}in(c, (SPs_952: bitstring,=None,UP_953: bitstring,=pkSess_951));
                        {489}new SPc_954: bitstring;
                        {490}new Nc_955: bitstring;
                        {491}let m1_956: bitstring = (SPc_954,exp(g,Nc_955)) in
                        {492}out(c, (pkCli,m1_956));
                        {493}in(c, PartS_957: bitstring);
                        {494}let Kcli_958: bitstring = exp(PartS_957,Nc_955) in
                        {495}out(c, senc(mCli(pkCli,pkSess_951),Kcli_958))
                    )
                    else
                        {496}let v_959: bool = (Sess = B) in
                        (
                            {497}if v_959 then
                            (
                                {498}let pkSess_960: bitstring = pub(skB) in
                                {499}out(c, GetEndpointRequest);
                                {500}in(c, (SPs_961: bitstring,=None,UP_962: bitstring,=pkSess_960));
                                {501}new SPc_963: bitstring;
                                {502}new Nc_964: bitstring;
                                {503}let m1_965: bitstring = (SPc_963,exp(g,Nc_964)) in
                                {504}out(c, (pkCli,m1_965));
                                {505}in(c, PartS_966: bitstring);
                                {506}let Kcli_967: bitstring = exp(PartS_966,Nc_964) in
                                {507}out(c, senc(mCli(pkCli,pkSess_960),Kcli_967))
                            )
                            else
                                {508}let v_968: bool = (Sess = C) in
                                (
                                    {509}if v_968 then
                                    (
                                        {510}let pkSess_969: bitstring = pub(skC) in
                                        {511}out(c, GetEndpointRequest);
                                        {512}in(c, (SPs_970: bitstring,=None,UP_971: bitstring,=pkSess_969));
                                        {513}new SPc_972: bitstring;
                                        {514}new Nc_973: bitstring;
                                        {515}let m1_974: bitstring = (SPc_972,exp(g,Nc_973)) in
                                        {516}out(c, (pkCli,m1_974));
                                        {517}in(c, PartS_975: bitstring);
                                        {518}let Kcli_976: bitstring = exp(PartS_975,Nc_973) in
                                        {519}out(c, senc(mCli(pkCli,pkSess_969),Kcli_976))
                                    )
                                    else
                                        {520}let pkSess_977: bitstring = pub(skI) in
                                        {521}out(c, GetEndpointRequest);
                                        {522}in(c, (SPs_978: bitstring,=None,UP_979: bitstring,=pkSess_977));
                                        {523}new SPc_980: bitstring;
                                        {524}new Nc_981: bitstring;
                                        {525}let m1_982: bitstring = (SPc_980,exp(g,Nc_981)) in
                                        {526}out(c, (pkCli,m1_982));
                                        {527}in(c, PartS_983: bitstring);
                                        {528}let Kcli_984: bitstring = exp(PartS_983,Nc_981) in
                                        {529}out(c, senc(mCli(pkCli,pkSess_977),Kcli_984))
                                )
                                else
                                    {530}let pkSess_985: bitstring = fail-any in
                                    {531}out(c, GetEndpointRequest);
                                    {532}in(c, (SPs_986: bitstring,=None,UP_987: bitstring,=pkSess_985));
                                    {533}new SPc_988: bitstring;
                                    {534}new Nc_989: bitstring;
                                    {535}let m1_990: bitstring = (SPc_988,exp(g,Nc_989)) in
                                    {536}out(c, (pkCli,m1_990));
                                    {537}in(c, PartS_991: bitstring);
                                    {538}let Kcli_992: bitstring = exp(PartS_991,Nc_989) in
                                    {539}out(c, senc(mCli(pkCli,pkSess_985),Kcli_992))
                        )
                        else
                            {540}let pkSess_993: bitstring = fail-any in
                            {541}out(c, GetEndpointRequest);
                            {542}in(c, (SPs_994: bitstring,=None,UP_995: bitstring,=pkSess_993));
                            {543}new SPc_996: bitstring;
                            {544}new Nc_997: bitstring;
                            {545}let m1_998: bitstring = (SPc_996,exp(g,Nc_997)) in
                            {546}out(c, (pkCli,m1_998));
                            {547}in(c, PartS_999: bitstring);
                            {548}let Kcli_1000: bitstring = exp(PartS_999,Nc_997) in
                            {549}out(c, senc(mCli(pkCli,pkSess_993),Kcli_1000))
                )
                else
                    {550}let pkSess_1001: bitstring = fail-any in
                    {551}out(c, GetEndpointRequest);
                    {552}in(c, (SPs_1002: bitstring,=None,UP_1003: bitstring,=pkSess_1001));
                    {553}new SPc_1004: bitstring;
                    {554}new Nc_1005: bitstring;
                    {555}let m1_1006: bitstring = (SPc_1004,exp(g,Nc_1005)) in
                    {556}out(c, (pkCli,m1_1006));
                    {557}in(c, PartS_1007: bitstring);
                    {558}let Kcli_1008: bitstring = exp(PartS_1007,Nc_1005) in
                    {559}out(c, senc(mCli(pkCli,pkSess_1001),Kcli_1008))
        )
        else
            {560}let v_1009: bool = (Cli = B) in
            (
                {561}if v_1009 then
                (
                    {562}let skCli_1010: bitstring = skB in
                    {563}let pkCli_1011: bitstring = pub(skCli_1010) in
                    {564}let v_1012: bool = (Disco = A) in
                    (
                        {565}if v_1012 then
                        (
                            {566}let pkDisco_1013: bitstring = pub(skA) in
                            {567}let v_1014: bool = (Sess = A) in
                            (
                                {568}if v_1014 then
                                (
                                    {569}let pkSess_1015: bitstring = pub(skA) in
                                    {570}out(c, GetEndpointRequest);
                                    {571}in(c, (SPs_1016: bitstring,=None,UP_1017: bitstring,=pkSess_1015));
                                    {572}new SPc_1018: bitstring;
                                    {573}new Nc_1019: bitstring;
                                    {574}let m1_1020: bitstring = (SPc_1018,exp(g,Nc_1019)) in
                                    {575}out(c, (pkCli_1011,m1_1020));
                                    {576}in(c, PartS_1021: bitstring);
                                    {577}let Kcli_1022: bitstring = exp(PartS_1021,Nc_1019) in
                                    {578}out(c, senc(mCli(pkCli_1011,pkSess_1015),Kcli_1022))
                                )
                                else
                                    {579}let v_1023: bool = (Sess = B) in
                                    (
                                        {580}if v_1023 then
                                        (
                                            {581}let pkSess_1024: bitstring = pub(skB) in
                                            {582}out(c, GetEndpointRequest);
                                            {583}in(c, (SPs_1025: bitstring,=None,UP_1026: bitstring,=pkSess_1024));
                                            {584}new SPc_1027: bitstring;
                                            {585}new Nc_1028: bitstring;
                                            {586}let m1_1029: bitstring = (SPc_1027,exp(g,Nc_1028)) in
                                            {587}out(c, (pkCli_1011,m1_1029));
                                            {588}in(c, PartS_1030: bitstring);
                                            {589}let Kcli_1031: bitstring = exp(PartS_1030,Nc_1028) in
                                            {590}out(c, senc(mCli(pkCli_1011,pkSess_1024),Kcli_1031))
                                        )
                                        else
                                            {591}let v_1032: bool = (Sess = C) in
                                            (
                                                {592}if v_1032 then
                                                (
                                                    {593}let pkSess_1033: bitstring = pub(skC) in
                                                    {594}out(c, GetEndpointRequest);
                                                    {595}in(c, (SPs_1034: bitstring,=None,UP_1035: bitstring,=pkSess_1033));
                                                    {596}new SPc_1036: bitstring;
                                                    {597}new Nc_1037: bitstring;
                                                    {598}let m1_1038: bitstring = (SPc_1036,exp(g,Nc_1037)) in
                                                    {599}out(c, (pkCli_1011,m1_1038));
                                                    {600}in(c, PartS_1039: bitstring);
                                                    {601}let Kcli_1040: bitstring = exp(PartS_1039,Nc_1037) in
                                                    {602}out(c, senc(mCli(pkCli_1011,pkSess_1033),Kcli_1040))
                                                )
                                                else
                                                    {603}let pkSess_1041: bitstring = pub(skI) in
                                                    {604}out(c, GetEndpointRequest);
                                                    {605}in(c, (SPs_1042: bitstring,=None,UP_1043: bitstring,=pkSess_1041));
                                                    {606}new SPc_1044: bitstring;
                                                    {607}new Nc_1045: bitstring;
                                                    {608}let m1_1046: bitstring = (SPc_1044,exp(g,Nc_1045)) in
                                                    {609}out(c, (pkCli_1011,m1_1046));
                                                    {610}in(c, PartS_1047: bitstring);
                                                    {611}let Kcli_1048: bitstring = exp(PartS_1047,Nc_1045) in
                                                    {612}out(c, senc(mCli(pkCli_1011,pkSess_1041),Kcli_1048))
                                            )
                                            else
                                                {613}let pkSess_1049: bitstring = fail-any in
                                                {614}out(c, GetEndpointRequest);
                                                {615}in(c, (SPs_1050: bitstring,=None,UP_1051: bitstring,=pkSess_1049));
                                                {616}new SPc_1052: bitstring;
                                                {617}new Nc_1053: bitstring;
                                                {618}let m1_1054: bitstring = (SPc_1052,exp(g,Nc_1053)) in
                                                {619}out(c, (pkCli_1011,m1_1054));
                                                {620}in(c, PartS_1055: bitstring);
                                                {621}let Kcli_1056: bitstring = exp(PartS_1055,Nc_1053) in
                                                {622}out(c, senc(mCli(pkCli_1011,pkSess_1049),Kcli_1056))
                                    )
                                    else
                                        {623}let pkSess_1057: bitstring = fail-any in
                                        {624}out(c, GetEndpointRequest);
                                        {625}in(c, (SPs_1058: bitstring,=None,UP_1059: bitstring,=pkSess_1057));
                                        {626}new SPc_1060: bitstring;
                                        {627}new Nc_1061: bitstring;
                                        {628}let m1_1062: bitstring = (SPc_1060,exp(g,Nc_1061)) in
                                        {629}out(c, (pkCli_1011,m1_1062));
                                        {630}in(c, PartS_1063: bitstring);
                                        {631}let Kcli_1064: bitstring = exp(PartS_1063,Nc_1061) in
                                        {632}out(c, senc(mCli(pkCli_1011,pkSess_1057),Kcli_1064))
                            )
                            else
                                {633}let pkSess_1065: bitstring = fail-any in
                                {634}out(c, GetEndpointRequest);
                                {635}in(c, (SPs_1066: bitstring,=None,UP_1067: bitstring,=pkSess_1065));
                                {636}new SPc_1068: bitstring;
                                {637}new Nc_1069: bitstring;
                                {638}let m1_1070: bitstring = (SPc_1068,exp(g,Nc_1069)) in
                                {639}out(c, (pkCli_1011,m1_1070));
                                {640}in(c, PartS_1071: bitstring);
                                {641}let Kcli_1072: bitstring = exp(PartS_1071,Nc_1069) in
                                {642}out(c, senc(mCli(pkCli_1011,pkSess_1065),Kcli_1072))
                        )
                        else
                            {643}let v_1073: bool = (Disco = B) in
                            (
                                {644}if v_1073 then
                                (
                                    {645}let pkDisco_1074: bitstring = pub(skB) in
                                    {646}let v_1075: bool = (Sess = A) in
                                    (
                                        {647}if v_1075 then
                                        (
                                            {648}let pkSess_1076: bitstring = pub(skA) in
                                            {649}out(c, GetEndpointRequest);
                                            {650}in(c, (SPs_1077: bitstring,=None,UP_1078: bitstring,=pkSess_1076));
                                            {651}new SPc_1079: bitstring;
                                            {652}new Nc_1080: bitstring;
                                            {653}let m1_1081: bitstring = (SPc_1079,exp(g,Nc_1080)) in
                                            {654}out(c, (pkCli_1011,m1_1081));
                                            {655}in(c, PartS_1082: bitstring);
                                            {656}let Kcli_1083: bitstring = exp(PartS_1082,Nc_1080) in
                                            {657}out(c, senc(mCli(pkCli_1011,pkSess_1076),Kcli_1083))
                                        )
                                        else
                                            {658}let v_1084: bool = (Sess = B) in
                                            (
                                                {659}if v_1084 then
                                                (
                                                    {660}let pkSess_1085: bitstring = pub(skB) in
                                                    {661}out(c, GetEndpointRequest);
                                                    {662}in(c, (SPs_1086: bitstring,=None,UP_1087: bitstring,=pkSess_1085));
                                                    {663}new SPc_1088: bitstring;
                                                    {664}new Nc_1089: bitstring;
                                                    {665}let m1_1090: bitstring = (SPc_1088,exp(g,Nc_1089)) in
                                                    {666}out(c, (pkCli_1011,m1_1090));
                                                    {667}in(c, PartS_1091: bitstring);
                                                    {668}let Kcli_1092: bitstring = exp(PartS_1091,Nc_1089) in
                                                    {669}out(c, senc(mCli(pkCli_1011,pkSess_1085),Kcli_1092))
                                                )
                                                else
                                                    {670}let v_1093: bool = (Sess = C) in
                                                    (
                                                        {671}if v_1093 then
                                                        (
                                                            {672}let pkSess_1094: bitstring = pub(skC) in
                                                            {673}out(c, GetEndpointRequest);
                                                            {674}in(c, (SPs_1095: bitstring,=None,UP_1096: bitstring,=pkSess_1094));
                                                            {675}new SPc_1097: bitstring;
                                                            {676}new Nc_1098: bitstring;
                                                            {677}let m1_1099: bitstring = (SPc_1097,exp(g,Nc_1098)) in
                                                            {678}out(c, (pkCli_1011,m1_1099));
                                                            {679}in(c, PartS_1100: bitstring);
                                                            {680}let Kcli_1101: bitstring = exp(PartS_1100,Nc_1098) in
                                                            {681}out(c, senc(mCli(pkCli_1011,pkSess_1094),Kcli_1101))
                                                        )
                                                        else
                                                            {682}let pkSess_1102: bitstring = pub(skI) in
                                                            {683}out(c, GetEndpointRequest);
                                                            {684}in(c, (SPs_1103: bitstring,=None,UP_1104: bitstring,=pkSess_1102));
                                                            {685}new SPc_1105: bitstring;
                                                            {686}new Nc_1106: bitstring;
                                                            {687}let m1_1107: bitstring = (SPc_1105,exp(g,Nc_1106)) in
                                                            {688}out(c, (pkCli_1011,m1_1107));
                                                            {689}in(c, PartS_1108: bitstring);
                                                            {690}let Kcli_1109: bitstring = exp(PartS_1108,Nc_1106) in
                                                            {691}out(c, senc(mCli(pkCli_1011,pkSess_1102),Kcli_1109))
                                                    )
                                                    else
                                                        {692}let pkSess_1110: bitstring = fail-any in
                                                        {693}out(c, GetEndpointRequest);
                                                        {694}in(c, (SPs_1111: bitstring,=None,UP_1112: bitstring,=pkSess_1110));
                                                        {695}new SPc_1113: bitstring;
                                                        {696}new Nc_1114: bitstring;
                                                        {697}let m1_1115: bitstring = (SPc_1113,exp(g,Nc_1114)) in
                                                        {698}out(c, (pkCli_1011,m1_1115));
                                                        {699}in(c, PartS_1116: bitstring);
                                                        {700}let Kcli_1117: bitstring = exp(PartS_1116,Nc_1114) in
                                                        {701}out(c, senc(mCli(pkCli_1011,pkSess_1110),Kcli_1117))
                                            )
                                            else
                                                {702}let pkSess_1118: bitstring = fail-any in
                                                {703}out(c, GetEndpointRequest);
                                                {704}in(c, (SPs_1119: bitstring,=None,UP_1120: bitstring,=pkSess_1118));
                                                {705}new SPc_1121: bitstring;
                                                {706}new Nc_1122: bitstring;
                                                {707}let m1_1123: bitstring = (SPc_1121,exp(g,Nc_1122)) in
                                                {708}out(c, (pkCli_1011,m1_1123));
                                                {709}in(c, PartS_1124: bitstring);
                                                {710}let Kcli_1125: bitstring = exp(PartS_1124,Nc_1122) in
                                                {711}out(c, senc(mCli(pkCli_1011,pkSess_1118),Kcli_1125))
                                    )
                                    else
                                        {712}let pkSess_1126: bitstring = fail-any in
                                        {713}out(c, GetEndpointRequest);
                                        {714}in(c, (SPs_1127: bitstring,=None,UP_1128: bitstring,=pkSess_1126));
                                        {715}new SPc_1129: bitstring;
                                        {716}new Nc_1130: bitstring;
                                        {717}let m1_1131: bitstring = (SPc_1129,exp(g,Nc_1130)) in
                                        {718}out(c, (pkCli_1011,m1_1131));
                                        {719}in(c, PartS_1132: bitstring);
                                        {720}let Kcli_1133: bitstring = exp(PartS_1132,Nc_1130) in
                                        {721}out(c, senc(mCli(pkCli_1011,pkSess_1126),Kcli_1133))
                                )
                                else
                                    {722}let v_1134: bool = (Disco = C) in
                                    (
                                        {723}if v_1134 then
                                        (
                                            {724}let pkDisco_1135: bitstring = pub(skC) in
                                            {725}let v_1136: bool = (Sess = A) in
                                            (
                                                {726}if v_1136 then
                                                (
                                                    {727}let pkSess_1137: bitstring = pub(skA) in
                                                    {728}out(c, GetEndpointRequest);
                                                    {729}in(c, (SPs_1138: bitstring,=None,UP_1139: bitstring,=pkSess_1137));
                                                    {730}new SPc_1140: bitstring;
                                                    {731}new Nc_1141: bitstring;
                                                    {732}let m1_1142: bitstring = (SPc_1140,exp(g,Nc_1141)) in
                                                    {733}out(c, (pkCli_1011,m1_1142));
                                                    {734}in(c, PartS_1143: bitstring);
                                                    {735}let Kcli_1144: bitstring = exp(PartS_1143,Nc_1141) in
                                                    {736}out(c, senc(mCli(pkCli_1011,pkSess_1137),Kcli_1144))
                                                )
                                                else
                                                    {737}let v_1145: bool = (Sess = B) in
                                                    (
                                                        {738}if v_1145 then
                                                        (
                                                            {739}let pkSess_1146: bitstring = pub(skB) in
                                                            {740}out(c, GetEndpointRequest);
                                                            {741}in(c, (SPs_1147: bitstring,=None,UP_1148: bitstring,=pkSess_1146));
                                                            {742}new SPc_1149: bitstring;
                                                            {743}new Nc_1150: bitstring;
                                                            {744}let m1_1151: bitstring = (SPc_1149,exp(g,Nc_1150)) in
                                                            {745}out(c, (pkCli_1011,m1_1151));
                                                            {746}in(c, PartS_1152: bitstring);
                                                            {747}let Kcli_1153: bitstring = exp(PartS_1152,Nc_1150) in
                                                            {748}out(c, senc(mCli(pkCli_1011,pkSess_1146),Kcli_1153))
                                                        )
                                                        else
                                                            {749}let v_1154: bool = (Sess = C) in
                                                            (
                                                                {750}if v_1154 then
                                                                (
                                                                    {751}let pkSess_1155: bitstring = pub(skC) in
                                                                    {752}out(c, GetEndpointRequest);
                                                                    {753}in(c, (SPs_1156: bitstring,=None,UP_1157: bitstring,=pkSess_1155));
                                                                    {754}new SPc_1158: bitstring;
                                                                    {755}new Nc_1159: bitstring;
                                                                    {756}let m1_1160: bitstring = (SPc_1158,exp(g,Nc_1159)) in
                                                                    {757}out(c, (pkCli_1011,m1_1160));
                                                                    {758}in(c, PartS_1161: bitstring);
                                                                    {759}let Kcli_1162: bitstring = exp(PartS_1161,Nc_1159) in
                                                                    {760}out(c, senc(mCli(pkCli_1011,pkSess_1155),Kcli_1162))
                                                                )
                                                                else
                                                                    {761}let pkSess_1163: bitstring = pub(skI) in
                                                                    {762}out(c, GetEndpointRequest);
                                                                    {763}in(c, (SPs_1164: bitstring,=None,UP_1165: bitstring,=pkSess_1163));
                                                                    {764}new SPc_1166: bitstring;
                                                                    {765}new Nc_1167: bitstring;
                                                                    {766}let m1_1168: bitstring = (SPc_1166,exp(g,Nc_1167)) in
                                                                    {767}out(c, (pkCli_1011,m1_1168));
                                                                    {768}in(c, PartS_1169: bitstring);
                                                                    {769}let Kcli_1170: bitstring = exp(PartS_1169,Nc_1167) in
                                                                    {770}out(c, senc(mCli(pkCli_1011,pkSess_1163),Kcli_1170))
                                                            )
                                                            else
                                                                {771}let pkSess_1171: bitstring = fail-any in
                                                                {772}out(c, GetEndpointRequest);
                                                                {773}in(c, (SPs_1172: bitstring,=None,UP_1173: bitstring,=pkSess_1171));
                                                                {774}new SPc_1174: bitstring;
                                                                {775}new Nc_1175: bitstring;
                                                                {776}let m1_1176: bitstring = (SPc_1174,exp(g,Nc_1175)) in
                                                                {777}out(c, (pkCli_1011,m1_1176));
                                                                {778}in(c, PartS_1177: bitstring);
                                                                {779}let Kcli_1178: bitstring = exp(PartS_1177,Nc_1175) in
                                                                {780}out(c, senc(mCli(pkCli_1011,pkSess_1171),Kcli_1178))
                                                    )
                                                    else
                                                        {781}let pkSess_1179: bitstring = fail-any in
                                                        {782}out(c, GetEndpointRequest);
                                                        {783}in(c, (SPs_1180: bitstring,=None,UP_1181: bitstring,=pkSess_1179));
                                                        {784}new SPc_1182: bitstring;
                                                        {785}new Nc_1183: bitstring;
                                                        {786}let m1_1184: bitstring = (SPc_1182,exp(g,Nc_1183)) in
                                                        {787}out(c, (pkCli_1011,m1_1184));
                                                        {788}in(c, PartS_1185: bitstring);
                                                        {789}let Kcli_1186: bitstring = exp(PartS_1185,Nc_1183) in
                                                        {790}out(c, senc(mCli(pkCli_1011,pkSess_1179),Kcli_1186))
                                            )
                                            else
                                                {791}let pkSess_1187: bitstring = fail-any in
                                                {792}out(c, GetEndpointRequest);
                                                {793}in(c, (SPs_1188: bitstring,=None,UP_1189: bitstring,=pkSess_1187));
                                                {794}new SPc_1190: bitstring;
                                                {795}new Nc_1191: bitstring;
                                                {796}let m1_1192: bitstring = (SPc_1190,exp(g,Nc_1191)) in
                                                {797}out(c, (pkCli_1011,m1_1192));
                                                {798}in(c, PartS_1193: bitstring);
                                                {799}let Kcli_1194: bitstring = exp(PartS_1193,Nc_1191) in
                                                {800}out(c, senc(mCli(pkCli_1011,pkSess_1187),Kcli_1194))
                                        )
                                        else
                                            {801}let pkDisco_1195: bitstring = pub(skI) in
                                            {802}let v_1196: bool = (Sess = A) in
                                            (
                                                {803}if v_1196 then
                                                (
                                                    {804}let pkSess_1197: bitstring = pub(skA) in
                                                    {805}out(c, GetEndpointRequest);
                                                    {806}in(c, (SPs_1198: bitstring,=None,UP_1199: bitstring,=pkSess_1197));
                                                    {807}new SPc_1200: bitstring;
                                                    {808}new Nc_1201: bitstring;
                                                    {809}let m1_1202: bitstring = (SPc_1200,exp(g,Nc_1201)) in
                                                    {810}out(c, (pkCli_1011,m1_1202));
                                                    {811}in(c, PartS_1203: bitstring);
                                                    {812}let Kcli_1204: bitstring = exp(PartS_1203,Nc_1201) in
                                                    {813}out(c, senc(mCli(pkCli_1011,pkSess_1197),Kcli_1204))
                                                )
                                                else
                                                    {814}let v_1205: bool = (Sess = B) in
                                                    (
                                                        {815}if v_1205 then
                                                        (
                                                            {816}let pkSess_1206: bitstring = pub(skB) in
                                                            {817}out(c, GetEndpointRequest);
                                                            {818}in(c, (SPs_1207: bitstring,=None,UP_1208: bitstring,=pkSess_1206));
                                                            {819}new SPc_1209: bitstring;
                                                            {820}new Nc_1210: bitstring;
                                                            {821}let m1_1211: bitstring = (SPc_1209,exp(g,Nc_1210)) in
                                                            {822}out(c, (pkCli_1011,m1_1211));
                                                            {823}in(c, PartS_1212: bitstring);
                                                            {824}let Kcli_1213: bitstring = exp(PartS_1212,Nc_1210) in
                                                            {825}out(c, senc(mCli(pkCli_1011,pkSess_1206),Kcli_1213))
                                                        )
                                                        else
                                                            {826}let v_1214: bool = (Sess = C) in
                                                            (
                                                                {827}if v_1214 then
                                                                (
                                                                    {828}let pkSess_1215: bitstring = pub(skC) in
                                                                    {829}out(c, GetEndpointRequest);
                                                                    {830}in(c, (SPs_1216: bitstring,=None,UP_1217: bitstring,=pkSess_1215));
                                                                    {831}new SPc_1218: bitstring;
                                                                    {832}new Nc_1219: bitstring;
                                                                    {833}let m1_1220: bitstring = (SPc_1218,exp(g,Nc_1219)) in
                                                                    {834}out(c, (pkCli_1011,m1_1220));
                                                                    {835}in(c, PartS_1221: bitstring);
                                                                    {836}let Kcli_1222: bitstring = exp(PartS_1221,Nc_1219) in
                                                                    {837}out(c, senc(mCli(pkCli_1011,pkSess_1215),Kcli_1222))
                                                                )
                                                                else
                                                                    {838}let pkSess_1223: bitstring = pub(skI) in
                                                                    {839}out(c, GetEndpointRequest);
                                                                    {840}in(c, (SPs_1224: bitstring,=None,UP_1225: bitstring,=pkSess_1223));
                                                                    {841}new SPc_1226: bitstring;
                                                                    {842}new Nc_1227: bitstring;
                                                                    {843}let m1_1228: bitstring = (SPc_1226,exp(g,Nc_1227)) in
                                                                    {844}out(c, (pkCli_1011,m1_1228));
                                                                    {845}in(c, PartS_1229: bitstring);
                                                                    {846}let Kcli_1230: bitstring = exp(PartS_1229,Nc_1227) in
                                                                    {847}out(c, senc(mCli(pkCli_1011,pkSess_1223),Kcli_1230))
                                                            )
                                                            else
                                                                {848}let pkSess_1231: bitstring = fail-any in
                                                                {849}out(c, GetEndpointRequest);
                                                                {850}in(c, (SPs_1232: bitstring,=None,UP_1233: bitstring,=pkSess_1231));
                                                                {851}new SPc_1234: bitstring;
                                                                {852}new Nc_1235: bitstring;
                                                                {853}let m1_1236: bitstring = (SPc_1234,exp(g,Nc_1235)) in
                                                                {854}out(c, (pkCli_1011,m1_1236));
                                                                {855}in(c, PartS_1237: bitstring);
                                                                {856}let Kcli_1238: bitstring = exp(PartS_1237,Nc_1235) in
                                                                {857}out(c, senc(mCli(pkCli_1011,pkSess_1231),Kcli_1238))
                                                    )
                                                    else
                                                        {858}let pkSess_1239: bitstring = fail-any in
                                                        {859}out(c, GetEndpointRequest);
                                                        {860}in(c, (SPs_1240: bitstring,=None,UP_1241: bitstring,=pkSess_1239));
                                                        {861}new SPc_1242: bitstring;
                                                        {862}new Nc_1243: bitstring;
                                                        {863}let m1_1244: bitstring = (SPc_1242,exp(g,Nc_1243)) in
                                                        {864}out(c, (pkCli_1011,m1_1244));
                                                        {865}in(c, PartS_1245: bitstring);
                                                        {866}let Kcli_1246: bitstring = exp(PartS_1245,Nc_1243) in
                                                        {867}out(c, senc(mCli(pkCli_1011,pkSess_1239),Kcli_1246))
                                            )
                                            else
                                                {868}let pkSess_1247: bitstring = fail-any in
                                                {869}out(c, GetEndpointRequest);
                                                {870}in(c, (SPs_1248: bitstring,=None,UP_1249: bitstring,=pkSess_1247));
                                                {871}new SPc_1250: bitstring;
                                                {872}new Nc_1251: bitstring;
                                                {873}let m1_1252: bitstring = (SPc_1250,exp(g,Nc_1251)) in
                                                {874}out(c, (pkCli_1011,m1_1252));
                                                {875}in(c, PartS_1253: bitstring);
                                                {876}let Kcli_1254: bitstring = exp(PartS_1253,Nc_1251) in
                                                {877}out(c, senc(mCli(pkCli_1011,pkSess_1247),Kcli_1254))
                                    )
                                    else
                                        {878}let pkDisco_1255: bitstring = fail-any in
                                        {879}let v_1256: bool = (Sess = A) in
                                        (
                                            {880}if v_1256 then
                                            (
                                                {881}let pkSess_1257: bitstring = pub(skA) in
                                                {882}out(c, GetEndpointRequest);
                                                {883}in(c, (SPs_1258: bitstring,=None,UP_1259: bitstring,=pkSess_1257));
                                                {884}new SPc_1260: bitstring;
                                                {885}new Nc_1261: bitstring;
                                                {886}let m1_1262: bitstring = (SPc_1260,exp(g,Nc_1261)) in
                                                {887}out(c, (pkCli_1011,m1_1262));
                                                {888}in(c, PartS_1263: bitstring);
                                                {889}let Kcli_1264: bitstring = exp(PartS_1263,Nc_1261) in
                                                {890}out(c, senc(mCli(pkCli_1011,pkSess_1257),Kcli_1264))
                                            )
                                            else
                                                {891}let v_1265: bool = (Sess = B) in
                                                (
                                                    {892}if v_1265 then
                                                    (
                                                        {893}let pkSess_1266: bitstring = pub(skB) in
                                                        {894}out(c, GetEndpointRequest);
                                                        {895}in(c, (SPs_1267: bitstring,=None,UP_1268: bitstring,=pkSess_1266));
                                                        {896}new SPc_1269: bitstring;
                                                        {897}new Nc_1270: bitstring;
                                                        {898}let m1_1271: bitstring = (SPc_1269,exp(g,Nc_1270)) in
                                                        {899}out(c, (pkCli_1011,m1_1271));
                                                        {900}in(c, PartS_1272: bitstring);
                                                        {901}let Kcli_1273: bitstring = exp(PartS_1272,Nc_1270) in
                                                        {902}out(c, senc(mCli(pkCli_1011,pkSess_1266),Kcli_1273))
                                                    )
                                                    else
                                                        {903}let v_1274: bool = (Sess = C) in
                                                        (
                                                            {904}if v_1274 then
                                                            (
                                                                {905}let pkSess_1275: bitstring = pub(skC) in
                                                                {906}out(c, GetEndpointRequest);
                                                                {907}in(c, (SPs_1276: bitstring,=None,UP_1277: bitstring,=pkSess_1275));
                                                                {908}new SPc_1278: bitstring;
                                                                {909}new Nc_1279: bitstring;
                                                                {910}let m1_1280: bitstring = (SPc_1278,exp(g,Nc_1279)) in
                                                                {911}out(c, (pkCli_1011,m1_1280));
                                                                {912}in(c, PartS_1281: bitstring);
                                                                {913}let Kcli_1282: bitstring = exp(PartS_1281,Nc_1279) in
                                                                {914}out(c, senc(mCli(pkCli_1011,pkSess_1275),Kcli_1282))
                                                            )
                                                            else
                                                                {915}let pkSess_1283: bitstring = pub(skI) in
                                                                {916}out(c, GetEndpointRequest);
                                                                {917}in(c, (SPs_1284: bitstring,=None,UP_1285: bitstring,=pkSess_1283));
                                                                {918}new SPc_1286: bitstring;
                                                                {919}new Nc_1287: bitstring;
                                                                {920}let m1_1288: bitstring = (SPc_1286,exp(g,Nc_1287)) in
                                                                {921}out(c, (pkCli_1011,m1_1288));
                                                                {922}in(c, PartS_1289: bitstring);
                                                                {923}let Kcli_1290: bitstring = exp(PartS_1289,Nc_1287) in
                                                                {924}out(c, senc(mCli(pkCli_1011,pkSess_1283),Kcli_1290))
                                                        )
                                                        else
                                                            {925}let pkSess_1291: bitstring = fail-any in
                                                            {926}out(c, GetEndpointRequest);
                                                            {927}in(c, (SPs_1292: bitstring,=None,UP_1293: bitstring,=pkSess_1291));
                                                            {928}new SPc_1294: bitstring;
                                                            {929}new Nc_1295: bitstring;
                                                            {930}let m1_1296: bitstring = (SPc_1294,exp(g,Nc_1295)) in
                                                            {931}out(c, (pkCli_1011,m1_1296));
                                                            {932}in(c, PartS_1297: bitstring);
                                                            {933}let Kcli_1298: bitstring = exp(PartS_1297,Nc_1295) in
                                                            {934}out(c, senc(mCli(pkCli_1011,pkSess_1291),Kcli_1298))
                                                )
                                                else
                                                    {935}let pkSess_1299: bitstring = fail-any in
                                                    {936}out(c, GetEndpointRequest);
                                                    {937}in(c, (SPs_1300: bitstring,=None,UP_1301: bitstring,=pkSess_1299));
                                                    {938}new SPc_1302: bitstring;
                                                    {939}new Nc_1303: bitstring;
                                                    {940}let m1_1304: bitstring = (SPc_1302,exp(g,Nc_1303)) in
                                                    {941}out(c, (pkCli_1011,m1_1304));
                                                    {942}in(c, PartS_1305: bitstring);
                                                    {943}let Kcli_1306: bitstring = exp(PartS_1305,Nc_1303) in
                                                    {944}out(c, senc(mCli(pkCli_1011,pkSess_1299),Kcli_1306))
                                        )
                                        else
                                            {945}let pkSess_1307: bitstring = fail-any in
                                            {946}out(c, GetEndpointRequest);
                                            {947}in(c, (SPs_1308: bitstring,=None,UP_1309: bitstring,=pkSess_1307));
                                            {948}new SPc_1310: bitstring;
                                            {949}new Nc_1311: bitstring;
                                            {950}let m1_1312: bitstring = (SPc_1310,exp(g,Nc_1311)) in
                                            {951}out(c, (pkCli_1011,m1_1312));
                                            {952}in(c, PartS_1313: bitstring);
                                            {953}let Kcli_1314: bitstring = exp(PartS_1313,Nc_1311) in
                                            {954}out(c, senc(mCli(pkCli_1011,pkSess_1307),Kcli_1314))
                            )
                            else
                                {955}let pkDisco_1315: bitstring = fail-any in
                                {956}let v_1316: bool = (Sess = A) in
                                (
                                    {957}if v_1316 then
                                    (
                                        {958}let pkSess_1317: bitstring = pub(skA) in
                                        {959}out(c, GetEndpointRequest);
                                        {960}in(c, (SPs_1318: bitstring,=None,UP_1319: bitstring,=pkSess_1317));
                                        {961}new SPc_1320: bitstring;
                                        {962}new Nc_1321: bitstring;
                                        {963}let m1_1322: bitstring = (SPc_1320,exp(g,Nc_1321)) in
                                        {964}out(c, (pkCli_1011,m1_1322));
                                        {965}in(c, PartS_1323: bitstring);
                                        {966}let Kcli_1324: bitstring = exp(PartS_1323,Nc_1321) in
                                        {967}out(c, senc(mCli(pkCli_1011,pkSess_1317),Kcli_1324))
                                    )
                                    else
                                        {968}let v_1325: bool = (Sess = B) in
                                        (
                                            {969}if v_1325 then
                                            (
                                                {970}let pkSess_1326: bitstring = pub(skB) in
                                                {971}out(c, GetEndpointRequest);
                                                {972}in(c, (SPs_1327: bitstring,=None,UP_1328: bitstring,=pkSess_1326));
                                                {973}new SPc_1329: bitstring;
                                                {974}new Nc_1330: bitstring;
                                                {975}let m1_1331: bitstring = (SPc_1329,exp(g,Nc_1330)) in
                                                {976}out(c, (pkCli_1011,m1_1331));
                                                {977}in(c, PartS_1332: bitstring);
                                                {978}let Kcli_1333: bitstring = exp(PartS_1332,Nc_1330) in
                                                {979}out(c, senc(mCli(pkCli_1011,pkSess_1326),Kcli_1333))
                                            )
                                            else
                                                {980}let v_1334: bool = (Sess = C) in
                                                (
                                                    {981}if v_1334 then
                                                    (
                                                        {982}let pkSess_1335: bitstring = pub(skC) in
                                                        {983}out(c, GetEndpointRequest);
                                                        {984}in(c, (SPs_1336: bitstring,=None,UP_1337: bitstring,=pkSess_1335));
                                                        {985}new SPc_1338: bitstring;
                                                        {986}new Nc_1339: bitstring;
                                                        {987}let m1_1340: bitstring = (SPc_1338,exp(g,Nc_1339)) in
                                                        {988}out(c, (pkCli_1011,m1_1340));
                                                        {989}in(c, PartS_1341: bitstring);
                                                        {990}let Kcli_1342: bitstring = exp(PartS_1341,Nc_1339) in
                                                        {991}out(c, senc(mCli(pkCli_1011,pkSess_1335),Kcli_1342))
                                                    )
                                                    else
                                                        {992}let pkSess_1343: bitstring = pub(skI) in
                                                        {993}out(c, GetEndpointRequest);
                                                        {994}in(c, (SPs_1344: bitstring,=None,UP_1345: bitstring,=pkSess_1343));
                                                        {995}new SPc_1346: bitstring;
                                                        {996}new Nc_1347: bitstring;
                                                        {997}let m1_1348: bitstring = (SPc_1346,exp(g,Nc_1347)) in
                                                        {998}out(c, (pkCli_1011,m1_1348));
                                                        {999}in(c, PartS_1349: bitstring);
                                                        {1000}let Kcli_1350: bitstring = exp(PartS_1349,Nc_1347) in
                                                        {1001}out(c, senc(mCli(pkCli_1011,pkSess_1343),Kcli_1350))
                                                )
                                                else
                                                    {1002}let pkSess_1351: bitstring = fail-any in
                                                    {1003}out(c, GetEndpointRequest);
                                                    {1004}in(c, (SPs_1352: bitstring,=None,UP_1353: bitstring,=pkSess_1351));
                                                    {1005}new SPc_1354: bitstring;
                                                    {1006}new Nc_1355: bitstring;
                                                    {1007}let m1_1356: bitstring = (SPc_1354,exp(g,Nc_1355)) in
                                                    {1008}out(c, (pkCli_1011,m1_1356));
                                                    {1009}in(c, PartS_1357: bitstring);
                                                    {1010}let Kcli_1358: bitstring = exp(PartS_1357,Nc_1355) in
                                                    {1011}out(c, senc(mCli(pkCli_1011,pkSess_1351),Kcli_1358))
                                        )
                                        else
                                            {1012}let pkSess_1359: bitstring = fail-any in
                                            {1013}out(c, GetEndpointRequest);
                                            {1014}in(c, (SPs_1360: bitstring,=None,UP_1361: bitstring,=pkSess_1359));
                                            {1015}new SPc_1362: bitstring;
                                            {1016}new Nc_1363: bitstring;
                                            {1017}let m1_1364: bitstring = (SPc_1362,exp(g,Nc_1363)) in
                                            {1018}out(c, (pkCli_1011,m1_1364));
                                            {1019}in(c, PartS_1365: bitstring);
                                            {1020}let Kcli_1366: bitstring = exp(PartS_1365,Nc_1363) in
                                            {1021}out(c, senc(mCli(pkCli_1011,pkSess_1359),Kcli_1366))
                                )
                                else
                                    {1022}let pkSess_1367: bitstring = fail-any in
                                    {1023}out(c, GetEndpointRequest);
                                    {1024}in(c, (SPs_1368: bitstring,=None,UP_1369: bitstring,=pkSess_1367));
                                    {1025}new SPc_1370: bitstring;
                                    {1026}new Nc_1371: bitstring;
                                    {1027}let m1_1372: bitstring = (SPc_1370,exp(g,Nc_1371)) in
                                    {1028}out(c, (pkCli_1011,m1_1372));
                                    {1029}in(c, PartS_1373: bitstring);
                                    {1030}let Kcli_1374: bitstring = exp(PartS_1373,Nc_1371) in
                                    {1031}out(c, senc(mCli(pkCli_1011,pkSess_1367),Kcli_1374))
                    )
                    else
                        {1032}let pkDisco_1375: bitstring = fail-any in
                        {1033}let v_1376: bool = (Sess = A) in
                        (
                            {1034}if v_1376 then
                            (
                                {1035}let pkSess_1377: bitstring = pub(skA) in
                                {1036}out(c, GetEndpointRequest);
                                {1037}in(c, (SPs_1378: bitstring,=None,UP_1379: bitstring,=pkSess_1377));
                                {1038}new SPc_1380: bitstring;
                                {1039}new Nc_1381: bitstring;
                                {1040}let m1_1382: bitstring = (SPc_1380,exp(g,Nc_1381)) in
                                {1041}out(c, (pkCli_1011,m1_1382));
                                {1042}in(c, PartS_1383: bitstring);
                                {1043}let Kcli_1384: bitstring = exp(PartS_1383,Nc_1381) in
                                {1044}out(c, senc(mCli(pkCli_1011,pkSess_1377),Kcli_1384))
                            )
                            else
                                {1045}let v_1385: bool = (Sess = B) in
                                (
                                    {1046}if v_1385 then
                                    (
                                        {1047}let pkSess_1386: bitstring = pub(skB) in
                                        {1048}out(c, GetEndpointRequest);
                                        {1049}in(c, (SPs_1387: bitstring,=None,UP_1388: bitstring,=pkSess_1386));
                                        {1050}new SPc_1389: bitstring;
                                        {1051}new Nc_1390: bitstring;
                                        {1052}let m1_1391: bitstring = (SPc_1389,exp(g,Nc_1390)) in
                                        {1053}out(c, (pkCli_1011,m1_1391));
                                        {1054}in(c, PartS_1392: bitstring);
                                        {1055}let Kcli_1393: bitstring = exp(PartS_1392,Nc_1390) in
                                        {1056}out(c, senc(mCli(pkCli_1011,pkSess_1386),Kcli_1393))
                                    )
                                    else
                                        {1057}let v_1394: bool = (Sess = C) in
                                        (
                                            {1058}if v_1394 then
                                            (
                                                {1059}let pkSess_1395: bitstring = pub(skC) in
                                                {1060}out(c, GetEndpointRequest);
                                                {1061}in(c, (SPs_1396: bitstring,=None,UP_1397: bitstring,=pkSess_1395));
                                                {1062}new SPc_1398: bitstring;
                                                {1063}new Nc_1399: bitstring;
                                                {1064}let m1_1400: bitstring = (SPc_1398,exp(g,Nc_1399)) in
                                                {1065}out(c, (pkCli_1011,m1_1400));
                                                {1066}in(c, PartS_1401: bitstring);
                                                {1067}let Kcli_1402: bitstring = exp(PartS_1401,Nc_1399) in
                                                {1068}out(c, senc(mCli(pkCli_1011,pkSess_1395),Kcli_1402))
                                            )
                                            else
                                                {1069}let pkSess_1403: bitstring = pub(skI) in
                                                {1070}out(c, GetEndpointRequest);
                                                {1071}in(c, (SPs_1404: bitstring,=None,UP_1405: bitstring,=pkSess_1403));
                                                {1072}new SPc_1406: bitstring;
                                                {1073}new Nc_1407: bitstring;
                                                {1074}let m1_1408: bitstring = (SPc_1406,exp(g,Nc_1407)) in
                                                {1075}out(c, (pkCli_1011,m1_1408));
                                                {1076}in(c, PartS_1409: bitstring);
                                                {1077}let Kcli_1410: bitstring = exp(PartS_1409,Nc_1407) in
                                                {1078}out(c, senc(mCli(pkCli_1011,pkSess_1403),Kcli_1410))
                                        )
                                        else
                                            {1079}let pkSess_1411: bitstring = fail-any in
                                            {1080}out(c, GetEndpointRequest);
                                            {1081}in(c, (SPs_1412: bitstring,=None,UP_1413: bitstring,=pkSess_1411));
                                            {1082}new SPc_1414: bitstring;
                                            {1083}new Nc_1415: bitstring;
                                            {1084}let m1_1416: bitstring = (SPc_1414,exp(g,Nc_1415)) in
                                            {1085}out(c, (pkCli_1011,m1_1416));
                                            {1086}in(c, PartS_1417: bitstring);
                                            {1087}let Kcli_1418: bitstring = exp(PartS_1417,Nc_1415) in
                                            {1088}out(c, senc(mCli(pkCli_1011,pkSess_1411),Kcli_1418))
                                )
                                else
                                    {1089}let pkSess_1419: bitstring = fail-any in
                                    {1090}out(c, GetEndpointRequest);
                                    {1091}in(c, (SPs_1420: bitstring,=None,UP_1421: bitstring,=pkSess_1419));
                                    {1092}new SPc_1422: bitstring;
                                    {1093}new Nc_1423: bitstring;
                                    {1094}let m1_1424: bitstring = (SPc_1422,exp(g,Nc_1423)) in
                                    {1095}out(c, (pkCli_1011,m1_1424));
                                    {1096}in(c, PartS_1425: bitstring);
                                    {1097}let Kcli_1426: bitstring = exp(PartS_1425,Nc_1423) in
                                    {1098}out(c, senc(mCli(pkCli_1011,pkSess_1419),Kcli_1426))
                        )
                        else
                            {1099}let pkSess_1427: bitstring = fail-any in
                            {1100}out(c, GetEndpointRequest);
                            {1101}in(c, (SPs_1428: bitstring,=None,UP_1429: bitstring,=pkSess_1427));
                            {1102}new SPc_1430: bitstring;
                            {1103}new Nc_1431: bitstring;
                            {1104}let m1_1432: bitstring = (SPc_1430,exp(g,Nc_1431)) in
                            {1105}out(c, (pkCli_1011,m1_1432));
                            {1106}in(c, PartS_1433: bitstring);
                            {1107}let Kcli_1434: bitstring = exp(PartS_1433,Nc_1431) in
                            {1108}out(c, senc(mCli(pkCli_1011,pkSess_1427),Kcli_1434))
                )
                else
                    {1109}let v_1435: bool = (Cli = C) in
                    (
                        {1110}if v_1435 then
                        (
                            {1111}let skCli_1436: bitstring = skC in
                            {1112}let pkCli_1437: bitstring = pub(skCli_1436) in
                            {1113}let v_1438: bool = (Disco = A) in
                            (
                                {1114}if v_1438 then
                                (
                                    {1115}let pkDisco_1439: bitstring = pub(skA) in
                                    {1116}let v_1440: bool = (Sess = A) in
                                    (
                                        {1117}if v_1440 then
                                        (
                                            {1118}let pkSess_1441: bitstring = pub(skA) in
                                            {1119}out(c, GetEndpointRequest);
                                            {1120}in(c, (SPs_1442: bitstring,=None,UP_1443: bitstring,=pkSess_1441));
                                            {1121}new SPc_1444: bitstring;
                                            {1122}new Nc_1445: bitstring;
                                            {1123}let m1_1446: bitstring = (SPc_1444,exp(g,Nc_1445)) in
                                            {1124}out(c, (pkCli_1437,m1_1446));
                                            {1125}in(c, PartS_1447: bitstring);
                                            {1126}let Kcli_1448: bitstring = exp(PartS_1447,Nc_1445) in
                                            {1127}out(c, senc(mCli(pkCli_1437,pkSess_1441),Kcli_1448))
                                        )
                                        else
                                            {1128}let v_1449: bool = (Sess = B) in
                                            (
                                                {1129}if v_1449 then
                                                (
                                                    {1130}let pkSess_1450: bitstring = pub(skB) in
                                                    {1131}out(c, GetEndpointRequest);
                                                    {1132}in(c, (SPs_1451: bitstring,=None,UP_1452: bitstring,=pkSess_1450));
                                                    {1133}new SPc_1453: bitstring;
                                                    {1134}new Nc_1454: bitstring;
                                                    {1135}let m1_1455: bitstring = (SPc_1453,exp(g,Nc_1454)) in
                                                    {1136}out(c, (pkCli_1437,m1_1455));
                                                    {1137}in(c, PartS_1456: bitstring);
                                                    {1138}let Kcli_1457: bitstring = exp(PartS_1456,Nc_1454) in
                                                    {1139}out(c, senc(mCli(pkCli_1437,pkSess_1450),Kcli_1457))
                                                )
                                                else
                                                    {1140}let v_1458: bool = (Sess = C) in
                                                    (
                                                        {1141}if v_1458 then
                                                        (
                                                            {1142}let pkSess_1459: bitstring = pub(skC) in
                                                            {1143}out(c, GetEndpointRequest);
                                                            {1144}in(c, (SPs_1460: bitstring,=None,UP_1461: bitstring,=pkSess_1459));
                                                            {1145}new SPc_1462: bitstring;
                                                            {1146}new Nc_1463: bitstring;
                                                            {1147}let m1_1464: bitstring = (SPc_1462,exp(g,Nc_1463)) in
                                                            {1148}out(c, (pkCli_1437,m1_1464));
                                                            {1149}in(c, PartS_1465: bitstring);
                                                            {1150}let Kcli_1466: bitstring = exp(PartS_1465,Nc_1463) in
                                                            {1151}out(c, senc(mCli(pkCli_1437,pkSess_1459),Kcli_1466))
                                                        )
                                                        else
                                                            {1152}let pkSess_1467: bitstring = pub(skI) in
                                                            {1153}out(c, GetEndpointRequest);
                                                            {1154}in(c, (SPs_1468: bitstring,=None,UP_1469: bitstring,=pkSess_1467));
                                                            {1155}new SPc_1470: bitstring;
                                                            {1156}new Nc_1471: bitstring;
                                                            {1157}let m1_1472: bitstring = (SPc_1470,exp(g,Nc_1471)) in
                                                            {1158}out(c, (pkCli_1437,m1_1472));
                                                            {1159}in(c, PartS_1473: bitstring);
                                                            {1160}let Kcli_1474: bitstring = exp(PartS_1473,Nc_1471) in
                                                            {1161}out(c, senc(mCli(pkCli_1437,pkSess_1467),Kcli_1474))
                                                    )
                                                    else
                                                        {1162}let pkSess_1475: bitstring = fail-any in
                                                        {1163}out(c, GetEndpointRequest);
                                                        {1164}in(c, (SPs_1476: bitstring,=None,UP_1477: bitstring,=pkSess_1475));
                                                        {1165}new SPc_1478: bitstring;
                                                        {1166}new Nc_1479: bitstring;
                                                        {1167}let m1_1480: bitstring = (SPc_1478,exp(g,Nc_1479)) in
                                                        {1168}out(c, (pkCli_1437,m1_1480));
                                                        {1169}in(c, PartS_1481: bitstring);
                                                        {1170}let Kcli_1482: bitstring = exp(PartS_1481,Nc_1479) in
                                                        {1171}out(c, senc(mCli(pkCli_1437,pkSess_1475),Kcli_1482))
                                            )
                                            else
                                                {1172}let pkSess_1483: bitstring = fail-any in
                                                {1173}out(c, GetEndpointRequest);
                                                {1174}in(c, (SPs_1484: bitstring,=None,UP_1485: bitstring,=pkSess_1483));
                                                {1175}new SPc_1486: bitstring;
                                                {1176}new Nc_1487: bitstring;
                                                {1177}let m1_1488: bitstring = (SPc_1486,exp(g,Nc_1487)) in
                                                {1178}out(c, (pkCli_1437,m1_1488));
                                                {1179}in(c, PartS_1489: bitstring);
                                                {1180}let Kcli_1490: bitstring = exp(PartS_1489,Nc_1487) in
                                                {1181}out(c, senc(mCli(pkCli_1437,pkSess_1483),Kcli_1490))
                                    )
                                    else
                                        {1182}let pkSess_1491: bitstring = fail-any in
                                        {1183}out(c, GetEndpointRequest);
                                        {1184}in(c, (SPs_1492: bitstring,=None,UP_1493: bitstring,=pkSess_1491));
                                        {1185}new SPc_1494: bitstring;
                                        {1186}new Nc_1495: bitstring;
                                        {1187}let m1_1496: bitstring = (SPc_1494,exp(g,Nc_1495)) in
                                        {1188}out(c, (pkCli_1437,m1_1496));
                                        {1189}in(c, PartS_1497: bitstring);
                                        {1190}let Kcli_1498: bitstring = exp(PartS_1497,Nc_1495) in
                                        {1191}out(c, senc(mCli(pkCli_1437,pkSess_1491),Kcli_1498))
                                )
                                else
                                    {1192}let v_1499: bool = (Disco = B) in
                                    (
                                        {1193}if v_1499 then
                                        (
                                            {1194}let pkDisco_1500: bitstring = pub(skB) in
                                            {1195}let v_1501: bool = (Sess = A) in
                                            (
                                                {1196}if v_1501 then
                                                (
                                                    {1197}let pkSess_1502: bitstring = pub(skA) in
                                                    {1198}out(c, GetEndpointRequest);
                                                    {1199}in(c, (SPs_1503: bitstring,=None,UP_1504: bitstring,=pkSess_1502));
                                                    {1200}new SPc_1505: bitstring;
                                                    {1201}new Nc_1506: bitstring;
                                                    {1202}let m1_1507: bitstring = (SPc_1505,exp(g,Nc_1506)) in
                                                    {1203}out(c, (pkCli_1437,m1_1507));
                                                    {1204}in(c, PartS_1508: bitstring);
                                                    {1205}let Kcli_1509: bitstring = exp(PartS_1508,Nc_1506) in
                                                    {1206}out(c, senc(mCli(pkCli_1437,pkSess_1502),Kcli_1509))
                                                )
                                                else
                                                    {1207}let v_1510: bool = (Sess = B) in
                                                    (
                                                        {1208}if v_1510 then
                                                        (
                                                            {1209}let pkSess_1511: bitstring = pub(skB) in
                                                            {1210}out(c, GetEndpointRequest);
                                                            {1211}in(c, (SPs_1512: bitstring,=None,UP_1513: bitstring,=pkSess_1511));
                                                            {1212}new SPc_1514: bitstring;
                                                            {1213}new Nc_1515: bitstring;
                                                            {1214}let m1_1516: bitstring = (SPc_1514,exp(g,Nc_1515)) in
                                                            {1215}out(c, (pkCli_1437,m1_1516));
                                                            {1216}in(c, PartS_1517: bitstring);
                                                            {1217}let Kcli_1518: bitstring = exp(PartS_1517,Nc_1515) in
                                                            {1218}out(c, senc(mCli(pkCli_1437,pkSess_1511),Kcli_1518))
                                                        )
                                                        else
                                                            {1219}let v_1519: bool = (Sess = C) in
                                                            (
                                                                {1220}if v_1519 then
                                                                (
                                                                    {1221}let pkSess_1520: bitstring = pub(skC) in
                                                                    {1222}out(c, GetEndpointRequest);
                                                                    {1223}in(c, (SPs_1521: bitstring,=None,UP_1522: bitstring,=pkSess_1520));
                                                                    {1224}new SPc_1523: bitstring;
                                                                    {1225}new Nc_1524: bitstring;
                                                                    {1226}let m1_1525: bitstring = (SPc_1523,exp(g,Nc_1524)) in
                                                                    {1227}out(c, (pkCli_1437,m1_1525));
                                                                    {1228}in(c, PartS_1526: bitstring);
                                                                    {1229}let Kcli_1527: bitstring = exp(PartS_1526,Nc_1524) in
                                                                    {1230}out(c, senc(mCli(pkCli_1437,pkSess_1520),Kcli_1527))
                                                                )
                                                                else
                                                                    {1231}let pkSess_1528: bitstring = pub(skI) in
                                                                    {1232}out(c, GetEndpointRequest);
                                                                    {1233}in(c, (SPs_1529: bitstring,=None,UP_1530: bitstring,=pkSess_1528));
                                                                    {1234}new SPc_1531: bitstring;
                                                                    {1235}new Nc_1532: bitstring;
                                                                    {1236}let m1_1533: bitstring = (SPc_1531,exp(g,Nc_1532)) in
                                                                    {1237}out(c, (pkCli_1437,m1_1533));
                                                                    {1238}in(c, PartS_1534: bitstring);
                                                                    {1239}let Kcli_1535: bitstring = exp(PartS_1534,Nc_1532) in
                                                                    {1240}out(c, senc(mCli(pkCli_1437,pkSess_1528),Kcli_1535))
                                                            )
                                                            else
                                                                {1241}let pkSess_1536: bitstring = fail-any in
                                                                {1242}out(c, GetEndpointRequest);
                                                                {1243}in(c, (SPs_1537: bitstring,=None,UP_1538: bitstring,=pkSess_1536));
                                                                {1244}new SPc_1539: bitstring;
                                                                {1245}new Nc_1540: bitstring;
                                                                {1246}let m1_1541: bitstring = (SPc_1539,exp(g,Nc_1540)) in
                                                                {1247}out(c, (pkCli_1437,m1_1541));
                                                                {1248}in(c, PartS_1542: bitstring);
                                                                {1249}let Kcli_1543: bitstring = exp(PartS_1542,Nc_1540) in
                                                                {1250}out(c, senc(mCli(pkCli_1437,pkSess_1536),Kcli_1543))
                                                    )
                                                    else
                                                        {1251}let pkSess_1544: bitstring = fail-any in
                                                        {1252}out(c, GetEndpointRequest);
                                                        {1253}in(c, (SPs_1545: bitstring,=None,UP_1546: bitstring,=pkSess_1544));
                                                        {1254}new SPc_1547: bitstring;
                                                        {1255}new Nc_1548: bitstring;
                                                        {1256}let m1_1549: bitstring = (SPc_1547,exp(g,Nc_1548)) in
                                                        {1257}out(c, (pkCli_1437,m1_1549));
                                                        {1258}in(c, PartS_1550: bitstring);
                                                        {1259}let Kcli_1551: bitstring = exp(PartS_1550,Nc_1548) in
                                                        {1260}out(c, senc(mCli(pkCli_1437,pkSess_1544),Kcli_1551))
                                            )
                                            else
                                                {1261}let pkSess_1552: bitstring = fail-any in
                                                {1262}out(c, GetEndpointRequest);
                                                {1263}in(c, (SPs_1553: bitstring,=None,UP_1554: bitstring,=pkSess_1552));
                                                {1264}new SPc_1555: bitstring;
                                                {1265}new Nc_1556: bitstring;
                                                {1266}let m1_1557: bitstring = (SPc_1555,exp(g,Nc_1556)) in
                                                {1267}out(c, (pkCli_1437,m1_1557));
                                                {1268}in(c, PartS_1558: bitstring);
                                                {1269}let Kcli_1559: bitstring = exp(PartS_1558,Nc_1556) in
                                                {1270}out(c, senc(mCli(pkCli_1437,pkSess_1552),Kcli_1559))
                                        )
                                        else
                                            {1271}let v_1560: bool = (Disco = C) in
                                            (
                                                {1272}if v_1560 then
                                                (
                                                    {1273}let pkDisco_1561: bitstring = pub(skC) in
                                                    {1274}let v_1562: bool = (Sess = A) in
                                                    (
                                                        {1275}if v_1562 then
                                                        (
                                                            {1276}let pkSess_1563: bitstring = pub(skA) in
                                                            {1277}out(c, GetEndpointRequest);
                                                            {1278}in(c, (SPs_1564: bitstring,=None,UP_1565: bitstring,=pkSess_1563));
                                                            {1279}new SPc_1566: bitstring;
                                                            {1280}new Nc_1567: bitstring;
                                                            {1281}let m1_1568: bitstring = (SPc_1566,exp(g,Nc_1567)) in
                                                            {1282}out(c, (pkCli_1437,m1_1568));
                                                            {1283}in(c, PartS_1569: bitstring);
                                                            {1284}let Kcli_1570: bitstring = exp(PartS_1569,Nc_1567) in
                                                            {1285}out(c, senc(mCli(pkCli_1437,pkSess_1563),Kcli_1570))
                                                        )
                                                        else
                                                            {1286}let v_1571: bool = (Sess = B) in
                                                            (
                                                                {1287}if v_1571 then
                                                                (
                                                                    {1288}let pkSess_1572: bitstring = pub(skB) in
                                                                    {1289}out(c, GetEndpointRequest);
                                                                    {1290}in(c, (SPs_1573: bitstring,=None,UP_1574: bitstring,=pkSess_1572));
                                                                    {1291}new SPc_1575: bitstring;
                                                                    {1292}new Nc_1576: bitstring;
                                                                    {1293}let m1_1577: bitstring = (SPc_1575,exp(g,Nc_1576)) in
                                                                    {1294}out(c, (pkCli_1437,m1_1577));
                                                                    {1295}in(c, PartS_1578: bitstring);
                                                                    {1296}let Kcli_1579: bitstring = exp(PartS_1578,Nc_1576) in
                                                                    {1297}out(c, senc(mCli(pkCli_1437,pkSess_1572),Kcli_1579))
                                                                )
                                                                else
                                                                    {1298}let v_1580: bool = (Sess = C) in
                                                                    (
                                                                        {1299}if v_1580 then
                                                                        (
                                                                            {1300}let pkSess_1581: bitstring = pub(skC) in
                                                                            {1301}out(c, GetEndpointRequest);
                                                                            {1302}in(c, (SPs_1582: bitstring,=None,UP_1583: bitstring,=pkSess_1581));
                                                                            {1303}new SPc_1584: bitstring;
                                                                            {1304}new Nc_1585: bitstring;
                                                                            {1305}let m1_1586: bitstring = (SPc_1584,exp(g,Nc_1585)) in
                                                                            {1306}out(c, (pkCli_1437,m1_1586));
                                                                            {1307}in(c, PartS_1587: bitstring);
                                                                            {1308}let Kcli_1588: bitstring = exp(PartS_1587,Nc_1585) in
                                                                            {1309}out(c, senc(mCli(pkCli_1437,pkSess_1581),Kcli_1588))
                                                                        )
                                                                        else
                                                                            {1310}let pkSess_1589: bitstring = pub(skI) in
                                                                            {1311}out(c, GetEndpointRequest);
                                                                            {1312}in(c, (SPs_1590: bitstring,=None,UP_1591: bitstring,=pkSess_1589));
                                                                            {1313}new SPc_1592: bitstring;
                                                                            {1314}new Nc_1593: bitstring;
                                                                            {1315}let m1_1594: bitstring = (SPc_1592,exp(g,Nc_1593)) in
                                                                            {1316}out(c, (pkCli_1437,m1_1594));
                                                                            {1317}in(c, PartS_1595: bitstring);
                                                                            {1318}let Kcli_1596: bitstring = exp(PartS_1595,Nc_1593) in
                                                                            {1319}out(c, senc(mCli(pkCli_1437,pkSess_1589),Kcli_1596))
                                                                    )
                                                                    else
                                                                        {1320}let pkSess_1597: bitstring = fail-any in
                                                                        {1321}out(c, GetEndpointRequest);
                                                                        {1322}in(c, (SPs_1598: bitstring,=None,UP_1599: bitstring,=pkSess_1597));
                                                                        {1323}new SPc_1600: bitstring;
                                                                        {1324}new Nc_1601: bitstring;
                                                                        {1325}let m1_1602: bitstring = (SPc_1600,exp(g,Nc_1601)) in
                                                                        {1326}out(c, (pkCli_1437,m1_1602));
                                                                        {1327}in(c, PartS_1603: bitstring);
                                                                        {1328}let Kcli_1604: bitstring = exp(PartS_1603,Nc_1601) in
                                                                        {1329}out(c, senc(mCli(pkCli_1437,pkSess_1597),Kcli_1604))
                                                            )
                                                            else
                                                                {1330}let pkSess_1605: bitstring = fail-any in
                                                                {1331}out(c, GetEndpointRequest);
                                                                {1332}in(c, (SPs_1606: bitstring,=None,UP_1607: bitstring,=pkSess_1605));
                                                                {1333}new SPc_1608: bitstring;
                                                                {1334}new Nc_1609: bitstring;
                                                                {1335}let m1_1610: bitstring = (SPc_1608,exp(g,Nc_1609)) in
                                                                {1336}out(c, (pkCli_1437,m1_1610));
                                                                {1337}in(c, PartS_1611: bitstring);
                                                                {1338}let Kcli_1612: bitstring = exp(PartS_1611,Nc_1609) in
                                                                {1339}out(c, senc(mCli(pkCli_1437,pkSess_1605),Kcli_1612))
                                                    )
                                                    else
                                                        {1340}let pkSess_1613: bitstring = fail-any in
                                                        {1341}out(c, GetEndpointRequest);
                                                        {1342}in(c, (SPs_1614: bitstring,=None,UP_1615: bitstring,=pkSess_1613));
                                                        {1343}new SPc_1616: bitstring;
                                                        {1344}new Nc_1617: bitstring;
                                                        {1345}let m1_1618: bitstring = (SPc_1616,exp(g,Nc_1617)) in
                                                        {1346}out(c, (pkCli_1437,m1_1618));
                                                        {1347}in(c, PartS_1619: bitstring);
                                                        {1348}let Kcli_1620: bitstring = exp(PartS_1619,Nc_1617) in
                                                        {1349}out(c, senc(mCli(pkCli_1437,pkSess_1613),Kcli_1620))
                                                )
                                                else
                                                    {1350}let pkDisco_1621: bitstring = pub(skI) in
                                                    {1351}let v_1622: bool = (Sess = A) in
                                                    (
                                                        {1352}if v_1622 then
                                                        (
                                                            {1353}let pkSess_1623: bitstring = pub(skA) in
                                                            {1354}out(c, GetEndpointRequest);
                                                            {1355}in(c, (SPs_1624: bitstring,=None,UP_1625: bitstring,=pkSess_1623));
                                                            {1356}new SPc_1626: bitstring;
                                                            {1357}new Nc_1627: bitstring;
                                                            {1358}let m1_1628: bitstring = (SPc_1626,exp(g,Nc_1627)) in
                                                            {1359}out(c, (pkCli_1437,m1_1628));
                                                            {1360}in(c, PartS_1629: bitstring);
                                                            {1361}let Kcli_1630: bitstring = exp(PartS_1629,Nc_1627) in
                                                            {1362}out(c, senc(mCli(pkCli_1437,pkSess_1623),Kcli_1630))
                                                        )
                                                        else
                                                            {1363}let v_1631: bool = (Sess = B) in
                                                            (
                                                                {1364}if v_1631 then
                                                                (
                                                                    {1365}let pkSess_1632: bitstring = pub(skB) in
                                                                    {1366}out(c, GetEndpointRequest);
                                                                    {1367}in(c, (SPs_1633: bitstring,=None,UP_1634: bitstring,=pkSess_1632));
                                                                    {1368}new SPc_1635: bitstring;
                                                                    {1369}new Nc_1636: bitstring;
                                                                    {1370}let m1_1637: bitstring = (SPc_1635,exp(g,Nc_1636)) in
                                                                    {1371}out(c, (pkCli_1437,m1_1637));
                                                                    {1372}in(c, PartS_1638: bitstring);
                                                                    {1373}let Kcli_1639: bitstring = exp(PartS_1638,Nc_1636) in
                                                                    {1374}out(c, senc(mCli(pkCli_1437,pkSess_1632),Kcli_1639))
                                                                )
                                                                else
                                                                    {1375}let v_1640: bool = (Sess = C) in
                                                                    (
                                                                        {1376}if v_1640 then
                                                                        (
                                                                            {1377}let pkSess_1641: bitstring = pub(skC) in
                                                                            {1378}out(c, GetEndpointRequest);
                                                                            {1379}in(c, (SPs_1642: bitstring,=None,UP_1643: bitstring,=pkSess_1641));
                                                                            {1380}new SPc_1644: bitstring;
                                                                            {1381}new Nc_1645: bitstring;
                                                                            {1382}let m1_1646: bitstring = (SPc_1644,exp(g,Nc_1645)) in
                                                                            {1383}out(c, (pkCli_1437,m1_1646));
                                                                            {1384}in(c, PartS_1647: bitstring);
                                                                            {1385}let Kcli_1648: bitstring = exp(PartS_1647,Nc_1645) in
                                                                            {1386}out(c, senc(mCli(pkCli_1437,pkSess_1641),Kcli_1648))
                                                                        )
                                                                        else
                                                                            {1387}let pkSess_1649: bitstring = pub(skI) in
                                                                            {1388}out(c, GetEndpointRequest);
                                                                            {1389}in(c, (SPs_1650: bitstring,=None,UP_1651: bitstring,=pkSess_1649));
                                                                            {1390}new SPc_1652: bitstring;
                                                                            {1391}new Nc_1653: bitstring;
                                                                            {1392}let m1_1654: bitstring = (SPc_1652,exp(g,Nc_1653)) in
                                                                            {1393}out(c, (pkCli_1437,m1_1654));
                                                                            {1394}in(c, PartS_1655: bitstring);
                                                                            {1395}let Kcli_1656: bitstring = exp(PartS_1655,Nc_1653) in
                                                                            {1396}out(c, senc(mCli(pkCli_1437,pkSess_1649),Kcli_1656))
                                                                    )
                                                                    else
                                                                        {1397}let pkSess_1657: bitstring = fail-any in
                                                                        {1398}out(c, GetEndpointRequest);
                                                                        {1399}in(c, (SPs_1658: bitstring,=None,UP_1659: bitstring,=pkSess_1657));
                                                                        {1400}new SPc_1660: bitstring;
                                                                        {1401}new Nc_1661: bitstring;
                                                                        {1402}let m1_1662: bitstring = (SPc_1660,exp(g,Nc_1661)) in
                                                                        {1403}out(c, (pkCli_1437,m1_1662));
                                                                        {1404}in(c, PartS_1663: bitstring);
                                                                        {1405}let Kcli_1664: bitstring = exp(PartS_1663,Nc_1661) in
                                                                        {1406}out(c, senc(mCli(pkCli_1437,pkSess_1657),Kcli_1664))
                                                            )
                                                            else
                                                                {1407}let pkSess_1665: bitstring = fail-any in
                                                                {1408}out(c, GetEndpointRequest);
                                                                {1409}in(c, (SPs_1666: bitstring,=None,UP_1667: bitstring,=pkSess_1665));
                                                                {1410}new SPc_1668: bitstring;
                                                                {1411}new Nc_1669: bitstring;
                                                                {1412}let m1_1670: bitstring = (SPc_1668,exp(g,Nc_1669)) in
                                                                {1413}out(c, (pkCli_1437,m1_1670));
                                                                {1414}in(c, PartS_1671: bitstring);
                                                                {1415}let Kcli_1672: bitstring = exp(PartS_1671,Nc_1669) in
                                                                {1416}out(c, senc(mCli(pkCli_1437,pkSess_1665),Kcli_1672))
                                                    )
                                                    else
                                                        {1417}let pkSess_1673: bitstring = fail-any in
                                                        {1418}out(c, GetEndpointRequest);
                                                        {1419}in(c, (SPs_1674: bitstring,=None,UP_1675: bitstring,=pkSess_1673));
                                                        {1420}new SPc_1676: bitstring;
                                                        {1421}new Nc_1677: bitstring;
                                                        {1422}let m1_1678: bitstring = (SPc_1676,exp(g,Nc_1677)) in
                                                        {1423}out(c, (pkCli_1437,m1_1678));
                                                        {1424}in(c, PartS_1679: bitstring);
                                                        {1425}let Kcli_1680: bitstring = exp(PartS_1679,Nc_1677) in
                                                        {1426}out(c, senc(mCli(pkCli_1437,pkSess_1673),Kcli_1680))
                                            )
                                            else
                                                {1427}let pkDisco_1681: bitstring = fail-any in
                                                {1428}let v_1682: bool = (Sess = A) in
                                                (
                                                    {1429}if v_1682 then
                                                    (
                                                        {1430}let pkSess_1683: bitstring = pub(skA) in
                                                        {1431}out(c, GetEndpointRequest);
                                                        {1432}in(c, (SPs_1684: bitstring,=None,UP_1685: bitstring,=pkSess_1683));
                                                        {1433}new SPc_1686: bitstring;
                                                        {1434}new Nc_1687: bitstring;
                                                        {1435}let m1_1688: bitstring = (SPc_1686,exp(g,Nc_1687)) in
                                                        {1436}out(c, (pkCli_1437,m1_1688));
                                                        {1437}in(c, PartS_1689: bitstring);
                                                        {1438}let Kcli_1690: bitstring = exp(PartS_1689,Nc_1687) in
                                                        {1439}out(c, senc(mCli(pkCli_1437,pkSess_1683),Kcli_1690))
                                                    )
                                                    else
                                                        {1440}let v_1691: bool = (Sess = B) in
                                                        (
                                                            {1441}if v_1691 then
                                                            (
                                                                {1442}let pkSess_1692: bitstring = pub(skB) in
                                                                {1443}out(c, GetEndpointRequest);
                                                                {1444}in(c, (SPs_1693: bitstring,=None,UP_1694: bitstring,=pkSess_1692));
                                                                {1445}new SPc_1695: bitstring;
                                                                {1446}new Nc_1696: bitstring;
                                                                {1447}let m1_1697: bitstring = (SPc_1695,exp(g,Nc_1696)) in
                                                                {1448}out(c, (pkCli_1437,m1_1697));
                                                                {1449}in(c, PartS_1698: bitstring);
                                                                {1450}let Kcli_1699: bitstring = exp(PartS_1698,Nc_1696) in
                                                                {1451}out(c, senc(mCli(pkCli_1437,pkSess_1692),Kcli_1699))
                                                            )
                                                            else
                                                                {1452}let v_1700: bool = (Sess = C) in
                                                                (
                                                                    {1453}if v_1700 then
                                                                    (
                                                                        {1454}let pkSess_1701: bitstring = pub(skC) in
                                                                        {1455}out(c, GetEndpointRequest);
                                                                        {1456}in(c, (SPs_1702: bitstring,=None,UP_1703: bitstring,=pkSess_1701));
                                                                        {1457}new SPc_1704: bitstring;
                                                                        {1458}new Nc_1705: bitstring;
                                                                        {1459}let m1_1706: bitstring = (SPc_1704,exp(g,Nc_1705)) in
                                                                        {1460}out(c, (pkCli_1437,m1_1706));
                                                                        {1461}in(c, PartS_1707: bitstring);
                                                                        {1462}let Kcli_1708: bitstring = exp(PartS_1707,Nc_1705) in
                                                                        {1463}out(c, senc(mCli(pkCli_1437,pkSess_1701),Kcli_1708))
                                                                    )
                                                                    else
                                                                        {1464}let pkSess_1709: bitstring = pub(skI) in
                                                                        {1465}out(c, GetEndpointRequest);
                                                                        {1466}in(c, (SPs_1710: bitstring,=None,UP_1711: bitstring,=pkSess_1709));
                                                                        {1467}new SPc_1712: bitstring;
                                                                        {1468}new Nc_1713: bitstring;
                                                                        {1469}let m1_1714: bitstring = (SPc_1712,exp(g,Nc_1713)) in
                                                                        {1470}out(c, (pkCli_1437,m1_1714));
                                                                        {1471}in(c, PartS_1715: bitstring);
                                                                        {1472}let Kcli_1716: bitstring = exp(PartS_1715,Nc_1713) in
                                                                        {1473}out(c, senc(mCli(pkCli_1437,pkSess_1709),Kcli_1716))
                                                                )
                                                                else
                                                                    {1474}let pkSess_1717: bitstring = fail-any in
                                                                    {1475}out(c, GetEndpointRequest);
                                                                    {1476}in(c, (SPs_1718: bitstring,=None,UP_1719: bitstring,=pkSess_1717));
                                                                    {1477}new SPc_1720: bitstring;
                                                                    {1478}new Nc_1721: bitstring;
                                                                    {1479}let m1_1722: bitstring = (SPc_1720,exp(g,Nc_1721)) in
                                                                    {1480}out(c, (pkCli_1437,m1_1722));
                                                                    {1481}in(c, PartS_1723: bitstring);
                                                                    {1482}let Kcli_1724: bitstring = exp(PartS_1723,Nc_1721) in
                                                                    {1483}out(c, senc(mCli(pkCli_1437,pkSess_1717),Kcli_1724))
                                                        )
                                                        else
                                                            {1484}let pkSess_1725: bitstring = fail-any in
                                                            {1485}out(c, GetEndpointRequest);
                                                            {1486}in(c, (SPs_1726: bitstring,=None,UP_1727: bitstring,=pkSess_1725));
                                                            {1487}new SPc_1728: bitstring;
                                                            {1488}new Nc_1729: bitstring;
                                                            {1489}let m1_1730: bitstring = (SPc_1728,exp(g,Nc_1729)) in
                                                            {1490}out(c, (pkCli_1437,m1_1730));
                                                            {1491}in(c, PartS_1731: bitstring);
                                                            {1492}let Kcli_1732: bitstring = exp(PartS_1731,Nc_1729) in
                                                            {1493}out(c, senc(mCli(pkCli_1437,pkSess_1725),Kcli_1732))
                                                )
                                                else
                                                    {1494}let pkSess_1733: bitstring = fail-any in
                                                    {1495}out(c, GetEndpointRequest);
                                                    {1496}in(c, (SPs_1734: bitstring,=None,UP_1735: bitstring,=pkSess_1733));
                                                    {1497}new SPc_1736: bitstring;
                                                    {1498}new Nc_1737: bitstring;
                                                    {1499}let m1_1738: bitstring = (SPc_1736,exp(g,Nc_1737)) in
                                                    {1500}out(c, (pkCli_1437,m1_1738));
                                                    {1501}in(c, PartS_1739: bitstring);
                                                    {1502}let Kcli_1740: bitstring = exp(PartS_1739,Nc_1737) in
                                                    {1503}out(c, senc(mCli(pkCli_1437,pkSess_1733),Kcli_1740))
                                    )
                                    else
                                        {1504}let pkDisco_1741: bitstring = fail-any in
                                        {1505}let v_1742: bool = (Sess = A) in
                                        (
                                            {1506}if v_1742 then
                                            (
                                                {1507}let pkSess_1743: bitstring = pub(skA) in
                                                {1508}out(c, GetEndpointRequest);
                                                {1509}in(c, (SPs_1744: bitstring,=None,UP_1745: bitstring,=pkSess_1743));
                                                {1510}new SPc_1746: bitstring;
                                                {1511}new Nc_1747: bitstring;
                                                {1512}let m1_1748: bitstring = (SPc_1746,exp(g,Nc_1747)) in
                                                {1513}out(c, (pkCli_1437,m1_1748));
                                                {1514}in(c, PartS_1749: bitstring);
                                                {1515}let Kcli_1750: bitstring = exp(PartS_1749,Nc_1747) in
                                                {1516}out(c, senc(mCli(pkCli_1437,pkSess_1743),Kcli_1750))
                                            )
                                            else
                                                {1517}let v_1751: bool = (Sess = B) in
                                                (
                                                    {1518}if v_1751 then
                                                    (
                                                        {1519}let pkSess_1752: bitstring = pub(skB) in
                                                        {1520}out(c, GetEndpointRequest);
                                                        {1521}in(c, (SPs_1753: bitstring,=None,UP_1754: bitstring,=pkSess_1752));
                                                        {1522}new SPc_1755: bitstring;
                                                        {1523}new Nc_1756: bitstring;
                                                        {1524}let m1_1757: bitstring = (SPc_1755,exp(g,Nc_1756)) in
                                                        {1525}out(c, (pkCli_1437,m1_1757));
                                                        {1526}in(c, PartS_1758: bitstring);
                                                        {1527}let Kcli_1759: bitstring = exp(PartS_1758,Nc_1756) in
                                                        {1528}out(c, senc(mCli(pkCli_1437,pkSess_1752),Kcli_1759))
                                                    )
                                                    else
                                                        {1529}let v_1760: bool = (Sess = C) in
                                                        (
                                                            {1530}if v_1760 then
                                                            (
                                                                {1531}let pkSess_1761: bitstring = pub(skC) in
                                                                {1532}out(c, GetEndpointRequest);
                                                                {1533}in(c, (SPs_1762: bitstring,=None,UP_1763: bitstring,=pkSess_1761));
                                                                {1534}new SPc_1764: bitstring;
                                                                {1535}new Nc_1765: bitstring;
                                                                {1536}let m1_1766: bitstring = (SPc_1764,exp(g,Nc_1765)) in
                                                                {1537}out(c, (pkCli_1437,m1_1766));
                                                                {1538}in(c, PartS_1767: bitstring);
                                                                {1539}let Kcli_1768: bitstring = exp(PartS_1767,Nc_1765) in
                                                                {1540}out(c, senc(mCli(pkCli_1437,pkSess_1761),Kcli_1768))
                                                            )
                                                            else
                                                                {1541}let pkSess_1769: bitstring = pub(skI) in
                                                                {1542}out(c, GetEndpointRequest);
                                                                {1543}in(c, (SPs_1770: bitstring,=None,UP_1771: bitstring,=pkSess_1769));
                                                                {1544}new SPc_1772: bitstring;
                                                                {1545}new Nc_1773: bitstring;
                                                                {1546}let m1_1774: bitstring = (SPc_1772,exp(g,Nc_1773)) in
                                                                {1547}out(c, (pkCli_1437,m1_1774));
                                                                {1548}in(c, PartS_1775: bitstring);
                                                                {1549}let Kcli_1776: bitstring = exp(PartS_1775,Nc_1773) in
                                                                {1550}out(c, senc(mCli(pkCli_1437,pkSess_1769),Kcli_1776))
                                                        )
                                                        else
                                                            {1551}let pkSess_1777: bitstring = fail-any in
                                                            {1552}out(c, GetEndpointRequest);
                                                            {1553}in(c, (SPs_1778: bitstring,=None,UP_1779: bitstring,=pkSess_1777));
                                                            {1554}new SPc_1780: bitstring;
                                                            {1555}new Nc_1781: bitstring;
                                                            {1556}let m1_1782: bitstring = (SPc_1780,exp(g,Nc_1781)) in
                                                            {1557}out(c, (pkCli_1437,m1_1782));
                                                            {1558}in(c, PartS_1783: bitstring);
                                                            {1559}let Kcli_1784: bitstring = exp(PartS_1783,Nc_1781) in
                                                            {1560}out(c, senc(mCli(pkCli_1437,pkSess_1777),Kcli_1784))
                                                )
                                                else
                                                    {1561}let pkSess_1785: bitstring = fail-any in
                                                    {1562}out(c, GetEndpointRequest);
                                                    {1563}in(c, (SPs_1786: bitstring,=None,UP_1787: bitstring,=pkSess_1785));
                                                    {1564}new SPc_1788: bitstring;
                                                    {1565}new Nc_1789: bitstring;
                                                    {1566}let m1_1790: bitstring = (SPc_1788,exp(g,Nc_1789)) in
                                                    {1567}out(c, (pkCli_1437,m1_1790));
                                                    {1568}in(c, PartS_1791: bitstring);
                                                    {1569}let Kcli_1792: bitstring = exp(PartS_1791,Nc_1789) in
                                                    {1570}out(c, senc(mCli(pkCli_1437,pkSess_1785),Kcli_1792))
                                        )
                                        else
                                            {1571}let pkSess_1793: bitstring = fail-any in
                                            {1572}out(c, GetEndpointRequest);
                                            {1573}in(c, (SPs_1794: bitstring,=None,UP_1795: bitstring,=pkSess_1793));
                                            {1574}new SPc_1796: bitstring;
                                            {1575}new Nc_1797: bitstring;
                                            {1576}let m1_1798: bitstring = (SPc_1796,exp(g,Nc_1797)) in
                                            {1577}out(c, (pkCli_1437,m1_1798));
                                            {1578}in(c, PartS_1799: bitstring);
                                            {1579}let Kcli_1800: bitstring = exp(PartS_1799,Nc_1797) in
                                            {1580}out(c, senc(mCli(pkCli_1437,pkSess_1793),Kcli_1800))
                            )
                            else
                                {1581}let pkDisco_1801: bitstring = fail-any in
                                {1582}let v_1802: bool = (Sess = A) in
                                (
                                    {1583}if v_1802 then
                                    (
                                        {1584}let pkSess_1803: bitstring = pub(skA) in
                                        {1585}out(c, GetEndpointRequest);
                                        {1586}in(c, (SPs_1804: bitstring,=None,UP_1805: bitstring,=pkSess_1803));
                                        {1587}new SPc_1806: bitstring;
                                        {1588}new Nc_1807: bitstring;
                                        {1589}let m1_1808: bitstring = (SPc_1806,exp(g,Nc_1807)) in
                                        {1590}out(c, (pkCli_1437,m1_1808));
                                        {1591}in(c, PartS_1809: bitstring);
                                        {1592}let Kcli_1810: bitstring = exp(PartS_1809,Nc_1807) in
                                        {1593}out(c, senc(mCli(pkCli_1437,pkSess_1803),Kcli_1810))
                                    )
                                    else
                                        {1594}let v_1811: bool = (Sess = B) in
                                        (
                                            {1595}if v_1811 then
                                            (
                                                {1596}let pkSess_1812: bitstring = pub(skB) in
                                                {1597}out(c, GetEndpointRequest);
                                                {1598}in(c, (SPs_1813: bitstring,=None,UP_1814: bitstring,=pkSess_1812));
                                                {1599}new SPc_1815: bitstring;
                                                {1600}new Nc_1816: bitstring;
                                                {1601}let m1_1817: bitstring = (SPc_1815,exp(g,Nc_1816)) in
                                                {1602}out(c, (pkCli_1437,m1_1817));
                                                {1603}in(c, PartS_1818: bitstring);
                                                {1604}let Kcli_1819: bitstring = exp(PartS_1818,Nc_1816) in
                                                {1605}out(c, senc(mCli(pkCli_1437,pkSess_1812),Kcli_1819))
                                            )
                                            else
                                                {1606}let v_1820: bool = (Sess = C) in
                                                (
                                                    {1607}if v_1820 then
                                                    (
                                                        {1608}let pkSess_1821: bitstring = pub(skC) in
                                                        {1609}out(c, GetEndpointRequest);
                                                        {1610}in(c, (SPs_1822: bitstring,=None,UP_1823: bitstring,=pkSess_1821));
                                                        {1611}new SPc_1824: bitstring;
                                                        {1612}new Nc_1825: bitstring;
                                                        {1613}let m1_1826: bitstring = (SPc_1824,exp(g,Nc_1825)) in
                                                        {1614}out(c, (pkCli_1437,m1_1826));
                                                        {1615}in(c, PartS_1827: bitstring);
                                                        {1616}let Kcli_1828: bitstring = exp(PartS_1827,Nc_1825) in
                                                        {1617}out(c, senc(mCli(pkCli_1437,pkSess_1821),Kcli_1828))
                                                    )
                                                    else
                                                        {1618}let pkSess_1829: bitstring = pub(skI) in
                                                        {1619}out(c, GetEndpointRequest);
                                                        {1620}in(c, (SPs_1830: bitstring,=None,UP_1831: bitstring,=pkSess_1829));
                                                        {1621}new SPc_1832: bitstring;
                                                        {1622}new Nc_1833: bitstring;
                                                        {1623}let m1_1834: bitstring = (SPc_1832,exp(g,Nc_1833)) in
                                                        {1624}out(c, (pkCli_1437,m1_1834));
                                                        {1625}in(c, PartS_1835: bitstring);
                                                        {1626}let Kcli_1836: bitstring = exp(PartS_1835,Nc_1833) in
                                                        {1627}out(c, senc(mCli(pkCli_1437,pkSess_1829),Kcli_1836))
                                                )
                                                else
                                                    {1628}let pkSess_1837: bitstring = fail-any in
                                                    {1629}out(c, GetEndpointRequest);
                                                    {1630}in(c, (SPs_1838: bitstring,=None,UP_1839: bitstring,=pkSess_1837));
                                                    {1631}new SPc_1840: bitstring;
                                                    {1632}new Nc_1841: bitstring;
                                                    {1633}let m1_1842: bitstring = (SPc_1840,exp(g,Nc_1841)) in
                                                    {1634}out(c, (pkCli_1437,m1_1842));
                                                    {1635}in(c, PartS_1843: bitstring);
                                                    {1636}let Kcli_1844: bitstring = exp(PartS_1843,Nc_1841) in
                                                    {1637}out(c, senc(mCli(pkCli_1437,pkSess_1837),Kcli_1844))
                                        )
                                        else
                                            {1638}let pkSess_1845: bitstring = fail-any in
                                            {1639}out(c, GetEndpointRequest);
                                            {1640}in(c, (SPs_1846: bitstring,=None,UP_1847: bitstring,=pkSess_1845));
                                            {1641}new SPc_1848: bitstring;
                                            {1642}new Nc_1849: bitstring;
                                            {1643}let m1_1850: bitstring = (SPc_1848,exp(g,Nc_1849)) in
                                            {1644}out(c, (pkCli_1437,m1_1850));
                                            {1645}in(c, PartS_1851: bitstring);
                                            {1646}let Kcli_1852: bitstring = exp(PartS_1851,Nc_1849) in
                                            {1647}out(c, senc(mCli(pkCli_1437,pkSess_1845),Kcli_1852))
                                )
                                else
                                    {1648}let pkSess_1853: bitstring = fail-any in
                                    {1649}out(c, GetEndpointRequest);
                                    {1650}in(c, (SPs_1854: bitstring,=None,UP_1855: bitstring,=pkSess_1853));
                                    {1651}new SPc_1856: bitstring;
                                    {1652}new Nc_1857: bitstring;
                                    {1653}let m1_1858: bitstring = (SPc_1856,exp(g,Nc_1857)) in
                                    {1654}out(c, (pkCli_1437,m1_1858));
                                    {1655}in(c, PartS_1859: bitstring);
                                    {1656}let Kcli_1860: bitstring = exp(PartS_1859,Nc_1857) in
                                    {1657}out(c, senc(mCli(pkCli_1437,pkSess_1853),Kcli_1860))
                        )
                        else
                            {1658}let skCli_1861: bitstring = skI in
                            {1659}let pkCli_1862: bitstring = pub(skCli_1861) in
                            {1660}let v_1863: bool = (Disco = A) in
                            (
                                {1661}if v_1863 then
                                (
                                    {1662}let pkDisco_1864: bitstring = pub(skA) in
                                    {1663}let v_1865: bool = (Sess = A) in
                                    (
                                        {1664}if v_1865 then
                                        (
                                            {1665}let pkSess_1866: bitstring = pub(skA) in
                                            {1666}out(c, GetEndpointRequest);
                                            {1667}in(c, (SPs_1867: bitstring,=None,UP_1868: bitstring,=pkSess_1866));
                                            {1668}new SPc_1869: bitstring;
                                            {1669}new Nc_1870: bitstring;
                                            {1670}let m1_1871: bitstring = (SPc_1869,exp(g,Nc_1870)) in
                                            {1671}out(c, (pkCli_1862,m1_1871));
                                            {1672}in(c, PartS_1872: bitstring);
                                            {1673}let Kcli_1873: bitstring = exp(PartS_1872,Nc_1870) in
                                            {1674}out(c, senc(mCli(pkCli_1862,pkSess_1866),Kcli_1873))
                                        )
                                        else
                                            {1675}let v_1874: bool = (Sess = B) in
                                            (
                                                {1676}if v_1874 then
                                                (
                                                    {1677}let pkSess_1875: bitstring = pub(skB) in
                                                    {1678}out(c, GetEndpointRequest);
                                                    {1679}in(c, (SPs_1876: bitstring,=None,UP_1877: bitstring,=pkSess_1875));
                                                    {1680}new SPc_1878: bitstring;
                                                    {1681}new Nc_1879: bitstring;
                                                    {1682}let m1_1880: bitstring = (SPc_1878,exp(g,Nc_1879)) in
                                                    {1683}out(c, (pkCli_1862,m1_1880));
                                                    {1684}in(c, PartS_1881: bitstring);
                                                    {1685}let Kcli_1882: bitstring = exp(PartS_1881,Nc_1879) in
                                                    {1686}out(c, senc(mCli(pkCli_1862,pkSess_1875),Kcli_1882))
                                                )
                                                else
                                                    {1687}let v_1883: bool = (Sess = C) in
                                                    (
                                                        {1688}if v_1883 then
                                                        (
                                                            {1689}let pkSess_1884: bitstring = pub(skC) in
                                                            {1690}out(c, GetEndpointRequest);
                                                            {1691}in(c, (SPs_1885: bitstring,=None,UP_1886: bitstring,=pkSess_1884));
                                                            {1692}new SPc_1887: bitstring;
                                                            {1693}new Nc_1888: bitstring;
                                                            {1694}let m1_1889: bitstring = (SPc_1887,exp(g,Nc_1888)) in
                                                            {1695}out(c, (pkCli_1862,m1_1889));
                                                            {1696}in(c, PartS_1890: bitstring);
                                                            {1697}let Kcli_1891: bitstring = exp(PartS_1890,Nc_1888) in
                                                            {1698}out(c, senc(mCli(pkCli_1862,pkSess_1884),Kcli_1891))
                                                        )
                                                        else
                                                            {1699}let pkSess_1892: bitstring = pub(skI) in
                                                            {1700}out(c, GetEndpointRequest);
                                                            {1701}in(c, (SPs_1893: bitstring,=None,UP_1894: bitstring,=pkSess_1892));
                                                            {1702}new SPc_1895: bitstring;
                                                            {1703}new Nc_1896: bitstring;
                                                            {1704}let m1_1897: bitstring = (SPc_1895,exp(g,Nc_1896)) in
                                                            {1705}out(c, (pkCli_1862,m1_1897));
                                                            {1706}in(c, PartS_1898: bitstring);
                                                            {1707}let Kcli_1899: bitstring = exp(PartS_1898,Nc_1896) in
                                                            {1708}out(c, senc(mCli(pkCli_1862,pkSess_1892),Kcli_1899))
                                                    )
                                                    else
                                                        {1709}let pkSess_1900: bitstring = fail-any in
                                                        {1710}out(c, GetEndpointRequest);
                                                        {1711}in(c, (SPs_1901: bitstring,=None,UP_1902: bitstring,=pkSess_1900));
                                                        {1712}new SPc_1903: bitstring;
                                                        {1713}new Nc_1904: bitstring;
                                                        {1714}let m1_1905: bitstring = (SPc_1903,exp(g,Nc_1904)) in
                                                        {1715}out(c, (pkCli_1862,m1_1905));
                                                        {1716}in(c, PartS_1906: bitstring);
                                                        {1717}let Kcli_1907: bitstring = exp(PartS_1906,Nc_1904) in
                                                        {1718}out(c, senc(mCli(pkCli_1862,pkSess_1900),Kcli_1907))
                                            )
                                            else
                                                {1719}let pkSess_1908: bitstring = fail-any in
                                                {1720}out(c, GetEndpointRequest);
                                                {1721}in(c, (SPs_1909: bitstring,=None,UP_1910: bitstring,=pkSess_1908));
                                                {1722}new SPc_1911: bitstring;
                                                {1723}new Nc_1912: bitstring;
                                                {1724}let m1_1913: bitstring = (SPc_1911,exp(g,Nc_1912)) in
                                                {1725}out(c, (pkCli_1862,m1_1913));
                                                {1726}in(c, PartS_1914: bitstring);
                                                {1727}let Kcli_1915: bitstring = exp(PartS_1914,Nc_1912) in
                                                {1728}out(c, senc(mCli(pkCli_1862,pkSess_1908),Kcli_1915))
                                    )
                                    else
                                        {1729}let pkSess_1916: bitstring = fail-any in
                                        {1730}out(c, GetEndpointRequest);
                                        {1731}in(c, (SPs_1917: bitstring,=None,UP_1918: bitstring,=pkSess_1916));
                                        {1732}new SPc_1919: bitstring;
                                        {1733}new Nc_1920: bitstring;
                                        {1734}let m1_1921: bitstring = (SPc_1919,exp(g,Nc_1920)) in
                                        {1735}out(c, (pkCli_1862,m1_1921));
                                        {1736}in(c, PartS_1922: bitstring);
                                        {1737}let Kcli_1923: bitstring = exp(PartS_1922,Nc_1920) in
                                        {1738}out(c, senc(mCli(pkCli_1862,pkSess_1916),Kcli_1923))
                                )
                                else
                                    {1739}let v_1924: bool = (Disco = B) in
                                    (
                                        {1740}if v_1924 then
                                        (
                                            {1741}let pkDisco_1925: bitstring = pub(skB) in
                                            {1742}let v_1926: bool = (Sess = A) in
                                            (
                                                {1743}if v_1926 then
                                                (
                                                    {1744}let pkSess_1927: bitstring = pub(skA) in
                                                    {1745}out(c, GetEndpointRequest);
                                                    {1746}in(c, (SPs_1928: bitstring,=None,UP_1929: bitstring,=pkSess_1927));
                                                    {1747}new SPc_1930: bitstring;
                                                    {1748}new Nc_1931: bitstring;
                                                    {1749}let m1_1932: bitstring = (SPc_1930,exp(g,Nc_1931)) in
                                                    {1750}out(c, (pkCli_1862,m1_1932));
                                                    {1751}in(c, PartS_1933: bitstring);
                                                    {1752}let Kcli_1934: bitstring = exp(PartS_1933,Nc_1931) in
                                                    {1753}out(c, senc(mCli(pkCli_1862,pkSess_1927),Kcli_1934))
                                                )
                                                else
                                                    {1754}let v_1935: bool = (Sess = B) in
                                                    (
                                                        {1755}if v_1935 then
                                                        (
                                                            {1756}let pkSess_1936: bitstring = pub(skB) in
                                                            {1757}out(c, GetEndpointRequest);
                                                            {1758}in(c, (SPs_1937: bitstring,=None,UP_1938: bitstring,=pkSess_1936));
                                                            {1759}new SPc_1939: bitstring;
                                                            {1760}new Nc_1940: bitstring;
                                                            {1761}let m1_1941: bitstring = (SPc_1939,exp(g,Nc_1940)) in
                                                            {1762}out(c, (pkCli_1862,m1_1941));
                                                            {1763}in(c, PartS_1942: bitstring);
                                                            {1764}let Kcli_1943: bitstring = exp(PartS_1942,Nc_1940) in
                                                            {1765}out(c, senc(mCli(pkCli_1862,pkSess_1936),Kcli_1943))
                                                        )
                                                        else
                                                            {1766}let v_1944: bool = (Sess = C) in
                                                            (
                                                                {1767}if v_1944 then
                                                                (
                                                                    {1768}let pkSess_1945: bitstring = pub(skC) in
                                                                    {1769}out(c, GetEndpointRequest);
                                                                    {1770}in(c, (SPs_1946: bitstring,=None,UP_1947: bitstring,=pkSess_1945));
                                                                    {1771}new SPc_1948: bitstring;
                                                                    {1772}new Nc_1949: bitstring;
                                                                    {1773}let m1_1950: bitstring = (SPc_1948,exp(g,Nc_1949)) in
                                                                    {1774}out(c, (pkCli_1862,m1_1950));
                                                                    {1775}in(c, PartS_1951: bitstring);
                                                                    {1776}let Kcli_1952: bitstring = exp(PartS_1951,Nc_1949) in
                                                                    {1777}out(c, senc(mCli(pkCli_1862,pkSess_1945),Kcli_1952))
                                                                )
                                                                else
                                                                    {1778}let pkSess_1953: bitstring = pub(skI) in
                                                                    {1779}out(c, GetEndpointRequest);
                                                                    {1780}in(c, (SPs_1954: bitstring,=None,UP_1955: bitstring,=pkSess_1953));
                                                                    {1781}new SPc_1956: bitstring;
                                                                    {1782}new Nc_1957: bitstring;
                                                                    {1783}let m1_1958: bitstring = (SPc_1956,exp(g,Nc_1957)) in
                                                                    {1784}out(c, (pkCli_1862,m1_1958));
                                                                    {1785}in(c, PartS_1959: bitstring);
                                                                    {1786}let Kcli_1960: bitstring = exp(PartS_1959,Nc_1957) in
                                                                    {1787}out(c, senc(mCli(pkCli_1862,pkSess_1953),Kcli_1960))
                                                            )
                                                            else
                                                                {1788}let pkSess_1961: bitstring = fail-any in
                                                                {1789}out(c, GetEndpointRequest);
                                                                {1790}in(c, (SPs_1962: bitstring,=None,UP_1963: bitstring,=pkSess_1961));
                                                                {1791}new SPc_1964: bitstring;
                                                                {1792}new Nc_1965: bitstring;
                                                                {1793}let m1_1966: bitstring = (SPc_1964,exp(g,Nc_1965)) in
                                                                {1794}out(c, (pkCli_1862,m1_1966));
                                                                {1795}in(c, PartS_1967: bitstring);
                                                                {1796}let Kcli_1968: bitstring = exp(PartS_1967,Nc_1965) in
                                                                {1797}out(c, senc(mCli(pkCli_1862,pkSess_1961),Kcli_1968))
                                                    )
                                                    else
                                                        {1798}let pkSess_1969: bitstring = fail-any in
                                                        {1799}out(c, GetEndpointRequest);
                                                        {1800}in(c, (SPs_1970: bitstring,=None,UP_1971: bitstring,=pkSess_1969));
                                                        {1801}new SPc_1972: bitstring;
                                                        {1802}new Nc_1973: bitstring;
                                                        {1803}let m1_1974: bitstring = (SPc_1972,exp(g,Nc_1973)) in
                                                        {1804}out(c, (pkCli_1862,m1_1974));
                                                        {1805}in(c, PartS_1975: bitstring);
                                                        {1806}let Kcli_1976: bitstring = exp(PartS_1975,Nc_1973) in
                                                        {1807}out(c, senc(mCli(pkCli_1862,pkSess_1969),Kcli_1976))
                                            )
                                            else
                                                {1808}let pkSess_1977: bitstring = fail-any in
                                                {1809}out(c, GetEndpointRequest);
                                                {1810}in(c, (SPs_1978: bitstring,=None,UP_1979: bitstring,=pkSess_1977));
                                                {1811}new SPc_1980: bitstring;
                                                {1812}new Nc_1981: bitstring;
                                                {1813}let m1_1982: bitstring = (SPc_1980,exp(g,Nc_1981)) in
                                                {1814}out(c, (pkCli_1862,m1_1982));
                                                {1815}in(c, PartS_1983: bitstring);
                                                {1816}let Kcli_1984: bitstring = exp(PartS_1983,Nc_1981) in
                                                {1817}out(c, senc(mCli(pkCli_1862,pkSess_1977),Kcli_1984))
                                        )
                                        else
                                            {1818}let v_1985: bool = (Disco = C) in
                                            (
                                                {1819}if v_1985 then
                                                (
                                                    {1820}let pkDisco_1986: bitstring = pub(skC) in
                                                    {1821}let v_1987: bool = (Sess = A) in
                                                    (
                                                        {1822}if v_1987 then
                                                        (
                                                            {1823}let pkSess_1988: bitstring = pub(skA) in
                                                            {1824}out(c, GetEndpointRequest);
                                                            {1825}in(c, (SPs_1989: bitstring,=None,UP_1990: bitstring,=pkSess_1988));
                                                            {1826}new SPc_1991: bitstring;
                                                            {1827}new Nc_1992: bitstring;
                                                            {1828}let m1_1993: bitstring = (SPc_1991,exp(g,Nc_1992)) in
                                                            {1829}out(c, (pkCli_1862,m1_1993));
                                                            {1830}in(c, PartS_1994: bitstring);
                                                            {1831}let Kcli_1995: bitstring = exp(PartS_1994,Nc_1992) in
                                                            {1832}out(c, senc(mCli(pkCli_1862,pkSess_1988),Kcli_1995))
                                                        )
                                                        else
                                                            {1833}let v_1996: bool = (Sess = B) in
                                                            (
                                                                {1834}if v_1996 then
                                                                (
                                                                    {1835}let pkSess_1997: bitstring = pub(skB) in
                                                                    {1836}out(c, GetEndpointRequest);
                                                                    {1837}in(c, (SPs_1998: bitstring,=None,UP_1999: bitstring,=pkSess_1997));
                                                                    {1838}new SPc_2000: bitstring;
                                                                    {1839}new Nc_2001: bitstring;
                                                                    {1840}let m1_2002: bitstring = (SPc_2000,exp(g,Nc_2001)) in
                                                                    {1841}out(c, (pkCli_1862,m1_2002));
                                                                    {1842}in(c, PartS_2003: bitstring);
                                                                    {1843}let Kcli_2004: bitstring = exp(PartS_2003,Nc_2001) in
                                                                    {1844}out(c, senc(mCli(pkCli_1862,pkSess_1997),Kcli_2004))
                                                                )
                                                                else
                                                                    {1845}let v_2005: bool = (Sess = C) in
                                                                    (
                                                                        {1846}if v_2005 then
                                                                        (
                                                                            {1847}let pkSess_2006: bitstring = pub(skC) in
                                                                            {1848}out(c, GetEndpointRequest);
                                                                            {1849}in(c, (SPs_2007: bitstring,=None,UP_2008: bitstring,=pkSess_2006));
                                                                            {1850}new SPc_2009: bitstring;
                                                                            {1851}new Nc_2010: bitstring;
                                                                            {1852}let m1_2011: bitstring = (SPc_2009,exp(g,Nc_2010)) in
                                                                            {1853}out(c, (pkCli_1862,m1_2011));
                                                                            {1854}in(c, PartS_2012: bitstring);
                                                                            {1855}let Kcli_2013: bitstring = exp(PartS_2012,Nc_2010) in
                                                                            {1856}out(c, senc(mCli(pkCli_1862,pkSess_2006),Kcli_2013))
                                                                        )
                                                                        else
                                                                            {1857}let pkSess_2014: bitstring = pub(skI) in
                                                                            {1858}out(c, GetEndpointRequest);
                                                                            {1859}in(c, (SPs_2015: bitstring,=None,UP_2016: bitstring,=pkSess_2014));
                                                                            {1860}new SPc_2017: bitstring;
                                                                            {1861}new Nc_2018: bitstring;
                                                                            {1862}let m1_2019: bitstring = (SPc_2017,exp(g,Nc_2018)) in
                                                                            {1863}out(c, (pkCli_1862,m1_2019));
                                                                            {1864}in(c, PartS_2020: bitstring);
                                                                            {1865}let Kcli_2021: bitstring = exp(PartS_2020,Nc_2018) in
                                                                            {1866}out(c, senc(mCli(pkCli_1862,pkSess_2014),Kcli_2021))
                                                                    )
                                                                    else
                                                                        {1867}let pkSess_2022: bitstring = fail-any in
                                                                        {1868}out(c, GetEndpointRequest);
                                                                        {1869}in(c, (SPs_2023: bitstring,=None,UP_2024: bitstring,=pkSess_2022));
                                                                        {1870}new SPc_2025: bitstring;
                                                                        {1871}new Nc_2026: bitstring;
                                                                        {1872}let m1_2027: bitstring = (SPc_2025,exp(g,Nc_2026)) in
                                                                        {1873}out(c, (pkCli_1862,m1_2027));
                                                                        {1874}in(c, PartS_2028: bitstring);
                                                                        {1875}let Kcli_2029: bitstring = exp(PartS_2028,Nc_2026) in
                                                                        {1876}out(c, senc(mCli(pkCli_1862,pkSess_2022),Kcli_2029))
                                                            )
                                                            else
                                                                {1877}let pkSess_2030: bitstring = fail-any in
                                                                {1878}out(c, GetEndpointRequest);
                                                                {1879}in(c, (SPs_2031: bitstring,=None,UP_2032: bitstring,=pkSess_2030));
                                                                {1880}new SPc_2033: bitstring;
                                                                {1881}new Nc_2034: bitstring;
                                                                {1882}let m1_2035: bitstring = (SPc_2033,exp(g,Nc_2034)) in
                                                                {1883}out(c, (pkCli_1862,m1_2035));
                                                                {1884}in(c, PartS_2036: bitstring);
                                                                {1885}let Kcli_2037: bitstring = exp(PartS_2036,Nc_2034) in
                                                                {1886}out(c, senc(mCli(pkCli_1862,pkSess_2030),Kcli_2037))
                                                    )
                                                    else
                                                        {1887}let pkSess_2038: bitstring = fail-any in
                                                        {1888}out(c, GetEndpointRequest);
                                                        {1889}in(c, (SPs_2039: bitstring,=None,UP_2040: bitstring,=pkSess_2038));
                                                        {1890}new SPc_2041: bitstring;
                                                        {1891}new Nc_2042: bitstring;
                                                        {1892}let m1_2043: bitstring = (SPc_2041,exp(g,Nc_2042)) in
                                                        {1893}out(c, (pkCli_1862,m1_2043));
                                                        {1894}in(c, PartS_2044: bitstring);
                                                        {1895}let Kcli_2045: bitstring = exp(PartS_2044,Nc_2042) in
                                                        {1896}out(c, senc(mCli(pkCli_1862,pkSess_2038),Kcli_2045))
                                                )
                                                else
                                                    {1897}let pkDisco_2046: bitstring = pub(skI) in
                                                    {1898}let v_2047: bool = (Sess = A) in
                                                    (
                                                        {1899}if v_2047 then
                                                        (
                                                            {1900}let pkSess_2048: bitstring = pub(skA) in
                                                            {1901}out(c, GetEndpointRequest);
                                                            {1902}in(c, (SPs_2049: bitstring,=None,UP_2050: bitstring,=pkSess_2048));
                                                            {1903}new SPc_2051: bitstring;
                                                            {1904}new Nc_2052: bitstring;
                                                            {1905}let m1_2053: bitstring = (SPc_2051,exp(g,Nc_2052)) in
                                                            {1906}out(c, (pkCli_1862,m1_2053));
                                                            {1907}in(c, PartS_2054: bitstring);
                                                            {1908}let Kcli_2055: bitstring = exp(PartS_2054,Nc_2052) in
                                                            {1909}out(c, senc(mCli(pkCli_1862,pkSess_2048),Kcli_2055))
                                                        )
                                                        else
                                                            {1910}let v_2056: bool = (Sess = B) in
                                                            (
                                                                {1911}if v_2056 then
                                                                (
                                                                    {1912}let pkSess_2057: bitstring = pub(skB) in
                                                                    {1913}out(c, GetEndpointRequest);
                                                                    {1914}in(c, (SPs_2058: bitstring,=None,UP_2059: bitstring,=pkSess_2057));
                                                                    {1915}new SPc_2060: bitstring;
                                                                    {1916}new Nc_2061: bitstring;
                                                                    {1917}let m1_2062: bitstring = (SPc_2060,exp(g,Nc_2061)) in
                                                                    {1918}out(c, (pkCli_1862,m1_2062));
                                                                    {1919}in(c, PartS_2063: bitstring);
                                                                    {1920}let Kcli_2064: bitstring = exp(PartS_2063,Nc_2061) in
                                                                    {1921}out(c, senc(mCli(pkCli_1862,pkSess_2057),Kcli_2064))
                                                                )
                                                                else
                                                                    {1922}let v_2065: bool = (Sess = C) in
                                                                    (
                                                                        {1923}if v_2065 then
                                                                        (
                                                                            {1924}let pkSess_2066: bitstring = pub(skC) in
                                                                            {1925}out(c, GetEndpointRequest);
                                                                            {1926}in(c, (SPs_2067: bitstring,=None,UP_2068: bitstring,=pkSess_2066));
                                                                            {1927}new SPc_2069: bitstring;
                                                                            {1928}new Nc_2070: bitstring;
                                                                            {1929}let m1_2071: bitstring = (SPc_2069,exp(g,Nc_2070)) in
                                                                            {1930}out(c, (pkCli_1862,m1_2071));
                                                                            {1931}in(c, PartS_2072: bitstring);
                                                                            {1932}let Kcli_2073: bitstring = exp(PartS_2072,Nc_2070) in
                                                                            {1933}out(c, senc(mCli(pkCli_1862,pkSess_2066),Kcli_2073))
                                                                        )
                                                                        else
                                                                            {1934}let pkSess_2074: bitstring = pub(skI) in
                                                                            {1935}out(c, GetEndpointRequest);
                                                                            {1936}in(c, (SPs_2075: bitstring,=None,UP_2076: bitstring,=pkSess_2074));
                                                                            {1937}new SPc_2077: bitstring;
                                                                            {1938}new Nc_2078: bitstring;
                                                                            {1939}let m1_2079: bitstring = (SPc_2077,exp(g,Nc_2078)) in
                                                                            {1940}out(c, (pkCli_1862,m1_2079));
                                                                            {1941}in(c, PartS_2080: bitstring);
                                                                            {1942}let Kcli_2081: bitstring = exp(PartS_2080,Nc_2078) in
                                                                            {1943}out(c, senc(mCli(pkCli_1862,pkSess_2074),Kcli_2081))
                                                                    )
                                                                    else
                                                                        {1944}let pkSess_2082: bitstring = fail-any in
                                                                        {1945}out(c, GetEndpointRequest);
                                                                        {1946}in(c, (SPs_2083: bitstring,=None,UP_2084: bitstring,=pkSess_2082));
                                                                        {1947}new SPc_2085: bitstring;
                                                                        {1948}new Nc_2086: bitstring;
                                                                        {1949}let m1_2087: bitstring = (SPc_2085,exp(g,Nc_2086)) in
                                                                        {1950}out(c, (pkCli_1862,m1_2087));
                                                                        {1951}in(c, PartS_2088: bitstring);
                                                                        {1952}let Kcli_2089: bitstring = exp(PartS_2088,Nc_2086) in
                                                                        {1953}out(c, senc(mCli(pkCli_1862,pkSess_2082),Kcli_2089))
                                                            )
                                                            else
                                                                {1954}let pkSess_2090: bitstring = fail-any in
                                                                {1955}out(c, GetEndpointRequest);
                                                                {1956}in(c, (SPs_2091: bitstring,=None,UP_2092: bitstring,=pkSess_2090));
                                                                {1957}new SPc_2093: bitstring;
                                                                {1958}new Nc_2094: bitstring;
                                                                {1959}let m1_2095: bitstring = (SPc_2093,exp(g,Nc_2094)) in
                                                                {1960}out(c, (pkCli_1862,m1_2095));
                                                                {1961}in(c, PartS_2096: bitstring);
                                                                {1962}let Kcli_2097: bitstring = exp(PartS_2096,Nc_2094) in
                                                                {1963}out(c, senc(mCli(pkCli_1862,pkSess_2090),Kcli_2097))
                                                    )
                                                    else
                                                        {1964}let pkSess_2098: bitstring = fail-any in
                                                        {1965}out(c, GetEndpointRequest);
                                                        {1966}in(c, (SPs_2099: bitstring,=None,UP_2100: bitstring,=pkSess_2098));
                                                        {1967}new SPc_2101: bitstring;
                                                        {1968}new Nc_2102: bitstring;
                                                        {1969}let m1_2103: bitstring = (SPc_2101,exp(g,Nc_2102)) in
                                                        {1970}out(c, (pkCli_1862,m1_2103));
                                                        {1971}in(c, PartS_2104: bitstring);
                                                        {1972}let Kcli_2105: bitstring = exp(PartS_2104,Nc_2102) in
                                                        {1973}out(c, senc(mCli(pkCli_1862,pkSess_2098),Kcli_2105))
                                            )
                                            else
                                                {1974}let pkDisco_2106: bitstring = fail-any in
                                                {1975}let v_2107: bool = (Sess = A) in
                                                (
                                                    {1976}if v_2107 then
                                                    (
                                                        {1977}let pkSess_2108: bitstring = pub(skA) in
                                                        {1978}out(c, GetEndpointRequest);
                                                        {1979}in(c, (SPs_2109: bitstring,=None,UP_2110: bitstring,=pkSess_2108));
                                                        {1980}new SPc_2111: bitstring;
                                                        {1981}new Nc_2112: bitstring;
                                                        {1982}let m1_2113: bitstring = (SPc_2111,exp(g,Nc_2112)) in
                                                        {1983}out(c, (pkCli_1862,m1_2113));
                                                        {1984}in(c, PartS_2114: bitstring);
                                                        {1985}let Kcli_2115: bitstring = exp(PartS_2114,Nc_2112) in
                                                        {1986}out(c, senc(mCli(pkCli_1862,pkSess_2108),Kcli_2115))
                                                    )
                                                    else
                                                        {1987}let v_2116: bool = (Sess = B) in
                                                        (
                                                            {1988}if v_2116 then
                                                            (
                                                                {1989}let pkSess_2117: bitstring = pub(skB) in
                                                                {1990}out(c, GetEndpointRequest);
                                                                {1991}in(c, (SPs_2118: bitstring,=None,UP_2119: bitstring,=pkSess_2117));
                                                                {1992}new SPc_2120: bitstring;
                                                                {1993}new Nc_2121: bitstring;
                                                                {1994}let m1_2122: bitstring = (SPc_2120,exp(g,Nc_2121)) in
                                                                {1995}out(c, (pkCli_1862,m1_2122));
                                                                {1996}in(c, PartS_2123: bitstring);
                                                                {1997}let Kcli_2124: bitstring = exp(PartS_2123,Nc_2121) in
                                                                {1998}out(c, senc(mCli(pkCli_1862,pkSess_2117),Kcli_2124))
                                                            )
                                                            else
                                                                {1999}let v_2125: bool = (Sess = C) in
                                                                (
                                                                    {2000}if v_2125 then
                                                                    (
                                                                        {2001}let pkSess_2126: bitstring = pub(skC) in
                                                                        {2002}out(c, GetEndpointRequest);
                                                                        {2003}in(c, (SPs_2127: bitstring,=None,UP_2128: bitstring,=pkSess_2126));
                                                                        {2004}new SPc_2129: bitstring;
                                                                        {2005}new Nc_2130: bitstring;
                                                                        {2006}let m1_2131: bitstring = (SPc_2129,exp(g,Nc_2130)) in
                                                                        {2007}out(c, (pkCli_1862,m1_2131));
                                                                        {2008}in(c, PartS_2132: bitstring);
                                                                        {2009}let Kcli_2133: bitstring = exp(PartS_2132,Nc_2130) in
                                                                        {2010}out(c, senc(mCli(pkCli_1862,pkSess_2126),Kcli_2133))
                                                                    )
                                                                    else
                                                                        {2011}let pkSess_2134: bitstring = pub(skI) in
                                                                        {2012}out(c, GetEndpointRequest);
                                                                        {2013}in(c, (SPs_2135: bitstring,=None,UP_2136: bitstring,=pkSess_2134));
                                                                        {2014}new SPc_2137: bitstring;
                                                                        {2015}new Nc_2138: bitstring;
                                                                        {2016}let m1_2139: bitstring = (SPc_2137,exp(g,Nc_2138)) in
                                                                        {2017}out(c, (pkCli_1862,m1_2139));
                                                                        {2018}in(c, PartS_2140: bitstring);
                                                                        {2019}let Kcli_2141: bitstring = exp(PartS_2140,Nc_2138) in
                                                                        {2020}out(c, senc(mCli(pkCli_1862,pkSess_2134),Kcli_2141))
                                                                )
                                                                else
                                                                    {2021}let pkSess_2142: bitstring = fail-any in
                                                                    {2022}out(c, GetEndpointRequest);
                                                                    {2023}in(c, (SPs_2143: bitstring,=None,UP_2144: bitstring,=pkSess_2142));
                                                                    {2024}new SPc_2145: bitstring;
                                                                    {2025}new Nc_2146: bitstring;
                                                                    {2026}let m1_2147: bitstring = (SPc_2145,exp(g,Nc_2146)) in
                                                                    {2027}out(c, (pkCli_1862,m1_2147));
                                                                    {2028}in(c, PartS_2148: bitstring);
                                                                    {2029}let Kcli_2149: bitstring = exp(PartS_2148,Nc_2146) in
                                                                    {2030}out(c, senc(mCli(pkCli_1862,pkSess_2142),Kcli_2149))
                                                        )
                                                        else
                                                            {2031}let pkSess_2150: bitstring = fail-any in
                                                            {2032}out(c, GetEndpointRequest);
                                                            {2033}in(c, (SPs_2151: bitstring,=None,UP_2152: bitstring,=pkSess_2150));
                                                            {2034}new SPc_2153: bitstring;
                                                            {2035}new Nc_2154: bitstring;
                                                            {2036}let m1_2155: bitstring = (SPc_2153,exp(g,Nc_2154)) in
                                                            {2037}out(c, (pkCli_1862,m1_2155));
                                                            {2038}in(c, PartS_2156: bitstring);
                                                            {2039}let Kcli_2157: bitstring = exp(PartS_2156,Nc_2154) in
                                                            {2040}out(c, senc(mCli(pkCli_1862,pkSess_2150),Kcli_2157))
                                                )
                                                else
                                                    {2041}let pkSess_2158: bitstring = fail-any in
                                                    {2042}out(c, GetEndpointRequest);
                                                    {2043}in(c, (SPs_2159: bitstring,=None,UP_2160: bitstring,=pkSess_2158));
                                                    {2044}new SPc_2161: bitstring;
                                                    {2045}new Nc_2162: bitstring;
                                                    {2046}let m1_2163: bitstring = (SPc_2161,exp(g,Nc_2162)) in
                                                    {2047}out(c, (pkCli_1862,m1_2163));
                                                    {2048}in(c, PartS_2164: bitstring);
                                                    {2049}let Kcli_2165: bitstring = exp(PartS_2164,Nc_2162) in
                                                    {2050}out(c, senc(mCli(pkCli_1862,pkSess_2158),Kcli_2165))
                                    )
                                    else
                                        {2051}let pkDisco_2166: bitstring = fail-any in
                                        {2052}let v_2167: bool = (Sess = A) in
                                        (
                                            {2053}if v_2167 then
                                            (
                                                {2054}let pkSess_2168: bitstring = pub(skA) in
                                                {2055}out(c, GetEndpointRequest);
                                                {2056}in(c, (SPs_2169: bitstring,=None,UP_2170: bitstring,=pkSess_2168));
                                                {2057}new SPc_2171: bitstring;
                                                {2058}new Nc_2172: bitstring;
                                                {2059}let m1_2173: bitstring = (SPc_2171,exp(g,Nc_2172)) in
                                                {2060}out(c, (pkCli_1862,m1_2173));
                                                {2061}in(c, PartS_2174: bitstring);
                                                {2062}let Kcli_2175: bitstring = exp(PartS_2174,Nc_2172) in
                                                {2063}out(c, senc(mCli(pkCli_1862,pkSess_2168),Kcli_2175))
                                            )
                                            else
                                                {2064}let v_2176: bool = (Sess = B) in
                                                (
                                                    {2065}if v_2176 then
                                                    (
                                                        {2066}let pkSess_2177: bitstring = pub(skB) in
                                                        {2067}out(c, GetEndpointRequest);
                                                        {2068}in(c, (SPs_2178: bitstring,=None,UP_2179: bitstring,=pkSess_2177));
                                                        {2069}new SPc_2180: bitstring;
                                                        {2070}new Nc_2181: bitstring;
                                                        {2071}let m1_2182: bitstring = (SPc_2180,exp(g,Nc_2181)) in
                                                        {2072}out(c, (pkCli_1862,m1_2182));
                                                        {2073}in(c, PartS_2183: bitstring);
                                                        {2074}let Kcli_2184: bitstring = exp(PartS_2183,Nc_2181) in
                                                        {2075}out(c, senc(mCli(pkCli_1862,pkSess_2177),Kcli_2184))
                                                    )
                                                    else
                                                        {2076}let v_2185: bool = (Sess = C) in
                                                        (
                                                            {2077}if v_2185 then
                                                            (
                                                                {2078}let pkSess_2186: bitstring = pub(skC) in
                                                                {2079}out(c, GetEndpointRequest);
                                                                {2080}in(c, (SPs_2187: bitstring,=None,UP_2188: bitstring,=pkSess_2186));
                                                                {2081}new SPc_2189: bitstring;
                                                                {2082}new Nc_2190: bitstring;
                                                                {2083}let m1_2191: bitstring = (SPc_2189,exp(g,Nc_2190)) in
                                                                {2084}out(c, (pkCli_1862,m1_2191));
                                                                {2085}in(c, PartS_2192: bitstring);
                                                                {2086}let Kcli_2193: bitstring = exp(PartS_2192,Nc_2190) in
                                                                {2087}out(c, senc(mCli(pkCli_1862,pkSess_2186),Kcli_2193))
                                                            )
                                                            else
                                                                {2088}let pkSess_2194: bitstring = pub(skI) in
                                                                {2089}out(c, GetEndpointRequest);
                                                                {2090}in(c, (SPs_2195: bitstring,=None,UP_2196: bitstring,=pkSess_2194));
                                                                {2091}new SPc_2197: bitstring;
                                                                {2092}new Nc_2198: bitstring;
                                                                {2093}let m1_2199: bitstring = (SPc_2197,exp(g,Nc_2198)) in
                                                                {2094}out(c, (pkCli_1862,m1_2199));
                                                                {2095}in(c, PartS_2200: bitstring);
                                                                {2096}let Kcli_2201: bitstring = exp(PartS_2200,Nc_2198) in
                                                                {2097}out(c, senc(mCli(pkCli_1862,pkSess_2194),Kcli_2201))
                                                        )
                                                        else
                                                            {2098}let pkSess_2202: bitstring = fail-any in
                                                            {2099}out(c, GetEndpointRequest);
                                                            {2100}in(c, (SPs_2203: bitstring,=None,UP_2204: bitstring,=pkSess_2202));
                                                            {2101}new SPc_2205: bitstring;
                                                            {2102}new Nc_2206: bitstring;
                                                            {2103}let m1_2207: bitstring = (SPc_2205,exp(g,Nc_2206)) in
                                                            {2104}out(c, (pkCli_1862,m1_2207));
                                                            {2105}in(c, PartS_2208: bitstring);
                                                            {2106}let Kcli_2209: bitstring = exp(PartS_2208,Nc_2206) in
                                                            {2107}out(c, senc(mCli(pkCli_1862,pkSess_2202),Kcli_2209))
                                                )
                                                else
                                                    {2108}let pkSess_2210: bitstring = fail-any in
                                                    {2109}out(c, GetEndpointRequest);
                                                    {2110}in(c, (SPs_2211: bitstring,=None,UP_2212: bitstring,=pkSess_2210));
                                                    {2111}new SPc_2213: bitstring;
                                                    {2112}new Nc_2214: bitstring;
                                                    {2113}let m1_2215: bitstring = (SPc_2213,exp(g,Nc_2214)) in
                                                    {2114}out(c, (pkCli_1862,m1_2215));
                                                    {2115}in(c, PartS_2216: bitstring);
                                                    {2116}let Kcli_2217: bitstring = exp(PartS_2216,Nc_2214) in
                                                    {2117}out(c, senc(mCli(pkCli_1862,pkSess_2210),Kcli_2217))
                                        )
                                        else
                                            {2118}let pkSess_2218: bitstring = fail-any in
                                            {2119}out(c, GetEndpointRequest);
                                            {2120}in(c, (SPs_2219: bitstring,=None,UP_2220: bitstring,=pkSess_2218));
                                            {2121}new SPc_2221: bitstring;
                                            {2122}new Nc_2222: bitstring;
                                            {2123}let m1_2223: bitstring = (SPc_2221,exp(g,Nc_2222)) in
                                            {2124}out(c, (pkCli_1862,m1_2223));
                                            {2125}in(c, PartS_2224: bitstring);
                                            {2126}let Kcli_2225: bitstring = exp(PartS_2224,Nc_2222) in
                                            {2127}out(c, senc(mCli(pkCli_1862,pkSess_2218),Kcli_2225))
                            )
                            else
                                {2128}let pkDisco_2226: bitstring = fail-any in
                                {2129}let v_2227: bool = (Sess = A) in
                                (
                                    {2130}if v_2227 then
                                    (
                                        {2131}let pkSess_2228: bitstring = pub(skA) in
                                        {2132}out(c, GetEndpointRequest);
                                        {2133}in(c, (SPs_2229: bitstring,=None,UP_2230: bitstring,=pkSess_2228));
                                        {2134}new SPc_2231: bitstring;
                                        {2135}new Nc_2232: bitstring;
                                        {2136}let m1_2233: bitstring = (SPc_2231,exp(g,Nc_2232)) in
                                        {2137}out(c, (pkCli_1862,m1_2233));
                                        {2138}in(c, PartS_2234: bitstring);
                                        {2139}let Kcli_2235: bitstring = exp(PartS_2234,Nc_2232) in
                                        {2140}out(c, senc(mCli(pkCli_1862,pkSess_2228),Kcli_2235))
                                    )
                                    else
                                        {2141}let v_2236: bool = (Sess = B) in
                                        (
                                            {2142}if v_2236 then
                                            (
                                                {2143}let pkSess_2237: bitstring = pub(skB) in
                                                {2144}out(c, GetEndpointRequest);
                                                {2145}in(c, (SPs_2238: bitstring,=None,UP_2239: bitstring,=pkSess_2237));
                                                {2146}new SPc_2240: bitstring;
                                                {2147}new Nc_2241: bitstring;
                                                {2148}let m1_2242: bitstring = (SPc_2240,exp(g,Nc_2241)) in
                                                {2149}out(c, (pkCli_1862,m1_2242));
                                                {2150}in(c, PartS_2243: bitstring);
                                                {2151}let Kcli_2244: bitstring = exp(PartS_2243,Nc_2241) in
                                                {2152}out(c, senc(mCli(pkCli_1862,pkSess_2237),Kcli_2244))
                                            )
                                            else
                                                {2153}let v_2245: bool = (Sess = C) in
                                                (
                                                    {2154}if v_2245 then
                                                    (
                                                        {2155}let pkSess_2246: bitstring = pub(skC) in
                                                        {2156}out(c, GetEndpointRequest);
                                                        {2157}in(c, (SPs_2247: bitstring,=None,UP_2248: bitstring,=pkSess_2246));
                                                        {2158}new SPc_2249: bitstring;
                                                        {2159}new Nc_2250: bitstring;
                                                        {2160}let m1_2251: bitstring = (SPc_2249,exp(g,Nc_2250)) in
                                                        {2161}out(c, (pkCli_1862,m1_2251));
                                                        {2162}in(c, PartS_2252: bitstring);
                                                        {2163}let Kcli_2253: bitstring = exp(PartS_2252,Nc_2250) in
                                                        {2164}out(c, senc(mCli(pkCli_1862,pkSess_2246),Kcli_2253))
                                                    )
                                                    else
                                                        {2165}let pkSess_2254: bitstring = pub(skI) in
                                                        {2166}out(c, GetEndpointRequest);
                                                        {2167}in(c, (SPs_2255: bitstring,=None,UP_2256: bitstring,=pkSess_2254));
                                                        {2168}new SPc_2257: bitstring;
                                                        {2169}new Nc_2258: bitstring;
                                                        {2170}let m1_2259: bitstring = (SPc_2257,exp(g,Nc_2258)) in
                                                        {2171}out(c, (pkCli_1862,m1_2259));
                                                        {2172}in(c, PartS_2260: bitstring);
                                                        {2173}let Kcli_2261: bitstring = exp(PartS_2260,Nc_2258) in
                                                        {2174}out(c, senc(mCli(pkCli_1862,pkSess_2254),Kcli_2261))
                                                )
                                                else
                                                    {2175}let pkSess_2262: bitstring = fail-any in
                                                    {2176}out(c, GetEndpointRequest);
                                                    {2177}in(c, (SPs_2263: bitstring,=None,UP_2264: bitstring,=pkSess_2262));
                                                    {2178}new SPc_2265: bitstring;
                                                    {2179}new Nc_2266: bitstring;
                                                    {2180}let m1_2267: bitstring = (SPc_2265,exp(g,Nc_2266)) in
                                                    {2181}out(c, (pkCli_1862,m1_2267));
                                                    {2182}in(c, PartS_2268: bitstring);
                                                    {2183}let Kcli_2269: bitstring = exp(PartS_2268,Nc_2266) in
                                                    {2184}out(c, senc(mCli(pkCli_1862,pkSess_2262),Kcli_2269))
                                        )
                                        else
                                            {2185}let pkSess_2270: bitstring = fail-any in
                                            {2186}out(c, GetEndpointRequest);
                                            {2187}in(c, (SPs_2271: bitstring,=None,UP_2272: bitstring,=pkSess_2270));
                                            {2188}new SPc_2273: bitstring;
                                            {2189}new Nc_2274: bitstring;
                                            {2190}let m1_2275: bitstring = (SPc_2273,exp(g,Nc_2274)) in
                                            {2191}out(c, (pkCli_1862,m1_2275));
                                            {2192}in(c, PartS_2276: bitstring);
                                            {2193}let Kcli_2277: bitstring = exp(PartS_2276,Nc_2274) in
                                            {2194}out(c, senc(mCli(pkCli_1862,pkSess_2270),Kcli_2277))
                                )
                                else
                                    {2195}let pkSess_2278: bitstring = fail-any in
                                    {2196}out(c, GetEndpointRequest);
                                    {2197}in(c, (SPs_2279: bitstring,=None,UP_2280: bitstring,=pkSess_2278));
                                    {2198}new SPc_2281: bitstring;
                                    {2199}new Nc_2282: bitstring;
                                    {2200}let m1_2283: bitstring = (SPc_2281,exp(g,Nc_2282)) in
                                    {2201}out(c, (pkCli_1862,m1_2283));
                                    {2202}in(c, PartS_2284: bitstring);
                                    {2203}let Kcli_2285: bitstring = exp(PartS_2284,Nc_2282) in
                                    {2204}out(c, senc(mCli(pkCli_1862,pkSess_2278),Kcli_2285))
                    )
                    else
                        {2205}let skCli_2286: bitstring = fail-any in
                        {2206}let pkCli_2287: bitstring = pub(skCli_2286) in
                        {2207}let v_2288: bool = (Disco = A) in
                        (
                            {2208}if v_2288 then
                            (
                                {2209}let pkDisco_2289: bitstring = pub(skA) in
                                {2210}let v_2290: bool = (Sess = A) in
                                (
                                    {2211}if v_2290 then
                                    (
                                        {2212}let pkSess_2291: bitstring = pub(skA) in
                                        {2213}out(c, GetEndpointRequest);
                                        {2214}in(c, (SPs_2292: bitstring,=None,UP_2293: bitstring,=pkSess_2291));
                                        {2215}new SPc_2294: bitstring;
                                        {2216}new Nc_2295: bitstring;
                                        {2217}let m1_2296: bitstring = (SPc_2294,exp(g,Nc_2295)) in
                                        {2218}out(c, (pkCli_2287,m1_2296));
                                        {2219}in(c, PartS_2297: bitstring);
                                        {2220}let Kcli_2298: bitstring = exp(PartS_2297,Nc_2295) in
                                        {2221}out(c, senc(mCli(pkCli_2287,pkSess_2291),Kcli_2298))
                                    )
                                    else
                                        {2222}let v_2299: bool = (Sess = B) in
                                        (
                                            {2223}if v_2299 then
                                            (
                                                {2224}let pkSess_2300: bitstring = pub(skB) in
                                                {2225}out(c, GetEndpointRequest);
                                                {2226}in(c, (SPs_2301: bitstring,=None,UP_2302: bitstring,=pkSess_2300));
                                                {2227}new SPc_2303: bitstring;
                                                {2228}new Nc_2304: bitstring;
                                                {2229}let m1_2305: bitstring = (SPc_2303,exp(g,Nc_2304)) in
                                                {2230}out(c, (pkCli_2287,m1_2305));
                                                {2231}in(c, PartS_2306: bitstring);
                                                {2232}let Kcli_2307: bitstring = exp(PartS_2306,Nc_2304) in
                                                {2233}out(c, senc(mCli(pkCli_2287,pkSess_2300),Kcli_2307))
                                            )
                                            else
                                                {2234}let v_2308: bool = (Sess = C) in
                                                (
                                                    {2235}if v_2308 then
                                                    (
                                                        {2236}let pkSess_2309: bitstring = pub(skC) in
                                                        {2237}out(c, GetEndpointRequest);
                                                        {2238}in(c, (SPs_2310: bitstring,=None,UP_2311: bitstring,=pkSess_2309));
                                                        {2239}new SPc_2312: bitstring;
                                                        {2240}new Nc_2313: bitstring;
                                                        {2241}let m1_2314: bitstring = (SPc_2312,exp(g,Nc_2313)) in
                                                        {2242}out(c, (pkCli_2287,m1_2314));
                                                        {2243}in(c, PartS_2315: bitstring);
                                                        {2244}let Kcli_2316: bitstring = exp(PartS_2315,Nc_2313) in
                                                        {2245}out(c, senc(mCli(pkCli_2287,pkSess_2309),Kcli_2316))
                                                    )
                                                    else
                                                        {2246}let pkSess_2317: bitstring = pub(skI) in
                                                        {2247}out(c, GetEndpointRequest);
                                                        {2248}in(c, (SPs_2318: bitstring,=None,UP_2319: bitstring,=pkSess_2317));
                                                        {2249}new SPc_2320: bitstring;
                                                        {2250}new Nc_2321: bitstring;
                                                        {2251}let m1_2322: bitstring = (SPc_2320,exp(g,Nc_2321)) in
                                                        {2252}out(c, (pkCli_2287,m1_2322));
                                                        {2253}in(c, PartS_2323: bitstring);
                                                        {2254}let Kcli_2324: bitstring = exp(PartS_2323,Nc_2321) in
                                                        {2255}out(c, senc(mCli(pkCli_2287,pkSess_2317),Kcli_2324))
                                                )
                                                else
                                                    {2256}let pkSess_2325: bitstring = fail-any in
                                                    {2257}out(c, GetEndpointRequest);
                                                    {2258}in(c, (SPs_2326: bitstring,=None,UP_2327: bitstring,=pkSess_2325));
                                                    {2259}new SPc_2328: bitstring;
                                                    {2260}new Nc_2329: bitstring;
                                                    {2261}let m1_2330: bitstring = (SPc_2328,exp(g,Nc_2329)) in
                                                    {2262}out(c, (pkCli_2287,m1_2330));
                                                    {2263}in(c, PartS_2331: bitstring);
                                                    {2264}let Kcli_2332: bitstring = exp(PartS_2331,Nc_2329) in
                                                    {2265}out(c, senc(mCli(pkCli_2287,pkSess_2325),Kcli_2332))
                                        )
                                        else
                                            {2266}let pkSess_2333: bitstring = fail-any in
                                            {2267}out(c, GetEndpointRequest);
                                            {2268}in(c, (SPs_2334: bitstring,=None,UP_2335: bitstring,=pkSess_2333));
                                            {2269}new SPc_2336: bitstring;
                                            {2270}new Nc_2337: bitstring;
                                            {2271}let m1_2338: bitstring = (SPc_2336,exp(g,Nc_2337)) in
                                            {2272}out(c, (pkCli_2287,m1_2338));
                                            {2273}in(c, PartS_2339: bitstring);
                                            {2274}let Kcli_2340: bitstring = exp(PartS_2339,Nc_2337) in
                                            {2275}out(c, senc(mCli(pkCli_2287,pkSess_2333),Kcli_2340))
                                )
                                else
                                    {2276}let pkSess_2341: bitstring = fail-any in
                                    {2277}out(c, GetEndpointRequest);
                                    {2278}in(c, (SPs_2342: bitstring,=None,UP_2343: bitstring,=pkSess_2341));
                                    {2279}new SPc_2344: bitstring;
                                    {2280}new Nc_2345: bitstring;
                                    {2281}let m1_2346: bitstring = (SPc_2344,exp(g,Nc_2345)) in
                                    {2282}out(c, (pkCli_2287,m1_2346));
                                    {2283}in(c, PartS_2347: bitstring);
                                    {2284}let Kcli_2348: bitstring = exp(PartS_2347,Nc_2345) in
                                    {2285}out(c, senc(mCli(pkCli_2287,pkSess_2341),Kcli_2348))
                            )
                            else
                                {2286}let v_2349: bool = (Disco = B) in
                                (
                                    {2287}if v_2349 then
                                    (
                                        {2288}let pkDisco_2350: bitstring = pub(skB) in
                                        {2289}let v_2351: bool = (Sess = A) in
                                        (
                                            {2290}if v_2351 then
                                            (
                                                {2291}let pkSess_2352: bitstring = pub(skA) in
                                                {2292}out(c, GetEndpointRequest);
                                                {2293}in(c, (SPs_2353: bitstring,=None,UP_2354: bitstring,=pkSess_2352));
                                                {2294}new SPc_2355: bitstring;
                                                {2295}new Nc_2356: bitstring;
                                                {2296}let m1_2357: bitstring = (SPc_2355,exp(g,Nc_2356)) in
                                                {2297}out(c, (pkCli_2287,m1_2357));
                                                {2298}in(c, PartS_2358: bitstring);
                                                {2299}let Kcli_2359: bitstring = exp(PartS_2358,Nc_2356) in
                                                {2300}out(c, senc(mCli(pkCli_2287,pkSess_2352),Kcli_2359))
                                            )
                                            else
                                                {2301}let v_2360: bool = (Sess = B) in
                                                (
                                                    {2302}if v_2360 then
                                                    (
                                                        {2303}let pkSess_2361: bitstring = pub(skB) in
                                                        {2304}out(c, GetEndpointRequest);
                                                        {2305}in(c, (SPs_2362: bitstring,=None,UP_2363: bitstring,=pkSess_2361));
                                                        {2306}new SPc_2364: bitstring;
                                                        {2307}new Nc_2365: bitstring;
                                                        {2308}let m1_2366: bitstring = (SPc_2364,exp(g,Nc_2365)) in
                                                        {2309}out(c, (pkCli_2287,m1_2366));
                                                        {2310}in(c, PartS_2367: bitstring);
                                                        {2311}let Kcli_2368: bitstring = exp(PartS_2367,Nc_2365) in
                                                        {2312}out(c, senc(mCli(pkCli_2287,pkSess_2361),Kcli_2368))
                                                    )
                                                    else
                                                        {2313}let v_2369: bool = (Sess = C) in
                                                        (
                                                            {2314}if v_2369 then
                                                            (
                                                                {2315}let pkSess_2370: bitstring = pub(skC) in
                                                                {2316}out(c, GetEndpointRequest);
                                                                {2317}in(c, (SPs_2371: bitstring,=None,UP_2372: bitstring,=pkSess_2370));
                                                                {2318}new SPc_2373: bitstring;
                                                                {2319}new Nc_2374: bitstring;
                                                                {2320}let m1_2375: bitstring = (SPc_2373,exp(g,Nc_2374)) in
                                                                {2321}out(c, (pkCli_2287,m1_2375));
                                                                {2322}in(c, PartS_2376: bitstring);
                                                                {2323}let Kcli_2377: bitstring = exp(PartS_2376,Nc_2374) in
                                                                {2324}out(c, senc(mCli(pkCli_2287,pkSess_2370),Kcli_2377))
                                                            )
                                                            else
                                                                {2325}let pkSess_2378: bitstring = pub(skI) in
                                                                {2326}out(c, GetEndpointRequest);
                                                                {2327}in(c, (SPs_2379: bitstring,=None,UP_2380: bitstring,=pkSess_2378));
                                                                {2328}new SPc_2381: bitstring;
                                                                {2329}new Nc_2382: bitstring;
                                                                {2330}let m1_2383: bitstring = (SPc_2381,exp(g,Nc_2382)) in
                                                                {2331}out(c, (pkCli_2287,m1_2383));
                                                                {2332}in(c, PartS_2384: bitstring);
                                                                {2333}let Kcli_2385: bitstring = exp(PartS_2384,Nc_2382) in
                                                                {2334}out(c, senc(mCli(pkCli_2287,pkSess_2378),Kcli_2385))
                                                        )
                                                        else
                                                            {2335}let pkSess_2386: bitstring = fail-any in
                                                            {2336}out(c, GetEndpointRequest);
                                                            {2337}in(c, (SPs_2387: bitstring,=None,UP_2388: bitstring,=pkSess_2386));
                                                            {2338}new SPc_2389: bitstring;
                                                            {2339}new Nc_2390: bitstring;
                                                            {2340}let m1_2391: bitstring = (SPc_2389,exp(g,Nc_2390)) in
                                                            {2341}out(c, (pkCli_2287,m1_2391));
                                                            {2342}in(c, PartS_2392: bitstring);
                                                            {2343}let Kcli_2393: bitstring = exp(PartS_2392,Nc_2390) in
                                                            {2344}out(c, senc(mCli(pkCli_2287,pkSess_2386),Kcli_2393))
                                                )
                                                else
                                                    {2345}let pkSess_2394: bitstring = fail-any in
                                                    {2346}out(c, GetEndpointRequest);
                                                    {2347}in(c, (SPs_2395: bitstring,=None,UP_2396: bitstring,=pkSess_2394));
                                                    {2348}new SPc_2397: bitstring;
                                                    {2349}new Nc_2398: bitstring;
                                                    {2350}let m1_2399: bitstring = (SPc_2397,exp(g,Nc_2398)) in
                                                    {2351}out(c, (pkCli_2287,m1_2399));
                                                    {2352}in(c, PartS_2400: bitstring);
                                                    {2353}let Kcli_2401: bitstring = exp(PartS_2400,Nc_2398) in
                                                    {2354}out(c, senc(mCli(pkCli_2287,pkSess_2394),Kcli_2401))
                                        )
                                        else
                                            {2355}let pkSess_2402: bitstring = fail-any in
                                            {2356}out(c, GetEndpointRequest);
                                            {2357}in(c, (SPs_2403: bitstring,=None,UP_2404: bitstring,=pkSess_2402));
                                            {2358}new SPc_2405: bitstring;
                                            {2359}new Nc_2406: bitstring;
                                            {2360}let m1_2407: bitstring = (SPc_2405,exp(g,Nc_2406)) in
                                            {2361}out(c, (pkCli_2287,m1_2407));
                                            {2362}in(c, PartS_2408: bitstring);
                                            {2363}let Kcli_2409: bitstring = exp(PartS_2408,Nc_2406) in
                                            {2364}out(c, senc(mCli(pkCli_2287,pkSess_2402),Kcli_2409))
                                    )
                                    else
                                        {2365}let v_2410: bool = (Disco = C) in
                                        (
                                            {2366}if v_2410 then
                                            (
                                                {2367}let pkDisco_2411: bitstring = pub(skC) in
                                                {2368}let v_2412: bool = (Sess = A) in
                                                (
                                                    {2369}if v_2412 then
                                                    (
                                                        {2370}let pkSess_2413: bitstring = pub(skA) in
                                                        {2371}out(c, GetEndpointRequest);
                                                        {2372}in(c, (SPs_2414: bitstring,=None,UP_2415: bitstring,=pkSess_2413));
                                                        {2373}new SPc_2416: bitstring;
                                                        {2374}new Nc_2417: bitstring;
                                                        {2375}let m1_2418: bitstring = (SPc_2416,exp(g,Nc_2417)) in
                                                        {2376}out(c, (pkCli_2287,m1_2418));
                                                        {2377}in(c, PartS_2419: bitstring);
                                                        {2378}let Kcli_2420: bitstring = exp(PartS_2419,Nc_2417) in
                                                        {2379}out(c, senc(mCli(pkCli_2287,pkSess_2413),Kcli_2420))
                                                    )
                                                    else
                                                        {2380}let v_2421: bool = (Sess = B) in
                                                        (
                                                            {2381}if v_2421 then
                                                            (
                                                                {2382}let pkSess_2422: bitstring = pub(skB) in
                                                                {2383}out(c, GetEndpointRequest);
                                                                {2384}in(c, (SPs_2423: bitstring,=None,UP_2424: bitstring,=pkSess_2422));
                                                                {2385}new SPc_2425: bitstring;
                                                                {2386}new Nc_2426: bitstring;
                                                                {2387}let m1_2427: bitstring = (SPc_2425,exp(g,Nc_2426)) in
                                                                {2388}out(c, (pkCli_2287,m1_2427));
                                                                {2389}in(c, PartS_2428: bitstring);
                                                                {2390}let Kcli_2429: bitstring = exp(PartS_2428,Nc_2426) in
                                                                {2391}out(c, senc(mCli(pkCli_2287,pkSess_2422),Kcli_2429))
                                                            )
                                                            else
                                                                {2392}let v_2430: bool = (Sess = C) in
                                                                (
                                                                    {2393}if v_2430 then
                                                                    (
                                                                        {2394}let pkSess_2431: bitstring = pub(skC) in
                                                                        {2395}out(c, GetEndpointRequest);
                                                                        {2396}in(c, (SPs_2432: bitstring,=None,UP_2433: bitstring,=pkSess_2431));
                                                                        {2397}new SPc_2434: bitstring;
                                                                        {2398}new Nc_2435: bitstring;
                                                                        {2399}let m1_2436: bitstring = (SPc_2434,exp(g,Nc_2435)) in
                                                                        {2400}out(c, (pkCli_2287,m1_2436));
                                                                        {2401}in(c, PartS_2437: bitstring);
                                                                        {2402}let Kcli_2438: bitstring = exp(PartS_2437,Nc_2435) in
                                                                        {2403}out(c, senc(mCli(pkCli_2287,pkSess_2431),Kcli_2438))
                                                                    )
                                                                    else
                                                                        {2404}let pkSess_2439: bitstring = pub(skI) in
                                                                        {2405}out(c, GetEndpointRequest);
                                                                        {2406}in(c, (SPs_2440: bitstring,=None,UP_2441: bitstring,=pkSess_2439));
                                                                        {2407}new SPc_2442: bitstring;
                                                                        {2408}new Nc_2443: bitstring;
                                                                        {2409}let m1_2444: bitstring = (SPc_2442,exp(g,Nc_2443)) in
                                                                        {2410}out(c, (pkCli_2287,m1_2444));
                                                                        {2411}in(c, PartS_2445: bitstring);
                                                                        {2412}let Kcli_2446: bitstring = exp(PartS_2445,Nc_2443) in
                                                                        {2413}out(c, senc(mCli(pkCli_2287,pkSess_2439),Kcli_2446))
                                                                )
                                                                else
                                                                    {2414}let pkSess_2447: bitstring = fail-any in
                                                                    {2415}out(c, GetEndpointRequest);
                                                                    {2416}in(c, (SPs_2448: bitstring,=None,UP_2449: bitstring,=pkSess_2447));
                                                                    {2417}new SPc_2450: bitstring;
                                                                    {2418}new Nc_2451: bitstring;
                                                                    {2419}let m1_2452: bitstring = (SPc_2450,exp(g,Nc_2451)) in
                                                                    {2420}out(c, (pkCli_2287,m1_2452));
                                                                    {2421}in(c, PartS_2453: bitstring);
                                                                    {2422}let Kcli_2454: bitstring = exp(PartS_2453,Nc_2451) in
                                                                    {2423}out(c, senc(mCli(pkCli_2287,pkSess_2447),Kcli_2454))
                                                        )
                                                        else
                                                            {2424}let pkSess_2455: bitstring = fail-any in
                                                            {2425}out(c, GetEndpointRequest);
                                                            {2426}in(c, (SPs_2456: bitstring,=None,UP_2457: bitstring,=pkSess_2455));
                                                            {2427}new SPc_2458: bitstring;
                                                            {2428}new Nc_2459: bitstring;
                                                            {2429}let m1_2460: bitstring = (SPc_2458,exp(g,Nc_2459)) in
                                                            {2430}out(c, (pkCli_2287,m1_2460));
                                                            {2431}in(c, PartS_2461: bitstring);
                                                            {2432}let Kcli_2462: bitstring = exp(PartS_2461,Nc_2459) in
                                                            {2433}out(c, senc(mCli(pkCli_2287,pkSess_2455),Kcli_2462))
                                                )
                                                else
                                                    {2434}let pkSess_2463: bitstring = fail-any in
                                                    {2435}out(c, GetEndpointRequest);
                                                    {2436}in(c, (SPs_2464: bitstring,=None,UP_2465: bitstring,=pkSess_2463));
                                                    {2437}new SPc_2466: bitstring;
                                                    {2438}new Nc_2467: bitstring;
                                                    {2439}let m1_2468: bitstring = (SPc_2466,exp(g,Nc_2467)) in
                                                    {2440}out(c, (pkCli_2287,m1_2468));
                                                    {2441}in(c, PartS_2469: bitstring);
                                                    {2442}let Kcli_2470: bitstring = exp(PartS_2469,Nc_2467) in
                                                    {2443}out(c, senc(mCli(pkCli_2287,pkSess_2463),Kcli_2470))
                                            )
                                            else
                                                {2444}let pkDisco_2471: bitstring = pub(skI) in
                                                {2445}let v_2472: bool = (Sess = A) in
                                                (
                                                    {2446}if v_2472 then
                                                    (
                                                        {2447}let pkSess_2473: bitstring = pub(skA) in
                                                        {2448}out(c, GetEndpointRequest);
                                                        {2449}in(c, (SPs_2474: bitstring,=None,UP_2475: bitstring,=pkSess_2473));
                                                        {2450}new SPc_2476: bitstring;
                                                        {2451}new Nc_2477: bitstring;
                                                        {2452}let m1_2478: bitstring = (SPc_2476,exp(g,Nc_2477)) in
                                                        {2453}out(c, (pkCli_2287,m1_2478));
                                                        {2454}in(c, PartS_2479: bitstring);
                                                        {2455}let Kcli_2480: bitstring = exp(PartS_2479,Nc_2477) in
                                                        {2456}out(c, senc(mCli(pkCli_2287,pkSess_2473),Kcli_2480))
                                                    )
                                                    else
                                                        {2457}let v_2481: bool = (Sess = B) in
                                                        (
                                                            {2458}if v_2481 then
                                                            (
                                                                {2459}let pkSess_2482: bitstring = pub(skB) in
                                                                {2460}out(c, GetEndpointRequest);
                                                                {2461}in(c, (SPs_2483: bitstring,=None,UP_2484: bitstring,=pkSess_2482));
                                                                {2462}new SPc_2485: bitstring;
                                                                {2463}new Nc_2486: bitstring;
                                                                {2464}let m1_2487: bitstring = (SPc_2485,exp(g,Nc_2486)) in
                                                                {2465}out(c, (pkCli_2287,m1_2487));
                                                                {2466}in(c, PartS_2488: bitstring);
                                                                {2467}let Kcli_2489: bitstring = exp(PartS_2488,Nc_2486) in
                                                                {2468}out(c, senc(mCli(pkCli_2287,pkSess_2482),Kcli_2489))
                                                            )
                                                            else
                                                                {2469}let v_2490: bool = (Sess = C) in
                                                                (
                                                                    {2470}if v_2490 then
                                                                    (
                                                                        {2471}let pkSess_2491: bitstring = pub(skC) in
                                                                        {2472}out(c, GetEndpointRequest);
                                                                        {2473}in(c, (SPs_2492: bitstring,=None,UP_2493: bitstring,=pkSess_2491));
                                                                        {2474}new SPc_2494: bitstring;
                                                                        {2475}new Nc_2495: bitstring;
                                                                        {2476}let m1_2496: bitstring = (SPc_2494,exp(g,Nc_2495)) in
                                                                        {2477}out(c, (pkCli_2287,m1_2496));
                                                                        {2478}in(c, PartS_2497: bitstring);
                                                                        {2479}let Kcli_2498: bitstring = exp(PartS_2497,Nc_2495) in
                                                                        {2480}out(c, senc(mCli(pkCli_2287,pkSess_2491),Kcli_2498))
                                                                    )
                                                                    else
                                                                        {2481}let pkSess_2499: bitstring = pub(skI) in
                                                                        {2482}out(c, GetEndpointRequest);
                                                                        {2483}in(c, (SPs_2500: bitstring,=None,UP_2501: bitstring,=pkSess_2499));
                                                                        {2484}new SPc_2502: bitstring;
                                                                        {2485}new Nc_2503: bitstring;
                                                                        {2486}let m1_2504: bitstring = (SPc_2502,exp(g,Nc_2503)) in
                                                                        {2487}out(c, (pkCli_2287,m1_2504));
                                                                        {2488}in(c, PartS_2505: bitstring);
                                                                        {2489}let Kcli_2506: bitstring = exp(PartS_2505,Nc_2503) in
                                                                        {2490}out(c, senc(mCli(pkCli_2287,pkSess_2499),Kcli_2506))
                                                                )
                                                                else
                                                                    {2491}let pkSess_2507: bitstring = fail-any in
                                                                    {2492}out(c, GetEndpointRequest);
                                                                    {2493}in(c, (SPs_2508: bitstring,=None,UP_2509: bitstring,=pkSess_2507));
                                                                    {2494}new SPc_2510: bitstring;
                                                                    {2495}new Nc_2511: bitstring;
                                                                    {2496}let m1_2512: bitstring = (SPc_2510,exp(g,Nc_2511)) in
                                                                    {2497}out(c, (pkCli_2287,m1_2512));
                                                                    {2498}in(c, PartS_2513: bitstring);
                                                                    {2499}let Kcli_2514: bitstring = exp(PartS_2513,Nc_2511) in
                                                                    {2500}out(c, senc(mCli(pkCli_2287,pkSess_2507),Kcli_2514))
                                                        )
                                                        else
                                                            {2501}let pkSess_2515: bitstring = fail-any in
                                                            {2502}out(c, GetEndpointRequest);
                                                            {2503}in(c, (SPs_2516: bitstring,=None,UP_2517: bitstring,=pkSess_2515));
                                                            {2504}new SPc_2518: bitstring;
                                                            {2505}new Nc_2519: bitstring;
                                                            {2506}let m1_2520: bitstring = (SPc_2518,exp(g,Nc_2519)) in
                                                            {2507}out(c, (pkCli_2287,m1_2520));
                                                            {2508}in(c, PartS_2521: bitstring);
                                                            {2509}let Kcli_2522: bitstring = exp(PartS_2521,Nc_2519) in
                                                            {2510}out(c, senc(mCli(pkCli_2287,pkSess_2515),Kcli_2522))
                                                )
                                                else
                                                    {2511}let pkSess_2523: bitstring = fail-any in
                                                    {2512}out(c, GetEndpointRequest);
                                                    {2513}in(c, (SPs_2524: bitstring,=None,UP_2525: bitstring,=pkSess_2523));
                                                    {2514}new SPc_2526: bitstring;
                                                    {2515}new Nc_2527: bitstring;
                                                    {2516}let m1_2528: bitstring = (SPc_2526,exp(g,Nc_2527)) in
                                                    {2517}out(c, (pkCli_2287,m1_2528));
                                                    {2518}in(c, PartS_2529: bitstring);
                                                    {2519}let Kcli_2530: bitstring = exp(PartS_2529,Nc_2527) in
                                                    {2520}out(c, senc(mCli(pkCli_2287,pkSess_2523),Kcli_2530))
                                        )
                                        else
                                            {2521}let pkDisco_2531: bitstring = fail-any in
                                            {2522}let v_2532: bool = (Sess = A) in
                                            (
                                                {2523}if v_2532 then
                                                (
                                                    {2524}let pkSess_2533: bitstring = pub(skA) in
                                                    {2525}out(c, GetEndpointRequest);
                                                    {2526}in(c, (SPs_2534: bitstring,=None,UP_2535: bitstring,=pkSess_2533));
                                                    {2527}new SPc_2536: bitstring;
                                                    {2528}new Nc_2537: bitstring;
                                                    {2529}let m1_2538: bitstring = (SPc_2536,exp(g,Nc_2537)) in
                                                    {2530}out(c, (pkCli_2287,m1_2538));
                                                    {2531}in(c, PartS_2539: bitstring);
                                                    {2532}let Kcli_2540: bitstring = exp(PartS_2539,Nc_2537) in
                                                    {2533}out(c, senc(mCli(pkCli_2287,pkSess_2533),Kcli_2540))
                                                )
                                                else
                                                    {2534}let v_2541: bool = (Sess = B) in
                                                    (
                                                        {2535}if v_2541 then
                                                        (
                                                            {2536}let pkSess_2542: bitstring = pub(skB) in
                                                            {2537}out(c, GetEndpointRequest);
                                                            {2538}in(c, (SPs_2543: bitstring,=None,UP_2544: bitstring,=pkSess_2542));
                                                            {2539}new SPc_2545: bitstring;
                                                            {2540}new Nc_2546: bitstring;
                                                            {2541}let m1_2547: bitstring = (SPc_2545,exp(g,Nc_2546)) in
                                                            {2542}out(c, (pkCli_2287,m1_2547));
                                                            {2543}in(c, PartS_2548: bitstring);
                                                            {2544}let Kcli_2549: bitstring = exp(PartS_2548,Nc_2546) in
                                                            {2545}out(c, senc(mCli(pkCli_2287,pkSess_2542),Kcli_2549))
                                                        )
                                                        else
                                                            {2546}let v_2550: bool = (Sess = C) in
                                                            (
                                                                {2547}if v_2550 then
                                                                (
                                                                    {2548}let pkSess_2551: bitstring = pub(skC) in
                                                                    {2549}out(c, GetEndpointRequest);
                                                                    {2550}in(c, (SPs_2552: bitstring,=None,UP_2553: bitstring,=pkSess_2551));
                                                                    {2551}new SPc_2554: bitstring;
                                                                    {2552}new Nc_2555: bitstring;
                                                                    {2553}let m1_2556: bitstring = (SPc_2554,exp(g,Nc_2555)) in
                                                                    {2554}out(c, (pkCli_2287,m1_2556));
                                                                    {2555}in(c, PartS_2557: bitstring);
                                                                    {2556}let Kcli_2558: bitstring = exp(PartS_2557,Nc_2555) in
                                                                    {2557}out(c, senc(mCli(pkCli_2287,pkSess_2551),Kcli_2558))
                                                                )
                                                                else
                                                                    {2558}let pkSess_2559: bitstring = pub(skI) in
                                                                    {2559}out(c, GetEndpointRequest);
                                                                    {2560}in(c, (SPs_2560: bitstring,=None,UP_2561: bitstring,=pkSess_2559));
                                                                    {2561}new SPc_2562: bitstring;
                                                                    {2562}new Nc_2563: bitstring;
                                                                    {2563}let m1_2564: bitstring = (SPc_2562,exp(g,Nc_2563)) in
                                                                    {2564}out(c, (pkCli_2287,m1_2564));
                                                                    {2565}in(c, PartS_2565: bitstring);
                                                                    {2566}let Kcli_2566: bitstring = exp(PartS_2565,Nc_2563) in
                                                                    {2567}out(c, senc(mCli(pkCli_2287,pkSess_2559),Kcli_2566))
                                                            )
                                                            else
                                                                {2568}let pkSess_2567: bitstring = fail-any in
                                                                {2569}out(c, GetEndpointRequest);
                                                                {2570}in(c, (SPs_2568: bitstring,=None,UP_2569: bitstring,=pkSess_2567));
                                                                {2571}new SPc_2570: bitstring;
                                                                {2572}new Nc_2571: bitstring;
                                                                {2573}let m1_2572: bitstring = (SPc_2570,exp(g,Nc_2571)) in
                                                                {2574}out(c, (pkCli_2287,m1_2572));
                                                                {2575}in(c, PartS_2573: bitstring);
                                                                {2576}let Kcli_2574: bitstring = exp(PartS_2573,Nc_2571) in
                                                                {2577}out(c, senc(mCli(pkCli_2287,pkSess_2567),Kcli_2574))
                                                    )
                                                    else
                                                        {2578}let pkSess_2575: bitstring = fail-any in
                                                        {2579}out(c, GetEndpointRequest);
                                                        {2580}in(c, (SPs_2576: bitstring,=None,UP_2577: bitstring,=pkSess_2575));
                                                        {2581}new SPc_2578: bitstring;
                                                        {2582}new Nc_2579: bitstring;
                                                        {2583}let m1_2580: bitstring = (SPc_2578,exp(g,Nc_2579)) in
                                                        {2584}out(c, (pkCli_2287,m1_2580));
                                                        {2585}in(c, PartS_2581: bitstring);
                                                        {2586}let Kcli_2582: bitstring = exp(PartS_2581,Nc_2579) in
                                                        {2587}out(c, senc(mCli(pkCli_2287,pkSess_2575),Kcli_2582))
                                            )
                                            else
                                                {2588}let pkSess_2583: bitstring = fail-any in
                                                {2589}out(c, GetEndpointRequest);
                                                {2590}in(c, (SPs_2584: bitstring,=None,UP_2585: bitstring,=pkSess_2583));
                                                {2591}new SPc_2586: bitstring;
                                                {2592}new Nc_2587: bitstring;
                                                {2593}let m1_2588: bitstring = (SPc_2586,exp(g,Nc_2587)) in
                                                {2594}out(c, (pkCli_2287,m1_2588));
                                                {2595}in(c, PartS_2589: bitstring);
                                                {2596}let Kcli_2590: bitstring = exp(PartS_2589,Nc_2587) in
                                                {2597}out(c, senc(mCli(pkCli_2287,pkSess_2583),Kcli_2590))
                                )
                                else
                                    {2598}let pkDisco_2591: bitstring = fail-any in
                                    {2599}let v_2592: bool = (Sess = A) in
                                    (
                                        {2600}if v_2592 then
                                        (
                                            {2601}let pkSess_2593: bitstring = pub(skA) in
                                            {2602}out(c, GetEndpointRequest);
                                            {2603}in(c, (SPs_2594: bitstring,=None,UP_2595: bitstring,=pkSess_2593));
                                            {2604}new SPc_2596: bitstring;
                                            {2605}new Nc_2597: bitstring;
                                            {2606}let m1_2598: bitstring = (SPc_2596,exp(g,Nc_2597)) in
                                            {2607}out(c, (pkCli_2287,m1_2598));
                                            {2608}in(c, PartS_2599: bitstring);
                                            {2609}let Kcli_2600: bitstring = exp(PartS_2599,Nc_2597) in
                                            {2610}out(c, senc(mCli(pkCli_2287,pkSess_2593),Kcli_2600))
                                        )
                                        else
                                            {2611}let v_2601: bool = (Sess = B) in
                                            (
                                                {2612}if v_2601 then
                                                (
                                                    {2613}let pkSess_2602: bitstring = pub(skB) in
                                                    {2614}out(c, GetEndpointRequest);
                                                    {2615}in(c, (SPs_2603: bitstring,=None,UP_2604: bitstring,=pkSess_2602));
                                                    {2616}new SPc_2605: bitstring;
                                                    {2617}new Nc_2606: bitstring;
                                                    {2618}let m1_2607: bitstring = (SPc_2605,exp(g,Nc_2606)) in
                                                    {2619}out(c, (pkCli_2287,m1_2607));
                                                    {2620}in(c, PartS_2608: bitstring);
                                                    {2621}let Kcli_2609: bitstring = exp(PartS_2608,Nc_2606) in
                                                    {2622}out(c, senc(mCli(pkCli_2287,pkSess_2602),Kcli_2609))
                                                )
                                                else
                                                    {2623}let v_2610: bool = (Sess = C) in
                                                    (
                                                        {2624}if v_2610 then
                                                        (
                                                            {2625}let pkSess_2611: bitstring = pub(skC) in
                                                            {2626}out(c, GetEndpointRequest);
                                                            {2627}in(c, (SPs_2612: bitstring,=None,UP_2613: bitstring,=pkSess_2611));
                                                            {2628}new SPc_2614: bitstring;
                                                            {2629}new Nc_2615: bitstring;
                                                            {2630}let m1_2616: bitstring = (SPc_2614,exp(g,Nc_2615)) in
                                                            {2631}out(c, (pkCli_2287,m1_2616));
                                                            {2632}in(c, PartS_2617: bitstring);
                                                            {2633}let Kcli_2618: bitstring = exp(PartS_2617,Nc_2615) in
                                                            {2634}out(c, senc(mCli(pkCli_2287,pkSess_2611),Kcli_2618))
                                                        )
                                                        else
                                                            {2635}let pkSess_2619: bitstring = pub(skI) in
                                                            {2636}out(c, GetEndpointRequest);
                                                            {2637}in(c, (SPs_2620: bitstring,=None,UP_2621: bitstring,=pkSess_2619));
                                                            {2638}new SPc_2622: bitstring;
                                                            {2639}new Nc_2623: bitstring;
                                                            {2640}let m1_2624: bitstring = (SPc_2622,exp(g,Nc_2623)) in
                                                            {2641}out(c, (pkCli_2287,m1_2624));
                                                            {2642}in(c, PartS_2625: bitstring);
                                                            {2643}let Kcli_2626: bitstring = exp(PartS_2625,Nc_2623) in
                                                            {2644}out(c, senc(mCli(pkCli_2287,pkSess_2619),Kcli_2626))
                                                    )
                                                    else
                                                        {2645}let pkSess_2627: bitstring = fail-any in
                                                        {2646}out(c, GetEndpointRequest);
                                                        {2647}in(c, (SPs_2628: bitstring,=None,UP_2629: bitstring,=pkSess_2627));
                                                        {2648}new SPc_2630: bitstring;
                                                        {2649}new Nc_2631: bitstring;
                                                        {2650}let m1_2632: bitstring = (SPc_2630,exp(g,Nc_2631)) in
                                                        {2651}out(c, (pkCli_2287,m1_2632));
                                                        {2652}in(c, PartS_2633: bitstring);
                                                        {2653}let Kcli_2634: bitstring = exp(PartS_2633,Nc_2631) in
                                                        {2654}out(c, senc(mCli(pkCli_2287,pkSess_2627),Kcli_2634))
                                            )
                                            else
                                                {2655}let pkSess_2635: bitstring = fail-any in
                                                {2656}out(c, GetEndpointRequest);
                                                {2657}in(c, (SPs_2636: bitstring,=None,UP_2637: bitstring,=pkSess_2635));
                                                {2658}new SPc_2638: bitstring;
                                                {2659}new Nc_2639: bitstring;
                                                {2660}let m1_2640: bitstring = (SPc_2638,exp(g,Nc_2639)) in
                                                {2661}out(c, (pkCli_2287,m1_2640));
                                                {2662}in(c, PartS_2641: bitstring);
                                                {2663}let Kcli_2642: bitstring = exp(PartS_2641,Nc_2639) in
                                                {2664}out(c, senc(mCli(pkCli_2287,pkSess_2635),Kcli_2642))
                                    )
                                    else
                                        {2665}let pkSess_2643: bitstring = fail-any in
                                        {2666}out(c, GetEndpointRequest);
                                        {2667}in(c, (SPs_2644: bitstring,=None,UP_2645: bitstring,=pkSess_2643));
                                        {2668}new SPc_2646: bitstring;
                                        {2669}new Nc_2647: bitstring;
                                        {2670}let m1_2648: bitstring = (SPc_2646,exp(g,Nc_2647)) in
                                        {2671}out(c, (pkCli_2287,m1_2648));
                                        {2672}in(c, PartS_2649: bitstring);
                                        {2673}let Kcli_2650: bitstring = exp(PartS_2649,Nc_2647) in
                                        {2674}out(c, senc(mCli(pkCli_2287,pkSess_2643),Kcli_2650))
                        )
                        else
                            {2675}let pkDisco_2651: bitstring = fail-any in
                            {2676}let v_2652: bool = (Sess = A) in
                            (
                                {2677}if v_2652 then
                                (
                                    {2678}let pkSess_2653: bitstring = pub(skA) in
                                    {2679}out(c, GetEndpointRequest);
                                    {2680}in(c, (SPs_2654: bitstring,=None,UP_2655: bitstring,=pkSess_2653));
                                    {2681}new SPc_2656: bitstring;
                                    {2682}new Nc_2657: bitstring;
                                    {2683}let m1_2658: bitstring = (SPc_2656,exp(g,Nc_2657)) in
                                    {2684}out(c, (pkCli_2287,m1_2658));
                                    {2685}in(c, PartS_2659: bitstring);
                                    {2686}let Kcli_2660: bitstring = exp(PartS_2659,Nc_2657) in
                                    {2687}out(c, senc(mCli(pkCli_2287,pkSess_2653),Kcli_2660))
                                )
                                else
                                    {2688}let v_2661: bool = (Sess = B) in
                                    (
                                        {2689}if v_2661 then
                                        (
                                            {2690}let pkSess_2662: bitstring = pub(skB) in
                                            {2691}out(c, GetEndpointRequest);
                                            {2692}in(c, (SPs_2663: bitstring,=None,UP_2664: bitstring,=pkSess_2662));
                                            {2693}new SPc_2665: bitstring;
                                            {2694}new Nc_2666: bitstring;
                                            {2695}let m1_2667: bitstring = (SPc_2665,exp(g,Nc_2666)) in
                                            {2696}out(c, (pkCli_2287,m1_2667));
                                            {2697}in(c, PartS_2668: bitstring);
                                            {2698}let Kcli_2669: bitstring = exp(PartS_2668,Nc_2666) in
                                            {2699}out(c, senc(mCli(pkCli_2287,pkSess_2662),Kcli_2669))
                                        )
                                        else
                                            {2700}let v_2670: bool = (Sess = C) in
                                            (
                                                {2701}if v_2670 then
                                                (
                                                    {2702}let pkSess_2671: bitstring = pub(skC) in
                                                    {2703}out(c, GetEndpointRequest);
                                                    {2704}in(c, (SPs_2672: bitstring,=None,UP_2673: bitstring,=pkSess_2671));
                                                    {2705}new SPc_2674: bitstring;
                                                    {2706}new Nc_2675: bitstring;
                                                    {2707}let m1_2676: bitstring = (SPc_2674,exp(g,Nc_2675)) in
                                                    {2708}out(c, (pkCli_2287,m1_2676));
                                                    {2709}in(c, PartS_2677: bitstring);
                                                    {2710}let Kcli_2678: bitstring = exp(PartS_2677,Nc_2675) in
                                                    {2711}out(c, senc(mCli(pkCli_2287,pkSess_2671),Kcli_2678))
                                                )
                                                else
                                                    {2712}let pkSess_2679: bitstring = pub(skI) in
                                                    {2713}out(c, GetEndpointRequest);
                                                    {2714}in(c, (SPs_2680: bitstring,=None,UP_2681: bitstring,=pkSess_2679));
                                                    {2715}new SPc_2682: bitstring;
                                                    {2716}new Nc_2683: bitstring;
                                                    {2717}let m1_2684: bitstring = (SPc_2682,exp(g,Nc_2683)) in
                                                    {2718}out(c, (pkCli_2287,m1_2684));
                                                    {2719}in(c, PartS_2685: bitstring);
                                                    {2720}let Kcli_2686: bitstring = exp(PartS_2685,Nc_2683) in
                                                    {2721}out(c, senc(mCli(pkCli_2287,pkSess_2679),Kcli_2686))
                                            )
                                            else
                                                {2722}let pkSess_2687: bitstring = fail-any in
                                                {2723}out(c, GetEndpointRequest);
                                                {2724}in(c, (SPs_2688: bitstring,=None,UP_2689: bitstring,=pkSess_2687));
                                                {2725}new SPc_2690: bitstring;
                                                {2726}new Nc_2691: bitstring;
                                                {2727}let m1_2692: bitstring = (SPc_2690,exp(g,Nc_2691)) in
                                                {2728}out(c, (pkCli_2287,m1_2692));
                                                {2729}in(c, PartS_2693: bitstring);
                                                {2730}let Kcli_2694: bitstring = exp(PartS_2693,Nc_2691) in
                                                {2731}out(c, senc(mCli(pkCli_2287,pkSess_2687),Kcli_2694))
                                    )
                                    else
                                        {2732}let pkSess_2695: bitstring = fail-any in
                                        {2733}out(c, GetEndpointRequest);
                                        {2734}in(c, (SPs_2696: bitstring,=None,UP_2697: bitstring,=pkSess_2695));
                                        {2735}new SPc_2698: bitstring;
                                        {2736}new Nc_2699: bitstring;
                                        {2737}let m1_2700: bitstring = (SPc_2698,exp(g,Nc_2699)) in
                                        {2738}out(c, (pkCli_2287,m1_2700));
                                        {2739}in(c, PartS_2701: bitstring);
                                        {2740}let Kcli_2702: bitstring = exp(PartS_2701,Nc_2699) in
                                        {2741}out(c, senc(mCli(pkCli_2287,pkSess_2695),Kcli_2702))
                            )
                            else
                                {2742}let pkSess_2703: bitstring = fail-any in
                                {2743}out(c, GetEndpointRequest);
                                {2744}in(c, (SPs_2704: bitstring,=None,UP_2705: bitstring,=pkSess_2703));
                                {2745}new SPc_2706: bitstring;
                                {2746}new Nc_2707: bitstring;
                                {2747}let m1_2708: bitstring = (SPc_2706,exp(g,Nc_2707)) in
                                {2748}out(c, (pkCli_2287,m1_2708));
                                {2749}in(c, PartS_2709: bitstring);
                                {2750}let Kcli_2710: bitstring = exp(PartS_2709,Nc_2707) in
                                {2751}out(c, senc(mCli(pkCli_2287,pkSess_2703),Kcli_2710))
            )
            else
                {2752}let skCli_2711: bitstring = fail-any in
                {2753}let pkCli_2712: bitstring = pub(skCli_2711) in
                {2754}let v_2713: bool = (Disco = A) in
                (
                    {2755}if v_2713 then
                    (
                        {2756}let pkDisco_2714: bitstring = pub(skA) in
                        {2757}let v_2715: bool = (Sess = A) in
                        (
                            {2758}if v_2715 then
                            (
                                {2759}let pkSess_2716: bitstring = pub(skA) in
                                {2760}out(c, GetEndpointRequest);
                                {2761}in(c, (SPs_2717: bitstring,=None,UP_2718: bitstring,=pkSess_2716));
                                {2762}new SPc_2719: bitstring;
                                {2763}new Nc_2720: bitstring;
                                {2764}let m1_2721: bitstring = (SPc_2719,exp(g,Nc_2720)) in
                                {2765}out(c, (pkCli_2712,m1_2721));
                                {2766}in(c, PartS_2722: bitstring);
                                {2767}let Kcli_2723: bitstring = exp(PartS_2722,Nc_2720) in
                                {2768}out(c, senc(mCli(pkCli_2712,pkSess_2716),Kcli_2723))
                            )
                            else
                                {2769}let v_2724: bool = (Sess = B) in
                                (
                                    {2770}if v_2724 then
                                    (
                                        {2771}let pkSess_2725: bitstring = pub(skB) in
                                        {2772}out(c, GetEndpointRequest);
                                        {2773}in(c, (SPs_2726: bitstring,=None,UP_2727: bitstring,=pkSess_2725));
                                        {2774}new SPc_2728: bitstring;
                                        {2775}new Nc_2729: bitstring;
                                        {2776}let m1_2730: bitstring = (SPc_2728,exp(g,Nc_2729)) in
                                        {2777}out(c, (pkCli_2712,m1_2730));
                                        {2778}in(c, PartS_2731: bitstring);
                                        {2779}let Kcli_2732: bitstring = exp(PartS_2731,Nc_2729) in
                                        {2780}out(c, senc(mCli(pkCli_2712,pkSess_2725),Kcli_2732))
                                    )
                                    else
                                        {2781}let v_2733: bool = (Sess = C) in
                                        (
                                            {2782}if v_2733 then
                                            (
                                                {2783}let pkSess_2734: bitstring = pub(skC) in
                                                {2784}out(c, GetEndpointRequest);
                                                {2785}in(c, (SPs_2735: bitstring,=None,UP_2736: bitstring,=pkSess_2734));
                                                {2786}new SPc_2737: bitstring;
                                                {2787}new Nc_2738: bitstring;
                                                {2788}let m1_2739: bitstring = (SPc_2737,exp(g,Nc_2738)) in
                                                {2789}out(c, (pkCli_2712,m1_2739));
                                                {2790}in(c, PartS_2740: bitstring);
                                                {2791}let Kcli_2741: bitstring = exp(PartS_2740,Nc_2738) in
                                                {2792}out(c, senc(mCli(pkCli_2712,pkSess_2734),Kcli_2741))
                                            )
                                            else
                                                {2793}let pkSess_2742: bitstring = pub(skI) in
                                                {2794}out(c, GetEndpointRequest);
                                                {2795}in(c, (SPs_2743: bitstring,=None,UP_2744: bitstring,=pkSess_2742));
                                                {2796}new SPc_2745: bitstring;
                                                {2797}new Nc_2746: bitstring;
                                                {2798}let m1_2747: bitstring = (SPc_2745,exp(g,Nc_2746)) in
                                                {2799}out(c, (pkCli_2712,m1_2747));
                                                {2800}in(c, PartS_2748: bitstring);
                                                {2801}let Kcli_2749: bitstring = exp(PartS_2748,Nc_2746) in
                                                {2802}out(c, senc(mCli(pkCli_2712,pkSess_2742),Kcli_2749))
                                        )
                                        else
                                            {2803}let pkSess_2750: bitstring = fail-any in
                                            {2804}out(c, GetEndpointRequest);
                                            {2805}in(c, (SPs_2751: bitstring,=None,UP_2752: bitstring,=pkSess_2750));
                                            {2806}new SPc_2753: bitstring;
                                            {2807}new Nc_2754: bitstring;
                                            {2808}let m1_2755: bitstring = (SPc_2753,exp(g,Nc_2754)) in
                                            {2809}out(c, (pkCli_2712,m1_2755));
                                            {2810}in(c, PartS_2756: bitstring);
                                            {2811}let Kcli_2757: bitstring = exp(PartS_2756,Nc_2754) in
                                            {2812}out(c, senc(mCli(pkCli_2712,pkSess_2750),Kcli_2757))
                                )
                                else
                                    {2813}let pkSess_2758: bitstring = fail-any in
                                    {2814}out(c, GetEndpointRequest);
                                    {2815}in(c, (SPs_2759: bitstring,=None,UP_2760: bitstring,=pkSess_2758));
                                    {2816}new SPc_2761: bitstring;
                                    {2817}new Nc_2762: bitstring;
                                    {2818}let m1_2763: bitstring = (SPc_2761,exp(g,Nc_2762)) in
                                    {2819}out(c, (pkCli_2712,m1_2763));
                                    {2820}in(c, PartS_2764: bitstring);
                                    {2821}let Kcli_2765: bitstring = exp(PartS_2764,Nc_2762) in
                                    {2822}out(c, senc(mCli(pkCli_2712,pkSess_2758),Kcli_2765))
                        )
                        else
                            {2823}let pkSess_2766: bitstring = fail-any in
                            {2824}out(c, GetEndpointRequest);
                            {2825}in(c, (SPs_2767: bitstring,=None,UP_2768: bitstring,=pkSess_2766));
                            {2826}new SPc_2769: bitstring;
                            {2827}new Nc_2770: bitstring;
                            {2828}let m1_2771: bitstring = (SPc_2769,exp(g,Nc_2770)) in
                            {2829}out(c, (pkCli_2712,m1_2771));
                            {2830}in(c, PartS_2772: bitstring);
                            {2831}let Kcli_2773: bitstring = exp(PartS_2772,Nc_2770) in
                            {2832}out(c, senc(mCli(pkCli_2712,pkSess_2766),Kcli_2773))
                    )
                    else
                        {2833}let v_2774: bool = (Disco = B) in
                        (
                            {2834}if v_2774 then
                            (
                                {2835}let pkDisco_2775: bitstring = pub(skB) in
                                {2836}let v_2776: bool = (Sess = A) in
                                (
                                    {2837}if v_2776 then
                                    (
                                        {2838}let pkSess_2777: bitstring = pub(skA) in
                                        {2839}out(c, GetEndpointRequest);
                                        {2840}in(c, (SPs_2778: bitstring,=None,UP_2779: bitstring,=pkSess_2777));
                                        {2841}new SPc_2780: bitstring;
                                        {2842}new Nc_2781: bitstring;
                                        {2843}let m1_2782: bitstring = (SPc_2780,exp(g,Nc_2781)) in
                                        {2844}out(c, (pkCli_2712,m1_2782));
                                        {2845}in(c, PartS_2783: bitstring);
                                        {2846}let Kcli_2784: bitstring = exp(PartS_2783,Nc_2781) in
                                        {2847}out(c, senc(mCli(pkCli_2712,pkSess_2777),Kcli_2784))
                                    )
                                    else
                                        {2848}let v_2785: bool = (Sess = B) in
                                        (
                                            {2849}if v_2785 then
                                            (
                                                {2850}let pkSess_2786: bitstring = pub(skB) in
                                                {2851}out(c, GetEndpointRequest);
                                                {2852}in(c, (SPs_2787: bitstring,=None,UP_2788: bitstring,=pkSess_2786));
                                                {2853}new SPc_2789: bitstring;
                                                {2854}new Nc_2790: bitstring;
                                                {2855}let m1_2791: bitstring = (SPc_2789,exp(g,Nc_2790)) in
                                                {2856}out(c, (pkCli_2712,m1_2791));
                                                {2857}in(c, PartS_2792: bitstring);
                                                {2858}let Kcli_2793: bitstring = exp(PartS_2792,Nc_2790) in
                                                {2859}out(c, senc(mCli(pkCli_2712,pkSess_2786),Kcli_2793))
                                            )
                                            else
                                                {2860}let v_2794: bool = (Sess = C) in
                                                (
                                                    {2861}if v_2794 then
                                                    (
                                                        {2862}let pkSess_2795: bitstring = pub(skC) in
                                                        {2863}out(c, GetEndpointRequest);
                                                        {2864}in(c, (SPs_2796: bitstring,=None,UP_2797: bitstring,=pkSess_2795));
                                                        {2865}new SPc_2798: bitstring;
                                                        {2866}new Nc_2799: bitstring;
                                                        {2867}let m1_2800: bitstring = (SPc_2798,exp(g,Nc_2799)) in
                                                        {2868}out(c, (pkCli_2712,m1_2800));
                                                        {2869}in(c, PartS_2801: bitstring);
                                                        {2870}let Kcli_2802: bitstring = exp(PartS_2801,Nc_2799) in
                                                        {2871}out(c, senc(mCli(pkCli_2712,pkSess_2795),Kcli_2802))
                                                    )
                                                    else
                                                        {2872}let pkSess_2803: bitstring = pub(skI) in
                                                        {2873}out(c, GetEndpointRequest);
                                                        {2874}in(c, (SPs_2804: bitstring,=None,UP_2805: bitstring,=pkSess_2803));
                                                        {2875}new SPc_2806: bitstring;
                                                        {2876}new Nc_2807: bitstring;
                                                        {2877}let m1_2808: bitstring = (SPc_2806,exp(g,Nc_2807)) in
                                                        {2878}out(c, (pkCli_2712,m1_2808));
                                                        {2879}in(c, PartS_2809: bitstring);
                                                        {2880}let Kcli_2810: bitstring = exp(PartS_2809,Nc_2807) in
                                                        {2881}out(c, senc(mCli(pkCli_2712,pkSess_2803),Kcli_2810))
                                                )
                                                else
                                                    {2882}let pkSess_2811: bitstring = fail-any in
                                                    {2883}out(c, GetEndpointRequest);
                                                    {2884}in(c, (SPs_2812: bitstring,=None,UP_2813: bitstring,=pkSess_2811));
                                                    {2885}new SPc_2814: bitstring;
                                                    {2886}new Nc_2815: bitstring;
                                                    {2887}let m1_2816: bitstring = (SPc_2814,exp(g,Nc_2815)) in
                                                    {2888}out(c, (pkCli_2712,m1_2816));
                                                    {2889}in(c, PartS_2817: bitstring);
                                                    {2890}let Kcli_2818: bitstring = exp(PartS_2817,Nc_2815) in
                                                    {2891}out(c, senc(mCli(pkCli_2712,pkSess_2811),Kcli_2818))
                                        )
                                        else
                                            {2892}let pkSess_2819: bitstring = fail-any in
                                            {2893}out(c, GetEndpointRequest);
                                            {2894}in(c, (SPs_2820: bitstring,=None,UP_2821: bitstring,=pkSess_2819));
                                            {2895}new SPc_2822: bitstring;
                                            {2896}new Nc_2823: bitstring;
                                            {2897}let m1_2824: bitstring = (SPc_2822,exp(g,Nc_2823)) in
                                            {2898}out(c, (pkCli_2712,m1_2824));
                                            {2899}in(c, PartS_2825: bitstring);
                                            {2900}let Kcli_2826: bitstring = exp(PartS_2825,Nc_2823) in
                                            {2901}out(c, senc(mCli(pkCli_2712,pkSess_2819),Kcli_2826))
                                )
                                else
                                    {2902}let pkSess_2827: bitstring = fail-any in
                                    {2903}out(c, GetEndpointRequest);
                                    {2904}in(c, (SPs_2828: bitstring,=None,UP_2829: bitstring,=pkSess_2827));
                                    {2905}new SPc_2830: bitstring;
                                    {2906}new Nc_2831: bitstring;
                                    {2907}let m1_2832: bitstring = (SPc_2830,exp(g,Nc_2831)) in
                                    {2908}out(c, (pkCli_2712,m1_2832));
                                    {2909}in(c, PartS_2833: bitstring);
                                    {2910}let Kcli_2834: bitstring = exp(PartS_2833,Nc_2831) in
                                    {2911}out(c, senc(mCli(pkCli_2712,pkSess_2827),Kcli_2834))
                            )
                            else
                                {2912}let v_2835: bool = (Disco = C) in
                                (
                                    {2913}if v_2835 then
                                    (
                                        {2914}let pkDisco_2836: bitstring = pub(skC) in
                                        {2915}let v_2837: bool = (Sess = A) in
                                        (
                                            {2916}if v_2837 then
                                            (
                                                {2917}let pkSess_2838: bitstring = pub(skA) in
                                                {2918}out(c, GetEndpointRequest);
                                                {2919}in(c, (SPs_2839: bitstring,=None,UP_2840: bitstring,=pkSess_2838));
                                                {2920}new SPc_2841: bitstring;
                                                {2921}new Nc_2842: bitstring;
                                                {2922}let m1_2843: bitstring = (SPc_2841,exp(g,Nc_2842)) in
                                                {2923}out(c, (pkCli_2712,m1_2843));
                                                {2924}in(c, PartS_2844: bitstring);
                                                {2925}let Kcli_2845: bitstring = exp(PartS_2844,Nc_2842) in
                                                {2926}out(c, senc(mCli(pkCli_2712,pkSess_2838),Kcli_2845))
                                            )
                                            else
                                                {2927}let v_2846: bool = (Sess = B) in
                                                (
                                                    {2928}if v_2846 then
                                                    (
                                                        {2929}let pkSess_2847: bitstring = pub(skB) in
                                                        {2930}out(c, GetEndpointRequest);
                                                        {2931}in(c, (SPs_2848: bitstring,=None,UP_2849: bitstring,=pkSess_2847));
                                                        {2932}new SPc_2850: bitstring;
                                                        {2933}new Nc_2851: bitstring;
                                                        {2934}let m1_2852: bitstring = (SPc_2850,exp(g,Nc_2851)) in
                                                        {2935}out(c, (pkCli_2712,m1_2852));
                                                        {2936}in(c, PartS_2853: bitstring);
                                                        {2937}let Kcli_2854: bitstring = exp(PartS_2853,Nc_2851) in
                                                        {2938}out(c, senc(mCli(pkCli_2712,pkSess_2847),Kcli_2854))
                                                    )
                                                    else
                                                        {2939}let v_2855: bool = (Sess = C) in
                                                        (
                                                            {2940}if v_2855 then
                                                            (
                                                                {2941}let pkSess_2856: bitstring = pub(skC) in
                                                                {2942}out(c, GetEndpointRequest);
                                                                {2943}in(c, (SPs_2857: bitstring,=None,UP_2858: bitstring,=pkSess_2856));
                                                                {2944}new SPc_2859: bitstring;
                                                                {2945}new Nc_2860: bitstring;
                                                                {2946}let m1_2861: bitstring = (SPc_2859,exp(g,Nc_2860)) in
                                                                {2947}out(c, (pkCli_2712,m1_2861));
                                                                {2948}in(c, PartS_2862: bitstring);
                                                                {2949}let Kcli_2863: bitstring = exp(PartS_2862,Nc_2860) in
                                                                {2950}out(c, senc(mCli(pkCli_2712,pkSess_2856),Kcli_2863))
                                                            )
                                                            else
                                                                {2951}let pkSess_2864: bitstring = pub(skI) in
                                                                {2952}out(c, GetEndpointRequest);
                                                                {2953}in(c, (SPs_2865: bitstring,=None,UP_2866: bitstring,=pkSess_2864));
                                                                {2954}new SPc_2867: bitstring;
                                                                {2955}new Nc_2868: bitstring;
                                                                {2956}let m1_2869: bitstring = (SPc_2867,exp(g,Nc_2868)) in
                                                                {2957}out(c, (pkCli_2712,m1_2869));
                                                                {2958}in(c, PartS_2870: bitstring);
                                                                {2959}let Kcli_2871: bitstring = exp(PartS_2870,Nc_2868) in
                                                                {2960}out(c, senc(mCli(pkCli_2712,pkSess_2864),Kcli_2871))
                                                        )
                                                        else
                                                            {2961}let pkSess_2872: bitstring = fail-any in
                                                            {2962}out(c, GetEndpointRequest);
                                                            {2963}in(c, (SPs_2873: bitstring,=None,UP_2874: bitstring,=pkSess_2872));
                                                            {2964}new SPc_2875: bitstring;
                                                            {2965}new Nc_2876: bitstring;
                                                            {2966}let m1_2877: bitstring = (SPc_2875,exp(g,Nc_2876)) in
                                                            {2967}out(c, (pkCli_2712,m1_2877));
                                                            {2968}in(c, PartS_2878: bitstring);
                                                            {2969}let Kcli_2879: bitstring = exp(PartS_2878,Nc_2876) in
                                                            {2970}out(c, senc(mCli(pkCli_2712,pkSess_2872),Kcli_2879))
                                                )
                                                else
                                                    {2971}let pkSess_2880: bitstring = fail-any in
                                                    {2972}out(c, GetEndpointRequest);
                                                    {2973}in(c, (SPs_2881: bitstring,=None,UP_2882: bitstring,=pkSess_2880));
                                                    {2974}new SPc_2883: bitstring;
                                                    {2975}new Nc_2884: bitstring;
                                                    {2976}let m1_2885: bitstring = (SPc_2883,exp(g,Nc_2884)) in
                                                    {2977}out(c, (pkCli_2712,m1_2885));
                                                    {2978}in(c, PartS_2886: bitstring);
                                                    {2979}let Kcli_2887: bitstring = exp(PartS_2886,Nc_2884) in
                                                    {2980}out(c, senc(mCli(pkCli_2712,pkSess_2880),Kcli_2887))
                                        )
                                        else
                                            {2981}let pkSess_2888: bitstring = fail-any in
                                            {2982}out(c, GetEndpointRequest);
                                            {2983}in(c, (SPs_2889: bitstring,=None,UP_2890: bitstring,=pkSess_2888));
                                            {2984}new SPc_2891: bitstring;
                                            {2985}new Nc_2892: bitstring;
                                            {2986}let m1_2893: bitstring = (SPc_2891,exp(g,Nc_2892)) in
                                            {2987}out(c, (pkCli_2712,m1_2893));
                                            {2988}in(c, PartS_2894: bitstring);
                                            {2989}let Kcli_2895: bitstring = exp(PartS_2894,Nc_2892) in
                                            {2990}out(c, senc(mCli(pkCli_2712,pkSess_2888),Kcli_2895))
                                    )
                                    else
                                        {2991}let pkDisco_2896: bitstring = pub(skI) in
                                        {2992}let v_2897: bool = (Sess = A) in
                                        (
                                            {2993}if v_2897 then
                                            (
                                                {2994}let pkSess_2898: bitstring = pub(skA) in
                                                {2995}out(c, GetEndpointRequest);
                                                {2996}in(c, (SPs_2899: bitstring,=None,UP_2900: bitstring,=pkSess_2898));
                                                {2997}new SPc_2901: bitstring;
                                                {2998}new Nc_2902: bitstring;
                                                {2999}let m1_2903: bitstring = (SPc_2901,exp(g,Nc_2902)) in
                                                {3000}out(c, (pkCli_2712,m1_2903));
                                                {3001}in(c, PartS_2904: bitstring);
                                                {3002}let Kcli_2905: bitstring = exp(PartS_2904,Nc_2902) in
                                                {3003}out(c, senc(mCli(pkCli_2712,pkSess_2898),Kcli_2905))
                                            )
                                            else
                                                {3004}let v_2906: bool = (Sess = B) in
                                                (
                                                    {3005}if v_2906 then
                                                    (
                                                        {3006}let pkSess_2907: bitstring = pub(skB) in
                                                        {3007}out(c, GetEndpointRequest);
                                                        {3008}in(c, (SPs_2908: bitstring,=None,UP_2909: bitstring,=pkSess_2907));
                                                        {3009}new SPc_2910: bitstring;
                                                        {3010}new Nc_2911: bitstring;
                                                        {3011}let m1_2912: bitstring = (SPc_2910,exp(g,Nc_2911)) in
                                                        {3012}out(c, (pkCli_2712,m1_2912));
                                                        {3013}in(c, PartS_2913: bitstring);
                                                        {3014}let Kcli_2914: bitstring = exp(PartS_2913,Nc_2911) in
                                                        {3015}out(c, senc(mCli(pkCli_2712,pkSess_2907),Kcli_2914))
                                                    )
                                                    else
                                                        {3016}let v_2915: bool = (Sess = C) in
                                                        (
                                                            {3017}if v_2915 then
                                                            (
                                                                {3018}let pkSess_2916: bitstring = pub(skC) in
                                                                {3019}out(c, GetEndpointRequest);
                                                                {3020}in(c, (SPs_2917: bitstring,=None,UP_2918: bitstring,=pkSess_2916));
                                                                {3021}new SPc_2919: bitstring;
                                                                {3022}new Nc_2920: bitstring;
                                                                {3023}let m1_2921: bitstring = (SPc_2919,exp(g,Nc_2920)) in
                                                                {3024}out(c, (pkCli_2712,m1_2921));
                                                                {3025}in(c, PartS_2922: bitstring);
                                                                {3026}let Kcli_2923: bitstring = exp(PartS_2922,Nc_2920) in
                                                                {3027}out(c, senc(mCli(pkCli_2712,pkSess_2916),Kcli_2923))
                                                            )
                                                            else
                                                                {3028}let pkSess_2924: bitstring = pub(skI) in
                                                                {3029}out(c, GetEndpointRequest);
                                                                {3030}in(c, (SPs_2925: bitstring,=None,UP_2926: bitstring,=pkSess_2924));
                                                                {3031}new SPc_2927: bitstring;
                                                                {3032}new Nc_2928: bitstring;
                                                                {3033}let m1_2929: bitstring = (SPc_2927,exp(g,Nc_2928)) in
                                                                {3034}out(c, (pkCli_2712,m1_2929));
                                                                {3035}in(c, PartS_2930: bitstring);
                                                                {3036}let Kcli_2931: bitstring = exp(PartS_2930,Nc_2928) in
                                                                {3037}out(c, senc(mCli(pkCli_2712,pkSess_2924),Kcli_2931))
                                                        )
                                                        else
                                                            {3038}let pkSess_2932: bitstring = fail-any in
                                                            {3039}out(c, GetEndpointRequest);
                                                            {3040}in(c, (SPs_2933: bitstring,=None,UP_2934: bitstring,=pkSess_2932));
                                                            {3041}new SPc_2935: bitstring;
                                                            {3042}new Nc_2936: bitstring;
                                                            {3043}let m1_2937: bitstring = (SPc_2935,exp(g,Nc_2936)) in
                                                            {3044}out(c, (pkCli_2712,m1_2937));
                                                            {3045}in(c, PartS_2938: bitstring);
                                                            {3046}let Kcli_2939: bitstring = exp(PartS_2938,Nc_2936) in
                                                            {3047}out(c, senc(mCli(pkCli_2712,pkSess_2932),Kcli_2939))
                                                )
                                                else
                                                    {3048}let pkSess_2940: bitstring = fail-any in
                                                    {3049}out(c, GetEndpointRequest);
                                                    {3050}in(c, (SPs_2941: bitstring,=None,UP_2942: bitstring,=pkSess_2940));
                                                    {3051}new SPc_2943: bitstring;
                                                    {3052}new Nc_2944: bitstring;
                                                    {3053}let m1_2945: bitstring = (SPc_2943,exp(g,Nc_2944)) in
                                                    {3054}out(c, (pkCli_2712,m1_2945));
                                                    {3055}in(c, PartS_2946: bitstring);
                                                    {3056}let Kcli_2947: bitstring = exp(PartS_2946,Nc_2944) in
                                                    {3057}out(c, senc(mCli(pkCli_2712,pkSess_2940),Kcli_2947))
                                        )
                                        else
                                            {3058}let pkSess_2948: bitstring = fail-any in
                                            {3059}out(c, GetEndpointRequest);
                                            {3060}in(c, (SPs_2949: bitstring,=None,UP_2950: bitstring,=pkSess_2948));
                                            {3061}new SPc_2951: bitstring;
                                            {3062}new Nc_2952: bitstring;
                                            {3063}let m1_2953: bitstring = (SPc_2951,exp(g,Nc_2952)) in
                                            {3064}out(c, (pkCli_2712,m1_2953));
                                            {3065}in(c, PartS_2954: bitstring);
                                            {3066}let Kcli_2955: bitstring = exp(PartS_2954,Nc_2952) in
                                            {3067}out(c, senc(mCli(pkCli_2712,pkSess_2948),Kcli_2955))
                                )
                                else
                                    {3068}let pkDisco_2956: bitstring = fail-any in
                                    {3069}let v_2957: bool = (Sess = A) in
                                    (
                                        {3070}if v_2957 then
                                        (
                                            {3071}let pkSess_2958: bitstring = pub(skA) in
                                            {3072}out(c, GetEndpointRequest);
                                            {3073}in(c, (SPs_2959: bitstring,=None,UP_2960: bitstring,=pkSess_2958));
                                            {3074}new SPc_2961: bitstring;
                                            {3075}new Nc_2962: bitstring;
                                            {3076}let m1_2963: bitstring = (SPc_2961,exp(g,Nc_2962)) in
                                            {3077}out(c, (pkCli_2712,m1_2963));
                                            {3078}in(c, PartS_2964: bitstring);
                                            {3079}let Kcli_2965: bitstring = exp(PartS_2964,Nc_2962) in
                                            {3080}out(c, senc(mCli(pkCli_2712,pkSess_2958),Kcli_2965))
                                        )
                                        else
                                            {3081}let v_2966: bool = (Sess = B) in
                                            (
                                                {3082}if v_2966 then
                                                (
                                                    {3083}let pkSess_2967: bitstring = pub(skB) in
                                                    {3084}out(c, GetEndpointRequest);
                                                    {3085}in(c, (SPs_2968: bitstring,=None,UP_2969: bitstring,=pkSess_2967));
                                                    {3086}new SPc_2970: bitstring;
                                                    {3087}new Nc_2971: bitstring;
                                                    {3088}let m1_2972: bitstring = (SPc_2970,exp(g,Nc_2971)) in
                                                    {3089}out(c, (pkCli_2712,m1_2972));
                                                    {3090}in(c, PartS_2973: bitstring);
                                                    {3091}let Kcli_2974: bitstring = exp(PartS_2973,Nc_2971) in
                                                    {3092}out(c, senc(mCli(pkCli_2712,pkSess_2967),Kcli_2974))
                                                )
                                                else
                                                    {3093}let v_2975: bool = (Sess = C) in
                                                    (
                                                        {3094}if v_2975 then
                                                        (
                                                            {3095}let pkSess_2976: bitstring = pub(skC) in
                                                            {3096}out(c, GetEndpointRequest);
                                                            {3097}in(c, (SPs_2977: bitstring,=None,UP_2978: bitstring,=pkSess_2976));
                                                            {3098}new SPc_2979: bitstring;
                                                            {3099}new Nc_2980: bitstring;
                                                            {3100}let m1_2981: bitstring = (SPc_2979,exp(g,Nc_2980)) in
                                                            {3101}out(c, (pkCli_2712,m1_2981));
                                                            {3102}in(c, PartS_2982: bitstring);
                                                            {3103}let Kcli_2983: bitstring = exp(PartS_2982,Nc_2980) in
                                                            {3104}out(c, senc(mCli(pkCli_2712,pkSess_2976),Kcli_2983))
                                                        )
                                                        else
                                                            {3105}let pkSess_2984: bitstring = pub(skI) in
                                                            {3106}out(c, GetEndpointRequest);
                                                            {3107}in(c, (SPs_2985: bitstring,=None,UP_2986: bitstring,=pkSess_2984));
                                                            {3108}new SPc_2987: bitstring;
                                                            {3109}new Nc_2988: bitstring;
                                                            {3110}let m1_2989: bitstring = (SPc_2987,exp(g,Nc_2988)) in
                                                            {3111}out(c, (pkCli_2712,m1_2989));
                                                            {3112}in(c, PartS_2990: bitstring);
                                                            {3113}let Kcli_2991: bitstring = exp(PartS_2990,Nc_2988) in
                                                            {3114}out(c, senc(mCli(pkCli_2712,pkSess_2984),Kcli_2991))
                                                    )
                                                    else
                                                        {3115}let pkSess_2992: bitstring = fail-any in
                                                        {3116}out(c, GetEndpointRequest);
                                                        {3117}in(c, (SPs_2993: bitstring,=None,UP_2994: bitstring,=pkSess_2992));
                                                        {3118}new SPc_2995: bitstring;
                                                        {3119}new Nc_2996: bitstring;
                                                        {3120}let m1_2997: bitstring = (SPc_2995,exp(g,Nc_2996)) in
                                                        {3121}out(c, (pkCli_2712,m1_2997));
                                                        {3122}in(c, PartS_2998: bitstring);
                                                        {3123}let Kcli_2999: bitstring = exp(PartS_2998,Nc_2996) in
                                                        {3124}out(c, senc(mCli(pkCli_2712,pkSess_2992),Kcli_2999))
                                            )
                                            else
                                                {3125}let pkSess_3000: bitstring = fail-any in
                                                {3126}out(c, GetEndpointRequest);
                                                {3127}in(c, (SPs_3001: bitstring,=None,UP_3002: bitstring,=pkSess_3000));
                                                {3128}new SPc_3003: bitstring;
                                                {3129}new Nc_3004: bitstring;
                                                {3130}let m1_3005: bitstring = (SPc_3003,exp(g,Nc_3004)) in
                                                {3131}out(c, (pkCli_2712,m1_3005));
                                                {3132}in(c, PartS_3006: bitstring);
                                                {3133}let Kcli_3007: bitstring = exp(PartS_3006,Nc_3004) in
                                                {3134}out(c, senc(mCli(pkCli_2712,pkSess_3000),Kcli_3007))
                                    )
                                    else
                                        {3135}let pkSess_3008: bitstring = fail-any in
                                        {3136}out(c, GetEndpointRequest);
                                        {3137}in(c, (SPs_3009: bitstring,=None,UP_3010: bitstring,=pkSess_3008));
                                        {3138}new SPc_3011: bitstring;
                                        {3139}new Nc_3012: bitstring;
                                        {3140}let m1_3013: bitstring = (SPc_3011,exp(g,Nc_3012)) in
                                        {3141}out(c, (pkCli_2712,m1_3013));
                                        {3142}in(c, PartS_3014: bitstring);
                                        {3143}let Kcli_3015: bitstring = exp(PartS_3014,Nc_3012) in
                                        {3144}out(c, senc(mCli(pkCli_2712,pkSess_3008),Kcli_3015))
                        )
                        else
                            {3145}let pkDisco_3016: bitstring = fail-any in
                            {3146}let v_3017: bool = (Sess = A) in
                            (
                                {3147}if v_3017 then
                                (
                                    {3148}let pkSess_3018: bitstring = pub(skA) in
                                    {3149}out(c, GetEndpointRequest);
                                    {3150}in(c, (SPs_3019: bitstring,=None,UP_3020: bitstring,=pkSess_3018));
                                    {3151}new SPc_3021: bitstring;
                                    {3152}new Nc_3022: bitstring;
                                    {3153}let m1_3023: bitstring = (SPc_3021,exp(g,Nc_3022)) in
                                    {3154}out(c, (pkCli_2712,m1_3023));
                                    {3155}in(c, PartS_3024: bitstring);
                                    {3156}let Kcli_3025: bitstring = exp(PartS_3024,Nc_3022) in
                                    {3157}out(c, senc(mCli(pkCli_2712,pkSess_3018),Kcli_3025))
                                )
                                else
                                    {3158}let v_3026: bool = (Sess = B) in
                                    (
                                        {3159}if v_3026 then
                                        (
                                            {3160}let pkSess_3027: bitstring = pub(skB) in
                                            {3161}out(c, GetEndpointRequest);
                                            {3162}in(c, (SPs_3028: bitstring,=None,UP_3029: bitstring,=pkSess_3027));
                                            {3163}new SPc_3030: bitstring;
                                            {3164}new Nc_3031: bitstring;
                                            {3165}let m1_3032: bitstring = (SPc_3030,exp(g,Nc_3031)) in
                                            {3166}out(c, (pkCli_2712,m1_3032));
                                            {3167}in(c, PartS_3033: bitstring);
                                            {3168}let Kcli_3034: bitstring = exp(PartS_3033,Nc_3031) in
                                            {3169}out(c, senc(mCli(pkCli_2712,pkSess_3027),Kcli_3034))
                                        )
                                        else
                                            {3170}let v_3035: bool = (Sess = C) in
                                            (
                                                {3171}if v_3035 then
                                                (
                                                    {3172}let pkSess_3036: bitstring = pub(skC) in
                                                    {3173}out(c, GetEndpointRequest);
                                                    {3174}in(c, (SPs_3037: bitstring,=None,UP_3038: bitstring,=pkSess_3036));
                                                    {3175}new SPc_3039: bitstring;
                                                    {3176}new Nc_3040: bitstring;
                                                    {3177}let m1_3041: bitstring = (SPc_3039,exp(g,Nc_3040)) in
                                                    {3178}out(c, (pkCli_2712,m1_3041));
                                                    {3179}in(c, PartS_3042: bitstring);
                                                    {3180}let Kcli_3043: bitstring = exp(PartS_3042,Nc_3040) in
                                                    {3181}out(c, senc(mCli(pkCli_2712,pkSess_3036),Kcli_3043))
                                                )
                                                else
                                                    {3182}let pkSess_3044: bitstring = pub(skI) in
                                                    {3183}out(c, GetEndpointRequest);
                                                    {3184}in(c, (SPs_3045: bitstring,=None,UP_3046: bitstring,=pkSess_3044));
                                                    {3185}new SPc_3047: bitstring;
                                                    {3186}new Nc_3048: bitstring;
                                                    {3187}let m1_3049: bitstring = (SPc_3047,exp(g,Nc_3048)) in
                                                    {3188}out(c, (pkCli_2712,m1_3049));
                                                    {3189}in(c, PartS_3050: bitstring);
                                                    {3190}let Kcli_3051: bitstring = exp(PartS_3050,Nc_3048) in
                                                    {3191}out(c, senc(mCli(pkCli_2712,pkSess_3044),Kcli_3051))
                                            )
                                            else
                                                {3192}let pkSess_3052: bitstring = fail-any in
                                                {3193}out(c, GetEndpointRequest);
                                                {3194}in(c, (SPs_3053: bitstring,=None,UP_3054: bitstring,=pkSess_3052));
                                                {3195}new SPc_3055: bitstring;
                                                {3196}new Nc_3056: bitstring;
                                                {3197}let m1_3057: bitstring = (SPc_3055,exp(g,Nc_3056)) in
                                                {3198}out(c, (pkCli_2712,m1_3057));
                                                {3199}in(c, PartS_3058: bitstring);
                                                {3200}let Kcli_3059: bitstring = exp(PartS_3058,Nc_3056) in
                                                {3201}out(c, senc(mCli(pkCli_2712,pkSess_3052),Kcli_3059))
                                    )
                                    else
                                        {3202}let pkSess_3060: bitstring = fail-any in
                                        {3203}out(c, GetEndpointRequest);
                                        {3204}in(c, (SPs_3061: bitstring,=None,UP_3062: bitstring,=pkSess_3060));
                                        {3205}new SPc_3063: bitstring;
                                        {3206}new Nc_3064: bitstring;
                                        {3207}let m1_3065: bitstring = (SPc_3063,exp(g,Nc_3064)) in
                                        {3208}out(c, (pkCli_2712,m1_3065));
                                        {3209}in(c, PartS_3066: bitstring);
                                        {3210}let Kcli_3067: bitstring = exp(PartS_3066,Nc_3064) in
                                        {3211}out(c, senc(mCli(pkCli_2712,pkSess_3060),Kcli_3067))
                            )
                            else
                                {3212}let pkSess_3068: bitstring = fail-any in
                                {3213}out(c, GetEndpointRequest);
                                {3214}in(c, (SPs_3069: bitstring,=None,UP_3070: bitstring,=pkSess_3068));
                                {3215}new SPc_3071: bitstring;
                                {3216}new Nc_3072: bitstring;
                                {3217}let m1_3073: bitstring = (SPc_3071,exp(g,Nc_3072)) in
                                {3218}out(c, (pkCli_2712,m1_3073));
                                {3219}in(c, PartS_3074: bitstring);
                                {3220}let Kcli_3075: bitstring = exp(PartS_3074,Nc_3072) in
                                {3221}out(c, senc(mCli(pkCli_2712,pkSess_3068),Kcli_3075))
                )
                else
                    {3222}let pkDisco_3076: bitstring = fail-any in
                    {3223}let v_3077: bool = (Sess = A) in
                    (
                        {3224}if v_3077 then
                        (
                            {3225}let pkSess_3078: bitstring = pub(skA) in
                            {3226}out(c, GetEndpointRequest);
                            {3227}in(c, (SPs_3079: bitstring,=None,UP_3080: bitstring,=pkSess_3078));
                            {3228}new SPc_3081: bitstring;
                            {3229}new Nc_3082: bitstring;
                            {3230}let m1_3083: bitstring = (SPc_3081,exp(g,Nc_3082)) in
                            {3231}out(c, (pkCli_2712,m1_3083));
                            {3232}in(c, PartS_3084: bitstring);
                            {3233}let Kcli_3085: bitstring = exp(PartS_3084,Nc_3082) in
                            {3234}out(c, senc(mCli(pkCli_2712,pkSess_3078),Kcli_3085))
                        )
                        else
                            {3235}let v_3086: bool = (Sess = B) in
                            (
                                {3236}if v_3086 then
                                (
                                    {3237}let pkSess_3087: bitstring = pub(skB) in
                                    {3238}out(c, GetEndpointRequest);
                                    {3239}in(c, (SPs_3088: bitstring,=None,UP_3089: bitstring,=pkSess_3087));
                                    {3240}new SPc_3090: bitstring;
                                    {3241}new Nc_3091: bitstring;
                                    {3242}let m1_3092: bitstring = (SPc_3090,exp(g,Nc_3091)) in
                                    {3243}out(c, (pkCli_2712,m1_3092));
                                    {3244}in(c, PartS_3093: bitstring);
                                    {3245}let Kcli_3094: bitstring = exp(PartS_3093,Nc_3091) in
                                    {3246}out(c, senc(mCli(pkCli_2712,pkSess_3087),Kcli_3094))
                                )
                                else
                                    {3247}let v_3095: bool = (Sess = C) in
                                    (
                                        {3248}if v_3095 then
                                        (
                                            {3249}let pkSess_3096: bitstring = pub(skC) in
                                            {3250}out(c, GetEndpointRequest);
                                            {3251}in(c, (SPs_3097: bitstring,=None,UP_3098: bitstring,=pkSess_3096));
                                            {3252}new SPc_3099: bitstring;
                                            {3253}new Nc_3100: bitstring;
                                            {3254}let m1_3101: bitstring = (SPc_3099,exp(g,Nc_3100)) in
                                            {3255}out(c, (pkCli_2712,m1_3101));
                                            {3256}in(c, PartS_3102: bitstring);
                                            {3257}let Kcli_3103: bitstring = exp(PartS_3102,Nc_3100) in
                                            {3258}out(c, senc(mCli(pkCli_2712,pkSess_3096),Kcli_3103))
                                        )
                                        else
                                            {3259}let pkSess_3104: bitstring = pub(skI) in
                                            {3260}out(c, GetEndpointRequest);
                                            {3261}in(c, (SPs_3105: bitstring,=None,UP_3106: bitstring,=pkSess_3104));
                                            {3262}new SPc_3107: bitstring;
                                            {3263}new Nc_3108: bitstring;
                                            {3264}let m1_3109: bitstring = (SPc_3107,exp(g,Nc_3108)) in
                                            {3265}out(c, (pkCli_2712,m1_3109));
                                            {3266}in(c, PartS_3110: bitstring);
                                            {3267}let Kcli_3111: bitstring = exp(PartS_3110,Nc_3108) in
                                            {3268}out(c, senc(mCli(pkCli_2712,pkSess_3104),Kcli_3111))
                                    )
                                    else
                                        {3269}let pkSess_3112: bitstring = fail-any in
                                        {3270}out(c, GetEndpointRequest);
                                        {3271}in(c, (SPs_3113: bitstring,=None,UP_3114: bitstring,=pkSess_3112));
                                        {3272}new SPc_3115: bitstring;
                                        {3273}new Nc_3116: bitstring;
                                        {3274}let m1_3117: bitstring = (SPc_3115,exp(g,Nc_3116)) in
                                        {3275}out(c, (pkCli_2712,m1_3117));
                                        {3276}in(c, PartS_3118: bitstring);
                                        {3277}let Kcli_3119: bitstring = exp(PartS_3118,Nc_3116) in
                                        {3278}out(c, senc(mCli(pkCli_2712,pkSess_3112),Kcli_3119))
                            )
                            else
                                {3279}let pkSess_3120: bitstring = fail-any in
                                {3280}out(c, GetEndpointRequest);
                                {3281}in(c, (SPs_3121: bitstring,=None,UP_3122: bitstring,=pkSess_3120));
                                {3282}new SPc_3123: bitstring;
                                {3283}new Nc_3124: bitstring;
                                {3284}let m1_3125: bitstring = (SPc_3123,exp(g,Nc_3124)) in
                                {3285}out(c, (pkCli_2712,m1_3125));
                                {3286}in(c, PartS_3126: bitstring);
                                {3287}let Kcli_3127: bitstring = exp(PartS_3126,Nc_3124) in
                                {3288}out(c, senc(mCli(pkCli_2712,pkSess_3120),Kcli_3127))
                    )
                    else
                        {3289}let pkSess_3128: bitstring = fail-any in
                        {3290}out(c, GetEndpointRequest);
                        {3291}in(c, (SPs_3129: bitstring,=None,UP_3130: bitstring,=pkSess_3128));
                        {3292}new SPc_3131: bitstring;
                        {3293}new Nc_3132: bitstring;
                        {3294}let m1_3133: bitstring = (SPc_3131,exp(g,Nc_3132)) in
                        {3295}out(c, (pkCli_2712,m1_3133));
                        {3296}in(c, PartS_3134: bitstring);
                        {3297}let Kcli_3135: bitstring = exp(PartS_3134,Nc_3132) in
                        {3298}out(c, senc(mCli(pkCli_2712,pkSess_3128),Kcli_3135))
    )
    else
        {3299}let skCli_3136: bitstring = fail-any in
        {3300}let pkCli_3137: bitstring = pub(skCli_3136) in
        {3301}let v_3138: bool = (Disco = A) in
        (
            {3302}if v_3138 then
            (
                {3303}let pkDisco_3139: bitstring = pub(skA) in
                {3304}let v_3140: bool = (Sess = A) in
                (
                    {3305}if v_3140 then
                    (
                        {3306}let pkSess_3141: bitstring = pub(skA) in
                        {3307}out(c, GetEndpointRequest);
                        {3308}in(c, (SPs_3142: bitstring,=None,UP_3143: bitstring,=pkSess_3141));
                        {3309}new SPc_3144: bitstring;
                        {3310}new Nc_3145: bitstring;
                        {3311}let m1_3146: bitstring = (SPc_3144,exp(g,Nc_3145)) in
                        {3312}out(c, (pkCli_3137,m1_3146));
                        {3313}in(c, PartS_3147: bitstring);
                        {3314}let Kcli_3148: bitstring = exp(PartS_3147,Nc_3145) in
                        {3315}out(c, senc(mCli(pkCli_3137,pkSess_3141),Kcli_3148))
                    )
                    else
                        {3316}let v_3149: bool = (Sess = B) in
                        (
                            {3317}if v_3149 then
                            (
                                {3318}let pkSess_3150: bitstring = pub(skB) in
                                {3319}out(c, GetEndpointRequest);
                                {3320}in(c, (SPs_3151: bitstring,=None,UP_3152: bitstring,=pkSess_3150));
                                {3321}new SPc_3153: bitstring;
                                {3322}new Nc_3154: bitstring;
                                {3323}let m1_3155: bitstring = (SPc_3153,exp(g,Nc_3154)) in
                                {3324}out(c, (pkCli_3137,m1_3155));
                                {3325}in(c, PartS_3156: bitstring);
                                {3326}let Kcli_3157: bitstring = exp(PartS_3156,Nc_3154) in
                                {3327}out(c, senc(mCli(pkCli_3137,pkSess_3150),Kcli_3157))
                            )
                            else
                                {3328}let v_3158: bool = (Sess = C) in
                                (
                                    {3329}if v_3158 then
                                    (
                                        {3330}let pkSess_3159: bitstring = pub(skC) in
                                        {3331}out(c, GetEndpointRequest);
                                        {3332}in(c, (SPs_3160: bitstring,=None,UP_3161: bitstring,=pkSess_3159));
                                        {3333}new SPc_3162: bitstring;
                                        {3334}new Nc_3163: bitstring;
                                        {3335}let m1_3164: bitstring = (SPc_3162,exp(g,Nc_3163)) in
                                        {3336}out(c, (pkCli_3137,m1_3164));
                                        {3337}in(c, PartS_3165: bitstring);
                                        {3338}let Kcli_3166: bitstring = exp(PartS_3165,Nc_3163) in
                                        {3339}out(c, senc(mCli(pkCli_3137,pkSess_3159),Kcli_3166))
                                    )
                                    else
                                        {3340}let pkSess_3167: bitstring = pub(skI) in
                                        {3341}out(c, GetEndpointRequest);
                                        {3342}in(c, (SPs_3168: bitstring,=None,UP_3169: bitstring,=pkSess_3167));
                                        {3343}new SPc_3170: bitstring;
                                        {3344}new Nc_3171: bitstring;
                                        {3345}let m1_3172: bitstring = (SPc_3170,exp(g,Nc_3171)) in
                                        {3346}out(c, (pkCli_3137,m1_3172));
                                        {3347}in(c, PartS_3173: bitstring);
                                        {3348}let Kcli_3174: bitstring = exp(PartS_3173,Nc_3171) in
                                        {3349}out(c, senc(mCli(pkCli_3137,pkSess_3167),Kcli_3174))
                                )
                                else
                                    {3350}let pkSess_3175: bitstring = fail-any in
                                    {3351}out(c, GetEndpointRequest);
                                    {3352}in(c, (SPs_3176: bitstring,=None,UP_3177: bitstring,=pkSess_3175));
                                    {3353}new SPc_3178: bitstring;
                                    {3354}new Nc_3179: bitstring;
                                    {3355}let m1_3180: bitstring = (SPc_3178,exp(g,Nc_3179)) in
                                    {3356}out(c, (pkCli_3137,m1_3180));
                                    {3357}in(c, PartS_3181: bitstring);
                                    {3358}let Kcli_3182: bitstring = exp(PartS_3181,Nc_3179) in
                                    {3359}out(c, senc(mCli(pkCli_3137,pkSess_3175),Kcli_3182))
                        )
                        else
                            {3360}let pkSess_3183: bitstring = fail-any in
                            {3361}out(c, GetEndpointRequest);
                            {3362}in(c, (SPs_3184: bitstring,=None,UP_3185: bitstring,=pkSess_3183));
                            {3363}new SPc_3186: bitstring;
                            {3364}new Nc_3187: bitstring;
                            {3365}let m1_3188: bitstring = (SPc_3186,exp(g,Nc_3187)) in
                            {3366}out(c, (pkCli_3137,m1_3188));
                            {3367}in(c, PartS_3189: bitstring);
                            {3368}let Kcli_3190: bitstring = exp(PartS_3189,Nc_3187) in
                            {3369}out(c, senc(mCli(pkCli_3137,pkSess_3183),Kcli_3190))
                )
                else
                    {3370}let pkSess_3191: bitstring = fail-any in
                    {3371}out(c, GetEndpointRequest);
                    {3372}in(c, (SPs_3192: bitstring,=None,UP_3193: bitstring,=pkSess_3191));
                    {3373}new SPc_3194: bitstring;
                    {3374}new Nc_3195: bitstring;
                    {3375}let m1_3196: bitstring = (SPc_3194,exp(g,Nc_3195)) in
                    {3376}out(c, (pkCli_3137,m1_3196));
                    {3377}in(c, PartS_3197: bitstring);
                    {3378}let Kcli_3198: bitstring = exp(PartS_3197,Nc_3195) in
                    {3379}out(c, senc(mCli(pkCli_3137,pkSess_3191),Kcli_3198))
            )
            else
                {3380}let v_3199: bool = (Disco = B) in
                (
                    {3381}if v_3199 then
                    (
                        {3382}let pkDisco_3200: bitstring = pub(skB) in
                        {3383}let v_3201: bool = (Sess = A) in
                        (
                            {3384}if v_3201 then
                            (
                                {3385}let pkSess_3202: bitstring = pub(skA) in
                                {3386}out(c, GetEndpointRequest);
                                {3387}in(c, (SPs_3203: bitstring,=None,UP_3204: bitstring,=pkSess_3202));
                                {3388}new SPc_3205: bitstring;
                                {3389}new Nc_3206: bitstring;
                                {3390}let m1_3207: bitstring = (SPc_3205,exp(g,Nc_3206)) in
                                {3391}out(c, (pkCli_3137,m1_3207));
                                {3392}in(c, PartS_3208: bitstring);
                                {3393}let Kcli_3209: bitstring = exp(PartS_3208,Nc_3206) in
                                {3394}out(c, senc(mCli(pkCli_3137,pkSess_3202),Kcli_3209))
                            )
                            else
                                {3395}let v_3210: bool = (Sess = B) in
                                (
                                    {3396}if v_3210 then
                                    (
                                        {3397}let pkSess_3211: bitstring = pub(skB) in
                                        {3398}out(c, GetEndpointRequest);
                                        {3399}in(c, (SPs_3212: bitstring,=None,UP_3213: bitstring,=pkSess_3211));
                                        {3400}new SPc_3214: bitstring;
                                        {3401}new Nc_3215: bitstring;
                                        {3402}let m1_3216: bitstring = (SPc_3214,exp(g,Nc_3215)) in
                                        {3403}out(c, (pkCli_3137,m1_3216));
                                        {3404}in(c, PartS_3217: bitstring);
                                        {3405}let Kcli_3218: bitstring = exp(PartS_3217,Nc_3215) in
                                        {3406}out(c, senc(mCli(pkCli_3137,pkSess_3211),Kcli_3218))
                                    )
                                    else
                                        {3407}let v_3219: bool = (Sess = C) in
                                        (
                                            {3408}if v_3219 then
                                            (
                                                {3409}let pkSess_3220: bitstring = pub(skC) in
                                                {3410}out(c, GetEndpointRequest);
                                                {3411}in(c, (SPs_3221: bitstring,=None,UP_3222: bitstring,=pkSess_3220));
                                                {3412}new SPc_3223: bitstring;
                                                {3413}new Nc_3224: bitstring;
                                                {3414}let m1_3225: bitstring = (SPc_3223,exp(g,Nc_3224)) in
                                                {3415}out(c, (pkCli_3137,m1_3225));
                                                {3416}in(c, PartS_3226: bitstring);
                                                {3417}let Kcli_3227: bitstring = exp(PartS_3226,Nc_3224) in
                                                {3418}out(c, senc(mCli(pkCli_3137,pkSess_3220),Kcli_3227))
                                            )
                                            else
                                                {3419}let pkSess_3228: bitstring = pub(skI) in
                                                {3420}out(c, GetEndpointRequest);
                                                {3421}in(c, (SPs_3229: bitstring,=None,UP_3230: bitstring,=pkSess_3228));
                                                {3422}new SPc_3231: bitstring;
                                                {3423}new Nc_3232: bitstring;
                                                {3424}let m1_3233: bitstring = (SPc_3231,exp(g,Nc_3232)) in
                                                {3425}out(c, (pkCli_3137,m1_3233));
                                                {3426}in(c, PartS_3234: bitstring);
                                                {3427}let Kcli_3235: bitstring = exp(PartS_3234,Nc_3232) in
                                                {3428}out(c, senc(mCli(pkCli_3137,pkSess_3228),Kcli_3235))
                                        )
                                        else
                                            {3429}let pkSess_3236: bitstring = fail-any in
                                            {3430}out(c, GetEndpointRequest);
                                            {3431}in(c, (SPs_3237: bitstring,=None,UP_3238: bitstring,=pkSess_3236));
                                            {3432}new SPc_3239: bitstring;
                                            {3433}new Nc_3240: bitstring;
                                            {3434}let m1_3241: bitstring = (SPc_3239,exp(g,Nc_3240)) in
                                            {3435}out(c, (pkCli_3137,m1_3241));
                                            {3436}in(c, PartS_3242: bitstring);
                                            {3437}let Kcli_3243: bitstring = exp(PartS_3242,Nc_3240) in
                                            {3438}out(c, senc(mCli(pkCli_3137,pkSess_3236),Kcli_3243))
                                )
                                else
                                    {3439}let pkSess_3244: bitstring = fail-any in
                                    {3440}out(c, GetEndpointRequest);
                                    {3441}in(c, (SPs_3245: bitstring,=None,UP_3246: bitstring,=pkSess_3244));
                                    {3442}new SPc_3247: bitstring;
                                    {3443}new Nc_3248: bitstring;
                                    {3444}let m1_3249: bitstring = (SPc_3247,exp(g,Nc_3248)) in
                                    {3445}out(c, (pkCli_3137,m1_3249));
                                    {3446}in(c, PartS_3250: bitstring);
                                    {3447}let Kcli_3251: bitstring = exp(PartS_3250,Nc_3248) in
                                    {3448}out(c, senc(mCli(pkCli_3137,pkSess_3244),Kcli_3251))
                        )
                        else
                            {3449}let pkSess_3252: bitstring = fail-any in
                            {3450}out(c, GetEndpointRequest);
                            {3451}in(c, (SPs_3253: bitstring,=None,UP_3254: bitstring,=pkSess_3252));
                            {3452}new SPc_3255: bitstring;
                            {3453}new Nc_3256: bitstring;
                            {3454}let m1_3257: bitstring = (SPc_3255,exp(g,Nc_3256)) in
                            {3455}out(c, (pkCli_3137,m1_3257));
                            {3456}in(c, PartS_3258: bitstring);
                            {3457}let Kcli_3259: bitstring = exp(PartS_3258,Nc_3256) in
                            {3458}out(c, senc(mCli(pkCli_3137,pkSess_3252),Kcli_3259))
                    )
                    else
                        {3459}let v_3260: bool = (Disco = C) in
                        (
                            {3460}if v_3260 then
                            (
                                {3461}let pkDisco_3261: bitstring = pub(skC) in
                                {3462}let v_3262: bool = (Sess = A) in
                                (
                                    {3463}if v_3262 then
                                    (
                                        {3464}let pkSess_3263: bitstring = pub(skA) in
                                        {3465}out(c, GetEndpointRequest);
                                        {3466}in(c, (SPs_3264: bitstring,=None,UP_3265: bitstring,=pkSess_3263));
                                        {3467}new SPc_3266: bitstring;
                                        {3468}new Nc_3267: bitstring;
                                        {3469}let m1_3268: bitstring = (SPc_3266,exp(g,Nc_3267)) in
                                        {3470}out(c, (pkCli_3137,m1_3268));
                                        {3471}in(c, PartS_3269: bitstring);
                                        {3472}let Kcli_3270: bitstring = exp(PartS_3269,Nc_3267) in
                                        {3473}out(c, senc(mCli(pkCli_3137,pkSess_3263),Kcli_3270))
                                    )
                                    else
                                        {3474}let v_3271: bool = (Sess = B) in
                                        (
                                            {3475}if v_3271 then
                                            (
                                                {3476}let pkSess_3272: bitstring = pub(skB) in
                                                {3477}out(c, GetEndpointRequest);
                                                {3478}in(c, (SPs_3273: bitstring,=None,UP_3274: bitstring,=pkSess_3272));
                                                {3479}new SPc_3275: bitstring;
                                                {3480}new Nc_3276: bitstring;
                                                {3481}let m1_3277: bitstring = (SPc_3275,exp(g,Nc_3276)) in
                                                {3482}out(c, (pkCli_3137,m1_3277));
                                                {3483}in(c, PartS_3278: bitstring);
                                                {3484}let Kcli_3279: bitstring = exp(PartS_3278,Nc_3276) in
                                                {3485}out(c, senc(mCli(pkCli_3137,pkSess_3272),Kcli_3279))
                                            )
                                            else
                                                {3486}let v_3280: bool = (Sess = C) in
                                                (
                                                    {3487}if v_3280 then
                                                    (
                                                        {3488}let pkSess_3281: bitstring = pub(skC) in
                                                        {3489}out(c, GetEndpointRequest);
                                                        {3490}in(c, (SPs_3282: bitstring,=None,UP_3283: bitstring,=pkSess_3281));
                                                        {3491}new SPc_3284: bitstring;
                                                        {3492}new Nc_3285: bitstring;
                                                        {3493}let m1_3286: bitstring = (SPc_3284,exp(g,Nc_3285)) in
                                                        {3494}out(c, (pkCli_3137,m1_3286));
                                                        {3495}in(c, PartS_3287: bitstring);
                                                        {3496}let Kcli_3288: bitstring = exp(PartS_3287,Nc_3285) in
                                                        {3497}out(c, senc(mCli(pkCli_3137,pkSess_3281),Kcli_3288))
                                                    )
                                                    else
                                                        {3498}let pkSess_3289: bitstring = pub(skI) in
                                                        {3499}out(c, GetEndpointRequest);
                                                        {3500}in(c, (SPs_3290: bitstring,=None,UP_3291: bitstring,=pkSess_3289));
                                                        {3501}new SPc_3292: bitstring;
                                                        {3502}new Nc_3293: bitstring;
                                                        {3503}let m1_3294: bitstring = (SPc_3292,exp(g,Nc_3293)) in
                                                        {3504}out(c, (pkCli_3137,m1_3294));
                                                        {3505}in(c, PartS_3295: bitstring);
                                                        {3506}let Kcli_3296: bitstring = exp(PartS_3295,Nc_3293) in
                                                        {3507}out(c, senc(mCli(pkCli_3137,pkSess_3289),Kcli_3296))
                                                )
                                                else
                                                    {3508}let pkSess_3297: bitstring = fail-any in
                                                    {3509}out(c, GetEndpointRequest);
                                                    {3510}in(c, (SPs_3298: bitstring,=None,UP_3299: bitstring,=pkSess_3297));
                                                    {3511}new SPc_3300: bitstring;
                                                    {3512}new Nc_3301: bitstring;
                                                    {3513}let m1_3302: bitstring = (SPc_3300,exp(g,Nc_3301)) in
                                                    {3514}out(c, (pkCli_3137,m1_3302));
                                                    {3515}in(c, PartS_3303: bitstring);
                                                    {3516}let Kcli_3304: bitstring = exp(PartS_3303,Nc_3301) in
                                                    {3517}out(c, senc(mCli(pkCli_3137,pkSess_3297),Kcli_3304))
                                        )
                                        else
                                            {3518}let pkSess_3305: bitstring = fail-any in
                                            {3519}out(c, GetEndpointRequest);
                                            {3520}in(c, (SPs_3306: bitstring,=None,UP_3307: bitstring,=pkSess_3305));
                                            {3521}new SPc_3308: bitstring;
                                            {3522}new Nc_3309: bitstring;
                                            {3523}let m1_3310: bitstring = (SPc_3308,exp(g,Nc_3309)) in
                                            {3524}out(c, (pkCli_3137,m1_3310));
                                            {3525}in(c, PartS_3311: bitstring);
                                            {3526}let Kcli_3312: bitstring = exp(PartS_3311,Nc_3309) in
                                            {3527}out(c, senc(mCli(pkCli_3137,pkSess_3305),Kcli_3312))
                                )
                                else
                                    {3528}let pkSess_3313: bitstring = fail-any in
                                    {3529}out(c, GetEndpointRequest);
                                    {3530}in(c, (SPs_3314: bitstring,=None,UP_3315: bitstring,=pkSess_3313));
                                    {3531}new SPc_3316: bitstring;
                                    {3532}new Nc_3317: bitstring;
                                    {3533}let m1_3318: bitstring = (SPc_3316,exp(g,Nc_3317)) in
                                    {3534}out(c, (pkCli_3137,m1_3318));
                                    {3535}in(c, PartS_3319: bitstring);
                                    {3536}let Kcli_3320: bitstring = exp(PartS_3319,Nc_3317) in
                                    {3537}out(c, senc(mCli(pkCli_3137,pkSess_3313),Kcli_3320))
                            )
                            else
                                {3538}let pkDisco_3321: bitstring = pub(skI) in
                                {3539}let v_3322: bool = (Sess = A) in
                                (
                                    {3540}if v_3322 then
                                    (
                                        {3541}let pkSess_3323: bitstring = pub(skA) in
                                        {3542}out(c, GetEndpointRequest);
                                        {3543}in(c, (SPs_3324: bitstring,=None,UP_3325: bitstring,=pkSess_3323));
                                        {3544}new SPc_3326: bitstring;
                                        {3545}new Nc_3327: bitstring;
                                        {3546}let m1_3328: bitstring = (SPc_3326,exp(g,Nc_3327)) in
                                        {3547}out(c, (pkCli_3137,m1_3328));
                                        {3548}in(c, PartS_3329: bitstring);
                                        {3549}let Kcli_3330: bitstring = exp(PartS_3329,Nc_3327) in
                                        {3550}out(c, senc(mCli(pkCli_3137,pkSess_3323),Kcli_3330))
                                    )
                                    else
                                        {3551}let v_3331: bool = (Sess = B) in
                                        (
                                            {3552}if v_3331 then
                                            (
                                                {3553}let pkSess_3332: bitstring = pub(skB) in
                                                {3554}out(c, GetEndpointRequest);
                                                {3555}in(c, (SPs_3333: bitstring,=None,UP_3334: bitstring,=pkSess_3332));
                                                {3556}new SPc_3335: bitstring;
                                                {3557}new Nc_3336: bitstring;
                                                {3558}let m1_3337: bitstring = (SPc_3335,exp(g,Nc_3336)) in
                                                {3559}out(c, (pkCli_3137,m1_3337));
                                                {3560}in(c, PartS_3338: bitstring);
                                                {3561}let Kcli_3339: bitstring = exp(PartS_3338,Nc_3336) in
                                                {3562}out(c, senc(mCli(pkCli_3137,pkSess_3332),Kcli_3339))
                                            )
                                            else
                                                {3563}let v_3340: bool = (Sess = C) in
                                                (
                                                    {3564}if v_3340 then
                                                    (
                                                        {3565}let pkSess_3341: bitstring = pub(skC) in
                                                        {3566}out(c, GetEndpointRequest);
                                                        {3567}in(c, (SPs_3342: bitstring,=None,UP_3343: bitstring,=pkSess_3341));
                                                        {3568}new SPc_3344: bitstring;
                                                        {3569}new Nc_3345: bitstring;
                                                        {3570}let m1_3346: bitstring = (SPc_3344,exp(g,Nc_3345)) in
                                                        {3571}out(c, (pkCli_3137,m1_3346));
                                                        {3572}in(c, PartS_3347: bitstring);
                                                        {3573}let Kcli_3348: bitstring = exp(PartS_3347,Nc_3345) in
                                                        {3574}out(c, senc(mCli(pkCli_3137,pkSess_3341),Kcli_3348))
                                                    )
                                                    else
                                                        {3575}let pkSess_3349: bitstring = pub(skI) in
                                                        {3576}out(c, GetEndpointRequest);
                                                        {3577}in(c, (SPs_3350: bitstring,=None,UP_3351: bitstring,=pkSess_3349));
                                                        {3578}new SPc_3352: bitstring;
                                                        {3579}new Nc_3353: bitstring;
                                                        {3580}let m1_3354: bitstring = (SPc_3352,exp(g,Nc_3353)) in
                                                        {3581}out(c, (pkCli_3137,m1_3354));
                                                        {3582}in(c, PartS_3355: bitstring);
                                                        {3583}let Kcli_3356: bitstring = exp(PartS_3355,Nc_3353) in
                                                        {3584}out(c, senc(mCli(pkCli_3137,pkSess_3349),Kcli_3356))
                                                )
                                                else
                                                    {3585}let pkSess_3357: bitstring = fail-any in
                                                    {3586}out(c, GetEndpointRequest);
                                                    {3587}in(c, (SPs_3358: bitstring,=None,UP_3359: bitstring,=pkSess_3357));
                                                    {3588}new SPc_3360: bitstring;
                                                    {3589}new Nc_3361: bitstring;
                                                    {3590}let m1_3362: bitstring = (SPc_3360,exp(g,Nc_3361)) in
                                                    {3591}out(c, (pkCli_3137,m1_3362));
                                                    {3592}in(c, PartS_3363: bitstring);
                                                    {3593}let Kcli_3364: bitstring = exp(PartS_3363,Nc_3361) in
                                                    {3594}out(c, senc(mCli(pkCli_3137,pkSess_3357),Kcli_3364))
                                        )
                                        else
                                            {3595}let pkSess_3365: bitstring = fail-any in
                                            {3596}out(c, GetEndpointRequest);
                                            {3597}in(c, (SPs_3366: bitstring,=None,UP_3367: bitstring,=pkSess_3365));
                                            {3598}new SPc_3368: bitstring;
                                            {3599}new Nc_3369: bitstring;
                                            {3600}let m1_3370: bitstring = (SPc_3368,exp(g,Nc_3369)) in
                                            {3601}out(c, (pkCli_3137,m1_3370));
                                            {3602}in(c, PartS_3371: bitstring);
                                            {3603}let Kcli_3372: bitstring = exp(PartS_3371,Nc_3369) in
                                            {3604}out(c, senc(mCli(pkCli_3137,pkSess_3365),Kcli_3372))
                                )
                                else
                                    {3605}let pkSess_3373: bitstring = fail-any in
                                    {3606}out(c, GetEndpointRequest);
                                    {3607}in(c, (SPs_3374: bitstring,=None,UP_3375: bitstring,=pkSess_3373));
                                    {3608}new SPc_3376: bitstring;
                                    {3609}new Nc_3377: bitstring;
                                    {3610}let m1_3378: bitstring = (SPc_3376,exp(g,Nc_3377)) in
                                    {3611}out(c, (pkCli_3137,m1_3378));
                                    {3612}in(c, PartS_3379: bitstring);
                                    {3613}let Kcli_3380: bitstring = exp(PartS_3379,Nc_3377) in
                                    {3614}out(c, senc(mCli(pkCli_3137,pkSess_3373),Kcli_3380))
                        )
                        else
                            {3615}let pkDisco_3381: bitstring = fail-any in
                            {3616}let v_3382: bool = (Sess = A) in
                            (
                                {3617}if v_3382 then
                                (
                                    {3618}let pkSess_3383: bitstring = pub(skA) in
                                    {3619}out(c, GetEndpointRequest);
                                    {3620}in(c, (SPs_3384: bitstring,=None,UP_3385: bitstring,=pkSess_3383));
                                    {3621}new SPc_3386: bitstring;
                                    {3622}new Nc_3387: bitstring;
                                    {3623}let m1_3388: bitstring = (SPc_3386,exp(g,Nc_3387)) in
                                    {3624}out(c, (pkCli_3137,m1_3388));
                                    {3625}in(c, PartS_3389: bitstring);
                                    {3626}let Kcli_3390: bitstring = exp(PartS_3389,Nc_3387) in
                                    {3627}out(c, senc(mCli(pkCli_3137,pkSess_3383),Kcli_3390))
                                )
                                else
                                    {3628}let v_3391: bool = (Sess = B) in
                                    (
                                        {3629}if v_3391 then
                                        (
                                            {3630}let pkSess_3392: bitstring = pub(skB) in
                                            {3631}out(c, GetEndpointRequest);
                                            {3632}in(c, (SPs_3393: bitstring,=None,UP_3394: bitstring,=pkSess_3392));
                                            {3633}new SPc_3395: bitstring;
                                            {3634}new Nc_3396: bitstring;
                                            {3635}let m1_3397: bitstring = (SPc_3395,exp(g,Nc_3396)) in
                                            {3636}out(c, (pkCli_3137,m1_3397));
                                            {3637}in(c, PartS_3398: bitstring);
                                            {3638}let Kcli_3399: bitstring = exp(PartS_3398,Nc_3396) in
                                            {3639}out(c, senc(mCli(pkCli_3137,pkSess_3392),Kcli_3399))
                                        )
                                        else
                                            {3640}let v_3400: bool = (Sess = C) in
                                            (
                                                {3641}if v_3400 then
                                                (
                                                    {3642}let pkSess_3401: bitstring = pub(skC) in
                                                    {3643}out(c, GetEndpointRequest);
                                                    {3644}in(c, (SPs_3402: bitstring,=None,UP_3403: bitstring,=pkSess_3401));
                                                    {3645}new SPc_3404: bitstring;
                                                    {3646}new Nc_3405: bitstring;
                                                    {3647}let m1_3406: bitstring = (SPc_3404,exp(g,Nc_3405)) in
                                                    {3648}out(c, (pkCli_3137,m1_3406));
                                                    {3649}in(c, PartS_3407: bitstring);
                                                    {3650}let Kcli_3408: bitstring = exp(PartS_3407,Nc_3405) in
                                                    {3651}out(c, senc(mCli(pkCli_3137,pkSess_3401),Kcli_3408))
                                                )
                                                else
                                                    {3652}let pkSess_3409: bitstring = pub(skI) in
                                                    {3653}out(c, GetEndpointRequest);
                                                    {3654}in(c, (SPs_3410: bitstring,=None,UP_3411: bitstring,=pkSess_3409));
                                                    {3655}new SPc_3412: bitstring;
                                                    {3656}new Nc_3413: bitstring;
                                                    {3657}let m1_3414: bitstring = (SPc_3412,exp(g,Nc_3413)) in
                                                    {3658}out(c, (pkCli_3137,m1_3414));
                                                    {3659}in(c, PartS_3415: bitstring);
                                                    {3660}let Kcli_3416: bitstring = exp(PartS_3415,Nc_3413) in
                                                    {3661}out(c, senc(mCli(pkCli_3137,pkSess_3409),Kcli_3416))
                                            )
                                            else
                                                {3662}let pkSess_3417: bitstring = fail-any in
                                                {3663}out(c, GetEndpointRequest);
                                                {3664}in(c, (SPs_3418: bitstring,=None,UP_3419: bitstring,=pkSess_3417));
                                                {3665}new SPc_3420: bitstring;
                                                {3666}new Nc_3421: bitstring;
                                                {3667}let m1_3422: bitstring = (SPc_3420,exp(g,Nc_3421)) in
                                                {3668}out(c, (pkCli_3137,m1_3422));
                                                {3669}in(c, PartS_3423: bitstring);
                                                {3670}let Kcli_3424: bitstring = exp(PartS_3423,Nc_3421) in
                                                {3671}out(c, senc(mCli(pkCli_3137,pkSess_3417),Kcli_3424))
                                    )
                                    else
                                        {3672}let pkSess_3425: bitstring = fail-any in
                                        {3673}out(c, GetEndpointRequest);
                                        {3674}in(c, (SPs_3426: bitstring,=None,UP_3427: bitstring,=pkSess_3425));
                                        {3675}new SPc_3428: bitstring;
                                        {3676}new Nc_3429: bitstring;
                                        {3677}let m1_3430: bitstring = (SPc_3428,exp(g,Nc_3429)) in
                                        {3678}out(c, (pkCli_3137,m1_3430));
                                        {3679}in(c, PartS_3431: bitstring);
                                        {3680}let Kcli_3432: bitstring = exp(PartS_3431,Nc_3429) in
                                        {3681}out(c, senc(mCli(pkCli_3137,pkSess_3425),Kcli_3432))
                            )
                            else
                                {3682}let pkSess_3433: bitstring = fail-any in
                                {3683}out(c, GetEndpointRequest);
                                {3684}in(c, (SPs_3434: bitstring,=None,UP_3435: bitstring,=pkSess_3433));
                                {3685}new SPc_3436: bitstring;
                                {3686}new Nc_3437: bitstring;
                                {3687}let m1_3438: bitstring = (SPc_3436,exp(g,Nc_3437)) in
                                {3688}out(c, (pkCli_3137,m1_3438));
                                {3689}in(c, PartS_3439: bitstring);
                                {3690}let Kcli_3440: bitstring = exp(PartS_3439,Nc_3437) in
                                {3691}out(c, senc(mCli(pkCli_3137,pkSess_3433),Kcli_3440))
                )
                else
                    {3692}let pkDisco_3441: bitstring = fail-any in
                    {3693}let v_3442: bool = (Sess = A) in
                    (
                        {3694}if v_3442 then
                        (
                            {3695}let pkSess_3443: bitstring = pub(skA) in
                            {3696}out(c, GetEndpointRequest);
                            {3697}in(c, (SPs_3444: bitstring,=None,UP_3445: bitstring,=pkSess_3443));
                            {3698}new SPc_3446: bitstring;
                            {3699}new Nc_3447: bitstring;
                            {3700}let m1_3448: bitstring = (SPc_3446,exp(g,Nc_3447)) in
                            {3701}out(c, (pkCli_3137,m1_3448));
                            {3702}in(c, PartS_3449: bitstring);
                            {3703}let Kcli_3450: bitstring = exp(PartS_3449,Nc_3447) in
                            {3704}out(c, senc(mCli(pkCli_3137,pkSess_3443),Kcli_3450))
                        )
                        else
                            {3705}let v_3451: bool = (Sess = B) in
                            (
                                {3706}if v_3451 then
                                (
                                    {3707}let pkSess_3452: bitstring = pub(skB) in
                                    {3708}out(c, GetEndpointRequest);
                                    {3709}in(c, (SPs_3453: bitstring,=None,UP_3454: bitstring,=pkSess_3452));
                                    {3710}new SPc_3455: bitstring;
                                    {3711}new Nc_3456: bitstring;
                                    {3712}let m1_3457: bitstring = (SPc_3455,exp(g,Nc_3456)) in
                                    {3713}out(c, (pkCli_3137,m1_3457));
                                    {3714}in(c, PartS_3458: bitstring);
                                    {3715}let Kcli_3459: bitstring = exp(PartS_3458,Nc_3456) in
                                    {3716}out(c, senc(mCli(pkCli_3137,pkSess_3452),Kcli_3459))
                                )
                                else
                                    {3717}let v_3460: bool = (Sess = C) in
                                    (
                                        {3718}if v_3460 then
                                        (
                                            {3719}let pkSess_3461: bitstring = pub(skC) in
                                            {3720}out(c, GetEndpointRequest);
                                            {3721}in(c, (SPs_3462: bitstring,=None,UP_3463: bitstring,=pkSess_3461));
                                            {3722}new SPc_3464: bitstring;
                                            {3723}new Nc_3465: bitstring;
                                            {3724}let m1_3466: bitstring = (SPc_3464,exp(g,Nc_3465)) in
                                            {3725}out(c, (pkCli_3137,m1_3466));
                                            {3726}in(c, PartS_3467: bitstring);
                                            {3727}let Kcli_3468: bitstring = exp(PartS_3467,Nc_3465) in
                                            {3728}out(c, senc(mCli(pkCli_3137,pkSess_3461),Kcli_3468))
                                        )
                                        else
                                            {3729}let pkSess_3469: bitstring = pub(skI) in
                                            {3730}out(c, GetEndpointRequest);
                                            {3731}in(c, (SPs_3470: bitstring,=None,UP_3471: bitstring,=pkSess_3469));
                                            {3732}new SPc_3472: bitstring;
                                            {3733}new Nc_3473: bitstring;
                                            {3734}let m1_3474: bitstring = (SPc_3472,exp(g,Nc_3473)) in
                                            {3735}out(c, (pkCli_3137,m1_3474));
                                            {3736}in(c, PartS_3475: bitstring);
                                            {3737}let Kcli_3476: bitstring = exp(PartS_3475,Nc_3473) in
                                            {3738}out(c, senc(mCli(pkCli_3137,pkSess_3469),Kcli_3476))
                                    )
                                    else
                                        {3739}let pkSess_3477: bitstring = fail-any in
                                        {3740}out(c, GetEndpointRequest);
                                        {3741}in(c, (SPs_3478: bitstring,=None,UP_3479: bitstring,=pkSess_3477));
                                        {3742}new SPc_3480: bitstring;
                                        {3743}new Nc_3481: bitstring;
                                        {3744}let m1_3482: bitstring = (SPc_3480,exp(g,Nc_3481)) in
                                        {3745}out(c, (pkCli_3137,m1_3482));
                                        {3746}in(c, PartS_3483: bitstring);
                                        {3747}let Kcli_3484: bitstring = exp(PartS_3483,Nc_3481) in
                                        {3748}out(c, senc(mCli(pkCli_3137,pkSess_3477),Kcli_3484))
                            )
                            else
                                {3749}let pkSess_3485: bitstring = fail-any in
                                {3750}out(c, GetEndpointRequest);
                                {3751}in(c, (SPs_3486: bitstring,=None,UP_3487: bitstring,=pkSess_3485));
                                {3752}new SPc_3488: bitstring;
                                {3753}new Nc_3489: bitstring;
                                {3754}let m1_3490: bitstring = (SPc_3488,exp(g,Nc_3489)) in
                                {3755}out(c, (pkCli_3137,m1_3490));
                                {3756}in(c, PartS_3491: bitstring);
                                {3757}let Kcli_3492: bitstring = exp(PartS_3491,Nc_3489) in
                                {3758}out(c, senc(mCli(pkCli_3137,pkSess_3485),Kcli_3492))
                    )
                    else
                        {3759}let pkSess_3493: bitstring = fail-any in
                        {3760}out(c, GetEndpointRequest);
                        {3761}in(c, (SPs_3494: bitstring,=None,UP_3495: bitstring,=pkSess_3493));
                        {3762}new SPc_3496: bitstring;
                        {3763}new Nc_3497: bitstring;
                        {3764}let m1_3498: bitstring = (SPc_3496,exp(g,Nc_3497)) in
                        {3765}out(c, (pkCli_3137,m1_3498));
                        {3766}in(c, PartS_3499: bitstring);
                        {3767}let Kcli_3500: bitstring = exp(PartS_3499,Nc_3497) in
                        {3768}out(c, senc(mCli(pkCli_3137,pkSess_3493),Kcli_3500))
        )
        else
            {3769}let pkDisco_3501: bitstring = fail-any in
            {3770}let v_3502: bool = (Sess = A) in
            (
                {3771}if v_3502 then
                (
                    {3772}let pkSess_3503: bitstring = pub(skA) in
                    {3773}out(c, GetEndpointRequest);
                    {3774}in(c, (SPs_3504: bitstring,=None,UP_3505: bitstring,=pkSess_3503));
                    {3775}new SPc_3506: bitstring;
                    {3776}new Nc_3507: bitstring;
                    {3777}let m1_3508: bitstring = (SPc_3506,exp(g,Nc_3507)) in
                    {3778}out(c, (pkCli_3137,m1_3508));
                    {3779}in(c, PartS_3509: bitstring);
                    {3780}let Kcli_3510: bitstring = exp(PartS_3509,Nc_3507) in
                    {3781}out(c, senc(mCli(pkCli_3137,pkSess_3503),Kcli_3510))
                )
                else
                    {3782}let v_3511: bool = (Sess = B) in
                    (
                        {3783}if v_3511 then
                        (
                            {3784}let pkSess_3512: bitstring = pub(skB) in
                            {3785}out(c, GetEndpointRequest);
                            {3786}in(c, (SPs_3513: bitstring,=None,UP_3514: bitstring,=pkSess_3512));
                            {3787}new SPc_3515: bitstring;
                            {3788}new Nc_3516: bitstring;
                            {3789}let m1_3517: bitstring = (SPc_3515,exp(g,Nc_3516)) in
                            {3790}out(c, (pkCli_3137,m1_3517));
                            {3791}in(c, PartS_3518: bitstring);
                            {3792}let Kcli_3519: bitstring = exp(PartS_3518,Nc_3516) in
                            {3793}out(c, senc(mCli(pkCli_3137,pkSess_3512),Kcli_3519))
                        )
                        else
                            {3794}let v_3520: bool = (Sess = C) in
                            (
                                {3795}if v_3520 then
                                (
                                    {3796}let pkSess_3521: bitstring = pub(skC) in
                                    {3797}out(c, GetEndpointRequest);
                                    {3798}in(c, (SPs_3522: bitstring,=None,UP_3523: bitstring,=pkSess_3521));
                                    {3799}new SPc_3524: bitstring;
                                    {3800}new Nc_3525: bitstring;
                                    {3801}let m1_3526: bitstring = (SPc_3524,exp(g,Nc_3525)) in
                                    {3802}out(c, (pkCli_3137,m1_3526));
                                    {3803}in(c, PartS_3527: bitstring);
                                    {3804}let Kcli_3528: bitstring = exp(PartS_3527,Nc_3525) in
                                    {3805}out(c, senc(mCli(pkCli_3137,pkSess_3521),Kcli_3528))
                                )
                                else
                                    {3806}let pkSess_3529: bitstring = pub(skI) in
                                    {3807}out(c, GetEndpointRequest);
                                    {3808}in(c, (SPs_3530: bitstring,=None,UP_3531: bitstring,=pkSess_3529));
                                    {3809}new SPc_3532: bitstring;
                                    {3810}new Nc_3533: bitstring;
                                    {3811}let m1_3534: bitstring = (SPc_3532,exp(g,Nc_3533)) in
                                    {3812}out(c, (pkCli_3137,m1_3534));
                                    {3813}in(c, PartS_3535: bitstring);
                                    {3814}let Kcli_3536: bitstring = exp(PartS_3535,Nc_3533) in
                                    {3815}out(c, senc(mCli(pkCli_3137,pkSess_3529),Kcli_3536))
                            )
                            else
                                {3816}let pkSess_3537: bitstring = fail-any in
                                {3817}out(c, GetEndpointRequest);
                                {3818}in(c, (SPs_3538: bitstring,=None,UP_3539: bitstring,=pkSess_3537));
                                {3819}new SPc_3540: bitstring;
                                {3820}new Nc_3541: bitstring;
                                {3821}let m1_3542: bitstring = (SPc_3540,exp(g,Nc_3541)) in
                                {3822}out(c, (pkCli_3137,m1_3542));
                                {3823}in(c, PartS_3543: bitstring);
                                {3824}let Kcli_3544: bitstring = exp(PartS_3543,Nc_3541) in
                                {3825}out(c, senc(mCli(pkCli_3137,pkSess_3537),Kcli_3544))
                    )
                    else
                        {3826}let pkSess_3545: bitstring = fail-any in
                        {3827}out(c, GetEndpointRequest);
                        {3828}in(c, (SPs_3546: bitstring,=None,UP_3547: bitstring,=pkSess_3545));
                        {3829}new SPc_3548: bitstring;
                        {3830}new Nc_3549: bitstring;
                        {3831}let m1_3550: bitstring = (SPc_3548,exp(g,Nc_3549)) in
                        {3832}out(c, (pkCli_3137,m1_3550));
                        {3833}in(c, PartS_3551: bitstring);
                        {3834}let Kcli_3552: bitstring = exp(PartS_3551,Nc_3549) in
                        {3835}out(c, senc(mCli(pkCli_3137,pkSess_3545),Kcli_3552))
            )
            else
                {3836}let pkSess_3553: bitstring = fail-any in
                {3837}out(c, GetEndpointRequest);
                {3838}in(c, (SPs_3554: bitstring,=None,UP_3555: bitstring,=pkSess_3553));
                {3839}new SPc_3556: bitstring;
                {3840}new Nc_3557: bitstring;
                {3841}let m1_3558: bitstring = (SPc_3556,exp(g,Nc_3557)) in
                {3842}out(c, (pkCli_3137,m1_3558));
                {3843}in(c, PartS_3559: bitstring);
                {3844}let Kcli_3560: bitstring = exp(PartS_3559,Nc_3557) in
                {3845}out(c, senc(mCli(pkCli_3137,pkSess_3553),Kcli_3560))
) | (
    {3846}!
    {3847}in(c, (Cli_3561: host,Disco_3562: host,Sess_3563: host));
    {3848}let v_3564: bool = (Disco_3562 = A) in
    (
        {3849}if v_3564 then
        (
            {3850}let skDisco: bitstring = skA in
            {3851}let pkDisco_3565: bitstring = pub(skDisco) in
            {3852}let v_3566: bool = (Cli_3561 = A) in
            (
                {3853}if v_3566 then
                (
                    {3854}let pkCli_3567: bitstring = pub(skA) in
                    {3855}let v_3568: bool = (Sess_3563 = A) in
                    (
                        {3856}if v_3568 then
                        (
                            {3857}let pkSess_3569: bitstring = pub(skA) in
                            {3858}in(c, =GetEndpointRequest);
                            {3859}new SPs_3570: bitstring;
                            {3860}new UP_3571: bitstring;
                            {3861}out(c, (SPs_3570,Sign,UP_3571,pkSess_3569))
                        )
                        else
                            {3862}let v_3572: bool = (Sess_3563 = B) in
                            (
                                {3863}if v_3572 then
                                (
                                    {3864}let pkSess_3573: bitstring = pub(skB) in
                                    {3865}in(c, =GetEndpointRequest);
                                    {3866}new SPs_3574: bitstring;
                                    {3867}new UP_3575: bitstring;
                                    {3868}out(c, (SPs_3574,Sign,UP_3575,pkSess_3573))
                                )
                                else
                                    {3869}let v_3576: bool = (Sess_3563 = C) in
                                    (
                                        {3870}if v_3576 then
                                        (
                                            {3871}let pkSess_3577: bitstring = pub(skC) in
                                            {3872}in(c, =GetEndpointRequest);
                                            {3873}new SPs_3578: bitstring;
                                            {3874}new UP_3579: bitstring;
                                            {3875}out(c, (SPs_3578,Sign,UP_3579,pkSess_3577))
                                        )
                                        else
                                            {3876}let pkSess_3580: bitstring = pub(skI) in
                                            {3877}in(c, =GetEndpointRequest);
                                            {3878}new SPs_3581: bitstring;
                                            {3879}new UP_3582: bitstring;
                                            {3880}out(c, (SPs_3581,Sign,UP_3582,pkSess_3580))
                                    )
                                    else
                                        {3881}let pkSess_3583: bitstring = fail-any in
                                        {3882}in(c, =GetEndpointRequest);
                                        {3883}new SPs_3584: bitstring;
                                        {3884}new UP_3585: bitstring;
                                        {3885}out(c, (SPs_3584,Sign,UP_3585,pkSess_3583))
                            )
                            else
                                {3886}let pkSess_3586: bitstring = fail-any in
                                {3887}in(c, =GetEndpointRequest);
                                {3888}new SPs_3587: bitstring;
                                {3889}new UP_3588: bitstring;
                                {3890}out(c, (SPs_3587,Sign,UP_3588,pkSess_3586))
                    )
                    else
                        {3891}let pkSess_3589: bitstring = fail-any in
                        {3892}in(c, =GetEndpointRequest);
                        {3893}new SPs_3590: bitstring;
                        {3894}new UP_3591: bitstring;
                        {3895}out(c, (SPs_3590,Sign,UP_3591,pkSess_3589))
                )
                else
                    {3896}let v_3592: bool = (Cli_3561 = B) in
                    (
                        {3897}if v_3592 then
                        (
                            {3898}let pkCli_3593: bitstring = pub(skB) in
                            {3899}let v_3594: bool = (Sess_3563 = A) in
                            (
                                {3900}if v_3594 then
                                (
                                    {3901}let pkSess_3595: bitstring = pub(skA) in
                                    {3902}in(c, =GetEndpointRequest);
                                    {3903}new SPs_3596: bitstring;
                                    {3904}new UP_3597: bitstring;
                                    {3905}out(c, (SPs_3596,Sign,UP_3597,pkSess_3595))
                                )
                                else
                                    {3906}let v_3598: bool = (Sess_3563 = B) in
                                    (
                                        {3907}if v_3598 then
                                        (
                                            {3908}let pkSess_3599: bitstring = pub(skB) in
                                            {3909}in(c, =GetEndpointRequest);
                                            {3910}new SPs_3600: bitstring;
                                            {3911}new UP_3601: bitstring;
                                            {3912}out(c, (SPs_3600,Sign,UP_3601,pkSess_3599))
                                        )
                                        else
                                            {3913}let v_3602: bool = (Sess_3563 = C) in
                                            (
                                                {3914}if v_3602 then
                                                (
                                                    {3915}let pkSess_3603: bitstring = pub(skC) in
                                                    {3916}in(c, =GetEndpointRequest);
                                                    {3917}new SPs_3604: bitstring;
                                                    {3918}new UP_3605: bitstring;
                                                    {3919}out(c, (SPs_3604,Sign,UP_3605,pkSess_3603))
                                                )
                                                else
                                                    {3920}let pkSess_3606: bitstring = pub(skI) in
                                                    {3921}in(c, =GetEndpointRequest);
                                                    {3922}new SPs_3607: bitstring;
                                                    {3923}new UP_3608: bitstring;
                                                    {3924}out(c, (SPs_3607,Sign,UP_3608,pkSess_3606))
                                            )
                                            else
                                                {3925}let pkSess_3609: bitstring = fail-any in
                                                {3926}in(c, =GetEndpointRequest);
                                                {3927}new SPs_3610: bitstring;
                                                {3928}new UP_3611: bitstring;
                                                {3929}out(c, (SPs_3610,Sign,UP_3611,pkSess_3609))
                                    )
                                    else
                                        {3930}let pkSess_3612: bitstring = fail-any in
                                        {3931}in(c, =GetEndpointRequest);
                                        {3932}new SPs_3613: bitstring;
                                        {3933}new UP_3614: bitstring;
                                        {3934}out(c, (SPs_3613,Sign,UP_3614,pkSess_3612))
                            )
                            else
                                {3935}let pkSess_3615: bitstring = fail-any in
                                {3936}in(c, =GetEndpointRequest);
                                {3937}new SPs_3616: bitstring;
                                {3938}new UP_3617: bitstring;
                                {3939}out(c, (SPs_3616,Sign,UP_3617,pkSess_3615))
                        )
                        else
                            {3940}let v_3618: bool = (Cli_3561 = C) in
                            (
                                {3941}if v_3618 then
                                (
                                    {3942}let pkCli_3619: bitstring = pub(skC) in
                                    {3943}let v_3620: bool = (Sess_3563 = A) in
                                    (
                                        {3944}if v_3620 then
                                        (
                                            {3945}let pkSess_3621: bitstring = pub(skA) in
                                            {3946}in(c, =GetEndpointRequest);
                                            {3947}new SPs_3622: bitstring;
                                            {3948}new UP_3623: bitstring;
                                            {3949}out(c, (SPs_3622,Sign,UP_3623,pkSess_3621))
                                        )
                                        else
                                            {3950}let v_3624: bool = (Sess_3563 = B) in
                                            (
                                                {3951}if v_3624 then
                                                (
                                                    {3952}let pkSess_3625: bitstring = pub(skB) in
                                                    {3953}in(c, =GetEndpointRequest);
                                                    {3954}new SPs_3626: bitstring;
                                                    {3955}new UP_3627: bitstring;
                                                    {3956}out(c, (SPs_3626,Sign,UP_3627,pkSess_3625))
                                                )
                                                else
                                                    {3957}let v_3628: bool = (Sess_3563 = C) in
                                                    (
                                                        {3958}if v_3628 then
                                                        (
                                                            {3959}let pkSess_3629: bitstring = pub(skC) in
                                                            {3960}in(c, =GetEndpointRequest);
                                                            {3961}new SPs_3630: bitstring;
                                                            {3962}new UP_3631: bitstring;
                                                            {3963}out(c, (SPs_3630,Sign,UP_3631,pkSess_3629))
                                                        )
                                                        else
                                                            {3964}let pkSess_3632: bitstring = pub(skI) in
                                                            {3965}in(c, =GetEndpointRequest);
                                                            {3966}new SPs_3633: bitstring;
                                                            {3967}new UP_3634: bitstring;
                                                            {3968}out(c, (SPs_3633,Sign,UP_3634,pkSess_3632))
                                                    )
                                                    else
                                                        {3969}let pkSess_3635: bitstring = fail-any in
                                                        {3970}in(c, =GetEndpointRequest);
                                                        {3971}new SPs_3636: bitstring;
                                                        {3972}new UP_3637: bitstring;
                                                        {3973}out(c, (SPs_3636,Sign,UP_3637,pkSess_3635))
                                            )
                                            else
                                                {3974}let pkSess_3638: bitstring = fail-any in
                                                {3975}in(c, =GetEndpointRequest);
                                                {3976}new SPs_3639: bitstring;
                                                {3977}new UP_3640: bitstring;
                                                {3978}out(c, (SPs_3639,Sign,UP_3640,pkSess_3638))
                                    )
                                    else
                                        {3979}let pkSess_3641: bitstring = fail-any in
                                        {3980}in(c, =GetEndpointRequest);
                                        {3981}new SPs_3642: bitstring;
                                        {3982}new UP_3643: bitstring;
                                        {3983}out(c, (SPs_3642,Sign,UP_3643,pkSess_3641))
                                )
                                else
                                    {3984}let pkCli_3644: bitstring = pub(skI) in
                                    {3985}let v_3645: bool = (Sess_3563 = A) in
                                    (
                                        {3986}if v_3645 then
                                        (
                                            {3987}let pkSess_3646: bitstring = pub(skA) in
                                            {3988}in(c, =GetEndpointRequest);
                                            {3989}new SPs_3647: bitstring;
                                            {3990}new UP_3648: bitstring;
                                            {3991}out(c, (SPs_3647,Sign,UP_3648,pkSess_3646))
                                        )
                                        else
                                            {3992}let v_3649: bool = (Sess_3563 = B) in
                                            (
                                                {3993}if v_3649 then
                                                (
                                                    {3994}let pkSess_3650: bitstring = pub(skB) in
                                                    {3995}in(c, =GetEndpointRequest);
                                                    {3996}new SPs_3651: bitstring;
                                                    {3997}new UP_3652: bitstring;
                                                    {3998}out(c, (SPs_3651,Sign,UP_3652,pkSess_3650))
                                                )
                                                else
                                                    {3999}let v_3653: bool = (Sess_3563 = C) in
                                                    (
                                                        {4000}if v_3653 then
                                                        (
                                                            {4001}let pkSess_3654: bitstring = pub(skC) in
                                                            {4002}in(c, =GetEndpointRequest);
                                                            {4003}new SPs_3655: bitstring;
                                                            {4004}new UP_3656: bitstring;
                                                            {4005}out(c, (SPs_3655,Sign,UP_3656,pkSess_3654))
                                                        )
                                                        else
                                                            {4006}let pkSess_3657: bitstring = pub(skI) in
                                                            {4007}in(c, =GetEndpointRequest);
                                                            {4008}new SPs_3658: bitstring;
                                                            {4009}new UP_3659: bitstring;
                                                            {4010}out(c, (SPs_3658,Sign,UP_3659,pkSess_3657))
                                                    )
                                                    else
                                                        {4011}let pkSess_3660: bitstring = fail-any in
                                                        {4012}in(c, =GetEndpointRequest);
                                                        {4013}new SPs_3661: bitstring;
                                                        {4014}new UP_3662: bitstring;
                                                        {4015}out(c, (SPs_3661,Sign,UP_3662,pkSess_3660))
                                            )
                                            else
                                                {4016}let pkSess_3663: bitstring = fail-any in
                                                {4017}in(c, =GetEndpointRequest);
                                                {4018}new SPs_3664: bitstring;
                                                {4019}new UP_3665: bitstring;
                                                {4020}out(c, (SPs_3664,Sign,UP_3665,pkSess_3663))
                                    )
                                    else
                                        {4021}let pkSess_3666: bitstring = fail-any in
                                        {4022}in(c, =GetEndpointRequest);
                                        {4023}new SPs_3667: bitstring;
                                        {4024}new UP_3668: bitstring;
                                        {4025}out(c, (SPs_3667,Sign,UP_3668,pkSess_3666))
                            )
                            else
                                {4026}let pkCli_3669: bitstring = fail-any in
                                {4027}let v_3670: bool = (Sess_3563 = A) in
                                (
                                    {4028}if v_3670 then
                                    (
                                        {4029}let pkSess_3671: bitstring = pub(skA) in
                                        {4030}in(c, =GetEndpointRequest);
                                        {4031}new SPs_3672: bitstring;
                                        {4032}new UP_3673: bitstring;
                                        {4033}out(c, (SPs_3672,Sign,UP_3673,pkSess_3671))
                                    )
                                    else
                                        {4034}let v_3674: bool = (Sess_3563 = B) in
                                        (
                                            {4035}if v_3674 then
                                            (
                                                {4036}let pkSess_3675: bitstring = pub(skB) in
                                                {4037}in(c, =GetEndpointRequest);
                                                {4038}new SPs_3676: bitstring;
                                                {4039}new UP_3677: bitstring;
                                                {4040}out(c, (SPs_3676,Sign,UP_3677,pkSess_3675))
                                            )
                                            else
                                                {4041}let v_3678: bool = (Sess_3563 = C) in
                                                (
                                                    {4042}if v_3678 then
                                                    (
                                                        {4043}let pkSess_3679: bitstring = pub(skC) in
                                                        {4044}in(c, =GetEndpointRequest);
                                                        {4045}new SPs_3680: bitstring;
                                                        {4046}new UP_3681: bitstring;
                                                        {4047}out(c, (SPs_3680,Sign,UP_3681,pkSess_3679))
                                                    )
                                                    else
                                                        {4048}let pkSess_3682: bitstring = pub(skI) in
                                                        {4049}in(c, =GetEndpointRequest);
                                                        {4050}new SPs_3683: bitstring;
                                                        {4051}new UP_3684: bitstring;
                                                        {4052}out(c, (SPs_3683,Sign,UP_3684,pkSess_3682))
                                                )
                                                else
                                                    {4053}let pkSess_3685: bitstring = fail-any in
                                                    {4054}in(c, =GetEndpointRequest);
                                                    {4055}new SPs_3686: bitstring;
                                                    {4056}new UP_3687: bitstring;
                                                    {4057}out(c, (SPs_3686,Sign,UP_3687,pkSess_3685))
                                        )
                                        else
                                            {4058}let pkSess_3688: bitstring = fail-any in
                                            {4059}in(c, =GetEndpointRequest);
                                            {4060}new SPs_3689: bitstring;
                                            {4061}new UP_3690: bitstring;
                                            {4062}out(c, (SPs_3689,Sign,UP_3690,pkSess_3688))
                                )
                                else
                                    {4063}let pkSess_3691: bitstring = fail-any in
                                    {4064}in(c, =GetEndpointRequest);
                                    {4065}new SPs_3692: bitstring;
                                    {4066}new UP_3693: bitstring;
                                    {4067}out(c, (SPs_3692,Sign,UP_3693,pkSess_3691))
                    )
                    else
                        {4068}let pkCli_3694: bitstring = fail-any in
                        {4069}let v_3695: bool = (Sess_3563 = A) in
                        (
                            {4070}if v_3695 then
                            (
                                {4071}let pkSess_3696: bitstring = pub(skA) in
                                {4072}in(c, =GetEndpointRequest);
                                {4073}new SPs_3697: bitstring;
                                {4074}new UP_3698: bitstring;
                                {4075}out(c, (SPs_3697,Sign,UP_3698,pkSess_3696))
                            )
                            else
                                {4076}let v_3699: bool = (Sess_3563 = B) in
                                (
                                    {4077}if v_3699 then
                                    (
                                        {4078}let pkSess_3700: bitstring = pub(skB) in
                                        {4079}in(c, =GetEndpointRequest);
                                        {4080}new SPs_3701: bitstring;
                                        {4081}new UP_3702: bitstring;
                                        {4082}out(c, (SPs_3701,Sign,UP_3702,pkSess_3700))
                                    )
                                    else
                                        {4083}let v_3703: bool = (Sess_3563 = C) in
                                        (
                                            {4084}if v_3703 then
                                            (
                                                {4085}let pkSess_3704: bitstring = pub(skC) in
                                                {4086}in(c, =GetEndpointRequest);
                                                {4087}new SPs_3705: bitstring;
                                                {4088}new UP_3706: bitstring;
                                                {4089}out(c, (SPs_3705,Sign,UP_3706,pkSess_3704))
                                            )
                                            else
                                                {4090}let pkSess_3707: bitstring = pub(skI) in
                                                {4091}in(c, =GetEndpointRequest);
                                                {4092}new SPs_3708: bitstring;
                                                {4093}new UP_3709: bitstring;
                                                {4094}out(c, (SPs_3708,Sign,UP_3709,pkSess_3707))
                                        )
                                        else
                                            {4095}let pkSess_3710: bitstring = fail-any in
                                            {4096}in(c, =GetEndpointRequest);
                                            {4097}new SPs_3711: bitstring;
                                            {4098}new UP_3712: bitstring;
                                            {4099}out(c, (SPs_3711,Sign,UP_3712,pkSess_3710))
                                )
                                else
                                    {4100}let pkSess_3713: bitstring = fail-any in
                                    {4101}in(c, =GetEndpointRequest);
                                    {4102}new SPs_3714: bitstring;
                                    {4103}new UP_3715: bitstring;
                                    {4104}out(c, (SPs_3714,Sign,UP_3715,pkSess_3713))
                        )
                        else
                            {4105}let pkSess_3716: bitstring = fail-any in
                            {4106}in(c, =GetEndpointRequest);
                            {4107}new SPs_3717: bitstring;
                            {4108}new UP_3718: bitstring;
                            {4109}out(c, (SPs_3717,Sign,UP_3718,pkSess_3716))
            )
            else
                {4110}let pkCli_3719: bitstring = fail-any in
                {4111}let v_3720: bool = (Sess_3563 = A) in
                (
                    {4112}if v_3720 then
                    (
                        {4113}let pkSess_3721: bitstring = pub(skA) in
                        {4114}in(c, =GetEndpointRequest);
                        {4115}new SPs_3722: bitstring;
                        {4116}new UP_3723: bitstring;
                        {4117}out(c, (SPs_3722,Sign,UP_3723,pkSess_3721))
                    )
                    else
                        {4118}let v_3724: bool = (Sess_3563 = B) in
                        (
                            {4119}if v_3724 then
                            (
                                {4120}let pkSess_3725: bitstring = pub(skB) in
                                {4121}in(c, =GetEndpointRequest);
                                {4122}new SPs_3726: bitstring;
                                {4123}new UP_3727: bitstring;
                                {4124}out(c, (SPs_3726,Sign,UP_3727,pkSess_3725))
                            )
                            else
                                {4125}let v_3728: bool = (Sess_3563 = C) in
                                (
                                    {4126}if v_3728 then
                                    (
                                        {4127}let pkSess_3729: bitstring = pub(skC) in
                                        {4128}in(c, =GetEndpointRequest);
                                        {4129}new SPs_3730: bitstring;
                                        {4130}new UP_3731: bitstring;
                                        {4131}out(c, (SPs_3730,Sign,UP_3731,pkSess_3729))
                                    )
                                    else
                                        {4132}let pkSess_3732: bitstring = pub(skI) in
                                        {4133}in(c, =GetEndpointRequest);
                                        {4134}new SPs_3733: bitstring;
                                        {4135}new UP_3734: bitstring;
                                        {4136}out(c, (SPs_3733,Sign,UP_3734,pkSess_3732))
                                )
                                else
                                    {4137}let pkSess_3735: bitstring = fail-any in
                                    {4138}in(c, =GetEndpointRequest);
                                    {4139}new SPs_3736: bitstring;
                                    {4140}new UP_3737: bitstring;
                                    {4141}out(c, (SPs_3736,Sign,UP_3737,pkSess_3735))
                        )
                        else
                            {4142}let pkSess_3738: bitstring = fail-any in
                            {4143}in(c, =GetEndpointRequest);
                            {4144}new SPs_3739: bitstring;
                            {4145}new UP_3740: bitstring;
                            {4146}out(c, (SPs_3739,Sign,UP_3740,pkSess_3738))
                )
                else
                    {4147}let pkSess_3741: bitstring = fail-any in
                    {4148}in(c, =GetEndpointRequest);
                    {4149}new SPs_3742: bitstring;
                    {4150}new UP_3743: bitstring;
                    {4151}out(c, (SPs_3742,Sign,UP_3743,pkSess_3741))
        )
        else
            {4152}let v_3744: bool = (Disco_3562 = B) in
            (
                {4153}if v_3744 then
                (
                    {4154}let skDisco_3745: bitstring = skB in
                    {4155}let pkDisco_3746: bitstring = pub(skDisco_3745) in
                    {4156}let v_3747: bool = (Cli_3561 = A) in
                    (
                        {4157}if v_3747 then
                        (
                            {4158}let pkCli_3748: bitstring = pub(skA) in
                            {4159}let v_3749: bool = (Sess_3563 = A) in
                            (
                                {4160}if v_3749 then
                                (
                                    {4161}let pkSess_3750: bitstring = pub(skA) in
                                    {4162}in(c, =GetEndpointRequest);
                                    {4163}new SPs_3751: bitstring;
                                    {4164}new UP_3752: bitstring;
                                    {4165}out(c, (SPs_3751,Sign,UP_3752,pkSess_3750))
                                )
                                else
                                    {4166}let v_3753: bool = (Sess_3563 = B) in
                                    (
                                        {4167}if v_3753 then
                                        (
                                            {4168}let pkSess_3754: bitstring = pub(skB) in
                                            {4169}in(c, =GetEndpointRequest);
                                            {4170}new SPs_3755: bitstring;
                                            {4171}new UP_3756: bitstring;
                                            {4172}out(c, (SPs_3755,Sign,UP_3756,pkSess_3754))
                                        )
                                        else
                                            {4173}let v_3757: bool = (Sess_3563 = C) in
                                            (
                                                {4174}if v_3757 then
                                                (
                                                    {4175}let pkSess_3758: bitstring = pub(skC) in
                                                    {4176}in(c, =GetEndpointRequest);
                                                    {4177}new SPs_3759: bitstring;
                                                    {4178}new UP_3760: bitstring;
                                                    {4179}out(c, (SPs_3759,Sign,UP_3760,pkSess_3758))
                                                )
                                                else
                                                    {4180}let pkSess_3761: bitstring = pub(skI) in
                                                    {4181}in(c, =GetEndpointRequest);
                                                    {4182}new SPs_3762: bitstring;
                                                    {4183}new UP_3763: bitstring;
                                                    {4184}out(c, (SPs_3762,Sign,UP_3763,pkSess_3761))
                                            )
                                            else
                                                {4185}let pkSess_3764: bitstring = fail-any in
                                                {4186}in(c, =GetEndpointRequest);
                                                {4187}new SPs_3765: bitstring;
                                                {4188}new UP_3766: bitstring;
                                                {4189}out(c, (SPs_3765,Sign,UP_3766,pkSess_3764))
                                    )
                                    else
                                        {4190}let pkSess_3767: bitstring = fail-any in
                                        {4191}in(c, =GetEndpointRequest);
                                        {4192}new SPs_3768: bitstring;
                                        {4193}new UP_3769: bitstring;
                                        {4194}out(c, (SPs_3768,Sign,UP_3769,pkSess_3767))
                            )
                            else
                                {4195}let pkSess_3770: bitstring = fail-any in
                                {4196}in(c, =GetEndpointRequest);
                                {4197}new SPs_3771: bitstring;
                                {4198}new UP_3772: bitstring;
                                {4199}out(c, (SPs_3771,Sign,UP_3772,pkSess_3770))
                        )
                        else
                            {4200}let v_3773: bool = (Cli_3561 = B) in
                            (
                                {4201}if v_3773 then
                                (
                                    {4202}let pkCli_3774: bitstring = pub(skB) in
                                    {4203}let v_3775: bool = (Sess_3563 = A) in
                                    (
                                        {4204}if v_3775 then
                                        (
                                            {4205}let pkSess_3776: bitstring = pub(skA) in
                                            {4206}in(c, =GetEndpointRequest);
                                            {4207}new SPs_3777: bitstring;
                                            {4208}new UP_3778: bitstring;
                                            {4209}out(c, (SPs_3777,Sign,UP_3778,pkSess_3776))
                                        )
                                        else
                                            {4210}let v_3779: bool = (Sess_3563 = B) in
                                            (
                                                {4211}if v_3779 then
                                                (
                                                    {4212}let pkSess_3780: bitstring = pub(skB) in
                                                    {4213}in(c, =GetEndpointRequest);
                                                    {4214}new SPs_3781: bitstring;
                                                    {4215}new UP_3782: bitstring;
                                                    {4216}out(c, (SPs_3781,Sign,UP_3782,pkSess_3780))
                                                )
                                                else
                                                    {4217}let v_3783: bool = (Sess_3563 = C) in
                                                    (
                                                        {4218}if v_3783 then
                                                        (
                                                            {4219}let pkSess_3784: bitstring = pub(skC) in
                                                            {4220}in(c, =GetEndpointRequest);
                                                            {4221}new SPs_3785: bitstring;
                                                            {4222}new UP_3786: bitstring;
                                                            {4223}out(c, (SPs_3785,Sign,UP_3786,pkSess_3784))
                                                        )
                                                        else
                                                            {4224}let pkSess_3787: bitstring = pub(skI) in
                                                            {4225}in(c, =GetEndpointRequest);
                                                            {4226}new SPs_3788: bitstring;
                                                            {4227}new UP_3789: bitstring;
                                                            {4228}out(c, (SPs_3788,Sign,UP_3789,pkSess_3787))
                                                    )
                                                    else
                                                        {4229}let pkSess_3790: bitstring = fail-any in
                                                        {4230}in(c, =GetEndpointRequest);
                                                        {4231}new SPs_3791: bitstring;
                                                        {4232}new UP_3792: bitstring;
                                                        {4233}out(c, (SPs_3791,Sign,UP_3792,pkSess_3790))
                                            )
                                            else
                                                {4234}let pkSess_3793: bitstring = fail-any in
                                                {4235}in(c, =GetEndpointRequest);
                                                {4236}new SPs_3794: bitstring;
                                                {4237}new UP_3795: bitstring;
                                                {4238}out(c, (SPs_3794,Sign,UP_3795,pkSess_3793))
                                    )
                                    else
                                        {4239}let pkSess_3796: bitstring = fail-any in
                                        {4240}in(c, =GetEndpointRequest);
                                        {4241}new SPs_3797: bitstring;
                                        {4242}new UP_3798: bitstring;
                                        {4243}out(c, (SPs_3797,Sign,UP_3798,pkSess_3796))
                                )
                                else
                                    {4244}let v_3799: bool = (Cli_3561 = C) in
                                    (
                                        {4245}if v_3799 then
                                        (
                                            {4246}let pkCli_3800: bitstring = pub(skC) in
                                            {4247}let v_3801: bool = (Sess_3563 = A) in
                                            (
                                                {4248}if v_3801 then
                                                (
                                                    {4249}let pkSess_3802: bitstring = pub(skA) in
                                                    {4250}in(c, =GetEndpointRequest);
                                                    {4251}new SPs_3803: bitstring;
                                                    {4252}new UP_3804: bitstring;
                                                    {4253}out(c, (SPs_3803,Sign,UP_3804,pkSess_3802))
                                                )
                                                else
                                                    {4254}let v_3805: bool = (Sess_3563 = B) in
                                                    (
                                                        {4255}if v_3805 then
                                                        (
                                                            {4256}let pkSess_3806: bitstring = pub(skB) in
                                                            {4257}in(c, =GetEndpointRequest);
                                                            {4258}new SPs_3807: bitstring;
                                                            {4259}new UP_3808: bitstring;
                                                            {4260}out(c, (SPs_3807,Sign,UP_3808,pkSess_3806))
                                                        )
                                                        else
                                                            {4261}let v_3809: bool = (Sess_3563 = C) in
                                                            (
                                                                {4262}if v_3809 then
                                                                (
                                                                    {4263}let pkSess_3810: bitstring = pub(skC) in
                                                                    {4264}in(c, =GetEndpointRequest);
                                                                    {4265}new SPs_3811: bitstring;
                                                                    {4266}new UP_3812: bitstring;
                                                                    {4267}out(c, (SPs_3811,Sign,UP_3812,pkSess_3810))
                                                                )
                                                                else
                                                                    {4268}let pkSess_3813: bitstring = pub(skI) in
                                                                    {4269}in(c, =GetEndpointRequest);
                                                                    {4270}new SPs_3814: bitstring;
                                                                    {4271}new UP_3815: bitstring;
                                                                    {4272}out(c, (SPs_3814,Sign,UP_3815,pkSess_3813))
                                                            )
                                                            else
                                                                {4273}let pkSess_3816: bitstring = fail-any in
                                                                {4274}in(c, =GetEndpointRequest);
                                                                {4275}new SPs_3817: bitstring;
                                                                {4276}new UP_3818: bitstring;
                                                                {4277}out(c, (SPs_3817,Sign,UP_3818,pkSess_3816))
                                                    )
                                                    else
                                                        {4278}let pkSess_3819: bitstring = fail-any in
                                                        {4279}in(c, =GetEndpointRequest);
                                                        {4280}new SPs_3820: bitstring;
                                                        {4281}new UP_3821: bitstring;
                                                        {4282}out(c, (SPs_3820,Sign,UP_3821,pkSess_3819))
                                            )
                                            else
                                                {4283}let pkSess_3822: bitstring = fail-any in
                                                {4284}in(c, =GetEndpointRequest);
                                                {4285}new SPs_3823: bitstring;
                                                {4286}new UP_3824: bitstring;
                                                {4287}out(c, (SPs_3823,Sign,UP_3824,pkSess_3822))
                                        )
                                        else
                                            {4288}let pkCli_3825: bitstring = pub(skI) in
                                            {4289}let v_3826: bool = (Sess_3563 = A) in
                                            (
                                                {4290}if v_3826 then
                                                (
                                                    {4291}let pkSess_3827: bitstring = pub(skA) in
                                                    {4292}in(c, =GetEndpointRequest);
                                                    {4293}new SPs_3828: bitstring;
                                                    {4294}new UP_3829: bitstring;
                                                    {4295}out(c, (SPs_3828,Sign,UP_3829,pkSess_3827))
                                                )
                                                else
                                                    {4296}let v_3830: bool = (Sess_3563 = B) in
                                                    (
                                                        {4297}if v_3830 then
                                                        (
                                                            {4298}let pkSess_3831: bitstring = pub(skB) in
                                                            {4299}in(c, =GetEndpointRequest);
                                                            {4300}new SPs_3832: bitstring;
                                                            {4301}new UP_3833: bitstring;
                                                            {4302}out(c, (SPs_3832,Sign,UP_3833,pkSess_3831))
                                                        )
                                                        else
                                                            {4303}let v_3834: bool = (Sess_3563 = C) in
                                                            (
                                                                {4304}if v_3834 then
                                                                (
                                                                    {4305}let pkSess_3835: bitstring = pub(skC) in
                                                                    {4306}in(c, =GetEndpointRequest);
                                                                    {4307}new SPs_3836: bitstring;
                                                                    {4308}new UP_3837: bitstring;
                                                                    {4309}out(c, (SPs_3836,Sign,UP_3837,pkSess_3835))
                                                                )
                                                                else
                                                                    {4310}let pkSess_3838: bitstring = pub(skI) in
                                                                    {4311}in(c, =GetEndpointRequest);
                                                                    {4312}new SPs_3839: bitstring;
                                                                    {4313}new UP_3840: bitstring;
                                                                    {4314}out(c, (SPs_3839,Sign,UP_3840,pkSess_3838))
                                                            )
                                                            else
                                                                {4315}let pkSess_3841: bitstring = fail-any in
                                                                {4316}in(c, =GetEndpointRequest);
                                                                {4317}new SPs_3842: bitstring;
                                                                {4318}new UP_3843: bitstring;
                                                                {4319}out(c, (SPs_3842,Sign,UP_3843,pkSess_3841))
                                                    )
                                                    else
                                                        {4320}let pkSess_3844: bitstring = fail-any in
                                                        {4321}in(c, =GetEndpointRequest);
                                                        {4322}new SPs_3845: bitstring;
                                                        {4323}new UP_3846: bitstring;
                                                        {4324}out(c, (SPs_3845,Sign,UP_3846,pkSess_3844))
                                            )
                                            else
                                                {4325}let pkSess_3847: bitstring = fail-any in
                                                {4326}in(c, =GetEndpointRequest);
                                                {4327}new SPs_3848: bitstring;
                                                {4328}new UP_3849: bitstring;
                                                {4329}out(c, (SPs_3848,Sign,UP_3849,pkSess_3847))
                                    )
                                    else
                                        {4330}let pkCli_3850: bitstring = fail-any in
                                        {4331}let v_3851: bool = (Sess_3563 = A) in
                                        (
                                            {4332}if v_3851 then
                                            (
                                                {4333}let pkSess_3852: bitstring = pub(skA) in
                                                {4334}in(c, =GetEndpointRequest);
                                                {4335}new SPs_3853: bitstring;
                                                {4336}new UP_3854: bitstring;
                                                {4337}out(c, (SPs_3853,Sign,UP_3854,pkSess_3852))
                                            )
                                            else
                                                {4338}let v_3855: bool = (Sess_3563 = B) in
                                                (
                                                    {4339}if v_3855 then
                                                    (
                                                        {4340}let pkSess_3856: bitstring = pub(skB) in
                                                        {4341}in(c, =GetEndpointRequest);
                                                        {4342}new SPs_3857: bitstring;
                                                        {4343}new UP_3858: bitstring;
                                                        {4344}out(c, (SPs_3857,Sign,UP_3858,pkSess_3856))
                                                    )
                                                    else
                                                        {4345}let v_3859: bool = (Sess_3563 = C) in
                                                        (
                                                            {4346}if v_3859 then
                                                            (
                                                                {4347}let pkSess_3860: bitstring = pub(skC) in
                                                                {4348}in(c, =GetEndpointRequest);
                                                                {4349}new SPs_3861: bitstring;
                                                                {4350}new UP_3862: bitstring;
                                                                {4351}out(c, (SPs_3861,Sign,UP_3862,pkSess_3860))
                                                            )
                                                            else
                                                                {4352}let pkSess_3863: bitstring = pub(skI) in
                                                                {4353}in(c, =GetEndpointRequest);
                                                                {4354}new SPs_3864: bitstring;
                                                                {4355}new UP_3865: bitstring;
                                                                {4356}out(c, (SPs_3864,Sign,UP_3865,pkSess_3863))
                                                        )
                                                        else
                                                            {4357}let pkSess_3866: bitstring = fail-any in
                                                            {4358}in(c, =GetEndpointRequest);
                                                            {4359}new SPs_3867: bitstring;
                                                            {4360}new UP_3868: bitstring;
                                                            {4361}out(c, (SPs_3867,Sign,UP_3868,pkSess_3866))
                                                )
                                                else
                                                    {4362}let pkSess_3869: bitstring = fail-any in
                                                    {4363}in(c, =GetEndpointRequest);
                                                    {4364}new SPs_3870: bitstring;
                                                    {4365}new UP_3871: bitstring;
                                                    {4366}out(c, (SPs_3870,Sign,UP_3871,pkSess_3869))
                                        )
                                        else
                                            {4367}let pkSess_3872: bitstring = fail-any in
                                            {4368}in(c, =GetEndpointRequest);
                                            {4369}new SPs_3873: bitstring;
                                            {4370}new UP_3874: bitstring;
                                            {4371}out(c, (SPs_3873,Sign,UP_3874,pkSess_3872))
                            )
                            else
                                {4372}let pkCli_3875: bitstring = fail-any in
                                {4373}let v_3876: bool = (Sess_3563 = A) in
                                (
                                    {4374}if v_3876 then
                                    (
                                        {4375}let pkSess_3877: bitstring = pub(skA) in
                                        {4376}in(c, =GetEndpointRequest);
                                        {4377}new SPs_3878: bitstring;
                                        {4378}new UP_3879: bitstring;
                                        {4379}out(c, (SPs_3878,Sign,UP_3879,pkSess_3877))
                                    )
                                    else
                                        {4380}let v_3880: bool = (Sess_3563 = B) in
                                        (
                                            {4381}if v_3880 then
                                            (
                                                {4382}let pkSess_3881: bitstring = pub(skB) in
                                                {4383}in(c, =GetEndpointRequest);
                                                {4384}new SPs_3882: bitstring;
                                                {4385}new UP_3883: bitstring;
                                                {4386}out(c, (SPs_3882,Sign,UP_3883,pkSess_3881))
                                            )
                                            else
                                                {4387}let v_3884: bool = (Sess_3563 = C) in
                                                (
                                                    {4388}if v_3884 then
                                                    (
                                                        {4389}let pkSess_3885: bitstring = pub(skC) in
                                                        {4390}in(c, =GetEndpointRequest);
                                                        {4391}new SPs_3886: bitstring;
                                                        {4392}new UP_3887: bitstring;
                                                        {4393}out(c, (SPs_3886,Sign,UP_3887,pkSess_3885))
                                                    )
                                                    else
                                                        {4394}let pkSess_3888: bitstring = pub(skI) in
                                                        {4395}in(c, =GetEndpointRequest);
                                                        {4396}new SPs_3889: bitstring;
                                                        {4397}new UP_3890: bitstring;
                                                        {4398}out(c, (SPs_3889,Sign,UP_3890,pkSess_3888))
                                                )
                                                else
                                                    {4399}let pkSess_3891: bitstring = fail-any in
                                                    {4400}in(c, =GetEndpointRequest);
                                                    {4401}new SPs_3892: bitstring;
                                                    {4402}new UP_3893: bitstring;
                                                    {4403}out(c, (SPs_3892,Sign,UP_3893,pkSess_3891))
                                        )
                                        else
                                            {4404}let pkSess_3894: bitstring = fail-any in
                                            {4405}in(c, =GetEndpointRequest);
                                            {4406}new SPs_3895: bitstring;
                                            {4407}new UP_3896: bitstring;
                                            {4408}out(c, (SPs_3895,Sign,UP_3896,pkSess_3894))
                                )
                                else
                                    {4409}let pkSess_3897: bitstring = fail-any in
                                    {4410}in(c, =GetEndpointRequest);
                                    {4411}new SPs_3898: bitstring;
                                    {4412}new UP_3899: bitstring;
                                    {4413}out(c, (SPs_3898,Sign,UP_3899,pkSess_3897))
                    )
                    else
                        {4414}let pkCli_3900: bitstring = fail-any in
                        {4415}let v_3901: bool = (Sess_3563 = A) in
                        (
                            {4416}if v_3901 then
                            (
                                {4417}let pkSess_3902: bitstring = pub(skA) in
                                {4418}in(c, =GetEndpointRequest);
                                {4419}new SPs_3903: bitstring;
                                {4420}new UP_3904: bitstring;
                                {4421}out(c, (SPs_3903,Sign,UP_3904,pkSess_3902))
                            )
                            else
                                {4422}let v_3905: bool = (Sess_3563 = B) in
                                (
                                    {4423}if v_3905 then
                                    (
                                        {4424}let pkSess_3906: bitstring = pub(skB) in
                                        {4425}in(c, =GetEndpointRequest);
                                        {4426}new SPs_3907: bitstring;
                                        {4427}new UP_3908: bitstring;
                                        {4428}out(c, (SPs_3907,Sign,UP_3908,pkSess_3906))
                                    )
                                    else
                                        {4429}let v_3909: bool = (Sess_3563 = C) in
                                        (
                                            {4430}if v_3909 then
                                            (
                                                {4431}let pkSess_3910: bitstring = pub(skC) in
                                                {4432}in(c, =GetEndpointRequest);
                                                {4433}new SPs_3911: bitstring;
                                                {4434}new UP_3912: bitstring;
                                                {4435}out(c, (SPs_3911,Sign,UP_3912,pkSess_3910))
                                            )
                                            else
                                                {4436}let pkSess_3913: bitstring = pub(skI) in
                                                {4437}in(c, =GetEndpointRequest);
                                                {4438}new SPs_3914: bitstring;
                                                {4439}new UP_3915: bitstring;
                                                {4440}out(c, (SPs_3914,Sign,UP_3915,pkSess_3913))
                                        )
                                        else
                                            {4441}let pkSess_3916: bitstring = fail-any in
                                            {4442}in(c, =GetEndpointRequest);
                                            {4443}new SPs_3917: bitstring;
                                            {4444}new UP_3918: bitstring;
                                            {4445}out(c, (SPs_3917,Sign,UP_3918,pkSess_3916))
                                )
                                else
                                    {4446}let pkSess_3919: bitstring = fail-any in
                                    {4447}in(c, =GetEndpointRequest);
                                    {4448}new SPs_3920: bitstring;
                                    {4449}new UP_3921: bitstring;
                                    {4450}out(c, (SPs_3920,Sign,UP_3921,pkSess_3919))
                        )
                        else
                            {4451}let pkSess_3922: bitstring = fail-any in
                            {4452}in(c, =GetEndpointRequest);
                            {4453}new SPs_3923: bitstring;
                            {4454}new UP_3924: bitstring;
                            {4455}out(c, (SPs_3923,Sign,UP_3924,pkSess_3922))
                )
                else
                    {4456}let v_3925: bool = (Disco_3562 = C) in
                    (
                        {4457}if v_3925 then
                        (
                            {4458}let skDisco_3926: bitstring = skC in
                            {4459}let pkDisco_3927: bitstring = pub(skDisco_3926) in
                            {4460}let v_3928: bool = (Cli_3561 = A) in
                            (
                                {4461}if v_3928 then
                                (
                                    {4462}let pkCli_3929: bitstring = pub(skA) in
                                    {4463}let v_3930: bool = (Sess_3563 = A) in
                                    (
                                        {4464}if v_3930 then
                                        (
                                            {4465}let pkSess_3931: bitstring = pub(skA) in
                                            {4466}in(c, =GetEndpointRequest);
                                            {4467}new SPs_3932: bitstring;
                                            {4468}new UP_3933: bitstring;
                                            {4469}out(c, (SPs_3932,Sign,UP_3933,pkSess_3931))
                                        )
                                        else
                                            {4470}let v_3934: bool = (Sess_3563 = B) in
                                            (
                                                {4471}if v_3934 then
                                                (
                                                    {4472}let pkSess_3935: bitstring = pub(skB) in
                                                    {4473}in(c, =GetEndpointRequest);
                                                    {4474}new SPs_3936: bitstring;
                                                    {4475}new UP_3937: bitstring;
                                                    {4476}out(c, (SPs_3936,Sign,UP_3937,pkSess_3935))
                                                )
                                                else
                                                    {4477}let v_3938: bool = (Sess_3563 = C) in
                                                    (
                                                        {4478}if v_3938 then
                                                        (
                                                            {4479}let pkSess_3939: bitstring = pub(skC) in
                                                            {4480}in(c, =GetEndpointRequest);
                                                            {4481}new SPs_3940: bitstring;
                                                            {4482}new UP_3941: bitstring;
                                                            {4483}out(c, (SPs_3940,Sign,UP_3941,pkSess_3939))
                                                        )
                                                        else
                                                            {4484}let pkSess_3942: bitstring = pub(skI) in
                                                            {4485}in(c, =GetEndpointRequest);
                                                            {4486}new SPs_3943: bitstring;
                                                            {4487}new UP_3944: bitstring;
                                                            {4488}out(c, (SPs_3943,Sign,UP_3944,pkSess_3942))
                                                    )
                                                    else
                                                        {4489}let pkSess_3945: bitstring = fail-any in
                                                        {4490}in(c, =GetEndpointRequest);
                                                        {4491}new SPs_3946: bitstring;
                                                        {4492}new UP_3947: bitstring;
                                                        {4493}out(c, (SPs_3946,Sign,UP_3947,pkSess_3945))
                                            )
                                            else
                                                {4494}let pkSess_3948: bitstring = fail-any in
                                                {4495}in(c, =GetEndpointRequest);
                                                {4496}new SPs_3949: bitstring;
                                                {4497}new UP_3950: bitstring;
                                                {4498}out(c, (SPs_3949,Sign,UP_3950,pkSess_3948))
                                    )
                                    else
                                        {4499}let pkSess_3951: bitstring = fail-any in
                                        {4500}in(c, =GetEndpointRequest);
                                        {4501}new SPs_3952: bitstring;
                                        {4502}new UP_3953: bitstring;
                                        {4503}out(c, (SPs_3952,Sign,UP_3953,pkSess_3951))
                                )
                                else
                                    {4504}let v_3954: bool = (Cli_3561 = B) in
                                    (
                                        {4505}if v_3954 then
                                        (
                                            {4506}let pkCli_3955: bitstring = pub(skB) in
                                            {4507}let v_3956: bool = (Sess_3563 = A) in
                                            (
                                                {4508}if v_3956 then
                                                (
                                                    {4509}let pkSess_3957: bitstring = pub(skA) in
                                                    {4510}in(c, =GetEndpointRequest);
                                                    {4511}new SPs_3958: bitstring;
                                                    {4512}new UP_3959: bitstring;
                                                    {4513}out(c, (SPs_3958,Sign,UP_3959,pkSess_3957))
                                                )
                                                else
                                                    {4514}let v_3960: bool = (Sess_3563 = B) in
                                                    (
                                                        {4515}if v_3960 then
                                                        (
                                                            {4516}let pkSess_3961: bitstring = pub(skB) in
                                                            {4517}in(c, =GetEndpointRequest);
                                                            {4518}new SPs_3962: bitstring;
                                                            {4519}new UP_3963: bitstring;
                                                            {4520}out(c, (SPs_3962,Sign,UP_3963,pkSess_3961))
                                                        )
                                                        else
                                                            {4521}let v_3964: bool = (Sess_3563 = C) in
                                                            (
                                                                {4522}if v_3964 then
                                                                (
                                                                    {4523}let pkSess_3965: bitstring = pub(skC) in
                                                                    {4524}in(c, =GetEndpointRequest);
                                                                    {4525}new SPs_3966: bitstring;
                                                                    {4526}new UP_3967: bitstring;
                                                                    {4527}out(c, (SPs_3966,Sign,UP_3967,pkSess_3965))
                                                                )
                                                                else
                                                                    {4528}let pkSess_3968: bitstring = pub(skI) in
                                                                    {4529}in(c, =GetEndpointRequest);
                                                                    {4530}new SPs_3969: bitstring;
                                                                    {4531}new UP_3970: bitstring;
                                                                    {4532}out(c, (SPs_3969,Sign,UP_3970,pkSess_3968))
                                                            )
                                                            else
                                                                {4533}let pkSess_3971: bitstring = fail-any in
                                                                {4534}in(c, =GetEndpointRequest);
                                                                {4535}new SPs_3972: bitstring;
                                                                {4536}new UP_3973: bitstring;
                                                                {4537}out(c, (SPs_3972,Sign,UP_3973,pkSess_3971))
                                                    )
                                                    else
                                                        {4538}let pkSess_3974: bitstring = fail-any in
                                                        {4539}in(c, =GetEndpointRequest);
                                                        {4540}new SPs_3975: bitstring;
                                                        {4541}new UP_3976: bitstring;
                                                        {4542}out(c, (SPs_3975,Sign,UP_3976,pkSess_3974))
                                            )
                                            else
                                                {4543}let pkSess_3977: bitstring = fail-any in
                                                {4544}in(c, =GetEndpointRequest);
                                                {4545}new SPs_3978: bitstring;
                                                {4546}new UP_3979: bitstring;
                                                {4547}out(c, (SPs_3978,Sign,UP_3979,pkSess_3977))
                                        )
                                        else
                                            {4548}let v_3980: bool = (Cli_3561 = C) in
                                            (
                                                {4549}if v_3980 then
                                                (
                                                    {4550}let pkCli_3981: bitstring = pub(skC) in
                                                    {4551}let v_3982: bool = (Sess_3563 = A) in
                                                    (
                                                        {4552}if v_3982 then
                                                        (
                                                            {4553}let pkSess_3983: bitstring = pub(skA) in
                                                            {4554}in(c, =GetEndpointRequest);
                                                            {4555}new SPs_3984: bitstring;
                                                            {4556}new UP_3985: bitstring;
                                                            {4557}out(c, (SPs_3984,Sign,UP_3985,pkSess_3983))
                                                        )
                                                        else
                                                            {4558}let v_3986: bool = (Sess_3563 = B) in
                                                            (
                                                                {4559}if v_3986 then
                                                                (
                                                                    {4560}let pkSess_3987: bitstring = pub(skB) in
                                                                    {4561}in(c, =GetEndpointRequest);
                                                                    {4562}new SPs_3988: bitstring;
                                                                    {4563}new UP_3989: bitstring;
                                                                    {4564}out(c, (SPs_3988,Sign,UP_3989,pkSess_3987))
                                                                )
                                                                else
                                                                    {4565}let v_3990: bool = (Sess_3563 = C) in
                                                                    (
                                                                        {4566}if v_3990 then
                                                                        (
                                                                            {4567}let pkSess_3991: bitstring = pub(skC) in
                                                                            {4568}in(c, =GetEndpointRequest);
                                                                            {4569}new SPs_3992: bitstring;
                                                                            {4570}new UP_3993: bitstring;
                                                                            {4571}out(c, (SPs_3992,Sign,UP_3993,pkSess_3991))
                                                                        )
                                                                        else
                                                                            {4572}let pkSess_3994: bitstring = pub(skI) in
                                                                            {4573}in(c, =GetEndpointRequest);
                                                                            {4574}new SPs_3995: bitstring;
                                                                            {4575}new UP_3996: bitstring;
                                                                            {4576}out(c, (SPs_3995,Sign,UP_3996,pkSess_3994))
                                                                    )
                                                                    else
                                                                        {4577}let pkSess_3997: bitstring = fail-any in
                                                                        {4578}in(c, =GetEndpointRequest);
                                                                        {4579}new SPs_3998: bitstring;
                                                                        {4580}new UP_3999: bitstring;
                                                                        {4581}out(c, (SPs_3998,Sign,UP_3999,pkSess_3997))
                                                            )
                                                            else
                                                                {4582}let pkSess_4000: bitstring = fail-any in
                                                                {4583}in(c, =GetEndpointRequest);
                                                                {4584}new SPs_4001: bitstring;
                                                                {4585}new UP_4002: bitstring;
                                                                {4586}out(c, (SPs_4001,Sign,UP_4002,pkSess_4000))
                                                    )
                                                    else
                                                        {4587}let pkSess_4003: bitstring = fail-any in
                                                        {4588}in(c, =GetEndpointRequest);
                                                        {4589}new SPs_4004: bitstring;
                                                        {4590}new UP_4005: bitstring;
                                                        {4591}out(c, (SPs_4004,Sign,UP_4005,pkSess_4003))
                                                )
                                                else
                                                    {4592}let pkCli_4006: bitstring = pub(skI) in
                                                    {4593}let v_4007: bool = (Sess_3563 = A) in
                                                    (
                                                        {4594}if v_4007 then
                                                        (
                                                            {4595}let pkSess_4008: bitstring = pub(skA) in
                                                            {4596}in(c, =GetEndpointRequest);
                                                            {4597}new SPs_4009: bitstring;
                                                            {4598}new UP_4010: bitstring;
                                                            {4599}out(c, (SPs_4009,Sign,UP_4010,pkSess_4008))
                                                        )
                                                        else
                                                            {4600}let v_4011: bool = (Sess_3563 = B) in
                                                            (
                                                                {4601}if v_4011 then
                                                                (
                                                                    {4602}let pkSess_4012: bitstring = pub(skB) in
                                                                    {4603}in(c, =GetEndpointRequest);
                                                                    {4604}new SPs_4013: bitstring;
                                                                    {4605}new UP_4014: bitstring;
                                                                    {4606}out(c, (SPs_4013,Sign,UP_4014,pkSess_4012))
                                                                )
                                                                else
                                                                    {4607}let v_4015: bool = (Sess_3563 = C) in
                                                                    (
                                                                        {4608}if v_4015 then
                                                                        (
                                                                            {4609}let pkSess_4016: bitstring = pub(skC) in
                                                                            {4610}in(c, =GetEndpointRequest);
                                                                            {4611}new SPs_4017: bitstring;
                                                                            {4612}new UP_4018: bitstring;
                                                                            {4613}out(c, (SPs_4017,Sign,UP_4018,pkSess_4016))
                                                                        )
                                                                        else
                                                                            {4614}let pkSess_4019: bitstring = pub(skI) in
                                                                            {4615}in(c, =GetEndpointRequest);
                                                                            {4616}new SPs_4020: bitstring;
                                                                            {4617}new UP_4021: bitstring;
                                                                            {4618}out(c, (SPs_4020,Sign,UP_4021,pkSess_4019))
                                                                    )
                                                                    else
                                                                        {4619}let pkSess_4022: bitstring = fail-any in
                                                                        {4620}in(c, =GetEndpointRequest);
                                                                        {4621}new SPs_4023: bitstring;
                                                                        {4622}new UP_4024: bitstring;
                                                                        {4623}out(c, (SPs_4023,Sign,UP_4024,pkSess_4022))
                                                            )
                                                            else
                                                                {4624}let pkSess_4025: bitstring = fail-any in
                                                                {4625}in(c, =GetEndpointRequest);
                                                                {4626}new SPs_4026: bitstring;
                                                                {4627}new UP_4027: bitstring;
                                                                {4628}out(c, (SPs_4026,Sign,UP_4027,pkSess_4025))
                                                    )
                                                    else
                                                        {4629}let pkSess_4028: bitstring = fail-any in
                                                        {4630}in(c, =GetEndpointRequest);
                                                        {4631}new SPs_4029: bitstring;
                                                        {4632}new UP_4030: bitstring;
                                                        {4633}out(c, (SPs_4029,Sign,UP_4030,pkSess_4028))
                                            )
                                            else
                                                {4634}let pkCli_4031: bitstring = fail-any in
                                                {4635}let v_4032: bool = (Sess_3563 = A) in
                                                (
                                                    {4636}if v_4032 then
                                                    (
                                                        {4637}let pkSess_4033: bitstring = pub(skA) in
                                                        {4638}in(c, =GetEndpointRequest);
                                                        {4639}new SPs_4034: bitstring;
                                                        {4640}new UP_4035: bitstring;
                                                        {4641}out(c, (SPs_4034,Sign,UP_4035,pkSess_4033))
                                                    )
                                                    else
                                                        {4642}let v_4036: bool = (Sess_3563 = B) in
                                                        (
                                                            {4643}if v_4036 then
                                                            (
                                                                {4644}let pkSess_4037: bitstring = pub(skB) in
                                                                {4645}in(c, =GetEndpointRequest);
                                                                {4646}new SPs_4038: bitstring;
                                                                {4647}new UP_4039: bitstring;
                                                                {4648}out(c, (SPs_4038,Sign,UP_4039,pkSess_4037))
                                                            )
                                                            else
                                                                {4649}let v_4040: bool = (Sess_3563 = C) in
                                                                (
                                                                    {4650}if v_4040 then
                                                                    (
                                                                        {4651}let pkSess_4041: bitstring = pub(skC) in
                                                                        {4652}in(c, =GetEndpointRequest);
                                                                        {4653}new SPs_4042: bitstring;
                                                                        {4654}new UP_4043: bitstring;
                                                                        {4655}out(c, (SPs_4042,Sign,UP_4043,pkSess_4041))
                                                                    )
                                                                    else
                                                                        {4656}let pkSess_4044: bitstring = pub(skI) in
                                                                        {4657}in(c, =GetEndpointRequest);
                                                                        {4658}new SPs_4045: bitstring;
                                                                        {4659}new UP_4046: bitstring;
                                                                        {4660}out(c, (SPs_4045,Sign,UP_4046,pkSess_4044))
                                                                )
                                                                else
                                                                    {4661}let pkSess_4047: bitstring = fail-any in
                                                                    {4662}in(c, =GetEndpointRequest);
                                                                    {4663}new SPs_4048: bitstring;
                                                                    {4664}new UP_4049: bitstring;
                                                                    {4665}out(c, (SPs_4048,Sign,UP_4049,pkSess_4047))
                                                        )
                                                        else
                                                            {4666}let pkSess_4050: bitstring = fail-any in
                                                            {4667}in(c, =GetEndpointRequest);
                                                            {4668}new SPs_4051: bitstring;
                                                            {4669}new UP_4052: bitstring;
                                                            {4670}out(c, (SPs_4051,Sign,UP_4052,pkSess_4050))
                                                )
                                                else
                                                    {4671}let pkSess_4053: bitstring = fail-any in
                                                    {4672}in(c, =GetEndpointRequest);
                                                    {4673}new SPs_4054: bitstring;
                                                    {4674}new UP_4055: bitstring;
                                                    {4675}out(c, (SPs_4054,Sign,UP_4055,pkSess_4053))
                                    )
                                    else
                                        {4676}let pkCli_4056: bitstring = fail-any in
                                        {4677}let v_4057: bool = (Sess_3563 = A) in
                                        (
                                            {4678}if v_4057 then
                                            (
                                                {4679}let pkSess_4058: bitstring = pub(skA) in
                                                {4680}in(c, =GetEndpointRequest);
                                                {4681}new SPs_4059: bitstring;
                                                {4682}new UP_4060: bitstring;
                                                {4683}out(c, (SPs_4059,Sign,UP_4060,pkSess_4058))
                                            )
                                            else
                                                {4684}let v_4061: bool = (Sess_3563 = B) in
                                                (
                                                    {4685}if v_4061 then
                                                    (
                                                        {4686}let pkSess_4062: bitstring = pub(skB) in
                                                        {4687}in(c, =GetEndpointRequest);
                                                        {4688}new SPs_4063: bitstring;
                                                        {4689}new UP_4064: bitstring;
                                                        {4690}out(c, (SPs_4063,Sign,UP_4064,pkSess_4062))
                                                    )
                                                    else
                                                        {4691}let v_4065: bool = (Sess_3563 = C) in
                                                        (
                                                            {4692}if v_4065 then
                                                            (
                                                                {4693}let pkSess_4066: bitstring = pub(skC) in
                                                                {4694}in(c, =GetEndpointRequest);
                                                                {4695}new SPs_4067: bitstring;
                                                                {4696}new UP_4068: bitstring;
                                                                {4697}out(c, (SPs_4067,Sign,UP_4068,pkSess_4066))
                                                            )
                                                            else
                                                                {4698}let pkSess_4069: bitstring = pub(skI) in
                                                                {4699}in(c, =GetEndpointRequest);
                                                                {4700}new SPs_4070: bitstring;
                                                                {4701}new UP_4071: bitstring;
                                                                {4702}out(c, (SPs_4070,Sign,UP_4071,pkSess_4069))
                                                        )
                                                        else
                                                            {4703}let pkSess_4072: bitstring = fail-any in
                                                            {4704}in(c, =GetEndpointRequest);
                                                            {4705}new SPs_4073: bitstring;
                                                            {4706}new UP_4074: bitstring;
                                                            {4707}out(c, (SPs_4073,Sign,UP_4074,pkSess_4072))
                                                )
                                                else
                                                    {4708}let pkSess_4075: bitstring = fail-any in
                                                    {4709}in(c, =GetEndpointRequest);
                                                    {4710}new SPs_4076: bitstring;
                                                    {4711}new UP_4077: bitstring;
                                                    {4712}out(c, (SPs_4076,Sign,UP_4077,pkSess_4075))
                                        )
                                        else
                                            {4713}let pkSess_4078: bitstring = fail-any in
                                            {4714}in(c, =GetEndpointRequest);
                                            {4715}new SPs_4079: bitstring;
                                            {4716}new UP_4080: bitstring;
                                            {4717}out(c, (SPs_4079,Sign,UP_4080,pkSess_4078))
                            )
                            else
                                {4718}let pkCli_4081: bitstring = fail-any in
                                {4719}let v_4082: bool = (Sess_3563 = A) in
                                (
                                    {4720}if v_4082 then
                                    (
                                        {4721}let pkSess_4083: bitstring = pub(skA) in
                                        {4722}in(c, =GetEndpointRequest);
                                        {4723}new SPs_4084: bitstring;
                                        {4724}new UP_4085: bitstring;
                                        {4725}out(c, (SPs_4084,Sign,UP_4085,pkSess_4083))
                                    )
                                    else
                                        {4726}let v_4086: bool = (Sess_3563 = B) in
                                        (
                                            {4727}if v_4086 then
                                            (
                                                {4728}let pkSess_4087: bitstring = pub(skB) in
                                                {4729}in(c, =GetEndpointRequest);
                                                {4730}new SPs_4088: bitstring;
                                                {4731}new UP_4089: bitstring;
                                                {4732}out(c, (SPs_4088,Sign,UP_4089,pkSess_4087))
                                            )
                                            else
                                                {4733}let v_4090: bool = (Sess_3563 = C) in
                                                (
                                                    {4734}if v_4090 then
                                                    (
                                                        {4735}let pkSess_4091: bitstring = pub(skC) in
                                                        {4736}in(c, =GetEndpointRequest);
                                                        {4737}new SPs_4092: bitstring;
                                                        {4738}new UP_4093: bitstring;
                                                        {4739}out(c, (SPs_4092,Sign,UP_4093,pkSess_4091))
                                                    )
                                                    else
                                                        {4740}let pkSess_4094: bitstring = pub(skI) in
                                                        {4741}in(c, =GetEndpointRequest);
                                                        {4742}new SPs_4095: bitstring;
                                                        {4743}new UP_4096: bitstring;
                                                        {4744}out(c, (SPs_4095,Sign,UP_4096,pkSess_4094))
                                                )
                                                else
                                                    {4745}let pkSess_4097: bitstring = fail-any in
                                                    {4746}in(c, =GetEndpointRequest);
                                                    {4747}new SPs_4098: bitstring;
                                                    {4748}new UP_4099: bitstring;
                                                    {4749}out(c, (SPs_4098,Sign,UP_4099,pkSess_4097))
                                        )
                                        else
                                            {4750}let pkSess_4100: bitstring = fail-any in
                                            {4751}in(c, =GetEndpointRequest);
                                            {4752}new SPs_4101: bitstring;
                                            {4753}new UP_4102: bitstring;
                                            {4754}out(c, (SPs_4101,Sign,UP_4102,pkSess_4100))
                                )
                                else
                                    {4755}let pkSess_4103: bitstring = fail-any in
                                    {4756}in(c, =GetEndpointRequest);
                                    {4757}new SPs_4104: bitstring;
                                    {4758}new UP_4105: bitstring;
                                    {4759}out(c, (SPs_4104,Sign,UP_4105,pkSess_4103))
                        )
                        else
                            {4760}let skDisco_4106: bitstring = skI in
                            {4761}let pkDisco_4107: bitstring = pub(skDisco_4106) in
                            {4762}let v_4108: bool = (Cli_3561 = A) in
                            (
                                {4763}if v_4108 then
                                (
                                    {4764}let pkCli_4109: bitstring = pub(skA) in
                                    {4765}let v_4110: bool = (Sess_3563 = A) in
                                    (
                                        {4766}if v_4110 then
                                        (
                                            {4767}let pkSess_4111: bitstring = pub(skA) in
                                            {4768}in(c, =GetEndpointRequest);
                                            {4769}new SPs_4112: bitstring;
                                            {4770}new UP_4113: bitstring;
                                            {4771}out(c, (SPs_4112,Sign,UP_4113,pkSess_4111))
                                        )
                                        else
                                            {4772}let v_4114: bool = (Sess_3563 = B) in
                                            (
                                                {4773}if v_4114 then
                                                (
                                                    {4774}let pkSess_4115: bitstring = pub(skB) in
                                                    {4775}in(c, =GetEndpointRequest);
                                                    {4776}new SPs_4116: bitstring;
                                                    {4777}new UP_4117: bitstring;
                                                    {4778}out(c, (SPs_4116,Sign,UP_4117,pkSess_4115))
                                                )
                                                else
                                                    {4779}let v_4118: bool = (Sess_3563 = C) in
                                                    (
                                                        {4780}if v_4118 then
                                                        (
                                                            {4781}let pkSess_4119: bitstring = pub(skC) in
                                                            {4782}in(c, =GetEndpointRequest);
                                                            {4783}new SPs_4120: bitstring;
                                                            {4784}new UP_4121: bitstring;
                                                            {4785}out(c, (SPs_4120,Sign,UP_4121,pkSess_4119))
                                                        )
                                                        else
                                                            {4786}let pkSess_4122: bitstring = pub(skI) in
                                                            {4787}in(c, =GetEndpointRequest);
                                                            {4788}new SPs_4123: bitstring;
                                                            {4789}new UP_4124: bitstring;
                                                            {4790}out(c, (SPs_4123,Sign,UP_4124,pkSess_4122))
                                                    )
                                                    else
                                                        {4791}let pkSess_4125: bitstring = fail-any in
                                                        {4792}in(c, =GetEndpointRequest);
                                                        {4793}new SPs_4126: bitstring;
                                                        {4794}new UP_4127: bitstring;
                                                        {4795}out(c, (SPs_4126,Sign,UP_4127,pkSess_4125))
                                            )
                                            else
                                                {4796}let pkSess_4128: bitstring = fail-any in
                                                {4797}in(c, =GetEndpointRequest);
                                                {4798}new SPs_4129: bitstring;
                                                {4799}new UP_4130: bitstring;
                                                {4800}out(c, (SPs_4129,Sign,UP_4130,pkSess_4128))
                                    )
                                    else
                                        {4801}let pkSess_4131: bitstring = fail-any in
                                        {4802}in(c, =GetEndpointRequest);
                                        {4803}new SPs_4132: bitstring;
                                        {4804}new UP_4133: bitstring;
                                        {4805}out(c, (SPs_4132,Sign,UP_4133,pkSess_4131))
                                )
                                else
                                    {4806}let v_4134: bool = (Cli_3561 = B) in
                                    (
                                        {4807}if v_4134 then
                                        (
                                            {4808}let pkCli_4135: bitstring = pub(skB) in
                                            {4809}let v_4136: bool = (Sess_3563 = A) in
                                            (
                                                {4810}if v_4136 then
                                                (
                                                    {4811}let pkSess_4137: bitstring = pub(skA) in
                                                    {4812}in(c, =GetEndpointRequest);
                                                    {4813}new SPs_4138: bitstring;
                                                    {4814}new UP_4139: bitstring;
                                                    {4815}out(c, (SPs_4138,Sign,UP_4139,pkSess_4137))
                                                )
                                                else
                                                    {4816}let v_4140: bool = (Sess_3563 = B) in
                                                    (
                                                        {4817}if v_4140 then
                                                        (
                                                            {4818}let pkSess_4141: bitstring = pub(skB) in
                                                            {4819}in(c, =GetEndpointRequest);
                                                            {4820}new SPs_4142: bitstring;
                                                            {4821}new UP_4143: bitstring;
                                                            {4822}out(c, (SPs_4142,Sign,UP_4143,pkSess_4141))
                                                        )
                                                        else
                                                            {4823}let v_4144: bool = (Sess_3563 = C) in
                                                            (
                                                                {4824}if v_4144 then
                                                                (
                                                                    {4825}let pkSess_4145: bitstring = pub(skC) in
                                                                    {4826}in(c, =GetEndpointRequest);
                                                                    {4827}new SPs_4146: bitstring;
                                                                    {4828}new UP_4147: bitstring;
                                                                    {4829}out(c, (SPs_4146,Sign,UP_4147,pkSess_4145))
                                                                )
                                                                else
                                                                    {4830}let pkSess_4148: bitstring = pub(skI) in
                                                                    {4831}in(c, =GetEndpointRequest);
                                                                    {4832}new SPs_4149: bitstring;
                                                                    {4833}new UP_4150: bitstring;
                                                                    {4834}out(c, (SPs_4149,Sign,UP_4150,pkSess_4148))
                                                            )
                                                            else
                                                                {4835}let pkSess_4151: bitstring = fail-any in
                                                                {4836}in(c, =GetEndpointRequest);
                                                                {4837}new SPs_4152: bitstring;
                                                                {4838}new UP_4153: bitstring;
                                                                {4839}out(c, (SPs_4152,Sign,UP_4153,pkSess_4151))
                                                    )
                                                    else
                                                        {4840}let pkSess_4154: bitstring = fail-any in
                                                        {4841}in(c, =GetEndpointRequest);
                                                        {4842}new SPs_4155: bitstring;
                                                        {4843}new UP_4156: bitstring;
                                                        {4844}out(c, (SPs_4155,Sign,UP_4156,pkSess_4154))
                                            )
                                            else
                                                {4845}let pkSess_4157: bitstring = fail-any in
                                                {4846}in(c, =GetEndpointRequest);
                                                {4847}new SPs_4158: bitstring;
                                                {4848}new UP_4159: bitstring;
                                                {4849}out(c, (SPs_4158,Sign,UP_4159,pkSess_4157))
                                        )
                                        else
                                            {4850}let v_4160: bool = (Cli_3561 = C) in
                                            (
                                                {4851}if v_4160 then
                                                (
                                                    {4852}let pkCli_4161: bitstring = pub(skC) in
                                                    {4853}let v_4162: bool = (Sess_3563 = A) in
                                                    (
                                                        {4854}if v_4162 then
                                                        (
                                                            {4855}let pkSess_4163: bitstring = pub(skA) in
                                                            {4856}in(c, =GetEndpointRequest);
                                                            {4857}new SPs_4164: bitstring;
                                                            {4858}new UP_4165: bitstring;
                                                            {4859}out(c, (SPs_4164,Sign,UP_4165,pkSess_4163))
                                                        )
                                                        else
                                                            {4860}let v_4166: bool = (Sess_3563 = B) in
                                                            (
                                                                {4861}if v_4166 then
                                                                (
                                                                    {4862}let pkSess_4167: bitstring = pub(skB) in
                                                                    {4863}in(c, =GetEndpointRequest);
                                                                    {4864}new SPs_4168: bitstring;
                                                                    {4865}new UP_4169: bitstring;
                                                                    {4866}out(c, (SPs_4168,Sign,UP_4169,pkSess_4167))
                                                                )
                                                                else
                                                                    {4867}let v_4170: bool = (Sess_3563 = C) in
                                                                    (
                                                                        {4868}if v_4170 then
                                                                        (
                                                                            {4869}let pkSess_4171: bitstring = pub(skC) in
                                                                            {4870}in(c, =GetEndpointRequest);
                                                                            {4871}new SPs_4172: bitstring;
                                                                            {4872}new UP_4173: bitstring;
                                                                            {4873}out(c, (SPs_4172,Sign,UP_4173,pkSess_4171))
                                                                        )
                                                                        else
                                                                            {4874}let pkSess_4174: bitstring = pub(skI) in
                                                                            {4875}in(c, =GetEndpointRequest);
                                                                            {4876}new SPs_4175: bitstring;
                                                                            {4877}new UP_4176: bitstring;
                                                                            {4878}out(c, (SPs_4175,Sign,UP_4176,pkSess_4174))
                                                                    )
                                                                    else
                                                                        {4879}let pkSess_4177: bitstring = fail-any in
                                                                        {4880}in(c, =GetEndpointRequest);
                                                                        {4881}new SPs_4178: bitstring;
                                                                        {4882}new UP_4179: bitstring;
                                                                        {4883}out(c, (SPs_4178,Sign,UP_4179,pkSess_4177))
                                                            )
                                                            else
                                                                {4884}let pkSess_4180: bitstring = fail-any in
                                                                {4885}in(c, =GetEndpointRequest);
                                                                {4886}new SPs_4181: bitstring;
                                                                {4887}new UP_4182: bitstring;
                                                                {4888}out(c, (SPs_4181,Sign,UP_4182,pkSess_4180))
                                                    )
                                                    else
                                                        {4889}let pkSess_4183: bitstring = fail-any in
                                                        {4890}in(c, =GetEndpointRequest);
                                                        {4891}new SPs_4184: bitstring;
                                                        {4892}new UP_4185: bitstring;
                                                        {4893}out(c, (SPs_4184,Sign,UP_4185,pkSess_4183))
                                                )
                                                else
                                                    {4894}let pkCli_4186: bitstring = pub(skI) in
                                                    {4895}let v_4187: bool = (Sess_3563 = A) in
                                                    (
                                                        {4896}if v_4187 then
                                                        (
                                                            {4897}let pkSess_4188: bitstring = pub(skA) in
                                                            {4898}in(c, =GetEndpointRequest);
                                                            {4899}new SPs_4189: bitstring;
                                                            {4900}new UP_4190: bitstring;
                                                            {4901}out(c, (SPs_4189,Sign,UP_4190,pkSess_4188))
                                                        )
                                                        else
                                                            {4902}let v_4191: bool = (Sess_3563 = B) in
                                                            (
                                                                {4903}if v_4191 then
                                                                (
                                                                    {4904}let pkSess_4192: bitstring = pub(skB) in
                                                                    {4905}in(c, =GetEndpointRequest);
                                                                    {4906}new SPs_4193: bitstring;
                                                                    {4907}new UP_4194: bitstring;
                                                                    {4908}out(c, (SPs_4193,Sign,UP_4194,pkSess_4192))
                                                                )
                                                                else
                                                                    {4909}let v_4195: bool = (Sess_3563 = C) in
                                                                    (
                                                                        {4910}if v_4195 then
                                                                        (
                                                                            {4911}let pkSess_4196: bitstring = pub(skC) in
                                                                            {4912}in(c, =GetEndpointRequest);
                                                                            {4913}new SPs_4197: bitstring;
                                                                            {4914}new UP_4198: bitstring;
                                                                            {4915}out(c, (SPs_4197,Sign,UP_4198,pkSess_4196))
                                                                        )
                                                                        else
                                                                            {4916}let pkSess_4199: bitstring = pub(skI) in
                                                                            {4917}in(c, =GetEndpointRequest);
                                                                            {4918}new SPs_4200: bitstring;
                                                                            {4919}new UP_4201: bitstring;
                                                                            {4920}out(c, (SPs_4200,Sign,UP_4201,pkSess_4199))
                                                                    )
                                                                    else
                                                                        {4921}let pkSess_4202: bitstring = fail-any in
                                                                        {4922}in(c, =GetEndpointRequest);
                                                                        {4923}new SPs_4203: bitstring;
                                                                        {4924}new UP_4204: bitstring;
                                                                        {4925}out(c, (SPs_4203,Sign,UP_4204,pkSess_4202))
                                                            )
                                                            else
                                                                {4926}let pkSess_4205: bitstring = fail-any in
                                                                {4927}in(c, =GetEndpointRequest);
                                                                {4928}new SPs_4206: bitstring;
                                                                {4929}new UP_4207: bitstring;
                                                                {4930}out(c, (SPs_4206,Sign,UP_4207,pkSess_4205))
                                                    )
                                                    else
                                                        {4931}let pkSess_4208: bitstring = fail-any in
                                                        {4932}in(c, =GetEndpointRequest);
                                                        {4933}new SPs_4209: bitstring;
                                                        {4934}new UP_4210: bitstring;
                                                        {4935}out(c, (SPs_4209,Sign,UP_4210,pkSess_4208))
                                            )
                                            else
                                                {4936}let pkCli_4211: bitstring = fail-any in
                                                {4937}let v_4212: bool = (Sess_3563 = A) in
                                                (
                                                    {4938}if v_4212 then
                                                    (
                                                        {4939}let pkSess_4213: bitstring = pub(skA) in
                                                        {4940}in(c, =GetEndpointRequest);
                                                        {4941}new SPs_4214: bitstring;
                                                        {4942}new UP_4215: bitstring;
                                                        {4943}out(c, (SPs_4214,Sign,UP_4215,pkSess_4213))
                                                    )
                                                    else
                                                        {4944}let v_4216: bool = (Sess_3563 = B) in
                                                        (
                                                            {4945}if v_4216 then
                                                            (
                                                                {4946}let pkSess_4217: bitstring = pub(skB) in
                                                                {4947}in(c, =GetEndpointRequest);
                                                                {4948}new SPs_4218: bitstring;
                                                                {4949}new UP_4219: bitstring;
                                                                {4950}out(c, (SPs_4218,Sign,UP_4219,pkSess_4217))
                                                            )
                                                            else
                                                                {4951}let v_4220: bool = (Sess_3563 = C) in
                                                                (
                                                                    {4952}if v_4220 then
                                                                    (
                                                                        {4953}let pkSess_4221: bitstring = pub(skC) in
                                                                        {4954}in(c, =GetEndpointRequest);
                                                                        {4955}new SPs_4222: bitstring;
                                                                        {4956}new UP_4223: bitstring;
                                                                        {4957}out(c, (SPs_4222,Sign,UP_4223,pkSess_4221))
                                                                    )
                                                                    else
                                                                        {4958}let pkSess_4224: bitstring = pub(skI) in
                                                                        {4959}in(c, =GetEndpointRequest);
                                                                        {4960}new SPs_4225: bitstring;
                                                                        {4961}new UP_4226: bitstring;
                                                                        {4962}out(c, (SPs_4225,Sign,UP_4226,pkSess_4224))
                                                                )
                                                                else
                                                                    {4963}let pkSess_4227: bitstring = fail-any in
                                                                    {4964}in(c, =GetEndpointRequest);
                                                                    {4965}new SPs_4228: bitstring;
                                                                    {4966}new UP_4229: bitstring;
                                                                    {4967}out(c, (SPs_4228,Sign,UP_4229,pkSess_4227))
                                                        )
                                                        else
                                                            {4968}let pkSess_4230: bitstring = fail-any in
                                                            {4969}in(c, =GetEndpointRequest);
                                                            {4970}new SPs_4231: bitstring;
                                                            {4971}new UP_4232: bitstring;
                                                            {4972}out(c, (SPs_4231,Sign,UP_4232,pkSess_4230))
                                                )
                                                else
                                                    {4973}let pkSess_4233: bitstring = fail-any in
                                                    {4974}in(c, =GetEndpointRequest);
                                                    {4975}new SPs_4234: bitstring;
                                                    {4976}new UP_4235: bitstring;
                                                    {4977}out(c, (SPs_4234,Sign,UP_4235,pkSess_4233))
                                    )
                                    else
                                        {4978}let pkCli_4236: bitstring = fail-any in
                                        {4979}let v_4237: bool = (Sess_3563 = A) in
                                        (
                                            {4980}if v_4237 then
                                            (
                                                {4981}let pkSess_4238: bitstring = pub(skA) in
                                                {4982}in(c, =GetEndpointRequest);
                                                {4983}new SPs_4239: bitstring;
                                                {4984}new UP_4240: bitstring;
                                                {4985}out(c, (SPs_4239,Sign,UP_4240,pkSess_4238))
                                            )
                                            else
                                                {4986}let v_4241: bool = (Sess_3563 = B) in
                                                (
                                                    {4987}if v_4241 then
                                                    (
                                                        {4988}let pkSess_4242: bitstring = pub(skB) in
                                                        {4989}in(c, =GetEndpointRequest);
                                                        {4990}new SPs_4243: bitstring;
                                                        {4991}new UP_4244: bitstring;
                                                        {4992}out(c, (SPs_4243,Sign,UP_4244,pkSess_4242))
                                                    )
                                                    else
                                                        {4993}let v_4245: bool = (Sess_3563 = C) in
                                                        (
                                                            {4994}if v_4245 then
                                                            (
                                                                {4995}let pkSess_4246: bitstring = pub(skC) in
                                                                {4996}in(c, =GetEndpointRequest);
                                                                {4997}new SPs_4247: bitstring;
                                                                {4998}new UP_4248: bitstring;
                                                                {4999}out(c, (SPs_4247,Sign,UP_4248,pkSess_4246))
                                                            )
                                                            else
                                                                {5000}let pkSess_4249: bitstring = pub(skI) in
                                                                {5001}in(c, =GetEndpointRequest);
                                                                {5002}new SPs_4250: bitstring;
                                                                {5003}new UP_4251: bitstring;
                                                                {5004}out(c, (SPs_4250,Sign,UP_4251,pkSess_4249))
                                                        )
                                                        else
                                                            {5005}let pkSess_4252: bitstring = fail-any in
                                                            {5006}in(c, =GetEndpointRequest);
                                                            {5007}new SPs_4253: bitstring;
                                                            {5008}new UP_4254: bitstring;
                                                            {5009}out(c, (SPs_4253,Sign,UP_4254,pkSess_4252))
                                                )
                                                else
                                                    {5010}let pkSess_4255: bitstring = fail-any in
                                                    {5011}in(c, =GetEndpointRequest);
                                                    {5012}new SPs_4256: bitstring;
                                                    {5013}new UP_4257: bitstring;
                                                    {5014}out(c, (SPs_4256,Sign,UP_4257,pkSess_4255))
                                        )
                                        else
                                            {5015}let pkSess_4258: bitstring = fail-any in
                                            {5016}in(c, =GetEndpointRequest);
                                            {5017}new SPs_4259: bitstring;
                                            {5018}new UP_4260: bitstring;
                                            {5019}out(c, (SPs_4259,Sign,UP_4260,pkSess_4258))
                            )
                            else
                                {5020}let pkCli_4261: bitstring = fail-any in
                                {5021}let v_4262: bool = (Sess_3563 = A) in
                                (
                                    {5022}if v_4262 then
                                    (
                                        {5023}let pkSess_4263: bitstring = pub(skA) in
                                        {5024}in(c, =GetEndpointRequest);
                                        {5025}new SPs_4264: bitstring;
                                        {5026}new UP_4265: bitstring;
                                        {5027}out(c, (SPs_4264,Sign,UP_4265,pkSess_4263))
                                    )
                                    else
                                        {5028}let v_4266: bool = (Sess_3563 = B) in
                                        (
                                            {5029}if v_4266 then
                                            (
                                                {5030}let pkSess_4267: bitstring = pub(skB) in
                                                {5031}in(c, =GetEndpointRequest);
                                                {5032}new SPs_4268: bitstring;
                                                {5033}new UP_4269: bitstring;
                                                {5034}out(c, (SPs_4268,Sign,UP_4269,pkSess_4267))
                                            )
                                            else
                                                {5035}let v_4270: bool = (Sess_3563 = C) in
                                                (
                                                    {5036}if v_4270 then
                                                    (
                                                        {5037}let pkSess_4271: bitstring = pub(skC) in
                                                        {5038}in(c, =GetEndpointRequest);
                                                        {5039}new SPs_4272: bitstring;
                                                        {5040}new UP_4273: bitstring;
                                                        {5041}out(c, (SPs_4272,Sign,UP_4273,pkSess_4271))
                                                    )
                                                    else
                                                        {5042}let pkSess_4274: bitstring = pub(skI) in
                                                        {5043}in(c, =GetEndpointRequest);
                                                        {5044}new SPs_4275: bitstring;
                                                        {5045}new UP_4276: bitstring;
                                                        {5046}out(c, (SPs_4275,Sign,UP_4276,pkSess_4274))
                                                )
                                                else
                                                    {5047}let pkSess_4277: bitstring = fail-any in
                                                    {5048}in(c, =GetEndpointRequest);
                                                    {5049}new SPs_4278: bitstring;
                                                    {5050}new UP_4279: bitstring;
                                                    {5051}out(c, (SPs_4278,Sign,UP_4279,pkSess_4277))
                                        )
                                        else
                                            {5052}let pkSess_4280: bitstring = fail-any in
                                            {5053}in(c, =GetEndpointRequest);
                                            {5054}new SPs_4281: bitstring;
                                            {5055}new UP_4282: bitstring;
                                            {5056}out(c, (SPs_4281,Sign,UP_4282,pkSess_4280))
                                )
                                else
                                    {5057}let pkSess_4283: bitstring = fail-any in
                                    {5058}in(c, =GetEndpointRequest);
                                    {5059}new SPs_4284: bitstring;
                                    {5060}new UP_4285: bitstring;
                                    {5061}out(c, (SPs_4284,Sign,UP_4285,pkSess_4283))
                    )
                    else
                        {5062}let skDisco_4286: bitstring = fail-any in
                        {5063}let pkDisco_4287: bitstring = pub(skDisco_4286) in
                        {5064}let v_4288: bool = (Cli_3561 = A) in
                        (
                            {5065}if v_4288 then
                            (
                                {5066}let pkCli_4289: bitstring = pub(skA) in
                                {5067}let v_4290: bool = (Sess_3563 = A) in
                                (
                                    {5068}if v_4290 then
                                    (
                                        {5069}let pkSess_4291: bitstring = pub(skA) in
                                        {5070}in(c, =GetEndpointRequest);
                                        {5071}new SPs_4292: bitstring;
                                        {5072}new UP_4293: bitstring;
                                        {5073}out(c, (SPs_4292,Sign,UP_4293,pkSess_4291))
                                    )
                                    else
                                        {5074}let v_4294: bool = (Sess_3563 = B) in
                                        (
                                            {5075}if v_4294 then
                                            (
                                                {5076}let pkSess_4295: bitstring = pub(skB) in
                                                {5077}in(c, =GetEndpointRequest);
                                                {5078}new SPs_4296: bitstring;
                                                {5079}new UP_4297: bitstring;
                                                {5080}out(c, (SPs_4296,Sign,UP_4297,pkSess_4295))
                                            )
                                            else
                                                {5081}let v_4298: bool = (Sess_3563 = C) in
                                                (
                                                    {5082}if v_4298 then
                                                    (
                                                        {5083}let pkSess_4299: bitstring = pub(skC) in
                                                        {5084}in(c, =GetEndpointRequest);
                                                        {5085}new SPs_4300: bitstring;
                                                        {5086}new UP_4301: bitstring;
                                                        {5087}out(c, (SPs_4300,Sign,UP_4301,pkSess_4299))
                                                    )
                                                    else
                                                        {5088}let pkSess_4302: bitstring = pub(skI) in
                                                        {5089}in(c, =GetEndpointRequest);
                                                        {5090}new SPs_4303: bitstring;
                                                        {5091}new UP_4304: bitstring;
                                                        {5092}out(c, (SPs_4303,Sign,UP_4304,pkSess_4302))
                                                )
                                                else
                                                    {5093}let pkSess_4305: bitstring = fail-any in
                                                    {5094}in(c, =GetEndpointRequest);
                                                    {5095}new SPs_4306: bitstring;
                                                    {5096}new UP_4307: bitstring;
                                                    {5097}out(c, (SPs_4306,Sign,UP_4307,pkSess_4305))
                                        )
                                        else
                                            {5098}let pkSess_4308: bitstring = fail-any in
                                            {5099}in(c, =GetEndpointRequest);
                                            {5100}new SPs_4309: bitstring;
                                            {5101}new UP_4310: bitstring;
                                            {5102}out(c, (SPs_4309,Sign,UP_4310,pkSess_4308))
                                )
                                else
                                    {5103}let pkSess_4311: bitstring = fail-any in
                                    {5104}in(c, =GetEndpointRequest);
                                    {5105}new SPs_4312: bitstring;
                                    {5106}new UP_4313: bitstring;
                                    {5107}out(c, (SPs_4312,Sign,UP_4313,pkSess_4311))
                            )
                            else
                                {5108}let v_4314: bool = (Cli_3561 = B) in
                                (
                                    {5109}if v_4314 then
                                    (
                                        {5110}let pkCli_4315: bitstring = pub(skB) in
                                        {5111}let v_4316: bool = (Sess_3563 = A) in
                                        (
                                            {5112}if v_4316 then
                                            (
                                                {5113}let pkSess_4317: bitstring = pub(skA) in
                                                {5114}in(c, =GetEndpointRequest);
                                                {5115}new SPs_4318: bitstring;
                                                {5116}new UP_4319: bitstring;
                                                {5117}out(c, (SPs_4318,Sign,UP_4319,pkSess_4317))
                                            )
                                            else
                                                {5118}let v_4320: bool = (Sess_3563 = B) in
                                                (
                                                    {5119}if v_4320 then
                                                    (
                                                        {5120}let pkSess_4321: bitstring = pub(skB) in
                                                        {5121}in(c, =GetEndpointRequest);
                                                        {5122}new SPs_4322: bitstring;
                                                        {5123}new UP_4323: bitstring;
                                                        {5124}out(c, (SPs_4322,Sign,UP_4323,pkSess_4321))
                                                    )
                                                    else
                                                        {5125}let v_4324: bool = (Sess_3563 = C) in
                                                        (
                                                            {5126}if v_4324 then
                                                            (
                                                                {5127}let pkSess_4325: bitstring = pub(skC) in
                                                                {5128}in(c, =GetEndpointRequest);
                                                                {5129}new SPs_4326: bitstring;
                                                                {5130}new UP_4327: bitstring;
                                                                {5131}out(c, (SPs_4326,Sign,UP_4327,pkSess_4325))
                                                            )
                                                            else
                                                                {5132}let pkSess_4328: bitstring = pub(skI) in
                                                                {5133}in(c, =GetEndpointRequest);
                                                                {5134}new SPs_4329: bitstring;
                                                                {5135}new UP_4330: bitstring;
                                                                {5136}out(c, (SPs_4329,Sign,UP_4330,pkSess_4328))
                                                        )
                                                        else
                                                            {5137}let pkSess_4331: bitstring = fail-any in
                                                            {5138}in(c, =GetEndpointRequest);
                                                            {5139}new SPs_4332: bitstring;
                                                            {5140}new UP_4333: bitstring;
                                                            {5141}out(c, (SPs_4332,Sign,UP_4333,pkSess_4331))
                                                )
                                                else
                                                    {5142}let pkSess_4334: bitstring = fail-any in
                                                    {5143}in(c, =GetEndpointRequest);
                                                    {5144}new SPs_4335: bitstring;
                                                    {5145}new UP_4336: bitstring;
                                                    {5146}out(c, (SPs_4335,Sign,UP_4336,pkSess_4334))
                                        )
                                        else
                                            {5147}let pkSess_4337: bitstring = fail-any in
                                            {5148}in(c, =GetEndpointRequest);
                                            {5149}new SPs_4338: bitstring;
                                            {5150}new UP_4339: bitstring;
                                            {5151}out(c, (SPs_4338,Sign,UP_4339,pkSess_4337))
                                    )
                                    else
                                        {5152}let v_4340: bool = (Cli_3561 = C) in
                                        (
                                            {5153}if v_4340 then
                                            (
                                                {5154}let pkCli_4341: bitstring = pub(skC) in
                                                {5155}let v_4342: bool = (Sess_3563 = A) in
                                                (
                                                    {5156}if v_4342 then
                                                    (
                                                        {5157}let pkSess_4343: bitstring = pub(skA) in
                                                        {5158}in(c, =GetEndpointRequest);
                                                        {5159}new SPs_4344: bitstring;
                                                        {5160}new UP_4345: bitstring;
                                                        {5161}out(c, (SPs_4344,Sign,UP_4345,pkSess_4343))
                                                    )
                                                    else
                                                        {5162}let v_4346: bool = (Sess_3563 = B) in
                                                        (
                                                            {5163}if v_4346 then
                                                            (
                                                                {5164}let pkSess_4347: bitstring = pub(skB) in
                                                                {5165}in(c, =GetEndpointRequest);
                                                                {5166}new SPs_4348: bitstring;
                                                                {5167}new UP_4349: bitstring;
                                                                {5168}out(c, (SPs_4348,Sign,UP_4349,pkSess_4347))
                                                            )
                                                            else
                                                                {5169}let v_4350: bool = (Sess_3563 = C) in
                                                                (
                                                                    {5170}if v_4350 then
                                                                    (
                                                                        {5171}let pkSess_4351: bitstring = pub(skC) in
                                                                        {5172}in(c, =GetEndpointRequest);
                                                                        {5173}new SPs_4352: bitstring;
                                                                        {5174}new UP_4353: bitstring;
                                                                        {5175}out(c, (SPs_4352,Sign,UP_4353,pkSess_4351))
                                                                    )
                                                                    else
                                                                        {5176}let pkSess_4354: bitstring = pub(skI) in
                                                                        {5177}in(c, =GetEndpointRequest);
                                                                        {5178}new SPs_4355: bitstring;
                                                                        {5179}new UP_4356: bitstring;
                                                                        {5180}out(c, (SPs_4355,Sign,UP_4356,pkSess_4354))
                                                                )
                                                                else
                                                                    {5181}let pkSess_4357: bitstring = fail-any in
                                                                    {5182}in(c, =GetEndpointRequest);
                                                                    {5183}new SPs_4358: bitstring;
                                                                    {5184}new UP_4359: bitstring;
                                                                    {5185}out(c, (SPs_4358,Sign,UP_4359,pkSess_4357))
                                                        )
                                                        else
                                                            {5186}let pkSess_4360: bitstring = fail-any in
                                                            {5187}in(c, =GetEndpointRequest);
                                                            {5188}new SPs_4361: bitstring;
                                                            {5189}new UP_4362: bitstring;
                                                            {5190}out(c, (SPs_4361,Sign,UP_4362,pkSess_4360))
                                                )
                                                else
                                                    {5191}let pkSess_4363: bitstring = fail-any in
                                                    {5192}in(c, =GetEndpointRequest);
                                                    {5193}new SPs_4364: bitstring;
                                                    {5194}new UP_4365: bitstring;
                                                    {5195}out(c, (SPs_4364,Sign,UP_4365,pkSess_4363))
                                            )
                                            else
                                                {5196}let pkCli_4366: bitstring = pub(skI) in
                                                {5197}let v_4367: bool = (Sess_3563 = A) in
                                                (
                                                    {5198}if v_4367 then
                                                    (
                                                        {5199}let pkSess_4368: bitstring = pub(skA) in
                                                        {5200}in(c, =GetEndpointRequest);
                                                        {5201}new SPs_4369: bitstring;
                                                        {5202}new UP_4370: bitstring;
                                                        {5203}out(c, (SPs_4369,Sign,UP_4370,pkSess_4368))
                                                    )
                                                    else
                                                        {5204}let v_4371: bool = (Sess_3563 = B) in
                                                        (
                                                            {5205}if v_4371 then
                                                            (
                                                                {5206}let pkSess_4372: bitstring = pub(skB) in
                                                                {5207}in(c, =GetEndpointRequest);
                                                                {5208}new SPs_4373: bitstring;
                                                                {5209}new UP_4374: bitstring;
                                                                {5210}out(c, (SPs_4373,Sign,UP_4374,pkSess_4372))
                                                            )
                                                            else
                                                                {5211}let v_4375: bool = (Sess_3563 = C) in
                                                                (
                                                                    {5212}if v_4375 then
                                                                    (
                                                                        {5213}let pkSess_4376: bitstring = pub(skC) in
                                                                        {5214}in(c, =GetEndpointRequest);
                                                                        {5215}new SPs_4377: bitstring;
                                                                        {5216}new UP_4378: bitstring;
                                                                        {5217}out(c, (SPs_4377,Sign,UP_4378,pkSess_4376))
                                                                    )
                                                                    else
                                                                        {5218}let pkSess_4379: bitstring = pub(skI) in
                                                                        {5219}in(c, =GetEndpointRequest);
                                                                        {5220}new SPs_4380: bitstring;
                                                                        {5221}new UP_4381: bitstring;
                                                                        {5222}out(c, (SPs_4380,Sign,UP_4381,pkSess_4379))
                                                                )
                                                                else
                                                                    {5223}let pkSess_4382: bitstring = fail-any in
                                                                    {5224}in(c, =GetEndpointRequest);
                                                                    {5225}new SPs_4383: bitstring;
                                                                    {5226}new UP_4384: bitstring;
                                                                    {5227}out(c, (SPs_4383,Sign,UP_4384,pkSess_4382))
                                                        )
                                                        else
                                                            {5228}let pkSess_4385: bitstring = fail-any in
                                                            {5229}in(c, =GetEndpointRequest);
                                                            {5230}new SPs_4386: bitstring;
                                                            {5231}new UP_4387: bitstring;
                                                            {5232}out(c, (SPs_4386,Sign,UP_4387,pkSess_4385))
                                                )
                                                else
                                                    {5233}let pkSess_4388: bitstring = fail-any in
                                                    {5234}in(c, =GetEndpointRequest);
                                                    {5235}new SPs_4389: bitstring;
                                                    {5236}new UP_4390: bitstring;
                                                    {5237}out(c, (SPs_4389,Sign,UP_4390,pkSess_4388))
                                        )
                                        else
                                            {5238}let pkCli_4391: bitstring = fail-any in
                                            {5239}let v_4392: bool = (Sess_3563 = A) in
                                            (
                                                {5240}if v_4392 then
                                                (
                                                    {5241}let pkSess_4393: bitstring = pub(skA) in
                                                    {5242}in(c, =GetEndpointRequest);
                                                    {5243}new SPs_4394: bitstring;
                                                    {5244}new UP_4395: bitstring;
                                                    {5245}out(c, (SPs_4394,Sign,UP_4395,pkSess_4393))
                                                )
                                                else
                                                    {5246}let v_4396: bool = (Sess_3563 = B) in
                                                    (
                                                        {5247}if v_4396 then
                                                        (
                                                            {5248}let pkSess_4397: bitstring = pub(skB) in
                                                            {5249}in(c, =GetEndpointRequest);
                                                            {5250}new SPs_4398: bitstring;
                                                            {5251}new UP_4399: bitstring;
                                                            {5252}out(c, (SPs_4398,Sign,UP_4399,pkSess_4397))
                                                        )
                                                        else
                                                            {5253}let v_4400: bool = (Sess_3563 = C) in
                                                            (
                                                                {5254}if v_4400 then
                                                                (
                                                                    {5255}let pkSess_4401: bitstring = pub(skC) in
                                                                    {5256}in(c, =GetEndpointRequest);
                                                                    {5257}new SPs_4402: bitstring;
                                                                    {5258}new UP_4403: bitstring;
                                                                    {5259}out(c, (SPs_4402,Sign,UP_4403,pkSess_4401))
                                                                )
                                                                else
                                                                    {5260}let pkSess_4404: bitstring = pub(skI) in
                                                                    {5261}in(c, =GetEndpointRequest);
                                                                    {5262}new SPs_4405: bitstring;
                                                                    {5263}new UP_4406: bitstring;
                                                                    {5264}out(c, (SPs_4405,Sign,UP_4406,pkSess_4404))
                                                            )
                                                            else
                                                                {5265}let pkSess_4407: bitstring = fail-any in
                                                                {5266}in(c, =GetEndpointRequest);
                                                                {5267}new SPs_4408: bitstring;
                                                                {5268}new UP_4409: bitstring;
                                                                {5269}out(c, (SPs_4408,Sign,UP_4409,pkSess_4407))
                                                    )
                                                    else
                                                        {5270}let pkSess_4410: bitstring = fail-any in
                                                        {5271}in(c, =GetEndpointRequest);
                                                        {5272}new SPs_4411: bitstring;
                                                        {5273}new UP_4412: bitstring;
                                                        {5274}out(c, (SPs_4411,Sign,UP_4412,pkSess_4410))
                                            )
                                            else
                                                {5275}let pkSess_4413: bitstring = fail-any in
                                                {5276}in(c, =GetEndpointRequest);
                                                {5277}new SPs_4414: bitstring;
                                                {5278}new UP_4415: bitstring;
                                                {5279}out(c, (SPs_4414,Sign,UP_4415,pkSess_4413))
                                )
                                else
                                    {5280}let pkCli_4416: bitstring = fail-any in
                                    {5281}let v_4417: bool = (Sess_3563 = A) in
                                    (
                                        {5282}if v_4417 then
                                        (
                                            {5283}let pkSess_4418: bitstring = pub(skA) in
                                            {5284}in(c, =GetEndpointRequest);
                                            {5285}new SPs_4419: bitstring;
                                            {5286}new UP_4420: bitstring;
                                            {5287}out(c, (SPs_4419,Sign,UP_4420,pkSess_4418))
                                        )
                                        else
                                            {5288}let v_4421: bool = (Sess_3563 = B) in
                                            (
                                                {5289}if v_4421 then
                                                (
                                                    {5290}let pkSess_4422: bitstring = pub(skB) in
                                                    {5291}in(c, =GetEndpointRequest);
                                                    {5292}new SPs_4423: bitstring;
                                                    {5293}new UP_4424: bitstring;
                                                    {5294}out(c, (SPs_4423,Sign,UP_4424,pkSess_4422))
                                                )
                                                else
                                                    {5295}let v_4425: bool = (Sess_3563 = C) in
                                                    (
                                                        {5296}if v_4425 then
                                                        (
                                                            {5297}let pkSess_4426: bitstring = pub(skC) in
                                                            {5298}in(c, =GetEndpointRequest);
                                                            {5299}new SPs_4427: bitstring;
                                                            {5300}new UP_4428: bitstring;
                                                            {5301}out(c, (SPs_4427,Sign,UP_4428,pkSess_4426))
                                                        )
                                                        else
                                                            {5302}let pkSess_4429: bitstring = pub(skI) in
                                                            {5303}in(c, =GetEndpointRequest);
                                                            {5304}new SPs_4430: bitstring;
                                                            {5305}new UP_4431: bitstring;
                                                            {5306}out(c, (SPs_4430,Sign,UP_4431,pkSess_4429))
                                                    )
                                                    else
                                                        {5307}let pkSess_4432: bitstring = fail-any in
                                                        {5308}in(c, =GetEndpointRequest);
                                                        {5309}new SPs_4433: bitstring;
                                                        {5310}new UP_4434: bitstring;
                                                        {5311}out(c, (SPs_4433,Sign,UP_4434,pkSess_4432))
                                            )
                                            else
                                                {5312}let pkSess_4435: bitstring = fail-any in
                                                {5313}in(c, =GetEndpointRequest);
                                                {5314}new SPs_4436: bitstring;
                                                {5315}new UP_4437: bitstring;
                                                {5316}out(c, (SPs_4436,Sign,UP_4437,pkSess_4435))
                                    )
                                    else
                                        {5317}let pkSess_4438: bitstring = fail-any in
                                        {5318}in(c, =GetEndpointRequest);
                                        {5319}new SPs_4439: bitstring;
                                        {5320}new UP_4440: bitstring;
                                        {5321}out(c, (SPs_4439,Sign,UP_4440,pkSess_4438))
                        )
                        else
                            {5322}let pkCli_4441: bitstring = fail-any in
                            {5323}let v_4442: bool = (Sess_3563 = A) in
                            (
                                {5324}if v_4442 then
                                (
                                    {5325}let pkSess_4443: bitstring = pub(skA) in
                                    {5326}in(c, =GetEndpointRequest);
                                    {5327}new SPs_4444: bitstring;
                                    {5328}new UP_4445: bitstring;
                                    {5329}out(c, (SPs_4444,Sign,UP_4445,pkSess_4443))
                                )
                                else
                                    {5330}let v_4446: bool = (Sess_3563 = B) in
                                    (
                                        {5331}if v_4446 then
                                        (
                                            {5332}let pkSess_4447: bitstring = pub(skB) in
                                            {5333}in(c, =GetEndpointRequest);
                                            {5334}new SPs_4448: bitstring;
                                            {5335}new UP_4449: bitstring;
                                            {5336}out(c, (SPs_4448,Sign,UP_4449,pkSess_4447))
                                        )
                                        else
                                            {5337}let v_4450: bool = (Sess_3563 = C) in
                                            (
                                                {5338}if v_4450 then
                                                (
                                                    {5339}let pkSess_4451: bitstring = pub(skC) in
                                                    {5340}in(c, =GetEndpointRequest);
                                                    {5341}new SPs_4452: bitstring;
                                                    {5342}new UP_4453: bitstring;
                                                    {5343}out(c, (SPs_4452,Sign,UP_4453,pkSess_4451))
                                                )
                                                else
                                                    {5344}let pkSess_4454: bitstring = pub(skI) in
                                                    {5345}in(c, =GetEndpointRequest);
                                                    {5346}new SPs_4455: bitstring;
                                                    {5347}new UP_4456: bitstring;
                                                    {5348}out(c, (SPs_4455,Sign,UP_4456,pkSess_4454))
                                            )
                                            else
                                                {5349}let pkSess_4457: bitstring = fail-any in
                                                {5350}in(c, =GetEndpointRequest);
                                                {5351}new SPs_4458: bitstring;
                                                {5352}new UP_4459: bitstring;
                                                {5353}out(c, (SPs_4458,Sign,UP_4459,pkSess_4457))
                                    )
                                    else
                                        {5354}let pkSess_4460: bitstring = fail-any in
                                        {5355}in(c, =GetEndpointRequest);
                                        {5356}new SPs_4461: bitstring;
                                        {5357}new UP_4462: bitstring;
                                        {5358}out(c, (SPs_4461,Sign,UP_4462,pkSess_4460))
                            )
                            else
                                {5359}let pkSess_4463: bitstring = fail-any in
                                {5360}in(c, =GetEndpointRequest);
                                {5361}new SPs_4464: bitstring;
                                {5362}new UP_4465: bitstring;
                                {5363}out(c, (SPs_4464,Sign,UP_4465,pkSess_4463))
            )
            else
                {5364}let skDisco_4466: bitstring = fail-any in
                {5365}let pkDisco_4467: bitstring = pub(skDisco_4466) in
                {5366}let v_4468: bool = (Cli_3561 = A) in
                (
                    {5367}if v_4468 then
                    (
                        {5368}let pkCli_4469: bitstring = pub(skA) in
                        {5369}let v_4470: bool = (Sess_3563 = A) in
                        (
                            {5370}if v_4470 then
                            (
                                {5371}let pkSess_4471: bitstring = pub(skA) in
                                {5372}in(c, =GetEndpointRequest);
                                {5373}new SPs_4472: bitstring;
                                {5374}new UP_4473: bitstring;
                                {5375}out(c, (SPs_4472,Sign,UP_4473,pkSess_4471))
                            )
                            else
                                {5376}let v_4474: bool = (Sess_3563 = B) in
                                (
                                    {5377}if v_4474 then
                                    (
                                        {5378}let pkSess_4475: bitstring = pub(skB) in
                                        {5379}in(c, =GetEndpointRequest);
                                        {5380}new SPs_4476: bitstring;
                                        {5381}new UP_4477: bitstring;
                                        {5382}out(c, (SPs_4476,Sign,UP_4477,pkSess_4475))
                                    )
                                    else
                                        {5383}let v_4478: bool = (Sess_3563 = C) in
                                        (
                                            {5384}if v_4478 then
                                            (
                                                {5385}let pkSess_4479: bitstring = pub(skC) in
                                                {5386}in(c, =GetEndpointRequest);
                                                {5387}new SPs_4480: bitstring;
                                                {5388}new UP_4481: bitstring;
                                                {5389}out(c, (SPs_4480,Sign,UP_4481,pkSess_4479))
                                            )
                                            else
                                                {5390}let pkSess_4482: bitstring = pub(skI) in
                                                {5391}in(c, =GetEndpointRequest);
                                                {5392}new SPs_4483: bitstring;
                                                {5393}new UP_4484: bitstring;
                                                {5394}out(c, (SPs_4483,Sign,UP_4484,pkSess_4482))
                                        )
                                        else
                                            {5395}let pkSess_4485: bitstring = fail-any in
                                            {5396}in(c, =GetEndpointRequest);
                                            {5397}new SPs_4486: bitstring;
                                            {5398}new UP_4487: bitstring;
                                            {5399}out(c, (SPs_4486,Sign,UP_4487,pkSess_4485))
                                )
                                else
                                    {5400}let pkSess_4488: bitstring = fail-any in
                                    {5401}in(c, =GetEndpointRequest);
                                    {5402}new SPs_4489: bitstring;
                                    {5403}new UP_4490: bitstring;
                                    {5404}out(c, (SPs_4489,Sign,UP_4490,pkSess_4488))
                        )
                        else
                            {5405}let pkSess_4491: bitstring = fail-any in
                            {5406}in(c, =GetEndpointRequest);
                            {5407}new SPs_4492: bitstring;
                            {5408}new UP_4493: bitstring;
                            {5409}out(c, (SPs_4492,Sign,UP_4493,pkSess_4491))
                    )
                    else
                        {5410}let v_4494: bool = (Cli_3561 = B) in
                        (
                            {5411}if v_4494 then
                            (
                                {5412}let pkCli_4495: bitstring = pub(skB) in
                                {5413}let v_4496: bool = (Sess_3563 = A) in
                                (
                                    {5414}if v_4496 then
                                    (
                                        {5415}let pkSess_4497: bitstring = pub(skA) in
                                        {5416}in(c, =GetEndpointRequest);
                                        {5417}new SPs_4498: bitstring;
                                        {5418}new UP_4499: bitstring;
                                        {5419}out(c, (SPs_4498,Sign,UP_4499,pkSess_4497))
                                    )
                                    else
                                        {5420}let v_4500: bool = (Sess_3563 = B) in
                                        (
                                            {5421}if v_4500 then
                                            (
                                                {5422}let pkSess_4501: bitstring = pub(skB) in
                                                {5423}in(c, =GetEndpointRequest);
                                                {5424}new SPs_4502: bitstring;
                                                {5425}new UP_4503: bitstring;
                                                {5426}out(c, (SPs_4502,Sign,UP_4503,pkSess_4501))
                                            )
                                            else
                                                {5427}let v_4504: bool = (Sess_3563 = C) in
                                                (
                                                    {5428}if v_4504 then
                                                    (
                                                        {5429}let pkSess_4505: bitstring = pub(skC) in
                                                        {5430}in(c, =GetEndpointRequest);
                                                        {5431}new SPs_4506: bitstring;
                                                        {5432}new UP_4507: bitstring;
                                                        {5433}out(c, (SPs_4506,Sign,UP_4507,pkSess_4505))
                                                    )
                                                    else
                                                        {5434}let pkSess_4508: bitstring = pub(skI) in
                                                        {5435}in(c, =GetEndpointRequest);
                                                        {5436}new SPs_4509: bitstring;
                                                        {5437}new UP_4510: bitstring;
                                                        {5438}out(c, (SPs_4509,Sign,UP_4510,pkSess_4508))
                                                )
                                                else
                                                    {5439}let pkSess_4511: bitstring = fail-any in
                                                    {5440}in(c, =GetEndpointRequest);
                                                    {5441}new SPs_4512: bitstring;
                                                    {5442}new UP_4513: bitstring;
                                                    {5443}out(c, (SPs_4512,Sign,UP_4513,pkSess_4511))
                                        )
                                        else
                                            {5444}let pkSess_4514: bitstring = fail-any in
                                            {5445}in(c, =GetEndpointRequest);
                                            {5446}new SPs_4515: bitstring;
                                            {5447}new UP_4516: bitstring;
                                            {5448}out(c, (SPs_4515,Sign,UP_4516,pkSess_4514))
                                )
                                else
                                    {5449}let pkSess_4517: bitstring = fail-any in
                                    {5450}in(c, =GetEndpointRequest);
                                    {5451}new SPs_4518: bitstring;
                                    {5452}new UP_4519: bitstring;
                                    {5453}out(c, (SPs_4518,Sign,UP_4519,pkSess_4517))
                            )
                            else
                                {5454}let v_4520: bool = (Cli_3561 = C) in
                                (
                                    {5455}if v_4520 then
                                    (
                                        {5456}let pkCli_4521: bitstring = pub(skC) in
                                        {5457}let v_4522: bool = (Sess_3563 = A) in
                                        (
                                            {5458}if v_4522 then
                                            (
                                                {5459}let pkSess_4523: bitstring = pub(skA) in
                                                {5460}in(c, =GetEndpointRequest);
                                                {5461}new SPs_4524: bitstring;
                                                {5462}new UP_4525: bitstring;
                                                {5463}out(c, (SPs_4524,Sign,UP_4525,pkSess_4523))
                                            )
                                            else
                                                {5464}let v_4526: bool = (Sess_3563 = B) in
                                                (
                                                    {5465}if v_4526 then
                                                    (
                                                        {5466}let pkSess_4527: bitstring = pub(skB) in
                                                        {5467}in(c, =GetEndpointRequest);
                                                        {5468}new SPs_4528: bitstring;
                                                        {5469}new UP_4529: bitstring;
                                                        {5470}out(c, (SPs_4528,Sign,UP_4529,pkSess_4527))
                                                    )
                                                    else
                                                        {5471}let v_4530: bool = (Sess_3563 = C) in
                                                        (
                                                            {5472}if v_4530 then
                                                            (
                                                                {5473}let pkSess_4531: bitstring = pub(skC) in
                                                                {5474}in(c, =GetEndpointRequest);
                                                                {5475}new SPs_4532: bitstring;
                                                                {5476}new UP_4533: bitstring;
                                                                {5477}out(c, (SPs_4532,Sign,UP_4533,pkSess_4531))
                                                            )
                                                            else
                                                                {5478}let pkSess_4534: bitstring = pub(skI) in
                                                                {5479}in(c, =GetEndpointRequest);
                                                                {5480}new SPs_4535: bitstring;
                                                                {5481}new UP_4536: bitstring;
                                                                {5482}out(c, (SPs_4535,Sign,UP_4536,pkSess_4534))
                                                        )
                                                        else
                                                            {5483}let pkSess_4537: bitstring = fail-any in
                                                            {5484}in(c, =GetEndpointRequest);
                                                            {5485}new SPs_4538: bitstring;
                                                            {5486}new UP_4539: bitstring;
                                                            {5487}out(c, (SPs_4538,Sign,UP_4539,pkSess_4537))
                                                )
                                                else
                                                    {5488}let pkSess_4540: bitstring = fail-any in
                                                    {5489}in(c, =GetEndpointRequest);
                                                    {5490}new SPs_4541: bitstring;
                                                    {5491}new UP_4542: bitstring;
                                                    {5492}out(c, (SPs_4541,Sign,UP_4542,pkSess_4540))
                                        )
                                        else
                                            {5493}let pkSess_4543: bitstring = fail-any in
                                            {5494}in(c, =GetEndpointRequest);
                                            {5495}new SPs_4544: bitstring;
                                            {5496}new UP_4545: bitstring;
                                            {5497}out(c, (SPs_4544,Sign,UP_4545,pkSess_4543))
                                    )
                                    else
                                        {5498}let pkCli_4546: bitstring = pub(skI) in
                                        {5499}let v_4547: bool = (Sess_3563 = A) in
                                        (
                                            {5500}if v_4547 then
                                            (
                                                {5501}let pkSess_4548: bitstring = pub(skA) in
                                                {5502}in(c, =GetEndpointRequest);
                                                {5503}new SPs_4549: bitstring;
                                                {5504}new UP_4550: bitstring;
                                                {5505}out(c, (SPs_4549,Sign,UP_4550,pkSess_4548))
                                            )
                                            else
                                                {5506}let v_4551: bool = (Sess_3563 = B) in
                                                (
                                                    {5507}if v_4551 then
                                                    (
                                                        {5508}let pkSess_4552: bitstring = pub(skB) in
                                                        {5509}in(c, =GetEndpointRequest);
                                                        {5510}new SPs_4553: bitstring;
                                                        {5511}new UP_4554: bitstring;
                                                        {5512}out(c, (SPs_4553,Sign,UP_4554,pkSess_4552))
                                                    )
                                                    else
                                                        {5513}let v_4555: bool = (Sess_3563 = C) in
                                                        (
                                                            {5514}if v_4555 then
                                                            (
                                                                {5515}let pkSess_4556: bitstring = pub(skC) in
                                                                {5516}in(c, =GetEndpointRequest);
                                                                {5517}new SPs_4557: bitstring;
                                                                {5518}new UP_4558: bitstring;
                                                                {5519}out(c, (SPs_4557,Sign,UP_4558,pkSess_4556))
                                                            )
                                                            else
                                                                {5520}let pkSess_4559: bitstring = pub(skI) in
                                                                {5521}in(c, =GetEndpointRequest);
                                                                {5522}new SPs_4560: bitstring;
                                                                {5523}new UP_4561: bitstring;
                                                                {5524}out(c, (SPs_4560,Sign,UP_4561,pkSess_4559))
                                                        )
                                                        else
                                                            {5525}let pkSess_4562: bitstring = fail-any in
                                                            {5526}in(c, =GetEndpointRequest);
                                                            {5527}new SPs_4563: bitstring;
                                                            {5528}new UP_4564: bitstring;
                                                            {5529}out(c, (SPs_4563,Sign,UP_4564,pkSess_4562))
                                                )
                                                else
                                                    {5530}let pkSess_4565: bitstring = fail-any in
                                                    {5531}in(c, =GetEndpointRequest);
                                                    {5532}new SPs_4566: bitstring;
                                                    {5533}new UP_4567: bitstring;
                                                    {5534}out(c, (SPs_4566,Sign,UP_4567,pkSess_4565))
                                        )
                                        else
                                            {5535}let pkSess_4568: bitstring = fail-any in
                                            {5536}in(c, =GetEndpointRequest);
                                            {5537}new SPs_4569: bitstring;
                                            {5538}new UP_4570: bitstring;
                                            {5539}out(c, (SPs_4569,Sign,UP_4570,pkSess_4568))
                                )
                                else
                                    {5540}let pkCli_4571: bitstring = fail-any in
                                    {5541}let v_4572: bool = (Sess_3563 = A) in
                                    (
                                        {5542}if v_4572 then
                                        (
                                            {5543}let pkSess_4573: bitstring = pub(skA) in
                                            {5544}in(c, =GetEndpointRequest);
                                            {5545}new SPs_4574: bitstring;
                                            {5546}new UP_4575: bitstring;
                                            {5547}out(c, (SPs_4574,Sign,UP_4575,pkSess_4573))
                                        )
                                        else
                                            {5548}let v_4576: bool = (Sess_3563 = B) in
                                            (
                                                {5549}if v_4576 then
                                                (
                                                    {5550}let pkSess_4577: bitstring = pub(skB) in
                                                    {5551}in(c, =GetEndpointRequest);
                                                    {5552}new SPs_4578: bitstring;
                                                    {5553}new UP_4579: bitstring;
                                                    {5554}out(c, (SPs_4578,Sign,UP_4579,pkSess_4577))
                                                )
                                                else
                                                    {5555}let v_4580: bool = (Sess_3563 = C) in
                                                    (
                                                        {5556}if v_4580 then
                                                        (
                                                            {5557}let pkSess_4581: bitstring = pub(skC) in
                                                            {5558}in(c, =GetEndpointRequest);
                                                            {5559}new SPs_4582: bitstring;
                                                            {5560}new UP_4583: bitstring;
                                                            {5561}out(c, (SPs_4582,Sign,UP_4583,pkSess_4581))
                                                        )
                                                        else
                                                            {5562}let pkSess_4584: bitstring = pub(skI) in
                                                            {5563}in(c, =GetEndpointRequest);
                                                            {5564}new SPs_4585: bitstring;
                                                            {5565}new UP_4586: bitstring;
                                                            {5566}out(c, (SPs_4585,Sign,UP_4586,pkSess_4584))
                                                    )
                                                    else
                                                        {5567}let pkSess_4587: bitstring = fail-any in
                                                        {5568}in(c, =GetEndpointRequest);
                                                        {5569}new SPs_4588: bitstring;
                                                        {5570}new UP_4589: bitstring;
                                                        {5571}out(c, (SPs_4588,Sign,UP_4589,pkSess_4587))
                                            )
                                            else
                                                {5572}let pkSess_4590: bitstring = fail-any in
                                                {5573}in(c, =GetEndpointRequest);
                                                {5574}new SPs_4591: bitstring;
                                                {5575}new UP_4592: bitstring;
                                                {5576}out(c, (SPs_4591,Sign,UP_4592,pkSess_4590))
                                    )
                                    else
                                        {5577}let pkSess_4593: bitstring = fail-any in
                                        {5578}in(c, =GetEndpointRequest);
                                        {5579}new SPs_4594: bitstring;
                                        {5580}new UP_4595: bitstring;
                                        {5581}out(c, (SPs_4594,Sign,UP_4595,pkSess_4593))
                        )
                        else
                            {5582}let pkCli_4596: bitstring = fail-any in
                            {5583}let v_4597: bool = (Sess_3563 = A) in
                            (
                                {5584}if v_4597 then
                                (
                                    {5585}let pkSess_4598: bitstring = pub(skA) in
                                    {5586}in(c, =GetEndpointRequest);
                                    {5587}new SPs_4599: bitstring;
                                    {5588}new UP_4600: bitstring;
                                    {5589}out(c, (SPs_4599,Sign,UP_4600,pkSess_4598))
                                )
                                else
                                    {5590}let v_4601: bool = (Sess_3563 = B) in
                                    (
                                        {5591}if v_4601 then
                                        (
                                            {5592}let pkSess_4602: bitstring = pub(skB) in
                                            {5593}in(c, =GetEndpointRequest);
                                            {5594}new SPs_4603: bitstring;
                                            {5595}new UP_4604: bitstring;
                                            {5596}out(c, (SPs_4603,Sign,UP_4604,pkSess_4602))
                                        )
                                        else
                                            {5597}let v_4605: bool = (Sess_3563 = C) in
                                            (
                                                {5598}if v_4605 then
                                                (
                                                    {5599}let pkSess_4606: bitstring = pub(skC) in
                                                    {5600}in(c, =GetEndpointRequest);
                                                    {5601}new SPs_4607: bitstring;
                                                    {5602}new UP_4608: bitstring;
                                                    {5603}out(c, (SPs_4607,Sign,UP_4608,pkSess_4606))
                                                )
                                                else
                                                    {5604}let pkSess_4609: bitstring = pub(skI) in
                                                    {5605}in(c, =GetEndpointRequest);
                                                    {5606}new SPs_4610: bitstring;
                                                    {5607}new UP_4611: bitstring;
                                                    {5608}out(c, (SPs_4610,Sign,UP_4611,pkSess_4609))
                                            )
                                            else
                                                {5609}let pkSess_4612: bitstring = fail-any in
                                                {5610}in(c, =GetEndpointRequest);
                                                {5611}new SPs_4613: bitstring;
                                                {5612}new UP_4614: bitstring;
                                                {5613}out(c, (SPs_4613,Sign,UP_4614,pkSess_4612))
                                    )
                                    else
                                        {5614}let pkSess_4615: bitstring = fail-any in
                                        {5615}in(c, =GetEndpointRequest);
                                        {5616}new SPs_4616: bitstring;
                                        {5617}new UP_4617: bitstring;
                                        {5618}out(c, (SPs_4616,Sign,UP_4617,pkSess_4615))
                            )
                            else
                                {5619}let pkSess_4618: bitstring = fail-any in
                                {5620}in(c, =GetEndpointRequest);
                                {5621}new SPs_4619: bitstring;
                                {5622}new UP_4620: bitstring;
                                {5623}out(c, (SPs_4619,Sign,UP_4620,pkSess_4618))
                )
                else
                    {5624}let pkCli_4621: bitstring = fail-any in
                    {5625}let v_4622: bool = (Sess_3563 = A) in
                    (
                        {5626}if v_4622 then
                        (
                            {5627}let pkSess_4623: bitstring = pub(skA) in
                            {5628}in(c, =GetEndpointRequest);
                            {5629}new SPs_4624: bitstring;
                            {5630}new UP_4625: bitstring;
                            {5631}out(c, (SPs_4624,Sign,UP_4625,pkSess_4623))
                        )
                        else
                            {5632}let v_4626: bool = (Sess_3563 = B) in
                            (
                                {5633}if v_4626 then
                                (
                                    {5634}let pkSess_4627: bitstring = pub(skB) in
                                    {5635}in(c, =GetEndpointRequest);
                                    {5636}new SPs_4628: bitstring;
                                    {5637}new UP_4629: bitstring;
                                    {5638}out(c, (SPs_4628,Sign,UP_4629,pkSess_4627))
                                )
                                else
                                    {5639}let v_4630: bool = (Sess_3563 = C) in
                                    (
                                        {5640}if v_4630 then
                                        (
                                            {5641}let pkSess_4631: bitstring = pub(skC) in
                                            {5642}in(c, =GetEndpointRequest);
                                            {5643}new SPs_4632: bitstring;
                                            {5644}new UP_4633: bitstring;
                                            {5645}out(c, (SPs_4632,Sign,UP_4633,pkSess_4631))
                                        )
                                        else
                                            {5646}let pkSess_4634: bitstring = pub(skI) in
                                            {5647}in(c, =GetEndpointRequest);
                                            {5648}new SPs_4635: bitstring;
                                            {5649}new UP_4636: bitstring;
                                            {5650}out(c, (SPs_4635,Sign,UP_4636,pkSess_4634))
                                    )
                                    else
                                        {5651}let pkSess_4637: bitstring = fail-any in
                                        {5652}in(c, =GetEndpointRequest);
                                        {5653}new SPs_4638: bitstring;
                                        {5654}new UP_4639: bitstring;
                                        {5655}out(c, (SPs_4638,Sign,UP_4639,pkSess_4637))
                            )
                            else
                                {5656}let pkSess_4640: bitstring = fail-any in
                                {5657}in(c, =GetEndpointRequest);
                                {5658}new SPs_4641: bitstring;
                                {5659}new UP_4642: bitstring;
                                {5660}out(c, (SPs_4641,Sign,UP_4642,pkSess_4640))
                    )
                    else
                        {5661}let pkSess_4643: bitstring = fail-any in
                        {5662}in(c, =GetEndpointRequest);
                        {5663}new SPs_4644: bitstring;
                        {5664}new UP_4645: bitstring;
                        {5665}out(c, (SPs_4644,Sign,UP_4645,pkSess_4643))
    )
    else
        {5666}let skDisco_4646: bitstring = fail-any in
        {5667}let pkDisco_4647: bitstring = pub(skDisco_4646) in
        {5668}let v_4648: bool = (Cli_3561 = A) in
        (
            {5669}if v_4648 then
            (
                {5670}let pkCli_4649: bitstring = pub(skA) in
                {5671}let v_4650: bool = (Sess_3563 = A) in
                (
                    {5672}if v_4650 then
                    (
                        {5673}let pkSess_4651: bitstring = pub(skA) in
                        {5674}in(c, =GetEndpointRequest);
                        {5675}new SPs_4652: bitstring;
                        {5676}new UP_4653: bitstring;
                        {5677}out(c, (SPs_4652,Sign,UP_4653,pkSess_4651))
                    )
                    else
                        {5678}let v_4654: bool = (Sess_3563 = B) in
                        (
                            {5679}if v_4654 then
                            (
                                {5680}let pkSess_4655: bitstring = pub(skB) in
                                {5681}in(c, =GetEndpointRequest);
                                {5682}new SPs_4656: bitstring;
                                {5683}new UP_4657: bitstring;
                                {5684}out(c, (SPs_4656,Sign,UP_4657,pkSess_4655))
                            )
                            else
                                {5685}let v_4658: bool = (Sess_3563 = C) in
                                (
                                    {5686}if v_4658 then
                                    (
                                        {5687}let pkSess_4659: bitstring = pub(skC) in
                                        {5688}in(c, =GetEndpointRequest);
                                        {5689}new SPs_4660: bitstring;
                                        {5690}new UP_4661: bitstring;
                                        {5691}out(c, (SPs_4660,Sign,UP_4661,pkSess_4659))
                                    )
                                    else
                                        {5692}let pkSess_4662: bitstring = pub(skI) in
                                        {5693}in(c, =GetEndpointRequest);
                                        {5694}new SPs_4663: bitstring;
                                        {5695}new UP_4664: bitstring;
                                        {5696}out(c, (SPs_4663,Sign,UP_4664,pkSess_4662))
                                )
                                else
                                    {5697}let pkSess_4665: bitstring = fail-any in
                                    {5698}in(c, =GetEndpointRequest);
                                    {5699}new SPs_4666: bitstring;
                                    {5700}new UP_4667: bitstring;
                                    {5701}out(c, (SPs_4666,Sign,UP_4667,pkSess_4665))
                        )
                        else
                            {5702}let pkSess_4668: bitstring = fail-any in
                            {5703}in(c, =GetEndpointRequest);
                            {5704}new SPs_4669: bitstring;
                            {5705}new UP_4670: bitstring;
                            {5706}out(c, (SPs_4669,Sign,UP_4670,pkSess_4668))
                )
                else
                    {5707}let pkSess_4671: bitstring = fail-any in
                    {5708}in(c, =GetEndpointRequest);
                    {5709}new SPs_4672: bitstring;
                    {5710}new UP_4673: bitstring;
                    {5711}out(c, (SPs_4672,Sign,UP_4673,pkSess_4671))
            )
            else
                {5712}let v_4674: bool = (Cli_3561 = B) in
                (
                    {5713}if v_4674 then
                    (
                        {5714}let pkCli_4675: bitstring = pub(skB) in
                        {5715}let v_4676: bool = (Sess_3563 = A) in
                        (
                            {5716}if v_4676 then
                            (
                                {5717}let pkSess_4677: bitstring = pub(skA) in
                                {5718}in(c, =GetEndpointRequest);
                                {5719}new SPs_4678: bitstring;
                                {5720}new UP_4679: bitstring;
                                {5721}out(c, (SPs_4678,Sign,UP_4679,pkSess_4677))
                            )
                            else
                                {5722}let v_4680: bool = (Sess_3563 = B) in
                                (
                                    {5723}if v_4680 then
                                    (
                                        {5724}let pkSess_4681: bitstring = pub(skB) in
                                        {5725}in(c, =GetEndpointRequest);
                                        {5726}new SPs_4682: bitstring;
                                        {5727}new UP_4683: bitstring;
                                        {5728}out(c, (SPs_4682,Sign,UP_4683,pkSess_4681))
                                    )
                                    else
                                        {5729}let v_4684: bool = (Sess_3563 = C) in
                                        (
                                            {5730}if v_4684 then
                                            (
                                                {5731}let pkSess_4685: bitstring = pub(skC) in
                                                {5732}in(c, =GetEndpointRequest);
                                                {5733}new SPs_4686: bitstring;
                                                {5734}new UP_4687: bitstring;
                                                {5735}out(c, (SPs_4686,Sign,UP_4687,pkSess_4685))
                                            )
                                            else
                                                {5736}let pkSess_4688: bitstring = pub(skI) in
                                                {5737}in(c, =GetEndpointRequest);
                                                {5738}new SPs_4689: bitstring;
                                                {5739}new UP_4690: bitstring;
                                                {5740}out(c, (SPs_4689,Sign,UP_4690,pkSess_4688))
                                        )
                                        else
                                            {5741}let pkSess_4691: bitstring = fail-any in
                                            {5742}in(c, =GetEndpointRequest);
                                            {5743}new SPs_4692: bitstring;
                                            {5744}new UP_4693: bitstring;
                                            {5745}out(c, (SPs_4692,Sign,UP_4693,pkSess_4691))
                                )
                                else
                                    {5746}let pkSess_4694: bitstring = fail-any in
                                    {5747}in(c, =GetEndpointRequest);
                                    {5748}new SPs_4695: bitstring;
                                    {5749}new UP_4696: bitstring;
                                    {5750}out(c, (SPs_4695,Sign,UP_4696,pkSess_4694))
                        )
                        else
                            {5751}let pkSess_4697: bitstring = fail-any in
                            {5752}in(c, =GetEndpointRequest);
                            {5753}new SPs_4698: bitstring;
                            {5754}new UP_4699: bitstring;
                            {5755}out(c, (SPs_4698,Sign,UP_4699,pkSess_4697))
                    )
                    else
                        {5756}let v_4700: bool = (Cli_3561 = C) in
                        (
                            {5757}if v_4700 then
                            (
                                {5758}let pkCli_4701: bitstring = pub(skC) in
                                {5759}let v_4702: bool = (Sess_3563 = A) in
                                (
                                    {5760}if v_4702 then
                                    (
                                        {5761}let pkSess_4703: bitstring = pub(skA) in
                                        {5762}in(c, =GetEndpointRequest);
                                        {5763}new SPs_4704: bitstring;
                                        {5764}new UP_4705: bitstring;
                                        {5765}out(c, (SPs_4704,Sign,UP_4705,pkSess_4703))
                                    )
                                    else
                                        {5766}let v_4706: bool = (Sess_3563 = B) in
                                        (
                                            {5767}if v_4706 then
                                            (
                                                {5768}let pkSess_4707: bitstring = pub(skB) in
                                                {5769}in(c, =GetEndpointRequest);
                                                {5770}new SPs_4708: bitstring;
                                                {5771}new UP_4709: bitstring;
                                                {5772}out(c, (SPs_4708,Sign,UP_4709,pkSess_4707))
                                            )
                                            else
                                                {5773}let v_4710: bool = (Sess_3563 = C) in
                                                (
                                                    {5774}if v_4710 then
                                                    (
                                                        {5775}let pkSess_4711: bitstring = pub(skC) in
                                                        {5776}in(c, =GetEndpointRequest);
                                                        {5777}new SPs_4712: bitstring;
                                                        {5778}new UP_4713: bitstring;
                                                        {5779}out(c, (SPs_4712,Sign,UP_4713,pkSess_4711))
                                                    )
                                                    else
                                                        {5780}let pkSess_4714: bitstring = pub(skI) in
                                                        {5781}in(c, =GetEndpointRequest);
                                                        {5782}new SPs_4715: bitstring;
                                                        {5783}new UP_4716: bitstring;
                                                        {5784}out(c, (SPs_4715,Sign,UP_4716,pkSess_4714))
                                                )
                                                else
                                                    {5785}let pkSess_4717: bitstring = fail-any in
                                                    {5786}in(c, =GetEndpointRequest);
                                                    {5787}new SPs_4718: bitstring;
                                                    {5788}new UP_4719: bitstring;
                                                    {5789}out(c, (SPs_4718,Sign,UP_4719,pkSess_4717))
                                        )
                                        else
                                            {5790}let pkSess_4720: bitstring = fail-any in
                                            {5791}in(c, =GetEndpointRequest);
                                            {5792}new SPs_4721: bitstring;
                                            {5793}new UP_4722: bitstring;
                                            {5794}out(c, (SPs_4721,Sign,UP_4722,pkSess_4720))
                                )
                                else
                                    {5795}let pkSess_4723: bitstring = fail-any in
                                    {5796}in(c, =GetEndpointRequest);
                                    {5797}new SPs_4724: bitstring;
                                    {5798}new UP_4725: bitstring;
                                    {5799}out(c, (SPs_4724,Sign,UP_4725,pkSess_4723))
                            )
                            else
                                {5800}let pkCli_4726: bitstring = pub(skI) in
                                {5801}let v_4727: bool = (Sess_3563 = A) in
                                (
                                    {5802}if v_4727 then
                                    (
                                        {5803}let pkSess_4728: bitstring = pub(skA) in
                                        {5804}in(c, =GetEndpointRequest);
                                        {5805}new SPs_4729: bitstring;
                                        {5806}new UP_4730: bitstring;
                                        {5807}out(c, (SPs_4729,Sign,UP_4730,pkSess_4728))
                                    )
                                    else
                                        {5808}let v_4731: bool = (Sess_3563 = B) in
                                        (
                                            {5809}if v_4731 then
                                            (
                                                {5810}let pkSess_4732: bitstring = pub(skB) in
                                                {5811}in(c, =GetEndpointRequest);
                                                {5812}new SPs_4733: bitstring;
                                                {5813}new UP_4734: bitstring;
                                                {5814}out(c, (SPs_4733,Sign,UP_4734,pkSess_4732))
                                            )
                                            else
                                                {5815}let v_4735: bool = (Sess_3563 = C) in
                                                (
                                                    {5816}if v_4735 then
                                                    (
                                                        {5817}let pkSess_4736: bitstring = pub(skC) in
                                                        {5818}in(c, =GetEndpointRequest);
                                                        {5819}new SPs_4737: bitstring;
                                                        {5820}new UP_4738: bitstring;
                                                        {5821}out(c, (SPs_4737,Sign,UP_4738,pkSess_4736))
                                                    )
                                                    else
                                                        {5822}let pkSess_4739: bitstring = pub(skI) in
                                                        {5823}in(c, =GetEndpointRequest);
                                                        {5824}new SPs_4740: bitstring;
                                                        {5825}new UP_4741: bitstring;
                                                        {5826}out(c, (SPs_4740,Sign,UP_4741,pkSess_4739))
                                                )
                                                else
                                                    {5827}let pkSess_4742: bitstring = fail-any in
                                                    {5828}in(c, =GetEndpointRequest);
                                                    {5829}new SPs_4743: bitstring;
                                                    {5830}new UP_4744: bitstring;
                                                    {5831}out(c, (SPs_4743,Sign,UP_4744,pkSess_4742))
                                        )
                                        else
                                            {5832}let pkSess_4745: bitstring = fail-any in
                                            {5833}in(c, =GetEndpointRequest);
                                            {5834}new SPs_4746: bitstring;
                                            {5835}new UP_4747: bitstring;
                                            {5836}out(c, (SPs_4746,Sign,UP_4747,pkSess_4745))
                                )
                                else
                                    {5837}let pkSess_4748: bitstring = fail-any in
                                    {5838}in(c, =GetEndpointRequest);
                                    {5839}new SPs_4749: bitstring;
                                    {5840}new UP_4750: bitstring;
                                    {5841}out(c, (SPs_4749,Sign,UP_4750,pkSess_4748))
                        )
                        else
                            {5842}let pkCli_4751: bitstring = fail-any in
                            {5843}let v_4752: bool = (Sess_3563 = A) in
                            (
                                {5844}if v_4752 then
                                (
                                    {5845}let pkSess_4753: bitstring = pub(skA) in
                                    {5846}in(c, =GetEndpointRequest);
                                    {5847}new SPs_4754: bitstring;
                                    {5848}new UP_4755: bitstring;
                                    {5849}out(c, (SPs_4754,Sign,UP_4755,pkSess_4753))
                                )
                                else
                                    {5850}let v_4756: bool = (Sess_3563 = B) in
                                    (
                                        {5851}if v_4756 then
                                        (
                                            {5852}let pkSess_4757: bitstring = pub(skB) in
                                            {5853}in(c, =GetEndpointRequest);
                                            {5854}new SPs_4758: bitstring;
                                            {5855}new UP_4759: bitstring;
                                            {5856}out(c, (SPs_4758,Sign,UP_4759,pkSess_4757))
                                        )
                                        else
                                            {5857}let v_4760: bool = (Sess_3563 = C) in
                                            (
                                                {5858}if v_4760 then
                                                (
                                                    {5859}let pkSess_4761: bitstring = pub(skC) in
                                                    {5860}in(c, =GetEndpointRequest);
                                                    {5861}new SPs_4762: bitstring;
                                                    {5862}new UP_4763: bitstring;
                                                    {5863}out(c, (SPs_4762,Sign,UP_4763,pkSess_4761))
                                                )
                                                else
                                                    {5864}let pkSess_4764: bitstring = pub(skI) in
                                                    {5865}in(c, =GetEndpointRequest);
                                                    {5866}new SPs_4765: bitstring;
                                                    {5867}new UP_4766: bitstring;
                                                    {5868}out(c, (SPs_4765,Sign,UP_4766,pkSess_4764))
                                            )
                                            else
                                                {5869}let pkSess_4767: bitstring = fail-any in
                                                {5870}in(c, =GetEndpointRequest);
                                                {5871}new SPs_4768: bitstring;
                                                {5872}new UP_4769: bitstring;
                                                {5873}out(c, (SPs_4768,Sign,UP_4769,pkSess_4767))
                                    )
                                    else
                                        {5874}let pkSess_4770: bitstring = fail-any in
                                        {5875}in(c, =GetEndpointRequest);
                                        {5876}new SPs_4771: bitstring;
                                        {5877}new UP_4772: bitstring;
                                        {5878}out(c, (SPs_4771,Sign,UP_4772,pkSess_4770))
                            )
                            else
                                {5879}let pkSess_4773: bitstring = fail-any in
                                {5880}in(c, =GetEndpointRequest);
                                {5881}new SPs_4774: bitstring;
                                {5882}new UP_4775: bitstring;
                                {5883}out(c, (SPs_4774,Sign,UP_4775,pkSess_4773))
                )
                else
                    {5884}let pkCli_4776: bitstring = fail-any in
                    {5885}let v_4777: bool = (Sess_3563 = A) in
                    (
                        {5886}if v_4777 then
                        (
                            {5887}let pkSess_4778: bitstring = pub(skA) in
                            {5888}in(c, =GetEndpointRequest);
                            {5889}new SPs_4779: bitstring;
                            {5890}new UP_4780: bitstring;
                            {5891}out(c, (SPs_4779,Sign,UP_4780,pkSess_4778))
                        )
                        else
                            {5892}let v_4781: bool = (Sess_3563 = B) in
                            (
                                {5893}if v_4781 then
                                (
                                    {5894}let pkSess_4782: bitstring = pub(skB) in
                                    {5895}in(c, =GetEndpointRequest);
                                    {5896}new SPs_4783: bitstring;
                                    {5897}new UP_4784: bitstring;
                                    {5898}out(c, (SPs_4783,Sign,UP_4784,pkSess_4782))
                                )
                                else
                                    {5899}let v_4785: bool = (Sess_3563 = C) in
                                    (
                                        {5900}if v_4785 then
                                        (
                                            {5901}let pkSess_4786: bitstring = pub(skC) in
                                            {5902}in(c, =GetEndpointRequest);
                                            {5903}new SPs_4787: bitstring;
                                            {5904}new UP_4788: bitstring;
                                            {5905}out(c, (SPs_4787,Sign,UP_4788,pkSess_4786))
                                        )
                                        else
                                            {5906}let pkSess_4789: bitstring = pub(skI) in
                                            {5907}in(c, =GetEndpointRequest);
                                            {5908}new SPs_4790: bitstring;
                                            {5909}new UP_4791: bitstring;
                                            {5910}out(c, (SPs_4790,Sign,UP_4791,pkSess_4789))
                                    )
                                    else
                                        {5911}let pkSess_4792: bitstring = fail-any in
                                        {5912}in(c, =GetEndpointRequest);
                                        {5913}new SPs_4793: bitstring;
                                        {5914}new UP_4794: bitstring;
                                        {5915}out(c, (SPs_4793,Sign,UP_4794,pkSess_4792))
                            )
                            else
                                {5916}let pkSess_4795: bitstring = fail-any in
                                {5917}in(c, =GetEndpointRequest);
                                {5918}new SPs_4796: bitstring;
                                {5919}new UP_4797: bitstring;
                                {5920}out(c, (SPs_4796,Sign,UP_4797,pkSess_4795))
                    )
                    else
                        {5921}let pkSess_4798: bitstring = fail-any in
                        {5922}in(c, =GetEndpointRequest);
                        {5923}new SPs_4799: bitstring;
                        {5924}new UP_4800: bitstring;
                        {5925}out(c, (SPs_4799,Sign,UP_4800,pkSess_4798))
        )
        else
            {5926}let pkCli_4801: bitstring = fail-any in
            {5927}let v_4802: bool = (Sess_3563 = A) in
            (
                {5928}if v_4802 then
                (
                    {5929}let pkSess_4803: bitstring = pub(skA) in
                    {5930}in(c, =GetEndpointRequest);
                    {5931}new SPs_4804: bitstring;
                    {5932}new UP_4805: bitstring;
                    {5933}out(c, (SPs_4804,Sign,UP_4805,pkSess_4803))
                )
                else
                    {5934}let v_4806: bool = (Sess_3563 = B) in
                    (
                        {5935}if v_4806 then
                        (
                            {5936}let pkSess_4807: bitstring = pub(skB) in
                            {5937}in(c, =GetEndpointRequest);
                            {5938}new SPs_4808: bitstring;
                            {5939}new UP_4809: bitstring;
                            {5940}out(c, (SPs_4808,Sign,UP_4809,pkSess_4807))
                        )
                        else
                            {5941}let v_4810: bool = (Sess_3563 = C) in
                            (
                                {5942}if v_4810 then
                                (
                                    {5943}let pkSess_4811: bitstring = pub(skC) in
                                    {5944}in(c, =GetEndpointRequest);
                                    {5945}new SPs_4812: bitstring;
                                    {5946}new UP_4813: bitstring;
                                    {5947}out(c, (SPs_4812,Sign,UP_4813,pkSess_4811))
                                )
                                else
                                    {5948}let pkSess_4814: bitstring = pub(skI) in
                                    {5949}in(c, =GetEndpointRequest);
                                    {5950}new SPs_4815: bitstring;
                                    {5951}new UP_4816: bitstring;
                                    {5952}out(c, (SPs_4815,Sign,UP_4816,pkSess_4814))
                            )
                            else
                                {5953}let pkSess_4817: bitstring = fail-any in
                                {5954}in(c, =GetEndpointRequest);
                                {5955}new SPs_4818: bitstring;
                                {5956}new UP_4819: bitstring;
                                {5957}out(c, (SPs_4818,Sign,UP_4819,pkSess_4817))
                    )
                    else
                        {5958}let pkSess_4820: bitstring = fail-any in
                        {5959}in(c, =GetEndpointRequest);
                        {5960}new SPs_4821: bitstring;
                        {5961}new UP_4822: bitstring;
                        {5962}out(c, (SPs_4821,Sign,UP_4822,pkSess_4820))
            )
            else
                {5963}let pkSess_4823: bitstring = fail-any in
                {5964}in(c, =GetEndpointRequest);
                {5965}new SPs_4824: bitstring;
                {5966}new UP_4825: bitstring;
                {5967}out(c, (SPs_4824,Sign,UP_4825,pkSess_4823))
) | (
    {5968}!
    {5969}in(c, (Cli_4826: host,Disco_4827: host,Sess_4828: host));
    {5970}let v_4829: bool = (Sess_4828 = A) in
    (
        {5971}if v_4829 then
        (
            {5972}let skSess: bitstring = skA in
            {5973}let pkSess_4830: bitstring = pub(skSess) in
            {5974}let v_4831: bool = (Cli_4826 = A) in
            (
                {5975}if v_4831 then
                (
                    {5976}let pkCli_4832: bitstring = pub(skA) in
                    {5977}let v_4833: bool = (Disco_4827 = A) in
                    (
                        {5978}if v_4833 then
                        (
                            {5979}let pkDisco_4834: bitstring = pub(skA) in
                            {5980}in(c, (=pkCli_4832,m1_4835: bitstring,sigM1: bitstring));
                            {5981}if (verify(h(m1_4835),sigM1,pkCli_4832) <> true) then
                                0
                            else
                                {5982}let (SPc_4836: bitstring,PartC: bitstring) = m1_4835 in
                                {5983}new Ns: bitstring;
                                {5984}let m2: bitstring = exp(g,Ns) in
                                {5985}out(c, (m2,sign(h(m2),skSess)));
                                {5986}let Ksrv: bitstring = exp(PartC,Ns) in
                                {5987}out(c, senc(mSrv(pkCli_4832,pkSess_4830),Ksrv))
                        )
                        else
                            {5988}let v_4837: bool = (Disco_4827 = B) in
                            (
                                {5989}if v_4837 then
                                (
                                    {5990}let pkDisco_4838: bitstring = pub(skB) in
                                    {5991}in(c, (=pkCli_4832,m1_4839: bitstring,sigM1_4840: bitstring));
                                    {5992}if (verify(h(m1_4839),sigM1_4840,pkCli_4832) <> true) then
                                        0
                                    else
                                        {5993}let (SPc_4841: bitstring,PartC_4842: bitstring) = m1_4839 in
                                        {5994}new Ns_4843: bitstring;
                                        {5995}let m2_4844: bitstring = exp(g,Ns_4843) in
                                        {5996}out(c, (m2_4844,sign(h(m2_4844),skSess)));
                                        {5997}let Ksrv_4845: bitstring = exp(PartC_4842,Ns_4843) in
                                        {5998}out(c, senc(mSrv(pkCli_4832,pkSess_4830),Ksrv_4845))
                                )
                                else
                                    {5999}let v_4846: bool = (Disco_4827 = C) in
                                    (
                                        {6000}if v_4846 then
                                        (
                                            {6001}let pkDisco_4847: bitstring = pub(skC) in
                                            {6002}in(c, (=pkCli_4832,m1_4848: bitstring,sigM1_4849: bitstring));
                                            {6003}if (verify(h(m1_4848),sigM1_4849,pkCli_4832) <> true) then
                                                0
                                            else
                                                {6004}let (SPc_4850: bitstring,PartC_4851: bitstring) = m1_4848 in
                                                {6005}new Ns_4852: bitstring;
                                                {6006}let m2_4853: bitstring = exp(g,Ns_4852) in
                                                {6007}out(c, (m2_4853,sign(h(m2_4853),skSess)));
                                                {6008}let Ksrv_4854: bitstring = exp(PartC_4851,Ns_4852) in
                                                {6009}out(c, senc(mSrv(pkCli_4832,pkSess_4830),Ksrv_4854))
                                        )
                                        else
                                            {6010}let pkDisco_4855: bitstring = pub(skI) in
                                            {6011}in(c, (=pkCli_4832,m1_4856: bitstring,sigM1_4857: bitstring));
                                            {6012}if (verify(h(m1_4856),sigM1_4857,pkCli_4832) <> true) then
                                                0
                                            else
                                                {6013}let (SPc_4858: bitstring,PartC_4859: bitstring) = m1_4856 in
                                                {6014}new Ns_4860: bitstring;
                                                {6015}let m2_4861: bitstring = exp(g,Ns_4860) in
                                                {6016}out(c, (m2_4861,sign(h(m2_4861),skSess)));
                                                {6017}let Ksrv_4862: bitstring = exp(PartC_4859,Ns_4860) in
                                                {6018}out(c, senc(mSrv(pkCli_4832,pkSess_4830),Ksrv_4862))
                                    )
                                    else
                                        {6019}let pkDisco_4863: bitstring = fail-any in
                                        {6020}in(c, (=pkCli_4832,m1_4864: bitstring,sigM1_4865: bitstring));
                                        {6021}if (verify(h(m1_4864),sigM1_4865,pkCli_4832) <> true) then
                                            0
                                        else
                                            {6022}let (SPc_4866: bitstring,PartC_4867: bitstring) = m1_4864 in
                                            {6023}new Ns_4868: bitstring;
                                            {6024}let m2_4869: bitstring = exp(g,Ns_4868) in
                                            {6025}out(c, (m2_4869,sign(h(m2_4869),skSess)));
                                            {6026}let Ksrv_4870: bitstring = exp(PartC_4867,Ns_4868) in
                                            {6027}out(c, senc(mSrv(pkCli_4832,pkSess_4830),Ksrv_4870))
                            )
                            else
                                {6028}let pkDisco_4871: bitstring = fail-any in
                                {6029}in(c, (=pkCli_4832,m1_4872: bitstring,sigM1_4873: bitstring));
                                {6030}if (verify(h(m1_4872),sigM1_4873,pkCli_4832) <> true) then
                                    0
                                else
                                    {6031}let (SPc_4874: bitstring,PartC_4875: bitstring) = m1_4872 in
                                    {6032}new Ns_4876: bitstring;
                                    {6033}let m2_4877: bitstring = exp(g,Ns_4876) in
                                    {6034}out(c, (m2_4877,sign(h(m2_4877),skSess)));
                                    {6035}let Ksrv_4878: bitstring = exp(PartC_4875,Ns_4876) in
                                    {6036}out(c, senc(mSrv(pkCli_4832,pkSess_4830),Ksrv_4878))
                    )
                    else
                        {6037}let pkDisco_4879: bitstring = fail-any in
                        {6038}in(c, (=pkCli_4832,m1_4880: bitstring,sigM1_4881: bitstring));
                        {6039}if (verify(h(m1_4880),sigM1_4881,pkCli_4832) <> true) then
                            0
                        else
                            {6040}let (SPc_4882: bitstring,PartC_4883: bitstring) = m1_4880 in
                            {6041}new Ns_4884: bitstring;
                            {6042}let m2_4885: bitstring = exp(g,Ns_4884) in
                            {6043}out(c, (m2_4885,sign(h(m2_4885),skSess)));
                            {6044}let Ksrv_4886: bitstring = exp(PartC_4883,Ns_4884) in
                            {6045}out(c, senc(mSrv(pkCli_4832,pkSess_4830),Ksrv_4886))
                )
                else
                    {6046}let v_4887: bool = (Cli_4826 = B) in
                    (
                        {6047}if v_4887 then
                        (
                            {6048}let pkCli_4888: bitstring = pub(skB) in
                            {6049}let v_4889: bool = (Disco_4827 = A) in
                            (
                                {6050}if v_4889 then
                                (
                                    {6051}let pkDisco_4890: bitstring = pub(skA) in
                                    {6052}in(c, (=pkCli_4888,m1_4891: bitstring,sigM1_4892: bitstring));
                                    {6053}if (verify(h(m1_4891),sigM1_4892,pkCli_4888) <> true) then
                                        0
                                    else
                                        {6054}let (SPc_4893: bitstring,PartC_4894: bitstring) = m1_4891 in
                                        {6055}new Ns_4895: bitstring;
                                        {6056}let m2_4896: bitstring = exp(g,Ns_4895) in
                                        {6057}out(c, (m2_4896,sign(h(m2_4896),skSess)));
                                        {6058}let Ksrv_4897: bitstring = exp(PartC_4894,Ns_4895) in
                                        {6059}out(c, senc(mSrv(pkCli_4888,pkSess_4830),Ksrv_4897))
                                )
                                else
                                    {6060}let v_4898: bool = (Disco_4827 = B) in
                                    (
                                        {6061}if v_4898 then
                                        (
                                            {6062}let pkDisco_4899: bitstring = pub(skB) in
                                            {6063}in(c, (=pkCli_4888,m1_4900: bitstring,sigM1_4901: bitstring));
                                            {6064}if (verify(h(m1_4900),sigM1_4901,pkCli_4888) <> true) then
                                                0
                                            else
                                                {6065}let (SPc_4902: bitstring,PartC_4903: bitstring) = m1_4900 in
                                                {6066}new Ns_4904: bitstring;
                                                {6067}let m2_4905: bitstring = exp(g,Ns_4904) in
                                                {6068}out(c, (m2_4905,sign(h(m2_4905),skSess)));
                                                {6069}let Ksrv_4906: bitstring = exp(PartC_4903,Ns_4904) in
                                                {6070}out(c, senc(mSrv(pkCli_4888,pkSess_4830),Ksrv_4906))
                                        )
                                        else
                                            {6071}let v_4907: bool = (Disco_4827 = C) in
                                            (
                                                {6072}if v_4907 then
                                                (
                                                    {6073}let pkDisco_4908: bitstring = pub(skC) in
                                                    {6074}in(c, (=pkCli_4888,m1_4909: bitstring,sigM1_4910: bitstring));
                                                    {6075}if (verify(h(m1_4909),sigM1_4910,pkCli_4888) <> true) then
                                                        0
                                                    else
                                                        {6076}let (SPc_4911: bitstring,PartC_4912: bitstring) = m1_4909 in
                                                        {6077}new Ns_4913: bitstring;
                                                        {6078}let m2_4914: bitstring = exp(g,Ns_4913) in
                                                        {6079}out(c, (m2_4914,sign(h(m2_4914),skSess)));
                                                        {6080}let Ksrv_4915: bitstring = exp(PartC_4912,Ns_4913) in
                                                        {6081}out(c, senc(mSrv(pkCli_4888,pkSess_4830),Ksrv_4915))
                                                )
                                                else
                                                    {6082}let pkDisco_4916: bitstring = pub(skI) in
                                                    {6083}in(c, (=pkCli_4888,m1_4917: bitstring,sigM1_4918: bitstring));
                                                    {6084}if (verify(h(m1_4917),sigM1_4918,pkCli_4888) <> true) then
                                                        0
                                                    else
                                                        {6085}let (SPc_4919: bitstring,PartC_4920: bitstring) = m1_4917 in
                                                        {6086}new Ns_4921: bitstring;
                                                        {6087}let m2_4922: bitstring = exp(g,Ns_4921) in
                                                        {6088}out(c, (m2_4922,sign(h(m2_4922),skSess)));
                                                        {6089}let Ksrv_4923: bitstring = exp(PartC_4920,Ns_4921) in
                                                        {6090}out(c, senc(mSrv(pkCli_4888,pkSess_4830),Ksrv_4923))
                                            )
                                            else
                                                {6091}let pkDisco_4924: bitstring = fail-any in
                                                {6092}in(c, (=pkCli_4888,m1_4925: bitstring,sigM1_4926: bitstring));
                                                {6093}if (verify(h(m1_4925),sigM1_4926,pkCli_4888) <> true) then
                                                    0
                                                else
                                                    {6094}let (SPc_4927: bitstring,PartC_4928: bitstring) = m1_4925 in
                                                    {6095}new Ns_4929: bitstring;
                                                    {6096}let m2_4930: bitstring = exp(g,Ns_4929) in
                                                    {6097}out(c, (m2_4930,sign(h(m2_4930),skSess)));
                                                    {6098}let Ksrv_4931: bitstring = exp(PartC_4928,Ns_4929) in
                                                    {6099}out(c, senc(mSrv(pkCli_4888,pkSess_4830),Ksrv_4931))
                                    )
                                    else
                                        {6100}let pkDisco_4932: bitstring = fail-any in
                                        {6101}in(c, (=pkCli_4888,m1_4933: bitstring,sigM1_4934: bitstring));
                                        {6102}if (verify(h(m1_4933),sigM1_4934,pkCli_4888) <> true) then
                                            0
                                        else
                                            {6103}let (SPc_4935: bitstring,PartC_4936: bitstring) = m1_4933 in
                                            {6104}new Ns_4937: bitstring;
                                            {6105}let m2_4938: bitstring = exp(g,Ns_4937) in
                                            {6106}out(c, (m2_4938,sign(h(m2_4938),skSess)));
                                            {6107}let Ksrv_4939: bitstring = exp(PartC_4936,Ns_4937) in
                                            {6108}out(c, senc(mSrv(pkCli_4888,pkSess_4830),Ksrv_4939))
                            )
                            else
                                {6109}let pkDisco_4940: bitstring = fail-any in
                                {6110}in(c, (=pkCli_4888,m1_4941: bitstring,sigM1_4942: bitstring));
                                {6111}if (verify(h(m1_4941),sigM1_4942,pkCli_4888) <> true) then
                                    0
                                else
                                    {6112}let (SPc_4943: bitstring,PartC_4944: bitstring) = m1_4941 in
                                    {6113}new Ns_4945: bitstring;
                                    {6114}let m2_4946: bitstring = exp(g,Ns_4945) in
                                    {6115}out(c, (m2_4946,sign(h(m2_4946),skSess)));
                                    {6116}let Ksrv_4947: bitstring = exp(PartC_4944,Ns_4945) in
                                    {6117}out(c, senc(mSrv(pkCli_4888,pkSess_4830),Ksrv_4947))
                        )
                        else
                            {6118}let v_4948: bool = (Cli_4826 = C) in
                            (
                                {6119}if v_4948 then
                                (
                                    {6120}let pkCli_4949: bitstring = pub(skC) in
                                    {6121}let v_4950: bool = (Disco_4827 = A) in
                                    (
                                        {6122}if v_4950 then
                                        (
                                            {6123}let pkDisco_4951: bitstring = pub(skA) in
                                            {6124}in(c, (=pkCli_4949,m1_4952: bitstring,sigM1_4953: bitstring));
                                            {6125}if (verify(h(m1_4952),sigM1_4953,pkCli_4949) <> true) then
                                                0
                                            else
                                                {6126}let (SPc_4954: bitstring,PartC_4955: bitstring) = m1_4952 in
                                                {6127}new Ns_4956: bitstring;
                                                {6128}let m2_4957: bitstring = exp(g,Ns_4956) in
                                                {6129}out(c, (m2_4957,sign(h(m2_4957),skSess)));
                                                {6130}let Ksrv_4958: bitstring = exp(PartC_4955,Ns_4956) in
                                                {6131}out(c, senc(mSrv(pkCli_4949,pkSess_4830),Ksrv_4958))
                                        )
                                        else
                                            {6132}let v_4959: bool = (Disco_4827 = B) in
                                            (
                                                {6133}if v_4959 then
                                                (
                                                    {6134}let pkDisco_4960: bitstring = pub(skB) in
                                                    {6135}in(c, (=pkCli_4949,m1_4961: bitstring,sigM1_4962: bitstring));
                                                    {6136}if (verify(h(m1_4961),sigM1_4962,pkCli_4949) <> true) then
                                                        0
                                                    else
                                                        {6137}let (SPc_4963: bitstring,PartC_4964: bitstring) = m1_4961 in
                                                        {6138}new Ns_4965: bitstring;
                                                        {6139}let m2_4966: bitstring = exp(g,Ns_4965) in
                                                        {6140}out(c, (m2_4966,sign(h(m2_4966),skSess)));
                                                        {6141}let Ksrv_4967: bitstring = exp(PartC_4964,Ns_4965) in
                                                        {6142}out(c, senc(mSrv(pkCli_4949,pkSess_4830),Ksrv_4967))
                                                )
                                                else
                                                    {6143}let v_4968: bool = (Disco_4827 = C) in
                                                    (
                                                        {6144}if v_4968 then
                                                        (
                                                            {6145}let pkDisco_4969: bitstring = pub(skC) in
                                                            {6146}in(c, (=pkCli_4949,m1_4970: bitstring,sigM1_4971: bitstring));
                                                            {6147}if (verify(h(m1_4970),sigM1_4971,pkCli_4949) <> true) then
                                                                0
                                                            else
                                                                {6148}let (SPc_4972: bitstring,PartC_4973: bitstring) = m1_4970 in
                                                                {6149}new Ns_4974: bitstring;
                                                                {6150}let m2_4975: bitstring = exp(g,Ns_4974) in
                                                                {6151}out(c, (m2_4975,sign(h(m2_4975),skSess)));
                                                                {6152}let Ksrv_4976: bitstring = exp(PartC_4973,Ns_4974) in
                                                                {6153}out(c, senc(mSrv(pkCli_4949,pkSess_4830),Ksrv_4976))
                                                        )
                                                        else
                                                            {6154}let pkDisco_4977: bitstring = pub(skI) in
                                                            {6155}in(c, (=pkCli_4949,m1_4978: bitstring,sigM1_4979: bitstring));
                                                            {6156}if (verify(h(m1_4978),sigM1_4979,pkCli_4949) <> true) then
                                                                0
                                                            else
                                                                {6157}let (SPc_4980: bitstring,PartC_4981: bitstring) = m1_4978 in
                                                                {6158}new Ns_4982: bitstring;
                                                                {6159}let m2_4983: bitstring = exp(g,Ns_4982) in
                                                                {6160}out(c, (m2_4983,sign(h(m2_4983),skSess)));
                                                                {6161}let Ksrv_4984: bitstring = exp(PartC_4981,Ns_4982) in
                                                                {6162}out(c, senc(mSrv(pkCli_4949,pkSess_4830),Ksrv_4984))
                                                    )
                                                    else
                                                        {6163}let pkDisco_4985: bitstring = fail-any in
                                                        {6164}in(c, (=pkCli_4949,m1_4986: bitstring,sigM1_4987: bitstring));
                                                        {6165}if (verify(h(m1_4986),sigM1_4987,pkCli_4949) <> true) then
                                                            0
                                                        else
                                                            {6166}let (SPc_4988: bitstring,PartC_4989: bitstring) = m1_4986 in
                                                            {6167}new Ns_4990: bitstring;
                                                            {6168}let m2_4991: bitstring = exp(g,Ns_4990) in
                                                            {6169}out(c, (m2_4991,sign(h(m2_4991),skSess)));
                                                            {6170}let Ksrv_4992: bitstring = exp(PartC_4989,Ns_4990) in
                                                            {6171}out(c, senc(mSrv(pkCli_4949,pkSess_4830),Ksrv_4992))
                                            )
                                            else
                                                {6172}let pkDisco_4993: bitstring = fail-any in
                                                {6173}in(c, (=pkCli_4949,m1_4994: bitstring,sigM1_4995: bitstring));
                                                {6174}if (verify(h(m1_4994),sigM1_4995,pkCli_4949) <> true) then
                                                    0
                                                else
                                                    {6175}let (SPc_4996: bitstring,PartC_4997: bitstring) = m1_4994 in
                                                    {6176}new Ns_4998: bitstring;
                                                    {6177}let m2_4999: bitstring = exp(g,Ns_4998) in
                                                    {6178}out(c, (m2_4999,sign(h(m2_4999),skSess)));
                                                    {6179}let Ksrv_5000: bitstring = exp(PartC_4997,Ns_4998) in
                                                    {6180}out(c, senc(mSrv(pkCli_4949,pkSess_4830),Ksrv_5000))
                                    )
                                    else
                                        {6181}let pkDisco_5001: bitstring = fail-any in
                                        {6182}in(c, (=pkCli_4949,m1_5002: bitstring,sigM1_5003: bitstring));
                                        {6183}if (verify(h(m1_5002),sigM1_5003,pkCli_4949) <> true) then
                                            0
                                        else
                                            {6184}let (SPc_5004: bitstring,PartC_5005: bitstring) = m1_5002 in
                                            {6185}new Ns_5006: bitstring;
                                            {6186}let m2_5007: bitstring = exp(g,Ns_5006) in
                                            {6187}out(c, (m2_5007,sign(h(m2_5007),skSess)));
                                            {6188}let Ksrv_5008: bitstring = exp(PartC_5005,Ns_5006) in
                                            {6189}out(c, senc(mSrv(pkCli_4949,pkSess_4830),Ksrv_5008))
                                )
                                else
                                    {6190}let pkCli_5009: bitstring = pub(skI) in
                                    {6191}let v_5010: bool = (Disco_4827 = A) in
                                    (
                                        {6192}if v_5010 then
                                        (
                                            {6193}let pkDisco_5011: bitstring = pub(skA) in
                                            {6194}in(c, (=pkCli_5009,m1_5012: bitstring,sigM1_5013: bitstring));
                                            {6195}if (verify(h(m1_5012),sigM1_5013,pkCli_5009) <> true) then
                                                0
                                            else
                                                {6196}let (SPc_5014: bitstring,PartC_5015: bitstring) = m1_5012 in
                                                {6197}new Ns_5016: bitstring;
                                                {6198}let m2_5017: bitstring = exp(g,Ns_5016) in
                                                {6199}out(c, (m2_5017,sign(h(m2_5017),skSess)));
                                                {6200}let Ksrv_5018: bitstring = exp(PartC_5015,Ns_5016) in
                                                {6201}out(c, senc(mSrv(pkCli_5009,pkSess_4830),Ksrv_5018))
                                        )
                                        else
                                            {6202}let v_5019: bool = (Disco_4827 = B) in
                                            (
                                                {6203}if v_5019 then
                                                (
                                                    {6204}let pkDisco_5020: bitstring = pub(skB) in
                                                    {6205}in(c, (=pkCli_5009,m1_5021: bitstring,sigM1_5022: bitstring));
                                                    {6206}if (verify(h(m1_5021),sigM1_5022,pkCli_5009) <> true) then
                                                        0
                                                    else
                                                        {6207}let (SPc_5023: bitstring,PartC_5024: bitstring) = m1_5021 in
                                                        {6208}new Ns_5025: bitstring;
                                                        {6209}let m2_5026: bitstring = exp(g,Ns_5025) in
                                                        {6210}out(c, (m2_5026,sign(h(m2_5026),skSess)));
                                                        {6211}let Ksrv_5027: bitstring = exp(PartC_5024,Ns_5025) in
                                                        {6212}out(c, senc(mSrv(pkCli_5009,pkSess_4830),Ksrv_5027))
                                                )
                                                else
                                                    {6213}let v_5028: bool = (Disco_4827 = C) in
                                                    (
                                                        {6214}if v_5028 then
                                                        (
                                                            {6215}let pkDisco_5029: bitstring = pub(skC) in
                                                            {6216}in(c, (=pkCli_5009,m1_5030: bitstring,sigM1_5031: bitstring));
                                                            {6217}if (verify(h(m1_5030),sigM1_5031,pkCli_5009) <> true) then
                                                                0
                                                            else
                                                                {6218}let (SPc_5032: bitstring,PartC_5033: bitstring) = m1_5030 in
                                                                {6219}new Ns_5034: bitstring;
                                                                {6220}let m2_5035: bitstring = exp(g,Ns_5034) in
                                                                {6221}out(c, (m2_5035,sign(h(m2_5035),skSess)));
                                                                {6222}let Ksrv_5036: bitstring = exp(PartC_5033,Ns_5034) in
                                                                {6223}out(c, senc(mSrv(pkCli_5009,pkSess_4830),Ksrv_5036))
                                                        )
                                                        else
                                                            {6224}let pkDisco_5037: bitstring = pub(skI) in
                                                            {6225}in(c, (=pkCli_5009,m1_5038: bitstring,sigM1_5039: bitstring));
                                                            {6226}if (verify(h(m1_5038),sigM1_5039,pkCli_5009) <> true) then
                                                                0
                                                            else
                                                                {6227}let (SPc_5040: bitstring,PartC_5041: bitstring) = m1_5038 in
                                                                {6228}new Ns_5042: bitstring;
                                                                {6229}let m2_5043: bitstring = exp(g,Ns_5042) in
                                                                {6230}out(c, (m2_5043,sign(h(m2_5043),skSess)));
                                                                {6231}let Ksrv_5044: bitstring = exp(PartC_5041,Ns_5042) in
                                                                {6232}out(c, senc(mSrv(pkCli_5009,pkSess_4830),Ksrv_5044))
                                                    )
                                                    else
                                                        {6233}let pkDisco_5045: bitstring = fail-any in
                                                        {6234}in(c, (=pkCli_5009,m1_5046: bitstring,sigM1_5047: bitstring));
                                                        {6235}if (verify(h(m1_5046),sigM1_5047,pkCli_5009) <> true) then
                                                            0
                                                        else
                                                            {6236}let (SPc_5048: bitstring,PartC_5049: bitstring) = m1_5046 in
                                                            {6237}new Ns_5050: bitstring;
                                                            {6238}let m2_5051: bitstring = exp(g,Ns_5050) in
                                                            {6239}out(c, (m2_5051,sign(h(m2_5051),skSess)));
                                                            {6240}let Ksrv_5052: bitstring = exp(PartC_5049,Ns_5050) in
                                                            {6241}out(c, senc(mSrv(pkCli_5009,pkSess_4830),Ksrv_5052))
                                            )
                                            else
                                                {6242}let pkDisco_5053: bitstring = fail-any in
                                                {6243}in(c, (=pkCli_5009,m1_5054: bitstring,sigM1_5055: bitstring));
                                                {6244}if (verify(h(m1_5054),sigM1_5055,pkCli_5009) <> true) then
                                                    0
                                                else
                                                    {6245}let (SPc_5056: bitstring,PartC_5057: bitstring) = m1_5054 in
                                                    {6246}new Ns_5058: bitstring;
                                                    {6247}let m2_5059: bitstring = exp(g,Ns_5058) in
                                                    {6248}out(c, (m2_5059,sign(h(m2_5059),skSess)));
                                                    {6249}let Ksrv_5060: bitstring = exp(PartC_5057,Ns_5058) in
                                                    {6250}out(c, senc(mSrv(pkCli_5009,pkSess_4830),Ksrv_5060))
                                    )
                                    else
                                        {6251}let pkDisco_5061: bitstring = fail-any in
                                        {6252}in(c, (=pkCli_5009,m1_5062: bitstring,sigM1_5063: bitstring));
                                        {6253}if (verify(h(m1_5062),sigM1_5063,pkCli_5009) <> true) then
                                            0
                                        else
                                            {6254}let (SPc_5064: bitstring,PartC_5065: bitstring) = m1_5062 in
                                            {6255}new Ns_5066: bitstring;
                                            {6256}let m2_5067: bitstring = exp(g,Ns_5066) in
                                            {6257}out(c, (m2_5067,sign(h(m2_5067),skSess)));
                                            {6258}let Ksrv_5068: bitstring = exp(PartC_5065,Ns_5066) in
                                            {6259}out(c, senc(mSrv(pkCli_5009,pkSess_4830),Ksrv_5068))
                            )
                            else
                                {6260}let pkCli_5069: bitstring = fail-any in
                                {6261}let v_5070: bool = (Disco_4827 = A) in
                                (
                                    {6262}if v_5070 then
                                    (
                                        {6263}let pkDisco_5071: bitstring = pub(skA) in
                                        {6264}in(c, (=pkCli_5069,m1_5072: bitstring,sigM1_5073: bitstring));
                                        {6265}if (verify(h(m1_5072),sigM1_5073,pkCli_5069) <> true) then
                                            0
                                        else
                                            {6266}let (SPc_5074: bitstring,PartC_5075: bitstring) = m1_5072 in
                                            {6267}new Ns_5076: bitstring;
                                            {6268}let m2_5077: bitstring = exp(g,Ns_5076) in
                                            {6269}out(c, (m2_5077,sign(h(m2_5077),skSess)));
                                            {6270}let Ksrv_5078: bitstring = exp(PartC_5075,Ns_5076) in
                                            {6271}out(c, senc(mSrv(pkCli_5069,pkSess_4830),Ksrv_5078))
                                    )
                                    else
                                        {6272}let v_5079: bool = (Disco_4827 = B) in
                                        (
                                            {6273}if v_5079 then
                                            (
                                                {6274}let pkDisco_5080: bitstring = pub(skB) in
                                                {6275}in(c, (=pkCli_5069,m1_5081: bitstring,sigM1_5082: bitstring));
                                                {6276}if (verify(h(m1_5081),sigM1_5082,pkCli_5069) <> true) then
                                                    0
                                                else
                                                    {6277}let (SPc_5083: bitstring,PartC_5084: bitstring) = m1_5081 in
                                                    {6278}new Ns_5085: bitstring;
                                                    {6279}let m2_5086: bitstring = exp(g,Ns_5085) in
                                                    {6280}out(c, (m2_5086,sign(h(m2_5086),skSess)));
                                                    {6281}let Ksrv_5087: bitstring = exp(PartC_5084,Ns_5085) in
                                                    {6282}out(c, senc(mSrv(pkCli_5069,pkSess_4830),Ksrv_5087))
                                            )
                                            else
                                                {6283}let v_5088: bool = (Disco_4827 = C) in
                                                (
                                                    {6284}if v_5088 then
                                                    (
                                                        {6285}let pkDisco_5089: bitstring = pub(skC) in
                                                        {6286}in(c, (=pkCli_5069,m1_5090: bitstring,sigM1_5091: bitstring));
                                                        {6287}if (verify(h(m1_5090),sigM1_5091,pkCli_5069) <> true) then
                                                            0
                                                        else
                                                            {6288}let (SPc_5092: bitstring,PartC_5093: bitstring) = m1_5090 in
                                                            {6289}new Ns_5094: bitstring;
                                                            {6290}let m2_5095: bitstring = exp(g,Ns_5094) in
                                                            {6291}out(c, (m2_5095,sign(h(m2_5095),skSess)));
                                                            {6292}let Ksrv_5096: bitstring = exp(PartC_5093,Ns_5094) in
                                                            {6293}out(c, senc(mSrv(pkCli_5069,pkSess_4830),Ksrv_5096))
                                                    )
                                                    else
                                                        {6294}let pkDisco_5097: bitstring = pub(skI) in
                                                        {6295}in(c, (=pkCli_5069,m1_5098: bitstring,sigM1_5099: bitstring));
                                                        {6296}if (verify(h(m1_5098),sigM1_5099,pkCli_5069) <> true) then
                                                            0
                                                        else
                                                            {6297}let (SPc_5100: bitstring,PartC_5101: bitstring) = m1_5098 in
                                                            {6298}new Ns_5102: bitstring;
                                                            {6299}let m2_5103: bitstring = exp(g,Ns_5102) in
                                                            {6300}out(c, (m2_5103,sign(h(m2_5103),skSess)));
                                                            {6301}let Ksrv_5104: bitstring = exp(PartC_5101,Ns_5102) in
                                                            {6302}out(c, senc(mSrv(pkCli_5069,pkSess_4830),Ksrv_5104))
                                                )
                                                else
                                                    {6303}let pkDisco_5105: bitstring = fail-any in
                                                    {6304}in(c, (=pkCli_5069,m1_5106: bitstring,sigM1_5107: bitstring));
                                                    {6305}if (verify(h(m1_5106),sigM1_5107,pkCli_5069) <> true) then
                                                        0
                                                    else
                                                        {6306}let (SPc_5108: bitstring,PartC_5109: bitstring) = m1_5106 in
                                                        {6307}new Ns_5110: bitstring;
                                                        {6308}let m2_5111: bitstring = exp(g,Ns_5110) in
                                                        {6309}out(c, (m2_5111,sign(h(m2_5111),skSess)));
                                                        {6310}let Ksrv_5112: bitstring = exp(PartC_5109,Ns_5110) in
                                                        {6311}out(c, senc(mSrv(pkCli_5069,pkSess_4830),Ksrv_5112))
                                        )
                                        else
                                            {6312}let pkDisco_5113: bitstring = fail-any in
                                            {6313}in(c, (=pkCli_5069,m1_5114: bitstring,sigM1_5115: bitstring));
                                            {6314}if (verify(h(m1_5114),sigM1_5115,pkCli_5069) <> true) then
                                                0
                                            else
                                                {6315}let (SPc_5116: bitstring,PartC_5117: bitstring) = m1_5114 in
                                                {6316}new Ns_5118: bitstring;
                                                {6317}let m2_5119: bitstring = exp(g,Ns_5118) in
                                                {6318}out(c, (m2_5119,sign(h(m2_5119),skSess)));
                                                {6319}let Ksrv_5120: bitstring = exp(PartC_5117,Ns_5118) in
                                                {6320}out(c, senc(mSrv(pkCli_5069,pkSess_4830),Ksrv_5120))
                                )
                                else
                                    {6321}let pkDisco_5121: bitstring = fail-any in
                                    {6322}in(c, (=pkCli_5069,m1_5122: bitstring,sigM1_5123: bitstring));
                                    {6323}if (verify(h(m1_5122),sigM1_5123,pkCli_5069) <> true) then
                                        0
                                    else
                                        {6324}let (SPc_5124: bitstring,PartC_5125: bitstring) = m1_5122 in
                                        {6325}new Ns_5126: bitstring;
                                        {6326}let m2_5127: bitstring = exp(g,Ns_5126) in
                                        {6327}out(c, (m2_5127,sign(h(m2_5127),skSess)));
                                        {6328}let Ksrv_5128: bitstring = exp(PartC_5125,Ns_5126) in
                                        {6329}out(c, senc(mSrv(pkCli_5069,pkSess_4830),Ksrv_5128))
                    )
                    else
                        {6330}let pkCli_5129: bitstring = fail-any in
                        {6331}let v_5130: bool = (Disco_4827 = A) in
                        (
                            {6332}if v_5130 then
                            (
                                {6333}let pkDisco_5131: bitstring = pub(skA) in
                                {6334}in(c, (=pkCli_5129,m1_5132: bitstring,sigM1_5133: bitstring));
                                {6335}if (verify(h(m1_5132),sigM1_5133,pkCli_5129) <> true) then
                                    0
                                else
                                    {6336}let (SPc_5134: bitstring,PartC_5135: bitstring) = m1_5132 in
                                    {6337}new Ns_5136: bitstring;
                                    {6338}let m2_5137: bitstring = exp(g,Ns_5136) in
                                    {6339}out(c, (m2_5137,sign(h(m2_5137),skSess)));
                                    {6340}let Ksrv_5138: bitstring = exp(PartC_5135,Ns_5136) in
                                    {6341}out(c, senc(mSrv(pkCli_5129,pkSess_4830),Ksrv_5138))
                            )
                            else
                                {6342}let v_5139: bool = (Disco_4827 = B) in
                                (
                                    {6343}if v_5139 then
                                    (
                                        {6344}let pkDisco_5140: bitstring = pub(skB) in
                                        {6345}in(c, (=pkCli_5129,m1_5141: bitstring,sigM1_5142: bitstring));
                                        {6346}if (verify(h(m1_5141),sigM1_5142,pkCli_5129) <> true) then
                                            0
                                        else
                                            {6347}let (SPc_5143: bitstring,PartC_5144: bitstring) = m1_5141 in
                                            {6348}new Ns_5145: bitstring;
                                            {6349}let m2_5146: bitstring = exp(g,Ns_5145) in
                                            {6350}out(c, (m2_5146,sign(h(m2_5146),skSess)));
                                            {6351}let Ksrv_5147: bitstring = exp(PartC_5144,Ns_5145) in
                                            {6352}out(c, senc(mSrv(pkCli_5129,pkSess_4830),Ksrv_5147))
                                    )
                                    else
                                        {6353}let v_5148: bool = (Disco_4827 = C) in
                                        (
                                            {6354}if v_5148 then
                                            (
                                                {6355}let pkDisco_5149: bitstring = pub(skC) in
                                                {6356}in(c, (=pkCli_5129,m1_5150: bitstring,sigM1_5151: bitstring));
                                                {6357}if (verify(h(m1_5150),sigM1_5151,pkCli_5129) <> true) then
                                                    0
                                                else
                                                    {6358}let (SPc_5152: bitstring,PartC_5153: bitstring) = m1_5150 in
                                                    {6359}new Ns_5154: bitstring;
                                                    {6360}let m2_5155: bitstring = exp(g,Ns_5154) in
                                                    {6361}out(c, (m2_5155,sign(h(m2_5155),skSess)));
                                                    {6362}let Ksrv_5156: bitstring = exp(PartC_5153,Ns_5154) in
                                                    {6363}out(c, senc(mSrv(pkCli_5129,pkSess_4830),Ksrv_5156))
                                            )
                                            else
                                                {6364}let pkDisco_5157: bitstring = pub(skI) in
                                                {6365}in(c, (=pkCli_5129,m1_5158: bitstring,sigM1_5159: bitstring));
                                                {6366}if (verify(h(m1_5158),sigM1_5159,pkCli_5129) <> true) then
                                                    0
                                                else
                                                    {6367}let (SPc_5160: bitstring,PartC_5161: bitstring) = m1_5158 in
                                                    {6368}new Ns_5162: bitstring;
                                                    {6369}let m2_5163: bitstring = exp(g,Ns_5162) in
                                                    {6370}out(c, (m2_5163,sign(h(m2_5163),skSess)));
                                                    {6371}let Ksrv_5164: bitstring = exp(PartC_5161,Ns_5162) in
                                                    {6372}out(c, senc(mSrv(pkCli_5129,pkSess_4830),Ksrv_5164))
                                        )
                                        else
                                            {6373}let pkDisco_5165: bitstring = fail-any in
                                            {6374}in(c, (=pkCli_5129,m1_5166: bitstring,sigM1_5167: bitstring));
                                            {6375}if (verify(h(m1_5166),sigM1_5167,pkCli_5129) <> true) then
                                                0
                                            else
                                                {6376}let (SPc_5168: bitstring,PartC_5169: bitstring) = m1_5166 in
                                                {6377}new Ns_5170: bitstring;
                                                {6378}let m2_5171: bitstring = exp(g,Ns_5170) in
                                                {6379}out(c, (m2_5171,sign(h(m2_5171),skSess)));
                                                {6380}let Ksrv_5172: bitstring = exp(PartC_5169,Ns_5170) in
                                                {6381}out(c, senc(mSrv(pkCli_5129,pkSess_4830),Ksrv_5172))
                                )
                                else
                                    {6382}let pkDisco_5173: bitstring = fail-any in
                                    {6383}in(c, (=pkCli_5129,m1_5174: bitstring,sigM1_5175: bitstring));
                                    {6384}if (verify(h(m1_5174),sigM1_5175,pkCli_5129) <> true) then
                                        0
                                    else
                                        {6385}let (SPc_5176: bitstring,PartC_5177: bitstring) = m1_5174 in
                                        {6386}new Ns_5178: bitstring;
                                        {6387}let m2_5179: bitstring = exp(g,Ns_5178) in
                                        {6388}out(c, (m2_5179,sign(h(m2_5179),skSess)));
                                        {6389}let Ksrv_5180: bitstring = exp(PartC_5177,Ns_5178) in
                                        {6390}out(c, senc(mSrv(pkCli_5129,pkSess_4830),Ksrv_5180))
                        )
                        else
                            {6391}let pkDisco_5181: bitstring = fail-any in
                            {6392}in(c, (=pkCli_5129,m1_5182: bitstring,sigM1_5183: bitstring));
                            {6393}if (verify(h(m1_5182),sigM1_5183,pkCli_5129) <> true) then
                                0
                            else
                                {6394}let (SPc_5184: bitstring,PartC_5185: bitstring) = m1_5182 in
                                {6395}new Ns_5186: bitstring;
                                {6396}let m2_5187: bitstring = exp(g,Ns_5186) in
                                {6397}out(c, (m2_5187,sign(h(m2_5187),skSess)));
                                {6398}let Ksrv_5188: bitstring = exp(PartC_5185,Ns_5186) in
                                {6399}out(c, senc(mSrv(pkCli_5129,pkSess_4830),Ksrv_5188))
            )
            else
                {6400}let pkCli_5189: bitstring = fail-any in
                {6401}let v_5190: bool = (Disco_4827 = A) in
                (
                    {6402}if v_5190 then
                    (
                        {6403}let pkDisco_5191: bitstring = pub(skA) in
                        {6404}in(c, (=pkCli_5189,m1_5192: bitstring,sigM1_5193: bitstring));
                        {6405}if (verify(h(m1_5192),sigM1_5193,pkCli_5189) <> true) then
                            0
                        else
                            {6406}let (SPc_5194: bitstring,PartC_5195: bitstring) = m1_5192 in
                            {6407}new Ns_5196: bitstring;
                            {6408}let m2_5197: bitstring = exp(g,Ns_5196) in
                            {6409}out(c, (m2_5197,sign(h(m2_5197),skSess)));
                            {6410}let Ksrv_5198: bitstring = exp(PartC_5195,Ns_5196) in
                            {6411}out(c, senc(mSrv(pkCli_5189,pkSess_4830),Ksrv_5198))
                    )
                    else
                        {6412}let v_5199: bool = (Disco_4827 = B) in
                        (
                            {6413}if v_5199 then
                            (
                                {6414}let pkDisco_5200: bitstring = pub(skB) in
                                {6415}in(c, (=pkCli_5189,m1_5201: bitstring,sigM1_5202: bitstring));
                                {6416}if (verify(h(m1_5201),sigM1_5202,pkCli_5189) <> true) then
                                    0
                                else
                                    {6417}let (SPc_5203: bitstring,PartC_5204: bitstring) = m1_5201 in
                                    {6418}new Ns_5205: bitstring;
                                    {6419}let m2_5206: bitstring = exp(g,Ns_5205) in
                                    {6420}out(c, (m2_5206,sign(h(m2_5206),skSess)));
                                    {6421}let Ksrv_5207: bitstring = exp(PartC_5204,Ns_5205) in
                                    {6422}out(c, senc(mSrv(pkCli_5189,pkSess_4830),Ksrv_5207))
                            )
                            else
                                {6423}let v_5208: bool = (Disco_4827 = C) in
                                (
                                    {6424}if v_5208 then
                                    (
                                        {6425}let pkDisco_5209: bitstring = pub(skC) in
                                        {6426}in(c, (=pkCli_5189,m1_5210: bitstring,sigM1_5211: bitstring));
                                        {6427}if (verify(h(m1_5210),sigM1_5211,pkCli_5189) <> true) then
                                            0
                                        else
                                            {6428}let (SPc_5212: bitstring,PartC_5213: bitstring) = m1_5210 in
                                            {6429}new Ns_5214: bitstring;
                                            {6430}let m2_5215: bitstring = exp(g,Ns_5214) in
                                            {6431}out(c, (m2_5215,sign(h(m2_5215),skSess)));
                                            {6432}let Ksrv_5216: bitstring = exp(PartC_5213,Ns_5214) in
                                            {6433}out(c, senc(mSrv(pkCli_5189,pkSess_4830),Ksrv_5216))
                                    )
                                    else
                                        {6434}let pkDisco_5217: bitstring = pub(skI) in
                                        {6435}in(c, (=pkCli_5189,m1_5218: bitstring,sigM1_5219: bitstring));
                                        {6436}if (verify(h(m1_5218),sigM1_5219,pkCli_5189) <> true) then
                                            0
                                        else
                                            {6437}let (SPc_5220: bitstring,PartC_5221: bitstring) = m1_5218 in
                                            {6438}new Ns_5222: bitstring;
                                            {6439}let m2_5223: bitstring = exp(g,Ns_5222) in
                                            {6440}out(c, (m2_5223,sign(h(m2_5223),skSess)));
                                            {6441}let Ksrv_5224: bitstring = exp(PartC_5221,Ns_5222) in
                                            {6442}out(c, senc(mSrv(pkCli_5189,pkSess_4830),Ksrv_5224))
                                )
                                else
                                    {6443}let pkDisco_5225: bitstring = fail-any in
                                    {6444}in(c, (=pkCli_5189,m1_5226: bitstring,sigM1_5227: bitstring));
                                    {6445}if (verify(h(m1_5226),sigM1_5227,pkCli_5189) <> true) then
                                        0
                                    else
                                        {6446}let (SPc_5228: bitstring,PartC_5229: bitstring) = m1_5226 in
                                        {6447}new Ns_5230: bitstring;
                                        {6448}let m2_5231: bitstring = exp(g,Ns_5230) in
                                        {6449}out(c, (m2_5231,sign(h(m2_5231),skSess)));
                                        {6450}let Ksrv_5232: bitstring = exp(PartC_5229,Ns_5230) in
                                        {6451}out(c, senc(mSrv(pkCli_5189,pkSess_4830),Ksrv_5232))
                        )
                        else
                            {6452}let pkDisco_5233: bitstring = fail-any in
                            {6453}in(c, (=pkCli_5189,m1_5234: bitstring,sigM1_5235: bitstring));
                            {6454}if (verify(h(m1_5234),sigM1_5235,pkCli_5189) <> true) then
                                0
                            else
                                {6455}let (SPc_5236: bitstring,PartC_5237: bitstring) = m1_5234 in
                                {6456}new Ns_5238: bitstring;
                                {6457}let m2_5239: bitstring = exp(g,Ns_5238) in
                                {6458}out(c, (m2_5239,sign(h(m2_5239),skSess)));
                                {6459}let Ksrv_5240: bitstring = exp(PartC_5237,Ns_5238) in
                                {6460}out(c, senc(mSrv(pkCli_5189,pkSess_4830),Ksrv_5240))
                )
                else
                    {6461}let pkDisco_5241: bitstring = fail-any in
                    {6462}in(c, (=pkCli_5189,m1_5242: bitstring,sigM1_5243: bitstring));
                    {6463}if (verify(h(m1_5242),sigM1_5243,pkCli_5189) <> true) then
                        0
                    else
                        {6464}let (SPc_5244: bitstring,PartC_5245: bitstring) = m1_5242 in
                        {6465}new Ns_5246: bitstring;
                        {6466}let m2_5247: bitstring = exp(g,Ns_5246) in
                        {6467}out(c, (m2_5247,sign(h(m2_5247),skSess)));
                        {6468}let Ksrv_5248: bitstring = exp(PartC_5245,Ns_5246) in
                        {6469}out(c, senc(mSrv(pkCli_5189,pkSess_4830),Ksrv_5248))
        )
        else
            {6470}let v_5249: bool = (Sess_4828 = B) in
            (
                {6471}if v_5249 then
                (
                    {6472}let skSess_5250: bitstring = skB in
                    {6473}let pkSess_5251: bitstring = pub(skSess_5250) in
                    {6474}let v_5252: bool = (Cli_4826 = A) in
                    (
                        {6475}if v_5252 then
                        (
                            {6476}let pkCli_5253: bitstring = pub(skA) in
                            {6477}let v_5254: bool = (Disco_4827 = A) in
                            (
                                {6478}if v_5254 then
                                (
                                    {6479}let pkDisco_5255: bitstring = pub(skA) in
                                    {6480}in(c, (=pkCli_5253,m1_5256: bitstring,sigM1_5257: bitstring));
                                    {6481}if (verify(h(m1_5256),sigM1_5257,pkCli_5253) <> true) then
                                        0
                                    else
                                        {6482}let (SPc_5258: bitstring,PartC_5259: bitstring) = m1_5256 in
                                        {6483}new Ns_5260: bitstring;
                                        {6484}let m2_5261: bitstring = exp(g,Ns_5260) in
                                        {6485}out(c, (m2_5261,sign(h(m2_5261),skSess_5250)));
                                        {6486}let Ksrv_5262: bitstring = exp(PartC_5259,Ns_5260) in
                                        {6487}out(c, senc(mSrv(pkCli_5253,pkSess_5251),Ksrv_5262))
                                )
                                else
                                    {6488}let v_5263: bool = (Disco_4827 = B) in
                                    (
                                        {6489}if v_5263 then
                                        (
                                            {6490}let pkDisco_5264: bitstring = pub(skB) in
                                            {6491}in(c, (=pkCli_5253,m1_5265: bitstring,sigM1_5266: bitstring));
                                            {6492}if (verify(h(m1_5265),sigM1_5266,pkCli_5253) <> true) then
                                                0
                                            else
                                                {6493}let (SPc_5267: bitstring,PartC_5268: bitstring) = m1_5265 in
                                                {6494}new Ns_5269: bitstring;
                                                {6495}let m2_5270: bitstring = exp(g,Ns_5269) in
                                                {6496}out(c, (m2_5270,sign(h(m2_5270),skSess_5250)));
                                                {6497}let Ksrv_5271: bitstring = exp(PartC_5268,Ns_5269) in
                                                {6498}out(c, senc(mSrv(pkCli_5253,pkSess_5251),Ksrv_5271))
                                        )
                                        else
                                            {6499}let v_5272: bool = (Disco_4827 = C) in
                                            (
                                                {6500}if v_5272 then
                                                (
                                                    {6501}let pkDisco_5273: bitstring = pub(skC) in
                                                    {6502}in(c, (=pkCli_5253,m1_5274: bitstring,sigM1_5275: bitstring));
                                                    {6503}if (verify(h(m1_5274),sigM1_5275,pkCli_5253) <> true) then
                                                        0
                                                    else
                                                        {6504}let (SPc_5276: bitstring,PartC_5277: bitstring) = m1_5274 in
                                                        {6505}new Ns_5278: bitstring;
                                                        {6506}let m2_5279: bitstring = exp(g,Ns_5278) in
                                                        {6507}out(c, (m2_5279,sign(h(m2_5279),skSess_5250)));
                                                        {6508}let Ksrv_5280: bitstring = exp(PartC_5277,Ns_5278) in
                                                        {6509}out(c, senc(mSrv(pkCli_5253,pkSess_5251),Ksrv_5280))
                                                )
                                                else
                                                    {6510}let pkDisco_5281: bitstring = pub(skI) in
                                                    {6511}in(c, (=pkCli_5253,m1_5282: bitstring,sigM1_5283: bitstring));
                                                    {6512}if (verify(h(m1_5282),sigM1_5283,pkCli_5253) <> true) then
                                                        0
                                                    else
                                                        {6513}let (SPc_5284: bitstring,PartC_5285: bitstring) = m1_5282 in
                                                        {6514}new Ns_5286: bitstring;
                                                        {6515}let m2_5287: bitstring = exp(g,Ns_5286) in
                                                        {6516}out(c, (m2_5287,sign(h(m2_5287),skSess_5250)));
                                                        {6517}let Ksrv_5288: bitstring = exp(PartC_5285,Ns_5286) in
                                                        {6518}out(c, senc(mSrv(pkCli_5253,pkSess_5251),Ksrv_5288))
                                            )
                                            else
                                                {6519}let pkDisco_5289: bitstring = fail-any in
                                                {6520}in(c, (=pkCli_5253,m1_5290: bitstring,sigM1_5291: bitstring));
                                                {6521}if (verify(h(m1_5290),sigM1_5291,pkCli_5253) <> true) then
                                                    0
                                                else
                                                    {6522}let (SPc_5292: bitstring,PartC_5293: bitstring) = m1_5290 in
                                                    {6523}new Ns_5294: bitstring;
                                                    {6524}let m2_5295: bitstring = exp(g,Ns_5294) in
                                                    {6525}out(c, (m2_5295,sign(h(m2_5295),skSess_5250)));
                                                    {6526}let Ksrv_5296: bitstring = exp(PartC_5293,Ns_5294) in
                                                    {6527}out(c, senc(mSrv(pkCli_5253,pkSess_5251),Ksrv_5296))
                                    )
                                    else
                                        {6528}let pkDisco_5297: bitstring = fail-any in
                                        {6529}in(c, (=pkCli_5253,m1_5298: bitstring,sigM1_5299: bitstring));
                                        {6530}if (verify(h(m1_5298),sigM1_5299,pkCli_5253) <> true) then
                                            0
                                        else
                                            {6531}let (SPc_5300: bitstring,PartC_5301: bitstring) = m1_5298 in
                                            {6532}new Ns_5302: bitstring;
                                            {6533}let m2_5303: bitstring = exp(g,Ns_5302) in
                                            {6534}out(c, (m2_5303,sign(h(m2_5303),skSess_5250)));
                                            {6535}let Ksrv_5304: bitstring = exp(PartC_5301,Ns_5302) in
                                            {6536}out(c, senc(mSrv(pkCli_5253,pkSess_5251),Ksrv_5304))
                            )
                            else
                                {6537}let pkDisco_5305: bitstring = fail-any in
                                {6538}in(c, (=pkCli_5253,m1_5306: bitstring,sigM1_5307: bitstring));
                                {6539}if (verify(h(m1_5306),sigM1_5307,pkCli_5253) <> true) then
                                    0
                                else
                                    {6540}let (SPc_5308: bitstring,PartC_5309: bitstring) = m1_5306 in
                                    {6541}new Ns_5310: bitstring;
                                    {6542}let m2_5311: bitstring = exp(g,Ns_5310) in
                                    {6543}out(c, (m2_5311,sign(h(m2_5311),skSess_5250)));
                                    {6544}let Ksrv_5312: bitstring = exp(PartC_5309,Ns_5310) in
                                    {6545}out(c, senc(mSrv(pkCli_5253,pkSess_5251),Ksrv_5312))
                        )
                        else
                            {6546}let v_5313: bool = (Cli_4826 = B) in
                            (
                                {6547}if v_5313 then
                                (
                                    {6548}let pkCli_5314: bitstring = pub(skB) in
                                    {6549}let v_5315: bool = (Disco_4827 = A) in
                                    (
                                        {6550}if v_5315 then
                                        (
                                            {6551}let pkDisco_5316: bitstring = pub(skA) in
                                            {6552}in(c, (=pkCli_5314,m1_5317: bitstring,sigM1_5318: bitstring));
                                            {6553}if (verify(h(m1_5317),sigM1_5318,pkCli_5314) <> true) then
                                                0
                                            else
                                                {6554}let (SPc_5319: bitstring,PartC_5320: bitstring) = m1_5317 in
                                                {6555}new Ns_5321: bitstring;
                                                {6556}let m2_5322: bitstring = exp(g,Ns_5321) in
                                                {6557}out(c, (m2_5322,sign(h(m2_5322),skSess_5250)));
                                                {6558}let Ksrv_5323: bitstring = exp(PartC_5320,Ns_5321) in
                                                {6559}out(c, senc(mSrv(pkCli_5314,pkSess_5251),Ksrv_5323))
                                        )
                                        else
                                            {6560}let v_5324: bool = (Disco_4827 = B) in
                                            (
                                                {6561}if v_5324 then
                                                (
                                                    {6562}let pkDisco_5325: bitstring = pub(skB) in
                                                    {6563}in(c, (=pkCli_5314,m1_5326: bitstring,sigM1_5327: bitstring));
                                                    {6564}if (verify(h(m1_5326),sigM1_5327,pkCli_5314) <> true) then
                                                        0
                                                    else
                                                        {6565}let (SPc_5328: bitstring,PartC_5329: bitstring) = m1_5326 in
                                                        {6566}new Ns_5330: bitstring;
                                                        {6567}let m2_5331: bitstring = exp(g,Ns_5330) in
                                                        {6568}out(c, (m2_5331,sign(h(m2_5331),skSess_5250)));
                                                        {6569}let Ksrv_5332: bitstring = exp(PartC_5329,Ns_5330) in
                                                        {6570}out(c, senc(mSrv(pkCli_5314,pkSess_5251),Ksrv_5332))
                                                )
                                                else
                                                    {6571}let v_5333: bool = (Disco_4827 = C) in
                                                    (
                                                        {6572}if v_5333 then
                                                        (
                                                            {6573}let pkDisco_5334: bitstring = pub(skC) in
                                                            {6574}in(c, (=pkCli_5314,m1_5335: bitstring,sigM1_5336: bitstring));
                                                            {6575}if (verify(h(m1_5335),sigM1_5336,pkCli_5314) <> true) then
                                                                0
                                                            else
                                                                {6576}let (SPc_5337: bitstring,PartC_5338: bitstring) = m1_5335 in
                                                                {6577}new Ns_5339: bitstring;
                                                                {6578}let m2_5340: bitstring = exp(g,Ns_5339) in
                                                                {6579}out(c, (m2_5340,sign(h(m2_5340),skSess_5250)));
                                                                {6580}let Ksrv_5341: bitstring = exp(PartC_5338,Ns_5339) in
                                                                {6581}out(c, senc(mSrv(pkCli_5314,pkSess_5251),Ksrv_5341))
                                                        )
                                                        else
                                                            {6582}let pkDisco_5342: bitstring = pub(skI) in
                                                            {6583}in(c, (=pkCli_5314,m1_5343: bitstring,sigM1_5344: bitstring));
                                                            {6584}if (verify(h(m1_5343),sigM1_5344,pkCli_5314) <> true) then
                                                                0
                                                            else
                                                                {6585}let (SPc_5345: bitstring,PartC_5346: bitstring) = m1_5343 in
                                                                {6586}new Ns_5347: bitstring;
                                                                {6587}let m2_5348: bitstring = exp(g,Ns_5347) in
                                                                {6588}out(c, (m2_5348,sign(h(m2_5348),skSess_5250)));
                                                                {6589}let Ksrv_5349: bitstring = exp(PartC_5346,Ns_5347) in
                                                                {6590}out(c, senc(mSrv(pkCli_5314,pkSess_5251),Ksrv_5349))
                                                    )
                                                    else
                                                        {6591}let pkDisco_5350: bitstring = fail-any in
                                                        {6592}in(c, (=pkCli_5314,m1_5351: bitstring,sigM1_5352: bitstring));
                                                        {6593}if (verify(h(m1_5351),sigM1_5352,pkCli_5314) <> true) then
                                                            0
                                                        else
                                                            {6594}let (SPc_5353: bitstring,PartC_5354: bitstring) = m1_5351 in
                                                            {6595}new Ns_5355: bitstring;
                                                            {6596}let m2_5356: bitstring = exp(g,Ns_5355) in
                                                            {6597}out(c, (m2_5356,sign(h(m2_5356),skSess_5250)));
                                                            {6598}let Ksrv_5357: bitstring = exp(PartC_5354,Ns_5355) in
                                                            {6599}out(c, senc(mSrv(pkCli_5314,pkSess_5251),Ksrv_5357))
                                            )
                                            else
                                                {6600}let pkDisco_5358: bitstring = fail-any in
                                                {6601}in(c, (=pkCli_5314,m1_5359: bitstring,sigM1_5360: bitstring));
                                                {6602}if (verify(h(m1_5359),sigM1_5360,pkCli_5314) <> true) then
                                                    0
                                                else
                                                    {6603}let (SPc_5361: bitstring,PartC_5362: bitstring) = m1_5359 in
                                                    {6604}new Ns_5363: bitstring;
                                                    {6605}let m2_5364: bitstring = exp(g,Ns_5363) in
                                                    {6606}out(c, (m2_5364,sign(h(m2_5364),skSess_5250)));
                                                    {6607}let Ksrv_5365: bitstring = exp(PartC_5362,Ns_5363) in
                                                    {6608}out(c, senc(mSrv(pkCli_5314,pkSess_5251),Ksrv_5365))
                                    )
                                    else
                                        {6609}let pkDisco_5366: bitstring = fail-any in
                                        {6610}in(c, (=pkCli_5314,m1_5367: bitstring,sigM1_5368: bitstring));
                                        {6611}if (verify(h(m1_5367),sigM1_5368,pkCli_5314) <> true) then
                                            0
                                        else
                                            {6612}let (SPc_5369: bitstring,PartC_5370: bitstring) = m1_5367 in
                                            {6613}new Ns_5371: bitstring;
                                            {6614}let m2_5372: bitstring = exp(g,Ns_5371) in
                                            {6615}out(c, (m2_5372,sign(h(m2_5372),skSess_5250)));
                                            {6616}let Ksrv_5373: bitstring = exp(PartC_5370,Ns_5371) in
                                            {6617}out(c, senc(mSrv(pkCli_5314,pkSess_5251),Ksrv_5373))
                                )
                                else
                                    {6618}let v_5374: bool = (Cli_4826 = C) in
                                    (
                                        {6619}if v_5374 then
                                        (
                                            {6620}let pkCli_5375: bitstring = pub(skC) in
                                            {6621}let v_5376: bool = (Disco_4827 = A) in
                                            (
                                                {6622}if v_5376 then
                                                (
                                                    {6623}let pkDisco_5377: bitstring = pub(skA) in
                                                    {6624}in(c, (=pkCli_5375,m1_5378: bitstring,sigM1_5379: bitstring));
                                                    {6625}if (verify(h(m1_5378),sigM1_5379,pkCli_5375) <> true) then
                                                        0
                                                    else
                                                        {6626}let (SPc_5380: bitstring,PartC_5381: bitstring) = m1_5378 in
                                                        {6627}new Ns_5382: bitstring;
                                                        {6628}let m2_5383: bitstring = exp(g,Ns_5382) in
                                                        {6629}out(c, (m2_5383,sign(h(m2_5383),skSess_5250)));
                                                        {6630}let Ksrv_5384: bitstring = exp(PartC_5381,Ns_5382) in
                                                        {6631}out(c, senc(mSrv(pkCli_5375,pkSess_5251),Ksrv_5384))
                                                )
                                                else
                                                    {6632}let v_5385: bool = (Disco_4827 = B) in
                                                    (
                                                        {6633}if v_5385 then
                                                        (
                                                            {6634}let pkDisco_5386: bitstring = pub(skB) in
                                                            {6635}in(c, (=pkCli_5375,m1_5387: bitstring,sigM1_5388: bitstring));
                                                            {6636}if (verify(h(m1_5387),sigM1_5388,pkCli_5375) <> true) then
                                                                0
                                                            else
                                                                {6637}let (SPc_5389: bitstring,PartC_5390: bitstring) = m1_5387 in
                                                                {6638}new Ns_5391: bitstring;
                                                                {6639}let m2_5392: bitstring = exp(g,Ns_5391) in
                                                                {6640}out(c, (m2_5392,sign(h(m2_5392),skSess_5250)));
                                                                {6641}let Ksrv_5393: bitstring = exp(PartC_5390,Ns_5391) in
                                                                {6642}out(c, senc(mSrv(pkCli_5375,pkSess_5251),Ksrv_5393))
                                                        )
                                                        else
                                                            {6643}let v_5394: bool = (Disco_4827 = C) in
                                                            (
                                                                {6644}if v_5394 then
                                                                (
                                                                    {6645}let pkDisco_5395: bitstring = pub(skC) in
                                                                    {6646}in(c, (=pkCli_5375,m1_5396: bitstring,sigM1_5397: bitstring));
                                                                    {6647}if (verify(h(m1_5396),sigM1_5397,pkCli_5375) <> true) then
                                                                        0
                                                                    else
                                                                        {6648}let (SPc_5398: bitstring,PartC_5399: bitstring) = m1_5396 in
                                                                        {6649}new Ns_5400: bitstring;
                                                                        {6650}let m2_5401: bitstring = exp(g,Ns_5400) in
                                                                        {6651}out(c, (m2_5401,sign(h(m2_5401),skSess_5250)));
                                                                        {6652}let Ksrv_5402: bitstring = exp(PartC_5399,Ns_5400) in
                                                                        {6653}out(c, senc(mSrv(pkCli_5375,pkSess_5251),Ksrv_5402))
                                                                )
                                                                else
                                                                    {6654}let pkDisco_5403: bitstring = pub(skI) in
                                                                    {6655}in(c, (=pkCli_5375,m1_5404: bitstring,sigM1_5405: bitstring));
                                                                    {6656}if (verify(h(m1_5404),sigM1_5405,pkCli_5375) <> true) then
                                                                        0
                                                                    else
                                                                        {6657}let (SPc_5406: bitstring,PartC_5407: bitstring) = m1_5404 in
                                                                        {6658}new Ns_5408: bitstring;
                                                                        {6659}let m2_5409: bitstring = exp(g,Ns_5408) in
                                                                        {6660}out(c, (m2_5409,sign(h(m2_5409),skSess_5250)));
                                                                        {6661}let Ksrv_5410: bitstring = exp(PartC_5407,Ns_5408) in
                                                                        {6662}out(c, senc(mSrv(pkCli_5375,pkSess_5251),Ksrv_5410))
                                                            )
                                                            else
                                                                {6663}let pkDisco_5411: bitstring = fail-any in
                                                                {6664}in(c, (=pkCli_5375,m1_5412: bitstring,sigM1_5413: bitstring));
                                                                {6665}if (verify(h(m1_5412),sigM1_5413,pkCli_5375) <> true) then
                                                                    0
                                                                else
                                                                    {6666}let (SPc_5414: bitstring,PartC_5415: bitstring) = m1_5412 in
                                                                    {6667}new Ns_5416: bitstring;
                                                                    {6668}let m2_5417: bitstring = exp(g,Ns_5416) in
                                                                    {6669}out(c, (m2_5417,sign(h(m2_5417),skSess_5250)));
                                                                    {6670}let Ksrv_5418: bitstring = exp(PartC_5415,Ns_5416) in
                                                                    {6671}out(c, senc(mSrv(pkCli_5375,pkSess_5251),Ksrv_5418))
                                                    )
                                                    else
                                                        {6672}let pkDisco_5419: bitstring = fail-any in
                                                        {6673}in(c, (=pkCli_5375,m1_5420: bitstring,sigM1_5421: bitstring));
                                                        {6674}if (verify(h(m1_5420),sigM1_5421,pkCli_5375) <> true) then
                                                            0
                                                        else
                                                            {6675}let (SPc_5422: bitstring,PartC_5423: bitstring) = m1_5420 in
                                                            {6676}new Ns_5424: bitstring;
                                                            {6677}let m2_5425: bitstring = exp(g,Ns_5424) in
                                                            {6678}out(c, (m2_5425,sign(h(m2_5425),skSess_5250)));
                                                            {6679}let Ksrv_5426: bitstring = exp(PartC_5423,Ns_5424) in
                                                            {6680}out(c, senc(mSrv(pkCli_5375,pkSess_5251),Ksrv_5426))
                                            )
                                            else
                                                {6681}let pkDisco_5427: bitstring = fail-any in
                                                {6682}in(c, (=pkCli_5375,m1_5428: bitstring,sigM1_5429: bitstring));
                                                {6683}if (verify(h(m1_5428),sigM1_5429,pkCli_5375) <> true) then
                                                    0
                                                else
                                                    {6684}let (SPc_5430: bitstring,PartC_5431: bitstring) = m1_5428 in
                                                    {6685}new Ns_5432: bitstring;
                                                    {6686}let m2_5433: bitstring = exp(g,Ns_5432) in
                                                    {6687}out(c, (m2_5433,sign(h(m2_5433),skSess_5250)));
                                                    {6688}let Ksrv_5434: bitstring = exp(PartC_5431,Ns_5432) in
                                                    {6689}out(c, senc(mSrv(pkCli_5375,pkSess_5251),Ksrv_5434))
                                        )
                                        else
                                            {6690}let pkCli_5435: bitstring = pub(skI) in
                                            {6691}let v_5436: bool = (Disco_4827 = A) in
                                            (
                                                {6692}if v_5436 then
                                                (
                                                    {6693}let pkDisco_5437: bitstring = pub(skA) in
                                                    {6694}in(c, (=pkCli_5435,m1_5438: bitstring,sigM1_5439: bitstring));
                                                    {6695}if (verify(h(m1_5438),sigM1_5439,pkCli_5435) <> true) then
                                                        0
                                                    else
                                                        {6696}let (SPc_5440: bitstring,PartC_5441: bitstring) = m1_5438 in
                                                        {6697}new Ns_5442: bitstring;
                                                        {6698}let m2_5443: bitstring = exp(g,Ns_5442) in
                                                        {6699}out(c, (m2_5443,sign(h(m2_5443),skSess_5250)));
                                                        {6700}let Ksrv_5444: bitstring = exp(PartC_5441,Ns_5442) in
                                                        {6701}out(c, senc(mSrv(pkCli_5435,pkSess_5251),Ksrv_5444))
                                                )
                                                else
                                                    {6702}let v_5445: bool = (Disco_4827 = B) in
                                                    (
                                                        {6703}if v_5445 then
                                                        (
                                                            {6704}let pkDisco_5446: bitstring = pub(skB) in
                                                            {6705}in(c, (=pkCli_5435,m1_5447: bitstring,sigM1_5448: bitstring));
                                                            {6706}if (verify(h(m1_5447),sigM1_5448,pkCli_5435) <> true) then
                                                                0
                                                            else
                                                                {6707}let (SPc_5449: bitstring,PartC_5450: bitstring) = m1_5447 in
                                                                {6708}new Ns_5451: bitstring;
                                                                {6709}let m2_5452: bitstring = exp(g,Ns_5451) in
                                                                {6710}out(c, (m2_5452,sign(h(m2_5452),skSess_5250)));
                                                                {6711}let Ksrv_5453: bitstring = exp(PartC_5450,Ns_5451) in
                                                                {6712}out(c, senc(mSrv(pkCli_5435,pkSess_5251),Ksrv_5453))
                                                        )
                                                        else
                                                            {6713}let v_5454: bool = (Disco_4827 = C) in
                                                            (
                                                                {6714}if v_5454 then
                                                                (
                                                                    {6715}let pkDisco_5455: bitstring = pub(skC) in
                                                                    {6716}in(c, (=pkCli_5435,m1_5456: bitstring,sigM1_5457: bitstring));
                                                                    {6717}if (verify(h(m1_5456),sigM1_5457,pkCli_5435) <> true) then
                                                                        0
                                                                    else
                                                                        {6718}let (SPc_5458: bitstring,PartC_5459: bitstring) = m1_5456 in
                                                                        {6719}new Ns_5460: bitstring;
                                                                        {6720}let m2_5461: bitstring = exp(g,Ns_5460) in
                                                                        {6721}out(c, (m2_5461,sign(h(m2_5461),skSess_5250)));
                                                                        {6722}let Ksrv_5462: bitstring = exp(PartC_5459,Ns_5460) in
                                                                        {6723}out(c, senc(mSrv(pkCli_5435,pkSess_5251),Ksrv_5462))
                                                                )
                                                                else
                                                                    {6724}let pkDisco_5463: bitstring = pub(skI) in
                                                                    {6725}in(c, (=pkCli_5435,m1_5464: bitstring,sigM1_5465: bitstring));
                                                                    {6726}if (verify(h(m1_5464),sigM1_5465,pkCli_5435) <> true) then
                                                                        0
                                                                    else
                                                                        {6727}let (SPc_5466: bitstring,PartC_5467: bitstring) = m1_5464 in
                                                                        {6728}new Ns_5468: bitstring;
                                                                        {6729}let m2_5469: bitstring = exp(g,Ns_5468) in
                                                                        {6730}out(c, (m2_5469,sign(h(m2_5469),skSess_5250)));
                                                                        {6731}let Ksrv_5470: bitstring = exp(PartC_5467,Ns_5468) in
                                                                        {6732}out(c, senc(mSrv(pkCli_5435,pkSess_5251),Ksrv_5470))
                                                            )
                                                            else
                                                                {6733}let pkDisco_5471: bitstring = fail-any in
                                                                {6734}in(c, (=pkCli_5435,m1_5472: bitstring,sigM1_5473: bitstring));
                                                                {6735}if (verify(h(m1_5472),sigM1_5473,pkCli_5435) <> true) then
                                                                    0
                                                                else
                                                                    {6736}let (SPc_5474: bitstring,PartC_5475: bitstring) = m1_5472 in
                                                                    {6737}new Ns_5476: bitstring;
                                                                    {6738}let m2_5477: bitstring = exp(g,Ns_5476) in
                                                                    {6739}out(c, (m2_5477,sign(h(m2_5477),skSess_5250)));
                                                                    {6740}let Ksrv_5478: bitstring = exp(PartC_5475,Ns_5476) in
                                                                    {6741}out(c, senc(mSrv(pkCli_5435,pkSess_5251),Ksrv_5478))
                                                    )
                                                    else
                                                        {6742}let pkDisco_5479: bitstring = fail-any in
                                                        {6743}in(c, (=pkCli_5435,m1_5480: bitstring,sigM1_5481: bitstring));
                                                        {6744}if (verify(h(m1_5480),sigM1_5481,pkCli_5435) <> true) then
                                                            0
                                                        else
                                                            {6745}let (SPc_5482: bitstring,PartC_5483: bitstring) = m1_5480 in
                                                            {6746}new Ns_5484: bitstring;
                                                            {6747}let m2_5485: bitstring = exp(g,Ns_5484) in
                                                            {6748}out(c, (m2_5485,sign(h(m2_5485),skSess_5250)));
                                                            {6749}let Ksrv_5486: bitstring = exp(PartC_5483,Ns_5484) in
                                                            {6750}out(c, senc(mSrv(pkCli_5435,pkSess_5251),Ksrv_5486))
                                            )
                                            else
                                                {6751}let pkDisco_5487: bitstring = fail-any in
                                                {6752}in(c, (=pkCli_5435,m1_5488: bitstring,sigM1_5489: bitstring));
                                                {6753}if (verify(h(m1_5488),sigM1_5489,pkCli_5435) <> true) then
                                                    0
                                                else
                                                    {6754}let (SPc_5490: bitstring,PartC_5491: bitstring) = m1_5488 in
                                                    {6755}new Ns_5492: bitstring;
                                                    {6756}let m2_5493: bitstring = exp(g,Ns_5492) in
                                                    {6757}out(c, (m2_5493,sign(h(m2_5493),skSess_5250)));
                                                    {6758}let Ksrv_5494: bitstring = exp(PartC_5491,Ns_5492) in
                                                    {6759}out(c, senc(mSrv(pkCli_5435,pkSess_5251),Ksrv_5494))
                                    )
                                    else
                                        {6760}let pkCli_5495: bitstring = fail-any in
                                        {6761}let v_5496: bool = (Disco_4827 = A) in
                                        (
                                            {6762}if v_5496 then
                                            (
                                                {6763}let pkDisco_5497: bitstring = pub(skA) in
                                                {6764}in(c, (=pkCli_5495,m1_5498: bitstring,sigM1_5499: bitstring));
                                                {6765}if (verify(h(m1_5498),sigM1_5499,pkCli_5495) <> true) then
                                                    0
                                                else
                                                    {6766}let (SPc_5500: bitstring,PartC_5501: bitstring) = m1_5498 in
                                                    {6767}new Ns_5502: bitstring;
                                                    {6768}let m2_5503: bitstring = exp(g,Ns_5502) in
                                                    {6769}out(c, (m2_5503,sign(h(m2_5503),skSess_5250)));
                                                    {6770}let Ksrv_5504: bitstring = exp(PartC_5501,Ns_5502) in
                                                    {6771}out(c, senc(mSrv(pkCli_5495,pkSess_5251),Ksrv_5504))
                                            )
                                            else
                                                {6772}let v_5505: bool = (Disco_4827 = B) in
                                                (
                                                    {6773}if v_5505 then
                                                    (
                                                        {6774}let pkDisco_5506: bitstring = pub(skB) in
                                                        {6775}in(c, (=pkCli_5495,m1_5507: bitstring,sigM1_5508: bitstring));
                                                        {6776}if (verify(h(m1_5507),sigM1_5508,pkCli_5495) <> true) then
                                                            0
                                                        else
                                                            {6777}let (SPc_5509: bitstring,PartC_5510: bitstring) = m1_5507 in
                                                            {6778}new Ns_5511: bitstring;
                                                            {6779}let m2_5512: bitstring = exp(g,Ns_5511) in
                                                            {6780}out(c, (m2_5512,sign(h(m2_5512),skSess_5250)));
                                                            {6781}let Ksrv_5513: bitstring = exp(PartC_5510,Ns_5511) in
                                                            {6782}out(c, senc(mSrv(pkCli_5495,pkSess_5251),Ksrv_5513))
                                                    )
                                                    else
                                                        {6783}let v_5514: bool = (Disco_4827 = C) in
                                                        (
                                                            {6784}if v_5514 then
                                                            (
                                                                {6785}let pkDisco_5515: bitstring = pub(skC) in
                                                                {6786}in(c, (=pkCli_5495,m1_5516: bitstring,sigM1_5517: bitstring));
                                                                {6787}if (verify(h(m1_5516),sigM1_5517,pkCli_5495) <> true) then
                                                                    0
                                                                else
                                                                    {6788}let (SPc_5518: bitstring,PartC_5519: bitstring) = m1_5516 in
                                                                    {6789}new Ns_5520: bitstring;
                                                                    {6790}let m2_5521: bitstring = exp(g,Ns_5520) in
                                                                    {6791}out(c, (m2_5521,sign(h(m2_5521),skSess_5250)));
                                                                    {6792}let Ksrv_5522: bitstring = exp(PartC_5519,Ns_5520) in
                                                                    {6793}out(c, senc(mSrv(pkCli_5495,pkSess_5251),Ksrv_5522))
                                                            )
                                                            else
                                                                {6794}let pkDisco_5523: bitstring = pub(skI) in
                                                                {6795}in(c, (=pkCli_5495,m1_5524: bitstring,sigM1_5525: bitstring));
                                                                {6796}if (verify(h(m1_5524),sigM1_5525,pkCli_5495) <> true) then
                                                                    0
                                                                else
                                                                    {6797}let (SPc_5526: bitstring,PartC_5527: bitstring) = m1_5524 in
                                                                    {6798}new Ns_5528: bitstring;
                                                                    {6799}let m2_5529: bitstring = exp(g,Ns_5528) in
                                                                    {6800}out(c, (m2_5529,sign(h(m2_5529),skSess_5250)));
                                                                    {6801}let Ksrv_5530: bitstring = exp(PartC_5527,Ns_5528) in
                                                                    {6802}out(c, senc(mSrv(pkCli_5495,pkSess_5251),Ksrv_5530))
                                                        )
                                                        else
                                                            {6803}let pkDisco_5531: bitstring = fail-any in
                                                            {6804}in(c, (=pkCli_5495,m1_5532: bitstring,sigM1_5533: bitstring));
                                                            {6805}if (verify(h(m1_5532),sigM1_5533,pkCli_5495) <> true) then
                                                                0
                                                            else
                                                                {6806}let (SPc_5534: bitstring,PartC_5535: bitstring) = m1_5532 in
                                                                {6807}new Ns_5536: bitstring;
                                                                {6808}let m2_5537: bitstring = exp(g,Ns_5536) in
                                                                {6809}out(c, (m2_5537,sign(h(m2_5537),skSess_5250)));
                                                                {6810}let Ksrv_5538: bitstring = exp(PartC_5535,Ns_5536) in
                                                                {6811}out(c, senc(mSrv(pkCli_5495,pkSess_5251),Ksrv_5538))
                                                )
                                                else
                                                    {6812}let pkDisco_5539: bitstring = fail-any in
                                                    {6813}in(c, (=pkCli_5495,m1_5540: bitstring,sigM1_5541: bitstring));
                                                    {6814}if (verify(h(m1_5540),sigM1_5541,pkCli_5495) <> true) then
                                                        0
                                                    else
                                                        {6815}let (SPc_5542: bitstring,PartC_5543: bitstring) = m1_5540 in
                                                        {6816}new Ns_5544: bitstring;
                                                        {6817}let m2_5545: bitstring = exp(g,Ns_5544) in
                                                        {6818}out(c, (m2_5545,sign(h(m2_5545),skSess_5250)));
                                                        {6819}let Ksrv_5546: bitstring = exp(PartC_5543,Ns_5544) in
                                                        {6820}out(c, senc(mSrv(pkCli_5495,pkSess_5251),Ksrv_5546))
                                        )
                                        else
                                            {6821}let pkDisco_5547: bitstring = fail-any in
                                            {6822}in(c, (=pkCli_5495,m1_5548: bitstring,sigM1_5549: bitstring));
                                            {6823}if (verify(h(m1_5548),sigM1_5549,pkCli_5495) <> true) then
                                                0
                                            else
                                                {6824}let (SPc_5550: bitstring,PartC_5551: bitstring) = m1_5548 in
                                                {6825}new Ns_5552: bitstring;
                                                {6826}let m2_5553: bitstring = exp(g,Ns_5552) in
                                                {6827}out(c, (m2_5553,sign(h(m2_5553),skSess_5250)));
                                                {6828}let Ksrv_5554: bitstring = exp(PartC_5551,Ns_5552) in
                                                {6829}out(c, senc(mSrv(pkCli_5495,pkSess_5251),Ksrv_5554))
                            )
                            else
                                {6830}let pkCli_5555: bitstring = fail-any in
                                {6831}let v_5556: bool = (Disco_4827 = A) in
                                (
                                    {6832}if v_5556 then
                                    (
                                        {6833}let pkDisco_5557: bitstring = pub(skA) in
                                        {6834}in(c, (=pkCli_5555,m1_5558: bitstring,sigM1_5559: bitstring));
                                        {6835}if (verify(h(m1_5558),sigM1_5559,pkCli_5555) <> true) then
                                            0
                                        else
                                            {6836}let (SPc_5560: bitstring,PartC_5561: bitstring) = m1_5558 in
                                            {6837}new Ns_5562: bitstring;
                                            {6838}let m2_5563: bitstring = exp(g,Ns_5562) in
                                            {6839}out(c, (m2_5563,sign(h(m2_5563),skSess_5250)));
                                            {6840}let Ksrv_5564: bitstring = exp(PartC_5561,Ns_5562) in
                                            {6841}out(c, senc(mSrv(pkCli_5555,pkSess_5251),Ksrv_5564))
                                    )
                                    else
                                        {6842}let v_5565: bool = (Disco_4827 = B) in
                                        (
                                            {6843}if v_5565 then
                                            (
                                                {6844}let pkDisco_5566: bitstring = pub(skB) in
                                                {6845}in(c, (=pkCli_5555,m1_5567: bitstring,sigM1_5568: bitstring));
                                                {6846}if (verify(h(m1_5567),sigM1_5568,pkCli_5555) <> true) then
                                                    0
                                                else
                                                    {6847}let (SPc_5569: bitstring,PartC_5570: bitstring) = m1_5567 in
                                                    {6848}new Ns_5571: bitstring;
                                                    {6849}let m2_5572: bitstring = exp(g,Ns_5571) in
                                                    {6850}out(c, (m2_5572,sign(h(m2_5572),skSess_5250)));
                                                    {6851}let Ksrv_5573: bitstring = exp(PartC_5570,Ns_5571) in
                                                    {6852}out(c, senc(mSrv(pkCli_5555,pkSess_5251),Ksrv_5573))
                                            )
                                            else
                                                {6853}let v_5574: bool = (Disco_4827 = C) in
                                                (
                                                    {6854}if v_5574 then
                                                    (
                                                        {6855}let pkDisco_5575: bitstring = pub(skC) in
                                                        {6856}in(c, (=pkCli_5555,m1_5576: bitstring,sigM1_5577: bitstring));
                                                        {6857}if (verify(h(m1_5576),sigM1_5577,pkCli_5555) <> true) then
                                                            0
                                                        else
                                                            {6858}let (SPc_5578: bitstring,PartC_5579: bitstring) = m1_5576 in
                                                            {6859}new Ns_5580: bitstring;
                                                            {6860}let m2_5581: bitstring = exp(g,Ns_5580) in
                                                            {6861}out(c, (m2_5581,sign(h(m2_5581),skSess_5250)));
                                                            {6862}let Ksrv_5582: bitstring = exp(PartC_5579,Ns_5580) in
                                                            {6863}out(c, senc(mSrv(pkCli_5555,pkSess_5251),Ksrv_5582))
                                                    )
                                                    else
                                                        {6864}let pkDisco_5583: bitstring = pub(skI) in
                                                        {6865}in(c, (=pkCli_5555,m1_5584: bitstring,sigM1_5585: bitstring));
                                                        {6866}if (verify(h(m1_5584),sigM1_5585,pkCli_5555) <> true) then
                                                            0
                                                        else
                                                            {6867}let (SPc_5586: bitstring,PartC_5587: bitstring) = m1_5584 in
                                                            {6868}new Ns_5588: bitstring;
                                                            {6869}let m2_5589: bitstring = exp(g,Ns_5588) in
                                                            {6870}out(c, (m2_5589,sign(h(m2_5589),skSess_5250)));
                                                            {6871}let Ksrv_5590: bitstring = exp(PartC_5587,Ns_5588) in
                                                            {6872}out(c, senc(mSrv(pkCli_5555,pkSess_5251),Ksrv_5590))
                                                )
                                                else
                                                    {6873}let pkDisco_5591: bitstring = fail-any in
                                                    {6874}in(c, (=pkCli_5555,m1_5592: bitstring,sigM1_5593: bitstring));
                                                    {6875}if (verify(h(m1_5592),sigM1_5593,pkCli_5555) <> true) then
                                                        0
                                                    else
                                                        {6876}let (SPc_5594: bitstring,PartC_5595: bitstring) = m1_5592 in
                                                        {6877}new Ns_5596: bitstring;
                                                        {6878}let m2_5597: bitstring = exp(g,Ns_5596) in
                                                        {6879}out(c, (m2_5597,sign(h(m2_5597),skSess_5250)));
                                                        {6880}let Ksrv_5598: bitstring = exp(PartC_5595,Ns_5596) in
                                                        {6881}out(c, senc(mSrv(pkCli_5555,pkSess_5251),Ksrv_5598))
                                        )
                                        else
                                            {6882}let pkDisco_5599: bitstring = fail-any in
                                            {6883}in(c, (=pkCli_5555,m1_5600: bitstring,sigM1_5601: bitstring));
                                            {6884}if (verify(h(m1_5600),sigM1_5601,pkCli_5555) <> true) then
                                                0
                                            else
                                                {6885}let (SPc_5602: bitstring,PartC_5603: bitstring) = m1_5600 in
                                                {6886}new Ns_5604: bitstring;
                                                {6887}let m2_5605: bitstring = exp(g,Ns_5604) in
                                                {6888}out(c, (m2_5605,sign(h(m2_5605),skSess_5250)));
                                                {6889}let Ksrv_5606: bitstring = exp(PartC_5603,Ns_5604) in
                                                {6890}out(c, senc(mSrv(pkCli_5555,pkSess_5251),Ksrv_5606))
                                )
                                else
                                    {6891}let pkDisco_5607: bitstring = fail-any in
                                    {6892}in(c, (=pkCli_5555,m1_5608: bitstring,sigM1_5609: bitstring));
                                    {6893}if (verify(h(m1_5608),sigM1_5609,pkCli_5555) <> true) then
                                        0
                                    else
                                        {6894}let (SPc_5610: bitstring,PartC_5611: bitstring) = m1_5608 in
                                        {6895}new Ns_5612: bitstring;
                                        {6896}let m2_5613: bitstring = exp(g,Ns_5612) in
                                        {6897}out(c, (m2_5613,sign(h(m2_5613),skSess_5250)));
                                        {6898}let Ksrv_5614: bitstring = exp(PartC_5611,Ns_5612) in
                                        {6899}out(c, senc(mSrv(pkCli_5555,pkSess_5251),Ksrv_5614))
                    )
                    else
                        {6900}let pkCli_5615: bitstring = fail-any in
                        {6901}let v_5616: bool = (Disco_4827 = A) in
                        (
                            {6902}if v_5616 then
                            (
                                {6903}let pkDisco_5617: bitstring = pub(skA) in
                                {6904}in(c, (=pkCli_5615,m1_5618: bitstring,sigM1_5619: bitstring));
                                {6905}if (verify(h(m1_5618),sigM1_5619,pkCli_5615) <> true) then
                                    0
                                else
                                    {6906}let (SPc_5620: bitstring,PartC_5621: bitstring) = m1_5618 in
                                    {6907}new Ns_5622: bitstring;
                                    {6908}let m2_5623: bitstring = exp(g,Ns_5622) in
                                    {6909}out(c, (m2_5623,sign(h(m2_5623),skSess_5250)));
                                    {6910}let Ksrv_5624: bitstring = exp(PartC_5621,Ns_5622) in
                                    {6911}out(c, senc(mSrv(pkCli_5615,pkSess_5251),Ksrv_5624))
                            )
                            else
                                {6912}let v_5625: bool = (Disco_4827 = B) in
                                (
                                    {6913}if v_5625 then
                                    (
                                        {6914}let pkDisco_5626: bitstring = pub(skB) in
                                        {6915}in(c, (=pkCli_5615,m1_5627: bitstring,sigM1_5628: bitstring));
                                        {6916}if (verify(h(m1_5627),sigM1_5628,pkCli_5615) <> true) then
                                            0
                                        else
                                            {6917}let (SPc_5629: bitstring,PartC_5630: bitstring) = m1_5627 in
                                            {6918}new Ns_5631: bitstring;
                                            {6919}let m2_5632: bitstring = exp(g,Ns_5631) in
                                            {6920}out(c, (m2_5632,sign(h(m2_5632),skSess_5250)));
                                            {6921}let Ksrv_5633: bitstring = exp(PartC_5630,Ns_5631) in
                                            {6922}out(c, senc(mSrv(pkCli_5615,pkSess_5251),Ksrv_5633))
                                    )
                                    else
                                        {6923}let v_5634: bool = (Disco_4827 = C) in
                                        (
                                            {6924}if v_5634 then
                                            (
                                                {6925}let pkDisco_5635: bitstring = pub(skC) in
                                                {6926}in(c, (=pkCli_5615,m1_5636: bitstring,sigM1_5637: bitstring));
                                                {6927}if (verify(h(m1_5636),sigM1_5637,pkCli_5615) <> true) then
                                                    0
                                                else
                                                    {6928}let (SPc_5638: bitstring,PartC_5639: bitstring) = m1_5636 in
                                                    {6929}new Ns_5640: bitstring;
                                                    {6930}let m2_5641: bitstring = exp(g,Ns_5640) in
                                                    {6931}out(c, (m2_5641,sign(h(m2_5641),skSess_5250)));
                                                    {6932}let Ksrv_5642: bitstring = exp(PartC_5639,Ns_5640) in
                                                    {6933}out(c, senc(mSrv(pkCli_5615,pkSess_5251),Ksrv_5642))
                                            )
                                            else
                                                {6934}let pkDisco_5643: bitstring = pub(skI) in
                                                {6935}in(c, (=pkCli_5615,m1_5644: bitstring,sigM1_5645: bitstring));
                                                {6936}if (verify(h(m1_5644),sigM1_5645,pkCli_5615) <> true) then
                                                    0
                                                else
                                                    {6937}let (SPc_5646: bitstring,PartC_5647: bitstring) = m1_5644 in
                                                    {6938}new Ns_5648: bitstring;
                                                    {6939}let m2_5649: bitstring = exp(g,Ns_5648) in
                                                    {6940}out(c, (m2_5649,sign(h(m2_5649),skSess_5250)));
                                                    {6941}let Ksrv_5650: bitstring = exp(PartC_5647,Ns_5648) in
                                                    {6942}out(c, senc(mSrv(pkCli_5615,pkSess_5251),Ksrv_5650))
                                        )
                                        else
                                            {6943}let pkDisco_5651: bitstring = fail-any in
                                            {6944}in(c, (=pkCli_5615,m1_5652: bitstring,sigM1_5653: bitstring));
                                            {6945}if (verify(h(m1_5652),sigM1_5653,pkCli_5615) <> true) then
                                                0
                                            else
                                                {6946}let (SPc_5654: bitstring,PartC_5655: bitstring) = m1_5652 in
                                                {6947}new Ns_5656: bitstring;
                                                {6948}let m2_5657: bitstring = exp(g,Ns_5656) in
                                                {6949}out(c, (m2_5657,sign(h(m2_5657),skSess_5250)));
                                                {6950}let Ksrv_5658: bitstring = exp(PartC_5655,Ns_5656) in
                                                {6951}out(c, senc(mSrv(pkCli_5615,pkSess_5251),Ksrv_5658))
                                )
                                else
                                    {6952}let pkDisco_5659: bitstring = fail-any in
                                    {6953}in(c, (=pkCli_5615,m1_5660: bitstring,sigM1_5661: bitstring));
                                    {6954}if (verify(h(m1_5660),sigM1_5661,pkCli_5615) <> true) then
                                        0
                                    else
                                        {6955}let (SPc_5662: bitstring,PartC_5663: bitstring) = m1_5660 in
                                        {6956}new Ns_5664: bitstring;
                                        {6957}let m2_5665: bitstring = exp(g,Ns_5664) in
                                        {6958}out(c, (m2_5665,sign(h(m2_5665),skSess_5250)));
                                        {6959}let Ksrv_5666: bitstring = exp(PartC_5663,Ns_5664) in
                                        {6960}out(c, senc(mSrv(pkCli_5615,pkSess_5251),Ksrv_5666))
                        )
                        else
                            {6961}let pkDisco_5667: bitstring = fail-any in
                            {6962}in(c, (=pkCli_5615,m1_5668: bitstring,sigM1_5669: bitstring));
                            {6963}if (verify(h(m1_5668),sigM1_5669,pkCli_5615) <> true) then
                                0
                            else
                                {6964}let (SPc_5670: bitstring,PartC_5671: bitstring) = m1_5668 in
                                {6965}new Ns_5672: bitstring;
                                {6966}let m2_5673: bitstring = exp(g,Ns_5672) in
                                {6967}out(c, (m2_5673,sign(h(m2_5673),skSess_5250)));
                                {6968}let Ksrv_5674: bitstring = exp(PartC_5671,Ns_5672) in
                                {6969}out(c, senc(mSrv(pkCli_5615,pkSess_5251),Ksrv_5674))
                )
                else
                    {6970}let v_5675: bool = (Sess_4828 = C) in
                    (
                        {6971}if v_5675 then
                        (
                            {6972}let skSess_5676: bitstring = skC in
                            {6973}let pkSess_5677: bitstring = pub(skSess_5676) in
                            {6974}let v_5678: bool = (Cli_4826 = A) in
                            (
                                {6975}if v_5678 then
                                (
                                    {6976}let pkCli_5679: bitstring = pub(skA) in
                                    {6977}let v_5680: bool = (Disco_4827 = A) in
                                    (
                                        {6978}if v_5680 then
                                        (
                                            {6979}let pkDisco_5681: bitstring = pub(skA) in
                                            {6980}in(c, (=pkCli_5679,m1_5682: bitstring,sigM1_5683: bitstring));
                                            {6981}if (verify(h(m1_5682),sigM1_5683,pkCli_5679) <> true) then
                                                0
                                            else
                                                {6982}let (SPc_5684: bitstring,PartC_5685: bitstring) = m1_5682 in
                                                {6983}new Ns_5686: bitstring;
                                                {6984}let m2_5687: bitstring = exp(g,Ns_5686) in
                                                {6985}out(c, (m2_5687,sign(h(m2_5687),skSess_5676)));
                                                {6986}let Ksrv_5688: bitstring = exp(PartC_5685,Ns_5686) in
                                                {6987}out(c, senc(mSrv(pkCli_5679,pkSess_5677),Ksrv_5688))
                                        )
                                        else
                                            {6988}let v_5689: bool = (Disco_4827 = B) in
                                            (
                                                {6989}if v_5689 then
                                                (
                                                    {6990}let pkDisco_5690: bitstring = pub(skB) in
                                                    {6991}in(c, (=pkCli_5679,m1_5691: bitstring,sigM1_5692: bitstring));
                                                    {6992}if (verify(h(m1_5691),sigM1_5692,pkCli_5679) <> true) then
                                                        0
                                                    else
                                                        {6993}let (SPc_5693: bitstring,PartC_5694: bitstring) = m1_5691 in
                                                        {6994}new Ns_5695: bitstring;
                                                        {6995}let m2_5696: bitstring = exp(g,Ns_5695) in
                                                        {6996}out(c, (m2_5696,sign(h(m2_5696),skSess_5676)));
                                                        {6997}let Ksrv_5697: bitstring = exp(PartC_5694,Ns_5695) in
                                                        {6998}out(c, senc(mSrv(pkCli_5679,pkSess_5677),Ksrv_5697))
                                                )
                                                else
                                                    {6999}let v_5698: bool = (Disco_4827 = C) in
                                                    (
                                                        {7000}if v_5698 then
                                                        (
                                                            {7001}let pkDisco_5699: bitstring = pub(skC) in
                                                            {7002}in(c, (=pkCli_5679,m1_5700: bitstring,sigM1_5701: bitstring));
                                                            {7003}if (verify(h(m1_5700),sigM1_5701,pkCli_5679) <> true) then
                                                                0
                                                            else
                                                                {7004}let (SPc_5702: bitstring,PartC_5703: bitstring) = m1_5700 in
                                                                {7005}new Ns_5704: bitstring;
                                                                {7006}let m2_5705: bitstring = exp(g,Ns_5704) in
                                                                {7007}out(c, (m2_5705,sign(h(m2_5705),skSess_5676)));
                                                                {7008}let Ksrv_5706: bitstring = exp(PartC_5703,Ns_5704) in
                                                                {7009}out(c, senc(mSrv(pkCli_5679,pkSess_5677),Ksrv_5706))
                                                        )
                                                        else
                                                            {7010}let pkDisco_5707: bitstring = pub(skI) in
                                                            {7011}in(c, (=pkCli_5679,m1_5708: bitstring,sigM1_5709: bitstring));
                                                            {7012}if (verify(h(m1_5708),sigM1_5709,pkCli_5679) <> true) then
                                                                0
                                                            else
                                                                {7013}let (SPc_5710: bitstring,PartC_5711: bitstring) = m1_5708 in
                                                                {7014}new Ns_5712: bitstring;
                                                                {7015}let m2_5713: bitstring = exp(g,Ns_5712) in
                                                                {7016}out(c, (m2_5713,sign(h(m2_5713),skSess_5676)));
                                                                {7017}let Ksrv_5714: bitstring = exp(PartC_5711,Ns_5712) in
                                                                {7018}out(c, senc(mSrv(pkCli_5679,pkSess_5677),Ksrv_5714))
                                                    )
                                                    else
                                                        {7019}let pkDisco_5715: bitstring = fail-any in
                                                        {7020}in(c, (=pkCli_5679,m1_5716: bitstring,sigM1_5717: bitstring));
                                                        {7021}if (verify(h(m1_5716),sigM1_5717,pkCli_5679) <> true) then
                                                            0
                                                        else
                                                            {7022}let (SPc_5718: bitstring,PartC_5719: bitstring) = m1_5716 in
                                                            {7023}new Ns_5720: bitstring;
                                                            {7024}let m2_5721: bitstring = exp(g,Ns_5720) in
                                                            {7025}out(c, (m2_5721,sign(h(m2_5721),skSess_5676)));
                                                            {7026}let Ksrv_5722: bitstring = exp(PartC_5719,Ns_5720) in
                                                            {7027}out(c, senc(mSrv(pkCli_5679,pkSess_5677),Ksrv_5722))
                                            )
                                            else
                                                {7028}let pkDisco_5723: bitstring = fail-any in
                                                {7029}in(c, (=pkCli_5679,m1_5724: bitstring,sigM1_5725: bitstring));
                                                {7030}if (verify(h(m1_5724),sigM1_5725,pkCli_5679) <> true) then
                                                    0
                                                else
                                                    {7031}let (SPc_5726: bitstring,PartC_5727: bitstring) = m1_5724 in
                                                    {7032}new Ns_5728: bitstring;
                                                    {7033}let m2_5729: bitstring = exp(g,Ns_5728) in
                                                    {7034}out(c, (m2_5729,sign(h(m2_5729),skSess_5676)));
                                                    {7035}let Ksrv_5730: bitstring = exp(PartC_5727,Ns_5728) in
                                                    {7036}out(c, senc(mSrv(pkCli_5679,pkSess_5677),Ksrv_5730))
                                    )
                                    else
                                        {7037}let pkDisco_5731: bitstring = fail-any in
                                        {7038}in(c, (=pkCli_5679,m1_5732: bitstring,sigM1_5733: bitstring));
                                        {7039}if (verify(h(m1_5732),sigM1_5733,pkCli_5679) <> true) then
                                            0
                                        else
                                            {7040}let (SPc_5734: bitstring,PartC_5735: bitstring) = m1_5732 in
                                            {7041}new Ns_5736: bitstring;
                                            {7042}let m2_5737: bitstring = exp(g,Ns_5736) in
                                            {7043}out(c, (m2_5737,sign(h(m2_5737),skSess_5676)));
                                            {7044}let Ksrv_5738: bitstring = exp(PartC_5735,Ns_5736) in
                                            {7045}out(c, senc(mSrv(pkCli_5679,pkSess_5677),Ksrv_5738))
                                )
                                else
                                    {7046}let v_5739: bool = (Cli_4826 = B) in
                                    (
                                        {7047}if v_5739 then
                                        (
                                            {7048}let pkCli_5740: bitstring = pub(skB) in
                                            {7049}let v_5741: bool = (Disco_4827 = A) in
                                            (
                                                {7050}if v_5741 then
                                                (
                                                    {7051}let pkDisco_5742: bitstring = pub(skA) in
                                                    {7052}in(c, (=pkCli_5740,m1_5743: bitstring,sigM1_5744: bitstring));
                                                    {7053}if (verify(h(m1_5743),sigM1_5744,pkCli_5740) <> true) then
                                                        0
                                                    else
                                                        {7054}let (SPc_5745: bitstring,PartC_5746: bitstring) = m1_5743 in
                                                        {7055}new Ns_5747: bitstring;
                                                        {7056}let m2_5748: bitstring = exp(g,Ns_5747) in
                                                        {7057}out(c, (m2_5748,sign(h(m2_5748),skSess_5676)));
                                                        {7058}let Ksrv_5749: bitstring = exp(PartC_5746,Ns_5747) in
                                                        {7059}out(c, senc(mSrv(pkCli_5740,pkSess_5677),Ksrv_5749))
                                                )
                                                else
                                                    {7060}let v_5750: bool = (Disco_4827 = B) in
                                                    (
                                                        {7061}if v_5750 then
                                                        (
                                                            {7062}let pkDisco_5751: bitstring = pub(skB) in
                                                            {7063}in(c, (=pkCli_5740,m1_5752: bitstring,sigM1_5753: bitstring));
                                                            {7064}if (verify(h(m1_5752),sigM1_5753,pkCli_5740) <> true) then
                                                                0
                                                            else
                                                                {7065}let (SPc_5754: bitstring,PartC_5755: bitstring) = m1_5752 in
                                                                {7066}new Ns_5756: bitstring;
                                                                {7067}let m2_5757: bitstring = exp(g,Ns_5756) in
                                                                {7068}out(c, (m2_5757,sign(h(m2_5757),skSess_5676)));
                                                                {7069}let Ksrv_5758: bitstring = exp(PartC_5755,Ns_5756) in
                                                                {7070}out(c, senc(mSrv(pkCli_5740,pkSess_5677),Ksrv_5758))
                                                        )
                                                        else
                                                            {7071}let v_5759: bool = (Disco_4827 = C) in
                                                            (
                                                                {7072}if v_5759 then
                                                                (
                                                                    {7073}let pkDisco_5760: bitstring = pub(skC) in
                                                                    {7074}in(c, (=pkCli_5740,m1_5761: bitstring,sigM1_5762: bitstring));
                                                                    {7075}if (verify(h(m1_5761),sigM1_5762,pkCli_5740) <> true) then
                                                                        0
                                                                    else
                                                                        {7076}let (SPc_5763: bitstring,PartC_5764: bitstring) = m1_5761 in
                                                                        {7077}new Ns_5765: bitstring;
                                                                        {7078}let m2_5766: bitstring = exp(g,Ns_5765) in
                                                                        {7079}out(c, (m2_5766,sign(h(m2_5766),skSess_5676)));
                                                                        {7080}let Ksrv_5767: bitstring = exp(PartC_5764,Ns_5765) in
                                                                        {7081}out(c, senc(mSrv(pkCli_5740,pkSess_5677),Ksrv_5767))
                                                                )
                                                                else
                                                                    {7082}let pkDisco_5768: bitstring = pub(skI) in
                                                                    {7083}in(c, (=pkCli_5740,m1_5769: bitstring,sigM1_5770: bitstring));
                                                                    {7084}if (verify(h(m1_5769),sigM1_5770,pkCli_5740) <> true) then
                                                                        0
                                                                    else
                                                                        {7085}let (SPc_5771: bitstring,PartC_5772: bitstring) = m1_5769 in
                                                                        {7086}new Ns_5773: bitstring;
                                                                        {7087}let m2_5774: bitstring = exp(g,Ns_5773) in
                                                                        {7088}out(c, (m2_5774,sign(h(m2_5774),skSess_5676)));
                                                                        {7089}let Ksrv_5775: bitstring = exp(PartC_5772,Ns_5773) in
                                                                        {7090}out(c, senc(mSrv(pkCli_5740,pkSess_5677),Ksrv_5775))
                                                            )
                                                            else
                                                                {7091}let pkDisco_5776: bitstring = fail-any in
                                                                {7092}in(c, (=pkCli_5740,m1_5777: bitstring,sigM1_5778: bitstring));
                                                                {7093}if (verify(h(m1_5777),sigM1_5778,pkCli_5740) <> true) then
                                                                    0
                                                                else
                                                                    {7094}let (SPc_5779: bitstring,PartC_5780: bitstring) = m1_5777 in
                                                                    {7095}new Ns_5781: bitstring;
                                                                    {7096}let m2_5782: bitstring = exp(g,Ns_5781) in
                                                                    {7097}out(c, (m2_5782,sign(h(m2_5782),skSess_5676)));
                                                                    {7098}let Ksrv_5783: bitstring = exp(PartC_5780,Ns_5781) in
                                                                    {7099}out(c, senc(mSrv(pkCli_5740,pkSess_5677),Ksrv_5783))
                                                    )
                                                    else
                                                        {7100}let pkDisco_5784: bitstring = fail-any in
                                                        {7101}in(c, (=pkCli_5740,m1_5785: bitstring,sigM1_5786: bitstring));
                                                        {7102}if (verify(h(m1_5785),sigM1_5786,pkCli_5740) <> true) then
                                                            0
                                                        else
                                                            {7103}let (SPc_5787: bitstring,PartC_5788: bitstring) = m1_5785 in
                                                            {7104}new Ns_5789: bitstring;
                                                            {7105}let m2_5790: bitstring = exp(g,Ns_5789) in
                                                            {7106}out(c, (m2_5790,sign(h(m2_5790),skSess_5676)));
                                                            {7107}let Ksrv_5791: bitstring = exp(PartC_5788,Ns_5789) in
                                                            {7108}out(c, senc(mSrv(pkCli_5740,pkSess_5677),Ksrv_5791))
                                            )
                                            else
                                                {7109}let pkDisco_5792: bitstring = fail-any in
                                                {7110}in(c, (=pkCli_5740,m1_5793: bitstring,sigM1_5794: bitstring));
                                                {7111}if (verify(h(m1_5793),sigM1_5794,pkCli_5740) <> true) then
                                                    0
                                                else
                                                    {7112}let (SPc_5795: bitstring,PartC_5796: bitstring) = m1_5793 in
                                                    {7113}new Ns_5797: bitstring;
                                                    {7114}let m2_5798: bitstring = exp(g,Ns_5797) in
                                                    {7115}out(c, (m2_5798,sign(h(m2_5798),skSess_5676)));
                                                    {7116}let Ksrv_5799: bitstring = exp(PartC_5796,Ns_5797) in
                                                    {7117}out(c, senc(mSrv(pkCli_5740,pkSess_5677),Ksrv_5799))
                                        )
                                        else
                                            {7118}let v_5800: bool = (Cli_4826 = C) in
                                            (
                                                {7119}if v_5800 then
                                                (
                                                    {7120}let pkCli_5801: bitstring = pub(skC) in
                                                    {7121}let v_5802: bool = (Disco_4827 = A) in
                                                    (
                                                        {7122}if v_5802 then
                                                        (
                                                            {7123}let pkDisco_5803: bitstring = pub(skA) in
                                                            {7124}in(c, (=pkCli_5801,m1_5804: bitstring,sigM1_5805: bitstring));
                                                            {7125}if (verify(h(m1_5804),sigM1_5805,pkCli_5801) <> true) then
                                                                0
                                                            else
                                                                {7126}let (SPc_5806: bitstring,PartC_5807: bitstring) = m1_5804 in
                                                                {7127}new Ns_5808: bitstring;
                                                                {7128}let m2_5809: bitstring = exp(g,Ns_5808) in
                                                                {7129}out(c, (m2_5809,sign(h(m2_5809),skSess_5676)));
                                                                {7130}let Ksrv_5810: bitstring = exp(PartC_5807,Ns_5808) in
                                                                {7131}out(c, senc(mSrv(pkCli_5801,pkSess_5677),Ksrv_5810))
                                                        )
                                                        else
                                                            {7132}let v_5811: bool = (Disco_4827 = B) in
                                                            (
                                                                {7133}if v_5811 then
                                                                (
                                                                    {7134}let pkDisco_5812: bitstring = pub(skB) in
                                                                    {7135}in(c, (=pkCli_5801,m1_5813: bitstring,sigM1_5814: bitstring));
                                                                    {7136}if (verify(h(m1_5813),sigM1_5814,pkCli_5801) <> true) then
                                                                        0
                                                                    else
                                                                        {7137}let (SPc_5815: bitstring,PartC_5816: bitstring) = m1_5813 in
                                                                        {7138}new Ns_5817: bitstring;
                                                                        {7139}let m2_5818: bitstring = exp(g,Ns_5817) in
                                                                        {7140}out(c, (m2_5818,sign(h(m2_5818),skSess_5676)));
                                                                        {7141}let Ksrv_5819: bitstring = exp(PartC_5816,Ns_5817) in
                                                                        {7142}out(c, senc(mSrv(pkCli_5801,pkSess_5677),Ksrv_5819))
                                                                )
                                                                else
                                                                    {7143}let v_5820: bool = (Disco_4827 = C) in
                                                                    (
                                                                        {7144}if v_5820 then
                                                                        (
                                                                            {7145}let pkDisco_5821: bitstring = pub(skC) in
                                                                            {7146}in(c, (=pkCli_5801,m1_5822: bitstring,sigM1_5823: bitstring));
                                                                            {7147}if (verify(h(m1_5822),sigM1_5823,pkCli_5801) <> true) then
                                                                                0
                                                                            else
                                                                                {7148}let (SPc_5824: bitstring,PartC_5825: bitstring) = m1_5822 in
                                                                                {7149}new Ns_5826: bitstring;
                                                                                {7150}let m2_5827: bitstring = exp(g,Ns_5826) in
                                                                                {7151}out(c, (m2_5827,sign(h(m2_5827),skSess_5676)));
                                                                                {7152}let Ksrv_5828: bitstring = exp(PartC_5825,Ns_5826) in
                                                                                {7153}out(c, senc(mSrv(pkCli_5801,pkSess_5677),Ksrv_5828))
                                                                        )
                                                                        else
                                                                            {7154}let pkDisco_5829: bitstring = pub(skI) in
                                                                            {7155}in(c, (=pkCli_5801,m1_5830: bitstring,sigM1_5831: bitstring));
                                                                            {7156}if (verify(h(m1_5830),sigM1_5831,pkCli_5801) <> true) then
                                                                                0
                                                                            else
                                                                                {7157}let (SPc_5832: bitstring,PartC_5833: bitstring) = m1_5830 in
                                                                                {7158}new Ns_5834: bitstring;
                                                                                {7159}let m2_5835: bitstring = exp(g,Ns_5834) in
                                                                                {7160}out(c, (m2_5835,sign(h(m2_5835),skSess_5676)));
                                                                                {7161}let Ksrv_5836: bitstring = exp(PartC_5833,Ns_5834) in
                                                                                {7162}out(c, senc(mSrv(pkCli_5801,pkSess_5677),Ksrv_5836))
                                                                    )
                                                                    else
                                                                        {7163}let pkDisco_5837: bitstring = fail-any in
                                                                        {7164}in(c, (=pkCli_5801,m1_5838: bitstring,sigM1_5839: bitstring));
                                                                        {7165}if (verify(h(m1_5838),sigM1_5839,pkCli_5801) <> true) then
                                                                            0
                                                                        else
                                                                            {7166}let (SPc_5840: bitstring,PartC_5841: bitstring) = m1_5838 in
                                                                            {7167}new Ns_5842: bitstring;
                                                                            {7168}let m2_5843: bitstring = exp(g,Ns_5842) in
                                                                            {7169}out(c, (m2_5843,sign(h(m2_5843),skSess_5676)));
                                                                            {7170}let Ksrv_5844: bitstring = exp(PartC_5841,Ns_5842) in
                                                                            {7171}out(c, senc(mSrv(pkCli_5801,pkSess_5677),Ksrv_5844))
                                                            )
                                                            else
                                                                {7172}let pkDisco_5845: bitstring = fail-any in
                                                                {7173}in(c, (=pkCli_5801,m1_5846: bitstring,sigM1_5847: bitstring));
                                                                {7174}if (verify(h(m1_5846),sigM1_5847,pkCli_5801) <> true) then
                                                                    0
                                                                else
                                                                    {7175}let (SPc_5848: bitstring,PartC_5849: bitstring) = m1_5846 in
                                                                    {7176}new Ns_5850: bitstring;
                                                                    {7177}let m2_5851: bitstring = exp(g,Ns_5850) in
                                                                    {7178}out(c, (m2_5851,sign(h(m2_5851),skSess_5676)));
                                                                    {7179}let Ksrv_5852: bitstring = exp(PartC_5849,Ns_5850) in
                                                                    {7180}out(c, senc(mSrv(pkCli_5801,pkSess_5677),Ksrv_5852))
                                                    )
                                                    else
                                                        {7181}let pkDisco_5853: bitstring = fail-any in
                                                        {7182}in(c, (=pkCli_5801,m1_5854: bitstring,sigM1_5855: bitstring));
                                                        {7183}if (verify(h(m1_5854),sigM1_5855,pkCli_5801) <> true) then
                                                            0
                                                        else
                                                            {7184}let (SPc_5856: bitstring,PartC_5857: bitstring) = m1_5854 in
                                                            {7185}new Ns_5858: bitstring;
                                                            {7186}let m2_5859: bitstring = exp(g,Ns_5858) in
                                                            {7187}out(c, (m2_5859,sign(h(m2_5859),skSess_5676)));
                                                            {7188}let Ksrv_5860: bitstring = exp(PartC_5857,Ns_5858) in
                                                            {7189}out(c, senc(mSrv(pkCli_5801,pkSess_5677),Ksrv_5860))
                                                )
                                                else
                                                    {7190}let pkCli_5861: bitstring = pub(skI) in
                                                    {7191}let v_5862: bool = (Disco_4827 = A) in
                                                    (
                                                        {7192}if v_5862 then
                                                        (
                                                            {7193}let pkDisco_5863: bitstring = pub(skA) in
                                                            {7194}in(c, (=pkCli_5861,m1_5864: bitstring,sigM1_5865: bitstring));
                                                            {7195}if (verify(h(m1_5864),sigM1_5865,pkCli_5861) <> true) then
                                                                0
                                                            else
                                                                {7196}let (SPc_5866: bitstring,PartC_5867: bitstring) = m1_5864 in
                                                                {7197}new Ns_5868: bitstring;
                                                                {7198}let m2_5869: bitstring = exp(g,Ns_5868) in
                                                                {7199}out(c, (m2_5869,sign(h(m2_5869),skSess_5676)));
                                                                {7200}let Ksrv_5870: bitstring = exp(PartC_5867,Ns_5868) in
                                                                {7201}out(c, senc(mSrv(pkCli_5861,pkSess_5677),Ksrv_5870))
                                                        )
                                                        else
                                                            {7202}let v_5871: bool = (Disco_4827 = B) in
                                                            (
                                                                {7203}if v_5871 then
                                                                (
                                                                    {7204}let pkDisco_5872: bitstring = pub(skB) in
                                                                    {7205}in(c, (=pkCli_5861,m1_5873: bitstring,sigM1_5874: bitstring));
                                                                    {7206}if (verify(h(m1_5873),sigM1_5874,pkCli_5861) <> true) then
                                                                        0
                                                                    else
                                                                        {7207}let (SPc_5875: bitstring,PartC_5876: bitstring) = m1_5873 in
                                                                        {7208}new Ns_5877: bitstring;
                                                                        {7209}let m2_5878: bitstring = exp(g,Ns_5877) in
                                                                        {7210}out(c, (m2_5878,sign(h(m2_5878),skSess_5676)));
                                                                        {7211}let Ksrv_5879: bitstring = exp(PartC_5876,Ns_5877) in
                                                                        {7212}out(c, senc(mSrv(pkCli_5861,pkSess_5677),Ksrv_5879))
                                                                )
                                                                else
                                                                    {7213}let v_5880: bool = (Disco_4827 = C) in
                                                                    (
                                                                        {7214}if v_5880 then
                                                                        (
                                                                            {7215}let pkDisco_5881: bitstring = pub(skC) in
                                                                            {7216}in(c, (=pkCli_5861,m1_5882: bitstring,sigM1_5883: bitstring));
                                                                            {7217}if (verify(h(m1_5882),sigM1_5883,pkCli_5861) <> true) then
                                                                                0
                                                                            else
                                                                                {7218}let (SPc_5884: bitstring,PartC_5885: bitstring) = m1_5882 in
                                                                                {7219}new Ns_5886: bitstring;
                                                                                {7220}let m2_5887: bitstring = exp(g,Ns_5886) in
                                                                                {7221}out(c, (m2_5887,sign(h(m2_5887),skSess_5676)));
                                                                                {7222}let Ksrv_5888: bitstring = exp(PartC_5885,Ns_5886) in
                                                                                {7223}out(c, senc(mSrv(pkCli_5861,pkSess_5677),Ksrv_5888))
                                                                        )
                                                                        else
                                                                            {7224}let pkDisco_5889: bitstring = pub(skI) in
                                                                            {7225}in(c, (=pkCli_5861,m1_5890: bitstring,sigM1_5891: bitstring));
                                                                            {7226}if (verify(h(m1_5890),sigM1_5891,pkCli_5861) <> true) then
                                                                                0
                                                                            else
                                                                                {7227}let (SPc_5892: bitstring,PartC_5893: bitstring) = m1_5890 in
                                                                                {7228}new Ns_5894: bitstring;
                                                                                {7229}let m2_5895: bitstring = exp(g,Ns_5894) in
                                                                                {7230}out(c, (m2_5895,sign(h(m2_5895),skSess_5676)));
                                                                                {7231}let Ksrv_5896: bitstring = exp(PartC_5893,Ns_5894) in
                                                                                {7232}out(c, senc(mSrv(pkCli_5861,pkSess_5677),Ksrv_5896))
                                                                    )
                                                                    else
                                                                        {7233}let pkDisco_5897: bitstring = fail-any in
                                                                        {7234}in(c, (=pkCli_5861,m1_5898: bitstring,sigM1_5899: bitstring));
                                                                        {7235}if (verify(h(m1_5898),sigM1_5899,pkCli_5861) <> true) then
                                                                            0
                                                                        else
                                                                            {7236}let (SPc_5900: bitstring,PartC_5901: bitstring) = m1_5898 in
                                                                            {7237}new Ns_5902: bitstring;
                                                                            {7238}let m2_5903: bitstring = exp(g,Ns_5902) in
                                                                            {7239}out(c, (m2_5903,sign(h(m2_5903),skSess_5676)));
                                                                            {7240}let Ksrv_5904: bitstring = exp(PartC_5901,Ns_5902) in
                                                                            {7241}out(c, senc(mSrv(pkCli_5861,pkSess_5677),Ksrv_5904))
                                                            )
                                                            else
                                                                {7242}let pkDisco_5905: bitstring = fail-any in
                                                                {7243}in(c, (=pkCli_5861,m1_5906: bitstring,sigM1_5907: bitstring));
                                                                {7244}if (verify(h(m1_5906),sigM1_5907,pkCli_5861) <> true) then
                                                                    0
                                                                else
                                                                    {7245}let (SPc_5908: bitstring,PartC_5909: bitstring) = m1_5906 in
                                                                    {7246}new Ns_5910: bitstring;
                                                                    {7247}let m2_5911: bitstring = exp(g,Ns_5910) in
                                                                    {7248}out(c, (m2_5911,sign(h(m2_5911),skSess_5676)));
                                                                    {7249}let Ksrv_5912: bitstring = exp(PartC_5909,Ns_5910) in
                                                                    {7250}out(c, senc(mSrv(pkCli_5861,pkSess_5677),Ksrv_5912))
                                                    )
                                                    else
                                                        {7251}let pkDisco_5913: bitstring = fail-any in
                                                        {7252}in(c, (=pkCli_5861,m1_5914: bitstring,sigM1_5915: bitstring));
                                                        {7253}if (verify(h(m1_5914),sigM1_5915,pkCli_5861) <> true) then
                                                            0
                                                        else
                                                            {7254}let (SPc_5916: bitstring,PartC_5917: bitstring) = m1_5914 in
                                                            {7255}new Ns_5918: bitstring;
                                                            {7256}let m2_5919: bitstring = exp(g,Ns_5918) in
                                                            {7257}out(c, (m2_5919,sign(h(m2_5919),skSess_5676)));
                                                            {7258}let Ksrv_5920: bitstring = exp(PartC_5917,Ns_5918) in
                                                            {7259}out(c, senc(mSrv(pkCli_5861,pkSess_5677),Ksrv_5920))
                                            )
                                            else
                                                {7260}let pkCli_5921: bitstring = fail-any in
                                                {7261}let v_5922: bool = (Disco_4827 = A) in
                                                (
                                                    {7262}if v_5922 then
                                                    (
                                                        {7263}let pkDisco_5923: bitstring = pub(skA) in
                                                        {7264}in(c, (=pkCli_5921,m1_5924: bitstring,sigM1_5925: bitstring));
                                                        {7265}if (verify(h(m1_5924),sigM1_5925,pkCli_5921) <> true) then
                                                            0
                                                        else
                                                            {7266}let (SPc_5926: bitstring,PartC_5927: bitstring) = m1_5924 in
                                                            {7267}new Ns_5928: bitstring;
                                                            {7268}let m2_5929: bitstring = exp(g,Ns_5928) in
                                                            {7269}out(c, (m2_5929,sign(h(m2_5929),skSess_5676)));
                                                            {7270}let Ksrv_5930: bitstring = exp(PartC_5927,Ns_5928) in
                                                            {7271}out(c, senc(mSrv(pkCli_5921,pkSess_5677),Ksrv_5930))
                                                    )
                                                    else
                                                        {7272}let v_5931: bool = (Disco_4827 = B) in
                                                        (
                                                            {7273}if v_5931 then
                                                            (
                                                                {7274}let pkDisco_5932: bitstring = pub(skB) in
                                                                {7275}in(c, (=pkCli_5921,m1_5933: bitstring,sigM1_5934: bitstring));
                                                                {7276}if (verify(h(m1_5933),sigM1_5934,pkCli_5921) <> true) then
                                                                    0
                                                                else
                                                                    {7277}let (SPc_5935: bitstring,PartC_5936: bitstring) = m1_5933 in
                                                                    {7278}new Ns_5937: bitstring;
                                                                    {7279}let m2_5938: bitstring = exp(g,Ns_5937) in
                                                                    {7280}out(c, (m2_5938,sign(h(m2_5938),skSess_5676)));
                                                                    {7281}let Ksrv_5939: bitstring = exp(PartC_5936,Ns_5937) in
                                                                    {7282}out(c, senc(mSrv(pkCli_5921,pkSess_5677),Ksrv_5939))
                                                            )
                                                            else
                                                                {7283}let v_5940: bool = (Disco_4827 = C) in
                                                                (
                                                                    {7284}if v_5940 then
                                                                    (
                                                                        {7285}let pkDisco_5941: bitstring = pub(skC) in
                                                                        {7286}in(c, (=pkCli_5921,m1_5942: bitstring,sigM1_5943: bitstring));
                                                                        {7287}if (verify(h(m1_5942),sigM1_5943,pkCli_5921) <> true) then
                                                                            0
                                                                        else
                                                                            {7288}let (SPc_5944: bitstring,PartC_5945: bitstring) = m1_5942 in
                                                                            {7289}new Ns_5946: bitstring;
                                                                            {7290}let m2_5947: bitstring = exp(g,Ns_5946) in
                                                                            {7291}out(c, (m2_5947,sign(h(m2_5947),skSess_5676)));
                                                                            {7292}let Ksrv_5948: bitstring = exp(PartC_5945,Ns_5946) in
                                                                            {7293}out(c, senc(mSrv(pkCli_5921,pkSess_5677),Ksrv_5948))
                                                                    )
                                                                    else
                                                                        {7294}let pkDisco_5949: bitstring = pub(skI) in
                                                                        {7295}in(c, (=pkCli_5921,m1_5950: bitstring,sigM1_5951: bitstring));
                                                                        {7296}if (verify(h(m1_5950),sigM1_5951,pkCli_5921) <> true) then
                                                                            0
                                                                        else
                                                                            {7297}let (SPc_5952: bitstring,PartC_5953: bitstring) = m1_5950 in
                                                                            {7298}new Ns_5954: bitstring;
                                                                            {7299}let m2_5955: bitstring = exp(g,Ns_5954) in
                                                                            {7300}out(c, (m2_5955,sign(h(m2_5955),skSess_5676)));
                                                                            {7301}let Ksrv_5956: bitstring = exp(PartC_5953,Ns_5954) in
                                                                            {7302}out(c, senc(mSrv(pkCli_5921,pkSess_5677),Ksrv_5956))
                                                                )
                                                                else
                                                                    {7303}let pkDisco_5957: bitstring = fail-any in
                                                                    {7304}in(c, (=pkCli_5921,m1_5958: bitstring,sigM1_5959: bitstring));
                                                                    {7305}if (verify(h(m1_5958),sigM1_5959,pkCli_5921) <> true) then
                                                                        0
                                                                    else
                                                                        {7306}let (SPc_5960: bitstring,PartC_5961: bitstring) = m1_5958 in
                                                                        {7307}new Ns_5962: bitstring;
                                                                        {7308}let m2_5963: bitstring = exp(g,Ns_5962) in
                                                                        {7309}out(c, (m2_5963,sign(h(m2_5963),skSess_5676)));
                                                                        {7310}let Ksrv_5964: bitstring = exp(PartC_5961,Ns_5962) in
                                                                        {7311}out(c, senc(mSrv(pkCli_5921,pkSess_5677),Ksrv_5964))
                                                        )
                                                        else
                                                            {7312}let pkDisco_5965: bitstring = fail-any in
                                                            {7313}in(c, (=pkCli_5921,m1_5966: bitstring,sigM1_5967: bitstring));
                                                            {7314}if (verify(h(m1_5966),sigM1_5967,pkCli_5921) <> true) then
                                                                0
                                                            else
                                                                {7315}let (SPc_5968: bitstring,PartC_5969: bitstring) = m1_5966 in
                                                                {7316}new Ns_5970: bitstring;
                                                                {7317}let m2_5971: bitstring = exp(g,Ns_5970) in
                                                                {7318}out(c, (m2_5971,sign(h(m2_5971),skSess_5676)));
                                                                {7319}let Ksrv_5972: bitstring = exp(PartC_5969,Ns_5970) in
                                                                {7320}out(c, senc(mSrv(pkCli_5921,pkSess_5677),Ksrv_5972))
                                                )
                                                else
                                                    {7321}let pkDisco_5973: bitstring = fail-any in
                                                    {7322}in(c, (=pkCli_5921,m1_5974: bitstring,sigM1_5975: bitstring));
                                                    {7323}if (verify(h(m1_5974),sigM1_5975,pkCli_5921) <> true) then
                                                        0
                                                    else
                                                        {7324}let (SPc_5976: bitstring,PartC_5977: bitstring) = m1_5974 in
                                                        {7325}new Ns_5978: bitstring;
                                                        {7326}let m2_5979: bitstring = exp(g,Ns_5978) in
                                                        {7327}out(c, (m2_5979,sign(h(m2_5979),skSess_5676)));
                                                        {7328}let Ksrv_5980: bitstring = exp(PartC_5977,Ns_5978) in
                                                        {7329}out(c, senc(mSrv(pkCli_5921,pkSess_5677),Ksrv_5980))
                                    )
                                    else
                                        {7330}let pkCli_5981: bitstring = fail-any in
                                        {7331}let v_5982: bool = (Disco_4827 = A) in
                                        (
                                            {7332}if v_5982 then
                                            (
                                                {7333}let pkDisco_5983: bitstring = pub(skA) in
                                                {7334}in(c, (=pkCli_5981,m1_5984: bitstring,sigM1_5985: bitstring));
                                                {7335}if (verify(h(m1_5984),sigM1_5985,pkCli_5981) <> true) then
                                                    0
                                                else
                                                    {7336}let (SPc_5986: bitstring,PartC_5987: bitstring) = m1_5984 in
                                                    {7337}new Ns_5988: bitstring;
                                                    {7338}let m2_5989: bitstring = exp(g,Ns_5988) in
                                                    {7339}out(c, (m2_5989,sign(h(m2_5989),skSess_5676)));
                                                    {7340}let Ksrv_5990: bitstring = exp(PartC_5987,Ns_5988) in
                                                    {7341}out(c, senc(mSrv(pkCli_5981,pkSess_5677),Ksrv_5990))
                                            )
                                            else
                                                {7342}let v_5991: bool = (Disco_4827 = B) in
                                                (
                                                    {7343}if v_5991 then
                                                    (
                                                        {7344}let pkDisco_5992: bitstring = pub(skB) in
                                                        {7345}in(c, (=pkCli_5981,m1_5993: bitstring,sigM1_5994: bitstring));
                                                        {7346}if (verify(h(m1_5993),sigM1_5994,pkCli_5981) <> true) then
                                                            0
                                                        else
                                                            {7347}let (SPc_5995: bitstring,PartC_5996: bitstring) = m1_5993 in
                                                            {7348}new Ns_5997: bitstring;
                                                            {7349}let m2_5998: bitstring = exp(g,Ns_5997) in
                                                            {7350}out(c, (m2_5998,sign(h(m2_5998),skSess_5676)));
                                                            {7351}let Ksrv_5999: bitstring = exp(PartC_5996,Ns_5997) in
                                                            {7352}out(c, senc(mSrv(pkCli_5981,pkSess_5677),Ksrv_5999))
                                                    )
                                                    else
                                                        {7353}let v_6000: bool = (Disco_4827 = C) in
                                                        (
                                                            {7354}if v_6000 then
                                                            (
                                                                {7355}let pkDisco_6001: bitstring = pub(skC) in
                                                                {7356}in(c, (=pkCli_5981,m1_6002: bitstring,sigM1_6003: bitstring));
                                                                {7357}if (verify(h(m1_6002),sigM1_6003,pkCli_5981) <> true) then
                                                                    0
                                                                else
                                                                    {7358}let (SPc_6004: bitstring,PartC_6005: bitstring) = m1_6002 in
                                                                    {7359}new Ns_6006: bitstring;
                                                                    {7360}let m2_6007: bitstring = exp(g,Ns_6006) in
                                                                    {7361}out(c, (m2_6007,sign(h(m2_6007),skSess_5676)));
                                                                    {7362}let Ksrv_6008: bitstring = exp(PartC_6005,Ns_6006) in
                                                                    {7363}out(c, senc(mSrv(pkCli_5981,pkSess_5677),Ksrv_6008))
                                                            )
                                                            else
                                                                {7364}let pkDisco_6009: bitstring = pub(skI) in
                                                                {7365}in(c, (=pkCli_5981,m1_6010: bitstring,sigM1_6011: bitstring));
                                                                {7366}if (verify(h(m1_6010),sigM1_6011,pkCli_5981) <> true) then
                                                                    0
                                                                else
                                                                    {7367}let (SPc_6012: bitstring,PartC_6013: bitstring) = m1_6010 in
                                                                    {7368}new Ns_6014: bitstring;
                                                                    {7369}let m2_6015: bitstring = exp(g,Ns_6014) in
                                                                    {7370}out(c, (m2_6015,sign(h(m2_6015),skSess_5676)));
                                                                    {7371}let Ksrv_6016: bitstring = exp(PartC_6013,Ns_6014) in
                                                                    {7372}out(c, senc(mSrv(pkCli_5981,pkSess_5677),Ksrv_6016))
                                                        )
                                                        else
                                                            {7373}let pkDisco_6017: bitstring = fail-any in
                                                            {7374}in(c, (=pkCli_5981,m1_6018: bitstring,sigM1_6019: bitstring));
                                                            {7375}if (verify(h(m1_6018),sigM1_6019,pkCli_5981) <> true) then
                                                                0
                                                            else
                                                                {7376}let (SPc_6020: bitstring,PartC_6021: bitstring) = m1_6018 in
                                                                {7377}new Ns_6022: bitstring;
                                                                {7378}let m2_6023: bitstring = exp(g,Ns_6022) in
                                                                {7379}out(c, (m2_6023,sign(h(m2_6023),skSess_5676)));
                                                                {7380}let Ksrv_6024: bitstring = exp(PartC_6021,Ns_6022) in
                                                                {7381}out(c, senc(mSrv(pkCli_5981,pkSess_5677),Ksrv_6024))
                                                )
                                                else
                                                    {7382}let pkDisco_6025: bitstring = fail-any in
                                                    {7383}in(c, (=pkCli_5981,m1_6026: bitstring,sigM1_6027: bitstring));
                                                    {7384}if (verify(h(m1_6026),sigM1_6027,pkCli_5981) <> true) then
                                                        0
                                                    else
                                                        {7385}let (SPc_6028: bitstring,PartC_6029: bitstring) = m1_6026 in
                                                        {7386}new Ns_6030: bitstring;
                                                        {7387}let m2_6031: bitstring = exp(g,Ns_6030) in
                                                        {7388}out(c, (m2_6031,sign(h(m2_6031),skSess_5676)));
                                                        {7389}let Ksrv_6032: bitstring = exp(PartC_6029,Ns_6030) in
                                                        {7390}out(c, senc(mSrv(pkCli_5981,pkSess_5677),Ksrv_6032))
                                        )
                                        else
                                            {7391}let pkDisco_6033: bitstring = fail-any in
                                            {7392}in(c, (=pkCli_5981,m1_6034: bitstring,sigM1_6035: bitstring));
                                            {7393}if (verify(h(m1_6034),sigM1_6035,pkCli_5981) <> true) then
                                                0
                                            else
                                                {7394}let (SPc_6036: bitstring,PartC_6037: bitstring) = m1_6034 in
                                                {7395}new Ns_6038: bitstring;
                                                {7396}let m2_6039: bitstring = exp(g,Ns_6038) in
                                                {7397}out(c, (m2_6039,sign(h(m2_6039),skSess_5676)));
                                                {7398}let Ksrv_6040: bitstring = exp(PartC_6037,Ns_6038) in
                                                {7399}out(c, senc(mSrv(pkCli_5981,pkSess_5677),Ksrv_6040))
                            )
                            else
                                {7400}let pkCli_6041: bitstring = fail-any in
                                {7401}let v_6042: bool = (Disco_4827 = A) in
                                (
                                    {7402}if v_6042 then
                                    (
                                        {7403}let pkDisco_6043: bitstring = pub(skA) in
                                        {7404}in(c, (=pkCli_6041,m1_6044: bitstring,sigM1_6045: bitstring));
                                        {7405}if (verify(h(m1_6044),sigM1_6045,pkCli_6041) <> true) then
                                            0
                                        else
                                            {7406}let (SPc_6046: bitstring,PartC_6047: bitstring) = m1_6044 in
                                            {7407}new Ns_6048: bitstring;
                                            {7408}let m2_6049: bitstring = exp(g,Ns_6048) in
                                            {7409}out(c, (m2_6049,sign(h(m2_6049),skSess_5676)));
                                            {7410}let Ksrv_6050: bitstring = exp(PartC_6047,Ns_6048) in
                                            {7411}out(c, senc(mSrv(pkCli_6041,pkSess_5677),Ksrv_6050))
                                    )
                                    else
                                        {7412}let v_6051: bool = (Disco_4827 = B) in
                                        (
                                            {7413}if v_6051 then
                                            (
                                                {7414}let pkDisco_6052: bitstring = pub(skB) in
                                                {7415}in(c, (=pkCli_6041,m1_6053: bitstring,sigM1_6054: bitstring));
                                                {7416}if (verify(h(m1_6053),sigM1_6054,pkCli_6041) <> true) then
                                                    0
                                                else
                                                    {7417}let (SPc_6055: bitstring,PartC_6056: bitstring) = m1_6053 in
                                                    {7418}new Ns_6057: bitstring;
                                                    {7419}let m2_6058: bitstring = exp(g,Ns_6057) in
                                                    {7420}out(c, (m2_6058,sign(h(m2_6058),skSess_5676)));
                                                    {7421}let Ksrv_6059: bitstring = exp(PartC_6056,Ns_6057) in
                                                    {7422}out(c, senc(mSrv(pkCli_6041,pkSess_5677),Ksrv_6059))
                                            )
                                            else
                                                {7423}let v_6060: bool = (Disco_4827 = C) in
                                                (
                                                    {7424}if v_6060 then
                                                    (
                                                        {7425}let pkDisco_6061: bitstring = pub(skC) in
                                                        {7426}in(c, (=pkCli_6041,m1_6062: bitstring,sigM1_6063: bitstring));
                                                        {7427}if (verify(h(m1_6062),sigM1_6063,pkCli_6041) <> true) then
                                                            0
                                                        else
                                                            {7428}let (SPc_6064: bitstring,PartC_6065: bitstring) = m1_6062 in
                                                            {7429}new Ns_6066: bitstring;
                                                            {7430}let m2_6067: bitstring = exp(g,Ns_6066) in
                                                            {7431}out(c, (m2_6067,sign(h(m2_6067),skSess_5676)));
                                                            {7432}let Ksrv_6068: bitstring = exp(PartC_6065,Ns_6066) in
                                                            {7433}out(c, senc(mSrv(pkCli_6041,pkSess_5677),Ksrv_6068))
                                                    )
                                                    else
                                                        {7434}let pkDisco_6069: bitstring = pub(skI) in
                                                        {7435}in(c, (=pkCli_6041,m1_6070: bitstring,sigM1_6071: bitstring));
                                                        {7436}if (verify(h(m1_6070),sigM1_6071,pkCli_6041) <> true) then
                                                            0
                                                        else
                                                            {7437}let (SPc_6072: bitstring,PartC_6073: bitstring) = m1_6070 in
                                                            {7438}new Ns_6074: bitstring;
                                                            {7439}let m2_6075: bitstring = exp(g,Ns_6074) in
                                                            {7440}out(c, (m2_6075,sign(h(m2_6075),skSess_5676)));
                                                            {7441}let Ksrv_6076: bitstring = exp(PartC_6073,Ns_6074) in
                                                            {7442}out(c, senc(mSrv(pkCli_6041,pkSess_5677),Ksrv_6076))
                                                )
                                                else
                                                    {7443}let pkDisco_6077: bitstring = fail-any in
                                                    {7444}in(c, (=pkCli_6041,m1_6078: bitstring,sigM1_6079: bitstring));
                                                    {7445}if (verify(h(m1_6078),sigM1_6079,pkCli_6041) <> true) then
                                                        0
                                                    else
                                                        {7446}let (SPc_6080: bitstring,PartC_6081: bitstring) = m1_6078 in
                                                        {7447}new Ns_6082: bitstring;
                                                        {7448}let m2_6083: bitstring = exp(g,Ns_6082) in
                                                        {7449}out(c, (m2_6083,sign(h(m2_6083),skSess_5676)));
                                                        {7450}let Ksrv_6084: bitstring = exp(PartC_6081,Ns_6082) in
                                                        {7451}out(c, senc(mSrv(pkCli_6041,pkSess_5677),Ksrv_6084))
                                        )
                                        else
                                            {7452}let pkDisco_6085: bitstring = fail-any in
                                            {7453}in(c, (=pkCli_6041,m1_6086: bitstring,sigM1_6087: bitstring));
                                            {7454}if (verify(h(m1_6086),sigM1_6087,pkCli_6041) <> true) then
                                                0
                                            else
                                                {7455}let (SPc_6088: bitstring,PartC_6089: bitstring) = m1_6086 in
                                                {7456}new Ns_6090: bitstring;
                                                {7457}let m2_6091: bitstring = exp(g,Ns_6090) in
                                                {7458}out(c, (m2_6091,sign(h(m2_6091),skSess_5676)));
                                                {7459}let Ksrv_6092: bitstring = exp(PartC_6089,Ns_6090) in
                                                {7460}out(c, senc(mSrv(pkCli_6041,pkSess_5677),Ksrv_6092))
                                )
                                else
                                    {7461}let pkDisco_6093: bitstring = fail-any in
                                    {7462}in(c, (=pkCli_6041,m1_6094: bitstring,sigM1_6095: bitstring));
                                    {7463}if (verify(h(m1_6094),sigM1_6095,pkCli_6041) <> true) then
                                        0
                                    else
                                        {7464}let (SPc_6096: bitstring,PartC_6097: bitstring) = m1_6094 in
                                        {7465}new Ns_6098: bitstring;
                                        {7466}let m2_6099: bitstring = exp(g,Ns_6098) in
                                        {7467}out(c, (m2_6099,sign(h(m2_6099),skSess_5676)));
                                        {7468}let Ksrv_6100: bitstring = exp(PartC_6097,Ns_6098) in
                                        {7469}out(c, senc(mSrv(pkCli_6041,pkSess_5677),Ksrv_6100))
                        )
                        else
                            {7470}let skSess_6101: bitstring = skI in
                            {7471}let pkSess_6102: bitstring = pub(skSess_6101) in
                            {7472}let v_6103: bool = (Cli_4826 = A) in
                            (
                                {7473}if v_6103 then
                                (
                                    {7474}let pkCli_6104: bitstring = pub(skA) in
                                    {7475}let v_6105: bool = (Disco_4827 = A) in
                                    (
                                        {7476}if v_6105 then
                                        (
                                            {7477}let pkDisco_6106: bitstring = pub(skA) in
                                            {7478}in(c, (=pkCli_6104,m1_6107: bitstring,sigM1_6108: bitstring));
                                            {7479}if (verify(h(m1_6107),sigM1_6108,pkCli_6104) <> true) then
                                                0
                                            else
                                                {7480}let (SPc_6109: bitstring,PartC_6110: bitstring) = m1_6107 in
                                                {7481}new Ns_6111: bitstring;
                                                {7482}let m2_6112: bitstring = exp(g,Ns_6111) in
                                                {7483}out(c, (m2_6112,sign(h(m2_6112),skSess_6101)));
                                                {7484}let Ksrv_6113: bitstring = exp(PartC_6110,Ns_6111) in
                                                {7485}out(c, senc(mSrv(pkCli_6104,pkSess_6102),Ksrv_6113))
                                        )
                                        else
                                            {7486}let v_6114: bool = (Disco_4827 = B) in
                                            (
                                                {7487}if v_6114 then
                                                (
                                                    {7488}let pkDisco_6115: bitstring = pub(skB) in
                                                    {7489}in(c, (=pkCli_6104,m1_6116: bitstring,sigM1_6117: bitstring));
                                                    {7490}if (verify(h(m1_6116),sigM1_6117,pkCli_6104) <> true) then
                                                        0
                                                    else
                                                        {7491}let (SPc_6118: bitstring,PartC_6119: bitstring) = m1_6116 in
                                                        {7492}new Ns_6120: bitstring;
                                                        {7493}let m2_6121: bitstring = exp(g,Ns_6120) in
                                                        {7494}out(c, (m2_6121,sign(h(m2_6121),skSess_6101)));
                                                        {7495}let Ksrv_6122: bitstring = exp(PartC_6119,Ns_6120) in
                                                        {7496}out(c, senc(mSrv(pkCli_6104,pkSess_6102),Ksrv_6122))
                                                )
                                                else
                                                    {7497}let v_6123: bool = (Disco_4827 = C) in
                                                    (
                                                        {7498}if v_6123 then
                                                        (
                                                            {7499}let pkDisco_6124: bitstring = pub(skC) in
                                                            {7500}in(c, (=pkCli_6104,m1_6125: bitstring,sigM1_6126: bitstring));
                                                            {7501}if (verify(h(m1_6125),sigM1_6126,pkCli_6104) <> true) then
                                                                0
                                                            else
                                                                {7502}let (SPc_6127: bitstring,PartC_6128: bitstring) = m1_6125 in
                                                                {7503}new Ns_6129: bitstring;
                                                                {7504}let m2_6130: bitstring = exp(g,Ns_6129) in
                                                                {7505}out(c, (m2_6130,sign(h(m2_6130),skSess_6101)));
                                                                {7506}let Ksrv_6131: bitstring = exp(PartC_6128,Ns_6129) in
                                                                {7507}out(c, senc(mSrv(pkCli_6104,pkSess_6102),Ksrv_6131))
                                                        )
                                                        else
                                                            {7508}let pkDisco_6132: bitstring = pub(skI) in
                                                            {7509}in(c, (=pkCli_6104,m1_6133: bitstring,sigM1_6134: bitstring));
                                                            {7510}if (verify(h(m1_6133),sigM1_6134,pkCli_6104) <> true) then
                                                                0
                                                            else
                                                                {7511}let (SPc_6135: bitstring,PartC_6136: bitstring) = m1_6133 in
                                                                {7512}new Ns_6137: bitstring;
                                                                {7513}let m2_6138: bitstring = exp(g,Ns_6137) in
                                                                {7514}out(c, (m2_6138,sign(h(m2_6138),skSess_6101)));
                                                                {7515}let Ksrv_6139: bitstring = exp(PartC_6136,Ns_6137) in
                                                                {7516}out(c, senc(mSrv(pkCli_6104,pkSess_6102),Ksrv_6139))
                                                    )
                                                    else
                                                        {7517}let pkDisco_6140: bitstring = fail-any in
                                                        {7518}in(c, (=pkCli_6104,m1_6141: bitstring,sigM1_6142: bitstring));
                                                        {7519}if (verify(h(m1_6141),sigM1_6142,pkCli_6104) <> true) then
                                                            0
                                                        else
                                                            {7520}let (SPc_6143: bitstring,PartC_6144: bitstring) = m1_6141 in
                                                            {7521}new Ns_6145: bitstring;
                                                            {7522}let m2_6146: bitstring = exp(g,Ns_6145) in
                                                            {7523}out(c, (m2_6146,sign(h(m2_6146),skSess_6101)));
                                                            {7524}let Ksrv_6147: bitstring = exp(PartC_6144,Ns_6145) in
                                                            {7525}out(c, senc(mSrv(pkCli_6104,pkSess_6102),Ksrv_6147))
                                            )
                                            else
                                                {7526}let pkDisco_6148: bitstring = fail-any in
                                                {7527}in(c, (=pkCli_6104,m1_6149: bitstring,sigM1_6150: bitstring));
                                                {7528}if (verify(h(m1_6149),sigM1_6150,pkCli_6104) <> true) then
                                                    0
                                                else
                                                    {7529}let (SPc_6151: bitstring,PartC_6152: bitstring) = m1_6149 in
                                                    {7530}new Ns_6153: bitstring;
                                                    {7531}let m2_6154: bitstring = exp(g,Ns_6153) in
                                                    {7532}out(c, (m2_6154,sign(h(m2_6154),skSess_6101)));
                                                    {7533}let Ksrv_6155: bitstring = exp(PartC_6152,Ns_6153) in
                                                    {7534}out(c, senc(mSrv(pkCli_6104,pkSess_6102),Ksrv_6155))
                                    )
                                    else
                                        {7535}let pkDisco_6156: bitstring = fail-any in
                                        {7536}in(c, (=pkCli_6104,m1_6157: bitstring,sigM1_6158: bitstring));
                                        {7537}if (verify(h(m1_6157),sigM1_6158,pkCli_6104) <> true) then
                                            0
                                        else
                                            {7538}let (SPc_6159: bitstring,PartC_6160: bitstring) = m1_6157 in
                                            {7539}new Ns_6161: bitstring;
                                            {7540}let m2_6162: bitstring = exp(g,Ns_6161) in
                                            {7541}out(c, (m2_6162,sign(h(m2_6162),skSess_6101)));
                                            {7542}let Ksrv_6163: bitstring = exp(PartC_6160,Ns_6161) in
                                            {7543}out(c, senc(mSrv(pkCli_6104,pkSess_6102),Ksrv_6163))
                                )
                                else
                                    {7544}let v_6164: bool = (Cli_4826 = B) in
                                    (
                                        {7545}if v_6164 then
                                        (
                                            {7546}let pkCli_6165: bitstring = pub(skB) in
                                            {7547}let v_6166: bool = (Disco_4827 = A) in
                                            (
                                                {7548}if v_6166 then
                                                (
                                                    {7549}let pkDisco_6167: bitstring = pub(skA) in
                                                    {7550}in(c, (=pkCli_6165,m1_6168: bitstring,sigM1_6169: bitstring));
                                                    {7551}if (verify(h(m1_6168),sigM1_6169,pkCli_6165) <> true) then
                                                        0
                                                    else
                                                        {7552}let (SPc_6170: bitstring,PartC_6171: bitstring) = m1_6168 in
                                                        {7553}new Ns_6172: bitstring;
                                                        {7554}let m2_6173: bitstring = exp(g,Ns_6172) in
                                                        {7555}out(c, (m2_6173,sign(h(m2_6173),skSess_6101)));
                                                        {7556}let Ksrv_6174: bitstring = exp(PartC_6171,Ns_6172) in
                                                        {7557}out(c, senc(mSrv(pkCli_6165,pkSess_6102),Ksrv_6174))
                                                )
                                                else
                                                    {7558}let v_6175: bool = (Disco_4827 = B) in
                                                    (
                                                        {7559}if v_6175 then
                                                        (
                                                            {7560}let pkDisco_6176: bitstring = pub(skB) in
                                                            {7561}in(c, (=pkCli_6165,m1_6177: bitstring,sigM1_6178: bitstring));
                                                            {7562}if (verify(h(m1_6177),sigM1_6178,pkCli_6165) <> true) then
                                                                0
                                                            else
                                                                {7563}let (SPc_6179: bitstring,PartC_6180: bitstring) = m1_6177 in
                                                                {7564}new Ns_6181: bitstring;
                                                                {7565}let m2_6182: bitstring = exp(g,Ns_6181) in
                                                                {7566}out(c, (m2_6182,sign(h(m2_6182),skSess_6101)));
                                                                {7567}let Ksrv_6183: bitstring = exp(PartC_6180,Ns_6181) in
                                                                {7568}out(c, senc(mSrv(pkCli_6165,pkSess_6102),Ksrv_6183))
                                                        )
                                                        else
                                                            {7569}let v_6184: bool = (Disco_4827 = C) in
                                                            (
                                                                {7570}if v_6184 then
                                                                (
                                                                    {7571}let pkDisco_6185: bitstring = pub(skC) in
                                                                    {7572}in(c, (=pkCli_6165,m1_6186: bitstring,sigM1_6187: bitstring));
                                                                    {7573}if (verify(h(m1_6186),sigM1_6187,pkCli_6165) <> true) then
                                                                        0
                                                                    else
                                                                        {7574}let (SPc_6188: bitstring,PartC_6189: bitstring) = m1_6186 in
                                                                        {7575}new Ns_6190: bitstring;
                                                                        {7576}let m2_6191: bitstring = exp(g,Ns_6190) in
                                                                        {7577}out(c, (m2_6191,sign(h(m2_6191),skSess_6101)));
                                                                        {7578}let Ksrv_6192: bitstring = exp(PartC_6189,Ns_6190) in
                                                                        {7579}out(c, senc(mSrv(pkCli_6165,pkSess_6102),Ksrv_6192))
                                                                )
                                                                else
                                                                    {7580}let pkDisco_6193: bitstring = pub(skI) in
                                                                    {7581}in(c, (=pkCli_6165,m1_6194: bitstring,sigM1_6195: bitstring));
                                                                    {7582}if (verify(h(m1_6194),sigM1_6195,pkCli_6165) <> true) then
                                                                        0
                                                                    else
                                                                        {7583}let (SPc_6196: bitstring,PartC_6197: bitstring) = m1_6194 in
                                                                        {7584}new Ns_6198: bitstring;
                                                                        {7585}let m2_6199: bitstring = exp(g,Ns_6198) in
                                                                        {7586}out(c, (m2_6199,sign(h(m2_6199),skSess_6101)));
                                                                        {7587}let Ksrv_6200: bitstring = exp(PartC_6197,Ns_6198) in
                                                                        {7588}out(c, senc(mSrv(pkCli_6165,pkSess_6102),Ksrv_6200))
                                                            )
                                                            else
                                                                {7589}let pkDisco_6201: bitstring = fail-any in
                                                                {7590}in(c, (=pkCli_6165,m1_6202: bitstring,sigM1_6203: bitstring));
                                                                {7591}if (verify(h(m1_6202),sigM1_6203,pkCli_6165) <> true) then
                                                                    0
                                                                else
                                                                    {7592}let (SPc_6204: bitstring,PartC_6205: bitstring) = m1_6202 in
                                                                    {7593}new Ns_6206: bitstring;
                                                                    {7594}let m2_6207: bitstring = exp(g,Ns_6206) in
                                                                    {7595}out(c, (m2_6207,sign(h(m2_6207),skSess_6101)));
                                                                    {7596}let Ksrv_6208: bitstring = exp(PartC_6205,Ns_6206) in
                                                                    {7597}out(c, senc(mSrv(pkCli_6165,pkSess_6102),Ksrv_6208))
                                                    )
                                                    else
                                                        {7598}let pkDisco_6209: bitstring = fail-any in
                                                        {7599}in(c, (=pkCli_6165,m1_6210: bitstring,sigM1_6211: bitstring));
                                                        {7600}if (verify(h(m1_6210),sigM1_6211,pkCli_6165) <> true) then
                                                            0
                                                        else
                                                            {7601}let (SPc_6212: bitstring,PartC_6213: bitstring) = m1_6210 in
                                                            {7602}new Ns_6214: bitstring;
                                                            {7603}let m2_6215: bitstring = exp(g,Ns_6214) in
                                                            {7604}out(c, (m2_6215,sign(h(m2_6215),skSess_6101)));
                                                            {7605}let Ksrv_6216: bitstring = exp(PartC_6213,Ns_6214) in
                                                            {7606}out(c, senc(mSrv(pkCli_6165,pkSess_6102),Ksrv_6216))
                                            )
                                            else
                                                {7607}let pkDisco_6217: bitstring = fail-any in
                                                {7608}in(c, (=pkCli_6165,m1_6218: bitstring,sigM1_6219: bitstring));
                                                {7609}if (verify(h(m1_6218),sigM1_6219,pkCli_6165) <> true) then
                                                    0
                                                else
                                                    {7610}let (SPc_6220: bitstring,PartC_6221: bitstring) = m1_6218 in
                                                    {7611}new Ns_6222: bitstring;
                                                    {7612}let m2_6223: bitstring = exp(g,Ns_6222) in
                                                    {7613}out(c, (m2_6223,sign(h(m2_6223),skSess_6101)));
                                                    {7614}let Ksrv_6224: bitstring = exp(PartC_6221,Ns_6222) in
                                                    {7615}out(c, senc(mSrv(pkCli_6165,pkSess_6102),Ksrv_6224))
                                        )
                                        else
                                            {7616}let v_6225: bool = (Cli_4826 = C) in
                                            (
                                                {7617}if v_6225 then
                                                (
                                                    {7618}let pkCli_6226: bitstring = pub(skC) in
                                                    {7619}let v_6227: bool = (Disco_4827 = A) in
                                                    (
                                                        {7620}if v_6227 then
                                                        (
                                                            {7621}let pkDisco_6228: bitstring = pub(skA) in
                                                            {7622}in(c, (=pkCli_6226,m1_6229: bitstring,sigM1_6230: bitstring));
                                                            {7623}if (verify(h(m1_6229),sigM1_6230,pkCli_6226) <> true) then
                                                                0
                                                            else
                                                                {7624}let (SPc_6231: bitstring,PartC_6232: bitstring) = m1_6229 in
                                                                {7625}new Ns_6233: bitstring;
                                                                {7626}let m2_6234: bitstring = exp(g,Ns_6233) in
                                                                {7627}out(c, (m2_6234,sign(h(m2_6234),skSess_6101)));
                                                                {7628}let Ksrv_6235: bitstring = exp(PartC_6232,Ns_6233) in
                                                                {7629}out(c, senc(mSrv(pkCli_6226,pkSess_6102),Ksrv_6235))
                                                        )
                                                        else
                                                            {7630}let v_6236: bool = (Disco_4827 = B) in
                                                            (
                                                                {7631}if v_6236 then
                                                                (
                                                                    {7632}let pkDisco_6237: bitstring = pub(skB) in
                                                                    {7633}in(c, (=pkCli_6226,m1_6238: bitstring,sigM1_6239: bitstring));
                                                                    {7634}if (verify(h(m1_6238),sigM1_6239,pkCli_6226) <> true) then
                                                                        0
                                                                    else
                                                                        {7635}let (SPc_6240: bitstring,PartC_6241: bitstring) = m1_6238 in
                                                                        {7636}new Ns_6242: bitstring;
                                                                        {7637}let m2_6243: bitstring = exp(g,Ns_6242) in
                                                                        {7638}out(c, (m2_6243,sign(h(m2_6243),skSess_6101)));
                                                                        {7639}let Ksrv_6244: bitstring = exp(PartC_6241,Ns_6242) in
                                                                        {7640}out(c, senc(mSrv(pkCli_6226,pkSess_6102),Ksrv_6244))
                                                                )
                                                                else
                                                                    {7641}let v_6245: bool = (Disco_4827 = C) in
                                                                    (
                                                                        {7642}if v_6245 then
                                                                        (
                                                                            {7643}let pkDisco_6246: bitstring = pub(skC) in
                                                                            {7644}in(c, (=pkCli_6226,m1_6247: bitstring,sigM1_6248: bitstring));
                                                                            {7645}if (verify(h(m1_6247),sigM1_6248,pkCli_6226) <> true) then
                                                                                0
                                                                            else
                                                                                {7646}let (SPc_6249: bitstring,PartC_6250: bitstring) = m1_6247 in
                                                                                {7647}new Ns_6251: bitstring;
                                                                                {7648}let m2_6252: bitstring = exp(g,Ns_6251) in
                                                                                {7649}out(c, (m2_6252,sign(h(m2_6252),skSess_6101)));
                                                                                {7650}let Ksrv_6253: bitstring = exp(PartC_6250,Ns_6251) in
                                                                                {7651}out(c, senc(mSrv(pkCli_6226,pkSess_6102),Ksrv_6253))
                                                                        )
                                                                        else
                                                                            {7652}let pkDisco_6254: bitstring = pub(skI) in
                                                                            {7653}in(c, (=pkCli_6226,m1_6255: bitstring,sigM1_6256: bitstring));
                                                                            {7654}if (verify(h(m1_6255),sigM1_6256,pkCli_6226) <> true) then
                                                                                0
                                                                            else
                                                                                {7655}let (SPc_6257: bitstring,PartC_6258: bitstring) = m1_6255 in
                                                                                {7656}new Ns_6259: bitstring;
                                                                                {7657}let m2_6260: bitstring = exp(g,Ns_6259) in
                                                                                {7658}out(c, (m2_6260,sign(h(m2_6260),skSess_6101)));
                                                                                {7659}let Ksrv_6261: bitstring = exp(PartC_6258,Ns_6259) in
                                                                                {7660}out(c, senc(mSrv(pkCli_6226,pkSess_6102),Ksrv_6261))
                                                                    )
                                                                    else
                                                                        {7661}let pkDisco_6262: bitstring = fail-any in
                                                                        {7662}in(c, (=pkCli_6226,m1_6263: bitstring,sigM1_6264: bitstring));
                                                                        {7663}if (verify(h(m1_6263),sigM1_6264,pkCli_6226) <> true) then
                                                                            0
                                                                        else
                                                                            {7664}let (SPc_6265: bitstring,PartC_6266: bitstring) = m1_6263 in
                                                                            {7665}new Ns_6267: bitstring;
                                                                            {7666}let m2_6268: bitstring = exp(g,Ns_6267) in
                                                                            {7667}out(c, (m2_6268,sign(h(m2_6268),skSess_6101)));
                                                                            {7668}let Ksrv_6269: bitstring = exp(PartC_6266,Ns_6267) in
                                                                            {7669}out(c, senc(mSrv(pkCli_6226,pkSess_6102),Ksrv_6269))
                                                            )
                                                            else
                                                                {7670}let pkDisco_6270: bitstring = fail-any in
                                                                {7671}in(c, (=pkCli_6226,m1_6271: bitstring,sigM1_6272: bitstring));
                                                                {7672}if (verify(h(m1_6271),sigM1_6272,pkCli_6226) <> true) then
                                                                    0
                                                                else
                                                                    {7673}let (SPc_6273: bitstring,PartC_6274: bitstring) = m1_6271 in
                                                                    {7674}new Ns_6275: bitstring;
                                                                    {7675}let m2_6276: bitstring = exp(g,Ns_6275) in
                                                                    {7676}out(c, (m2_6276,sign(h(m2_6276),skSess_6101)));
                                                                    {7677}let Ksrv_6277: bitstring = exp(PartC_6274,Ns_6275) in
                                                                    {7678}out(c, senc(mSrv(pkCli_6226,pkSess_6102),Ksrv_6277))
                                                    )
                                                    else
                                                        {7679}let pkDisco_6278: bitstring = fail-any in
                                                        {7680}in(c, (=pkCli_6226,m1_6279: bitstring,sigM1_6280: bitstring));
                                                        {7681}if (verify(h(m1_6279),sigM1_6280,pkCli_6226) <> true) then
                                                            0
                                                        else
                                                            {7682}let (SPc_6281: bitstring,PartC_6282: bitstring) = m1_6279 in
                                                            {7683}new Ns_6283: bitstring;
                                                            {7684}let m2_6284: bitstring = exp(g,Ns_6283) in
                                                            {7685}out(c, (m2_6284,sign(h(m2_6284),skSess_6101)));
                                                            {7686}let Ksrv_6285: bitstring = exp(PartC_6282,Ns_6283) in
                                                            {7687}out(c, senc(mSrv(pkCli_6226,pkSess_6102),Ksrv_6285))
                                                )
                                                else
                                                    {7688}let pkCli_6286: bitstring = pub(skI) in
                                                    {7689}let v_6287: bool = (Disco_4827 = A) in
                                                    (
                                                        {7690}if v_6287 then
                                                        (
                                                            {7691}let pkDisco_6288: bitstring = pub(skA) in
                                                            {7692}in(c, (=pkCli_6286,m1_6289: bitstring,sigM1_6290: bitstring));
                                                            {7693}if (verify(h(m1_6289),sigM1_6290,pkCli_6286) <> true) then
                                                                0
                                                            else
                                                                {7694}let (SPc_6291: bitstring,PartC_6292: bitstring) = m1_6289 in
                                                                {7695}new Ns_6293: bitstring;
                                                                {7696}let m2_6294: bitstring = exp(g,Ns_6293) in
                                                                {7697}out(c, (m2_6294,sign(h(m2_6294),skSess_6101)));
                                                                {7698}let Ksrv_6295: bitstring = exp(PartC_6292,Ns_6293) in
                                                                {7699}out(c, senc(mSrv(pkCli_6286,pkSess_6102),Ksrv_6295))
                                                        )
                                                        else
                                                            {7700}let v_6296: bool = (Disco_4827 = B) in
                                                            (
                                                                {7701}if v_6296 then
                                                                (
                                                                    {7702}let pkDisco_6297: bitstring = pub(skB) in
                                                                    {7703}in(c, (=pkCli_6286,m1_6298: bitstring,sigM1_6299: bitstring));
                                                                    {7704}if (verify(h(m1_6298),sigM1_6299,pkCli_6286) <> true) then
                                                                        0
                                                                    else
                                                                        {7705}let (SPc_6300: bitstring,PartC_6301: bitstring) = m1_6298 in
                                                                        {7706}new Ns_6302: bitstring;
                                                                        {7707}let m2_6303: bitstring = exp(g,Ns_6302) in
                                                                        {7708}out(c, (m2_6303,sign(h(m2_6303),skSess_6101)));
                                                                        {7709}let Ksrv_6304: bitstring = exp(PartC_6301,Ns_6302) in
                                                                        {7710}out(c, senc(mSrv(pkCli_6286,pkSess_6102),Ksrv_6304))
                                                                )
                                                                else
                                                                    {7711}let v_6305: bool = (Disco_4827 = C) in
                                                                    (
                                                                        {7712}if v_6305 then
                                                                        (
                                                                            {7713}let pkDisco_6306: bitstring = pub(skC) in
                                                                            {7714}in(c, (=pkCli_6286,m1_6307: bitstring,sigM1_6308: bitstring));
                                                                            {7715}if (verify(h(m1_6307),sigM1_6308,pkCli_6286) <> true) then
                                                                                0
                                                                            else
                                                                                {7716}let (SPc_6309: bitstring,PartC_6310: bitstring) = m1_6307 in
                                                                                {7717}new Ns_6311: bitstring;
                                                                                {7718}let m2_6312: bitstring = exp(g,Ns_6311) in
                                                                                {7719}out(c, (m2_6312,sign(h(m2_6312),skSess_6101)));
                                                                                {7720}let Ksrv_6313: bitstring = exp(PartC_6310,Ns_6311) in
                                                                                {7721}out(c, senc(mSrv(pkCli_6286,pkSess_6102),Ksrv_6313))
                                                                        )
                                                                        else
                                                                            {7722}let pkDisco_6314: bitstring = pub(skI) in
                                                                            {7723}in(c, (=pkCli_6286,m1_6315: bitstring,sigM1_6316: bitstring));
                                                                            {7724}if (verify(h(m1_6315),sigM1_6316,pkCli_6286) <> true) then
                                                                                0
                                                                            else
                                                                                {7725}let (SPc_6317: bitstring,PartC_6318: bitstring) = m1_6315 in
                                                                                {7726}new Ns_6319: bitstring;
                                                                                {7727}let m2_6320: bitstring = exp(g,Ns_6319) in
                                                                                {7728}out(c, (m2_6320,sign(h(m2_6320),skSess_6101)));
                                                                                {7729}let Ksrv_6321: bitstring = exp(PartC_6318,Ns_6319) in
                                                                                {7730}out(c, senc(mSrv(pkCli_6286,pkSess_6102),Ksrv_6321))
                                                                    )
                                                                    else
                                                                        {7731}let pkDisco_6322: bitstring = fail-any in
                                                                        {7732}in(c, (=pkCli_6286,m1_6323: bitstring,sigM1_6324: bitstring));
                                                                        {7733}if (verify(h(m1_6323),sigM1_6324,pkCli_6286) <> true) then
                                                                            0
                                                                        else
                                                                            {7734}let (SPc_6325: bitstring,PartC_6326: bitstring) = m1_6323 in
                                                                            {7735}new Ns_6327: bitstring;
                                                                            {7736}let m2_6328: bitstring = exp(g,Ns_6327) in
                                                                            {7737}out(c, (m2_6328,sign(h(m2_6328),skSess_6101)));
                                                                            {7738}let Ksrv_6329: bitstring = exp(PartC_6326,Ns_6327) in
                                                                            {7739}out(c, senc(mSrv(pkCli_6286,pkSess_6102),Ksrv_6329))
                                                            )
                                                            else
                                                                {7740}let pkDisco_6330: bitstring = fail-any in
                                                                {7741}in(c, (=pkCli_6286,m1_6331: bitstring,sigM1_6332: bitstring));
                                                                {7742}if (verify(h(m1_6331),sigM1_6332,pkCli_6286) <> true) then
                                                                    0
                                                                else
                                                                    {7743}let (SPc_6333: bitstring,PartC_6334: bitstring) = m1_6331 in
                                                                    {7744}new Ns_6335: bitstring;
                                                                    {7745}let m2_6336: bitstring = exp(g,Ns_6335) in
                                                                    {7746}out(c, (m2_6336,sign(h(m2_6336),skSess_6101)));
                                                                    {7747}let Ksrv_6337: bitstring = exp(PartC_6334,Ns_6335) in
                                                                    {7748}out(c, senc(mSrv(pkCli_6286,pkSess_6102),Ksrv_6337))
                                                    )
                                                    else
                                                        {7749}let pkDisco_6338: bitstring = fail-any in
                                                        {7750}in(c, (=pkCli_6286,m1_6339: bitstring,sigM1_6340: bitstring));
                                                        {7751}if (verify(h(m1_6339),sigM1_6340,pkCli_6286) <> true) then
                                                            0
                                                        else
                                                            {7752}let (SPc_6341: bitstring,PartC_6342: bitstring) = m1_6339 in
                                                            {7753}new Ns_6343: bitstring;
                                                            {7754}let m2_6344: bitstring = exp(g,Ns_6343) in
                                                            {7755}out(c, (m2_6344,sign(h(m2_6344),skSess_6101)));
                                                            {7756}let Ksrv_6345: bitstring = exp(PartC_6342,Ns_6343) in
                                                            {7757}out(c, senc(mSrv(pkCli_6286,pkSess_6102),Ksrv_6345))
                                            )
                                            else
                                                {7758}let pkCli_6346: bitstring = fail-any in
                                                {7759}let v_6347: bool = (Disco_4827 = A) in
                                                (
                                                    {7760}if v_6347 then
                                                    (
                                                        {7761}let pkDisco_6348: bitstring = pub(skA) in
                                                        {7762}in(c, (=pkCli_6346,m1_6349: bitstring,sigM1_6350: bitstring));
                                                        {7763}if (verify(h(m1_6349),sigM1_6350,pkCli_6346) <> true) then
                                                            0
                                                        else
                                                            {7764}let (SPc_6351: bitstring,PartC_6352: bitstring) = m1_6349 in
                                                            {7765}new Ns_6353: bitstring;
                                                            {7766}let m2_6354: bitstring = exp(g,Ns_6353) in
                                                            {7767}out(c, (m2_6354,sign(h(m2_6354),skSess_6101)));
                                                            {7768}let Ksrv_6355: bitstring = exp(PartC_6352,Ns_6353) in
                                                            {7769}out(c, senc(mSrv(pkCli_6346,pkSess_6102),Ksrv_6355))
                                                    )
                                                    else
                                                        {7770}let v_6356: bool = (Disco_4827 = B) in
                                                        (
                                                            {7771}if v_6356 then
                                                            (
                                                                {7772}let pkDisco_6357: bitstring = pub(skB) in
                                                                {7773}in(c, (=pkCli_6346,m1_6358: bitstring,sigM1_6359: bitstring));
                                                                {7774}if (verify(h(m1_6358),sigM1_6359,pkCli_6346) <> true) then
                                                                    0
                                                                else
                                                                    {7775}let (SPc_6360: bitstring,PartC_6361: bitstring) = m1_6358 in
                                                                    {7776}new Ns_6362: bitstring;
                                                                    {7777}let m2_6363: bitstring = exp(g,Ns_6362) in
                                                                    {7778}out(c, (m2_6363,sign(h(m2_6363),skSess_6101)));
                                                                    {7779}let Ksrv_6364: bitstring = exp(PartC_6361,Ns_6362) in
                                                                    {7780}out(c, senc(mSrv(pkCli_6346,pkSess_6102),Ksrv_6364))
                                                            )
                                                            else
                                                                {7781}let v_6365: bool = (Disco_4827 = C) in
                                                                (
                                                                    {7782}if v_6365 then
                                                                    (
                                                                        {7783}let pkDisco_6366: bitstring = pub(skC) in
                                                                        {7784}in(c, (=pkCli_6346,m1_6367: bitstring,sigM1_6368: bitstring));
                                                                        {7785}if (verify(h(m1_6367),sigM1_6368,pkCli_6346) <> true) then
                                                                            0
                                                                        else
                                                                            {7786}let (SPc_6369: bitstring,PartC_6370: bitstring) = m1_6367 in
                                                                            {7787}new Ns_6371: bitstring;
                                                                            {7788}let m2_6372: bitstring = exp(g,Ns_6371) in
                                                                            {7789}out(c, (m2_6372,sign(h(m2_6372),skSess_6101)));
                                                                            {7790}let Ksrv_6373: bitstring = exp(PartC_6370,Ns_6371) in
                                                                            {7791}out(c, senc(mSrv(pkCli_6346,pkSess_6102),Ksrv_6373))
                                                                    )
                                                                    else
                                                                        {7792}let pkDisco_6374: bitstring = pub(skI) in
                                                                        {7793}in(c, (=pkCli_6346,m1_6375: bitstring,sigM1_6376: bitstring));
                                                                        {7794}if (verify(h(m1_6375),sigM1_6376,pkCli_6346) <> true) then
                                                                            0
                                                                        else
                                                                            {7795}let (SPc_6377: bitstring,PartC_6378: bitstring) = m1_6375 in
                                                                            {7796}new Ns_6379: bitstring;
                                                                            {7797}let m2_6380: bitstring = exp(g,Ns_6379) in
                                                                            {7798}out(c, (m2_6380,sign(h(m2_6380),skSess_6101)));
                                                                            {7799}let Ksrv_6381: bitstring = exp(PartC_6378,Ns_6379) in
                                                                            {7800}out(c, senc(mSrv(pkCli_6346,pkSess_6102),Ksrv_6381))
                                                                )
                                                                else
                                                                    {7801}let pkDisco_6382: bitstring = fail-any in
                                                                    {7802}in(c, (=pkCli_6346,m1_6383: bitstring,sigM1_6384: bitstring));
                                                                    {7803}if (verify(h(m1_6383),sigM1_6384,pkCli_6346) <> true) then
                                                                        0
                                                                    else
                                                                        {7804}let (SPc_6385: bitstring,PartC_6386: bitstring) = m1_6383 in
                                                                        {7805}new Ns_6387: bitstring;
                                                                        {7806}let m2_6388: bitstring = exp(g,Ns_6387) in
                                                                        {7807}out(c, (m2_6388,sign(h(m2_6388),skSess_6101)));
                                                                        {7808}let Ksrv_6389: bitstring = exp(PartC_6386,Ns_6387) in
                                                                        {7809}out(c, senc(mSrv(pkCli_6346,pkSess_6102),Ksrv_6389))
                                                        )
                                                        else
                                                            {7810}let pkDisco_6390: bitstring = fail-any in
                                                            {7811}in(c, (=pkCli_6346,m1_6391: bitstring,sigM1_6392: bitstring));
                                                            {7812}if (verify(h(m1_6391),sigM1_6392,pkCli_6346) <> true) then
                                                                0
                                                            else
                                                                {7813}let (SPc_6393: bitstring,PartC_6394: bitstring) = m1_6391 in
                                                                {7814}new Ns_6395: bitstring;
                                                                {7815}let m2_6396: bitstring = exp(g,Ns_6395) in
                                                                {7816}out(c, (m2_6396,sign(h(m2_6396),skSess_6101)));
                                                                {7817}let Ksrv_6397: bitstring = exp(PartC_6394,Ns_6395) in
                                                                {7818}out(c, senc(mSrv(pkCli_6346,pkSess_6102),Ksrv_6397))
                                                )
                                                else
                                                    {7819}let pkDisco_6398: bitstring = fail-any in
                                                    {7820}in(c, (=pkCli_6346,m1_6399: bitstring,sigM1_6400: bitstring));
                                                    {7821}if (verify(h(m1_6399),sigM1_6400,pkCli_6346) <> true) then
                                                        0
                                                    else
                                                        {7822}let (SPc_6401: bitstring,PartC_6402: bitstring) = m1_6399 in
                                                        {7823}new Ns_6403: bitstring;
                                                        {7824}let m2_6404: bitstring = exp(g,Ns_6403) in
                                                        {7825}out(c, (m2_6404,sign(h(m2_6404),skSess_6101)));
                                                        {7826}let Ksrv_6405: bitstring = exp(PartC_6402,Ns_6403) in
                                                        {7827}out(c, senc(mSrv(pkCli_6346,pkSess_6102),Ksrv_6405))
                                    )
                                    else
                                        {7828}let pkCli_6406: bitstring = fail-any in
                                        {7829}let v_6407: bool = (Disco_4827 = A) in
                                        (
                                            {7830}if v_6407 then
                                            (
                                                {7831}let pkDisco_6408: bitstring = pub(skA) in
                                                {7832}in(c, (=pkCli_6406,m1_6409: bitstring,sigM1_6410: bitstring));
                                                {7833}if (verify(h(m1_6409),sigM1_6410,pkCli_6406) <> true) then
                                                    0
                                                else
                                                    {7834}let (SPc_6411: bitstring,PartC_6412: bitstring) = m1_6409 in
                                                    {7835}new Ns_6413: bitstring;
                                                    {7836}let m2_6414: bitstring = exp(g,Ns_6413) in
                                                    {7837}out(c, (m2_6414,sign(h(m2_6414),skSess_6101)));
                                                    {7838}let Ksrv_6415: bitstring = exp(PartC_6412,Ns_6413) in
                                                    {7839}out(c, senc(mSrv(pkCli_6406,pkSess_6102),Ksrv_6415))
                                            )
                                            else
                                                {7840}let v_6416: bool = (Disco_4827 = B) in
                                                (
                                                    {7841}if v_6416 then
                                                    (
                                                        {7842}let pkDisco_6417: bitstring = pub(skB) in
                                                        {7843}in(c, (=pkCli_6406,m1_6418: bitstring,sigM1_6419: bitstring));
                                                        {7844}if (verify(h(m1_6418),sigM1_6419,pkCli_6406) <> true) then
                                                            0
                                                        else
                                                            {7845}let (SPc_6420: bitstring,PartC_6421: bitstring) = m1_6418 in
                                                            {7846}new Ns_6422: bitstring;
                                                            {7847}let m2_6423: bitstring = exp(g,Ns_6422) in
                                                            {7848}out(c, (m2_6423,sign(h(m2_6423),skSess_6101)));
                                                            {7849}let Ksrv_6424: bitstring = exp(PartC_6421,Ns_6422) in
                                                            {7850}out(c, senc(mSrv(pkCli_6406,pkSess_6102),Ksrv_6424))
                                                    )
                                                    else
                                                        {7851}let v_6425: bool = (Disco_4827 = C) in
                                                        (
                                                            {7852}if v_6425 then
                                                            (
                                                                {7853}let pkDisco_6426: bitstring = pub(skC) in
                                                                {7854}in(c, (=pkCli_6406,m1_6427: bitstring,sigM1_6428: bitstring));
                                                                {7855}if (verify(h(m1_6427),sigM1_6428,pkCli_6406) <> true) then
                                                                    0
                                                                else
                                                                    {7856}let (SPc_6429: bitstring,PartC_6430: bitstring) = m1_6427 in
                                                                    {7857}new Ns_6431: bitstring;
                                                                    {7858}let m2_6432: bitstring = exp(g,Ns_6431) in
                                                                    {7859}out(c, (m2_6432,sign(h(m2_6432),skSess_6101)));
                                                                    {7860}let Ksrv_6433: bitstring = exp(PartC_6430,Ns_6431) in
                                                                    {7861}out(c, senc(mSrv(pkCli_6406,pkSess_6102),Ksrv_6433))
                                                            )
                                                            else
                                                                {7862}let pkDisco_6434: bitstring = pub(skI) in
                                                                {7863}in(c, (=pkCli_6406,m1_6435: bitstring,sigM1_6436: bitstring));
                                                                {7864}if (verify(h(m1_6435),sigM1_6436,pkCli_6406) <> true) then
                                                                    0
                                                                else
                                                                    {7865}let (SPc_6437: bitstring,PartC_6438: bitstring) = m1_6435 in
                                                                    {7866}new Ns_6439: bitstring;
                                                                    {7867}let m2_6440: bitstring = exp(g,Ns_6439) in
                                                                    {7868}out(c, (m2_6440,sign(h(m2_6440),skSess_6101)));
                                                                    {7869}let Ksrv_6441: bitstring = exp(PartC_6438,Ns_6439) in
                                                                    {7870}out(c, senc(mSrv(pkCli_6406,pkSess_6102),Ksrv_6441))
                                                        )
                                                        else
                                                            {7871}let pkDisco_6442: bitstring = fail-any in
                                                            {7872}in(c, (=pkCli_6406,m1_6443: bitstring,sigM1_6444: bitstring));
                                                            {7873}if (verify(h(m1_6443),sigM1_6444,pkCli_6406) <> true) then
                                                                0
                                                            else
                                                                {7874}let (SPc_6445: bitstring,PartC_6446: bitstring) = m1_6443 in
                                                                {7875}new Ns_6447: bitstring;
                                                                {7876}let m2_6448: bitstring = exp(g,Ns_6447) in
                                                                {7877}out(c, (m2_6448,sign(h(m2_6448),skSess_6101)));
                                                                {7878}let Ksrv_6449: bitstring = exp(PartC_6446,Ns_6447) in
                                                                {7879}out(c, senc(mSrv(pkCli_6406,pkSess_6102),Ksrv_6449))
                                                )
                                                else
                                                    {7880}let pkDisco_6450: bitstring = fail-any in
                                                    {7881}in(c, (=pkCli_6406,m1_6451: bitstring,sigM1_6452: bitstring));
                                                    {7882}if (verify(h(m1_6451),sigM1_6452,pkCli_6406) <> true) then
                                                        0
                                                    else
                                                        {7883}let (SPc_6453: bitstring,PartC_6454: bitstring) = m1_6451 in
                                                        {7884}new Ns_6455: bitstring;
                                                        {7885}let m2_6456: bitstring = exp(g,Ns_6455) in
                                                        {7886}out(c, (m2_6456,sign(h(m2_6456),skSess_6101)));
                                                        {7887}let Ksrv_6457: bitstring = exp(PartC_6454,Ns_6455) in
                                                        {7888}out(c, senc(mSrv(pkCli_6406,pkSess_6102),Ksrv_6457))
                                        )
                                        else
                                            {7889}let pkDisco_6458: bitstring = fail-any in
                                            {7890}in(c, (=pkCli_6406,m1_6459: bitstring,sigM1_6460: bitstring));
                                            {7891}if (verify(h(m1_6459),sigM1_6460,pkCli_6406) <> true) then
                                                0
                                            else
                                                {7892}let (SPc_6461: bitstring,PartC_6462: bitstring) = m1_6459 in
                                                {7893}new Ns_6463: bitstring;
                                                {7894}let m2_6464: bitstring = exp(g,Ns_6463) in
                                                {7895}out(c, (m2_6464,sign(h(m2_6464),skSess_6101)));
                                                {7896}let Ksrv_6465: bitstring = exp(PartC_6462,Ns_6463) in
                                                {7897}out(c, senc(mSrv(pkCli_6406,pkSess_6102),Ksrv_6465))
                            )
                            else
                                {7898}let pkCli_6466: bitstring = fail-any in
                                {7899}let v_6467: bool = (Disco_4827 = A) in
                                (
                                    {7900}if v_6467 then
                                    (
                                        {7901}let pkDisco_6468: bitstring = pub(skA) in
                                        {7902}in(c, (=pkCli_6466,m1_6469: bitstring,sigM1_6470: bitstring));
                                        {7903}if (verify(h(m1_6469),sigM1_6470,pkCli_6466) <> true) then
                                            0
                                        else
                                            {7904}let (SPc_6471: bitstring,PartC_6472: bitstring) = m1_6469 in
                                            {7905}new Ns_6473: bitstring;
                                            {7906}let m2_6474: bitstring = exp(g,Ns_6473) in
                                            {7907}out(c, (m2_6474,sign(h(m2_6474),skSess_6101)));
                                            {7908}let Ksrv_6475: bitstring = exp(PartC_6472,Ns_6473) in
                                            {7909}out(c, senc(mSrv(pkCli_6466,pkSess_6102),Ksrv_6475))
                                    )
                                    else
                                        {7910}let v_6476: bool = (Disco_4827 = B) in
                                        (
                                            {7911}if v_6476 then
                                            (
                                                {7912}let pkDisco_6477: bitstring = pub(skB) in
                                                {7913}in(c, (=pkCli_6466,m1_6478: bitstring,sigM1_6479: bitstring));
                                                {7914}if (verify(h(m1_6478),sigM1_6479,pkCli_6466) <> true) then
                                                    0
                                                else
                                                    {7915}let (SPc_6480: bitstring,PartC_6481: bitstring) = m1_6478 in
                                                    {7916}new Ns_6482: bitstring;
                                                    {7917}let m2_6483: bitstring = exp(g,Ns_6482) in
                                                    {7918}out(c, (m2_6483,sign(h(m2_6483),skSess_6101)));
                                                    {7919}let Ksrv_6484: bitstring = exp(PartC_6481,Ns_6482) in
                                                    {7920}out(c, senc(mSrv(pkCli_6466,pkSess_6102),Ksrv_6484))
                                            )
                                            else
                                                {7921}let v_6485: bool = (Disco_4827 = C) in
                                                (
                                                    {7922}if v_6485 then
                                                    (
                                                        {7923}let pkDisco_6486: bitstring = pub(skC) in
                                                        {7924}in(c, (=pkCli_6466,m1_6487: bitstring,sigM1_6488: bitstring));
                                                        {7925}if (verify(h(m1_6487),sigM1_6488,pkCli_6466) <> true) then
                                                            0
                                                        else
                                                            {7926}let (SPc_6489: bitstring,PartC_6490: bitstring) = m1_6487 in
                                                            {7927}new Ns_6491: bitstring;
                                                            {7928}let m2_6492: bitstring = exp(g,Ns_6491) in
                                                            {7929}out(c, (m2_6492,sign(h(m2_6492),skSess_6101)));
                                                            {7930}let Ksrv_6493: bitstring = exp(PartC_6490,Ns_6491) in
                                                            {7931}out(c, senc(mSrv(pkCli_6466,pkSess_6102),Ksrv_6493))
                                                    )
                                                    else
                                                        {7932}let pkDisco_6494: bitstring = pub(skI) in
                                                        {7933}in(c, (=pkCli_6466,m1_6495: bitstring,sigM1_6496: bitstring));
                                                        {7934}if (verify(h(m1_6495),sigM1_6496,pkCli_6466) <> true) then
                                                            0
                                                        else
                                                            {7935}let (SPc_6497: bitstring,PartC_6498: bitstring) = m1_6495 in
                                                            {7936}new Ns_6499: bitstring;
                                                            {7937}let m2_6500: bitstring = exp(g,Ns_6499) in
                                                            {7938}out(c, (m2_6500,sign(h(m2_6500),skSess_6101)));
                                                            {7939}let Ksrv_6501: bitstring = exp(PartC_6498,Ns_6499) in
                                                            {7940}out(c, senc(mSrv(pkCli_6466,pkSess_6102),Ksrv_6501))
                                                )
                                                else
                                                    {7941}let pkDisco_6502: bitstring = fail-any in
                                                    {7942}in(c, (=pkCli_6466,m1_6503: bitstring,sigM1_6504: bitstring));
                                                    {7943}if (verify(h(m1_6503),sigM1_6504,pkCli_6466) <> true) then
                                                        0
                                                    else
                                                        {7944}let (SPc_6505: bitstring,PartC_6506: bitstring) = m1_6503 in
                                                        {7945}new Ns_6507: bitstring;
                                                        {7946}let m2_6508: bitstring = exp(g,Ns_6507) in
                                                        {7947}out(c, (m2_6508,sign(h(m2_6508),skSess_6101)));
                                                        {7948}let Ksrv_6509: bitstring = exp(PartC_6506,Ns_6507) in
                                                        {7949}out(c, senc(mSrv(pkCli_6466,pkSess_6102),Ksrv_6509))
                                        )
                                        else
                                            {7950}let pkDisco_6510: bitstring = fail-any in
                                            {7951}in(c, (=pkCli_6466,m1_6511: bitstring,sigM1_6512: bitstring));
                                            {7952}if (verify(h(m1_6511),sigM1_6512,pkCli_6466) <> true) then
                                                0
                                            else
                                                {7953}let (SPc_6513: bitstring,PartC_6514: bitstring) = m1_6511 in
                                                {7954}new Ns_6515: bitstring;
                                                {7955}let m2_6516: bitstring = exp(g,Ns_6515) in
                                                {7956}out(c, (m2_6516,sign(h(m2_6516),skSess_6101)));
                                                {7957}let Ksrv_6517: bitstring = exp(PartC_6514,Ns_6515) in
                                                {7958}out(c, senc(mSrv(pkCli_6466,pkSess_6102),Ksrv_6517))
                                )
                                else
                                    {7959}let pkDisco_6518: bitstring = fail-any in
                                    {7960}in(c, (=pkCli_6466,m1_6519: bitstring,sigM1_6520: bitstring));
                                    {7961}if (verify(h(m1_6519),sigM1_6520,pkCli_6466) <> true) then
                                        0
                                    else
                                        {7962}let (SPc_6521: bitstring,PartC_6522: bitstring) = m1_6519 in
                                        {7963}new Ns_6523: bitstring;
                                        {7964}let m2_6524: bitstring = exp(g,Ns_6523) in
                                        {7965}out(c, (m2_6524,sign(h(m2_6524),skSess_6101)));
                                        {7966}let Ksrv_6525: bitstring = exp(PartC_6522,Ns_6523) in
                                        {7967}out(c, senc(mSrv(pkCli_6466,pkSess_6102),Ksrv_6525))
                    )
                    else
                        {7968}let skSess_6526: bitstring = fail-any in
                        {7969}let pkSess_6527: bitstring = pub(skSess_6526) in
                        {7970}let v_6528: bool = (Cli_4826 = A) in
                        (
                            {7971}if v_6528 then
                            (
                                {7972}let pkCli_6529: bitstring = pub(skA) in
                                {7973}let v_6530: bool = (Disco_4827 = A) in
                                (
                                    {7974}if v_6530 then
                                    (
                                        {7975}let pkDisco_6531: bitstring = pub(skA) in
                                        {7976}in(c, (=pkCli_6529,m1_6532: bitstring,sigM1_6533: bitstring));
                                        {7977}if (verify(h(m1_6532),sigM1_6533,pkCli_6529) <> true) then
                                            0
                                        else
                                            {7978}let (SPc_6534: bitstring,PartC_6535: bitstring) = m1_6532 in
                                            {7979}new Ns_6536: bitstring;
                                            {7980}let m2_6537: bitstring = exp(g,Ns_6536) in
                                            {7981}out(c, (m2_6537,sign(h(m2_6537),skSess_6526)));
                                            {7982}let Ksrv_6538: bitstring = exp(PartC_6535,Ns_6536) in
                                            {7983}out(c, senc(mSrv(pkCli_6529,pkSess_6527),Ksrv_6538))
                                    )
                                    else
                                        {7984}let v_6539: bool = (Disco_4827 = B) in
                                        (
                                            {7985}if v_6539 then
                                            (
                                                {7986}let pkDisco_6540: bitstring = pub(skB) in
                                                {7987}in(c, (=pkCli_6529,m1_6541: bitstring,sigM1_6542: bitstring));
                                                {7988}if (verify(h(m1_6541),sigM1_6542,pkCli_6529) <> true) then
                                                    0
                                                else
                                                    {7989}let (SPc_6543: bitstring,PartC_6544: bitstring) = m1_6541 in
                                                    {7990}new Ns_6545: bitstring;
                                                    {7991}let m2_6546: bitstring = exp(g,Ns_6545) in
                                                    {7992}out(c, (m2_6546,sign(h(m2_6546),skSess_6526)));
                                                    {7993}let Ksrv_6547: bitstring = exp(PartC_6544,Ns_6545) in
                                                    {7994}out(c, senc(mSrv(pkCli_6529,pkSess_6527),Ksrv_6547))
                                            )
                                            else
                                                {7995}let v_6548: bool = (Disco_4827 = C) in
                                                (
                                                    {7996}if v_6548 then
                                                    (
                                                        {7997}let pkDisco_6549: bitstring = pub(skC) in
                                                        {7998}in(c, (=pkCli_6529,m1_6550: bitstring,sigM1_6551: bitstring));
                                                        {7999}if (verify(h(m1_6550),sigM1_6551,pkCli_6529) <> true) then
                                                            0
                                                        else
                                                            {8000}let (SPc_6552: bitstring,PartC_6553: bitstring) = m1_6550 in
                                                            {8001}new Ns_6554: bitstring;
                                                            {8002}let m2_6555: bitstring = exp(g,Ns_6554) in
                                                            {8003}out(c, (m2_6555,sign(h(m2_6555),skSess_6526)));
                                                            {8004}let Ksrv_6556: bitstring = exp(PartC_6553,Ns_6554) in
                                                            {8005}out(c, senc(mSrv(pkCli_6529,pkSess_6527),Ksrv_6556))
                                                    )
                                                    else
                                                        {8006}let pkDisco_6557: bitstring = pub(skI) in
                                                        {8007}in(c, (=pkCli_6529,m1_6558: bitstring,sigM1_6559: bitstring));
                                                        {8008}if (verify(h(m1_6558),sigM1_6559,pkCli_6529) <> true) then
                                                            0
                                                        else
                                                            {8009}let (SPc_6560: bitstring,PartC_6561: bitstring) = m1_6558 in
                                                            {8010}new Ns_6562: bitstring;
                                                            {8011}let m2_6563: bitstring = exp(g,Ns_6562) in
                                                            {8012}out(c, (m2_6563,sign(h(m2_6563),skSess_6526)));
                                                            {8013}let Ksrv_6564: bitstring = exp(PartC_6561,Ns_6562) in
                                                            {8014}out(c, senc(mSrv(pkCli_6529,pkSess_6527),Ksrv_6564))
                                                )
                                                else
                                                    {8015}let pkDisco_6565: bitstring = fail-any in
                                                    {8016}in(c, (=pkCli_6529,m1_6566: bitstring,sigM1_6567: bitstring));
                                                    {8017}if (verify(h(m1_6566),sigM1_6567,pkCli_6529) <> true) then
                                                        0
                                                    else
                                                        {8018}let (SPc_6568: bitstring,PartC_6569: bitstring) = m1_6566 in
                                                        {8019}new Ns_6570: bitstring;
                                                        {8020}let m2_6571: bitstring = exp(g,Ns_6570) in
                                                        {8021}out(c, (m2_6571,sign(h(m2_6571),skSess_6526)));
                                                        {8022}let Ksrv_6572: bitstring = exp(PartC_6569,Ns_6570) in
                                                        {8023}out(c, senc(mSrv(pkCli_6529,pkSess_6527),Ksrv_6572))
                                        )
                                        else
                                            {8024}let pkDisco_6573: bitstring = fail-any in
                                            {8025}in(c, (=pkCli_6529,m1_6574: bitstring,sigM1_6575: bitstring));
                                            {8026}if (verify(h(m1_6574),sigM1_6575,pkCli_6529) <> true) then
                                                0
                                            else
                                                {8027}let (SPc_6576: bitstring,PartC_6577: bitstring) = m1_6574 in
                                                {8028}new Ns_6578: bitstring;
                                                {8029}let m2_6579: bitstring = exp(g,Ns_6578) in
                                                {8030}out(c, (m2_6579,sign(h(m2_6579),skSess_6526)));
                                                {8031}let Ksrv_6580: bitstring = exp(PartC_6577,Ns_6578) in
                                                {8032}out(c, senc(mSrv(pkCli_6529,pkSess_6527),Ksrv_6580))
                                )
                                else
                                    {8033}let pkDisco_6581: bitstring = fail-any in
                                    {8034}in(c, (=pkCli_6529,m1_6582: bitstring,sigM1_6583: bitstring));
                                    {8035}if (verify(h(m1_6582),sigM1_6583,pkCli_6529) <> true) then
                                        0
                                    else
                                        {8036}let (SPc_6584: bitstring,PartC_6585: bitstring) = m1_6582 in
                                        {8037}new Ns_6586: bitstring;
                                        {8038}let m2_6587: bitstring = exp(g,Ns_6586) in
                                        {8039}out(c, (m2_6587,sign(h(m2_6587),skSess_6526)));
                                        {8040}let Ksrv_6588: bitstring = exp(PartC_6585,Ns_6586) in
                                        {8041}out(c, senc(mSrv(pkCli_6529,pkSess_6527),Ksrv_6588))
                            )
                            else
                                {8042}let v_6589: bool = (Cli_4826 = B) in
                                (
                                    {8043}if v_6589 then
                                    (
                                        {8044}let pkCli_6590: bitstring = pub(skB) in
                                        {8045}let v_6591: bool = (Disco_4827 = A) in
                                        (
                                            {8046}if v_6591 then
                                            (
                                                {8047}let pkDisco_6592: bitstring = pub(skA) in
                                                {8048}in(c, (=pkCli_6590,m1_6593: bitstring,sigM1_6594: bitstring));
                                                {8049}if (verify(h(m1_6593),sigM1_6594,pkCli_6590) <> true) then
                                                    0
                                                else
                                                    {8050}let (SPc_6595: bitstring,PartC_6596: bitstring) = m1_6593 in
                                                    {8051}new Ns_6597: bitstring;
                                                    {8052}let m2_6598: bitstring = exp(g,Ns_6597) in
                                                    {8053}out(c, (m2_6598,sign(h(m2_6598),skSess_6526)));
                                                    {8054}let Ksrv_6599: bitstring = exp(PartC_6596,Ns_6597) in
                                                    {8055}out(c, senc(mSrv(pkCli_6590,pkSess_6527),Ksrv_6599))
                                            )
                                            else
                                                {8056}let v_6600: bool = (Disco_4827 = B) in
                                                (
                                                    {8057}if v_6600 then
                                                    (
                                                        {8058}let pkDisco_6601: bitstring = pub(skB) in
                                                        {8059}in(c, (=pkCli_6590,m1_6602: bitstring,sigM1_6603: bitstring));
                                                        {8060}if (verify(h(m1_6602),sigM1_6603,pkCli_6590) <> true) then
                                                            0
                                                        else
                                                            {8061}let (SPc_6604: bitstring,PartC_6605: bitstring) = m1_6602 in
                                                            {8062}new Ns_6606: bitstring;
                                                            {8063}let m2_6607: bitstring = exp(g,Ns_6606) in
                                                            {8064}out(c, (m2_6607,sign(h(m2_6607),skSess_6526)));
                                                            {8065}let Ksrv_6608: bitstring = exp(PartC_6605,Ns_6606) in
                                                            {8066}out(c, senc(mSrv(pkCli_6590,pkSess_6527),Ksrv_6608))
                                                    )
                                                    else
                                                        {8067}let v_6609: bool = (Disco_4827 = C) in
                                                        (
                                                            {8068}if v_6609 then
                                                            (
                                                                {8069}let pkDisco_6610: bitstring = pub(skC) in
                                                                {8070}in(c, (=pkCli_6590,m1_6611: bitstring,sigM1_6612: bitstring));
                                                                {8071}if (verify(h(m1_6611),sigM1_6612,pkCli_6590) <> true) then
                                                                    0
                                                                else
                                                                    {8072}let (SPc_6613: bitstring,PartC_6614: bitstring) = m1_6611 in
                                                                    {8073}new Ns_6615: bitstring;
                                                                    {8074}let m2_6616: bitstring = exp(g,Ns_6615) in
                                                                    {8075}out(c, (m2_6616,sign(h(m2_6616),skSess_6526)));
                                                                    {8076}let Ksrv_6617: bitstring = exp(PartC_6614,Ns_6615) in
                                                                    {8077}out(c, senc(mSrv(pkCli_6590,pkSess_6527),Ksrv_6617))
                                                            )
                                                            else
                                                                {8078}let pkDisco_6618: bitstring = pub(skI) in
                                                                {8079}in(c, (=pkCli_6590,m1_6619: bitstring,sigM1_6620: bitstring));
                                                                {8080}if (verify(h(m1_6619),sigM1_6620,pkCli_6590) <> true) then
                                                                    0
                                                                else
                                                                    {8081}let (SPc_6621: bitstring,PartC_6622: bitstring) = m1_6619 in
                                                                    {8082}new Ns_6623: bitstring;
                                                                    {8083}let m2_6624: bitstring = exp(g,Ns_6623) in
                                                                    {8084}out(c, (m2_6624,sign(h(m2_6624),skSess_6526)));
                                                                    {8085}let Ksrv_6625: bitstring = exp(PartC_6622,Ns_6623) in
                                                                    {8086}out(c, senc(mSrv(pkCli_6590,pkSess_6527),Ksrv_6625))
                                                        )
                                                        else
                                                            {8087}let pkDisco_6626: bitstring = fail-any in
                                                            {8088}in(c, (=pkCli_6590,m1_6627: bitstring,sigM1_6628: bitstring));
                                                            {8089}if (verify(h(m1_6627),sigM1_6628,pkCli_6590) <> true) then
                                                                0
                                                            else
                                                                {8090}let (SPc_6629: bitstring,PartC_6630: bitstring) = m1_6627 in
                                                                {8091}new Ns_6631: bitstring;
                                                                {8092}let m2_6632: bitstring = exp(g,Ns_6631) in
                                                                {8093}out(c, (m2_6632,sign(h(m2_6632),skSess_6526)));
                                                                {8094}let Ksrv_6633: bitstring = exp(PartC_6630,Ns_6631) in
                                                                {8095}out(c, senc(mSrv(pkCli_6590,pkSess_6527),Ksrv_6633))
                                                )
                                                else
                                                    {8096}let pkDisco_6634: bitstring = fail-any in
                                                    {8097}in(c, (=pkCli_6590,m1_6635: bitstring,sigM1_6636: bitstring));
                                                    {8098}if (verify(h(m1_6635),sigM1_6636,pkCli_6590) <> true) then
                                                        0
                                                    else
                                                        {8099}let (SPc_6637: bitstring,PartC_6638: bitstring) = m1_6635 in
                                                        {8100}new Ns_6639: bitstring;
                                                        {8101}let m2_6640: bitstring = exp(g,Ns_6639) in
                                                        {8102}out(c, (m2_6640,sign(h(m2_6640),skSess_6526)));
                                                        {8103}let Ksrv_6641: bitstring = exp(PartC_6638,Ns_6639) in
                                                        {8104}out(c, senc(mSrv(pkCli_6590,pkSess_6527),Ksrv_6641))
                                        )
                                        else
                                            {8105}let pkDisco_6642: bitstring = fail-any in
                                            {8106}in(c, (=pkCli_6590,m1_6643: bitstring,sigM1_6644: bitstring));
                                            {8107}if (verify(h(m1_6643),sigM1_6644,pkCli_6590) <> true) then
                                                0
                                            else
                                                {8108}let (SPc_6645: bitstring,PartC_6646: bitstring) = m1_6643 in
                                                {8109}new Ns_6647: bitstring;
                                                {8110}let m2_6648: bitstring = exp(g,Ns_6647) in
                                                {8111}out(c, (m2_6648,sign(h(m2_6648),skSess_6526)));
                                                {8112}let Ksrv_6649: bitstring = exp(PartC_6646,Ns_6647) in
                                                {8113}out(c, senc(mSrv(pkCli_6590,pkSess_6527),Ksrv_6649))
                                    )
                                    else
                                        {8114}let v_6650: bool = (Cli_4826 = C) in
                                        (
                                            {8115}if v_6650 then
                                            (
                                                {8116}let pkCli_6651: bitstring = pub(skC) in
                                                {8117}let v_6652: bool = (Disco_4827 = A) in
                                                (
                                                    {8118}if v_6652 then
                                                    (
                                                        {8119}let pkDisco_6653: bitstring = pub(skA) in
                                                        {8120}in(c, (=pkCli_6651,m1_6654: bitstring,sigM1_6655: bitstring));
                                                        {8121}if (verify(h(m1_6654),sigM1_6655,pkCli_6651) <> true) then
                                                            0
                                                        else
                                                            {8122}let (SPc_6656: bitstring,PartC_6657: bitstring) = m1_6654 in
                                                            {8123}new Ns_6658: bitstring;
                                                            {8124}let m2_6659: bitstring = exp(g,Ns_6658) in
                                                            {8125}out(c, (m2_6659,sign(h(m2_6659),skSess_6526)));
                                                            {8126}let Ksrv_6660: bitstring = exp(PartC_6657,Ns_6658) in
                                                            {8127}out(c, senc(mSrv(pkCli_6651,pkSess_6527),Ksrv_6660))
                                                    )
                                                    else
                                                        {8128}let v_6661: bool = (Disco_4827 = B) in
                                                        (
                                                            {8129}if v_6661 then
                                                            (
                                                                {8130}let pkDisco_6662: bitstring = pub(skB) in
                                                                {8131}in(c, (=pkCli_6651,m1_6663: bitstring,sigM1_6664: bitstring));
                                                                {8132}if (verify(h(m1_6663),sigM1_6664,pkCli_6651) <> true) then
                                                                    0
                                                                else
                                                                    {8133}let (SPc_6665: bitstring,PartC_6666: bitstring) = m1_6663 in
                                                                    {8134}new Ns_6667: bitstring;
                                                                    {8135}let m2_6668: bitstring = exp(g,Ns_6667) in
                                                                    {8136}out(c, (m2_6668,sign(h(m2_6668),skSess_6526)));
                                                                    {8137}let Ksrv_6669: bitstring = exp(PartC_6666,Ns_6667) in
                                                                    {8138}out(c, senc(mSrv(pkCli_6651,pkSess_6527),Ksrv_6669))
                                                            )
                                                            else
                                                                {8139}let v_6670: bool = (Disco_4827 = C) in
                                                                (
                                                                    {8140}if v_6670 then
                                                                    (
                                                                        {8141}let pkDisco_6671: bitstring = pub(skC) in
                                                                        {8142}in(c, (=pkCli_6651,m1_6672: bitstring,sigM1_6673: bitstring));
                                                                        {8143}if (verify(h(m1_6672),sigM1_6673,pkCli_6651) <> true) then
                                                                            0
                                                                        else
                                                                            {8144}let (SPc_6674: bitstring,PartC_6675: bitstring) = m1_6672 in
                                                                            {8145}new Ns_6676: bitstring;
                                                                            {8146}let m2_6677: bitstring = exp(g,Ns_6676) in
                                                                            {8147}out(c, (m2_6677,sign(h(m2_6677),skSess_6526)));
                                                                            {8148}let Ksrv_6678: bitstring = exp(PartC_6675,Ns_6676) in
                                                                            {8149}out(c, senc(mSrv(pkCli_6651,pkSess_6527),Ksrv_6678))
                                                                    )
                                                                    else
                                                                        {8150}let pkDisco_6679: bitstring = pub(skI) in
                                                                        {8151}in(c, (=pkCli_6651,m1_6680: bitstring,sigM1_6681: bitstring));
                                                                        {8152}if (verify(h(m1_6680),sigM1_6681,pkCli_6651) <> true) then
                                                                            0
                                                                        else
                                                                            {8153}let (SPc_6682: bitstring,PartC_6683: bitstring) = m1_6680 in
                                                                            {8154}new Ns_6684: bitstring;
                                                                            {8155}let m2_6685: bitstring = exp(g,Ns_6684) in
                                                                            {8156}out(c, (m2_6685,sign(h(m2_6685),skSess_6526)));
                                                                            {8157}let Ksrv_6686: bitstring = exp(PartC_6683,Ns_6684) in
                                                                            {8158}out(c, senc(mSrv(pkCli_6651,pkSess_6527),Ksrv_6686))
                                                                )
                                                                else
                                                                    {8159}let pkDisco_6687: bitstring = fail-any in
                                                                    {8160}in(c, (=pkCli_6651,m1_6688: bitstring,sigM1_6689: bitstring));
                                                                    {8161}if (verify(h(m1_6688),sigM1_6689,pkCli_6651) <> true) then
                                                                        0
                                                                    else
                                                                        {8162}let (SPc_6690: bitstring,PartC_6691: bitstring) = m1_6688 in
                                                                        {8163}new Ns_6692: bitstring;
                                                                        {8164}let m2_6693: bitstring = exp(g,Ns_6692) in
                                                                        {8165}out(c, (m2_6693,sign(h(m2_6693),skSess_6526)));
                                                                        {8166}let Ksrv_6694: bitstring = exp(PartC_6691,Ns_6692) in
                                                                        {8167}out(c, senc(mSrv(pkCli_6651,pkSess_6527),Ksrv_6694))
                                                        )
                                                        else
                                                            {8168}let pkDisco_6695: bitstring = fail-any in
                                                            {8169}in(c, (=pkCli_6651,m1_6696: bitstring,sigM1_6697: bitstring));
                                                            {8170}if (verify(h(m1_6696),sigM1_6697,pkCli_6651) <> true) then
                                                                0
                                                            else
                                                                {8171}let (SPc_6698: bitstring,PartC_6699: bitstring) = m1_6696 in
                                                                {8172}new Ns_6700: bitstring;
                                                                {8173}let m2_6701: bitstring = exp(g,Ns_6700) in
                                                                {8174}out(c, (m2_6701,sign(h(m2_6701),skSess_6526)));
                                                                {8175}let Ksrv_6702: bitstring = exp(PartC_6699,Ns_6700) in
                                                                {8176}out(c, senc(mSrv(pkCli_6651,pkSess_6527),Ksrv_6702))
                                                )
                                                else
                                                    {8177}let pkDisco_6703: bitstring = fail-any in
                                                    {8178}in(c, (=pkCli_6651,m1_6704: bitstring,sigM1_6705: bitstring));
                                                    {8179}if (verify(h(m1_6704),sigM1_6705,pkCli_6651) <> true) then
                                                        0
                                                    else
                                                        {8180}let (SPc_6706: bitstring,PartC_6707: bitstring) = m1_6704 in
                                                        {8181}new Ns_6708: bitstring;
                                                        {8182}let m2_6709: bitstring = exp(g,Ns_6708) in
                                                        {8183}out(c, (m2_6709,sign(h(m2_6709),skSess_6526)));
                                                        {8184}let Ksrv_6710: bitstring = exp(PartC_6707,Ns_6708) in
                                                        {8185}out(c, senc(mSrv(pkCli_6651,pkSess_6527),Ksrv_6710))
                                            )
                                            else
                                                {8186}let pkCli_6711: bitstring = pub(skI) in
                                                {8187}let v_6712: bool = (Disco_4827 = A) in
                                                (
                                                    {8188}if v_6712 then
                                                    (
                                                        {8189}let pkDisco_6713: bitstring = pub(skA) in
                                                        {8190}in(c, (=pkCli_6711,m1_6714: bitstring,sigM1_6715: bitstring));
                                                        {8191}if (verify(h(m1_6714),sigM1_6715,pkCli_6711) <> true) then
                                                            0
                                                        else
                                                            {8192}let (SPc_6716: bitstring,PartC_6717: bitstring) = m1_6714 in
                                                            {8193}new Ns_6718: bitstring;
                                                            {8194}let m2_6719: bitstring = exp(g,Ns_6718) in
                                                            {8195}out(c, (m2_6719,sign(h(m2_6719),skSess_6526)));
                                                            {8196}let Ksrv_6720: bitstring = exp(PartC_6717,Ns_6718) in
                                                            {8197}out(c, senc(mSrv(pkCli_6711,pkSess_6527),Ksrv_6720))
                                                    )
                                                    else
                                                        {8198}let v_6721: bool = (Disco_4827 = B) in
                                                        (
                                                            {8199}if v_6721 then
                                                            (
                                                                {8200}let pkDisco_6722: bitstring = pub(skB) in
                                                                {8201}in(c, (=pkCli_6711,m1_6723: bitstring,sigM1_6724: bitstring));
                                                                {8202}if (verify(h(m1_6723),sigM1_6724,pkCli_6711) <> true) then
                                                                    0
                                                                else
                                                                    {8203}let (SPc_6725: bitstring,PartC_6726: bitstring) = m1_6723 in
                                                                    {8204}new Ns_6727: bitstring;
                                                                    {8205}let m2_6728: bitstring = exp(g,Ns_6727) in
                                                                    {8206}out(c, (m2_6728,sign(h(m2_6728),skSess_6526)));
                                                                    {8207}let Ksrv_6729: bitstring = exp(PartC_6726,Ns_6727) in
                                                                    {8208}out(c, senc(mSrv(pkCli_6711,pkSess_6527),Ksrv_6729))
                                                            )
                                                            else
                                                                {8209}let v_6730: bool = (Disco_4827 = C) in
                                                                (
                                                                    {8210}if v_6730 then
                                                                    (
                                                                        {8211}let pkDisco_6731: bitstring = pub(skC) in
                                                                        {8212}in(c, (=pkCli_6711,m1_6732: bitstring,sigM1_6733: bitstring));
                                                                        {8213}if (verify(h(m1_6732),sigM1_6733,pkCli_6711) <> true) then
                                                                            0
                                                                        else
                                                                            {8214}let (SPc_6734: bitstring,PartC_6735: bitstring) = m1_6732 in
                                                                            {8215}new Ns_6736: bitstring;
                                                                            {8216}let m2_6737: bitstring = exp(g,Ns_6736) in
                                                                            {8217}out(c, (m2_6737,sign(h(m2_6737),skSess_6526)));
                                                                            {8218}let Ksrv_6738: bitstring = exp(PartC_6735,Ns_6736) in
                                                                            {8219}out(c, senc(mSrv(pkCli_6711,pkSess_6527),Ksrv_6738))
                                                                    )
                                                                    else
                                                                        {8220}let pkDisco_6739: bitstring = pub(skI) in
                                                                        {8221}in(c, (=pkCli_6711,m1_6740: bitstring,sigM1_6741: bitstring));
                                                                        {8222}if (verify(h(m1_6740),sigM1_6741,pkCli_6711) <> true) then
                                                                            0
                                                                        else
                                                                            {8223}let (SPc_6742: bitstring,PartC_6743: bitstring) = m1_6740 in
                                                                            {8224}new Ns_6744: bitstring;
                                                                            {8225}let m2_6745: bitstring = exp(g,Ns_6744) in
                                                                            {8226}out(c, (m2_6745,sign(h(m2_6745),skSess_6526)));
                                                                            {8227}let Ksrv_6746: bitstring = exp(PartC_6743,Ns_6744) in
                                                                            {8228}out(c, senc(mSrv(pkCli_6711,pkSess_6527),Ksrv_6746))
                                                                )
                                                                else
                                                                    {8229}let pkDisco_6747: bitstring = fail-any in
                                                                    {8230}in(c, (=pkCli_6711,m1_6748: bitstring,sigM1_6749: bitstring));
                                                                    {8231}if (verify(h(m1_6748),sigM1_6749,pkCli_6711) <> true) then
                                                                        0
                                                                    else
                                                                        {8232}let (SPc_6750: bitstring,PartC_6751: bitstring) = m1_6748 in
                                                                        {8233}new Ns_6752: bitstring;
                                                                        {8234}let m2_6753: bitstring = exp(g,Ns_6752) in
                                                                        {8235}out(c, (m2_6753,sign(h(m2_6753),skSess_6526)));
                                                                        {8236}let Ksrv_6754: bitstring = exp(PartC_6751,Ns_6752) in
                                                                        {8237}out(c, senc(mSrv(pkCli_6711,pkSess_6527),Ksrv_6754))
                                                        )
                                                        else
                                                            {8238}let pkDisco_6755: bitstring = fail-any in
                                                            {8239}in(c, (=pkCli_6711,m1_6756: bitstring,sigM1_6757: bitstring));
                                                            {8240}if (verify(h(m1_6756),sigM1_6757,pkCli_6711) <> true) then
                                                                0
                                                            else
                                                                {8241}let (SPc_6758: bitstring,PartC_6759: bitstring) = m1_6756 in
                                                                {8242}new Ns_6760: bitstring;
                                                                {8243}let m2_6761: bitstring = exp(g,Ns_6760) in
                                                                {8244}out(c, (m2_6761,sign(h(m2_6761),skSess_6526)));
                                                                {8245}let Ksrv_6762: bitstring = exp(PartC_6759,Ns_6760) in
                                                                {8246}out(c, senc(mSrv(pkCli_6711,pkSess_6527),Ksrv_6762))
                                                )
                                                else
                                                    {8247}let pkDisco_6763: bitstring = fail-any in
                                                    {8248}in(c, (=pkCli_6711,m1_6764: bitstring,sigM1_6765: bitstring));
                                                    {8249}if (verify(h(m1_6764),sigM1_6765,pkCli_6711) <> true) then
                                                        0
                                                    else
                                                        {8250}let (SPc_6766: bitstring,PartC_6767: bitstring) = m1_6764 in
                                                        {8251}new Ns_6768: bitstring;
                                                        {8252}let m2_6769: bitstring = exp(g,Ns_6768) in
                                                        {8253}out(c, (m2_6769,sign(h(m2_6769),skSess_6526)));
                                                        {8254}let Ksrv_6770: bitstring = exp(PartC_6767,Ns_6768) in
                                                        {8255}out(c, senc(mSrv(pkCli_6711,pkSess_6527),Ksrv_6770))
                                        )
                                        else
                                            {8256}let pkCli_6771: bitstring = fail-any in
                                            {8257}let v_6772: bool = (Disco_4827 = A) in
                                            (
                                                {8258}if v_6772 then
                                                (
                                                    {8259}let pkDisco_6773: bitstring = pub(skA) in
                                                    {8260}in(c, (=pkCli_6771,m1_6774: bitstring,sigM1_6775: bitstring));
                                                    {8261}if (verify(h(m1_6774),sigM1_6775,pkCli_6771) <> true) then
                                                        0
                                                    else
                                                        {8262}let (SPc_6776: bitstring,PartC_6777: bitstring) = m1_6774 in
                                                        {8263}new Ns_6778: bitstring;
                                                        {8264}let m2_6779: bitstring = exp(g,Ns_6778) in
                                                        {8265}out(c, (m2_6779,sign(h(m2_6779),skSess_6526)));
                                                        {8266}let Ksrv_6780: bitstring = exp(PartC_6777,Ns_6778) in
                                                        {8267}out(c, senc(mSrv(pkCli_6771,pkSess_6527),Ksrv_6780))
                                                )
                                                else
                                                    {8268}let v_6781: bool = (Disco_4827 = B) in
                                                    (
                                                        {8269}if v_6781 then
                                                        (
                                                            {8270}let pkDisco_6782: bitstring = pub(skB) in
                                                            {8271}in(c, (=pkCli_6771,m1_6783: bitstring,sigM1_6784: bitstring));
                                                            {8272}if (verify(h(m1_6783),sigM1_6784,pkCli_6771) <> true) then
                                                                0
                                                            else
                                                                {8273}let (SPc_6785: bitstring,PartC_6786: bitstring) = m1_6783 in
                                                                {8274}new Ns_6787: bitstring;
                                                                {8275}let m2_6788: bitstring = exp(g,Ns_6787) in
                                                                {8276}out(c, (m2_6788,sign(h(m2_6788),skSess_6526)));
                                                                {8277}let Ksrv_6789: bitstring = exp(PartC_6786,Ns_6787) in
                                                                {8278}out(c, senc(mSrv(pkCli_6771,pkSess_6527),Ksrv_6789))
                                                        )
                                                        else
                                                            {8279}let v_6790: bool = (Disco_4827 = C) in
                                                            (
                                                                {8280}if v_6790 then
                                                                (
                                                                    {8281}let pkDisco_6791: bitstring = pub(skC) in
                                                                    {8282}in(c, (=pkCli_6771,m1_6792: bitstring,sigM1_6793: bitstring));
                                                                    {8283}if (verify(h(m1_6792),sigM1_6793,pkCli_6771) <> true) then
                                                                        0
                                                                    else
                                                                        {8284}let (SPc_6794: bitstring,PartC_6795: bitstring) = m1_6792 in
                                                                        {8285}new Ns_6796: bitstring;
                                                                        {8286}let m2_6797: bitstring = exp(g,Ns_6796) in
                                                                        {8287}out(c, (m2_6797,sign(h(m2_6797),skSess_6526)));
                                                                        {8288}let Ksrv_6798: bitstring = exp(PartC_6795,Ns_6796) in
                                                                        {8289}out(c, senc(mSrv(pkCli_6771,pkSess_6527),Ksrv_6798))
                                                                )
                                                                else
                                                                    {8290}let pkDisco_6799: bitstring = pub(skI) in
                                                                    {8291}in(c, (=pkCli_6771,m1_6800: bitstring,sigM1_6801: bitstring));
                                                                    {8292}if (verify(h(m1_6800),sigM1_6801,pkCli_6771) <> true) then
                                                                        0
                                                                    else
                                                                        {8293}let (SPc_6802: bitstring,PartC_6803: bitstring) = m1_6800 in
                                                                        {8294}new Ns_6804: bitstring;
                                                                        {8295}let m2_6805: bitstring = exp(g,Ns_6804) in
                                                                        {8296}out(c, (m2_6805,sign(h(m2_6805),skSess_6526)));
                                                                        {8297}let Ksrv_6806: bitstring = exp(PartC_6803,Ns_6804) in
                                                                        {8298}out(c, senc(mSrv(pkCli_6771,pkSess_6527),Ksrv_6806))
                                                            )
                                                            else
                                                                {8299}let pkDisco_6807: bitstring = fail-any in
                                                                {8300}in(c, (=pkCli_6771,m1_6808: bitstring,sigM1_6809: bitstring));
                                                                {8301}if (verify(h(m1_6808),sigM1_6809,pkCli_6771) <> true) then
                                                                    0
                                                                else
                                                                    {8302}let (SPc_6810: bitstring,PartC_6811: bitstring) = m1_6808 in
                                                                    {8303}new Ns_6812: bitstring;
                                                                    {8304}let m2_6813: bitstring = exp(g,Ns_6812) in
                                                                    {8305}out(c, (m2_6813,sign(h(m2_6813),skSess_6526)));
                                                                    {8306}let Ksrv_6814: bitstring = exp(PartC_6811,Ns_6812) in
                                                                    {8307}out(c, senc(mSrv(pkCli_6771,pkSess_6527),Ksrv_6814))
                                                    )
                                                    else
                                                        {8308}let pkDisco_6815: bitstring = fail-any in
                                                        {8309}in(c, (=pkCli_6771,m1_6816: bitstring,sigM1_6817: bitstring));
                                                        {8310}if (verify(h(m1_6816),sigM1_6817,pkCli_6771) <> true) then
                                                            0
                                                        else
                                                            {8311}let (SPc_6818: bitstring,PartC_6819: bitstring) = m1_6816 in
                                                            {8312}new Ns_6820: bitstring;
                                                            {8313}let m2_6821: bitstring = exp(g,Ns_6820) in
                                                            {8314}out(c, (m2_6821,sign(h(m2_6821),skSess_6526)));
                                                            {8315}let Ksrv_6822: bitstring = exp(PartC_6819,Ns_6820) in
                                                            {8316}out(c, senc(mSrv(pkCli_6771,pkSess_6527),Ksrv_6822))
                                            )
                                            else
                                                {8317}let pkDisco_6823: bitstring = fail-any in
                                                {8318}in(c, (=pkCli_6771,m1_6824: bitstring,sigM1_6825: bitstring));
                                                {8319}if (verify(h(m1_6824),sigM1_6825,pkCli_6771) <> true) then
                                                    0
                                                else
                                                    {8320}let (SPc_6826: bitstring,PartC_6827: bitstring) = m1_6824 in
                                                    {8321}new Ns_6828: bitstring;
                                                    {8322}let m2_6829: bitstring = exp(g,Ns_6828) in
                                                    {8323}out(c, (m2_6829,sign(h(m2_6829),skSess_6526)));
                                                    {8324}let Ksrv_6830: bitstring = exp(PartC_6827,Ns_6828) in
                                                    {8325}out(c, senc(mSrv(pkCli_6771,pkSess_6527),Ksrv_6830))
                                )
                                else
                                    {8326}let pkCli_6831: bitstring = fail-any in
                                    {8327}let v_6832: bool = (Disco_4827 = A) in
                                    (
                                        {8328}if v_6832 then
                                        (
                                            {8329}let pkDisco_6833: bitstring = pub(skA) in
                                            {8330}in(c, (=pkCli_6831,m1_6834: bitstring,sigM1_6835: bitstring));
                                            {8331}if (verify(h(m1_6834),sigM1_6835,pkCli_6831) <> true) then
                                                0
                                            else
                                                {8332}let (SPc_6836: bitstring,PartC_6837: bitstring) = m1_6834 in
                                                {8333}new Ns_6838: bitstring;
                                                {8334}let m2_6839: bitstring = exp(g,Ns_6838) in
                                                {8335}out(c, (m2_6839,sign(h(m2_6839),skSess_6526)));
                                                {8336}let Ksrv_6840: bitstring = exp(PartC_6837,Ns_6838) in
                                                {8337}out(c, senc(mSrv(pkCli_6831,pkSess_6527),Ksrv_6840))
                                        )
                                        else
                                            {8338}let v_6841: bool = (Disco_4827 = B) in
                                            (
                                                {8339}if v_6841 then
                                                (
                                                    {8340}let pkDisco_6842: bitstring = pub(skB) in
                                                    {8341}in(c, (=pkCli_6831,m1_6843: bitstring,sigM1_6844: bitstring));
                                                    {8342}if (verify(h(m1_6843),sigM1_6844,pkCli_6831) <> true) then
                                                        0
                                                    else
                                                        {8343}let (SPc_6845: bitstring,PartC_6846: bitstring) = m1_6843 in
                                                        {8344}new Ns_6847: bitstring;
                                                        {8345}let m2_6848: bitstring = exp(g,Ns_6847) in
                                                        {8346}out(c, (m2_6848,sign(h(m2_6848),skSess_6526)));
                                                        {8347}let Ksrv_6849: bitstring = exp(PartC_6846,Ns_6847) in
                                                        {8348}out(c, senc(mSrv(pkCli_6831,pkSess_6527),Ksrv_6849))
                                                )
                                                else
                                                    {8349}let v_6850: bool = (Disco_4827 = C) in
                                                    (
                                                        {8350}if v_6850 then
                                                        (
                                                            {8351}let pkDisco_6851: bitstring = pub(skC) in
                                                            {8352}in(c, (=pkCli_6831,m1_6852: bitstring,sigM1_6853: bitstring));
                                                            {8353}if (verify(h(m1_6852),sigM1_6853,pkCli_6831) <> true) then
                                                                0
                                                            else
                                                                {8354}let (SPc_6854: bitstring,PartC_6855: bitstring) = m1_6852 in
                                                                {8355}new Ns_6856: bitstring;
                                                                {8356}let m2_6857: bitstring = exp(g,Ns_6856) in
                                                                {8357}out(c, (m2_6857,sign(h(m2_6857),skSess_6526)));
                                                                {8358}let Ksrv_6858: bitstring = exp(PartC_6855,Ns_6856) in
                                                                {8359}out(c, senc(mSrv(pkCli_6831,pkSess_6527),Ksrv_6858))
                                                        )
                                                        else
                                                            {8360}let pkDisco_6859: bitstring = pub(skI) in
                                                            {8361}in(c, (=pkCli_6831,m1_6860: bitstring,sigM1_6861: bitstring));
                                                            {8362}if (verify(h(m1_6860),sigM1_6861,pkCli_6831) <> true) then
                                                                0
                                                            else
                                                                {8363}let (SPc_6862: bitstring,PartC_6863: bitstring) = m1_6860 in
                                                                {8364}new Ns_6864: bitstring;
                                                                {8365}let m2_6865: bitstring = exp(g,Ns_6864) in
                                                                {8366}out(c, (m2_6865,sign(h(m2_6865),skSess_6526)));
                                                                {8367}let Ksrv_6866: bitstring = exp(PartC_6863,Ns_6864) in
                                                                {8368}out(c, senc(mSrv(pkCli_6831,pkSess_6527),Ksrv_6866))
                                                    )
                                                    else
                                                        {8369}let pkDisco_6867: bitstring = fail-any in
                                                        {8370}in(c, (=pkCli_6831,m1_6868: bitstring,sigM1_6869: bitstring));
                                                        {8371}if (verify(h(m1_6868),sigM1_6869,pkCli_6831) <> true) then
                                                            0
                                                        else
                                                            {8372}let (SPc_6870: bitstring,PartC_6871: bitstring) = m1_6868 in
                                                            {8373}new Ns_6872: bitstring;
                                                            {8374}let m2_6873: bitstring = exp(g,Ns_6872) in
                                                            {8375}out(c, (m2_6873,sign(h(m2_6873),skSess_6526)));
                                                            {8376}let Ksrv_6874: bitstring = exp(PartC_6871,Ns_6872) in
                                                            {8377}out(c, senc(mSrv(pkCli_6831,pkSess_6527),Ksrv_6874))
                                            )
                                            else
                                                {8378}let pkDisco_6875: bitstring = fail-any in
                                                {8379}in(c, (=pkCli_6831,m1_6876: bitstring,sigM1_6877: bitstring));
                                                {8380}if (verify(h(m1_6876),sigM1_6877,pkCli_6831) <> true) then
                                                    0
                                                else
                                                    {8381}let (SPc_6878: bitstring,PartC_6879: bitstring) = m1_6876 in
                                                    {8382}new Ns_6880: bitstring;
                                                    {8383}let m2_6881: bitstring = exp(g,Ns_6880) in
                                                    {8384}out(c, (m2_6881,sign(h(m2_6881),skSess_6526)));
                                                    {8385}let Ksrv_6882: bitstring = exp(PartC_6879,Ns_6880) in
                                                    {8386}out(c, senc(mSrv(pkCli_6831,pkSess_6527),Ksrv_6882))
                                    )
                                    else
                                        {8387}let pkDisco_6883: bitstring = fail-any in
                                        {8388}in(c, (=pkCli_6831,m1_6884: bitstring,sigM1_6885: bitstring));
                                        {8389}if (verify(h(m1_6884),sigM1_6885,pkCli_6831) <> true) then
                                            0
                                        else
                                            {8390}let (SPc_6886: bitstring,PartC_6887: bitstring) = m1_6884 in
                                            {8391}new Ns_6888: bitstring;
                                            {8392}let m2_6889: bitstring = exp(g,Ns_6888) in
                                            {8393}out(c, (m2_6889,sign(h(m2_6889),skSess_6526)));
                                            {8394}let Ksrv_6890: bitstring = exp(PartC_6887,Ns_6888) in
                                            {8395}out(c, senc(mSrv(pkCli_6831,pkSess_6527),Ksrv_6890))
                        )
                        else
                            {8396}let pkCli_6891: bitstring = fail-any in
                            {8397}let v_6892: bool = (Disco_4827 = A) in
                            (
                                {8398}if v_6892 then
                                (
                                    {8399}let pkDisco_6893: bitstring = pub(skA) in
                                    {8400}in(c, (=pkCli_6891,m1_6894: bitstring,sigM1_6895: bitstring));
                                    {8401}if (verify(h(m1_6894),sigM1_6895,pkCli_6891) <> true) then
                                        0
                                    else
                                        {8402}let (SPc_6896: bitstring,PartC_6897: bitstring) = m1_6894 in
                                        {8403}new Ns_6898: bitstring;
                                        {8404}let m2_6899: bitstring = exp(g,Ns_6898) in
                                        {8405}out(c, (m2_6899,sign(h(m2_6899),skSess_6526)));
                                        {8406}let Ksrv_6900: bitstring = exp(PartC_6897,Ns_6898) in
                                        {8407}out(c, senc(mSrv(pkCli_6891,pkSess_6527),Ksrv_6900))
                                )
                                else
                                    {8408}let v_6901: bool = (Disco_4827 = B) in
                                    (
                                        {8409}if v_6901 then
                                        (
                                            {8410}let pkDisco_6902: bitstring = pub(skB) in
                                            {8411}in(c, (=pkCli_6891,m1_6903: bitstring,sigM1_6904: bitstring));
                                            {8412}if (verify(h(m1_6903),sigM1_6904,pkCli_6891) <> true) then
                                                0
                                            else
                                                {8413}let (SPc_6905: bitstring,PartC_6906: bitstring) = m1_6903 in
                                                {8414}new Ns_6907: bitstring;
                                                {8415}let m2_6908: bitstring = exp(g,Ns_6907) in
                                                {8416}out(c, (m2_6908,sign(h(m2_6908),skSess_6526)));
                                                {8417}let Ksrv_6909: bitstring = exp(PartC_6906,Ns_6907) in
                                                {8418}out(c, senc(mSrv(pkCli_6891,pkSess_6527),Ksrv_6909))
                                        )
                                        else
                                            {8419}let v_6910: bool = (Disco_4827 = C) in
                                            (
                                                {8420}if v_6910 then
                                                (
                                                    {8421}let pkDisco_6911: bitstring = pub(skC) in
                                                    {8422}in(c, (=pkCli_6891,m1_6912: bitstring,sigM1_6913: bitstring));
                                                    {8423}if (verify(h(m1_6912),sigM1_6913,pkCli_6891) <> true) then
                                                        0
                                                    else
                                                        {8424}let (SPc_6914: bitstring,PartC_6915: bitstring) = m1_6912 in
                                                        {8425}new Ns_6916: bitstring;
                                                        {8426}let m2_6917: bitstring = exp(g,Ns_6916) in
                                                        {8427}out(c, (m2_6917,sign(h(m2_6917),skSess_6526)));
                                                        {8428}let Ksrv_6918: bitstring = exp(PartC_6915,Ns_6916) in
                                                        {8429}out(c, senc(mSrv(pkCli_6891,pkSess_6527),Ksrv_6918))
                                                )
                                                else
                                                    {8430}let pkDisco_6919: bitstring = pub(skI) in
                                                    {8431}in(c, (=pkCli_6891,m1_6920: bitstring,sigM1_6921: bitstring));
                                                    {8432}if (verify(h(m1_6920),sigM1_6921,pkCli_6891) <> true) then
                                                        0
                                                    else
                                                        {8433}let (SPc_6922: bitstring,PartC_6923: bitstring) = m1_6920 in
                                                        {8434}new Ns_6924: bitstring;
                                                        {8435}let m2_6925: bitstring = exp(g,Ns_6924) in
                                                        {8436}out(c, (m2_6925,sign(h(m2_6925),skSess_6526)));
                                                        {8437}let Ksrv_6926: bitstring = exp(PartC_6923,Ns_6924) in
                                                        {8438}out(c, senc(mSrv(pkCli_6891,pkSess_6527),Ksrv_6926))
                                            )
                                            else
                                                {8439}let pkDisco_6927: bitstring = fail-any in
                                                {8440}in(c, (=pkCli_6891,m1_6928: bitstring,sigM1_6929: bitstring));
                                                {8441}if (verify(h(m1_6928),sigM1_6929,pkCli_6891) <> true) then
                                                    0
                                                else
                                                    {8442}let (SPc_6930: bitstring,PartC_6931: bitstring) = m1_6928 in
                                                    {8443}new Ns_6932: bitstring;
                                                    {8444}let m2_6933: bitstring = exp(g,Ns_6932) in
                                                    {8445}out(c, (m2_6933,sign(h(m2_6933),skSess_6526)));
                                                    {8446}let Ksrv_6934: bitstring = exp(PartC_6931,Ns_6932) in
                                                    {8447}out(c, senc(mSrv(pkCli_6891,pkSess_6527),Ksrv_6934))
                                    )
                                    else
                                        {8448}let pkDisco_6935: bitstring = fail-any in
                                        {8449}in(c, (=pkCli_6891,m1_6936: bitstring,sigM1_6937: bitstring));
                                        {8450}if (verify(h(m1_6936),sigM1_6937,pkCli_6891) <> true) then
                                            0
                                        else
                                            {8451}let (SPc_6938: bitstring,PartC_6939: bitstring) = m1_6936 in
                                            {8452}new Ns_6940: bitstring;
                                            {8453}let m2_6941: bitstring = exp(g,Ns_6940) in
                                            {8454}out(c, (m2_6941,sign(h(m2_6941),skSess_6526)));
                                            {8455}let Ksrv_6942: bitstring = exp(PartC_6939,Ns_6940) in
                                            {8456}out(c, senc(mSrv(pkCli_6891,pkSess_6527),Ksrv_6942))
                            )
                            else
                                {8457}let pkDisco_6943: bitstring = fail-any in
                                {8458}in(c, (=pkCli_6891,m1_6944: bitstring,sigM1_6945: bitstring));
                                {8459}if (verify(h(m1_6944),sigM1_6945,pkCli_6891) <> true) then
                                    0
                                else
                                    {8460}let (SPc_6946: bitstring,PartC_6947: bitstring) = m1_6944 in
                                    {8461}new Ns_6948: bitstring;
                                    {8462}let m2_6949: bitstring = exp(g,Ns_6948) in
                                    {8463}out(c, (m2_6949,sign(h(m2_6949),skSess_6526)));
                                    {8464}let Ksrv_6950: bitstring = exp(PartC_6947,Ns_6948) in
                                    {8465}out(c, senc(mSrv(pkCli_6891,pkSess_6527),Ksrv_6950))
            )
            else
                {8466}let skSess_6951: bitstring = fail-any in
                {8467}let pkSess_6952: bitstring = pub(skSess_6951) in
                {8468}let v_6953: bool = (Cli_4826 = A) in
                (
                    {8469}if v_6953 then
                    (
                        {8470}let pkCli_6954: bitstring = pub(skA) in
                        {8471}let v_6955: bool = (Disco_4827 = A) in
                        (
                            {8472}if v_6955 then
                            (
                                {8473}let pkDisco_6956: bitstring = pub(skA) in
                                {8474}in(c, (=pkCli_6954,m1_6957: bitstring,sigM1_6958: bitstring));
                                {8475}if (verify(h(m1_6957),sigM1_6958,pkCli_6954) <> true) then
                                    0
                                else
                                    {8476}let (SPc_6959: bitstring,PartC_6960: bitstring) = m1_6957 in
                                    {8477}new Ns_6961: bitstring;
                                    {8478}let m2_6962: bitstring = exp(g,Ns_6961) in
                                    {8479}out(c, (m2_6962,sign(h(m2_6962),skSess_6951)));
                                    {8480}let Ksrv_6963: bitstring = exp(PartC_6960,Ns_6961) in
                                    {8481}out(c, senc(mSrv(pkCli_6954,pkSess_6952),Ksrv_6963))
                            )
                            else
                                {8482}let v_6964: bool = (Disco_4827 = B) in
                                (
                                    {8483}if v_6964 then
                                    (
                                        {8484}let pkDisco_6965: bitstring = pub(skB) in
                                        {8485}in(c, (=pkCli_6954,m1_6966: bitstring,sigM1_6967: bitstring));
                                        {8486}if (verify(h(m1_6966),sigM1_6967,pkCli_6954) <> true) then
                                            0
                                        else
                                            {8487}let (SPc_6968: bitstring,PartC_6969: bitstring) = m1_6966 in
                                            {8488}new Ns_6970: bitstring;
                                            {8489}let m2_6971: bitstring = exp(g,Ns_6970) in
                                            {8490}out(c, (m2_6971,sign(h(m2_6971),skSess_6951)));
                                            {8491}let Ksrv_6972: bitstring = exp(PartC_6969,Ns_6970) in
                                            {8492}out(c, senc(mSrv(pkCli_6954,pkSess_6952),Ksrv_6972))
                                    )
                                    else
                                        {8493}let v_6973: bool = (Disco_4827 = C) in
                                        (
                                            {8494}if v_6973 then
                                            (
                                                {8495}let pkDisco_6974: bitstring = pub(skC) in
                                                {8496}in(c, (=pkCli_6954,m1_6975: bitstring,sigM1_6976: bitstring));
                                                {8497}if (verify(h(m1_6975),sigM1_6976,pkCli_6954) <> true) then
                                                    0
                                                else
                                                    {8498}let (SPc_6977: bitstring,PartC_6978: bitstring) = m1_6975 in
                                                    {8499}new Ns_6979: bitstring;
                                                    {8500}let m2_6980: bitstring = exp(g,Ns_6979) in
                                                    {8501}out(c, (m2_6980,sign(h(m2_6980),skSess_6951)));
                                                    {8502}let Ksrv_6981: bitstring = exp(PartC_6978,Ns_6979) in
                                                    {8503}out(c, senc(mSrv(pkCli_6954,pkSess_6952),Ksrv_6981))
                                            )
                                            else
                                                {8504}let pkDisco_6982: bitstring = pub(skI) in
                                                {8505}in(c, (=pkCli_6954,m1_6983: bitstring,sigM1_6984: bitstring));
                                                {8506}if (verify(h(m1_6983),sigM1_6984,pkCli_6954) <> true) then
                                                    0
                                                else
                                                    {8507}let (SPc_6985: bitstring,PartC_6986: bitstring) = m1_6983 in
                                                    {8508}new Ns_6987: bitstring;
                                                    {8509}let m2_6988: bitstring = exp(g,Ns_6987) in
                                                    {8510}out(c, (m2_6988,sign(h(m2_6988),skSess_6951)));
                                                    {8511}let Ksrv_6989: bitstring = exp(PartC_6986,Ns_6987) in
                                                    {8512}out(c, senc(mSrv(pkCli_6954,pkSess_6952),Ksrv_6989))
                                        )
                                        else
                                            {8513}let pkDisco_6990: bitstring = fail-any in
                                            {8514}in(c, (=pkCli_6954,m1_6991: bitstring,sigM1_6992: bitstring));
                                            {8515}if (verify(h(m1_6991),sigM1_6992,pkCli_6954) <> true) then
                                                0
                                            else
                                                {8516}let (SPc_6993: bitstring,PartC_6994: bitstring) = m1_6991 in
                                                {8517}new Ns_6995: bitstring;
                                                {8518}let m2_6996: bitstring = exp(g,Ns_6995) in
                                                {8519}out(c, (m2_6996,sign(h(m2_6996),skSess_6951)));
                                                {8520}let Ksrv_6997: bitstring = exp(PartC_6994,Ns_6995) in
                                                {8521}out(c, senc(mSrv(pkCli_6954,pkSess_6952),Ksrv_6997))
                                )
                                else
                                    {8522}let pkDisco_6998: bitstring = fail-any in
                                    {8523}in(c, (=pkCli_6954,m1_6999: bitstring,sigM1_7000: bitstring));
                                    {8524}if (verify(h(m1_6999),sigM1_7000,pkCli_6954) <> true) then
                                        0
                                    else
                                        {8525}let (SPc_7001: bitstring,PartC_7002: bitstring) = m1_6999 in
                                        {8526}new Ns_7003: bitstring;
                                        {8527}let m2_7004: bitstring = exp(g,Ns_7003) in
                                        {8528}out(c, (m2_7004,sign(h(m2_7004),skSess_6951)));
                                        {8529}let Ksrv_7005: bitstring = exp(PartC_7002,Ns_7003) in
                                        {8530}out(c, senc(mSrv(pkCli_6954,pkSess_6952),Ksrv_7005))
                        )
                        else
                            {8531}let pkDisco_7006: bitstring = fail-any in
                            {8532}in(c, (=pkCli_6954,m1_7007: bitstring,sigM1_7008: bitstring));
                            {8533}if (verify(h(m1_7007),sigM1_7008,pkCli_6954) <> true) then
                                0
                            else
                                {8534}let (SPc_7009: bitstring,PartC_7010: bitstring) = m1_7007 in
                                {8535}new Ns_7011: bitstring;
                                {8536}let m2_7012: bitstring = exp(g,Ns_7011) in
                                {8537}out(c, (m2_7012,sign(h(m2_7012),skSess_6951)));
                                {8538}let Ksrv_7013: bitstring = exp(PartC_7010,Ns_7011) in
                                {8539}out(c, senc(mSrv(pkCli_6954,pkSess_6952),Ksrv_7013))
                    )
                    else
                        {8540}let v_7014: bool = (Cli_4826 = B) in
                        (
                            {8541}if v_7014 then
                            (
                                {8542}let pkCli_7015: bitstring = pub(skB) in
                                {8543}let v_7016: bool = (Disco_4827 = A) in
                                (
                                    {8544}if v_7016 then
                                    (
                                        {8545}let pkDisco_7017: bitstring = pub(skA) in
                                        {8546}in(c, (=pkCli_7015,m1_7018: bitstring,sigM1_7019: bitstring));
                                        {8547}if (verify(h(m1_7018),sigM1_7019,pkCli_7015) <> true) then
                                            0
                                        else
                                            {8548}let (SPc_7020: bitstring,PartC_7021: bitstring) = m1_7018 in
                                            {8549}new Ns_7022: bitstring;
                                            {8550}let m2_7023: bitstring = exp(g,Ns_7022) in
                                            {8551}out(c, (m2_7023,sign(h(m2_7023),skSess_6951)));
                                            {8552}let Ksrv_7024: bitstring = exp(PartC_7021,Ns_7022) in
                                            {8553}out(c, senc(mSrv(pkCli_7015,pkSess_6952),Ksrv_7024))
                                    )
                                    else
                                        {8554}let v_7025: bool = (Disco_4827 = B) in
                                        (
                                            {8555}if v_7025 then
                                            (
                                                {8556}let pkDisco_7026: bitstring = pub(skB) in
                                                {8557}in(c, (=pkCli_7015,m1_7027: bitstring,sigM1_7028: bitstring));
                                                {8558}if (verify(h(m1_7027),sigM1_7028,pkCli_7015) <> true) then
                                                    0
                                                else
                                                    {8559}let (SPc_7029: bitstring,PartC_7030: bitstring) = m1_7027 in
                                                    {8560}new Ns_7031: bitstring;
                                                    {8561}let m2_7032: bitstring = exp(g,Ns_7031) in
                                                    {8562}out(c, (m2_7032,sign(h(m2_7032),skSess_6951)));
                                                    {8563}let Ksrv_7033: bitstring = exp(PartC_7030,Ns_7031) in
                                                    {8564}out(c, senc(mSrv(pkCli_7015,pkSess_6952),Ksrv_7033))
                                            )
                                            else
                                                {8565}let v_7034: bool = (Disco_4827 = C) in
                                                (
                                                    {8566}if v_7034 then
                                                    (
                                                        {8567}let pkDisco_7035: bitstring = pub(skC) in
                                                        {8568}in(c, (=pkCli_7015,m1_7036: bitstring,sigM1_7037: bitstring));
                                                        {8569}if (verify(h(m1_7036),sigM1_7037,pkCli_7015) <> true) then
                                                            0
                                                        else
                                                            {8570}let (SPc_7038: bitstring,PartC_7039: bitstring) = m1_7036 in
                                                            {8571}new Ns_7040: bitstring;
                                                            {8572}let m2_7041: bitstring = exp(g,Ns_7040) in
                                                            {8573}out(c, (m2_7041,sign(h(m2_7041),skSess_6951)));
                                                            {8574}let Ksrv_7042: bitstring = exp(PartC_7039,Ns_7040) in
                                                            {8575}out(c, senc(mSrv(pkCli_7015,pkSess_6952),Ksrv_7042))
                                                    )
                                                    else
                                                        {8576}let pkDisco_7043: bitstring = pub(skI) in
                                                        {8577}in(c, (=pkCli_7015,m1_7044: bitstring,sigM1_7045: bitstring));
                                                        {8578}if (verify(h(m1_7044),sigM1_7045,pkCli_7015) <> true) then
                                                            0
                                                        else
                                                            {8579}let (SPc_7046: bitstring,PartC_7047: bitstring) = m1_7044 in
                                                            {8580}new Ns_7048: bitstring;
                                                            {8581}let m2_7049: bitstring = exp(g,Ns_7048) in
                                                            {8582}out(c, (m2_7049,sign(h(m2_7049),skSess_6951)));
                                                            {8583}let Ksrv_7050: bitstring = exp(PartC_7047,Ns_7048) in
                                                            {8584}out(c, senc(mSrv(pkCli_7015,pkSess_6952),Ksrv_7050))
                                                )
                                                else
                                                    {8585}let pkDisco_7051: bitstring = fail-any in
                                                    {8586}in(c, (=pkCli_7015,m1_7052: bitstring,sigM1_7053: bitstring));
                                                    {8587}if (verify(h(m1_7052),sigM1_7053,pkCli_7015) <> true) then
                                                        0
                                                    else
                                                        {8588}let (SPc_7054: bitstring,PartC_7055: bitstring) = m1_7052 in
                                                        {8589}new Ns_7056: bitstring;
                                                        {8590}let m2_7057: bitstring = exp(g,Ns_7056) in
                                                        {8591}out(c, (m2_7057,sign(h(m2_7057),skSess_6951)));
                                                        {8592}let Ksrv_7058: bitstring = exp(PartC_7055,Ns_7056) in
                                                        {8593}out(c, senc(mSrv(pkCli_7015,pkSess_6952),Ksrv_7058))
                                        )
                                        else
                                            {8594}let pkDisco_7059: bitstring = fail-any in
                                            {8595}in(c, (=pkCli_7015,m1_7060: bitstring,sigM1_7061: bitstring));
                                            {8596}if (verify(h(m1_7060),sigM1_7061,pkCli_7015) <> true) then
                                                0
                                            else
                                                {8597}let (SPc_7062: bitstring,PartC_7063: bitstring) = m1_7060 in
                                                {8598}new Ns_7064: bitstring;
                                                {8599}let m2_7065: bitstring = exp(g,Ns_7064) in
                                                {8600}out(c, (m2_7065,sign(h(m2_7065),skSess_6951)));
                                                {8601}let Ksrv_7066: bitstring = exp(PartC_7063,Ns_7064) in
                                                {8602}out(c, senc(mSrv(pkCli_7015,pkSess_6952),Ksrv_7066))
                                )
                                else
                                    {8603}let pkDisco_7067: bitstring = fail-any in
                                    {8604}in(c, (=pkCli_7015,m1_7068: bitstring,sigM1_7069: bitstring));
                                    {8605}if (verify(h(m1_7068),sigM1_7069,pkCli_7015) <> true) then
                                        0
                                    else
                                        {8606}let (SPc_7070: bitstring,PartC_7071: bitstring) = m1_7068 in
                                        {8607}new Ns_7072: bitstring;
                                        {8608}let m2_7073: bitstring = exp(g,Ns_7072) in
                                        {8609}out(c, (m2_7073,sign(h(m2_7073),skSess_6951)));
                                        {8610}let Ksrv_7074: bitstring = exp(PartC_7071,Ns_7072) in
                                        {8611}out(c, senc(mSrv(pkCli_7015,pkSess_6952),Ksrv_7074))
                            )
                            else
                                {8612}let v_7075: bool = (Cli_4826 = C) in
                                (
                                    {8613}if v_7075 then
                                    (
                                        {8614}let pkCli_7076: bitstring = pub(skC) in
                                        {8615}let v_7077: bool = (Disco_4827 = A) in
                                        (
                                            {8616}if v_7077 then
                                            (
                                                {8617}let pkDisco_7078: bitstring = pub(skA) in
                                                {8618}in(c, (=pkCli_7076,m1_7079: bitstring,sigM1_7080: bitstring));
                                                {8619}if (verify(h(m1_7079),sigM1_7080,pkCli_7076) <> true) then
                                                    0
                                                else
                                                    {8620}let (SPc_7081: bitstring,PartC_7082: bitstring) = m1_7079 in
                                                    {8621}new Ns_7083: bitstring;
                                                    {8622}let m2_7084: bitstring = exp(g,Ns_7083) in
                                                    {8623}out(c, (m2_7084,sign(h(m2_7084),skSess_6951)));
                                                    {8624}let Ksrv_7085: bitstring = exp(PartC_7082,Ns_7083) in
                                                    {8625}out(c, senc(mSrv(pkCli_7076,pkSess_6952),Ksrv_7085))
                                            )
                                            else
                                                {8626}let v_7086: bool = (Disco_4827 = B) in
                                                (
                                                    {8627}if v_7086 then
                                                    (
                                                        {8628}let pkDisco_7087: bitstring = pub(skB) in
                                                        {8629}in(c, (=pkCli_7076,m1_7088: bitstring,sigM1_7089: bitstring));
                                                        {8630}if (verify(h(m1_7088),sigM1_7089,pkCli_7076) <> true) then
                                                            0
                                                        else
                                                            {8631}let (SPc_7090: bitstring,PartC_7091: bitstring) = m1_7088 in
                                                            {8632}new Ns_7092: bitstring;
                                                            {8633}let m2_7093: bitstring = exp(g,Ns_7092) in
                                                            {8634}out(c, (m2_7093,sign(h(m2_7093),skSess_6951)));
                                                            {8635}let Ksrv_7094: bitstring = exp(PartC_7091,Ns_7092) in
                                                            {8636}out(c, senc(mSrv(pkCli_7076,pkSess_6952),Ksrv_7094))
                                                    )
                                                    else
                                                        {8637}let v_7095: bool = (Disco_4827 = C) in
                                                        (
                                                            {8638}if v_7095 then
                                                            (
                                                                {8639}let pkDisco_7096: bitstring = pub(skC) in
                                                                {8640}in(c, (=pkCli_7076,m1_7097: bitstring,sigM1_7098: bitstring));
                                                                {8641}if (verify(h(m1_7097),sigM1_7098,pkCli_7076) <> true) then
                                                                    0
                                                                else
                                                                    {8642}let (SPc_7099: bitstring,PartC_7100: bitstring) = m1_7097 in
                                                                    {8643}new Ns_7101: bitstring;
                                                                    {8644}let m2_7102: bitstring = exp(g,Ns_7101) in
                                                                    {8645}out(c, (m2_7102,sign(h(m2_7102),skSess_6951)));
                                                                    {8646}let Ksrv_7103: bitstring = exp(PartC_7100,Ns_7101) in
                                                                    {8647}out(c, senc(mSrv(pkCli_7076,pkSess_6952),Ksrv_7103))
                                                            )
                                                            else
                                                                {8648}let pkDisco_7104: bitstring = pub(skI) in
                                                                {8649}in(c, (=pkCli_7076,m1_7105: bitstring,sigM1_7106: bitstring));
                                                                {8650}if (verify(h(m1_7105),sigM1_7106,pkCli_7076) <> true) then
                                                                    0
                                                                else
                                                                    {8651}let (SPc_7107: bitstring,PartC_7108: bitstring) = m1_7105 in
                                                                    {8652}new Ns_7109: bitstring;
                                                                    {8653}let m2_7110: bitstring = exp(g,Ns_7109) in
                                                                    {8654}out(c, (m2_7110,sign(h(m2_7110),skSess_6951)));
                                                                    {8655}let Ksrv_7111: bitstring = exp(PartC_7108,Ns_7109) in
                                                                    {8656}out(c, senc(mSrv(pkCli_7076,pkSess_6952),Ksrv_7111))
                                                        )
                                                        else
                                                            {8657}let pkDisco_7112: bitstring = fail-any in
                                                            {8658}in(c, (=pkCli_7076,m1_7113: bitstring,sigM1_7114: bitstring));
                                                            {8659}if (verify(h(m1_7113),sigM1_7114,pkCli_7076) <> true) then
                                                                0
                                                            else
                                                                {8660}let (SPc_7115: bitstring,PartC_7116: bitstring) = m1_7113 in
                                                                {8661}new Ns_7117: bitstring;
                                                                {8662}let m2_7118: bitstring = exp(g,Ns_7117) in
                                                                {8663}out(c, (m2_7118,sign(h(m2_7118),skSess_6951)));
                                                                {8664}let Ksrv_7119: bitstring = exp(PartC_7116,Ns_7117) in
                                                                {8665}out(c, senc(mSrv(pkCli_7076,pkSess_6952),Ksrv_7119))
                                                )
                                                else
                                                    {8666}let pkDisco_7120: bitstring = fail-any in
                                                    {8667}in(c, (=pkCli_7076,m1_7121: bitstring,sigM1_7122: bitstring));
                                                    {8668}if (verify(h(m1_7121),sigM1_7122,pkCli_7076) <> true) then
                                                        0
                                                    else
                                                        {8669}let (SPc_7123: bitstring,PartC_7124: bitstring) = m1_7121 in
                                                        {8670}new Ns_7125: bitstring;
                                                        {8671}let m2_7126: bitstring = exp(g,Ns_7125) in
                                                        {8672}out(c, (m2_7126,sign(h(m2_7126),skSess_6951)));
                                                        {8673}let Ksrv_7127: bitstring = exp(PartC_7124,Ns_7125) in
                                                        {8674}out(c, senc(mSrv(pkCli_7076,pkSess_6952),Ksrv_7127))
                                        )
                                        else
                                            {8675}let pkDisco_7128: bitstring = fail-any in
                                            {8676}in(c, (=pkCli_7076,m1_7129: bitstring,sigM1_7130: bitstring));
                                            {8677}if (verify(h(m1_7129),sigM1_7130,pkCli_7076) <> true) then
                                                0
                                            else
                                                {8678}let (SPc_7131: bitstring,PartC_7132: bitstring) = m1_7129 in
                                                {8679}new Ns_7133: bitstring;
                                                {8680}let m2_7134: bitstring = exp(g,Ns_7133) in
                                                {8681}out(c, (m2_7134,sign(h(m2_7134),skSess_6951)));
                                                {8682}let Ksrv_7135: bitstring = exp(PartC_7132,Ns_7133) in
                                                {8683}out(c, senc(mSrv(pkCli_7076,pkSess_6952),Ksrv_7135))
                                    )
                                    else
                                        {8684}let pkCli_7136: bitstring = pub(skI) in
                                        {8685}let v_7137: bool = (Disco_4827 = A) in
                                        (
                                            {8686}if v_7137 then
                                            (
                                                {8687}let pkDisco_7138: bitstring = pub(skA) in
                                                {8688}in(c, (=pkCli_7136,m1_7139: bitstring,sigM1_7140: bitstring));
                                                {8689}if (verify(h(m1_7139),sigM1_7140,pkCli_7136) <> true) then
                                                    0
                                                else
                                                    {8690}let (SPc_7141: bitstring,PartC_7142: bitstring) = m1_7139 in
                                                    {8691}new Ns_7143: bitstring;
                                                    {8692}let m2_7144: bitstring = exp(g,Ns_7143) in
                                                    {8693}out(c, (m2_7144,sign(h(m2_7144),skSess_6951)));
                                                    {8694}let Ksrv_7145: bitstring = exp(PartC_7142,Ns_7143) in
                                                    {8695}out(c, senc(mSrv(pkCli_7136,pkSess_6952),Ksrv_7145))
                                            )
                                            else
                                                {8696}let v_7146: bool = (Disco_4827 = B) in
                                                (
                                                    {8697}if v_7146 then
                                                    (
                                                        {8698}let pkDisco_7147: bitstring = pub(skB) in
                                                        {8699}in(c, (=pkCli_7136,m1_7148: bitstring,sigM1_7149: bitstring));
                                                        {8700}if (verify(h(m1_7148),sigM1_7149,pkCli_7136) <> true) then
                                                            0
                                                        else
                                                            {8701}let (SPc_7150: bitstring,PartC_7151: bitstring) = m1_7148 in
                                                            {8702}new Ns_7152: bitstring;
                                                            {8703}let m2_7153: bitstring = exp(g,Ns_7152) in
                                                            {8704}out(c, (m2_7153,sign(h(m2_7153),skSess_6951)));
                                                            {8705}let Ksrv_7154: bitstring = exp(PartC_7151,Ns_7152) in
                                                            {8706}out(c, senc(mSrv(pkCli_7136,pkSess_6952),Ksrv_7154))
                                                    )
                                                    else
                                                        {8707}let v_7155: bool = (Disco_4827 = C) in
                                                        (
                                                            {8708}if v_7155 then
                                                            (
                                                                {8709}let pkDisco_7156: bitstring = pub(skC) in
                                                                {8710}in(c, (=pkCli_7136,m1_7157: bitstring,sigM1_7158: bitstring));
                                                                {8711}if (verify(h(m1_7157),sigM1_7158,pkCli_7136) <> true) then
                                                                    0
                                                                else
                                                                    {8712}let (SPc_7159: bitstring,PartC_7160: bitstring) = m1_7157 in
                                                                    {8713}new Ns_7161: bitstring;
                                                                    {8714}let m2_7162: bitstring = exp(g,Ns_7161) in
                                                                    {8715}out(c, (m2_7162,sign(h(m2_7162),skSess_6951)));
                                                                    {8716}let Ksrv_7163: bitstring = exp(PartC_7160,Ns_7161) in
                                                                    {8717}out(c, senc(mSrv(pkCli_7136,pkSess_6952),Ksrv_7163))
                                                            )
                                                            else
                                                                {8718}let pkDisco_7164: bitstring = pub(skI) in
                                                                {8719}in(c, (=pkCli_7136,m1_7165: bitstring,sigM1_7166: bitstring));
                                                                {8720}if (verify(h(m1_7165),sigM1_7166,pkCli_7136) <> true) then
                                                                    0
                                                                else
                                                                    {8721}let (SPc_7167: bitstring,PartC_7168: bitstring) = m1_7165 in
                                                                    {8722}new Ns_7169: bitstring;
                                                                    {8723}let m2_7170: bitstring = exp(g,Ns_7169) in
                                                                    {8724}out(c, (m2_7170,sign(h(m2_7170),skSess_6951)));
                                                                    {8725}let Ksrv_7171: bitstring = exp(PartC_7168,Ns_7169) in
                                                                    {8726}out(c, senc(mSrv(pkCli_7136,pkSess_6952),Ksrv_7171))
                                                        )
                                                        else
                                                            {8727}let pkDisco_7172: bitstring = fail-any in
                                                            {8728}in(c, (=pkCli_7136,m1_7173: bitstring,sigM1_7174: bitstring));
                                                            {8729}if (verify(h(m1_7173),sigM1_7174,pkCli_7136) <> true) then
                                                                0
                                                            else
                                                                {8730}let (SPc_7175: bitstring,PartC_7176: bitstring) = m1_7173 in
                                                                {8731}new Ns_7177: bitstring;
                                                                {8732}let m2_7178: bitstring = exp(g,Ns_7177) in
                                                                {8733}out(c, (m2_7178,sign(h(m2_7178),skSess_6951)));
                                                                {8734}let Ksrv_7179: bitstring = exp(PartC_7176,Ns_7177) in
                                                                {8735}out(c, senc(mSrv(pkCli_7136,pkSess_6952),Ksrv_7179))
                                                )
                                                else
                                                    {8736}let pkDisco_7180: bitstring = fail-any in
                                                    {8737}in(c, (=pkCli_7136,m1_7181: bitstring,sigM1_7182: bitstring));
                                                    {8738}if (verify(h(m1_7181),sigM1_7182,pkCli_7136) <> true) then
                                                        0
                                                    else
                                                        {8739}let (SPc_7183: bitstring,PartC_7184: bitstring) = m1_7181 in
                                                        {8740}new Ns_7185: bitstring;
                                                        {8741}let m2_7186: bitstring = exp(g,Ns_7185) in
                                                        {8742}out(c, (m2_7186,sign(h(m2_7186),skSess_6951)));
                                                        {8743}let Ksrv_7187: bitstring = exp(PartC_7184,Ns_7185) in
                                                        {8744}out(c, senc(mSrv(pkCli_7136,pkSess_6952),Ksrv_7187))
                                        )
                                        else
                                            {8745}let pkDisco_7188: bitstring = fail-any in
                                            {8746}in(c, (=pkCli_7136,m1_7189: bitstring,sigM1_7190: bitstring));
                                            {8747}if (verify(h(m1_7189),sigM1_7190,pkCli_7136) <> true) then
                                                0
                                            else
                                                {8748}let (SPc_7191: bitstring,PartC_7192: bitstring) = m1_7189 in
                                                {8749}new Ns_7193: bitstring;
                                                {8750}let m2_7194: bitstring = exp(g,Ns_7193) in
                                                {8751}out(c, (m2_7194,sign(h(m2_7194),skSess_6951)));
                                                {8752}let Ksrv_7195: bitstring = exp(PartC_7192,Ns_7193) in
                                                {8753}out(c, senc(mSrv(pkCli_7136,pkSess_6952),Ksrv_7195))
                                )
                                else
                                    {8754}let pkCli_7196: bitstring = fail-any in
                                    {8755}let v_7197: bool = (Disco_4827 = A) in
                                    (
                                        {8756}if v_7197 then
                                        (
                                            {8757}let pkDisco_7198: bitstring = pub(skA) in
                                            {8758}in(c, (=pkCli_7196,m1_7199: bitstring,sigM1_7200: bitstring));
                                            {8759}if (verify(h(m1_7199),sigM1_7200,pkCli_7196) <> true) then
                                                0
                                            else
                                                {8760}let (SPc_7201: bitstring,PartC_7202: bitstring) = m1_7199 in
                                                {8761}new Ns_7203: bitstring;
                                                {8762}let m2_7204: bitstring = exp(g,Ns_7203) in
                                                {8763}out(c, (m2_7204,sign(h(m2_7204),skSess_6951)));
                                                {8764}let Ksrv_7205: bitstring = exp(PartC_7202,Ns_7203) in
                                                {8765}out(c, senc(mSrv(pkCli_7196,pkSess_6952),Ksrv_7205))
                                        )
                                        else
                                            {8766}let v_7206: bool = (Disco_4827 = B) in
                                            (
                                                {8767}if v_7206 then
                                                (
                                                    {8768}let pkDisco_7207: bitstring = pub(skB) in
                                                    {8769}in(c, (=pkCli_7196,m1_7208: bitstring,sigM1_7209: bitstring));
                                                    {8770}if (verify(h(m1_7208),sigM1_7209,pkCli_7196) <> true) then
                                                        0
                                                    else
                                                        {8771}let (SPc_7210: bitstring,PartC_7211: bitstring) = m1_7208 in
                                                        {8772}new Ns_7212: bitstring;
                                                        {8773}let m2_7213: bitstring = exp(g,Ns_7212) in
                                                        {8774}out(c, (m2_7213,sign(h(m2_7213),skSess_6951)));
                                                        {8775}let Ksrv_7214: bitstring = exp(PartC_7211,Ns_7212) in
                                                        {8776}out(c, senc(mSrv(pkCli_7196,pkSess_6952),Ksrv_7214))
                                                )
                                                else
                                                    {8777}let v_7215: bool = (Disco_4827 = C) in
                                                    (
                                                        {8778}if v_7215 then
                                                        (
                                                            {8779}let pkDisco_7216: bitstring = pub(skC) in
                                                            {8780}in(c, (=pkCli_7196,m1_7217: bitstring,sigM1_7218: bitstring));
                                                            {8781}if (verify(h(m1_7217),sigM1_7218,pkCli_7196) <> true) then
                                                                0
                                                            else
                                                                {8782}let (SPc_7219: bitstring,PartC_7220: bitstring) = m1_7217 in
                                                                {8783}new Ns_7221: bitstring;
                                                                {8784}let m2_7222: bitstring = exp(g,Ns_7221) in
                                                                {8785}out(c, (m2_7222,sign(h(m2_7222),skSess_6951)));
                                                                {8786}let Ksrv_7223: bitstring = exp(PartC_7220,Ns_7221) in
                                                                {8787}out(c, senc(mSrv(pkCli_7196,pkSess_6952),Ksrv_7223))
                                                        )
                                                        else
                                                            {8788}let pkDisco_7224: bitstring = pub(skI) in
                                                            {8789}in(c, (=pkCli_7196,m1_7225: bitstring,sigM1_7226: bitstring));
                                                            {8790}if (verify(h(m1_7225),sigM1_7226,pkCli_7196) <> true) then
                                                                0
                                                            else
                                                                {8791}let (SPc_7227: bitstring,PartC_7228: bitstring) = m1_7225 in
                                                                {8792}new Ns_7229: bitstring;
                                                                {8793}let m2_7230: bitstring = exp(g,Ns_7229) in
                                                                {8794}out(c, (m2_7230,sign(h(m2_7230),skSess_6951)));
                                                                {8795}let Ksrv_7231: bitstring = exp(PartC_7228,Ns_7229) in
                                                                {8796}out(c, senc(mSrv(pkCli_7196,pkSess_6952),Ksrv_7231))
                                                    )
                                                    else
                                                        {8797}let pkDisco_7232: bitstring = fail-any in
                                                        {8798}in(c, (=pkCli_7196,m1_7233: bitstring,sigM1_7234: bitstring));
                                                        {8799}if (verify(h(m1_7233),sigM1_7234,pkCli_7196) <> true) then
                                                            0
                                                        else
                                                            {8800}let (SPc_7235: bitstring,PartC_7236: bitstring) = m1_7233 in
                                                            {8801}new Ns_7237: bitstring;
                                                            {8802}let m2_7238: bitstring = exp(g,Ns_7237) in
                                                            {8803}out(c, (m2_7238,sign(h(m2_7238),skSess_6951)));
                                                            {8804}let Ksrv_7239: bitstring = exp(PartC_7236,Ns_7237) in
                                                            {8805}out(c, senc(mSrv(pkCli_7196,pkSess_6952),Ksrv_7239))
                                            )
                                            else
                                                {8806}let pkDisco_7240: bitstring = fail-any in
                                                {8807}in(c, (=pkCli_7196,m1_7241: bitstring,sigM1_7242: bitstring));
                                                {8808}if (verify(h(m1_7241),sigM1_7242,pkCli_7196) <> true) then
                                                    0
                                                else
                                                    {8809}let (SPc_7243: bitstring,PartC_7244: bitstring) = m1_7241 in
                                                    {8810}new Ns_7245: bitstring;
                                                    {8811}let m2_7246: bitstring = exp(g,Ns_7245) in
                                                    {8812}out(c, (m2_7246,sign(h(m2_7246),skSess_6951)));
                                                    {8813}let Ksrv_7247: bitstring = exp(PartC_7244,Ns_7245) in
                                                    {8814}out(c, senc(mSrv(pkCli_7196,pkSess_6952),Ksrv_7247))
                                    )
                                    else
                                        {8815}let pkDisco_7248: bitstring = fail-any in
                                        {8816}in(c, (=pkCli_7196,m1_7249: bitstring,sigM1_7250: bitstring));
                                        {8817}if (verify(h(m1_7249),sigM1_7250,pkCli_7196) <> true) then
                                            0
                                        else
                                            {8818}let (SPc_7251: bitstring,PartC_7252: bitstring) = m1_7249 in
                                            {8819}new Ns_7253: bitstring;
                                            {8820}let m2_7254: bitstring = exp(g,Ns_7253) in
                                            {8821}out(c, (m2_7254,sign(h(m2_7254),skSess_6951)));
                                            {8822}let Ksrv_7255: bitstring = exp(PartC_7252,Ns_7253) in
                                            {8823}out(c, senc(mSrv(pkCli_7196,pkSess_6952),Ksrv_7255))
                        )
                        else
                            {8824}let pkCli_7256: bitstring = fail-any in
                            {8825}let v_7257: bool = (Disco_4827 = A) in
                            (
                                {8826}if v_7257 then
                                (
                                    {8827}let pkDisco_7258: bitstring = pub(skA) in
                                    {8828}in(c, (=pkCli_7256,m1_7259: bitstring,sigM1_7260: bitstring));
                                    {8829}if (verify(h(m1_7259),sigM1_7260,pkCli_7256) <> true) then
                                        0
                                    else
                                        {8830}let (SPc_7261: bitstring,PartC_7262: bitstring) = m1_7259 in
                                        {8831}new Ns_7263: bitstring;
                                        {8832}let m2_7264: bitstring = exp(g,Ns_7263) in
                                        {8833}out(c, (m2_7264,sign(h(m2_7264),skSess_6951)));
                                        {8834}let Ksrv_7265: bitstring = exp(PartC_7262,Ns_7263) in
                                        {8835}out(c, senc(mSrv(pkCli_7256,pkSess_6952),Ksrv_7265))
                                )
                                else
                                    {8836}let v_7266: bool = (Disco_4827 = B) in
                                    (
                                        {8837}if v_7266 then
                                        (
                                            {8838}let pkDisco_7267: bitstring = pub(skB) in
                                            {8839}in(c, (=pkCli_7256,m1_7268: bitstring,sigM1_7269: bitstring));
                                            {8840}if (verify(h(m1_7268),sigM1_7269,pkCli_7256) <> true) then
                                                0
                                            else
                                                {8841}let (SPc_7270: bitstring,PartC_7271: bitstring) = m1_7268 in
                                                {8842}new Ns_7272: bitstring;
                                                {8843}let m2_7273: bitstring = exp(g,Ns_7272) in
                                                {8844}out(c, (m2_7273,sign(h(m2_7273),skSess_6951)));
                                                {8845}let Ksrv_7274: bitstring = exp(PartC_7271,Ns_7272) in
                                                {8846}out(c, senc(mSrv(pkCli_7256,pkSess_6952),Ksrv_7274))
                                        )
                                        else
                                            {8847}let v_7275: bool = (Disco_4827 = C) in
                                            (
                                                {8848}if v_7275 then
                                                (
                                                    {8849}let pkDisco_7276: bitstring = pub(skC) in
                                                    {8850}in(c, (=pkCli_7256,m1_7277: bitstring,sigM1_7278: bitstring));
                                                    {8851}if (verify(h(m1_7277),sigM1_7278,pkCli_7256) <> true) then
                                                        0
                                                    else
                                                        {8852}let (SPc_7279: bitstring,PartC_7280: bitstring) = m1_7277 in
                                                        {8853}new Ns_7281: bitstring;
                                                        {8854}let m2_7282: bitstring = exp(g,Ns_7281) in
                                                        {8855}out(c, (m2_7282,sign(h(m2_7282),skSess_6951)));
                                                        {8856}let Ksrv_7283: bitstring = exp(PartC_7280,Ns_7281) in
                                                        {8857}out(c, senc(mSrv(pkCli_7256,pkSess_6952),Ksrv_7283))
                                                )
                                                else
                                                    {8858}let pkDisco_7284: bitstring = pub(skI) in
                                                    {8859}in(c, (=pkCli_7256,m1_7285: bitstring,sigM1_7286: bitstring));
                                                    {8860}if (verify(h(m1_7285),sigM1_7286,pkCli_7256) <> true) then
                                                        0
                                                    else
                                                        {8861}let (SPc_7287: bitstring,PartC_7288: bitstring) = m1_7285 in
                                                        {8862}new Ns_7289: bitstring;
                                                        {8863}let m2_7290: bitstring = exp(g,Ns_7289) in
                                                        {8864}out(c, (m2_7290,sign(h(m2_7290),skSess_6951)));
                                                        {8865}let Ksrv_7291: bitstring = exp(PartC_7288,Ns_7289) in
                                                        {8866}out(c, senc(mSrv(pkCli_7256,pkSess_6952),Ksrv_7291))
                                            )
                                            else
                                                {8867}let pkDisco_7292: bitstring = fail-any in
                                                {8868}in(c, (=pkCli_7256,m1_7293: bitstring,sigM1_7294: bitstring));
                                                {8869}if (verify(h(m1_7293),sigM1_7294,pkCli_7256) <> true) then
                                                    0
                                                else
                                                    {8870}let (SPc_7295: bitstring,PartC_7296: bitstring) = m1_7293 in
                                                    {8871}new Ns_7297: bitstring;
                                                    {8872}let m2_7298: bitstring = exp(g,Ns_7297) in
                                                    {8873}out(c, (m2_7298,sign(h(m2_7298),skSess_6951)));
                                                    {8874}let Ksrv_7299: bitstring = exp(PartC_7296,Ns_7297) in
                                                    {8875}out(c, senc(mSrv(pkCli_7256,pkSess_6952),Ksrv_7299))
                                    )
                                    else
                                        {8876}let pkDisco_7300: bitstring = fail-any in
                                        {8877}in(c, (=pkCli_7256,m1_7301: bitstring,sigM1_7302: bitstring));
                                        {8878}if (verify(h(m1_7301),sigM1_7302,pkCli_7256) <> true) then
                                            0
                                        else
                                            {8879}let (SPc_7303: bitstring,PartC_7304: bitstring) = m1_7301 in
                                            {8880}new Ns_7305: bitstring;
                                            {8881}let m2_7306: bitstring = exp(g,Ns_7305) in
                                            {8882}out(c, (m2_7306,sign(h(m2_7306),skSess_6951)));
                                            {8883}let Ksrv_7307: bitstring = exp(PartC_7304,Ns_7305) in
                                            {8884}out(c, senc(mSrv(pkCli_7256,pkSess_6952),Ksrv_7307))
                            )
                            else
                                {8885}let pkDisco_7308: bitstring = fail-any in
                                {8886}in(c, (=pkCli_7256,m1_7309: bitstring,sigM1_7310: bitstring));
                                {8887}if (verify(h(m1_7309),sigM1_7310,pkCli_7256) <> true) then
                                    0
                                else
                                    {8888}let (SPc_7311: bitstring,PartC_7312: bitstring) = m1_7309 in
                                    {8889}new Ns_7313: bitstring;
                                    {8890}let m2_7314: bitstring = exp(g,Ns_7313) in
                                    {8891}out(c, (m2_7314,sign(h(m2_7314),skSess_6951)));
                                    {8892}let Ksrv_7315: bitstring = exp(PartC_7312,Ns_7313) in
                                    {8893}out(c, senc(mSrv(pkCli_7256,pkSess_6952),Ksrv_7315))
                )
                else
                    {8894}let pkCli_7316: bitstring = fail-any in
                    {8895}let v_7317: bool = (Disco_4827 = A) in
                    (
                        {8896}if v_7317 then
                        (
                            {8897}let pkDisco_7318: bitstring = pub(skA) in
                            {8898}in(c, (=pkCli_7316,m1_7319: bitstring,sigM1_7320: bitstring));
                            {8899}if (verify(h(m1_7319),sigM1_7320,pkCli_7316) <> true) then
                                0
                            else
                                {8900}let (SPc_7321: bitstring,PartC_7322: bitstring) = m1_7319 in
                                {8901}new Ns_7323: bitstring;
                                {8902}let m2_7324: bitstring = exp(g,Ns_7323) in
                                {8903}out(c, (m2_7324,sign(h(m2_7324),skSess_6951)));
                                {8904}let Ksrv_7325: bitstring = exp(PartC_7322,Ns_7323) in
                                {8905}out(c, senc(mSrv(pkCli_7316,pkSess_6952),Ksrv_7325))
                        )
                        else
                            {8906}let v_7326: bool = (Disco_4827 = B) in
                            (
                                {8907}if v_7326 then
                                (
                                    {8908}let pkDisco_7327: bitstring = pub(skB) in
                                    {8909}in(c, (=pkCli_7316,m1_7328: bitstring,sigM1_7329: bitstring));
                                    {8910}if (verify(h(m1_7328),sigM1_7329,pkCli_7316) <> true) then
                                        0
                                    else
                                        {8911}let (SPc_7330: bitstring,PartC_7331: bitstring) = m1_7328 in
                                        {8912}new Ns_7332: bitstring;
                                        {8913}let m2_7333: bitstring = exp(g,Ns_7332) in
                                        {8914}out(c, (m2_7333,sign(h(m2_7333),skSess_6951)));
                                        {8915}let Ksrv_7334: bitstring = exp(PartC_7331,Ns_7332) in
                                        {8916}out(c, senc(mSrv(pkCli_7316,pkSess_6952),Ksrv_7334))
                                )
                                else
                                    {8917}let v_7335: bool = (Disco_4827 = C) in
                                    (
                                        {8918}if v_7335 then
                                        (
                                            {8919}let pkDisco_7336: bitstring = pub(skC) in
                                            {8920}in(c, (=pkCli_7316,m1_7337: bitstring,sigM1_7338: bitstring));
                                            {8921}if (verify(h(m1_7337),sigM1_7338,pkCli_7316) <> true) then
                                                0
                                            else
                                                {8922}let (SPc_7339: bitstring,PartC_7340: bitstring) = m1_7337 in
                                                {8923}new Ns_7341: bitstring;
                                                {8924}let m2_7342: bitstring = exp(g,Ns_7341) in
                                                {8925}out(c, (m2_7342,sign(h(m2_7342),skSess_6951)));
                                                {8926}let Ksrv_7343: bitstring = exp(PartC_7340,Ns_7341) in
                                                {8927}out(c, senc(mSrv(pkCli_7316,pkSess_6952),Ksrv_7343))
                                        )
                                        else
                                            {8928}let pkDisco_7344: bitstring = pub(skI) in
                                            {8929}in(c, (=pkCli_7316,m1_7345: bitstring,sigM1_7346: bitstring));
                                            {8930}if (verify(h(m1_7345),sigM1_7346,pkCli_7316) <> true) then
                                                0
                                            else
                                                {8931}let (SPc_7347: bitstring,PartC_7348: bitstring) = m1_7345 in
                                                {8932}new Ns_7349: bitstring;
                                                {8933}let m2_7350: bitstring = exp(g,Ns_7349) in
                                                {8934}out(c, (m2_7350,sign(h(m2_7350),skSess_6951)));
                                                {8935}let Ksrv_7351: bitstring = exp(PartC_7348,Ns_7349) in
                                                {8936}out(c, senc(mSrv(pkCli_7316,pkSess_6952),Ksrv_7351))
                                    )
                                    else
                                        {8937}let pkDisco_7352: bitstring = fail-any in
                                        {8938}in(c, (=pkCli_7316,m1_7353: bitstring,sigM1_7354: bitstring));
                                        {8939}if (verify(h(m1_7353),sigM1_7354,pkCli_7316) <> true) then
                                            0
                                        else
                                            {8940}let (SPc_7355: bitstring,PartC_7356: bitstring) = m1_7353 in
                                            {8941}new Ns_7357: bitstring;
                                            {8942}let m2_7358: bitstring = exp(g,Ns_7357) in
                                            {8943}out(c, (m2_7358,sign(h(m2_7358),skSess_6951)));
                                            {8944}let Ksrv_7359: bitstring = exp(PartC_7356,Ns_7357) in
                                            {8945}out(c, senc(mSrv(pkCli_7316,pkSess_6952),Ksrv_7359))
                            )
                            else
                                {8946}let pkDisco_7360: bitstring = fail-any in
                                {8947}in(c, (=pkCli_7316,m1_7361: bitstring,sigM1_7362: bitstring));
                                {8948}if (verify(h(m1_7361),sigM1_7362,pkCli_7316) <> true) then
                                    0
                                else
                                    {8949}let (SPc_7363: bitstring,PartC_7364: bitstring) = m1_7361 in
                                    {8950}new Ns_7365: bitstring;
                                    {8951}let m2_7366: bitstring = exp(g,Ns_7365) in
                                    {8952}out(c, (m2_7366,sign(h(m2_7366),skSess_6951)));
                                    {8953}let Ksrv_7367: bitstring = exp(PartC_7364,Ns_7365) in
                                    {8954}out(c, senc(mSrv(pkCli_7316,pkSess_6952),Ksrv_7367))
                    )
                    else
                        {8955}let pkDisco_7368: bitstring = fail-any in
                        {8956}in(c, (=pkCli_7316,m1_7369: bitstring,sigM1_7370: bitstring));
                        {8957}if (verify(h(m1_7369),sigM1_7370,pkCli_7316) <> true) then
                            0
                        else
                            {8958}let (SPc_7371: bitstring,PartC_7372: bitstring) = m1_7369 in
                            {8959}new Ns_7373: bitstring;
                            {8960}let m2_7374: bitstring = exp(g,Ns_7373) in
                            {8961}out(c, (m2_7374,sign(h(m2_7374),skSess_6951)));
                            {8962}let Ksrv_7375: bitstring = exp(PartC_7372,Ns_7373) in
                            {8963}out(c, senc(mSrv(pkCli_7316,pkSess_6952),Ksrv_7375))
    )
    else
        {8964}let skSess_7376: bitstring = fail-any in
        {8965}let pkSess_7377: bitstring = pub(skSess_7376) in
        {8966}let v_7378: bool = (Cli_4826 = A) in
        (
            {8967}if v_7378 then
            (
                {8968}let pkCli_7379: bitstring = pub(skA) in
                {8969}let v_7380: bool = (Disco_4827 = A) in
                (
                    {8970}if v_7380 then
                    (
                        {8971}let pkDisco_7381: bitstring = pub(skA) in
                        {8972}in(c, (=pkCli_7379,m1_7382: bitstring,sigM1_7383: bitstring));
                        {8973}if (verify(h(m1_7382),sigM1_7383,pkCli_7379) <> true) then
                            0
                        else
                            {8974}let (SPc_7384: bitstring,PartC_7385: bitstring) = m1_7382 in
                            {8975}new Ns_7386: bitstring;
                            {8976}let m2_7387: bitstring = exp(g,Ns_7386) in
                            {8977}out(c, (m2_7387,sign(h(m2_7387),skSess_7376)));
                            {8978}let Ksrv_7388: bitstring = exp(PartC_7385,Ns_7386) in
                            {8979}out(c, senc(mSrv(pkCli_7379,pkSess_7377),Ksrv_7388))
                    )
                    else
                        {8980}let v_7389: bool = (Disco_4827 = B) in
                        (
                            {8981}if v_7389 then
                            (
                                {8982}let pkDisco_7390: bitstring = pub(skB) in
                                {8983}in(c, (=pkCli_7379,m1_7391: bitstring,sigM1_7392: bitstring));
                                {8984}if (verify(h(m1_7391),sigM1_7392,pkCli_7379) <> true) then
                                    0
                                else
                                    {8985}let (SPc_7393: bitstring,PartC_7394: bitstring) = m1_7391 in
                                    {8986}new Ns_7395: bitstring;
                                    {8987}let m2_7396: bitstring = exp(g,Ns_7395) in
                                    {8988}out(c, (m2_7396,sign(h(m2_7396),skSess_7376)));
                                    {8989}let Ksrv_7397: bitstring = exp(PartC_7394,Ns_7395) in
                                    {8990}out(c, senc(mSrv(pkCli_7379,pkSess_7377),Ksrv_7397))
                            )
                            else
                                {8991}let v_7398: bool = (Disco_4827 = C) in
                                (
                                    {8992}if v_7398 then
                                    (
                                        {8993}let pkDisco_7399: bitstring = pub(skC) in
                                        {8994}in(c, (=pkCli_7379,m1_7400: bitstring,sigM1_7401: bitstring));
                                        {8995}if (verify(h(m1_7400),sigM1_7401,pkCli_7379) <> true) then
                                            0
                                        else
                                            {8996}let (SPc_7402: bitstring,PartC_7403: bitstring) = m1_7400 in
                                            {8997}new Ns_7404: bitstring;
                                            {8998}let m2_7405: bitstring = exp(g,Ns_7404) in
                                            {8999}out(c, (m2_7405,sign(h(m2_7405),skSess_7376)));
                                            {9000}let Ksrv_7406: bitstring = exp(PartC_7403,Ns_7404) in
                                            {9001}out(c, senc(mSrv(pkCli_7379,pkSess_7377),Ksrv_7406))
                                    )
                                    else
                                        {9002}let pkDisco_7407: bitstring = pub(skI) in
                                        {9003}in(c, (=pkCli_7379,m1_7408: bitstring,sigM1_7409: bitstring));
                                        {9004}if (verify(h(m1_7408),sigM1_7409,pkCli_7379) <> true) then
                                            0
                                        else
                                            {9005}let (SPc_7410: bitstring,PartC_7411: bitstring) = m1_7408 in
                                            {9006}new Ns_7412: bitstring;
                                            {9007}let m2_7413: bitstring = exp(g,Ns_7412) in
                                            {9008}out(c, (m2_7413,sign(h(m2_7413),skSess_7376)));
                                            {9009}let Ksrv_7414: bitstring = exp(PartC_7411,Ns_7412) in
                                            {9010}out(c, senc(mSrv(pkCli_7379,pkSess_7377),Ksrv_7414))
                                )
                                else
                                    {9011}let pkDisco_7415: bitstring = fail-any in
                                    {9012}in(c, (=pkCli_7379,m1_7416: bitstring,sigM1_7417: bitstring));
                                    {9013}if (verify(h(m1_7416),sigM1_7417,pkCli_7379) <> true) then
                                        0
                                    else
                                        {9014}let (SPc_7418: bitstring,PartC_7419: bitstring) = m1_7416 in
                                        {9015}new Ns_7420: bitstring;
                                        {9016}let m2_7421: bitstring = exp(g,Ns_7420) in
                                        {9017}out(c, (m2_7421,sign(h(m2_7421),skSess_7376)));
                                        {9018}let Ksrv_7422: bitstring = exp(PartC_7419,Ns_7420) in
                                        {9019}out(c, senc(mSrv(pkCli_7379,pkSess_7377),Ksrv_7422))
                        )
                        else
                            {9020}let pkDisco_7423: bitstring = fail-any in
                            {9021}in(c, (=pkCli_7379,m1_7424: bitstring,sigM1_7425: bitstring));
                            {9022}if (verify(h(m1_7424),sigM1_7425,pkCli_7379) <> true) then
                                0
                            else
                                {9023}let (SPc_7426: bitstring,PartC_7427: bitstring) = m1_7424 in
                                {9024}new Ns_7428: bitstring;
                                {9025}let m2_7429: bitstring = exp(g,Ns_7428) in
                                {9026}out(c, (m2_7429,sign(h(m2_7429),skSess_7376)));
                                {9027}let Ksrv_7430: bitstring = exp(PartC_7427,Ns_7428) in
                                {9028}out(c, senc(mSrv(pkCli_7379,pkSess_7377),Ksrv_7430))
                )
                else
                    {9029}let pkDisco_7431: bitstring = fail-any in
                    {9030}in(c, (=pkCli_7379,m1_7432: bitstring,sigM1_7433: bitstring));
                    {9031}if (verify(h(m1_7432),sigM1_7433,pkCli_7379) <> true) then
                        0
                    else
                        {9032}let (SPc_7434: bitstring,PartC_7435: bitstring) = m1_7432 in
                        {9033}new Ns_7436: bitstring;
                        {9034}let m2_7437: bitstring = exp(g,Ns_7436) in
                        {9035}out(c, (m2_7437,sign(h(m2_7437),skSess_7376)));
                        {9036}let Ksrv_7438: bitstring = exp(PartC_7435,Ns_7436) in
                        {9037}out(c, senc(mSrv(pkCli_7379,pkSess_7377),Ksrv_7438))
            )
            else
                {9038}let v_7439: bool = (Cli_4826 = B) in
                (
                    {9039}if v_7439 then
                    (
                        {9040}let pkCli_7440: bitstring = pub(skB) in
                        {9041}let v_7441: bool = (Disco_4827 = A) in
                        (
                            {9042}if v_7441 then
                            (
                                {9043}let pkDisco_7442: bitstring = pub(skA) in
                                {9044}in(c, (=pkCli_7440,m1_7443: bitstring,sigM1_7444: bitstring));
                                {9045}if (verify(h(m1_7443),sigM1_7444,pkCli_7440) <> true) then
                                    0
                                else
                                    {9046}let (SPc_7445: bitstring,PartC_7446: bitstring) = m1_7443 in
                                    {9047}new Ns_7447: bitstring;
                                    {9048}let m2_7448: bitstring = exp(g,Ns_7447) in
                                    {9049}out(c, (m2_7448,sign(h(m2_7448),skSess_7376)));
                                    {9050}let Ksrv_7449: bitstring = exp(PartC_7446,Ns_7447) in
                                    {9051}out(c, senc(mSrv(pkCli_7440,pkSess_7377),Ksrv_7449))
                            )
                            else
                                {9052}let v_7450: bool = (Disco_4827 = B) in
                                (
                                    {9053}if v_7450 then
                                    (
                                        {9054}let pkDisco_7451: bitstring = pub(skB) in
                                        {9055}in(c, (=pkCli_7440,m1_7452: bitstring,sigM1_7453: bitstring));
                                        {9056}if (verify(h(m1_7452),sigM1_7453,pkCli_7440) <> true) then
                                            0
                                        else
                                            {9057}let (SPc_7454: bitstring,PartC_7455: bitstring) = m1_7452 in
                                            {9058}new Ns_7456: bitstring;
                                            {9059}let m2_7457: bitstring = exp(g,Ns_7456) in
                                            {9060}out(c, (m2_7457,sign(h(m2_7457),skSess_7376)));
                                            {9061}let Ksrv_7458: bitstring = exp(PartC_7455,Ns_7456) in
                                            {9062}out(c, senc(mSrv(pkCli_7440,pkSess_7377),Ksrv_7458))
                                    )
                                    else
                                        {9063}let v_7459: bool = (Disco_4827 = C) in
                                        (
                                            {9064}if v_7459 then
                                            (
                                                {9065}let pkDisco_7460: bitstring = pub(skC) in
                                                {9066}in(c, (=pkCli_7440,m1_7461: bitstring,sigM1_7462: bitstring));
                                                {9067}if (verify(h(m1_7461),sigM1_7462,pkCli_7440) <> true) then
                                                    0
                                                else
                                                    {9068}let (SPc_7463: bitstring,PartC_7464: bitstring) = m1_7461 in
                                                    {9069}new Ns_7465: bitstring;
                                                    {9070}let m2_7466: bitstring = exp(g,Ns_7465) in
                                                    {9071}out(c, (m2_7466,sign(h(m2_7466),skSess_7376)));
                                                    {9072}let Ksrv_7467: bitstring = exp(PartC_7464,Ns_7465) in
                                                    {9073}out(c, senc(mSrv(pkCli_7440,pkSess_7377),Ksrv_7467))
                                            )
                                            else
                                                {9074}let pkDisco_7468: bitstring = pub(skI) in
                                                {9075}in(c, (=pkCli_7440,m1_7469: bitstring,sigM1_7470: bitstring));
                                                {9076}if (verify(h(m1_7469),sigM1_7470,pkCli_7440) <> true) then
                                                    0
                                                else
                                                    {9077}let (SPc_7471: bitstring,PartC_7472: bitstring) = m1_7469 in
                                                    {9078}new Ns_7473: bitstring;
                                                    {9079}let m2_7474: bitstring = exp(g,Ns_7473) in
                                                    {9080}out(c, (m2_7474,sign(h(m2_7474),skSess_7376)));
                                                    {9081}let Ksrv_7475: bitstring = exp(PartC_7472,Ns_7473) in
                                                    {9082}out(c, senc(mSrv(pkCli_7440,pkSess_7377),Ksrv_7475))
                                        )
                                        else
                                            {9083}let pkDisco_7476: bitstring = fail-any in
                                            {9084}in(c, (=pkCli_7440,m1_7477: bitstring,sigM1_7478: bitstring));
                                            {9085}if (verify(h(m1_7477),sigM1_7478,pkCli_7440) <> true) then
                                                0
                                            else
                                                {9086}let (SPc_7479: bitstring,PartC_7480: bitstring) = m1_7477 in
                                                {9087}new Ns_7481: bitstring;
                                                {9088}let m2_7482: bitstring = exp(g,Ns_7481) in
                                                {9089}out(c, (m2_7482,sign(h(m2_7482),skSess_7376)));
                                                {9090}let Ksrv_7483: bitstring = exp(PartC_7480,Ns_7481) in
                                                {9091}out(c, senc(mSrv(pkCli_7440,pkSess_7377),Ksrv_7483))
                                )
                                else
                                    {9092}let pkDisco_7484: bitstring = fail-any in
                                    {9093}in(c, (=pkCli_7440,m1_7485: bitstring,sigM1_7486: bitstring));
                                    {9094}if (verify(h(m1_7485),sigM1_7486,pkCli_7440) <> true) then
                                        0
                                    else
                                        {9095}let (SPc_7487: bitstring,PartC_7488: bitstring) = m1_7485 in
                                        {9096}new Ns_7489: bitstring;
                                        {9097}let m2_7490: bitstring = exp(g,Ns_7489) in
                                        {9098}out(c, (m2_7490,sign(h(m2_7490),skSess_7376)));
                                        {9099}let Ksrv_7491: bitstring = exp(PartC_7488,Ns_7489) in
                                        {9100}out(c, senc(mSrv(pkCli_7440,pkSess_7377),Ksrv_7491))
                        )
                        else
                            {9101}let pkDisco_7492: bitstring = fail-any in
                            {9102}in(c, (=pkCli_7440,m1_7493: bitstring,sigM1_7494: bitstring));
                            {9103}if (verify(h(m1_7493),sigM1_7494,pkCli_7440) <> true) then
                                0
                            else
                                {9104}let (SPc_7495: bitstring,PartC_7496: bitstring) = m1_7493 in
                                {9105}new Ns_7497: bitstring;
                                {9106}let m2_7498: bitstring = exp(g,Ns_7497) in
                                {9107}out(c, (m2_7498,sign(h(m2_7498),skSess_7376)));
                                {9108}let Ksrv_7499: bitstring = exp(PartC_7496,Ns_7497) in
                                {9109}out(c, senc(mSrv(pkCli_7440,pkSess_7377),Ksrv_7499))
                    )
                    else
                        {9110}let v_7500: bool = (Cli_4826 = C) in
                        (
                            {9111}if v_7500 then
                            (
                                {9112}let pkCli_7501: bitstring = pub(skC) in
                                {9113}let v_7502: bool = (Disco_4827 = A) in
                                (
                                    {9114}if v_7502 then
                                    (
                                        {9115}let pkDisco_7503: bitstring = pub(skA) in
                                        {9116}in(c, (=pkCli_7501,m1_7504: bitstring,sigM1_7505: bitstring));
                                        {9117}if (verify(h(m1_7504),sigM1_7505,pkCli_7501) <> true) then
                                            0
                                        else
                                            {9118}let (SPc_7506: bitstring,PartC_7507: bitstring) = m1_7504 in
                                            {9119}new Ns_7508: bitstring;
                                            {9120}let m2_7509: bitstring = exp(g,Ns_7508) in
                                            {9121}out(c, (m2_7509,sign(h(m2_7509),skSess_7376)));
                                            {9122}let Ksrv_7510: bitstring = exp(PartC_7507,Ns_7508) in
                                            {9123}out(c, senc(mSrv(pkCli_7501,pkSess_7377),Ksrv_7510))
                                    )
                                    else
                                        {9124}let v_7511: bool = (Disco_4827 = B) in
                                        (
                                            {9125}if v_7511 then
                                            (
                                                {9126}let pkDisco_7512: bitstring = pub(skB) in
                                                {9127}in(c, (=pkCli_7501,m1_7513: bitstring,sigM1_7514: bitstring));
                                                {9128}if (verify(h(m1_7513),sigM1_7514,pkCli_7501) <> true) then
                                                    0
                                                else
                                                    {9129}let (SPc_7515: bitstring,PartC_7516: bitstring) = m1_7513 in
                                                    {9130}new Ns_7517: bitstring;
                                                    {9131}let m2_7518: bitstring = exp(g,Ns_7517) in
                                                    {9132}out(c, (m2_7518,sign(h(m2_7518),skSess_7376)));
                                                    {9133}let Ksrv_7519: bitstring = exp(PartC_7516,Ns_7517) in
                                                    {9134}out(c, senc(mSrv(pkCli_7501,pkSess_7377),Ksrv_7519))
                                            )
                                            else
                                                {9135}let v_7520: bool = (Disco_4827 = C) in
                                                (
                                                    {9136}if v_7520 then
                                                    (
                                                        {9137}let pkDisco_7521: bitstring = pub(skC) in
                                                        {9138}in(c, (=pkCli_7501,m1_7522: bitstring,sigM1_7523: bitstring));
                                                        {9139}if (verify(h(m1_7522),sigM1_7523,pkCli_7501) <> true) then
                                                            0
                                                        else
                                                            {9140}let (SPc_7524: bitstring,PartC_7525: bitstring) = m1_7522 in
                                                            {9141}new Ns_7526: bitstring;
                                                            {9142}let m2_7527: bitstring = exp(g,Ns_7526) in
                                                            {9143}out(c, (m2_7527,sign(h(m2_7527),skSess_7376)));
                                                            {9144}let Ksrv_7528: bitstring = exp(PartC_7525,Ns_7526) in
                                                            {9145}out(c, senc(mSrv(pkCli_7501,pkSess_7377),Ksrv_7528))
                                                    )
                                                    else
                                                        {9146}let pkDisco_7529: bitstring = pub(skI) in
                                                        {9147}in(c, (=pkCli_7501,m1_7530: bitstring,sigM1_7531: bitstring));
                                                        {9148}if (verify(h(m1_7530),sigM1_7531,pkCli_7501) <> true) then
                                                            0
                                                        else
                                                            {9149}let (SPc_7532: bitstring,PartC_7533: bitstring) = m1_7530 in
                                                            {9150}new Ns_7534: bitstring;
                                                            {9151}let m2_7535: bitstring = exp(g,Ns_7534) in
                                                            {9152}out(c, (m2_7535,sign(h(m2_7535),skSess_7376)));
                                                            {9153}let Ksrv_7536: bitstring = exp(PartC_7533,Ns_7534) in
                                                            {9154}out(c, senc(mSrv(pkCli_7501,pkSess_7377),Ksrv_7536))
                                                )
                                                else
                                                    {9155}let pkDisco_7537: bitstring = fail-any in
                                                    {9156}in(c, (=pkCli_7501,m1_7538: bitstring,sigM1_7539: bitstring));
                                                    {9157}if (verify(h(m1_7538),sigM1_7539,pkCli_7501) <> true) then
                                                        0
                                                    else
                                                        {9158}let (SPc_7540: bitstring,PartC_7541: bitstring) = m1_7538 in
                                                        {9159}new Ns_7542: bitstring;
                                                        {9160}let m2_7543: bitstring = exp(g,Ns_7542) in
                                                        {9161}out(c, (m2_7543,sign(h(m2_7543),skSess_7376)));
                                                        {9162}let Ksrv_7544: bitstring = exp(PartC_7541,Ns_7542) in
                                                        {9163}out(c, senc(mSrv(pkCli_7501,pkSess_7377),Ksrv_7544))
                                        )
                                        else
                                            {9164}let pkDisco_7545: bitstring = fail-any in
                                            {9165}in(c, (=pkCli_7501,m1_7546: bitstring,sigM1_7547: bitstring));
                                            {9166}if (verify(h(m1_7546),sigM1_7547,pkCli_7501) <> true) then
                                                0
                                            else
                                                {9167}let (SPc_7548: bitstring,PartC_7549: bitstring) = m1_7546 in
                                                {9168}new Ns_7550: bitstring;
                                                {9169}let m2_7551: bitstring = exp(g,Ns_7550) in
                                                {9170}out(c, (m2_7551,sign(h(m2_7551),skSess_7376)));
                                                {9171}let Ksrv_7552: bitstring = exp(PartC_7549,Ns_7550) in
                                                {9172}out(c, senc(mSrv(pkCli_7501,pkSess_7377),Ksrv_7552))
                                )
                                else
                                    {9173}let pkDisco_7553: bitstring = fail-any in
                                    {9174}in(c, (=pkCli_7501,m1_7554: bitstring,sigM1_7555: bitstring));
                                    {9175}if (verify(h(m1_7554),sigM1_7555,pkCli_7501) <> true) then
                                        0
                                    else
                                        {9176}let (SPc_7556: bitstring,PartC_7557: bitstring) = m1_7554 in
                                        {9177}new Ns_7558: bitstring;
                                        {9178}let m2_7559: bitstring = exp(g,Ns_7558) in
                                        {9179}out(c, (m2_7559,sign(h(m2_7559),skSess_7376)));
                                        {9180}let Ksrv_7560: bitstring = exp(PartC_7557,Ns_7558) in
                                        {9181}out(c, senc(mSrv(pkCli_7501,pkSess_7377),Ksrv_7560))
                            )
                            else
                                {9182}let pkCli_7561: bitstring = pub(skI) in
                                {9183}let v_7562: bool = (Disco_4827 = A) in
                                (
                                    {9184}if v_7562 then
                                    (
                                        {9185}let pkDisco_7563: bitstring = pub(skA) in
                                        {9186}in(c, (=pkCli_7561,m1_7564: bitstring,sigM1_7565: bitstring));
                                        {9187}if (verify(h(m1_7564),sigM1_7565,pkCli_7561) <> true) then
                                            0
                                        else
                                            {9188}let (SPc_7566: bitstring,PartC_7567: bitstring) = m1_7564 in
                                            {9189}new Ns_7568: bitstring;
                                            {9190}let m2_7569: bitstring = exp(g,Ns_7568) in
                                            {9191}out(c, (m2_7569,sign(h(m2_7569),skSess_7376)));
                                            {9192}let Ksrv_7570: bitstring = exp(PartC_7567,Ns_7568) in
                                            {9193}out(c, senc(mSrv(pkCli_7561,pkSess_7377),Ksrv_7570))
                                    )
                                    else
                                        {9194}let v_7571: bool = (Disco_4827 = B) in
                                        (
                                            {9195}if v_7571 then
                                            (
                                                {9196}let pkDisco_7572: bitstring = pub(skB) in
                                                {9197}in(c, (=pkCli_7561,m1_7573: bitstring,sigM1_7574: bitstring));
                                                {9198}if (verify(h(m1_7573),sigM1_7574,pkCli_7561) <> true) then
                                                    0
                                                else
                                                    {9199}let (SPc_7575: bitstring,PartC_7576: bitstring) = m1_7573 in
                                                    {9200}new Ns_7577: bitstring;
                                                    {9201}let m2_7578: bitstring = exp(g,Ns_7577) in
                                                    {9202}out(c, (m2_7578,sign(h(m2_7578),skSess_7376)));
                                                    {9203}let Ksrv_7579: bitstring = exp(PartC_7576,Ns_7577) in
                                                    {9204}out(c, senc(mSrv(pkCli_7561,pkSess_7377),Ksrv_7579))
                                            )
                                            else
                                                {9205}let v_7580: bool = (Disco_4827 = C) in
                                                (
                                                    {9206}if v_7580 then
                                                    (
                                                        {9207}let pkDisco_7581: bitstring = pub(skC) in
                                                        {9208}in(c, (=pkCli_7561,m1_7582: bitstring,sigM1_7583: bitstring));
                                                        {9209}if (verify(h(m1_7582),sigM1_7583,pkCli_7561) <> true) then
                                                            0
                                                        else
                                                            {9210}let (SPc_7584: bitstring,PartC_7585: bitstring) = m1_7582 in
                                                            {9211}new Ns_7586: bitstring;
                                                            {9212}let m2_7587: bitstring = exp(g,Ns_7586) in
                                                            {9213}out(c, (m2_7587,sign(h(m2_7587),skSess_7376)));
                                                            {9214}let Ksrv_7588: bitstring = exp(PartC_7585,Ns_7586) in
                                                            {9215}out(c, senc(mSrv(pkCli_7561,pkSess_7377),Ksrv_7588))
                                                    )
                                                    else
                                                        {9216}let pkDisco_7589: bitstring = pub(skI) in
                                                        {9217}in(c, (=pkCli_7561,m1_7590: bitstring,sigM1_7591: bitstring));
                                                        {9218}if (verify(h(m1_7590),sigM1_7591,pkCli_7561) <> true) then
                                                            0
                                                        else
                                                            {9219}let (SPc_7592: bitstring,PartC_7593: bitstring) = m1_7590 in
                                                            {9220}new Ns_7594: bitstring;
                                                            {9221}let m2_7595: bitstring = exp(g,Ns_7594) in
                                                            {9222}out(c, (m2_7595,sign(h(m2_7595),skSess_7376)));
                                                            {9223}let Ksrv_7596: bitstring = exp(PartC_7593,Ns_7594) in
                                                            {9224}out(c, senc(mSrv(pkCli_7561,pkSess_7377),Ksrv_7596))
                                                )
                                                else
                                                    {9225}let pkDisco_7597: bitstring = fail-any in
                                                    {9226}in(c, (=pkCli_7561,m1_7598: bitstring,sigM1_7599: bitstring));
                                                    {9227}if (verify(h(m1_7598),sigM1_7599,pkCli_7561) <> true) then
                                                        0
                                                    else
                                                        {9228}let (SPc_7600: bitstring,PartC_7601: bitstring) = m1_7598 in
                                                        {9229}new Ns_7602: bitstring;
                                                        {9230}let m2_7603: bitstring = exp(g,Ns_7602) in
                                                        {9231}out(c, (m2_7603,sign(h(m2_7603),skSess_7376)));
                                                        {9232}let Ksrv_7604: bitstring = exp(PartC_7601,Ns_7602) in
                                                        {9233}out(c, senc(mSrv(pkCli_7561,pkSess_7377),Ksrv_7604))
                                        )
                                        else
                                            {9234}let pkDisco_7605: bitstring = fail-any in
                                            {9235}in(c, (=pkCli_7561,m1_7606: bitstring,sigM1_7607: bitstring));
                                            {9236}if (verify(h(m1_7606),sigM1_7607,pkCli_7561) <> true) then
                                                0
                                            else
                                                {9237}let (SPc_7608: bitstring,PartC_7609: bitstring) = m1_7606 in
                                                {9238}new Ns_7610: bitstring;
                                                {9239}let m2_7611: bitstring = exp(g,Ns_7610) in
                                                {9240}out(c, (m2_7611,sign(h(m2_7611),skSess_7376)));
                                                {9241}let Ksrv_7612: bitstring = exp(PartC_7609,Ns_7610) in
                                                {9242}out(c, senc(mSrv(pkCli_7561,pkSess_7377),Ksrv_7612))
                                )
                                else
                                    {9243}let pkDisco_7613: bitstring = fail-any in
                                    {9244}in(c, (=pkCli_7561,m1_7614: bitstring,sigM1_7615: bitstring));
                                    {9245}if (verify(h(m1_7614),sigM1_7615,pkCli_7561) <> true) then
                                        0
                                    else
                                        {9246}let (SPc_7616: bitstring,PartC_7617: bitstring) = m1_7614 in
                                        {9247}new Ns_7618: bitstring;
                                        {9248}let m2_7619: bitstring = exp(g,Ns_7618) in
                                        {9249}out(c, (m2_7619,sign(h(m2_7619),skSess_7376)));
                                        {9250}let Ksrv_7620: bitstring = exp(PartC_7617,Ns_7618) in
                                        {9251}out(c, senc(mSrv(pkCli_7561,pkSess_7377),Ksrv_7620))
                        )
                        else
                            {9252}let pkCli_7621: bitstring = fail-any in
                            {9253}let v_7622: bool = (Disco_4827 = A) in
                            (
                                {9254}if v_7622 then
                                (
                                    {9255}let pkDisco_7623: bitstring = pub(skA) in
                                    {9256}in(c, (=pkCli_7621,m1_7624: bitstring,sigM1_7625: bitstring));
                                    {9257}if (verify(h(m1_7624),sigM1_7625,pkCli_7621) <> true) then
                                        0
                                    else
                                        {9258}let (SPc_7626: bitstring,PartC_7627: bitstring) = m1_7624 in
                                        {9259}new Ns_7628: bitstring;
                                        {9260}let m2_7629: bitstring = exp(g,Ns_7628) in
                                        {9261}out(c, (m2_7629,sign(h(m2_7629),skSess_7376)));
                                        {9262}let Ksrv_7630: bitstring = exp(PartC_7627,Ns_7628) in
                                        {9263}out(c, senc(mSrv(pkCli_7621,pkSess_7377),Ksrv_7630))
                                )
                                else
                                    {9264}let v_7631: bool = (Disco_4827 = B) in
                                    (
                                        {9265}if v_7631 then
                                        (
                                            {9266}let pkDisco_7632: bitstring = pub(skB) in
                                            {9267}in(c, (=pkCli_7621,m1_7633: bitstring,sigM1_7634: bitstring));
                                            {9268}if (verify(h(m1_7633),sigM1_7634,pkCli_7621) <> true) then
                                                0
                                            else
                                                {9269}let (SPc_7635: bitstring,PartC_7636: bitstring) = m1_7633 in
                                                {9270}new Ns_7637: bitstring;
                                                {9271}let m2_7638: bitstring = exp(g,Ns_7637) in
                                                {9272}out(c, (m2_7638,sign(h(m2_7638),skSess_7376)));
                                                {9273}let Ksrv_7639: bitstring = exp(PartC_7636,Ns_7637) in
                                                {9274}out(c, senc(mSrv(pkCli_7621,pkSess_7377),Ksrv_7639))
                                        )
                                        else
                                            {9275}let v_7640: bool = (Disco_4827 = C) in
                                            (
                                                {9276}if v_7640 then
                                                (
                                                    {9277}let pkDisco_7641: bitstring = pub(skC) in
                                                    {9278}in(c, (=pkCli_7621,m1_7642: bitstring,sigM1_7643: bitstring));
                                                    {9279}if (verify(h(m1_7642),sigM1_7643,pkCli_7621) <> true) then
                                                        0
                                                    else
                                                        {9280}let (SPc_7644: bitstring,PartC_7645: bitstring) = m1_7642 in
                                                        {9281}new Ns_7646: bitstring;
                                                        {9282}let m2_7647: bitstring = exp(g,Ns_7646) in
                                                        {9283}out(c, (m2_7647,sign(h(m2_7647),skSess_7376)));
                                                        {9284}let Ksrv_7648: bitstring = exp(PartC_7645,Ns_7646) in
                                                        {9285}out(c, senc(mSrv(pkCli_7621,pkSess_7377),Ksrv_7648))
                                                )
                                                else
                                                    {9286}let pkDisco_7649: bitstring = pub(skI) in
                                                    {9287}in(c, (=pkCli_7621,m1_7650: bitstring,sigM1_7651: bitstring));
                                                    {9288}if (verify(h(m1_7650),sigM1_7651,pkCli_7621) <> true) then
                                                        0
                                                    else
                                                        {9289}let (SPc_7652: bitstring,PartC_7653: bitstring) = m1_7650 in
                                                        {9290}new Ns_7654: bitstring;
                                                        {9291}let m2_7655: bitstring = exp(g,Ns_7654) in
                                                        {9292}out(c, (m2_7655,sign(h(m2_7655),skSess_7376)));
                                                        {9293}let Ksrv_7656: bitstring = exp(PartC_7653,Ns_7654) in
                                                        {9294}out(c, senc(mSrv(pkCli_7621,pkSess_7377),Ksrv_7656))
                                            )
                                            else
                                                {9295}let pkDisco_7657: bitstring = fail-any in
                                                {9296}in(c, (=pkCli_7621,m1_7658: bitstring,sigM1_7659: bitstring));
                                                {9297}if (verify(h(m1_7658),sigM1_7659,pkCli_7621) <> true) then
                                                    0
                                                else
                                                    {9298}let (SPc_7660: bitstring,PartC_7661: bitstring) = m1_7658 in
                                                    {9299}new Ns_7662: bitstring;
                                                    {9300}let m2_7663: bitstring = exp(g,Ns_7662) in
                                                    {9301}out(c, (m2_7663,sign(h(m2_7663),skSess_7376)));
                                                    {9302}let Ksrv_7664: bitstring = exp(PartC_7661,Ns_7662) in
                                                    {9303}out(c, senc(mSrv(pkCli_7621,pkSess_7377),Ksrv_7664))
                                    )
                                    else
                                        {9304}let pkDisco_7665: bitstring = fail-any in
                                        {9305}in(c, (=pkCli_7621,m1_7666: bitstring,sigM1_7667: bitstring));
                                        {9306}if (verify(h(m1_7666),sigM1_7667,pkCli_7621) <> true) then
                                            0
                                        else
                                            {9307}let (SPc_7668: bitstring,PartC_7669: bitstring) = m1_7666 in
                                            {9308}new Ns_7670: bitstring;
                                            {9309}let m2_7671: bitstring = exp(g,Ns_7670) in
                                            {9310}out(c, (m2_7671,sign(h(m2_7671),skSess_7376)));
                                            {9311}let Ksrv_7672: bitstring = exp(PartC_7669,Ns_7670) in
                                            {9312}out(c, senc(mSrv(pkCli_7621,pkSess_7377),Ksrv_7672))
                            )
                            else
                                {9313}let pkDisco_7673: bitstring = fail-any in
                                {9314}in(c, (=pkCli_7621,m1_7674: bitstring,sigM1_7675: bitstring));
                                {9315}if (verify(h(m1_7674),sigM1_7675,pkCli_7621) <> true) then
                                    0
                                else
                                    {9316}let (SPc_7676: bitstring,PartC_7677: bitstring) = m1_7674 in
                                    {9317}new Ns_7678: bitstring;
                                    {9318}let m2_7679: bitstring = exp(g,Ns_7678) in
                                    {9319}out(c, (m2_7679,sign(h(m2_7679),skSess_7376)));
                                    {9320}let Ksrv_7680: bitstring = exp(PartC_7677,Ns_7678) in
                                    {9321}out(c, senc(mSrv(pkCli_7621,pkSess_7377),Ksrv_7680))
                )
                else
                    {9322}let pkCli_7681: bitstring = fail-any in
                    {9323}let v_7682: bool = (Disco_4827 = A) in
                    (
                        {9324}if v_7682 then
                        (
                            {9325}let pkDisco_7683: bitstring = pub(skA) in
                            {9326}in(c, (=pkCli_7681,m1_7684: bitstring,sigM1_7685: bitstring));
                            {9327}if (verify(h(m1_7684),sigM1_7685,pkCli_7681) <> true) then
                                0
                            else
                                {9328}let (SPc_7686: bitstring,PartC_7687: bitstring) = m1_7684 in
                                {9329}new Ns_7688: bitstring;
                                {9330}let m2_7689: bitstring = exp(g,Ns_7688) in
                                {9331}out(c, (m2_7689,sign(h(m2_7689),skSess_7376)));
                                {9332}let Ksrv_7690: bitstring = exp(PartC_7687,Ns_7688) in
                                {9333}out(c, senc(mSrv(pkCli_7681,pkSess_7377),Ksrv_7690))
                        )
                        else
                            {9334}let v_7691: bool = (Disco_4827 = B) in
                            (
                                {9335}if v_7691 then
                                (
                                    {9336}let pkDisco_7692: bitstring = pub(skB) in
                                    {9337}in(c, (=pkCli_7681,m1_7693: bitstring,sigM1_7694: bitstring));
                                    {9338}if (verify(h(m1_7693),sigM1_7694,pkCli_7681) <> true) then
                                        0
                                    else
                                        {9339}let (SPc_7695: bitstring,PartC_7696: bitstring) = m1_7693 in
                                        {9340}new Ns_7697: bitstring;
                                        {9341}let m2_7698: bitstring = exp(g,Ns_7697) in
                                        {9342}out(c, (m2_7698,sign(h(m2_7698),skSess_7376)));
                                        {9343}let Ksrv_7699: bitstring = exp(PartC_7696,Ns_7697) in
                                        {9344}out(c, senc(mSrv(pkCli_7681,pkSess_7377),Ksrv_7699))
                                )
                                else
                                    {9345}let v_7700: bool = (Disco_4827 = C) in
                                    (
                                        {9346}if v_7700 then
                                        (
                                            {9347}let pkDisco_7701: bitstring = pub(skC) in
                                            {9348}in(c, (=pkCli_7681,m1_7702: bitstring,sigM1_7703: bitstring));
                                            {9349}if (verify(h(m1_7702),sigM1_7703,pkCli_7681) <> true) then
                                                0
                                            else
                                                {9350}let (SPc_7704: bitstring,PartC_7705: bitstring) = m1_7702 in
                                                {9351}new Ns_7706: bitstring;
                                                {9352}let m2_7707: bitstring = exp(g,Ns_7706) in
                                                {9353}out(c, (m2_7707,sign(h(m2_7707),skSess_7376)));
                                                {9354}let Ksrv_7708: bitstring = exp(PartC_7705,Ns_7706) in
                                                {9355}out(c, senc(mSrv(pkCli_7681,pkSess_7377),Ksrv_7708))
                                        )
                                        else
                                            {9356}let pkDisco_7709: bitstring = pub(skI) in
                                            {9357}in(c, (=pkCli_7681,m1_7710: bitstring,sigM1_7711: bitstring));
                                            {9358}if (verify(h(m1_7710),sigM1_7711,pkCli_7681) <> true) then
                                                0
                                            else
                                                {9359}let (SPc_7712: bitstring,PartC_7713: bitstring) = m1_7710 in
                                                {9360}new Ns_7714: bitstring;
                                                {9361}let m2_7715: bitstring = exp(g,Ns_7714) in
                                                {9362}out(c, (m2_7715,sign(h(m2_7715),skSess_7376)));
                                                {9363}let Ksrv_7716: bitstring = exp(PartC_7713,Ns_7714) in
                                                {9364}out(c, senc(mSrv(pkCli_7681,pkSess_7377),Ksrv_7716))
                                    )
                                    else
                                        {9365}let pkDisco_7717: bitstring = fail-any in
                                        {9366}in(c, (=pkCli_7681,m1_7718: bitstring,sigM1_7719: bitstring));
                                        {9367}if (verify(h(m1_7718),sigM1_7719,pkCli_7681) <> true) then
                                            0
                                        else
                                            {9368}let (SPc_7720: bitstring,PartC_7721: bitstring) = m1_7718 in
                                            {9369}new Ns_7722: bitstring;
                                            {9370}let m2_7723: bitstring = exp(g,Ns_7722) in
                                            {9371}out(c, (m2_7723,sign(h(m2_7723),skSess_7376)));
                                            {9372}let Ksrv_7724: bitstring = exp(PartC_7721,Ns_7722) in
                                            {9373}out(c, senc(mSrv(pkCli_7681,pkSess_7377),Ksrv_7724))
                            )
                            else
                                {9374}let pkDisco_7725: bitstring = fail-any in
                                {9375}in(c, (=pkCli_7681,m1_7726: bitstring,sigM1_7727: bitstring));
                                {9376}if (verify(h(m1_7726),sigM1_7727,pkCli_7681) <> true) then
                                    0
                                else
                                    {9377}let (SPc_7728: bitstring,PartC_7729: bitstring) = m1_7726 in
                                    {9378}new Ns_7730: bitstring;
                                    {9379}let m2_7731: bitstring = exp(g,Ns_7730) in
                                    {9380}out(c, (m2_7731,sign(h(m2_7731),skSess_7376)));
                                    {9381}let Ksrv_7732: bitstring = exp(PartC_7729,Ns_7730) in
                                    {9382}out(c, senc(mSrv(pkCli_7681,pkSess_7377),Ksrv_7732))
                    )
                    else
                        {9383}let pkDisco_7733: bitstring = fail-any in
                        {9384}in(c, (=pkCli_7681,m1_7734: bitstring,sigM1_7735: bitstring));
                        {9385}if (verify(h(m1_7734),sigM1_7735,pkCli_7681) <> true) then
                            0
                        else
                            {9386}let (SPc_7736: bitstring,PartC_7737: bitstring) = m1_7734 in
                            {9387}new Ns_7738: bitstring;
                            {9388}let m2_7739: bitstring = exp(g,Ns_7738) in
                            {9389}out(c, (m2_7739,sign(h(m2_7739),skSess_7376)));
                            {9390}let Ksrv_7740: bitstring = exp(PartC_7737,Ns_7738) in
                            {9391}out(c, senc(mSrv(pkCli_7681,pkSess_7377),Ksrv_7740))
        )
        else
            {9392}let pkCli_7741: bitstring = fail-any in
            {9393}let v_7742: bool = (Disco_4827 = A) in
            (
                {9394}if v_7742 then
                (
                    {9395}let pkDisco_7743: bitstring = pub(skA) in
                    {9396}in(c, (=pkCli_7741,m1_7744: bitstring,sigM1_7745: bitstring));
                    {9397}if (verify(h(m1_7744),sigM1_7745,pkCli_7741) <> true) then
                        0
                    else
                        {9398}let (SPc_7746: bitstring,PartC_7747: bitstring) = m1_7744 in
                        {9399}new Ns_7748: bitstring;
                        {9400}let m2_7749: bitstring = exp(g,Ns_7748) in
                        {9401}out(c, (m2_7749,sign(h(m2_7749),skSess_7376)));
                        {9402}let Ksrv_7750: bitstring = exp(PartC_7747,Ns_7748) in
                        {9403}out(c, senc(mSrv(pkCli_7741,pkSess_7377),Ksrv_7750))
                )
                else
                    {9404}let v_7751: bool = (Disco_4827 = B) in
                    (
                        {9405}if v_7751 then
                        (
                            {9406}let pkDisco_7752: bitstring = pub(skB) in
                            {9407}in(c, (=pkCli_7741,m1_7753: bitstring,sigM1_7754: bitstring));
                            {9408}if (verify(h(m1_7753),sigM1_7754,pkCli_7741) <> true) then
                                0
                            else
                                {9409}let (SPc_7755: bitstring,PartC_7756: bitstring) = m1_7753 in
                                {9410}new Ns_7757: bitstring;
                                {9411}let m2_7758: bitstring = exp(g,Ns_7757) in
                                {9412}out(c, (m2_7758,sign(h(m2_7758),skSess_7376)));
                                {9413}let Ksrv_7759: bitstring = exp(PartC_7756,Ns_7757) in
                                {9414}out(c, senc(mSrv(pkCli_7741,pkSess_7377),Ksrv_7759))
                        )
                        else
                            {9415}let v_7760: bool = (Disco_4827 = C) in
                            (
                                {9416}if v_7760 then
                                (
                                    {9417}let pkDisco_7761: bitstring = pub(skC) in
                                    {9418}in(c, (=pkCli_7741,m1_7762: bitstring,sigM1_7763: bitstring));
                                    {9419}if (verify(h(m1_7762),sigM1_7763,pkCli_7741) <> true) then
                                        0
                                    else
                                        {9420}let (SPc_7764: bitstring,PartC_7765: bitstring) = m1_7762 in
                                        {9421}new Ns_7766: bitstring;
                                        {9422}let m2_7767: bitstring = exp(g,Ns_7766) in
                                        {9423}out(c, (m2_7767,sign(h(m2_7767),skSess_7376)));
                                        {9424}let Ksrv_7768: bitstring = exp(PartC_7765,Ns_7766) in
                                        {9425}out(c, senc(mSrv(pkCli_7741,pkSess_7377),Ksrv_7768))
                                )
                                else
                                    {9426}let pkDisco_7769: bitstring = pub(skI) in
                                    {9427}in(c, (=pkCli_7741,m1_7770: bitstring,sigM1_7771: bitstring));
                                    {9428}if (verify(h(m1_7770),sigM1_7771,pkCli_7741) <> true) then
                                        0
                                    else
                                        {9429}let (SPc_7772: bitstring,PartC_7773: bitstring) = m1_7770 in
                                        {9430}new Ns_7774: bitstring;
                                        {9431}let m2_7775: bitstring = exp(g,Ns_7774) in
                                        {9432}out(c, (m2_7775,sign(h(m2_7775),skSess_7376)));
                                        {9433}let Ksrv_7776: bitstring = exp(PartC_7773,Ns_7774) in
                                        {9434}out(c, senc(mSrv(pkCli_7741,pkSess_7377),Ksrv_7776))
                            )
                            else
                                {9435}let pkDisco_7777: bitstring = fail-any in
                                {9436}in(c, (=pkCli_7741,m1_7778: bitstring,sigM1_7779: bitstring));
                                {9437}if (verify(h(m1_7778),sigM1_7779,pkCli_7741) <> true) then
                                    0
                                else
                                    {9438}let (SPc_7780: bitstring,PartC_7781: bitstring) = m1_7778 in
                                    {9439}new Ns_7782: bitstring;
                                    {9440}let m2_7783: bitstring = exp(g,Ns_7782) in
                                    {9441}out(c, (m2_7783,sign(h(m2_7783),skSess_7376)));
                                    {9442}let Ksrv_7784: bitstring = exp(PartC_7781,Ns_7782) in
                                    {9443}out(c, senc(mSrv(pkCli_7741,pkSess_7377),Ksrv_7784))
                    )
                    else
                        {9444}let pkDisco_7785: bitstring = fail-any in
                        {9445}in(c, (=pkCli_7741,m1_7786: bitstring,sigM1_7787: bitstring));
                        {9446}if (verify(h(m1_7786),sigM1_7787,pkCli_7741) <> true) then
                            0
                        else
                            {9447}let (SPc_7788: bitstring,PartC_7789: bitstring) = m1_7786 in
                            {9448}new Ns_7790: bitstring;
                            {9449}let m2_7791: bitstring = exp(g,Ns_7790) in
                            {9450}out(c, (m2_7791,sign(h(m2_7791),skSess_7376)));
                            {9451}let Ksrv_7792: bitstring = exp(PartC_7789,Ns_7790) in
                            {9452}out(c, senc(mSrv(pkCli_7741,pkSess_7377),Ksrv_7792))
            )
            else
                {9453}let pkDisco_7793: bitstring = fail-any in
                {9454}in(c, (=pkCli_7741,m1_7794: bitstring,sigM1_7795: bitstring));
                {9455}if (verify(h(m1_7794),sigM1_7795,pkCli_7741) <> true) then
                    0
                else
                    {9456}let (SPc_7796: bitstring,PartC_7797: bitstring) = m1_7794 in
                    {9457}new Ns_7798: bitstring;
                    {9458}let m2_7799: bitstring = exp(g,Ns_7798) in
                    {9459}out(c, (m2_7799,sign(h(m2_7799),skSess_7376)));
                    {9460}let Ksrv_7800: bitstring = exp(PartC_7797,Ns_7798) in
                    {9461}out(c, senc(mSrv(pkCli_7741,pkSess_7377),Ksrv_7800))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 110 rules. 645 rules in the queue.
400 rules inserted. The rule base contains 154 rules. 645 rules in the queue.
600 rules inserted. The rule base contains 324 rules. 642 rules in the queue.
800 rules inserted. The rule base contains 417 rules. 642 rules in the queue.
1000 rules inserted. The rule base contains 426 rules. 642 rules in the queue.
1200 rules inserted. The rule base contains 428 rules. 639 rules in the queue.
1400 rules inserted. The rule base contains 416 rules. 638 rules in the queue.
1600 rules inserted. The rule base contains 384 rules. 634 rules in the queue.
1800 rules inserted. The rule base contains 422 rules. 596 rules in the queue.
2000 rules inserted. The rule base contains 425 rules. 659 rules in the queue.
2200 rules inserted. The rule base contains 447 rules. 1164 rules in the queue.
2400 rules inserted. The rule base contains 602 rules. 1584 rules in the queue.
2600 rules inserted. The rule base contains 703 rules. 2031 rules in the queue.
2800 rules inserted. The rule base contains 770 rules. 3682 rules in the queue.
3000 rules inserted. The rule base contains 838 rules. 5333 rules in the queue.
3200 rules inserted. The rule base contains 897 rules. 5842 rules in the queue.
3400 rules inserted. The rule base contains 965 rules. 6987 rules in the queue.
3600 rules inserted. The rule base contains 1019 rules. 6984 rules in the queue.
3800 rules inserted. The rule base contains 1180 rules. 6833 rules in the queue.
4000 rules inserted. The rule base contains 1302 rules. 6711 rules in the queue.
4200 rules inserted. The rule base contains 1425 rules. 6588 rules in the queue.
4400 rules inserted. The rule base contains 1547 rules. 6466 rules in the queue.
4600 rules inserted. The rule base contains 1667 rules. 6476 rules in the queue.
4800 rules inserted. The rule base contains 1736 rules. 6419 rules in the queue.
5000 rules inserted. The rule base contains 1850 rules. 6328 rules in the queue.
5200 rules inserted. The rule base contains 1941 rules. 6268 rules in the queue.
5400 rules inserted. The rule base contains 2053 rules. 6437 rules in the queue.
5600 rules inserted. The rule base contains 2138 rules. 6641 rules in the queue.
5800 rules inserted. The rule base contains 2213 rules. 6583 rules in the queue.
6000 rules inserted. The rule base contains 2324 rules. 6494 rules in the queue.
6200 rules inserted. The rule base contains 2415 rules. 6434 rules in the queue.
6400 rules inserted. The rule base contains 2527 rules. 6603 rules in the queue.
6600 rules inserted. The rule base contains 2592 rules. 6548 rules in the queue.
6800 rules inserted. The rule base contains 2686 rules. 6617 rules in the queue.
7000 rules inserted. The rule base contains 2793 rules. 6532 rules in the queue.
7200 rules inserted. The rule base contains 2874 rules. 6609 rules in the queue.
7400 rules inserted. The rule base contains 2957 rules. 6543 rules in the queue.
7600 rules inserted. The rule base contains 3063 rules. 6462 rules in the queue.
7800 rules inserted. The rule base contains 3160 rules. 6783 rules in the queue.
8000 rules inserted. The rule base contains 3268 rules. 6700 rules in the queue.
8200 rules inserted. The rule base contains 3363 rules. 6763 rules in the queue.
8400 rules inserted. The rule base contains 3428 rules. 6706 rules in the queue.
8600 rules inserted. The rule base contains 3534 rules. 6627 rules in the queue.
8800 rules inserted. The rule base contains 3610 rules. 6577 rules in the queue.
9000 rules inserted. The rule base contains 3677 rules. 6527 rules in the queue.
9200 rules inserted. The rule base contains 3767 rules. 6447 rules in the queue.
9400 rules inserted. The rule base contains 3867 rules. 6375 rules in the queue.
9600 rules inserted. The rule base contains 3939 rules. 6325 rules in the queue.
9800 rules inserted. The rule base contains 4038 rules. 6235 rules in the queue.
10000 rules inserted. The rule base contains 4130 rules. 6173 rules in the queue.
10200 rules inserted. The rule base contains 4199 rules. 6123 rules in the queue.
10400 rules inserted. The rule base contains 4262 rules. 6068 rules in the queue.
10600 rules inserted. The rule base contains 4265 rules. 6065 rules in the queue.
10800 rules inserted. The rule base contains 4310 rules. 6531 rules in the queue.
11000 rules inserted. The rule base contains 4393 rules. 7106 rules in the queue.
11200 rules inserted. The rule base contains 4401 rules. 7100 rules in the queue.
11400 rules inserted. The rule base contains 4400 rules. 7088 rules in the queue.
11600 rules inserted. The rule base contains 4453 rules. 7038 rules in the queue.
11800 rules inserted. The rule base contains 4533 rules. 6988 rules in the queue.
12000 rules inserted. The rule base contains 4599 rules. 6938 rules in the queue.
12200 rules inserted. The rule base contains 4663 rules. 6889 rules in the queue.
12400 rules inserted. The rule base contains 4652 rules. 6887 rules in the queue.
12600 rules inserted. The rule base contains 4655 rules. 6879 rules in the queue.
12800 rules inserted. The rule base contains 4718 rules. 6830 rules in the queue.
13000 rules inserted. The rule base contains 4789 rules. 6780 rules in the queue.
13200 rules inserted. The rule base contains 4774 rules. 6772 rules in the queue.
13400 rules inserted. The rule base contains 4838 rules. 6717 rules in the queue.
13600 rules inserted. The rule base contains 4878 rules. 6677 rules in the queue.
13800 rules inserted. The rule base contains 4896 rules. 6665 rules in the queue.
14000 rules inserted. The rule base contains 4896 rules. 6663 rules in the queue.
14200 rules inserted. The rule base contains 4961 rules. 6608 rules in the queue.
14400 rules inserted. The rule base contains 5025 rules. 6559 rules in the queue.
14600 rules inserted. The rule base contains 5094 rules. 6509 rules in the queue.
14800 rules inserted. The rule base contains 5150 rules. 6454 rules in the queue.
15000 rules inserted. The rule base contains 5162 rules. 6451 rules in the queue.
15200 rules inserted. The rule base contains 5147 rules. 6444 rules in the queue.
15400 rules inserted. The rule base contains 5135 rules. 6442 rules in the queue.
15600 rules inserted. The rule base contains 5124 rules. 6439 rules in the queue.
15800 rules inserted. The rule base contains 5128 rules. 6437 rules in the queue.
16000 rules inserted. The rule base contains 5116 rules. 6434 rules in the queue.
16200 rules inserted. The rule base contains 5119 rules. 6432 rules in the queue.
16400 rules inserted. The rule base contains 5099 rules. 6429 rules in the queue.
16600 rules inserted. The rule base contains 5049 rules. 6429 rules in the queue.
16800 rules inserted. The rule base contains 5128 rules. 6635 rules in the queue.
17000 rules inserted. The rule base contains 5231 rules. 6692 rules in the queue.
17200 rules inserted. The rule base contains 5341 rules. 6745 rules in the queue.
17400 rules inserted. The rule base contains 5432 rules. 6950 rules in the queue.
17600 rules inserted. The rule base contains 5535 rules. 6902 rules in the queue.
17800 rules inserted. The rule base contains 5656 rules. 6811 rules in the queue.
18000 rules inserted. The rule base contains 5754 rules. 6756 rules in the queue.
18200 rules inserted. The rule base contains 5788 rules. 6641 rules in the queue.
18400 rules inserted. The rule base contains 5766 rules. 6633 rules in the queue.
18600 rules inserted. The rule base contains 5750 rules. 6625 rules in the queue.
18800 rules inserted. The rule base contains 5748 rules. 6619 rules in the queue.
19000 rules inserted. The rule base contains 5739 rules. 6613 rules in the queue.
19200 rules inserted. The rule base contains 5743 rules. 6596 rules in the queue.
19400 rules inserted. The rule base contains 5731 rules. 6587 rules in the queue.
19600 rules inserted. The rule base contains 5719 rules. 6580 rules in the queue.
19800 rules inserted. The rule base contains 5722 rules. 6566 rules in the queue.
20000 rules inserted. The rule base contains 5713 rules. 6554 rules in the queue.
20200 rules inserted. The rule base contains 5704 rules. 6547 rules in the queue.
20400 rules inserted. The rule base contains 5701 rules. 6534 rules in the queue.
20600 rules inserted. The rule base contains 5690 rules. 6523 rules in the queue.
20800 rules inserted. The rule base contains 5689 rules. 6514 rules in the queue.
21000 rules inserted. The rule base contains 5682 rules. 6511 rules in the queue.
21200 rules inserted. The rule base contains 5670 rules. 6502 rules in the queue.
21400 rules inserted. The rule base contains 5657 rules. 6495 rules in the queue.
21600 rules inserted. The rule base contains 5661 rules. 6475 rules in the queue.
21800 rules inserted. The rule base contains 5664 rules. 6456 rules in the queue.
22000 rules inserted. The rule base contains 5662 rules. 6437 rules in the queue.
22200 rules inserted. The rule base contains 5642 rules. 6431 rules in the queue.
22400 rules inserted. The rule base contains 5644 rules. 6412 rules in the queue.
22600 rules inserted. The rule base contains 5620 rules. 6406 rules in the queue.
22800 rules inserted. The rule base contains 5631 rules. 6379 rules in the queue.
23000 rules inserted. The rule base contains 5666 rules. 6339 rules in the queue.
23200 rules inserted. The rule base contains 5727 rules. 6179 rules in the queue.
23400 rules inserted. The rule base contains 5824 rules. 6102 rules in the queue.
23600 rules inserted. The rule base contains 5904 rules. 6052 rules in the queue.
23800 rules inserted. The rule base contains 5964 rules. 5880 rules in the queue.
24000 rules inserted. The rule base contains 6038 rules. 5816 rules in the queue.
24200 rules inserted. The rule base contains 6142 rules. 5765 rules in the queue.
24400 rules inserted. The rule base contains 6142 rules. 5626 rules in the queue.
24600 rules inserted. The rule base contains 6146 rules. 5622 rules in the queue.
24800 rules inserted. The rule base contains 6196 rules. 5554 rules in the queue.
25000 rules inserted. The rule base contains 6252 rules. 5498 rules in the queue.
25200 rules inserted. The rule base contains 6267 rules. 5459 rules in the queue.
25400 rules inserted. The rule base contains 6276 rules. 5422 rules in the queue.
25600 rules inserted. The rule base contains 6325 rules. 5355 rules in the queue.
25800 rules inserted. The rule base contains 6372 rules. 5308 rules in the queue.
26000 rules inserted. The rule base contains 6407 rules. 5260 rules in the queue.
26200 rules inserted. The rule base contains 6438 rules. 5207 rules in the queue.
26400 rules inserted. The rule base contains 6491 rules. 5146 rules in the queue.
26600 rules inserted. The rule base contains 6525 rules. 5099 rules in the queue.
26800 rules inserted. The rule base contains 6579 rules. 5029 rules in the queue.
27000 rules inserted. The rule base contains 6631 rules. 4977 rules in the queue.
27200 rules inserted. The rule base contains 6631 rules. 4947 rules in the queue.
27400 rules inserted. The rule base contains 6652 rules. 4904 rules in the queue.
27600 rules inserted. The rule base contains 6679 rules. 4861 rules in the queue.
27800 rules inserted. The rule base contains 6757 rules. 4781 rules in the queue.
28000 rules inserted. The rule base contains 6833 rules. 4703 rules in the queue.
28200 rules inserted. The rule base contains 6905 rules. 4625 rules in the queue.
28400 rules inserted. The rule base contains 6967 rules. 4558 rules in the queue.
28600 rules inserted. The rule base contains 7029 rules. 4491 rules in the queue.
28800 rules inserted. The rule base contains 7102 rules. 4413 rules in the queue.
29000 rules inserted. The rule base contains 7234 rules. 4272 rules in the queue.
29200 rules inserted. The rule base contains 7247 rules. 4242 rules in the queue.
29400 rules inserted. The rule base contains 7241 rules. 4231 rules in the queue.
29600 rules inserted. The rule base contains 7245 rules. 4210 rules in the queue.
29800 rules inserted. The rule base contains 7233 rules. 4206 rules in the queue.
30000 rules inserted. The rule base contains 7229 rules. 4178 rules in the queue.
30200 rules inserted. The rule base contains 7206 rules. 4159 rules in the queue.
30400 rules inserted. The rule base contains 7298 rules. 4056 rules in the queue.
30600 rules inserted. The rule base contains 7428 rules. 3918 rules in the queue.
30800 rules inserted. The rule base contains 7504 rules. 3840 rules in the queue.
31000 rules inserted. The rule base contains 7607 rules. 3733 rules in the queue.
31200 rules inserted. The rule base contains 7749 rules. 3579 rules in the queue.
31400 rules inserted. The rule base contains 7829 rules. 3496 rules in the queue.
31600 rules inserted. The rule base contains 7949 rules. 3371 rules in the queue.
31800 rules inserted. The rule base contains 8056 rules. 3256 rules in the queue.
32000 rules inserted. The rule base contains 8197 rules. 3107 rules in the queue.
32200 rules inserted. The rule base contains 8273 rules. 3029 rules in the queue.
32400 rules inserted. The rule base contains 8368 rules. 2929 rules in the queue.
32600 rules inserted. The rule base contains 8511 rules. 2775 rules in the queue.
32800 rules inserted. The rule base contains 8661 rules. 2618 rules in the queue.
33000 rules inserted. The rule base contains 8808 rules. 2462 rules in the queue.
33200 rules inserted. The rule base contains 8955 rules. 2305 rules in the queue.
33400 rules inserted. The rule base contains 9044 rules. 2207 rules in the queue.
33600 rules inserted. The rule base contains 9056 rules. 2170 rules in the queue.
33800 rules inserted. The rule base contains 9055 rules. 2142 rules in the queue.
34000 rules inserted. The rule base contains 9067 rules. 2105 rules in the queue.
34200 rules inserted. The rule base contains 9111 rules. 2053 rules in the queue.
34400 rules inserted. The rule base contains 9170 rules. 1994 rules in the queue.
34600 rules inserted. The rule base contains 9325 rules. 1829 rules in the queue.
34800 rules inserted. The rule base contains 9489 rules. 1654 rules in the queue.
35000 rules inserted. The rule base contains 9641 rules. 1489 rules in the queue.
35200 rules inserted. The rule base contains 9795 rules. 1323 rules in the queue.
35400 rules inserted. The rule base contains 9955 rules. 1149 rules in the queue.
35600 rules inserted. The rule base contains 10123 rules. 981 rules in the queue.
35800 rules inserted. The rule base contains 10201 rules. 903 rules in the queue.
36000 rules inserted. The rule base contains 10303 rules. 801 rules in the queue.
36200 rules inserted. The rule base contains 10389 rules. 715 rules in the queue.
36400 rules inserted. The rule base contains 10541 rules. 563 rules in the queue.
36600 rules inserted. The rule base contains 10715 rules. 371 rules in the queue.
36800 rules inserted. The rule base contains 10875 rules. 211 rules in the queue.
37000 rules inserted. The rule base contains 11051 rules. 35 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is true.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 110 rules. 645 rules in the queue.
400 rules inserted. The rule base contains 154 rules. 645 rules in the queue.
600 rules inserted. The rule base contains 324 rules. 642 rules in the queue.
800 rules inserted. The rule base contains 417 rules. 642 rules in the queue.
1000 rules inserted. The rule base contains 426 rules. 642 rules in the queue.
1200 rules inserted. The rule base contains 428 rules. 639 rules in the queue.
1400 rules inserted. The rule base contains 416 rules. 638 rules in the queue.
1600 rules inserted. The rule base contains 384 rules. 634 rules in the queue.
1800 rules inserted. The rule base contains 422 rules. 596 rules in the queue.
2000 rules inserted. The rule base contains 425 rules. 659 rules in the queue.
2200 rules inserted. The rule base contains 447 rules. 1164 rules in the queue.
2400 rules inserted. The rule base contains 602 rules. 1584 rules in the queue.
2600 rules inserted. The rule base contains 703 rules. 2031 rules in the queue.
2800 rules inserted. The rule base contains 770 rules. 3682 rules in the queue.
3000 rules inserted. The rule base contains 838 rules. 5333 rules in the queue.
3200 rules inserted. The rule base contains 897 rules. 5842 rules in the queue.
3400 rules inserted. The rule base contains 965 rules. 6987 rules in the queue.
3600 rules inserted. The rule base contains 1019 rules. 6984 rules in the queue.
3800 rules inserted. The rule base contains 1180 rules. 6833 rules in the queue.
4000 rules inserted. The rule base contains 1302 rules. 6711 rules in the queue.
4200 rules inserted. The rule base contains 1425 rules. 6588 rules in the queue.
4400 rules inserted. The rule base contains 1547 rules. 6466 rules in the queue.
4600 rules inserted. The rule base contains 1667 rules. 6476 rules in the queue.
4800 rules inserted. The rule base contains 1736 rules. 6419 rules in the queue.
5000 rules inserted. The rule base contains 1850 rules. 6328 rules in the queue.
5200 rules inserted. The rule base contains 1941 rules. 6268 rules in the queue.
5400 rules inserted. The rule base contains 2053 rules. 6437 rules in the queue.
5600 rules inserted. The rule base contains 2138 rules. 6641 rules in the queue.
5800 rules inserted. The rule base contains 2213 rules. 6583 rules in the queue.
6000 rules inserted. The rule base contains 2324 rules. 6494 rules in the queue.
6200 rules inserted. The rule base contains 2415 rules. 6434 rules in the queue.
6400 rules inserted. The rule base contains 2527 rules. 6603 rules in the queue.
6600 rules inserted. The rule base contains 2592 rules. 6548 rules in the queue.
6800 rules inserted. The rule base contains 2686 rules. 6617 rules in the queue.
7000 rules inserted. The rule base contains 2793 rules. 6532 rules in the queue.
7200 rules inserted. The rule base contains 2874 rules. 6609 rules in the queue.
7400 rules inserted. The rule base contains 2957 rules. 6543 rules in the queue.
7600 rules inserted. The rule base contains 3063 rules. 6462 rules in the queue.
7800 rules inserted. The rule base contains 3160 rules. 6783 rules in the queue.
8000 rules inserted. The rule base contains 3268 rules. 6700 rules in the queue.
8200 rules inserted. The rule base contains 3363 rules. 6763 rules in the queue.
8400 rules inserted. The rule base contains 3428 rules. 6706 rules in the queue.
8600 rules inserted. The rule base contains 3534 rules. 6627 rules in the queue.
8800 rules inserted. The rule base contains 3610 rules. 6577 rules in the queue.
9000 rules inserted. The rule base contains 3677 rules. 6527 rules in the queue.
9200 rules inserted. The rule base contains 3767 rules. 6447 rules in the queue.
9400 rules inserted. The rule base contains 3867 rules. 6375 rules in the queue.
9600 rules inserted. The rule base contains 3939 rules. 6325 rules in the queue.
9800 rules inserted. The rule base contains 4038 rules. 6235 rules in the queue.
10000 rules inserted. The rule base contains 4130 rules. 6173 rules in the queue.
10200 rules inserted. The rule base contains 4199 rules. 6123 rules in the queue.
10400 rules inserted. The rule base contains 4262 rules. 6068 rules in the queue.
10600 rules inserted. The rule base contains 4265 rules. 6065 rules in the queue.
10800 rules inserted. The rule base contains 4310 rules. 6531 rules in the queue.
11000 rules inserted. The rule base contains 4393 rules. 7106 rules in the queue.
11200 rules inserted. The rule base contains 4401 rules. 7100 rules in the queue.
11400 rules inserted. The rule base contains 4400 rules. 7088 rules in the queue.
11600 rules inserted. The rule base contains 4453 rules. 7038 rules in the queue.
11800 rules inserted. The rule base contains 4533 rules. 6988 rules in the queue.
12000 rules inserted. The rule base contains 4599 rules. 6938 rules in the queue.
12200 rules inserted. The rule base contains 4663 rules. 6889 rules in the queue.
12400 rules inserted. The rule base contains 4652 rules. 6887 rules in the queue.
12600 rules inserted. The rule base contains 4655 rules. 6879 rules in the queue.
12800 rules inserted. The rule base contains 4718 rules. 6830 rules in the queue.
13000 rules inserted. The rule base contains 4789 rules. 6780 rules in the queue.
13200 rules inserted. The rule base contains 4774 rules. 6772 rules in the queue.
13400 rules inserted. The rule base contains 4838 rules. 6717 rules in the queue.
13600 rules inserted. The rule base contains 4878 rules. 6677 rules in the queue.
13800 rules inserted. The rule base contains 4896 rules. 6665 rules in the queue.
14000 rules inserted. The rule base contains 4896 rules. 6663 rules in the queue.
14200 rules inserted. The rule base contains 4961 rules. 6608 rules in the queue.
14400 rules inserted. The rule base contains 5025 rules. 6559 rules in the queue.
14600 rules inserted. The rule base contains 5094 rules. 6509 rules in the queue.
14800 rules inserted. The rule base contains 5150 rules. 6454 rules in the queue.
15000 rules inserted. The rule base contains 5162 rules. 6451 rules in the queue.
15200 rules inserted. The rule base contains 5147 rules. 6444 rules in the queue.
15400 rules inserted. The rule base contains 5135 rules. 6442 rules in the queue.
15600 rules inserted. The rule base contains 5124 rules. 6439 rules in the queue.
15800 rules inserted. The rule base contains 5128 rules. 6437 rules in the queue.
16000 rules inserted. The rule base contains 5116 rules. 6434 rules in the queue.
16200 rules inserted. The rule base contains 5119 rules. 6432 rules in the queue.
16400 rules inserted. The rule base contains 5099 rules. 6429 rules in the queue.
16600 rules inserted. The rule base contains 5049 rules. 6429 rules in the queue.
16800 rules inserted. The rule base contains 5128 rules. 6635 rules in the queue.
17000 rules inserted. The rule base contains 5231 rules. 6692 rules in the queue.
17200 rules inserted. The rule base contains 5341 rules. 6745 rules in the queue.
17400 rules inserted. The rule base contains 5432 rules. 6950 rules in the queue.
17600 rules inserted. The rule base contains 5535 rules. 6902 rules in the queue.
17800 rules inserted. The rule base contains 5656 rules. 6811 rules in the queue.
18000 rules inserted. The rule base contains 5754 rules. 6756 rules in the queue.
18200 rules inserted. The rule base contains 5788 rules. 6641 rules in the queue.
18400 rules inserted. The rule base contains 5766 rules. 6633 rules in the queue.
18600 rules inserted. The rule base contains 5750 rules. 6625 rules in the queue.
18800 rules inserted. The rule base contains 5748 rules. 6619 rules in the queue.
19000 rules inserted. The rule base contains 5739 rules. 6613 rules in the queue.
19200 rules inserted. The rule base contains 5743 rules. 6596 rules in the queue.
19400 rules inserted. The rule base contains 5731 rules. 6587 rules in the queue.
19600 rules inserted. The rule base contains 5719 rules. 6580 rules in the queue.
19800 rules inserted. The rule base contains 5722 rules. 6566 rules in the queue.
20000 rules inserted. The rule base contains 5713 rules. 6554 rules in the queue.
20200 rules inserted. The rule base contains 5704 rules. 6547 rules in the queue.
20400 rules inserted. The rule base contains 5701 rules. 6534 rules in the queue.
20600 rules inserted. The rule base contains 5690 rules. 6523 rules in the queue.
20800 rules inserted. The rule base contains 5689 rules. 6514 rules in the queue.
21000 rules inserted. The rule base contains 5682 rules. 6511 rules in the queue.
21200 rules inserted. The rule base contains 5670 rules. 6502 rules in the queue.
21400 rules inserted. The rule base contains 5657 rules. 6495 rules in the queue.
21600 rules inserted. The rule base contains 5661 rules. 6475 rules in the queue.
21800 rules inserted. The rule base contains 5664 rules. 6456 rules in the queue.
22000 rules inserted. The rule base contains 5662 rules. 6437 rules in the queue.
22200 rules inserted. The rule base contains 5642 rules. 6431 rules in the queue.
22400 rules inserted. The rule base contains 5644 rules. 6412 rules in the queue.
22600 rules inserted. The rule base contains 5620 rules. 6406 rules in the queue.
22800 rules inserted. The rule base contains 5631 rules. 6379 rules in the queue.
23000 rules inserted. The rule base contains 5666 rules. 6339 rules in the queue.
23200 rules inserted. The rule base contains 5727 rules. 6179 rules in the queue.
23400 rules inserted. The rule base contains 5824 rules. 6102 rules in the queue.
23600 rules inserted. The rule base contains 5904 rules. 6052 rules in the queue.
23800 rules inserted. The rule base contains 5964 rules. 5880 rules in the queue.
24000 rules inserted. The rule base contains 6038 rules. 5816 rules in the queue.
24200 rules inserted. The rule base contains 6142 rules. 5765 rules in the queue.
24400 rules inserted. The rule base contains 6142 rules. 5626 rules in the queue.
24600 rules inserted. The rule base contains 6146 rules. 5622 rules in the queue.
24800 rules inserted. The rule base contains 6196 rules. 5554 rules in the queue.
25000 rules inserted. The rule base contains 6252 rules. 5498 rules in the queue.
25200 rules inserted. The rule base contains 6267 rules. 5459 rules in the queue.
25400 rules inserted. The rule base contains 6276 rules. 5422 rules in the queue.
25600 rules inserted. The rule base contains 6325 rules. 5355 rules in the queue.
25800 rules inserted. The rule base contains 6372 rules. 5308 rules in the queue.
26000 rules inserted. The rule base contains 6407 rules. 5260 rules in the queue.
26200 rules inserted. The rule base contains 6438 rules. 5207 rules in the queue.
26400 rules inserted. The rule base contains 6491 rules. 5146 rules in the queue.
26600 rules inserted. The rule base contains 6525 rules. 5099 rules in the queue.
26800 rules inserted. The rule base contains 6579 rules. 5029 rules in the queue.
27000 rules inserted. The rule base contains 6631 rules. 4977 rules in the queue.
27200 rules inserted. The rule base contains 6631 rules. 4947 rules in the queue.
27400 rules inserted. The rule base contains 6652 rules. 4904 rules in the queue.
27600 rules inserted. The rule base contains 6679 rules. 4861 rules in the queue.
27800 rules inserted. The rule base contains 6757 rules. 4781 rules in the queue.
28000 rules inserted. The rule base contains 6833 rules. 4703 rules in the queue.
28200 rules inserted. The rule base contains 6905 rules. 4625 rules in the queue.
28400 rules inserted. The rule base contains 6967 rules. 4558 rules in the queue.
28600 rules inserted. The rule base contains 7029 rules. 4491 rules in the queue.
28800 rules inserted. The rule base contains 7102 rules. 4413 rules in the queue.
29000 rules inserted. The rule base contains 7234 rules. 4272 rules in the queue.
29200 rules inserted. The rule base contains 7247 rules. 4242 rules in the queue.
29400 rules inserted. The rule base contains 7241 rules. 4231 rules in the queue.
29600 rules inserted. The rule base contains 7245 rules. 4210 rules in the queue.
29800 rules inserted. The rule base contains 7233 rules. 4206 rules in the queue.
30000 rules inserted. The rule base contains 7229 rules. 4178 rules in the queue.
30200 rules inserted. The rule base contains 7206 rules. 4159 rules in the queue.
30400 rules inserted. The rule base contains 7298 rules. 4056 rules in the queue.
30600 rules inserted. The rule base contains 7428 rules. 3918 rules in the queue.
30800 rules inserted. The rule base contains 7504 rules. 3840 rules in the queue.
31000 rules inserted. The rule base contains 7607 rules. 3733 rules in the queue.
31200 rules inserted. The rule base contains 7749 rules. 3579 rules in the queue.
31400 rules inserted. The rule base contains 7829 rules. 3496 rules in the queue.
31600 rules inserted. The rule base contains 7949 rules. 3371 rules in the queue.
31800 rules inserted. The rule base contains 8056 rules. 3256 rules in the queue.
32000 rules inserted. The rule base contains 8197 rules. 3107 rules in the queue.
32200 rules inserted. The rule base contains 8273 rules. 3029 rules in the queue.
32400 rules inserted. The rule base contains 8368 rules. 2929 rules in the queue.
32600 rules inserted. The rule base contains 8511 rules. 2775 rules in the queue.
32800 rules inserted. The rule base contains 8661 rules. 2618 rules in the queue.
33000 rules inserted. The rule base contains 8808 rules. 2462 rules in the queue.
33200 rules inserted. The rule base contains 8955 rules. 2305 rules in the queue.
33400 rules inserted. The rule base contains 9044 rules. 2207 rules in the queue.
33600 rules inserted. The rule base contains 9056 rules. 2170 rules in the queue.
33800 rules inserted. The rule base contains 9055 rules. 2142 rules in the queue.
34000 rules inserted. The rule base contains 9067 rules. 2105 rules in the queue.
34200 rules inserted. The rule base contains 9111 rules. 2053 rules in the queue.
34400 rules inserted. The rule base contains 9170 rules. 1994 rules in the queue.
34600 rules inserted. The rule base contains 9325 rules. 1829 rules in the queue.
34800 rules inserted. The rule base contains 9489 rules. 1654 rules in the queue.
35000 rules inserted. The rule base contains 9641 rules. 1489 rules in the queue.
35200 rules inserted. The rule base contains 9795 rules. 1323 rules in the queue.
35400 rules inserted. The rule base contains 9955 rules. 1149 rules in the queue.
35600 rules inserted. The rule base contains 10123 rules. 981 rules in the queue.
35800 rules inserted. The rule base contains 10201 rules. 903 rules in the queue.
36000 rules inserted. The rule base contains 10303 rules. 801 rules in the queue.
36200 rules inserted. The rule base contains 10389 rules. 715 rules in the queue.
36400 rules inserted. The rule base contains 10541 rules. 563 rules in the queue.
36600 rules inserted. The rule base contains 10715 rules. 371 rules in the queue.
36800 rules inserted. The rule base contains 10875 rules. 211 rules in the queue.
37000 rules inserted. The rule base contains 11051 rules. 35 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
goal reachable: attacker(mCli(pub(skA[]),pub(skC[])))
Abbreviations:
Nc_1545772 = Nc_611[UP_609 = UP_1545768,SPs_608 = SPs_1545767,Sess = C[],Disco = A[],Cli = A[],!1 = @sid_1545769]
SPc_1545773 = SPc_610[UP_609 = UP_1545768,SPs_608 = SPs_1545767,Sess = C[],Disco = A[],Cli = A[],!1 = @sid_1545769]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

5. The attacker has some term UP_1545768.
attacker(UP_1545768).

6. Using the function None the attacker may obtain None.
attacker(None).

7. The attacker has some term SPs_1545767.
attacker(SPs_1545767).

8. By 7, the attacker may know SPs_1545767.
By 6, the attacker may know None.
By 5, the attacker may know UP_1545768.
By 4, the attacker may know pub(skC[]).
Using the function 4-tuple the attacker may obtain (SPs_1545767,None,UP_1545768,pub(skC[])).
attacker((SPs_1545767,None,UP_1545768,pub(skC[]))).

9. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {10}.
The message (SPs_1545767,None,UP_1545768,pub(skC[])) that the attacker may have by 8 may be received at input {46}.
So the message (pub(skA[]),(SPc_1545773,exp(g,Nc_1545772))) may be sent to the attacker at output {50}.
attacker((pub(skA[]),(SPc_1545773,exp(g,Nc_1545772)))).

10. By 9, the attacker may know (pub(skA[]),(SPc_1545773,exp(g,Nc_1545772))).
Using the function 2-proj-2-tuple the attacker may obtain (SPc_1545773,exp(g,Nc_1545772)).
attacker((SPc_1545773,exp(g,Nc_1545772))).

11. By 10, the attacker may know (SPc_1545773,exp(g,Nc_1545772)).
Using the function 2-proj-2-tuple the attacker may obtain exp(g,Nc_1545772).
attacker(exp(g,Nc_1545772)).

12. Using the function g the attacker may obtain g.
attacker(g).

13. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {10}.
The message (SPs_1545767,None,UP_1545768,pub(skC[])) that the attacker may have by 8 may be received at input {46}.
The message g that the attacker may have by 12 may be received at input {51}.
So the message senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_1545772)) may be sent to the attacker at output {53}.
attacker(senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_1545772))).

14. By 13, the attacker may know senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_1545772)).
By 11, the attacker may know exp(g,Nc_1545772).
Using the function sdec the attacker may obtain mCli(pub(skA[]),pub(skC[])).
attacker(mCli(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

new skI creating skI_1562320 at {7}

out(c, skI_1562320) at {8}

in(c, (A,A,C)) at {10} in copy a_1545775

out(c, GetEndpointRequest) at {45} in copy a_1545775

in(c, (a_1545774,None,a,pub(skC))) at {46} in copy a_1545775

new SPc_610 creating SPc_1545777 at {47} in copy a_1545775

new Nc_611 creating Nc_1545776 at {48} in copy a_1545775

out(c, (pub(skA),(SPc_1545777,exp(g,Nc_1545776)))) at {50} in copy a_1545775

in(c, g) at {51} in copy a_1545775

out(c, senc(mCli(pub(skA),pub(skC)),exp(g,Nc_1545776))) at {53} in copy a_1545775

The attacker has the message mCli(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is false.
