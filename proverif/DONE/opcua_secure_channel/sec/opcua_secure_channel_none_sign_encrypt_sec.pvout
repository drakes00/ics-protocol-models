Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_519: bool = (Cli = A) in
    (
        {10}if v_519 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_520: bool = (Disco = A) in
            (
                {14}if v_520 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_521: bool = (Sess = A) in
                    (
                        {17}if v_521 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let gNc: bitstring = exp(g,Nc) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,pkCli,gNc) in
                            {24}out(c, (pkCli,m1));
                            {25}in(c, em2: bitstring);
                            {26}let m2: bitstring = em2 in
                            {27}let (=OpenSecureChannelResponse,PartS: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {28}let Kcli: bitstring = exp(PartS,Nc) in
                            {29}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {30}let v_522: bool = (Sess = B) in
                            (
                                {31}if v_522 then
                                (
                                    {32}let pkSess_523: bitstring = pub(skB) in
                                    {33}out(c, GetEndpointRequest);
                                    {34}in(c, (=GetEndpointResponse,=pkSess_523,=None,SP_524: bitstring,UP_525: bitstring));
                                    {35}new Nc_526: bitstring;
                                    {36}let gNc_527: bitstring = exp(g,Nc_526) in
                                    {37}let m1_528: bitstring = (OpenSecureChannelRequest,pkCli,gNc_527) in
                                    {38}out(c, (pkCli,m1_528));
                                    {39}in(c, em2_529: bitstring);
                                    {40}let m2_530: bitstring = em2_529 in
                                    {41}let (=OpenSecureChannelResponse,PartS_531: bitstring,ST_532: bitstring,TTL_533: bitstring) = m2_530 in
                                    {42}let Kcli_534: bitstring = exp(PartS_531,Nc_526) in
                                    {43}out(c, senc(mCli(pkCli,pkSess_523),Kcli_534))
                                )
                                else
                                    {44}let v_535: bool = (Sess = C) in
                                    (
                                        {45}if v_535 then
                                        (
                                            {46}let pkSess_536: bitstring = pub(skC) in
                                            {47}out(c, GetEndpointRequest);
                                            {48}in(c, (=GetEndpointResponse,=pkSess_536,=None,SP_537: bitstring,UP_538: bitstring));
                                            {49}new Nc_539: bitstring;
                                            {50}let gNc_540: bitstring = exp(g,Nc_539) in
                                            {51}let m1_541: bitstring = (OpenSecureChannelRequest,pkCli,gNc_540) in
                                            {52}out(c, (pkCli,m1_541));
                                            {53}in(c, em2_542: bitstring);
                                            {54}let m2_543: bitstring = em2_542 in
                                            {55}let (=OpenSecureChannelResponse,PartS_544: bitstring,ST_545: bitstring,TTL_546: bitstring) = m2_543 in
                                            {56}let Kcli_547: bitstring = exp(PartS_544,Nc_539) in
                                            {57}out(c, senc(mCli(pkCli,pkSess_536),Kcli_547))
                                        )
                                        else
                                            {58}let pkSess_548: bitstring = pub(sk(Sess)) in
                                            {59}out(c, GetEndpointRequest);
                                            {60}in(c, (=GetEndpointResponse,=pkSess_548,=None,SP_549: bitstring,UP_550: bitstring));
                                            {61}new Nc_551: bitstring;
                                            {62}let gNc_552: bitstring = exp(g,Nc_551) in
                                            {63}let m1_553: bitstring = (OpenSecureChannelRequest,pkCli,gNc_552) in
                                            {64}out(c, (pkCli,m1_553));
                                            {65}in(c, em2_554: bitstring);
                                            {66}let m2_555: bitstring = em2_554 in
                                            {67}let (=OpenSecureChannelResponse,PartS_556: bitstring,ST_557: bitstring,TTL_558: bitstring) = m2_555 in
                                            {68}let Kcli_559: bitstring = exp(PartS_556,Nc_551) in
                                            {69}out(c, senc(mCli(pkCli,pkSess_548),Kcli_559))
                                    )
                                    else
                                        {70}let pkSess_560: bitstring = fail-any in
                                        {71}out(c, GetEndpointRequest);
                                        {72}in(c, (=GetEndpointResponse,=pkSess_560,=None,SP_561: bitstring,UP_562: bitstring));
                                        {73}new Nc_563: bitstring;
                                        {74}let gNc_564: bitstring = exp(g,Nc_563) in
                                        {75}let m1_565: bitstring = (OpenSecureChannelRequest,pkCli,gNc_564) in
                                        {76}out(c, (pkCli,m1_565));
                                        {77}in(c, em2_566: bitstring);
                                        {78}let m2_567: bitstring = em2_566 in
                                        {79}let (=OpenSecureChannelResponse,PartS_568: bitstring,ST_569: bitstring,TTL_570: bitstring) = m2_567 in
                                        {80}let Kcli_571: bitstring = exp(PartS_568,Nc_563) in
                                        {81}out(c, senc(mCli(pkCli,pkSess_560),Kcli_571))
                            )
                            else
                                {82}let pkSess_572: bitstring = fail-any in
                                {83}out(c, GetEndpointRequest);
                                {84}in(c, (=GetEndpointResponse,=pkSess_572,=None,SP_573: bitstring,UP_574: bitstring));
                                {85}new Nc_575: bitstring;
                                {86}let gNc_576: bitstring = exp(g,Nc_575) in
                                {87}let m1_577: bitstring = (OpenSecureChannelRequest,pkCli,gNc_576) in
                                {88}out(c, (pkCli,m1_577));
                                {89}in(c, em2_578: bitstring);
                                {90}let m2_579: bitstring = em2_578 in
                                {91}let (=OpenSecureChannelResponse,PartS_580: bitstring,ST_581: bitstring,TTL_582: bitstring) = m2_579 in
                                {92}let Kcli_583: bitstring = exp(PartS_580,Nc_575) in
                                {93}out(c, senc(mCli(pkCli,pkSess_572),Kcli_583))
                    )
                    else
                        {94}let pkSess_584: bitstring = fail-any in
                        {95}out(c, GetEndpointRequest);
                        {96}in(c, (=GetEndpointResponse,=pkSess_584,=None,SP_585: bitstring,UP_586: bitstring));
                        {97}new Nc_587: bitstring;
                        {98}let gNc_588: bitstring = exp(g,Nc_587) in
                        {99}let m1_589: bitstring = (OpenSecureChannelRequest,pkCli,gNc_588) in
                        {100}out(c, (pkCli,m1_589));
                        {101}in(c, em2_590: bitstring);
                        {102}let m2_591: bitstring = em2_590 in
                        {103}let (=OpenSecureChannelResponse,PartS_592: bitstring,ST_593: bitstring,TTL_594: bitstring) = m2_591 in
                        {104}let Kcli_595: bitstring = exp(PartS_592,Nc_587) in
                        {105}out(c, senc(mCli(pkCli,pkSess_584),Kcli_595))
                )
                else
                    {106}let v_596: bool = (Disco = B) in
                    (
                        {107}if v_596 then
                        (
                            {108}let pkDisco_597: bitstring = pub(skB) in
                            {109}let v_598: bool = (Sess = A) in
                            (
                                {110}if v_598 then
                                (
                                    {111}let pkSess_599: bitstring = pub(skA) in
                                    {112}out(c, GetEndpointRequest);
                                    {113}in(c, (=GetEndpointResponse,=pkSess_599,=None,SP_600: bitstring,UP_601: bitstring));
                                    {114}new Nc_602: bitstring;
                                    {115}let gNc_603: bitstring = exp(g,Nc_602) in
                                    {116}let m1_604: bitstring = (OpenSecureChannelRequest,pkCli,gNc_603) in
                                    {117}out(c, (pkCli,m1_604));
                                    {118}in(c, em2_605: bitstring);
                                    {119}let m2_606: bitstring = em2_605 in
                                    {120}let (=OpenSecureChannelResponse,PartS_607: bitstring,ST_608: bitstring,TTL_609: bitstring) = m2_606 in
                                    {121}let Kcli_610: bitstring = exp(PartS_607,Nc_602) in
                                    {122}out(c, senc(mCli(pkCli,pkSess_599),Kcli_610))
                                )
                                else
                                    {123}let v_611: bool = (Sess = B) in
                                    (
                                        {124}if v_611 then
                                        (
                                            {125}let pkSess_612: bitstring = pub(skB) in
                                            {126}out(c, GetEndpointRequest);
                                            {127}in(c, (=GetEndpointResponse,=pkSess_612,=None,SP_613: bitstring,UP_614: bitstring));
                                            {128}new Nc_615: bitstring;
                                            {129}let gNc_616: bitstring = exp(g,Nc_615) in
                                            {130}let m1_617: bitstring = (OpenSecureChannelRequest,pkCli,gNc_616) in
                                            {131}out(c, (pkCli,m1_617));
                                            {132}in(c, em2_618: bitstring);
                                            {133}let m2_619: bitstring = em2_618 in
                                            {134}let (=OpenSecureChannelResponse,PartS_620: bitstring,ST_621: bitstring,TTL_622: bitstring) = m2_619 in
                                            {135}let Kcli_623: bitstring = exp(PartS_620,Nc_615) in
                                            {136}out(c, senc(mCli(pkCli,pkSess_612),Kcli_623))
                                        )
                                        else
                                            {137}let v_624: bool = (Sess = C) in
                                            (
                                                {138}if v_624 then
                                                (
                                                    {139}let pkSess_625: bitstring = pub(skC) in
                                                    {140}out(c, GetEndpointRequest);
                                                    {141}in(c, (=GetEndpointResponse,=pkSess_625,=None,SP_626: bitstring,UP_627: bitstring));
                                                    {142}new Nc_628: bitstring;
                                                    {143}let gNc_629: bitstring = exp(g,Nc_628) in
                                                    {144}let m1_630: bitstring = (OpenSecureChannelRequest,pkCli,gNc_629) in
                                                    {145}out(c, (pkCli,m1_630));
                                                    {146}in(c, em2_631: bitstring);
                                                    {147}let m2_632: bitstring = em2_631 in
                                                    {148}let (=OpenSecureChannelResponse,PartS_633: bitstring,ST_634: bitstring,TTL_635: bitstring) = m2_632 in
                                                    {149}let Kcli_636: bitstring = exp(PartS_633,Nc_628) in
                                                    {150}out(c, senc(mCli(pkCli,pkSess_625),Kcli_636))
                                                )
                                                else
                                                    {151}let pkSess_637: bitstring = pub(sk(Sess)) in
                                                    {152}out(c, GetEndpointRequest);
                                                    {153}in(c, (=GetEndpointResponse,=pkSess_637,=None,SP_638: bitstring,UP_639: bitstring));
                                                    {154}new Nc_640: bitstring;
                                                    {155}let gNc_641: bitstring = exp(g,Nc_640) in
                                                    {156}let m1_642: bitstring = (OpenSecureChannelRequest,pkCli,gNc_641) in
                                                    {157}out(c, (pkCli,m1_642));
                                                    {158}in(c, em2_643: bitstring);
                                                    {159}let m2_644: bitstring = em2_643 in
                                                    {160}let (=OpenSecureChannelResponse,PartS_645: bitstring,ST_646: bitstring,TTL_647: bitstring) = m2_644 in
                                                    {161}let Kcli_648: bitstring = exp(PartS_645,Nc_640) in
                                                    {162}out(c, senc(mCli(pkCli,pkSess_637),Kcli_648))
                                            )
                                            else
                                                {163}let pkSess_649: bitstring = fail-any in
                                                {164}out(c, GetEndpointRequest);
                                                {165}in(c, (=GetEndpointResponse,=pkSess_649,=None,SP_650: bitstring,UP_651: bitstring));
                                                {166}new Nc_652: bitstring;
                                                {167}let gNc_653: bitstring = exp(g,Nc_652) in
                                                {168}let m1_654: bitstring = (OpenSecureChannelRequest,pkCli,gNc_653) in
                                                {169}out(c, (pkCli,m1_654));
                                                {170}in(c, em2_655: bitstring);
                                                {171}let m2_656: bitstring = em2_655 in
                                                {172}let (=OpenSecureChannelResponse,PartS_657: bitstring,ST_658: bitstring,TTL_659: bitstring) = m2_656 in
                                                {173}let Kcli_660: bitstring = exp(PartS_657,Nc_652) in
                                                {174}out(c, senc(mCli(pkCli,pkSess_649),Kcli_660))
                                    )
                                    else
                                        {175}let pkSess_661: bitstring = fail-any in
                                        {176}out(c, GetEndpointRequest);
                                        {177}in(c, (=GetEndpointResponse,=pkSess_661,=None,SP_662: bitstring,UP_663: bitstring));
                                        {178}new Nc_664: bitstring;
                                        {179}let gNc_665: bitstring = exp(g,Nc_664) in
                                        {180}let m1_666: bitstring = (OpenSecureChannelRequest,pkCli,gNc_665) in
                                        {181}out(c, (pkCli,m1_666));
                                        {182}in(c, em2_667: bitstring);
                                        {183}let m2_668: bitstring = em2_667 in
                                        {184}let (=OpenSecureChannelResponse,PartS_669: bitstring,ST_670: bitstring,TTL_671: bitstring) = m2_668 in
                                        {185}let Kcli_672: bitstring = exp(PartS_669,Nc_664) in
                                        {186}out(c, senc(mCli(pkCli,pkSess_661),Kcli_672))
                            )
                            else
                                {187}let pkSess_673: bitstring = fail-any in
                                {188}out(c, GetEndpointRequest);
                                {189}in(c, (=GetEndpointResponse,=pkSess_673,=None,SP_674: bitstring,UP_675: bitstring));
                                {190}new Nc_676: bitstring;
                                {191}let gNc_677: bitstring = exp(g,Nc_676) in
                                {192}let m1_678: bitstring = (OpenSecureChannelRequest,pkCli,gNc_677) in
                                {193}out(c, (pkCli,m1_678));
                                {194}in(c, em2_679: bitstring);
                                {195}let m2_680: bitstring = em2_679 in
                                {196}let (=OpenSecureChannelResponse,PartS_681: bitstring,ST_682: bitstring,TTL_683: bitstring) = m2_680 in
                                {197}let Kcli_684: bitstring = exp(PartS_681,Nc_676) in
                                {198}out(c, senc(mCli(pkCli,pkSess_673),Kcli_684))
                        )
                        else
                            {199}let v_685: bool = (Disco = C) in
                            (
                                {200}if v_685 then
                                (
                                    {201}let pkDisco_686: bitstring = pub(skC) in
                                    {202}let v_687: bool = (Sess = A) in
                                    (
                                        {203}if v_687 then
                                        (
                                            {204}let pkSess_688: bitstring = pub(skA) in
                                            {205}out(c, GetEndpointRequest);
                                            {206}in(c, (=GetEndpointResponse,=pkSess_688,=None,SP_689: bitstring,UP_690: bitstring));
                                            {207}new Nc_691: bitstring;
                                            {208}let gNc_692: bitstring = exp(g,Nc_691) in
                                            {209}let m1_693: bitstring = (OpenSecureChannelRequest,pkCli,gNc_692) in
                                            {210}out(c, (pkCli,m1_693));
                                            {211}in(c, em2_694: bitstring);
                                            {212}let m2_695: bitstring = em2_694 in
                                            {213}let (=OpenSecureChannelResponse,PartS_696: bitstring,ST_697: bitstring,TTL_698: bitstring) = m2_695 in
                                            {214}let Kcli_699: bitstring = exp(PartS_696,Nc_691) in
                                            {215}out(c, senc(mCli(pkCli,pkSess_688),Kcli_699))
                                        )
                                        else
                                            {216}let v_700: bool = (Sess = B) in
                                            (
                                                {217}if v_700 then
                                                (
                                                    {218}let pkSess_701: bitstring = pub(skB) in
                                                    {219}out(c, GetEndpointRequest);
                                                    {220}in(c, (=GetEndpointResponse,=pkSess_701,=None,SP_702: bitstring,UP_703: bitstring));
                                                    {221}new Nc_704: bitstring;
                                                    {222}let gNc_705: bitstring = exp(g,Nc_704) in
                                                    {223}let m1_706: bitstring = (OpenSecureChannelRequest,pkCli,gNc_705) in
                                                    {224}out(c, (pkCli,m1_706));
                                                    {225}in(c, em2_707: bitstring);
                                                    {226}let m2_708: bitstring = em2_707 in
                                                    {227}let (=OpenSecureChannelResponse,PartS_709: bitstring,ST_710: bitstring,TTL_711: bitstring) = m2_708 in
                                                    {228}let Kcli_712: bitstring = exp(PartS_709,Nc_704) in
                                                    {229}out(c, senc(mCli(pkCli,pkSess_701),Kcli_712))
                                                )
                                                else
                                                    {230}let v_713: bool = (Sess = C) in
                                                    (
                                                        {231}if v_713 then
                                                        (
                                                            {232}let pkSess_714: bitstring = pub(skC) in
                                                            {233}out(c, GetEndpointRequest);
                                                            {234}in(c, (=GetEndpointResponse,=pkSess_714,=None,SP_715: bitstring,UP_716: bitstring));
                                                            {235}new Nc_717: bitstring;
                                                            {236}let gNc_718: bitstring = exp(g,Nc_717) in
                                                            {237}let m1_719: bitstring = (OpenSecureChannelRequest,pkCli,gNc_718) in
                                                            {238}out(c, (pkCli,m1_719));
                                                            {239}in(c, em2_720: bitstring);
                                                            {240}let m2_721: bitstring = em2_720 in
                                                            {241}let (=OpenSecureChannelResponse,PartS_722: bitstring,ST_723: bitstring,TTL_724: bitstring) = m2_721 in
                                                            {242}let Kcli_725: bitstring = exp(PartS_722,Nc_717) in
                                                            {243}out(c, senc(mCli(pkCli,pkSess_714),Kcli_725))
                                                        )
                                                        else
                                                            {244}let pkSess_726: bitstring = pub(sk(Sess)) in
                                                            {245}out(c, GetEndpointRequest);
                                                            {246}in(c, (=GetEndpointResponse,=pkSess_726,=None,SP_727: bitstring,UP_728: bitstring));
                                                            {247}new Nc_729: bitstring;
                                                            {248}let gNc_730: bitstring = exp(g,Nc_729) in
                                                            {249}let m1_731: bitstring = (OpenSecureChannelRequest,pkCli,gNc_730) in
                                                            {250}out(c, (pkCli,m1_731));
                                                            {251}in(c, em2_732: bitstring);
                                                            {252}let m2_733: bitstring = em2_732 in
                                                            {253}let (=OpenSecureChannelResponse,PartS_734: bitstring,ST_735: bitstring,TTL_736: bitstring) = m2_733 in
                                                            {254}let Kcli_737: bitstring = exp(PartS_734,Nc_729) in
                                                            {255}out(c, senc(mCli(pkCli,pkSess_726),Kcli_737))
                                                    )
                                                    else
                                                        {256}let pkSess_738: bitstring = fail-any in
                                                        {257}out(c, GetEndpointRequest);
                                                        {258}in(c, (=GetEndpointResponse,=pkSess_738,=None,SP_739: bitstring,UP_740: bitstring));
                                                        {259}new Nc_741: bitstring;
                                                        {260}let gNc_742: bitstring = exp(g,Nc_741) in
                                                        {261}let m1_743: bitstring = (OpenSecureChannelRequest,pkCli,gNc_742) in
                                                        {262}out(c, (pkCli,m1_743));
                                                        {263}in(c, em2_744: bitstring);
                                                        {264}let m2_745: bitstring = em2_744 in
                                                        {265}let (=OpenSecureChannelResponse,PartS_746: bitstring,ST_747: bitstring,TTL_748: bitstring) = m2_745 in
                                                        {266}let Kcli_749: bitstring = exp(PartS_746,Nc_741) in
                                                        {267}out(c, senc(mCli(pkCli,pkSess_738),Kcli_749))
                                            )
                                            else
                                                {268}let pkSess_750: bitstring = fail-any in
                                                {269}out(c, GetEndpointRequest);
                                                {270}in(c, (=GetEndpointResponse,=pkSess_750,=None,SP_751: bitstring,UP_752: bitstring));
                                                {271}new Nc_753: bitstring;
                                                {272}let gNc_754: bitstring = exp(g,Nc_753) in
                                                {273}let m1_755: bitstring = (OpenSecureChannelRequest,pkCli,gNc_754) in
                                                {274}out(c, (pkCli,m1_755));
                                                {275}in(c, em2_756: bitstring);
                                                {276}let m2_757: bitstring = em2_756 in
                                                {277}let (=OpenSecureChannelResponse,PartS_758: bitstring,ST_759: bitstring,TTL_760: bitstring) = m2_757 in
                                                {278}let Kcli_761: bitstring = exp(PartS_758,Nc_753) in
                                                {279}out(c, senc(mCli(pkCli,pkSess_750),Kcli_761))
                                    )
                                    else
                                        {280}let pkSess_762: bitstring = fail-any in
                                        {281}out(c, GetEndpointRequest);
                                        {282}in(c, (=GetEndpointResponse,=pkSess_762,=None,SP_763: bitstring,UP_764: bitstring));
                                        {283}new Nc_765: bitstring;
                                        {284}let gNc_766: bitstring = exp(g,Nc_765) in
                                        {285}let m1_767: bitstring = (OpenSecureChannelRequest,pkCli,gNc_766) in
                                        {286}out(c, (pkCli,m1_767));
                                        {287}in(c, em2_768: bitstring);
                                        {288}let m2_769: bitstring = em2_768 in
                                        {289}let (=OpenSecureChannelResponse,PartS_770: bitstring,ST_771: bitstring,TTL_772: bitstring) = m2_769 in
                                        {290}let Kcli_773: bitstring = exp(PartS_770,Nc_765) in
                                        {291}out(c, senc(mCli(pkCli,pkSess_762),Kcli_773))
                                )
                                else
                                    {292}let pkDisco_774: bitstring = pub(sk(Disco)) in
                                    {293}let v_775: bool = (Sess = A) in
                                    (
                                        {294}if v_775 then
                                        (
                                            {295}let pkSess_776: bitstring = pub(skA) in
                                            {296}out(c, GetEndpointRequest);
                                            {297}in(c, (=GetEndpointResponse,=pkSess_776,=None,SP_777: bitstring,UP_778: bitstring));
                                            {298}new Nc_779: bitstring;
                                            {299}let gNc_780: bitstring = exp(g,Nc_779) in
                                            {300}let m1_781: bitstring = (OpenSecureChannelRequest,pkCli,gNc_780) in
                                            {301}out(c, (pkCli,m1_781));
                                            {302}in(c, em2_782: bitstring);
                                            {303}let m2_783: bitstring = em2_782 in
                                            {304}let (=OpenSecureChannelResponse,PartS_784: bitstring,ST_785: bitstring,TTL_786: bitstring) = m2_783 in
                                            {305}let Kcli_787: bitstring = exp(PartS_784,Nc_779) in
                                            {306}out(c, senc(mCli(pkCli,pkSess_776),Kcli_787))
                                        )
                                        else
                                            {307}let v_788: bool = (Sess = B) in
                                            (
                                                {308}if v_788 then
                                                (
                                                    {309}let pkSess_789: bitstring = pub(skB) in
                                                    {310}out(c, GetEndpointRequest);
                                                    {311}in(c, (=GetEndpointResponse,=pkSess_789,=None,SP_790: bitstring,UP_791: bitstring));
                                                    {312}new Nc_792: bitstring;
                                                    {313}let gNc_793: bitstring = exp(g,Nc_792) in
                                                    {314}let m1_794: bitstring = (OpenSecureChannelRequest,pkCli,gNc_793) in
                                                    {315}out(c, (pkCli,m1_794));
                                                    {316}in(c, em2_795: bitstring);
                                                    {317}let m2_796: bitstring = em2_795 in
                                                    {318}let (=OpenSecureChannelResponse,PartS_797: bitstring,ST_798: bitstring,TTL_799: bitstring) = m2_796 in
                                                    {319}let Kcli_800: bitstring = exp(PartS_797,Nc_792) in
                                                    {320}out(c, senc(mCli(pkCli,pkSess_789),Kcli_800))
                                                )
                                                else
                                                    {321}let v_801: bool = (Sess = C) in
                                                    (
                                                        {322}if v_801 then
                                                        (
                                                            {323}let pkSess_802: bitstring = pub(skC) in
                                                            {324}out(c, GetEndpointRequest);
                                                            {325}in(c, (=GetEndpointResponse,=pkSess_802,=None,SP_803: bitstring,UP_804: bitstring));
                                                            {326}new Nc_805: bitstring;
                                                            {327}let gNc_806: bitstring = exp(g,Nc_805) in
                                                            {328}let m1_807: bitstring = (OpenSecureChannelRequest,pkCli,gNc_806) in
                                                            {329}out(c, (pkCli,m1_807));
                                                            {330}in(c, em2_808: bitstring);
                                                            {331}let m2_809: bitstring = em2_808 in
                                                            {332}let (=OpenSecureChannelResponse,PartS_810: bitstring,ST_811: bitstring,TTL_812: bitstring) = m2_809 in
                                                            {333}let Kcli_813: bitstring = exp(PartS_810,Nc_805) in
                                                            {334}out(c, senc(mCli(pkCli,pkSess_802),Kcli_813))
                                                        )
                                                        else
                                                            {335}let pkSess_814: bitstring = pub(sk(Sess)) in
                                                            {336}out(c, GetEndpointRequest);
                                                            {337}in(c, (=GetEndpointResponse,=pkSess_814,=None,SP_815: bitstring,UP_816: bitstring));
                                                            {338}new Nc_817: bitstring;
                                                            {339}let gNc_818: bitstring = exp(g,Nc_817) in
                                                            {340}let m1_819: bitstring = (OpenSecureChannelRequest,pkCli,gNc_818) in
                                                            {341}out(c, (pkCli,m1_819));
                                                            {342}in(c, em2_820: bitstring);
                                                            {343}let m2_821: bitstring = em2_820 in
                                                            {344}let (=OpenSecureChannelResponse,PartS_822: bitstring,ST_823: bitstring,TTL_824: bitstring) = m2_821 in
                                                            {345}let Kcli_825: bitstring = exp(PartS_822,Nc_817) in
                                                            {346}out(c, senc(mCli(pkCli,pkSess_814),Kcli_825))
                                                    )
                                                    else
                                                        {347}let pkSess_826: bitstring = fail-any in
                                                        {348}out(c, GetEndpointRequest);
                                                        {349}in(c, (=GetEndpointResponse,=pkSess_826,=None,SP_827: bitstring,UP_828: bitstring));
                                                        {350}new Nc_829: bitstring;
                                                        {351}let gNc_830: bitstring = exp(g,Nc_829) in
                                                        {352}let m1_831: bitstring = (OpenSecureChannelRequest,pkCli,gNc_830) in
                                                        {353}out(c, (pkCli,m1_831));
                                                        {354}in(c, em2_832: bitstring);
                                                        {355}let m2_833: bitstring = em2_832 in
                                                        {356}let (=OpenSecureChannelResponse,PartS_834: bitstring,ST_835: bitstring,TTL_836: bitstring) = m2_833 in
                                                        {357}let Kcli_837: bitstring = exp(PartS_834,Nc_829) in
                                                        {358}out(c, senc(mCli(pkCli,pkSess_826),Kcli_837))
                                            )
                                            else
                                                {359}let pkSess_838: bitstring = fail-any in
                                                {360}out(c, GetEndpointRequest);
                                                {361}in(c, (=GetEndpointResponse,=pkSess_838,=None,SP_839: bitstring,UP_840: bitstring));
                                                {362}new Nc_841: bitstring;
                                                {363}let gNc_842: bitstring = exp(g,Nc_841) in
                                                {364}let m1_843: bitstring = (OpenSecureChannelRequest,pkCli,gNc_842) in
                                                {365}out(c, (pkCli,m1_843));
                                                {366}in(c, em2_844: bitstring);
                                                {367}let m2_845: bitstring = em2_844 in
                                                {368}let (=OpenSecureChannelResponse,PartS_846: bitstring,ST_847: bitstring,TTL_848: bitstring) = m2_845 in
                                                {369}let Kcli_849: bitstring = exp(PartS_846,Nc_841) in
                                                {370}out(c, senc(mCli(pkCli,pkSess_838),Kcli_849))
                                    )
                                    else
                                        {371}let pkSess_850: bitstring = fail-any in
                                        {372}out(c, GetEndpointRequest);
                                        {373}in(c, (=GetEndpointResponse,=pkSess_850,=None,SP_851: bitstring,UP_852: bitstring));
                                        {374}new Nc_853: bitstring;
                                        {375}let gNc_854: bitstring = exp(g,Nc_853) in
                                        {376}let m1_855: bitstring = (OpenSecureChannelRequest,pkCli,gNc_854) in
                                        {377}out(c, (pkCli,m1_855));
                                        {378}in(c, em2_856: bitstring);
                                        {379}let m2_857: bitstring = em2_856 in
                                        {380}let (=OpenSecureChannelResponse,PartS_858: bitstring,ST_859: bitstring,TTL_860: bitstring) = m2_857 in
                                        {381}let Kcli_861: bitstring = exp(PartS_858,Nc_853) in
                                        {382}out(c, senc(mCli(pkCli,pkSess_850),Kcli_861))
                            )
                            else
                                {383}let pkDisco_862: bitstring = fail-any in
                                {384}let v_863: bool = (Sess = A) in
                                (
                                    {385}if v_863 then
                                    (
                                        {386}let pkSess_864: bitstring = pub(skA) in
                                        {387}out(c, GetEndpointRequest);
                                        {388}in(c, (=GetEndpointResponse,=pkSess_864,=None,SP_865: bitstring,UP_866: bitstring));
                                        {389}new Nc_867: bitstring;
                                        {390}let gNc_868: bitstring = exp(g,Nc_867) in
                                        {391}let m1_869: bitstring = (OpenSecureChannelRequest,pkCli,gNc_868) in
                                        {392}out(c, (pkCli,m1_869));
                                        {393}in(c, em2_870: bitstring);
                                        {394}let m2_871: bitstring = em2_870 in
                                        {395}let (=OpenSecureChannelResponse,PartS_872: bitstring,ST_873: bitstring,TTL_874: bitstring) = m2_871 in
                                        {396}let Kcli_875: bitstring = exp(PartS_872,Nc_867) in
                                        {397}out(c, senc(mCli(pkCli,pkSess_864),Kcli_875))
                                    )
                                    else
                                        {398}let v_876: bool = (Sess = B) in
                                        (
                                            {399}if v_876 then
                                            (
                                                {400}let pkSess_877: bitstring = pub(skB) in
                                                {401}out(c, GetEndpointRequest);
                                                {402}in(c, (=GetEndpointResponse,=pkSess_877,=None,SP_878: bitstring,UP_879: bitstring));
                                                {403}new Nc_880: bitstring;
                                                {404}let gNc_881: bitstring = exp(g,Nc_880) in
                                                {405}let m1_882: bitstring = (OpenSecureChannelRequest,pkCli,gNc_881) in
                                                {406}out(c, (pkCli,m1_882));
                                                {407}in(c, em2_883: bitstring);
                                                {408}let m2_884: bitstring = em2_883 in
                                                {409}let (=OpenSecureChannelResponse,PartS_885: bitstring,ST_886: bitstring,TTL_887: bitstring) = m2_884 in
                                                {410}let Kcli_888: bitstring = exp(PartS_885,Nc_880) in
                                                {411}out(c, senc(mCli(pkCli,pkSess_877),Kcli_888))
                                            )
                                            else
                                                {412}let v_889: bool = (Sess = C) in
                                                (
                                                    {413}if v_889 then
                                                    (
                                                        {414}let pkSess_890: bitstring = pub(skC) in
                                                        {415}out(c, GetEndpointRequest);
                                                        {416}in(c, (=GetEndpointResponse,=pkSess_890,=None,SP_891: bitstring,UP_892: bitstring));
                                                        {417}new Nc_893: bitstring;
                                                        {418}let gNc_894: bitstring = exp(g,Nc_893) in
                                                        {419}let m1_895: bitstring = (OpenSecureChannelRequest,pkCli,gNc_894) in
                                                        {420}out(c, (pkCli,m1_895));
                                                        {421}in(c, em2_896: bitstring);
                                                        {422}let m2_897: bitstring = em2_896 in
                                                        {423}let (=OpenSecureChannelResponse,PartS_898: bitstring,ST_899: bitstring,TTL_900: bitstring) = m2_897 in
                                                        {424}let Kcli_901: bitstring = exp(PartS_898,Nc_893) in
                                                        {425}out(c, senc(mCli(pkCli,pkSess_890),Kcli_901))
                                                    )
                                                    else
                                                        {426}let pkSess_902: bitstring = pub(sk(Sess)) in
                                                        {427}out(c, GetEndpointRequest);
                                                        {428}in(c, (=GetEndpointResponse,=pkSess_902,=None,SP_903: bitstring,UP_904: bitstring));
                                                        {429}new Nc_905: bitstring;
                                                        {430}let gNc_906: bitstring = exp(g,Nc_905) in
                                                        {431}let m1_907: bitstring = (OpenSecureChannelRequest,pkCli,gNc_906) in
                                                        {432}out(c, (pkCli,m1_907));
                                                        {433}in(c, em2_908: bitstring);
                                                        {434}let m2_909: bitstring = em2_908 in
                                                        {435}let (=OpenSecureChannelResponse,PartS_910: bitstring,ST_911: bitstring,TTL_912: bitstring) = m2_909 in
                                                        {436}let Kcli_913: bitstring = exp(PartS_910,Nc_905) in
                                                        {437}out(c, senc(mCli(pkCli,pkSess_902),Kcli_913))
                                                )
                                                else
                                                    {438}let pkSess_914: bitstring = fail-any in
                                                    {439}out(c, GetEndpointRequest);
                                                    {440}in(c, (=GetEndpointResponse,=pkSess_914,=None,SP_915: bitstring,UP_916: bitstring));
                                                    {441}new Nc_917: bitstring;
                                                    {442}let gNc_918: bitstring = exp(g,Nc_917) in
                                                    {443}let m1_919: bitstring = (OpenSecureChannelRequest,pkCli,gNc_918) in
                                                    {444}out(c, (pkCli,m1_919));
                                                    {445}in(c, em2_920: bitstring);
                                                    {446}let m2_921: bitstring = em2_920 in
                                                    {447}let (=OpenSecureChannelResponse,PartS_922: bitstring,ST_923: bitstring,TTL_924: bitstring) = m2_921 in
                                                    {448}let Kcli_925: bitstring = exp(PartS_922,Nc_917) in
                                                    {449}out(c, senc(mCli(pkCli,pkSess_914),Kcli_925))
                                        )
                                        else
                                            {450}let pkSess_926: bitstring = fail-any in
                                            {451}out(c, GetEndpointRequest);
                                            {452}in(c, (=GetEndpointResponse,=pkSess_926,=None,SP_927: bitstring,UP_928: bitstring));
                                            {453}new Nc_929: bitstring;
                                            {454}let gNc_930: bitstring = exp(g,Nc_929) in
                                            {455}let m1_931: bitstring = (OpenSecureChannelRequest,pkCli,gNc_930) in
                                            {456}out(c, (pkCli,m1_931));
                                            {457}in(c, em2_932: bitstring);
                                            {458}let m2_933: bitstring = em2_932 in
                                            {459}let (=OpenSecureChannelResponse,PartS_934: bitstring,ST_935: bitstring,TTL_936: bitstring) = m2_933 in
                                            {460}let Kcli_937: bitstring = exp(PartS_934,Nc_929) in
                                            {461}out(c, senc(mCli(pkCli,pkSess_926),Kcli_937))
                                )
                                else
                                    {462}let pkSess_938: bitstring = fail-any in
                                    {463}out(c, GetEndpointRequest);
                                    {464}in(c, (=GetEndpointResponse,=pkSess_938,=None,SP_939: bitstring,UP_940: bitstring));
                                    {465}new Nc_941: bitstring;
                                    {466}let gNc_942: bitstring = exp(g,Nc_941) in
                                    {467}let m1_943: bitstring = (OpenSecureChannelRequest,pkCli,gNc_942) in
                                    {468}out(c, (pkCli,m1_943));
                                    {469}in(c, em2_944: bitstring);
                                    {470}let m2_945: bitstring = em2_944 in
                                    {471}let (=OpenSecureChannelResponse,PartS_946: bitstring,ST_947: bitstring,TTL_948: bitstring) = m2_945 in
                                    {472}let Kcli_949: bitstring = exp(PartS_946,Nc_941) in
                                    {473}out(c, senc(mCli(pkCli,pkSess_938),Kcli_949))
                    )
                    else
                        {474}let pkDisco_950: bitstring = fail-any in
                        {475}let v_951: bool = (Sess = A) in
                        (
                            {476}if v_951 then
                            (
                                {477}let pkSess_952: bitstring = pub(skA) in
                                {478}out(c, GetEndpointRequest);
                                {479}in(c, (=GetEndpointResponse,=pkSess_952,=None,SP_953: bitstring,UP_954: bitstring));
                                {480}new Nc_955: bitstring;
                                {481}let gNc_956: bitstring = exp(g,Nc_955) in
                                {482}let m1_957: bitstring = (OpenSecureChannelRequest,pkCli,gNc_956) in
                                {483}out(c, (pkCli,m1_957));
                                {484}in(c, em2_958: bitstring);
                                {485}let m2_959: bitstring = em2_958 in
                                {486}let (=OpenSecureChannelResponse,PartS_960: bitstring,ST_961: bitstring,TTL_962: bitstring) = m2_959 in
                                {487}let Kcli_963: bitstring = exp(PartS_960,Nc_955) in
                                {488}out(c, senc(mCli(pkCli,pkSess_952),Kcli_963))
                            )
                            else
                                {489}let v_964: bool = (Sess = B) in
                                (
                                    {490}if v_964 then
                                    (
                                        {491}let pkSess_965: bitstring = pub(skB) in
                                        {492}out(c, GetEndpointRequest);
                                        {493}in(c, (=GetEndpointResponse,=pkSess_965,=None,SP_966: bitstring,UP_967: bitstring));
                                        {494}new Nc_968: bitstring;
                                        {495}let gNc_969: bitstring = exp(g,Nc_968) in
                                        {496}let m1_970: bitstring = (OpenSecureChannelRequest,pkCli,gNc_969) in
                                        {497}out(c, (pkCli,m1_970));
                                        {498}in(c, em2_971: bitstring);
                                        {499}let m2_972: bitstring = em2_971 in
                                        {500}let (=OpenSecureChannelResponse,PartS_973: bitstring,ST_974: bitstring,TTL_975: bitstring) = m2_972 in
                                        {501}let Kcli_976: bitstring = exp(PartS_973,Nc_968) in
                                        {502}out(c, senc(mCli(pkCli,pkSess_965),Kcli_976))
                                    )
                                    else
                                        {503}let v_977: bool = (Sess = C) in
                                        (
                                            {504}if v_977 then
                                            (
                                                {505}let pkSess_978: bitstring = pub(skC) in
                                                {506}out(c, GetEndpointRequest);
                                                {507}in(c, (=GetEndpointResponse,=pkSess_978,=None,SP_979: bitstring,UP_980: bitstring));
                                                {508}new Nc_981: bitstring;
                                                {509}let gNc_982: bitstring = exp(g,Nc_981) in
                                                {510}let m1_983: bitstring = (OpenSecureChannelRequest,pkCli,gNc_982) in
                                                {511}out(c, (pkCli,m1_983));
                                                {512}in(c, em2_984: bitstring);
                                                {513}let m2_985: bitstring = em2_984 in
                                                {514}let (=OpenSecureChannelResponse,PartS_986: bitstring,ST_987: bitstring,TTL_988: bitstring) = m2_985 in
                                                {515}let Kcli_989: bitstring = exp(PartS_986,Nc_981) in
                                                {516}out(c, senc(mCli(pkCli,pkSess_978),Kcli_989))
                                            )
                                            else
                                                {517}let pkSess_990: bitstring = pub(sk(Sess)) in
                                                {518}out(c, GetEndpointRequest);
                                                {519}in(c, (=GetEndpointResponse,=pkSess_990,=None,SP_991: bitstring,UP_992: bitstring));
                                                {520}new Nc_993: bitstring;
                                                {521}let gNc_994: bitstring = exp(g,Nc_993) in
                                                {522}let m1_995: bitstring = (OpenSecureChannelRequest,pkCli,gNc_994) in
                                                {523}out(c, (pkCli,m1_995));
                                                {524}in(c, em2_996: bitstring);
                                                {525}let m2_997: bitstring = em2_996 in
                                                {526}let (=OpenSecureChannelResponse,PartS_998: bitstring,ST_999: bitstring,TTL_1000: bitstring) = m2_997 in
                                                {527}let Kcli_1001: bitstring = exp(PartS_998,Nc_993) in
                                                {528}out(c, senc(mCli(pkCli,pkSess_990),Kcli_1001))
                                        )
                                        else
                                            {529}let pkSess_1002: bitstring = fail-any in
                                            {530}out(c, GetEndpointRequest);
                                            {531}in(c, (=GetEndpointResponse,=pkSess_1002,=None,SP_1003: bitstring,UP_1004: bitstring));
                                            {532}new Nc_1005: bitstring;
                                            {533}let gNc_1006: bitstring = exp(g,Nc_1005) in
                                            {534}let m1_1007: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1006) in
                                            {535}out(c, (pkCli,m1_1007));
                                            {536}in(c, em2_1008: bitstring);
                                            {537}let m2_1009: bitstring = em2_1008 in
                                            {538}let (=OpenSecureChannelResponse,PartS_1010: bitstring,ST_1011: bitstring,TTL_1012: bitstring) = m2_1009 in
                                            {539}let Kcli_1013: bitstring = exp(PartS_1010,Nc_1005) in
                                            {540}out(c, senc(mCli(pkCli,pkSess_1002),Kcli_1013))
                                )
                                else
                                    {541}let pkSess_1014: bitstring = fail-any in
                                    {542}out(c, GetEndpointRequest);
                                    {543}in(c, (=GetEndpointResponse,=pkSess_1014,=None,SP_1015: bitstring,UP_1016: bitstring));
                                    {544}new Nc_1017: bitstring;
                                    {545}let gNc_1018: bitstring = exp(g,Nc_1017) in
                                    {546}let m1_1019: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1018) in
                                    {547}out(c, (pkCli,m1_1019));
                                    {548}in(c, em2_1020: bitstring);
                                    {549}let m2_1021: bitstring = em2_1020 in
                                    {550}let (=OpenSecureChannelResponse,PartS_1022: bitstring,ST_1023: bitstring,TTL_1024: bitstring) = m2_1021 in
                                    {551}let Kcli_1025: bitstring = exp(PartS_1022,Nc_1017) in
                                    {552}out(c, senc(mCli(pkCli,pkSess_1014),Kcli_1025))
                        )
                        else
                            {553}let pkSess_1026: bitstring = fail-any in
                            {554}out(c, GetEndpointRequest);
                            {555}in(c, (=GetEndpointResponse,=pkSess_1026,=None,SP_1027: bitstring,UP_1028: bitstring));
                            {556}new Nc_1029: bitstring;
                            {557}let gNc_1030: bitstring = exp(g,Nc_1029) in
                            {558}let m1_1031: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1030) in
                            {559}out(c, (pkCli,m1_1031));
                            {560}in(c, em2_1032: bitstring);
                            {561}let m2_1033: bitstring = em2_1032 in
                            {562}let (=OpenSecureChannelResponse,PartS_1034: bitstring,ST_1035: bitstring,TTL_1036: bitstring) = m2_1033 in
                            {563}let Kcli_1037: bitstring = exp(PartS_1034,Nc_1029) in
                            {564}out(c, senc(mCli(pkCli,pkSess_1026),Kcli_1037))
            )
            else
                {565}let pkDisco_1038: bitstring = fail-any in
                {566}let v_1039: bool = (Sess = A) in
                (
                    {567}if v_1039 then
                    (
                        {568}let pkSess_1040: bitstring = pub(skA) in
                        {569}out(c, GetEndpointRequest);
                        {570}in(c, (=GetEndpointResponse,=pkSess_1040,=None,SP_1041: bitstring,UP_1042: bitstring));
                        {571}new Nc_1043: bitstring;
                        {572}let gNc_1044: bitstring = exp(g,Nc_1043) in
                        {573}let m1_1045: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1044) in
                        {574}out(c, (pkCli,m1_1045));
                        {575}in(c, em2_1046: bitstring);
                        {576}let m2_1047: bitstring = em2_1046 in
                        {577}let (=OpenSecureChannelResponse,PartS_1048: bitstring,ST_1049: bitstring,TTL_1050: bitstring) = m2_1047 in
                        {578}let Kcli_1051: bitstring = exp(PartS_1048,Nc_1043) in
                        {579}out(c, senc(mCli(pkCli,pkSess_1040),Kcli_1051))
                    )
                    else
                        {580}let v_1052: bool = (Sess = B) in
                        (
                            {581}if v_1052 then
                            (
                                {582}let pkSess_1053: bitstring = pub(skB) in
                                {583}out(c, GetEndpointRequest);
                                {584}in(c, (=GetEndpointResponse,=pkSess_1053,=None,SP_1054: bitstring,UP_1055: bitstring));
                                {585}new Nc_1056: bitstring;
                                {586}let gNc_1057: bitstring = exp(g,Nc_1056) in
                                {587}let m1_1058: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1057) in
                                {588}out(c, (pkCli,m1_1058));
                                {589}in(c, em2_1059: bitstring);
                                {590}let m2_1060: bitstring = em2_1059 in
                                {591}let (=OpenSecureChannelResponse,PartS_1061: bitstring,ST_1062: bitstring,TTL_1063: bitstring) = m2_1060 in
                                {592}let Kcli_1064: bitstring = exp(PartS_1061,Nc_1056) in
                                {593}out(c, senc(mCli(pkCli,pkSess_1053),Kcli_1064))
                            )
                            else
                                {594}let v_1065: bool = (Sess = C) in
                                (
                                    {595}if v_1065 then
                                    (
                                        {596}let pkSess_1066: bitstring = pub(skC) in
                                        {597}out(c, GetEndpointRequest);
                                        {598}in(c, (=GetEndpointResponse,=pkSess_1066,=None,SP_1067: bitstring,UP_1068: bitstring));
                                        {599}new Nc_1069: bitstring;
                                        {600}let gNc_1070: bitstring = exp(g,Nc_1069) in
                                        {601}let m1_1071: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1070) in
                                        {602}out(c, (pkCli,m1_1071));
                                        {603}in(c, em2_1072: bitstring);
                                        {604}let m2_1073: bitstring = em2_1072 in
                                        {605}let (=OpenSecureChannelResponse,PartS_1074: bitstring,ST_1075: bitstring,TTL_1076: bitstring) = m2_1073 in
                                        {606}let Kcli_1077: bitstring = exp(PartS_1074,Nc_1069) in
                                        {607}out(c, senc(mCli(pkCli,pkSess_1066),Kcli_1077))
                                    )
                                    else
                                        {608}let pkSess_1078: bitstring = pub(sk(Sess)) in
                                        {609}out(c, GetEndpointRequest);
                                        {610}in(c, (=GetEndpointResponse,=pkSess_1078,=None,SP_1079: bitstring,UP_1080: bitstring));
                                        {611}new Nc_1081: bitstring;
                                        {612}let gNc_1082: bitstring = exp(g,Nc_1081) in
                                        {613}let m1_1083: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1082) in
                                        {614}out(c, (pkCli,m1_1083));
                                        {615}in(c, em2_1084: bitstring);
                                        {616}let m2_1085: bitstring = em2_1084 in
                                        {617}let (=OpenSecureChannelResponse,PartS_1086: bitstring,ST_1087: bitstring,TTL_1088: bitstring) = m2_1085 in
                                        {618}let Kcli_1089: bitstring = exp(PartS_1086,Nc_1081) in
                                        {619}out(c, senc(mCli(pkCli,pkSess_1078),Kcli_1089))
                                )
                                else
                                    {620}let pkSess_1090: bitstring = fail-any in
                                    {621}out(c, GetEndpointRequest);
                                    {622}in(c, (=GetEndpointResponse,=pkSess_1090,=None,SP_1091: bitstring,UP_1092: bitstring));
                                    {623}new Nc_1093: bitstring;
                                    {624}let gNc_1094: bitstring = exp(g,Nc_1093) in
                                    {625}let m1_1095: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1094) in
                                    {626}out(c, (pkCli,m1_1095));
                                    {627}in(c, em2_1096: bitstring);
                                    {628}let m2_1097: bitstring = em2_1096 in
                                    {629}let (=OpenSecureChannelResponse,PartS_1098: bitstring,ST_1099: bitstring,TTL_1100: bitstring) = m2_1097 in
                                    {630}let Kcli_1101: bitstring = exp(PartS_1098,Nc_1093) in
                                    {631}out(c, senc(mCli(pkCli,pkSess_1090),Kcli_1101))
                        )
                        else
                            {632}let pkSess_1102: bitstring = fail-any in
                            {633}out(c, GetEndpointRequest);
                            {634}in(c, (=GetEndpointResponse,=pkSess_1102,=None,SP_1103: bitstring,UP_1104: bitstring));
                            {635}new Nc_1105: bitstring;
                            {636}let gNc_1106: bitstring = exp(g,Nc_1105) in
                            {637}let m1_1107: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1106) in
                            {638}out(c, (pkCli,m1_1107));
                            {639}in(c, em2_1108: bitstring);
                            {640}let m2_1109: bitstring = em2_1108 in
                            {641}let (=OpenSecureChannelResponse,PartS_1110: bitstring,ST_1111: bitstring,TTL_1112: bitstring) = m2_1109 in
                            {642}let Kcli_1113: bitstring = exp(PartS_1110,Nc_1105) in
                            {643}out(c, senc(mCli(pkCli,pkSess_1102),Kcli_1113))
                )
                else
                    {644}let pkSess_1114: bitstring = fail-any in
                    {645}out(c, GetEndpointRequest);
                    {646}in(c, (=GetEndpointResponse,=pkSess_1114,=None,SP_1115: bitstring,UP_1116: bitstring));
                    {647}new Nc_1117: bitstring;
                    {648}let gNc_1118: bitstring = exp(g,Nc_1117) in
                    {649}let m1_1119: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1118) in
                    {650}out(c, (pkCli,m1_1119));
                    {651}in(c, em2_1120: bitstring);
                    {652}let m2_1121: bitstring = em2_1120 in
                    {653}let (=OpenSecureChannelResponse,PartS_1122: bitstring,ST_1123: bitstring,TTL_1124: bitstring) = m2_1121 in
                    {654}let Kcli_1125: bitstring = exp(PartS_1122,Nc_1117) in
                    {655}out(c, senc(mCli(pkCli,pkSess_1114),Kcli_1125))
        )
        else
            {656}let v_1126: bool = (Cli = B) in
            (
                {657}if v_1126 then
                (
                    {658}let skCli_1127: bitstring = skB in
                    {659}let pkCli_1128: bitstring = pub(skCli_1127) in
                    {660}let v_1129: bool = (Disco = A) in
                    (
                        {661}if v_1129 then
                        (
                            {662}let pkDisco_1130: bitstring = pub(skA) in
                            {663}let v_1131: bool = (Sess = A) in
                            (
                                {664}if v_1131 then
                                (
                                    {665}let pkSess_1132: bitstring = pub(skA) in
                                    {666}out(c, GetEndpointRequest);
                                    {667}in(c, (=GetEndpointResponse,=pkSess_1132,=None,SP_1133: bitstring,UP_1134: bitstring));
                                    {668}new Nc_1135: bitstring;
                                    {669}let gNc_1136: bitstring = exp(g,Nc_1135) in
                                    {670}let m1_1137: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1136) in
                                    {671}out(c, (pkCli_1128,m1_1137));
                                    {672}in(c, em2_1138: bitstring);
                                    {673}let m2_1139: bitstring = em2_1138 in
                                    {674}let (=OpenSecureChannelResponse,PartS_1140: bitstring,ST_1141: bitstring,TTL_1142: bitstring) = m2_1139 in
                                    {675}let Kcli_1143: bitstring = exp(PartS_1140,Nc_1135) in
                                    {676}out(c, senc(mCli(pkCli_1128,pkSess_1132),Kcli_1143))
                                )
                                else
                                    {677}let v_1144: bool = (Sess = B) in
                                    (
                                        {678}if v_1144 then
                                        (
                                            {679}let pkSess_1145: bitstring = pub(skB) in
                                            {680}out(c, GetEndpointRequest);
                                            {681}in(c, (=GetEndpointResponse,=pkSess_1145,=None,SP_1146: bitstring,UP_1147: bitstring));
                                            {682}new Nc_1148: bitstring;
                                            {683}let gNc_1149: bitstring = exp(g,Nc_1148) in
                                            {684}let m1_1150: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1149) in
                                            {685}out(c, (pkCli_1128,m1_1150));
                                            {686}in(c, em2_1151: bitstring);
                                            {687}let m2_1152: bitstring = em2_1151 in
                                            {688}let (=OpenSecureChannelResponse,PartS_1153: bitstring,ST_1154: bitstring,TTL_1155: bitstring) = m2_1152 in
                                            {689}let Kcli_1156: bitstring = exp(PartS_1153,Nc_1148) in
                                            {690}out(c, senc(mCli(pkCli_1128,pkSess_1145),Kcli_1156))
                                        )
                                        else
                                            {691}let v_1157: bool = (Sess = C) in
                                            (
                                                {692}if v_1157 then
                                                (
                                                    {693}let pkSess_1158: bitstring = pub(skC) in
                                                    {694}out(c, GetEndpointRequest);
                                                    {695}in(c, (=GetEndpointResponse,=pkSess_1158,=None,SP_1159: bitstring,UP_1160: bitstring));
                                                    {696}new Nc_1161: bitstring;
                                                    {697}let gNc_1162: bitstring = exp(g,Nc_1161) in
                                                    {698}let m1_1163: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1162) in
                                                    {699}out(c, (pkCli_1128,m1_1163));
                                                    {700}in(c, em2_1164: bitstring);
                                                    {701}let m2_1165: bitstring = em2_1164 in
                                                    {702}let (=OpenSecureChannelResponse,PartS_1166: bitstring,ST_1167: bitstring,TTL_1168: bitstring) = m2_1165 in
                                                    {703}let Kcli_1169: bitstring = exp(PartS_1166,Nc_1161) in
                                                    {704}out(c, senc(mCli(pkCli_1128,pkSess_1158),Kcli_1169))
                                                )
                                                else
                                                    {705}let pkSess_1170: bitstring = pub(sk(Sess)) in
                                                    {706}out(c, GetEndpointRequest);
                                                    {707}in(c, (=GetEndpointResponse,=pkSess_1170,=None,SP_1171: bitstring,UP_1172: bitstring));
                                                    {708}new Nc_1173: bitstring;
                                                    {709}let gNc_1174: bitstring = exp(g,Nc_1173) in
                                                    {710}let m1_1175: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1174) in
                                                    {711}out(c, (pkCli_1128,m1_1175));
                                                    {712}in(c, em2_1176: bitstring);
                                                    {713}let m2_1177: bitstring = em2_1176 in
                                                    {714}let (=OpenSecureChannelResponse,PartS_1178: bitstring,ST_1179: bitstring,TTL_1180: bitstring) = m2_1177 in
                                                    {715}let Kcli_1181: bitstring = exp(PartS_1178,Nc_1173) in
                                                    {716}out(c, senc(mCli(pkCli_1128,pkSess_1170),Kcli_1181))
                                            )
                                            else
                                                {717}let pkSess_1182: bitstring = fail-any in
                                                {718}out(c, GetEndpointRequest);
                                                {719}in(c, (=GetEndpointResponse,=pkSess_1182,=None,SP_1183: bitstring,UP_1184: bitstring));
                                                {720}new Nc_1185: bitstring;
                                                {721}let gNc_1186: bitstring = exp(g,Nc_1185) in
                                                {722}let m1_1187: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1186) in
                                                {723}out(c, (pkCli_1128,m1_1187));
                                                {724}in(c, em2_1188: bitstring);
                                                {725}let m2_1189: bitstring = em2_1188 in
                                                {726}let (=OpenSecureChannelResponse,PartS_1190: bitstring,ST_1191: bitstring,TTL_1192: bitstring) = m2_1189 in
                                                {727}let Kcli_1193: bitstring = exp(PartS_1190,Nc_1185) in
                                                {728}out(c, senc(mCli(pkCli_1128,pkSess_1182),Kcli_1193))
                                    )
                                    else
                                        {729}let pkSess_1194: bitstring = fail-any in
                                        {730}out(c, GetEndpointRequest);
                                        {731}in(c, (=GetEndpointResponse,=pkSess_1194,=None,SP_1195: bitstring,UP_1196: bitstring));
                                        {732}new Nc_1197: bitstring;
                                        {733}let gNc_1198: bitstring = exp(g,Nc_1197) in
                                        {734}let m1_1199: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1198) in
                                        {735}out(c, (pkCli_1128,m1_1199));
                                        {736}in(c, em2_1200: bitstring);
                                        {737}let m2_1201: bitstring = em2_1200 in
                                        {738}let (=OpenSecureChannelResponse,PartS_1202: bitstring,ST_1203: bitstring,TTL_1204: bitstring) = m2_1201 in
                                        {739}let Kcli_1205: bitstring = exp(PartS_1202,Nc_1197) in
                                        {740}out(c, senc(mCli(pkCli_1128,pkSess_1194),Kcli_1205))
                            )
                            else
                                {741}let pkSess_1206: bitstring = fail-any in
                                {742}out(c, GetEndpointRequest);
                                {743}in(c, (=GetEndpointResponse,=pkSess_1206,=None,SP_1207: bitstring,UP_1208: bitstring));
                                {744}new Nc_1209: bitstring;
                                {745}let gNc_1210: bitstring = exp(g,Nc_1209) in
                                {746}let m1_1211: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1210) in
                                {747}out(c, (pkCli_1128,m1_1211));
                                {748}in(c, em2_1212: bitstring);
                                {749}let m2_1213: bitstring = em2_1212 in
                                {750}let (=OpenSecureChannelResponse,PartS_1214: bitstring,ST_1215: bitstring,TTL_1216: bitstring) = m2_1213 in
                                {751}let Kcli_1217: bitstring = exp(PartS_1214,Nc_1209) in
                                {752}out(c, senc(mCli(pkCli_1128,pkSess_1206),Kcli_1217))
                        )
                        else
                            {753}let v_1218: bool = (Disco = B) in
                            (
                                {754}if v_1218 then
                                (
                                    {755}let pkDisco_1219: bitstring = pub(skB) in
                                    {756}let v_1220: bool = (Sess = A) in
                                    (
                                        {757}if v_1220 then
                                        (
                                            {758}let pkSess_1221: bitstring = pub(skA) in
                                            {759}out(c, GetEndpointRequest);
                                            {760}in(c, (=GetEndpointResponse,=pkSess_1221,=None,SP_1222: bitstring,UP_1223: bitstring));
                                            {761}new Nc_1224: bitstring;
                                            {762}let gNc_1225: bitstring = exp(g,Nc_1224) in
                                            {763}let m1_1226: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1225) in
                                            {764}out(c, (pkCli_1128,m1_1226));
                                            {765}in(c, em2_1227: bitstring);
                                            {766}let m2_1228: bitstring = em2_1227 in
                                            {767}let (=OpenSecureChannelResponse,PartS_1229: bitstring,ST_1230: bitstring,TTL_1231: bitstring) = m2_1228 in
                                            {768}let Kcli_1232: bitstring = exp(PartS_1229,Nc_1224) in
                                            {769}out(c, senc(mCli(pkCli_1128,pkSess_1221),Kcli_1232))
                                        )
                                        else
                                            {770}let v_1233: bool = (Sess = B) in
                                            (
                                                {771}if v_1233 then
                                                (
                                                    {772}let pkSess_1234: bitstring = pub(skB) in
                                                    {773}out(c, GetEndpointRequest);
                                                    {774}in(c, (=GetEndpointResponse,=pkSess_1234,=None,SP_1235: bitstring,UP_1236: bitstring));
                                                    {775}new Nc_1237: bitstring;
                                                    {776}let gNc_1238: bitstring = exp(g,Nc_1237) in
                                                    {777}let m1_1239: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1238) in
                                                    {778}out(c, (pkCli_1128,m1_1239));
                                                    {779}in(c, em2_1240: bitstring);
                                                    {780}let m2_1241: bitstring = em2_1240 in
                                                    {781}let (=OpenSecureChannelResponse,PartS_1242: bitstring,ST_1243: bitstring,TTL_1244: bitstring) = m2_1241 in
                                                    {782}let Kcli_1245: bitstring = exp(PartS_1242,Nc_1237) in
                                                    {783}out(c, senc(mCli(pkCli_1128,pkSess_1234),Kcli_1245))
                                                )
                                                else
                                                    {784}let v_1246: bool = (Sess = C) in
                                                    (
                                                        {785}if v_1246 then
                                                        (
                                                            {786}let pkSess_1247: bitstring = pub(skC) in
                                                            {787}out(c, GetEndpointRequest);
                                                            {788}in(c, (=GetEndpointResponse,=pkSess_1247,=None,SP_1248: bitstring,UP_1249: bitstring));
                                                            {789}new Nc_1250: bitstring;
                                                            {790}let gNc_1251: bitstring = exp(g,Nc_1250) in
                                                            {791}let m1_1252: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1251) in
                                                            {792}out(c, (pkCli_1128,m1_1252));
                                                            {793}in(c, em2_1253: bitstring);
                                                            {794}let m2_1254: bitstring = em2_1253 in
                                                            {795}let (=OpenSecureChannelResponse,PartS_1255: bitstring,ST_1256: bitstring,TTL_1257: bitstring) = m2_1254 in
                                                            {796}let Kcli_1258: bitstring = exp(PartS_1255,Nc_1250) in
                                                            {797}out(c, senc(mCli(pkCli_1128,pkSess_1247),Kcli_1258))
                                                        )
                                                        else
                                                            {798}let pkSess_1259: bitstring = pub(sk(Sess)) in
                                                            {799}out(c, GetEndpointRequest);
                                                            {800}in(c, (=GetEndpointResponse,=pkSess_1259,=None,SP_1260: bitstring,UP_1261: bitstring));
                                                            {801}new Nc_1262: bitstring;
                                                            {802}let gNc_1263: bitstring = exp(g,Nc_1262) in
                                                            {803}let m1_1264: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1263) in
                                                            {804}out(c, (pkCli_1128,m1_1264));
                                                            {805}in(c, em2_1265: bitstring);
                                                            {806}let m2_1266: bitstring = em2_1265 in
                                                            {807}let (=OpenSecureChannelResponse,PartS_1267: bitstring,ST_1268: bitstring,TTL_1269: bitstring) = m2_1266 in
                                                            {808}let Kcli_1270: bitstring = exp(PartS_1267,Nc_1262) in
                                                            {809}out(c, senc(mCli(pkCli_1128,pkSess_1259),Kcli_1270))
                                                    )
                                                    else
                                                        {810}let pkSess_1271: bitstring = fail-any in
                                                        {811}out(c, GetEndpointRequest);
                                                        {812}in(c, (=GetEndpointResponse,=pkSess_1271,=None,SP_1272: bitstring,UP_1273: bitstring));
                                                        {813}new Nc_1274: bitstring;
                                                        {814}let gNc_1275: bitstring = exp(g,Nc_1274) in
                                                        {815}let m1_1276: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1275) in
                                                        {816}out(c, (pkCli_1128,m1_1276));
                                                        {817}in(c, em2_1277: bitstring);
                                                        {818}let m2_1278: bitstring = em2_1277 in
                                                        {819}let (=OpenSecureChannelResponse,PartS_1279: bitstring,ST_1280: bitstring,TTL_1281: bitstring) = m2_1278 in
                                                        {820}let Kcli_1282: bitstring = exp(PartS_1279,Nc_1274) in
                                                        {821}out(c, senc(mCli(pkCli_1128,pkSess_1271),Kcli_1282))
                                            )
                                            else
                                                {822}let pkSess_1283: bitstring = fail-any in
                                                {823}out(c, GetEndpointRequest);
                                                {824}in(c, (=GetEndpointResponse,=pkSess_1283,=None,SP_1284: bitstring,UP_1285: bitstring));
                                                {825}new Nc_1286: bitstring;
                                                {826}let gNc_1287: bitstring = exp(g,Nc_1286) in
                                                {827}let m1_1288: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1287) in
                                                {828}out(c, (pkCli_1128,m1_1288));
                                                {829}in(c, em2_1289: bitstring);
                                                {830}let m2_1290: bitstring = em2_1289 in
                                                {831}let (=OpenSecureChannelResponse,PartS_1291: bitstring,ST_1292: bitstring,TTL_1293: bitstring) = m2_1290 in
                                                {832}let Kcli_1294: bitstring = exp(PartS_1291,Nc_1286) in
                                                {833}out(c, senc(mCli(pkCli_1128,pkSess_1283),Kcli_1294))
                                    )
                                    else
                                        {834}let pkSess_1295: bitstring = fail-any in
                                        {835}out(c, GetEndpointRequest);
                                        {836}in(c, (=GetEndpointResponse,=pkSess_1295,=None,SP_1296: bitstring,UP_1297: bitstring));
                                        {837}new Nc_1298: bitstring;
                                        {838}let gNc_1299: bitstring = exp(g,Nc_1298) in
                                        {839}let m1_1300: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1299) in
                                        {840}out(c, (pkCli_1128,m1_1300));
                                        {841}in(c, em2_1301: bitstring);
                                        {842}let m2_1302: bitstring = em2_1301 in
                                        {843}let (=OpenSecureChannelResponse,PartS_1303: bitstring,ST_1304: bitstring,TTL_1305: bitstring) = m2_1302 in
                                        {844}let Kcli_1306: bitstring = exp(PartS_1303,Nc_1298) in
                                        {845}out(c, senc(mCli(pkCli_1128,pkSess_1295),Kcli_1306))
                                )
                                else
                                    {846}let v_1307: bool = (Disco = C) in
                                    (
                                        {847}if v_1307 then
                                        (
                                            {848}let pkDisco_1308: bitstring = pub(skC) in
                                            {849}let v_1309: bool = (Sess = A) in
                                            (
                                                {850}if v_1309 then
                                                (
                                                    {851}let pkSess_1310: bitstring = pub(skA) in
                                                    {852}out(c, GetEndpointRequest);
                                                    {853}in(c, (=GetEndpointResponse,=pkSess_1310,=None,SP_1311: bitstring,UP_1312: bitstring));
                                                    {854}new Nc_1313: bitstring;
                                                    {855}let gNc_1314: bitstring = exp(g,Nc_1313) in
                                                    {856}let m1_1315: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1314) in
                                                    {857}out(c, (pkCli_1128,m1_1315));
                                                    {858}in(c, em2_1316: bitstring);
                                                    {859}let m2_1317: bitstring = em2_1316 in
                                                    {860}let (=OpenSecureChannelResponse,PartS_1318: bitstring,ST_1319: bitstring,TTL_1320: bitstring) = m2_1317 in
                                                    {861}let Kcli_1321: bitstring = exp(PartS_1318,Nc_1313) in
                                                    {862}out(c, senc(mCli(pkCli_1128,pkSess_1310),Kcli_1321))
                                                )
                                                else
                                                    {863}let v_1322: bool = (Sess = B) in
                                                    (
                                                        {864}if v_1322 then
                                                        (
                                                            {865}let pkSess_1323: bitstring = pub(skB) in
                                                            {866}out(c, GetEndpointRequest);
                                                            {867}in(c, (=GetEndpointResponse,=pkSess_1323,=None,SP_1324: bitstring,UP_1325: bitstring));
                                                            {868}new Nc_1326: bitstring;
                                                            {869}let gNc_1327: bitstring = exp(g,Nc_1326) in
                                                            {870}let m1_1328: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1327) in
                                                            {871}out(c, (pkCli_1128,m1_1328));
                                                            {872}in(c, em2_1329: bitstring);
                                                            {873}let m2_1330: bitstring = em2_1329 in
                                                            {874}let (=OpenSecureChannelResponse,PartS_1331: bitstring,ST_1332: bitstring,TTL_1333: bitstring) = m2_1330 in
                                                            {875}let Kcli_1334: bitstring = exp(PartS_1331,Nc_1326) in
                                                            {876}out(c, senc(mCli(pkCli_1128,pkSess_1323),Kcli_1334))
                                                        )
                                                        else
                                                            {877}let v_1335: bool = (Sess = C) in
                                                            (
                                                                {878}if v_1335 then
                                                                (
                                                                    {879}let pkSess_1336: bitstring = pub(skC) in
                                                                    {880}out(c, GetEndpointRequest);
                                                                    {881}in(c, (=GetEndpointResponse,=pkSess_1336,=None,SP_1337: bitstring,UP_1338: bitstring));
                                                                    {882}new Nc_1339: bitstring;
                                                                    {883}let gNc_1340: bitstring = exp(g,Nc_1339) in
                                                                    {884}let m1_1341: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1340) in
                                                                    {885}out(c, (pkCli_1128,m1_1341));
                                                                    {886}in(c, em2_1342: bitstring);
                                                                    {887}let m2_1343: bitstring = em2_1342 in
                                                                    {888}let (=OpenSecureChannelResponse,PartS_1344: bitstring,ST_1345: bitstring,TTL_1346: bitstring) = m2_1343 in
                                                                    {889}let Kcli_1347: bitstring = exp(PartS_1344,Nc_1339) in
                                                                    {890}out(c, senc(mCli(pkCli_1128,pkSess_1336),Kcli_1347))
                                                                )
                                                                else
                                                                    {891}let pkSess_1348: bitstring = pub(sk(Sess)) in
                                                                    {892}out(c, GetEndpointRequest);
                                                                    {893}in(c, (=GetEndpointResponse,=pkSess_1348,=None,SP_1349: bitstring,UP_1350: bitstring));
                                                                    {894}new Nc_1351: bitstring;
                                                                    {895}let gNc_1352: bitstring = exp(g,Nc_1351) in
                                                                    {896}let m1_1353: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1352) in
                                                                    {897}out(c, (pkCli_1128,m1_1353));
                                                                    {898}in(c, em2_1354: bitstring);
                                                                    {899}let m2_1355: bitstring = em2_1354 in
                                                                    {900}let (=OpenSecureChannelResponse,PartS_1356: bitstring,ST_1357: bitstring,TTL_1358: bitstring) = m2_1355 in
                                                                    {901}let Kcli_1359: bitstring = exp(PartS_1356,Nc_1351) in
                                                                    {902}out(c, senc(mCli(pkCli_1128,pkSess_1348),Kcli_1359))
                                                            )
                                                            else
                                                                {903}let pkSess_1360: bitstring = fail-any in
                                                                {904}out(c, GetEndpointRequest);
                                                                {905}in(c, (=GetEndpointResponse,=pkSess_1360,=None,SP_1361: bitstring,UP_1362: bitstring));
                                                                {906}new Nc_1363: bitstring;
                                                                {907}let gNc_1364: bitstring = exp(g,Nc_1363) in
                                                                {908}let m1_1365: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1364) in
                                                                {909}out(c, (pkCli_1128,m1_1365));
                                                                {910}in(c, em2_1366: bitstring);
                                                                {911}let m2_1367: bitstring = em2_1366 in
                                                                {912}let (=OpenSecureChannelResponse,PartS_1368: bitstring,ST_1369: bitstring,TTL_1370: bitstring) = m2_1367 in
                                                                {913}let Kcli_1371: bitstring = exp(PartS_1368,Nc_1363) in
                                                                {914}out(c, senc(mCli(pkCli_1128,pkSess_1360),Kcli_1371))
                                                    )
                                                    else
                                                        {915}let pkSess_1372: bitstring = fail-any in
                                                        {916}out(c, GetEndpointRequest);
                                                        {917}in(c, (=GetEndpointResponse,=pkSess_1372,=None,SP_1373: bitstring,UP_1374: bitstring));
                                                        {918}new Nc_1375: bitstring;
                                                        {919}let gNc_1376: bitstring = exp(g,Nc_1375) in
                                                        {920}let m1_1377: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1376) in
                                                        {921}out(c, (pkCli_1128,m1_1377));
                                                        {922}in(c, em2_1378: bitstring);
                                                        {923}let m2_1379: bitstring = em2_1378 in
                                                        {924}let (=OpenSecureChannelResponse,PartS_1380: bitstring,ST_1381: bitstring,TTL_1382: bitstring) = m2_1379 in
                                                        {925}let Kcli_1383: bitstring = exp(PartS_1380,Nc_1375) in
                                                        {926}out(c, senc(mCli(pkCli_1128,pkSess_1372),Kcli_1383))
                                            )
                                            else
                                                {927}let pkSess_1384: bitstring = fail-any in
                                                {928}out(c, GetEndpointRequest);
                                                {929}in(c, (=GetEndpointResponse,=pkSess_1384,=None,SP_1385: bitstring,UP_1386: bitstring));
                                                {930}new Nc_1387: bitstring;
                                                {931}let gNc_1388: bitstring = exp(g,Nc_1387) in
                                                {932}let m1_1389: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1388) in
                                                {933}out(c, (pkCli_1128,m1_1389));
                                                {934}in(c, em2_1390: bitstring);
                                                {935}let m2_1391: bitstring = em2_1390 in
                                                {936}let (=OpenSecureChannelResponse,PartS_1392: bitstring,ST_1393: bitstring,TTL_1394: bitstring) = m2_1391 in
                                                {937}let Kcli_1395: bitstring = exp(PartS_1392,Nc_1387) in
                                                {938}out(c, senc(mCli(pkCli_1128,pkSess_1384),Kcli_1395))
                                        )
                                        else
                                            {939}let pkDisco_1396: bitstring = pub(sk(Disco)) in
                                            {940}let v_1397: bool = (Sess = A) in
                                            (
                                                {941}if v_1397 then
                                                (
                                                    {942}let pkSess_1398: bitstring = pub(skA) in
                                                    {943}out(c, GetEndpointRequest);
                                                    {944}in(c, (=GetEndpointResponse,=pkSess_1398,=None,SP_1399: bitstring,UP_1400: bitstring));
                                                    {945}new Nc_1401: bitstring;
                                                    {946}let gNc_1402: bitstring = exp(g,Nc_1401) in
                                                    {947}let m1_1403: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1402) in
                                                    {948}out(c, (pkCli_1128,m1_1403));
                                                    {949}in(c, em2_1404: bitstring);
                                                    {950}let m2_1405: bitstring = em2_1404 in
                                                    {951}let (=OpenSecureChannelResponse,PartS_1406: bitstring,ST_1407: bitstring,TTL_1408: bitstring) = m2_1405 in
                                                    {952}let Kcli_1409: bitstring = exp(PartS_1406,Nc_1401) in
                                                    {953}out(c, senc(mCli(pkCli_1128,pkSess_1398),Kcli_1409))
                                                )
                                                else
                                                    {954}let v_1410: bool = (Sess = B) in
                                                    (
                                                        {955}if v_1410 then
                                                        (
                                                            {956}let pkSess_1411: bitstring = pub(skB) in
                                                            {957}out(c, GetEndpointRequest);
                                                            {958}in(c, (=GetEndpointResponse,=pkSess_1411,=None,SP_1412: bitstring,UP_1413: bitstring));
                                                            {959}new Nc_1414: bitstring;
                                                            {960}let gNc_1415: bitstring = exp(g,Nc_1414) in
                                                            {961}let m1_1416: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1415) in
                                                            {962}out(c, (pkCli_1128,m1_1416));
                                                            {963}in(c, em2_1417: bitstring);
                                                            {964}let m2_1418: bitstring = em2_1417 in
                                                            {965}let (=OpenSecureChannelResponse,PartS_1419: bitstring,ST_1420: bitstring,TTL_1421: bitstring) = m2_1418 in
                                                            {966}let Kcli_1422: bitstring = exp(PartS_1419,Nc_1414) in
                                                            {967}out(c, senc(mCli(pkCli_1128,pkSess_1411),Kcli_1422))
                                                        )
                                                        else
                                                            {968}let v_1423: bool = (Sess = C) in
                                                            (
                                                                {969}if v_1423 then
                                                                (
                                                                    {970}let pkSess_1424: bitstring = pub(skC) in
                                                                    {971}out(c, GetEndpointRequest);
                                                                    {972}in(c, (=GetEndpointResponse,=pkSess_1424,=None,SP_1425: bitstring,UP_1426: bitstring));
                                                                    {973}new Nc_1427: bitstring;
                                                                    {974}let gNc_1428: bitstring = exp(g,Nc_1427) in
                                                                    {975}let m1_1429: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1428) in
                                                                    {976}out(c, (pkCli_1128,m1_1429));
                                                                    {977}in(c, em2_1430: bitstring);
                                                                    {978}let m2_1431: bitstring = em2_1430 in
                                                                    {979}let (=OpenSecureChannelResponse,PartS_1432: bitstring,ST_1433: bitstring,TTL_1434: bitstring) = m2_1431 in
                                                                    {980}let Kcli_1435: bitstring = exp(PartS_1432,Nc_1427) in
                                                                    {981}out(c, senc(mCli(pkCli_1128,pkSess_1424),Kcli_1435))
                                                                )
                                                                else
                                                                    {982}let pkSess_1436: bitstring = pub(sk(Sess)) in
                                                                    {983}out(c, GetEndpointRequest);
                                                                    {984}in(c, (=GetEndpointResponse,=pkSess_1436,=None,SP_1437: bitstring,UP_1438: bitstring));
                                                                    {985}new Nc_1439: bitstring;
                                                                    {986}let gNc_1440: bitstring = exp(g,Nc_1439) in
                                                                    {987}let m1_1441: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1440) in
                                                                    {988}out(c, (pkCli_1128,m1_1441));
                                                                    {989}in(c, em2_1442: bitstring);
                                                                    {990}let m2_1443: bitstring = em2_1442 in
                                                                    {991}let (=OpenSecureChannelResponse,PartS_1444: bitstring,ST_1445: bitstring,TTL_1446: bitstring) = m2_1443 in
                                                                    {992}let Kcli_1447: bitstring = exp(PartS_1444,Nc_1439) in
                                                                    {993}out(c, senc(mCli(pkCli_1128,pkSess_1436),Kcli_1447))
                                                            )
                                                            else
                                                                {994}let pkSess_1448: bitstring = fail-any in
                                                                {995}out(c, GetEndpointRequest);
                                                                {996}in(c, (=GetEndpointResponse,=pkSess_1448,=None,SP_1449: bitstring,UP_1450: bitstring));
                                                                {997}new Nc_1451: bitstring;
                                                                {998}let gNc_1452: bitstring = exp(g,Nc_1451) in
                                                                {999}let m1_1453: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1452) in
                                                                {1000}out(c, (pkCli_1128,m1_1453));
                                                                {1001}in(c, em2_1454: bitstring);
                                                                {1002}let m2_1455: bitstring = em2_1454 in
                                                                {1003}let (=OpenSecureChannelResponse,PartS_1456: bitstring,ST_1457: bitstring,TTL_1458: bitstring) = m2_1455 in
                                                                {1004}let Kcli_1459: bitstring = exp(PartS_1456,Nc_1451) in
                                                                {1005}out(c, senc(mCli(pkCli_1128,pkSess_1448),Kcli_1459))
                                                    )
                                                    else
                                                        {1006}let pkSess_1460: bitstring = fail-any in
                                                        {1007}out(c, GetEndpointRequest);
                                                        {1008}in(c, (=GetEndpointResponse,=pkSess_1460,=None,SP_1461: bitstring,UP_1462: bitstring));
                                                        {1009}new Nc_1463: bitstring;
                                                        {1010}let gNc_1464: bitstring = exp(g,Nc_1463) in
                                                        {1011}let m1_1465: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1464) in
                                                        {1012}out(c, (pkCli_1128,m1_1465));
                                                        {1013}in(c, em2_1466: bitstring);
                                                        {1014}let m2_1467: bitstring = em2_1466 in
                                                        {1015}let (=OpenSecureChannelResponse,PartS_1468: bitstring,ST_1469: bitstring,TTL_1470: bitstring) = m2_1467 in
                                                        {1016}let Kcli_1471: bitstring = exp(PartS_1468,Nc_1463) in
                                                        {1017}out(c, senc(mCli(pkCli_1128,pkSess_1460),Kcli_1471))
                                            )
                                            else
                                                {1018}let pkSess_1472: bitstring = fail-any in
                                                {1019}out(c, GetEndpointRequest);
                                                {1020}in(c, (=GetEndpointResponse,=pkSess_1472,=None,SP_1473: bitstring,UP_1474: bitstring));
                                                {1021}new Nc_1475: bitstring;
                                                {1022}let gNc_1476: bitstring = exp(g,Nc_1475) in
                                                {1023}let m1_1477: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1476) in
                                                {1024}out(c, (pkCli_1128,m1_1477));
                                                {1025}in(c, em2_1478: bitstring);
                                                {1026}let m2_1479: bitstring = em2_1478 in
                                                {1027}let (=OpenSecureChannelResponse,PartS_1480: bitstring,ST_1481: bitstring,TTL_1482: bitstring) = m2_1479 in
                                                {1028}let Kcli_1483: bitstring = exp(PartS_1480,Nc_1475) in
                                                {1029}out(c, senc(mCli(pkCli_1128,pkSess_1472),Kcli_1483))
                                    )
                                    else
                                        {1030}let pkDisco_1484: bitstring = fail-any in
                                        {1031}let v_1485: bool = (Sess = A) in
                                        (
                                            {1032}if v_1485 then
                                            (
                                                {1033}let pkSess_1486: bitstring = pub(skA) in
                                                {1034}out(c, GetEndpointRequest);
                                                {1035}in(c, (=GetEndpointResponse,=pkSess_1486,=None,SP_1487: bitstring,UP_1488: bitstring));
                                                {1036}new Nc_1489: bitstring;
                                                {1037}let gNc_1490: bitstring = exp(g,Nc_1489) in
                                                {1038}let m1_1491: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1490) in
                                                {1039}out(c, (pkCli_1128,m1_1491));
                                                {1040}in(c, em2_1492: bitstring);
                                                {1041}let m2_1493: bitstring = em2_1492 in
                                                {1042}let (=OpenSecureChannelResponse,PartS_1494: bitstring,ST_1495: bitstring,TTL_1496: bitstring) = m2_1493 in
                                                {1043}let Kcli_1497: bitstring = exp(PartS_1494,Nc_1489) in
                                                {1044}out(c, senc(mCli(pkCli_1128,pkSess_1486),Kcli_1497))
                                            )
                                            else
                                                {1045}let v_1498: bool = (Sess = B) in
                                                (
                                                    {1046}if v_1498 then
                                                    (
                                                        {1047}let pkSess_1499: bitstring = pub(skB) in
                                                        {1048}out(c, GetEndpointRequest);
                                                        {1049}in(c, (=GetEndpointResponse,=pkSess_1499,=None,SP_1500: bitstring,UP_1501: bitstring));
                                                        {1050}new Nc_1502: bitstring;
                                                        {1051}let gNc_1503: bitstring = exp(g,Nc_1502) in
                                                        {1052}let m1_1504: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1503) in
                                                        {1053}out(c, (pkCli_1128,m1_1504));
                                                        {1054}in(c, em2_1505: bitstring);
                                                        {1055}let m2_1506: bitstring = em2_1505 in
                                                        {1056}let (=OpenSecureChannelResponse,PartS_1507: bitstring,ST_1508: bitstring,TTL_1509: bitstring) = m2_1506 in
                                                        {1057}let Kcli_1510: bitstring = exp(PartS_1507,Nc_1502) in
                                                        {1058}out(c, senc(mCli(pkCli_1128,pkSess_1499),Kcli_1510))
                                                    )
                                                    else
                                                        {1059}let v_1511: bool = (Sess = C) in
                                                        (
                                                            {1060}if v_1511 then
                                                            (
                                                                {1061}let pkSess_1512: bitstring = pub(skC) in
                                                                {1062}out(c, GetEndpointRequest);
                                                                {1063}in(c, (=GetEndpointResponse,=pkSess_1512,=None,SP_1513: bitstring,UP_1514: bitstring));
                                                                {1064}new Nc_1515: bitstring;
                                                                {1065}let gNc_1516: bitstring = exp(g,Nc_1515) in
                                                                {1066}let m1_1517: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1516) in
                                                                {1067}out(c, (pkCli_1128,m1_1517));
                                                                {1068}in(c, em2_1518: bitstring);
                                                                {1069}let m2_1519: bitstring = em2_1518 in
                                                                {1070}let (=OpenSecureChannelResponse,PartS_1520: bitstring,ST_1521: bitstring,TTL_1522: bitstring) = m2_1519 in
                                                                {1071}let Kcli_1523: bitstring = exp(PartS_1520,Nc_1515) in
                                                                {1072}out(c, senc(mCli(pkCli_1128,pkSess_1512),Kcli_1523))
                                                            )
                                                            else
                                                                {1073}let pkSess_1524: bitstring = pub(sk(Sess)) in
                                                                {1074}out(c, GetEndpointRequest);
                                                                {1075}in(c, (=GetEndpointResponse,=pkSess_1524,=None,SP_1525: bitstring,UP_1526: bitstring));
                                                                {1076}new Nc_1527: bitstring;
                                                                {1077}let gNc_1528: bitstring = exp(g,Nc_1527) in
                                                                {1078}let m1_1529: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1528) in
                                                                {1079}out(c, (pkCli_1128,m1_1529));
                                                                {1080}in(c, em2_1530: bitstring);
                                                                {1081}let m2_1531: bitstring = em2_1530 in
                                                                {1082}let (=OpenSecureChannelResponse,PartS_1532: bitstring,ST_1533: bitstring,TTL_1534: bitstring) = m2_1531 in
                                                                {1083}let Kcli_1535: bitstring = exp(PartS_1532,Nc_1527) in
                                                                {1084}out(c, senc(mCli(pkCli_1128,pkSess_1524),Kcli_1535))
                                                        )
                                                        else
                                                            {1085}let pkSess_1536: bitstring = fail-any in
                                                            {1086}out(c, GetEndpointRequest);
                                                            {1087}in(c, (=GetEndpointResponse,=pkSess_1536,=None,SP_1537: bitstring,UP_1538: bitstring));
                                                            {1088}new Nc_1539: bitstring;
                                                            {1089}let gNc_1540: bitstring = exp(g,Nc_1539) in
                                                            {1090}let m1_1541: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1540) in
                                                            {1091}out(c, (pkCli_1128,m1_1541));
                                                            {1092}in(c, em2_1542: bitstring);
                                                            {1093}let m2_1543: bitstring = em2_1542 in
                                                            {1094}let (=OpenSecureChannelResponse,PartS_1544: bitstring,ST_1545: bitstring,TTL_1546: bitstring) = m2_1543 in
                                                            {1095}let Kcli_1547: bitstring = exp(PartS_1544,Nc_1539) in
                                                            {1096}out(c, senc(mCli(pkCli_1128,pkSess_1536),Kcli_1547))
                                                )
                                                else
                                                    {1097}let pkSess_1548: bitstring = fail-any in
                                                    {1098}out(c, GetEndpointRequest);
                                                    {1099}in(c, (=GetEndpointResponse,=pkSess_1548,=None,SP_1549: bitstring,UP_1550: bitstring));
                                                    {1100}new Nc_1551: bitstring;
                                                    {1101}let gNc_1552: bitstring = exp(g,Nc_1551) in
                                                    {1102}let m1_1553: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1552) in
                                                    {1103}out(c, (pkCli_1128,m1_1553));
                                                    {1104}in(c, em2_1554: bitstring);
                                                    {1105}let m2_1555: bitstring = em2_1554 in
                                                    {1106}let (=OpenSecureChannelResponse,PartS_1556: bitstring,ST_1557: bitstring,TTL_1558: bitstring) = m2_1555 in
                                                    {1107}let Kcli_1559: bitstring = exp(PartS_1556,Nc_1551) in
                                                    {1108}out(c, senc(mCli(pkCli_1128,pkSess_1548),Kcli_1559))
                                        )
                                        else
                                            {1109}let pkSess_1560: bitstring = fail-any in
                                            {1110}out(c, GetEndpointRequest);
                                            {1111}in(c, (=GetEndpointResponse,=pkSess_1560,=None,SP_1561: bitstring,UP_1562: bitstring));
                                            {1112}new Nc_1563: bitstring;
                                            {1113}let gNc_1564: bitstring = exp(g,Nc_1563) in
                                            {1114}let m1_1565: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1564) in
                                            {1115}out(c, (pkCli_1128,m1_1565));
                                            {1116}in(c, em2_1566: bitstring);
                                            {1117}let m2_1567: bitstring = em2_1566 in
                                            {1118}let (=OpenSecureChannelResponse,PartS_1568: bitstring,ST_1569: bitstring,TTL_1570: bitstring) = m2_1567 in
                                            {1119}let Kcli_1571: bitstring = exp(PartS_1568,Nc_1563) in
                                            {1120}out(c, senc(mCli(pkCli_1128,pkSess_1560),Kcli_1571))
                            )
                            else
                                {1121}let pkDisco_1572: bitstring = fail-any in
                                {1122}let v_1573: bool = (Sess = A) in
                                (
                                    {1123}if v_1573 then
                                    (
                                        {1124}let pkSess_1574: bitstring = pub(skA) in
                                        {1125}out(c, GetEndpointRequest);
                                        {1126}in(c, (=GetEndpointResponse,=pkSess_1574,=None,SP_1575: bitstring,UP_1576: bitstring));
                                        {1127}new Nc_1577: bitstring;
                                        {1128}let gNc_1578: bitstring = exp(g,Nc_1577) in
                                        {1129}let m1_1579: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1578) in
                                        {1130}out(c, (pkCli_1128,m1_1579));
                                        {1131}in(c, em2_1580: bitstring);
                                        {1132}let m2_1581: bitstring = em2_1580 in
                                        {1133}let (=OpenSecureChannelResponse,PartS_1582: bitstring,ST_1583: bitstring,TTL_1584: bitstring) = m2_1581 in
                                        {1134}let Kcli_1585: bitstring = exp(PartS_1582,Nc_1577) in
                                        {1135}out(c, senc(mCli(pkCli_1128,pkSess_1574),Kcli_1585))
                                    )
                                    else
                                        {1136}let v_1586: bool = (Sess = B) in
                                        (
                                            {1137}if v_1586 then
                                            (
                                                {1138}let pkSess_1587: bitstring = pub(skB) in
                                                {1139}out(c, GetEndpointRequest);
                                                {1140}in(c, (=GetEndpointResponse,=pkSess_1587,=None,SP_1588: bitstring,UP_1589: bitstring));
                                                {1141}new Nc_1590: bitstring;
                                                {1142}let gNc_1591: bitstring = exp(g,Nc_1590) in
                                                {1143}let m1_1592: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1591) in
                                                {1144}out(c, (pkCli_1128,m1_1592));
                                                {1145}in(c, em2_1593: bitstring);
                                                {1146}let m2_1594: bitstring = em2_1593 in
                                                {1147}let (=OpenSecureChannelResponse,PartS_1595: bitstring,ST_1596: bitstring,TTL_1597: bitstring) = m2_1594 in
                                                {1148}let Kcli_1598: bitstring = exp(PartS_1595,Nc_1590) in
                                                {1149}out(c, senc(mCli(pkCli_1128,pkSess_1587),Kcli_1598))
                                            )
                                            else
                                                {1150}let v_1599: bool = (Sess = C) in
                                                (
                                                    {1151}if v_1599 then
                                                    (
                                                        {1152}let pkSess_1600: bitstring = pub(skC) in
                                                        {1153}out(c, GetEndpointRequest);
                                                        {1154}in(c, (=GetEndpointResponse,=pkSess_1600,=None,SP_1601: bitstring,UP_1602: bitstring));
                                                        {1155}new Nc_1603: bitstring;
                                                        {1156}let gNc_1604: bitstring = exp(g,Nc_1603) in
                                                        {1157}let m1_1605: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1604) in
                                                        {1158}out(c, (pkCli_1128,m1_1605));
                                                        {1159}in(c, em2_1606: bitstring);
                                                        {1160}let m2_1607: bitstring = em2_1606 in
                                                        {1161}let (=OpenSecureChannelResponse,PartS_1608: bitstring,ST_1609: bitstring,TTL_1610: bitstring) = m2_1607 in
                                                        {1162}let Kcli_1611: bitstring = exp(PartS_1608,Nc_1603) in
                                                        {1163}out(c, senc(mCli(pkCli_1128,pkSess_1600),Kcli_1611))
                                                    )
                                                    else
                                                        {1164}let pkSess_1612: bitstring = pub(sk(Sess)) in
                                                        {1165}out(c, GetEndpointRequest);
                                                        {1166}in(c, (=GetEndpointResponse,=pkSess_1612,=None,SP_1613: bitstring,UP_1614: bitstring));
                                                        {1167}new Nc_1615: bitstring;
                                                        {1168}let gNc_1616: bitstring = exp(g,Nc_1615) in
                                                        {1169}let m1_1617: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1616) in
                                                        {1170}out(c, (pkCli_1128,m1_1617));
                                                        {1171}in(c, em2_1618: bitstring);
                                                        {1172}let m2_1619: bitstring = em2_1618 in
                                                        {1173}let (=OpenSecureChannelResponse,PartS_1620: bitstring,ST_1621: bitstring,TTL_1622: bitstring) = m2_1619 in
                                                        {1174}let Kcli_1623: bitstring = exp(PartS_1620,Nc_1615) in
                                                        {1175}out(c, senc(mCli(pkCli_1128,pkSess_1612),Kcli_1623))
                                                )
                                                else
                                                    {1176}let pkSess_1624: bitstring = fail-any in
                                                    {1177}out(c, GetEndpointRequest);
                                                    {1178}in(c, (=GetEndpointResponse,=pkSess_1624,=None,SP_1625: bitstring,UP_1626: bitstring));
                                                    {1179}new Nc_1627: bitstring;
                                                    {1180}let gNc_1628: bitstring = exp(g,Nc_1627) in
                                                    {1181}let m1_1629: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1628) in
                                                    {1182}out(c, (pkCli_1128,m1_1629));
                                                    {1183}in(c, em2_1630: bitstring);
                                                    {1184}let m2_1631: bitstring = em2_1630 in
                                                    {1185}let (=OpenSecureChannelResponse,PartS_1632: bitstring,ST_1633: bitstring,TTL_1634: bitstring) = m2_1631 in
                                                    {1186}let Kcli_1635: bitstring = exp(PartS_1632,Nc_1627) in
                                                    {1187}out(c, senc(mCli(pkCli_1128,pkSess_1624),Kcli_1635))
                                        )
                                        else
                                            {1188}let pkSess_1636: bitstring = fail-any in
                                            {1189}out(c, GetEndpointRequest);
                                            {1190}in(c, (=GetEndpointResponse,=pkSess_1636,=None,SP_1637: bitstring,UP_1638: bitstring));
                                            {1191}new Nc_1639: bitstring;
                                            {1192}let gNc_1640: bitstring = exp(g,Nc_1639) in
                                            {1193}let m1_1641: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1640) in
                                            {1194}out(c, (pkCli_1128,m1_1641));
                                            {1195}in(c, em2_1642: bitstring);
                                            {1196}let m2_1643: bitstring = em2_1642 in
                                            {1197}let (=OpenSecureChannelResponse,PartS_1644: bitstring,ST_1645: bitstring,TTL_1646: bitstring) = m2_1643 in
                                            {1198}let Kcli_1647: bitstring = exp(PartS_1644,Nc_1639) in
                                            {1199}out(c, senc(mCli(pkCli_1128,pkSess_1636),Kcli_1647))
                                )
                                else
                                    {1200}let pkSess_1648: bitstring = fail-any in
                                    {1201}out(c, GetEndpointRequest);
                                    {1202}in(c, (=GetEndpointResponse,=pkSess_1648,=None,SP_1649: bitstring,UP_1650: bitstring));
                                    {1203}new Nc_1651: bitstring;
                                    {1204}let gNc_1652: bitstring = exp(g,Nc_1651) in
                                    {1205}let m1_1653: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1652) in
                                    {1206}out(c, (pkCli_1128,m1_1653));
                                    {1207}in(c, em2_1654: bitstring);
                                    {1208}let m2_1655: bitstring = em2_1654 in
                                    {1209}let (=OpenSecureChannelResponse,PartS_1656: bitstring,ST_1657: bitstring,TTL_1658: bitstring) = m2_1655 in
                                    {1210}let Kcli_1659: bitstring = exp(PartS_1656,Nc_1651) in
                                    {1211}out(c, senc(mCli(pkCli_1128,pkSess_1648),Kcli_1659))
                    )
                    else
                        {1212}let pkDisco_1660: bitstring = fail-any in
                        {1213}let v_1661: bool = (Sess = A) in
                        (
                            {1214}if v_1661 then
                            (
                                {1215}let pkSess_1662: bitstring = pub(skA) in
                                {1216}out(c, GetEndpointRequest);
                                {1217}in(c, (=GetEndpointResponse,=pkSess_1662,=None,SP_1663: bitstring,UP_1664: bitstring));
                                {1218}new Nc_1665: bitstring;
                                {1219}let gNc_1666: bitstring = exp(g,Nc_1665) in
                                {1220}let m1_1667: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1666) in
                                {1221}out(c, (pkCli_1128,m1_1667));
                                {1222}in(c, em2_1668: bitstring);
                                {1223}let m2_1669: bitstring = em2_1668 in
                                {1224}let (=OpenSecureChannelResponse,PartS_1670: bitstring,ST_1671: bitstring,TTL_1672: bitstring) = m2_1669 in
                                {1225}let Kcli_1673: bitstring = exp(PartS_1670,Nc_1665) in
                                {1226}out(c, senc(mCli(pkCli_1128,pkSess_1662),Kcli_1673))
                            )
                            else
                                {1227}let v_1674: bool = (Sess = B) in
                                (
                                    {1228}if v_1674 then
                                    (
                                        {1229}let pkSess_1675: bitstring = pub(skB) in
                                        {1230}out(c, GetEndpointRequest);
                                        {1231}in(c, (=GetEndpointResponse,=pkSess_1675,=None,SP_1676: bitstring,UP_1677: bitstring));
                                        {1232}new Nc_1678: bitstring;
                                        {1233}let gNc_1679: bitstring = exp(g,Nc_1678) in
                                        {1234}let m1_1680: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1679) in
                                        {1235}out(c, (pkCli_1128,m1_1680));
                                        {1236}in(c, em2_1681: bitstring);
                                        {1237}let m2_1682: bitstring = em2_1681 in
                                        {1238}let (=OpenSecureChannelResponse,PartS_1683: bitstring,ST_1684: bitstring,TTL_1685: bitstring) = m2_1682 in
                                        {1239}let Kcli_1686: bitstring = exp(PartS_1683,Nc_1678) in
                                        {1240}out(c, senc(mCli(pkCli_1128,pkSess_1675),Kcli_1686))
                                    )
                                    else
                                        {1241}let v_1687: bool = (Sess = C) in
                                        (
                                            {1242}if v_1687 then
                                            (
                                                {1243}let pkSess_1688: bitstring = pub(skC) in
                                                {1244}out(c, GetEndpointRequest);
                                                {1245}in(c, (=GetEndpointResponse,=pkSess_1688,=None,SP_1689: bitstring,UP_1690: bitstring));
                                                {1246}new Nc_1691: bitstring;
                                                {1247}let gNc_1692: bitstring = exp(g,Nc_1691) in
                                                {1248}let m1_1693: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1692) in
                                                {1249}out(c, (pkCli_1128,m1_1693));
                                                {1250}in(c, em2_1694: bitstring);
                                                {1251}let m2_1695: bitstring = em2_1694 in
                                                {1252}let (=OpenSecureChannelResponse,PartS_1696: bitstring,ST_1697: bitstring,TTL_1698: bitstring) = m2_1695 in
                                                {1253}let Kcli_1699: bitstring = exp(PartS_1696,Nc_1691) in
                                                {1254}out(c, senc(mCli(pkCli_1128,pkSess_1688),Kcli_1699))
                                            )
                                            else
                                                {1255}let pkSess_1700: bitstring = pub(sk(Sess)) in
                                                {1256}out(c, GetEndpointRequest);
                                                {1257}in(c, (=GetEndpointResponse,=pkSess_1700,=None,SP_1701: bitstring,UP_1702: bitstring));
                                                {1258}new Nc_1703: bitstring;
                                                {1259}let gNc_1704: bitstring = exp(g,Nc_1703) in
                                                {1260}let m1_1705: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1704) in
                                                {1261}out(c, (pkCli_1128,m1_1705));
                                                {1262}in(c, em2_1706: bitstring);
                                                {1263}let m2_1707: bitstring = em2_1706 in
                                                {1264}let (=OpenSecureChannelResponse,PartS_1708: bitstring,ST_1709: bitstring,TTL_1710: bitstring) = m2_1707 in
                                                {1265}let Kcli_1711: bitstring = exp(PartS_1708,Nc_1703) in
                                                {1266}out(c, senc(mCli(pkCli_1128,pkSess_1700),Kcli_1711))
                                        )
                                        else
                                            {1267}let pkSess_1712: bitstring = fail-any in
                                            {1268}out(c, GetEndpointRequest);
                                            {1269}in(c, (=GetEndpointResponse,=pkSess_1712,=None,SP_1713: bitstring,UP_1714: bitstring));
                                            {1270}new Nc_1715: bitstring;
                                            {1271}let gNc_1716: bitstring = exp(g,Nc_1715) in
                                            {1272}let m1_1717: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1716) in
                                            {1273}out(c, (pkCli_1128,m1_1717));
                                            {1274}in(c, em2_1718: bitstring);
                                            {1275}let m2_1719: bitstring = em2_1718 in
                                            {1276}let (=OpenSecureChannelResponse,PartS_1720: bitstring,ST_1721: bitstring,TTL_1722: bitstring) = m2_1719 in
                                            {1277}let Kcli_1723: bitstring = exp(PartS_1720,Nc_1715) in
                                            {1278}out(c, senc(mCli(pkCli_1128,pkSess_1712),Kcli_1723))
                                )
                                else
                                    {1279}let pkSess_1724: bitstring = fail-any in
                                    {1280}out(c, GetEndpointRequest);
                                    {1281}in(c, (=GetEndpointResponse,=pkSess_1724,=None,SP_1725: bitstring,UP_1726: bitstring));
                                    {1282}new Nc_1727: bitstring;
                                    {1283}let gNc_1728: bitstring = exp(g,Nc_1727) in
                                    {1284}let m1_1729: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1728) in
                                    {1285}out(c, (pkCli_1128,m1_1729));
                                    {1286}in(c, em2_1730: bitstring);
                                    {1287}let m2_1731: bitstring = em2_1730 in
                                    {1288}let (=OpenSecureChannelResponse,PartS_1732: bitstring,ST_1733: bitstring,TTL_1734: bitstring) = m2_1731 in
                                    {1289}let Kcli_1735: bitstring = exp(PartS_1732,Nc_1727) in
                                    {1290}out(c, senc(mCli(pkCli_1128,pkSess_1724),Kcli_1735))
                        )
                        else
                            {1291}let pkSess_1736: bitstring = fail-any in
                            {1292}out(c, GetEndpointRequest);
                            {1293}in(c, (=GetEndpointResponse,=pkSess_1736,=None,SP_1737: bitstring,UP_1738: bitstring));
                            {1294}new Nc_1739: bitstring;
                            {1295}let gNc_1740: bitstring = exp(g,Nc_1739) in
                            {1296}let m1_1741: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1740) in
                            {1297}out(c, (pkCli_1128,m1_1741));
                            {1298}in(c, em2_1742: bitstring);
                            {1299}let m2_1743: bitstring = em2_1742 in
                            {1300}let (=OpenSecureChannelResponse,PartS_1744: bitstring,ST_1745: bitstring,TTL_1746: bitstring) = m2_1743 in
                            {1301}let Kcli_1747: bitstring = exp(PartS_1744,Nc_1739) in
                            {1302}out(c, senc(mCli(pkCli_1128,pkSess_1736),Kcli_1747))
                )
                else
                    {1303}let =true = (Cli = C) in
                    (
                        {1304}let skCli_1748: bitstring = skC in
                        {1305}let pkCli_1749: bitstring = pub(skCli_1748) in
                        {1306}let v_1750: bool = (Disco = A) in
                        (
                            {1307}if v_1750 then
                            (
                                {1308}let pkDisco_1751: bitstring = pub(skA) in
                                {1309}let v_1752: bool = (Sess = A) in
                                (
                                    {1310}if v_1752 then
                                    (
                                        {1311}let pkSess_1753: bitstring = pub(skA) in
                                        {1312}out(c, GetEndpointRequest);
                                        {1313}in(c, (=GetEndpointResponse,=pkSess_1753,=None,SP_1754: bitstring,UP_1755: bitstring));
                                        {1314}new Nc_1756: bitstring;
                                        {1315}let gNc_1757: bitstring = exp(g,Nc_1756) in
                                        {1316}let m1_1758: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1757) in
                                        {1317}out(c, (pkCli_1749,m1_1758));
                                        {1318}in(c, em2_1759: bitstring);
                                        {1319}let m2_1760: bitstring = em2_1759 in
                                        {1320}let (=OpenSecureChannelResponse,PartS_1761: bitstring,ST_1762: bitstring,TTL_1763: bitstring) = m2_1760 in
                                        {1321}let Kcli_1764: bitstring = exp(PartS_1761,Nc_1756) in
                                        {1322}out(c, senc(mCli(pkCli_1749,pkSess_1753),Kcli_1764))
                                    )
                                    else
                                        {1323}let v_1765: bool = (Sess = B) in
                                        (
                                            {1324}if v_1765 then
                                            (
                                                {1325}let pkSess_1766: bitstring = pub(skB) in
                                                {1326}out(c, GetEndpointRequest);
                                                {1327}in(c, (=GetEndpointResponse,=pkSess_1766,=None,SP_1767: bitstring,UP_1768: bitstring));
                                                {1328}new Nc_1769: bitstring;
                                                {1329}let gNc_1770: bitstring = exp(g,Nc_1769) in
                                                {1330}let m1_1771: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1770) in
                                                {1331}out(c, (pkCli_1749,m1_1771));
                                                {1332}in(c, em2_1772: bitstring);
                                                {1333}let m2_1773: bitstring = em2_1772 in
                                                {1334}let (=OpenSecureChannelResponse,PartS_1774: bitstring,ST_1775: bitstring,TTL_1776: bitstring) = m2_1773 in
                                                {1335}let Kcli_1777: bitstring = exp(PartS_1774,Nc_1769) in
                                                {1336}out(c, senc(mCli(pkCli_1749,pkSess_1766),Kcli_1777))
                                            )
                                            else
                                                {1337}let v_1778: bool = (Sess = C) in
                                                (
                                                    {1338}if v_1778 then
                                                    (
                                                        {1339}let pkSess_1779: bitstring = pub(skC) in
                                                        {1340}out(c, GetEndpointRequest);
                                                        {1341}in(c, (=GetEndpointResponse,=pkSess_1779,=None,SP_1780: bitstring,UP_1781: bitstring));
                                                        {1342}new Nc_1782: bitstring;
                                                        {1343}let gNc_1783: bitstring = exp(g,Nc_1782) in
                                                        {1344}let m1_1784: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1783) in
                                                        {1345}out(c, (pkCli_1749,m1_1784));
                                                        {1346}in(c, em2_1785: bitstring);
                                                        {1347}let m2_1786: bitstring = em2_1785 in
                                                        {1348}let (=OpenSecureChannelResponse,PartS_1787: bitstring,ST_1788: bitstring,TTL_1789: bitstring) = m2_1786 in
                                                        {1349}let Kcli_1790: bitstring = exp(PartS_1787,Nc_1782) in
                                                        {1350}out(c, senc(mCli(pkCli_1749,pkSess_1779),Kcli_1790))
                                                    )
                                                    else
                                                        {1351}let pkSess_1791: bitstring = pub(sk(Sess)) in
                                                        {1352}out(c, GetEndpointRequest);
                                                        {1353}in(c, (=GetEndpointResponse,=pkSess_1791,=None,SP_1792: bitstring,UP_1793: bitstring));
                                                        {1354}new Nc_1794: bitstring;
                                                        {1355}let gNc_1795: bitstring = exp(g,Nc_1794) in
                                                        {1356}let m1_1796: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1795) in
                                                        {1357}out(c, (pkCli_1749,m1_1796));
                                                        {1358}in(c, em2_1797: bitstring);
                                                        {1359}let m2_1798: bitstring = em2_1797 in
                                                        {1360}let (=OpenSecureChannelResponse,PartS_1799: bitstring,ST_1800: bitstring,TTL_1801: bitstring) = m2_1798 in
                                                        {1361}let Kcli_1802: bitstring = exp(PartS_1799,Nc_1794) in
                                                        {1362}out(c, senc(mCli(pkCli_1749,pkSess_1791),Kcli_1802))
                                                )
                                                else
                                                    {1363}let pkSess_1803: bitstring = fail-any in
                                                    {1364}out(c, GetEndpointRequest);
                                                    {1365}in(c, (=GetEndpointResponse,=pkSess_1803,=None,SP_1804: bitstring,UP_1805: bitstring));
                                                    {1366}new Nc_1806: bitstring;
                                                    {1367}let gNc_1807: bitstring = exp(g,Nc_1806) in
                                                    {1368}let m1_1808: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1807) in
                                                    {1369}out(c, (pkCli_1749,m1_1808));
                                                    {1370}in(c, em2_1809: bitstring);
                                                    {1371}let m2_1810: bitstring = em2_1809 in
                                                    {1372}let (=OpenSecureChannelResponse,PartS_1811: bitstring,ST_1812: bitstring,TTL_1813: bitstring) = m2_1810 in
                                                    {1373}let Kcli_1814: bitstring = exp(PartS_1811,Nc_1806) in
                                                    {1374}out(c, senc(mCli(pkCli_1749,pkSess_1803),Kcli_1814))
                                        )
                                        else
                                            {1375}let pkSess_1815: bitstring = fail-any in
                                            {1376}out(c, GetEndpointRequest);
                                            {1377}in(c, (=GetEndpointResponse,=pkSess_1815,=None,SP_1816: bitstring,UP_1817: bitstring));
                                            {1378}new Nc_1818: bitstring;
                                            {1379}let gNc_1819: bitstring = exp(g,Nc_1818) in
                                            {1380}let m1_1820: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1819) in
                                            {1381}out(c, (pkCli_1749,m1_1820));
                                            {1382}in(c, em2_1821: bitstring);
                                            {1383}let m2_1822: bitstring = em2_1821 in
                                            {1384}let (=OpenSecureChannelResponse,PartS_1823: bitstring,ST_1824: bitstring,TTL_1825: bitstring) = m2_1822 in
                                            {1385}let Kcli_1826: bitstring = exp(PartS_1823,Nc_1818) in
                                            {1386}out(c, senc(mCli(pkCli_1749,pkSess_1815),Kcli_1826))
                                )
                                else
                                    {1387}let pkSess_1827: bitstring = fail-any in
                                    {1388}out(c, GetEndpointRequest);
                                    {1389}in(c, (=GetEndpointResponse,=pkSess_1827,=None,SP_1828: bitstring,UP_1829: bitstring));
                                    {1390}new Nc_1830: bitstring;
                                    {1391}let gNc_1831: bitstring = exp(g,Nc_1830) in
                                    {1392}let m1_1832: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1831) in
                                    {1393}out(c, (pkCli_1749,m1_1832));
                                    {1394}in(c, em2_1833: bitstring);
                                    {1395}let m2_1834: bitstring = em2_1833 in
                                    {1396}let (=OpenSecureChannelResponse,PartS_1835: bitstring,ST_1836: bitstring,TTL_1837: bitstring) = m2_1834 in
                                    {1397}let Kcli_1838: bitstring = exp(PartS_1835,Nc_1830) in
                                    {1398}out(c, senc(mCli(pkCli_1749,pkSess_1827),Kcli_1838))
                            )
                            else
                                {1399}let v_1839: bool = (Disco = B) in
                                (
                                    {1400}if v_1839 then
                                    (
                                        {1401}let pkDisco_1840: bitstring = pub(skB) in
                                        {1402}let v_1841: bool = (Sess = A) in
                                        (
                                            {1403}if v_1841 then
                                            (
                                                {1404}let pkSess_1842: bitstring = pub(skA) in
                                                {1405}out(c, GetEndpointRequest);
                                                {1406}in(c, (=GetEndpointResponse,=pkSess_1842,=None,SP_1843: bitstring,UP_1844: bitstring));
                                                {1407}new Nc_1845: bitstring;
                                                {1408}let gNc_1846: bitstring = exp(g,Nc_1845) in
                                                {1409}let m1_1847: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1846) in
                                                {1410}out(c, (pkCli_1749,m1_1847));
                                                {1411}in(c, em2_1848: bitstring);
                                                {1412}let m2_1849: bitstring = em2_1848 in
                                                {1413}let (=OpenSecureChannelResponse,PartS_1850: bitstring,ST_1851: bitstring,TTL_1852: bitstring) = m2_1849 in
                                                {1414}let Kcli_1853: bitstring = exp(PartS_1850,Nc_1845) in
                                                {1415}out(c, senc(mCli(pkCli_1749,pkSess_1842),Kcli_1853))
                                            )
                                            else
                                                {1416}let v_1854: bool = (Sess = B) in
                                                (
                                                    {1417}if v_1854 then
                                                    (
                                                        {1418}let pkSess_1855: bitstring = pub(skB) in
                                                        {1419}out(c, GetEndpointRequest);
                                                        {1420}in(c, (=GetEndpointResponse,=pkSess_1855,=None,SP_1856: bitstring,UP_1857: bitstring));
                                                        {1421}new Nc_1858: bitstring;
                                                        {1422}let gNc_1859: bitstring = exp(g,Nc_1858) in
                                                        {1423}let m1_1860: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1859) in
                                                        {1424}out(c, (pkCli_1749,m1_1860));
                                                        {1425}in(c, em2_1861: bitstring);
                                                        {1426}let m2_1862: bitstring = em2_1861 in
                                                        {1427}let (=OpenSecureChannelResponse,PartS_1863: bitstring,ST_1864: bitstring,TTL_1865: bitstring) = m2_1862 in
                                                        {1428}let Kcli_1866: bitstring = exp(PartS_1863,Nc_1858) in
                                                        {1429}out(c, senc(mCli(pkCli_1749,pkSess_1855),Kcli_1866))
                                                    )
                                                    else
                                                        {1430}let v_1867: bool = (Sess = C) in
                                                        (
                                                            {1431}if v_1867 then
                                                            (
                                                                {1432}let pkSess_1868: bitstring = pub(skC) in
                                                                {1433}out(c, GetEndpointRequest);
                                                                {1434}in(c, (=GetEndpointResponse,=pkSess_1868,=None,SP_1869: bitstring,UP_1870: bitstring));
                                                                {1435}new Nc_1871: bitstring;
                                                                {1436}let gNc_1872: bitstring = exp(g,Nc_1871) in
                                                                {1437}let m1_1873: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1872) in
                                                                {1438}out(c, (pkCli_1749,m1_1873));
                                                                {1439}in(c, em2_1874: bitstring);
                                                                {1440}let m2_1875: bitstring = em2_1874 in
                                                                {1441}let (=OpenSecureChannelResponse,PartS_1876: bitstring,ST_1877: bitstring,TTL_1878: bitstring) = m2_1875 in
                                                                {1442}let Kcli_1879: bitstring = exp(PartS_1876,Nc_1871) in
                                                                {1443}out(c, senc(mCli(pkCli_1749,pkSess_1868),Kcli_1879))
                                                            )
                                                            else
                                                                {1444}let pkSess_1880: bitstring = pub(sk(Sess)) in
                                                                {1445}out(c, GetEndpointRequest);
                                                                {1446}in(c, (=GetEndpointResponse,=pkSess_1880,=None,SP_1881: bitstring,UP_1882: bitstring));
                                                                {1447}new Nc_1883: bitstring;
                                                                {1448}let gNc_1884: bitstring = exp(g,Nc_1883) in
                                                                {1449}let m1_1885: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1884) in
                                                                {1450}out(c, (pkCli_1749,m1_1885));
                                                                {1451}in(c, em2_1886: bitstring);
                                                                {1452}let m2_1887: bitstring = em2_1886 in
                                                                {1453}let (=OpenSecureChannelResponse,PartS_1888: bitstring,ST_1889: bitstring,TTL_1890: bitstring) = m2_1887 in
                                                                {1454}let Kcli_1891: bitstring = exp(PartS_1888,Nc_1883) in
                                                                {1455}out(c, senc(mCli(pkCli_1749,pkSess_1880),Kcli_1891))
                                                        )
                                                        else
                                                            {1456}let pkSess_1892: bitstring = fail-any in
                                                            {1457}out(c, GetEndpointRequest);
                                                            {1458}in(c, (=GetEndpointResponse,=pkSess_1892,=None,SP_1893: bitstring,UP_1894: bitstring));
                                                            {1459}new Nc_1895: bitstring;
                                                            {1460}let gNc_1896: bitstring = exp(g,Nc_1895) in
                                                            {1461}let m1_1897: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1896) in
                                                            {1462}out(c, (pkCli_1749,m1_1897));
                                                            {1463}in(c, em2_1898: bitstring);
                                                            {1464}let m2_1899: bitstring = em2_1898 in
                                                            {1465}let (=OpenSecureChannelResponse,PartS_1900: bitstring,ST_1901: bitstring,TTL_1902: bitstring) = m2_1899 in
                                                            {1466}let Kcli_1903: bitstring = exp(PartS_1900,Nc_1895) in
                                                            {1467}out(c, senc(mCli(pkCli_1749,pkSess_1892),Kcli_1903))
                                                )
                                                else
                                                    {1468}let pkSess_1904: bitstring = fail-any in
                                                    {1469}out(c, GetEndpointRequest);
                                                    {1470}in(c, (=GetEndpointResponse,=pkSess_1904,=None,SP_1905: bitstring,UP_1906: bitstring));
                                                    {1471}new Nc_1907: bitstring;
                                                    {1472}let gNc_1908: bitstring = exp(g,Nc_1907) in
                                                    {1473}let m1_1909: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1908) in
                                                    {1474}out(c, (pkCli_1749,m1_1909));
                                                    {1475}in(c, em2_1910: bitstring);
                                                    {1476}let m2_1911: bitstring = em2_1910 in
                                                    {1477}let (=OpenSecureChannelResponse,PartS_1912: bitstring,ST_1913: bitstring,TTL_1914: bitstring) = m2_1911 in
                                                    {1478}let Kcli_1915: bitstring = exp(PartS_1912,Nc_1907) in
                                                    {1479}out(c, senc(mCli(pkCli_1749,pkSess_1904),Kcli_1915))
                                        )
                                        else
                                            {1480}let pkSess_1916: bitstring = fail-any in
                                            {1481}out(c, GetEndpointRequest);
                                            {1482}in(c, (=GetEndpointResponse,=pkSess_1916,=None,SP_1917: bitstring,UP_1918: bitstring));
                                            {1483}new Nc_1919: bitstring;
                                            {1484}let gNc_1920: bitstring = exp(g,Nc_1919) in
                                            {1485}let m1_1921: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1920) in
                                            {1486}out(c, (pkCli_1749,m1_1921));
                                            {1487}in(c, em2_1922: bitstring);
                                            {1488}let m2_1923: bitstring = em2_1922 in
                                            {1489}let (=OpenSecureChannelResponse,PartS_1924: bitstring,ST_1925: bitstring,TTL_1926: bitstring) = m2_1923 in
                                            {1490}let Kcli_1927: bitstring = exp(PartS_1924,Nc_1919) in
                                            {1491}out(c, senc(mCli(pkCli_1749,pkSess_1916),Kcli_1927))
                                    )
                                    else
                                        {1492}let v_1928: bool = (Disco = C) in
                                        (
                                            {1493}if v_1928 then
                                            (
                                                {1494}let pkDisco_1929: bitstring = pub(skC) in
                                                {1495}let v_1930: bool = (Sess = A) in
                                                (
                                                    {1496}if v_1930 then
                                                    (
                                                        {1497}let pkSess_1931: bitstring = pub(skA) in
                                                        {1498}out(c, GetEndpointRequest);
                                                        {1499}in(c, (=GetEndpointResponse,=pkSess_1931,=None,SP_1932: bitstring,UP_1933: bitstring));
                                                        {1500}new Nc_1934: bitstring;
                                                        {1501}let gNc_1935: bitstring = exp(g,Nc_1934) in
                                                        {1502}let m1_1936: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1935) in
                                                        {1503}out(c, (pkCli_1749,m1_1936));
                                                        {1504}in(c, em2_1937: bitstring);
                                                        {1505}let m2_1938: bitstring = em2_1937 in
                                                        {1506}let (=OpenSecureChannelResponse,PartS_1939: bitstring,ST_1940: bitstring,TTL_1941: bitstring) = m2_1938 in
                                                        {1507}let Kcli_1942: bitstring = exp(PartS_1939,Nc_1934) in
                                                        {1508}out(c, senc(mCli(pkCli_1749,pkSess_1931),Kcli_1942))
                                                    )
                                                    else
                                                        {1509}let v_1943: bool = (Sess = B) in
                                                        (
                                                            {1510}if v_1943 then
                                                            (
                                                                {1511}let pkSess_1944: bitstring = pub(skB) in
                                                                {1512}out(c, GetEndpointRequest);
                                                                {1513}in(c, (=GetEndpointResponse,=pkSess_1944,=None,SP_1945: bitstring,UP_1946: bitstring));
                                                                {1514}new Nc_1947: bitstring;
                                                                {1515}let gNc_1948: bitstring = exp(g,Nc_1947) in
                                                                {1516}let m1_1949: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1948) in
                                                                {1517}out(c, (pkCli_1749,m1_1949));
                                                                {1518}in(c, em2_1950: bitstring);
                                                                {1519}let m2_1951: bitstring = em2_1950 in
                                                                {1520}let (=OpenSecureChannelResponse,PartS_1952: bitstring,ST_1953: bitstring,TTL_1954: bitstring) = m2_1951 in
                                                                {1521}let Kcli_1955: bitstring = exp(PartS_1952,Nc_1947) in
                                                                {1522}out(c, senc(mCli(pkCli_1749,pkSess_1944),Kcli_1955))
                                                            )
                                                            else
                                                                {1523}let v_1956: bool = (Sess = C) in
                                                                (
                                                                    {1524}if v_1956 then
                                                                    (
                                                                        {1525}let pkSess_1957: bitstring = pub(skC) in
                                                                        {1526}out(c, GetEndpointRequest);
                                                                        {1527}in(c, (=GetEndpointResponse,=pkSess_1957,=None,SP_1958: bitstring,UP_1959: bitstring));
                                                                        {1528}new Nc_1960: bitstring;
                                                                        {1529}let gNc_1961: bitstring = exp(g,Nc_1960) in
                                                                        {1530}let m1_1962: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1961) in
                                                                        {1531}out(c, (pkCli_1749,m1_1962));
                                                                        {1532}in(c, em2_1963: bitstring);
                                                                        {1533}let m2_1964: bitstring = em2_1963 in
                                                                        {1534}let (=OpenSecureChannelResponse,PartS_1965: bitstring,ST_1966: bitstring,TTL_1967: bitstring) = m2_1964 in
                                                                        {1535}let Kcli_1968: bitstring = exp(PartS_1965,Nc_1960) in
                                                                        {1536}out(c, senc(mCli(pkCli_1749,pkSess_1957),Kcli_1968))
                                                                    )
                                                                    else
                                                                        {1537}let pkSess_1969: bitstring = pub(sk(Sess)) in
                                                                        {1538}out(c, GetEndpointRequest);
                                                                        {1539}in(c, (=GetEndpointResponse,=pkSess_1969,=None,SP_1970: bitstring,UP_1971: bitstring));
                                                                        {1540}new Nc_1972: bitstring;
                                                                        {1541}let gNc_1973: bitstring = exp(g,Nc_1972) in
                                                                        {1542}let m1_1974: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1973) in
                                                                        {1543}out(c, (pkCli_1749,m1_1974));
                                                                        {1544}in(c, em2_1975: bitstring);
                                                                        {1545}let m2_1976: bitstring = em2_1975 in
                                                                        {1546}let (=OpenSecureChannelResponse,PartS_1977: bitstring,ST_1978: bitstring,TTL_1979: bitstring) = m2_1976 in
                                                                        {1547}let Kcli_1980: bitstring = exp(PartS_1977,Nc_1972) in
                                                                        {1548}out(c, senc(mCli(pkCli_1749,pkSess_1969),Kcli_1980))
                                                                )
                                                                else
                                                                    {1549}let pkSess_1981: bitstring = fail-any in
                                                                    {1550}out(c, GetEndpointRequest);
                                                                    {1551}in(c, (=GetEndpointResponse,=pkSess_1981,=None,SP_1982: bitstring,UP_1983: bitstring));
                                                                    {1552}new Nc_1984: bitstring;
                                                                    {1553}let gNc_1985: bitstring = exp(g,Nc_1984) in
                                                                    {1554}let m1_1986: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1985) in
                                                                    {1555}out(c, (pkCli_1749,m1_1986));
                                                                    {1556}in(c, em2_1987: bitstring);
                                                                    {1557}let m2_1988: bitstring = em2_1987 in
                                                                    {1558}let (=OpenSecureChannelResponse,PartS_1989: bitstring,ST_1990: bitstring,TTL_1991: bitstring) = m2_1988 in
                                                                    {1559}let Kcli_1992: bitstring = exp(PartS_1989,Nc_1984) in
                                                                    {1560}out(c, senc(mCli(pkCli_1749,pkSess_1981),Kcli_1992))
                                                        )
                                                        else
                                                            {1561}let pkSess_1993: bitstring = fail-any in
                                                            {1562}out(c, GetEndpointRequest);
                                                            {1563}in(c, (=GetEndpointResponse,=pkSess_1993,=None,SP_1994: bitstring,UP_1995: bitstring));
                                                            {1564}new Nc_1996: bitstring;
                                                            {1565}let gNc_1997: bitstring = exp(g,Nc_1996) in
                                                            {1566}let m1_1998: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1997) in
                                                            {1567}out(c, (pkCli_1749,m1_1998));
                                                            {1568}in(c, em2_1999: bitstring);
                                                            {1569}let m2_2000: bitstring = em2_1999 in
                                                            {1570}let (=OpenSecureChannelResponse,PartS_2001: bitstring,ST_2002: bitstring,TTL_2003: bitstring) = m2_2000 in
                                                            {1571}let Kcli_2004: bitstring = exp(PartS_2001,Nc_1996) in
                                                            {1572}out(c, senc(mCli(pkCli_1749,pkSess_1993),Kcli_2004))
                                                )
                                                else
                                                    {1573}let pkSess_2005: bitstring = fail-any in
                                                    {1574}out(c, GetEndpointRequest);
                                                    {1575}in(c, (=GetEndpointResponse,=pkSess_2005,=None,SP_2006: bitstring,UP_2007: bitstring));
                                                    {1576}new Nc_2008: bitstring;
                                                    {1577}let gNc_2009: bitstring = exp(g,Nc_2008) in
                                                    {1578}let m1_2010: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2009) in
                                                    {1579}out(c, (pkCli_1749,m1_2010));
                                                    {1580}in(c, em2_2011: bitstring);
                                                    {1581}let m2_2012: bitstring = em2_2011 in
                                                    {1582}let (=OpenSecureChannelResponse,PartS_2013: bitstring,ST_2014: bitstring,TTL_2015: bitstring) = m2_2012 in
                                                    {1583}let Kcli_2016: bitstring = exp(PartS_2013,Nc_2008) in
                                                    {1584}out(c, senc(mCli(pkCli_1749,pkSess_2005),Kcli_2016))
                                            )
                                            else
                                                {1585}let pkDisco_2017: bitstring = pub(sk(Disco)) in
                                                {1586}let v_2018: bool = (Sess = A) in
                                                (
                                                    {1587}if v_2018 then
                                                    (
                                                        {1588}let pkSess_2019: bitstring = pub(skA) in
                                                        {1589}out(c, GetEndpointRequest);
                                                        {1590}in(c, (=GetEndpointResponse,=pkSess_2019,=None,SP_2020: bitstring,UP_2021: bitstring));
                                                        {1591}new Nc_2022: bitstring;
                                                        {1592}let gNc_2023: bitstring = exp(g,Nc_2022) in
                                                        {1593}let m1_2024: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2023) in
                                                        {1594}out(c, (pkCli_1749,m1_2024));
                                                        {1595}in(c, em2_2025: bitstring);
                                                        {1596}let m2_2026: bitstring = em2_2025 in
                                                        {1597}let (=OpenSecureChannelResponse,PartS_2027: bitstring,ST_2028: bitstring,TTL_2029: bitstring) = m2_2026 in
                                                        {1598}let Kcli_2030: bitstring = exp(PartS_2027,Nc_2022) in
                                                        {1599}out(c, senc(mCli(pkCli_1749,pkSess_2019),Kcli_2030))
                                                    )
                                                    else
                                                        {1600}let v_2031: bool = (Sess = B) in
                                                        (
                                                            {1601}if v_2031 then
                                                            (
                                                                {1602}let pkSess_2032: bitstring = pub(skB) in
                                                                {1603}out(c, GetEndpointRequest);
                                                                {1604}in(c, (=GetEndpointResponse,=pkSess_2032,=None,SP_2033: bitstring,UP_2034: bitstring));
                                                                {1605}new Nc_2035: bitstring;
                                                                {1606}let gNc_2036: bitstring = exp(g,Nc_2035) in
                                                                {1607}let m1_2037: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2036) in
                                                                {1608}out(c, (pkCli_1749,m1_2037));
                                                                {1609}in(c, em2_2038: bitstring);
                                                                {1610}let m2_2039: bitstring = em2_2038 in
                                                                {1611}let (=OpenSecureChannelResponse,PartS_2040: bitstring,ST_2041: bitstring,TTL_2042: bitstring) = m2_2039 in
                                                                {1612}let Kcli_2043: bitstring = exp(PartS_2040,Nc_2035) in
                                                                {1613}out(c, senc(mCli(pkCli_1749,pkSess_2032),Kcli_2043))
                                                            )
                                                            else
                                                                {1614}let v_2044: bool = (Sess = C) in
                                                                (
                                                                    {1615}if v_2044 then
                                                                    (
                                                                        {1616}let pkSess_2045: bitstring = pub(skC) in
                                                                        {1617}out(c, GetEndpointRequest);
                                                                        {1618}in(c, (=GetEndpointResponse,=pkSess_2045,=None,SP_2046: bitstring,UP_2047: bitstring));
                                                                        {1619}new Nc_2048: bitstring;
                                                                        {1620}let gNc_2049: bitstring = exp(g,Nc_2048) in
                                                                        {1621}let m1_2050: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2049) in
                                                                        {1622}out(c, (pkCli_1749,m1_2050));
                                                                        {1623}in(c, em2_2051: bitstring);
                                                                        {1624}let m2_2052: bitstring = em2_2051 in
                                                                        {1625}let (=OpenSecureChannelResponse,PartS_2053: bitstring,ST_2054: bitstring,TTL_2055: bitstring) = m2_2052 in
                                                                        {1626}let Kcli_2056: bitstring = exp(PartS_2053,Nc_2048) in
                                                                        {1627}out(c, senc(mCli(pkCli_1749,pkSess_2045),Kcli_2056))
                                                                    )
                                                                    else
                                                                        {1628}let pkSess_2057: bitstring = pub(sk(Sess)) in
                                                                        {1629}out(c, GetEndpointRequest);
                                                                        {1630}in(c, (=GetEndpointResponse,=pkSess_2057,=None,SP_2058: bitstring,UP_2059: bitstring));
                                                                        {1631}new Nc_2060: bitstring;
                                                                        {1632}let gNc_2061: bitstring = exp(g,Nc_2060) in
                                                                        {1633}let m1_2062: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2061) in
                                                                        {1634}out(c, (pkCli_1749,m1_2062));
                                                                        {1635}in(c, em2_2063: bitstring);
                                                                        {1636}let m2_2064: bitstring = em2_2063 in
                                                                        {1637}let (=OpenSecureChannelResponse,PartS_2065: bitstring,ST_2066: bitstring,TTL_2067: bitstring) = m2_2064 in
                                                                        {1638}let Kcli_2068: bitstring = exp(PartS_2065,Nc_2060) in
                                                                        {1639}out(c, senc(mCli(pkCli_1749,pkSess_2057),Kcli_2068))
                                                                )
                                                                else
                                                                    {1640}let pkSess_2069: bitstring = fail-any in
                                                                    {1641}out(c, GetEndpointRequest);
                                                                    {1642}in(c, (=GetEndpointResponse,=pkSess_2069,=None,SP_2070: bitstring,UP_2071: bitstring));
                                                                    {1643}new Nc_2072: bitstring;
                                                                    {1644}let gNc_2073: bitstring = exp(g,Nc_2072) in
                                                                    {1645}let m1_2074: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2073) in
                                                                    {1646}out(c, (pkCli_1749,m1_2074));
                                                                    {1647}in(c, em2_2075: bitstring);
                                                                    {1648}let m2_2076: bitstring = em2_2075 in
                                                                    {1649}let (=OpenSecureChannelResponse,PartS_2077: bitstring,ST_2078: bitstring,TTL_2079: bitstring) = m2_2076 in
                                                                    {1650}let Kcli_2080: bitstring = exp(PartS_2077,Nc_2072) in
                                                                    {1651}out(c, senc(mCli(pkCli_1749,pkSess_2069),Kcli_2080))
                                                        )
                                                        else
                                                            {1652}let pkSess_2081: bitstring = fail-any in
                                                            {1653}out(c, GetEndpointRequest);
                                                            {1654}in(c, (=GetEndpointResponse,=pkSess_2081,=None,SP_2082: bitstring,UP_2083: bitstring));
                                                            {1655}new Nc_2084: bitstring;
                                                            {1656}let gNc_2085: bitstring = exp(g,Nc_2084) in
                                                            {1657}let m1_2086: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2085) in
                                                            {1658}out(c, (pkCli_1749,m1_2086));
                                                            {1659}in(c, em2_2087: bitstring);
                                                            {1660}let m2_2088: bitstring = em2_2087 in
                                                            {1661}let (=OpenSecureChannelResponse,PartS_2089: bitstring,ST_2090: bitstring,TTL_2091: bitstring) = m2_2088 in
                                                            {1662}let Kcli_2092: bitstring = exp(PartS_2089,Nc_2084) in
                                                            {1663}out(c, senc(mCli(pkCli_1749,pkSess_2081),Kcli_2092))
                                                )
                                                else
                                                    {1664}let pkSess_2093: bitstring = fail-any in
                                                    {1665}out(c, GetEndpointRequest);
                                                    {1666}in(c, (=GetEndpointResponse,=pkSess_2093,=None,SP_2094: bitstring,UP_2095: bitstring));
                                                    {1667}new Nc_2096: bitstring;
                                                    {1668}let gNc_2097: bitstring = exp(g,Nc_2096) in
                                                    {1669}let m1_2098: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2097) in
                                                    {1670}out(c, (pkCli_1749,m1_2098));
                                                    {1671}in(c, em2_2099: bitstring);
                                                    {1672}let m2_2100: bitstring = em2_2099 in
                                                    {1673}let (=OpenSecureChannelResponse,PartS_2101: bitstring,ST_2102: bitstring,TTL_2103: bitstring) = m2_2100 in
                                                    {1674}let Kcli_2104: bitstring = exp(PartS_2101,Nc_2096) in
                                                    {1675}out(c, senc(mCli(pkCli_1749,pkSess_2093),Kcli_2104))
                                        )
                                        else
                                            {1676}let pkDisco_2105: bitstring = fail-any in
                                            {1677}let v_2106: bool = (Sess = A) in
                                            (
                                                {1678}if v_2106 then
                                                (
                                                    {1679}let pkSess_2107: bitstring = pub(skA) in
                                                    {1680}out(c, GetEndpointRequest);
                                                    {1681}in(c, (=GetEndpointResponse,=pkSess_2107,=None,SP_2108: bitstring,UP_2109: bitstring));
                                                    {1682}new Nc_2110: bitstring;
                                                    {1683}let gNc_2111: bitstring = exp(g,Nc_2110) in
                                                    {1684}let m1_2112: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2111) in
                                                    {1685}out(c, (pkCli_1749,m1_2112));
                                                    {1686}in(c, em2_2113: bitstring);
                                                    {1687}let m2_2114: bitstring = em2_2113 in
                                                    {1688}let (=OpenSecureChannelResponse,PartS_2115: bitstring,ST_2116: bitstring,TTL_2117: bitstring) = m2_2114 in
                                                    {1689}let Kcli_2118: bitstring = exp(PartS_2115,Nc_2110) in
                                                    {1690}out(c, senc(mCli(pkCli_1749,pkSess_2107),Kcli_2118))
                                                )
                                                else
                                                    {1691}let v_2119: bool = (Sess = B) in
                                                    (
                                                        {1692}if v_2119 then
                                                        (
                                                            {1693}let pkSess_2120: bitstring = pub(skB) in
                                                            {1694}out(c, GetEndpointRequest);
                                                            {1695}in(c, (=GetEndpointResponse,=pkSess_2120,=None,SP_2121: bitstring,UP_2122: bitstring));
                                                            {1696}new Nc_2123: bitstring;
                                                            {1697}let gNc_2124: bitstring = exp(g,Nc_2123) in
                                                            {1698}let m1_2125: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2124) in
                                                            {1699}out(c, (pkCli_1749,m1_2125));
                                                            {1700}in(c, em2_2126: bitstring);
                                                            {1701}let m2_2127: bitstring = em2_2126 in
                                                            {1702}let (=OpenSecureChannelResponse,PartS_2128: bitstring,ST_2129: bitstring,TTL_2130: bitstring) = m2_2127 in
                                                            {1703}let Kcli_2131: bitstring = exp(PartS_2128,Nc_2123) in
                                                            {1704}out(c, senc(mCli(pkCli_1749,pkSess_2120),Kcli_2131))
                                                        )
                                                        else
                                                            {1705}let v_2132: bool = (Sess = C) in
                                                            (
                                                                {1706}if v_2132 then
                                                                (
                                                                    {1707}let pkSess_2133: bitstring = pub(skC) in
                                                                    {1708}out(c, GetEndpointRequest);
                                                                    {1709}in(c, (=GetEndpointResponse,=pkSess_2133,=None,SP_2134: bitstring,UP_2135: bitstring));
                                                                    {1710}new Nc_2136: bitstring;
                                                                    {1711}let gNc_2137: bitstring = exp(g,Nc_2136) in
                                                                    {1712}let m1_2138: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2137) in
                                                                    {1713}out(c, (pkCli_1749,m1_2138));
                                                                    {1714}in(c, em2_2139: bitstring);
                                                                    {1715}let m2_2140: bitstring = em2_2139 in
                                                                    {1716}let (=OpenSecureChannelResponse,PartS_2141: bitstring,ST_2142: bitstring,TTL_2143: bitstring) = m2_2140 in
                                                                    {1717}let Kcli_2144: bitstring = exp(PartS_2141,Nc_2136) in
                                                                    {1718}out(c, senc(mCli(pkCli_1749,pkSess_2133),Kcli_2144))
                                                                )
                                                                else
                                                                    {1719}let pkSess_2145: bitstring = pub(sk(Sess)) in
                                                                    {1720}out(c, GetEndpointRequest);
                                                                    {1721}in(c, (=GetEndpointResponse,=pkSess_2145,=None,SP_2146: bitstring,UP_2147: bitstring));
                                                                    {1722}new Nc_2148: bitstring;
                                                                    {1723}let gNc_2149: bitstring = exp(g,Nc_2148) in
                                                                    {1724}let m1_2150: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2149) in
                                                                    {1725}out(c, (pkCli_1749,m1_2150));
                                                                    {1726}in(c, em2_2151: bitstring);
                                                                    {1727}let m2_2152: bitstring = em2_2151 in
                                                                    {1728}let (=OpenSecureChannelResponse,PartS_2153: bitstring,ST_2154: bitstring,TTL_2155: bitstring) = m2_2152 in
                                                                    {1729}let Kcli_2156: bitstring = exp(PartS_2153,Nc_2148) in
                                                                    {1730}out(c, senc(mCli(pkCli_1749,pkSess_2145),Kcli_2156))
                                                            )
                                                            else
                                                                {1731}let pkSess_2157: bitstring = fail-any in
                                                                {1732}out(c, GetEndpointRequest);
                                                                {1733}in(c, (=GetEndpointResponse,=pkSess_2157,=None,SP_2158: bitstring,UP_2159: bitstring));
                                                                {1734}new Nc_2160: bitstring;
                                                                {1735}let gNc_2161: bitstring = exp(g,Nc_2160) in
                                                                {1736}let m1_2162: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2161) in
                                                                {1737}out(c, (pkCli_1749,m1_2162));
                                                                {1738}in(c, em2_2163: bitstring);
                                                                {1739}let m2_2164: bitstring = em2_2163 in
                                                                {1740}let (=OpenSecureChannelResponse,PartS_2165: bitstring,ST_2166: bitstring,TTL_2167: bitstring) = m2_2164 in
                                                                {1741}let Kcli_2168: bitstring = exp(PartS_2165,Nc_2160) in
                                                                {1742}out(c, senc(mCli(pkCli_1749,pkSess_2157),Kcli_2168))
                                                    )
                                                    else
                                                        {1743}let pkSess_2169: bitstring = fail-any in
                                                        {1744}out(c, GetEndpointRequest);
                                                        {1745}in(c, (=GetEndpointResponse,=pkSess_2169,=None,SP_2170: bitstring,UP_2171: bitstring));
                                                        {1746}new Nc_2172: bitstring;
                                                        {1747}let gNc_2173: bitstring = exp(g,Nc_2172) in
                                                        {1748}let m1_2174: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2173) in
                                                        {1749}out(c, (pkCli_1749,m1_2174));
                                                        {1750}in(c, em2_2175: bitstring);
                                                        {1751}let m2_2176: bitstring = em2_2175 in
                                                        {1752}let (=OpenSecureChannelResponse,PartS_2177: bitstring,ST_2178: bitstring,TTL_2179: bitstring) = m2_2176 in
                                                        {1753}let Kcli_2180: bitstring = exp(PartS_2177,Nc_2172) in
                                                        {1754}out(c, senc(mCli(pkCli_1749,pkSess_2169),Kcli_2180))
                                            )
                                            else
                                                {1755}let pkSess_2181: bitstring = fail-any in
                                                {1756}out(c, GetEndpointRequest);
                                                {1757}in(c, (=GetEndpointResponse,=pkSess_2181,=None,SP_2182: bitstring,UP_2183: bitstring));
                                                {1758}new Nc_2184: bitstring;
                                                {1759}let gNc_2185: bitstring = exp(g,Nc_2184) in
                                                {1760}let m1_2186: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2185) in
                                                {1761}out(c, (pkCli_1749,m1_2186));
                                                {1762}in(c, em2_2187: bitstring);
                                                {1763}let m2_2188: bitstring = em2_2187 in
                                                {1764}let (=OpenSecureChannelResponse,PartS_2189: bitstring,ST_2190: bitstring,TTL_2191: bitstring) = m2_2188 in
                                                {1765}let Kcli_2192: bitstring = exp(PartS_2189,Nc_2184) in
                                                {1766}out(c, senc(mCli(pkCli_1749,pkSess_2181),Kcli_2192))
                                )
                                else
                                    {1767}let pkDisco_2193: bitstring = fail-any in
                                    {1768}let v_2194: bool = (Sess = A) in
                                    (
                                        {1769}if v_2194 then
                                        (
                                            {1770}let pkSess_2195: bitstring = pub(skA) in
                                            {1771}out(c, GetEndpointRequest);
                                            {1772}in(c, (=GetEndpointResponse,=pkSess_2195,=None,SP_2196: bitstring,UP_2197: bitstring));
                                            {1773}new Nc_2198: bitstring;
                                            {1774}let gNc_2199: bitstring = exp(g,Nc_2198) in
                                            {1775}let m1_2200: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2199) in
                                            {1776}out(c, (pkCli_1749,m1_2200));
                                            {1777}in(c, em2_2201: bitstring);
                                            {1778}let m2_2202: bitstring = em2_2201 in
                                            {1779}let (=OpenSecureChannelResponse,PartS_2203: bitstring,ST_2204: bitstring,TTL_2205: bitstring) = m2_2202 in
                                            {1780}let Kcli_2206: bitstring = exp(PartS_2203,Nc_2198) in
                                            {1781}out(c, senc(mCli(pkCli_1749,pkSess_2195),Kcli_2206))
                                        )
                                        else
                                            {1782}let v_2207: bool = (Sess = B) in
                                            (
                                                {1783}if v_2207 then
                                                (
                                                    {1784}let pkSess_2208: bitstring = pub(skB) in
                                                    {1785}out(c, GetEndpointRequest);
                                                    {1786}in(c, (=GetEndpointResponse,=pkSess_2208,=None,SP_2209: bitstring,UP_2210: bitstring));
                                                    {1787}new Nc_2211: bitstring;
                                                    {1788}let gNc_2212: bitstring = exp(g,Nc_2211) in
                                                    {1789}let m1_2213: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2212) in
                                                    {1790}out(c, (pkCli_1749,m1_2213));
                                                    {1791}in(c, em2_2214: bitstring);
                                                    {1792}let m2_2215: bitstring = em2_2214 in
                                                    {1793}let (=OpenSecureChannelResponse,PartS_2216: bitstring,ST_2217: bitstring,TTL_2218: bitstring) = m2_2215 in
                                                    {1794}let Kcli_2219: bitstring = exp(PartS_2216,Nc_2211) in
                                                    {1795}out(c, senc(mCli(pkCli_1749,pkSess_2208),Kcli_2219))
                                                )
                                                else
                                                    {1796}let v_2220: bool = (Sess = C) in
                                                    (
                                                        {1797}if v_2220 then
                                                        (
                                                            {1798}let pkSess_2221: bitstring = pub(skC) in
                                                            {1799}out(c, GetEndpointRequest);
                                                            {1800}in(c, (=GetEndpointResponse,=pkSess_2221,=None,SP_2222: bitstring,UP_2223: bitstring));
                                                            {1801}new Nc_2224: bitstring;
                                                            {1802}let gNc_2225: bitstring = exp(g,Nc_2224) in
                                                            {1803}let m1_2226: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2225) in
                                                            {1804}out(c, (pkCli_1749,m1_2226));
                                                            {1805}in(c, em2_2227: bitstring);
                                                            {1806}let m2_2228: bitstring = em2_2227 in
                                                            {1807}let (=OpenSecureChannelResponse,PartS_2229: bitstring,ST_2230: bitstring,TTL_2231: bitstring) = m2_2228 in
                                                            {1808}let Kcli_2232: bitstring = exp(PartS_2229,Nc_2224) in
                                                            {1809}out(c, senc(mCli(pkCli_1749,pkSess_2221),Kcli_2232))
                                                        )
                                                        else
                                                            {1810}let pkSess_2233: bitstring = pub(sk(Sess)) in
                                                            {1811}out(c, GetEndpointRequest);
                                                            {1812}in(c, (=GetEndpointResponse,=pkSess_2233,=None,SP_2234: bitstring,UP_2235: bitstring));
                                                            {1813}new Nc_2236: bitstring;
                                                            {1814}let gNc_2237: bitstring = exp(g,Nc_2236) in
                                                            {1815}let m1_2238: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2237) in
                                                            {1816}out(c, (pkCli_1749,m1_2238));
                                                            {1817}in(c, em2_2239: bitstring);
                                                            {1818}let m2_2240: bitstring = em2_2239 in
                                                            {1819}let (=OpenSecureChannelResponse,PartS_2241: bitstring,ST_2242: bitstring,TTL_2243: bitstring) = m2_2240 in
                                                            {1820}let Kcli_2244: bitstring = exp(PartS_2241,Nc_2236) in
                                                            {1821}out(c, senc(mCli(pkCli_1749,pkSess_2233),Kcli_2244))
                                                    )
                                                    else
                                                        {1822}let pkSess_2245: bitstring = fail-any in
                                                        {1823}out(c, GetEndpointRequest);
                                                        {1824}in(c, (=GetEndpointResponse,=pkSess_2245,=None,SP_2246: bitstring,UP_2247: bitstring));
                                                        {1825}new Nc_2248: bitstring;
                                                        {1826}let gNc_2249: bitstring = exp(g,Nc_2248) in
                                                        {1827}let m1_2250: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2249) in
                                                        {1828}out(c, (pkCli_1749,m1_2250));
                                                        {1829}in(c, em2_2251: bitstring);
                                                        {1830}let m2_2252: bitstring = em2_2251 in
                                                        {1831}let (=OpenSecureChannelResponse,PartS_2253: bitstring,ST_2254: bitstring,TTL_2255: bitstring) = m2_2252 in
                                                        {1832}let Kcli_2256: bitstring = exp(PartS_2253,Nc_2248) in
                                                        {1833}out(c, senc(mCli(pkCli_1749,pkSess_2245),Kcli_2256))
                                            )
                                            else
                                                {1834}let pkSess_2257: bitstring = fail-any in
                                                {1835}out(c, GetEndpointRequest);
                                                {1836}in(c, (=GetEndpointResponse,=pkSess_2257,=None,SP_2258: bitstring,UP_2259: bitstring));
                                                {1837}new Nc_2260: bitstring;
                                                {1838}let gNc_2261: bitstring = exp(g,Nc_2260) in
                                                {1839}let m1_2262: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2261) in
                                                {1840}out(c, (pkCli_1749,m1_2262));
                                                {1841}in(c, em2_2263: bitstring);
                                                {1842}let m2_2264: bitstring = em2_2263 in
                                                {1843}let (=OpenSecureChannelResponse,PartS_2265: bitstring,ST_2266: bitstring,TTL_2267: bitstring) = m2_2264 in
                                                {1844}let Kcli_2268: bitstring = exp(PartS_2265,Nc_2260) in
                                                {1845}out(c, senc(mCli(pkCli_1749,pkSess_2257),Kcli_2268))
                                    )
                                    else
                                        {1846}let pkSess_2269: bitstring = fail-any in
                                        {1847}out(c, GetEndpointRequest);
                                        {1848}in(c, (=GetEndpointResponse,=pkSess_2269,=None,SP_2270: bitstring,UP_2271: bitstring));
                                        {1849}new Nc_2272: bitstring;
                                        {1850}let gNc_2273: bitstring = exp(g,Nc_2272) in
                                        {1851}let m1_2274: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2273) in
                                        {1852}out(c, (pkCli_1749,m1_2274));
                                        {1853}in(c, em2_2275: bitstring);
                                        {1854}let m2_2276: bitstring = em2_2275 in
                                        {1855}let (=OpenSecureChannelResponse,PartS_2277: bitstring,ST_2278: bitstring,TTL_2279: bitstring) = m2_2276 in
                                        {1856}let Kcli_2280: bitstring = exp(PartS_2277,Nc_2272) in
                                        {1857}out(c, senc(mCli(pkCli_1749,pkSess_2269),Kcli_2280))
                        )
                        else
                            {1858}let pkDisco_2281: bitstring = fail-any in
                            {1859}let v_2282: bool = (Sess = A) in
                            (
                                {1860}if v_2282 then
                                (
                                    {1861}let pkSess_2283: bitstring = pub(skA) in
                                    {1862}out(c, GetEndpointRequest);
                                    {1863}in(c, (=GetEndpointResponse,=pkSess_2283,=None,SP_2284: bitstring,UP_2285: bitstring));
                                    {1864}new Nc_2286: bitstring;
                                    {1865}let gNc_2287: bitstring = exp(g,Nc_2286) in
                                    {1866}let m1_2288: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2287) in
                                    {1867}out(c, (pkCli_1749,m1_2288));
                                    {1868}in(c, em2_2289: bitstring);
                                    {1869}let m2_2290: bitstring = em2_2289 in
                                    {1870}let (=OpenSecureChannelResponse,PartS_2291: bitstring,ST_2292: bitstring,TTL_2293: bitstring) = m2_2290 in
                                    {1871}let Kcli_2294: bitstring = exp(PartS_2291,Nc_2286) in
                                    {1872}out(c, senc(mCli(pkCli_1749,pkSess_2283),Kcli_2294))
                                )
                                else
                                    {1873}let v_2295: bool = (Sess = B) in
                                    (
                                        {1874}if v_2295 then
                                        (
                                            {1875}let pkSess_2296: bitstring = pub(skB) in
                                            {1876}out(c, GetEndpointRequest);
                                            {1877}in(c, (=GetEndpointResponse,=pkSess_2296,=None,SP_2297: bitstring,UP_2298: bitstring));
                                            {1878}new Nc_2299: bitstring;
                                            {1879}let gNc_2300: bitstring = exp(g,Nc_2299) in
                                            {1880}let m1_2301: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2300) in
                                            {1881}out(c, (pkCli_1749,m1_2301));
                                            {1882}in(c, em2_2302: bitstring);
                                            {1883}let m2_2303: bitstring = em2_2302 in
                                            {1884}let (=OpenSecureChannelResponse,PartS_2304: bitstring,ST_2305: bitstring,TTL_2306: bitstring) = m2_2303 in
                                            {1885}let Kcli_2307: bitstring = exp(PartS_2304,Nc_2299) in
                                            {1886}out(c, senc(mCli(pkCli_1749,pkSess_2296),Kcli_2307))
                                        )
                                        else
                                            {1887}let v_2308: bool = (Sess = C) in
                                            (
                                                {1888}if v_2308 then
                                                (
                                                    {1889}let pkSess_2309: bitstring = pub(skC) in
                                                    {1890}out(c, GetEndpointRequest);
                                                    {1891}in(c, (=GetEndpointResponse,=pkSess_2309,=None,SP_2310: bitstring,UP_2311: bitstring));
                                                    {1892}new Nc_2312: bitstring;
                                                    {1893}let gNc_2313: bitstring = exp(g,Nc_2312) in
                                                    {1894}let m1_2314: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2313) in
                                                    {1895}out(c, (pkCli_1749,m1_2314));
                                                    {1896}in(c, em2_2315: bitstring);
                                                    {1897}let m2_2316: bitstring = em2_2315 in
                                                    {1898}let (=OpenSecureChannelResponse,PartS_2317: bitstring,ST_2318: bitstring,TTL_2319: bitstring) = m2_2316 in
                                                    {1899}let Kcli_2320: bitstring = exp(PartS_2317,Nc_2312) in
                                                    {1900}out(c, senc(mCli(pkCli_1749,pkSess_2309),Kcli_2320))
                                                )
                                                else
                                                    {1901}let pkSess_2321: bitstring = pub(sk(Sess)) in
                                                    {1902}out(c, GetEndpointRequest);
                                                    {1903}in(c, (=GetEndpointResponse,=pkSess_2321,=None,SP_2322: bitstring,UP_2323: bitstring));
                                                    {1904}new Nc_2324: bitstring;
                                                    {1905}let gNc_2325: bitstring = exp(g,Nc_2324) in
                                                    {1906}let m1_2326: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2325) in
                                                    {1907}out(c, (pkCli_1749,m1_2326));
                                                    {1908}in(c, em2_2327: bitstring);
                                                    {1909}let m2_2328: bitstring = em2_2327 in
                                                    {1910}let (=OpenSecureChannelResponse,PartS_2329: bitstring,ST_2330: bitstring,TTL_2331: bitstring) = m2_2328 in
                                                    {1911}let Kcli_2332: bitstring = exp(PartS_2329,Nc_2324) in
                                                    {1912}out(c, senc(mCli(pkCli_1749,pkSess_2321),Kcli_2332))
                                            )
                                            else
                                                {1913}let pkSess_2333: bitstring = fail-any in
                                                {1914}out(c, GetEndpointRequest);
                                                {1915}in(c, (=GetEndpointResponse,=pkSess_2333,=None,SP_2334: bitstring,UP_2335: bitstring));
                                                {1916}new Nc_2336: bitstring;
                                                {1917}let gNc_2337: bitstring = exp(g,Nc_2336) in
                                                {1918}let m1_2338: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2337) in
                                                {1919}out(c, (pkCli_1749,m1_2338));
                                                {1920}in(c, em2_2339: bitstring);
                                                {1921}let m2_2340: bitstring = em2_2339 in
                                                {1922}let (=OpenSecureChannelResponse,PartS_2341: bitstring,ST_2342: bitstring,TTL_2343: bitstring) = m2_2340 in
                                                {1923}let Kcli_2344: bitstring = exp(PartS_2341,Nc_2336) in
                                                {1924}out(c, senc(mCli(pkCli_1749,pkSess_2333),Kcli_2344))
                                    )
                                    else
                                        {1925}let pkSess_2345: bitstring = fail-any in
                                        {1926}out(c, GetEndpointRequest);
                                        {1927}in(c, (=GetEndpointResponse,=pkSess_2345,=None,SP_2346: bitstring,UP_2347: bitstring));
                                        {1928}new Nc_2348: bitstring;
                                        {1929}let gNc_2349: bitstring = exp(g,Nc_2348) in
                                        {1930}let m1_2350: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2349) in
                                        {1931}out(c, (pkCli_1749,m1_2350));
                                        {1932}in(c, em2_2351: bitstring);
                                        {1933}let m2_2352: bitstring = em2_2351 in
                                        {1934}let (=OpenSecureChannelResponse,PartS_2353: bitstring,ST_2354: bitstring,TTL_2355: bitstring) = m2_2352 in
                                        {1935}let Kcli_2356: bitstring = exp(PartS_2353,Nc_2348) in
                                        {1936}out(c, senc(mCli(pkCli_1749,pkSess_2345),Kcli_2356))
                            )
                            else
                                {1937}let pkSess_2357: bitstring = fail-any in
                                {1938}out(c, GetEndpointRequest);
                                {1939}in(c, (=GetEndpointResponse,=pkSess_2357,=None,SP_2358: bitstring,UP_2359: bitstring));
                                {1940}new Nc_2360: bitstring;
                                {1941}let gNc_2361: bitstring = exp(g,Nc_2360) in
                                {1942}let m1_2362: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2361) in
                                {1943}out(c, (pkCli_1749,m1_2362));
                                {1944}in(c, em2_2363: bitstring);
                                {1945}let m2_2364: bitstring = em2_2363 in
                                {1946}let (=OpenSecureChannelResponse,PartS_2365: bitstring,ST_2366: bitstring,TTL_2367: bitstring) = m2_2364 in
                                {1947}let Kcli_2368: bitstring = exp(PartS_2365,Nc_2360) in
                                {1948}out(c, senc(mCli(pkCli_1749,pkSess_2357),Kcli_2368))
                    )
                    else
                        {1949}let skCli_2369: bitstring = fail-any in
                        {1950}let pkCli_2370: bitstring = pub(skCli_2369) in
                        {1951}let v_2371: bool = (Disco = A) in
                        (
                            {1952}if v_2371 then
                            (
                                {1953}let pkDisco_2372: bitstring = pub(skA) in
                                {1954}let v_2373: bool = (Sess = A) in
                                (
                                    {1955}if v_2373 then
                                    (
                                        {1956}let pkSess_2374: bitstring = pub(skA) in
                                        {1957}out(c, GetEndpointRequest);
                                        {1958}in(c, (=GetEndpointResponse,=pkSess_2374,=None,SP_2375: bitstring,UP_2376: bitstring));
                                        {1959}new Nc_2377: bitstring;
                                        {1960}let gNc_2378: bitstring = exp(g,Nc_2377) in
                                        {1961}let m1_2379: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2378) in
                                        {1962}out(c, (pkCli_2370,m1_2379));
                                        {1963}in(c, em2_2380: bitstring);
                                        {1964}let m2_2381: bitstring = em2_2380 in
                                        {1965}let (=OpenSecureChannelResponse,PartS_2382: bitstring,ST_2383: bitstring,TTL_2384: bitstring) = m2_2381 in
                                        {1966}let Kcli_2385: bitstring = exp(PartS_2382,Nc_2377) in
                                        {1967}out(c, senc(mCli(pkCli_2370,pkSess_2374),Kcli_2385))
                                    )
                                    else
                                        {1968}let v_2386: bool = (Sess = B) in
                                        (
                                            {1969}if v_2386 then
                                            (
                                                {1970}let pkSess_2387: bitstring = pub(skB) in
                                                {1971}out(c, GetEndpointRequest);
                                                {1972}in(c, (=GetEndpointResponse,=pkSess_2387,=None,SP_2388: bitstring,UP_2389: bitstring));
                                                {1973}new Nc_2390: bitstring;
                                                {1974}let gNc_2391: bitstring = exp(g,Nc_2390) in
                                                {1975}let m1_2392: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2391) in
                                                {1976}out(c, (pkCli_2370,m1_2392));
                                                {1977}in(c, em2_2393: bitstring);
                                                {1978}let m2_2394: bitstring = em2_2393 in
                                                {1979}let (=OpenSecureChannelResponse,PartS_2395: bitstring,ST_2396: bitstring,TTL_2397: bitstring) = m2_2394 in
                                                {1980}let Kcli_2398: bitstring = exp(PartS_2395,Nc_2390) in
                                                {1981}out(c, senc(mCli(pkCli_2370,pkSess_2387),Kcli_2398))
                                            )
                                            else
                                                {1982}let v_2399: bool = (Sess = C) in
                                                (
                                                    {1983}if v_2399 then
                                                    (
                                                        {1984}let pkSess_2400: bitstring = pub(skC) in
                                                        {1985}out(c, GetEndpointRequest);
                                                        {1986}in(c, (=GetEndpointResponse,=pkSess_2400,=None,SP_2401: bitstring,UP_2402: bitstring));
                                                        {1987}new Nc_2403: bitstring;
                                                        {1988}let gNc_2404: bitstring = exp(g,Nc_2403) in
                                                        {1989}let m1_2405: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2404) in
                                                        {1990}out(c, (pkCli_2370,m1_2405));
                                                        {1991}in(c, em2_2406: bitstring);
                                                        {1992}let m2_2407: bitstring = em2_2406 in
                                                        {1993}let (=OpenSecureChannelResponse,PartS_2408: bitstring,ST_2409: bitstring,TTL_2410: bitstring) = m2_2407 in
                                                        {1994}let Kcli_2411: bitstring = exp(PartS_2408,Nc_2403) in
                                                        {1995}out(c, senc(mCli(pkCli_2370,pkSess_2400),Kcli_2411))
                                                    )
                                                    else
                                                        {1996}let pkSess_2412: bitstring = pub(sk(Sess)) in
                                                        {1997}out(c, GetEndpointRequest);
                                                        {1998}in(c, (=GetEndpointResponse,=pkSess_2412,=None,SP_2413: bitstring,UP_2414: bitstring));
                                                        {1999}new Nc_2415: bitstring;
                                                        {2000}let gNc_2416: bitstring = exp(g,Nc_2415) in
                                                        {2001}let m1_2417: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2416) in
                                                        {2002}out(c, (pkCli_2370,m1_2417));
                                                        {2003}in(c, em2_2418: bitstring);
                                                        {2004}let m2_2419: bitstring = em2_2418 in
                                                        {2005}let (=OpenSecureChannelResponse,PartS_2420: bitstring,ST_2421: bitstring,TTL_2422: bitstring) = m2_2419 in
                                                        {2006}let Kcli_2423: bitstring = exp(PartS_2420,Nc_2415) in
                                                        {2007}out(c, senc(mCli(pkCli_2370,pkSess_2412),Kcli_2423))
                                                )
                                                else
                                                    {2008}let pkSess_2424: bitstring = fail-any in
                                                    {2009}out(c, GetEndpointRequest);
                                                    {2010}in(c, (=GetEndpointResponse,=pkSess_2424,=None,SP_2425: bitstring,UP_2426: bitstring));
                                                    {2011}new Nc_2427: bitstring;
                                                    {2012}let gNc_2428: bitstring = exp(g,Nc_2427) in
                                                    {2013}let m1_2429: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2428) in
                                                    {2014}out(c, (pkCli_2370,m1_2429));
                                                    {2015}in(c, em2_2430: bitstring);
                                                    {2016}let m2_2431: bitstring = em2_2430 in
                                                    {2017}let (=OpenSecureChannelResponse,PartS_2432: bitstring,ST_2433: bitstring,TTL_2434: bitstring) = m2_2431 in
                                                    {2018}let Kcli_2435: bitstring = exp(PartS_2432,Nc_2427) in
                                                    {2019}out(c, senc(mCli(pkCli_2370,pkSess_2424),Kcli_2435))
                                        )
                                        else
                                            {2020}let pkSess_2436: bitstring = fail-any in
                                            {2021}out(c, GetEndpointRequest);
                                            {2022}in(c, (=GetEndpointResponse,=pkSess_2436,=None,SP_2437: bitstring,UP_2438: bitstring));
                                            {2023}new Nc_2439: bitstring;
                                            {2024}let gNc_2440: bitstring = exp(g,Nc_2439) in
                                            {2025}let m1_2441: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2440) in
                                            {2026}out(c, (pkCli_2370,m1_2441));
                                            {2027}in(c, em2_2442: bitstring);
                                            {2028}let m2_2443: bitstring = em2_2442 in
                                            {2029}let (=OpenSecureChannelResponse,PartS_2444: bitstring,ST_2445: bitstring,TTL_2446: bitstring) = m2_2443 in
                                            {2030}let Kcli_2447: bitstring = exp(PartS_2444,Nc_2439) in
                                            {2031}out(c, senc(mCli(pkCli_2370,pkSess_2436),Kcli_2447))
                                )
                                else
                                    {2032}let pkSess_2448: bitstring = fail-any in
                                    {2033}out(c, GetEndpointRequest);
                                    {2034}in(c, (=GetEndpointResponse,=pkSess_2448,=None,SP_2449: bitstring,UP_2450: bitstring));
                                    {2035}new Nc_2451: bitstring;
                                    {2036}let gNc_2452: bitstring = exp(g,Nc_2451) in
                                    {2037}let m1_2453: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2452) in
                                    {2038}out(c, (pkCli_2370,m1_2453));
                                    {2039}in(c, em2_2454: bitstring);
                                    {2040}let m2_2455: bitstring = em2_2454 in
                                    {2041}let (=OpenSecureChannelResponse,PartS_2456: bitstring,ST_2457: bitstring,TTL_2458: bitstring) = m2_2455 in
                                    {2042}let Kcli_2459: bitstring = exp(PartS_2456,Nc_2451) in
                                    {2043}out(c, senc(mCli(pkCli_2370,pkSess_2448),Kcli_2459))
                            )
                            else
                                {2044}let v_2460: bool = (Disco = B) in
                                (
                                    {2045}if v_2460 then
                                    (
                                        {2046}let pkDisco_2461: bitstring = pub(skB) in
                                        {2047}let v_2462: bool = (Sess = A) in
                                        (
                                            {2048}if v_2462 then
                                            (
                                                {2049}let pkSess_2463: bitstring = pub(skA) in
                                                {2050}out(c, GetEndpointRequest);
                                                {2051}in(c, (=GetEndpointResponse,=pkSess_2463,=None,SP_2464: bitstring,UP_2465: bitstring));
                                                {2052}new Nc_2466: bitstring;
                                                {2053}let gNc_2467: bitstring = exp(g,Nc_2466) in
                                                {2054}let m1_2468: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2467) in
                                                {2055}out(c, (pkCli_2370,m1_2468));
                                                {2056}in(c, em2_2469: bitstring);
                                                {2057}let m2_2470: bitstring = em2_2469 in
                                                {2058}let (=OpenSecureChannelResponse,PartS_2471: bitstring,ST_2472: bitstring,TTL_2473: bitstring) = m2_2470 in
                                                {2059}let Kcli_2474: bitstring = exp(PartS_2471,Nc_2466) in
                                                {2060}out(c, senc(mCli(pkCli_2370,pkSess_2463),Kcli_2474))
                                            )
                                            else
                                                {2061}let v_2475: bool = (Sess = B) in
                                                (
                                                    {2062}if v_2475 then
                                                    (
                                                        {2063}let pkSess_2476: bitstring = pub(skB) in
                                                        {2064}out(c, GetEndpointRequest);
                                                        {2065}in(c, (=GetEndpointResponse,=pkSess_2476,=None,SP_2477: bitstring,UP_2478: bitstring));
                                                        {2066}new Nc_2479: bitstring;
                                                        {2067}let gNc_2480: bitstring = exp(g,Nc_2479) in
                                                        {2068}let m1_2481: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2480) in
                                                        {2069}out(c, (pkCli_2370,m1_2481));
                                                        {2070}in(c, em2_2482: bitstring);
                                                        {2071}let m2_2483: bitstring = em2_2482 in
                                                        {2072}let (=OpenSecureChannelResponse,PartS_2484: bitstring,ST_2485: bitstring,TTL_2486: bitstring) = m2_2483 in
                                                        {2073}let Kcli_2487: bitstring = exp(PartS_2484,Nc_2479) in
                                                        {2074}out(c, senc(mCli(pkCli_2370,pkSess_2476),Kcli_2487))
                                                    )
                                                    else
                                                        {2075}let v_2488: bool = (Sess = C) in
                                                        (
                                                            {2076}if v_2488 then
                                                            (
                                                                {2077}let pkSess_2489: bitstring = pub(skC) in
                                                                {2078}out(c, GetEndpointRequest);
                                                                {2079}in(c, (=GetEndpointResponse,=pkSess_2489,=None,SP_2490: bitstring,UP_2491: bitstring));
                                                                {2080}new Nc_2492: bitstring;
                                                                {2081}let gNc_2493: bitstring = exp(g,Nc_2492) in
                                                                {2082}let m1_2494: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2493) in
                                                                {2083}out(c, (pkCli_2370,m1_2494));
                                                                {2084}in(c, em2_2495: bitstring);
                                                                {2085}let m2_2496: bitstring = em2_2495 in
                                                                {2086}let (=OpenSecureChannelResponse,PartS_2497: bitstring,ST_2498: bitstring,TTL_2499: bitstring) = m2_2496 in
                                                                {2087}let Kcli_2500: bitstring = exp(PartS_2497,Nc_2492) in
                                                                {2088}out(c, senc(mCli(pkCli_2370,pkSess_2489),Kcli_2500))
                                                            )
                                                            else
                                                                {2089}let pkSess_2501: bitstring = pub(sk(Sess)) in
                                                                {2090}out(c, GetEndpointRequest);
                                                                {2091}in(c, (=GetEndpointResponse,=pkSess_2501,=None,SP_2502: bitstring,UP_2503: bitstring));
                                                                {2092}new Nc_2504: bitstring;
                                                                {2093}let gNc_2505: bitstring = exp(g,Nc_2504) in
                                                                {2094}let m1_2506: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2505) in
                                                                {2095}out(c, (pkCli_2370,m1_2506));
                                                                {2096}in(c, em2_2507: bitstring);
                                                                {2097}let m2_2508: bitstring = em2_2507 in
                                                                {2098}let (=OpenSecureChannelResponse,PartS_2509: bitstring,ST_2510: bitstring,TTL_2511: bitstring) = m2_2508 in
                                                                {2099}let Kcli_2512: bitstring = exp(PartS_2509,Nc_2504) in
                                                                {2100}out(c, senc(mCli(pkCli_2370,pkSess_2501),Kcli_2512))
                                                        )
                                                        else
                                                            {2101}let pkSess_2513: bitstring = fail-any in
                                                            {2102}out(c, GetEndpointRequest);
                                                            {2103}in(c, (=GetEndpointResponse,=pkSess_2513,=None,SP_2514: bitstring,UP_2515: bitstring));
                                                            {2104}new Nc_2516: bitstring;
                                                            {2105}let gNc_2517: bitstring = exp(g,Nc_2516) in
                                                            {2106}let m1_2518: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2517) in
                                                            {2107}out(c, (pkCli_2370,m1_2518));
                                                            {2108}in(c, em2_2519: bitstring);
                                                            {2109}let m2_2520: bitstring = em2_2519 in
                                                            {2110}let (=OpenSecureChannelResponse,PartS_2521: bitstring,ST_2522: bitstring,TTL_2523: bitstring) = m2_2520 in
                                                            {2111}let Kcli_2524: bitstring = exp(PartS_2521,Nc_2516) in
                                                            {2112}out(c, senc(mCli(pkCli_2370,pkSess_2513),Kcli_2524))
                                                )
                                                else
                                                    {2113}let pkSess_2525: bitstring = fail-any in
                                                    {2114}out(c, GetEndpointRequest);
                                                    {2115}in(c, (=GetEndpointResponse,=pkSess_2525,=None,SP_2526: bitstring,UP_2527: bitstring));
                                                    {2116}new Nc_2528: bitstring;
                                                    {2117}let gNc_2529: bitstring = exp(g,Nc_2528) in
                                                    {2118}let m1_2530: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2529) in
                                                    {2119}out(c, (pkCli_2370,m1_2530));
                                                    {2120}in(c, em2_2531: bitstring);
                                                    {2121}let m2_2532: bitstring = em2_2531 in
                                                    {2122}let (=OpenSecureChannelResponse,PartS_2533: bitstring,ST_2534: bitstring,TTL_2535: bitstring) = m2_2532 in
                                                    {2123}let Kcli_2536: bitstring = exp(PartS_2533,Nc_2528) in
                                                    {2124}out(c, senc(mCli(pkCli_2370,pkSess_2525),Kcli_2536))
                                        )
                                        else
                                            {2125}let pkSess_2537: bitstring = fail-any in
                                            {2126}out(c, GetEndpointRequest);
                                            {2127}in(c, (=GetEndpointResponse,=pkSess_2537,=None,SP_2538: bitstring,UP_2539: bitstring));
                                            {2128}new Nc_2540: bitstring;
                                            {2129}let gNc_2541: bitstring = exp(g,Nc_2540) in
                                            {2130}let m1_2542: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2541) in
                                            {2131}out(c, (pkCli_2370,m1_2542));
                                            {2132}in(c, em2_2543: bitstring);
                                            {2133}let m2_2544: bitstring = em2_2543 in
                                            {2134}let (=OpenSecureChannelResponse,PartS_2545: bitstring,ST_2546: bitstring,TTL_2547: bitstring) = m2_2544 in
                                            {2135}let Kcli_2548: bitstring = exp(PartS_2545,Nc_2540) in
                                            {2136}out(c, senc(mCli(pkCli_2370,pkSess_2537),Kcli_2548))
                                    )
                                    else
                                        {2137}let v_2549: bool = (Disco = C) in
                                        (
                                            {2138}if v_2549 then
                                            (
                                                {2139}let pkDisco_2550: bitstring = pub(skC) in
                                                {2140}let v_2551: bool = (Sess = A) in
                                                (
                                                    {2141}if v_2551 then
                                                    (
                                                        {2142}let pkSess_2552: bitstring = pub(skA) in
                                                        {2143}out(c, GetEndpointRequest);
                                                        {2144}in(c, (=GetEndpointResponse,=pkSess_2552,=None,SP_2553: bitstring,UP_2554: bitstring));
                                                        {2145}new Nc_2555: bitstring;
                                                        {2146}let gNc_2556: bitstring = exp(g,Nc_2555) in
                                                        {2147}let m1_2557: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2556) in
                                                        {2148}out(c, (pkCli_2370,m1_2557));
                                                        {2149}in(c, em2_2558: bitstring);
                                                        {2150}let m2_2559: bitstring = em2_2558 in
                                                        {2151}let (=OpenSecureChannelResponse,PartS_2560: bitstring,ST_2561: bitstring,TTL_2562: bitstring) = m2_2559 in
                                                        {2152}let Kcli_2563: bitstring = exp(PartS_2560,Nc_2555) in
                                                        {2153}out(c, senc(mCli(pkCli_2370,pkSess_2552),Kcli_2563))
                                                    )
                                                    else
                                                        {2154}let v_2564: bool = (Sess = B) in
                                                        (
                                                            {2155}if v_2564 then
                                                            (
                                                                {2156}let pkSess_2565: bitstring = pub(skB) in
                                                                {2157}out(c, GetEndpointRequest);
                                                                {2158}in(c, (=GetEndpointResponse,=pkSess_2565,=None,SP_2566: bitstring,UP_2567: bitstring));
                                                                {2159}new Nc_2568: bitstring;
                                                                {2160}let gNc_2569: bitstring = exp(g,Nc_2568) in
                                                                {2161}let m1_2570: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2569) in
                                                                {2162}out(c, (pkCli_2370,m1_2570));
                                                                {2163}in(c, em2_2571: bitstring);
                                                                {2164}let m2_2572: bitstring = em2_2571 in
                                                                {2165}let (=OpenSecureChannelResponse,PartS_2573: bitstring,ST_2574: bitstring,TTL_2575: bitstring) = m2_2572 in
                                                                {2166}let Kcli_2576: bitstring = exp(PartS_2573,Nc_2568) in
                                                                {2167}out(c, senc(mCli(pkCli_2370,pkSess_2565),Kcli_2576))
                                                            )
                                                            else
                                                                {2168}let v_2577: bool = (Sess = C) in
                                                                (
                                                                    {2169}if v_2577 then
                                                                    (
                                                                        {2170}let pkSess_2578: bitstring = pub(skC) in
                                                                        {2171}out(c, GetEndpointRequest);
                                                                        {2172}in(c, (=GetEndpointResponse,=pkSess_2578,=None,SP_2579: bitstring,UP_2580: bitstring));
                                                                        {2173}new Nc_2581: bitstring;
                                                                        {2174}let gNc_2582: bitstring = exp(g,Nc_2581) in
                                                                        {2175}let m1_2583: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2582) in
                                                                        {2176}out(c, (pkCli_2370,m1_2583));
                                                                        {2177}in(c, em2_2584: bitstring);
                                                                        {2178}let m2_2585: bitstring = em2_2584 in
                                                                        {2179}let (=OpenSecureChannelResponse,PartS_2586: bitstring,ST_2587: bitstring,TTL_2588: bitstring) = m2_2585 in
                                                                        {2180}let Kcli_2589: bitstring = exp(PartS_2586,Nc_2581) in
                                                                        {2181}out(c, senc(mCli(pkCli_2370,pkSess_2578),Kcli_2589))
                                                                    )
                                                                    else
                                                                        {2182}let pkSess_2590: bitstring = pub(sk(Sess)) in
                                                                        {2183}out(c, GetEndpointRequest);
                                                                        {2184}in(c, (=GetEndpointResponse,=pkSess_2590,=None,SP_2591: bitstring,UP_2592: bitstring));
                                                                        {2185}new Nc_2593: bitstring;
                                                                        {2186}let gNc_2594: bitstring = exp(g,Nc_2593) in
                                                                        {2187}let m1_2595: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2594) in
                                                                        {2188}out(c, (pkCli_2370,m1_2595));
                                                                        {2189}in(c, em2_2596: bitstring);
                                                                        {2190}let m2_2597: bitstring = em2_2596 in
                                                                        {2191}let (=OpenSecureChannelResponse,PartS_2598: bitstring,ST_2599: bitstring,TTL_2600: bitstring) = m2_2597 in
                                                                        {2192}let Kcli_2601: bitstring = exp(PartS_2598,Nc_2593) in
                                                                        {2193}out(c, senc(mCli(pkCli_2370,pkSess_2590),Kcli_2601))
                                                                )
                                                                else
                                                                    {2194}let pkSess_2602: bitstring = fail-any in
                                                                    {2195}out(c, GetEndpointRequest);
                                                                    {2196}in(c, (=GetEndpointResponse,=pkSess_2602,=None,SP_2603: bitstring,UP_2604: bitstring));
                                                                    {2197}new Nc_2605: bitstring;
                                                                    {2198}let gNc_2606: bitstring = exp(g,Nc_2605) in
                                                                    {2199}let m1_2607: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2606) in
                                                                    {2200}out(c, (pkCli_2370,m1_2607));
                                                                    {2201}in(c, em2_2608: bitstring);
                                                                    {2202}let m2_2609: bitstring = em2_2608 in
                                                                    {2203}let (=OpenSecureChannelResponse,PartS_2610: bitstring,ST_2611: bitstring,TTL_2612: bitstring) = m2_2609 in
                                                                    {2204}let Kcli_2613: bitstring = exp(PartS_2610,Nc_2605) in
                                                                    {2205}out(c, senc(mCli(pkCli_2370,pkSess_2602),Kcli_2613))
                                                        )
                                                        else
                                                            {2206}let pkSess_2614: bitstring = fail-any in
                                                            {2207}out(c, GetEndpointRequest);
                                                            {2208}in(c, (=GetEndpointResponse,=pkSess_2614,=None,SP_2615: bitstring,UP_2616: bitstring));
                                                            {2209}new Nc_2617: bitstring;
                                                            {2210}let gNc_2618: bitstring = exp(g,Nc_2617) in
                                                            {2211}let m1_2619: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2618) in
                                                            {2212}out(c, (pkCli_2370,m1_2619));
                                                            {2213}in(c, em2_2620: bitstring);
                                                            {2214}let m2_2621: bitstring = em2_2620 in
                                                            {2215}let (=OpenSecureChannelResponse,PartS_2622: bitstring,ST_2623: bitstring,TTL_2624: bitstring) = m2_2621 in
                                                            {2216}let Kcli_2625: bitstring = exp(PartS_2622,Nc_2617) in
                                                            {2217}out(c, senc(mCli(pkCli_2370,pkSess_2614),Kcli_2625))
                                                )
                                                else
                                                    {2218}let pkSess_2626: bitstring = fail-any in
                                                    {2219}out(c, GetEndpointRequest);
                                                    {2220}in(c, (=GetEndpointResponse,=pkSess_2626,=None,SP_2627: bitstring,UP_2628: bitstring));
                                                    {2221}new Nc_2629: bitstring;
                                                    {2222}let gNc_2630: bitstring = exp(g,Nc_2629) in
                                                    {2223}let m1_2631: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2630) in
                                                    {2224}out(c, (pkCli_2370,m1_2631));
                                                    {2225}in(c, em2_2632: bitstring);
                                                    {2226}let m2_2633: bitstring = em2_2632 in
                                                    {2227}let (=OpenSecureChannelResponse,PartS_2634: bitstring,ST_2635: bitstring,TTL_2636: bitstring) = m2_2633 in
                                                    {2228}let Kcli_2637: bitstring = exp(PartS_2634,Nc_2629) in
                                                    {2229}out(c, senc(mCli(pkCli_2370,pkSess_2626),Kcli_2637))
                                            )
                                            else
                                                {2230}let pkDisco_2638: bitstring = pub(sk(Disco)) in
                                                {2231}let v_2639: bool = (Sess = A) in
                                                (
                                                    {2232}if v_2639 then
                                                    (
                                                        {2233}let pkSess_2640: bitstring = pub(skA) in
                                                        {2234}out(c, GetEndpointRequest);
                                                        {2235}in(c, (=GetEndpointResponse,=pkSess_2640,=None,SP_2641: bitstring,UP_2642: bitstring));
                                                        {2236}new Nc_2643: bitstring;
                                                        {2237}let gNc_2644: bitstring = exp(g,Nc_2643) in
                                                        {2238}let m1_2645: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2644) in
                                                        {2239}out(c, (pkCli_2370,m1_2645));
                                                        {2240}in(c, em2_2646: bitstring);
                                                        {2241}let m2_2647: bitstring = em2_2646 in
                                                        {2242}let (=OpenSecureChannelResponse,PartS_2648: bitstring,ST_2649: bitstring,TTL_2650: bitstring) = m2_2647 in
                                                        {2243}let Kcli_2651: bitstring = exp(PartS_2648,Nc_2643) in
                                                        {2244}out(c, senc(mCli(pkCli_2370,pkSess_2640),Kcli_2651))
                                                    )
                                                    else
                                                        {2245}let v_2652: bool = (Sess = B) in
                                                        (
                                                            {2246}if v_2652 then
                                                            (
                                                                {2247}let pkSess_2653: bitstring = pub(skB) in
                                                                {2248}out(c, GetEndpointRequest);
                                                                {2249}in(c, (=GetEndpointResponse,=pkSess_2653,=None,SP_2654: bitstring,UP_2655: bitstring));
                                                                {2250}new Nc_2656: bitstring;
                                                                {2251}let gNc_2657: bitstring = exp(g,Nc_2656) in
                                                                {2252}let m1_2658: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2657) in
                                                                {2253}out(c, (pkCli_2370,m1_2658));
                                                                {2254}in(c, em2_2659: bitstring);
                                                                {2255}let m2_2660: bitstring = em2_2659 in
                                                                {2256}let (=OpenSecureChannelResponse,PartS_2661: bitstring,ST_2662: bitstring,TTL_2663: bitstring) = m2_2660 in
                                                                {2257}let Kcli_2664: bitstring = exp(PartS_2661,Nc_2656) in
                                                                {2258}out(c, senc(mCli(pkCli_2370,pkSess_2653),Kcli_2664))
                                                            )
                                                            else
                                                                {2259}let v_2665: bool = (Sess = C) in
                                                                (
                                                                    {2260}if v_2665 then
                                                                    (
                                                                        {2261}let pkSess_2666: bitstring = pub(skC) in
                                                                        {2262}out(c, GetEndpointRequest);
                                                                        {2263}in(c, (=GetEndpointResponse,=pkSess_2666,=None,SP_2667: bitstring,UP_2668: bitstring));
                                                                        {2264}new Nc_2669: bitstring;
                                                                        {2265}let gNc_2670: bitstring = exp(g,Nc_2669) in
                                                                        {2266}let m1_2671: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2670) in
                                                                        {2267}out(c, (pkCli_2370,m1_2671));
                                                                        {2268}in(c, em2_2672: bitstring);
                                                                        {2269}let m2_2673: bitstring = em2_2672 in
                                                                        {2270}let (=OpenSecureChannelResponse,PartS_2674: bitstring,ST_2675: bitstring,TTL_2676: bitstring) = m2_2673 in
                                                                        {2271}let Kcli_2677: bitstring = exp(PartS_2674,Nc_2669) in
                                                                        {2272}out(c, senc(mCli(pkCli_2370,pkSess_2666),Kcli_2677))
                                                                    )
                                                                    else
                                                                        {2273}let pkSess_2678: bitstring = pub(sk(Sess)) in
                                                                        {2274}out(c, GetEndpointRequest);
                                                                        {2275}in(c, (=GetEndpointResponse,=pkSess_2678,=None,SP_2679: bitstring,UP_2680: bitstring));
                                                                        {2276}new Nc_2681: bitstring;
                                                                        {2277}let gNc_2682: bitstring = exp(g,Nc_2681) in
                                                                        {2278}let m1_2683: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2682) in
                                                                        {2279}out(c, (pkCli_2370,m1_2683));
                                                                        {2280}in(c, em2_2684: bitstring);
                                                                        {2281}let m2_2685: bitstring = em2_2684 in
                                                                        {2282}let (=OpenSecureChannelResponse,PartS_2686: bitstring,ST_2687: bitstring,TTL_2688: bitstring) = m2_2685 in
                                                                        {2283}let Kcli_2689: bitstring = exp(PartS_2686,Nc_2681) in
                                                                        {2284}out(c, senc(mCli(pkCli_2370,pkSess_2678),Kcli_2689))
                                                                )
                                                                else
                                                                    {2285}let pkSess_2690: bitstring = fail-any in
                                                                    {2286}out(c, GetEndpointRequest);
                                                                    {2287}in(c, (=GetEndpointResponse,=pkSess_2690,=None,SP_2691: bitstring,UP_2692: bitstring));
                                                                    {2288}new Nc_2693: bitstring;
                                                                    {2289}let gNc_2694: bitstring = exp(g,Nc_2693) in
                                                                    {2290}let m1_2695: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2694) in
                                                                    {2291}out(c, (pkCli_2370,m1_2695));
                                                                    {2292}in(c, em2_2696: bitstring);
                                                                    {2293}let m2_2697: bitstring = em2_2696 in
                                                                    {2294}let (=OpenSecureChannelResponse,PartS_2698: bitstring,ST_2699: bitstring,TTL_2700: bitstring) = m2_2697 in
                                                                    {2295}let Kcli_2701: bitstring = exp(PartS_2698,Nc_2693) in
                                                                    {2296}out(c, senc(mCli(pkCli_2370,pkSess_2690),Kcli_2701))
                                                        )
                                                        else
                                                            {2297}let pkSess_2702: bitstring = fail-any in
                                                            {2298}out(c, GetEndpointRequest);
                                                            {2299}in(c, (=GetEndpointResponse,=pkSess_2702,=None,SP_2703: bitstring,UP_2704: bitstring));
                                                            {2300}new Nc_2705: bitstring;
                                                            {2301}let gNc_2706: bitstring = exp(g,Nc_2705) in
                                                            {2302}let m1_2707: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2706) in
                                                            {2303}out(c, (pkCli_2370,m1_2707));
                                                            {2304}in(c, em2_2708: bitstring);
                                                            {2305}let m2_2709: bitstring = em2_2708 in
                                                            {2306}let (=OpenSecureChannelResponse,PartS_2710: bitstring,ST_2711: bitstring,TTL_2712: bitstring) = m2_2709 in
                                                            {2307}let Kcli_2713: bitstring = exp(PartS_2710,Nc_2705) in
                                                            {2308}out(c, senc(mCli(pkCli_2370,pkSess_2702),Kcli_2713))
                                                )
                                                else
                                                    {2309}let pkSess_2714: bitstring = fail-any in
                                                    {2310}out(c, GetEndpointRequest);
                                                    {2311}in(c, (=GetEndpointResponse,=pkSess_2714,=None,SP_2715: bitstring,UP_2716: bitstring));
                                                    {2312}new Nc_2717: bitstring;
                                                    {2313}let gNc_2718: bitstring = exp(g,Nc_2717) in
                                                    {2314}let m1_2719: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2718) in
                                                    {2315}out(c, (pkCli_2370,m1_2719));
                                                    {2316}in(c, em2_2720: bitstring);
                                                    {2317}let m2_2721: bitstring = em2_2720 in
                                                    {2318}let (=OpenSecureChannelResponse,PartS_2722: bitstring,ST_2723: bitstring,TTL_2724: bitstring) = m2_2721 in
                                                    {2319}let Kcli_2725: bitstring = exp(PartS_2722,Nc_2717) in
                                                    {2320}out(c, senc(mCli(pkCli_2370,pkSess_2714),Kcli_2725))
                                        )
                                        else
                                            {2321}let pkDisco_2726: bitstring = fail-any in
                                            {2322}let v_2727: bool = (Sess = A) in
                                            (
                                                {2323}if v_2727 then
                                                (
                                                    {2324}let pkSess_2728: bitstring = pub(skA) in
                                                    {2325}out(c, GetEndpointRequest);
                                                    {2326}in(c, (=GetEndpointResponse,=pkSess_2728,=None,SP_2729: bitstring,UP_2730: bitstring));
                                                    {2327}new Nc_2731: bitstring;
                                                    {2328}let gNc_2732: bitstring = exp(g,Nc_2731) in
                                                    {2329}let m1_2733: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2732) in
                                                    {2330}out(c, (pkCli_2370,m1_2733));
                                                    {2331}in(c, em2_2734: bitstring);
                                                    {2332}let m2_2735: bitstring = em2_2734 in
                                                    {2333}let (=OpenSecureChannelResponse,PartS_2736: bitstring,ST_2737: bitstring,TTL_2738: bitstring) = m2_2735 in
                                                    {2334}let Kcli_2739: bitstring = exp(PartS_2736,Nc_2731) in
                                                    {2335}out(c, senc(mCli(pkCli_2370,pkSess_2728),Kcli_2739))
                                                )
                                                else
                                                    {2336}let v_2740: bool = (Sess = B) in
                                                    (
                                                        {2337}if v_2740 then
                                                        (
                                                            {2338}let pkSess_2741: bitstring = pub(skB) in
                                                            {2339}out(c, GetEndpointRequest);
                                                            {2340}in(c, (=GetEndpointResponse,=pkSess_2741,=None,SP_2742: bitstring,UP_2743: bitstring));
                                                            {2341}new Nc_2744: bitstring;
                                                            {2342}let gNc_2745: bitstring = exp(g,Nc_2744) in
                                                            {2343}let m1_2746: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2745) in
                                                            {2344}out(c, (pkCli_2370,m1_2746));
                                                            {2345}in(c, em2_2747: bitstring);
                                                            {2346}let m2_2748: bitstring = em2_2747 in
                                                            {2347}let (=OpenSecureChannelResponse,PartS_2749: bitstring,ST_2750: bitstring,TTL_2751: bitstring) = m2_2748 in
                                                            {2348}let Kcli_2752: bitstring = exp(PartS_2749,Nc_2744) in
                                                            {2349}out(c, senc(mCli(pkCli_2370,pkSess_2741),Kcli_2752))
                                                        )
                                                        else
                                                            {2350}let v_2753: bool = (Sess = C) in
                                                            (
                                                                {2351}if v_2753 then
                                                                (
                                                                    {2352}let pkSess_2754: bitstring = pub(skC) in
                                                                    {2353}out(c, GetEndpointRequest);
                                                                    {2354}in(c, (=GetEndpointResponse,=pkSess_2754,=None,SP_2755: bitstring,UP_2756: bitstring));
                                                                    {2355}new Nc_2757: bitstring;
                                                                    {2356}let gNc_2758: bitstring = exp(g,Nc_2757) in
                                                                    {2357}let m1_2759: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2758) in
                                                                    {2358}out(c, (pkCli_2370,m1_2759));
                                                                    {2359}in(c, em2_2760: bitstring);
                                                                    {2360}let m2_2761: bitstring = em2_2760 in
                                                                    {2361}let (=OpenSecureChannelResponse,PartS_2762: bitstring,ST_2763: bitstring,TTL_2764: bitstring) = m2_2761 in
                                                                    {2362}let Kcli_2765: bitstring = exp(PartS_2762,Nc_2757) in
                                                                    {2363}out(c, senc(mCli(pkCli_2370,pkSess_2754),Kcli_2765))
                                                                )
                                                                else
                                                                    {2364}let pkSess_2766: bitstring = pub(sk(Sess)) in
                                                                    {2365}out(c, GetEndpointRequest);
                                                                    {2366}in(c, (=GetEndpointResponse,=pkSess_2766,=None,SP_2767: bitstring,UP_2768: bitstring));
                                                                    {2367}new Nc_2769: bitstring;
                                                                    {2368}let gNc_2770: bitstring = exp(g,Nc_2769) in
                                                                    {2369}let m1_2771: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2770) in
                                                                    {2370}out(c, (pkCli_2370,m1_2771));
                                                                    {2371}in(c, em2_2772: bitstring);
                                                                    {2372}let m2_2773: bitstring = em2_2772 in
                                                                    {2373}let (=OpenSecureChannelResponse,PartS_2774: bitstring,ST_2775: bitstring,TTL_2776: bitstring) = m2_2773 in
                                                                    {2374}let Kcli_2777: bitstring = exp(PartS_2774,Nc_2769) in
                                                                    {2375}out(c, senc(mCli(pkCli_2370,pkSess_2766),Kcli_2777))
                                                            )
                                                            else
                                                                {2376}let pkSess_2778: bitstring = fail-any in
                                                                {2377}out(c, GetEndpointRequest);
                                                                {2378}in(c, (=GetEndpointResponse,=pkSess_2778,=None,SP_2779: bitstring,UP_2780: bitstring));
                                                                {2379}new Nc_2781: bitstring;
                                                                {2380}let gNc_2782: bitstring = exp(g,Nc_2781) in
                                                                {2381}let m1_2783: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2782) in
                                                                {2382}out(c, (pkCli_2370,m1_2783));
                                                                {2383}in(c, em2_2784: bitstring);
                                                                {2384}let m2_2785: bitstring = em2_2784 in
                                                                {2385}let (=OpenSecureChannelResponse,PartS_2786: bitstring,ST_2787: bitstring,TTL_2788: bitstring) = m2_2785 in
                                                                {2386}let Kcli_2789: bitstring = exp(PartS_2786,Nc_2781) in
                                                                {2387}out(c, senc(mCli(pkCli_2370,pkSess_2778),Kcli_2789))
                                                    )
                                                    else
                                                        {2388}let pkSess_2790: bitstring = fail-any in
                                                        {2389}out(c, GetEndpointRequest);
                                                        {2390}in(c, (=GetEndpointResponse,=pkSess_2790,=None,SP_2791: bitstring,UP_2792: bitstring));
                                                        {2391}new Nc_2793: bitstring;
                                                        {2392}let gNc_2794: bitstring = exp(g,Nc_2793) in
                                                        {2393}let m1_2795: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2794) in
                                                        {2394}out(c, (pkCli_2370,m1_2795));
                                                        {2395}in(c, em2_2796: bitstring);
                                                        {2396}let m2_2797: bitstring = em2_2796 in
                                                        {2397}let (=OpenSecureChannelResponse,PartS_2798: bitstring,ST_2799: bitstring,TTL_2800: bitstring) = m2_2797 in
                                                        {2398}let Kcli_2801: bitstring = exp(PartS_2798,Nc_2793) in
                                                        {2399}out(c, senc(mCli(pkCli_2370,pkSess_2790),Kcli_2801))
                                            )
                                            else
                                                {2400}let pkSess_2802: bitstring = fail-any in
                                                {2401}out(c, GetEndpointRequest);
                                                {2402}in(c, (=GetEndpointResponse,=pkSess_2802,=None,SP_2803: bitstring,UP_2804: bitstring));
                                                {2403}new Nc_2805: bitstring;
                                                {2404}let gNc_2806: bitstring = exp(g,Nc_2805) in
                                                {2405}let m1_2807: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2806) in
                                                {2406}out(c, (pkCli_2370,m1_2807));
                                                {2407}in(c, em2_2808: bitstring);
                                                {2408}let m2_2809: bitstring = em2_2808 in
                                                {2409}let (=OpenSecureChannelResponse,PartS_2810: bitstring,ST_2811: bitstring,TTL_2812: bitstring) = m2_2809 in
                                                {2410}let Kcli_2813: bitstring = exp(PartS_2810,Nc_2805) in
                                                {2411}out(c, senc(mCli(pkCli_2370,pkSess_2802),Kcli_2813))
                                )
                                else
                                    {2412}let pkDisco_2814: bitstring = fail-any in
                                    {2413}let v_2815: bool = (Sess = A) in
                                    (
                                        {2414}if v_2815 then
                                        (
                                            {2415}let pkSess_2816: bitstring = pub(skA) in
                                            {2416}out(c, GetEndpointRequest);
                                            {2417}in(c, (=GetEndpointResponse,=pkSess_2816,=None,SP_2817: bitstring,UP_2818: bitstring));
                                            {2418}new Nc_2819: bitstring;
                                            {2419}let gNc_2820: bitstring = exp(g,Nc_2819) in
                                            {2420}let m1_2821: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2820) in
                                            {2421}out(c, (pkCli_2370,m1_2821));
                                            {2422}in(c, em2_2822: bitstring);
                                            {2423}let m2_2823: bitstring = em2_2822 in
                                            {2424}let (=OpenSecureChannelResponse,PartS_2824: bitstring,ST_2825: bitstring,TTL_2826: bitstring) = m2_2823 in
                                            {2425}let Kcli_2827: bitstring = exp(PartS_2824,Nc_2819) in
                                            {2426}out(c, senc(mCli(pkCli_2370,pkSess_2816),Kcli_2827))
                                        )
                                        else
                                            {2427}let v_2828: bool = (Sess = B) in
                                            (
                                                {2428}if v_2828 then
                                                (
                                                    {2429}let pkSess_2829: bitstring = pub(skB) in
                                                    {2430}out(c, GetEndpointRequest);
                                                    {2431}in(c, (=GetEndpointResponse,=pkSess_2829,=None,SP_2830: bitstring,UP_2831: bitstring));
                                                    {2432}new Nc_2832: bitstring;
                                                    {2433}let gNc_2833: bitstring = exp(g,Nc_2832) in
                                                    {2434}let m1_2834: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2833) in
                                                    {2435}out(c, (pkCli_2370,m1_2834));
                                                    {2436}in(c, em2_2835: bitstring);
                                                    {2437}let m2_2836: bitstring = em2_2835 in
                                                    {2438}let (=OpenSecureChannelResponse,PartS_2837: bitstring,ST_2838: bitstring,TTL_2839: bitstring) = m2_2836 in
                                                    {2439}let Kcli_2840: bitstring = exp(PartS_2837,Nc_2832) in
                                                    {2440}out(c, senc(mCli(pkCli_2370,pkSess_2829),Kcli_2840))
                                                )
                                                else
                                                    {2441}let v_2841: bool = (Sess = C) in
                                                    (
                                                        {2442}if v_2841 then
                                                        (
                                                            {2443}let pkSess_2842: bitstring = pub(skC) in
                                                            {2444}out(c, GetEndpointRequest);
                                                            {2445}in(c, (=GetEndpointResponse,=pkSess_2842,=None,SP_2843: bitstring,UP_2844: bitstring));
                                                            {2446}new Nc_2845: bitstring;
                                                            {2447}let gNc_2846: bitstring = exp(g,Nc_2845) in
                                                            {2448}let m1_2847: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2846) in
                                                            {2449}out(c, (pkCli_2370,m1_2847));
                                                            {2450}in(c, em2_2848: bitstring);
                                                            {2451}let m2_2849: bitstring = em2_2848 in
                                                            {2452}let (=OpenSecureChannelResponse,PartS_2850: bitstring,ST_2851: bitstring,TTL_2852: bitstring) = m2_2849 in
                                                            {2453}let Kcli_2853: bitstring = exp(PartS_2850,Nc_2845) in
                                                            {2454}out(c, senc(mCli(pkCli_2370,pkSess_2842),Kcli_2853))
                                                        )
                                                        else
                                                            {2455}let pkSess_2854: bitstring = pub(sk(Sess)) in
                                                            {2456}out(c, GetEndpointRequest);
                                                            {2457}in(c, (=GetEndpointResponse,=pkSess_2854,=None,SP_2855: bitstring,UP_2856: bitstring));
                                                            {2458}new Nc_2857: bitstring;
                                                            {2459}let gNc_2858: bitstring = exp(g,Nc_2857) in
                                                            {2460}let m1_2859: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2858) in
                                                            {2461}out(c, (pkCli_2370,m1_2859));
                                                            {2462}in(c, em2_2860: bitstring);
                                                            {2463}let m2_2861: bitstring = em2_2860 in
                                                            {2464}let (=OpenSecureChannelResponse,PartS_2862: bitstring,ST_2863: bitstring,TTL_2864: bitstring) = m2_2861 in
                                                            {2465}let Kcli_2865: bitstring = exp(PartS_2862,Nc_2857) in
                                                            {2466}out(c, senc(mCli(pkCli_2370,pkSess_2854),Kcli_2865))
                                                    )
                                                    else
                                                        {2467}let pkSess_2866: bitstring = fail-any in
                                                        {2468}out(c, GetEndpointRequest);
                                                        {2469}in(c, (=GetEndpointResponse,=pkSess_2866,=None,SP_2867: bitstring,UP_2868: bitstring));
                                                        {2470}new Nc_2869: bitstring;
                                                        {2471}let gNc_2870: bitstring = exp(g,Nc_2869) in
                                                        {2472}let m1_2871: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2870) in
                                                        {2473}out(c, (pkCli_2370,m1_2871));
                                                        {2474}in(c, em2_2872: bitstring);
                                                        {2475}let m2_2873: bitstring = em2_2872 in
                                                        {2476}let (=OpenSecureChannelResponse,PartS_2874: bitstring,ST_2875: bitstring,TTL_2876: bitstring) = m2_2873 in
                                                        {2477}let Kcli_2877: bitstring = exp(PartS_2874,Nc_2869) in
                                                        {2478}out(c, senc(mCli(pkCli_2370,pkSess_2866),Kcli_2877))
                                            )
                                            else
                                                {2479}let pkSess_2878: bitstring = fail-any in
                                                {2480}out(c, GetEndpointRequest);
                                                {2481}in(c, (=GetEndpointResponse,=pkSess_2878,=None,SP_2879: bitstring,UP_2880: bitstring));
                                                {2482}new Nc_2881: bitstring;
                                                {2483}let gNc_2882: bitstring = exp(g,Nc_2881) in
                                                {2484}let m1_2883: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2882) in
                                                {2485}out(c, (pkCli_2370,m1_2883));
                                                {2486}in(c, em2_2884: bitstring);
                                                {2487}let m2_2885: bitstring = em2_2884 in
                                                {2488}let (=OpenSecureChannelResponse,PartS_2886: bitstring,ST_2887: bitstring,TTL_2888: bitstring) = m2_2885 in
                                                {2489}let Kcli_2889: bitstring = exp(PartS_2886,Nc_2881) in
                                                {2490}out(c, senc(mCli(pkCli_2370,pkSess_2878),Kcli_2889))
                                    )
                                    else
                                        {2491}let pkSess_2890: bitstring = fail-any in
                                        {2492}out(c, GetEndpointRequest);
                                        {2493}in(c, (=GetEndpointResponse,=pkSess_2890,=None,SP_2891: bitstring,UP_2892: bitstring));
                                        {2494}new Nc_2893: bitstring;
                                        {2495}let gNc_2894: bitstring = exp(g,Nc_2893) in
                                        {2496}let m1_2895: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2894) in
                                        {2497}out(c, (pkCli_2370,m1_2895));
                                        {2498}in(c, em2_2896: bitstring);
                                        {2499}let m2_2897: bitstring = em2_2896 in
                                        {2500}let (=OpenSecureChannelResponse,PartS_2898: bitstring,ST_2899: bitstring,TTL_2900: bitstring) = m2_2897 in
                                        {2501}let Kcli_2901: bitstring = exp(PartS_2898,Nc_2893) in
                                        {2502}out(c, senc(mCli(pkCli_2370,pkSess_2890),Kcli_2901))
                        )
                        else
                            {2503}let pkDisco_2902: bitstring = fail-any in
                            {2504}let v_2903: bool = (Sess = A) in
                            (
                                {2505}if v_2903 then
                                (
                                    {2506}let pkSess_2904: bitstring = pub(skA) in
                                    {2507}out(c, GetEndpointRequest);
                                    {2508}in(c, (=GetEndpointResponse,=pkSess_2904,=None,SP_2905: bitstring,UP_2906: bitstring));
                                    {2509}new Nc_2907: bitstring;
                                    {2510}let gNc_2908: bitstring = exp(g,Nc_2907) in
                                    {2511}let m1_2909: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2908) in
                                    {2512}out(c, (pkCli_2370,m1_2909));
                                    {2513}in(c, em2_2910: bitstring);
                                    {2514}let m2_2911: bitstring = em2_2910 in
                                    {2515}let (=OpenSecureChannelResponse,PartS_2912: bitstring,ST_2913: bitstring,TTL_2914: bitstring) = m2_2911 in
                                    {2516}let Kcli_2915: bitstring = exp(PartS_2912,Nc_2907) in
                                    {2517}out(c, senc(mCli(pkCli_2370,pkSess_2904),Kcli_2915))
                                )
                                else
                                    {2518}let v_2916: bool = (Sess = B) in
                                    (
                                        {2519}if v_2916 then
                                        (
                                            {2520}let pkSess_2917: bitstring = pub(skB) in
                                            {2521}out(c, GetEndpointRequest);
                                            {2522}in(c, (=GetEndpointResponse,=pkSess_2917,=None,SP_2918: bitstring,UP_2919: bitstring));
                                            {2523}new Nc_2920: bitstring;
                                            {2524}let gNc_2921: bitstring = exp(g,Nc_2920) in
                                            {2525}let m1_2922: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2921) in
                                            {2526}out(c, (pkCli_2370,m1_2922));
                                            {2527}in(c, em2_2923: bitstring);
                                            {2528}let m2_2924: bitstring = em2_2923 in
                                            {2529}let (=OpenSecureChannelResponse,PartS_2925: bitstring,ST_2926: bitstring,TTL_2927: bitstring) = m2_2924 in
                                            {2530}let Kcli_2928: bitstring = exp(PartS_2925,Nc_2920) in
                                            {2531}out(c, senc(mCli(pkCli_2370,pkSess_2917),Kcli_2928))
                                        )
                                        else
                                            {2532}let v_2929: bool = (Sess = C) in
                                            (
                                                {2533}if v_2929 then
                                                (
                                                    {2534}let pkSess_2930: bitstring = pub(skC) in
                                                    {2535}out(c, GetEndpointRequest);
                                                    {2536}in(c, (=GetEndpointResponse,=pkSess_2930,=None,SP_2931: bitstring,UP_2932: bitstring));
                                                    {2537}new Nc_2933: bitstring;
                                                    {2538}let gNc_2934: bitstring = exp(g,Nc_2933) in
                                                    {2539}let m1_2935: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2934) in
                                                    {2540}out(c, (pkCli_2370,m1_2935));
                                                    {2541}in(c, em2_2936: bitstring);
                                                    {2542}let m2_2937: bitstring = em2_2936 in
                                                    {2543}let (=OpenSecureChannelResponse,PartS_2938: bitstring,ST_2939: bitstring,TTL_2940: bitstring) = m2_2937 in
                                                    {2544}let Kcli_2941: bitstring = exp(PartS_2938,Nc_2933) in
                                                    {2545}out(c, senc(mCli(pkCli_2370,pkSess_2930),Kcli_2941))
                                                )
                                                else
                                                    {2546}let pkSess_2942: bitstring = pub(sk(Sess)) in
                                                    {2547}out(c, GetEndpointRequest);
                                                    {2548}in(c, (=GetEndpointResponse,=pkSess_2942,=None,SP_2943: bitstring,UP_2944: bitstring));
                                                    {2549}new Nc_2945: bitstring;
                                                    {2550}let gNc_2946: bitstring = exp(g,Nc_2945) in
                                                    {2551}let m1_2947: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2946) in
                                                    {2552}out(c, (pkCli_2370,m1_2947));
                                                    {2553}in(c, em2_2948: bitstring);
                                                    {2554}let m2_2949: bitstring = em2_2948 in
                                                    {2555}let (=OpenSecureChannelResponse,PartS_2950: bitstring,ST_2951: bitstring,TTL_2952: bitstring) = m2_2949 in
                                                    {2556}let Kcli_2953: bitstring = exp(PartS_2950,Nc_2945) in
                                                    {2557}out(c, senc(mCli(pkCli_2370,pkSess_2942),Kcli_2953))
                                            )
                                            else
                                                {2558}let pkSess_2954: bitstring = fail-any in
                                                {2559}out(c, GetEndpointRequest);
                                                {2560}in(c, (=GetEndpointResponse,=pkSess_2954,=None,SP_2955: bitstring,UP_2956: bitstring));
                                                {2561}new Nc_2957: bitstring;
                                                {2562}let gNc_2958: bitstring = exp(g,Nc_2957) in
                                                {2563}let m1_2959: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2958) in
                                                {2564}out(c, (pkCli_2370,m1_2959));
                                                {2565}in(c, em2_2960: bitstring);
                                                {2566}let m2_2961: bitstring = em2_2960 in
                                                {2567}let (=OpenSecureChannelResponse,PartS_2962: bitstring,ST_2963: bitstring,TTL_2964: bitstring) = m2_2961 in
                                                {2568}let Kcli_2965: bitstring = exp(PartS_2962,Nc_2957) in
                                                {2569}out(c, senc(mCli(pkCli_2370,pkSess_2954),Kcli_2965))
                                    )
                                    else
                                        {2570}let pkSess_2966: bitstring = fail-any in
                                        {2571}out(c, GetEndpointRequest);
                                        {2572}in(c, (=GetEndpointResponse,=pkSess_2966,=None,SP_2967: bitstring,UP_2968: bitstring));
                                        {2573}new Nc_2969: bitstring;
                                        {2574}let gNc_2970: bitstring = exp(g,Nc_2969) in
                                        {2575}let m1_2971: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2970) in
                                        {2576}out(c, (pkCli_2370,m1_2971));
                                        {2577}in(c, em2_2972: bitstring);
                                        {2578}let m2_2973: bitstring = em2_2972 in
                                        {2579}let (=OpenSecureChannelResponse,PartS_2974: bitstring,ST_2975: bitstring,TTL_2976: bitstring) = m2_2973 in
                                        {2580}let Kcli_2977: bitstring = exp(PartS_2974,Nc_2969) in
                                        {2581}out(c, senc(mCli(pkCli_2370,pkSess_2966),Kcli_2977))
                            )
                            else
                                {2582}let pkSess_2978: bitstring = fail-any in
                                {2583}out(c, GetEndpointRequest);
                                {2584}in(c, (=GetEndpointResponse,=pkSess_2978,=None,SP_2979: bitstring,UP_2980: bitstring));
                                {2585}new Nc_2981: bitstring;
                                {2586}let gNc_2982: bitstring = exp(g,Nc_2981) in
                                {2587}let m1_2983: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2982) in
                                {2588}out(c, (pkCli_2370,m1_2983));
                                {2589}in(c, em2_2984: bitstring);
                                {2590}let m2_2985: bitstring = em2_2984 in
                                {2591}let (=OpenSecureChannelResponse,PartS_2986: bitstring,ST_2987: bitstring,TTL_2988: bitstring) = m2_2985 in
                                {2592}let Kcli_2989: bitstring = exp(PartS_2986,Nc_2981) in
                                {2593}out(c, senc(mCli(pkCli_2370,pkSess_2978),Kcli_2989))
            )
            else
                {2594}let skCli_2990: bitstring = fail-any in
                {2595}let pkCli_2991: bitstring = pub(skCli_2990) in
                {2596}let v_2992: bool = (Disco = A) in
                (
                    {2597}if v_2992 then
                    (
                        {2598}let pkDisco_2993: bitstring = pub(skA) in
                        {2599}let v_2994: bool = (Sess = A) in
                        (
                            {2600}if v_2994 then
                            (
                                {2601}let pkSess_2995: bitstring = pub(skA) in
                                {2602}out(c, GetEndpointRequest);
                                {2603}in(c, (=GetEndpointResponse,=pkSess_2995,=None,SP_2996: bitstring,UP_2997: bitstring));
                                {2604}new Nc_2998: bitstring;
                                {2605}let gNc_2999: bitstring = exp(g,Nc_2998) in
                                {2606}let m1_3000: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_2999) in
                                {2607}out(c, (pkCli_2991,m1_3000));
                                {2608}in(c, em2_3001: bitstring);
                                {2609}let m2_3002: bitstring = em2_3001 in
                                {2610}let (=OpenSecureChannelResponse,PartS_3003: bitstring,ST_3004: bitstring,TTL_3005: bitstring) = m2_3002 in
                                {2611}let Kcli_3006: bitstring = exp(PartS_3003,Nc_2998) in
                                {2612}out(c, senc(mCli(pkCli_2991,pkSess_2995),Kcli_3006))
                            )
                            else
                                {2613}let v_3007: bool = (Sess = B) in
                                (
                                    {2614}if v_3007 then
                                    (
                                        {2615}let pkSess_3008: bitstring = pub(skB) in
                                        {2616}out(c, GetEndpointRequest);
                                        {2617}in(c, (=GetEndpointResponse,=pkSess_3008,=None,SP_3009: bitstring,UP_3010: bitstring));
                                        {2618}new Nc_3011: bitstring;
                                        {2619}let gNc_3012: bitstring = exp(g,Nc_3011) in
                                        {2620}let m1_3013: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3012) in
                                        {2621}out(c, (pkCli_2991,m1_3013));
                                        {2622}in(c, em2_3014: bitstring);
                                        {2623}let m2_3015: bitstring = em2_3014 in
                                        {2624}let (=OpenSecureChannelResponse,PartS_3016: bitstring,ST_3017: bitstring,TTL_3018: bitstring) = m2_3015 in
                                        {2625}let Kcli_3019: bitstring = exp(PartS_3016,Nc_3011) in
                                        {2626}out(c, senc(mCli(pkCli_2991,pkSess_3008),Kcli_3019))
                                    )
                                    else
                                        {2627}let v_3020: bool = (Sess = C) in
                                        (
                                            {2628}if v_3020 then
                                            (
                                                {2629}let pkSess_3021: bitstring = pub(skC) in
                                                {2630}out(c, GetEndpointRequest);
                                                {2631}in(c, (=GetEndpointResponse,=pkSess_3021,=None,SP_3022: bitstring,UP_3023: bitstring));
                                                {2632}new Nc_3024: bitstring;
                                                {2633}let gNc_3025: bitstring = exp(g,Nc_3024) in
                                                {2634}let m1_3026: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3025) in
                                                {2635}out(c, (pkCli_2991,m1_3026));
                                                {2636}in(c, em2_3027: bitstring);
                                                {2637}let m2_3028: bitstring = em2_3027 in
                                                {2638}let (=OpenSecureChannelResponse,PartS_3029: bitstring,ST_3030: bitstring,TTL_3031: bitstring) = m2_3028 in
                                                {2639}let Kcli_3032: bitstring = exp(PartS_3029,Nc_3024) in
                                                {2640}out(c, senc(mCli(pkCli_2991,pkSess_3021),Kcli_3032))
                                            )
                                            else
                                                {2641}let pkSess_3033: bitstring = pub(sk(Sess)) in
                                                {2642}out(c, GetEndpointRequest);
                                                {2643}in(c, (=GetEndpointResponse,=pkSess_3033,=None,SP_3034: bitstring,UP_3035: bitstring));
                                                {2644}new Nc_3036: bitstring;
                                                {2645}let gNc_3037: bitstring = exp(g,Nc_3036) in
                                                {2646}let m1_3038: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3037) in
                                                {2647}out(c, (pkCli_2991,m1_3038));
                                                {2648}in(c, em2_3039: bitstring);
                                                {2649}let m2_3040: bitstring = em2_3039 in
                                                {2650}let (=OpenSecureChannelResponse,PartS_3041: bitstring,ST_3042: bitstring,TTL_3043: bitstring) = m2_3040 in
                                                {2651}let Kcli_3044: bitstring = exp(PartS_3041,Nc_3036) in
                                                {2652}out(c, senc(mCli(pkCli_2991,pkSess_3033),Kcli_3044))
                                        )
                                        else
                                            {2653}let pkSess_3045: bitstring = fail-any in
                                            {2654}out(c, GetEndpointRequest);
                                            {2655}in(c, (=GetEndpointResponse,=pkSess_3045,=None,SP_3046: bitstring,UP_3047: bitstring));
                                            {2656}new Nc_3048: bitstring;
                                            {2657}let gNc_3049: bitstring = exp(g,Nc_3048) in
                                            {2658}let m1_3050: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3049) in
                                            {2659}out(c, (pkCli_2991,m1_3050));
                                            {2660}in(c, em2_3051: bitstring);
                                            {2661}let m2_3052: bitstring = em2_3051 in
                                            {2662}let (=OpenSecureChannelResponse,PartS_3053: bitstring,ST_3054: bitstring,TTL_3055: bitstring) = m2_3052 in
                                            {2663}let Kcli_3056: bitstring = exp(PartS_3053,Nc_3048) in
                                            {2664}out(c, senc(mCli(pkCli_2991,pkSess_3045),Kcli_3056))
                                )
                                else
                                    {2665}let pkSess_3057: bitstring = fail-any in
                                    {2666}out(c, GetEndpointRequest);
                                    {2667}in(c, (=GetEndpointResponse,=pkSess_3057,=None,SP_3058: bitstring,UP_3059: bitstring));
                                    {2668}new Nc_3060: bitstring;
                                    {2669}let gNc_3061: bitstring = exp(g,Nc_3060) in
                                    {2670}let m1_3062: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3061) in
                                    {2671}out(c, (pkCli_2991,m1_3062));
                                    {2672}in(c, em2_3063: bitstring);
                                    {2673}let m2_3064: bitstring = em2_3063 in
                                    {2674}let (=OpenSecureChannelResponse,PartS_3065: bitstring,ST_3066: bitstring,TTL_3067: bitstring) = m2_3064 in
                                    {2675}let Kcli_3068: bitstring = exp(PartS_3065,Nc_3060) in
                                    {2676}out(c, senc(mCli(pkCli_2991,pkSess_3057),Kcli_3068))
                        )
                        else
                            {2677}let pkSess_3069: bitstring = fail-any in
                            {2678}out(c, GetEndpointRequest);
                            {2679}in(c, (=GetEndpointResponse,=pkSess_3069,=None,SP_3070: bitstring,UP_3071: bitstring));
                            {2680}new Nc_3072: bitstring;
                            {2681}let gNc_3073: bitstring = exp(g,Nc_3072) in
                            {2682}let m1_3074: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3073) in
                            {2683}out(c, (pkCli_2991,m1_3074));
                            {2684}in(c, em2_3075: bitstring);
                            {2685}let m2_3076: bitstring = em2_3075 in
                            {2686}let (=OpenSecureChannelResponse,PartS_3077: bitstring,ST_3078: bitstring,TTL_3079: bitstring) = m2_3076 in
                            {2687}let Kcli_3080: bitstring = exp(PartS_3077,Nc_3072) in
                            {2688}out(c, senc(mCli(pkCli_2991,pkSess_3069),Kcli_3080))
                    )
                    else
                        {2689}let v_3081: bool = (Disco = B) in
                        (
                            {2690}if v_3081 then
                            (
                                {2691}let pkDisco_3082: bitstring = pub(skB) in
                                {2692}let v_3083: bool = (Sess = A) in
                                (
                                    {2693}if v_3083 then
                                    (
                                        {2694}let pkSess_3084: bitstring = pub(skA) in
                                        {2695}out(c, GetEndpointRequest);
                                        {2696}in(c, (=GetEndpointResponse,=pkSess_3084,=None,SP_3085: bitstring,UP_3086: bitstring));
                                        {2697}new Nc_3087: bitstring;
                                        {2698}let gNc_3088: bitstring = exp(g,Nc_3087) in
                                        {2699}let m1_3089: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3088) in
                                        {2700}out(c, (pkCli_2991,m1_3089));
                                        {2701}in(c, em2_3090: bitstring);
                                        {2702}let m2_3091: bitstring = em2_3090 in
                                        {2703}let (=OpenSecureChannelResponse,PartS_3092: bitstring,ST_3093: bitstring,TTL_3094: bitstring) = m2_3091 in
                                        {2704}let Kcli_3095: bitstring = exp(PartS_3092,Nc_3087) in
                                        {2705}out(c, senc(mCli(pkCli_2991,pkSess_3084),Kcli_3095))
                                    )
                                    else
                                        {2706}let v_3096: bool = (Sess = B) in
                                        (
                                            {2707}if v_3096 then
                                            (
                                                {2708}let pkSess_3097: bitstring = pub(skB) in
                                                {2709}out(c, GetEndpointRequest);
                                                {2710}in(c, (=GetEndpointResponse,=pkSess_3097,=None,SP_3098: bitstring,UP_3099: bitstring));
                                                {2711}new Nc_3100: bitstring;
                                                {2712}let gNc_3101: bitstring = exp(g,Nc_3100) in
                                                {2713}let m1_3102: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3101) in
                                                {2714}out(c, (pkCli_2991,m1_3102));
                                                {2715}in(c, em2_3103: bitstring);
                                                {2716}let m2_3104: bitstring = em2_3103 in
                                                {2717}let (=OpenSecureChannelResponse,PartS_3105: bitstring,ST_3106: bitstring,TTL_3107: bitstring) = m2_3104 in
                                                {2718}let Kcli_3108: bitstring = exp(PartS_3105,Nc_3100) in
                                                {2719}out(c, senc(mCli(pkCli_2991,pkSess_3097),Kcli_3108))
                                            )
                                            else
                                                {2720}let v_3109: bool = (Sess = C) in
                                                (
                                                    {2721}if v_3109 then
                                                    (
                                                        {2722}let pkSess_3110: bitstring = pub(skC) in
                                                        {2723}out(c, GetEndpointRequest);
                                                        {2724}in(c, (=GetEndpointResponse,=pkSess_3110,=None,SP_3111: bitstring,UP_3112: bitstring));
                                                        {2725}new Nc_3113: bitstring;
                                                        {2726}let gNc_3114: bitstring = exp(g,Nc_3113) in
                                                        {2727}let m1_3115: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3114) in
                                                        {2728}out(c, (pkCli_2991,m1_3115));
                                                        {2729}in(c, em2_3116: bitstring);
                                                        {2730}let m2_3117: bitstring = em2_3116 in
                                                        {2731}let (=OpenSecureChannelResponse,PartS_3118: bitstring,ST_3119: bitstring,TTL_3120: bitstring) = m2_3117 in
                                                        {2732}let Kcli_3121: bitstring = exp(PartS_3118,Nc_3113) in
                                                        {2733}out(c, senc(mCli(pkCli_2991,pkSess_3110),Kcli_3121))
                                                    )
                                                    else
                                                        {2734}let pkSess_3122: bitstring = pub(sk(Sess)) in
                                                        {2735}out(c, GetEndpointRequest);
                                                        {2736}in(c, (=GetEndpointResponse,=pkSess_3122,=None,SP_3123: bitstring,UP_3124: bitstring));
                                                        {2737}new Nc_3125: bitstring;
                                                        {2738}let gNc_3126: bitstring = exp(g,Nc_3125) in
                                                        {2739}let m1_3127: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3126) in
                                                        {2740}out(c, (pkCli_2991,m1_3127));
                                                        {2741}in(c, em2_3128: bitstring);
                                                        {2742}let m2_3129: bitstring = em2_3128 in
                                                        {2743}let (=OpenSecureChannelResponse,PartS_3130: bitstring,ST_3131: bitstring,TTL_3132: bitstring) = m2_3129 in
                                                        {2744}let Kcli_3133: bitstring = exp(PartS_3130,Nc_3125) in
                                                        {2745}out(c, senc(mCli(pkCli_2991,pkSess_3122),Kcli_3133))
                                                )
                                                else
                                                    {2746}let pkSess_3134: bitstring = fail-any in
                                                    {2747}out(c, GetEndpointRequest);
                                                    {2748}in(c, (=GetEndpointResponse,=pkSess_3134,=None,SP_3135: bitstring,UP_3136: bitstring));
                                                    {2749}new Nc_3137: bitstring;
                                                    {2750}let gNc_3138: bitstring = exp(g,Nc_3137) in
                                                    {2751}let m1_3139: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3138) in
                                                    {2752}out(c, (pkCli_2991,m1_3139));
                                                    {2753}in(c, em2_3140: bitstring);
                                                    {2754}let m2_3141: bitstring = em2_3140 in
                                                    {2755}let (=OpenSecureChannelResponse,PartS_3142: bitstring,ST_3143: bitstring,TTL_3144: bitstring) = m2_3141 in
                                                    {2756}let Kcli_3145: bitstring = exp(PartS_3142,Nc_3137) in
                                                    {2757}out(c, senc(mCli(pkCli_2991,pkSess_3134),Kcli_3145))
                                        )
                                        else
                                            {2758}let pkSess_3146: bitstring = fail-any in
                                            {2759}out(c, GetEndpointRequest);
                                            {2760}in(c, (=GetEndpointResponse,=pkSess_3146,=None,SP_3147: bitstring,UP_3148: bitstring));
                                            {2761}new Nc_3149: bitstring;
                                            {2762}let gNc_3150: bitstring = exp(g,Nc_3149) in
                                            {2763}let m1_3151: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3150) in
                                            {2764}out(c, (pkCli_2991,m1_3151));
                                            {2765}in(c, em2_3152: bitstring);
                                            {2766}let m2_3153: bitstring = em2_3152 in
                                            {2767}let (=OpenSecureChannelResponse,PartS_3154: bitstring,ST_3155: bitstring,TTL_3156: bitstring) = m2_3153 in
                                            {2768}let Kcli_3157: bitstring = exp(PartS_3154,Nc_3149) in
                                            {2769}out(c, senc(mCli(pkCli_2991,pkSess_3146),Kcli_3157))
                                )
                                else
                                    {2770}let pkSess_3158: bitstring = fail-any in
                                    {2771}out(c, GetEndpointRequest);
                                    {2772}in(c, (=GetEndpointResponse,=pkSess_3158,=None,SP_3159: bitstring,UP_3160: bitstring));
                                    {2773}new Nc_3161: bitstring;
                                    {2774}let gNc_3162: bitstring = exp(g,Nc_3161) in
                                    {2775}let m1_3163: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3162) in
                                    {2776}out(c, (pkCli_2991,m1_3163));
                                    {2777}in(c, em2_3164: bitstring);
                                    {2778}let m2_3165: bitstring = em2_3164 in
                                    {2779}let (=OpenSecureChannelResponse,PartS_3166: bitstring,ST_3167: bitstring,TTL_3168: bitstring) = m2_3165 in
                                    {2780}let Kcli_3169: bitstring = exp(PartS_3166,Nc_3161) in
                                    {2781}out(c, senc(mCli(pkCli_2991,pkSess_3158),Kcli_3169))
                            )
                            else
                                {2782}let v_3170: bool = (Disco = C) in
                                (
                                    {2783}if v_3170 then
                                    (
                                        {2784}let pkDisco_3171: bitstring = pub(skC) in
                                        {2785}let v_3172: bool = (Sess = A) in
                                        (
                                            {2786}if v_3172 then
                                            (
                                                {2787}let pkSess_3173: bitstring = pub(skA) in
                                                {2788}out(c, GetEndpointRequest);
                                                {2789}in(c, (=GetEndpointResponse,=pkSess_3173,=None,SP_3174: bitstring,UP_3175: bitstring));
                                                {2790}new Nc_3176: bitstring;
                                                {2791}let gNc_3177: bitstring = exp(g,Nc_3176) in
                                                {2792}let m1_3178: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3177) in
                                                {2793}out(c, (pkCli_2991,m1_3178));
                                                {2794}in(c, em2_3179: bitstring);
                                                {2795}let m2_3180: bitstring = em2_3179 in
                                                {2796}let (=OpenSecureChannelResponse,PartS_3181: bitstring,ST_3182: bitstring,TTL_3183: bitstring) = m2_3180 in
                                                {2797}let Kcli_3184: bitstring = exp(PartS_3181,Nc_3176) in
                                                {2798}out(c, senc(mCli(pkCli_2991,pkSess_3173),Kcli_3184))
                                            )
                                            else
                                                {2799}let v_3185: bool = (Sess = B) in
                                                (
                                                    {2800}if v_3185 then
                                                    (
                                                        {2801}let pkSess_3186: bitstring = pub(skB) in
                                                        {2802}out(c, GetEndpointRequest);
                                                        {2803}in(c, (=GetEndpointResponse,=pkSess_3186,=None,SP_3187: bitstring,UP_3188: bitstring));
                                                        {2804}new Nc_3189: bitstring;
                                                        {2805}let gNc_3190: bitstring = exp(g,Nc_3189) in
                                                        {2806}let m1_3191: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3190) in
                                                        {2807}out(c, (pkCli_2991,m1_3191));
                                                        {2808}in(c, em2_3192: bitstring);
                                                        {2809}let m2_3193: bitstring = em2_3192 in
                                                        {2810}let (=OpenSecureChannelResponse,PartS_3194: bitstring,ST_3195: bitstring,TTL_3196: bitstring) = m2_3193 in
                                                        {2811}let Kcli_3197: bitstring = exp(PartS_3194,Nc_3189) in
                                                        {2812}out(c, senc(mCli(pkCli_2991,pkSess_3186),Kcli_3197))
                                                    )
                                                    else
                                                        {2813}let v_3198: bool = (Sess = C) in
                                                        (
                                                            {2814}if v_3198 then
                                                            (
                                                                {2815}let pkSess_3199: bitstring = pub(skC) in
                                                                {2816}out(c, GetEndpointRequest);
                                                                {2817}in(c, (=GetEndpointResponse,=pkSess_3199,=None,SP_3200: bitstring,UP_3201: bitstring));
                                                                {2818}new Nc_3202: bitstring;
                                                                {2819}let gNc_3203: bitstring = exp(g,Nc_3202) in
                                                                {2820}let m1_3204: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3203) in
                                                                {2821}out(c, (pkCli_2991,m1_3204));
                                                                {2822}in(c, em2_3205: bitstring);
                                                                {2823}let m2_3206: bitstring = em2_3205 in
                                                                {2824}let (=OpenSecureChannelResponse,PartS_3207: bitstring,ST_3208: bitstring,TTL_3209: bitstring) = m2_3206 in
                                                                {2825}let Kcli_3210: bitstring = exp(PartS_3207,Nc_3202) in
                                                                {2826}out(c, senc(mCli(pkCli_2991,pkSess_3199),Kcli_3210))
                                                            )
                                                            else
                                                                {2827}let pkSess_3211: bitstring = pub(sk(Sess)) in
                                                                {2828}out(c, GetEndpointRequest);
                                                                {2829}in(c, (=GetEndpointResponse,=pkSess_3211,=None,SP_3212: bitstring,UP_3213: bitstring));
                                                                {2830}new Nc_3214: bitstring;
                                                                {2831}let gNc_3215: bitstring = exp(g,Nc_3214) in
                                                                {2832}let m1_3216: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3215) in
                                                                {2833}out(c, (pkCli_2991,m1_3216));
                                                                {2834}in(c, em2_3217: bitstring);
                                                                {2835}let m2_3218: bitstring = em2_3217 in
                                                                {2836}let (=OpenSecureChannelResponse,PartS_3219: bitstring,ST_3220: bitstring,TTL_3221: bitstring) = m2_3218 in
                                                                {2837}let Kcli_3222: bitstring = exp(PartS_3219,Nc_3214) in
                                                                {2838}out(c, senc(mCli(pkCli_2991,pkSess_3211),Kcli_3222))
                                                        )
                                                        else
                                                            {2839}let pkSess_3223: bitstring = fail-any in
                                                            {2840}out(c, GetEndpointRequest);
                                                            {2841}in(c, (=GetEndpointResponse,=pkSess_3223,=None,SP_3224: bitstring,UP_3225: bitstring));
                                                            {2842}new Nc_3226: bitstring;
                                                            {2843}let gNc_3227: bitstring = exp(g,Nc_3226) in
                                                            {2844}let m1_3228: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3227) in
                                                            {2845}out(c, (pkCli_2991,m1_3228));
                                                            {2846}in(c, em2_3229: bitstring);
                                                            {2847}let m2_3230: bitstring = em2_3229 in
                                                            {2848}let (=OpenSecureChannelResponse,PartS_3231: bitstring,ST_3232: bitstring,TTL_3233: bitstring) = m2_3230 in
                                                            {2849}let Kcli_3234: bitstring = exp(PartS_3231,Nc_3226) in
                                                            {2850}out(c, senc(mCli(pkCli_2991,pkSess_3223),Kcli_3234))
                                                )
                                                else
                                                    {2851}let pkSess_3235: bitstring = fail-any in
                                                    {2852}out(c, GetEndpointRequest);
                                                    {2853}in(c, (=GetEndpointResponse,=pkSess_3235,=None,SP_3236: bitstring,UP_3237: bitstring));
                                                    {2854}new Nc_3238: bitstring;
                                                    {2855}let gNc_3239: bitstring = exp(g,Nc_3238) in
                                                    {2856}let m1_3240: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3239) in
                                                    {2857}out(c, (pkCli_2991,m1_3240));
                                                    {2858}in(c, em2_3241: bitstring);
                                                    {2859}let m2_3242: bitstring = em2_3241 in
                                                    {2860}let (=OpenSecureChannelResponse,PartS_3243: bitstring,ST_3244: bitstring,TTL_3245: bitstring) = m2_3242 in
                                                    {2861}let Kcli_3246: bitstring = exp(PartS_3243,Nc_3238) in
                                                    {2862}out(c, senc(mCli(pkCli_2991,pkSess_3235),Kcli_3246))
                                        )
                                        else
                                            {2863}let pkSess_3247: bitstring = fail-any in
                                            {2864}out(c, GetEndpointRequest);
                                            {2865}in(c, (=GetEndpointResponse,=pkSess_3247,=None,SP_3248: bitstring,UP_3249: bitstring));
                                            {2866}new Nc_3250: bitstring;
                                            {2867}let gNc_3251: bitstring = exp(g,Nc_3250) in
                                            {2868}let m1_3252: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3251) in
                                            {2869}out(c, (pkCli_2991,m1_3252));
                                            {2870}in(c, em2_3253: bitstring);
                                            {2871}let m2_3254: bitstring = em2_3253 in
                                            {2872}let (=OpenSecureChannelResponse,PartS_3255: bitstring,ST_3256: bitstring,TTL_3257: bitstring) = m2_3254 in
                                            {2873}let Kcli_3258: bitstring = exp(PartS_3255,Nc_3250) in
                                            {2874}out(c, senc(mCli(pkCli_2991,pkSess_3247),Kcli_3258))
                                    )
                                    else
                                        {2875}let pkDisco_3259: bitstring = pub(sk(Disco)) in
                                        {2876}let v_3260: bool = (Sess = A) in
                                        (
                                            {2877}if v_3260 then
                                            (
                                                {2878}let pkSess_3261: bitstring = pub(skA) in
                                                {2879}out(c, GetEndpointRequest);
                                                {2880}in(c, (=GetEndpointResponse,=pkSess_3261,=None,SP_3262: bitstring,UP_3263: bitstring));
                                                {2881}new Nc_3264: bitstring;
                                                {2882}let gNc_3265: bitstring = exp(g,Nc_3264) in
                                                {2883}let m1_3266: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3265) in
                                                {2884}out(c, (pkCli_2991,m1_3266));
                                                {2885}in(c, em2_3267: bitstring);
                                                {2886}let m2_3268: bitstring = em2_3267 in
                                                {2887}let (=OpenSecureChannelResponse,PartS_3269: bitstring,ST_3270: bitstring,TTL_3271: bitstring) = m2_3268 in
                                                {2888}let Kcli_3272: bitstring = exp(PartS_3269,Nc_3264) in
                                                {2889}out(c, senc(mCli(pkCli_2991,pkSess_3261),Kcli_3272))
                                            )
                                            else
                                                {2890}let v_3273: bool = (Sess = B) in
                                                (
                                                    {2891}if v_3273 then
                                                    (
                                                        {2892}let pkSess_3274: bitstring = pub(skB) in
                                                        {2893}out(c, GetEndpointRequest);
                                                        {2894}in(c, (=GetEndpointResponse,=pkSess_3274,=None,SP_3275: bitstring,UP_3276: bitstring));
                                                        {2895}new Nc_3277: bitstring;
                                                        {2896}let gNc_3278: bitstring = exp(g,Nc_3277) in
                                                        {2897}let m1_3279: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3278) in
                                                        {2898}out(c, (pkCli_2991,m1_3279));
                                                        {2899}in(c, em2_3280: bitstring);
                                                        {2900}let m2_3281: bitstring = em2_3280 in
                                                        {2901}let (=OpenSecureChannelResponse,PartS_3282: bitstring,ST_3283: bitstring,TTL_3284: bitstring) = m2_3281 in
                                                        {2902}let Kcli_3285: bitstring = exp(PartS_3282,Nc_3277) in
                                                        {2903}out(c, senc(mCli(pkCli_2991,pkSess_3274),Kcli_3285))
                                                    )
                                                    else
                                                        {2904}let v_3286: bool = (Sess = C) in
                                                        (
                                                            {2905}if v_3286 then
                                                            (
                                                                {2906}let pkSess_3287: bitstring = pub(skC) in
                                                                {2907}out(c, GetEndpointRequest);
                                                                {2908}in(c, (=GetEndpointResponse,=pkSess_3287,=None,SP_3288: bitstring,UP_3289: bitstring));
                                                                {2909}new Nc_3290: bitstring;
                                                                {2910}let gNc_3291: bitstring = exp(g,Nc_3290) in
                                                                {2911}let m1_3292: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3291) in
                                                                {2912}out(c, (pkCli_2991,m1_3292));
                                                                {2913}in(c, em2_3293: bitstring);
                                                                {2914}let m2_3294: bitstring = em2_3293 in
                                                                {2915}let (=OpenSecureChannelResponse,PartS_3295: bitstring,ST_3296: bitstring,TTL_3297: bitstring) = m2_3294 in
                                                                {2916}let Kcli_3298: bitstring = exp(PartS_3295,Nc_3290) in
                                                                {2917}out(c, senc(mCli(pkCli_2991,pkSess_3287),Kcli_3298))
                                                            )
                                                            else
                                                                {2918}let pkSess_3299: bitstring = pub(sk(Sess)) in
                                                                {2919}out(c, GetEndpointRequest);
                                                                {2920}in(c, (=GetEndpointResponse,=pkSess_3299,=None,SP_3300: bitstring,UP_3301: bitstring));
                                                                {2921}new Nc_3302: bitstring;
                                                                {2922}let gNc_3303: bitstring = exp(g,Nc_3302) in
                                                                {2923}let m1_3304: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3303) in
                                                                {2924}out(c, (pkCli_2991,m1_3304));
                                                                {2925}in(c, em2_3305: bitstring);
                                                                {2926}let m2_3306: bitstring = em2_3305 in
                                                                {2927}let (=OpenSecureChannelResponse,PartS_3307: bitstring,ST_3308: bitstring,TTL_3309: bitstring) = m2_3306 in
                                                                {2928}let Kcli_3310: bitstring = exp(PartS_3307,Nc_3302) in
                                                                {2929}out(c, senc(mCli(pkCli_2991,pkSess_3299),Kcli_3310))
                                                        )
                                                        else
                                                            {2930}let pkSess_3311: bitstring = fail-any in
                                                            {2931}out(c, GetEndpointRequest);
                                                            {2932}in(c, (=GetEndpointResponse,=pkSess_3311,=None,SP_3312: bitstring,UP_3313: bitstring));
                                                            {2933}new Nc_3314: bitstring;
                                                            {2934}let gNc_3315: bitstring = exp(g,Nc_3314) in
                                                            {2935}let m1_3316: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3315) in
                                                            {2936}out(c, (pkCli_2991,m1_3316));
                                                            {2937}in(c, em2_3317: bitstring);
                                                            {2938}let m2_3318: bitstring = em2_3317 in
                                                            {2939}let (=OpenSecureChannelResponse,PartS_3319: bitstring,ST_3320: bitstring,TTL_3321: bitstring) = m2_3318 in
                                                            {2940}let Kcli_3322: bitstring = exp(PartS_3319,Nc_3314) in
                                                            {2941}out(c, senc(mCli(pkCli_2991,pkSess_3311),Kcli_3322))
                                                )
                                                else
                                                    {2942}let pkSess_3323: bitstring = fail-any in
                                                    {2943}out(c, GetEndpointRequest);
                                                    {2944}in(c, (=GetEndpointResponse,=pkSess_3323,=None,SP_3324: bitstring,UP_3325: bitstring));
                                                    {2945}new Nc_3326: bitstring;
                                                    {2946}let gNc_3327: bitstring = exp(g,Nc_3326) in
                                                    {2947}let m1_3328: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3327) in
                                                    {2948}out(c, (pkCli_2991,m1_3328));
                                                    {2949}in(c, em2_3329: bitstring);
                                                    {2950}let m2_3330: bitstring = em2_3329 in
                                                    {2951}let (=OpenSecureChannelResponse,PartS_3331: bitstring,ST_3332: bitstring,TTL_3333: bitstring) = m2_3330 in
                                                    {2952}let Kcli_3334: bitstring = exp(PartS_3331,Nc_3326) in
                                                    {2953}out(c, senc(mCli(pkCli_2991,pkSess_3323),Kcli_3334))
                                        )
                                        else
                                            {2954}let pkSess_3335: bitstring = fail-any in
                                            {2955}out(c, GetEndpointRequest);
                                            {2956}in(c, (=GetEndpointResponse,=pkSess_3335,=None,SP_3336: bitstring,UP_3337: bitstring));
                                            {2957}new Nc_3338: bitstring;
                                            {2958}let gNc_3339: bitstring = exp(g,Nc_3338) in
                                            {2959}let m1_3340: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3339) in
                                            {2960}out(c, (pkCli_2991,m1_3340));
                                            {2961}in(c, em2_3341: bitstring);
                                            {2962}let m2_3342: bitstring = em2_3341 in
                                            {2963}let (=OpenSecureChannelResponse,PartS_3343: bitstring,ST_3344: bitstring,TTL_3345: bitstring) = m2_3342 in
                                            {2964}let Kcli_3346: bitstring = exp(PartS_3343,Nc_3338) in
                                            {2965}out(c, senc(mCli(pkCli_2991,pkSess_3335),Kcli_3346))
                                )
                                else
                                    {2966}let pkDisco_3347: bitstring = fail-any in
                                    {2967}let v_3348: bool = (Sess = A) in
                                    (
                                        {2968}if v_3348 then
                                        (
                                            {2969}let pkSess_3349: bitstring = pub(skA) in
                                            {2970}out(c, GetEndpointRequest);
                                            {2971}in(c, (=GetEndpointResponse,=pkSess_3349,=None,SP_3350: bitstring,UP_3351: bitstring));
                                            {2972}new Nc_3352: bitstring;
                                            {2973}let gNc_3353: bitstring = exp(g,Nc_3352) in
                                            {2974}let m1_3354: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3353) in
                                            {2975}out(c, (pkCli_2991,m1_3354));
                                            {2976}in(c, em2_3355: bitstring);
                                            {2977}let m2_3356: bitstring = em2_3355 in
                                            {2978}let (=OpenSecureChannelResponse,PartS_3357: bitstring,ST_3358: bitstring,TTL_3359: bitstring) = m2_3356 in
                                            {2979}let Kcli_3360: bitstring = exp(PartS_3357,Nc_3352) in
                                            {2980}out(c, senc(mCli(pkCli_2991,pkSess_3349),Kcli_3360))
                                        )
                                        else
                                            {2981}let v_3361: bool = (Sess = B) in
                                            (
                                                {2982}if v_3361 then
                                                (
                                                    {2983}let pkSess_3362: bitstring = pub(skB) in
                                                    {2984}out(c, GetEndpointRequest);
                                                    {2985}in(c, (=GetEndpointResponse,=pkSess_3362,=None,SP_3363: bitstring,UP_3364: bitstring));
                                                    {2986}new Nc_3365: bitstring;
                                                    {2987}let gNc_3366: bitstring = exp(g,Nc_3365) in
                                                    {2988}let m1_3367: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3366) in
                                                    {2989}out(c, (pkCli_2991,m1_3367));
                                                    {2990}in(c, em2_3368: bitstring);
                                                    {2991}let m2_3369: bitstring = em2_3368 in
                                                    {2992}let (=OpenSecureChannelResponse,PartS_3370: bitstring,ST_3371: bitstring,TTL_3372: bitstring) = m2_3369 in
                                                    {2993}let Kcli_3373: bitstring = exp(PartS_3370,Nc_3365) in
                                                    {2994}out(c, senc(mCli(pkCli_2991,pkSess_3362),Kcli_3373))
                                                )
                                                else
                                                    {2995}let v_3374: bool = (Sess = C) in
                                                    (
                                                        {2996}if v_3374 then
                                                        (
                                                            {2997}let pkSess_3375: bitstring = pub(skC) in
                                                            {2998}out(c, GetEndpointRequest);
                                                            {2999}in(c, (=GetEndpointResponse,=pkSess_3375,=None,SP_3376: bitstring,UP_3377: bitstring));
                                                            {3000}new Nc_3378: bitstring;
                                                            {3001}let gNc_3379: bitstring = exp(g,Nc_3378) in
                                                            {3002}let m1_3380: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3379) in
                                                            {3003}out(c, (pkCli_2991,m1_3380));
                                                            {3004}in(c, em2_3381: bitstring);
                                                            {3005}let m2_3382: bitstring = em2_3381 in
                                                            {3006}let (=OpenSecureChannelResponse,PartS_3383: bitstring,ST_3384: bitstring,TTL_3385: bitstring) = m2_3382 in
                                                            {3007}let Kcli_3386: bitstring = exp(PartS_3383,Nc_3378) in
                                                            {3008}out(c, senc(mCli(pkCli_2991,pkSess_3375),Kcli_3386))
                                                        )
                                                        else
                                                            {3009}let pkSess_3387: bitstring = pub(sk(Sess)) in
                                                            {3010}out(c, GetEndpointRequest);
                                                            {3011}in(c, (=GetEndpointResponse,=pkSess_3387,=None,SP_3388: bitstring,UP_3389: bitstring));
                                                            {3012}new Nc_3390: bitstring;
                                                            {3013}let gNc_3391: bitstring = exp(g,Nc_3390) in
                                                            {3014}let m1_3392: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3391) in
                                                            {3015}out(c, (pkCli_2991,m1_3392));
                                                            {3016}in(c, em2_3393: bitstring);
                                                            {3017}let m2_3394: bitstring = em2_3393 in
                                                            {3018}let (=OpenSecureChannelResponse,PartS_3395: bitstring,ST_3396: bitstring,TTL_3397: bitstring) = m2_3394 in
                                                            {3019}let Kcli_3398: bitstring = exp(PartS_3395,Nc_3390) in
                                                            {3020}out(c, senc(mCli(pkCli_2991,pkSess_3387),Kcli_3398))
                                                    )
                                                    else
                                                        {3021}let pkSess_3399: bitstring = fail-any in
                                                        {3022}out(c, GetEndpointRequest);
                                                        {3023}in(c, (=GetEndpointResponse,=pkSess_3399,=None,SP_3400: bitstring,UP_3401: bitstring));
                                                        {3024}new Nc_3402: bitstring;
                                                        {3025}let gNc_3403: bitstring = exp(g,Nc_3402) in
                                                        {3026}let m1_3404: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3403) in
                                                        {3027}out(c, (pkCli_2991,m1_3404));
                                                        {3028}in(c, em2_3405: bitstring);
                                                        {3029}let m2_3406: bitstring = em2_3405 in
                                                        {3030}let (=OpenSecureChannelResponse,PartS_3407: bitstring,ST_3408: bitstring,TTL_3409: bitstring) = m2_3406 in
                                                        {3031}let Kcli_3410: bitstring = exp(PartS_3407,Nc_3402) in
                                                        {3032}out(c, senc(mCli(pkCli_2991,pkSess_3399),Kcli_3410))
                                            )
                                            else
                                                {3033}let pkSess_3411: bitstring = fail-any in
                                                {3034}out(c, GetEndpointRequest);
                                                {3035}in(c, (=GetEndpointResponse,=pkSess_3411,=None,SP_3412: bitstring,UP_3413: bitstring));
                                                {3036}new Nc_3414: bitstring;
                                                {3037}let gNc_3415: bitstring = exp(g,Nc_3414) in
                                                {3038}let m1_3416: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3415) in
                                                {3039}out(c, (pkCli_2991,m1_3416));
                                                {3040}in(c, em2_3417: bitstring);
                                                {3041}let m2_3418: bitstring = em2_3417 in
                                                {3042}let (=OpenSecureChannelResponse,PartS_3419: bitstring,ST_3420: bitstring,TTL_3421: bitstring) = m2_3418 in
                                                {3043}let Kcli_3422: bitstring = exp(PartS_3419,Nc_3414) in
                                                {3044}out(c, senc(mCli(pkCli_2991,pkSess_3411),Kcli_3422))
                                    )
                                    else
                                        {3045}let pkSess_3423: bitstring = fail-any in
                                        {3046}out(c, GetEndpointRequest);
                                        {3047}in(c, (=GetEndpointResponse,=pkSess_3423,=None,SP_3424: bitstring,UP_3425: bitstring));
                                        {3048}new Nc_3426: bitstring;
                                        {3049}let gNc_3427: bitstring = exp(g,Nc_3426) in
                                        {3050}let m1_3428: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3427) in
                                        {3051}out(c, (pkCli_2991,m1_3428));
                                        {3052}in(c, em2_3429: bitstring);
                                        {3053}let m2_3430: bitstring = em2_3429 in
                                        {3054}let (=OpenSecureChannelResponse,PartS_3431: bitstring,ST_3432: bitstring,TTL_3433: bitstring) = m2_3430 in
                                        {3055}let Kcli_3434: bitstring = exp(PartS_3431,Nc_3426) in
                                        {3056}out(c, senc(mCli(pkCli_2991,pkSess_3423),Kcli_3434))
                        )
                        else
                            {3057}let pkDisco_3435: bitstring = fail-any in
                            {3058}let v_3436: bool = (Sess = A) in
                            (
                                {3059}if v_3436 then
                                (
                                    {3060}let pkSess_3437: bitstring = pub(skA) in
                                    {3061}out(c, GetEndpointRequest);
                                    {3062}in(c, (=GetEndpointResponse,=pkSess_3437,=None,SP_3438: bitstring,UP_3439: bitstring));
                                    {3063}new Nc_3440: bitstring;
                                    {3064}let gNc_3441: bitstring = exp(g,Nc_3440) in
                                    {3065}let m1_3442: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3441) in
                                    {3066}out(c, (pkCli_2991,m1_3442));
                                    {3067}in(c, em2_3443: bitstring);
                                    {3068}let m2_3444: bitstring = em2_3443 in
                                    {3069}let (=OpenSecureChannelResponse,PartS_3445: bitstring,ST_3446: bitstring,TTL_3447: bitstring) = m2_3444 in
                                    {3070}let Kcli_3448: bitstring = exp(PartS_3445,Nc_3440) in
                                    {3071}out(c, senc(mCli(pkCli_2991,pkSess_3437),Kcli_3448))
                                )
                                else
                                    {3072}let v_3449: bool = (Sess = B) in
                                    (
                                        {3073}if v_3449 then
                                        (
                                            {3074}let pkSess_3450: bitstring = pub(skB) in
                                            {3075}out(c, GetEndpointRequest);
                                            {3076}in(c, (=GetEndpointResponse,=pkSess_3450,=None,SP_3451: bitstring,UP_3452: bitstring));
                                            {3077}new Nc_3453: bitstring;
                                            {3078}let gNc_3454: bitstring = exp(g,Nc_3453) in
                                            {3079}let m1_3455: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3454) in
                                            {3080}out(c, (pkCli_2991,m1_3455));
                                            {3081}in(c, em2_3456: bitstring);
                                            {3082}let m2_3457: bitstring = em2_3456 in
                                            {3083}let (=OpenSecureChannelResponse,PartS_3458: bitstring,ST_3459: bitstring,TTL_3460: bitstring) = m2_3457 in
                                            {3084}let Kcli_3461: bitstring = exp(PartS_3458,Nc_3453) in
                                            {3085}out(c, senc(mCli(pkCli_2991,pkSess_3450),Kcli_3461))
                                        )
                                        else
                                            {3086}let v_3462: bool = (Sess = C) in
                                            (
                                                {3087}if v_3462 then
                                                (
                                                    {3088}let pkSess_3463: bitstring = pub(skC) in
                                                    {3089}out(c, GetEndpointRequest);
                                                    {3090}in(c, (=GetEndpointResponse,=pkSess_3463,=None,SP_3464: bitstring,UP_3465: bitstring));
                                                    {3091}new Nc_3466: bitstring;
                                                    {3092}let gNc_3467: bitstring = exp(g,Nc_3466) in
                                                    {3093}let m1_3468: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3467) in
                                                    {3094}out(c, (pkCli_2991,m1_3468));
                                                    {3095}in(c, em2_3469: bitstring);
                                                    {3096}let m2_3470: bitstring = em2_3469 in
                                                    {3097}let (=OpenSecureChannelResponse,PartS_3471: bitstring,ST_3472: bitstring,TTL_3473: bitstring) = m2_3470 in
                                                    {3098}let Kcli_3474: bitstring = exp(PartS_3471,Nc_3466) in
                                                    {3099}out(c, senc(mCli(pkCli_2991,pkSess_3463),Kcli_3474))
                                                )
                                                else
                                                    {3100}let pkSess_3475: bitstring = pub(sk(Sess)) in
                                                    {3101}out(c, GetEndpointRequest);
                                                    {3102}in(c, (=GetEndpointResponse,=pkSess_3475,=None,SP_3476: bitstring,UP_3477: bitstring));
                                                    {3103}new Nc_3478: bitstring;
                                                    {3104}let gNc_3479: bitstring = exp(g,Nc_3478) in
                                                    {3105}let m1_3480: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3479) in
                                                    {3106}out(c, (pkCli_2991,m1_3480));
                                                    {3107}in(c, em2_3481: bitstring);
                                                    {3108}let m2_3482: bitstring = em2_3481 in
                                                    {3109}let (=OpenSecureChannelResponse,PartS_3483: bitstring,ST_3484: bitstring,TTL_3485: bitstring) = m2_3482 in
                                                    {3110}let Kcli_3486: bitstring = exp(PartS_3483,Nc_3478) in
                                                    {3111}out(c, senc(mCli(pkCli_2991,pkSess_3475),Kcli_3486))
                                            )
                                            else
                                                {3112}let pkSess_3487: bitstring = fail-any in
                                                {3113}out(c, GetEndpointRequest);
                                                {3114}in(c, (=GetEndpointResponse,=pkSess_3487,=None,SP_3488: bitstring,UP_3489: bitstring));
                                                {3115}new Nc_3490: bitstring;
                                                {3116}let gNc_3491: bitstring = exp(g,Nc_3490) in
                                                {3117}let m1_3492: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3491) in
                                                {3118}out(c, (pkCli_2991,m1_3492));
                                                {3119}in(c, em2_3493: bitstring);
                                                {3120}let m2_3494: bitstring = em2_3493 in
                                                {3121}let (=OpenSecureChannelResponse,PartS_3495: bitstring,ST_3496: bitstring,TTL_3497: bitstring) = m2_3494 in
                                                {3122}let Kcli_3498: bitstring = exp(PartS_3495,Nc_3490) in
                                                {3123}out(c, senc(mCli(pkCli_2991,pkSess_3487),Kcli_3498))
                                    )
                                    else
                                        {3124}let pkSess_3499: bitstring = fail-any in
                                        {3125}out(c, GetEndpointRequest);
                                        {3126}in(c, (=GetEndpointResponse,=pkSess_3499,=None,SP_3500: bitstring,UP_3501: bitstring));
                                        {3127}new Nc_3502: bitstring;
                                        {3128}let gNc_3503: bitstring = exp(g,Nc_3502) in
                                        {3129}let m1_3504: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3503) in
                                        {3130}out(c, (pkCli_2991,m1_3504));
                                        {3131}in(c, em2_3505: bitstring);
                                        {3132}let m2_3506: bitstring = em2_3505 in
                                        {3133}let (=OpenSecureChannelResponse,PartS_3507: bitstring,ST_3508: bitstring,TTL_3509: bitstring) = m2_3506 in
                                        {3134}let Kcli_3510: bitstring = exp(PartS_3507,Nc_3502) in
                                        {3135}out(c, senc(mCli(pkCli_2991,pkSess_3499),Kcli_3510))
                            )
                            else
                                {3136}let pkSess_3511: bitstring = fail-any in
                                {3137}out(c, GetEndpointRequest);
                                {3138}in(c, (=GetEndpointResponse,=pkSess_3511,=None,SP_3512: bitstring,UP_3513: bitstring));
                                {3139}new Nc_3514: bitstring;
                                {3140}let gNc_3515: bitstring = exp(g,Nc_3514) in
                                {3141}let m1_3516: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3515) in
                                {3142}out(c, (pkCli_2991,m1_3516));
                                {3143}in(c, em2_3517: bitstring);
                                {3144}let m2_3518: bitstring = em2_3517 in
                                {3145}let (=OpenSecureChannelResponse,PartS_3519: bitstring,ST_3520: bitstring,TTL_3521: bitstring) = m2_3518 in
                                {3146}let Kcli_3522: bitstring = exp(PartS_3519,Nc_3514) in
                                {3147}out(c, senc(mCli(pkCli_2991,pkSess_3511),Kcli_3522))
                )
                else
                    {3148}let pkDisco_3523: bitstring = fail-any in
                    {3149}let v_3524: bool = (Sess = A) in
                    (
                        {3150}if v_3524 then
                        (
                            {3151}let pkSess_3525: bitstring = pub(skA) in
                            {3152}out(c, GetEndpointRequest);
                            {3153}in(c, (=GetEndpointResponse,=pkSess_3525,=None,SP_3526: bitstring,UP_3527: bitstring));
                            {3154}new Nc_3528: bitstring;
                            {3155}let gNc_3529: bitstring = exp(g,Nc_3528) in
                            {3156}let m1_3530: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3529) in
                            {3157}out(c, (pkCli_2991,m1_3530));
                            {3158}in(c, em2_3531: bitstring);
                            {3159}let m2_3532: bitstring = em2_3531 in
                            {3160}let (=OpenSecureChannelResponse,PartS_3533: bitstring,ST_3534: bitstring,TTL_3535: bitstring) = m2_3532 in
                            {3161}let Kcli_3536: bitstring = exp(PartS_3533,Nc_3528) in
                            {3162}out(c, senc(mCli(pkCli_2991,pkSess_3525),Kcli_3536))
                        )
                        else
                            {3163}let v_3537: bool = (Sess = B) in
                            (
                                {3164}if v_3537 then
                                (
                                    {3165}let pkSess_3538: bitstring = pub(skB) in
                                    {3166}out(c, GetEndpointRequest);
                                    {3167}in(c, (=GetEndpointResponse,=pkSess_3538,=None,SP_3539: bitstring,UP_3540: bitstring));
                                    {3168}new Nc_3541: bitstring;
                                    {3169}let gNc_3542: bitstring = exp(g,Nc_3541) in
                                    {3170}let m1_3543: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3542) in
                                    {3171}out(c, (pkCli_2991,m1_3543));
                                    {3172}in(c, em2_3544: bitstring);
                                    {3173}let m2_3545: bitstring = em2_3544 in
                                    {3174}let (=OpenSecureChannelResponse,PartS_3546: bitstring,ST_3547: bitstring,TTL_3548: bitstring) = m2_3545 in
                                    {3175}let Kcli_3549: bitstring = exp(PartS_3546,Nc_3541) in
                                    {3176}out(c, senc(mCli(pkCli_2991,pkSess_3538),Kcli_3549))
                                )
                                else
                                    {3177}let v_3550: bool = (Sess = C) in
                                    (
                                        {3178}if v_3550 then
                                        (
                                            {3179}let pkSess_3551: bitstring = pub(skC) in
                                            {3180}out(c, GetEndpointRequest);
                                            {3181}in(c, (=GetEndpointResponse,=pkSess_3551,=None,SP_3552: bitstring,UP_3553: bitstring));
                                            {3182}new Nc_3554: bitstring;
                                            {3183}let gNc_3555: bitstring = exp(g,Nc_3554) in
                                            {3184}let m1_3556: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3555) in
                                            {3185}out(c, (pkCli_2991,m1_3556));
                                            {3186}in(c, em2_3557: bitstring);
                                            {3187}let m2_3558: bitstring = em2_3557 in
                                            {3188}let (=OpenSecureChannelResponse,PartS_3559: bitstring,ST_3560: bitstring,TTL_3561: bitstring) = m2_3558 in
                                            {3189}let Kcli_3562: bitstring = exp(PartS_3559,Nc_3554) in
                                            {3190}out(c, senc(mCli(pkCli_2991,pkSess_3551),Kcli_3562))
                                        )
                                        else
                                            {3191}let pkSess_3563: bitstring = pub(sk(Sess)) in
                                            {3192}out(c, GetEndpointRequest);
                                            {3193}in(c, (=GetEndpointResponse,=pkSess_3563,=None,SP_3564: bitstring,UP_3565: bitstring));
                                            {3194}new Nc_3566: bitstring;
                                            {3195}let gNc_3567: bitstring = exp(g,Nc_3566) in
                                            {3196}let m1_3568: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3567) in
                                            {3197}out(c, (pkCli_2991,m1_3568));
                                            {3198}in(c, em2_3569: bitstring);
                                            {3199}let m2_3570: bitstring = em2_3569 in
                                            {3200}let (=OpenSecureChannelResponse,PartS_3571: bitstring,ST_3572: bitstring,TTL_3573: bitstring) = m2_3570 in
                                            {3201}let Kcli_3574: bitstring = exp(PartS_3571,Nc_3566) in
                                            {3202}out(c, senc(mCli(pkCli_2991,pkSess_3563),Kcli_3574))
                                    )
                                    else
                                        {3203}let pkSess_3575: bitstring = fail-any in
                                        {3204}out(c, GetEndpointRequest);
                                        {3205}in(c, (=GetEndpointResponse,=pkSess_3575,=None,SP_3576: bitstring,UP_3577: bitstring));
                                        {3206}new Nc_3578: bitstring;
                                        {3207}let gNc_3579: bitstring = exp(g,Nc_3578) in
                                        {3208}let m1_3580: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3579) in
                                        {3209}out(c, (pkCli_2991,m1_3580));
                                        {3210}in(c, em2_3581: bitstring);
                                        {3211}let m2_3582: bitstring = em2_3581 in
                                        {3212}let (=OpenSecureChannelResponse,PartS_3583: bitstring,ST_3584: bitstring,TTL_3585: bitstring) = m2_3582 in
                                        {3213}let Kcli_3586: bitstring = exp(PartS_3583,Nc_3578) in
                                        {3214}out(c, senc(mCli(pkCli_2991,pkSess_3575),Kcli_3586))
                            )
                            else
                                {3215}let pkSess_3587: bitstring = fail-any in
                                {3216}out(c, GetEndpointRequest);
                                {3217}in(c, (=GetEndpointResponse,=pkSess_3587,=None,SP_3588: bitstring,UP_3589: bitstring));
                                {3218}new Nc_3590: bitstring;
                                {3219}let gNc_3591: bitstring = exp(g,Nc_3590) in
                                {3220}let m1_3592: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3591) in
                                {3221}out(c, (pkCli_2991,m1_3592));
                                {3222}in(c, em2_3593: bitstring);
                                {3223}let m2_3594: bitstring = em2_3593 in
                                {3224}let (=OpenSecureChannelResponse,PartS_3595: bitstring,ST_3596: bitstring,TTL_3597: bitstring) = m2_3594 in
                                {3225}let Kcli_3598: bitstring = exp(PartS_3595,Nc_3590) in
                                {3226}out(c, senc(mCli(pkCli_2991,pkSess_3587),Kcli_3598))
                    )
                    else
                        {3227}let pkSess_3599: bitstring = fail-any in
                        {3228}out(c, GetEndpointRequest);
                        {3229}in(c, (=GetEndpointResponse,=pkSess_3599,=None,SP_3600: bitstring,UP_3601: bitstring));
                        {3230}new Nc_3602: bitstring;
                        {3231}let gNc_3603: bitstring = exp(g,Nc_3602) in
                        {3232}let m1_3604: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3603) in
                        {3233}out(c, (pkCli_2991,m1_3604));
                        {3234}in(c, em2_3605: bitstring);
                        {3235}let m2_3606: bitstring = em2_3605 in
                        {3236}let (=OpenSecureChannelResponse,PartS_3607: bitstring,ST_3608: bitstring,TTL_3609: bitstring) = m2_3606 in
                        {3237}let Kcli_3610: bitstring = exp(PartS_3607,Nc_3602) in
                        {3238}out(c, senc(mCli(pkCli_2991,pkSess_3599),Kcli_3610))
    )
    else
        {3239}let skCli_3611: bitstring = fail-any in
        {3240}let pkCli_3612: bitstring = pub(skCli_3611) in
        {3241}let v_3613: bool = (Disco = A) in
        (
            {3242}if v_3613 then
            (
                {3243}let pkDisco_3614: bitstring = pub(skA) in
                {3244}let v_3615: bool = (Sess = A) in
                (
                    {3245}if v_3615 then
                    (
                        {3246}let pkSess_3616: bitstring = pub(skA) in
                        {3247}out(c, GetEndpointRequest);
                        {3248}in(c, (=GetEndpointResponse,=pkSess_3616,=None,SP_3617: bitstring,UP_3618: bitstring));
                        {3249}new Nc_3619: bitstring;
                        {3250}let gNc_3620: bitstring = exp(g,Nc_3619) in
                        {3251}let m1_3621: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3620) in
                        {3252}out(c, (pkCli_3612,m1_3621));
                        {3253}in(c, em2_3622: bitstring);
                        {3254}let m2_3623: bitstring = em2_3622 in
                        {3255}let (=OpenSecureChannelResponse,PartS_3624: bitstring,ST_3625: bitstring,TTL_3626: bitstring) = m2_3623 in
                        {3256}let Kcli_3627: bitstring = exp(PartS_3624,Nc_3619) in
                        {3257}out(c, senc(mCli(pkCli_3612,pkSess_3616),Kcli_3627))
                    )
                    else
                        {3258}let v_3628: bool = (Sess = B) in
                        (
                            {3259}if v_3628 then
                            (
                                {3260}let pkSess_3629: bitstring = pub(skB) in
                                {3261}out(c, GetEndpointRequest);
                                {3262}in(c, (=GetEndpointResponse,=pkSess_3629,=None,SP_3630: bitstring,UP_3631: bitstring));
                                {3263}new Nc_3632: bitstring;
                                {3264}let gNc_3633: bitstring = exp(g,Nc_3632) in
                                {3265}let m1_3634: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3633) in
                                {3266}out(c, (pkCli_3612,m1_3634));
                                {3267}in(c, em2_3635: bitstring);
                                {3268}let m2_3636: bitstring = em2_3635 in
                                {3269}let (=OpenSecureChannelResponse,PartS_3637: bitstring,ST_3638: bitstring,TTL_3639: bitstring) = m2_3636 in
                                {3270}let Kcli_3640: bitstring = exp(PartS_3637,Nc_3632) in
                                {3271}out(c, senc(mCli(pkCli_3612,pkSess_3629),Kcli_3640))
                            )
                            else
                                {3272}let v_3641: bool = (Sess = C) in
                                (
                                    {3273}if v_3641 then
                                    (
                                        {3274}let pkSess_3642: bitstring = pub(skC) in
                                        {3275}out(c, GetEndpointRequest);
                                        {3276}in(c, (=GetEndpointResponse,=pkSess_3642,=None,SP_3643: bitstring,UP_3644: bitstring));
                                        {3277}new Nc_3645: bitstring;
                                        {3278}let gNc_3646: bitstring = exp(g,Nc_3645) in
                                        {3279}let m1_3647: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3646) in
                                        {3280}out(c, (pkCli_3612,m1_3647));
                                        {3281}in(c, em2_3648: bitstring);
                                        {3282}let m2_3649: bitstring = em2_3648 in
                                        {3283}let (=OpenSecureChannelResponse,PartS_3650: bitstring,ST_3651: bitstring,TTL_3652: bitstring) = m2_3649 in
                                        {3284}let Kcli_3653: bitstring = exp(PartS_3650,Nc_3645) in
                                        {3285}out(c, senc(mCli(pkCli_3612,pkSess_3642),Kcli_3653))
                                    )
                                    else
                                        {3286}let pkSess_3654: bitstring = pub(sk(Sess)) in
                                        {3287}out(c, GetEndpointRequest);
                                        {3288}in(c, (=GetEndpointResponse,=pkSess_3654,=None,SP_3655: bitstring,UP_3656: bitstring));
                                        {3289}new Nc_3657: bitstring;
                                        {3290}let gNc_3658: bitstring = exp(g,Nc_3657) in
                                        {3291}let m1_3659: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3658) in
                                        {3292}out(c, (pkCli_3612,m1_3659));
                                        {3293}in(c, em2_3660: bitstring);
                                        {3294}let m2_3661: bitstring = em2_3660 in
                                        {3295}let (=OpenSecureChannelResponse,PartS_3662: bitstring,ST_3663: bitstring,TTL_3664: bitstring) = m2_3661 in
                                        {3296}let Kcli_3665: bitstring = exp(PartS_3662,Nc_3657) in
                                        {3297}out(c, senc(mCli(pkCli_3612,pkSess_3654),Kcli_3665))
                                )
                                else
                                    {3298}let pkSess_3666: bitstring = fail-any in
                                    {3299}out(c, GetEndpointRequest);
                                    {3300}in(c, (=GetEndpointResponse,=pkSess_3666,=None,SP_3667: bitstring,UP_3668: bitstring));
                                    {3301}new Nc_3669: bitstring;
                                    {3302}let gNc_3670: bitstring = exp(g,Nc_3669) in
                                    {3303}let m1_3671: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3670) in
                                    {3304}out(c, (pkCli_3612,m1_3671));
                                    {3305}in(c, em2_3672: bitstring);
                                    {3306}let m2_3673: bitstring = em2_3672 in
                                    {3307}let (=OpenSecureChannelResponse,PartS_3674: bitstring,ST_3675: bitstring,TTL_3676: bitstring) = m2_3673 in
                                    {3308}let Kcli_3677: bitstring = exp(PartS_3674,Nc_3669) in
                                    {3309}out(c, senc(mCli(pkCli_3612,pkSess_3666),Kcli_3677))
                        )
                        else
                            {3310}let pkSess_3678: bitstring = fail-any in
                            {3311}out(c, GetEndpointRequest);
                            {3312}in(c, (=GetEndpointResponse,=pkSess_3678,=None,SP_3679: bitstring,UP_3680: bitstring));
                            {3313}new Nc_3681: bitstring;
                            {3314}let gNc_3682: bitstring = exp(g,Nc_3681) in
                            {3315}let m1_3683: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3682) in
                            {3316}out(c, (pkCli_3612,m1_3683));
                            {3317}in(c, em2_3684: bitstring);
                            {3318}let m2_3685: bitstring = em2_3684 in
                            {3319}let (=OpenSecureChannelResponse,PartS_3686: bitstring,ST_3687: bitstring,TTL_3688: bitstring) = m2_3685 in
                            {3320}let Kcli_3689: bitstring = exp(PartS_3686,Nc_3681) in
                            {3321}out(c, senc(mCli(pkCli_3612,pkSess_3678),Kcli_3689))
                )
                else
                    {3322}let pkSess_3690: bitstring = fail-any in
                    {3323}out(c, GetEndpointRequest);
                    {3324}in(c, (=GetEndpointResponse,=pkSess_3690,=None,SP_3691: bitstring,UP_3692: bitstring));
                    {3325}new Nc_3693: bitstring;
                    {3326}let gNc_3694: bitstring = exp(g,Nc_3693) in
                    {3327}let m1_3695: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3694) in
                    {3328}out(c, (pkCli_3612,m1_3695));
                    {3329}in(c, em2_3696: bitstring);
                    {3330}let m2_3697: bitstring = em2_3696 in
                    {3331}let (=OpenSecureChannelResponse,PartS_3698: bitstring,ST_3699: bitstring,TTL_3700: bitstring) = m2_3697 in
                    {3332}let Kcli_3701: bitstring = exp(PartS_3698,Nc_3693) in
                    {3333}out(c, senc(mCli(pkCli_3612,pkSess_3690),Kcli_3701))
            )
            else
                {3334}let v_3702: bool = (Disco = B) in
                (
                    {3335}if v_3702 then
                    (
                        {3336}let pkDisco_3703: bitstring = pub(skB) in
                        {3337}let v_3704: bool = (Sess = A) in
                        (
                            {3338}if v_3704 then
                            (
                                {3339}let pkSess_3705: bitstring = pub(skA) in
                                {3340}out(c, GetEndpointRequest);
                                {3341}in(c, (=GetEndpointResponse,=pkSess_3705,=None,SP_3706: bitstring,UP_3707: bitstring));
                                {3342}new Nc_3708: bitstring;
                                {3343}let gNc_3709: bitstring = exp(g,Nc_3708) in
                                {3344}let m1_3710: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3709) in
                                {3345}out(c, (pkCli_3612,m1_3710));
                                {3346}in(c, em2_3711: bitstring);
                                {3347}let m2_3712: bitstring = em2_3711 in
                                {3348}let (=OpenSecureChannelResponse,PartS_3713: bitstring,ST_3714: bitstring,TTL_3715: bitstring) = m2_3712 in
                                {3349}let Kcli_3716: bitstring = exp(PartS_3713,Nc_3708) in
                                {3350}out(c, senc(mCli(pkCli_3612,pkSess_3705),Kcli_3716))
                            )
                            else
                                {3351}let v_3717: bool = (Sess = B) in
                                (
                                    {3352}if v_3717 then
                                    (
                                        {3353}let pkSess_3718: bitstring = pub(skB) in
                                        {3354}out(c, GetEndpointRequest);
                                        {3355}in(c, (=GetEndpointResponse,=pkSess_3718,=None,SP_3719: bitstring,UP_3720: bitstring));
                                        {3356}new Nc_3721: bitstring;
                                        {3357}let gNc_3722: bitstring = exp(g,Nc_3721) in
                                        {3358}let m1_3723: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3722) in
                                        {3359}out(c, (pkCli_3612,m1_3723));
                                        {3360}in(c, em2_3724: bitstring);
                                        {3361}let m2_3725: bitstring = em2_3724 in
                                        {3362}let (=OpenSecureChannelResponse,PartS_3726: bitstring,ST_3727: bitstring,TTL_3728: bitstring) = m2_3725 in
                                        {3363}let Kcli_3729: bitstring = exp(PartS_3726,Nc_3721) in
                                        {3364}out(c, senc(mCli(pkCli_3612,pkSess_3718),Kcli_3729))
                                    )
                                    else
                                        {3365}let v_3730: bool = (Sess = C) in
                                        (
                                            {3366}if v_3730 then
                                            (
                                                {3367}let pkSess_3731: bitstring = pub(skC) in
                                                {3368}out(c, GetEndpointRequest);
                                                {3369}in(c, (=GetEndpointResponse,=pkSess_3731,=None,SP_3732: bitstring,UP_3733: bitstring));
                                                {3370}new Nc_3734: bitstring;
                                                {3371}let gNc_3735: bitstring = exp(g,Nc_3734) in
                                                {3372}let m1_3736: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3735) in
                                                {3373}out(c, (pkCli_3612,m1_3736));
                                                {3374}in(c, em2_3737: bitstring);
                                                {3375}let m2_3738: bitstring = em2_3737 in
                                                {3376}let (=OpenSecureChannelResponse,PartS_3739: bitstring,ST_3740: bitstring,TTL_3741: bitstring) = m2_3738 in
                                                {3377}let Kcli_3742: bitstring = exp(PartS_3739,Nc_3734) in
                                                {3378}out(c, senc(mCli(pkCli_3612,pkSess_3731),Kcli_3742))
                                            )
                                            else
                                                {3379}let pkSess_3743: bitstring = pub(sk(Sess)) in
                                                {3380}out(c, GetEndpointRequest);
                                                {3381}in(c, (=GetEndpointResponse,=pkSess_3743,=None,SP_3744: bitstring,UP_3745: bitstring));
                                                {3382}new Nc_3746: bitstring;
                                                {3383}let gNc_3747: bitstring = exp(g,Nc_3746) in
                                                {3384}let m1_3748: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3747) in
                                                {3385}out(c, (pkCli_3612,m1_3748));
                                                {3386}in(c, em2_3749: bitstring);
                                                {3387}let m2_3750: bitstring = em2_3749 in
                                                {3388}let (=OpenSecureChannelResponse,PartS_3751: bitstring,ST_3752: bitstring,TTL_3753: bitstring) = m2_3750 in
                                                {3389}let Kcli_3754: bitstring = exp(PartS_3751,Nc_3746) in
                                                {3390}out(c, senc(mCli(pkCli_3612,pkSess_3743),Kcli_3754))
                                        )
                                        else
                                            {3391}let pkSess_3755: bitstring = fail-any in
                                            {3392}out(c, GetEndpointRequest);
                                            {3393}in(c, (=GetEndpointResponse,=pkSess_3755,=None,SP_3756: bitstring,UP_3757: bitstring));
                                            {3394}new Nc_3758: bitstring;
                                            {3395}let gNc_3759: bitstring = exp(g,Nc_3758) in
                                            {3396}let m1_3760: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3759) in
                                            {3397}out(c, (pkCli_3612,m1_3760));
                                            {3398}in(c, em2_3761: bitstring);
                                            {3399}let m2_3762: bitstring = em2_3761 in
                                            {3400}let (=OpenSecureChannelResponse,PartS_3763: bitstring,ST_3764: bitstring,TTL_3765: bitstring) = m2_3762 in
                                            {3401}let Kcli_3766: bitstring = exp(PartS_3763,Nc_3758) in
                                            {3402}out(c, senc(mCli(pkCli_3612,pkSess_3755),Kcli_3766))
                                )
                                else
                                    {3403}let pkSess_3767: bitstring = fail-any in
                                    {3404}out(c, GetEndpointRequest);
                                    {3405}in(c, (=GetEndpointResponse,=pkSess_3767,=None,SP_3768: bitstring,UP_3769: bitstring));
                                    {3406}new Nc_3770: bitstring;
                                    {3407}let gNc_3771: bitstring = exp(g,Nc_3770) in
                                    {3408}let m1_3772: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3771) in
                                    {3409}out(c, (pkCli_3612,m1_3772));
                                    {3410}in(c, em2_3773: bitstring);
                                    {3411}let m2_3774: bitstring = em2_3773 in
                                    {3412}let (=OpenSecureChannelResponse,PartS_3775: bitstring,ST_3776: bitstring,TTL_3777: bitstring) = m2_3774 in
                                    {3413}let Kcli_3778: bitstring = exp(PartS_3775,Nc_3770) in
                                    {3414}out(c, senc(mCli(pkCli_3612,pkSess_3767),Kcli_3778))
                        )
                        else
                            {3415}let pkSess_3779: bitstring = fail-any in
                            {3416}out(c, GetEndpointRequest);
                            {3417}in(c, (=GetEndpointResponse,=pkSess_3779,=None,SP_3780: bitstring,UP_3781: bitstring));
                            {3418}new Nc_3782: bitstring;
                            {3419}let gNc_3783: bitstring = exp(g,Nc_3782) in
                            {3420}let m1_3784: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3783) in
                            {3421}out(c, (pkCli_3612,m1_3784));
                            {3422}in(c, em2_3785: bitstring);
                            {3423}let m2_3786: bitstring = em2_3785 in
                            {3424}let (=OpenSecureChannelResponse,PartS_3787: bitstring,ST_3788: bitstring,TTL_3789: bitstring) = m2_3786 in
                            {3425}let Kcli_3790: bitstring = exp(PartS_3787,Nc_3782) in
                            {3426}out(c, senc(mCli(pkCli_3612,pkSess_3779),Kcli_3790))
                    )
                    else
                        {3427}let v_3791: bool = (Disco = C) in
                        (
                            {3428}if v_3791 then
                            (
                                {3429}let pkDisco_3792: bitstring = pub(skC) in
                                {3430}let v_3793: bool = (Sess = A) in
                                (
                                    {3431}if v_3793 then
                                    (
                                        {3432}let pkSess_3794: bitstring = pub(skA) in
                                        {3433}out(c, GetEndpointRequest);
                                        {3434}in(c, (=GetEndpointResponse,=pkSess_3794,=None,SP_3795: bitstring,UP_3796: bitstring));
                                        {3435}new Nc_3797: bitstring;
                                        {3436}let gNc_3798: bitstring = exp(g,Nc_3797) in
                                        {3437}let m1_3799: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3798) in
                                        {3438}out(c, (pkCli_3612,m1_3799));
                                        {3439}in(c, em2_3800: bitstring);
                                        {3440}let m2_3801: bitstring = em2_3800 in
                                        {3441}let (=OpenSecureChannelResponse,PartS_3802: bitstring,ST_3803: bitstring,TTL_3804: bitstring) = m2_3801 in
                                        {3442}let Kcli_3805: bitstring = exp(PartS_3802,Nc_3797) in
                                        {3443}out(c, senc(mCli(pkCli_3612,pkSess_3794),Kcli_3805))
                                    )
                                    else
                                        {3444}let v_3806: bool = (Sess = B) in
                                        (
                                            {3445}if v_3806 then
                                            (
                                                {3446}let pkSess_3807: bitstring = pub(skB) in
                                                {3447}out(c, GetEndpointRequest);
                                                {3448}in(c, (=GetEndpointResponse,=pkSess_3807,=None,SP_3808: bitstring,UP_3809: bitstring));
                                                {3449}new Nc_3810: bitstring;
                                                {3450}let gNc_3811: bitstring = exp(g,Nc_3810) in
                                                {3451}let m1_3812: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3811) in
                                                {3452}out(c, (pkCli_3612,m1_3812));
                                                {3453}in(c, em2_3813: bitstring);
                                                {3454}let m2_3814: bitstring = em2_3813 in
                                                {3455}let (=OpenSecureChannelResponse,PartS_3815: bitstring,ST_3816: bitstring,TTL_3817: bitstring) = m2_3814 in
                                                {3456}let Kcli_3818: bitstring = exp(PartS_3815,Nc_3810) in
                                                {3457}out(c, senc(mCli(pkCli_3612,pkSess_3807),Kcli_3818))
                                            )
                                            else
                                                {3458}let v_3819: bool = (Sess = C) in
                                                (
                                                    {3459}if v_3819 then
                                                    (
                                                        {3460}let pkSess_3820: bitstring = pub(skC) in
                                                        {3461}out(c, GetEndpointRequest);
                                                        {3462}in(c, (=GetEndpointResponse,=pkSess_3820,=None,SP_3821: bitstring,UP_3822: bitstring));
                                                        {3463}new Nc_3823: bitstring;
                                                        {3464}let gNc_3824: bitstring = exp(g,Nc_3823) in
                                                        {3465}let m1_3825: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3824) in
                                                        {3466}out(c, (pkCli_3612,m1_3825));
                                                        {3467}in(c, em2_3826: bitstring);
                                                        {3468}let m2_3827: bitstring = em2_3826 in
                                                        {3469}let (=OpenSecureChannelResponse,PartS_3828: bitstring,ST_3829: bitstring,TTL_3830: bitstring) = m2_3827 in
                                                        {3470}let Kcli_3831: bitstring = exp(PartS_3828,Nc_3823) in
                                                        {3471}out(c, senc(mCli(pkCli_3612,pkSess_3820),Kcli_3831))
                                                    )
                                                    else
                                                        {3472}let pkSess_3832: bitstring = pub(sk(Sess)) in
                                                        {3473}out(c, GetEndpointRequest);
                                                        {3474}in(c, (=GetEndpointResponse,=pkSess_3832,=None,SP_3833: bitstring,UP_3834: bitstring));
                                                        {3475}new Nc_3835: bitstring;
                                                        {3476}let gNc_3836: bitstring = exp(g,Nc_3835) in
                                                        {3477}let m1_3837: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3836) in
                                                        {3478}out(c, (pkCli_3612,m1_3837));
                                                        {3479}in(c, em2_3838: bitstring);
                                                        {3480}let m2_3839: bitstring = em2_3838 in
                                                        {3481}let (=OpenSecureChannelResponse,PartS_3840: bitstring,ST_3841: bitstring,TTL_3842: bitstring) = m2_3839 in
                                                        {3482}let Kcli_3843: bitstring = exp(PartS_3840,Nc_3835) in
                                                        {3483}out(c, senc(mCli(pkCli_3612,pkSess_3832),Kcli_3843))
                                                )
                                                else
                                                    {3484}let pkSess_3844: bitstring = fail-any in
                                                    {3485}out(c, GetEndpointRequest);
                                                    {3486}in(c, (=GetEndpointResponse,=pkSess_3844,=None,SP_3845: bitstring,UP_3846: bitstring));
                                                    {3487}new Nc_3847: bitstring;
                                                    {3488}let gNc_3848: bitstring = exp(g,Nc_3847) in
                                                    {3489}let m1_3849: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3848) in
                                                    {3490}out(c, (pkCli_3612,m1_3849));
                                                    {3491}in(c, em2_3850: bitstring);
                                                    {3492}let m2_3851: bitstring = em2_3850 in
                                                    {3493}let (=OpenSecureChannelResponse,PartS_3852: bitstring,ST_3853: bitstring,TTL_3854: bitstring) = m2_3851 in
                                                    {3494}let Kcli_3855: bitstring = exp(PartS_3852,Nc_3847) in
                                                    {3495}out(c, senc(mCli(pkCli_3612,pkSess_3844),Kcli_3855))
                                        )
                                        else
                                            {3496}let pkSess_3856: bitstring = fail-any in
                                            {3497}out(c, GetEndpointRequest);
                                            {3498}in(c, (=GetEndpointResponse,=pkSess_3856,=None,SP_3857: bitstring,UP_3858: bitstring));
                                            {3499}new Nc_3859: bitstring;
                                            {3500}let gNc_3860: bitstring = exp(g,Nc_3859) in
                                            {3501}let m1_3861: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3860) in
                                            {3502}out(c, (pkCli_3612,m1_3861));
                                            {3503}in(c, em2_3862: bitstring);
                                            {3504}let m2_3863: bitstring = em2_3862 in
                                            {3505}let (=OpenSecureChannelResponse,PartS_3864: bitstring,ST_3865: bitstring,TTL_3866: bitstring) = m2_3863 in
                                            {3506}let Kcli_3867: bitstring = exp(PartS_3864,Nc_3859) in
                                            {3507}out(c, senc(mCli(pkCli_3612,pkSess_3856),Kcli_3867))
                                )
                                else
                                    {3508}let pkSess_3868: bitstring = fail-any in
                                    {3509}out(c, GetEndpointRequest);
                                    {3510}in(c, (=GetEndpointResponse,=pkSess_3868,=None,SP_3869: bitstring,UP_3870: bitstring));
                                    {3511}new Nc_3871: bitstring;
                                    {3512}let gNc_3872: bitstring = exp(g,Nc_3871) in
                                    {3513}let m1_3873: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3872) in
                                    {3514}out(c, (pkCli_3612,m1_3873));
                                    {3515}in(c, em2_3874: bitstring);
                                    {3516}let m2_3875: bitstring = em2_3874 in
                                    {3517}let (=OpenSecureChannelResponse,PartS_3876: bitstring,ST_3877: bitstring,TTL_3878: bitstring) = m2_3875 in
                                    {3518}let Kcli_3879: bitstring = exp(PartS_3876,Nc_3871) in
                                    {3519}out(c, senc(mCli(pkCli_3612,pkSess_3868),Kcli_3879))
                            )
                            else
                                {3520}let pkDisco_3880: bitstring = pub(sk(Disco)) in
                                {3521}let v_3881: bool = (Sess = A) in
                                (
                                    {3522}if v_3881 then
                                    (
                                        {3523}let pkSess_3882: bitstring = pub(skA) in
                                        {3524}out(c, GetEndpointRequest);
                                        {3525}in(c, (=GetEndpointResponse,=pkSess_3882,=None,SP_3883: bitstring,UP_3884: bitstring));
                                        {3526}new Nc_3885: bitstring;
                                        {3527}let gNc_3886: bitstring = exp(g,Nc_3885) in
                                        {3528}let m1_3887: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3886) in
                                        {3529}out(c, (pkCli_3612,m1_3887));
                                        {3530}in(c, em2_3888: bitstring);
                                        {3531}let m2_3889: bitstring = em2_3888 in
                                        {3532}let (=OpenSecureChannelResponse,PartS_3890: bitstring,ST_3891: bitstring,TTL_3892: bitstring) = m2_3889 in
                                        {3533}let Kcli_3893: bitstring = exp(PartS_3890,Nc_3885) in
                                        {3534}out(c, senc(mCli(pkCli_3612,pkSess_3882),Kcli_3893))
                                    )
                                    else
                                        {3535}let v_3894: bool = (Sess = B) in
                                        (
                                            {3536}if v_3894 then
                                            (
                                                {3537}let pkSess_3895: bitstring = pub(skB) in
                                                {3538}out(c, GetEndpointRequest);
                                                {3539}in(c, (=GetEndpointResponse,=pkSess_3895,=None,SP_3896: bitstring,UP_3897: bitstring));
                                                {3540}new Nc_3898: bitstring;
                                                {3541}let gNc_3899: bitstring = exp(g,Nc_3898) in
                                                {3542}let m1_3900: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3899) in
                                                {3543}out(c, (pkCli_3612,m1_3900));
                                                {3544}in(c, em2_3901: bitstring);
                                                {3545}let m2_3902: bitstring = em2_3901 in
                                                {3546}let (=OpenSecureChannelResponse,PartS_3903: bitstring,ST_3904: bitstring,TTL_3905: bitstring) = m2_3902 in
                                                {3547}let Kcli_3906: bitstring = exp(PartS_3903,Nc_3898) in
                                                {3548}out(c, senc(mCli(pkCli_3612,pkSess_3895),Kcli_3906))
                                            )
                                            else
                                                {3549}let v_3907: bool = (Sess = C) in
                                                (
                                                    {3550}if v_3907 then
                                                    (
                                                        {3551}let pkSess_3908: bitstring = pub(skC) in
                                                        {3552}out(c, GetEndpointRequest);
                                                        {3553}in(c, (=GetEndpointResponse,=pkSess_3908,=None,SP_3909: bitstring,UP_3910: bitstring));
                                                        {3554}new Nc_3911: bitstring;
                                                        {3555}let gNc_3912: bitstring = exp(g,Nc_3911) in
                                                        {3556}let m1_3913: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3912) in
                                                        {3557}out(c, (pkCli_3612,m1_3913));
                                                        {3558}in(c, em2_3914: bitstring);
                                                        {3559}let m2_3915: bitstring = em2_3914 in
                                                        {3560}let (=OpenSecureChannelResponse,PartS_3916: bitstring,ST_3917: bitstring,TTL_3918: bitstring) = m2_3915 in
                                                        {3561}let Kcli_3919: bitstring = exp(PartS_3916,Nc_3911) in
                                                        {3562}out(c, senc(mCli(pkCli_3612,pkSess_3908),Kcli_3919))
                                                    )
                                                    else
                                                        {3563}let pkSess_3920: bitstring = pub(sk(Sess)) in
                                                        {3564}out(c, GetEndpointRequest);
                                                        {3565}in(c, (=GetEndpointResponse,=pkSess_3920,=None,SP_3921: bitstring,UP_3922: bitstring));
                                                        {3566}new Nc_3923: bitstring;
                                                        {3567}let gNc_3924: bitstring = exp(g,Nc_3923) in
                                                        {3568}let m1_3925: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3924) in
                                                        {3569}out(c, (pkCli_3612,m1_3925));
                                                        {3570}in(c, em2_3926: bitstring);
                                                        {3571}let m2_3927: bitstring = em2_3926 in
                                                        {3572}let (=OpenSecureChannelResponse,PartS_3928: bitstring,ST_3929: bitstring,TTL_3930: bitstring) = m2_3927 in
                                                        {3573}let Kcli_3931: bitstring = exp(PartS_3928,Nc_3923) in
                                                        {3574}out(c, senc(mCli(pkCli_3612,pkSess_3920),Kcli_3931))
                                                )
                                                else
                                                    {3575}let pkSess_3932: bitstring = fail-any in
                                                    {3576}out(c, GetEndpointRequest);
                                                    {3577}in(c, (=GetEndpointResponse,=pkSess_3932,=None,SP_3933: bitstring,UP_3934: bitstring));
                                                    {3578}new Nc_3935: bitstring;
                                                    {3579}let gNc_3936: bitstring = exp(g,Nc_3935) in
                                                    {3580}let m1_3937: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3936) in
                                                    {3581}out(c, (pkCli_3612,m1_3937));
                                                    {3582}in(c, em2_3938: bitstring);
                                                    {3583}let m2_3939: bitstring = em2_3938 in
                                                    {3584}let (=OpenSecureChannelResponse,PartS_3940: bitstring,ST_3941: bitstring,TTL_3942: bitstring) = m2_3939 in
                                                    {3585}let Kcli_3943: bitstring = exp(PartS_3940,Nc_3935) in
                                                    {3586}out(c, senc(mCli(pkCli_3612,pkSess_3932),Kcli_3943))
                                        )
                                        else
                                            {3587}let pkSess_3944: bitstring = fail-any in
                                            {3588}out(c, GetEndpointRequest);
                                            {3589}in(c, (=GetEndpointResponse,=pkSess_3944,=None,SP_3945: bitstring,UP_3946: bitstring));
                                            {3590}new Nc_3947: bitstring;
                                            {3591}let gNc_3948: bitstring = exp(g,Nc_3947) in
                                            {3592}let m1_3949: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3948) in
                                            {3593}out(c, (pkCli_3612,m1_3949));
                                            {3594}in(c, em2_3950: bitstring);
                                            {3595}let m2_3951: bitstring = em2_3950 in
                                            {3596}let (=OpenSecureChannelResponse,PartS_3952: bitstring,ST_3953: bitstring,TTL_3954: bitstring) = m2_3951 in
                                            {3597}let Kcli_3955: bitstring = exp(PartS_3952,Nc_3947) in
                                            {3598}out(c, senc(mCli(pkCli_3612,pkSess_3944),Kcli_3955))
                                )
                                else
                                    {3599}let pkSess_3956: bitstring = fail-any in
                                    {3600}out(c, GetEndpointRequest);
                                    {3601}in(c, (=GetEndpointResponse,=pkSess_3956,=None,SP_3957: bitstring,UP_3958: bitstring));
                                    {3602}new Nc_3959: bitstring;
                                    {3603}let gNc_3960: bitstring = exp(g,Nc_3959) in
                                    {3604}let m1_3961: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3960) in
                                    {3605}out(c, (pkCli_3612,m1_3961));
                                    {3606}in(c, em2_3962: bitstring);
                                    {3607}let m2_3963: bitstring = em2_3962 in
                                    {3608}let (=OpenSecureChannelResponse,PartS_3964: bitstring,ST_3965: bitstring,TTL_3966: bitstring) = m2_3963 in
                                    {3609}let Kcli_3967: bitstring = exp(PartS_3964,Nc_3959) in
                                    {3610}out(c, senc(mCli(pkCli_3612,pkSess_3956),Kcli_3967))
                        )
                        else
                            {3611}let pkDisco_3968: bitstring = fail-any in
                            {3612}let v_3969: bool = (Sess = A) in
                            (
                                {3613}if v_3969 then
                                (
                                    {3614}let pkSess_3970: bitstring = pub(skA) in
                                    {3615}out(c, GetEndpointRequest);
                                    {3616}in(c, (=GetEndpointResponse,=pkSess_3970,=None,SP_3971: bitstring,UP_3972: bitstring));
                                    {3617}new Nc_3973: bitstring;
                                    {3618}let gNc_3974: bitstring = exp(g,Nc_3973) in
                                    {3619}let m1_3975: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3974) in
                                    {3620}out(c, (pkCli_3612,m1_3975));
                                    {3621}in(c, em2_3976: bitstring);
                                    {3622}let m2_3977: bitstring = em2_3976 in
                                    {3623}let (=OpenSecureChannelResponse,PartS_3978: bitstring,ST_3979: bitstring,TTL_3980: bitstring) = m2_3977 in
                                    {3624}let Kcli_3981: bitstring = exp(PartS_3978,Nc_3973) in
                                    {3625}out(c, senc(mCli(pkCli_3612,pkSess_3970),Kcli_3981))
                                )
                                else
                                    {3626}let v_3982: bool = (Sess = B) in
                                    (
                                        {3627}if v_3982 then
                                        (
                                            {3628}let pkSess_3983: bitstring = pub(skB) in
                                            {3629}out(c, GetEndpointRequest);
                                            {3630}in(c, (=GetEndpointResponse,=pkSess_3983,=None,SP_3984: bitstring,UP_3985: bitstring));
                                            {3631}new Nc_3986: bitstring;
                                            {3632}let gNc_3987: bitstring = exp(g,Nc_3986) in
                                            {3633}let m1_3988: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3987) in
                                            {3634}out(c, (pkCli_3612,m1_3988));
                                            {3635}in(c, em2_3989: bitstring);
                                            {3636}let m2_3990: bitstring = em2_3989 in
                                            {3637}let (=OpenSecureChannelResponse,PartS_3991: bitstring,ST_3992: bitstring,TTL_3993: bitstring) = m2_3990 in
                                            {3638}let Kcli_3994: bitstring = exp(PartS_3991,Nc_3986) in
                                            {3639}out(c, senc(mCli(pkCli_3612,pkSess_3983),Kcli_3994))
                                        )
                                        else
                                            {3640}let v_3995: bool = (Sess = C) in
                                            (
                                                {3641}if v_3995 then
                                                (
                                                    {3642}let pkSess_3996: bitstring = pub(skC) in
                                                    {3643}out(c, GetEndpointRequest);
                                                    {3644}in(c, (=GetEndpointResponse,=pkSess_3996,=None,SP_3997: bitstring,UP_3998: bitstring));
                                                    {3645}new Nc_3999: bitstring;
                                                    {3646}let gNc_4000: bitstring = exp(g,Nc_3999) in
                                                    {3647}let m1_4001: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4000) in
                                                    {3648}out(c, (pkCli_3612,m1_4001));
                                                    {3649}in(c, em2_4002: bitstring);
                                                    {3650}let m2_4003: bitstring = em2_4002 in
                                                    {3651}let (=OpenSecureChannelResponse,PartS_4004: bitstring,ST_4005: bitstring,TTL_4006: bitstring) = m2_4003 in
                                                    {3652}let Kcli_4007: bitstring = exp(PartS_4004,Nc_3999) in
                                                    {3653}out(c, senc(mCli(pkCli_3612,pkSess_3996),Kcli_4007))
                                                )
                                                else
                                                    {3654}let pkSess_4008: bitstring = pub(sk(Sess)) in
                                                    {3655}out(c, GetEndpointRequest);
                                                    {3656}in(c, (=GetEndpointResponse,=pkSess_4008,=None,SP_4009: bitstring,UP_4010: bitstring));
                                                    {3657}new Nc_4011: bitstring;
                                                    {3658}let gNc_4012: bitstring = exp(g,Nc_4011) in
                                                    {3659}let m1_4013: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4012) in
                                                    {3660}out(c, (pkCli_3612,m1_4013));
                                                    {3661}in(c, em2_4014: bitstring);
                                                    {3662}let m2_4015: bitstring = em2_4014 in
                                                    {3663}let (=OpenSecureChannelResponse,PartS_4016: bitstring,ST_4017: bitstring,TTL_4018: bitstring) = m2_4015 in
                                                    {3664}let Kcli_4019: bitstring = exp(PartS_4016,Nc_4011) in
                                                    {3665}out(c, senc(mCli(pkCli_3612,pkSess_4008),Kcli_4019))
                                            )
                                            else
                                                {3666}let pkSess_4020: bitstring = fail-any in
                                                {3667}out(c, GetEndpointRequest);
                                                {3668}in(c, (=GetEndpointResponse,=pkSess_4020,=None,SP_4021: bitstring,UP_4022: bitstring));
                                                {3669}new Nc_4023: bitstring;
                                                {3670}let gNc_4024: bitstring = exp(g,Nc_4023) in
                                                {3671}let m1_4025: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4024) in
                                                {3672}out(c, (pkCli_3612,m1_4025));
                                                {3673}in(c, em2_4026: bitstring);
                                                {3674}let m2_4027: bitstring = em2_4026 in
                                                {3675}let (=OpenSecureChannelResponse,PartS_4028: bitstring,ST_4029: bitstring,TTL_4030: bitstring) = m2_4027 in
                                                {3676}let Kcli_4031: bitstring = exp(PartS_4028,Nc_4023) in
                                                {3677}out(c, senc(mCli(pkCli_3612,pkSess_4020),Kcli_4031))
                                    )
                                    else
                                        {3678}let pkSess_4032: bitstring = fail-any in
                                        {3679}out(c, GetEndpointRequest);
                                        {3680}in(c, (=GetEndpointResponse,=pkSess_4032,=None,SP_4033: bitstring,UP_4034: bitstring));
                                        {3681}new Nc_4035: bitstring;
                                        {3682}let gNc_4036: bitstring = exp(g,Nc_4035) in
                                        {3683}let m1_4037: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4036) in
                                        {3684}out(c, (pkCli_3612,m1_4037));
                                        {3685}in(c, em2_4038: bitstring);
                                        {3686}let m2_4039: bitstring = em2_4038 in
                                        {3687}let (=OpenSecureChannelResponse,PartS_4040: bitstring,ST_4041: bitstring,TTL_4042: bitstring) = m2_4039 in
                                        {3688}let Kcli_4043: bitstring = exp(PartS_4040,Nc_4035) in
                                        {3689}out(c, senc(mCli(pkCli_3612,pkSess_4032),Kcli_4043))
                            )
                            else
                                {3690}let pkSess_4044: bitstring = fail-any in
                                {3691}out(c, GetEndpointRequest);
                                {3692}in(c, (=GetEndpointResponse,=pkSess_4044,=None,SP_4045: bitstring,UP_4046: bitstring));
                                {3693}new Nc_4047: bitstring;
                                {3694}let gNc_4048: bitstring = exp(g,Nc_4047) in
                                {3695}let m1_4049: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4048) in
                                {3696}out(c, (pkCli_3612,m1_4049));
                                {3697}in(c, em2_4050: bitstring);
                                {3698}let m2_4051: bitstring = em2_4050 in
                                {3699}let (=OpenSecureChannelResponse,PartS_4052: bitstring,ST_4053: bitstring,TTL_4054: bitstring) = m2_4051 in
                                {3700}let Kcli_4055: bitstring = exp(PartS_4052,Nc_4047) in
                                {3701}out(c, senc(mCli(pkCli_3612,pkSess_4044),Kcli_4055))
                )
                else
                    {3702}let pkDisco_4056: bitstring = fail-any in
                    {3703}let v_4057: bool = (Sess = A) in
                    (
                        {3704}if v_4057 then
                        (
                            {3705}let pkSess_4058: bitstring = pub(skA) in
                            {3706}out(c, GetEndpointRequest);
                            {3707}in(c, (=GetEndpointResponse,=pkSess_4058,=None,SP_4059: bitstring,UP_4060: bitstring));
                            {3708}new Nc_4061: bitstring;
                            {3709}let gNc_4062: bitstring = exp(g,Nc_4061) in
                            {3710}let m1_4063: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4062) in
                            {3711}out(c, (pkCli_3612,m1_4063));
                            {3712}in(c, em2_4064: bitstring);
                            {3713}let m2_4065: bitstring = em2_4064 in
                            {3714}let (=OpenSecureChannelResponse,PartS_4066: bitstring,ST_4067: bitstring,TTL_4068: bitstring) = m2_4065 in
                            {3715}let Kcli_4069: bitstring = exp(PartS_4066,Nc_4061) in
                            {3716}out(c, senc(mCli(pkCli_3612,pkSess_4058),Kcli_4069))
                        )
                        else
                            {3717}let v_4070: bool = (Sess = B) in
                            (
                                {3718}if v_4070 then
                                (
                                    {3719}let pkSess_4071: bitstring = pub(skB) in
                                    {3720}out(c, GetEndpointRequest);
                                    {3721}in(c, (=GetEndpointResponse,=pkSess_4071,=None,SP_4072: bitstring,UP_4073: bitstring));
                                    {3722}new Nc_4074: bitstring;
                                    {3723}let gNc_4075: bitstring = exp(g,Nc_4074) in
                                    {3724}let m1_4076: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4075) in
                                    {3725}out(c, (pkCli_3612,m1_4076));
                                    {3726}in(c, em2_4077: bitstring);
                                    {3727}let m2_4078: bitstring = em2_4077 in
                                    {3728}let (=OpenSecureChannelResponse,PartS_4079: bitstring,ST_4080: bitstring,TTL_4081: bitstring) = m2_4078 in
                                    {3729}let Kcli_4082: bitstring = exp(PartS_4079,Nc_4074) in
                                    {3730}out(c, senc(mCli(pkCli_3612,pkSess_4071),Kcli_4082))
                                )
                                else
                                    {3731}let v_4083: bool = (Sess = C) in
                                    (
                                        {3732}if v_4083 then
                                        (
                                            {3733}let pkSess_4084: bitstring = pub(skC) in
                                            {3734}out(c, GetEndpointRequest);
                                            {3735}in(c, (=GetEndpointResponse,=pkSess_4084,=None,SP_4085: bitstring,UP_4086: bitstring));
                                            {3736}new Nc_4087: bitstring;
                                            {3737}let gNc_4088: bitstring = exp(g,Nc_4087) in
                                            {3738}let m1_4089: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4088) in
                                            {3739}out(c, (pkCli_3612,m1_4089));
                                            {3740}in(c, em2_4090: bitstring);
                                            {3741}let m2_4091: bitstring = em2_4090 in
                                            {3742}let (=OpenSecureChannelResponse,PartS_4092: bitstring,ST_4093: bitstring,TTL_4094: bitstring) = m2_4091 in
                                            {3743}let Kcli_4095: bitstring = exp(PartS_4092,Nc_4087) in
                                            {3744}out(c, senc(mCli(pkCli_3612,pkSess_4084),Kcli_4095))
                                        )
                                        else
                                            {3745}let pkSess_4096: bitstring = pub(sk(Sess)) in
                                            {3746}out(c, GetEndpointRequest);
                                            {3747}in(c, (=GetEndpointResponse,=pkSess_4096,=None,SP_4097: bitstring,UP_4098: bitstring));
                                            {3748}new Nc_4099: bitstring;
                                            {3749}let gNc_4100: bitstring = exp(g,Nc_4099) in
                                            {3750}let m1_4101: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4100) in
                                            {3751}out(c, (pkCli_3612,m1_4101));
                                            {3752}in(c, em2_4102: bitstring);
                                            {3753}let m2_4103: bitstring = em2_4102 in
                                            {3754}let (=OpenSecureChannelResponse,PartS_4104: bitstring,ST_4105: bitstring,TTL_4106: bitstring) = m2_4103 in
                                            {3755}let Kcli_4107: bitstring = exp(PartS_4104,Nc_4099) in
                                            {3756}out(c, senc(mCli(pkCli_3612,pkSess_4096),Kcli_4107))
                                    )
                                    else
                                        {3757}let pkSess_4108: bitstring = fail-any in
                                        {3758}out(c, GetEndpointRequest);
                                        {3759}in(c, (=GetEndpointResponse,=pkSess_4108,=None,SP_4109: bitstring,UP_4110: bitstring));
                                        {3760}new Nc_4111: bitstring;
                                        {3761}let gNc_4112: bitstring = exp(g,Nc_4111) in
                                        {3762}let m1_4113: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4112) in
                                        {3763}out(c, (pkCli_3612,m1_4113));
                                        {3764}in(c, em2_4114: bitstring);
                                        {3765}let m2_4115: bitstring = em2_4114 in
                                        {3766}let (=OpenSecureChannelResponse,PartS_4116: bitstring,ST_4117: bitstring,TTL_4118: bitstring) = m2_4115 in
                                        {3767}let Kcli_4119: bitstring = exp(PartS_4116,Nc_4111) in
                                        {3768}out(c, senc(mCli(pkCli_3612,pkSess_4108),Kcli_4119))
                            )
                            else
                                {3769}let pkSess_4120: bitstring = fail-any in
                                {3770}out(c, GetEndpointRequest);
                                {3771}in(c, (=GetEndpointResponse,=pkSess_4120,=None,SP_4121: bitstring,UP_4122: bitstring));
                                {3772}new Nc_4123: bitstring;
                                {3773}let gNc_4124: bitstring = exp(g,Nc_4123) in
                                {3774}let m1_4125: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4124) in
                                {3775}out(c, (pkCli_3612,m1_4125));
                                {3776}in(c, em2_4126: bitstring);
                                {3777}let m2_4127: bitstring = em2_4126 in
                                {3778}let (=OpenSecureChannelResponse,PartS_4128: bitstring,ST_4129: bitstring,TTL_4130: bitstring) = m2_4127 in
                                {3779}let Kcli_4131: bitstring = exp(PartS_4128,Nc_4123) in
                                {3780}out(c, senc(mCli(pkCli_3612,pkSess_4120),Kcli_4131))
                    )
                    else
                        {3781}let pkSess_4132: bitstring = fail-any in
                        {3782}out(c, GetEndpointRequest);
                        {3783}in(c, (=GetEndpointResponse,=pkSess_4132,=None,SP_4133: bitstring,UP_4134: bitstring));
                        {3784}new Nc_4135: bitstring;
                        {3785}let gNc_4136: bitstring = exp(g,Nc_4135) in
                        {3786}let m1_4137: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4136) in
                        {3787}out(c, (pkCli_3612,m1_4137));
                        {3788}in(c, em2_4138: bitstring);
                        {3789}let m2_4139: bitstring = em2_4138 in
                        {3790}let (=OpenSecureChannelResponse,PartS_4140: bitstring,ST_4141: bitstring,TTL_4142: bitstring) = m2_4139 in
                        {3791}let Kcli_4143: bitstring = exp(PartS_4140,Nc_4135) in
                        {3792}out(c, senc(mCli(pkCli_3612,pkSess_4132),Kcli_4143))
        )
        else
            {3793}let pkDisco_4144: bitstring = fail-any in
            {3794}let v_4145: bool = (Sess = A) in
            (
                {3795}if v_4145 then
                (
                    {3796}let pkSess_4146: bitstring = pub(skA) in
                    {3797}out(c, GetEndpointRequest);
                    {3798}in(c, (=GetEndpointResponse,=pkSess_4146,=None,SP_4147: bitstring,UP_4148: bitstring));
                    {3799}new Nc_4149: bitstring;
                    {3800}let gNc_4150: bitstring = exp(g,Nc_4149) in
                    {3801}let m1_4151: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4150) in
                    {3802}out(c, (pkCli_3612,m1_4151));
                    {3803}in(c, em2_4152: bitstring);
                    {3804}let m2_4153: bitstring = em2_4152 in
                    {3805}let (=OpenSecureChannelResponse,PartS_4154: bitstring,ST_4155: bitstring,TTL_4156: bitstring) = m2_4153 in
                    {3806}let Kcli_4157: bitstring = exp(PartS_4154,Nc_4149) in
                    {3807}out(c, senc(mCli(pkCli_3612,pkSess_4146),Kcli_4157))
                )
                else
                    {3808}let v_4158: bool = (Sess = B) in
                    (
                        {3809}if v_4158 then
                        (
                            {3810}let pkSess_4159: bitstring = pub(skB) in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_4159,=None,SP_4160: bitstring,UP_4161: bitstring));
                            {3813}new Nc_4162: bitstring;
                            {3814}let gNc_4163: bitstring = exp(g,Nc_4162) in
                            {3815}let m1_4164: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4163) in
                            {3816}out(c, (pkCli_3612,m1_4164));
                            {3817}in(c, em2_4165: bitstring);
                            {3818}let m2_4166: bitstring = em2_4165 in
                            {3819}let (=OpenSecureChannelResponse,PartS_4167: bitstring,ST_4168: bitstring,TTL_4169: bitstring) = m2_4166 in
                            {3820}let Kcli_4170: bitstring = exp(PartS_4167,Nc_4162) in
                            {3821}out(c, senc(mCli(pkCli_3612,pkSess_4159),Kcli_4170))
                        )
                        else
                            {3822}let v_4171: bool = (Sess = C) in
                            (
                                {3823}if v_4171 then
                                (
                                    {3824}let pkSess_4172: bitstring = pub(skC) in
                                    {3825}out(c, GetEndpointRequest);
                                    {3826}in(c, (=GetEndpointResponse,=pkSess_4172,=None,SP_4173: bitstring,UP_4174: bitstring));
                                    {3827}new Nc_4175: bitstring;
                                    {3828}let gNc_4176: bitstring = exp(g,Nc_4175) in
                                    {3829}let m1_4177: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4176) in
                                    {3830}out(c, (pkCli_3612,m1_4177));
                                    {3831}in(c, em2_4178: bitstring);
                                    {3832}let m2_4179: bitstring = em2_4178 in
                                    {3833}let (=OpenSecureChannelResponse,PartS_4180: bitstring,ST_4181: bitstring,TTL_4182: bitstring) = m2_4179 in
                                    {3834}let Kcli_4183: bitstring = exp(PartS_4180,Nc_4175) in
                                    {3835}out(c, senc(mCli(pkCli_3612,pkSess_4172),Kcli_4183))
                                )
                                else
                                    {3836}let pkSess_4184: bitstring = pub(sk(Sess)) in
                                    {3837}out(c, GetEndpointRequest);
                                    {3838}in(c, (=GetEndpointResponse,=pkSess_4184,=None,SP_4185: bitstring,UP_4186: bitstring));
                                    {3839}new Nc_4187: bitstring;
                                    {3840}let gNc_4188: bitstring = exp(g,Nc_4187) in
                                    {3841}let m1_4189: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4188) in
                                    {3842}out(c, (pkCli_3612,m1_4189));
                                    {3843}in(c, em2_4190: bitstring);
                                    {3844}let m2_4191: bitstring = em2_4190 in
                                    {3845}let (=OpenSecureChannelResponse,PartS_4192: bitstring,ST_4193: bitstring,TTL_4194: bitstring) = m2_4191 in
                                    {3846}let Kcli_4195: bitstring = exp(PartS_4192,Nc_4187) in
                                    {3847}out(c, senc(mCli(pkCli_3612,pkSess_4184),Kcli_4195))
                            )
                            else
                                {3848}let pkSess_4196: bitstring = fail-any in
                                {3849}out(c, GetEndpointRequest);
                                {3850}in(c, (=GetEndpointResponse,=pkSess_4196,=None,SP_4197: bitstring,UP_4198: bitstring));
                                {3851}new Nc_4199: bitstring;
                                {3852}let gNc_4200: bitstring = exp(g,Nc_4199) in
                                {3853}let m1_4201: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4200) in
                                {3854}out(c, (pkCli_3612,m1_4201));
                                {3855}in(c, em2_4202: bitstring);
                                {3856}let m2_4203: bitstring = em2_4202 in
                                {3857}let (=OpenSecureChannelResponse,PartS_4204: bitstring,ST_4205: bitstring,TTL_4206: bitstring) = m2_4203 in
                                {3858}let Kcli_4207: bitstring = exp(PartS_4204,Nc_4199) in
                                {3859}out(c, senc(mCli(pkCli_3612,pkSess_4196),Kcli_4207))
                    )
                    else
                        {3860}let pkSess_4208: bitstring = fail-any in
                        {3861}out(c, GetEndpointRequest);
                        {3862}in(c, (=GetEndpointResponse,=pkSess_4208,=None,SP_4209: bitstring,UP_4210: bitstring));
                        {3863}new Nc_4211: bitstring;
                        {3864}let gNc_4212: bitstring = exp(g,Nc_4211) in
                        {3865}let m1_4213: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4212) in
                        {3866}out(c, (pkCli_3612,m1_4213));
                        {3867}in(c, em2_4214: bitstring);
                        {3868}let m2_4215: bitstring = em2_4214 in
                        {3869}let (=OpenSecureChannelResponse,PartS_4216: bitstring,ST_4217: bitstring,TTL_4218: bitstring) = m2_4215 in
                        {3870}let Kcli_4219: bitstring = exp(PartS_4216,Nc_4211) in
                        {3871}out(c, senc(mCli(pkCli_3612,pkSess_4208),Kcli_4219))
            )
            else
                {3872}let pkSess_4220: bitstring = fail-any in
                {3873}out(c, GetEndpointRequest);
                {3874}in(c, (=GetEndpointResponse,=pkSess_4220,=None,SP_4221: bitstring,UP_4222: bitstring));
                {3875}new Nc_4223: bitstring;
                {3876}let gNc_4224: bitstring = exp(g,Nc_4223) in
                {3877}let m1_4225: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4224) in
                {3878}out(c, (pkCli_3612,m1_4225));
                {3879}in(c, em2_4226: bitstring);
                {3880}let m2_4227: bitstring = em2_4226 in
                {3881}let (=OpenSecureChannelResponse,PartS_4228: bitstring,ST_4229: bitstring,TTL_4230: bitstring) = m2_4227 in
                {3882}let Kcli_4231: bitstring = exp(PartS_4228,Nc_4223) in
                {3883}out(c, senc(mCli(pkCli_3612,pkSess_4220),Kcli_4231))
) | (
    {3884}!
    {3885}in(c, (Cli_4232: host,Disco_4233: host,Sess_4234: host));
    {3886}let v_4235: bool = (Disco_4233 = A) in
    (
        {3887}if v_4235 then
        (
            {3888}let skDisco: bitstring = skA in
            {3889}let pkDisco_4236: bitstring = pub(skDisco) in
            {3890}let v_4237: bool = (Cli_4232 = A) in
            (
                {3891}if v_4237 then
                (
                    {3892}let pkCli_4238: bitstring = pub(skA) in
                    {3893}let v_4239: bool = (Sess_4234 = A) in
                    (
                        {3894}if v_4239 then
                        (
                            {3895}let pkSess_4240: bitstring = pub(skA) in
                            {3896}in(c, =GetEndpointRequest);
                            {3897}new SP_4241: bitstring;
                            {3898}new UP_4242: bitstring;
                            {3899}out(c, (GetEndpointResponse,pkSess_4240,SignAndEncrypt,SP_4241,UP_4242))
                        )
                        else
                            {3900}let v_4243: bool = (Sess_4234 = B) in
                            (
                                {3901}if v_4243 then
                                (
                                    {3902}let pkSess_4244: bitstring = pub(skB) in
                                    {3903}in(c, =GetEndpointRequest);
                                    {3904}new SP_4245: bitstring;
                                    {3905}new UP_4246: bitstring;
                                    {3906}out(c, (GetEndpointResponse,pkSess_4244,SignAndEncrypt,SP_4245,UP_4246))
                                )
                                else
                                    {3907}let v_4247: bool = (Sess_4234 = C) in
                                    (
                                        {3908}if v_4247 then
                                        (
                                            {3909}let pkSess_4248: bitstring = pub(skC) in
                                            {3910}in(c, =GetEndpointRequest);
                                            {3911}new SP_4249: bitstring;
                                            {3912}new UP_4250: bitstring;
                                            {3913}out(c, (GetEndpointResponse,pkSess_4248,SignAndEncrypt,SP_4249,UP_4250))
                                        )
                                        else
                                            {3914}let pkSess_4251: bitstring = pub(sk(Sess_4234)) in
                                            {3915}in(c, =GetEndpointRequest);
                                            {3916}new SP_4252: bitstring;
                                            {3917}new UP_4253: bitstring;
                                            {3918}out(c, (GetEndpointResponse,pkSess_4251,SignAndEncrypt,SP_4252,UP_4253))
                                    )
                                    else
                                        {3919}let pkSess_4254: bitstring = fail-any in
                                        {3920}in(c, =GetEndpointRequest);
                                        {3921}new SP_4255: bitstring;
                                        {3922}new UP_4256: bitstring;
                                        {3923}out(c, (GetEndpointResponse,pkSess_4254,SignAndEncrypt,SP_4255,UP_4256))
                            )
                            else
                                {3924}let pkSess_4257: bitstring = fail-any in
                                {3925}in(c, =GetEndpointRequest);
                                {3926}new SP_4258: bitstring;
                                {3927}new UP_4259: bitstring;
                                {3928}out(c, (GetEndpointResponse,pkSess_4257,SignAndEncrypt,SP_4258,UP_4259))
                    )
                    else
                        {3929}let pkSess_4260: bitstring = fail-any in
                        {3930}in(c, =GetEndpointRequest);
                        {3931}new SP_4261: bitstring;
                        {3932}new UP_4262: bitstring;
                        {3933}out(c, (GetEndpointResponse,pkSess_4260,SignAndEncrypt,SP_4261,UP_4262))
                )
                else
                    {3934}let v_4263: bool = (Cli_4232 = B) in
                    (
                        {3935}if v_4263 then
                        (
                            {3936}let pkCli_4264: bitstring = pub(skB) in
                            {3937}let v_4265: bool = (Sess_4234 = A) in
                            (
                                {3938}if v_4265 then
                                (
                                    {3939}let pkSess_4266: bitstring = pub(skA) in
                                    {3940}in(c, =GetEndpointRequest);
                                    {3941}new SP_4267: bitstring;
                                    {3942}new UP_4268: bitstring;
                                    {3943}out(c, (GetEndpointResponse,pkSess_4266,SignAndEncrypt,SP_4267,UP_4268))
                                )
                                else
                                    {3944}let v_4269: bool = (Sess_4234 = B) in
                                    (
                                        {3945}if v_4269 then
                                        (
                                            {3946}let pkSess_4270: bitstring = pub(skB) in
                                            {3947}in(c, =GetEndpointRequest);
                                            {3948}new SP_4271: bitstring;
                                            {3949}new UP_4272: bitstring;
                                            {3950}out(c, (GetEndpointResponse,pkSess_4270,SignAndEncrypt,SP_4271,UP_4272))
                                        )
                                        else
                                            {3951}let v_4273: bool = (Sess_4234 = C) in
                                            (
                                                {3952}if v_4273 then
                                                (
                                                    {3953}let pkSess_4274: bitstring = pub(skC) in
                                                    {3954}in(c, =GetEndpointRequest);
                                                    {3955}new SP_4275: bitstring;
                                                    {3956}new UP_4276: bitstring;
                                                    {3957}out(c, (GetEndpointResponse,pkSess_4274,SignAndEncrypt,SP_4275,UP_4276))
                                                )
                                                else
                                                    {3958}let pkSess_4277: bitstring = pub(sk(Sess_4234)) in
                                                    {3959}in(c, =GetEndpointRequest);
                                                    {3960}new SP_4278: bitstring;
                                                    {3961}new UP_4279: bitstring;
                                                    {3962}out(c, (GetEndpointResponse,pkSess_4277,SignAndEncrypt,SP_4278,UP_4279))
                                            )
                                            else
                                                {3963}let pkSess_4280: bitstring = fail-any in
                                                {3964}in(c, =GetEndpointRequest);
                                                {3965}new SP_4281: bitstring;
                                                {3966}new UP_4282: bitstring;
                                                {3967}out(c, (GetEndpointResponse,pkSess_4280,SignAndEncrypt,SP_4281,UP_4282))
                                    )
                                    else
                                        {3968}let pkSess_4283: bitstring = fail-any in
                                        {3969}in(c, =GetEndpointRequest);
                                        {3970}new SP_4284: bitstring;
                                        {3971}new UP_4285: bitstring;
                                        {3972}out(c, (GetEndpointResponse,pkSess_4283,SignAndEncrypt,SP_4284,UP_4285))
                            )
                            else
                                {3973}let pkSess_4286: bitstring = fail-any in
                                {3974}in(c, =GetEndpointRequest);
                                {3975}new SP_4287: bitstring;
                                {3976}new UP_4288: bitstring;
                                {3977}out(c, (GetEndpointResponse,pkSess_4286,SignAndEncrypt,SP_4287,UP_4288))
                        )
                        else
                            {3978}let v_4289: bool = (Cli_4232 = C) in
                            (
                                {3979}if v_4289 then
                                (
                                    {3980}let pkCli_4290: bitstring = pub(skC) in
                                    {3981}let v_4291: bool = (Sess_4234 = A) in
                                    (
                                        {3982}if v_4291 then
                                        (
                                            {3983}let pkSess_4292: bitstring = pub(skA) in
                                            {3984}in(c, =GetEndpointRequest);
                                            {3985}new SP_4293: bitstring;
                                            {3986}new UP_4294: bitstring;
                                            {3987}out(c, (GetEndpointResponse,pkSess_4292,SignAndEncrypt,SP_4293,UP_4294))
                                        )
                                        else
                                            {3988}let v_4295: bool = (Sess_4234 = B) in
                                            (
                                                {3989}if v_4295 then
                                                (
                                                    {3990}let pkSess_4296: bitstring = pub(skB) in
                                                    {3991}in(c, =GetEndpointRequest);
                                                    {3992}new SP_4297: bitstring;
                                                    {3993}new UP_4298: bitstring;
                                                    {3994}out(c, (GetEndpointResponse,pkSess_4296,SignAndEncrypt,SP_4297,UP_4298))
                                                )
                                                else
                                                    {3995}let v_4299: bool = (Sess_4234 = C) in
                                                    (
                                                        {3996}if v_4299 then
                                                        (
                                                            {3997}let pkSess_4300: bitstring = pub(skC) in
                                                            {3998}in(c, =GetEndpointRequest);
                                                            {3999}new SP_4301: bitstring;
                                                            {4000}new UP_4302: bitstring;
                                                            {4001}out(c, (GetEndpointResponse,pkSess_4300,SignAndEncrypt,SP_4301,UP_4302))
                                                        )
                                                        else
                                                            {4002}let pkSess_4303: bitstring = pub(sk(Sess_4234)) in
                                                            {4003}in(c, =GetEndpointRequest);
                                                            {4004}new SP_4304: bitstring;
                                                            {4005}new UP_4305: bitstring;
                                                            {4006}out(c, (GetEndpointResponse,pkSess_4303,SignAndEncrypt,SP_4304,UP_4305))
                                                    )
                                                    else
                                                        {4007}let pkSess_4306: bitstring = fail-any in
                                                        {4008}in(c, =GetEndpointRequest);
                                                        {4009}new SP_4307: bitstring;
                                                        {4010}new UP_4308: bitstring;
                                                        {4011}out(c, (GetEndpointResponse,pkSess_4306,SignAndEncrypt,SP_4307,UP_4308))
                                            )
                                            else
                                                {4012}let pkSess_4309: bitstring = fail-any in
                                                {4013}in(c, =GetEndpointRequest);
                                                {4014}new SP_4310: bitstring;
                                                {4015}new UP_4311: bitstring;
                                                {4016}out(c, (GetEndpointResponse,pkSess_4309,SignAndEncrypt,SP_4310,UP_4311))
                                    )
                                    else
                                        {4017}let pkSess_4312: bitstring = fail-any in
                                        {4018}in(c, =GetEndpointRequest);
                                        {4019}new SP_4313: bitstring;
                                        {4020}new UP_4314: bitstring;
                                        {4021}out(c, (GetEndpointResponse,pkSess_4312,SignAndEncrypt,SP_4313,UP_4314))
                                )
                                else
                                    {4022}let pkCli_4315: bitstring = pub(sk(Cli_4232)) in
                                    {4023}let v_4316: bool = (Sess_4234 = A) in
                                    (
                                        {4024}if v_4316 then
                                        (
                                            {4025}let pkSess_4317: bitstring = pub(skA) in
                                            {4026}in(c, =GetEndpointRequest);
                                            {4027}new SP_4318: bitstring;
                                            {4028}new UP_4319: bitstring;
                                            {4029}out(c, (GetEndpointResponse,pkSess_4317,SignAndEncrypt,SP_4318,UP_4319))
                                        )
                                        else
                                            {4030}let v_4320: bool = (Sess_4234 = B) in
                                            (
                                                {4031}if v_4320 then
                                                (
                                                    {4032}let pkSess_4321: bitstring = pub(skB) in
                                                    {4033}in(c, =GetEndpointRequest);
                                                    {4034}new SP_4322: bitstring;
                                                    {4035}new UP_4323: bitstring;
                                                    {4036}out(c, (GetEndpointResponse,pkSess_4321,SignAndEncrypt,SP_4322,UP_4323))
                                                )
                                                else
                                                    {4037}let v_4324: bool = (Sess_4234 = C) in
                                                    (
                                                        {4038}if v_4324 then
                                                        (
                                                            {4039}let pkSess_4325: bitstring = pub(skC) in
                                                            {4040}in(c, =GetEndpointRequest);
                                                            {4041}new SP_4326: bitstring;
                                                            {4042}new UP_4327: bitstring;
                                                            {4043}out(c, (GetEndpointResponse,pkSess_4325,SignAndEncrypt,SP_4326,UP_4327))
                                                        )
                                                        else
                                                            {4044}let pkSess_4328: bitstring = pub(sk(Sess_4234)) in
                                                            {4045}in(c, =GetEndpointRequest);
                                                            {4046}new SP_4329: bitstring;
                                                            {4047}new UP_4330: bitstring;
                                                            {4048}out(c, (GetEndpointResponse,pkSess_4328,SignAndEncrypt,SP_4329,UP_4330))
                                                    )
                                                    else
                                                        {4049}let pkSess_4331: bitstring = fail-any in
                                                        {4050}in(c, =GetEndpointRequest);
                                                        {4051}new SP_4332: bitstring;
                                                        {4052}new UP_4333: bitstring;
                                                        {4053}out(c, (GetEndpointResponse,pkSess_4331,SignAndEncrypt,SP_4332,UP_4333))
                                            )
                                            else
                                                {4054}let pkSess_4334: bitstring = fail-any in
                                                {4055}in(c, =GetEndpointRequest);
                                                {4056}new SP_4335: bitstring;
                                                {4057}new UP_4336: bitstring;
                                                {4058}out(c, (GetEndpointResponse,pkSess_4334,SignAndEncrypt,SP_4335,UP_4336))
                                    )
                                    else
                                        {4059}let pkSess_4337: bitstring = fail-any in
                                        {4060}in(c, =GetEndpointRequest);
                                        {4061}new SP_4338: bitstring;
                                        {4062}new UP_4339: bitstring;
                                        {4063}out(c, (GetEndpointResponse,pkSess_4337,SignAndEncrypt,SP_4338,UP_4339))
                            )
                            else
                                {4064}let pkCli_4340: bitstring = fail-any in
                                {4065}let v_4341: bool = (Sess_4234 = A) in
                                (
                                    {4066}if v_4341 then
                                    (
                                        {4067}let pkSess_4342: bitstring = pub(skA) in
                                        {4068}in(c, =GetEndpointRequest);
                                        {4069}new SP_4343: bitstring;
                                        {4070}new UP_4344: bitstring;
                                        {4071}out(c, (GetEndpointResponse,pkSess_4342,SignAndEncrypt,SP_4343,UP_4344))
                                    )
                                    else
                                        {4072}let v_4345: bool = (Sess_4234 = B) in
                                        (
                                            {4073}if v_4345 then
                                            (
                                                {4074}let pkSess_4346: bitstring = pub(skB) in
                                                {4075}in(c, =GetEndpointRequest);
                                                {4076}new SP_4347: bitstring;
                                                {4077}new UP_4348: bitstring;
                                                {4078}out(c, (GetEndpointResponse,pkSess_4346,SignAndEncrypt,SP_4347,UP_4348))
                                            )
                                            else
                                                {4079}let v_4349: bool = (Sess_4234 = C) in
                                                (
                                                    {4080}if v_4349 then
                                                    (
                                                        {4081}let pkSess_4350: bitstring = pub(skC) in
                                                        {4082}in(c, =GetEndpointRequest);
                                                        {4083}new SP_4351: bitstring;
                                                        {4084}new UP_4352: bitstring;
                                                        {4085}out(c, (GetEndpointResponse,pkSess_4350,SignAndEncrypt,SP_4351,UP_4352))
                                                    )
                                                    else
                                                        {4086}let pkSess_4353: bitstring = pub(sk(Sess_4234)) in
                                                        {4087}in(c, =GetEndpointRequest);
                                                        {4088}new SP_4354: bitstring;
                                                        {4089}new UP_4355: bitstring;
                                                        {4090}out(c, (GetEndpointResponse,pkSess_4353,SignAndEncrypt,SP_4354,UP_4355))
                                                )
                                                else
                                                    {4091}let pkSess_4356: bitstring = fail-any in
                                                    {4092}in(c, =GetEndpointRequest);
                                                    {4093}new SP_4357: bitstring;
                                                    {4094}new UP_4358: bitstring;
                                                    {4095}out(c, (GetEndpointResponse,pkSess_4356,SignAndEncrypt,SP_4357,UP_4358))
                                        )
                                        else
                                            {4096}let pkSess_4359: bitstring = fail-any in
                                            {4097}in(c, =GetEndpointRequest);
                                            {4098}new SP_4360: bitstring;
                                            {4099}new UP_4361: bitstring;
                                            {4100}out(c, (GetEndpointResponse,pkSess_4359,SignAndEncrypt,SP_4360,UP_4361))
                                )
                                else
                                    {4101}let pkSess_4362: bitstring = fail-any in
                                    {4102}in(c, =GetEndpointRequest);
                                    {4103}new SP_4363: bitstring;
                                    {4104}new UP_4364: bitstring;
                                    {4105}out(c, (GetEndpointResponse,pkSess_4362,SignAndEncrypt,SP_4363,UP_4364))
                    )
                    else
                        {4106}let pkCli_4365: bitstring = fail-any in
                        {4107}let v_4366: bool = (Sess_4234 = A) in
                        (
                            {4108}if v_4366 then
                            (
                                {4109}let pkSess_4367: bitstring = pub(skA) in
                                {4110}in(c, =GetEndpointRequest);
                                {4111}new SP_4368: bitstring;
                                {4112}new UP_4369: bitstring;
                                {4113}out(c, (GetEndpointResponse,pkSess_4367,SignAndEncrypt,SP_4368,UP_4369))
                            )
                            else
                                {4114}let v_4370: bool = (Sess_4234 = B) in
                                (
                                    {4115}if v_4370 then
                                    (
                                        {4116}let pkSess_4371: bitstring = pub(skB) in
                                        {4117}in(c, =GetEndpointRequest);
                                        {4118}new SP_4372: bitstring;
                                        {4119}new UP_4373: bitstring;
                                        {4120}out(c, (GetEndpointResponse,pkSess_4371,SignAndEncrypt,SP_4372,UP_4373))
                                    )
                                    else
                                        {4121}let v_4374: bool = (Sess_4234 = C) in
                                        (
                                            {4122}if v_4374 then
                                            (
                                                {4123}let pkSess_4375: bitstring = pub(skC) in
                                                {4124}in(c, =GetEndpointRequest);
                                                {4125}new SP_4376: bitstring;
                                                {4126}new UP_4377: bitstring;
                                                {4127}out(c, (GetEndpointResponse,pkSess_4375,SignAndEncrypt,SP_4376,UP_4377))
                                            )
                                            else
                                                {4128}let pkSess_4378: bitstring = pub(sk(Sess_4234)) in
                                                {4129}in(c, =GetEndpointRequest);
                                                {4130}new SP_4379: bitstring;
                                                {4131}new UP_4380: bitstring;
                                                {4132}out(c, (GetEndpointResponse,pkSess_4378,SignAndEncrypt,SP_4379,UP_4380))
                                        )
                                        else
                                            {4133}let pkSess_4381: bitstring = fail-any in
                                            {4134}in(c, =GetEndpointRequest);
                                            {4135}new SP_4382: bitstring;
                                            {4136}new UP_4383: bitstring;
                                            {4137}out(c, (GetEndpointResponse,pkSess_4381,SignAndEncrypt,SP_4382,UP_4383))
                                )
                                else
                                    {4138}let pkSess_4384: bitstring = fail-any in
                                    {4139}in(c, =GetEndpointRequest);
                                    {4140}new SP_4385: bitstring;
                                    {4141}new UP_4386: bitstring;
                                    {4142}out(c, (GetEndpointResponse,pkSess_4384,SignAndEncrypt,SP_4385,UP_4386))
                        )
                        else
                            {4143}let pkSess_4387: bitstring = fail-any in
                            {4144}in(c, =GetEndpointRequest);
                            {4145}new SP_4388: bitstring;
                            {4146}new UP_4389: bitstring;
                            {4147}out(c, (GetEndpointResponse,pkSess_4387,SignAndEncrypt,SP_4388,UP_4389))
            )
            else
                {4148}let pkCli_4390: bitstring = fail-any in
                {4149}let v_4391: bool = (Sess_4234 = A) in
                (
                    {4150}if v_4391 then
                    (
                        {4151}let pkSess_4392: bitstring = pub(skA) in
                        {4152}in(c, =GetEndpointRequest);
                        {4153}new SP_4393: bitstring;
                        {4154}new UP_4394: bitstring;
                        {4155}out(c, (GetEndpointResponse,pkSess_4392,SignAndEncrypt,SP_4393,UP_4394))
                    )
                    else
                        {4156}let v_4395: bool = (Sess_4234 = B) in
                        (
                            {4157}if v_4395 then
                            (
                                {4158}let pkSess_4396: bitstring = pub(skB) in
                                {4159}in(c, =GetEndpointRequest);
                                {4160}new SP_4397: bitstring;
                                {4161}new UP_4398: bitstring;
                                {4162}out(c, (GetEndpointResponse,pkSess_4396,SignAndEncrypt,SP_4397,UP_4398))
                            )
                            else
                                {4163}let v_4399: bool = (Sess_4234 = C) in
                                (
                                    {4164}if v_4399 then
                                    (
                                        {4165}let pkSess_4400: bitstring = pub(skC) in
                                        {4166}in(c, =GetEndpointRequest);
                                        {4167}new SP_4401: bitstring;
                                        {4168}new UP_4402: bitstring;
                                        {4169}out(c, (GetEndpointResponse,pkSess_4400,SignAndEncrypt,SP_4401,UP_4402))
                                    )
                                    else
                                        {4170}let pkSess_4403: bitstring = pub(sk(Sess_4234)) in
                                        {4171}in(c, =GetEndpointRequest);
                                        {4172}new SP_4404: bitstring;
                                        {4173}new UP_4405: bitstring;
                                        {4174}out(c, (GetEndpointResponse,pkSess_4403,SignAndEncrypt,SP_4404,UP_4405))
                                )
                                else
                                    {4175}let pkSess_4406: bitstring = fail-any in
                                    {4176}in(c, =GetEndpointRequest);
                                    {4177}new SP_4407: bitstring;
                                    {4178}new UP_4408: bitstring;
                                    {4179}out(c, (GetEndpointResponse,pkSess_4406,SignAndEncrypt,SP_4407,UP_4408))
                        )
                        else
                            {4180}let pkSess_4409: bitstring = fail-any in
                            {4181}in(c, =GetEndpointRequest);
                            {4182}new SP_4410: bitstring;
                            {4183}new UP_4411: bitstring;
                            {4184}out(c, (GetEndpointResponse,pkSess_4409,SignAndEncrypt,SP_4410,UP_4411))
                )
                else
                    {4185}let pkSess_4412: bitstring = fail-any in
                    {4186}in(c, =GetEndpointRequest);
                    {4187}new SP_4413: bitstring;
                    {4188}new UP_4414: bitstring;
                    {4189}out(c, (GetEndpointResponse,pkSess_4412,SignAndEncrypt,SP_4413,UP_4414))
        )
        else
            {4190}let v_4415: bool = (Disco_4233 = B) in
            (
                {4191}if v_4415 then
                (
                    {4192}let skDisco_4416: bitstring = skB in
                    {4193}let pkDisco_4417: bitstring = pub(skDisco_4416) in
                    {4194}let v_4418: bool = (Cli_4232 = A) in
                    (
                        {4195}if v_4418 then
                        (
                            {4196}let pkCli_4419: bitstring = pub(skA) in
                            {4197}let v_4420: bool = (Sess_4234 = A) in
                            (
                                {4198}if v_4420 then
                                (
                                    {4199}let pkSess_4421: bitstring = pub(skA) in
                                    {4200}in(c, =GetEndpointRequest);
                                    {4201}new SP_4422: bitstring;
                                    {4202}new UP_4423: bitstring;
                                    {4203}out(c, (GetEndpointResponse,pkSess_4421,SignAndEncrypt,SP_4422,UP_4423))
                                )
                                else
                                    {4204}let v_4424: bool = (Sess_4234 = B) in
                                    (
                                        {4205}if v_4424 then
                                        (
                                            {4206}let pkSess_4425: bitstring = pub(skB) in
                                            {4207}in(c, =GetEndpointRequest);
                                            {4208}new SP_4426: bitstring;
                                            {4209}new UP_4427: bitstring;
                                            {4210}out(c, (GetEndpointResponse,pkSess_4425,SignAndEncrypt,SP_4426,UP_4427))
                                        )
                                        else
                                            {4211}let v_4428: bool = (Sess_4234 = C) in
                                            (
                                                {4212}if v_4428 then
                                                (
                                                    {4213}let pkSess_4429: bitstring = pub(skC) in
                                                    {4214}in(c, =GetEndpointRequest);
                                                    {4215}new SP_4430: bitstring;
                                                    {4216}new UP_4431: bitstring;
                                                    {4217}out(c, (GetEndpointResponse,pkSess_4429,SignAndEncrypt,SP_4430,UP_4431))
                                                )
                                                else
                                                    {4218}let pkSess_4432: bitstring = pub(sk(Sess_4234)) in
                                                    {4219}in(c, =GetEndpointRequest);
                                                    {4220}new SP_4433: bitstring;
                                                    {4221}new UP_4434: bitstring;
                                                    {4222}out(c, (GetEndpointResponse,pkSess_4432,SignAndEncrypt,SP_4433,UP_4434))
                                            )
                                            else
                                                {4223}let pkSess_4435: bitstring = fail-any in
                                                {4224}in(c, =GetEndpointRequest);
                                                {4225}new SP_4436: bitstring;
                                                {4226}new UP_4437: bitstring;
                                                {4227}out(c, (GetEndpointResponse,pkSess_4435,SignAndEncrypt,SP_4436,UP_4437))
                                    )
                                    else
                                        {4228}let pkSess_4438: bitstring = fail-any in
                                        {4229}in(c, =GetEndpointRequest);
                                        {4230}new SP_4439: bitstring;
                                        {4231}new UP_4440: bitstring;
                                        {4232}out(c, (GetEndpointResponse,pkSess_4438,SignAndEncrypt,SP_4439,UP_4440))
                            )
                            else
                                {4233}let pkSess_4441: bitstring = fail-any in
                                {4234}in(c, =GetEndpointRequest);
                                {4235}new SP_4442: bitstring;
                                {4236}new UP_4443: bitstring;
                                {4237}out(c, (GetEndpointResponse,pkSess_4441,SignAndEncrypt,SP_4442,UP_4443))
                        )
                        else
                            {4238}let v_4444: bool = (Cli_4232 = B) in
                            (
                                {4239}if v_4444 then
                                (
                                    {4240}let pkCli_4445: bitstring = pub(skB) in
                                    {4241}let v_4446: bool = (Sess_4234 = A) in
                                    (
                                        {4242}if v_4446 then
                                        (
                                            {4243}let pkSess_4447: bitstring = pub(skA) in
                                            {4244}in(c, =GetEndpointRequest);
                                            {4245}new SP_4448: bitstring;
                                            {4246}new UP_4449: bitstring;
                                            {4247}out(c, (GetEndpointResponse,pkSess_4447,SignAndEncrypt,SP_4448,UP_4449))
                                        )
                                        else
                                            {4248}let v_4450: bool = (Sess_4234 = B) in
                                            (
                                                {4249}if v_4450 then
                                                (
                                                    {4250}let pkSess_4451: bitstring = pub(skB) in
                                                    {4251}in(c, =GetEndpointRequest);
                                                    {4252}new SP_4452: bitstring;
                                                    {4253}new UP_4453: bitstring;
                                                    {4254}out(c, (GetEndpointResponse,pkSess_4451,SignAndEncrypt,SP_4452,UP_4453))
                                                )
                                                else
                                                    {4255}let v_4454: bool = (Sess_4234 = C) in
                                                    (
                                                        {4256}if v_4454 then
                                                        (
                                                            {4257}let pkSess_4455: bitstring = pub(skC) in
                                                            {4258}in(c, =GetEndpointRequest);
                                                            {4259}new SP_4456: bitstring;
                                                            {4260}new UP_4457: bitstring;
                                                            {4261}out(c, (GetEndpointResponse,pkSess_4455,SignAndEncrypt,SP_4456,UP_4457))
                                                        )
                                                        else
                                                            {4262}let pkSess_4458: bitstring = pub(sk(Sess_4234)) in
                                                            {4263}in(c, =GetEndpointRequest);
                                                            {4264}new SP_4459: bitstring;
                                                            {4265}new UP_4460: bitstring;
                                                            {4266}out(c, (GetEndpointResponse,pkSess_4458,SignAndEncrypt,SP_4459,UP_4460))
                                                    )
                                                    else
                                                        {4267}let pkSess_4461: bitstring = fail-any in
                                                        {4268}in(c, =GetEndpointRequest);
                                                        {4269}new SP_4462: bitstring;
                                                        {4270}new UP_4463: bitstring;
                                                        {4271}out(c, (GetEndpointResponse,pkSess_4461,SignAndEncrypt,SP_4462,UP_4463))
                                            )
                                            else
                                                {4272}let pkSess_4464: bitstring = fail-any in
                                                {4273}in(c, =GetEndpointRequest);
                                                {4274}new SP_4465: bitstring;
                                                {4275}new UP_4466: bitstring;
                                                {4276}out(c, (GetEndpointResponse,pkSess_4464,SignAndEncrypt,SP_4465,UP_4466))
                                    )
                                    else
                                        {4277}let pkSess_4467: bitstring = fail-any in
                                        {4278}in(c, =GetEndpointRequest);
                                        {4279}new SP_4468: bitstring;
                                        {4280}new UP_4469: bitstring;
                                        {4281}out(c, (GetEndpointResponse,pkSess_4467,SignAndEncrypt,SP_4468,UP_4469))
                                )
                                else
                                    {4282}let v_4470: bool = (Cli_4232 = C) in
                                    (
                                        {4283}if v_4470 then
                                        (
                                            {4284}let pkCli_4471: bitstring = pub(skC) in
                                            {4285}let v_4472: bool = (Sess_4234 = A) in
                                            (
                                                {4286}if v_4472 then
                                                (
                                                    {4287}let pkSess_4473: bitstring = pub(skA) in
                                                    {4288}in(c, =GetEndpointRequest);
                                                    {4289}new SP_4474: bitstring;
                                                    {4290}new UP_4475: bitstring;
                                                    {4291}out(c, (GetEndpointResponse,pkSess_4473,SignAndEncrypt,SP_4474,UP_4475))
                                                )
                                                else
                                                    {4292}let v_4476: bool = (Sess_4234 = B) in
                                                    (
                                                        {4293}if v_4476 then
                                                        (
                                                            {4294}let pkSess_4477: bitstring = pub(skB) in
                                                            {4295}in(c, =GetEndpointRequest);
                                                            {4296}new SP_4478: bitstring;
                                                            {4297}new UP_4479: bitstring;
                                                            {4298}out(c, (GetEndpointResponse,pkSess_4477,SignAndEncrypt,SP_4478,UP_4479))
                                                        )
                                                        else
                                                            {4299}let v_4480: bool = (Sess_4234 = C) in
                                                            (
                                                                {4300}if v_4480 then
                                                                (
                                                                    {4301}let pkSess_4481: bitstring = pub(skC) in
                                                                    {4302}in(c, =GetEndpointRequest);
                                                                    {4303}new SP_4482: bitstring;
                                                                    {4304}new UP_4483: bitstring;
                                                                    {4305}out(c, (GetEndpointResponse,pkSess_4481,SignAndEncrypt,SP_4482,UP_4483))
                                                                )
                                                                else
                                                                    {4306}let pkSess_4484: bitstring = pub(sk(Sess_4234)) in
                                                                    {4307}in(c, =GetEndpointRequest);
                                                                    {4308}new SP_4485: bitstring;
                                                                    {4309}new UP_4486: bitstring;
                                                                    {4310}out(c, (GetEndpointResponse,pkSess_4484,SignAndEncrypt,SP_4485,UP_4486))
                                                            )
                                                            else
                                                                {4311}let pkSess_4487: bitstring = fail-any in
                                                                {4312}in(c, =GetEndpointRequest);
                                                                {4313}new SP_4488: bitstring;
                                                                {4314}new UP_4489: bitstring;
                                                                {4315}out(c, (GetEndpointResponse,pkSess_4487,SignAndEncrypt,SP_4488,UP_4489))
                                                    )
                                                    else
                                                        {4316}let pkSess_4490: bitstring = fail-any in
                                                        {4317}in(c, =GetEndpointRequest);
                                                        {4318}new SP_4491: bitstring;
                                                        {4319}new UP_4492: bitstring;
                                                        {4320}out(c, (GetEndpointResponse,pkSess_4490,SignAndEncrypt,SP_4491,UP_4492))
                                            )
                                            else
                                                {4321}let pkSess_4493: bitstring = fail-any in
                                                {4322}in(c, =GetEndpointRequest);
                                                {4323}new SP_4494: bitstring;
                                                {4324}new UP_4495: bitstring;
                                                {4325}out(c, (GetEndpointResponse,pkSess_4493,SignAndEncrypt,SP_4494,UP_4495))
                                        )
                                        else
                                            {4326}let pkCli_4496: bitstring = pub(sk(Cli_4232)) in
                                            {4327}let v_4497: bool = (Sess_4234 = A) in
                                            (
                                                {4328}if v_4497 then
                                                (
                                                    {4329}let pkSess_4498: bitstring = pub(skA) in
                                                    {4330}in(c, =GetEndpointRequest);
                                                    {4331}new SP_4499: bitstring;
                                                    {4332}new UP_4500: bitstring;
                                                    {4333}out(c, (GetEndpointResponse,pkSess_4498,SignAndEncrypt,SP_4499,UP_4500))
                                                )
                                                else
                                                    {4334}let v_4501: bool = (Sess_4234 = B) in
                                                    (
                                                        {4335}if v_4501 then
                                                        (
                                                            {4336}let pkSess_4502: bitstring = pub(skB) in
                                                            {4337}in(c, =GetEndpointRequest);
                                                            {4338}new SP_4503: bitstring;
                                                            {4339}new UP_4504: bitstring;
                                                            {4340}out(c, (GetEndpointResponse,pkSess_4502,SignAndEncrypt,SP_4503,UP_4504))
                                                        )
                                                        else
                                                            {4341}let v_4505: bool = (Sess_4234 = C) in
                                                            (
                                                                {4342}if v_4505 then
                                                                (
                                                                    {4343}let pkSess_4506: bitstring = pub(skC) in
                                                                    {4344}in(c, =GetEndpointRequest);
                                                                    {4345}new SP_4507: bitstring;
                                                                    {4346}new UP_4508: bitstring;
                                                                    {4347}out(c, (GetEndpointResponse,pkSess_4506,SignAndEncrypt,SP_4507,UP_4508))
                                                                )
                                                                else
                                                                    {4348}let pkSess_4509: bitstring = pub(sk(Sess_4234)) in
                                                                    {4349}in(c, =GetEndpointRequest);
                                                                    {4350}new SP_4510: bitstring;
                                                                    {4351}new UP_4511: bitstring;
                                                                    {4352}out(c, (GetEndpointResponse,pkSess_4509,SignAndEncrypt,SP_4510,UP_4511))
                                                            )
                                                            else
                                                                {4353}let pkSess_4512: bitstring = fail-any in
                                                                {4354}in(c, =GetEndpointRequest);
                                                                {4355}new SP_4513: bitstring;
                                                                {4356}new UP_4514: bitstring;
                                                                {4357}out(c, (GetEndpointResponse,pkSess_4512,SignAndEncrypt,SP_4513,UP_4514))
                                                    )
                                                    else
                                                        {4358}let pkSess_4515: bitstring = fail-any in
                                                        {4359}in(c, =GetEndpointRequest);
                                                        {4360}new SP_4516: bitstring;
                                                        {4361}new UP_4517: bitstring;
                                                        {4362}out(c, (GetEndpointResponse,pkSess_4515,SignAndEncrypt,SP_4516,UP_4517))
                                            )
                                            else
                                                {4363}let pkSess_4518: bitstring = fail-any in
                                                {4364}in(c, =GetEndpointRequest);
                                                {4365}new SP_4519: bitstring;
                                                {4366}new UP_4520: bitstring;
                                                {4367}out(c, (GetEndpointResponse,pkSess_4518,SignAndEncrypt,SP_4519,UP_4520))
                                    )
                                    else
                                        {4368}let pkCli_4521: bitstring = fail-any in
                                        {4369}let v_4522: bool = (Sess_4234 = A) in
                                        (
                                            {4370}if v_4522 then
                                            (
                                                {4371}let pkSess_4523: bitstring = pub(skA) in
                                                {4372}in(c, =GetEndpointRequest);
                                                {4373}new SP_4524: bitstring;
                                                {4374}new UP_4525: bitstring;
                                                {4375}out(c, (GetEndpointResponse,pkSess_4523,SignAndEncrypt,SP_4524,UP_4525))
                                            )
                                            else
                                                {4376}let v_4526: bool = (Sess_4234 = B) in
                                                (
                                                    {4377}if v_4526 then
                                                    (
                                                        {4378}let pkSess_4527: bitstring = pub(skB) in
                                                        {4379}in(c, =GetEndpointRequest);
                                                        {4380}new SP_4528: bitstring;
                                                        {4381}new UP_4529: bitstring;
                                                        {4382}out(c, (GetEndpointResponse,pkSess_4527,SignAndEncrypt,SP_4528,UP_4529))
                                                    )
                                                    else
                                                        {4383}let v_4530: bool = (Sess_4234 = C) in
                                                        (
                                                            {4384}if v_4530 then
                                                            (
                                                                {4385}let pkSess_4531: bitstring = pub(skC) in
                                                                {4386}in(c, =GetEndpointRequest);
                                                                {4387}new SP_4532: bitstring;
                                                                {4388}new UP_4533: bitstring;
                                                                {4389}out(c, (GetEndpointResponse,pkSess_4531,SignAndEncrypt,SP_4532,UP_4533))
                                                            )
                                                            else
                                                                {4390}let pkSess_4534: bitstring = pub(sk(Sess_4234)) in
                                                                {4391}in(c, =GetEndpointRequest);
                                                                {4392}new SP_4535: bitstring;
                                                                {4393}new UP_4536: bitstring;
                                                                {4394}out(c, (GetEndpointResponse,pkSess_4534,SignAndEncrypt,SP_4535,UP_4536))
                                                        )
                                                        else
                                                            {4395}let pkSess_4537: bitstring = fail-any in
                                                            {4396}in(c, =GetEndpointRequest);
                                                            {4397}new SP_4538: bitstring;
                                                            {4398}new UP_4539: bitstring;
                                                            {4399}out(c, (GetEndpointResponse,pkSess_4537,SignAndEncrypt,SP_4538,UP_4539))
                                                )
                                                else
                                                    {4400}let pkSess_4540: bitstring = fail-any in
                                                    {4401}in(c, =GetEndpointRequest);
                                                    {4402}new SP_4541: bitstring;
                                                    {4403}new UP_4542: bitstring;
                                                    {4404}out(c, (GetEndpointResponse,pkSess_4540,SignAndEncrypt,SP_4541,UP_4542))
                                        )
                                        else
                                            {4405}let pkSess_4543: bitstring = fail-any in
                                            {4406}in(c, =GetEndpointRequest);
                                            {4407}new SP_4544: bitstring;
                                            {4408}new UP_4545: bitstring;
                                            {4409}out(c, (GetEndpointResponse,pkSess_4543,SignAndEncrypt,SP_4544,UP_4545))
                            )
                            else
                                {4410}let pkCli_4546: bitstring = fail-any in
                                {4411}let v_4547: bool = (Sess_4234 = A) in
                                (
                                    {4412}if v_4547 then
                                    (
                                        {4413}let pkSess_4548: bitstring = pub(skA) in
                                        {4414}in(c, =GetEndpointRequest);
                                        {4415}new SP_4549: bitstring;
                                        {4416}new UP_4550: bitstring;
                                        {4417}out(c, (GetEndpointResponse,pkSess_4548,SignAndEncrypt,SP_4549,UP_4550))
                                    )
                                    else
                                        {4418}let v_4551: bool = (Sess_4234 = B) in
                                        (
                                            {4419}if v_4551 then
                                            (
                                                {4420}let pkSess_4552: bitstring = pub(skB) in
                                                {4421}in(c, =GetEndpointRequest);
                                                {4422}new SP_4553: bitstring;
                                                {4423}new UP_4554: bitstring;
                                                {4424}out(c, (GetEndpointResponse,pkSess_4552,SignAndEncrypt,SP_4553,UP_4554))
                                            )
                                            else
                                                {4425}let v_4555: bool = (Sess_4234 = C) in
                                                (
                                                    {4426}if v_4555 then
                                                    (
                                                        {4427}let pkSess_4556: bitstring = pub(skC) in
                                                        {4428}in(c, =GetEndpointRequest);
                                                        {4429}new SP_4557: bitstring;
                                                        {4430}new UP_4558: bitstring;
                                                        {4431}out(c, (GetEndpointResponse,pkSess_4556,SignAndEncrypt,SP_4557,UP_4558))
                                                    )
                                                    else
                                                        {4432}let pkSess_4559: bitstring = pub(sk(Sess_4234)) in
                                                        {4433}in(c, =GetEndpointRequest);
                                                        {4434}new SP_4560: bitstring;
                                                        {4435}new UP_4561: bitstring;
                                                        {4436}out(c, (GetEndpointResponse,pkSess_4559,SignAndEncrypt,SP_4560,UP_4561))
                                                )
                                                else
                                                    {4437}let pkSess_4562: bitstring = fail-any in
                                                    {4438}in(c, =GetEndpointRequest);
                                                    {4439}new SP_4563: bitstring;
                                                    {4440}new UP_4564: bitstring;
                                                    {4441}out(c, (GetEndpointResponse,pkSess_4562,SignAndEncrypt,SP_4563,UP_4564))
                                        )
                                        else
                                            {4442}let pkSess_4565: bitstring = fail-any in
                                            {4443}in(c, =GetEndpointRequest);
                                            {4444}new SP_4566: bitstring;
                                            {4445}new UP_4567: bitstring;
                                            {4446}out(c, (GetEndpointResponse,pkSess_4565,SignAndEncrypt,SP_4566,UP_4567))
                                )
                                else
                                    {4447}let pkSess_4568: bitstring = fail-any in
                                    {4448}in(c, =GetEndpointRequest);
                                    {4449}new SP_4569: bitstring;
                                    {4450}new UP_4570: bitstring;
                                    {4451}out(c, (GetEndpointResponse,pkSess_4568,SignAndEncrypt,SP_4569,UP_4570))
                    )
                    else
                        {4452}let pkCli_4571: bitstring = fail-any in
                        {4453}let v_4572: bool = (Sess_4234 = A) in
                        (
                            {4454}if v_4572 then
                            (
                                {4455}let pkSess_4573: bitstring = pub(skA) in
                                {4456}in(c, =GetEndpointRequest);
                                {4457}new SP_4574: bitstring;
                                {4458}new UP_4575: bitstring;
                                {4459}out(c, (GetEndpointResponse,pkSess_4573,SignAndEncrypt,SP_4574,UP_4575))
                            )
                            else
                                {4460}let v_4576: bool = (Sess_4234 = B) in
                                (
                                    {4461}if v_4576 then
                                    (
                                        {4462}let pkSess_4577: bitstring = pub(skB) in
                                        {4463}in(c, =GetEndpointRequest);
                                        {4464}new SP_4578: bitstring;
                                        {4465}new UP_4579: bitstring;
                                        {4466}out(c, (GetEndpointResponse,pkSess_4577,SignAndEncrypt,SP_4578,UP_4579))
                                    )
                                    else
                                        {4467}let v_4580: bool = (Sess_4234 = C) in
                                        (
                                            {4468}if v_4580 then
                                            (
                                                {4469}let pkSess_4581: bitstring = pub(skC) in
                                                {4470}in(c, =GetEndpointRequest);
                                                {4471}new SP_4582: bitstring;
                                                {4472}new UP_4583: bitstring;
                                                {4473}out(c, (GetEndpointResponse,pkSess_4581,SignAndEncrypt,SP_4582,UP_4583))
                                            )
                                            else
                                                {4474}let pkSess_4584: bitstring = pub(sk(Sess_4234)) in
                                                {4475}in(c, =GetEndpointRequest);
                                                {4476}new SP_4585: bitstring;
                                                {4477}new UP_4586: bitstring;
                                                {4478}out(c, (GetEndpointResponse,pkSess_4584,SignAndEncrypt,SP_4585,UP_4586))
                                        )
                                        else
                                            {4479}let pkSess_4587: bitstring = fail-any in
                                            {4480}in(c, =GetEndpointRequest);
                                            {4481}new SP_4588: bitstring;
                                            {4482}new UP_4589: bitstring;
                                            {4483}out(c, (GetEndpointResponse,pkSess_4587,SignAndEncrypt,SP_4588,UP_4589))
                                )
                                else
                                    {4484}let pkSess_4590: bitstring = fail-any in
                                    {4485}in(c, =GetEndpointRequest);
                                    {4486}new SP_4591: bitstring;
                                    {4487}new UP_4592: bitstring;
                                    {4488}out(c, (GetEndpointResponse,pkSess_4590,SignAndEncrypt,SP_4591,UP_4592))
                        )
                        else
                            {4489}let pkSess_4593: bitstring = fail-any in
                            {4490}in(c, =GetEndpointRequest);
                            {4491}new SP_4594: bitstring;
                            {4492}new UP_4595: bitstring;
                            {4493}out(c, (GetEndpointResponse,pkSess_4593,SignAndEncrypt,SP_4594,UP_4595))
                )
                else
                    {4494}let =true = (Disco_4233 = C) in
                    (
                        {4495}let skDisco_4596: bitstring = skC in
                        {4496}let pkDisco_4597: bitstring = pub(skDisco_4596) in
                        {4497}let v_4598: bool = (Cli_4232 = A) in
                        (
                            {4498}if v_4598 then
                            (
                                {4499}let pkCli_4599: bitstring = pub(skA) in
                                {4500}let v_4600: bool = (Sess_4234 = A) in
                                (
                                    {4501}if v_4600 then
                                    (
                                        {4502}let pkSess_4601: bitstring = pub(skA) in
                                        {4503}in(c, =GetEndpointRequest);
                                        {4504}new SP_4602: bitstring;
                                        {4505}new UP_4603: bitstring;
                                        {4506}out(c, (GetEndpointResponse,pkSess_4601,SignAndEncrypt,SP_4602,UP_4603))
                                    )
                                    else
                                        {4507}let v_4604: bool = (Sess_4234 = B) in
                                        (
                                            {4508}if v_4604 then
                                            (
                                                {4509}let pkSess_4605: bitstring = pub(skB) in
                                                {4510}in(c, =GetEndpointRequest);
                                                {4511}new SP_4606: bitstring;
                                                {4512}new UP_4607: bitstring;
                                                {4513}out(c, (GetEndpointResponse,pkSess_4605,SignAndEncrypt,SP_4606,UP_4607))
                                            )
                                            else
                                                {4514}let v_4608: bool = (Sess_4234 = C) in
                                                (
                                                    {4515}if v_4608 then
                                                    (
                                                        {4516}let pkSess_4609: bitstring = pub(skC) in
                                                        {4517}in(c, =GetEndpointRequest);
                                                        {4518}new SP_4610: bitstring;
                                                        {4519}new UP_4611: bitstring;
                                                        {4520}out(c, (GetEndpointResponse,pkSess_4609,SignAndEncrypt,SP_4610,UP_4611))
                                                    )
                                                    else
                                                        {4521}let pkSess_4612: bitstring = pub(sk(Sess_4234)) in
                                                        {4522}in(c, =GetEndpointRequest);
                                                        {4523}new SP_4613: bitstring;
                                                        {4524}new UP_4614: bitstring;
                                                        {4525}out(c, (GetEndpointResponse,pkSess_4612,SignAndEncrypt,SP_4613,UP_4614))
                                                )
                                                else
                                                    {4526}let pkSess_4615: bitstring = fail-any in
                                                    {4527}in(c, =GetEndpointRequest);
                                                    {4528}new SP_4616: bitstring;
                                                    {4529}new UP_4617: bitstring;
                                                    {4530}out(c, (GetEndpointResponse,pkSess_4615,SignAndEncrypt,SP_4616,UP_4617))
                                        )
                                        else
                                            {4531}let pkSess_4618: bitstring = fail-any in
                                            {4532}in(c, =GetEndpointRequest);
                                            {4533}new SP_4619: bitstring;
                                            {4534}new UP_4620: bitstring;
                                            {4535}out(c, (GetEndpointResponse,pkSess_4618,SignAndEncrypt,SP_4619,UP_4620))
                                )
                                else
                                    {4536}let pkSess_4621: bitstring = fail-any in
                                    {4537}in(c, =GetEndpointRequest);
                                    {4538}new SP_4622: bitstring;
                                    {4539}new UP_4623: bitstring;
                                    {4540}out(c, (GetEndpointResponse,pkSess_4621,SignAndEncrypt,SP_4622,UP_4623))
                            )
                            else
                                {4541}let v_4624: bool = (Cli_4232 = B) in
                                (
                                    {4542}if v_4624 then
                                    (
                                        {4543}let pkCli_4625: bitstring = pub(skB) in
                                        {4544}let v_4626: bool = (Sess_4234 = A) in
                                        (
                                            {4545}if v_4626 then
                                            (
                                                {4546}let pkSess_4627: bitstring = pub(skA) in
                                                {4547}in(c, =GetEndpointRequest);
                                                {4548}new SP_4628: bitstring;
                                                {4549}new UP_4629: bitstring;
                                                {4550}out(c, (GetEndpointResponse,pkSess_4627,SignAndEncrypt,SP_4628,UP_4629))
                                            )
                                            else
                                                {4551}let v_4630: bool = (Sess_4234 = B) in
                                                (
                                                    {4552}if v_4630 then
                                                    (
                                                        {4553}let pkSess_4631: bitstring = pub(skB) in
                                                        {4554}in(c, =GetEndpointRequest);
                                                        {4555}new SP_4632: bitstring;
                                                        {4556}new UP_4633: bitstring;
                                                        {4557}out(c, (GetEndpointResponse,pkSess_4631,SignAndEncrypt,SP_4632,UP_4633))
                                                    )
                                                    else
                                                        {4558}let v_4634: bool = (Sess_4234 = C) in
                                                        (
                                                            {4559}if v_4634 then
                                                            (
                                                                {4560}let pkSess_4635: bitstring = pub(skC) in
                                                                {4561}in(c, =GetEndpointRequest);
                                                                {4562}new SP_4636: bitstring;
                                                                {4563}new UP_4637: bitstring;
                                                                {4564}out(c, (GetEndpointResponse,pkSess_4635,SignAndEncrypt,SP_4636,UP_4637))
                                                            )
                                                            else
                                                                {4565}let pkSess_4638: bitstring = pub(sk(Sess_4234)) in
                                                                {4566}in(c, =GetEndpointRequest);
                                                                {4567}new SP_4639: bitstring;
                                                                {4568}new UP_4640: bitstring;
                                                                {4569}out(c, (GetEndpointResponse,pkSess_4638,SignAndEncrypt,SP_4639,UP_4640))
                                                        )
                                                        else
                                                            {4570}let pkSess_4641: bitstring = fail-any in
                                                            {4571}in(c, =GetEndpointRequest);
                                                            {4572}new SP_4642: bitstring;
                                                            {4573}new UP_4643: bitstring;
                                                            {4574}out(c, (GetEndpointResponse,pkSess_4641,SignAndEncrypt,SP_4642,UP_4643))
                                                )
                                                else
                                                    {4575}let pkSess_4644: bitstring = fail-any in
                                                    {4576}in(c, =GetEndpointRequest);
                                                    {4577}new SP_4645: bitstring;
                                                    {4578}new UP_4646: bitstring;
                                                    {4579}out(c, (GetEndpointResponse,pkSess_4644,SignAndEncrypt,SP_4645,UP_4646))
                                        )
                                        else
                                            {4580}let pkSess_4647: bitstring = fail-any in
                                            {4581}in(c, =GetEndpointRequest);
                                            {4582}new SP_4648: bitstring;
                                            {4583}new UP_4649: bitstring;
                                            {4584}out(c, (GetEndpointResponse,pkSess_4647,SignAndEncrypt,SP_4648,UP_4649))
                                    )
                                    else
                                        {4585}let v_4650: bool = (Cli_4232 = C) in
                                        (
                                            {4586}if v_4650 then
                                            (
                                                {4587}let pkCli_4651: bitstring = pub(skC) in
                                                {4588}let v_4652: bool = (Sess_4234 = A) in
                                                (
                                                    {4589}if v_4652 then
                                                    (
                                                        {4590}let pkSess_4653: bitstring = pub(skA) in
                                                        {4591}in(c, =GetEndpointRequest);
                                                        {4592}new SP_4654: bitstring;
                                                        {4593}new UP_4655: bitstring;
                                                        {4594}out(c, (GetEndpointResponse,pkSess_4653,SignAndEncrypt,SP_4654,UP_4655))
                                                    )
                                                    else
                                                        {4595}let v_4656: bool = (Sess_4234 = B) in
                                                        (
                                                            {4596}if v_4656 then
                                                            (
                                                                {4597}let pkSess_4657: bitstring = pub(skB) in
                                                                {4598}in(c, =GetEndpointRequest);
                                                                {4599}new SP_4658: bitstring;
                                                                {4600}new UP_4659: bitstring;
                                                                {4601}out(c, (GetEndpointResponse,pkSess_4657,SignAndEncrypt,SP_4658,UP_4659))
                                                            )
                                                            else
                                                                {4602}let v_4660: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4603}if v_4660 then
                                                                    (
                                                                        {4604}let pkSess_4661: bitstring = pub(skC) in
                                                                        {4605}in(c, =GetEndpointRequest);
                                                                        {4606}new SP_4662: bitstring;
                                                                        {4607}new UP_4663: bitstring;
                                                                        {4608}out(c, (GetEndpointResponse,pkSess_4661,SignAndEncrypt,SP_4662,UP_4663))
                                                                    )
                                                                    else
                                                                        {4609}let pkSess_4664: bitstring = pub(sk(Sess_4234)) in
                                                                        {4610}in(c, =GetEndpointRequest);
                                                                        {4611}new SP_4665: bitstring;
                                                                        {4612}new UP_4666: bitstring;
                                                                        {4613}out(c, (GetEndpointResponse,pkSess_4664,SignAndEncrypt,SP_4665,UP_4666))
                                                                )
                                                                else
                                                                    {4614}let pkSess_4667: bitstring = fail-any in
                                                                    {4615}in(c, =GetEndpointRequest);
                                                                    {4616}new SP_4668: bitstring;
                                                                    {4617}new UP_4669: bitstring;
                                                                    {4618}out(c, (GetEndpointResponse,pkSess_4667,SignAndEncrypt,SP_4668,UP_4669))
                                                        )
                                                        else
                                                            {4619}let pkSess_4670: bitstring = fail-any in
                                                            {4620}in(c, =GetEndpointRequest);
                                                            {4621}new SP_4671: bitstring;
                                                            {4622}new UP_4672: bitstring;
                                                            {4623}out(c, (GetEndpointResponse,pkSess_4670,SignAndEncrypt,SP_4671,UP_4672))
                                                )
                                                else
                                                    {4624}let pkSess_4673: bitstring = fail-any in
                                                    {4625}in(c, =GetEndpointRequest);
                                                    {4626}new SP_4674: bitstring;
                                                    {4627}new UP_4675: bitstring;
                                                    {4628}out(c, (GetEndpointResponse,pkSess_4673,SignAndEncrypt,SP_4674,UP_4675))
                                            )
                                            else
                                                {4629}let pkCli_4676: bitstring = pub(sk(Cli_4232)) in
                                                {4630}let v_4677: bool = (Sess_4234 = A) in
                                                (
                                                    {4631}if v_4677 then
                                                    (
                                                        {4632}let pkSess_4678: bitstring = pub(skA) in
                                                        {4633}in(c, =GetEndpointRequest);
                                                        {4634}new SP_4679: bitstring;
                                                        {4635}new UP_4680: bitstring;
                                                        {4636}out(c, (GetEndpointResponse,pkSess_4678,SignAndEncrypt,SP_4679,UP_4680))
                                                    )
                                                    else
                                                        {4637}let v_4681: bool = (Sess_4234 = B) in
                                                        (
                                                            {4638}if v_4681 then
                                                            (
                                                                {4639}let pkSess_4682: bitstring = pub(skB) in
                                                                {4640}in(c, =GetEndpointRequest);
                                                                {4641}new SP_4683: bitstring;
                                                                {4642}new UP_4684: bitstring;
                                                                {4643}out(c, (GetEndpointResponse,pkSess_4682,SignAndEncrypt,SP_4683,UP_4684))
                                                            )
                                                            else
                                                                {4644}let v_4685: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4645}if v_4685 then
                                                                    (
                                                                        {4646}let pkSess_4686: bitstring = pub(skC) in
                                                                        {4647}in(c, =GetEndpointRequest);
                                                                        {4648}new SP_4687: bitstring;
                                                                        {4649}new UP_4688: bitstring;
                                                                        {4650}out(c, (GetEndpointResponse,pkSess_4686,SignAndEncrypt,SP_4687,UP_4688))
                                                                    )
                                                                    else
                                                                        {4651}let pkSess_4689: bitstring = pub(sk(Sess_4234)) in
                                                                        {4652}in(c, =GetEndpointRequest);
                                                                        {4653}new SP_4690: bitstring;
                                                                        {4654}new UP_4691: bitstring;
                                                                        {4655}out(c, (GetEndpointResponse,pkSess_4689,SignAndEncrypt,SP_4690,UP_4691))
                                                                )
                                                                else
                                                                    {4656}let pkSess_4692: bitstring = fail-any in
                                                                    {4657}in(c, =GetEndpointRequest);
                                                                    {4658}new SP_4693: bitstring;
                                                                    {4659}new UP_4694: bitstring;
                                                                    {4660}out(c, (GetEndpointResponse,pkSess_4692,SignAndEncrypt,SP_4693,UP_4694))
                                                        )
                                                        else
                                                            {4661}let pkSess_4695: bitstring = fail-any in
                                                            {4662}in(c, =GetEndpointRequest);
                                                            {4663}new SP_4696: bitstring;
                                                            {4664}new UP_4697: bitstring;
                                                            {4665}out(c, (GetEndpointResponse,pkSess_4695,SignAndEncrypt,SP_4696,UP_4697))
                                                )
                                                else
                                                    {4666}let pkSess_4698: bitstring = fail-any in
                                                    {4667}in(c, =GetEndpointRequest);
                                                    {4668}new SP_4699: bitstring;
                                                    {4669}new UP_4700: bitstring;
                                                    {4670}out(c, (GetEndpointResponse,pkSess_4698,SignAndEncrypt,SP_4699,UP_4700))
                                        )
                                        else
                                            {4671}let pkCli_4701: bitstring = fail-any in
                                            {4672}let v_4702: bool = (Sess_4234 = A) in
                                            (
                                                {4673}if v_4702 then
                                                (
                                                    {4674}let pkSess_4703: bitstring = pub(skA) in
                                                    {4675}in(c, =GetEndpointRequest);
                                                    {4676}new SP_4704: bitstring;
                                                    {4677}new UP_4705: bitstring;
                                                    {4678}out(c, (GetEndpointResponse,pkSess_4703,SignAndEncrypt,SP_4704,UP_4705))
                                                )
                                                else
                                                    {4679}let v_4706: bool = (Sess_4234 = B) in
                                                    (
                                                        {4680}if v_4706 then
                                                        (
                                                            {4681}let pkSess_4707: bitstring = pub(skB) in
                                                            {4682}in(c, =GetEndpointRequest);
                                                            {4683}new SP_4708: bitstring;
                                                            {4684}new UP_4709: bitstring;
                                                            {4685}out(c, (GetEndpointResponse,pkSess_4707,SignAndEncrypt,SP_4708,UP_4709))
                                                        )
                                                        else
                                                            {4686}let v_4710: bool = (Sess_4234 = C) in
                                                            (
                                                                {4687}if v_4710 then
                                                                (
                                                                    {4688}let pkSess_4711: bitstring = pub(skC) in
                                                                    {4689}in(c, =GetEndpointRequest);
                                                                    {4690}new SP_4712: bitstring;
                                                                    {4691}new UP_4713: bitstring;
                                                                    {4692}out(c, (GetEndpointResponse,pkSess_4711,SignAndEncrypt,SP_4712,UP_4713))
                                                                )
                                                                else
                                                                    {4693}let pkSess_4714: bitstring = pub(sk(Sess_4234)) in
                                                                    {4694}in(c, =GetEndpointRequest);
                                                                    {4695}new SP_4715: bitstring;
                                                                    {4696}new UP_4716: bitstring;
                                                                    {4697}out(c, (GetEndpointResponse,pkSess_4714,SignAndEncrypt,SP_4715,UP_4716))
                                                            )
                                                            else
                                                                {4698}let pkSess_4717: bitstring = fail-any in
                                                                {4699}in(c, =GetEndpointRequest);
                                                                {4700}new SP_4718: bitstring;
                                                                {4701}new UP_4719: bitstring;
                                                                {4702}out(c, (GetEndpointResponse,pkSess_4717,SignAndEncrypt,SP_4718,UP_4719))
                                                    )
                                                    else
                                                        {4703}let pkSess_4720: bitstring = fail-any in
                                                        {4704}in(c, =GetEndpointRequest);
                                                        {4705}new SP_4721: bitstring;
                                                        {4706}new UP_4722: bitstring;
                                                        {4707}out(c, (GetEndpointResponse,pkSess_4720,SignAndEncrypt,SP_4721,UP_4722))
                                            )
                                            else
                                                {4708}let pkSess_4723: bitstring = fail-any in
                                                {4709}in(c, =GetEndpointRequest);
                                                {4710}new SP_4724: bitstring;
                                                {4711}new UP_4725: bitstring;
                                                {4712}out(c, (GetEndpointResponse,pkSess_4723,SignAndEncrypt,SP_4724,UP_4725))
                                )
                                else
                                    {4713}let pkCli_4726: bitstring = fail-any in
                                    {4714}let v_4727: bool = (Sess_4234 = A) in
                                    (
                                        {4715}if v_4727 then
                                        (
                                            {4716}let pkSess_4728: bitstring = pub(skA) in
                                            {4717}in(c, =GetEndpointRequest);
                                            {4718}new SP_4729: bitstring;
                                            {4719}new UP_4730: bitstring;
                                            {4720}out(c, (GetEndpointResponse,pkSess_4728,SignAndEncrypt,SP_4729,UP_4730))
                                        )
                                        else
                                            {4721}let v_4731: bool = (Sess_4234 = B) in
                                            (
                                                {4722}if v_4731 then
                                                (
                                                    {4723}let pkSess_4732: bitstring = pub(skB) in
                                                    {4724}in(c, =GetEndpointRequest);
                                                    {4725}new SP_4733: bitstring;
                                                    {4726}new UP_4734: bitstring;
                                                    {4727}out(c, (GetEndpointResponse,pkSess_4732,SignAndEncrypt,SP_4733,UP_4734))
                                                )
                                                else
                                                    {4728}let v_4735: bool = (Sess_4234 = C) in
                                                    (
                                                        {4729}if v_4735 then
                                                        (
                                                            {4730}let pkSess_4736: bitstring = pub(skC) in
                                                            {4731}in(c, =GetEndpointRequest);
                                                            {4732}new SP_4737: bitstring;
                                                            {4733}new UP_4738: bitstring;
                                                            {4734}out(c, (GetEndpointResponse,pkSess_4736,SignAndEncrypt,SP_4737,UP_4738))
                                                        )
                                                        else
                                                            {4735}let pkSess_4739: bitstring = pub(sk(Sess_4234)) in
                                                            {4736}in(c, =GetEndpointRequest);
                                                            {4737}new SP_4740: bitstring;
                                                            {4738}new UP_4741: bitstring;
                                                            {4739}out(c, (GetEndpointResponse,pkSess_4739,SignAndEncrypt,SP_4740,UP_4741))
                                                    )
                                                    else
                                                        {4740}let pkSess_4742: bitstring = fail-any in
                                                        {4741}in(c, =GetEndpointRequest);
                                                        {4742}new SP_4743: bitstring;
                                                        {4743}new UP_4744: bitstring;
                                                        {4744}out(c, (GetEndpointResponse,pkSess_4742,SignAndEncrypt,SP_4743,UP_4744))
                                            )
                                            else
                                                {4745}let pkSess_4745: bitstring = fail-any in
                                                {4746}in(c, =GetEndpointRequest);
                                                {4747}new SP_4746: bitstring;
                                                {4748}new UP_4747: bitstring;
                                                {4749}out(c, (GetEndpointResponse,pkSess_4745,SignAndEncrypt,SP_4746,UP_4747))
                                    )
                                    else
                                        {4750}let pkSess_4748: bitstring = fail-any in
                                        {4751}in(c, =GetEndpointRequest);
                                        {4752}new SP_4749: bitstring;
                                        {4753}new UP_4750: bitstring;
                                        {4754}out(c, (GetEndpointResponse,pkSess_4748,SignAndEncrypt,SP_4749,UP_4750))
                        )
                        else
                            {4755}let pkCli_4751: bitstring = fail-any in
                            {4756}let v_4752: bool = (Sess_4234 = A) in
                            (
                                {4757}if v_4752 then
                                (
                                    {4758}let pkSess_4753: bitstring = pub(skA) in
                                    {4759}in(c, =GetEndpointRequest);
                                    {4760}new SP_4754: bitstring;
                                    {4761}new UP_4755: bitstring;
                                    {4762}out(c, (GetEndpointResponse,pkSess_4753,SignAndEncrypt,SP_4754,UP_4755))
                                )
                                else
                                    {4763}let v_4756: bool = (Sess_4234 = B) in
                                    (
                                        {4764}if v_4756 then
                                        (
                                            {4765}let pkSess_4757: bitstring = pub(skB) in
                                            {4766}in(c, =GetEndpointRequest);
                                            {4767}new SP_4758: bitstring;
                                            {4768}new UP_4759: bitstring;
                                            {4769}out(c, (GetEndpointResponse,pkSess_4757,SignAndEncrypt,SP_4758,UP_4759))
                                        )
                                        else
                                            {4770}let v_4760: bool = (Sess_4234 = C) in
                                            (
                                                {4771}if v_4760 then
                                                (
                                                    {4772}let pkSess_4761: bitstring = pub(skC) in
                                                    {4773}in(c, =GetEndpointRequest);
                                                    {4774}new SP_4762: bitstring;
                                                    {4775}new UP_4763: bitstring;
                                                    {4776}out(c, (GetEndpointResponse,pkSess_4761,SignAndEncrypt,SP_4762,UP_4763))
                                                )
                                                else
                                                    {4777}let pkSess_4764: bitstring = pub(sk(Sess_4234)) in
                                                    {4778}in(c, =GetEndpointRequest);
                                                    {4779}new SP_4765: bitstring;
                                                    {4780}new UP_4766: bitstring;
                                                    {4781}out(c, (GetEndpointResponse,pkSess_4764,SignAndEncrypt,SP_4765,UP_4766))
                                            )
                                            else
                                                {4782}let pkSess_4767: bitstring = fail-any in
                                                {4783}in(c, =GetEndpointRequest);
                                                {4784}new SP_4768: bitstring;
                                                {4785}new UP_4769: bitstring;
                                                {4786}out(c, (GetEndpointResponse,pkSess_4767,SignAndEncrypt,SP_4768,UP_4769))
                                    )
                                    else
                                        {4787}let pkSess_4770: bitstring = fail-any in
                                        {4788}in(c, =GetEndpointRequest);
                                        {4789}new SP_4771: bitstring;
                                        {4790}new UP_4772: bitstring;
                                        {4791}out(c, (GetEndpointResponse,pkSess_4770,SignAndEncrypt,SP_4771,UP_4772))
                            )
                            else
                                {4792}let pkSess_4773: bitstring = fail-any in
                                {4793}in(c, =GetEndpointRequest);
                                {4794}new SP_4774: bitstring;
                                {4795}new UP_4775: bitstring;
                                {4796}out(c, (GetEndpointResponse,pkSess_4773,SignAndEncrypt,SP_4774,UP_4775))
                    )
                    else
                        {4797}let skDisco_4776: bitstring = fail-any in
                        {4798}let pkDisco_4777: bitstring = pub(skDisco_4776) in
                        {4799}let v_4778: bool = (Cli_4232 = A) in
                        (
                            {4800}if v_4778 then
                            (
                                {4801}let pkCli_4779: bitstring = pub(skA) in
                                {4802}let v_4780: bool = (Sess_4234 = A) in
                                (
                                    {4803}if v_4780 then
                                    (
                                        {4804}let pkSess_4781: bitstring = pub(skA) in
                                        {4805}in(c, =GetEndpointRequest);
                                        {4806}new SP_4782: bitstring;
                                        {4807}new UP_4783: bitstring;
                                        {4808}out(c, (GetEndpointResponse,pkSess_4781,SignAndEncrypt,SP_4782,UP_4783))
                                    )
                                    else
                                        {4809}let v_4784: bool = (Sess_4234 = B) in
                                        (
                                            {4810}if v_4784 then
                                            (
                                                {4811}let pkSess_4785: bitstring = pub(skB) in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_4786: bitstring;
                                                {4814}new UP_4787: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_4785,SignAndEncrypt,SP_4786,UP_4787))
                                            )
                                            else
                                                {4816}let v_4788: bool = (Sess_4234 = C) in
                                                (
                                                    {4817}if v_4788 then
                                                    (
                                                        {4818}let pkSess_4789: bitstring = pub(skC) in
                                                        {4819}in(c, =GetEndpointRequest);
                                                        {4820}new SP_4790: bitstring;
                                                        {4821}new UP_4791: bitstring;
                                                        {4822}out(c, (GetEndpointResponse,pkSess_4789,SignAndEncrypt,SP_4790,UP_4791))
                                                    )
                                                    else
                                                        {4823}let pkSess_4792: bitstring = pub(sk(Sess_4234)) in
                                                        {4824}in(c, =GetEndpointRequest);
                                                        {4825}new SP_4793: bitstring;
                                                        {4826}new UP_4794: bitstring;
                                                        {4827}out(c, (GetEndpointResponse,pkSess_4792,SignAndEncrypt,SP_4793,UP_4794))
                                                )
                                                else
                                                    {4828}let pkSess_4795: bitstring = fail-any in
                                                    {4829}in(c, =GetEndpointRequest);
                                                    {4830}new SP_4796: bitstring;
                                                    {4831}new UP_4797: bitstring;
                                                    {4832}out(c, (GetEndpointResponse,pkSess_4795,SignAndEncrypt,SP_4796,UP_4797))
                                        )
                                        else
                                            {4833}let pkSess_4798: bitstring = fail-any in
                                            {4834}in(c, =GetEndpointRequest);
                                            {4835}new SP_4799: bitstring;
                                            {4836}new UP_4800: bitstring;
                                            {4837}out(c, (GetEndpointResponse,pkSess_4798,SignAndEncrypt,SP_4799,UP_4800))
                                )
                                else
                                    {4838}let pkSess_4801: bitstring = fail-any in
                                    {4839}in(c, =GetEndpointRequest);
                                    {4840}new SP_4802: bitstring;
                                    {4841}new UP_4803: bitstring;
                                    {4842}out(c, (GetEndpointResponse,pkSess_4801,SignAndEncrypt,SP_4802,UP_4803))
                            )
                            else
                                {4843}let v_4804: bool = (Cli_4232 = B) in
                                (
                                    {4844}if v_4804 then
                                    (
                                        {4845}let pkCli_4805: bitstring = pub(skB) in
                                        {4846}let v_4806: bool = (Sess_4234 = A) in
                                        (
                                            {4847}if v_4806 then
                                            (
                                                {4848}let pkSess_4807: bitstring = pub(skA) in
                                                {4849}in(c, =GetEndpointRequest);
                                                {4850}new SP_4808: bitstring;
                                                {4851}new UP_4809: bitstring;
                                                {4852}out(c, (GetEndpointResponse,pkSess_4807,SignAndEncrypt,SP_4808,UP_4809))
                                            )
                                            else
                                                {4853}let v_4810: bool = (Sess_4234 = B) in
                                                (
                                                    {4854}if v_4810 then
                                                    (
                                                        {4855}let pkSess_4811: bitstring = pub(skB) in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_4812: bitstring;
                                                        {4858}new UP_4813: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_4811,SignAndEncrypt,SP_4812,UP_4813))
                                                    )
                                                    else
                                                        {4860}let v_4814: bool = (Sess_4234 = C) in
                                                        (
                                                            {4861}if v_4814 then
                                                            (
                                                                {4862}let pkSess_4815: bitstring = pub(skC) in
                                                                {4863}in(c, =GetEndpointRequest);
                                                                {4864}new SP_4816: bitstring;
                                                                {4865}new UP_4817: bitstring;
                                                                {4866}out(c, (GetEndpointResponse,pkSess_4815,SignAndEncrypt,SP_4816,UP_4817))
                                                            )
                                                            else
                                                                {4867}let pkSess_4818: bitstring = pub(sk(Sess_4234)) in
                                                                {4868}in(c, =GetEndpointRequest);
                                                                {4869}new SP_4819: bitstring;
                                                                {4870}new UP_4820: bitstring;
                                                                {4871}out(c, (GetEndpointResponse,pkSess_4818,SignAndEncrypt,SP_4819,UP_4820))
                                                        )
                                                        else
                                                            {4872}let pkSess_4821: bitstring = fail-any in
                                                            {4873}in(c, =GetEndpointRequest);
                                                            {4874}new SP_4822: bitstring;
                                                            {4875}new UP_4823: bitstring;
                                                            {4876}out(c, (GetEndpointResponse,pkSess_4821,SignAndEncrypt,SP_4822,UP_4823))
                                                )
                                                else
                                                    {4877}let pkSess_4824: bitstring = fail-any in
                                                    {4878}in(c, =GetEndpointRequest);
                                                    {4879}new SP_4825: bitstring;
                                                    {4880}new UP_4826: bitstring;
                                                    {4881}out(c, (GetEndpointResponse,pkSess_4824,SignAndEncrypt,SP_4825,UP_4826))
                                        )
                                        else
                                            {4882}let pkSess_4827: bitstring = fail-any in
                                            {4883}in(c, =GetEndpointRequest);
                                            {4884}new SP_4828: bitstring;
                                            {4885}new UP_4829: bitstring;
                                            {4886}out(c, (GetEndpointResponse,pkSess_4827,SignAndEncrypt,SP_4828,UP_4829))
                                    )
                                    else
                                        {4887}let v_4830: bool = (Cli_4232 = C) in
                                        (
                                            {4888}if v_4830 then
                                            (
                                                {4889}let pkCli_4831: bitstring = pub(skC) in
                                                {4890}let v_4832: bool = (Sess_4234 = A) in
                                                (
                                                    {4891}if v_4832 then
                                                    (
                                                        {4892}let pkSess_4833: bitstring = pub(skA) in
                                                        {4893}in(c, =GetEndpointRequest);
                                                        {4894}new SP_4834: bitstring;
                                                        {4895}new UP_4835: bitstring;
                                                        {4896}out(c, (GetEndpointResponse,pkSess_4833,SignAndEncrypt,SP_4834,UP_4835))
                                                    )
                                                    else
                                                        {4897}let v_4836: bool = (Sess_4234 = B) in
                                                        (
                                                            {4898}if v_4836 then
                                                            (
                                                                {4899}let pkSess_4837: bitstring = pub(skB) in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_4838: bitstring;
                                                                {4902}new UP_4839: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_4837,SignAndEncrypt,SP_4838,UP_4839))
                                                            )
                                                            else
                                                                {4904}let v_4840: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4905}if v_4840 then
                                                                    (
                                                                        {4906}let pkSess_4841: bitstring = pub(skC) in
                                                                        {4907}in(c, =GetEndpointRequest);
                                                                        {4908}new SP_4842: bitstring;
                                                                        {4909}new UP_4843: bitstring;
                                                                        {4910}out(c, (GetEndpointResponse,pkSess_4841,SignAndEncrypt,SP_4842,UP_4843))
                                                                    )
                                                                    else
                                                                        {4911}let pkSess_4844: bitstring = pub(sk(Sess_4234)) in
                                                                        {4912}in(c, =GetEndpointRequest);
                                                                        {4913}new SP_4845: bitstring;
                                                                        {4914}new UP_4846: bitstring;
                                                                        {4915}out(c, (GetEndpointResponse,pkSess_4844,SignAndEncrypt,SP_4845,UP_4846))
                                                                )
                                                                else
                                                                    {4916}let pkSess_4847: bitstring = fail-any in
                                                                    {4917}in(c, =GetEndpointRequest);
                                                                    {4918}new SP_4848: bitstring;
                                                                    {4919}new UP_4849: bitstring;
                                                                    {4920}out(c, (GetEndpointResponse,pkSess_4847,SignAndEncrypt,SP_4848,UP_4849))
                                                        )
                                                        else
                                                            {4921}let pkSess_4850: bitstring = fail-any in
                                                            {4922}in(c, =GetEndpointRequest);
                                                            {4923}new SP_4851: bitstring;
                                                            {4924}new UP_4852: bitstring;
                                                            {4925}out(c, (GetEndpointResponse,pkSess_4850,SignAndEncrypt,SP_4851,UP_4852))
                                                )
                                                else
                                                    {4926}let pkSess_4853: bitstring = fail-any in
                                                    {4927}in(c, =GetEndpointRequest);
                                                    {4928}new SP_4854: bitstring;
                                                    {4929}new UP_4855: bitstring;
                                                    {4930}out(c, (GetEndpointResponse,pkSess_4853,SignAndEncrypt,SP_4854,UP_4855))
                                            )
                                            else
                                                {4931}let pkCli_4856: bitstring = pub(sk(Cli_4232)) in
                                                {4932}let v_4857: bool = (Sess_4234 = A) in
                                                (
                                                    {4933}if v_4857 then
                                                    (
                                                        {4934}let pkSess_4858: bitstring = pub(skA) in
                                                        {4935}in(c, =GetEndpointRequest);
                                                        {4936}new SP_4859: bitstring;
                                                        {4937}new UP_4860: bitstring;
                                                        {4938}out(c, (GetEndpointResponse,pkSess_4858,SignAndEncrypt,SP_4859,UP_4860))
                                                    )
                                                    else
                                                        {4939}let v_4861: bool = (Sess_4234 = B) in
                                                        (
                                                            {4940}if v_4861 then
                                                            (
                                                                {4941}let pkSess_4862: bitstring = pub(skB) in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_4863: bitstring;
                                                                {4944}new UP_4864: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_4862,SignAndEncrypt,SP_4863,UP_4864))
                                                            )
                                                            else
                                                                {4946}let v_4865: bool = (Sess_4234 = C) in
                                                                (
                                                                    {4947}if v_4865 then
                                                                    (
                                                                        {4948}let pkSess_4866: bitstring = pub(skC) in
                                                                        {4949}in(c, =GetEndpointRequest);
                                                                        {4950}new SP_4867: bitstring;
                                                                        {4951}new UP_4868: bitstring;
                                                                        {4952}out(c, (GetEndpointResponse,pkSess_4866,SignAndEncrypt,SP_4867,UP_4868))
                                                                    )
                                                                    else
                                                                        {4953}let pkSess_4869: bitstring = pub(sk(Sess_4234)) in
                                                                        {4954}in(c, =GetEndpointRequest);
                                                                        {4955}new SP_4870: bitstring;
                                                                        {4956}new UP_4871: bitstring;
                                                                        {4957}out(c, (GetEndpointResponse,pkSess_4869,SignAndEncrypt,SP_4870,UP_4871))
                                                                )
                                                                else
                                                                    {4958}let pkSess_4872: bitstring = fail-any in
                                                                    {4959}in(c, =GetEndpointRequest);
                                                                    {4960}new SP_4873: bitstring;
                                                                    {4961}new UP_4874: bitstring;
                                                                    {4962}out(c, (GetEndpointResponse,pkSess_4872,SignAndEncrypt,SP_4873,UP_4874))
                                                        )
                                                        else
                                                            {4963}let pkSess_4875: bitstring = fail-any in
                                                            {4964}in(c, =GetEndpointRequest);
                                                            {4965}new SP_4876: bitstring;
                                                            {4966}new UP_4877: bitstring;
                                                            {4967}out(c, (GetEndpointResponse,pkSess_4875,SignAndEncrypt,SP_4876,UP_4877))
                                                )
                                                else
                                                    {4968}let pkSess_4878: bitstring = fail-any in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4879: bitstring;
                                                    {4971}new UP_4880: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4878,SignAndEncrypt,SP_4879,UP_4880))
                                        )
                                        else
                                            {4973}let pkCli_4881: bitstring = fail-any in
                                            {4974}let v_4882: bool = (Sess_4234 = A) in
                                            (
                                                {4975}if v_4882 then
                                                (
                                                    {4976}let pkSess_4883: bitstring = pub(skA) in
                                                    {4977}in(c, =GetEndpointRequest);
                                                    {4978}new SP_4884: bitstring;
                                                    {4979}new UP_4885: bitstring;
                                                    {4980}out(c, (GetEndpointResponse,pkSess_4883,SignAndEncrypt,SP_4884,UP_4885))
                                                )
                                                else
                                                    {4981}let v_4886: bool = (Sess_4234 = B) in
                                                    (
                                                        {4982}if v_4886 then
                                                        (
                                                            {4983}let pkSess_4887: bitstring = pub(skB) in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_4888: bitstring;
                                                            {4986}new UP_4889: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_4887,SignAndEncrypt,SP_4888,UP_4889))
                                                        )
                                                        else
                                                            {4988}let v_4890: bool = (Sess_4234 = C) in
                                                            (
                                                                {4989}if v_4890 then
                                                                (
                                                                    {4990}let pkSess_4891: bitstring = pub(skC) in
                                                                    {4991}in(c, =GetEndpointRequest);
                                                                    {4992}new SP_4892: bitstring;
                                                                    {4993}new UP_4893: bitstring;
                                                                    {4994}out(c, (GetEndpointResponse,pkSess_4891,SignAndEncrypt,SP_4892,UP_4893))
                                                                )
                                                                else
                                                                    {4995}let pkSess_4894: bitstring = pub(sk(Sess_4234)) in
                                                                    {4996}in(c, =GetEndpointRequest);
                                                                    {4997}new SP_4895: bitstring;
                                                                    {4998}new UP_4896: bitstring;
                                                                    {4999}out(c, (GetEndpointResponse,pkSess_4894,SignAndEncrypt,SP_4895,UP_4896))
                                                            )
                                                            else
                                                                {5000}let pkSess_4897: bitstring = fail-any in
                                                                {5001}in(c, =GetEndpointRequest);
                                                                {5002}new SP_4898: bitstring;
                                                                {5003}new UP_4899: bitstring;
                                                                {5004}out(c, (GetEndpointResponse,pkSess_4897,SignAndEncrypt,SP_4898,UP_4899))
                                                    )
                                                    else
                                                        {5005}let pkSess_4900: bitstring = fail-any in
                                                        {5006}in(c, =GetEndpointRequest);
                                                        {5007}new SP_4901: bitstring;
                                                        {5008}new UP_4902: bitstring;
                                                        {5009}out(c, (GetEndpointResponse,pkSess_4900,SignAndEncrypt,SP_4901,UP_4902))
                                            )
                                            else
                                                {5010}let pkSess_4903: bitstring = fail-any in
                                                {5011}in(c, =GetEndpointRequest);
                                                {5012}new SP_4904: bitstring;
                                                {5013}new UP_4905: bitstring;
                                                {5014}out(c, (GetEndpointResponse,pkSess_4903,SignAndEncrypt,SP_4904,UP_4905))
                                )
                                else
                                    {5015}let pkCli_4906: bitstring = fail-any in
                                    {5016}let v_4907: bool = (Sess_4234 = A) in
                                    (
                                        {5017}if v_4907 then
                                        (
                                            {5018}let pkSess_4908: bitstring = pub(skA) in
                                            {5019}in(c, =GetEndpointRequest);
                                            {5020}new SP_4909: bitstring;
                                            {5021}new UP_4910: bitstring;
                                            {5022}out(c, (GetEndpointResponse,pkSess_4908,SignAndEncrypt,SP_4909,UP_4910))
                                        )
                                        else
                                            {5023}let v_4911: bool = (Sess_4234 = B) in
                                            (
                                                {5024}if v_4911 then
                                                (
                                                    {5025}let pkSess_4912: bitstring = pub(skB) in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_4913: bitstring;
                                                    {5028}new UP_4914: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_4912,SignAndEncrypt,SP_4913,UP_4914))
                                                )
                                                else
                                                    {5030}let v_4915: bool = (Sess_4234 = C) in
                                                    (
                                                        {5031}if v_4915 then
                                                        (
                                                            {5032}let pkSess_4916: bitstring = pub(skC) in
                                                            {5033}in(c, =GetEndpointRequest);
                                                            {5034}new SP_4917: bitstring;
                                                            {5035}new UP_4918: bitstring;
                                                            {5036}out(c, (GetEndpointResponse,pkSess_4916,SignAndEncrypt,SP_4917,UP_4918))
                                                        )
                                                        else
                                                            {5037}let pkSess_4919: bitstring = pub(sk(Sess_4234)) in
                                                            {5038}in(c, =GetEndpointRequest);
                                                            {5039}new SP_4920: bitstring;
                                                            {5040}new UP_4921: bitstring;
                                                            {5041}out(c, (GetEndpointResponse,pkSess_4919,SignAndEncrypt,SP_4920,UP_4921))
                                                    )
                                                    else
                                                        {5042}let pkSess_4922: bitstring = fail-any in
                                                        {5043}in(c, =GetEndpointRequest);
                                                        {5044}new SP_4923: bitstring;
                                                        {5045}new UP_4924: bitstring;
                                                        {5046}out(c, (GetEndpointResponse,pkSess_4922,SignAndEncrypt,SP_4923,UP_4924))
                                            )
                                            else
                                                {5047}let pkSess_4925: bitstring = fail-any in
                                                {5048}in(c, =GetEndpointRequest);
                                                {5049}new SP_4926: bitstring;
                                                {5050}new UP_4927: bitstring;
                                                {5051}out(c, (GetEndpointResponse,pkSess_4925,SignAndEncrypt,SP_4926,UP_4927))
                                    )
                                    else
                                        {5052}let pkSess_4928: bitstring = fail-any in
                                        {5053}in(c, =GetEndpointRequest);
                                        {5054}new SP_4929: bitstring;
                                        {5055}new UP_4930: bitstring;
                                        {5056}out(c, (GetEndpointResponse,pkSess_4928,SignAndEncrypt,SP_4929,UP_4930))
                        )
                        else
                            {5057}let pkCli_4931: bitstring = fail-any in
                            {5058}let v_4932: bool = (Sess_4234 = A) in
                            (
                                {5059}if v_4932 then
                                (
                                    {5060}let pkSess_4933: bitstring = pub(skA) in
                                    {5061}in(c, =GetEndpointRequest);
                                    {5062}new SP_4934: bitstring;
                                    {5063}new UP_4935: bitstring;
                                    {5064}out(c, (GetEndpointResponse,pkSess_4933,SignAndEncrypt,SP_4934,UP_4935))
                                )
                                else
                                    {5065}let v_4936: bool = (Sess_4234 = B) in
                                    (
                                        {5066}if v_4936 then
                                        (
                                            {5067}let pkSess_4937: bitstring = pub(skB) in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_4938: bitstring;
                                            {5070}new UP_4939: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_4937,SignAndEncrypt,SP_4938,UP_4939))
                                        )
                                        else
                                            {5072}let v_4940: bool = (Sess_4234 = C) in
                                            (
                                                {5073}if v_4940 then
                                                (
                                                    {5074}let pkSess_4941: bitstring = pub(skC) in
                                                    {5075}in(c, =GetEndpointRequest);
                                                    {5076}new SP_4942: bitstring;
                                                    {5077}new UP_4943: bitstring;
                                                    {5078}out(c, (GetEndpointResponse,pkSess_4941,SignAndEncrypt,SP_4942,UP_4943))
                                                )
                                                else
                                                    {5079}let pkSess_4944: bitstring = pub(sk(Sess_4234)) in
                                                    {5080}in(c, =GetEndpointRequest);
                                                    {5081}new SP_4945: bitstring;
                                                    {5082}new UP_4946: bitstring;
                                                    {5083}out(c, (GetEndpointResponse,pkSess_4944,SignAndEncrypt,SP_4945,UP_4946))
                                            )
                                            else
                                                {5084}let pkSess_4947: bitstring = fail-any in
                                                {5085}in(c, =GetEndpointRequest);
                                                {5086}new SP_4948: bitstring;
                                                {5087}new UP_4949: bitstring;
                                                {5088}out(c, (GetEndpointResponse,pkSess_4947,SignAndEncrypt,SP_4948,UP_4949))
                                    )
                                    else
                                        {5089}let pkSess_4950: bitstring = fail-any in
                                        {5090}in(c, =GetEndpointRequest);
                                        {5091}new SP_4951: bitstring;
                                        {5092}new UP_4952: bitstring;
                                        {5093}out(c, (GetEndpointResponse,pkSess_4950,SignAndEncrypt,SP_4951,UP_4952))
                            )
                            else
                                {5094}let pkSess_4953: bitstring = fail-any in
                                {5095}in(c, =GetEndpointRequest);
                                {5096}new SP_4954: bitstring;
                                {5097}new UP_4955: bitstring;
                                {5098}out(c, (GetEndpointResponse,pkSess_4953,SignAndEncrypt,SP_4954,UP_4955))
            )
            else
                {5099}let skDisco_4956: bitstring = fail-any in
                {5100}let pkDisco_4957: bitstring = pub(skDisco_4956) in
                {5101}let v_4958: bool = (Cli_4232 = A) in
                (
                    {5102}if v_4958 then
                    (
                        {5103}let pkCli_4959: bitstring = pub(skA) in
                        {5104}let v_4960: bool = (Sess_4234 = A) in
                        (
                            {5105}if v_4960 then
                            (
                                {5106}let pkSess_4961: bitstring = pub(skA) in
                                {5107}in(c, =GetEndpointRequest);
                                {5108}new SP_4962: bitstring;
                                {5109}new UP_4963: bitstring;
                                {5110}out(c, (GetEndpointResponse,pkSess_4961,SignAndEncrypt,SP_4962,UP_4963))
                            )
                            else
                                {5111}let v_4964: bool = (Sess_4234 = B) in
                                (
                                    {5112}if v_4964 then
                                    (
                                        {5113}let pkSess_4965: bitstring = pub(skB) in
                                        {5114}in(c, =GetEndpointRequest);
                                        {5115}new SP_4966: bitstring;
                                        {5116}new UP_4967: bitstring;
                                        {5117}out(c, (GetEndpointResponse,pkSess_4965,SignAndEncrypt,SP_4966,UP_4967))
                                    )
                                    else
                                        {5118}let v_4968: bool = (Sess_4234 = C) in
                                        (
                                            {5119}if v_4968 then
                                            (
                                                {5120}let pkSess_4969: bitstring = pub(skC) in
                                                {5121}in(c, =GetEndpointRequest);
                                                {5122}new SP_4970: bitstring;
                                                {5123}new UP_4971: bitstring;
                                                {5124}out(c, (GetEndpointResponse,pkSess_4969,SignAndEncrypt,SP_4970,UP_4971))
                                            )
                                            else
                                                {5125}let pkSess_4972: bitstring = pub(sk(Sess_4234)) in
                                                {5126}in(c, =GetEndpointRequest);
                                                {5127}new SP_4973: bitstring;
                                                {5128}new UP_4974: bitstring;
                                                {5129}out(c, (GetEndpointResponse,pkSess_4972,SignAndEncrypt,SP_4973,UP_4974))
                                        )
                                        else
                                            {5130}let pkSess_4975: bitstring = fail-any in
                                            {5131}in(c, =GetEndpointRequest);
                                            {5132}new SP_4976: bitstring;
                                            {5133}new UP_4977: bitstring;
                                            {5134}out(c, (GetEndpointResponse,pkSess_4975,SignAndEncrypt,SP_4976,UP_4977))
                                )
                                else
                                    {5135}let pkSess_4978: bitstring = fail-any in
                                    {5136}in(c, =GetEndpointRequest);
                                    {5137}new SP_4979: bitstring;
                                    {5138}new UP_4980: bitstring;
                                    {5139}out(c, (GetEndpointResponse,pkSess_4978,SignAndEncrypt,SP_4979,UP_4980))
                        )
                        else
                            {5140}let pkSess_4981: bitstring = fail-any in
                            {5141}in(c, =GetEndpointRequest);
                            {5142}new SP_4982: bitstring;
                            {5143}new UP_4983: bitstring;
                            {5144}out(c, (GetEndpointResponse,pkSess_4981,SignAndEncrypt,SP_4982,UP_4983))
                    )
                    else
                        {5145}let v_4984: bool = (Cli_4232 = B) in
                        (
                            {5146}if v_4984 then
                            (
                                {5147}let pkCli_4985: bitstring = pub(skB) in
                                {5148}let v_4986: bool = (Sess_4234 = A) in
                                (
                                    {5149}if v_4986 then
                                    (
                                        {5150}let pkSess_4987: bitstring = pub(skA) in
                                        {5151}in(c, =GetEndpointRequest);
                                        {5152}new SP_4988: bitstring;
                                        {5153}new UP_4989: bitstring;
                                        {5154}out(c, (GetEndpointResponse,pkSess_4987,SignAndEncrypt,SP_4988,UP_4989))
                                    )
                                    else
                                        {5155}let v_4990: bool = (Sess_4234 = B) in
                                        (
                                            {5156}if v_4990 then
                                            (
                                                {5157}let pkSess_4991: bitstring = pub(skB) in
                                                {5158}in(c, =GetEndpointRequest);
                                                {5159}new SP_4992: bitstring;
                                                {5160}new UP_4993: bitstring;
                                                {5161}out(c, (GetEndpointResponse,pkSess_4991,SignAndEncrypt,SP_4992,UP_4993))
                                            )
                                            else
                                                {5162}let v_4994: bool = (Sess_4234 = C) in
                                                (
                                                    {5163}if v_4994 then
                                                    (
                                                        {5164}let pkSess_4995: bitstring = pub(skC) in
                                                        {5165}in(c, =GetEndpointRequest);
                                                        {5166}new SP_4996: bitstring;
                                                        {5167}new UP_4997: bitstring;
                                                        {5168}out(c, (GetEndpointResponse,pkSess_4995,SignAndEncrypt,SP_4996,UP_4997))
                                                    )
                                                    else
                                                        {5169}let pkSess_4998: bitstring = pub(sk(Sess_4234)) in
                                                        {5170}in(c, =GetEndpointRequest);
                                                        {5171}new SP_4999: bitstring;
                                                        {5172}new UP_5000: bitstring;
                                                        {5173}out(c, (GetEndpointResponse,pkSess_4998,SignAndEncrypt,SP_4999,UP_5000))
                                                )
                                                else
                                                    {5174}let pkSess_5001: bitstring = fail-any in
                                                    {5175}in(c, =GetEndpointRequest);
                                                    {5176}new SP_5002: bitstring;
                                                    {5177}new UP_5003: bitstring;
                                                    {5178}out(c, (GetEndpointResponse,pkSess_5001,SignAndEncrypt,SP_5002,UP_5003))
                                        )
                                        else
                                            {5179}let pkSess_5004: bitstring = fail-any in
                                            {5180}in(c, =GetEndpointRequest);
                                            {5181}new SP_5005: bitstring;
                                            {5182}new UP_5006: bitstring;
                                            {5183}out(c, (GetEndpointResponse,pkSess_5004,SignAndEncrypt,SP_5005,UP_5006))
                                )
                                else
                                    {5184}let pkSess_5007: bitstring = fail-any in
                                    {5185}in(c, =GetEndpointRequest);
                                    {5186}new SP_5008: bitstring;
                                    {5187}new UP_5009: bitstring;
                                    {5188}out(c, (GetEndpointResponse,pkSess_5007,SignAndEncrypt,SP_5008,UP_5009))
                            )
                            else
                                {5189}let v_5010: bool = (Cli_4232 = C) in
                                (
                                    {5190}if v_5010 then
                                    (
                                        {5191}let pkCli_5011: bitstring = pub(skC) in
                                        {5192}let v_5012: bool = (Sess_4234 = A) in
                                        (
                                            {5193}if v_5012 then
                                            (
                                                {5194}let pkSess_5013: bitstring = pub(skA) in
                                                {5195}in(c, =GetEndpointRequest);
                                                {5196}new SP_5014: bitstring;
                                                {5197}new UP_5015: bitstring;
                                                {5198}out(c, (GetEndpointResponse,pkSess_5013,SignAndEncrypt,SP_5014,UP_5015))
                                            )
                                            else
                                                {5199}let v_5016: bool = (Sess_4234 = B) in
                                                (
                                                    {5200}if v_5016 then
                                                    (
                                                        {5201}let pkSess_5017: bitstring = pub(skB) in
                                                        {5202}in(c, =GetEndpointRequest);
                                                        {5203}new SP_5018: bitstring;
                                                        {5204}new UP_5019: bitstring;
                                                        {5205}out(c, (GetEndpointResponse,pkSess_5017,SignAndEncrypt,SP_5018,UP_5019))
                                                    )
                                                    else
                                                        {5206}let v_5020: bool = (Sess_4234 = C) in
                                                        (
                                                            {5207}if v_5020 then
                                                            (
                                                                {5208}let pkSess_5021: bitstring = pub(skC) in
                                                                {5209}in(c, =GetEndpointRequest);
                                                                {5210}new SP_5022: bitstring;
                                                                {5211}new UP_5023: bitstring;
                                                                {5212}out(c, (GetEndpointResponse,pkSess_5021,SignAndEncrypt,SP_5022,UP_5023))
                                                            )
                                                            else
                                                                {5213}let pkSess_5024: bitstring = pub(sk(Sess_4234)) in
                                                                {5214}in(c, =GetEndpointRequest);
                                                                {5215}new SP_5025: bitstring;
                                                                {5216}new UP_5026: bitstring;
                                                                {5217}out(c, (GetEndpointResponse,pkSess_5024,SignAndEncrypt,SP_5025,UP_5026))
                                                        )
                                                        else
                                                            {5218}let pkSess_5027: bitstring = fail-any in
                                                            {5219}in(c, =GetEndpointRequest);
                                                            {5220}new SP_5028: bitstring;
                                                            {5221}new UP_5029: bitstring;
                                                            {5222}out(c, (GetEndpointResponse,pkSess_5027,SignAndEncrypt,SP_5028,UP_5029))
                                                )
                                                else
                                                    {5223}let pkSess_5030: bitstring = fail-any in
                                                    {5224}in(c, =GetEndpointRequest);
                                                    {5225}new SP_5031: bitstring;
                                                    {5226}new UP_5032: bitstring;
                                                    {5227}out(c, (GetEndpointResponse,pkSess_5030,SignAndEncrypt,SP_5031,UP_5032))
                                        )
                                        else
                                            {5228}let pkSess_5033: bitstring = fail-any in
                                            {5229}in(c, =GetEndpointRequest);
                                            {5230}new SP_5034: bitstring;
                                            {5231}new UP_5035: bitstring;
                                            {5232}out(c, (GetEndpointResponse,pkSess_5033,SignAndEncrypt,SP_5034,UP_5035))
                                    )
                                    else
                                        {5233}let pkCli_5036: bitstring = pub(sk(Cli_4232)) in
                                        {5234}let v_5037: bool = (Sess_4234 = A) in
                                        (
                                            {5235}if v_5037 then
                                            (
                                                {5236}let pkSess_5038: bitstring = pub(skA) in
                                                {5237}in(c, =GetEndpointRequest);
                                                {5238}new SP_5039: bitstring;
                                                {5239}new UP_5040: bitstring;
                                                {5240}out(c, (GetEndpointResponse,pkSess_5038,SignAndEncrypt,SP_5039,UP_5040))
                                            )
                                            else
                                                {5241}let v_5041: bool = (Sess_4234 = B) in
                                                (
                                                    {5242}if v_5041 then
                                                    (
                                                        {5243}let pkSess_5042: bitstring = pub(skB) in
                                                        {5244}in(c, =GetEndpointRequest);
                                                        {5245}new SP_5043: bitstring;
                                                        {5246}new UP_5044: bitstring;
                                                        {5247}out(c, (GetEndpointResponse,pkSess_5042,SignAndEncrypt,SP_5043,UP_5044))
                                                    )
                                                    else
                                                        {5248}let v_5045: bool = (Sess_4234 = C) in
                                                        (
                                                            {5249}if v_5045 then
                                                            (
                                                                {5250}let pkSess_5046: bitstring = pub(skC) in
                                                                {5251}in(c, =GetEndpointRequest);
                                                                {5252}new SP_5047: bitstring;
                                                                {5253}new UP_5048: bitstring;
                                                                {5254}out(c, (GetEndpointResponse,pkSess_5046,SignAndEncrypt,SP_5047,UP_5048))
                                                            )
                                                            else
                                                                {5255}let pkSess_5049: bitstring = pub(sk(Sess_4234)) in
                                                                {5256}in(c, =GetEndpointRequest);
                                                                {5257}new SP_5050: bitstring;
                                                                {5258}new UP_5051: bitstring;
                                                                {5259}out(c, (GetEndpointResponse,pkSess_5049,SignAndEncrypt,SP_5050,UP_5051))
                                                        )
                                                        else
                                                            {5260}let pkSess_5052: bitstring = fail-any in
                                                            {5261}in(c, =GetEndpointRequest);
                                                            {5262}new SP_5053: bitstring;
                                                            {5263}new UP_5054: bitstring;
                                                            {5264}out(c, (GetEndpointResponse,pkSess_5052,SignAndEncrypt,SP_5053,UP_5054))
                                                )
                                                else
                                                    {5265}let pkSess_5055: bitstring = fail-any in
                                                    {5266}in(c, =GetEndpointRequest);
                                                    {5267}new SP_5056: bitstring;
                                                    {5268}new UP_5057: bitstring;
                                                    {5269}out(c, (GetEndpointResponse,pkSess_5055,SignAndEncrypt,SP_5056,UP_5057))
                                        )
                                        else
                                            {5270}let pkSess_5058: bitstring = fail-any in
                                            {5271}in(c, =GetEndpointRequest);
                                            {5272}new SP_5059: bitstring;
                                            {5273}new UP_5060: bitstring;
                                            {5274}out(c, (GetEndpointResponse,pkSess_5058,SignAndEncrypt,SP_5059,UP_5060))
                                )
                                else
                                    {5275}let pkCli_5061: bitstring = fail-any in
                                    {5276}let v_5062: bool = (Sess_4234 = A) in
                                    (
                                        {5277}if v_5062 then
                                        (
                                            {5278}let pkSess_5063: bitstring = pub(skA) in
                                            {5279}in(c, =GetEndpointRequest);
                                            {5280}new SP_5064: bitstring;
                                            {5281}new UP_5065: bitstring;
                                            {5282}out(c, (GetEndpointResponse,pkSess_5063,SignAndEncrypt,SP_5064,UP_5065))
                                        )
                                        else
                                            {5283}let v_5066: bool = (Sess_4234 = B) in
                                            (
                                                {5284}if v_5066 then
                                                (
                                                    {5285}let pkSess_5067: bitstring = pub(skB) in
                                                    {5286}in(c, =GetEndpointRequest);
                                                    {5287}new SP_5068: bitstring;
                                                    {5288}new UP_5069: bitstring;
                                                    {5289}out(c, (GetEndpointResponse,pkSess_5067,SignAndEncrypt,SP_5068,UP_5069))
                                                )
                                                else
                                                    {5290}let v_5070: bool = (Sess_4234 = C) in
                                                    (
                                                        {5291}if v_5070 then
                                                        (
                                                            {5292}let pkSess_5071: bitstring = pub(skC) in
                                                            {5293}in(c, =GetEndpointRequest);
                                                            {5294}new SP_5072: bitstring;
                                                            {5295}new UP_5073: bitstring;
                                                            {5296}out(c, (GetEndpointResponse,pkSess_5071,SignAndEncrypt,SP_5072,UP_5073))
                                                        )
                                                        else
                                                            {5297}let pkSess_5074: bitstring = pub(sk(Sess_4234)) in
                                                            {5298}in(c, =GetEndpointRequest);
                                                            {5299}new SP_5075: bitstring;
                                                            {5300}new UP_5076: bitstring;
                                                            {5301}out(c, (GetEndpointResponse,pkSess_5074,SignAndEncrypt,SP_5075,UP_5076))
                                                    )
                                                    else
                                                        {5302}let pkSess_5077: bitstring = fail-any in
                                                        {5303}in(c, =GetEndpointRequest);
                                                        {5304}new SP_5078: bitstring;
                                                        {5305}new UP_5079: bitstring;
                                                        {5306}out(c, (GetEndpointResponse,pkSess_5077,SignAndEncrypt,SP_5078,UP_5079))
                                            )
                                            else
                                                {5307}let pkSess_5080: bitstring = fail-any in
                                                {5308}in(c, =GetEndpointRequest);
                                                {5309}new SP_5081: bitstring;
                                                {5310}new UP_5082: bitstring;
                                                {5311}out(c, (GetEndpointResponse,pkSess_5080,SignAndEncrypt,SP_5081,UP_5082))
                                    )
                                    else
                                        {5312}let pkSess_5083: bitstring = fail-any in
                                        {5313}in(c, =GetEndpointRequest);
                                        {5314}new SP_5084: bitstring;
                                        {5315}new UP_5085: bitstring;
                                        {5316}out(c, (GetEndpointResponse,pkSess_5083,SignAndEncrypt,SP_5084,UP_5085))
                        )
                        else
                            {5317}let pkCli_5086: bitstring = fail-any in
                            {5318}let v_5087: bool = (Sess_4234 = A) in
                            (
                                {5319}if v_5087 then
                                (
                                    {5320}let pkSess_5088: bitstring = pub(skA) in
                                    {5321}in(c, =GetEndpointRequest);
                                    {5322}new SP_5089: bitstring;
                                    {5323}new UP_5090: bitstring;
                                    {5324}out(c, (GetEndpointResponse,pkSess_5088,SignAndEncrypt,SP_5089,UP_5090))
                                )
                                else
                                    {5325}let v_5091: bool = (Sess_4234 = B) in
                                    (
                                        {5326}if v_5091 then
                                        (
                                            {5327}let pkSess_5092: bitstring = pub(skB) in
                                            {5328}in(c, =GetEndpointRequest);
                                            {5329}new SP_5093: bitstring;
                                            {5330}new UP_5094: bitstring;
                                            {5331}out(c, (GetEndpointResponse,pkSess_5092,SignAndEncrypt,SP_5093,UP_5094))
                                        )
                                        else
                                            {5332}let v_5095: bool = (Sess_4234 = C) in
                                            (
                                                {5333}if v_5095 then
                                                (
                                                    {5334}let pkSess_5096: bitstring = pub(skC) in
                                                    {5335}in(c, =GetEndpointRequest);
                                                    {5336}new SP_5097: bitstring;
                                                    {5337}new UP_5098: bitstring;
                                                    {5338}out(c, (GetEndpointResponse,pkSess_5096,SignAndEncrypt,SP_5097,UP_5098))
                                                )
                                                else
                                                    {5339}let pkSess_5099: bitstring = pub(sk(Sess_4234)) in
                                                    {5340}in(c, =GetEndpointRequest);
                                                    {5341}new SP_5100: bitstring;
                                                    {5342}new UP_5101: bitstring;
                                                    {5343}out(c, (GetEndpointResponse,pkSess_5099,SignAndEncrypt,SP_5100,UP_5101))
                                            )
                                            else
                                                {5344}let pkSess_5102: bitstring = fail-any in
                                                {5345}in(c, =GetEndpointRequest);
                                                {5346}new SP_5103: bitstring;
                                                {5347}new UP_5104: bitstring;
                                                {5348}out(c, (GetEndpointResponse,pkSess_5102,SignAndEncrypt,SP_5103,UP_5104))
                                    )
                                    else
                                        {5349}let pkSess_5105: bitstring = fail-any in
                                        {5350}in(c, =GetEndpointRequest);
                                        {5351}new SP_5106: bitstring;
                                        {5352}new UP_5107: bitstring;
                                        {5353}out(c, (GetEndpointResponse,pkSess_5105,SignAndEncrypt,SP_5106,UP_5107))
                            )
                            else
                                {5354}let pkSess_5108: bitstring = fail-any in
                                {5355}in(c, =GetEndpointRequest);
                                {5356}new SP_5109: bitstring;
                                {5357}new UP_5110: bitstring;
                                {5358}out(c, (GetEndpointResponse,pkSess_5108,SignAndEncrypt,SP_5109,UP_5110))
                )
                else
                    {5359}let pkCli_5111: bitstring = fail-any in
                    {5360}let v_5112: bool = (Sess_4234 = A) in
                    (
                        {5361}if v_5112 then
                        (
                            {5362}let pkSess_5113: bitstring = pub(skA) in
                            {5363}in(c, =GetEndpointRequest);
                            {5364}new SP_5114: bitstring;
                            {5365}new UP_5115: bitstring;
                            {5366}out(c, (GetEndpointResponse,pkSess_5113,SignAndEncrypt,SP_5114,UP_5115))
                        )
                        else
                            {5367}let v_5116: bool = (Sess_4234 = B) in
                            (
                                {5368}if v_5116 then
                                (
                                    {5369}let pkSess_5117: bitstring = pub(skB) in
                                    {5370}in(c, =GetEndpointRequest);
                                    {5371}new SP_5118: bitstring;
                                    {5372}new UP_5119: bitstring;
                                    {5373}out(c, (GetEndpointResponse,pkSess_5117,SignAndEncrypt,SP_5118,UP_5119))
                                )
                                else
                                    {5374}let v_5120: bool = (Sess_4234 = C) in
                                    (
                                        {5375}if v_5120 then
                                        (
                                            {5376}let pkSess_5121: bitstring = pub(skC) in
                                            {5377}in(c, =GetEndpointRequest);
                                            {5378}new SP_5122: bitstring;
                                            {5379}new UP_5123: bitstring;
                                            {5380}out(c, (GetEndpointResponse,pkSess_5121,SignAndEncrypt,SP_5122,UP_5123))
                                        )
                                        else
                                            {5381}let pkSess_5124: bitstring = pub(sk(Sess_4234)) in
                                            {5382}in(c, =GetEndpointRequest);
                                            {5383}new SP_5125: bitstring;
                                            {5384}new UP_5126: bitstring;
                                            {5385}out(c, (GetEndpointResponse,pkSess_5124,SignAndEncrypt,SP_5125,UP_5126))
                                    )
                                    else
                                        {5386}let pkSess_5127: bitstring = fail-any in
                                        {5387}in(c, =GetEndpointRequest);
                                        {5388}new SP_5128: bitstring;
                                        {5389}new UP_5129: bitstring;
                                        {5390}out(c, (GetEndpointResponse,pkSess_5127,SignAndEncrypt,SP_5128,UP_5129))
                            )
                            else
                                {5391}let pkSess_5130: bitstring = fail-any in
                                {5392}in(c, =GetEndpointRequest);
                                {5393}new SP_5131: bitstring;
                                {5394}new UP_5132: bitstring;
                                {5395}out(c, (GetEndpointResponse,pkSess_5130,SignAndEncrypt,SP_5131,UP_5132))
                    )
                    else
                        {5396}let pkSess_5133: bitstring = fail-any in
                        {5397}in(c, =GetEndpointRequest);
                        {5398}new SP_5134: bitstring;
                        {5399}new UP_5135: bitstring;
                        {5400}out(c, (GetEndpointResponse,pkSess_5133,SignAndEncrypt,SP_5134,UP_5135))
    )
    else
        {5401}let skDisco_5136: bitstring = fail-any in
        {5402}let pkDisco_5137: bitstring = pub(skDisco_5136) in
        {5403}let v_5138: bool = (Cli_4232 = A) in
        (
            {5404}if v_5138 then
            (
                {5405}let pkCli_5139: bitstring = pub(skA) in
                {5406}let v_5140: bool = (Sess_4234 = A) in
                (
                    {5407}if v_5140 then
                    (
                        {5408}let pkSess_5141: bitstring = pub(skA) in
                        {5409}in(c, =GetEndpointRequest);
                        {5410}new SP_5142: bitstring;
                        {5411}new UP_5143: bitstring;
                        {5412}out(c, (GetEndpointResponse,pkSess_5141,SignAndEncrypt,SP_5142,UP_5143))
                    )
                    else
                        {5413}let v_5144: bool = (Sess_4234 = B) in
                        (
                            {5414}if v_5144 then
                            (
                                {5415}let pkSess_5145: bitstring = pub(skB) in
                                {5416}in(c, =GetEndpointRequest);
                                {5417}new SP_5146: bitstring;
                                {5418}new UP_5147: bitstring;
                                {5419}out(c, (GetEndpointResponse,pkSess_5145,SignAndEncrypt,SP_5146,UP_5147))
                            )
                            else
                                {5420}let v_5148: bool = (Sess_4234 = C) in
                                (
                                    {5421}if v_5148 then
                                    (
                                        {5422}let pkSess_5149: bitstring = pub(skC) in
                                        {5423}in(c, =GetEndpointRequest);
                                        {5424}new SP_5150: bitstring;
                                        {5425}new UP_5151: bitstring;
                                        {5426}out(c, (GetEndpointResponse,pkSess_5149,SignAndEncrypt,SP_5150,UP_5151))
                                    )
                                    else
                                        {5427}let pkSess_5152: bitstring = pub(sk(Sess_4234)) in
                                        {5428}in(c, =GetEndpointRequest);
                                        {5429}new SP_5153: bitstring;
                                        {5430}new UP_5154: bitstring;
                                        {5431}out(c, (GetEndpointResponse,pkSess_5152,SignAndEncrypt,SP_5153,UP_5154))
                                )
                                else
                                    {5432}let pkSess_5155: bitstring = fail-any in
                                    {5433}in(c, =GetEndpointRequest);
                                    {5434}new SP_5156: bitstring;
                                    {5435}new UP_5157: bitstring;
                                    {5436}out(c, (GetEndpointResponse,pkSess_5155,SignAndEncrypt,SP_5156,UP_5157))
                        )
                        else
                            {5437}let pkSess_5158: bitstring = fail-any in
                            {5438}in(c, =GetEndpointRequest);
                            {5439}new SP_5159: bitstring;
                            {5440}new UP_5160: bitstring;
                            {5441}out(c, (GetEndpointResponse,pkSess_5158,SignAndEncrypt,SP_5159,UP_5160))
                )
                else
                    {5442}let pkSess_5161: bitstring = fail-any in
                    {5443}in(c, =GetEndpointRequest);
                    {5444}new SP_5162: bitstring;
                    {5445}new UP_5163: bitstring;
                    {5446}out(c, (GetEndpointResponse,pkSess_5161,SignAndEncrypt,SP_5162,UP_5163))
            )
            else
                {5447}let v_5164: bool = (Cli_4232 = B) in
                (
                    {5448}if v_5164 then
                    (
                        {5449}let pkCli_5165: bitstring = pub(skB) in
                        {5450}let v_5166: bool = (Sess_4234 = A) in
                        (
                            {5451}if v_5166 then
                            (
                                {5452}let pkSess_5167: bitstring = pub(skA) in
                                {5453}in(c, =GetEndpointRequest);
                                {5454}new SP_5168: bitstring;
                                {5455}new UP_5169: bitstring;
                                {5456}out(c, (GetEndpointResponse,pkSess_5167,SignAndEncrypt,SP_5168,UP_5169))
                            )
                            else
                                {5457}let v_5170: bool = (Sess_4234 = B) in
                                (
                                    {5458}if v_5170 then
                                    (
                                        {5459}let pkSess_5171: bitstring = pub(skB) in
                                        {5460}in(c, =GetEndpointRequest);
                                        {5461}new SP_5172: bitstring;
                                        {5462}new UP_5173: bitstring;
                                        {5463}out(c, (GetEndpointResponse,pkSess_5171,SignAndEncrypt,SP_5172,UP_5173))
                                    )
                                    else
                                        {5464}let v_5174: bool = (Sess_4234 = C) in
                                        (
                                            {5465}if v_5174 then
                                            (
                                                {5466}let pkSess_5175: bitstring = pub(skC) in
                                                {5467}in(c, =GetEndpointRequest);
                                                {5468}new SP_5176: bitstring;
                                                {5469}new UP_5177: bitstring;
                                                {5470}out(c, (GetEndpointResponse,pkSess_5175,SignAndEncrypt,SP_5176,UP_5177))
                                            )
                                            else
                                                {5471}let pkSess_5178: bitstring = pub(sk(Sess_4234)) in
                                                {5472}in(c, =GetEndpointRequest);
                                                {5473}new SP_5179: bitstring;
                                                {5474}new UP_5180: bitstring;
                                                {5475}out(c, (GetEndpointResponse,pkSess_5178,SignAndEncrypt,SP_5179,UP_5180))
                                        )
                                        else
                                            {5476}let pkSess_5181: bitstring = fail-any in
                                            {5477}in(c, =GetEndpointRequest);
                                            {5478}new SP_5182: bitstring;
                                            {5479}new UP_5183: bitstring;
                                            {5480}out(c, (GetEndpointResponse,pkSess_5181,SignAndEncrypt,SP_5182,UP_5183))
                                )
                                else
                                    {5481}let pkSess_5184: bitstring = fail-any in
                                    {5482}in(c, =GetEndpointRequest);
                                    {5483}new SP_5185: bitstring;
                                    {5484}new UP_5186: bitstring;
                                    {5485}out(c, (GetEndpointResponse,pkSess_5184,SignAndEncrypt,SP_5185,UP_5186))
                        )
                        else
                            {5486}let pkSess_5187: bitstring = fail-any in
                            {5487}in(c, =GetEndpointRequest);
                            {5488}new SP_5188: bitstring;
                            {5489}new UP_5189: bitstring;
                            {5490}out(c, (GetEndpointResponse,pkSess_5187,SignAndEncrypt,SP_5188,UP_5189))
                    )
                    else
                        {5491}let v_5190: bool = (Cli_4232 = C) in
                        (
                            {5492}if v_5190 then
                            (
                                {5493}let pkCli_5191: bitstring = pub(skC) in
                                {5494}let v_5192: bool = (Sess_4234 = A) in
                                (
                                    {5495}if v_5192 then
                                    (
                                        {5496}let pkSess_5193: bitstring = pub(skA) in
                                        {5497}in(c, =GetEndpointRequest);
                                        {5498}new SP_5194: bitstring;
                                        {5499}new UP_5195: bitstring;
                                        {5500}out(c, (GetEndpointResponse,pkSess_5193,SignAndEncrypt,SP_5194,UP_5195))
                                    )
                                    else
                                        {5501}let v_5196: bool = (Sess_4234 = B) in
                                        (
                                            {5502}if v_5196 then
                                            (
                                                {5503}let pkSess_5197: bitstring = pub(skB) in
                                                {5504}in(c, =GetEndpointRequest);
                                                {5505}new SP_5198: bitstring;
                                                {5506}new UP_5199: bitstring;
                                                {5507}out(c, (GetEndpointResponse,pkSess_5197,SignAndEncrypt,SP_5198,UP_5199))
                                            )
                                            else
                                                {5508}let v_5200: bool = (Sess_4234 = C) in
                                                (
                                                    {5509}if v_5200 then
                                                    (
                                                        {5510}let pkSess_5201: bitstring = pub(skC) in
                                                        {5511}in(c, =GetEndpointRequest);
                                                        {5512}new SP_5202: bitstring;
                                                        {5513}new UP_5203: bitstring;
                                                        {5514}out(c, (GetEndpointResponse,pkSess_5201,SignAndEncrypt,SP_5202,UP_5203))
                                                    )
                                                    else
                                                        {5515}let pkSess_5204: bitstring = pub(sk(Sess_4234)) in
                                                        {5516}in(c, =GetEndpointRequest);
                                                        {5517}new SP_5205: bitstring;
                                                        {5518}new UP_5206: bitstring;
                                                        {5519}out(c, (GetEndpointResponse,pkSess_5204,SignAndEncrypt,SP_5205,UP_5206))
                                                )
                                                else
                                                    {5520}let pkSess_5207: bitstring = fail-any in
                                                    {5521}in(c, =GetEndpointRequest);
                                                    {5522}new SP_5208: bitstring;
                                                    {5523}new UP_5209: bitstring;
                                                    {5524}out(c, (GetEndpointResponse,pkSess_5207,SignAndEncrypt,SP_5208,UP_5209))
                                        )
                                        else
                                            {5525}let pkSess_5210: bitstring = fail-any in
                                            {5526}in(c, =GetEndpointRequest);
                                            {5527}new SP_5211: bitstring;
                                            {5528}new UP_5212: bitstring;
                                            {5529}out(c, (GetEndpointResponse,pkSess_5210,SignAndEncrypt,SP_5211,UP_5212))
                                )
                                else
                                    {5530}let pkSess_5213: bitstring = fail-any in
                                    {5531}in(c, =GetEndpointRequest);
                                    {5532}new SP_5214: bitstring;
                                    {5533}new UP_5215: bitstring;
                                    {5534}out(c, (GetEndpointResponse,pkSess_5213,SignAndEncrypt,SP_5214,UP_5215))
                            )
                            else
                                {5535}let pkCli_5216: bitstring = pub(sk(Cli_4232)) in
                                {5536}let v_5217: bool = (Sess_4234 = A) in
                                (
                                    {5537}if v_5217 then
                                    (
                                        {5538}let pkSess_5218: bitstring = pub(skA) in
                                        {5539}in(c, =GetEndpointRequest);
                                        {5540}new SP_5219: bitstring;
                                        {5541}new UP_5220: bitstring;
                                        {5542}out(c, (GetEndpointResponse,pkSess_5218,SignAndEncrypt,SP_5219,UP_5220))
                                    )
                                    else
                                        {5543}let v_5221: bool = (Sess_4234 = B) in
                                        (
                                            {5544}if v_5221 then
                                            (
                                                {5545}let pkSess_5222: bitstring = pub(skB) in
                                                {5546}in(c, =GetEndpointRequest);
                                                {5547}new SP_5223: bitstring;
                                                {5548}new UP_5224: bitstring;
                                                {5549}out(c, (GetEndpointResponse,pkSess_5222,SignAndEncrypt,SP_5223,UP_5224))
                                            )
                                            else
                                                {5550}let v_5225: bool = (Sess_4234 = C) in
                                                (
                                                    {5551}if v_5225 then
                                                    (
                                                        {5552}let pkSess_5226: bitstring = pub(skC) in
                                                        {5553}in(c, =GetEndpointRequest);
                                                        {5554}new SP_5227: bitstring;
                                                        {5555}new UP_5228: bitstring;
                                                        {5556}out(c, (GetEndpointResponse,pkSess_5226,SignAndEncrypt,SP_5227,UP_5228))
                                                    )
                                                    else
                                                        {5557}let pkSess_5229: bitstring = pub(sk(Sess_4234)) in
                                                        {5558}in(c, =GetEndpointRequest);
                                                        {5559}new SP_5230: bitstring;
                                                        {5560}new UP_5231: bitstring;
                                                        {5561}out(c, (GetEndpointResponse,pkSess_5229,SignAndEncrypt,SP_5230,UP_5231))
                                                )
                                                else
                                                    {5562}let pkSess_5232: bitstring = fail-any in
                                                    {5563}in(c, =GetEndpointRequest);
                                                    {5564}new SP_5233: bitstring;
                                                    {5565}new UP_5234: bitstring;
                                                    {5566}out(c, (GetEndpointResponse,pkSess_5232,SignAndEncrypt,SP_5233,UP_5234))
                                        )
                                        else
                                            {5567}let pkSess_5235: bitstring = fail-any in
                                            {5568}in(c, =GetEndpointRequest);
                                            {5569}new SP_5236: bitstring;
                                            {5570}new UP_5237: bitstring;
                                            {5571}out(c, (GetEndpointResponse,pkSess_5235,SignAndEncrypt,SP_5236,UP_5237))
                                )
                                else
                                    {5572}let pkSess_5238: bitstring = fail-any in
                                    {5573}in(c, =GetEndpointRequest);
                                    {5574}new SP_5239: bitstring;
                                    {5575}new UP_5240: bitstring;
                                    {5576}out(c, (GetEndpointResponse,pkSess_5238,SignAndEncrypt,SP_5239,UP_5240))
                        )
                        else
                            {5577}let pkCli_5241: bitstring = fail-any in
                            {5578}let v_5242: bool = (Sess_4234 = A) in
                            (
                                {5579}if v_5242 then
                                (
                                    {5580}let pkSess_5243: bitstring = pub(skA) in
                                    {5581}in(c, =GetEndpointRequest);
                                    {5582}new SP_5244: bitstring;
                                    {5583}new UP_5245: bitstring;
                                    {5584}out(c, (GetEndpointResponse,pkSess_5243,SignAndEncrypt,SP_5244,UP_5245))
                                )
                                else
                                    {5585}let v_5246: bool = (Sess_4234 = B) in
                                    (
                                        {5586}if v_5246 then
                                        (
                                            {5587}let pkSess_5247: bitstring = pub(skB) in
                                            {5588}in(c, =GetEndpointRequest);
                                            {5589}new SP_5248: bitstring;
                                            {5590}new UP_5249: bitstring;
                                            {5591}out(c, (GetEndpointResponse,pkSess_5247,SignAndEncrypt,SP_5248,UP_5249))
                                        )
                                        else
                                            {5592}let v_5250: bool = (Sess_4234 = C) in
                                            (
                                                {5593}if v_5250 then
                                                (
                                                    {5594}let pkSess_5251: bitstring = pub(skC) in
                                                    {5595}in(c, =GetEndpointRequest);
                                                    {5596}new SP_5252: bitstring;
                                                    {5597}new UP_5253: bitstring;
                                                    {5598}out(c, (GetEndpointResponse,pkSess_5251,SignAndEncrypt,SP_5252,UP_5253))
                                                )
                                                else
                                                    {5599}let pkSess_5254: bitstring = pub(sk(Sess_4234)) in
                                                    {5600}in(c, =GetEndpointRequest);
                                                    {5601}new SP_5255: bitstring;
                                                    {5602}new UP_5256: bitstring;
                                                    {5603}out(c, (GetEndpointResponse,pkSess_5254,SignAndEncrypt,SP_5255,UP_5256))
                                            )
                                            else
                                                {5604}let pkSess_5257: bitstring = fail-any in
                                                {5605}in(c, =GetEndpointRequest);
                                                {5606}new SP_5258: bitstring;
                                                {5607}new UP_5259: bitstring;
                                                {5608}out(c, (GetEndpointResponse,pkSess_5257,SignAndEncrypt,SP_5258,UP_5259))
                                    )
                                    else
                                        {5609}let pkSess_5260: bitstring = fail-any in
                                        {5610}in(c, =GetEndpointRequest);
                                        {5611}new SP_5261: bitstring;
                                        {5612}new UP_5262: bitstring;
                                        {5613}out(c, (GetEndpointResponse,pkSess_5260,SignAndEncrypt,SP_5261,UP_5262))
                            )
                            else
                                {5614}let pkSess_5263: bitstring = fail-any in
                                {5615}in(c, =GetEndpointRequest);
                                {5616}new SP_5264: bitstring;
                                {5617}new UP_5265: bitstring;
                                {5618}out(c, (GetEndpointResponse,pkSess_5263,SignAndEncrypt,SP_5264,UP_5265))
                )
                else
                    {5619}let pkCli_5266: bitstring = fail-any in
                    {5620}let v_5267: bool = (Sess_4234 = A) in
                    (
                        {5621}if v_5267 then
                        (
                            {5622}let pkSess_5268: bitstring = pub(skA) in
                            {5623}in(c, =GetEndpointRequest);
                            {5624}new SP_5269: bitstring;
                            {5625}new UP_5270: bitstring;
                            {5626}out(c, (GetEndpointResponse,pkSess_5268,SignAndEncrypt,SP_5269,UP_5270))
                        )
                        else
                            {5627}let v_5271: bool = (Sess_4234 = B) in
                            (
                                {5628}if v_5271 then
                                (
                                    {5629}let pkSess_5272: bitstring = pub(skB) in
                                    {5630}in(c, =GetEndpointRequest);
                                    {5631}new SP_5273: bitstring;
                                    {5632}new UP_5274: bitstring;
                                    {5633}out(c, (GetEndpointResponse,pkSess_5272,SignAndEncrypt,SP_5273,UP_5274))
                                )
                                else
                                    {5634}let v_5275: bool = (Sess_4234 = C) in
                                    (
                                        {5635}if v_5275 then
                                        (
                                            {5636}let pkSess_5276: bitstring = pub(skC) in
                                            {5637}in(c, =GetEndpointRequest);
                                            {5638}new SP_5277: bitstring;
                                            {5639}new UP_5278: bitstring;
                                            {5640}out(c, (GetEndpointResponse,pkSess_5276,SignAndEncrypt,SP_5277,UP_5278))
                                        )
                                        else
                                            {5641}let pkSess_5279: bitstring = pub(sk(Sess_4234)) in
                                            {5642}in(c, =GetEndpointRequest);
                                            {5643}new SP_5280: bitstring;
                                            {5644}new UP_5281: bitstring;
                                            {5645}out(c, (GetEndpointResponse,pkSess_5279,SignAndEncrypt,SP_5280,UP_5281))
                                    )
                                    else
                                        {5646}let pkSess_5282: bitstring = fail-any in
                                        {5647}in(c, =GetEndpointRequest);
                                        {5648}new SP_5283: bitstring;
                                        {5649}new UP_5284: bitstring;
                                        {5650}out(c, (GetEndpointResponse,pkSess_5282,SignAndEncrypt,SP_5283,UP_5284))
                            )
                            else
                                {5651}let pkSess_5285: bitstring = fail-any in
                                {5652}in(c, =GetEndpointRequest);
                                {5653}new SP_5286: bitstring;
                                {5654}new UP_5287: bitstring;
                                {5655}out(c, (GetEndpointResponse,pkSess_5285,SignAndEncrypt,SP_5286,UP_5287))
                    )
                    else
                        {5656}let pkSess_5288: bitstring = fail-any in
                        {5657}in(c, =GetEndpointRequest);
                        {5658}new SP_5289: bitstring;
                        {5659}new UP_5290: bitstring;
                        {5660}out(c, (GetEndpointResponse,pkSess_5288,SignAndEncrypt,SP_5289,UP_5290))
        )
        else
            {5661}let pkCli_5291: bitstring = fail-any in
            {5662}let v_5292: bool = (Sess_4234 = A) in
            (
                {5663}if v_5292 then
                (
                    {5664}let pkSess_5293: bitstring = pub(skA) in
                    {5665}in(c, =GetEndpointRequest);
                    {5666}new SP_5294: bitstring;
                    {5667}new UP_5295: bitstring;
                    {5668}out(c, (GetEndpointResponse,pkSess_5293,SignAndEncrypt,SP_5294,UP_5295))
                )
                else
                    {5669}let v_5296: bool = (Sess_4234 = B) in
                    (
                        {5670}if v_5296 then
                        (
                            {5671}let pkSess_5297: bitstring = pub(skB) in
                            {5672}in(c, =GetEndpointRequest);
                            {5673}new SP_5298: bitstring;
                            {5674}new UP_5299: bitstring;
                            {5675}out(c, (GetEndpointResponse,pkSess_5297,SignAndEncrypt,SP_5298,UP_5299))
                        )
                        else
                            {5676}let v_5300: bool = (Sess_4234 = C) in
                            (
                                {5677}if v_5300 then
                                (
                                    {5678}let pkSess_5301: bitstring = pub(skC) in
                                    {5679}in(c, =GetEndpointRequest);
                                    {5680}new SP_5302: bitstring;
                                    {5681}new UP_5303: bitstring;
                                    {5682}out(c, (GetEndpointResponse,pkSess_5301,SignAndEncrypt,SP_5302,UP_5303))
                                )
                                else
                                    {5683}let pkSess_5304: bitstring = pub(sk(Sess_4234)) in
                                    {5684}in(c, =GetEndpointRequest);
                                    {5685}new SP_5305: bitstring;
                                    {5686}new UP_5306: bitstring;
                                    {5687}out(c, (GetEndpointResponse,pkSess_5304,SignAndEncrypt,SP_5305,UP_5306))
                            )
                            else
                                {5688}let pkSess_5307: bitstring = fail-any in
                                {5689}in(c, =GetEndpointRequest);
                                {5690}new SP_5308: bitstring;
                                {5691}new UP_5309: bitstring;
                                {5692}out(c, (GetEndpointResponse,pkSess_5307,SignAndEncrypt,SP_5308,UP_5309))
                    )
                    else
                        {5693}let pkSess_5310: bitstring = fail-any in
                        {5694}in(c, =GetEndpointRequest);
                        {5695}new SP_5311: bitstring;
                        {5696}new UP_5312: bitstring;
                        {5697}out(c, (GetEndpointResponse,pkSess_5310,SignAndEncrypt,SP_5311,UP_5312))
            )
            else
                {5698}let pkSess_5313: bitstring = fail-any in
                {5699}in(c, =GetEndpointRequest);
                {5700}new SP_5314: bitstring;
                {5701}new UP_5315: bitstring;
                {5702}out(c, (GetEndpointResponse,pkSess_5313,SignAndEncrypt,SP_5314,UP_5315))
) | (
    {5703}!
    {5704}in(c, (Cli_5316: host,Disco_5317: host,Sess_5318: host));
    {5705}let v_5319: bool = (Sess_5318 = A) in
    (
        {5706}if v_5319 then
        (
            {5707}let skSess: bitstring = skA in
            {5708}let pkSess_5320: bitstring = pub(skSess) in
            {5709}let v_5321: bool = (Cli_5316 = A) in
            (
                {5710}if v_5321 then
                (
                    {5711}let pkCli_5322: bitstring = pub(skA) in
                    {5712}let v_5323: bool = (Disco_5317 = A) in
                    (
                        {5713}if v_5323 then
                        (
                            {5714}let pkDisco_5324: bitstring = pub(skA) in
                            {5715}in(c, (=pkCli_5322,em1: bitstring,sigM1: bitstring));
                            {5716}let m1_5325: bitstring = dec(em1,skSess) in
                            {5717}if (verify(h(m1_5325),sigM1,pkCli_5322) <> true) then
                                0
                            else
                                {5718}let (=OpenSecureChannelRequest,=pkCli_5322,PartC: bitstring) = m1_5325 in
                                {5719}new Ns: bitstring;
                                {5720}new ST_5326: bitstring;
                                {5721}new TTL_5327: bitstring;
                                {5722}let gNs: bitstring = exp(g,Ns) in
                                {5723}let m2_5328: bitstring = (OpenSecureChannelResponse,gNs,ST_5326,TTL_5327) in
                                {5724}out(c, (enc(m2_5328,pkCli_5322),sign(h(m2_5328),skSess)));
                                {5725}let Ksrv: bitstring = exp(PartC,Ns) in
                                {5726}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv))
                        )
                        else
                            {5727}let v_5329: bool = (Disco_5317 = B) in
                            (
                                {5728}if v_5329 then
                                (
                                    {5729}let pkDisco_5330: bitstring = pub(skB) in
                                    {5730}in(c, (=pkCli_5322,em1_5331: bitstring,sigM1_5332: bitstring));
                                    {5731}let m1_5333: bitstring = dec(em1_5331,skSess) in
                                    {5732}if (verify(h(m1_5333),sigM1_5332,pkCli_5322) <> true) then
                                        0
                                    else
                                        {5733}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5334: bitstring) = m1_5333 in
                                        {5734}new Ns_5335: bitstring;
                                        {5735}new ST_5336: bitstring;
                                        {5736}new TTL_5337: bitstring;
                                        {5737}let gNs_5338: bitstring = exp(g,Ns_5335) in
                                        {5738}let m2_5339: bitstring = (OpenSecureChannelResponse,gNs_5338,ST_5336,TTL_5337) in
                                        {5739}out(c, (enc(m2_5339,pkCli_5322),sign(h(m2_5339),skSess)));
                                        {5740}let Ksrv_5340: bitstring = exp(PartC_5334,Ns_5335) in
                                        {5741}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5340))
                                )
                                else
                                    {5742}let v_5341: bool = (Disco_5317 = C) in
                                    (
                                        {5743}if v_5341 then
                                        (
                                            {5744}let pkDisco_5342: bitstring = pub(skC) in
                                            {5745}in(c, (=pkCli_5322,em1_5343: bitstring,sigM1_5344: bitstring));
                                            {5746}let m1_5345: bitstring = dec(em1_5343,skSess) in
                                            {5747}if (verify(h(m1_5345),sigM1_5344,pkCli_5322) <> true) then
                                                0
                                            else
                                                {5748}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5346: bitstring) = m1_5345 in
                                                {5749}new Ns_5347: bitstring;
                                                {5750}new ST_5348: bitstring;
                                                {5751}new TTL_5349: bitstring;
                                                {5752}let gNs_5350: bitstring = exp(g,Ns_5347) in
                                                {5753}let m2_5351: bitstring = (OpenSecureChannelResponse,gNs_5350,ST_5348,TTL_5349) in
                                                {5754}out(c, (enc(m2_5351,pkCli_5322),sign(h(m2_5351),skSess)));
                                                {5755}let Ksrv_5352: bitstring = exp(PartC_5346,Ns_5347) in
                                                {5756}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5352))
                                        )
                                        else
                                            {5757}let pkDisco_5353: bitstring = pub(sk(Disco_5317)) in
                                            {5758}in(c, (=pkCli_5322,em1_5354: bitstring,sigM1_5355: bitstring));
                                            {5759}let m1_5356: bitstring = dec(em1_5354,skSess) in
                                            {5760}if (verify(h(m1_5356),sigM1_5355,pkCli_5322) <> true) then
                                                0
                                            else
                                                {5761}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5357: bitstring) = m1_5356 in
                                                {5762}new Ns_5358: bitstring;
                                                {5763}new ST_5359: bitstring;
                                                {5764}new TTL_5360: bitstring;
                                                {5765}let gNs_5361: bitstring = exp(g,Ns_5358) in
                                                {5766}let m2_5362: bitstring = (OpenSecureChannelResponse,gNs_5361,ST_5359,TTL_5360) in
                                                {5767}out(c, (enc(m2_5362,pkCli_5322),sign(h(m2_5362),skSess)));
                                                {5768}let Ksrv_5363: bitstring = exp(PartC_5357,Ns_5358) in
                                                {5769}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5363))
                                    )
                                    else
                                        {5770}let pkDisco_5364: bitstring = fail-any in
                                        {5771}in(c, (=pkCli_5322,em1_5365: bitstring,sigM1_5366: bitstring));
                                        {5772}let m1_5367: bitstring = dec(em1_5365,skSess) in
                                        {5773}if (verify(h(m1_5367),sigM1_5366,pkCli_5322) <> true) then
                                            0
                                        else
                                            {5774}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5368: bitstring) = m1_5367 in
                                            {5775}new Ns_5369: bitstring;
                                            {5776}new ST_5370: bitstring;
                                            {5777}new TTL_5371: bitstring;
                                            {5778}let gNs_5372: bitstring = exp(g,Ns_5369) in
                                            {5779}let m2_5373: bitstring = (OpenSecureChannelResponse,gNs_5372,ST_5370,TTL_5371) in
                                            {5780}out(c, (enc(m2_5373,pkCli_5322),sign(h(m2_5373),skSess)));
                                            {5781}let Ksrv_5374: bitstring = exp(PartC_5368,Ns_5369) in
                                            {5782}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5374))
                            )
                            else
                                {5783}let pkDisco_5375: bitstring = fail-any in
                                {5784}in(c, (=pkCli_5322,em1_5376: bitstring,sigM1_5377: bitstring));
                                {5785}let m1_5378: bitstring = dec(em1_5376,skSess) in
                                {5786}if (verify(h(m1_5378),sigM1_5377,pkCli_5322) <> true) then
                                    0
                                else
                                    {5787}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5379: bitstring) = m1_5378 in
                                    {5788}new Ns_5380: bitstring;
                                    {5789}new ST_5381: bitstring;
                                    {5790}new TTL_5382: bitstring;
                                    {5791}let gNs_5383: bitstring = exp(g,Ns_5380) in
                                    {5792}let m2_5384: bitstring = (OpenSecureChannelResponse,gNs_5383,ST_5381,TTL_5382) in
                                    {5793}out(c, (enc(m2_5384,pkCli_5322),sign(h(m2_5384),skSess)));
                                    {5794}let Ksrv_5385: bitstring = exp(PartC_5379,Ns_5380) in
                                    {5795}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5385))
                    )
                    else
                        {5796}let pkDisco_5386: bitstring = fail-any in
                        {5797}in(c, (=pkCli_5322,em1_5387: bitstring,sigM1_5388: bitstring));
                        {5798}let m1_5389: bitstring = dec(em1_5387,skSess) in
                        {5799}if (verify(h(m1_5389),sigM1_5388,pkCli_5322) <> true) then
                            0
                        else
                            {5800}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5390: bitstring) = m1_5389 in
                            {5801}new Ns_5391: bitstring;
                            {5802}new ST_5392: bitstring;
                            {5803}new TTL_5393: bitstring;
                            {5804}let gNs_5394: bitstring = exp(g,Ns_5391) in
                            {5805}let m2_5395: bitstring = (OpenSecureChannelResponse,gNs_5394,ST_5392,TTL_5393) in
                            {5806}out(c, (enc(m2_5395,pkCli_5322),sign(h(m2_5395),skSess)));
                            {5807}let Ksrv_5396: bitstring = exp(PartC_5390,Ns_5391) in
                            {5808}out(c, senc(mSrv(pkCli_5322,pkSess_5320),Ksrv_5396))
                )
                else
                    {5809}let v_5397: bool = (Cli_5316 = B) in
                    (
                        {5810}if v_5397 then
                        (
                            {5811}let pkCli_5398: bitstring = pub(skB) in
                            {5812}let v_5399: bool = (Disco_5317 = A) in
                            (
                                {5813}if v_5399 then
                                (
                                    {5814}let pkDisco_5400: bitstring = pub(skA) in
                                    {5815}in(c, (=pkCli_5398,em1_5401: bitstring,sigM1_5402: bitstring));
                                    {5816}let m1_5403: bitstring = dec(em1_5401,skSess) in
                                    {5817}if (verify(h(m1_5403),sigM1_5402,pkCli_5398) <> true) then
                                        0
                                    else
                                        {5818}let (=OpenSecureChannelRequest,=pkCli_5398,PartC_5404: bitstring) = m1_5403 in
                                        {5819}new Ns_5405: bitstring;
                                        {5820}new ST_5406: bitstring;
                                        {5821}new TTL_5407: bitstring;
                                        {5822}let gNs_5408: bitstring = exp(g,Ns_5405) in
                                        {5823}let m2_5409: bitstring = (OpenSecureChannelResponse,gNs_5408,ST_5406,TTL_5407) in
                                        {5824}out(c, (enc(m2_5409,pkCli_5398),sign(h(m2_5409),skSess)));
                                        {5825}let Ksrv_5410: bitstring = exp(PartC_5404,Ns_5405) in
                                        {5826}out(c, senc(mSrv(pkCli_5398,pkSess_5320),Ksrv_5410))
                                )
                                else
                                    {5827}let v_5411: bool = (Disco_5317 = B) in
                                    (
                                        {5828}if v_5411 then
                                        (
                                            {5829}let pkDisco_5412: bitstring = pub(skB) in
                                            {5830}in(c, (=pkCli_5398,em1_5413: bitstring,sigM1_5414: bitstring));
                                            {5831}let m1_5415: bitstring = dec(em1_5413,skSess) in
                                            {5832}if (verify(h(m1_5415),sigM1_5414,pkCli_5398) <> true) then
                                                0
                                            else
                                                {5833}let (=OpenSecureChannelRequest,=pkCli_5398,PartC_5416: bitstring) = m1_5415 in
                                                {5834}new Ns_5417: bitstring;
                                                {5835}new ST_5418: bitstring;
                                                {5836}new TTL_5419: bitstring;
                                                {5837}let gNs_5420: bitstring = exp(g,Ns_5417) in
                                                {5838}let m2_5421: bitstring = (OpenSecureChannelResponse,gNs_5420,ST_5418,TTL_5419) in
                                                {5839}out(c, (enc(m2_5421,pkCli_5398),sign(h(m2_5421),skSess)));
                                                {5840}let Ksrv_5422: bitstring = exp(PartC_5416,Ns_5417) in
                                                {5841}out(c, senc(mSrv(pkCli_5398,pkSess_5320),Ksrv_5422))
                                        )
                                        else
                                            {5842}let v_5423: bool = (Disco_5317 = C) in
                                            (
                                                {5843}if v_5423 then
                                                (
                                                    {5844}let pkDisco_5424: bitstring = pub(skC) in
                                                    {5845}in(c, (=pkCli_5398,em1_5425: bitstring,sigM1_5426: bitstring));
                                                    {5846}let m1_5427: bitstring = dec(em1_5425,skSess) in
                                                    {5847}if (verify(h(m1_5427),sigM1_5426,pkCli_5398) <> true) then
                                                        0
                                                    else
                                                        {5848}let (=OpenSecureChannelRequest,=pkCli_5398,PartC_5428: bitstring) = m1_5427 in
                                                        {5849}new Ns_5429: bitstring;
                                                        {5850}new ST_5430: bitstring;
                                                        {5851}new TTL_5431: bitstring;
                                                        {5852}let gNs_5432: bitstring = exp(g,Ns_5429) in
                                                        {5853}let m2_5433: bitstring = (OpenSecureChannelResponse,gNs_5432,ST_5430,TTL_5431) in
                                                        {5854}out(c, (enc(m2_5433,pkCli_5398),sign(h(m2_5433),skSess)));
                                                        {5855}let Ksrv_5434: bitstring = exp(PartC_5428,Ns_5429) in
                                                        {5856}out(c, senc(mSrv(pkCli_5398,pkSess_5320),Ksrv_5434))
                                                )
                                                else
                                                    {5857}let pkDisco_5435: bitstring = pub(sk(Disco_5317)) in
                                                    {5858}in(c, (=pkCli_5398,em1_5436: bitstring,sigM1_5437: bitstring));
                                                    {5859}let m1_5438: bitstring = dec(em1_5436,skSess) in
                                                    {5860}if (verify(h(m1_5438),sigM1_5437,pkCli_5398) <> true) then
                                                        0
                                                    else
                                                        {5861}let (=OpenSecureChannelRequest,=pkCli_5398,PartC_5439: bitstring) = m1_5438 in
                                                        {5862}new Ns_5440: bitstring;
                                                        {5863}new ST_5441: bitstring;
                                                        {5864}new TTL_5442: bitstring;
                                                        {5865}let gNs_5443: bitstring = exp(g,Ns_5440) in
                                                        {5866}let m2_5444: bitstring = (OpenSecureChannelResponse,gNs_5443,ST_5441,TTL_5442) in
                                                        {5867}out(c, (enc(m2_5444,pkCli_5398),sign(h(m2_5444),skSess)));
                                                        {5868}let Ksrv_5445: bitstring = exp(PartC_5439,Ns_5440) in
                                                        {5869}out(c, senc(mSrv(pkCli_5398,pkSess_5320),Ksrv_5445))
                                            )
                                            else
                                                {5870}let pkDisco_5446: bitstring = fail-any in
                                                {5871}in(c, (=pkCli_5398,em1_5447: bitstring,sigM1_5448: bitstring));
                                                {5872}let m1_5449: bitstring = dec(em1_5447,skSess) in
                                                {5873}if (verify(h(m1_5449),sigM1_5448,pkCli_5398) <> true) then
                                                    0
                                                else
                                                    {5874}let (=OpenSecureChannelRequest,=pkCli_5398,PartC_5450: bitstring) = m1_5449 in
                                                    {5875}new Ns_5451: bitstring;
                                                    {5876}new ST_5452: bitstring;
                                                    {5877}new TTL_5453: bitstring;
                                                    {5878}let gNs_5454: bitstring = exp(g,Ns_5451) in
                                                    {5879}let m2_5455: bitstring = (OpenSecureChannelResponse,gNs_5454,ST_5452,TTL_5453) in
                                                    {5880}out(c, (enc(m2_5455,pkCli_5398),sign(h(m2_5455),skSess)));
                                                    {5881}let Ksrv_5456: bitstring = exp(PartC_5450,Ns_5451) in
                                                    {5882}out(c, senc(mSrv(pkCli_5398,pkSess_5320),Ksrv_5456))
                                    )
                                    else
                                        {5883}let pkDisco_5457: bitstring = fail-any in
                                        {5884}in(c, (=pkCli_5398,em1_5458: bitstring,sigM1_5459: bitstring));
                                        {5885}let m1_5460: bitstring = dec(em1_5458,skSess) in
                                        {5886}if (verify(h(m1_5460),sigM1_5459,pkCli_5398) <> true) then
                                            0
                                        else
                                            {5887}let (=OpenSecureChannelRequest,=pkCli_5398,PartC_5461: bitstring) = m1_5460 in
                                            {5888}new Ns_5462: bitstring;
                                            {5889}new ST_5463: bitstring;
                                            {5890}new TTL_5464: bitstring;
                                            {5891}let gNs_5465: bitstring = exp(g,Ns_5462) in
                                            {5892}let m2_5466: bitstring = (OpenSecureChannelResponse,gNs_5465,ST_5463,TTL_5464) in
                                            {5893}out(c, (enc(m2_5466,pkCli_5398),sign(h(m2_5466),skSess)));
                                            {5894}let Ksrv_5467: bitstring = exp(PartC_5461,Ns_5462) in
                                            {5895}out(c, senc(mSrv(pkCli_5398,pkSess_5320),Ksrv_5467))
                            )
                            else
                                {5896}let pkDisco_5468: bitstring = fail-any in
                                {5897}in(c, (=pkCli_5398,em1_5469: bitstring,sigM1_5470: bitstring));
                                {5898}let m1_5471: bitstring = dec(em1_5469,skSess) in
                                {5899}if (verify(h(m1_5471),sigM1_5470,pkCli_5398) <> true) then
                                    0
                                else
                                    {5900}let (=OpenSecureChannelRequest,=pkCli_5398,PartC_5472: bitstring) = m1_5471 in
                                    {5901}new Ns_5473: bitstring;
                                    {5902}new ST_5474: bitstring;
                                    {5903}new TTL_5475: bitstring;
                                    {5904}let gNs_5476: bitstring = exp(g,Ns_5473) in
                                    {5905}let m2_5477: bitstring = (OpenSecureChannelResponse,gNs_5476,ST_5474,TTL_5475) in
                                    {5906}out(c, (enc(m2_5477,pkCli_5398),sign(h(m2_5477),skSess)));
                                    {5907}let Ksrv_5478: bitstring = exp(PartC_5472,Ns_5473) in
                                    {5908}out(c, senc(mSrv(pkCli_5398,pkSess_5320),Ksrv_5478))
                        )
                        else
                            {5909}let v_5479: bool = (Cli_5316 = C) in
                            (
                                {5910}if v_5479 then
                                (
                                    {5911}let pkCli_5480: bitstring = pub(skC) in
                                    {5912}let v_5481: bool = (Disco_5317 = A) in
                                    (
                                        {5913}if v_5481 then
                                        (
                                            {5914}let pkDisco_5482: bitstring = pub(skA) in
                                            {5915}in(c, (=pkCli_5480,em1_5483: bitstring,sigM1_5484: bitstring));
                                            {5916}let m1_5485: bitstring = dec(em1_5483,skSess) in
                                            {5917}if (verify(h(m1_5485),sigM1_5484,pkCli_5480) <> true) then
                                                0
                                            else
                                                {5918}let (=OpenSecureChannelRequest,=pkCli_5480,PartC_5486: bitstring) = m1_5485 in
                                                {5919}new Ns_5487: bitstring;
                                                {5920}new ST_5488: bitstring;
                                                {5921}new TTL_5489: bitstring;
                                                {5922}let gNs_5490: bitstring = exp(g,Ns_5487) in
                                                {5923}let m2_5491: bitstring = (OpenSecureChannelResponse,gNs_5490,ST_5488,TTL_5489) in
                                                {5924}out(c, (enc(m2_5491,pkCli_5480),sign(h(m2_5491),skSess)));
                                                {5925}let Ksrv_5492: bitstring = exp(PartC_5486,Ns_5487) in
                                                {5926}out(c, senc(mSrv(pkCli_5480,pkSess_5320),Ksrv_5492))
                                        )
                                        else
                                            {5927}let v_5493: bool = (Disco_5317 = B) in
                                            (
                                                {5928}if v_5493 then
                                                (
                                                    {5929}let pkDisco_5494: bitstring = pub(skB) in
                                                    {5930}in(c, (=pkCli_5480,em1_5495: bitstring,sigM1_5496: bitstring));
                                                    {5931}let m1_5497: bitstring = dec(em1_5495,skSess) in
                                                    {5932}if (verify(h(m1_5497),sigM1_5496,pkCli_5480) <> true) then
                                                        0
                                                    else
                                                        {5933}let (=OpenSecureChannelRequest,=pkCli_5480,PartC_5498: bitstring) = m1_5497 in
                                                        {5934}new Ns_5499: bitstring;
                                                        {5935}new ST_5500: bitstring;
                                                        {5936}new TTL_5501: bitstring;
                                                        {5937}let gNs_5502: bitstring = exp(g,Ns_5499) in
                                                        {5938}let m2_5503: bitstring = (OpenSecureChannelResponse,gNs_5502,ST_5500,TTL_5501) in
                                                        {5939}out(c, (enc(m2_5503,pkCli_5480),sign(h(m2_5503),skSess)));
                                                        {5940}let Ksrv_5504: bitstring = exp(PartC_5498,Ns_5499) in
                                                        {5941}out(c, senc(mSrv(pkCli_5480,pkSess_5320),Ksrv_5504))
                                                )
                                                else
                                                    {5942}let v_5505: bool = (Disco_5317 = C) in
                                                    (
                                                        {5943}if v_5505 then
                                                        (
                                                            {5944}let pkDisco_5506: bitstring = pub(skC) in
                                                            {5945}in(c, (=pkCli_5480,em1_5507: bitstring,sigM1_5508: bitstring));
                                                            {5946}let m1_5509: bitstring = dec(em1_5507,skSess) in
                                                            {5947}if (verify(h(m1_5509),sigM1_5508,pkCli_5480) <> true) then
                                                                0
                                                            else
                                                                {5948}let (=OpenSecureChannelRequest,=pkCli_5480,PartC_5510: bitstring) = m1_5509 in
                                                                {5949}new Ns_5511: bitstring;
                                                                {5950}new ST_5512: bitstring;
                                                                {5951}new TTL_5513: bitstring;
                                                                {5952}let gNs_5514: bitstring = exp(g,Ns_5511) in
                                                                {5953}let m2_5515: bitstring = (OpenSecureChannelResponse,gNs_5514,ST_5512,TTL_5513) in
                                                                {5954}out(c, (enc(m2_5515,pkCli_5480),sign(h(m2_5515),skSess)));
                                                                {5955}let Ksrv_5516: bitstring = exp(PartC_5510,Ns_5511) in
                                                                {5956}out(c, senc(mSrv(pkCli_5480,pkSess_5320),Ksrv_5516))
                                                        )
                                                        else
                                                            {5957}let pkDisco_5517: bitstring = pub(sk(Disco_5317)) in
                                                            {5958}in(c, (=pkCli_5480,em1_5518: bitstring,sigM1_5519: bitstring));
                                                            {5959}let m1_5520: bitstring = dec(em1_5518,skSess) in
                                                            {5960}if (verify(h(m1_5520),sigM1_5519,pkCli_5480) <> true) then
                                                                0
                                                            else
                                                                {5961}let (=OpenSecureChannelRequest,=pkCli_5480,PartC_5521: bitstring) = m1_5520 in
                                                                {5962}new Ns_5522: bitstring;
                                                                {5963}new ST_5523: bitstring;
                                                                {5964}new TTL_5524: bitstring;
                                                                {5965}let gNs_5525: bitstring = exp(g,Ns_5522) in
                                                                {5966}let m2_5526: bitstring = (OpenSecureChannelResponse,gNs_5525,ST_5523,TTL_5524) in
                                                                {5967}out(c, (enc(m2_5526,pkCli_5480),sign(h(m2_5526),skSess)));
                                                                {5968}let Ksrv_5527: bitstring = exp(PartC_5521,Ns_5522) in
                                                                {5969}out(c, senc(mSrv(pkCli_5480,pkSess_5320),Ksrv_5527))
                                                    )
                                                    else
                                                        {5970}let pkDisco_5528: bitstring = fail-any in
                                                        {5971}in(c, (=pkCli_5480,em1_5529: bitstring,sigM1_5530: bitstring));
                                                        {5972}let m1_5531: bitstring = dec(em1_5529,skSess) in
                                                        {5973}if (verify(h(m1_5531),sigM1_5530,pkCli_5480) <> true) then
                                                            0
                                                        else
                                                            {5974}let (=OpenSecureChannelRequest,=pkCli_5480,PartC_5532: bitstring) = m1_5531 in
                                                            {5975}new Ns_5533: bitstring;
                                                            {5976}new ST_5534: bitstring;
                                                            {5977}new TTL_5535: bitstring;
                                                            {5978}let gNs_5536: bitstring = exp(g,Ns_5533) in
                                                            {5979}let m2_5537: bitstring = (OpenSecureChannelResponse,gNs_5536,ST_5534,TTL_5535) in
                                                            {5980}out(c, (enc(m2_5537,pkCli_5480),sign(h(m2_5537),skSess)));
                                                            {5981}let Ksrv_5538: bitstring = exp(PartC_5532,Ns_5533) in
                                                            {5982}out(c, senc(mSrv(pkCli_5480,pkSess_5320),Ksrv_5538))
                                            )
                                            else
                                                {5983}let pkDisco_5539: bitstring = fail-any in
                                                {5984}in(c, (=pkCli_5480,em1_5540: bitstring,sigM1_5541: bitstring));
                                                {5985}let m1_5542: bitstring = dec(em1_5540,skSess) in
                                                {5986}if (verify(h(m1_5542),sigM1_5541,pkCli_5480) <> true) then
                                                    0
                                                else
                                                    {5987}let (=OpenSecureChannelRequest,=pkCli_5480,PartC_5543: bitstring) = m1_5542 in
                                                    {5988}new Ns_5544: bitstring;
                                                    {5989}new ST_5545: bitstring;
                                                    {5990}new TTL_5546: bitstring;
                                                    {5991}let gNs_5547: bitstring = exp(g,Ns_5544) in
                                                    {5992}let m2_5548: bitstring = (OpenSecureChannelResponse,gNs_5547,ST_5545,TTL_5546) in
                                                    {5993}out(c, (enc(m2_5548,pkCli_5480),sign(h(m2_5548),skSess)));
                                                    {5994}let Ksrv_5549: bitstring = exp(PartC_5543,Ns_5544) in
                                                    {5995}out(c, senc(mSrv(pkCli_5480,pkSess_5320),Ksrv_5549))
                                    )
                                    else
                                        {5996}let pkDisco_5550: bitstring = fail-any in
                                        {5997}in(c, (=pkCli_5480,em1_5551: bitstring,sigM1_5552: bitstring));
                                        {5998}let m1_5553: bitstring = dec(em1_5551,skSess) in
                                        {5999}if (verify(h(m1_5553),sigM1_5552,pkCli_5480) <> true) then
                                            0
                                        else
                                            {6000}let (=OpenSecureChannelRequest,=pkCli_5480,PartC_5554: bitstring) = m1_5553 in
                                            {6001}new Ns_5555: bitstring;
                                            {6002}new ST_5556: bitstring;
                                            {6003}new TTL_5557: bitstring;
                                            {6004}let gNs_5558: bitstring = exp(g,Ns_5555) in
                                            {6005}let m2_5559: bitstring = (OpenSecureChannelResponse,gNs_5558,ST_5556,TTL_5557) in
                                            {6006}out(c, (enc(m2_5559,pkCli_5480),sign(h(m2_5559),skSess)));
                                            {6007}let Ksrv_5560: bitstring = exp(PartC_5554,Ns_5555) in
                                            {6008}out(c, senc(mSrv(pkCli_5480,pkSess_5320),Ksrv_5560))
                                )
                                else
                                    {6009}let pkCli_5561: bitstring = pub(sk(Cli_5316)) in
                                    {6010}let v_5562: bool = (Disco_5317 = A) in
                                    (
                                        {6011}if v_5562 then
                                        (
                                            {6012}let pkDisco_5563: bitstring = pub(skA) in
                                            {6013}in(c, (=pkCli_5561,em1_5564: bitstring,sigM1_5565: bitstring));
                                            {6014}let m1_5566: bitstring = dec(em1_5564,skSess) in
                                            {6015}if (verify(h(m1_5566),sigM1_5565,pkCli_5561) <> true) then
                                                0
                                            else
                                                {6016}let (=OpenSecureChannelRequest,=pkCli_5561,PartC_5567: bitstring) = m1_5566 in
                                                {6017}new Ns_5568: bitstring;
                                                {6018}new ST_5569: bitstring;
                                                {6019}new TTL_5570: bitstring;
                                                {6020}let gNs_5571: bitstring = exp(g,Ns_5568) in
                                                {6021}let m2_5572: bitstring = (OpenSecureChannelResponse,gNs_5571,ST_5569,TTL_5570) in
                                                {6022}out(c, (enc(m2_5572,pkCli_5561),sign(h(m2_5572),skSess)));
                                                {6023}let Ksrv_5573: bitstring = exp(PartC_5567,Ns_5568) in
                                                {6024}out(c, senc(mSrv(pkCli_5561,pkSess_5320),Ksrv_5573))
                                        )
                                        else
                                            {6025}let v_5574: bool = (Disco_5317 = B) in
                                            (
                                                {6026}if v_5574 then
                                                (
                                                    {6027}let pkDisco_5575: bitstring = pub(skB) in
                                                    {6028}in(c, (=pkCli_5561,em1_5576: bitstring,sigM1_5577: bitstring));
                                                    {6029}let m1_5578: bitstring = dec(em1_5576,skSess) in
                                                    {6030}if (verify(h(m1_5578),sigM1_5577,pkCli_5561) <> true) then
                                                        0
                                                    else
                                                        {6031}let (=OpenSecureChannelRequest,=pkCli_5561,PartC_5579: bitstring) = m1_5578 in
                                                        {6032}new Ns_5580: bitstring;
                                                        {6033}new ST_5581: bitstring;
                                                        {6034}new TTL_5582: bitstring;
                                                        {6035}let gNs_5583: bitstring = exp(g,Ns_5580) in
                                                        {6036}let m2_5584: bitstring = (OpenSecureChannelResponse,gNs_5583,ST_5581,TTL_5582) in
                                                        {6037}out(c, (enc(m2_5584,pkCli_5561),sign(h(m2_5584),skSess)));
                                                        {6038}let Ksrv_5585: bitstring = exp(PartC_5579,Ns_5580) in
                                                        {6039}out(c, senc(mSrv(pkCli_5561,pkSess_5320),Ksrv_5585))
                                                )
                                                else
                                                    {6040}let v_5586: bool = (Disco_5317 = C) in
                                                    (
                                                        {6041}if v_5586 then
                                                        (
                                                            {6042}let pkDisco_5587: bitstring = pub(skC) in
                                                            {6043}in(c, (=pkCli_5561,em1_5588: bitstring,sigM1_5589: bitstring));
                                                            {6044}let m1_5590: bitstring = dec(em1_5588,skSess) in
                                                            {6045}if (verify(h(m1_5590),sigM1_5589,pkCli_5561) <> true) then
                                                                0
                                                            else
                                                                {6046}let (=OpenSecureChannelRequest,=pkCli_5561,PartC_5591: bitstring) = m1_5590 in
                                                                {6047}new Ns_5592: bitstring;
                                                                {6048}new ST_5593: bitstring;
                                                                {6049}new TTL_5594: bitstring;
                                                                {6050}let gNs_5595: bitstring = exp(g,Ns_5592) in
                                                                {6051}let m2_5596: bitstring = (OpenSecureChannelResponse,gNs_5595,ST_5593,TTL_5594) in
                                                                {6052}out(c, (enc(m2_5596,pkCli_5561),sign(h(m2_5596),skSess)));
                                                                {6053}let Ksrv_5597: bitstring = exp(PartC_5591,Ns_5592) in
                                                                {6054}out(c, senc(mSrv(pkCli_5561,pkSess_5320),Ksrv_5597))
                                                        )
                                                        else
                                                            {6055}let pkDisco_5598: bitstring = pub(sk(Disco_5317)) in
                                                            {6056}in(c, (=pkCli_5561,em1_5599: bitstring,sigM1_5600: bitstring));
                                                            {6057}let m1_5601: bitstring = dec(em1_5599,skSess) in
                                                            {6058}if (verify(h(m1_5601),sigM1_5600,pkCli_5561) <> true) then
                                                                0
                                                            else
                                                                {6059}let (=OpenSecureChannelRequest,=pkCli_5561,PartC_5602: bitstring) = m1_5601 in
                                                                {6060}new Ns_5603: bitstring;
                                                                {6061}new ST_5604: bitstring;
                                                                {6062}new TTL_5605: bitstring;
                                                                {6063}let gNs_5606: bitstring = exp(g,Ns_5603) in
                                                                {6064}let m2_5607: bitstring = (OpenSecureChannelResponse,gNs_5606,ST_5604,TTL_5605) in
                                                                {6065}out(c, (enc(m2_5607,pkCli_5561),sign(h(m2_5607),skSess)));
                                                                {6066}let Ksrv_5608: bitstring = exp(PartC_5602,Ns_5603) in
                                                                {6067}out(c, senc(mSrv(pkCli_5561,pkSess_5320),Ksrv_5608))
                                                    )
                                                    else
                                                        {6068}let pkDisco_5609: bitstring = fail-any in
                                                        {6069}in(c, (=pkCli_5561,em1_5610: bitstring,sigM1_5611: bitstring));
                                                        {6070}let m1_5612: bitstring = dec(em1_5610,skSess) in
                                                        {6071}if (verify(h(m1_5612),sigM1_5611,pkCli_5561) <> true) then
                                                            0
                                                        else
                                                            {6072}let (=OpenSecureChannelRequest,=pkCli_5561,PartC_5613: bitstring) = m1_5612 in
                                                            {6073}new Ns_5614: bitstring;
                                                            {6074}new ST_5615: bitstring;
                                                            {6075}new TTL_5616: bitstring;
                                                            {6076}let gNs_5617: bitstring = exp(g,Ns_5614) in
                                                            {6077}let m2_5618: bitstring = (OpenSecureChannelResponse,gNs_5617,ST_5615,TTL_5616) in
                                                            {6078}out(c, (enc(m2_5618,pkCli_5561),sign(h(m2_5618),skSess)));
                                                            {6079}let Ksrv_5619: bitstring = exp(PartC_5613,Ns_5614) in
                                                            {6080}out(c, senc(mSrv(pkCli_5561,pkSess_5320),Ksrv_5619))
                                            )
                                            else
                                                {6081}let pkDisco_5620: bitstring = fail-any in
                                                {6082}in(c, (=pkCli_5561,em1_5621: bitstring,sigM1_5622: bitstring));
                                                {6083}let m1_5623: bitstring = dec(em1_5621,skSess) in
                                                {6084}if (verify(h(m1_5623),sigM1_5622,pkCli_5561) <> true) then
                                                    0
                                                else
                                                    {6085}let (=OpenSecureChannelRequest,=pkCli_5561,PartC_5624: bitstring) = m1_5623 in
                                                    {6086}new Ns_5625: bitstring;
                                                    {6087}new ST_5626: bitstring;
                                                    {6088}new TTL_5627: bitstring;
                                                    {6089}let gNs_5628: bitstring = exp(g,Ns_5625) in
                                                    {6090}let m2_5629: bitstring = (OpenSecureChannelResponse,gNs_5628,ST_5626,TTL_5627) in
                                                    {6091}out(c, (enc(m2_5629,pkCli_5561),sign(h(m2_5629),skSess)));
                                                    {6092}let Ksrv_5630: bitstring = exp(PartC_5624,Ns_5625) in
                                                    {6093}out(c, senc(mSrv(pkCli_5561,pkSess_5320),Ksrv_5630))
                                    )
                                    else
                                        {6094}let pkDisco_5631: bitstring = fail-any in
                                        {6095}in(c, (=pkCli_5561,em1_5632: bitstring,sigM1_5633: bitstring));
                                        {6096}let m1_5634: bitstring = dec(em1_5632,skSess) in
                                        {6097}if (verify(h(m1_5634),sigM1_5633,pkCli_5561) <> true) then
                                            0
                                        else
                                            {6098}let (=OpenSecureChannelRequest,=pkCli_5561,PartC_5635: bitstring) = m1_5634 in
                                            {6099}new Ns_5636: bitstring;
                                            {6100}new ST_5637: bitstring;
                                            {6101}new TTL_5638: bitstring;
                                            {6102}let gNs_5639: bitstring = exp(g,Ns_5636) in
                                            {6103}let m2_5640: bitstring = (OpenSecureChannelResponse,gNs_5639,ST_5637,TTL_5638) in
                                            {6104}out(c, (enc(m2_5640,pkCli_5561),sign(h(m2_5640),skSess)));
                                            {6105}let Ksrv_5641: bitstring = exp(PartC_5635,Ns_5636) in
                                            {6106}out(c, senc(mSrv(pkCli_5561,pkSess_5320),Ksrv_5641))
                            )
                            else
                                {6107}let pkCli_5642: bitstring = fail-any in
                                {6108}let v_5643: bool = (Disco_5317 = A) in
                                (
                                    {6109}if v_5643 then
                                    (
                                        {6110}let pkDisco_5644: bitstring = pub(skA) in
                                        {6111}in(c, (=pkCli_5642,em1_5645: bitstring,sigM1_5646: bitstring));
                                        {6112}let m1_5647: bitstring = dec(em1_5645,skSess) in
                                        {6113}if (verify(h(m1_5647),sigM1_5646,pkCli_5642) <> true) then
                                            0
                                        else
                                            {6114}let (=OpenSecureChannelRequest,=pkCli_5642,PartC_5648: bitstring) = m1_5647 in
                                            {6115}new Ns_5649: bitstring;
                                            {6116}new ST_5650: bitstring;
                                            {6117}new TTL_5651: bitstring;
                                            {6118}let gNs_5652: bitstring = exp(g,Ns_5649) in
                                            {6119}let m2_5653: bitstring = (OpenSecureChannelResponse,gNs_5652,ST_5650,TTL_5651) in
                                            {6120}out(c, (enc(m2_5653,pkCli_5642),sign(h(m2_5653),skSess)));
                                            {6121}let Ksrv_5654: bitstring = exp(PartC_5648,Ns_5649) in
                                            {6122}out(c, senc(mSrv(pkCli_5642,pkSess_5320),Ksrv_5654))
                                    )
                                    else
                                        {6123}let v_5655: bool = (Disco_5317 = B) in
                                        (
                                            {6124}if v_5655 then
                                            (
                                                {6125}let pkDisco_5656: bitstring = pub(skB) in
                                                {6126}in(c, (=pkCli_5642,em1_5657: bitstring,sigM1_5658: bitstring));
                                                {6127}let m1_5659: bitstring = dec(em1_5657,skSess) in
                                                {6128}if (verify(h(m1_5659),sigM1_5658,pkCli_5642) <> true) then
                                                    0
                                                else
                                                    {6129}let (=OpenSecureChannelRequest,=pkCli_5642,PartC_5660: bitstring) = m1_5659 in
                                                    {6130}new Ns_5661: bitstring;
                                                    {6131}new ST_5662: bitstring;
                                                    {6132}new TTL_5663: bitstring;
                                                    {6133}let gNs_5664: bitstring = exp(g,Ns_5661) in
                                                    {6134}let m2_5665: bitstring = (OpenSecureChannelResponse,gNs_5664,ST_5662,TTL_5663) in
                                                    {6135}out(c, (enc(m2_5665,pkCli_5642),sign(h(m2_5665),skSess)));
                                                    {6136}let Ksrv_5666: bitstring = exp(PartC_5660,Ns_5661) in
                                                    {6137}out(c, senc(mSrv(pkCli_5642,pkSess_5320),Ksrv_5666))
                                            )
                                            else
                                                {6138}let v_5667: bool = (Disco_5317 = C) in
                                                (
                                                    {6139}if v_5667 then
                                                    (
                                                        {6140}let pkDisco_5668: bitstring = pub(skC) in
                                                        {6141}in(c, (=pkCli_5642,em1_5669: bitstring,sigM1_5670: bitstring));
                                                        {6142}let m1_5671: bitstring = dec(em1_5669,skSess) in
                                                        {6143}if (verify(h(m1_5671),sigM1_5670,pkCli_5642) <> true) then
                                                            0
                                                        else
                                                            {6144}let (=OpenSecureChannelRequest,=pkCli_5642,PartC_5672: bitstring) = m1_5671 in
                                                            {6145}new Ns_5673: bitstring;
                                                            {6146}new ST_5674: bitstring;
                                                            {6147}new TTL_5675: bitstring;
                                                            {6148}let gNs_5676: bitstring = exp(g,Ns_5673) in
                                                            {6149}let m2_5677: bitstring = (OpenSecureChannelResponse,gNs_5676,ST_5674,TTL_5675) in
                                                            {6150}out(c, (enc(m2_5677,pkCli_5642),sign(h(m2_5677),skSess)));
                                                            {6151}let Ksrv_5678: bitstring = exp(PartC_5672,Ns_5673) in
                                                            {6152}out(c, senc(mSrv(pkCli_5642,pkSess_5320),Ksrv_5678))
                                                    )
                                                    else
                                                        {6153}let pkDisco_5679: bitstring = pub(sk(Disco_5317)) in
                                                        {6154}in(c, (=pkCli_5642,em1_5680: bitstring,sigM1_5681: bitstring));
                                                        {6155}let m1_5682: bitstring = dec(em1_5680,skSess) in
                                                        {6156}if (verify(h(m1_5682),sigM1_5681,pkCli_5642) <> true) then
                                                            0
                                                        else
                                                            {6157}let (=OpenSecureChannelRequest,=pkCli_5642,PartC_5683: bitstring) = m1_5682 in
                                                            {6158}new Ns_5684: bitstring;
                                                            {6159}new ST_5685: bitstring;
                                                            {6160}new TTL_5686: bitstring;
                                                            {6161}let gNs_5687: bitstring = exp(g,Ns_5684) in
                                                            {6162}let m2_5688: bitstring = (OpenSecureChannelResponse,gNs_5687,ST_5685,TTL_5686) in
                                                            {6163}out(c, (enc(m2_5688,pkCli_5642),sign(h(m2_5688),skSess)));
                                                            {6164}let Ksrv_5689: bitstring = exp(PartC_5683,Ns_5684) in
                                                            {6165}out(c, senc(mSrv(pkCli_5642,pkSess_5320),Ksrv_5689))
                                                )
                                                else
                                                    {6166}let pkDisco_5690: bitstring = fail-any in
                                                    {6167}in(c, (=pkCli_5642,em1_5691: bitstring,sigM1_5692: bitstring));
                                                    {6168}let m1_5693: bitstring = dec(em1_5691,skSess) in
                                                    {6169}if (verify(h(m1_5693),sigM1_5692,pkCli_5642) <> true) then
                                                        0
                                                    else
                                                        {6170}let (=OpenSecureChannelRequest,=pkCli_5642,PartC_5694: bitstring) = m1_5693 in
                                                        {6171}new Ns_5695: bitstring;
                                                        {6172}new ST_5696: bitstring;
                                                        {6173}new TTL_5697: bitstring;
                                                        {6174}let gNs_5698: bitstring = exp(g,Ns_5695) in
                                                        {6175}let m2_5699: bitstring = (OpenSecureChannelResponse,gNs_5698,ST_5696,TTL_5697) in
                                                        {6176}out(c, (enc(m2_5699,pkCli_5642),sign(h(m2_5699),skSess)));
                                                        {6177}let Ksrv_5700: bitstring = exp(PartC_5694,Ns_5695) in
                                                        {6178}out(c, senc(mSrv(pkCli_5642,pkSess_5320),Ksrv_5700))
                                        )
                                        else
                                            {6179}let pkDisco_5701: bitstring = fail-any in
                                            {6180}in(c, (=pkCli_5642,em1_5702: bitstring,sigM1_5703: bitstring));
                                            {6181}let m1_5704: bitstring = dec(em1_5702,skSess) in
                                            {6182}if (verify(h(m1_5704),sigM1_5703,pkCli_5642) <> true) then
                                                0
                                            else
                                                {6183}let (=OpenSecureChannelRequest,=pkCli_5642,PartC_5705: bitstring) = m1_5704 in
                                                {6184}new Ns_5706: bitstring;
                                                {6185}new ST_5707: bitstring;
                                                {6186}new TTL_5708: bitstring;
                                                {6187}let gNs_5709: bitstring = exp(g,Ns_5706) in
                                                {6188}let m2_5710: bitstring = (OpenSecureChannelResponse,gNs_5709,ST_5707,TTL_5708) in
                                                {6189}out(c, (enc(m2_5710,pkCli_5642),sign(h(m2_5710),skSess)));
                                                {6190}let Ksrv_5711: bitstring = exp(PartC_5705,Ns_5706) in
                                                {6191}out(c, senc(mSrv(pkCli_5642,pkSess_5320),Ksrv_5711))
                                )
                                else
                                    {6192}let pkDisco_5712: bitstring = fail-any in
                                    {6193}in(c, (=pkCli_5642,em1_5713: bitstring,sigM1_5714: bitstring));
                                    {6194}let m1_5715: bitstring = dec(em1_5713,skSess) in
                                    {6195}if (verify(h(m1_5715),sigM1_5714,pkCli_5642) <> true) then
                                        0
                                    else
                                        {6196}let (=OpenSecureChannelRequest,=pkCli_5642,PartC_5716: bitstring) = m1_5715 in
                                        {6197}new Ns_5717: bitstring;
                                        {6198}new ST_5718: bitstring;
                                        {6199}new TTL_5719: bitstring;
                                        {6200}let gNs_5720: bitstring = exp(g,Ns_5717) in
                                        {6201}let m2_5721: bitstring = (OpenSecureChannelResponse,gNs_5720,ST_5718,TTL_5719) in
                                        {6202}out(c, (enc(m2_5721,pkCli_5642),sign(h(m2_5721),skSess)));
                                        {6203}let Ksrv_5722: bitstring = exp(PartC_5716,Ns_5717) in
                                        {6204}out(c, senc(mSrv(pkCli_5642,pkSess_5320),Ksrv_5722))
                    )
                    else
                        {6205}let pkCli_5723: bitstring = fail-any in
                        {6206}let v_5724: bool = (Disco_5317 = A) in
                        (
                            {6207}if v_5724 then
                            (
                                {6208}let pkDisco_5725: bitstring = pub(skA) in
                                {6209}in(c, (=pkCli_5723,em1_5726: bitstring,sigM1_5727: bitstring));
                                {6210}let m1_5728: bitstring = dec(em1_5726,skSess) in
                                {6211}if (verify(h(m1_5728),sigM1_5727,pkCli_5723) <> true) then
                                    0
                                else
                                    {6212}let (=OpenSecureChannelRequest,=pkCli_5723,PartC_5729: bitstring) = m1_5728 in
                                    {6213}new Ns_5730: bitstring;
                                    {6214}new ST_5731: bitstring;
                                    {6215}new TTL_5732: bitstring;
                                    {6216}let gNs_5733: bitstring = exp(g,Ns_5730) in
                                    {6217}let m2_5734: bitstring = (OpenSecureChannelResponse,gNs_5733,ST_5731,TTL_5732) in
                                    {6218}out(c, (enc(m2_5734,pkCli_5723),sign(h(m2_5734),skSess)));
                                    {6219}let Ksrv_5735: bitstring = exp(PartC_5729,Ns_5730) in
                                    {6220}out(c, senc(mSrv(pkCli_5723,pkSess_5320),Ksrv_5735))
                            )
                            else
                                {6221}let v_5736: bool = (Disco_5317 = B) in
                                (
                                    {6222}if v_5736 then
                                    (
                                        {6223}let pkDisco_5737: bitstring = pub(skB) in
                                        {6224}in(c, (=pkCli_5723,em1_5738: bitstring,sigM1_5739: bitstring));
                                        {6225}let m1_5740: bitstring = dec(em1_5738,skSess) in
                                        {6226}if (verify(h(m1_5740),sigM1_5739,pkCli_5723) <> true) then
                                            0
                                        else
                                            {6227}let (=OpenSecureChannelRequest,=pkCli_5723,PartC_5741: bitstring) = m1_5740 in
                                            {6228}new Ns_5742: bitstring;
                                            {6229}new ST_5743: bitstring;
                                            {6230}new TTL_5744: bitstring;
                                            {6231}let gNs_5745: bitstring = exp(g,Ns_5742) in
                                            {6232}let m2_5746: bitstring = (OpenSecureChannelResponse,gNs_5745,ST_5743,TTL_5744) in
                                            {6233}out(c, (enc(m2_5746,pkCli_5723),sign(h(m2_5746),skSess)));
                                            {6234}let Ksrv_5747: bitstring = exp(PartC_5741,Ns_5742) in
                                            {6235}out(c, senc(mSrv(pkCli_5723,pkSess_5320),Ksrv_5747))
                                    )
                                    else
                                        {6236}let v_5748: bool = (Disco_5317 = C) in
                                        (
                                            {6237}if v_5748 then
                                            (
                                                {6238}let pkDisco_5749: bitstring = pub(skC) in
                                                {6239}in(c, (=pkCli_5723,em1_5750: bitstring,sigM1_5751: bitstring));
                                                {6240}let m1_5752: bitstring = dec(em1_5750,skSess) in
                                                {6241}if (verify(h(m1_5752),sigM1_5751,pkCli_5723) <> true) then
                                                    0
                                                else
                                                    {6242}let (=OpenSecureChannelRequest,=pkCli_5723,PartC_5753: bitstring) = m1_5752 in
                                                    {6243}new Ns_5754: bitstring;
                                                    {6244}new ST_5755: bitstring;
                                                    {6245}new TTL_5756: bitstring;
                                                    {6246}let gNs_5757: bitstring = exp(g,Ns_5754) in
                                                    {6247}let m2_5758: bitstring = (OpenSecureChannelResponse,gNs_5757,ST_5755,TTL_5756) in
                                                    {6248}out(c, (enc(m2_5758,pkCli_5723),sign(h(m2_5758),skSess)));
                                                    {6249}let Ksrv_5759: bitstring = exp(PartC_5753,Ns_5754) in
                                                    {6250}out(c, senc(mSrv(pkCli_5723,pkSess_5320),Ksrv_5759))
                                            )
                                            else
                                                {6251}let pkDisco_5760: bitstring = pub(sk(Disco_5317)) in
                                                {6252}in(c, (=pkCli_5723,em1_5761: bitstring,sigM1_5762: bitstring));
                                                {6253}let m1_5763: bitstring = dec(em1_5761,skSess) in
                                                {6254}if (verify(h(m1_5763),sigM1_5762,pkCli_5723) <> true) then
                                                    0
                                                else
                                                    {6255}let (=OpenSecureChannelRequest,=pkCli_5723,PartC_5764: bitstring) = m1_5763 in
                                                    {6256}new Ns_5765: bitstring;
                                                    {6257}new ST_5766: bitstring;
                                                    {6258}new TTL_5767: bitstring;
                                                    {6259}let gNs_5768: bitstring = exp(g,Ns_5765) in
                                                    {6260}let m2_5769: bitstring = (OpenSecureChannelResponse,gNs_5768,ST_5766,TTL_5767) in
                                                    {6261}out(c, (enc(m2_5769,pkCli_5723),sign(h(m2_5769),skSess)));
                                                    {6262}let Ksrv_5770: bitstring = exp(PartC_5764,Ns_5765) in
                                                    {6263}out(c, senc(mSrv(pkCli_5723,pkSess_5320),Ksrv_5770))
                                        )
                                        else
                                            {6264}let pkDisco_5771: bitstring = fail-any in
                                            {6265}in(c, (=pkCli_5723,em1_5772: bitstring,sigM1_5773: bitstring));
                                            {6266}let m1_5774: bitstring = dec(em1_5772,skSess) in
                                            {6267}if (verify(h(m1_5774),sigM1_5773,pkCli_5723) <> true) then
                                                0
                                            else
                                                {6268}let (=OpenSecureChannelRequest,=pkCli_5723,PartC_5775: bitstring) = m1_5774 in
                                                {6269}new Ns_5776: bitstring;
                                                {6270}new ST_5777: bitstring;
                                                {6271}new TTL_5778: bitstring;
                                                {6272}let gNs_5779: bitstring = exp(g,Ns_5776) in
                                                {6273}let m2_5780: bitstring = (OpenSecureChannelResponse,gNs_5779,ST_5777,TTL_5778) in
                                                {6274}out(c, (enc(m2_5780,pkCli_5723),sign(h(m2_5780),skSess)));
                                                {6275}let Ksrv_5781: bitstring = exp(PartC_5775,Ns_5776) in
                                                {6276}out(c, senc(mSrv(pkCli_5723,pkSess_5320),Ksrv_5781))
                                )
                                else
                                    {6277}let pkDisco_5782: bitstring = fail-any in
                                    {6278}in(c, (=pkCli_5723,em1_5783: bitstring,sigM1_5784: bitstring));
                                    {6279}let m1_5785: bitstring = dec(em1_5783,skSess) in
                                    {6280}if (verify(h(m1_5785),sigM1_5784,pkCli_5723) <> true) then
                                        0
                                    else
                                        {6281}let (=OpenSecureChannelRequest,=pkCli_5723,PartC_5786: bitstring) = m1_5785 in
                                        {6282}new Ns_5787: bitstring;
                                        {6283}new ST_5788: bitstring;
                                        {6284}new TTL_5789: bitstring;
                                        {6285}let gNs_5790: bitstring = exp(g,Ns_5787) in
                                        {6286}let m2_5791: bitstring = (OpenSecureChannelResponse,gNs_5790,ST_5788,TTL_5789) in
                                        {6287}out(c, (enc(m2_5791,pkCli_5723),sign(h(m2_5791),skSess)));
                                        {6288}let Ksrv_5792: bitstring = exp(PartC_5786,Ns_5787) in
                                        {6289}out(c, senc(mSrv(pkCli_5723,pkSess_5320),Ksrv_5792))
                        )
                        else
                            {6290}let pkDisco_5793: bitstring = fail-any in
                            {6291}in(c, (=pkCli_5723,em1_5794: bitstring,sigM1_5795: bitstring));
                            {6292}let m1_5796: bitstring = dec(em1_5794,skSess) in
                            {6293}if (verify(h(m1_5796),sigM1_5795,pkCli_5723) <> true) then
                                0
                            else
                                {6294}let (=OpenSecureChannelRequest,=pkCli_5723,PartC_5797: bitstring) = m1_5796 in
                                {6295}new Ns_5798: bitstring;
                                {6296}new ST_5799: bitstring;
                                {6297}new TTL_5800: bitstring;
                                {6298}let gNs_5801: bitstring = exp(g,Ns_5798) in
                                {6299}let m2_5802: bitstring = (OpenSecureChannelResponse,gNs_5801,ST_5799,TTL_5800) in
                                {6300}out(c, (enc(m2_5802,pkCli_5723),sign(h(m2_5802),skSess)));
                                {6301}let Ksrv_5803: bitstring = exp(PartC_5797,Ns_5798) in
                                {6302}out(c, senc(mSrv(pkCli_5723,pkSess_5320),Ksrv_5803))
            )
            else
                {6303}let pkCli_5804: bitstring = fail-any in
                {6304}let v_5805: bool = (Disco_5317 = A) in
                (
                    {6305}if v_5805 then
                    (
                        {6306}let pkDisco_5806: bitstring = pub(skA) in
                        {6307}in(c, (=pkCli_5804,em1_5807: bitstring,sigM1_5808: bitstring));
                        {6308}let m1_5809: bitstring = dec(em1_5807,skSess) in
                        {6309}if (verify(h(m1_5809),sigM1_5808,pkCli_5804) <> true) then
                            0
                        else
                            {6310}let (=OpenSecureChannelRequest,=pkCli_5804,PartC_5810: bitstring) = m1_5809 in
                            {6311}new Ns_5811: bitstring;
                            {6312}new ST_5812: bitstring;
                            {6313}new TTL_5813: bitstring;
                            {6314}let gNs_5814: bitstring = exp(g,Ns_5811) in
                            {6315}let m2_5815: bitstring = (OpenSecureChannelResponse,gNs_5814,ST_5812,TTL_5813) in
                            {6316}out(c, (enc(m2_5815,pkCli_5804),sign(h(m2_5815),skSess)));
                            {6317}let Ksrv_5816: bitstring = exp(PartC_5810,Ns_5811) in
                            {6318}out(c, senc(mSrv(pkCli_5804,pkSess_5320),Ksrv_5816))
                    )
                    else
                        {6319}let v_5817: bool = (Disco_5317 = B) in
                        (
                            {6320}if v_5817 then
                            (
                                {6321}let pkDisco_5818: bitstring = pub(skB) in
                                {6322}in(c, (=pkCli_5804,em1_5819: bitstring,sigM1_5820: bitstring));
                                {6323}let m1_5821: bitstring = dec(em1_5819,skSess) in
                                {6324}if (verify(h(m1_5821),sigM1_5820,pkCli_5804) <> true) then
                                    0
                                else
                                    {6325}let (=OpenSecureChannelRequest,=pkCli_5804,PartC_5822: bitstring) = m1_5821 in
                                    {6326}new Ns_5823: bitstring;
                                    {6327}new ST_5824: bitstring;
                                    {6328}new TTL_5825: bitstring;
                                    {6329}let gNs_5826: bitstring = exp(g,Ns_5823) in
                                    {6330}let m2_5827: bitstring = (OpenSecureChannelResponse,gNs_5826,ST_5824,TTL_5825) in
                                    {6331}out(c, (enc(m2_5827,pkCli_5804),sign(h(m2_5827),skSess)));
                                    {6332}let Ksrv_5828: bitstring = exp(PartC_5822,Ns_5823) in
                                    {6333}out(c, senc(mSrv(pkCli_5804,pkSess_5320),Ksrv_5828))
                            )
                            else
                                {6334}let v_5829: bool = (Disco_5317 = C) in
                                (
                                    {6335}if v_5829 then
                                    (
                                        {6336}let pkDisco_5830: bitstring = pub(skC) in
                                        {6337}in(c, (=pkCli_5804,em1_5831: bitstring,sigM1_5832: bitstring));
                                        {6338}let m1_5833: bitstring = dec(em1_5831,skSess) in
                                        {6339}if (verify(h(m1_5833),sigM1_5832,pkCli_5804) <> true) then
                                            0
                                        else
                                            {6340}let (=OpenSecureChannelRequest,=pkCli_5804,PartC_5834: bitstring) = m1_5833 in
                                            {6341}new Ns_5835: bitstring;
                                            {6342}new ST_5836: bitstring;
                                            {6343}new TTL_5837: bitstring;
                                            {6344}let gNs_5838: bitstring = exp(g,Ns_5835) in
                                            {6345}let m2_5839: bitstring = (OpenSecureChannelResponse,gNs_5838,ST_5836,TTL_5837) in
                                            {6346}out(c, (enc(m2_5839,pkCli_5804),sign(h(m2_5839),skSess)));
                                            {6347}let Ksrv_5840: bitstring = exp(PartC_5834,Ns_5835) in
                                            {6348}out(c, senc(mSrv(pkCli_5804,pkSess_5320),Ksrv_5840))
                                    )
                                    else
                                        {6349}let pkDisco_5841: bitstring = pub(sk(Disco_5317)) in
                                        {6350}in(c, (=pkCli_5804,em1_5842: bitstring,sigM1_5843: bitstring));
                                        {6351}let m1_5844: bitstring = dec(em1_5842,skSess) in
                                        {6352}if (verify(h(m1_5844),sigM1_5843,pkCli_5804) <> true) then
                                            0
                                        else
                                            {6353}let (=OpenSecureChannelRequest,=pkCli_5804,PartC_5845: bitstring) = m1_5844 in
                                            {6354}new Ns_5846: bitstring;
                                            {6355}new ST_5847: bitstring;
                                            {6356}new TTL_5848: bitstring;
                                            {6357}let gNs_5849: bitstring = exp(g,Ns_5846) in
                                            {6358}let m2_5850: bitstring = (OpenSecureChannelResponse,gNs_5849,ST_5847,TTL_5848) in
                                            {6359}out(c, (enc(m2_5850,pkCli_5804),sign(h(m2_5850),skSess)));
                                            {6360}let Ksrv_5851: bitstring = exp(PartC_5845,Ns_5846) in
                                            {6361}out(c, senc(mSrv(pkCli_5804,pkSess_5320),Ksrv_5851))
                                )
                                else
                                    {6362}let pkDisco_5852: bitstring = fail-any in
                                    {6363}in(c, (=pkCli_5804,em1_5853: bitstring,sigM1_5854: bitstring));
                                    {6364}let m1_5855: bitstring = dec(em1_5853,skSess) in
                                    {6365}if (verify(h(m1_5855),sigM1_5854,pkCli_5804) <> true) then
                                        0
                                    else
                                        {6366}let (=OpenSecureChannelRequest,=pkCli_5804,PartC_5856: bitstring) = m1_5855 in
                                        {6367}new Ns_5857: bitstring;
                                        {6368}new ST_5858: bitstring;
                                        {6369}new TTL_5859: bitstring;
                                        {6370}let gNs_5860: bitstring = exp(g,Ns_5857) in
                                        {6371}let m2_5861: bitstring = (OpenSecureChannelResponse,gNs_5860,ST_5858,TTL_5859) in
                                        {6372}out(c, (enc(m2_5861,pkCli_5804),sign(h(m2_5861),skSess)));
                                        {6373}let Ksrv_5862: bitstring = exp(PartC_5856,Ns_5857) in
                                        {6374}out(c, senc(mSrv(pkCli_5804,pkSess_5320),Ksrv_5862))
                        )
                        else
                            {6375}let pkDisco_5863: bitstring = fail-any in
                            {6376}in(c, (=pkCli_5804,em1_5864: bitstring,sigM1_5865: bitstring));
                            {6377}let m1_5866: bitstring = dec(em1_5864,skSess) in
                            {6378}if (verify(h(m1_5866),sigM1_5865,pkCli_5804) <> true) then
                                0
                            else
                                {6379}let (=OpenSecureChannelRequest,=pkCli_5804,PartC_5867: bitstring) = m1_5866 in
                                {6380}new Ns_5868: bitstring;
                                {6381}new ST_5869: bitstring;
                                {6382}new TTL_5870: bitstring;
                                {6383}let gNs_5871: bitstring = exp(g,Ns_5868) in
                                {6384}let m2_5872: bitstring = (OpenSecureChannelResponse,gNs_5871,ST_5869,TTL_5870) in
                                {6385}out(c, (enc(m2_5872,pkCli_5804),sign(h(m2_5872),skSess)));
                                {6386}let Ksrv_5873: bitstring = exp(PartC_5867,Ns_5868) in
                                {6387}out(c, senc(mSrv(pkCli_5804,pkSess_5320),Ksrv_5873))
                )
                else
                    {6388}let pkDisco_5874: bitstring = fail-any in
                    {6389}in(c, (=pkCli_5804,em1_5875: bitstring,sigM1_5876: bitstring));
                    {6390}let m1_5877: bitstring = dec(em1_5875,skSess) in
                    {6391}if (verify(h(m1_5877),sigM1_5876,pkCli_5804) <> true) then
                        0
                    else
                        {6392}let (=OpenSecureChannelRequest,=pkCli_5804,PartC_5878: bitstring) = m1_5877 in
                        {6393}new Ns_5879: bitstring;
                        {6394}new ST_5880: bitstring;
                        {6395}new TTL_5881: bitstring;
                        {6396}let gNs_5882: bitstring = exp(g,Ns_5879) in
                        {6397}let m2_5883: bitstring = (OpenSecureChannelResponse,gNs_5882,ST_5880,TTL_5881) in
                        {6398}out(c, (enc(m2_5883,pkCli_5804),sign(h(m2_5883),skSess)));
                        {6399}let Ksrv_5884: bitstring = exp(PartC_5878,Ns_5879) in
                        {6400}out(c, senc(mSrv(pkCli_5804,pkSess_5320),Ksrv_5884))
        )
        else
            {6401}let v_5885: bool = (Sess_5318 = B) in
            (
                {6402}if v_5885 then
                (
                    {6403}let skSess_5886: bitstring = skB in
                    {6404}let pkSess_5887: bitstring = pub(skSess_5886) in
                    {6405}let v_5888: bool = (Cli_5316 = A) in
                    (
                        {6406}if v_5888 then
                        (
                            {6407}let pkCli_5889: bitstring = pub(skA) in
                            {6408}let v_5890: bool = (Disco_5317 = A) in
                            (
                                {6409}if v_5890 then
                                (
                                    {6410}let pkDisco_5891: bitstring = pub(skA) in
                                    {6411}in(c, (=pkCli_5889,em1_5892: bitstring,sigM1_5893: bitstring));
                                    {6412}let m1_5894: bitstring = dec(em1_5892,skSess_5886) in
                                    {6413}if (verify(h(m1_5894),sigM1_5893,pkCli_5889) <> true) then
                                        0
                                    else
                                        {6414}let (=OpenSecureChannelRequest,=pkCli_5889,PartC_5895: bitstring) = m1_5894 in
                                        {6415}new Ns_5896: bitstring;
                                        {6416}new ST_5897: bitstring;
                                        {6417}new TTL_5898: bitstring;
                                        {6418}let gNs_5899: bitstring = exp(g,Ns_5896) in
                                        {6419}let m2_5900: bitstring = (OpenSecureChannelResponse,gNs_5899,ST_5897,TTL_5898) in
                                        {6420}out(c, (enc(m2_5900,pkCli_5889),sign(h(m2_5900),skSess_5886)));
                                        {6421}let Ksrv_5901: bitstring = exp(PartC_5895,Ns_5896) in
                                        {6422}out(c, senc(mSrv(pkCli_5889,pkSess_5887),Ksrv_5901))
                                )
                                else
                                    {6423}let v_5902: bool = (Disco_5317 = B) in
                                    (
                                        {6424}if v_5902 then
                                        (
                                            {6425}let pkDisco_5903: bitstring = pub(skB) in
                                            {6426}in(c, (=pkCli_5889,em1_5904: bitstring,sigM1_5905: bitstring));
                                            {6427}let m1_5906: bitstring = dec(em1_5904,skSess_5886) in
                                            {6428}if (verify(h(m1_5906),sigM1_5905,pkCli_5889) <> true) then
                                                0
                                            else
                                                {6429}let (=OpenSecureChannelRequest,=pkCli_5889,PartC_5907: bitstring) = m1_5906 in
                                                {6430}new Ns_5908: bitstring;
                                                {6431}new ST_5909: bitstring;
                                                {6432}new TTL_5910: bitstring;
                                                {6433}let gNs_5911: bitstring = exp(g,Ns_5908) in
                                                {6434}let m2_5912: bitstring = (OpenSecureChannelResponse,gNs_5911,ST_5909,TTL_5910) in
                                                {6435}out(c, (enc(m2_5912,pkCli_5889),sign(h(m2_5912),skSess_5886)));
                                                {6436}let Ksrv_5913: bitstring = exp(PartC_5907,Ns_5908) in
                                                {6437}out(c, senc(mSrv(pkCli_5889,pkSess_5887),Ksrv_5913))
                                        )
                                        else
                                            {6438}let v_5914: bool = (Disco_5317 = C) in
                                            (
                                                {6439}if v_5914 then
                                                (
                                                    {6440}let pkDisco_5915: bitstring = pub(skC) in
                                                    {6441}in(c, (=pkCli_5889,em1_5916: bitstring,sigM1_5917: bitstring));
                                                    {6442}let m1_5918: bitstring = dec(em1_5916,skSess_5886) in
                                                    {6443}if (verify(h(m1_5918),sigM1_5917,pkCli_5889) <> true) then
                                                        0
                                                    else
                                                        {6444}let (=OpenSecureChannelRequest,=pkCli_5889,PartC_5919: bitstring) = m1_5918 in
                                                        {6445}new Ns_5920: bitstring;
                                                        {6446}new ST_5921: bitstring;
                                                        {6447}new TTL_5922: bitstring;
                                                        {6448}let gNs_5923: bitstring = exp(g,Ns_5920) in
                                                        {6449}let m2_5924: bitstring = (OpenSecureChannelResponse,gNs_5923,ST_5921,TTL_5922) in
                                                        {6450}out(c, (enc(m2_5924,pkCli_5889),sign(h(m2_5924),skSess_5886)));
                                                        {6451}let Ksrv_5925: bitstring = exp(PartC_5919,Ns_5920) in
                                                        {6452}out(c, senc(mSrv(pkCli_5889,pkSess_5887),Ksrv_5925))
                                                )
                                                else
                                                    {6453}let pkDisco_5926: bitstring = pub(sk(Disco_5317)) in
                                                    {6454}in(c, (=pkCli_5889,em1_5927: bitstring,sigM1_5928: bitstring));
                                                    {6455}let m1_5929: bitstring = dec(em1_5927,skSess_5886) in
                                                    {6456}if (verify(h(m1_5929),sigM1_5928,pkCli_5889) <> true) then
                                                        0
                                                    else
                                                        {6457}let (=OpenSecureChannelRequest,=pkCli_5889,PartC_5930: bitstring) = m1_5929 in
                                                        {6458}new Ns_5931: bitstring;
                                                        {6459}new ST_5932: bitstring;
                                                        {6460}new TTL_5933: bitstring;
                                                        {6461}let gNs_5934: bitstring = exp(g,Ns_5931) in
                                                        {6462}let m2_5935: bitstring = (OpenSecureChannelResponse,gNs_5934,ST_5932,TTL_5933) in
                                                        {6463}out(c, (enc(m2_5935,pkCli_5889),sign(h(m2_5935),skSess_5886)));
                                                        {6464}let Ksrv_5936: bitstring = exp(PartC_5930,Ns_5931) in
                                                        {6465}out(c, senc(mSrv(pkCli_5889,pkSess_5887),Ksrv_5936))
                                            )
                                            else
                                                {6466}let pkDisco_5937: bitstring = fail-any in
                                                {6467}in(c, (=pkCli_5889,em1_5938: bitstring,sigM1_5939: bitstring));
                                                {6468}let m1_5940: bitstring = dec(em1_5938,skSess_5886) in
                                                {6469}if (verify(h(m1_5940),sigM1_5939,pkCli_5889) <> true) then
                                                    0
                                                else
                                                    {6470}let (=OpenSecureChannelRequest,=pkCli_5889,PartC_5941: bitstring) = m1_5940 in
                                                    {6471}new Ns_5942: bitstring;
                                                    {6472}new ST_5943: bitstring;
                                                    {6473}new TTL_5944: bitstring;
                                                    {6474}let gNs_5945: bitstring = exp(g,Ns_5942) in
                                                    {6475}let m2_5946: bitstring = (OpenSecureChannelResponse,gNs_5945,ST_5943,TTL_5944) in
                                                    {6476}out(c, (enc(m2_5946,pkCli_5889),sign(h(m2_5946),skSess_5886)));
                                                    {6477}let Ksrv_5947: bitstring = exp(PartC_5941,Ns_5942) in
                                                    {6478}out(c, senc(mSrv(pkCli_5889,pkSess_5887),Ksrv_5947))
                                    )
                                    else
                                        {6479}let pkDisco_5948: bitstring = fail-any in
                                        {6480}in(c, (=pkCli_5889,em1_5949: bitstring,sigM1_5950: bitstring));
                                        {6481}let m1_5951: bitstring = dec(em1_5949,skSess_5886) in
                                        {6482}if (verify(h(m1_5951),sigM1_5950,pkCli_5889) <> true) then
                                            0
                                        else
                                            {6483}let (=OpenSecureChannelRequest,=pkCli_5889,PartC_5952: bitstring) = m1_5951 in
                                            {6484}new Ns_5953: bitstring;
                                            {6485}new ST_5954: bitstring;
                                            {6486}new TTL_5955: bitstring;
                                            {6487}let gNs_5956: bitstring = exp(g,Ns_5953) in
                                            {6488}let m2_5957: bitstring = (OpenSecureChannelResponse,gNs_5956,ST_5954,TTL_5955) in
                                            {6489}out(c, (enc(m2_5957,pkCli_5889),sign(h(m2_5957),skSess_5886)));
                                            {6490}let Ksrv_5958: bitstring = exp(PartC_5952,Ns_5953) in
                                            {6491}out(c, senc(mSrv(pkCli_5889,pkSess_5887),Ksrv_5958))
                            )
                            else
                                {6492}let pkDisco_5959: bitstring = fail-any in
                                {6493}in(c, (=pkCli_5889,em1_5960: bitstring,sigM1_5961: bitstring));
                                {6494}let m1_5962: bitstring = dec(em1_5960,skSess_5886) in
                                {6495}if (verify(h(m1_5962),sigM1_5961,pkCli_5889) <> true) then
                                    0
                                else
                                    {6496}let (=OpenSecureChannelRequest,=pkCli_5889,PartC_5963: bitstring) = m1_5962 in
                                    {6497}new Ns_5964: bitstring;
                                    {6498}new ST_5965: bitstring;
                                    {6499}new TTL_5966: bitstring;
                                    {6500}let gNs_5967: bitstring = exp(g,Ns_5964) in
                                    {6501}let m2_5968: bitstring = (OpenSecureChannelResponse,gNs_5967,ST_5965,TTL_5966) in
                                    {6502}out(c, (enc(m2_5968,pkCli_5889),sign(h(m2_5968),skSess_5886)));
                                    {6503}let Ksrv_5969: bitstring = exp(PartC_5963,Ns_5964) in
                                    {6504}out(c, senc(mSrv(pkCli_5889,pkSess_5887),Ksrv_5969))
                        )
                        else
                            {6505}let v_5970: bool = (Cli_5316 = B) in
                            (
                                {6506}if v_5970 then
                                (
                                    {6507}let pkCli_5971: bitstring = pub(skB) in
                                    {6508}let v_5972: bool = (Disco_5317 = A) in
                                    (
                                        {6509}if v_5972 then
                                        (
                                            {6510}let pkDisco_5973: bitstring = pub(skA) in
                                            {6511}in(c, (=pkCli_5971,em1_5974: bitstring,sigM1_5975: bitstring));
                                            {6512}let m1_5976: bitstring = dec(em1_5974,skSess_5886) in
                                            {6513}if (verify(h(m1_5976),sigM1_5975,pkCli_5971) <> true) then
                                                0
                                            else
                                                {6514}let (=OpenSecureChannelRequest,=pkCli_5971,PartC_5977: bitstring) = m1_5976 in
                                                {6515}new Ns_5978: bitstring;
                                                {6516}new ST_5979: bitstring;
                                                {6517}new TTL_5980: bitstring;
                                                {6518}let gNs_5981: bitstring = exp(g,Ns_5978) in
                                                {6519}let m2_5982: bitstring = (OpenSecureChannelResponse,gNs_5981,ST_5979,TTL_5980) in
                                                {6520}out(c, (enc(m2_5982,pkCli_5971),sign(h(m2_5982),skSess_5886)));
                                                {6521}let Ksrv_5983: bitstring = exp(PartC_5977,Ns_5978) in
                                                {6522}out(c, senc(mSrv(pkCli_5971,pkSess_5887),Ksrv_5983))
                                        )
                                        else
                                            {6523}let v_5984: bool = (Disco_5317 = B) in
                                            (
                                                {6524}if v_5984 then
                                                (
                                                    {6525}let pkDisco_5985: bitstring = pub(skB) in
                                                    {6526}in(c, (=pkCli_5971,em1_5986: bitstring,sigM1_5987: bitstring));
                                                    {6527}let m1_5988: bitstring = dec(em1_5986,skSess_5886) in
                                                    {6528}if (verify(h(m1_5988),sigM1_5987,pkCli_5971) <> true) then
                                                        0
                                                    else
                                                        {6529}let (=OpenSecureChannelRequest,=pkCli_5971,PartC_5989: bitstring) = m1_5988 in
                                                        {6530}new Ns_5990: bitstring;
                                                        {6531}new ST_5991: bitstring;
                                                        {6532}new TTL_5992: bitstring;
                                                        {6533}let gNs_5993: bitstring = exp(g,Ns_5990) in
                                                        {6534}let m2_5994: bitstring = (OpenSecureChannelResponse,gNs_5993,ST_5991,TTL_5992) in
                                                        {6535}out(c, (enc(m2_5994,pkCli_5971),sign(h(m2_5994),skSess_5886)));
                                                        {6536}let Ksrv_5995: bitstring = exp(PartC_5989,Ns_5990) in
                                                        {6537}out(c, senc(mSrv(pkCli_5971,pkSess_5887),Ksrv_5995))
                                                )
                                                else
                                                    {6538}let v_5996: bool = (Disco_5317 = C) in
                                                    (
                                                        {6539}if v_5996 then
                                                        (
                                                            {6540}let pkDisco_5997: bitstring = pub(skC) in
                                                            {6541}in(c, (=pkCli_5971,em1_5998: bitstring,sigM1_5999: bitstring));
                                                            {6542}let m1_6000: bitstring = dec(em1_5998,skSess_5886) in
                                                            {6543}if (verify(h(m1_6000),sigM1_5999,pkCli_5971) <> true) then
                                                                0
                                                            else
                                                                {6544}let (=OpenSecureChannelRequest,=pkCli_5971,PartC_6001: bitstring) = m1_6000 in
                                                                {6545}new Ns_6002: bitstring;
                                                                {6546}new ST_6003: bitstring;
                                                                {6547}new TTL_6004: bitstring;
                                                                {6548}let gNs_6005: bitstring = exp(g,Ns_6002) in
                                                                {6549}let m2_6006: bitstring = (OpenSecureChannelResponse,gNs_6005,ST_6003,TTL_6004) in
                                                                {6550}out(c, (enc(m2_6006,pkCli_5971),sign(h(m2_6006),skSess_5886)));
                                                                {6551}let Ksrv_6007: bitstring = exp(PartC_6001,Ns_6002) in
                                                                {6552}out(c, senc(mSrv(pkCli_5971,pkSess_5887),Ksrv_6007))
                                                        )
                                                        else
                                                            {6553}let pkDisco_6008: bitstring = pub(sk(Disco_5317)) in
                                                            {6554}in(c, (=pkCli_5971,em1_6009: bitstring,sigM1_6010: bitstring));
                                                            {6555}let m1_6011: bitstring = dec(em1_6009,skSess_5886) in
                                                            {6556}if (verify(h(m1_6011),sigM1_6010,pkCli_5971) <> true) then
                                                                0
                                                            else
                                                                {6557}let (=OpenSecureChannelRequest,=pkCli_5971,PartC_6012: bitstring) = m1_6011 in
                                                                {6558}new Ns_6013: bitstring;
                                                                {6559}new ST_6014: bitstring;
                                                                {6560}new TTL_6015: bitstring;
                                                                {6561}let gNs_6016: bitstring = exp(g,Ns_6013) in
                                                                {6562}let m2_6017: bitstring = (OpenSecureChannelResponse,gNs_6016,ST_6014,TTL_6015) in
                                                                {6563}out(c, (enc(m2_6017,pkCli_5971),sign(h(m2_6017),skSess_5886)));
                                                                {6564}let Ksrv_6018: bitstring = exp(PartC_6012,Ns_6013) in
                                                                {6565}out(c, senc(mSrv(pkCli_5971,pkSess_5887),Ksrv_6018))
                                                    )
                                                    else
                                                        {6566}let pkDisco_6019: bitstring = fail-any in
                                                        {6567}in(c, (=pkCli_5971,em1_6020: bitstring,sigM1_6021: bitstring));
                                                        {6568}let m1_6022: bitstring = dec(em1_6020,skSess_5886) in
                                                        {6569}if (verify(h(m1_6022),sigM1_6021,pkCli_5971) <> true) then
                                                            0
                                                        else
                                                            {6570}let (=OpenSecureChannelRequest,=pkCli_5971,PartC_6023: bitstring) = m1_6022 in
                                                            {6571}new Ns_6024: bitstring;
                                                            {6572}new ST_6025: bitstring;
                                                            {6573}new TTL_6026: bitstring;
                                                            {6574}let gNs_6027: bitstring = exp(g,Ns_6024) in
                                                            {6575}let m2_6028: bitstring = (OpenSecureChannelResponse,gNs_6027,ST_6025,TTL_6026) in
                                                            {6576}out(c, (enc(m2_6028,pkCli_5971),sign(h(m2_6028),skSess_5886)));
                                                            {6577}let Ksrv_6029: bitstring = exp(PartC_6023,Ns_6024) in
                                                            {6578}out(c, senc(mSrv(pkCli_5971,pkSess_5887),Ksrv_6029))
                                            )
                                            else
                                                {6579}let pkDisco_6030: bitstring = fail-any in
                                                {6580}in(c, (=pkCli_5971,em1_6031: bitstring,sigM1_6032: bitstring));
                                                {6581}let m1_6033: bitstring = dec(em1_6031,skSess_5886) in
                                                {6582}if (verify(h(m1_6033),sigM1_6032,pkCli_5971) <> true) then
                                                    0
                                                else
                                                    {6583}let (=OpenSecureChannelRequest,=pkCli_5971,PartC_6034: bitstring) = m1_6033 in
                                                    {6584}new Ns_6035: bitstring;
                                                    {6585}new ST_6036: bitstring;
                                                    {6586}new TTL_6037: bitstring;
                                                    {6587}let gNs_6038: bitstring = exp(g,Ns_6035) in
                                                    {6588}let m2_6039: bitstring = (OpenSecureChannelResponse,gNs_6038,ST_6036,TTL_6037) in
                                                    {6589}out(c, (enc(m2_6039,pkCli_5971),sign(h(m2_6039),skSess_5886)));
                                                    {6590}let Ksrv_6040: bitstring = exp(PartC_6034,Ns_6035) in
                                                    {6591}out(c, senc(mSrv(pkCli_5971,pkSess_5887),Ksrv_6040))
                                    )
                                    else
                                        {6592}let pkDisco_6041: bitstring = fail-any in
                                        {6593}in(c, (=pkCli_5971,em1_6042: bitstring,sigM1_6043: bitstring));
                                        {6594}let m1_6044: bitstring = dec(em1_6042,skSess_5886) in
                                        {6595}if (verify(h(m1_6044),sigM1_6043,pkCli_5971) <> true) then
                                            0
                                        else
                                            {6596}let (=OpenSecureChannelRequest,=pkCli_5971,PartC_6045: bitstring) = m1_6044 in
                                            {6597}new Ns_6046: bitstring;
                                            {6598}new ST_6047: bitstring;
                                            {6599}new TTL_6048: bitstring;
                                            {6600}let gNs_6049: bitstring = exp(g,Ns_6046) in
                                            {6601}let m2_6050: bitstring = (OpenSecureChannelResponse,gNs_6049,ST_6047,TTL_6048) in
                                            {6602}out(c, (enc(m2_6050,pkCli_5971),sign(h(m2_6050),skSess_5886)));
                                            {6603}let Ksrv_6051: bitstring = exp(PartC_6045,Ns_6046) in
                                            {6604}out(c, senc(mSrv(pkCli_5971,pkSess_5887),Ksrv_6051))
                                )
                                else
                                    {6605}let v_6052: bool = (Cli_5316 = C) in
                                    (
                                        {6606}if v_6052 then
                                        (
                                            {6607}let pkCli_6053: bitstring = pub(skC) in
                                            {6608}let v_6054: bool = (Disco_5317 = A) in
                                            (
                                                {6609}if v_6054 then
                                                (
                                                    {6610}let pkDisco_6055: bitstring = pub(skA) in
                                                    {6611}in(c, (=pkCli_6053,em1_6056: bitstring,sigM1_6057: bitstring));
                                                    {6612}let m1_6058: bitstring = dec(em1_6056,skSess_5886) in
                                                    {6613}if (verify(h(m1_6058),sigM1_6057,pkCli_6053) <> true) then
                                                        0
                                                    else
                                                        {6614}let (=OpenSecureChannelRequest,=pkCli_6053,PartC_6059: bitstring) = m1_6058 in
                                                        {6615}new Ns_6060: bitstring;
                                                        {6616}new ST_6061: bitstring;
                                                        {6617}new TTL_6062: bitstring;
                                                        {6618}let gNs_6063: bitstring = exp(g,Ns_6060) in
                                                        {6619}let m2_6064: bitstring = (OpenSecureChannelResponse,gNs_6063,ST_6061,TTL_6062) in
                                                        {6620}out(c, (enc(m2_6064,pkCli_6053),sign(h(m2_6064),skSess_5886)));
                                                        {6621}let Ksrv_6065: bitstring = exp(PartC_6059,Ns_6060) in
                                                        {6622}out(c, senc(mSrv(pkCli_6053,pkSess_5887),Ksrv_6065))
                                                )
                                                else
                                                    {6623}let v_6066: bool = (Disco_5317 = B) in
                                                    (
                                                        {6624}if v_6066 then
                                                        (
                                                            {6625}let pkDisco_6067: bitstring = pub(skB) in
                                                            {6626}in(c, (=pkCli_6053,em1_6068: bitstring,sigM1_6069: bitstring));
                                                            {6627}let m1_6070: bitstring = dec(em1_6068,skSess_5886) in
                                                            {6628}if (verify(h(m1_6070),sigM1_6069,pkCli_6053) <> true) then
                                                                0
                                                            else
                                                                {6629}let (=OpenSecureChannelRequest,=pkCli_6053,PartC_6071: bitstring) = m1_6070 in
                                                                {6630}new Ns_6072: bitstring;
                                                                {6631}new ST_6073: bitstring;
                                                                {6632}new TTL_6074: bitstring;
                                                                {6633}let gNs_6075: bitstring = exp(g,Ns_6072) in
                                                                {6634}let m2_6076: bitstring = (OpenSecureChannelResponse,gNs_6075,ST_6073,TTL_6074) in
                                                                {6635}out(c, (enc(m2_6076,pkCli_6053),sign(h(m2_6076),skSess_5886)));
                                                                {6636}let Ksrv_6077: bitstring = exp(PartC_6071,Ns_6072) in
                                                                {6637}out(c, senc(mSrv(pkCli_6053,pkSess_5887),Ksrv_6077))
                                                        )
                                                        else
                                                            {6638}let v_6078: bool = (Disco_5317 = C) in
                                                            (
                                                                {6639}if v_6078 then
                                                                (
                                                                    {6640}let pkDisco_6079: bitstring = pub(skC) in
                                                                    {6641}in(c, (=pkCli_6053,em1_6080: bitstring,sigM1_6081: bitstring));
                                                                    {6642}let m1_6082: bitstring = dec(em1_6080,skSess_5886) in
                                                                    {6643}if (verify(h(m1_6082),sigM1_6081,pkCli_6053) <> true) then
                                                                        0
                                                                    else
                                                                        {6644}let (=OpenSecureChannelRequest,=pkCli_6053,PartC_6083: bitstring) = m1_6082 in
                                                                        {6645}new Ns_6084: bitstring;
                                                                        {6646}new ST_6085: bitstring;
                                                                        {6647}new TTL_6086: bitstring;
                                                                        {6648}let gNs_6087: bitstring = exp(g,Ns_6084) in
                                                                        {6649}let m2_6088: bitstring = (OpenSecureChannelResponse,gNs_6087,ST_6085,TTL_6086) in
                                                                        {6650}out(c, (enc(m2_6088,pkCli_6053),sign(h(m2_6088),skSess_5886)));
                                                                        {6651}let Ksrv_6089: bitstring = exp(PartC_6083,Ns_6084) in
                                                                        {6652}out(c, senc(mSrv(pkCli_6053,pkSess_5887),Ksrv_6089))
                                                                )
                                                                else
                                                                    {6653}let pkDisco_6090: bitstring = pub(sk(Disco_5317)) in
                                                                    {6654}in(c, (=pkCli_6053,em1_6091: bitstring,sigM1_6092: bitstring));
                                                                    {6655}let m1_6093: bitstring = dec(em1_6091,skSess_5886) in
                                                                    {6656}if (verify(h(m1_6093),sigM1_6092,pkCli_6053) <> true) then
                                                                        0
                                                                    else
                                                                        {6657}let (=OpenSecureChannelRequest,=pkCli_6053,PartC_6094: bitstring) = m1_6093 in
                                                                        {6658}new Ns_6095: bitstring;
                                                                        {6659}new ST_6096: bitstring;
                                                                        {6660}new TTL_6097: bitstring;
                                                                        {6661}let gNs_6098: bitstring = exp(g,Ns_6095) in
                                                                        {6662}let m2_6099: bitstring = (OpenSecureChannelResponse,gNs_6098,ST_6096,TTL_6097) in
                                                                        {6663}out(c, (enc(m2_6099,pkCli_6053),sign(h(m2_6099),skSess_5886)));
                                                                        {6664}let Ksrv_6100: bitstring = exp(PartC_6094,Ns_6095) in
                                                                        {6665}out(c, senc(mSrv(pkCli_6053,pkSess_5887),Ksrv_6100))
                                                            )
                                                            else
                                                                {6666}let pkDisco_6101: bitstring = fail-any in
                                                                {6667}in(c, (=pkCli_6053,em1_6102: bitstring,sigM1_6103: bitstring));
                                                                {6668}let m1_6104: bitstring = dec(em1_6102,skSess_5886) in
                                                                {6669}if (verify(h(m1_6104),sigM1_6103,pkCli_6053) <> true) then
                                                                    0
                                                                else
                                                                    {6670}let (=OpenSecureChannelRequest,=pkCli_6053,PartC_6105: bitstring) = m1_6104 in
                                                                    {6671}new Ns_6106: bitstring;
                                                                    {6672}new ST_6107: bitstring;
                                                                    {6673}new TTL_6108: bitstring;
                                                                    {6674}let gNs_6109: bitstring = exp(g,Ns_6106) in
                                                                    {6675}let m2_6110: bitstring = (OpenSecureChannelResponse,gNs_6109,ST_6107,TTL_6108) in
                                                                    {6676}out(c, (enc(m2_6110,pkCli_6053),sign(h(m2_6110),skSess_5886)));
                                                                    {6677}let Ksrv_6111: bitstring = exp(PartC_6105,Ns_6106) in
                                                                    {6678}out(c, senc(mSrv(pkCli_6053,pkSess_5887),Ksrv_6111))
                                                    )
                                                    else
                                                        {6679}let pkDisco_6112: bitstring = fail-any in
                                                        {6680}in(c, (=pkCli_6053,em1_6113: bitstring,sigM1_6114: bitstring));
                                                        {6681}let m1_6115: bitstring = dec(em1_6113,skSess_5886) in
                                                        {6682}if (verify(h(m1_6115),sigM1_6114,pkCli_6053) <> true) then
                                                            0
                                                        else
                                                            {6683}let (=OpenSecureChannelRequest,=pkCli_6053,PartC_6116: bitstring) = m1_6115 in
                                                            {6684}new Ns_6117: bitstring;
                                                            {6685}new ST_6118: bitstring;
                                                            {6686}new TTL_6119: bitstring;
                                                            {6687}let gNs_6120: bitstring = exp(g,Ns_6117) in
                                                            {6688}let m2_6121: bitstring = (OpenSecureChannelResponse,gNs_6120,ST_6118,TTL_6119) in
                                                            {6689}out(c, (enc(m2_6121,pkCli_6053),sign(h(m2_6121),skSess_5886)));
                                                            {6690}let Ksrv_6122: bitstring = exp(PartC_6116,Ns_6117) in
                                                            {6691}out(c, senc(mSrv(pkCli_6053,pkSess_5887),Ksrv_6122))
                                            )
                                            else
                                                {6692}let pkDisco_6123: bitstring = fail-any in
                                                {6693}in(c, (=pkCli_6053,em1_6124: bitstring,sigM1_6125: bitstring));
                                                {6694}let m1_6126: bitstring = dec(em1_6124,skSess_5886) in
                                                {6695}if (verify(h(m1_6126),sigM1_6125,pkCli_6053) <> true) then
                                                    0
                                                else
                                                    {6696}let (=OpenSecureChannelRequest,=pkCli_6053,PartC_6127: bitstring) = m1_6126 in
                                                    {6697}new Ns_6128: bitstring;
                                                    {6698}new ST_6129: bitstring;
                                                    {6699}new TTL_6130: bitstring;
                                                    {6700}let gNs_6131: bitstring = exp(g,Ns_6128) in
                                                    {6701}let m2_6132: bitstring = (OpenSecureChannelResponse,gNs_6131,ST_6129,TTL_6130) in
                                                    {6702}out(c, (enc(m2_6132,pkCli_6053),sign(h(m2_6132),skSess_5886)));
                                                    {6703}let Ksrv_6133: bitstring = exp(PartC_6127,Ns_6128) in
                                                    {6704}out(c, senc(mSrv(pkCli_6053,pkSess_5887),Ksrv_6133))
                                        )
                                        else
                                            {6705}let pkCli_6134: bitstring = pub(sk(Cli_5316)) in
                                            {6706}let v_6135: bool = (Disco_5317 = A) in
                                            (
                                                {6707}if v_6135 then
                                                (
                                                    {6708}let pkDisco_6136: bitstring = pub(skA) in
                                                    {6709}in(c, (=pkCli_6134,em1_6137: bitstring,sigM1_6138: bitstring));
                                                    {6710}let m1_6139: bitstring = dec(em1_6137,skSess_5886) in
                                                    {6711}if (verify(h(m1_6139),sigM1_6138,pkCli_6134) <> true) then
                                                        0
                                                    else
                                                        {6712}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6140: bitstring) = m1_6139 in
                                                        {6713}new Ns_6141: bitstring;
                                                        {6714}new ST_6142: bitstring;
                                                        {6715}new TTL_6143: bitstring;
                                                        {6716}let gNs_6144: bitstring = exp(g,Ns_6141) in
                                                        {6717}let m2_6145: bitstring = (OpenSecureChannelResponse,gNs_6144,ST_6142,TTL_6143) in
                                                        {6718}out(c, (enc(m2_6145,pkCli_6134),sign(h(m2_6145),skSess_5886)));
                                                        {6719}let Ksrv_6146: bitstring = exp(PartC_6140,Ns_6141) in
                                                        {6720}out(c, senc(mSrv(pkCli_6134,pkSess_5887),Ksrv_6146))
                                                )
                                                else
                                                    {6721}let v_6147: bool = (Disco_5317 = B) in
                                                    (
                                                        {6722}if v_6147 then
                                                        (
                                                            {6723}let pkDisco_6148: bitstring = pub(skB) in
                                                            {6724}in(c, (=pkCli_6134,em1_6149: bitstring,sigM1_6150: bitstring));
                                                            {6725}let m1_6151: bitstring = dec(em1_6149,skSess_5886) in
                                                            {6726}if (verify(h(m1_6151),sigM1_6150,pkCli_6134) <> true) then
                                                                0
                                                            else
                                                                {6727}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6152: bitstring) = m1_6151 in
                                                                {6728}new Ns_6153: bitstring;
                                                                {6729}new ST_6154: bitstring;
                                                                {6730}new TTL_6155: bitstring;
                                                                {6731}let gNs_6156: bitstring = exp(g,Ns_6153) in
                                                                {6732}let m2_6157: bitstring = (OpenSecureChannelResponse,gNs_6156,ST_6154,TTL_6155) in
                                                                {6733}out(c, (enc(m2_6157,pkCli_6134),sign(h(m2_6157),skSess_5886)));
                                                                {6734}let Ksrv_6158: bitstring = exp(PartC_6152,Ns_6153) in
                                                                {6735}out(c, senc(mSrv(pkCli_6134,pkSess_5887),Ksrv_6158))
                                                        )
                                                        else
                                                            {6736}let v_6159: bool = (Disco_5317 = C) in
                                                            (
                                                                {6737}if v_6159 then
                                                                (
                                                                    {6738}let pkDisco_6160: bitstring = pub(skC) in
                                                                    {6739}in(c, (=pkCli_6134,em1_6161: bitstring,sigM1_6162: bitstring));
                                                                    {6740}let m1_6163: bitstring = dec(em1_6161,skSess_5886) in
                                                                    {6741}if (verify(h(m1_6163),sigM1_6162,pkCli_6134) <> true) then
                                                                        0
                                                                    else
                                                                        {6742}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6164: bitstring) = m1_6163 in
                                                                        {6743}new Ns_6165: bitstring;
                                                                        {6744}new ST_6166: bitstring;
                                                                        {6745}new TTL_6167: bitstring;
                                                                        {6746}let gNs_6168: bitstring = exp(g,Ns_6165) in
                                                                        {6747}let m2_6169: bitstring = (OpenSecureChannelResponse,gNs_6168,ST_6166,TTL_6167) in
                                                                        {6748}out(c, (enc(m2_6169,pkCli_6134),sign(h(m2_6169),skSess_5886)));
                                                                        {6749}let Ksrv_6170: bitstring = exp(PartC_6164,Ns_6165) in
                                                                        {6750}out(c, senc(mSrv(pkCli_6134,pkSess_5887),Ksrv_6170))
                                                                )
                                                                else
                                                                    {6751}let pkDisco_6171: bitstring = pub(sk(Disco_5317)) in
                                                                    {6752}in(c, (=pkCli_6134,em1_6172: bitstring,sigM1_6173: bitstring));
                                                                    {6753}let m1_6174: bitstring = dec(em1_6172,skSess_5886) in
                                                                    {6754}if (verify(h(m1_6174),sigM1_6173,pkCli_6134) <> true) then
                                                                        0
                                                                    else
                                                                        {6755}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6175: bitstring) = m1_6174 in
                                                                        {6756}new Ns_6176: bitstring;
                                                                        {6757}new ST_6177: bitstring;
                                                                        {6758}new TTL_6178: bitstring;
                                                                        {6759}let gNs_6179: bitstring = exp(g,Ns_6176) in
                                                                        {6760}let m2_6180: bitstring = (OpenSecureChannelResponse,gNs_6179,ST_6177,TTL_6178) in
                                                                        {6761}out(c, (enc(m2_6180,pkCli_6134),sign(h(m2_6180),skSess_5886)));
                                                                        {6762}let Ksrv_6181: bitstring = exp(PartC_6175,Ns_6176) in
                                                                        {6763}out(c, senc(mSrv(pkCli_6134,pkSess_5887),Ksrv_6181))
                                                            )
                                                            else
                                                                {6764}let pkDisco_6182: bitstring = fail-any in
                                                                {6765}in(c, (=pkCli_6134,em1_6183: bitstring,sigM1_6184: bitstring));
                                                                {6766}let m1_6185: bitstring = dec(em1_6183,skSess_5886) in
                                                                {6767}if (verify(h(m1_6185),sigM1_6184,pkCli_6134) <> true) then
                                                                    0
                                                                else
                                                                    {6768}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6186: bitstring) = m1_6185 in
                                                                    {6769}new Ns_6187: bitstring;
                                                                    {6770}new ST_6188: bitstring;
                                                                    {6771}new TTL_6189: bitstring;
                                                                    {6772}let gNs_6190: bitstring = exp(g,Ns_6187) in
                                                                    {6773}let m2_6191: bitstring = (OpenSecureChannelResponse,gNs_6190,ST_6188,TTL_6189) in
                                                                    {6774}out(c, (enc(m2_6191,pkCli_6134),sign(h(m2_6191),skSess_5886)));
                                                                    {6775}let Ksrv_6192: bitstring = exp(PartC_6186,Ns_6187) in
                                                                    {6776}out(c, senc(mSrv(pkCli_6134,pkSess_5887),Ksrv_6192))
                                                    )
                                                    else
                                                        {6777}let pkDisco_6193: bitstring = fail-any in
                                                        {6778}in(c, (=pkCli_6134,em1_6194: bitstring,sigM1_6195: bitstring));
                                                        {6779}let m1_6196: bitstring = dec(em1_6194,skSess_5886) in
                                                        {6780}if (verify(h(m1_6196),sigM1_6195,pkCli_6134) <> true) then
                                                            0
                                                        else
                                                            {6781}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6197: bitstring) = m1_6196 in
                                                            {6782}new Ns_6198: bitstring;
                                                            {6783}new ST_6199: bitstring;
                                                            {6784}new TTL_6200: bitstring;
                                                            {6785}let gNs_6201: bitstring = exp(g,Ns_6198) in
                                                            {6786}let m2_6202: bitstring = (OpenSecureChannelResponse,gNs_6201,ST_6199,TTL_6200) in
                                                            {6787}out(c, (enc(m2_6202,pkCli_6134),sign(h(m2_6202),skSess_5886)));
                                                            {6788}let Ksrv_6203: bitstring = exp(PartC_6197,Ns_6198) in
                                                            {6789}out(c, senc(mSrv(pkCli_6134,pkSess_5887),Ksrv_6203))
                                            )
                                            else
                                                {6790}let pkDisco_6204: bitstring = fail-any in
                                                {6791}in(c, (=pkCli_6134,em1_6205: bitstring,sigM1_6206: bitstring));
                                                {6792}let m1_6207: bitstring = dec(em1_6205,skSess_5886) in
                                                {6793}if (verify(h(m1_6207),sigM1_6206,pkCli_6134) <> true) then
                                                    0
                                                else
                                                    {6794}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6208: bitstring) = m1_6207 in
                                                    {6795}new Ns_6209: bitstring;
                                                    {6796}new ST_6210: bitstring;
                                                    {6797}new TTL_6211: bitstring;
                                                    {6798}let gNs_6212: bitstring = exp(g,Ns_6209) in
                                                    {6799}let m2_6213: bitstring = (OpenSecureChannelResponse,gNs_6212,ST_6210,TTL_6211) in
                                                    {6800}out(c, (enc(m2_6213,pkCli_6134),sign(h(m2_6213),skSess_5886)));
                                                    {6801}let Ksrv_6214: bitstring = exp(PartC_6208,Ns_6209) in
                                                    {6802}out(c, senc(mSrv(pkCli_6134,pkSess_5887),Ksrv_6214))
                                    )
                                    else
                                        {6803}let pkCli_6215: bitstring = fail-any in
                                        {6804}let v_6216: bool = (Disco_5317 = A) in
                                        (
                                            {6805}if v_6216 then
                                            (
                                                {6806}let pkDisco_6217: bitstring = pub(skA) in
                                                {6807}in(c, (=pkCli_6215,em1_6218: bitstring,sigM1_6219: bitstring));
                                                {6808}let m1_6220: bitstring = dec(em1_6218,skSess_5886) in
                                                {6809}if (verify(h(m1_6220),sigM1_6219,pkCli_6215) <> true) then
                                                    0
                                                else
                                                    {6810}let (=OpenSecureChannelRequest,=pkCli_6215,PartC_6221: bitstring) = m1_6220 in
                                                    {6811}new Ns_6222: bitstring;
                                                    {6812}new ST_6223: bitstring;
                                                    {6813}new TTL_6224: bitstring;
                                                    {6814}let gNs_6225: bitstring = exp(g,Ns_6222) in
                                                    {6815}let m2_6226: bitstring = (OpenSecureChannelResponse,gNs_6225,ST_6223,TTL_6224) in
                                                    {6816}out(c, (enc(m2_6226,pkCli_6215),sign(h(m2_6226),skSess_5886)));
                                                    {6817}let Ksrv_6227: bitstring = exp(PartC_6221,Ns_6222) in
                                                    {6818}out(c, senc(mSrv(pkCli_6215,pkSess_5887),Ksrv_6227))
                                            )
                                            else
                                                {6819}let v_6228: bool = (Disco_5317 = B) in
                                                (
                                                    {6820}if v_6228 then
                                                    (
                                                        {6821}let pkDisco_6229: bitstring = pub(skB) in
                                                        {6822}in(c, (=pkCli_6215,em1_6230: bitstring,sigM1_6231: bitstring));
                                                        {6823}let m1_6232: bitstring = dec(em1_6230,skSess_5886) in
                                                        {6824}if (verify(h(m1_6232),sigM1_6231,pkCli_6215) <> true) then
                                                            0
                                                        else
                                                            {6825}let (=OpenSecureChannelRequest,=pkCli_6215,PartC_6233: bitstring) = m1_6232 in
                                                            {6826}new Ns_6234: bitstring;
                                                            {6827}new ST_6235: bitstring;
                                                            {6828}new TTL_6236: bitstring;
                                                            {6829}let gNs_6237: bitstring = exp(g,Ns_6234) in
                                                            {6830}let m2_6238: bitstring = (OpenSecureChannelResponse,gNs_6237,ST_6235,TTL_6236) in
                                                            {6831}out(c, (enc(m2_6238,pkCli_6215),sign(h(m2_6238),skSess_5886)));
                                                            {6832}let Ksrv_6239: bitstring = exp(PartC_6233,Ns_6234) in
                                                            {6833}out(c, senc(mSrv(pkCli_6215,pkSess_5887),Ksrv_6239))
                                                    )
                                                    else
                                                        {6834}let v_6240: bool = (Disco_5317 = C) in
                                                        (
                                                            {6835}if v_6240 then
                                                            (
                                                                {6836}let pkDisco_6241: bitstring = pub(skC) in
                                                                {6837}in(c, (=pkCli_6215,em1_6242: bitstring,sigM1_6243: bitstring));
                                                                {6838}let m1_6244: bitstring = dec(em1_6242,skSess_5886) in
                                                                {6839}if (verify(h(m1_6244),sigM1_6243,pkCli_6215) <> true) then
                                                                    0
                                                                else
                                                                    {6840}let (=OpenSecureChannelRequest,=pkCli_6215,PartC_6245: bitstring) = m1_6244 in
                                                                    {6841}new Ns_6246: bitstring;
                                                                    {6842}new ST_6247: bitstring;
                                                                    {6843}new TTL_6248: bitstring;
                                                                    {6844}let gNs_6249: bitstring = exp(g,Ns_6246) in
                                                                    {6845}let m2_6250: bitstring = (OpenSecureChannelResponse,gNs_6249,ST_6247,TTL_6248) in
                                                                    {6846}out(c, (enc(m2_6250,pkCli_6215),sign(h(m2_6250),skSess_5886)));
                                                                    {6847}let Ksrv_6251: bitstring = exp(PartC_6245,Ns_6246) in
                                                                    {6848}out(c, senc(mSrv(pkCli_6215,pkSess_5887),Ksrv_6251))
                                                            )
                                                            else
                                                                {6849}let pkDisco_6252: bitstring = pub(sk(Disco_5317)) in
                                                                {6850}in(c, (=pkCli_6215,em1_6253: bitstring,sigM1_6254: bitstring));
                                                                {6851}let m1_6255: bitstring = dec(em1_6253,skSess_5886) in
                                                                {6852}if (verify(h(m1_6255),sigM1_6254,pkCli_6215) <> true) then
                                                                    0
                                                                else
                                                                    {6853}let (=OpenSecureChannelRequest,=pkCli_6215,PartC_6256: bitstring) = m1_6255 in
                                                                    {6854}new Ns_6257: bitstring;
                                                                    {6855}new ST_6258: bitstring;
                                                                    {6856}new TTL_6259: bitstring;
                                                                    {6857}let gNs_6260: bitstring = exp(g,Ns_6257) in
                                                                    {6858}let m2_6261: bitstring = (OpenSecureChannelResponse,gNs_6260,ST_6258,TTL_6259) in
                                                                    {6859}out(c, (enc(m2_6261,pkCli_6215),sign(h(m2_6261),skSess_5886)));
                                                                    {6860}let Ksrv_6262: bitstring = exp(PartC_6256,Ns_6257) in
                                                                    {6861}out(c, senc(mSrv(pkCli_6215,pkSess_5887),Ksrv_6262))
                                                        )
                                                        else
                                                            {6862}let pkDisco_6263: bitstring = fail-any in
                                                            {6863}in(c, (=pkCli_6215,em1_6264: bitstring,sigM1_6265: bitstring));
                                                            {6864}let m1_6266: bitstring = dec(em1_6264,skSess_5886) in
                                                            {6865}if (verify(h(m1_6266),sigM1_6265,pkCli_6215) <> true) then
                                                                0
                                                            else
                                                                {6866}let (=OpenSecureChannelRequest,=pkCli_6215,PartC_6267: bitstring) = m1_6266 in
                                                                {6867}new Ns_6268: bitstring;
                                                                {6868}new ST_6269: bitstring;
                                                                {6869}new TTL_6270: bitstring;
                                                                {6870}let gNs_6271: bitstring = exp(g,Ns_6268) in
                                                                {6871}let m2_6272: bitstring = (OpenSecureChannelResponse,gNs_6271,ST_6269,TTL_6270) in
                                                                {6872}out(c, (enc(m2_6272,pkCli_6215),sign(h(m2_6272),skSess_5886)));
                                                                {6873}let Ksrv_6273: bitstring = exp(PartC_6267,Ns_6268) in
                                                                {6874}out(c, senc(mSrv(pkCli_6215,pkSess_5887),Ksrv_6273))
                                                )
                                                else
                                                    {6875}let pkDisco_6274: bitstring = fail-any in
                                                    {6876}in(c, (=pkCli_6215,em1_6275: bitstring,sigM1_6276: bitstring));
                                                    {6877}let m1_6277: bitstring = dec(em1_6275,skSess_5886) in
                                                    {6878}if (verify(h(m1_6277),sigM1_6276,pkCli_6215) <> true) then
                                                        0
                                                    else
                                                        {6879}let (=OpenSecureChannelRequest,=pkCli_6215,PartC_6278: bitstring) = m1_6277 in
                                                        {6880}new Ns_6279: bitstring;
                                                        {6881}new ST_6280: bitstring;
                                                        {6882}new TTL_6281: bitstring;
                                                        {6883}let gNs_6282: bitstring = exp(g,Ns_6279) in
                                                        {6884}let m2_6283: bitstring = (OpenSecureChannelResponse,gNs_6282,ST_6280,TTL_6281) in
                                                        {6885}out(c, (enc(m2_6283,pkCli_6215),sign(h(m2_6283),skSess_5886)));
                                                        {6886}let Ksrv_6284: bitstring = exp(PartC_6278,Ns_6279) in
                                                        {6887}out(c, senc(mSrv(pkCli_6215,pkSess_5887),Ksrv_6284))
                                        )
                                        else
                                            {6888}let pkDisco_6285: bitstring = fail-any in
                                            {6889}in(c, (=pkCli_6215,em1_6286: bitstring,sigM1_6287: bitstring));
                                            {6890}let m1_6288: bitstring = dec(em1_6286,skSess_5886) in
                                            {6891}if (verify(h(m1_6288),sigM1_6287,pkCli_6215) <> true) then
                                                0
                                            else
                                                {6892}let (=OpenSecureChannelRequest,=pkCli_6215,PartC_6289: bitstring) = m1_6288 in
                                                {6893}new Ns_6290: bitstring;
                                                {6894}new ST_6291: bitstring;
                                                {6895}new TTL_6292: bitstring;
                                                {6896}let gNs_6293: bitstring = exp(g,Ns_6290) in
                                                {6897}let m2_6294: bitstring = (OpenSecureChannelResponse,gNs_6293,ST_6291,TTL_6292) in
                                                {6898}out(c, (enc(m2_6294,pkCli_6215),sign(h(m2_6294),skSess_5886)));
                                                {6899}let Ksrv_6295: bitstring = exp(PartC_6289,Ns_6290) in
                                                {6900}out(c, senc(mSrv(pkCli_6215,pkSess_5887),Ksrv_6295))
                            )
                            else
                                {6901}let pkCli_6296: bitstring = fail-any in
                                {6902}let v_6297: bool = (Disco_5317 = A) in
                                (
                                    {6903}if v_6297 then
                                    (
                                        {6904}let pkDisco_6298: bitstring = pub(skA) in
                                        {6905}in(c, (=pkCli_6296,em1_6299: bitstring,sigM1_6300: bitstring));
                                        {6906}let m1_6301: bitstring = dec(em1_6299,skSess_5886) in
                                        {6907}if (verify(h(m1_6301),sigM1_6300,pkCli_6296) <> true) then
                                            0
                                        else
                                            {6908}let (=OpenSecureChannelRequest,=pkCli_6296,PartC_6302: bitstring) = m1_6301 in
                                            {6909}new Ns_6303: bitstring;
                                            {6910}new ST_6304: bitstring;
                                            {6911}new TTL_6305: bitstring;
                                            {6912}let gNs_6306: bitstring = exp(g,Ns_6303) in
                                            {6913}let m2_6307: bitstring = (OpenSecureChannelResponse,gNs_6306,ST_6304,TTL_6305) in
                                            {6914}out(c, (enc(m2_6307,pkCli_6296),sign(h(m2_6307),skSess_5886)));
                                            {6915}let Ksrv_6308: bitstring = exp(PartC_6302,Ns_6303) in
                                            {6916}out(c, senc(mSrv(pkCli_6296,pkSess_5887),Ksrv_6308))
                                    )
                                    else
                                        {6917}let v_6309: bool = (Disco_5317 = B) in
                                        (
                                            {6918}if v_6309 then
                                            (
                                                {6919}let pkDisco_6310: bitstring = pub(skB) in
                                                {6920}in(c, (=pkCli_6296,em1_6311: bitstring,sigM1_6312: bitstring));
                                                {6921}let m1_6313: bitstring = dec(em1_6311,skSess_5886) in
                                                {6922}if (verify(h(m1_6313),sigM1_6312,pkCli_6296) <> true) then
                                                    0
                                                else
                                                    {6923}let (=OpenSecureChannelRequest,=pkCli_6296,PartC_6314: bitstring) = m1_6313 in
                                                    {6924}new Ns_6315: bitstring;
                                                    {6925}new ST_6316: bitstring;
                                                    {6926}new TTL_6317: bitstring;
                                                    {6927}let gNs_6318: bitstring = exp(g,Ns_6315) in
                                                    {6928}let m2_6319: bitstring = (OpenSecureChannelResponse,gNs_6318,ST_6316,TTL_6317) in
                                                    {6929}out(c, (enc(m2_6319,pkCli_6296),sign(h(m2_6319),skSess_5886)));
                                                    {6930}let Ksrv_6320: bitstring = exp(PartC_6314,Ns_6315) in
                                                    {6931}out(c, senc(mSrv(pkCli_6296,pkSess_5887),Ksrv_6320))
                                            )
                                            else
                                                {6932}let v_6321: bool = (Disco_5317 = C) in
                                                (
                                                    {6933}if v_6321 then
                                                    (
                                                        {6934}let pkDisco_6322: bitstring = pub(skC) in
                                                        {6935}in(c, (=pkCli_6296,em1_6323: bitstring,sigM1_6324: bitstring));
                                                        {6936}let m1_6325: bitstring = dec(em1_6323,skSess_5886) in
                                                        {6937}if (verify(h(m1_6325),sigM1_6324,pkCli_6296) <> true) then
                                                            0
                                                        else
                                                            {6938}let (=OpenSecureChannelRequest,=pkCli_6296,PartC_6326: bitstring) = m1_6325 in
                                                            {6939}new Ns_6327: bitstring;
                                                            {6940}new ST_6328: bitstring;
                                                            {6941}new TTL_6329: bitstring;
                                                            {6942}let gNs_6330: bitstring = exp(g,Ns_6327) in
                                                            {6943}let m2_6331: bitstring = (OpenSecureChannelResponse,gNs_6330,ST_6328,TTL_6329) in
                                                            {6944}out(c, (enc(m2_6331,pkCli_6296),sign(h(m2_6331),skSess_5886)));
                                                            {6945}let Ksrv_6332: bitstring = exp(PartC_6326,Ns_6327) in
                                                            {6946}out(c, senc(mSrv(pkCli_6296,pkSess_5887),Ksrv_6332))
                                                    )
                                                    else
                                                        {6947}let pkDisco_6333: bitstring = pub(sk(Disco_5317)) in
                                                        {6948}in(c, (=pkCli_6296,em1_6334: bitstring,sigM1_6335: bitstring));
                                                        {6949}let m1_6336: bitstring = dec(em1_6334,skSess_5886) in
                                                        {6950}if (verify(h(m1_6336),sigM1_6335,pkCli_6296) <> true) then
                                                            0
                                                        else
                                                            {6951}let (=OpenSecureChannelRequest,=pkCli_6296,PartC_6337: bitstring) = m1_6336 in
                                                            {6952}new Ns_6338: bitstring;
                                                            {6953}new ST_6339: bitstring;
                                                            {6954}new TTL_6340: bitstring;
                                                            {6955}let gNs_6341: bitstring = exp(g,Ns_6338) in
                                                            {6956}let m2_6342: bitstring = (OpenSecureChannelResponse,gNs_6341,ST_6339,TTL_6340) in
                                                            {6957}out(c, (enc(m2_6342,pkCli_6296),sign(h(m2_6342),skSess_5886)));
                                                            {6958}let Ksrv_6343: bitstring = exp(PartC_6337,Ns_6338) in
                                                            {6959}out(c, senc(mSrv(pkCli_6296,pkSess_5887),Ksrv_6343))
                                                )
                                                else
                                                    {6960}let pkDisco_6344: bitstring = fail-any in
                                                    {6961}in(c, (=pkCli_6296,em1_6345: bitstring,sigM1_6346: bitstring));
                                                    {6962}let m1_6347: bitstring = dec(em1_6345,skSess_5886) in
                                                    {6963}if (verify(h(m1_6347),sigM1_6346,pkCli_6296) <> true) then
                                                        0
                                                    else
                                                        {6964}let (=OpenSecureChannelRequest,=pkCli_6296,PartC_6348: bitstring) = m1_6347 in
                                                        {6965}new Ns_6349: bitstring;
                                                        {6966}new ST_6350: bitstring;
                                                        {6967}new TTL_6351: bitstring;
                                                        {6968}let gNs_6352: bitstring = exp(g,Ns_6349) in
                                                        {6969}let m2_6353: bitstring = (OpenSecureChannelResponse,gNs_6352,ST_6350,TTL_6351) in
                                                        {6970}out(c, (enc(m2_6353,pkCli_6296),sign(h(m2_6353),skSess_5886)));
                                                        {6971}let Ksrv_6354: bitstring = exp(PartC_6348,Ns_6349) in
                                                        {6972}out(c, senc(mSrv(pkCli_6296,pkSess_5887),Ksrv_6354))
                                        )
                                        else
                                            {6973}let pkDisco_6355: bitstring = fail-any in
                                            {6974}in(c, (=pkCli_6296,em1_6356: bitstring,sigM1_6357: bitstring));
                                            {6975}let m1_6358: bitstring = dec(em1_6356,skSess_5886) in
                                            {6976}if (verify(h(m1_6358),sigM1_6357,pkCli_6296) <> true) then
                                                0
                                            else
                                                {6977}let (=OpenSecureChannelRequest,=pkCli_6296,PartC_6359: bitstring) = m1_6358 in
                                                {6978}new Ns_6360: bitstring;
                                                {6979}new ST_6361: bitstring;
                                                {6980}new TTL_6362: bitstring;
                                                {6981}let gNs_6363: bitstring = exp(g,Ns_6360) in
                                                {6982}let m2_6364: bitstring = (OpenSecureChannelResponse,gNs_6363,ST_6361,TTL_6362) in
                                                {6983}out(c, (enc(m2_6364,pkCli_6296),sign(h(m2_6364),skSess_5886)));
                                                {6984}let Ksrv_6365: bitstring = exp(PartC_6359,Ns_6360) in
                                                {6985}out(c, senc(mSrv(pkCli_6296,pkSess_5887),Ksrv_6365))
                                )
                                else
                                    {6986}let pkDisco_6366: bitstring = fail-any in
                                    {6987}in(c, (=pkCli_6296,em1_6367: bitstring,sigM1_6368: bitstring));
                                    {6988}let m1_6369: bitstring = dec(em1_6367,skSess_5886) in
                                    {6989}if (verify(h(m1_6369),sigM1_6368,pkCli_6296) <> true) then
                                        0
                                    else
                                        {6990}let (=OpenSecureChannelRequest,=pkCli_6296,PartC_6370: bitstring) = m1_6369 in
                                        {6991}new Ns_6371: bitstring;
                                        {6992}new ST_6372: bitstring;
                                        {6993}new TTL_6373: bitstring;
                                        {6994}let gNs_6374: bitstring = exp(g,Ns_6371) in
                                        {6995}let m2_6375: bitstring = (OpenSecureChannelResponse,gNs_6374,ST_6372,TTL_6373) in
                                        {6996}out(c, (enc(m2_6375,pkCli_6296),sign(h(m2_6375),skSess_5886)));
                                        {6997}let Ksrv_6376: bitstring = exp(PartC_6370,Ns_6371) in
                                        {6998}out(c, senc(mSrv(pkCli_6296,pkSess_5887),Ksrv_6376))
                    )
                    else
                        {6999}let pkCli_6377: bitstring = fail-any in
                        {7000}let v_6378: bool = (Disco_5317 = A) in
                        (
                            {7001}if v_6378 then
                            (
                                {7002}let pkDisco_6379: bitstring = pub(skA) in
                                {7003}in(c, (=pkCli_6377,em1_6380: bitstring,sigM1_6381: bitstring));
                                {7004}let m1_6382: bitstring = dec(em1_6380,skSess_5886) in
                                {7005}if (verify(h(m1_6382),sigM1_6381,pkCli_6377) <> true) then
                                    0
                                else
                                    {7006}let (=OpenSecureChannelRequest,=pkCli_6377,PartC_6383: bitstring) = m1_6382 in
                                    {7007}new Ns_6384: bitstring;
                                    {7008}new ST_6385: bitstring;
                                    {7009}new TTL_6386: bitstring;
                                    {7010}let gNs_6387: bitstring = exp(g,Ns_6384) in
                                    {7011}let m2_6388: bitstring = (OpenSecureChannelResponse,gNs_6387,ST_6385,TTL_6386) in
                                    {7012}out(c, (enc(m2_6388,pkCli_6377),sign(h(m2_6388),skSess_5886)));
                                    {7013}let Ksrv_6389: bitstring = exp(PartC_6383,Ns_6384) in
                                    {7014}out(c, senc(mSrv(pkCli_6377,pkSess_5887),Ksrv_6389))
                            )
                            else
                                {7015}let v_6390: bool = (Disco_5317 = B) in
                                (
                                    {7016}if v_6390 then
                                    (
                                        {7017}let pkDisco_6391: bitstring = pub(skB) in
                                        {7018}in(c, (=pkCli_6377,em1_6392: bitstring,sigM1_6393: bitstring));
                                        {7019}let m1_6394: bitstring = dec(em1_6392,skSess_5886) in
                                        {7020}if (verify(h(m1_6394),sigM1_6393,pkCli_6377) <> true) then
                                            0
                                        else
                                            {7021}let (=OpenSecureChannelRequest,=pkCli_6377,PartC_6395: bitstring) = m1_6394 in
                                            {7022}new Ns_6396: bitstring;
                                            {7023}new ST_6397: bitstring;
                                            {7024}new TTL_6398: bitstring;
                                            {7025}let gNs_6399: bitstring = exp(g,Ns_6396) in
                                            {7026}let m2_6400: bitstring = (OpenSecureChannelResponse,gNs_6399,ST_6397,TTL_6398) in
                                            {7027}out(c, (enc(m2_6400,pkCli_6377),sign(h(m2_6400),skSess_5886)));
                                            {7028}let Ksrv_6401: bitstring = exp(PartC_6395,Ns_6396) in
                                            {7029}out(c, senc(mSrv(pkCli_6377,pkSess_5887),Ksrv_6401))
                                    )
                                    else
                                        {7030}let v_6402: bool = (Disco_5317 = C) in
                                        (
                                            {7031}if v_6402 then
                                            (
                                                {7032}let pkDisco_6403: bitstring = pub(skC) in
                                                {7033}in(c, (=pkCli_6377,em1_6404: bitstring,sigM1_6405: bitstring));
                                                {7034}let m1_6406: bitstring = dec(em1_6404,skSess_5886) in
                                                {7035}if (verify(h(m1_6406),sigM1_6405,pkCli_6377) <> true) then
                                                    0
                                                else
                                                    {7036}let (=OpenSecureChannelRequest,=pkCli_6377,PartC_6407: bitstring) = m1_6406 in
                                                    {7037}new Ns_6408: bitstring;
                                                    {7038}new ST_6409: bitstring;
                                                    {7039}new TTL_6410: bitstring;
                                                    {7040}let gNs_6411: bitstring = exp(g,Ns_6408) in
                                                    {7041}let m2_6412: bitstring = (OpenSecureChannelResponse,gNs_6411,ST_6409,TTL_6410) in
                                                    {7042}out(c, (enc(m2_6412,pkCli_6377),sign(h(m2_6412),skSess_5886)));
                                                    {7043}let Ksrv_6413: bitstring = exp(PartC_6407,Ns_6408) in
                                                    {7044}out(c, senc(mSrv(pkCli_6377,pkSess_5887),Ksrv_6413))
                                            )
                                            else
                                                {7045}let pkDisco_6414: bitstring = pub(sk(Disco_5317)) in
                                                {7046}in(c, (=pkCli_6377,em1_6415: bitstring,sigM1_6416: bitstring));
                                                {7047}let m1_6417: bitstring = dec(em1_6415,skSess_5886) in
                                                {7048}if (verify(h(m1_6417),sigM1_6416,pkCli_6377) <> true) then
                                                    0
                                                else
                                                    {7049}let (=OpenSecureChannelRequest,=pkCli_6377,PartC_6418: bitstring) = m1_6417 in
                                                    {7050}new Ns_6419: bitstring;
                                                    {7051}new ST_6420: bitstring;
                                                    {7052}new TTL_6421: bitstring;
                                                    {7053}let gNs_6422: bitstring = exp(g,Ns_6419) in
                                                    {7054}let m2_6423: bitstring = (OpenSecureChannelResponse,gNs_6422,ST_6420,TTL_6421) in
                                                    {7055}out(c, (enc(m2_6423,pkCli_6377),sign(h(m2_6423),skSess_5886)));
                                                    {7056}let Ksrv_6424: bitstring = exp(PartC_6418,Ns_6419) in
                                                    {7057}out(c, senc(mSrv(pkCli_6377,pkSess_5887),Ksrv_6424))
                                        )
                                        else
                                            {7058}let pkDisco_6425: bitstring = fail-any in
                                            {7059}in(c, (=pkCli_6377,em1_6426: bitstring,sigM1_6427: bitstring));
                                            {7060}let m1_6428: bitstring = dec(em1_6426,skSess_5886) in
                                            {7061}if (verify(h(m1_6428),sigM1_6427,pkCli_6377) <> true) then
                                                0
                                            else
                                                {7062}let (=OpenSecureChannelRequest,=pkCli_6377,PartC_6429: bitstring) = m1_6428 in
                                                {7063}new Ns_6430: bitstring;
                                                {7064}new ST_6431: bitstring;
                                                {7065}new TTL_6432: bitstring;
                                                {7066}let gNs_6433: bitstring = exp(g,Ns_6430) in
                                                {7067}let m2_6434: bitstring = (OpenSecureChannelResponse,gNs_6433,ST_6431,TTL_6432) in
                                                {7068}out(c, (enc(m2_6434,pkCli_6377),sign(h(m2_6434),skSess_5886)));
                                                {7069}let Ksrv_6435: bitstring = exp(PartC_6429,Ns_6430) in
                                                {7070}out(c, senc(mSrv(pkCli_6377,pkSess_5887),Ksrv_6435))
                                )
                                else
                                    {7071}let pkDisco_6436: bitstring = fail-any in
                                    {7072}in(c, (=pkCli_6377,em1_6437: bitstring,sigM1_6438: bitstring));
                                    {7073}let m1_6439: bitstring = dec(em1_6437,skSess_5886) in
                                    {7074}if (verify(h(m1_6439),sigM1_6438,pkCli_6377) <> true) then
                                        0
                                    else
                                        {7075}let (=OpenSecureChannelRequest,=pkCli_6377,PartC_6440: bitstring) = m1_6439 in
                                        {7076}new Ns_6441: bitstring;
                                        {7077}new ST_6442: bitstring;
                                        {7078}new TTL_6443: bitstring;
                                        {7079}let gNs_6444: bitstring = exp(g,Ns_6441) in
                                        {7080}let m2_6445: bitstring = (OpenSecureChannelResponse,gNs_6444,ST_6442,TTL_6443) in
                                        {7081}out(c, (enc(m2_6445,pkCli_6377),sign(h(m2_6445),skSess_5886)));
                                        {7082}let Ksrv_6446: bitstring = exp(PartC_6440,Ns_6441) in
                                        {7083}out(c, senc(mSrv(pkCli_6377,pkSess_5887),Ksrv_6446))
                        )
                        else
                            {7084}let pkDisco_6447: bitstring = fail-any in
                            {7085}in(c, (=pkCli_6377,em1_6448: bitstring,sigM1_6449: bitstring));
                            {7086}let m1_6450: bitstring = dec(em1_6448,skSess_5886) in
                            {7087}if (verify(h(m1_6450),sigM1_6449,pkCli_6377) <> true) then
                                0
                            else
                                {7088}let (=OpenSecureChannelRequest,=pkCli_6377,PartC_6451: bitstring) = m1_6450 in
                                {7089}new Ns_6452: bitstring;
                                {7090}new ST_6453: bitstring;
                                {7091}new TTL_6454: bitstring;
                                {7092}let gNs_6455: bitstring = exp(g,Ns_6452) in
                                {7093}let m2_6456: bitstring = (OpenSecureChannelResponse,gNs_6455,ST_6453,TTL_6454) in
                                {7094}out(c, (enc(m2_6456,pkCli_6377),sign(h(m2_6456),skSess_5886)));
                                {7095}let Ksrv_6457: bitstring = exp(PartC_6451,Ns_6452) in
                                {7096}out(c, senc(mSrv(pkCli_6377,pkSess_5887),Ksrv_6457))
                )
                else
                    {7097}let =true = (Sess_5318 = C) in
                    (
                        {7098}let skSess_6458: bitstring = skC in
                        {7099}let pkSess_6459: bitstring = pub(skSess_6458) in
                        {7100}let v_6460: bool = (Cli_5316 = A) in
                        (
                            {7101}if v_6460 then
                            (
                                {7102}let pkCli_6461: bitstring = pub(skA) in
                                {7103}let v_6462: bool = (Disco_5317 = A) in
                                (
                                    {7104}if v_6462 then
                                    (
                                        {7105}let pkDisco_6463: bitstring = pub(skA) in
                                        {7106}in(c, (=pkCli_6461,em1_6464: bitstring,sigM1_6465: bitstring));
                                        {7107}let m1_6466: bitstring = dec(em1_6464,skSess_6458) in
                                        {7108}if (verify(h(m1_6466),sigM1_6465,pkCli_6461) <> true) then
                                            0
                                        else
                                            {7109}let (=OpenSecureChannelRequest,=pkCli_6461,PartC_6467: bitstring) = m1_6466 in
                                            {7110}new Ns_6468: bitstring;
                                            {7111}new ST_6469: bitstring;
                                            {7112}new TTL_6470: bitstring;
                                            {7113}let gNs_6471: bitstring = exp(g,Ns_6468) in
                                            {7114}let m2_6472: bitstring = (OpenSecureChannelResponse,gNs_6471,ST_6469,TTL_6470) in
                                            {7115}out(c, (enc(m2_6472,pkCli_6461),sign(h(m2_6472),skSess_6458)));
                                            {7116}let Ksrv_6473: bitstring = exp(PartC_6467,Ns_6468) in
                                            {7117}out(c, senc(mSrv(pkCli_6461,pkSess_6459),Ksrv_6473))
                                    )
                                    else
                                        {7118}let v_6474: bool = (Disco_5317 = B) in
                                        (
                                            {7119}if v_6474 then
                                            (
                                                {7120}let pkDisco_6475: bitstring = pub(skB) in
                                                {7121}in(c, (=pkCli_6461,em1_6476: bitstring,sigM1_6477: bitstring));
                                                {7122}let m1_6478: bitstring = dec(em1_6476,skSess_6458) in
                                                {7123}if (verify(h(m1_6478),sigM1_6477,pkCli_6461) <> true) then
                                                    0
                                                else
                                                    {7124}let (=OpenSecureChannelRequest,=pkCli_6461,PartC_6479: bitstring) = m1_6478 in
                                                    {7125}new Ns_6480: bitstring;
                                                    {7126}new ST_6481: bitstring;
                                                    {7127}new TTL_6482: bitstring;
                                                    {7128}let gNs_6483: bitstring = exp(g,Ns_6480) in
                                                    {7129}let m2_6484: bitstring = (OpenSecureChannelResponse,gNs_6483,ST_6481,TTL_6482) in
                                                    {7130}out(c, (enc(m2_6484,pkCli_6461),sign(h(m2_6484),skSess_6458)));
                                                    {7131}let Ksrv_6485: bitstring = exp(PartC_6479,Ns_6480) in
                                                    {7132}out(c, senc(mSrv(pkCli_6461,pkSess_6459),Ksrv_6485))
                                            )
                                            else
                                                {7133}let v_6486: bool = (Disco_5317 = C) in
                                                (
                                                    {7134}if v_6486 then
                                                    (
                                                        {7135}let pkDisco_6487: bitstring = pub(skC) in
                                                        {7136}in(c, (=pkCli_6461,em1_6488: bitstring,sigM1_6489: bitstring));
                                                        {7137}let m1_6490: bitstring = dec(em1_6488,skSess_6458) in
                                                        {7138}if (verify(h(m1_6490),sigM1_6489,pkCli_6461) <> true) then
                                                            0
                                                        else
                                                            {7139}let (=OpenSecureChannelRequest,=pkCli_6461,PartC_6491: bitstring) = m1_6490 in
                                                            {7140}new Ns_6492: bitstring;
                                                            {7141}new ST_6493: bitstring;
                                                            {7142}new TTL_6494: bitstring;
                                                            {7143}let gNs_6495: bitstring = exp(g,Ns_6492) in
                                                            {7144}let m2_6496: bitstring = (OpenSecureChannelResponse,gNs_6495,ST_6493,TTL_6494) in
                                                            {7145}out(c, (enc(m2_6496,pkCli_6461),sign(h(m2_6496),skSess_6458)));
                                                            {7146}let Ksrv_6497: bitstring = exp(PartC_6491,Ns_6492) in
                                                            {7147}out(c, senc(mSrv(pkCli_6461,pkSess_6459),Ksrv_6497))
                                                    )
                                                    else
                                                        {7148}let pkDisco_6498: bitstring = pub(sk(Disco_5317)) in
                                                        {7149}in(c, (=pkCli_6461,em1_6499: bitstring,sigM1_6500: bitstring));
                                                        {7150}let m1_6501: bitstring = dec(em1_6499,skSess_6458) in
                                                        {7151}if (verify(h(m1_6501),sigM1_6500,pkCli_6461) <> true) then
                                                            0
                                                        else
                                                            {7152}let (=OpenSecureChannelRequest,=pkCli_6461,PartC_6502: bitstring) = m1_6501 in
                                                            {7153}new Ns_6503: bitstring;
                                                            {7154}new ST_6504: bitstring;
                                                            {7155}new TTL_6505: bitstring;
                                                            {7156}let gNs_6506: bitstring = exp(g,Ns_6503) in
                                                            {7157}let m2_6507: bitstring = (OpenSecureChannelResponse,gNs_6506,ST_6504,TTL_6505) in
                                                            {7158}out(c, (enc(m2_6507,pkCli_6461),sign(h(m2_6507),skSess_6458)));
                                                            {7159}let Ksrv_6508: bitstring = exp(PartC_6502,Ns_6503) in
                                                            {7160}out(c, senc(mSrv(pkCli_6461,pkSess_6459),Ksrv_6508))
                                                )
                                                else
                                                    {7161}let pkDisco_6509: bitstring = fail-any in
                                                    {7162}in(c, (=pkCli_6461,em1_6510: bitstring,sigM1_6511: bitstring));
                                                    {7163}let m1_6512: bitstring = dec(em1_6510,skSess_6458) in
                                                    {7164}if (verify(h(m1_6512),sigM1_6511,pkCli_6461) <> true) then
                                                        0
                                                    else
                                                        {7165}let (=OpenSecureChannelRequest,=pkCli_6461,PartC_6513: bitstring) = m1_6512 in
                                                        {7166}new Ns_6514: bitstring;
                                                        {7167}new ST_6515: bitstring;
                                                        {7168}new TTL_6516: bitstring;
                                                        {7169}let gNs_6517: bitstring = exp(g,Ns_6514) in
                                                        {7170}let m2_6518: bitstring = (OpenSecureChannelResponse,gNs_6517,ST_6515,TTL_6516) in
                                                        {7171}out(c, (enc(m2_6518,pkCli_6461),sign(h(m2_6518),skSess_6458)));
                                                        {7172}let Ksrv_6519: bitstring = exp(PartC_6513,Ns_6514) in
                                                        {7173}out(c, senc(mSrv(pkCli_6461,pkSess_6459),Ksrv_6519))
                                        )
                                        else
                                            {7174}let pkDisco_6520: bitstring = fail-any in
                                            {7175}in(c, (=pkCli_6461,em1_6521: bitstring,sigM1_6522: bitstring));
                                            {7176}let m1_6523: bitstring = dec(em1_6521,skSess_6458) in
                                            {7177}if (verify(h(m1_6523),sigM1_6522,pkCli_6461) <> true) then
                                                0
                                            else
                                                {7178}let (=OpenSecureChannelRequest,=pkCli_6461,PartC_6524: bitstring) = m1_6523 in
                                                {7179}new Ns_6525: bitstring;
                                                {7180}new ST_6526: bitstring;
                                                {7181}new TTL_6527: bitstring;
                                                {7182}let gNs_6528: bitstring = exp(g,Ns_6525) in
                                                {7183}let m2_6529: bitstring = (OpenSecureChannelResponse,gNs_6528,ST_6526,TTL_6527) in
                                                {7184}out(c, (enc(m2_6529,pkCli_6461),sign(h(m2_6529),skSess_6458)));
                                                {7185}let Ksrv_6530: bitstring = exp(PartC_6524,Ns_6525) in
                                                {7186}out(c, senc(mSrv(pkCli_6461,pkSess_6459),Ksrv_6530))
                                )
                                else
                                    {7187}let pkDisco_6531: bitstring = fail-any in
                                    {7188}in(c, (=pkCli_6461,em1_6532: bitstring,sigM1_6533: bitstring));
                                    {7189}let m1_6534: bitstring = dec(em1_6532,skSess_6458) in
                                    {7190}if (verify(h(m1_6534),sigM1_6533,pkCli_6461) <> true) then
                                        0
                                    else
                                        {7191}let (=OpenSecureChannelRequest,=pkCli_6461,PartC_6535: bitstring) = m1_6534 in
                                        {7192}new Ns_6536: bitstring;
                                        {7193}new ST_6537: bitstring;
                                        {7194}new TTL_6538: bitstring;
                                        {7195}let gNs_6539: bitstring = exp(g,Ns_6536) in
                                        {7196}let m2_6540: bitstring = (OpenSecureChannelResponse,gNs_6539,ST_6537,TTL_6538) in
                                        {7197}out(c, (enc(m2_6540,pkCli_6461),sign(h(m2_6540),skSess_6458)));
                                        {7198}let Ksrv_6541: bitstring = exp(PartC_6535,Ns_6536) in
                                        {7199}out(c, senc(mSrv(pkCli_6461,pkSess_6459),Ksrv_6541))
                            )
                            else
                                {7200}let v_6542: bool = (Cli_5316 = B) in
                                (
                                    {7201}if v_6542 then
                                    (
                                        {7202}let pkCli_6543: bitstring = pub(skB) in
                                        {7203}let v_6544: bool = (Disco_5317 = A) in
                                        (
                                            {7204}if v_6544 then
                                            (
                                                {7205}let pkDisco_6545: bitstring = pub(skA) in
                                                {7206}in(c, (=pkCli_6543,em1_6546: bitstring,sigM1_6547: bitstring));
                                                {7207}let m1_6548: bitstring = dec(em1_6546,skSess_6458) in
                                                {7208}if (verify(h(m1_6548),sigM1_6547,pkCli_6543) <> true) then
                                                    0
                                                else
                                                    {7209}let (=OpenSecureChannelRequest,=pkCli_6543,PartC_6549: bitstring) = m1_6548 in
                                                    {7210}new Ns_6550: bitstring;
                                                    {7211}new ST_6551: bitstring;
                                                    {7212}new TTL_6552: bitstring;
                                                    {7213}let gNs_6553: bitstring = exp(g,Ns_6550) in
                                                    {7214}let m2_6554: bitstring = (OpenSecureChannelResponse,gNs_6553,ST_6551,TTL_6552) in
                                                    {7215}out(c, (enc(m2_6554,pkCli_6543),sign(h(m2_6554),skSess_6458)));
                                                    {7216}let Ksrv_6555: bitstring = exp(PartC_6549,Ns_6550) in
                                                    {7217}out(c, senc(mSrv(pkCli_6543,pkSess_6459),Ksrv_6555))
                                            )
                                            else
                                                {7218}let v_6556: bool = (Disco_5317 = B) in
                                                (
                                                    {7219}if v_6556 then
                                                    (
                                                        {7220}let pkDisco_6557: bitstring = pub(skB) in
                                                        {7221}in(c, (=pkCli_6543,em1_6558: bitstring,sigM1_6559: bitstring));
                                                        {7222}let m1_6560: bitstring = dec(em1_6558,skSess_6458) in
                                                        {7223}if (verify(h(m1_6560),sigM1_6559,pkCli_6543) <> true) then
                                                            0
                                                        else
                                                            {7224}let (=OpenSecureChannelRequest,=pkCli_6543,PartC_6561: bitstring) = m1_6560 in
                                                            {7225}new Ns_6562: bitstring;
                                                            {7226}new ST_6563: bitstring;
                                                            {7227}new TTL_6564: bitstring;
                                                            {7228}let gNs_6565: bitstring = exp(g,Ns_6562) in
                                                            {7229}let m2_6566: bitstring = (OpenSecureChannelResponse,gNs_6565,ST_6563,TTL_6564) in
                                                            {7230}out(c, (enc(m2_6566,pkCli_6543),sign(h(m2_6566),skSess_6458)));
                                                            {7231}let Ksrv_6567: bitstring = exp(PartC_6561,Ns_6562) in
                                                            {7232}out(c, senc(mSrv(pkCli_6543,pkSess_6459),Ksrv_6567))
                                                    )
                                                    else
                                                        {7233}let v_6568: bool = (Disco_5317 = C) in
                                                        (
                                                            {7234}if v_6568 then
                                                            (
                                                                {7235}let pkDisco_6569: bitstring = pub(skC) in
                                                                {7236}in(c, (=pkCli_6543,em1_6570: bitstring,sigM1_6571: bitstring));
                                                                {7237}let m1_6572: bitstring = dec(em1_6570,skSess_6458) in
                                                                {7238}if (verify(h(m1_6572),sigM1_6571,pkCli_6543) <> true) then
                                                                    0
                                                                else
                                                                    {7239}let (=OpenSecureChannelRequest,=pkCli_6543,PartC_6573: bitstring) = m1_6572 in
                                                                    {7240}new Ns_6574: bitstring;
                                                                    {7241}new ST_6575: bitstring;
                                                                    {7242}new TTL_6576: bitstring;
                                                                    {7243}let gNs_6577: bitstring = exp(g,Ns_6574) in
                                                                    {7244}let m2_6578: bitstring = (OpenSecureChannelResponse,gNs_6577,ST_6575,TTL_6576) in
                                                                    {7245}out(c, (enc(m2_6578,pkCli_6543),sign(h(m2_6578),skSess_6458)));
                                                                    {7246}let Ksrv_6579: bitstring = exp(PartC_6573,Ns_6574) in
                                                                    {7247}out(c, senc(mSrv(pkCli_6543,pkSess_6459),Ksrv_6579))
                                                            )
                                                            else
                                                                {7248}let pkDisco_6580: bitstring = pub(sk(Disco_5317)) in
                                                                {7249}in(c, (=pkCli_6543,em1_6581: bitstring,sigM1_6582: bitstring));
                                                                {7250}let m1_6583: bitstring = dec(em1_6581,skSess_6458) in
                                                                {7251}if (verify(h(m1_6583),sigM1_6582,pkCli_6543) <> true) then
                                                                    0
                                                                else
                                                                    {7252}let (=OpenSecureChannelRequest,=pkCli_6543,PartC_6584: bitstring) = m1_6583 in
                                                                    {7253}new Ns_6585: bitstring;
                                                                    {7254}new ST_6586: bitstring;
                                                                    {7255}new TTL_6587: bitstring;
                                                                    {7256}let gNs_6588: bitstring = exp(g,Ns_6585) in
                                                                    {7257}let m2_6589: bitstring = (OpenSecureChannelResponse,gNs_6588,ST_6586,TTL_6587) in
                                                                    {7258}out(c, (enc(m2_6589,pkCli_6543),sign(h(m2_6589),skSess_6458)));
                                                                    {7259}let Ksrv_6590: bitstring = exp(PartC_6584,Ns_6585) in
                                                                    {7260}out(c, senc(mSrv(pkCli_6543,pkSess_6459),Ksrv_6590))
                                                        )
                                                        else
                                                            {7261}let pkDisco_6591: bitstring = fail-any in
                                                            {7262}in(c, (=pkCli_6543,em1_6592: bitstring,sigM1_6593: bitstring));
                                                            {7263}let m1_6594: bitstring = dec(em1_6592,skSess_6458) in
                                                            {7264}if (verify(h(m1_6594),sigM1_6593,pkCli_6543) <> true) then
                                                                0
                                                            else
                                                                {7265}let (=OpenSecureChannelRequest,=pkCli_6543,PartC_6595: bitstring) = m1_6594 in
                                                                {7266}new Ns_6596: bitstring;
                                                                {7267}new ST_6597: bitstring;
                                                                {7268}new TTL_6598: bitstring;
                                                                {7269}let gNs_6599: bitstring = exp(g,Ns_6596) in
                                                                {7270}let m2_6600: bitstring = (OpenSecureChannelResponse,gNs_6599,ST_6597,TTL_6598) in
                                                                {7271}out(c, (enc(m2_6600,pkCli_6543),sign(h(m2_6600),skSess_6458)));
                                                                {7272}let Ksrv_6601: bitstring = exp(PartC_6595,Ns_6596) in
                                                                {7273}out(c, senc(mSrv(pkCli_6543,pkSess_6459),Ksrv_6601))
                                                )
                                                else
                                                    {7274}let pkDisco_6602: bitstring = fail-any in
                                                    {7275}in(c, (=pkCli_6543,em1_6603: bitstring,sigM1_6604: bitstring));
                                                    {7276}let m1_6605: bitstring = dec(em1_6603,skSess_6458) in
                                                    {7277}if (verify(h(m1_6605),sigM1_6604,pkCli_6543) <> true) then
                                                        0
                                                    else
                                                        {7278}let (=OpenSecureChannelRequest,=pkCli_6543,PartC_6606: bitstring) = m1_6605 in
                                                        {7279}new Ns_6607: bitstring;
                                                        {7280}new ST_6608: bitstring;
                                                        {7281}new TTL_6609: bitstring;
                                                        {7282}let gNs_6610: bitstring = exp(g,Ns_6607) in
                                                        {7283}let m2_6611: bitstring = (OpenSecureChannelResponse,gNs_6610,ST_6608,TTL_6609) in
                                                        {7284}out(c, (enc(m2_6611,pkCli_6543),sign(h(m2_6611),skSess_6458)));
                                                        {7285}let Ksrv_6612: bitstring = exp(PartC_6606,Ns_6607) in
                                                        {7286}out(c, senc(mSrv(pkCli_6543,pkSess_6459),Ksrv_6612))
                                        )
                                        else
                                            {7287}let pkDisco_6613: bitstring = fail-any in
                                            {7288}in(c, (=pkCli_6543,em1_6614: bitstring,sigM1_6615: bitstring));
                                            {7289}let m1_6616: bitstring = dec(em1_6614,skSess_6458) in
                                            {7290}if (verify(h(m1_6616),sigM1_6615,pkCli_6543) <> true) then
                                                0
                                            else
                                                {7291}let (=OpenSecureChannelRequest,=pkCli_6543,PartC_6617: bitstring) = m1_6616 in
                                                {7292}new Ns_6618: bitstring;
                                                {7293}new ST_6619: bitstring;
                                                {7294}new TTL_6620: bitstring;
                                                {7295}let gNs_6621: bitstring = exp(g,Ns_6618) in
                                                {7296}let m2_6622: bitstring = (OpenSecureChannelResponse,gNs_6621,ST_6619,TTL_6620) in
                                                {7297}out(c, (enc(m2_6622,pkCli_6543),sign(h(m2_6622),skSess_6458)));
                                                {7298}let Ksrv_6623: bitstring = exp(PartC_6617,Ns_6618) in
                                                {7299}out(c, senc(mSrv(pkCli_6543,pkSess_6459),Ksrv_6623))
                                    )
                                    else
                                        {7300}let v_6624: bool = (Cli_5316 = C) in
                                        (
                                            {7301}if v_6624 then
                                            (
                                                {7302}let pkCli_6625: bitstring = pub(skC) in
                                                {7303}let v_6626: bool = (Disco_5317 = A) in
                                                (
                                                    {7304}if v_6626 then
                                                    (
                                                        {7305}let pkDisco_6627: bitstring = pub(skA) in
                                                        {7306}in(c, (=pkCli_6625,em1_6628: bitstring,sigM1_6629: bitstring));
                                                        {7307}let m1_6630: bitstring = dec(em1_6628,skSess_6458) in
                                                        {7308}if (verify(h(m1_6630),sigM1_6629,pkCli_6625) <> true) then
                                                            0
                                                        else
                                                            {7309}let (=OpenSecureChannelRequest,=pkCli_6625,PartC_6631: bitstring) = m1_6630 in
                                                            {7310}new Ns_6632: bitstring;
                                                            {7311}new ST_6633: bitstring;
                                                            {7312}new TTL_6634: bitstring;
                                                            {7313}let gNs_6635: bitstring = exp(g,Ns_6632) in
                                                            {7314}let m2_6636: bitstring = (OpenSecureChannelResponse,gNs_6635,ST_6633,TTL_6634) in
                                                            {7315}out(c, (enc(m2_6636,pkCli_6625),sign(h(m2_6636),skSess_6458)));
                                                            {7316}let Ksrv_6637: bitstring = exp(PartC_6631,Ns_6632) in
                                                            {7317}out(c, senc(mSrv(pkCli_6625,pkSess_6459),Ksrv_6637))
                                                    )
                                                    else
                                                        {7318}let v_6638: bool = (Disco_5317 = B) in
                                                        (
                                                            {7319}if v_6638 then
                                                            (
                                                                {7320}let pkDisco_6639: bitstring = pub(skB) in
                                                                {7321}in(c, (=pkCli_6625,em1_6640: bitstring,sigM1_6641: bitstring));
                                                                {7322}let m1_6642: bitstring = dec(em1_6640,skSess_6458) in
                                                                {7323}if (verify(h(m1_6642),sigM1_6641,pkCli_6625) <> true) then
                                                                    0
                                                                else
                                                                    {7324}let (=OpenSecureChannelRequest,=pkCli_6625,PartC_6643: bitstring) = m1_6642 in
                                                                    {7325}new Ns_6644: bitstring;
                                                                    {7326}new ST_6645: bitstring;
                                                                    {7327}new TTL_6646: bitstring;
                                                                    {7328}let gNs_6647: bitstring = exp(g,Ns_6644) in
                                                                    {7329}let m2_6648: bitstring = (OpenSecureChannelResponse,gNs_6647,ST_6645,TTL_6646) in
                                                                    {7330}out(c, (enc(m2_6648,pkCli_6625),sign(h(m2_6648),skSess_6458)));
                                                                    {7331}let Ksrv_6649: bitstring = exp(PartC_6643,Ns_6644) in
                                                                    {7332}out(c, senc(mSrv(pkCli_6625,pkSess_6459),Ksrv_6649))
                                                            )
                                                            else
                                                                {7333}let v_6650: bool = (Disco_5317 = C) in
                                                                (
                                                                    {7334}if v_6650 then
                                                                    (
                                                                        {7335}let pkDisco_6651: bitstring = pub(skC) in
                                                                        {7336}in(c, (=pkCli_6625,em1_6652: bitstring,sigM1_6653: bitstring));
                                                                        {7337}let m1_6654: bitstring = dec(em1_6652,skSess_6458) in
                                                                        {7338}if (verify(h(m1_6654),sigM1_6653,pkCli_6625) <> true) then
                                                                            0
                                                                        else
                                                                            {7339}let (=OpenSecureChannelRequest,=pkCli_6625,PartC_6655: bitstring) = m1_6654 in
                                                                            {7340}new Ns_6656: bitstring;
                                                                            {7341}new ST_6657: bitstring;
                                                                            {7342}new TTL_6658: bitstring;
                                                                            {7343}let gNs_6659: bitstring = exp(g,Ns_6656) in
                                                                            {7344}let m2_6660: bitstring = (OpenSecureChannelResponse,gNs_6659,ST_6657,TTL_6658) in
                                                                            {7345}out(c, (enc(m2_6660,pkCli_6625),sign(h(m2_6660),skSess_6458)));
                                                                            {7346}let Ksrv_6661: bitstring = exp(PartC_6655,Ns_6656) in
                                                                            {7347}out(c, senc(mSrv(pkCli_6625,pkSess_6459),Ksrv_6661))
                                                                    )
                                                                    else
                                                                        {7348}let pkDisco_6662: bitstring = pub(sk(Disco_5317)) in
                                                                        {7349}in(c, (=pkCli_6625,em1_6663: bitstring,sigM1_6664: bitstring));
                                                                        {7350}let m1_6665: bitstring = dec(em1_6663,skSess_6458) in
                                                                        {7351}if (verify(h(m1_6665),sigM1_6664,pkCli_6625) <> true) then
                                                                            0
                                                                        else
                                                                            {7352}let (=OpenSecureChannelRequest,=pkCli_6625,PartC_6666: bitstring) = m1_6665 in
                                                                            {7353}new Ns_6667: bitstring;
                                                                            {7354}new ST_6668: bitstring;
                                                                            {7355}new TTL_6669: bitstring;
                                                                            {7356}let gNs_6670: bitstring = exp(g,Ns_6667) in
                                                                            {7357}let m2_6671: bitstring = (OpenSecureChannelResponse,gNs_6670,ST_6668,TTL_6669) in
                                                                            {7358}out(c, (enc(m2_6671,pkCli_6625),sign(h(m2_6671),skSess_6458)));
                                                                            {7359}let Ksrv_6672: bitstring = exp(PartC_6666,Ns_6667) in
                                                                            {7360}out(c, senc(mSrv(pkCli_6625,pkSess_6459),Ksrv_6672))
                                                                )
                                                                else
                                                                    {7361}let pkDisco_6673: bitstring = fail-any in
                                                                    {7362}in(c, (=pkCli_6625,em1_6674: bitstring,sigM1_6675: bitstring));
                                                                    {7363}let m1_6676: bitstring = dec(em1_6674,skSess_6458) in
                                                                    {7364}if (verify(h(m1_6676),sigM1_6675,pkCli_6625) <> true) then
                                                                        0
                                                                    else
                                                                        {7365}let (=OpenSecureChannelRequest,=pkCli_6625,PartC_6677: bitstring) = m1_6676 in
                                                                        {7366}new Ns_6678: bitstring;
                                                                        {7367}new ST_6679: bitstring;
                                                                        {7368}new TTL_6680: bitstring;
                                                                        {7369}let gNs_6681: bitstring = exp(g,Ns_6678) in
                                                                        {7370}let m2_6682: bitstring = (OpenSecureChannelResponse,gNs_6681,ST_6679,TTL_6680) in
                                                                        {7371}out(c, (enc(m2_6682,pkCli_6625),sign(h(m2_6682),skSess_6458)));
                                                                        {7372}let Ksrv_6683: bitstring = exp(PartC_6677,Ns_6678) in
                                                                        {7373}out(c, senc(mSrv(pkCli_6625,pkSess_6459),Ksrv_6683))
                                                        )
                                                        else
                                                            {7374}let pkDisco_6684: bitstring = fail-any in
                                                            {7375}in(c, (=pkCli_6625,em1_6685: bitstring,sigM1_6686: bitstring));
                                                            {7376}let m1_6687: bitstring = dec(em1_6685,skSess_6458) in
                                                            {7377}if (verify(h(m1_6687),sigM1_6686,pkCli_6625) <> true) then
                                                                0
                                                            else
                                                                {7378}let (=OpenSecureChannelRequest,=pkCli_6625,PartC_6688: bitstring) = m1_6687 in
                                                                {7379}new Ns_6689: bitstring;
                                                                {7380}new ST_6690: bitstring;
                                                                {7381}new TTL_6691: bitstring;
                                                                {7382}let gNs_6692: bitstring = exp(g,Ns_6689) in
                                                                {7383}let m2_6693: bitstring = (OpenSecureChannelResponse,gNs_6692,ST_6690,TTL_6691) in
                                                                {7384}out(c, (enc(m2_6693,pkCli_6625),sign(h(m2_6693),skSess_6458)));
                                                                {7385}let Ksrv_6694: bitstring = exp(PartC_6688,Ns_6689) in
                                                                {7386}out(c, senc(mSrv(pkCli_6625,pkSess_6459),Ksrv_6694))
                                                )
                                                else
                                                    {7387}let pkDisco_6695: bitstring = fail-any in
                                                    {7388}in(c, (=pkCli_6625,em1_6696: bitstring,sigM1_6697: bitstring));
                                                    {7389}let m1_6698: bitstring = dec(em1_6696,skSess_6458) in
                                                    {7390}if (verify(h(m1_6698),sigM1_6697,pkCli_6625) <> true) then
                                                        0
                                                    else
                                                        {7391}let (=OpenSecureChannelRequest,=pkCli_6625,PartC_6699: bitstring) = m1_6698 in
                                                        {7392}new Ns_6700: bitstring;
                                                        {7393}new ST_6701: bitstring;
                                                        {7394}new TTL_6702: bitstring;
                                                        {7395}let gNs_6703: bitstring = exp(g,Ns_6700) in
                                                        {7396}let m2_6704: bitstring = (OpenSecureChannelResponse,gNs_6703,ST_6701,TTL_6702) in
                                                        {7397}out(c, (enc(m2_6704,pkCli_6625),sign(h(m2_6704),skSess_6458)));
                                                        {7398}let Ksrv_6705: bitstring = exp(PartC_6699,Ns_6700) in
                                                        {7399}out(c, senc(mSrv(pkCli_6625,pkSess_6459),Ksrv_6705))
                                            )
                                            else
                                                {7400}let pkCli_6706: bitstring = pub(sk(Cli_5316)) in
                                                {7401}let v_6707: bool = (Disco_5317 = A) in
                                                (
                                                    {7402}if v_6707 then
                                                    (
                                                        {7403}let pkDisco_6708: bitstring = pub(skA) in
                                                        {7404}in(c, (=pkCli_6706,em1_6709: bitstring,sigM1_6710: bitstring));
                                                        {7405}let m1_6711: bitstring = dec(em1_6709,skSess_6458) in
                                                        {7406}if (verify(h(m1_6711),sigM1_6710,pkCli_6706) <> true) then
                                                            0
                                                        else
                                                            {7407}let (=OpenSecureChannelRequest,=pkCli_6706,PartC_6712: bitstring) = m1_6711 in
                                                            {7408}new Ns_6713: bitstring;
                                                            {7409}new ST_6714: bitstring;
                                                            {7410}new TTL_6715: bitstring;
                                                            {7411}let gNs_6716: bitstring = exp(g,Ns_6713) in
                                                            {7412}let m2_6717: bitstring = (OpenSecureChannelResponse,gNs_6716,ST_6714,TTL_6715) in
                                                            {7413}out(c, (enc(m2_6717,pkCli_6706),sign(h(m2_6717),skSess_6458)));
                                                            {7414}let Ksrv_6718: bitstring = exp(PartC_6712,Ns_6713) in
                                                            {7415}out(c, senc(mSrv(pkCli_6706,pkSess_6459),Ksrv_6718))
                                                    )
                                                    else
                                                        {7416}let v_6719: bool = (Disco_5317 = B) in
                                                        (
                                                            {7417}if v_6719 then
                                                            (
                                                                {7418}let pkDisco_6720: bitstring = pub(skB) in
                                                                {7419}in(c, (=pkCli_6706,em1_6721: bitstring,sigM1_6722: bitstring));
                                                                {7420}let m1_6723: bitstring = dec(em1_6721,skSess_6458) in
                                                                {7421}if (verify(h(m1_6723),sigM1_6722,pkCli_6706) <> true) then
                                                                    0
                                                                else
                                                                    {7422}let (=OpenSecureChannelRequest,=pkCli_6706,PartC_6724: bitstring) = m1_6723 in
                                                                    {7423}new Ns_6725: bitstring;
                                                                    {7424}new ST_6726: bitstring;
                                                                    {7425}new TTL_6727: bitstring;
                                                                    {7426}let gNs_6728: bitstring = exp(g,Ns_6725) in
                                                                    {7427}let m2_6729: bitstring = (OpenSecureChannelResponse,gNs_6728,ST_6726,TTL_6727) in
                                                                    {7428}out(c, (enc(m2_6729,pkCli_6706),sign(h(m2_6729),skSess_6458)));
                                                                    {7429}let Ksrv_6730: bitstring = exp(PartC_6724,Ns_6725) in
                                                                    {7430}out(c, senc(mSrv(pkCli_6706,pkSess_6459),Ksrv_6730))
                                                            )
                                                            else
                                                                {7431}let v_6731: bool = (Disco_5317 = C) in
                                                                (
                                                                    {7432}if v_6731 then
                                                                    (
                                                                        {7433}let pkDisco_6732: bitstring = pub(skC) in
                                                                        {7434}in(c, (=pkCli_6706,em1_6733: bitstring,sigM1_6734: bitstring));
                                                                        {7435}let m1_6735: bitstring = dec(em1_6733,skSess_6458) in
                                                                        {7436}if (verify(h(m1_6735),sigM1_6734,pkCli_6706) <> true) then
                                                                            0
                                                                        else
                                                                            {7437}let (=OpenSecureChannelRequest,=pkCli_6706,PartC_6736: bitstring) = m1_6735 in
                                                                            {7438}new Ns_6737: bitstring;
                                                                            {7439}new ST_6738: bitstring;
                                                                            {7440}new TTL_6739: bitstring;
                                                                            {7441}let gNs_6740: bitstring = exp(g,Ns_6737) in
                                                                            {7442}let m2_6741: bitstring = (OpenSecureChannelResponse,gNs_6740,ST_6738,TTL_6739) in
                                                                            {7443}out(c, (enc(m2_6741,pkCli_6706),sign(h(m2_6741),skSess_6458)));
                                                                            {7444}let Ksrv_6742: bitstring = exp(PartC_6736,Ns_6737) in
                                                                            {7445}out(c, senc(mSrv(pkCli_6706,pkSess_6459),Ksrv_6742))
                                                                    )
                                                                    else
                                                                        {7446}let pkDisco_6743: bitstring = pub(sk(Disco_5317)) in
                                                                        {7447}in(c, (=pkCli_6706,em1_6744: bitstring,sigM1_6745: bitstring));
                                                                        {7448}let m1_6746: bitstring = dec(em1_6744,skSess_6458) in
                                                                        {7449}if (verify(h(m1_6746),sigM1_6745,pkCli_6706) <> true) then
                                                                            0
                                                                        else
                                                                            {7450}let (=OpenSecureChannelRequest,=pkCli_6706,PartC_6747: bitstring) = m1_6746 in
                                                                            {7451}new Ns_6748: bitstring;
                                                                            {7452}new ST_6749: bitstring;
                                                                            {7453}new TTL_6750: bitstring;
                                                                            {7454}let gNs_6751: bitstring = exp(g,Ns_6748) in
                                                                            {7455}let m2_6752: bitstring = (OpenSecureChannelResponse,gNs_6751,ST_6749,TTL_6750) in
                                                                            {7456}out(c, (enc(m2_6752,pkCli_6706),sign(h(m2_6752),skSess_6458)));
                                                                            {7457}let Ksrv_6753: bitstring = exp(PartC_6747,Ns_6748) in
                                                                            {7458}out(c, senc(mSrv(pkCli_6706,pkSess_6459),Ksrv_6753))
                                                                )
                                                                else
                                                                    {7459}let pkDisco_6754: bitstring = fail-any in
                                                                    {7460}in(c, (=pkCli_6706,em1_6755: bitstring,sigM1_6756: bitstring));
                                                                    {7461}let m1_6757: bitstring = dec(em1_6755,skSess_6458) in
                                                                    {7462}if (verify(h(m1_6757),sigM1_6756,pkCli_6706) <> true) then
                                                                        0
                                                                    else
                                                                        {7463}let (=OpenSecureChannelRequest,=pkCli_6706,PartC_6758: bitstring) = m1_6757 in
                                                                        {7464}new Ns_6759: bitstring;
                                                                        {7465}new ST_6760: bitstring;
                                                                        {7466}new TTL_6761: bitstring;
                                                                        {7467}let gNs_6762: bitstring = exp(g,Ns_6759) in
                                                                        {7468}let m2_6763: bitstring = (OpenSecureChannelResponse,gNs_6762,ST_6760,TTL_6761) in
                                                                        {7469}out(c, (enc(m2_6763,pkCli_6706),sign(h(m2_6763),skSess_6458)));
                                                                        {7470}let Ksrv_6764: bitstring = exp(PartC_6758,Ns_6759) in
                                                                        {7471}out(c, senc(mSrv(pkCli_6706,pkSess_6459),Ksrv_6764))
                                                        )
                                                        else
                                                            {7472}let pkDisco_6765: bitstring = fail-any in
                                                            {7473}in(c, (=pkCli_6706,em1_6766: bitstring,sigM1_6767: bitstring));
                                                            {7474}let m1_6768: bitstring = dec(em1_6766,skSess_6458) in
                                                            {7475}if (verify(h(m1_6768),sigM1_6767,pkCli_6706) <> true) then
                                                                0
                                                            else
                                                                {7476}let (=OpenSecureChannelRequest,=pkCli_6706,PartC_6769: bitstring) = m1_6768 in
                                                                {7477}new Ns_6770: bitstring;
                                                                {7478}new ST_6771: bitstring;
                                                                {7479}new TTL_6772: bitstring;
                                                                {7480}let gNs_6773: bitstring = exp(g,Ns_6770) in
                                                                {7481}let m2_6774: bitstring = (OpenSecureChannelResponse,gNs_6773,ST_6771,TTL_6772) in
                                                                {7482}out(c, (enc(m2_6774,pkCli_6706),sign(h(m2_6774),skSess_6458)));
                                                                {7483}let Ksrv_6775: bitstring = exp(PartC_6769,Ns_6770) in
                                                                {7484}out(c, senc(mSrv(pkCli_6706,pkSess_6459),Ksrv_6775))
                                                )
                                                else
                                                    {7485}let pkDisco_6776: bitstring = fail-any in
                                                    {7486}in(c, (=pkCli_6706,em1_6777: bitstring,sigM1_6778: bitstring));
                                                    {7487}let m1_6779: bitstring = dec(em1_6777,skSess_6458) in
                                                    {7488}if (verify(h(m1_6779),sigM1_6778,pkCli_6706) <> true) then
                                                        0
                                                    else
                                                        {7489}let (=OpenSecureChannelRequest,=pkCli_6706,PartC_6780: bitstring) = m1_6779 in
                                                        {7490}new Ns_6781: bitstring;
                                                        {7491}new ST_6782: bitstring;
                                                        {7492}new TTL_6783: bitstring;
                                                        {7493}let gNs_6784: bitstring = exp(g,Ns_6781) in
                                                        {7494}let m2_6785: bitstring = (OpenSecureChannelResponse,gNs_6784,ST_6782,TTL_6783) in
                                                        {7495}out(c, (enc(m2_6785,pkCli_6706),sign(h(m2_6785),skSess_6458)));
                                                        {7496}let Ksrv_6786: bitstring = exp(PartC_6780,Ns_6781) in
                                                        {7497}out(c, senc(mSrv(pkCli_6706,pkSess_6459),Ksrv_6786))
                                        )
                                        else
                                            {7498}let pkCli_6787: bitstring = fail-any in
                                            {7499}let v_6788: bool = (Disco_5317 = A) in
                                            (
                                                {7500}if v_6788 then
                                                (
                                                    {7501}let pkDisco_6789: bitstring = pub(skA) in
                                                    {7502}in(c, (=pkCli_6787,em1_6790: bitstring,sigM1_6791: bitstring));
                                                    {7503}let m1_6792: bitstring = dec(em1_6790,skSess_6458) in
                                                    {7504}if (verify(h(m1_6792),sigM1_6791,pkCli_6787) <> true) then
                                                        0
                                                    else
                                                        {7505}let (=OpenSecureChannelRequest,=pkCli_6787,PartC_6793: bitstring) = m1_6792 in
                                                        {7506}new Ns_6794: bitstring;
                                                        {7507}new ST_6795: bitstring;
                                                        {7508}new TTL_6796: bitstring;
                                                        {7509}let gNs_6797: bitstring = exp(g,Ns_6794) in
                                                        {7510}let m2_6798: bitstring = (OpenSecureChannelResponse,gNs_6797,ST_6795,TTL_6796) in
                                                        {7511}out(c, (enc(m2_6798,pkCli_6787),sign(h(m2_6798),skSess_6458)));
                                                        {7512}let Ksrv_6799: bitstring = exp(PartC_6793,Ns_6794) in
                                                        {7513}out(c, senc(mSrv(pkCli_6787,pkSess_6459),Ksrv_6799))
                                                )
                                                else
                                                    {7514}let v_6800: bool = (Disco_5317 = B) in
                                                    (
                                                        {7515}if v_6800 then
                                                        (
                                                            {7516}let pkDisco_6801: bitstring = pub(skB) in
                                                            {7517}in(c, (=pkCli_6787,em1_6802: bitstring,sigM1_6803: bitstring));
                                                            {7518}let m1_6804: bitstring = dec(em1_6802,skSess_6458) in
                                                            {7519}if (verify(h(m1_6804),sigM1_6803,pkCli_6787) <> true) then
                                                                0
                                                            else
                                                                {7520}let (=OpenSecureChannelRequest,=pkCli_6787,PartC_6805: bitstring) = m1_6804 in
                                                                {7521}new Ns_6806: bitstring;
                                                                {7522}new ST_6807: bitstring;
                                                                {7523}new TTL_6808: bitstring;
                                                                {7524}let gNs_6809: bitstring = exp(g,Ns_6806) in
                                                                {7525}let m2_6810: bitstring = (OpenSecureChannelResponse,gNs_6809,ST_6807,TTL_6808) in
                                                                {7526}out(c, (enc(m2_6810,pkCli_6787),sign(h(m2_6810),skSess_6458)));
                                                                {7527}let Ksrv_6811: bitstring = exp(PartC_6805,Ns_6806) in
                                                                {7528}out(c, senc(mSrv(pkCli_6787,pkSess_6459),Ksrv_6811))
                                                        )
                                                        else
                                                            {7529}let v_6812: bool = (Disco_5317 = C) in
                                                            (
                                                                {7530}if v_6812 then
                                                                (
                                                                    {7531}let pkDisco_6813: bitstring = pub(skC) in
                                                                    {7532}in(c, (=pkCli_6787,em1_6814: bitstring,sigM1_6815: bitstring));
                                                                    {7533}let m1_6816: bitstring = dec(em1_6814,skSess_6458) in
                                                                    {7534}if (verify(h(m1_6816),sigM1_6815,pkCli_6787) <> true) then
                                                                        0
                                                                    else
                                                                        {7535}let (=OpenSecureChannelRequest,=pkCli_6787,PartC_6817: bitstring) = m1_6816 in
                                                                        {7536}new Ns_6818: bitstring;
                                                                        {7537}new ST_6819: bitstring;
                                                                        {7538}new TTL_6820: bitstring;
                                                                        {7539}let gNs_6821: bitstring = exp(g,Ns_6818) in
                                                                        {7540}let m2_6822: bitstring = (OpenSecureChannelResponse,gNs_6821,ST_6819,TTL_6820) in
                                                                        {7541}out(c, (enc(m2_6822,pkCli_6787),sign(h(m2_6822),skSess_6458)));
                                                                        {7542}let Ksrv_6823: bitstring = exp(PartC_6817,Ns_6818) in
                                                                        {7543}out(c, senc(mSrv(pkCli_6787,pkSess_6459),Ksrv_6823))
                                                                )
                                                                else
                                                                    {7544}let pkDisco_6824: bitstring = pub(sk(Disco_5317)) in
                                                                    {7545}in(c, (=pkCli_6787,em1_6825: bitstring,sigM1_6826: bitstring));
                                                                    {7546}let m1_6827: bitstring = dec(em1_6825,skSess_6458) in
                                                                    {7547}if (verify(h(m1_6827),sigM1_6826,pkCli_6787) <> true) then
                                                                        0
                                                                    else
                                                                        {7548}let (=OpenSecureChannelRequest,=pkCli_6787,PartC_6828: bitstring) = m1_6827 in
                                                                        {7549}new Ns_6829: bitstring;
                                                                        {7550}new ST_6830: bitstring;
                                                                        {7551}new TTL_6831: bitstring;
                                                                        {7552}let gNs_6832: bitstring = exp(g,Ns_6829) in
                                                                        {7553}let m2_6833: bitstring = (OpenSecureChannelResponse,gNs_6832,ST_6830,TTL_6831) in
                                                                        {7554}out(c, (enc(m2_6833,pkCli_6787),sign(h(m2_6833),skSess_6458)));
                                                                        {7555}let Ksrv_6834: bitstring = exp(PartC_6828,Ns_6829) in
                                                                        {7556}out(c, senc(mSrv(pkCli_6787,pkSess_6459),Ksrv_6834))
                                                            )
                                                            else
                                                                {7557}let pkDisco_6835: bitstring = fail-any in
                                                                {7558}in(c, (=pkCli_6787,em1_6836: bitstring,sigM1_6837: bitstring));
                                                                {7559}let m1_6838: bitstring = dec(em1_6836,skSess_6458) in
                                                                {7560}if (verify(h(m1_6838),sigM1_6837,pkCli_6787) <> true) then
                                                                    0
                                                                else
                                                                    {7561}let (=OpenSecureChannelRequest,=pkCli_6787,PartC_6839: bitstring) = m1_6838 in
                                                                    {7562}new Ns_6840: bitstring;
                                                                    {7563}new ST_6841: bitstring;
                                                                    {7564}new TTL_6842: bitstring;
                                                                    {7565}let gNs_6843: bitstring = exp(g,Ns_6840) in
                                                                    {7566}let m2_6844: bitstring = (OpenSecureChannelResponse,gNs_6843,ST_6841,TTL_6842) in
                                                                    {7567}out(c, (enc(m2_6844,pkCli_6787),sign(h(m2_6844),skSess_6458)));
                                                                    {7568}let Ksrv_6845: bitstring = exp(PartC_6839,Ns_6840) in
                                                                    {7569}out(c, senc(mSrv(pkCli_6787,pkSess_6459),Ksrv_6845))
                                                    )
                                                    else
                                                        {7570}let pkDisco_6846: bitstring = fail-any in
                                                        {7571}in(c, (=pkCli_6787,em1_6847: bitstring,sigM1_6848: bitstring));
                                                        {7572}let m1_6849: bitstring = dec(em1_6847,skSess_6458) in
                                                        {7573}if (verify(h(m1_6849),sigM1_6848,pkCli_6787) <> true) then
                                                            0
                                                        else
                                                            {7574}let (=OpenSecureChannelRequest,=pkCli_6787,PartC_6850: bitstring) = m1_6849 in
                                                            {7575}new Ns_6851: bitstring;
                                                            {7576}new ST_6852: bitstring;
                                                            {7577}new TTL_6853: bitstring;
                                                            {7578}let gNs_6854: bitstring = exp(g,Ns_6851) in
                                                            {7579}let m2_6855: bitstring = (OpenSecureChannelResponse,gNs_6854,ST_6852,TTL_6853) in
                                                            {7580}out(c, (enc(m2_6855,pkCli_6787),sign(h(m2_6855),skSess_6458)));
                                                            {7581}let Ksrv_6856: bitstring = exp(PartC_6850,Ns_6851) in
                                                            {7582}out(c, senc(mSrv(pkCli_6787,pkSess_6459),Ksrv_6856))
                                            )
                                            else
                                                {7583}let pkDisco_6857: bitstring = fail-any in
                                                {7584}in(c, (=pkCli_6787,em1_6858: bitstring,sigM1_6859: bitstring));
                                                {7585}let m1_6860: bitstring = dec(em1_6858,skSess_6458) in
                                                {7586}if (verify(h(m1_6860),sigM1_6859,pkCli_6787) <> true) then
                                                    0
                                                else
                                                    {7587}let (=OpenSecureChannelRequest,=pkCli_6787,PartC_6861: bitstring) = m1_6860 in
                                                    {7588}new Ns_6862: bitstring;
                                                    {7589}new ST_6863: bitstring;
                                                    {7590}new TTL_6864: bitstring;
                                                    {7591}let gNs_6865: bitstring = exp(g,Ns_6862) in
                                                    {7592}let m2_6866: bitstring = (OpenSecureChannelResponse,gNs_6865,ST_6863,TTL_6864) in
                                                    {7593}out(c, (enc(m2_6866,pkCli_6787),sign(h(m2_6866),skSess_6458)));
                                                    {7594}let Ksrv_6867: bitstring = exp(PartC_6861,Ns_6862) in
                                                    {7595}out(c, senc(mSrv(pkCli_6787,pkSess_6459),Ksrv_6867))
                                )
                                else
                                    {7596}let pkCli_6868: bitstring = fail-any in
                                    {7597}let v_6869: bool = (Disco_5317 = A) in
                                    (
                                        {7598}if v_6869 then
                                        (
                                            {7599}let pkDisco_6870: bitstring = pub(skA) in
                                            {7600}in(c, (=pkCli_6868,em1_6871: bitstring,sigM1_6872: bitstring));
                                            {7601}let m1_6873: bitstring = dec(em1_6871,skSess_6458) in
                                            {7602}if (verify(h(m1_6873),sigM1_6872,pkCli_6868) <> true) then
                                                0
                                            else
                                                {7603}let (=OpenSecureChannelRequest,=pkCli_6868,PartC_6874: bitstring) = m1_6873 in
                                                {7604}new Ns_6875: bitstring;
                                                {7605}new ST_6876: bitstring;
                                                {7606}new TTL_6877: bitstring;
                                                {7607}let gNs_6878: bitstring = exp(g,Ns_6875) in
                                                {7608}let m2_6879: bitstring = (OpenSecureChannelResponse,gNs_6878,ST_6876,TTL_6877) in
                                                {7609}out(c, (enc(m2_6879,pkCli_6868),sign(h(m2_6879),skSess_6458)));
                                                {7610}let Ksrv_6880: bitstring = exp(PartC_6874,Ns_6875) in
                                                {7611}out(c, senc(mSrv(pkCli_6868,pkSess_6459),Ksrv_6880))
                                        )
                                        else
                                            {7612}let v_6881: bool = (Disco_5317 = B) in
                                            (
                                                {7613}if v_6881 then
                                                (
                                                    {7614}let pkDisco_6882: bitstring = pub(skB) in
                                                    {7615}in(c, (=pkCli_6868,em1_6883: bitstring,sigM1_6884: bitstring));
                                                    {7616}let m1_6885: bitstring = dec(em1_6883,skSess_6458) in
                                                    {7617}if (verify(h(m1_6885),sigM1_6884,pkCli_6868) <> true) then
                                                        0
                                                    else
                                                        {7618}let (=OpenSecureChannelRequest,=pkCli_6868,PartC_6886: bitstring) = m1_6885 in
                                                        {7619}new Ns_6887: bitstring;
                                                        {7620}new ST_6888: bitstring;
                                                        {7621}new TTL_6889: bitstring;
                                                        {7622}let gNs_6890: bitstring = exp(g,Ns_6887) in
                                                        {7623}let m2_6891: bitstring = (OpenSecureChannelResponse,gNs_6890,ST_6888,TTL_6889) in
                                                        {7624}out(c, (enc(m2_6891,pkCli_6868),sign(h(m2_6891),skSess_6458)));
                                                        {7625}let Ksrv_6892: bitstring = exp(PartC_6886,Ns_6887) in
                                                        {7626}out(c, senc(mSrv(pkCli_6868,pkSess_6459),Ksrv_6892))
                                                )
                                                else
                                                    {7627}let v_6893: bool = (Disco_5317 = C) in
                                                    (
                                                        {7628}if v_6893 then
                                                        (
                                                            {7629}let pkDisco_6894: bitstring = pub(skC) in
                                                            {7630}in(c, (=pkCli_6868,em1_6895: bitstring,sigM1_6896: bitstring));
                                                            {7631}let m1_6897: bitstring = dec(em1_6895,skSess_6458) in
                                                            {7632}if (verify(h(m1_6897),sigM1_6896,pkCli_6868) <> true) then
                                                                0
                                                            else
                                                                {7633}let (=OpenSecureChannelRequest,=pkCli_6868,PartC_6898: bitstring) = m1_6897 in
                                                                {7634}new Ns_6899: bitstring;
                                                                {7635}new ST_6900: bitstring;
                                                                {7636}new TTL_6901: bitstring;
                                                                {7637}let gNs_6902: bitstring = exp(g,Ns_6899) in
                                                                {7638}let m2_6903: bitstring = (OpenSecureChannelResponse,gNs_6902,ST_6900,TTL_6901) in
                                                                {7639}out(c, (enc(m2_6903,pkCli_6868),sign(h(m2_6903),skSess_6458)));
                                                                {7640}let Ksrv_6904: bitstring = exp(PartC_6898,Ns_6899) in
                                                                {7641}out(c, senc(mSrv(pkCli_6868,pkSess_6459),Ksrv_6904))
                                                        )
                                                        else
                                                            {7642}let pkDisco_6905: bitstring = pub(sk(Disco_5317)) in
                                                            {7643}in(c, (=pkCli_6868,em1_6906: bitstring,sigM1_6907: bitstring));
                                                            {7644}let m1_6908: bitstring = dec(em1_6906,skSess_6458) in
                                                            {7645}if (verify(h(m1_6908),sigM1_6907,pkCli_6868) <> true) then
                                                                0
                                                            else
                                                                {7646}let (=OpenSecureChannelRequest,=pkCli_6868,PartC_6909: bitstring) = m1_6908 in
                                                                {7647}new Ns_6910: bitstring;
                                                                {7648}new ST_6911: bitstring;
                                                                {7649}new TTL_6912: bitstring;
                                                                {7650}let gNs_6913: bitstring = exp(g,Ns_6910) in
                                                                {7651}let m2_6914: bitstring = (OpenSecureChannelResponse,gNs_6913,ST_6911,TTL_6912) in
                                                                {7652}out(c, (enc(m2_6914,pkCli_6868),sign(h(m2_6914),skSess_6458)));
                                                                {7653}let Ksrv_6915: bitstring = exp(PartC_6909,Ns_6910) in
                                                                {7654}out(c, senc(mSrv(pkCli_6868,pkSess_6459),Ksrv_6915))
                                                    )
                                                    else
                                                        {7655}let pkDisco_6916: bitstring = fail-any in
                                                        {7656}in(c, (=pkCli_6868,em1_6917: bitstring,sigM1_6918: bitstring));
                                                        {7657}let m1_6919: bitstring = dec(em1_6917,skSess_6458) in
                                                        {7658}if (verify(h(m1_6919),sigM1_6918,pkCli_6868) <> true) then
                                                            0
                                                        else
                                                            {7659}let (=OpenSecureChannelRequest,=pkCli_6868,PartC_6920: bitstring) = m1_6919 in
                                                            {7660}new Ns_6921: bitstring;
                                                            {7661}new ST_6922: bitstring;
                                                            {7662}new TTL_6923: bitstring;
                                                            {7663}let gNs_6924: bitstring = exp(g,Ns_6921) in
                                                            {7664}let m2_6925: bitstring = (OpenSecureChannelResponse,gNs_6924,ST_6922,TTL_6923) in
                                                            {7665}out(c, (enc(m2_6925,pkCli_6868),sign(h(m2_6925),skSess_6458)));
                                                            {7666}let Ksrv_6926: bitstring = exp(PartC_6920,Ns_6921) in
                                                            {7667}out(c, senc(mSrv(pkCli_6868,pkSess_6459),Ksrv_6926))
                                            )
                                            else
                                                {7668}let pkDisco_6927: bitstring = fail-any in
                                                {7669}in(c, (=pkCli_6868,em1_6928: bitstring,sigM1_6929: bitstring));
                                                {7670}let m1_6930: bitstring = dec(em1_6928,skSess_6458) in
                                                {7671}if (verify(h(m1_6930),sigM1_6929,pkCli_6868) <> true) then
                                                    0
                                                else
                                                    {7672}let (=OpenSecureChannelRequest,=pkCli_6868,PartC_6931: bitstring) = m1_6930 in
                                                    {7673}new Ns_6932: bitstring;
                                                    {7674}new ST_6933: bitstring;
                                                    {7675}new TTL_6934: bitstring;
                                                    {7676}let gNs_6935: bitstring = exp(g,Ns_6932) in
                                                    {7677}let m2_6936: bitstring = (OpenSecureChannelResponse,gNs_6935,ST_6933,TTL_6934) in
                                                    {7678}out(c, (enc(m2_6936,pkCli_6868),sign(h(m2_6936),skSess_6458)));
                                                    {7679}let Ksrv_6937: bitstring = exp(PartC_6931,Ns_6932) in
                                                    {7680}out(c, senc(mSrv(pkCli_6868,pkSess_6459),Ksrv_6937))
                                    )
                                    else
                                        {7681}let pkDisco_6938: bitstring = fail-any in
                                        {7682}in(c, (=pkCli_6868,em1_6939: bitstring,sigM1_6940: bitstring));
                                        {7683}let m1_6941: bitstring = dec(em1_6939,skSess_6458) in
                                        {7684}if (verify(h(m1_6941),sigM1_6940,pkCli_6868) <> true) then
                                            0
                                        else
                                            {7685}let (=OpenSecureChannelRequest,=pkCli_6868,PartC_6942: bitstring) = m1_6941 in
                                            {7686}new Ns_6943: bitstring;
                                            {7687}new ST_6944: bitstring;
                                            {7688}new TTL_6945: bitstring;
                                            {7689}let gNs_6946: bitstring = exp(g,Ns_6943) in
                                            {7690}let m2_6947: bitstring = (OpenSecureChannelResponse,gNs_6946,ST_6944,TTL_6945) in
                                            {7691}out(c, (enc(m2_6947,pkCli_6868),sign(h(m2_6947),skSess_6458)));
                                            {7692}let Ksrv_6948: bitstring = exp(PartC_6942,Ns_6943) in
                                            {7693}out(c, senc(mSrv(pkCli_6868,pkSess_6459),Ksrv_6948))
                        )
                        else
                            {7694}let pkCli_6949: bitstring = fail-any in
                            {7695}let v_6950: bool = (Disco_5317 = A) in
                            (
                                {7696}if v_6950 then
                                (
                                    {7697}let pkDisco_6951: bitstring = pub(skA) in
                                    {7698}in(c, (=pkCli_6949,em1_6952: bitstring,sigM1_6953: bitstring));
                                    {7699}let m1_6954: bitstring = dec(em1_6952,skSess_6458) in
                                    {7700}if (verify(h(m1_6954),sigM1_6953,pkCli_6949) <> true) then
                                        0
                                    else
                                        {7701}let (=OpenSecureChannelRequest,=pkCli_6949,PartC_6955: bitstring) = m1_6954 in
                                        {7702}new Ns_6956: bitstring;
                                        {7703}new ST_6957: bitstring;
                                        {7704}new TTL_6958: bitstring;
                                        {7705}let gNs_6959: bitstring = exp(g,Ns_6956) in
                                        {7706}let m2_6960: bitstring = (OpenSecureChannelResponse,gNs_6959,ST_6957,TTL_6958) in
                                        {7707}out(c, (enc(m2_6960,pkCli_6949),sign(h(m2_6960),skSess_6458)));
                                        {7708}let Ksrv_6961: bitstring = exp(PartC_6955,Ns_6956) in
                                        {7709}out(c, senc(mSrv(pkCli_6949,pkSess_6459),Ksrv_6961))
                                )
                                else
                                    {7710}let v_6962: bool = (Disco_5317 = B) in
                                    (
                                        {7711}if v_6962 then
                                        (
                                            {7712}let pkDisco_6963: bitstring = pub(skB) in
                                            {7713}in(c, (=pkCli_6949,em1_6964: bitstring,sigM1_6965: bitstring));
                                            {7714}let m1_6966: bitstring = dec(em1_6964,skSess_6458) in
                                            {7715}if (verify(h(m1_6966),sigM1_6965,pkCli_6949) <> true) then
                                                0
                                            else
                                                {7716}let (=OpenSecureChannelRequest,=pkCli_6949,PartC_6967: bitstring) = m1_6966 in
                                                {7717}new Ns_6968: bitstring;
                                                {7718}new ST_6969: bitstring;
                                                {7719}new TTL_6970: bitstring;
                                                {7720}let gNs_6971: bitstring = exp(g,Ns_6968) in
                                                {7721}let m2_6972: bitstring = (OpenSecureChannelResponse,gNs_6971,ST_6969,TTL_6970) in
                                                {7722}out(c, (enc(m2_6972,pkCli_6949),sign(h(m2_6972),skSess_6458)));
                                                {7723}let Ksrv_6973: bitstring = exp(PartC_6967,Ns_6968) in
                                                {7724}out(c, senc(mSrv(pkCli_6949,pkSess_6459),Ksrv_6973))
                                        )
                                        else
                                            {7725}let v_6974: bool = (Disco_5317 = C) in
                                            (
                                                {7726}if v_6974 then
                                                (
                                                    {7727}let pkDisco_6975: bitstring = pub(skC) in
                                                    {7728}in(c, (=pkCli_6949,em1_6976: bitstring,sigM1_6977: bitstring));
                                                    {7729}let m1_6978: bitstring = dec(em1_6976,skSess_6458) in
                                                    {7730}if (verify(h(m1_6978),sigM1_6977,pkCli_6949) <> true) then
                                                        0
                                                    else
                                                        {7731}let (=OpenSecureChannelRequest,=pkCli_6949,PartC_6979: bitstring) = m1_6978 in
                                                        {7732}new Ns_6980: bitstring;
                                                        {7733}new ST_6981: bitstring;
                                                        {7734}new TTL_6982: bitstring;
                                                        {7735}let gNs_6983: bitstring = exp(g,Ns_6980) in
                                                        {7736}let m2_6984: bitstring = (OpenSecureChannelResponse,gNs_6983,ST_6981,TTL_6982) in
                                                        {7737}out(c, (enc(m2_6984,pkCli_6949),sign(h(m2_6984),skSess_6458)));
                                                        {7738}let Ksrv_6985: bitstring = exp(PartC_6979,Ns_6980) in
                                                        {7739}out(c, senc(mSrv(pkCli_6949,pkSess_6459),Ksrv_6985))
                                                )
                                                else
                                                    {7740}let pkDisco_6986: bitstring = pub(sk(Disco_5317)) in
                                                    {7741}in(c, (=pkCli_6949,em1_6987: bitstring,sigM1_6988: bitstring));
                                                    {7742}let m1_6989: bitstring = dec(em1_6987,skSess_6458) in
                                                    {7743}if (verify(h(m1_6989),sigM1_6988,pkCli_6949) <> true) then
                                                        0
                                                    else
                                                        {7744}let (=OpenSecureChannelRequest,=pkCli_6949,PartC_6990: bitstring) = m1_6989 in
                                                        {7745}new Ns_6991: bitstring;
                                                        {7746}new ST_6992: bitstring;
                                                        {7747}new TTL_6993: bitstring;
                                                        {7748}let gNs_6994: bitstring = exp(g,Ns_6991) in
                                                        {7749}let m2_6995: bitstring = (OpenSecureChannelResponse,gNs_6994,ST_6992,TTL_6993) in
                                                        {7750}out(c, (enc(m2_6995,pkCli_6949),sign(h(m2_6995),skSess_6458)));
                                                        {7751}let Ksrv_6996: bitstring = exp(PartC_6990,Ns_6991) in
                                                        {7752}out(c, senc(mSrv(pkCli_6949,pkSess_6459),Ksrv_6996))
                                            )
                                            else
                                                {7753}let pkDisco_6997: bitstring = fail-any in
                                                {7754}in(c, (=pkCli_6949,em1_6998: bitstring,sigM1_6999: bitstring));
                                                {7755}let m1_7000: bitstring = dec(em1_6998,skSess_6458) in
                                                {7756}if (verify(h(m1_7000),sigM1_6999,pkCli_6949) <> true) then
                                                    0
                                                else
                                                    {7757}let (=OpenSecureChannelRequest,=pkCli_6949,PartC_7001: bitstring) = m1_7000 in
                                                    {7758}new Ns_7002: bitstring;
                                                    {7759}new ST_7003: bitstring;
                                                    {7760}new TTL_7004: bitstring;
                                                    {7761}let gNs_7005: bitstring = exp(g,Ns_7002) in
                                                    {7762}let m2_7006: bitstring = (OpenSecureChannelResponse,gNs_7005,ST_7003,TTL_7004) in
                                                    {7763}out(c, (enc(m2_7006,pkCli_6949),sign(h(m2_7006),skSess_6458)));
                                                    {7764}let Ksrv_7007: bitstring = exp(PartC_7001,Ns_7002) in
                                                    {7765}out(c, senc(mSrv(pkCli_6949,pkSess_6459),Ksrv_7007))
                                    )
                                    else
                                        {7766}let pkDisco_7008: bitstring = fail-any in
                                        {7767}in(c, (=pkCli_6949,em1_7009: bitstring,sigM1_7010: bitstring));
                                        {7768}let m1_7011: bitstring = dec(em1_7009,skSess_6458) in
                                        {7769}if (verify(h(m1_7011),sigM1_7010,pkCli_6949) <> true) then
                                            0
                                        else
                                            {7770}let (=OpenSecureChannelRequest,=pkCli_6949,PartC_7012: bitstring) = m1_7011 in
                                            {7771}new Ns_7013: bitstring;
                                            {7772}new ST_7014: bitstring;
                                            {7773}new TTL_7015: bitstring;
                                            {7774}let gNs_7016: bitstring = exp(g,Ns_7013) in
                                            {7775}let m2_7017: bitstring = (OpenSecureChannelResponse,gNs_7016,ST_7014,TTL_7015) in
                                            {7776}out(c, (enc(m2_7017,pkCli_6949),sign(h(m2_7017),skSess_6458)));
                                            {7777}let Ksrv_7018: bitstring = exp(PartC_7012,Ns_7013) in
                                            {7778}out(c, senc(mSrv(pkCli_6949,pkSess_6459),Ksrv_7018))
                            )
                            else
                                {7779}let pkDisco_7019: bitstring = fail-any in
                                {7780}in(c, (=pkCli_6949,em1_7020: bitstring,sigM1_7021: bitstring));
                                {7781}let m1_7022: bitstring = dec(em1_7020,skSess_6458) in
                                {7782}if (verify(h(m1_7022),sigM1_7021,pkCli_6949) <> true) then
                                    0
                                else
                                    {7783}let (=OpenSecureChannelRequest,=pkCli_6949,PartC_7023: bitstring) = m1_7022 in
                                    {7784}new Ns_7024: bitstring;
                                    {7785}new ST_7025: bitstring;
                                    {7786}new TTL_7026: bitstring;
                                    {7787}let gNs_7027: bitstring = exp(g,Ns_7024) in
                                    {7788}let m2_7028: bitstring = (OpenSecureChannelResponse,gNs_7027,ST_7025,TTL_7026) in
                                    {7789}out(c, (enc(m2_7028,pkCli_6949),sign(h(m2_7028),skSess_6458)));
                                    {7790}let Ksrv_7029: bitstring = exp(PartC_7023,Ns_7024) in
                                    {7791}out(c, senc(mSrv(pkCli_6949,pkSess_6459),Ksrv_7029))
                    )
                    else
                        {7792}let skSess_7030: bitstring = fail-any in
                        {7793}let pkSess_7031: bitstring = pub(skSess_7030) in
                        {7794}let v_7032: bool = (Cli_5316 = A) in
                        (
                            {7795}if v_7032 then
                            (
                                {7796}let pkCli_7033: bitstring = pub(skA) in
                                {7797}let v_7034: bool = (Disco_5317 = A) in
                                (
                                    {7798}if v_7034 then
                                    (
                                        {7799}let pkDisco_7035: bitstring = pub(skA) in
                                        {7800}in(c, (=pkCli_7033,em1_7036: bitstring,sigM1_7037: bitstring));
                                        {7801}let m1_7038: bitstring = dec(em1_7036,skSess_7030) in
                                        {7802}if (verify(h(m1_7038),sigM1_7037,pkCli_7033) <> true) then
                                            0
                                        else
                                            {7803}let (=OpenSecureChannelRequest,=pkCli_7033,PartC_7039: bitstring) = m1_7038 in
                                            {7804}new Ns_7040: bitstring;
                                            {7805}new ST_7041: bitstring;
                                            {7806}new TTL_7042: bitstring;
                                            {7807}let gNs_7043: bitstring = exp(g,Ns_7040) in
                                            {7808}let m2_7044: bitstring = (OpenSecureChannelResponse,gNs_7043,ST_7041,TTL_7042) in
                                            {7809}out(c, (enc(m2_7044,pkCli_7033),sign(h(m2_7044),skSess_7030)));
                                            {7810}let Ksrv_7045: bitstring = exp(PartC_7039,Ns_7040) in
                                            {7811}out(c, senc(mSrv(pkCli_7033,pkSess_7031),Ksrv_7045))
                                    )
                                    else
                                        {7812}let v_7046: bool = (Disco_5317 = B) in
                                        (
                                            {7813}if v_7046 then
                                            (
                                                {7814}let pkDisco_7047: bitstring = pub(skB) in
                                                {7815}in(c, (=pkCli_7033,em1_7048: bitstring,sigM1_7049: bitstring));
                                                {7816}let m1_7050: bitstring = dec(em1_7048,skSess_7030) in
                                                {7817}if (verify(h(m1_7050),sigM1_7049,pkCli_7033) <> true) then
                                                    0
                                                else
                                                    {7818}let (=OpenSecureChannelRequest,=pkCli_7033,PartC_7051: bitstring) = m1_7050 in
                                                    {7819}new Ns_7052: bitstring;
                                                    {7820}new ST_7053: bitstring;
                                                    {7821}new TTL_7054: bitstring;
                                                    {7822}let gNs_7055: bitstring = exp(g,Ns_7052) in
                                                    {7823}let m2_7056: bitstring = (OpenSecureChannelResponse,gNs_7055,ST_7053,TTL_7054) in
                                                    {7824}out(c, (enc(m2_7056,pkCli_7033),sign(h(m2_7056),skSess_7030)));
                                                    {7825}let Ksrv_7057: bitstring = exp(PartC_7051,Ns_7052) in
                                                    {7826}out(c, senc(mSrv(pkCli_7033,pkSess_7031),Ksrv_7057))
                                            )
                                            else
                                                {7827}let v_7058: bool = (Disco_5317 = C) in
                                                (
                                                    {7828}if v_7058 then
                                                    (
                                                        {7829}let pkDisco_7059: bitstring = pub(skC) in
                                                        {7830}in(c, (=pkCli_7033,em1_7060: bitstring,sigM1_7061: bitstring));
                                                        {7831}let m1_7062: bitstring = dec(em1_7060,skSess_7030) in
                                                        {7832}if (verify(h(m1_7062),sigM1_7061,pkCli_7033) <> true) then
                                                            0
                                                        else
                                                            {7833}let (=OpenSecureChannelRequest,=pkCli_7033,PartC_7063: bitstring) = m1_7062 in
                                                            {7834}new Ns_7064: bitstring;
                                                            {7835}new ST_7065: bitstring;
                                                            {7836}new TTL_7066: bitstring;
                                                            {7837}let gNs_7067: bitstring = exp(g,Ns_7064) in
                                                            {7838}let m2_7068: bitstring = (OpenSecureChannelResponse,gNs_7067,ST_7065,TTL_7066) in
                                                            {7839}out(c, (enc(m2_7068,pkCli_7033),sign(h(m2_7068),skSess_7030)));
                                                            {7840}let Ksrv_7069: bitstring = exp(PartC_7063,Ns_7064) in
                                                            {7841}out(c, senc(mSrv(pkCli_7033,pkSess_7031),Ksrv_7069))
                                                    )
                                                    else
                                                        {7842}let pkDisco_7070: bitstring = pub(sk(Disco_5317)) in
                                                        {7843}in(c, (=pkCli_7033,em1_7071: bitstring,sigM1_7072: bitstring));
                                                        {7844}let m1_7073: bitstring = dec(em1_7071,skSess_7030) in
                                                        {7845}if (verify(h(m1_7073),sigM1_7072,pkCli_7033) <> true) then
                                                            0
                                                        else
                                                            {7846}let (=OpenSecureChannelRequest,=pkCli_7033,PartC_7074: bitstring) = m1_7073 in
                                                            {7847}new Ns_7075: bitstring;
                                                            {7848}new ST_7076: bitstring;
                                                            {7849}new TTL_7077: bitstring;
                                                            {7850}let gNs_7078: bitstring = exp(g,Ns_7075) in
                                                            {7851}let m2_7079: bitstring = (OpenSecureChannelResponse,gNs_7078,ST_7076,TTL_7077) in
                                                            {7852}out(c, (enc(m2_7079,pkCli_7033),sign(h(m2_7079),skSess_7030)));
                                                            {7853}let Ksrv_7080: bitstring = exp(PartC_7074,Ns_7075) in
                                                            {7854}out(c, senc(mSrv(pkCli_7033,pkSess_7031),Ksrv_7080))
                                                )
                                                else
                                                    {7855}let pkDisco_7081: bitstring = fail-any in
                                                    {7856}in(c, (=pkCli_7033,em1_7082: bitstring,sigM1_7083: bitstring));
                                                    {7857}let m1_7084: bitstring = dec(em1_7082,skSess_7030) in
                                                    {7858}if (verify(h(m1_7084),sigM1_7083,pkCli_7033) <> true) then
                                                        0
                                                    else
                                                        {7859}let (=OpenSecureChannelRequest,=pkCli_7033,PartC_7085: bitstring) = m1_7084 in
                                                        {7860}new Ns_7086: bitstring;
                                                        {7861}new ST_7087: bitstring;
                                                        {7862}new TTL_7088: bitstring;
                                                        {7863}let gNs_7089: bitstring = exp(g,Ns_7086) in
                                                        {7864}let m2_7090: bitstring = (OpenSecureChannelResponse,gNs_7089,ST_7087,TTL_7088) in
                                                        {7865}out(c, (enc(m2_7090,pkCli_7033),sign(h(m2_7090),skSess_7030)));
                                                        {7866}let Ksrv_7091: bitstring = exp(PartC_7085,Ns_7086) in
                                                        {7867}out(c, senc(mSrv(pkCli_7033,pkSess_7031),Ksrv_7091))
                                        )
                                        else
                                            {7868}let pkDisco_7092: bitstring = fail-any in
                                            {7869}in(c, (=pkCli_7033,em1_7093: bitstring,sigM1_7094: bitstring));
                                            {7870}let m1_7095: bitstring = dec(em1_7093,skSess_7030) in
                                            {7871}if (verify(h(m1_7095),sigM1_7094,pkCli_7033) <> true) then
                                                0
                                            else
                                                {7872}let (=OpenSecureChannelRequest,=pkCli_7033,PartC_7096: bitstring) = m1_7095 in
                                                {7873}new Ns_7097: bitstring;
                                                {7874}new ST_7098: bitstring;
                                                {7875}new TTL_7099: bitstring;
                                                {7876}let gNs_7100: bitstring = exp(g,Ns_7097) in
                                                {7877}let m2_7101: bitstring = (OpenSecureChannelResponse,gNs_7100,ST_7098,TTL_7099) in
                                                {7878}out(c, (enc(m2_7101,pkCli_7033),sign(h(m2_7101),skSess_7030)));
                                                {7879}let Ksrv_7102: bitstring = exp(PartC_7096,Ns_7097) in
                                                {7880}out(c, senc(mSrv(pkCli_7033,pkSess_7031),Ksrv_7102))
                                )
                                else
                                    {7881}let pkDisco_7103: bitstring = fail-any in
                                    {7882}in(c, (=pkCli_7033,em1_7104: bitstring,sigM1_7105: bitstring));
                                    {7883}let m1_7106: bitstring = dec(em1_7104,skSess_7030) in
                                    {7884}if (verify(h(m1_7106),sigM1_7105,pkCli_7033) <> true) then
                                        0
                                    else
                                        {7885}let (=OpenSecureChannelRequest,=pkCli_7033,PartC_7107: bitstring) = m1_7106 in
                                        {7886}new Ns_7108: bitstring;
                                        {7887}new ST_7109: bitstring;
                                        {7888}new TTL_7110: bitstring;
                                        {7889}let gNs_7111: bitstring = exp(g,Ns_7108) in
                                        {7890}let m2_7112: bitstring = (OpenSecureChannelResponse,gNs_7111,ST_7109,TTL_7110) in
                                        {7891}out(c, (enc(m2_7112,pkCli_7033),sign(h(m2_7112),skSess_7030)));
                                        {7892}let Ksrv_7113: bitstring = exp(PartC_7107,Ns_7108) in
                                        {7893}out(c, senc(mSrv(pkCli_7033,pkSess_7031),Ksrv_7113))
                            )
                            else
                                {7894}let v_7114: bool = (Cli_5316 = B) in
                                (
                                    {7895}if v_7114 then
                                    (
                                        {7896}let pkCli_7115: bitstring = pub(skB) in
                                        {7897}let v_7116: bool = (Disco_5317 = A) in
                                        (
                                            {7898}if v_7116 then
                                            (
                                                {7899}let pkDisco_7117: bitstring = pub(skA) in
                                                {7900}in(c, (=pkCli_7115,em1_7118: bitstring,sigM1_7119: bitstring));
                                                {7901}let m1_7120: bitstring = dec(em1_7118,skSess_7030) in
                                                {7902}if (verify(h(m1_7120),sigM1_7119,pkCli_7115) <> true) then
                                                    0
                                                else
                                                    {7903}let (=OpenSecureChannelRequest,=pkCli_7115,PartC_7121: bitstring) = m1_7120 in
                                                    {7904}new Ns_7122: bitstring;
                                                    {7905}new ST_7123: bitstring;
                                                    {7906}new TTL_7124: bitstring;
                                                    {7907}let gNs_7125: bitstring = exp(g,Ns_7122) in
                                                    {7908}let m2_7126: bitstring = (OpenSecureChannelResponse,gNs_7125,ST_7123,TTL_7124) in
                                                    {7909}out(c, (enc(m2_7126,pkCli_7115),sign(h(m2_7126),skSess_7030)));
                                                    {7910}let Ksrv_7127: bitstring = exp(PartC_7121,Ns_7122) in
                                                    {7911}out(c, senc(mSrv(pkCli_7115,pkSess_7031),Ksrv_7127))
                                            )
                                            else
                                                {7912}let v_7128: bool = (Disco_5317 = B) in
                                                (
                                                    {7913}if v_7128 then
                                                    (
                                                        {7914}let pkDisco_7129: bitstring = pub(skB) in
                                                        {7915}in(c, (=pkCli_7115,em1_7130: bitstring,sigM1_7131: bitstring));
                                                        {7916}let m1_7132: bitstring = dec(em1_7130,skSess_7030) in
                                                        {7917}if (verify(h(m1_7132),sigM1_7131,pkCli_7115) <> true) then
                                                            0
                                                        else
                                                            {7918}let (=OpenSecureChannelRequest,=pkCli_7115,PartC_7133: bitstring) = m1_7132 in
                                                            {7919}new Ns_7134: bitstring;
                                                            {7920}new ST_7135: bitstring;
                                                            {7921}new TTL_7136: bitstring;
                                                            {7922}let gNs_7137: bitstring = exp(g,Ns_7134) in
                                                            {7923}let m2_7138: bitstring = (OpenSecureChannelResponse,gNs_7137,ST_7135,TTL_7136) in
                                                            {7924}out(c, (enc(m2_7138,pkCli_7115),sign(h(m2_7138),skSess_7030)));
                                                            {7925}let Ksrv_7139: bitstring = exp(PartC_7133,Ns_7134) in
                                                            {7926}out(c, senc(mSrv(pkCli_7115,pkSess_7031),Ksrv_7139))
                                                    )
                                                    else
                                                        {7927}let v_7140: bool = (Disco_5317 = C) in
                                                        (
                                                            {7928}if v_7140 then
                                                            (
                                                                {7929}let pkDisco_7141: bitstring = pub(skC) in
                                                                {7930}in(c, (=pkCli_7115,em1_7142: bitstring,sigM1_7143: bitstring));
                                                                {7931}let m1_7144: bitstring = dec(em1_7142,skSess_7030) in
                                                                {7932}if (verify(h(m1_7144),sigM1_7143,pkCli_7115) <> true) then
                                                                    0
                                                                else
                                                                    {7933}let (=OpenSecureChannelRequest,=pkCli_7115,PartC_7145: bitstring) = m1_7144 in
                                                                    {7934}new Ns_7146: bitstring;
                                                                    {7935}new ST_7147: bitstring;
                                                                    {7936}new TTL_7148: bitstring;
                                                                    {7937}let gNs_7149: bitstring = exp(g,Ns_7146) in
                                                                    {7938}let m2_7150: bitstring = (OpenSecureChannelResponse,gNs_7149,ST_7147,TTL_7148) in
                                                                    {7939}out(c, (enc(m2_7150,pkCli_7115),sign(h(m2_7150),skSess_7030)));
                                                                    {7940}let Ksrv_7151: bitstring = exp(PartC_7145,Ns_7146) in
                                                                    {7941}out(c, senc(mSrv(pkCli_7115,pkSess_7031),Ksrv_7151))
                                                            )
                                                            else
                                                                {7942}let pkDisco_7152: bitstring = pub(sk(Disco_5317)) in
                                                                {7943}in(c, (=pkCli_7115,em1_7153: bitstring,sigM1_7154: bitstring));
                                                                {7944}let m1_7155: bitstring = dec(em1_7153,skSess_7030) in
                                                                {7945}if (verify(h(m1_7155),sigM1_7154,pkCli_7115) <> true) then
                                                                    0
                                                                else
                                                                    {7946}let (=OpenSecureChannelRequest,=pkCli_7115,PartC_7156: bitstring) = m1_7155 in
                                                                    {7947}new Ns_7157: bitstring;
                                                                    {7948}new ST_7158: bitstring;
                                                                    {7949}new TTL_7159: bitstring;
                                                                    {7950}let gNs_7160: bitstring = exp(g,Ns_7157) in
                                                                    {7951}let m2_7161: bitstring = (OpenSecureChannelResponse,gNs_7160,ST_7158,TTL_7159) in
                                                                    {7952}out(c, (enc(m2_7161,pkCli_7115),sign(h(m2_7161),skSess_7030)));
                                                                    {7953}let Ksrv_7162: bitstring = exp(PartC_7156,Ns_7157) in
                                                                    {7954}out(c, senc(mSrv(pkCli_7115,pkSess_7031),Ksrv_7162))
                                                        )
                                                        else
                                                            {7955}let pkDisco_7163: bitstring = fail-any in
                                                            {7956}in(c, (=pkCli_7115,em1_7164: bitstring,sigM1_7165: bitstring));
                                                            {7957}let m1_7166: bitstring = dec(em1_7164,skSess_7030) in
                                                            {7958}if (verify(h(m1_7166),sigM1_7165,pkCli_7115) <> true) then
                                                                0
                                                            else
                                                                {7959}let (=OpenSecureChannelRequest,=pkCli_7115,PartC_7167: bitstring) = m1_7166 in
                                                                {7960}new Ns_7168: bitstring;
                                                                {7961}new ST_7169: bitstring;
                                                                {7962}new TTL_7170: bitstring;
                                                                {7963}let gNs_7171: bitstring = exp(g,Ns_7168) in
                                                                {7964}let m2_7172: bitstring = (OpenSecureChannelResponse,gNs_7171,ST_7169,TTL_7170) in
                                                                {7965}out(c, (enc(m2_7172,pkCli_7115),sign(h(m2_7172),skSess_7030)));
                                                                {7966}let Ksrv_7173: bitstring = exp(PartC_7167,Ns_7168) in
                                                                {7967}out(c, senc(mSrv(pkCli_7115,pkSess_7031),Ksrv_7173))
                                                )
                                                else
                                                    {7968}let pkDisco_7174: bitstring = fail-any in
                                                    {7969}in(c, (=pkCli_7115,em1_7175: bitstring,sigM1_7176: bitstring));
                                                    {7970}let m1_7177: bitstring = dec(em1_7175,skSess_7030) in
                                                    {7971}if (verify(h(m1_7177),sigM1_7176,pkCli_7115) <> true) then
                                                        0
                                                    else
                                                        {7972}let (=OpenSecureChannelRequest,=pkCli_7115,PartC_7178: bitstring) = m1_7177 in
                                                        {7973}new Ns_7179: bitstring;
                                                        {7974}new ST_7180: bitstring;
                                                        {7975}new TTL_7181: bitstring;
                                                        {7976}let gNs_7182: bitstring = exp(g,Ns_7179) in
                                                        {7977}let m2_7183: bitstring = (OpenSecureChannelResponse,gNs_7182,ST_7180,TTL_7181) in
                                                        {7978}out(c, (enc(m2_7183,pkCli_7115),sign(h(m2_7183),skSess_7030)));
                                                        {7979}let Ksrv_7184: bitstring = exp(PartC_7178,Ns_7179) in
                                                        {7980}out(c, senc(mSrv(pkCli_7115,pkSess_7031),Ksrv_7184))
                                        )
                                        else
                                            {7981}let pkDisco_7185: bitstring = fail-any in
                                            {7982}in(c, (=pkCli_7115,em1_7186: bitstring,sigM1_7187: bitstring));
                                            {7983}let m1_7188: bitstring = dec(em1_7186,skSess_7030) in
                                            {7984}if (verify(h(m1_7188),sigM1_7187,pkCli_7115) <> true) then
                                                0
                                            else
                                                {7985}let (=OpenSecureChannelRequest,=pkCli_7115,PartC_7189: bitstring) = m1_7188 in
                                                {7986}new Ns_7190: bitstring;
                                                {7987}new ST_7191: bitstring;
                                                {7988}new TTL_7192: bitstring;
                                                {7989}let gNs_7193: bitstring = exp(g,Ns_7190) in
                                                {7990}let m2_7194: bitstring = (OpenSecureChannelResponse,gNs_7193,ST_7191,TTL_7192) in
                                                {7991}out(c, (enc(m2_7194,pkCli_7115),sign(h(m2_7194),skSess_7030)));
                                                {7992}let Ksrv_7195: bitstring = exp(PartC_7189,Ns_7190) in
                                                {7993}out(c, senc(mSrv(pkCli_7115,pkSess_7031),Ksrv_7195))
                                    )
                                    else
                                        {7994}let v_7196: bool = (Cli_5316 = C) in
                                        (
                                            {7995}if v_7196 then
                                            (
                                                {7996}let pkCli_7197: bitstring = pub(skC) in
                                                {7997}let v_7198: bool = (Disco_5317 = A) in
                                                (
                                                    {7998}if v_7198 then
                                                    (
                                                        {7999}let pkDisco_7199: bitstring = pub(skA) in
                                                        {8000}in(c, (=pkCli_7197,em1_7200: bitstring,sigM1_7201: bitstring));
                                                        {8001}let m1_7202: bitstring = dec(em1_7200,skSess_7030) in
                                                        {8002}if (verify(h(m1_7202),sigM1_7201,pkCli_7197) <> true) then
                                                            0
                                                        else
                                                            {8003}let (=OpenSecureChannelRequest,=pkCli_7197,PartC_7203: bitstring) = m1_7202 in
                                                            {8004}new Ns_7204: bitstring;
                                                            {8005}new ST_7205: bitstring;
                                                            {8006}new TTL_7206: bitstring;
                                                            {8007}let gNs_7207: bitstring = exp(g,Ns_7204) in
                                                            {8008}let m2_7208: bitstring = (OpenSecureChannelResponse,gNs_7207,ST_7205,TTL_7206) in
                                                            {8009}out(c, (enc(m2_7208,pkCli_7197),sign(h(m2_7208),skSess_7030)));
                                                            {8010}let Ksrv_7209: bitstring = exp(PartC_7203,Ns_7204) in
                                                            {8011}out(c, senc(mSrv(pkCli_7197,pkSess_7031),Ksrv_7209))
                                                    )
                                                    else
                                                        {8012}let v_7210: bool = (Disco_5317 = B) in
                                                        (
                                                            {8013}if v_7210 then
                                                            (
                                                                {8014}let pkDisco_7211: bitstring = pub(skB) in
                                                                {8015}in(c, (=pkCli_7197,em1_7212: bitstring,sigM1_7213: bitstring));
                                                                {8016}let m1_7214: bitstring = dec(em1_7212,skSess_7030) in
                                                                {8017}if (verify(h(m1_7214),sigM1_7213,pkCli_7197) <> true) then
                                                                    0
                                                                else
                                                                    {8018}let (=OpenSecureChannelRequest,=pkCli_7197,PartC_7215: bitstring) = m1_7214 in
                                                                    {8019}new Ns_7216: bitstring;
                                                                    {8020}new ST_7217: bitstring;
                                                                    {8021}new TTL_7218: bitstring;
                                                                    {8022}let gNs_7219: bitstring = exp(g,Ns_7216) in
                                                                    {8023}let m2_7220: bitstring = (OpenSecureChannelResponse,gNs_7219,ST_7217,TTL_7218) in
                                                                    {8024}out(c, (enc(m2_7220,pkCli_7197),sign(h(m2_7220),skSess_7030)));
                                                                    {8025}let Ksrv_7221: bitstring = exp(PartC_7215,Ns_7216) in
                                                                    {8026}out(c, senc(mSrv(pkCli_7197,pkSess_7031),Ksrv_7221))
                                                            )
                                                            else
                                                                {8027}let v_7222: bool = (Disco_5317 = C) in
                                                                (
                                                                    {8028}if v_7222 then
                                                                    (
                                                                        {8029}let pkDisco_7223: bitstring = pub(skC) in
                                                                        {8030}in(c, (=pkCli_7197,em1_7224: bitstring,sigM1_7225: bitstring));
                                                                        {8031}let m1_7226: bitstring = dec(em1_7224,skSess_7030) in
                                                                        {8032}if (verify(h(m1_7226),sigM1_7225,pkCli_7197) <> true) then
                                                                            0
                                                                        else
                                                                            {8033}let (=OpenSecureChannelRequest,=pkCli_7197,PartC_7227: bitstring) = m1_7226 in
                                                                            {8034}new Ns_7228: bitstring;
                                                                            {8035}new ST_7229: bitstring;
                                                                            {8036}new TTL_7230: bitstring;
                                                                            {8037}let gNs_7231: bitstring = exp(g,Ns_7228) in
                                                                            {8038}let m2_7232: bitstring = (OpenSecureChannelResponse,gNs_7231,ST_7229,TTL_7230) in
                                                                            {8039}out(c, (enc(m2_7232,pkCli_7197),sign(h(m2_7232),skSess_7030)));
                                                                            {8040}let Ksrv_7233: bitstring = exp(PartC_7227,Ns_7228) in
                                                                            {8041}out(c, senc(mSrv(pkCli_7197,pkSess_7031),Ksrv_7233))
                                                                    )
                                                                    else
                                                                        {8042}let pkDisco_7234: bitstring = pub(sk(Disco_5317)) in
                                                                        {8043}in(c, (=pkCli_7197,em1_7235: bitstring,sigM1_7236: bitstring));
                                                                        {8044}let m1_7237: bitstring = dec(em1_7235,skSess_7030) in
                                                                        {8045}if (verify(h(m1_7237),sigM1_7236,pkCli_7197) <> true) then
                                                                            0
                                                                        else
                                                                            {8046}let (=OpenSecureChannelRequest,=pkCli_7197,PartC_7238: bitstring) = m1_7237 in
                                                                            {8047}new Ns_7239: bitstring;
                                                                            {8048}new ST_7240: bitstring;
                                                                            {8049}new TTL_7241: bitstring;
                                                                            {8050}let gNs_7242: bitstring = exp(g,Ns_7239) in
                                                                            {8051}let m2_7243: bitstring = (OpenSecureChannelResponse,gNs_7242,ST_7240,TTL_7241) in
                                                                            {8052}out(c, (enc(m2_7243,pkCli_7197),sign(h(m2_7243),skSess_7030)));
                                                                            {8053}let Ksrv_7244: bitstring = exp(PartC_7238,Ns_7239) in
                                                                            {8054}out(c, senc(mSrv(pkCli_7197,pkSess_7031),Ksrv_7244))
                                                                )
                                                                else
                                                                    {8055}let pkDisco_7245: bitstring = fail-any in
                                                                    {8056}in(c, (=pkCli_7197,em1_7246: bitstring,sigM1_7247: bitstring));
                                                                    {8057}let m1_7248: bitstring = dec(em1_7246,skSess_7030) in
                                                                    {8058}if (verify(h(m1_7248),sigM1_7247,pkCli_7197) <> true) then
                                                                        0
                                                                    else
                                                                        {8059}let (=OpenSecureChannelRequest,=pkCli_7197,PartC_7249: bitstring) = m1_7248 in
                                                                        {8060}new Ns_7250: bitstring;
                                                                        {8061}new ST_7251: bitstring;
                                                                        {8062}new TTL_7252: bitstring;
                                                                        {8063}let gNs_7253: bitstring = exp(g,Ns_7250) in
                                                                        {8064}let m2_7254: bitstring = (OpenSecureChannelResponse,gNs_7253,ST_7251,TTL_7252) in
                                                                        {8065}out(c, (enc(m2_7254,pkCli_7197),sign(h(m2_7254),skSess_7030)));
                                                                        {8066}let Ksrv_7255: bitstring = exp(PartC_7249,Ns_7250) in
                                                                        {8067}out(c, senc(mSrv(pkCli_7197,pkSess_7031),Ksrv_7255))
                                                        )
                                                        else
                                                            {8068}let pkDisco_7256: bitstring = fail-any in
                                                            {8069}in(c, (=pkCli_7197,em1_7257: bitstring,sigM1_7258: bitstring));
                                                            {8070}let m1_7259: bitstring = dec(em1_7257,skSess_7030) in
                                                            {8071}if (verify(h(m1_7259),sigM1_7258,pkCli_7197) <> true) then
                                                                0
                                                            else
                                                                {8072}let (=OpenSecureChannelRequest,=pkCli_7197,PartC_7260: bitstring) = m1_7259 in
                                                                {8073}new Ns_7261: bitstring;
                                                                {8074}new ST_7262: bitstring;
                                                                {8075}new TTL_7263: bitstring;
                                                                {8076}let gNs_7264: bitstring = exp(g,Ns_7261) in
                                                                {8077}let m2_7265: bitstring = (OpenSecureChannelResponse,gNs_7264,ST_7262,TTL_7263) in
                                                                {8078}out(c, (enc(m2_7265,pkCli_7197),sign(h(m2_7265),skSess_7030)));
                                                                {8079}let Ksrv_7266: bitstring = exp(PartC_7260,Ns_7261) in
                                                                {8080}out(c, senc(mSrv(pkCli_7197,pkSess_7031),Ksrv_7266))
                                                )
                                                else
                                                    {8081}let pkDisco_7267: bitstring = fail-any in
                                                    {8082}in(c, (=pkCli_7197,em1_7268: bitstring,sigM1_7269: bitstring));
                                                    {8083}let m1_7270: bitstring = dec(em1_7268,skSess_7030) in
                                                    {8084}if (verify(h(m1_7270),sigM1_7269,pkCli_7197) <> true) then
                                                        0
                                                    else
                                                        {8085}let (=OpenSecureChannelRequest,=pkCli_7197,PartC_7271: bitstring) = m1_7270 in
                                                        {8086}new Ns_7272: bitstring;
                                                        {8087}new ST_7273: bitstring;
                                                        {8088}new TTL_7274: bitstring;
                                                        {8089}let gNs_7275: bitstring = exp(g,Ns_7272) in
                                                        {8090}let m2_7276: bitstring = (OpenSecureChannelResponse,gNs_7275,ST_7273,TTL_7274) in
                                                        {8091}out(c, (enc(m2_7276,pkCli_7197),sign(h(m2_7276),skSess_7030)));
                                                        {8092}let Ksrv_7277: bitstring = exp(PartC_7271,Ns_7272) in
                                                        {8093}out(c, senc(mSrv(pkCli_7197,pkSess_7031),Ksrv_7277))
                                            )
                                            else
                                                {8094}let pkCli_7278: bitstring = pub(sk(Cli_5316)) in
                                                {8095}let v_7279: bool = (Disco_5317 = A) in
                                                (
                                                    {8096}if v_7279 then
                                                    (
                                                        {8097}let pkDisco_7280: bitstring = pub(skA) in
                                                        {8098}in(c, (=pkCli_7278,em1_7281: bitstring,sigM1_7282: bitstring));
                                                        {8099}let m1_7283: bitstring = dec(em1_7281,skSess_7030) in
                                                        {8100}if (verify(h(m1_7283),sigM1_7282,pkCli_7278) <> true) then
                                                            0
                                                        else
                                                            {8101}let (=OpenSecureChannelRequest,=pkCli_7278,PartC_7284: bitstring) = m1_7283 in
                                                            {8102}new Ns_7285: bitstring;
                                                            {8103}new ST_7286: bitstring;
                                                            {8104}new TTL_7287: bitstring;
                                                            {8105}let gNs_7288: bitstring = exp(g,Ns_7285) in
                                                            {8106}let m2_7289: bitstring = (OpenSecureChannelResponse,gNs_7288,ST_7286,TTL_7287) in
                                                            {8107}out(c, (enc(m2_7289,pkCli_7278),sign(h(m2_7289),skSess_7030)));
                                                            {8108}let Ksrv_7290: bitstring = exp(PartC_7284,Ns_7285) in
                                                            {8109}out(c, senc(mSrv(pkCli_7278,pkSess_7031),Ksrv_7290))
                                                    )
                                                    else
                                                        {8110}let v_7291: bool = (Disco_5317 = B) in
                                                        (
                                                            {8111}if v_7291 then
                                                            (
                                                                {8112}let pkDisco_7292: bitstring = pub(skB) in
                                                                {8113}in(c, (=pkCli_7278,em1_7293: bitstring,sigM1_7294: bitstring));
                                                                {8114}let m1_7295: bitstring = dec(em1_7293,skSess_7030) in
                                                                {8115}if (verify(h(m1_7295),sigM1_7294,pkCli_7278) <> true) then
                                                                    0
                                                                else
                                                                    {8116}let (=OpenSecureChannelRequest,=pkCli_7278,PartC_7296: bitstring) = m1_7295 in
                                                                    {8117}new Ns_7297: bitstring;
                                                                    {8118}new ST_7298: bitstring;
                                                                    {8119}new TTL_7299: bitstring;
                                                                    {8120}let gNs_7300: bitstring = exp(g,Ns_7297) in
                                                                    {8121}let m2_7301: bitstring = (OpenSecureChannelResponse,gNs_7300,ST_7298,TTL_7299) in
                                                                    {8122}out(c, (enc(m2_7301,pkCli_7278),sign(h(m2_7301),skSess_7030)));
                                                                    {8123}let Ksrv_7302: bitstring = exp(PartC_7296,Ns_7297) in
                                                                    {8124}out(c, senc(mSrv(pkCli_7278,pkSess_7031),Ksrv_7302))
                                                            )
                                                            else
                                                                {8125}let v_7303: bool = (Disco_5317 = C) in
                                                                (
                                                                    {8126}if v_7303 then
                                                                    (
                                                                        {8127}let pkDisco_7304: bitstring = pub(skC) in
                                                                        {8128}in(c, (=pkCli_7278,em1_7305: bitstring,sigM1_7306: bitstring));
                                                                        {8129}let m1_7307: bitstring = dec(em1_7305,skSess_7030) in
                                                                        {8130}if (verify(h(m1_7307),sigM1_7306,pkCli_7278) <> true) then
                                                                            0
                                                                        else
                                                                            {8131}let (=OpenSecureChannelRequest,=pkCli_7278,PartC_7308: bitstring) = m1_7307 in
                                                                            {8132}new Ns_7309: bitstring;
                                                                            {8133}new ST_7310: bitstring;
                                                                            {8134}new TTL_7311: bitstring;
                                                                            {8135}let gNs_7312: bitstring = exp(g,Ns_7309) in
                                                                            {8136}let m2_7313: bitstring = (OpenSecureChannelResponse,gNs_7312,ST_7310,TTL_7311) in
                                                                            {8137}out(c, (enc(m2_7313,pkCli_7278),sign(h(m2_7313),skSess_7030)));
                                                                            {8138}let Ksrv_7314: bitstring = exp(PartC_7308,Ns_7309) in
                                                                            {8139}out(c, senc(mSrv(pkCli_7278,pkSess_7031),Ksrv_7314))
                                                                    )
                                                                    else
                                                                        {8140}let pkDisco_7315: bitstring = pub(sk(Disco_5317)) in
                                                                        {8141}in(c, (=pkCli_7278,em1_7316: bitstring,sigM1_7317: bitstring));
                                                                        {8142}let m1_7318: bitstring = dec(em1_7316,skSess_7030) in
                                                                        {8143}if (verify(h(m1_7318),sigM1_7317,pkCli_7278) <> true) then
                                                                            0
                                                                        else
                                                                            {8144}let (=OpenSecureChannelRequest,=pkCli_7278,PartC_7319: bitstring) = m1_7318 in
                                                                            {8145}new Ns_7320: bitstring;
                                                                            {8146}new ST_7321: bitstring;
                                                                            {8147}new TTL_7322: bitstring;
                                                                            {8148}let gNs_7323: bitstring = exp(g,Ns_7320) in
                                                                            {8149}let m2_7324: bitstring = (OpenSecureChannelResponse,gNs_7323,ST_7321,TTL_7322) in
                                                                            {8150}out(c, (enc(m2_7324,pkCli_7278),sign(h(m2_7324),skSess_7030)));
                                                                            {8151}let Ksrv_7325: bitstring = exp(PartC_7319,Ns_7320) in
                                                                            {8152}out(c, senc(mSrv(pkCli_7278,pkSess_7031),Ksrv_7325))
                                                                )
                                                                else
                                                                    {8153}let pkDisco_7326: bitstring = fail-any in
                                                                    {8154}in(c, (=pkCli_7278,em1_7327: bitstring,sigM1_7328: bitstring));
                                                                    {8155}let m1_7329: bitstring = dec(em1_7327,skSess_7030) in
                                                                    {8156}if (verify(h(m1_7329),sigM1_7328,pkCli_7278) <> true) then
                                                                        0
                                                                    else
                                                                        {8157}let (=OpenSecureChannelRequest,=pkCli_7278,PartC_7330: bitstring) = m1_7329 in
                                                                        {8158}new Ns_7331: bitstring;
                                                                        {8159}new ST_7332: bitstring;
                                                                        {8160}new TTL_7333: bitstring;
                                                                        {8161}let gNs_7334: bitstring = exp(g,Ns_7331) in
                                                                        {8162}let m2_7335: bitstring = (OpenSecureChannelResponse,gNs_7334,ST_7332,TTL_7333) in
                                                                        {8163}out(c, (enc(m2_7335,pkCli_7278),sign(h(m2_7335),skSess_7030)));
                                                                        {8164}let Ksrv_7336: bitstring = exp(PartC_7330,Ns_7331) in
                                                                        {8165}out(c, senc(mSrv(pkCli_7278,pkSess_7031),Ksrv_7336))
                                                        )
                                                        else
                                                            {8166}let pkDisco_7337: bitstring = fail-any in
                                                            {8167}in(c, (=pkCli_7278,em1_7338: bitstring,sigM1_7339: bitstring));
                                                            {8168}let m1_7340: bitstring = dec(em1_7338,skSess_7030) in
                                                            {8169}if (verify(h(m1_7340),sigM1_7339,pkCli_7278) <> true) then
                                                                0
                                                            else
                                                                {8170}let (=OpenSecureChannelRequest,=pkCli_7278,PartC_7341: bitstring) = m1_7340 in
                                                                {8171}new Ns_7342: bitstring;
                                                                {8172}new ST_7343: bitstring;
                                                                {8173}new TTL_7344: bitstring;
                                                                {8174}let gNs_7345: bitstring = exp(g,Ns_7342) in
                                                                {8175}let m2_7346: bitstring = (OpenSecureChannelResponse,gNs_7345,ST_7343,TTL_7344) in
                                                                {8176}out(c, (enc(m2_7346,pkCli_7278),sign(h(m2_7346),skSess_7030)));
                                                                {8177}let Ksrv_7347: bitstring = exp(PartC_7341,Ns_7342) in
                                                                {8178}out(c, senc(mSrv(pkCli_7278,pkSess_7031),Ksrv_7347))
                                                )
                                                else
                                                    {8179}let pkDisco_7348: bitstring = fail-any in
                                                    {8180}in(c, (=pkCli_7278,em1_7349: bitstring,sigM1_7350: bitstring));
                                                    {8181}let m1_7351: bitstring = dec(em1_7349,skSess_7030) in
                                                    {8182}if (verify(h(m1_7351),sigM1_7350,pkCli_7278) <> true) then
                                                        0
                                                    else
                                                        {8183}let (=OpenSecureChannelRequest,=pkCli_7278,PartC_7352: bitstring) = m1_7351 in
                                                        {8184}new Ns_7353: bitstring;
                                                        {8185}new ST_7354: bitstring;
                                                        {8186}new TTL_7355: bitstring;
                                                        {8187}let gNs_7356: bitstring = exp(g,Ns_7353) in
                                                        {8188}let m2_7357: bitstring = (OpenSecureChannelResponse,gNs_7356,ST_7354,TTL_7355) in
                                                        {8189}out(c, (enc(m2_7357,pkCli_7278),sign(h(m2_7357),skSess_7030)));
                                                        {8190}let Ksrv_7358: bitstring = exp(PartC_7352,Ns_7353) in
                                                        {8191}out(c, senc(mSrv(pkCli_7278,pkSess_7031),Ksrv_7358))
                                        )
                                        else
                                            {8192}let pkCli_7359: bitstring = fail-any in
                                            {8193}let v_7360: bool = (Disco_5317 = A) in
                                            (
                                                {8194}if v_7360 then
                                                (
                                                    {8195}let pkDisco_7361: bitstring = pub(skA) in
                                                    {8196}in(c, (=pkCli_7359,em1_7362: bitstring,sigM1_7363: bitstring));
                                                    {8197}let m1_7364: bitstring = dec(em1_7362,skSess_7030) in
                                                    {8198}if (verify(h(m1_7364),sigM1_7363,pkCli_7359) <> true) then
                                                        0
                                                    else
                                                        {8199}let (=OpenSecureChannelRequest,=pkCli_7359,PartC_7365: bitstring) = m1_7364 in
                                                        {8200}new Ns_7366: bitstring;
                                                        {8201}new ST_7367: bitstring;
                                                        {8202}new TTL_7368: bitstring;
                                                        {8203}let gNs_7369: bitstring = exp(g,Ns_7366) in
                                                        {8204}let m2_7370: bitstring = (OpenSecureChannelResponse,gNs_7369,ST_7367,TTL_7368) in
                                                        {8205}out(c, (enc(m2_7370,pkCli_7359),sign(h(m2_7370),skSess_7030)));
                                                        {8206}let Ksrv_7371: bitstring = exp(PartC_7365,Ns_7366) in
                                                        {8207}out(c, senc(mSrv(pkCli_7359,pkSess_7031),Ksrv_7371))
                                                )
                                                else
                                                    {8208}let v_7372: bool = (Disco_5317 = B) in
                                                    (
                                                        {8209}if v_7372 then
                                                        (
                                                            {8210}let pkDisco_7373: bitstring = pub(skB) in
                                                            {8211}in(c, (=pkCli_7359,em1_7374: bitstring,sigM1_7375: bitstring));
                                                            {8212}let m1_7376: bitstring = dec(em1_7374,skSess_7030) in
                                                            {8213}if (verify(h(m1_7376),sigM1_7375,pkCli_7359) <> true) then
                                                                0
                                                            else
                                                                {8214}let (=OpenSecureChannelRequest,=pkCli_7359,PartC_7377: bitstring) = m1_7376 in
                                                                {8215}new Ns_7378: bitstring;
                                                                {8216}new ST_7379: bitstring;
                                                                {8217}new TTL_7380: bitstring;
                                                                {8218}let gNs_7381: bitstring = exp(g,Ns_7378) in
                                                                {8219}let m2_7382: bitstring = (OpenSecureChannelResponse,gNs_7381,ST_7379,TTL_7380) in
                                                                {8220}out(c, (enc(m2_7382,pkCli_7359),sign(h(m2_7382),skSess_7030)));
                                                                {8221}let Ksrv_7383: bitstring = exp(PartC_7377,Ns_7378) in
                                                                {8222}out(c, senc(mSrv(pkCli_7359,pkSess_7031),Ksrv_7383))
                                                        )
                                                        else
                                                            {8223}let v_7384: bool = (Disco_5317 = C) in
                                                            (
                                                                {8224}if v_7384 then
                                                                (
                                                                    {8225}let pkDisco_7385: bitstring = pub(skC) in
                                                                    {8226}in(c, (=pkCli_7359,em1_7386: bitstring,sigM1_7387: bitstring));
                                                                    {8227}let m1_7388: bitstring = dec(em1_7386,skSess_7030) in
                                                                    {8228}if (verify(h(m1_7388),sigM1_7387,pkCli_7359) <> true) then
                                                                        0
                                                                    else
                                                                        {8229}let (=OpenSecureChannelRequest,=pkCli_7359,PartC_7389: bitstring) = m1_7388 in
                                                                        {8230}new Ns_7390: bitstring;
                                                                        {8231}new ST_7391: bitstring;
                                                                        {8232}new TTL_7392: bitstring;
                                                                        {8233}let gNs_7393: bitstring = exp(g,Ns_7390) in
                                                                        {8234}let m2_7394: bitstring = (OpenSecureChannelResponse,gNs_7393,ST_7391,TTL_7392) in
                                                                        {8235}out(c, (enc(m2_7394,pkCli_7359),sign(h(m2_7394),skSess_7030)));
                                                                        {8236}let Ksrv_7395: bitstring = exp(PartC_7389,Ns_7390) in
                                                                        {8237}out(c, senc(mSrv(pkCli_7359,pkSess_7031),Ksrv_7395))
                                                                )
                                                                else
                                                                    {8238}let pkDisco_7396: bitstring = pub(sk(Disco_5317)) in
                                                                    {8239}in(c, (=pkCli_7359,em1_7397: bitstring,sigM1_7398: bitstring));
                                                                    {8240}let m1_7399: bitstring = dec(em1_7397,skSess_7030) in
                                                                    {8241}if (verify(h(m1_7399),sigM1_7398,pkCli_7359) <> true) then
                                                                        0
                                                                    else
                                                                        {8242}let (=OpenSecureChannelRequest,=pkCli_7359,PartC_7400: bitstring) = m1_7399 in
                                                                        {8243}new Ns_7401: bitstring;
                                                                        {8244}new ST_7402: bitstring;
                                                                        {8245}new TTL_7403: bitstring;
                                                                        {8246}let gNs_7404: bitstring = exp(g,Ns_7401) in
                                                                        {8247}let m2_7405: bitstring = (OpenSecureChannelResponse,gNs_7404,ST_7402,TTL_7403) in
                                                                        {8248}out(c, (enc(m2_7405,pkCli_7359),sign(h(m2_7405),skSess_7030)));
                                                                        {8249}let Ksrv_7406: bitstring = exp(PartC_7400,Ns_7401) in
                                                                        {8250}out(c, senc(mSrv(pkCli_7359,pkSess_7031),Ksrv_7406))
                                                            )
                                                            else
                                                                {8251}let pkDisco_7407: bitstring = fail-any in
                                                                {8252}in(c, (=pkCli_7359,em1_7408: bitstring,sigM1_7409: bitstring));
                                                                {8253}let m1_7410: bitstring = dec(em1_7408,skSess_7030) in
                                                                {8254}if (verify(h(m1_7410),sigM1_7409,pkCli_7359) <> true) then
                                                                    0
                                                                else
                                                                    {8255}let (=OpenSecureChannelRequest,=pkCli_7359,PartC_7411: bitstring) = m1_7410 in
                                                                    {8256}new Ns_7412: bitstring;
                                                                    {8257}new ST_7413: bitstring;
                                                                    {8258}new TTL_7414: bitstring;
                                                                    {8259}let gNs_7415: bitstring = exp(g,Ns_7412) in
                                                                    {8260}let m2_7416: bitstring = (OpenSecureChannelResponse,gNs_7415,ST_7413,TTL_7414) in
                                                                    {8261}out(c, (enc(m2_7416,pkCli_7359),sign(h(m2_7416),skSess_7030)));
                                                                    {8262}let Ksrv_7417: bitstring = exp(PartC_7411,Ns_7412) in
                                                                    {8263}out(c, senc(mSrv(pkCli_7359,pkSess_7031),Ksrv_7417))
                                                    )
                                                    else
                                                        {8264}let pkDisco_7418: bitstring = fail-any in
                                                        {8265}in(c, (=pkCli_7359,em1_7419: bitstring,sigM1_7420: bitstring));
                                                        {8266}let m1_7421: bitstring = dec(em1_7419,skSess_7030) in
                                                        {8267}if (verify(h(m1_7421),sigM1_7420,pkCli_7359) <> true) then
                                                            0
                                                        else
                                                            {8268}let (=OpenSecureChannelRequest,=pkCli_7359,PartC_7422: bitstring) = m1_7421 in
                                                            {8269}new Ns_7423: bitstring;
                                                            {8270}new ST_7424: bitstring;
                                                            {8271}new TTL_7425: bitstring;
                                                            {8272}let gNs_7426: bitstring = exp(g,Ns_7423) in
                                                            {8273}let m2_7427: bitstring = (OpenSecureChannelResponse,gNs_7426,ST_7424,TTL_7425) in
                                                            {8274}out(c, (enc(m2_7427,pkCli_7359),sign(h(m2_7427),skSess_7030)));
                                                            {8275}let Ksrv_7428: bitstring = exp(PartC_7422,Ns_7423) in
                                                            {8276}out(c, senc(mSrv(pkCli_7359,pkSess_7031),Ksrv_7428))
                                            )
                                            else
                                                {8277}let pkDisco_7429: bitstring = fail-any in
                                                {8278}in(c, (=pkCli_7359,em1_7430: bitstring,sigM1_7431: bitstring));
                                                {8279}let m1_7432: bitstring = dec(em1_7430,skSess_7030) in
                                                {8280}if (verify(h(m1_7432),sigM1_7431,pkCli_7359) <> true) then
                                                    0
                                                else
                                                    {8281}let (=OpenSecureChannelRequest,=pkCli_7359,PartC_7433: bitstring) = m1_7432 in
                                                    {8282}new Ns_7434: bitstring;
                                                    {8283}new ST_7435: bitstring;
                                                    {8284}new TTL_7436: bitstring;
                                                    {8285}let gNs_7437: bitstring = exp(g,Ns_7434) in
                                                    {8286}let m2_7438: bitstring = (OpenSecureChannelResponse,gNs_7437,ST_7435,TTL_7436) in
                                                    {8287}out(c, (enc(m2_7438,pkCli_7359),sign(h(m2_7438),skSess_7030)));
                                                    {8288}let Ksrv_7439: bitstring = exp(PartC_7433,Ns_7434) in
                                                    {8289}out(c, senc(mSrv(pkCli_7359,pkSess_7031),Ksrv_7439))
                                )
                                else
                                    {8290}let pkCli_7440: bitstring = fail-any in
                                    {8291}let v_7441: bool = (Disco_5317 = A) in
                                    (
                                        {8292}if v_7441 then
                                        (
                                            {8293}let pkDisco_7442: bitstring = pub(skA) in
                                            {8294}in(c, (=pkCli_7440,em1_7443: bitstring,sigM1_7444: bitstring));
                                            {8295}let m1_7445: bitstring = dec(em1_7443,skSess_7030) in
                                            {8296}if (verify(h(m1_7445),sigM1_7444,pkCli_7440) <> true) then
                                                0
                                            else
                                                {8297}let (=OpenSecureChannelRequest,=pkCli_7440,PartC_7446: bitstring) = m1_7445 in
                                                {8298}new Ns_7447: bitstring;
                                                {8299}new ST_7448: bitstring;
                                                {8300}new TTL_7449: bitstring;
                                                {8301}let gNs_7450: bitstring = exp(g,Ns_7447) in
                                                {8302}let m2_7451: bitstring = (OpenSecureChannelResponse,gNs_7450,ST_7448,TTL_7449) in
                                                {8303}out(c, (enc(m2_7451,pkCli_7440),sign(h(m2_7451),skSess_7030)));
                                                {8304}let Ksrv_7452: bitstring = exp(PartC_7446,Ns_7447) in
                                                {8305}out(c, senc(mSrv(pkCli_7440,pkSess_7031),Ksrv_7452))
                                        )
                                        else
                                            {8306}let v_7453: bool = (Disco_5317 = B) in
                                            (
                                                {8307}if v_7453 then
                                                (
                                                    {8308}let pkDisco_7454: bitstring = pub(skB) in
                                                    {8309}in(c, (=pkCli_7440,em1_7455: bitstring,sigM1_7456: bitstring));
                                                    {8310}let m1_7457: bitstring = dec(em1_7455,skSess_7030) in
                                                    {8311}if (verify(h(m1_7457),sigM1_7456,pkCli_7440) <> true) then
                                                        0
                                                    else
                                                        {8312}let (=OpenSecureChannelRequest,=pkCli_7440,PartC_7458: bitstring) = m1_7457 in
                                                        {8313}new Ns_7459: bitstring;
                                                        {8314}new ST_7460: bitstring;
                                                        {8315}new TTL_7461: bitstring;
                                                        {8316}let gNs_7462: bitstring = exp(g,Ns_7459) in
                                                        {8317}let m2_7463: bitstring = (OpenSecureChannelResponse,gNs_7462,ST_7460,TTL_7461) in
                                                        {8318}out(c, (enc(m2_7463,pkCli_7440),sign(h(m2_7463),skSess_7030)));
                                                        {8319}let Ksrv_7464: bitstring = exp(PartC_7458,Ns_7459) in
                                                        {8320}out(c, senc(mSrv(pkCli_7440,pkSess_7031),Ksrv_7464))
                                                )
                                                else
                                                    {8321}let v_7465: bool = (Disco_5317 = C) in
                                                    (
                                                        {8322}if v_7465 then
                                                        (
                                                            {8323}let pkDisco_7466: bitstring = pub(skC) in
                                                            {8324}in(c, (=pkCli_7440,em1_7467: bitstring,sigM1_7468: bitstring));
                                                            {8325}let m1_7469: bitstring = dec(em1_7467,skSess_7030) in
                                                            {8326}if (verify(h(m1_7469),sigM1_7468,pkCli_7440) <> true) then
                                                                0
                                                            else
                                                                {8327}let (=OpenSecureChannelRequest,=pkCli_7440,PartC_7470: bitstring) = m1_7469 in
                                                                {8328}new Ns_7471: bitstring;
                                                                {8329}new ST_7472: bitstring;
                                                                {8330}new TTL_7473: bitstring;
                                                                {8331}let gNs_7474: bitstring = exp(g,Ns_7471) in
                                                                {8332}let m2_7475: bitstring = (OpenSecureChannelResponse,gNs_7474,ST_7472,TTL_7473) in
                                                                {8333}out(c, (enc(m2_7475,pkCli_7440),sign(h(m2_7475),skSess_7030)));
                                                                {8334}let Ksrv_7476: bitstring = exp(PartC_7470,Ns_7471) in
                                                                {8335}out(c, senc(mSrv(pkCli_7440,pkSess_7031),Ksrv_7476))
                                                        )
                                                        else
                                                            {8336}let pkDisco_7477: bitstring = pub(sk(Disco_5317)) in
                                                            {8337}in(c, (=pkCli_7440,em1_7478: bitstring,sigM1_7479: bitstring));
                                                            {8338}let m1_7480: bitstring = dec(em1_7478,skSess_7030) in
                                                            {8339}if (verify(h(m1_7480),sigM1_7479,pkCli_7440) <> true) then
                                                                0
                                                            else
                                                                {8340}let (=OpenSecureChannelRequest,=pkCli_7440,PartC_7481: bitstring) = m1_7480 in
                                                                {8341}new Ns_7482: bitstring;
                                                                {8342}new ST_7483: bitstring;
                                                                {8343}new TTL_7484: bitstring;
                                                                {8344}let gNs_7485: bitstring = exp(g,Ns_7482) in
                                                                {8345}let m2_7486: bitstring = (OpenSecureChannelResponse,gNs_7485,ST_7483,TTL_7484) in
                                                                {8346}out(c, (enc(m2_7486,pkCli_7440),sign(h(m2_7486),skSess_7030)));
                                                                {8347}let Ksrv_7487: bitstring = exp(PartC_7481,Ns_7482) in
                                                                {8348}out(c, senc(mSrv(pkCli_7440,pkSess_7031),Ksrv_7487))
                                                    )
                                                    else
                                                        {8349}let pkDisco_7488: bitstring = fail-any in
                                                        {8350}in(c, (=pkCli_7440,em1_7489: bitstring,sigM1_7490: bitstring));
                                                        {8351}let m1_7491: bitstring = dec(em1_7489,skSess_7030) in
                                                        {8352}if (verify(h(m1_7491),sigM1_7490,pkCli_7440) <> true) then
                                                            0
                                                        else
                                                            {8353}let (=OpenSecureChannelRequest,=pkCli_7440,PartC_7492: bitstring) = m1_7491 in
                                                            {8354}new Ns_7493: bitstring;
                                                            {8355}new ST_7494: bitstring;
                                                            {8356}new TTL_7495: bitstring;
                                                            {8357}let gNs_7496: bitstring = exp(g,Ns_7493) in
                                                            {8358}let m2_7497: bitstring = (OpenSecureChannelResponse,gNs_7496,ST_7494,TTL_7495) in
                                                            {8359}out(c, (enc(m2_7497,pkCli_7440),sign(h(m2_7497),skSess_7030)));
                                                            {8360}let Ksrv_7498: bitstring = exp(PartC_7492,Ns_7493) in
                                                            {8361}out(c, senc(mSrv(pkCli_7440,pkSess_7031),Ksrv_7498))
                                            )
                                            else
                                                {8362}let pkDisco_7499: bitstring = fail-any in
                                                {8363}in(c, (=pkCli_7440,em1_7500: bitstring,sigM1_7501: bitstring));
                                                {8364}let m1_7502: bitstring = dec(em1_7500,skSess_7030) in
                                                {8365}if (verify(h(m1_7502),sigM1_7501,pkCli_7440) <> true) then
                                                    0
                                                else
                                                    {8366}let (=OpenSecureChannelRequest,=pkCli_7440,PartC_7503: bitstring) = m1_7502 in
                                                    {8367}new Ns_7504: bitstring;
                                                    {8368}new ST_7505: bitstring;
                                                    {8369}new TTL_7506: bitstring;
                                                    {8370}let gNs_7507: bitstring = exp(g,Ns_7504) in
                                                    {8371}let m2_7508: bitstring = (OpenSecureChannelResponse,gNs_7507,ST_7505,TTL_7506) in
                                                    {8372}out(c, (enc(m2_7508,pkCli_7440),sign(h(m2_7508),skSess_7030)));
                                                    {8373}let Ksrv_7509: bitstring = exp(PartC_7503,Ns_7504) in
                                                    {8374}out(c, senc(mSrv(pkCli_7440,pkSess_7031),Ksrv_7509))
                                    )
                                    else
                                        {8375}let pkDisco_7510: bitstring = fail-any in
                                        {8376}in(c, (=pkCli_7440,em1_7511: bitstring,sigM1_7512: bitstring));
                                        {8377}let m1_7513: bitstring = dec(em1_7511,skSess_7030) in
                                        {8378}if (verify(h(m1_7513),sigM1_7512,pkCli_7440) <> true) then
                                            0
                                        else
                                            {8379}let (=OpenSecureChannelRequest,=pkCli_7440,PartC_7514: bitstring) = m1_7513 in
                                            {8380}new Ns_7515: bitstring;
                                            {8381}new ST_7516: bitstring;
                                            {8382}new TTL_7517: bitstring;
                                            {8383}let gNs_7518: bitstring = exp(g,Ns_7515) in
                                            {8384}let m2_7519: bitstring = (OpenSecureChannelResponse,gNs_7518,ST_7516,TTL_7517) in
                                            {8385}out(c, (enc(m2_7519,pkCli_7440),sign(h(m2_7519),skSess_7030)));
                                            {8386}let Ksrv_7520: bitstring = exp(PartC_7514,Ns_7515) in
                                            {8387}out(c, senc(mSrv(pkCli_7440,pkSess_7031),Ksrv_7520))
                        )
                        else
                            {8388}let pkCli_7521: bitstring = fail-any in
                            {8389}let v_7522: bool = (Disco_5317 = A) in
                            (
                                {8390}if v_7522 then
                                (
                                    {8391}let pkDisco_7523: bitstring = pub(skA) in
                                    {8392}in(c, (=pkCli_7521,em1_7524: bitstring,sigM1_7525: bitstring));
                                    {8393}let m1_7526: bitstring = dec(em1_7524,skSess_7030) in
                                    {8394}if (verify(h(m1_7526),sigM1_7525,pkCli_7521) <> true) then
                                        0
                                    else
                                        {8395}let (=OpenSecureChannelRequest,=pkCli_7521,PartC_7527: bitstring) = m1_7526 in
                                        {8396}new Ns_7528: bitstring;
                                        {8397}new ST_7529: bitstring;
                                        {8398}new TTL_7530: bitstring;
                                        {8399}let gNs_7531: bitstring = exp(g,Ns_7528) in
                                        {8400}let m2_7532: bitstring = (OpenSecureChannelResponse,gNs_7531,ST_7529,TTL_7530) in
                                        {8401}out(c, (enc(m2_7532,pkCli_7521),sign(h(m2_7532),skSess_7030)));
                                        {8402}let Ksrv_7533: bitstring = exp(PartC_7527,Ns_7528) in
                                        {8403}out(c, senc(mSrv(pkCli_7521,pkSess_7031),Ksrv_7533))
                                )
                                else
                                    {8404}let v_7534: bool = (Disco_5317 = B) in
                                    (
                                        {8405}if v_7534 then
                                        (
                                            {8406}let pkDisco_7535: bitstring = pub(skB) in
                                            {8407}in(c, (=pkCli_7521,em1_7536: bitstring,sigM1_7537: bitstring));
                                            {8408}let m1_7538: bitstring = dec(em1_7536,skSess_7030) in
                                            {8409}if (verify(h(m1_7538),sigM1_7537,pkCli_7521) <> true) then
                                                0
                                            else
                                                {8410}let (=OpenSecureChannelRequest,=pkCli_7521,PartC_7539: bitstring) = m1_7538 in
                                                {8411}new Ns_7540: bitstring;
                                                {8412}new ST_7541: bitstring;
                                                {8413}new TTL_7542: bitstring;
                                                {8414}let gNs_7543: bitstring = exp(g,Ns_7540) in
                                                {8415}let m2_7544: bitstring = (OpenSecureChannelResponse,gNs_7543,ST_7541,TTL_7542) in
                                                {8416}out(c, (enc(m2_7544,pkCli_7521),sign(h(m2_7544),skSess_7030)));
                                                {8417}let Ksrv_7545: bitstring = exp(PartC_7539,Ns_7540) in
                                                {8418}out(c, senc(mSrv(pkCli_7521,pkSess_7031),Ksrv_7545))
                                        )
                                        else
                                            {8419}let v_7546: bool = (Disco_5317 = C) in
                                            (
                                                {8420}if v_7546 then
                                                (
                                                    {8421}let pkDisco_7547: bitstring = pub(skC) in
                                                    {8422}in(c, (=pkCli_7521,em1_7548: bitstring,sigM1_7549: bitstring));
                                                    {8423}let m1_7550: bitstring = dec(em1_7548,skSess_7030) in
                                                    {8424}if (verify(h(m1_7550),sigM1_7549,pkCli_7521) <> true) then
                                                        0
                                                    else
                                                        {8425}let (=OpenSecureChannelRequest,=pkCli_7521,PartC_7551: bitstring) = m1_7550 in
                                                        {8426}new Ns_7552: bitstring;
                                                        {8427}new ST_7553: bitstring;
                                                        {8428}new TTL_7554: bitstring;
                                                        {8429}let gNs_7555: bitstring = exp(g,Ns_7552) in
                                                        {8430}let m2_7556: bitstring = (OpenSecureChannelResponse,gNs_7555,ST_7553,TTL_7554) in
                                                        {8431}out(c, (enc(m2_7556,pkCli_7521),sign(h(m2_7556),skSess_7030)));
                                                        {8432}let Ksrv_7557: bitstring = exp(PartC_7551,Ns_7552) in
                                                        {8433}out(c, senc(mSrv(pkCli_7521,pkSess_7031),Ksrv_7557))
                                                )
                                                else
                                                    {8434}let pkDisco_7558: bitstring = pub(sk(Disco_5317)) in
                                                    {8435}in(c, (=pkCli_7521,em1_7559: bitstring,sigM1_7560: bitstring));
                                                    {8436}let m1_7561: bitstring = dec(em1_7559,skSess_7030) in
                                                    {8437}if (verify(h(m1_7561),sigM1_7560,pkCli_7521) <> true) then
                                                        0
                                                    else
                                                        {8438}let (=OpenSecureChannelRequest,=pkCli_7521,PartC_7562: bitstring) = m1_7561 in
                                                        {8439}new Ns_7563: bitstring;
                                                        {8440}new ST_7564: bitstring;
                                                        {8441}new TTL_7565: bitstring;
                                                        {8442}let gNs_7566: bitstring = exp(g,Ns_7563) in
                                                        {8443}let m2_7567: bitstring = (OpenSecureChannelResponse,gNs_7566,ST_7564,TTL_7565) in
                                                        {8444}out(c, (enc(m2_7567,pkCli_7521),sign(h(m2_7567),skSess_7030)));
                                                        {8445}let Ksrv_7568: bitstring = exp(PartC_7562,Ns_7563) in
                                                        {8446}out(c, senc(mSrv(pkCli_7521,pkSess_7031),Ksrv_7568))
                                            )
                                            else
                                                {8447}let pkDisco_7569: bitstring = fail-any in
                                                {8448}in(c, (=pkCli_7521,em1_7570: bitstring,sigM1_7571: bitstring));
                                                {8449}let m1_7572: bitstring = dec(em1_7570,skSess_7030) in
                                                {8450}if (verify(h(m1_7572),sigM1_7571,pkCli_7521) <> true) then
                                                    0
                                                else
                                                    {8451}let (=OpenSecureChannelRequest,=pkCli_7521,PartC_7573: bitstring) = m1_7572 in
                                                    {8452}new Ns_7574: bitstring;
                                                    {8453}new ST_7575: bitstring;
                                                    {8454}new TTL_7576: bitstring;
                                                    {8455}let gNs_7577: bitstring = exp(g,Ns_7574) in
                                                    {8456}let m2_7578: bitstring = (OpenSecureChannelResponse,gNs_7577,ST_7575,TTL_7576) in
                                                    {8457}out(c, (enc(m2_7578,pkCli_7521),sign(h(m2_7578),skSess_7030)));
                                                    {8458}let Ksrv_7579: bitstring = exp(PartC_7573,Ns_7574) in
                                                    {8459}out(c, senc(mSrv(pkCli_7521,pkSess_7031),Ksrv_7579))
                                    )
                                    else
                                        {8460}let pkDisco_7580: bitstring = fail-any in
                                        {8461}in(c, (=pkCli_7521,em1_7581: bitstring,sigM1_7582: bitstring));
                                        {8462}let m1_7583: bitstring = dec(em1_7581,skSess_7030) in
                                        {8463}if (verify(h(m1_7583),sigM1_7582,pkCli_7521) <> true) then
                                            0
                                        else
                                            {8464}let (=OpenSecureChannelRequest,=pkCli_7521,PartC_7584: bitstring) = m1_7583 in
                                            {8465}new Ns_7585: bitstring;
                                            {8466}new ST_7586: bitstring;
                                            {8467}new TTL_7587: bitstring;
                                            {8468}let gNs_7588: bitstring = exp(g,Ns_7585) in
                                            {8469}let m2_7589: bitstring = (OpenSecureChannelResponse,gNs_7588,ST_7586,TTL_7587) in
                                            {8470}out(c, (enc(m2_7589,pkCli_7521),sign(h(m2_7589),skSess_7030)));
                                            {8471}let Ksrv_7590: bitstring = exp(PartC_7584,Ns_7585) in
                                            {8472}out(c, senc(mSrv(pkCli_7521,pkSess_7031),Ksrv_7590))
                            )
                            else
                                {8473}let pkDisco_7591: bitstring = fail-any in
                                {8474}in(c, (=pkCli_7521,em1_7592: bitstring,sigM1_7593: bitstring));
                                {8475}let m1_7594: bitstring = dec(em1_7592,skSess_7030) in
                                {8476}if (verify(h(m1_7594),sigM1_7593,pkCli_7521) <> true) then
                                    0
                                else
                                    {8477}let (=OpenSecureChannelRequest,=pkCli_7521,PartC_7595: bitstring) = m1_7594 in
                                    {8478}new Ns_7596: bitstring;
                                    {8479}new ST_7597: bitstring;
                                    {8480}new TTL_7598: bitstring;
                                    {8481}let gNs_7599: bitstring = exp(g,Ns_7596) in
                                    {8482}let m2_7600: bitstring = (OpenSecureChannelResponse,gNs_7599,ST_7597,TTL_7598) in
                                    {8483}out(c, (enc(m2_7600,pkCli_7521),sign(h(m2_7600),skSess_7030)));
                                    {8484}let Ksrv_7601: bitstring = exp(PartC_7595,Ns_7596) in
                                    {8485}out(c, senc(mSrv(pkCli_7521,pkSess_7031),Ksrv_7601))
            )
            else
                {8486}let skSess_7602: bitstring = fail-any in
                {8487}let pkSess_7603: bitstring = pub(skSess_7602) in
                {8488}let v_7604: bool = (Cli_5316 = A) in
                (
                    {8489}if v_7604 then
                    (
                        {8490}let pkCli_7605: bitstring = pub(skA) in
                        {8491}let v_7606: bool = (Disco_5317 = A) in
                        (
                            {8492}if v_7606 then
                            (
                                {8493}let pkDisco_7607: bitstring = pub(skA) in
                                {8494}in(c, (=pkCli_7605,em1_7608: bitstring,sigM1_7609: bitstring));
                                {8495}let m1_7610: bitstring = dec(em1_7608,skSess_7602) in
                                {8496}if (verify(h(m1_7610),sigM1_7609,pkCli_7605) <> true) then
                                    0
                                else
                                    {8497}let (=OpenSecureChannelRequest,=pkCli_7605,PartC_7611: bitstring) = m1_7610 in
                                    {8498}new Ns_7612: bitstring;
                                    {8499}new ST_7613: bitstring;
                                    {8500}new TTL_7614: bitstring;
                                    {8501}let gNs_7615: bitstring = exp(g,Ns_7612) in
                                    {8502}let m2_7616: bitstring = (OpenSecureChannelResponse,gNs_7615,ST_7613,TTL_7614) in
                                    {8503}out(c, (enc(m2_7616,pkCli_7605),sign(h(m2_7616),skSess_7602)));
                                    {8504}let Ksrv_7617: bitstring = exp(PartC_7611,Ns_7612) in
                                    {8505}out(c, senc(mSrv(pkCli_7605,pkSess_7603),Ksrv_7617))
                            )
                            else
                                {8506}let v_7618: bool = (Disco_5317 = B) in
                                (
                                    {8507}if v_7618 then
                                    (
                                        {8508}let pkDisco_7619: bitstring = pub(skB) in
                                        {8509}in(c, (=pkCli_7605,em1_7620: bitstring,sigM1_7621: bitstring));
                                        {8510}let m1_7622: bitstring = dec(em1_7620,skSess_7602) in
                                        {8511}if (verify(h(m1_7622),sigM1_7621,pkCli_7605) <> true) then
                                            0
                                        else
                                            {8512}let (=OpenSecureChannelRequest,=pkCli_7605,PartC_7623: bitstring) = m1_7622 in
                                            {8513}new Ns_7624: bitstring;
                                            {8514}new ST_7625: bitstring;
                                            {8515}new TTL_7626: bitstring;
                                            {8516}let gNs_7627: bitstring = exp(g,Ns_7624) in
                                            {8517}let m2_7628: bitstring = (OpenSecureChannelResponse,gNs_7627,ST_7625,TTL_7626) in
                                            {8518}out(c, (enc(m2_7628,pkCli_7605),sign(h(m2_7628),skSess_7602)));
                                            {8519}let Ksrv_7629: bitstring = exp(PartC_7623,Ns_7624) in
                                            {8520}out(c, senc(mSrv(pkCli_7605,pkSess_7603),Ksrv_7629))
                                    )
                                    else
                                        {8521}let v_7630: bool = (Disco_5317 = C) in
                                        (
                                            {8522}if v_7630 then
                                            (
                                                {8523}let pkDisco_7631: bitstring = pub(skC) in
                                                {8524}in(c, (=pkCli_7605,em1_7632: bitstring,sigM1_7633: bitstring));
                                                {8525}let m1_7634: bitstring = dec(em1_7632,skSess_7602) in
                                                {8526}if (verify(h(m1_7634),sigM1_7633,pkCli_7605) <> true) then
                                                    0
                                                else
                                                    {8527}let (=OpenSecureChannelRequest,=pkCli_7605,PartC_7635: bitstring) = m1_7634 in
                                                    {8528}new Ns_7636: bitstring;
                                                    {8529}new ST_7637: bitstring;
                                                    {8530}new TTL_7638: bitstring;
                                                    {8531}let gNs_7639: bitstring = exp(g,Ns_7636) in
                                                    {8532}let m2_7640: bitstring = (OpenSecureChannelResponse,gNs_7639,ST_7637,TTL_7638) in
                                                    {8533}out(c, (enc(m2_7640,pkCli_7605),sign(h(m2_7640),skSess_7602)));
                                                    {8534}let Ksrv_7641: bitstring = exp(PartC_7635,Ns_7636) in
                                                    {8535}out(c, senc(mSrv(pkCli_7605,pkSess_7603),Ksrv_7641))
                                            )
                                            else
                                                {8536}let pkDisco_7642: bitstring = pub(sk(Disco_5317)) in
                                                {8537}in(c, (=pkCli_7605,em1_7643: bitstring,sigM1_7644: bitstring));
                                                {8538}let m1_7645: bitstring = dec(em1_7643,skSess_7602) in
                                                {8539}if (verify(h(m1_7645),sigM1_7644,pkCli_7605) <> true) then
                                                    0
                                                else
                                                    {8540}let (=OpenSecureChannelRequest,=pkCli_7605,PartC_7646: bitstring) = m1_7645 in
                                                    {8541}new Ns_7647: bitstring;
                                                    {8542}new ST_7648: bitstring;
                                                    {8543}new TTL_7649: bitstring;
                                                    {8544}let gNs_7650: bitstring = exp(g,Ns_7647) in
                                                    {8545}let m2_7651: bitstring = (OpenSecureChannelResponse,gNs_7650,ST_7648,TTL_7649) in
                                                    {8546}out(c, (enc(m2_7651,pkCli_7605),sign(h(m2_7651),skSess_7602)));
                                                    {8547}let Ksrv_7652: bitstring = exp(PartC_7646,Ns_7647) in
                                                    {8548}out(c, senc(mSrv(pkCli_7605,pkSess_7603),Ksrv_7652))
                                        )
                                        else
                                            {8549}let pkDisco_7653: bitstring = fail-any in
                                            {8550}in(c, (=pkCli_7605,em1_7654: bitstring,sigM1_7655: bitstring));
                                            {8551}let m1_7656: bitstring = dec(em1_7654,skSess_7602) in
                                            {8552}if (verify(h(m1_7656),sigM1_7655,pkCli_7605) <> true) then
                                                0
                                            else
                                                {8553}let (=OpenSecureChannelRequest,=pkCli_7605,PartC_7657: bitstring) = m1_7656 in
                                                {8554}new Ns_7658: bitstring;
                                                {8555}new ST_7659: bitstring;
                                                {8556}new TTL_7660: bitstring;
                                                {8557}let gNs_7661: bitstring = exp(g,Ns_7658) in
                                                {8558}let m2_7662: bitstring = (OpenSecureChannelResponse,gNs_7661,ST_7659,TTL_7660) in
                                                {8559}out(c, (enc(m2_7662,pkCli_7605),sign(h(m2_7662),skSess_7602)));
                                                {8560}let Ksrv_7663: bitstring = exp(PartC_7657,Ns_7658) in
                                                {8561}out(c, senc(mSrv(pkCli_7605,pkSess_7603),Ksrv_7663))
                                )
                                else
                                    {8562}let pkDisco_7664: bitstring = fail-any in
                                    {8563}in(c, (=pkCli_7605,em1_7665: bitstring,sigM1_7666: bitstring));
                                    {8564}let m1_7667: bitstring = dec(em1_7665,skSess_7602) in
                                    {8565}if (verify(h(m1_7667),sigM1_7666,pkCli_7605) <> true) then
                                        0
                                    else
                                        {8566}let (=OpenSecureChannelRequest,=pkCli_7605,PartC_7668: bitstring) = m1_7667 in
                                        {8567}new Ns_7669: bitstring;
                                        {8568}new ST_7670: bitstring;
                                        {8569}new TTL_7671: bitstring;
                                        {8570}let gNs_7672: bitstring = exp(g,Ns_7669) in
                                        {8571}let m2_7673: bitstring = (OpenSecureChannelResponse,gNs_7672,ST_7670,TTL_7671) in
                                        {8572}out(c, (enc(m2_7673,pkCli_7605),sign(h(m2_7673),skSess_7602)));
                                        {8573}let Ksrv_7674: bitstring = exp(PartC_7668,Ns_7669) in
                                        {8574}out(c, senc(mSrv(pkCli_7605,pkSess_7603),Ksrv_7674))
                        )
                        else
                            {8575}let pkDisco_7675: bitstring = fail-any in
                            {8576}in(c, (=pkCli_7605,em1_7676: bitstring,sigM1_7677: bitstring));
                            {8577}let m1_7678: bitstring = dec(em1_7676,skSess_7602) in
                            {8578}if (verify(h(m1_7678),sigM1_7677,pkCli_7605) <> true) then
                                0
                            else
                                {8579}let (=OpenSecureChannelRequest,=pkCli_7605,PartC_7679: bitstring) = m1_7678 in
                                {8580}new Ns_7680: bitstring;
                                {8581}new ST_7681: bitstring;
                                {8582}new TTL_7682: bitstring;
                                {8583}let gNs_7683: bitstring = exp(g,Ns_7680) in
                                {8584}let m2_7684: bitstring = (OpenSecureChannelResponse,gNs_7683,ST_7681,TTL_7682) in
                                {8585}out(c, (enc(m2_7684,pkCli_7605),sign(h(m2_7684),skSess_7602)));
                                {8586}let Ksrv_7685: bitstring = exp(PartC_7679,Ns_7680) in
                                {8587}out(c, senc(mSrv(pkCli_7605,pkSess_7603),Ksrv_7685))
                    )
                    else
                        {8588}let v_7686: bool = (Cli_5316 = B) in
                        (
                            {8589}if v_7686 then
                            (
                                {8590}let pkCli_7687: bitstring = pub(skB) in
                                {8591}let v_7688: bool = (Disco_5317 = A) in
                                (
                                    {8592}if v_7688 then
                                    (
                                        {8593}let pkDisco_7689: bitstring = pub(skA) in
                                        {8594}in(c, (=pkCli_7687,em1_7690: bitstring,sigM1_7691: bitstring));
                                        {8595}let m1_7692: bitstring = dec(em1_7690,skSess_7602) in
                                        {8596}if (verify(h(m1_7692),sigM1_7691,pkCli_7687) <> true) then
                                            0
                                        else
                                            {8597}let (=OpenSecureChannelRequest,=pkCli_7687,PartC_7693: bitstring) = m1_7692 in
                                            {8598}new Ns_7694: bitstring;
                                            {8599}new ST_7695: bitstring;
                                            {8600}new TTL_7696: bitstring;
                                            {8601}let gNs_7697: bitstring = exp(g,Ns_7694) in
                                            {8602}let m2_7698: bitstring = (OpenSecureChannelResponse,gNs_7697,ST_7695,TTL_7696) in
                                            {8603}out(c, (enc(m2_7698,pkCli_7687),sign(h(m2_7698),skSess_7602)));
                                            {8604}let Ksrv_7699: bitstring = exp(PartC_7693,Ns_7694) in
                                            {8605}out(c, senc(mSrv(pkCli_7687,pkSess_7603),Ksrv_7699))
                                    )
                                    else
                                        {8606}let v_7700: bool = (Disco_5317 = B) in
                                        (
                                            {8607}if v_7700 then
                                            (
                                                {8608}let pkDisco_7701: bitstring = pub(skB) in
                                                {8609}in(c, (=pkCli_7687,em1_7702: bitstring,sigM1_7703: bitstring));
                                                {8610}let m1_7704: bitstring = dec(em1_7702,skSess_7602) in
                                                {8611}if (verify(h(m1_7704),sigM1_7703,pkCli_7687) <> true) then
                                                    0
                                                else
                                                    {8612}let (=OpenSecureChannelRequest,=pkCli_7687,PartC_7705: bitstring) = m1_7704 in
                                                    {8613}new Ns_7706: bitstring;
                                                    {8614}new ST_7707: bitstring;
                                                    {8615}new TTL_7708: bitstring;
                                                    {8616}let gNs_7709: bitstring = exp(g,Ns_7706) in
                                                    {8617}let m2_7710: bitstring = (OpenSecureChannelResponse,gNs_7709,ST_7707,TTL_7708) in
                                                    {8618}out(c, (enc(m2_7710,pkCli_7687),sign(h(m2_7710),skSess_7602)));
                                                    {8619}let Ksrv_7711: bitstring = exp(PartC_7705,Ns_7706) in
                                                    {8620}out(c, senc(mSrv(pkCli_7687,pkSess_7603),Ksrv_7711))
                                            )
                                            else
                                                {8621}let v_7712: bool = (Disco_5317 = C) in
                                                (
                                                    {8622}if v_7712 then
                                                    (
                                                        {8623}let pkDisco_7713: bitstring = pub(skC) in
                                                        {8624}in(c, (=pkCli_7687,em1_7714: bitstring,sigM1_7715: bitstring));
                                                        {8625}let m1_7716: bitstring = dec(em1_7714,skSess_7602) in
                                                        {8626}if (verify(h(m1_7716),sigM1_7715,pkCli_7687) <> true) then
                                                            0
                                                        else
                                                            {8627}let (=OpenSecureChannelRequest,=pkCli_7687,PartC_7717: bitstring) = m1_7716 in
                                                            {8628}new Ns_7718: bitstring;
                                                            {8629}new ST_7719: bitstring;
                                                            {8630}new TTL_7720: bitstring;
                                                            {8631}let gNs_7721: bitstring = exp(g,Ns_7718) in
                                                            {8632}let m2_7722: bitstring = (OpenSecureChannelResponse,gNs_7721,ST_7719,TTL_7720) in
                                                            {8633}out(c, (enc(m2_7722,pkCli_7687),sign(h(m2_7722),skSess_7602)));
                                                            {8634}let Ksrv_7723: bitstring = exp(PartC_7717,Ns_7718) in
                                                            {8635}out(c, senc(mSrv(pkCli_7687,pkSess_7603),Ksrv_7723))
                                                    )
                                                    else
                                                        {8636}let pkDisco_7724: bitstring = pub(sk(Disco_5317)) in
                                                        {8637}in(c, (=pkCli_7687,em1_7725: bitstring,sigM1_7726: bitstring));
                                                        {8638}let m1_7727: bitstring = dec(em1_7725,skSess_7602) in
                                                        {8639}if (verify(h(m1_7727),sigM1_7726,pkCli_7687) <> true) then
                                                            0
                                                        else
                                                            {8640}let (=OpenSecureChannelRequest,=pkCli_7687,PartC_7728: bitstring) = m1_7727 in
                                                            {8641}new Ns_7729: bitstring;
                                                            {8642}new ST_7730: bitstring;
                                                            {8643}new TTL_7731: bitstring;
                                                            {8644}let gNs_7732: bitstring = exp(g,Ns_7729) in
                                                            {8645}let m2_7733: bitstring = (OpenSecureChannelResponse,gNs_7732,ST_7730,TTL_7731) in
                                                            {8646}out(c, (enc(m2_7733,pkCli_7687),sign(h(m2_7733),skSess_7602)));
                                                            {8647}let Ksrv_7734: bitstring = exp(PartC_7728,Ns_7729) in
                                                            {8648}out(c, senc(mSrv(pkCli_7687,pkSess_7603),Ksrv_7734))
                                                )
                                                else
                                                    {8649}let pkDisco_7735: bitstring = fail-any in
                                                    {8650}in(c, (=pkCli_7687,em1_7736: bitstring,sigM1_7737: bitstring));
                                                    {8651}let m1_7738: bitstring = dec(em1_7736,skSess_7602) in
                                                    {8652}if (verify(h(m1_7738),sigM1_7737,pkCli_7687) <> true) then
                                                        0
                                                    else
                                                        {8653}let (=OpenSecureChannelRequest,=pkCli_7687,PartC_7739: bitstring) = m1_7738 in
                                                        {8654}new Ns_7740: bitstring;
                                                        {8655}new ST_7741: bitstring;
                                                        {8656}new TTL_7742: bitstring;
                                                        {8657}let gNs_7743: bitstring = exp(g,Ns_7740) in
                                                        {8658}let m2_7744: bitstring = (OpenSecureChannelResponse,gNs_7743,ST_7741,TTL_7742) in
                                                        {8659}out(c, (enc(m2_7744,pkCli_7687),sign(h(m2_7744),skSess_7602)));
                                                        {8660}let Ksrv_7745: bitstring = exp(PartC_7739,Ns_7740) in
                                                        {8661}out(c, senc(mSrv(pkCli_7687,pkSess_7603),Ksrv_7745))
                                        )
                                        else
                                            {8662}let pkDisco_7746: bitstring = fail-any in
                                            {8663}in(c, (=pkCli_7687,em1_7747: bitstring,sigM1_7748: bitstring));
                                            {8664}let m1_7749: bitstring = dec(em1_7747,skSess_7602) in
                                            {8665}if (verify(h(m1_7749),sigM1_7748,pkCli_7687) <> true) then
                                                0
                                            else
                                                {8666}let (=OpenSecureChannelRequest,=pkCli_7687,PartC_7750: bitstring) = m1_7749 in
                                                {8667}new Ns_7751: bitstring;
                                                {8668}new ST_7752: bitstring;
                                                {8669}new TTL_7753: bitstring;
                                                {8670}let gNs_7754: bitstring = exp(g,Ns_7751) in
                                                {8671}let m2_7755: bitstring = (OpenSecureChannelResponse,gNs_7754,ST_7752,TTL_7753) in
                                                {8672}out(c, (enc(m2_7755,pkCli_7687),sign(h(m2_7755),skSess_7602)));
                                                {8673}let Ksrv_7756: bitstring = exp(PartC_7750,Ns_7751) in
                                                {8674}out(c, senc(mSrv(pkCli_7687,pkSess_7603),Ksrv_7756))
                                )
                                else
                                    {8675}let pkDisco_7757: bitstring = fail-any in
                                    {8676}in(c, (=pkCli_7687,em1_7758: bitstring,sigM1_7759: bitstring));
                                    {8677}let m1_7760: bitstring = dec(em1_7758,skSess_7602) in
                                    {8678}if (verify(h(m1_7760),sigM1_7759,pkCli_7687) <> true) then
                                        0
                                    else
                                        {8679}let (=OpenSecureChannelRequest,=pkCli_7687,PartC_7761: bitstring) = m1_7760 in
                                        {8680}new Ns_7762: bitstring;
                                        {8681}new ST_7763: bitstring;
                                        {8682}new TTL_7764: bitstring;
                                        {8683}let gNs_7765: bitstring = exp(g,Ns_7762) in
                                        {8684}let m2_7766: bitstring = (OpenSecureChannelResponse,gNs_7765,ST_7763,TTL_7764) in
                                        {8685}out(c, (enc(m2_7766,pkCli_7687),sign(h(m2_7766),skSess_7602)));
                                        {8686}let Ksrv_7767: bitstring = exp(PartC_7761,Ns_7762) in
                                        {8687}out(c, senc(mSrv(pkCli_7687,pkSess_7603),Ksrv_7767))
                            )
                            else
                                {8688}let v_7768: bool = (Cli_5316 = C) in
                                (
                                    {8689}if v_7768 then
                                    (
                                        {8690}let pkCli_7769: bitstring = pub(skC) in
                                        {8691}let v_7770: bool = (Disco_5317 = A) in
                                        (
                                            {8692}if v_7770 then
                                            (
                                                {8693}let pkDisco_7771: bitstring = pub(skA) in
                                                {8694}in(c, (=pkCli_7769,em1_7772: bitstring,sigM1_7773: bitstring));
                                                {8695}let m1_7774: bitstring = dec(em1_7772,skSess_7602) in
                                                {8696}if (verify(h(m1_7774),sigM1_7773,pkCli_7769) <> true) then
                                                    0
                                                else
                                                    {8697}let (=OpenSecureChannelRequest,=pkCli_7769,PartC_7775: bitstring) = m1_7774 in
                                                    {8698}new Ns_7776: bitstring;
                                                    {8699}new ST_7777: bitstring;
                                                    {8700}new TTL_7778: bitstring;
                                                    {8701}let gNs_7779: bitstring = exp(g,Ns_7776) in
                                                    {8702}let m2_7780: bitstring = (OpenSecureChannelResponse,gNs_7779,ST_7777,TTL_7778) in
                                                    {8703}out(c, (enc(m2_7780,pkCli_7769),sign(h(m2_7780),skSess_7602)));
                                                    {8704}let Ksrv_7781: bitstring = exp(PartC_7775,Ns_7776) in
                                                    {8705}out(c, senc(mSrv(pkCli_7769,pkSess_7603),Ksrv_7781))
                                            )
                                            else
                                                {8706}let v_7782: bool = (Disco_5317 = B) in
                                                (
                                                    {8707}if v_7782 then
                                                    (
                                                        {8708}let pkDisco_7783: bitstring = pub(skB) in
                                                        {8709}in(c, (=pkCli_7769,em1_7784: bitstring,sigM1_7785: bitstring));
                                                        {8710}let m1_7786: bitstring = dec(em1_7784,skSess_7602) in
                                                        {8711}if (verify(h(m1_7786),sigM1_7785,pkCli_7769) <> true) then
                                                            0
                                                        else
                                                            {8712}let (=OpenSecureChannelRequest,=pkCli_7769,PartC_7787: bitstring) = m1_7786 in
                                                            {8713}new Ns_7788: bitstring;
                                                            {8714}new ST_7789: bitstring;
                                                            {8715}new TTL_7790: bitstring;
                                                            {8716}let gNs_7791: bitstring = exp(g,Ns_7788) in
                                                            {8717}let m2_7792: bitstring = (OpenSecureChannelResponse,gNs_7791,ST_7789,TTL_7790) in
                                                            {8718}out(c, (enc(m2_7792,pkCli_7769),sign(h(m2_7792),skSess_7602)));
                                                            {8719}let Ksrv_7793: bitstring = exp(PartC_7787,Ns_7788) in
                                                            {8720}out(c, senc(mSrv(pkCli_7769,pkSess_7603),Ksrv_7793))
                                                    )
                                                    else
                                                        {8721}let v_7794: bool = (Disco_5317 = C) in
                                                        (
                                                            {8722}if v_7794 then
                                                            (
                                                                {8723}let pkDisco_7795: bitstring = pub(skC) in
                                                                {8724}in(c, (=pkCli_7769,em1_7796: bitstring,sigM1_7797: bitstring));
                                                                {8725}let m1_7798: bitstring = dec(em1_7796,skSess_7602) in
                                                                {8726}if (verify(h(m1_7798),sigM1_7797,pkCli_7769) <> true) then
                                                                    0
                                                                else
                                                                    {8727}let (=OpenSecureChannelRequest,=pkCli_7769,PartC_7799: bitstring) = m1_7798 in
                                                                    {8728}new Ns_7800: bitstring;
                                                                    {8729}new ST_7801: bitstring;
                                                                    {8730}new TTL_7802: bitstring;
                                                                    {8731}let gNs_7803: bitstring = exp(g,Ns_7800) in
                                                                    {8732}let m2_7804: bitstring = (OpenSecureChannelResponse,gNs_7803,ST_7801,TTL_7802) in
                                                                    {8733}out(c, (enc(m2_7804,pkCli_7769),sign(h(m2_7804),skSess_7602)));
                                                                    {8734}let Ksrv_7805: bitstring = exp(PartC_7799,Ns_7800) in
                                                                    {8735}out(c, senc(mSrv(pkCli_7769,pkSess_7603),Ksrv_7805))
                                                            )
                                                            else
                                                                {8736}let pkDisco_7806: bitstring = pub(sk(Disco_5317)) in
                                                                {8737}in(c, (=pkCli_7769,em1_7807: bitstring,sigM1_7808: bitstring));
                                                                {8738}let m1_7809: bitstring = dec(em1_7807,skSess_7602) in
                                                                {8739}if (verify(h(m1_7809),sigM1_7808,pkCli_7769) <> true) then
                                                                    0
                                                                else
                                                                    {8740}let (=OpenSecureChannelRequest,=pkCli_7769,PartC_7810: bitstring) = m1_7809 in
                                                                    {8741}new Ns_7811: bitstring;
                                                                    {8742}new ST_7812: bitstring;
                                                                    {8743}new TTL_7813: bitstring;
                                                                    {8744}let gNs_7814: bitstring = exp(g,Ns_7811) in
                                                                    {8745}let m2_7815: bitstring = (OpenSecureChannelResponse,gNs_7814,ST_7812,TTL_7813) in
                                                                    {8746}out(c, (enc(m2_7815,pkCli_7769),sign(h(m2_7815),skSess_7602)));
                                                                    {8747}let Ksrv_7816: bitstring = exp(PartC_7810,Ns_7811) in
                                                                    {8748}out(c, senc(mSrv(pkCli_7769,pkSess_7603),Ksrv_7816))
                                                        )
                                                        else
                                                            {8749}let pkDisco_7817: bitstring = fail-any in
                                                            {8750}in(c, (=pkCli_7769,em1_7818: bitstring,sigM1_7819: bitstring));
                                                            {8751}let m1_7820: bitstring = dec(em1_7818,skSess_7602) in
                                                            {8752}if (verify(h(m1_7820),sigM1_7819,pkCli_7769) <> true) then
                                                                0
                                                            else
                                                                {8753}let (=OpenSecureChannelRequest,=pkCli_7769,PartC_7821: bitstring) = m1_7820 in
                                                                {8754}new Ns_7822: bitstring;
                                                                {8755}new ST_7823: bitstring;
                                                                {8756}new TTL_7824: bitstring;
                                                                {8757}let gNs_7825: bitstring = exp(g,Ns_7822) in
                                                                {8758}let m2_7826: bitstring = (OpenSecureChannelResponse,gNs_7825,ST_7823,TTL_7824) in
                                                                {8759}out(c, (enc(m2_7826,pkCli_7769),sign(h(m2_7826),skSess_7602)));
                                                                {8760}let Ksrv_7827: bitstring = exp(PartC_7821,Ns_7822) in
                                                                {8761}out(c, senc(mSrv(pkCli_7769,pkSess_7603),Ksrv_7827))
                                                )
                                                else
                                                    {8762}let pkDisco_7828: bitstring = fail-any in
                                                    {8763}in(c, (=pkCli_7769,em1_7829: bitstring,sigM1_7830: bitstring));
                                                    {8764}let m1_7831: bitstring = dec(em1_7829,skSess_7602) in
                                                    {8765}if (verify(h(m1_7831),sigM1_7830,pkCli_7769) <> true) then
                                                        0
                                                    else
                                                        {8766}let (=OpenSecureChannelRequest,=pkCli_7769,PartC_7832: bitstring) = m1_7831 in
                                                        {8767}new Ns_7833: bitstring;
                                                        {8768}new ST_7834: bitstring;
                                                        {8769}new TTL_7835: bitstring;
                                                        {8770}let gNs_7836: bitstring = exp(g,Ns_7833) in
                                                        {8771}let m2_7837: bitstring = (OpenSecureChannelResponse,gNs_7836,ST_7834,TTL_7835) in
                                                        {8772}out(c, (enc(m2_7837,pkCli_7769),sign(h(m2_7837),skSess_7602)));
                                                        {8773}let Ksrv_7838: bitstring = exp(PartC_7832,Ns_7833) in
                                                        {8774}out(c, senc(mSrv(pkCli_7769,pkSess_7603),Ksrv_7838))
                                        )
                                        else
                                            {8775}let pkDisco_7839: bitstring = fail-any in
                                            {8776}in(c, (=pkCli_7769,em1_7840: bitstring,sigM1_7841: bitstring));
                                            {8777}let m1_7842: bitstring = dec(em1_7840,skSess_7602) in
                                            {8778}if (verify(h(m1_7842),sigM1_7841,pkCli_7769) <> true) then
                                                0
                                            else
                                                {8779}let (=OpenSecureChannelRequest,=pkCli_7769,PartC_7843: bitstring) = m1_7842 in
                                                {8780}new Ns_7844: bitstring;
                                                {8781}new ST_7845: bitstring;
                                                {8782}new TTL_7846: bitstring;
                                                {8783}let gNs_7847: bitstring = exp(g,Ns_7844) in
                                                {8784}let m2_7848: bitstring = (OpenSecureChannelResponse,gNs_7847,ST_7845,TTL_7846) in
                                                {8785}out(c, (enc(m2_7848,pkCli_7769),sign(h(m2_7848),skSess_7602)));
                                                {8786}let Ksrv_7849: bitstring = exp(PartC_7843,Ns_7844) in
                                                {8787}out(c, senc(mSrv(pkCli_7769,pkSess_7603),Ksrv_7849))
                                    )
                                    else
                                        {8788}let pkCli_7850: bitstring = pub(sk(Cli_5316)) in
                                        {8789}let v_7851: bool = (Disco_5317 = A) in
                                        (
                                            {8790}if v_7851 then
                                            (
                                                {8791}let pkDisco_7852: bitstring = pub(skA) in
                                                {8792}in(c, (=pkCli_7850,em1_7853: bitstring,sigM1_7854: bitstring));
                                                {8793}let m1_7855: bitstring = dec(em1_7853,skSess_7602) in
                                                {8794}if (verify(h(m1_7855),sigM1_7854,pkCli_7850) <> true) then
                                                    0
                                                else
                                                    {8795}let (=OpenSecureChannelRequest,=pkCli_7850,PartC_7856: bitstring) = m1_7855 in
                                                    {8796}new Ns_7857: bitstring;
                                                    {8797}new ST_7858: bitstring;
                                                    {8798}new TTL_7859: bitstring;
                                                    {8799}let gNs_7860: bitstring = exp(g,Ns_7857) in
                                                    {8800}let m2_7861: bitstring = (OpenSecureChannelResponse,gNs_7860,ST_7858,TTL_7859) in
                                                    {8801}out(c, (enc(m2_7861,pkCli_7850),sign(h(m2_7861),skSess_7602)));
                                                    {8802}let Ksrv_7862: bitstring = exp(PartC_7856,Ns_7857) in
                                                    {8803}out(c, senc(mSrv(pkCli_7850,pkSess_7603),Ksrv_7862))
                                            )
                                            else
                                                {8804}let v_7863: bool = (Disco_5317 = B) in
                                                (
                                                    {8805}if v_7863 then
                                                    (
                                                        {8806}let pkDisco_7864: bitstring = pub(skB) in
                                                        {8807}in(c, (=pkCli_7850,em1_7865: bitstring,sigM1_7866: bitstring));
                                                        {8808}let m1_7867: bitstring = dec(em1_7865,skSess_7602) in
                                                        {8809}if (verify(h(m1_7867),sigM1_7866,pkCli_7850) <> true) then
                                                            0
                                                        else
                                                            {8810}let (=OpenSecureChannelRequest,=pkCli_7850,PartC_7868: bitstring) = m1_7867 in
                                                            {8811}new Ns_7869: bitstring;
                                                            {8812}new ST_7870: bitstring;
                                                            {8813}new TTL_7871: bitstring;
                                                            {8814}let gNs_7872: bitstring = exp(g,Ns_7869) in
                                                            {8815}let m2_7873: bitstring = (OpenSecureChannelResponse,gNs_7872,ST_7870,TTL_7871) in
                                                            {8816}out(c, (enc(m2_7873,pkCli_7850),sign(h(m2_7873),skSess_7602)));
                                                            {8817}let Ksrv_7874: bitstring = exp(PartC_7868,Ns_7869) in
                                                            {8818}out(c, senc(mSrv(pkCli_7850,pkSess_7603),Ksrv_7874))
                                                    )
                                                    else
                                                        {8819}let v_7875: bool = (Disco_5317 = C) in
                                                        (
                                                            {8820}if v_7875 then
                                                            (
                                                                {8821}let pkDisco_7876: bitstring = pub(skC) in
                                                                {8822}in(c, (=pkCli_7850,em1_7877: bitstring,sigM1_7878: bitstring));
                                                                {8823}let m1_7879: bitstring = dec(em1_7877,skSess_7602) in
                                                                {8824}if (verify(h(m1_7879),sigM1_7878,pkCli_7850) <> true) then
                                                                    0
                                                                else
                                                                    {8825}let (=OpenSecureChannelRequest,=pkCli_7850,PartC_7880: bitstring) = m1_7879 in
                                                                    {8826}new Ns_7881: bitstring;
                                                                    {8827}new ST_7882: bitstring;
                                                                    {8828}new TTL_7883: bitstring;
                                                                    {8829}let gNs_7884: bitstring = exp(g,Ns_7881) in
                                                                    {8830}let m2_7885: bitstring = (OpenSecureChannelResponse,gNs_7884,ST_7882,TTL_7883) in
                                                                    {8831}out(c, (enc(m2_7885,pkCli_7850),sign(h(m2_7885),skSess_7602)));
                                                                    {8832}let Ksrv_7886: bitstring = exp(PartC_7880,Ns_7881) in
                                                                    {8833}out(c, senc(mSrv(pkCli_7850,pkSess_7603),Ksrv_7886))
                                                            )
                                                            else
                                                                {8834}let pkDisco_7887: bitstring = pub(sk(Disco_5317)) in
                                                                {8835}in(c, (=pkCli_7850,em1_7888: bitstring,sigM1_7889: bitstring));
                                                                {8836}let m1_7890: bitstring = dec(em1_7888,skSess_7602) in
                                                                {8837}if (verify(h(m1_7890),sigM1_7889,pkCli_7850) <> true) then
                                                                    0
                                                                else
                                                                    {8838}let (=OpenSecureChannelRequest,=pkCli_7850,PartC_7891: bitstring) = m1_7890 in
                                                                    {8839}new Ns_7892: bitstring;
                                                                    {8840}new ST_7893: bitstring;
                                                                    {8841}new TTL_7894: bitstring;
                                                                    {8842}let gNs_7895: bitstring = exp(g,Ns_7892) in
                                                                    {8843}let m2_7896: bitstring = (OpenSecureChannelResponse,gNs_7895,ST_7893,TTL_7894) in
                                                                    {8844}out(c, (enc(m2_7896,pkCli_7850),sign(h(m2_7896),skSess_7602)));
                                                                    {8845}let Ksrv_7897: bitstring = exp(PartC_7891,Ns_7892) in
                                                                    {8846}out(c, senc(mSrv(pkCli_7850,pkSess_7603),Ksrv_7897))
                                                        )
                                                        else
                                                            {8847}let pkDisco_7898: bitstring = fail-any in
                                                            {8848}in(c, (=pkCli_7850,em1_7899: bitstring,sigM1_7900: bitstring));
                                                            {8849}let m1_7901: bitstring = dec(em1_7899,skSess_7602) in
                                                            {8850}if (verify(h(m1_7901),sigM1_7900,pkCli_7850) <> true) then
                                                                0
                                                            else
                                                                {8851}let (=OpenSecureChannelRequest,=pkCli_7850,PartC_7902: bitstring) = m1_7901 in
                                                                {8852}new Ns_7903: bitstring;
                                                                {8853}new ST_7904: bitstring;
                                                                {8854}new TTL_7905: bitstring;
                                                                {8855}let gNs_7906: bitstring = exp(g,Ns_7903) in
                                                                {8856}let m2_7907: bitstring = (OpenSecureChannelResponse,gNs_7906,ST_7904,TTL_7905) in
                                                                {8857}out(c, (enc(m2_7907,pkCli_7850),sign(h(m2_7907),skSess_7602)));
                                                                {8858}let Ksrv_7908: bitstring = exp(PartC_7902,Ns_7903) in
                                                                {8859}out(c, senc(mSrv(pkCli_7850,pkSess_7603),Ksrv_7908))
                                                )
                                                else
                                                    {8860}let pkDisco_7909: bitstring = fail-any in
                                                    {8861}in(c, (=pkCli_7850,em1_7910: bitstring,sigM1_7911: bitstring));
                                                    {8862}let m1_7912: bitstring = dec(em1_7910,skSess_7602) in
                                                    {8863}if (verify(h(m1_7912),sigM1_7911,pkCli_7850) <> true) then
                                                        0
                                                    else
                                                        {8864}let (=OpenSecureChannelRequest,=pkCli_7850,PartC_7913: bitstring) = m1_7912 in
                                                        {8865}new Ns_7914: bitstring;
                                                        {8866}new ST_7915: bitstring;
                                                        {8867}new TTL_7916: bitstring;
                                                        {8868}let gNs_7917: bitstring = exp(g,Ns_7914) in
                                                        {8869}let m2_7918: bitstring = (OpenSecureChannelResponse,gNs_7917,ST_7915,TTL_7916) in
                                                        {8870}out(c, (enc(m2_7918,pkCli_7850),sign(h(m2_7918),skSess_7602)));
                                                        {8871}let Ksrv_7919: bitstring = exp(PartC_7913,Ns_7914) in
                                                        {8872}out(c, senc(mSrv(pkCli_7850,pkSess_7603),Ksrv_7919))
                                        )
                                        else
                                            {8873}let pkDisco_7920: bitstring = fail-any in
                                            {8874}in(c, (=pkCli_7850,em1_7921: bitstring,sigM1_7922: bitstring));
                                            {8875}let m1_7923: bitstring = dec(em1_7921,skSess_7602) in
                                            {8876}if (verify(h(m1_7923),sigM1_7922,pkCli_7850) <> true) then
                                                0
                                            else
                                                {8877}let (=OpenSecureChannelRequest,=pkCli_7850,PartC_7924: bitstring) = m1_7923 in
                                                {8878}new Ns_7925: bitstring;
                                                {8879}new ST_7926: bitstring;
                                                {8880}new TTL_7927: bitstring;
                                                {8881}let gNs_7928: bitstring = exp(g,Ns_7925) in
                                                {8882}let m2_7929: bitstring = (OpenSecureChannelResponse,gNs_7928,ST_7926,TTL_7927) in
                                                {8883}out(c, (enc(m2_7929,pkCli_7850),sign(h(m2_7929),skSess_7602)));
                                                {8884}let Ksrv_7930: bitstring = exp(PartC_7924,Ns_7925) in
                                                {8885}out(c, senc(mSrv(pkCli_7850,pkSess_7603),Ksrv_7930))
                                )
                                else
                                    {8886}let pkCli_7931: bitstring = fail-any in
                                    {8887}let v_7932: bool = (Disco_5317 = A) in
                                    (
                                        {8888}if v_7932 then
                                        (
                                            {8889}let pkDisco_7933: bitstring = pub(skA) in
                                            {8890}in(c, (=pkCli_7931,em1_7934: bitstring,sigM1_7935: bitstring));
                                            {8891}let m1_7936: bitstring = dec(em1_7934,skSess_7602) in
                                            {8892}if (verify(h(m1_7936),sigM1_7935,pkCli_7931) <> true) then
                                                0
                                            else
                                                {8893}let (=OpenSecureChannelRequest,=pkCli_7931,PartC_7937: bitstring) = m1_7936 in
                                                {8894}new Ns_7938: bitstring;
                                                {8895}new ST_7939: bitstring;
                                                {8896}new TTL_7940: bitstring;
                                                {8897}let gNs_7941: bitstring = exp(g,Ns_7938) in
                                                {8898}let m2_7942: bitstring = (OpenSecureChannelResponse,gNs_7941,ST_7939,TTL_7940) in
                                                {8899}out(c, (enc(m2_7942,pkCli_7931),sign(h(m2_7942),skSess_7602)));
                                                {8900}let Ksrv_7943: bitstring = exp(PartC_7937,Ns_7938) in
                                                {8901}out(c, senc(mSrv(pkCli_7931,pkSess_7603),Ksrv_7943))
                                        )
                                        else
                                            {8902}let v_7944: bool = (Disco_5317 = B) in
                                            (
                                                {8903}if v_7944 then
                                                (
                                                    {8904}let pkDisco_7945: bitstring = pub(skB) in
                                                    {8905}in(c, (=pkCli_7931,em1_7946: bitstring,sigM1_7947: bitstring));
                                                    {8906}let m1_7948: bitstring = dec(em1_7946,skSess_7602) in
                                                    {8907}if (verify(h(m1_7948),sigM1_7947,pkCli_7931) <> true) then
                                                        0
                                                    else
                                                        {8908}let (=OpenSecureChannelRequest,=pkCli_7931,PartC_7949: bitstring) = m1_7948 in
                                                        {8909}new Ns_7950: bitstring;
                                                        {8910}new ST_7951: bitstring;
                                                        {8911}new TTL_7952: bitstring;
                                                        {8912}let gNs_7953: bitstring = exp(g,Ns_7950) in
                                                        {8913}let m2_7954: bitstring = (OpenSecureChannelResponse,gNs_7953,ST_7951,TTL_7952) in
                                                        {8914}out(c, (enc(m2_7954,pkCli_7931),sign(h(m2_7954),skSess_7602)));
                                                        {8915}let Ksrv_7955: bitstring = exp(PartC_7949,Ns_7950) in
                                                        {8916}out(c, senc(mSrv(pkCli_7931,pkSess_7603),Ksrv_7955))
                                                )
                                                else
                                                    {8917}let v_7956: bool = (Disco_5317 = C) in
                                                    (
                                                        {8918}if v_7956 then
                                                        (
                                                            {8919}let pkDisco_7957: bitstring = pub(skC) in
                                                            {8920}in(c, (=pkCli_7931,em1_7958: bitstring,sigM1_7959: bitstring));
                                                            {8921}let m1_7960: bitstring = dec(em1_7958,skSess_7602) in
                                                            {8922}if (verify(h(m1_7960),sigM1_7959,pkCli_7931) <> true) then
                                                                0
                                                            else
                                                                {8923}let (=OpenSecureChannelRequest,=pkCli_7931,PartC_7961: bitstring) = m1_7960 in
                                                                {8924}new Ns_7962: bitstring;
                                                                {8925}new ST_7963: bitstring;
                                                                {8926}new TTL_7964: bitstring;
                                                                {8927}let gNs_7965: bitstring = exp(g,Ns_7962) in
                                                                {8928}let m2_7966: bitstring = (OpenSecureChannelResponse,gNs_7965,ST_7963,TTL_7964) in
                                                                {8929}out(c, (enc(m2_7966,pkCli_7931),sign(h(m2_7966),skSess_7602)));
                                                                {8930}let Ksrv_7967: bitstring = exp(PartC_7961,Ns_7962) in
                                                                {8931}out(c, senc(mSrv(pkCli_7931,pkSess_7603),Ksrv_7967))
                                                        )
                                                        else
                                                            {8932}let pkDisco_7968: bitstring = pub(sk(Disco_5317)) in
                                                            {8933}in(c, (=pkCli_7931,em1_7969: bitstring,sigM1_7970: bitstring));
                                                            {8934}let m1_7971: bitstring = dec(em1_7969,skSess_7602) in
                                                            {8935}if (verify(h(m1_7971),sigM1_7970,pkCli_7931) <> true) then
                                                                0
                                                            else
                                                                {8936}let (=OpenSecureChannelRequest,=pkCli_7931,PartC_7972: bitstring) = m1_7971 in
                                                                {8937}new Ns_7973: bitstring;
                                                                {8938}new ST_7974: bitstring;
                                                                {8939}new TTL_7975: bitstring;
                                                                {8940}let gNs_7976: bitstring = exp(g,Ns_7973) in
                                                                {8941}let m2_7977: bitstring = (OpenSecureChannelResponse,gNs_7976,ST_7974,TTL_7975) in
                                                                {8942}out(c, (enc(m2_7977,pkCli_7931),sign(h(m2_7977),skSess_7602)));
                                                                {8943}let Ksrv_7978: bitstring = exp(PartC_7972,Ns_7973) in
                                                                {8944}out(c, senc(mSrv(pkCli_7931,pkSess_7603),Ksrv_7978))
                                                    )
                                                    else
                                                        {8945}let pkDisco_7979: bitstring = fail-any in
                                                        {8946}in(c, (=pkCli_7931,em1_7980: bitstring,sigM1_7981: bitstring));
                                                        {8947}let m1_7982: bitstring = dec(em1_7980,skSess_7602) in
                                                        {8948}if (verify(h(m1_7982),sigM1_7981,pkCli_7931) <> true) then
                                                            0
                                                        else
                                                            {8949}let (=OpenSecureChannelRequest,=pkCli_7931,PartC_7983: bitstring) = m1_7982 in
                                                            {8950}new Ns_7984: bitstring;
                                                            {8951}new ST_7985: bitstring;
                                                            {8952}new TTL_7986: bitstring;
                                                            {8953}let gNs_7987: bitstring = exp(g,Ns_7984) in
                                                            {8954}let m2_7988: bitstring = (OpenSecureChannelResponse,gNs_7987,ST_7985,TTL_7986) in
                                                            {8955}out(c, (enc(m2_7988,pkCli_7931),sign(h(m2_7988),skSess_7602)));
                                                            {8956}let Ksrv_7989: bitstring = exp(PartC_7983,Ns_7984) in
                                                            {8957}out(c, senc(mSrv(pkCli_7931,pkSess_7603),Ksrv_7989))
                                            )
                                            else
                                                {8958}let pkDisco_7990: bitstring = fail-any in
                                                {8959}in(c, (=pkCli_7931,em1_7991: bitstring,sigM1_7992: bitstring));
                                                {8960}let m1_7993: bitstring = dec(em1_7991,skSess_7602) in
                                                {8961}if (verify(h(m1_7993),sigM1_7992,pkCli_7931) <> true) then
                                                    0
                                                else
                                                    {8962}let (=OpenSecureChannelRequest,=pkCli_7931,PartC_7994: bitstring) = m1_7993 in
                                                    {8963}new Ns_7995: bitstring;
                                                    {8964}new ST_7996: bitstring;
                                                    {8965}new TTL_7997: bitstring;
                                                    {8966}let gNs_7998: bitstring = exp(g,Ns_7995) in
                                                    {8967}let m2_7999: bitstring = (OpenSecureChannelResponse,gNs_7998,ST_7996,TTL_7997) in
                                                    {8968}out(c, (enc(m2_7999,pkCli_7931),sign(h(m2_7999),skSess_7602)));
                                                    {8969}let Ksrv_8000: bitstring = exp(PartC_7994,Ns_7995) in
                                                    {8970}out(c, senc(mSrv(pkCli_7931,pkSess_7603),Ksrv_8000))
                                    )
                                    else
                                        {8971}let pkDisco_8001: bitstring = fail-any in
                                        {8972}in(c, (=pkCli_7931,em1_8002: bitstring,sigM1_8003: bitstring));
                                        {8973}let m1_8004: bitstring = dec(em1_8002,skSess_7602) in
                                        {8974}if (verify(h(m1_8004),sigM1_8003,pkCli_7931) <> true) then
                                            0
                                        else
                                            {8975}let (=OpenSecureChannelRequest,=pkCli_7931,PartC_8005: bitstring) = m1_8004 in
                                            {8976}new Ns_8006: bitstring;
                                            {8977}new ST_8007: bitstring;
                                            {8978}new TTL_8008: bitstring;
                                            {8979}let gNs_8009: bitstring = exp(g,Ns_8006) in
                                            {8980}let m2_8010: bitstring = (OpenSecureChannelResponse,gNs_8009,ST_8007,TTL_8008) in
                                            {8981}out(c, (enc(m2_8010,pkCli_7931),sign(h(m2_8010),skSess_7602)));
                                            {8982}let Ksrv_8011: bitstring = exp(PartC_8005,Ns_8006) in
                                            {8983}out(c, senc(mSrv(pkCli_7931,pkSess_7603),Ksrv_8011))
                        )
                        else
                            {8984}let pkCli_8012: bitstring = fail-any in
                            {8985}let v_8013: bool = (Disco_5317 = A) in
                            (
                                {8986}if v_8013 then
                                (
                                    {8987}let pkDisco_8014: bitstring = pub(skA) in
                                    {8988}in(c, (=pkCli_8012,em1_8015: bitstring,sigM1_8016: bitstring));
                                    {8989}let m1_8017: bitstring = dec(em1_8015,skSess_7602) in
                                    {8990}if (verify(h(m1_8017),sigM1_8016,pkCli_8012) <> true) then
                                        0
                                    else
                                        {8991}let (=OpenSecureChannelRequest,=pkCli_8012,PartC_8018: bitstring) = m1_8017 in
                                        {8992}new Ns_8019: bitstring;
                                        {8993}new ST_8020: bitstring;
                                        {8994}new TTL_8021: bitstring;
                                        {8995}let gNs_8022: bitstring = exp(g,Ns_8019) in
                                        {8996}let m2_8023: bitstring = (OpenSecureChannelResponse,gNs_8022,ST_8020,TTL_8021) in
                                        {8997}out(c, (enc(m2_8023,pkCli_8012),sign(h(m2_8023),skSess_7602)));
                                        {8998}let Ksrv_8024: bitstring = exp(PartC_8018,Ns_8019) in
                                        {8999}out(c, senc(mSrv(pkCli_8012,pkSess_7603),Ksrv_8024))
                                )
                                else
                                    {9000}let v_8025: bool = (Disco_5317 = B) in
                                    (
                                        {9001}if v_8025 then
                                        (
                                            {9002}let pkDisco_8026: bitstring = pub(skB) in
                                            {9003}in(c, (=pkCli_8012,em1_8027: bitstring,sigM1_8028: bitstring));
                                            {9004}let m1_8029: bitstring = dec(em1_8027,skSess_7602) in
                                            {9005}if (verify(h(m1_8029),sigM1_8028,pkCli_8012) <> true) then
                                                0
                                            else
                                                {9006}let (=OpenSecureChannelRequest,=pkCli_8012,PartC_8030: bitstring) = m1_8029 in
                                                {9007}new Ns_8031: bitstring;
                                                {9008}new ST_8032: bitstring;
                                                {9009}new TTL_8033: bitstring;
                                                {9010}let gNs_8034: bitstring = exp(g,Ns_8031) in
                                                {9011}let m2_8035: bitstring = (OpenSecureChannelResponse,gNs_8034,ST_8032,TTL_8033) in
                                                {9012}out(c, (enc(m2_8035,pkCli_8012),sign(h(m2_8035),skSess_7602)));
                                                {9013}let Ksrv_8036: bitstring = exp(PartC_8030,Ns_8031) in
                                                {9014}out(c, senc(mSrv(pkCli_8012,pkSess_7603),Ksrv_8036))
                                        )
                                        else
                                            {9015}let v_8037: bool = (Disco_5317 = C) in
                                            (
                                                {9016}if v_8037 then
                                                (
                                                    {9017}let pkDisco_8038: bitstring = pub(skC) in
                                                    {9018}in(c, (=pkCli_8012,em1_8039: bitstring,sigM1_8040: bitstring));
                                                    {9019}let m1_8041: bitstring = dec(em1_8039,skSess_7602) in
                                                    {9020}if (verify(h(m1_8041),sigM1_8040,pkCli_8012) <> true) then
                                                        0
                                                    else
                                                        {9021}let (=OpenSecureChannelRequest,=pkCli_8012,PartC_8042: bitstring) = m1_8041 in
                                                        {9022}new Ns_8043: bitstring;
                                                        {9023}new ST_8044: bitstring;
                                                        {9024}new TTL_8045: bitstring;
                                                        {9025}let gNs_8046: bitstring = exp(g,Ns_8043) in
                                                        {9026}let m2_8047: bitstring = (OpenSecureChannelResponse,gNs_8046,ST_8044,TTL_8045) in
                                                        {9027}out(c, (enc(m2_8047,pkCli_8012),sign(h(m2_8047),skSess_7602)));
                                                        {9028}let Ksrv_8048: bitstring = exp(PartC_8042,Ns_8043) in
                                                        {9029}out(c, senc(mSrv(pkCli_8012,pkSess_7603),Ksrv_8048))
                                                )
                                                else
                                                    {9030}let pkDisco_8049: bitstring = pub(sk(Disco_5317)) in
                                                    {9031}in(c, (=pkCli_8012,em1_8050: bitstring,sigM1_8051: bitstring));
                                                    {9032}let m1_8052: bitstring = dec(em1_8050,skSess_7602) in
                                                    {9033}if (verify(h(m1_8052),sigM1_8051,pkCli_8012) <> true) then
                                                        0
                                                    else
                                                        {9034}let (=OpenSecureChannelRequest,=pkCli_8012,PartC_8053: bitstring) = m1_8052 in
                                                        {9035}new Ns_8054: bitstring;
                                                        {9036}new ST_8055: bitstring;
                                                        {9037}new TTL_8056: bitstring;
                                                        {9038}let gNs_8057: bitstring = exp(g,Ns_8054) in
                                                        {9039}let m2_8058: bitstring = (OpenSecureChannelResponse,gNs_8057,ST_8055,TTL_8056) in
                                                        {9040}out(c, (enc(m2_8058,pkCli_8012),sign(h(m2_8058),skSess_7602)));
                                                        {9041}let Ksrv_8059: bitstring = exp(PartC_8053,Ns_8054) in
                                                        {9042}out(c, senc(mSrv(pkCli_8012,pkSess_7603),Ksrv_8059))
                                            )
                                            else
                                                {9043}let pkDisco_8060: bitstring = fail-any in
                                                {9044}in(c, (=pkCli_8012,em1_8061: bitstring,sigM1_8062: bitstring));
                                                {9045}let m1_8063: bitstring = dec(em1_8061,skSess_7602) in
                                                {9046}if (verify(h(m1_8063),sigM1_8062,pkCli_8012) <> true) then
                                                    0
                                                else
                                                    {9047}let (=OpenSecureChannelRequest,=pkCli_8012,PartC_8064: bitstring) = m1_8063 in
                                                    {9048}new Ns_8065: bitstring;
                                                    {9049}new ST_8066: bitstring;
                                                    {9050}new TTL_8067: bitstring;
                                                    {9051}let gNs_8068: bitstring = exp(g,Ns_8065) in
                                                    {9052}let m2_8069: bitstring = (OpenSecureChannelResponse,gNs_8068,ST_8066,TTL_8067) in
                                                    {9053}out(c, (enc(m2_8069,pkCli_8012),sign(h(m2_8069),skSess_7602)));
                                                    {9054}let Ksrv_8070: bitstring = exp(PartC_8064,Ns_8065) in
                                                    {9055}out(c, senc(mSrv(pkCli_8012,pkSess_7603),Ksrv_8070))
                                    )
                                    else
                                        {9056}let pkDisco_8071: bitstring = fail-any in
                                        {9057}in(c, (=pkCli_8012,em1_8072: bitstring,sigM1_8073: bitstring));
                                        {9058}let m1_8074: bitstring = dec(em1_8072,skSess_7602) in
                                        {9059}if (verify(h(m1_8074),sigM1_8073,pkCli_8012) <> true) then
                                            0
                                        else
                                            {9060}let (=OpenSecureChannelRequest,=pkCli_8012,PartC_8075: bitstring) = m1_8074 in
                                            {9061}new Ns_8076: bitstring;
                                            {9062}new ST_8077: bitstring;
                                            {9063}new TTL_8078: bitstring;
                                            {9064}let gNs_8079: bitstring = exp(g,Ns_8076) in
                                            {9065}let m2_8080: bitstring = (OpenSecureChannelResponse,gNs_8079,ST_8077,TTL_8078) in
                                            {9066}out(c, (enc(m2_8080,pkCli_8012),sign(h(m2_8080),skSess_7602)));
                                            {9067}let Ksrv_8081: bitstring = exp(PartC_8075,Ns_8076) in
                                            {9068}out(c, senc(mSrv(pkCli_8012,pkSess_7603),Ksrv_8081))
                            )
                            else
                                {9069}let pkDisco_8082: bitstring = fail-any in
                                {9070}in(c, (=pkCli_8012,em1_8083: bitstring,sigM1_8084: bitstring));
                                {9071}let m1_8085: bitstring = dec(em1_8083,skSess_7602) in
                                {9072}if (verify(h(m1_8085),sigM1_8084,pkCli_8012) <> true) then
                                    0
                                else
                                    {9073}let (=OpenSecureChannelRequest,=pkCli_8012,PartC_8086: bitstring) = m1_8085 in
                                    {9074}new Ns_8087: bitstring;
                                    {9075}new ST_8088: bitstring;
                                    {9076}new TTL_8089: bitstring;
                                    {9077}let gNs_8090: bitstring = exp(g,Ns_8087) in
                                    {9078}let m2_8091: bitstring = (OpenSecureChannelResponse,gNs_8090,ST_8088,TTL_8089) in
                                    {9079}out(c, (enc(m2_8091,pkCli_8012),sign(h(m2_8091),skSess_7602)));
                                    {9080}let Ksrv_8092: bitstring = exp(PartC_8086,Ns_8087) in
                                    {9081}out(c, senc(mSrv(pkCli_8012,pkSess_7603),Ksrv_8092))
                )
                else
                    {9082}let pkCli_8093: bitstring = fail-any in
                    {9083}let v_8094: bool = (Disco_5317 = A) in
                    (
                        {9084}if v_8094 then
                        (
                            {9085}let pkDisco_8095: bitstring = pub(skA) in
                            {9086}in(c, (=pkCli_8093,em1_8096: bitstring,sigM1_8097: bitstring));
                            {9087}let m1_8098: bitstring = dec(em1_8096,skSess_7602) in
                            {9088}if (verify(h(m1_8098),sigM1_8097,pkCli_8093) <> true) then
                                0
                            else
                                {9089}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8099: bitstring) = m1_8098 in
                                {9090}new Ns_8100: bitstring;
                                {9091}new ST_8101: bitstring;
                                {9092}new TTL_8102: bitstring;
                                {9093}let gNs_8103: bitstring = exp(g,Ns_8100) in
                                {9094}let m2_8104: bitstring = (OpenSecureChannelResponse,gNs_8103,ST_8101,TTL_8102) in
                                {9095}out(c, (enc(m2_8104,pkCli_8093),sign(h(m2_8104),skSess_7602)));
                                {9096}let Ksrv_8105: bitstring = exp(PartC_8099,Ns_8100) in
                                {9097}out(c, senc(mSrv(pkCli_8093,pkSess_7603),Ksrv_8105))
                        )
                        else
                            {9098}let v_8106: bool = (Disco_5317 = B) in
                            (
                                {9099}if v_8106 then
                                (
                                    {9100}let pkDisco_8107: bitstring = pub(skB) in
                                    {9101}in(c, (=pkCli_8093,em1_8108: bitstring,sigM1_8109: bitstring));
                                    {9102}let m1_8110: bitstring = dec(em1_8108,skSess_7602) in
                                    {9103}if (verify(h(m1_8110),sigM1_8109,pkCli_8093) <> true) then
                                        0
                                    else
                                        {9104}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8111: bitstring) = m1_8110 in
                                        {9105}new Ns_8112: bitstring;
                                        {9106}new ST_8113: bitstring;
                                        {9107}new TTL_8114: bitstring;
                                        {9108}let gNs_8115: bitstring = exp(g,Ns_8112) in
                                        {9109}let m2_8116: bitstring = (OpenSecureChannelResponse,gNs_8115,ST_8113,TTL_8114) in
                                        {9110}out(c, (enc(m2_8116,pkCli_8093),sign(h(m2_8116),skSess_7602)));
                                        {9111}let Ksrv_8117: bitstring = exp(PartC_8111,Ns_8112) in
                                        {9112}out(c, senc(mSrv(pkCli_8093,pkSess_7603),Ksrv_8117))
                                )
                                else
                                    {9113}let v_8118: bool = (Disco_5317 = C) in
                                    (
                                        {9114}if v_8118 then
                                        (
                                            {9115}let pkDisco_8119: bitstring = pub(skC) in
                                            {9116}in(c, (=pkCli_8093,em1_8120: bitstring,sigM1_8121: bitstring));
                                            {9117}let m1_8122: bitstring = dec(em1_8120,skSess_7602) in
                                            {9118}if (verify(h(m1_8122),sigM1_8121,pkCli_8093) <> true) then
                                                0
                                            else
                                                {9119}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8123: bitstring) = m1_8122 in
                                                {9120}new Ns_8124: bitstring;
                                                {9121}new ST_8125: bitstring;
                                                {9122}new TTL_8126: bitstring;
                                                {9123}let gNs_8127: bitstring = exp(g,Ns_8124) in
                                                {9124}let m2_8128: bitstring = (OpenSecureChannelResponse,gNs_8127,ST_8125,TTL_8126) in
                                                {9125}out(c, (enc(m2_8128,pkCli_8093),sign(h(m2_8128),skSess_7602)));
                                                {9126}let Ksrv_8129: bitstring = exp(PartC_8123,Ns_8124) in
                                                {9127}out(c, senc(mSrv(pkCli_8093,pkSess_7603),Ksrv_8129))
                                        )
                                        else
                                            {9128}let pkDisco_8130: bitstring = pub(sk(Disco_5317)) in
                                            {9129}in(c, (=pkCli_8093,em1_8131: bitstring,sigM1_8132: bitstring));
                                            {9130}let m1_8133: bitstring = dec(em1_8131,skSess_7602) in
                                            {9131}if (verify(h(m1_8133),sigM1_8132,pkCli_8093) <> true) then
                                                0
                                            else
                                                {9132}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8134: bitstring) = m1_8133 in
                                                {9133}new Ns_8135: bitstring;
                                                {9134}new ST_8136: bitstring;
                                                {9135}new TTL_8137: bitstring;
                                                {9136}let gNs_8138: bitstring = exp(g,Ns_8135) in
                                                {9137}let m2_8139: bitstring = (OpenSecureChannelResponse,gNs_8138,ST_8136,TTL_8137) in
                                                {9138}out(c, (enc(m2_8139,pkCli_8093),sign(h(m2_8139),skSess_7602)));
                                                {9139}let Ksrv_8140: bitstring = exp(PartC_8134,Ns_8135) in
                                                {9140}out(c, senc(mSrv(pkCli_8093,pkSess_7603),Ksrv_8140))
                                    )
                                    else
                                        {9141}let pkDisco_8141: bitstring = fail-any in
                                        {9142}in(c, (=pkCli_8093,em1_8142: bitstring,sigM1_8143: bitstring));
                                        {9143}let m1_8144: bitstring = dec(em1_8142,skSess_7602) in
                                        {9144}if (verify(h(m1_8144),sigM1_8143,pkCli_8093) <> true) then
                                            0
                                        else
                                            {9145}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8145: bitstring) = m1_8144 in
                                            {9146}new Ns_8146: bitstring;
                                            {9147}new ST_8147: bitstring;
                                            {9148}new TTL_8148: bitstring;
                                            {9149}let gNs_8149: bitstring = exp(g,Ns_8146) in
                                            {9150}let m2_8150: bitstring = (OpenSecureChannelResponse,gNs_8149,ST_8147,TTL_8148) in
                                            {9151}out(c, (enc(m2_8150,pkCli_8093),sign(h(m2_8150),skSess_7602)));
                                            {9152}let Ksrv_8151: bitstring = exp(PartC_8145,Ns_8146) in
                                            {9153}out(c, senc(mSrv(pkCli_8093,pkSess_7603),Ksrv_8151))
                            )
                            else
                                {9154}let pkDisco_8152: bitstring = fail-any in
                                {9155}in(c, (=pkCli_8093,em1_8153: bitstring,sigM1_8154: bitstring));
                                {9156}let m1_8155: bitstring = dec(em1_8153,skSess_7602) in
                                {9157}if (verify(h(m1_8155),sigM1_8154,pkCli_8093) <> true) then
                                    0
                                else
                                    {9158}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8156: bitstring) = m1_8155 in
                                    {9159}new Ns_8157: bitstring;
                                    {9160}new ST_8158: bitstring;
                                    {9161}new TTL_8159: bitstring;
                                    {9162}let gNs_8160: bitstring = exp(g,Ns_8157) in
                                    {9163}let m2_8161: bitstring = (OpenSecureChannelResponse,gNs_8160,ST_8158,TTL_8159) in
                                    {9164}out(c, (enc(m2_8161,pkCli_8093),sign(h(m2_8161),skSess_7602)));
                                    {9165}let Ksrv_8162: bitstring = exp(PartC_8156,Ns_8157) in
                                    {9166}out(c, senc(mSrv(pkCli_8093,pkSess_7603),Ksrv_8162))
                    )
                    else
                        {9167}let pkDisco_8163: bitstring = fail-any in
                        {9168}in(c, (=pkCli_8093,em1_8164: bitstring,sigM1_8165: bitstring));
                        {9169}let m1_8166: bitstring = dec(em1_8164,skSess_7602) in
                        {9170}if (verify(h(m1_8166),sigM1_8165,pkCli_8093) <> true) then
                            0
                        else
                            {9171}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8167: bitstring) = m1_8166 in
                            {9172}new Ns_8168: bitstring;
                            {9173}new ST_8169: bitstring;
                            {9174}new TTL_8170: bitstring;
                            {9175}let gNs_8171: bitstring = exp(g,Ns_8168) in
                            {9176}let m2_8172: bitstring = (OpenSecureChannelResponse,gNs_8171,ST_8169,TTL_8170) in
                            {9177}out(c, (enc(m2_8172,pkCli_8093),sign(h(m2_8172),skSess_7602)));
                            {9178}let Ksrv_8173: bitstring = exp(PartC_8167,Ns_8168) in
                            {9179}out(c, senc(mSrv(pkCli_8093,pkSess_7603),Ksrv_8173))
    )
    else
        {9180}let skSess_8174: bitstring = fail-any in
        {9181}let pkSess_8175: bitstring = pub(skSess_8174) in
        {9182}let v_8176: bool = (Cli_5316 = A) in
        (
            {9183}if v_8176 then
            (
                {9184}let pkCli_8177: bitstring = pub(skA) in
                {9185}let v_8178: bool = (Disco_5317 = A) in
                (
                    {9186}if v_8178 then
                    (
                        {9187}let pkDisco_8179: bitstring = pub(skA) in
                        {9188}in(c, (=pkCli_8177,em1_8180: bitstring,sigM1_8181: bitstring));
                        {9189}let m1_8182: bitstring = dec(em1_8180,skSess_8174) in
                        {9190}if (verify(h(m1_8182),sigM1_8181,pkCli_8177) <> true) then
                            0
                        else
                            {9191}let (=OpenSecureChannelRequest,=pkCli_8177,PartC_8183: bitstring) = m1_8182 in
                            {9192}new Ns_8184: bitstring;
                            {9193}new ST_8185: bitstring;
                            {9194}new TTL_8186: bitstring;
                            {9195}let gNs_8187: bitstring = exp(g,Ns_8184) in
                            {9196}let m2_8188: bitstring = (OpenSecureChannelResponse,gNs_8187,ST_8185,TTL_8186) in
                            {9197}out(c, (enc(m2_8188,pkCli_8177),sign(h(m2_8188),skSess_8174)));
                            {9198}let Ksrv_8189: bitstring = exp(PartC_8183,Ns_8184) in
                            {9199}out(c, senc(mSrv(pkCli_8177,pkSess_8175),Ksrv_8189))
                    )
                    else
                        {9200}let v_8190: bool = (Disco_5317 = B) in
                        (
                            {9201}if v_8190 then
                            (
                                {9202}let pkDisco_8191: bitstring = pub(skB) in
                                {9203}in(c, (=pkCli_8177,em1_8192: bitstring,sigM1_8193: bitstring));
                                {9204}let m1_8194: bitstring = dec(em1_8192,skSess_8174) in
                                {9205}if (verify(h(m1_8194),sigM1_8193,pkCli_8177) <> true) then
                                    0
                                else
                                    {9206}let (=OpenSecureChannelRequest,=pkCli_8177,PartC_8195: bitstring) = m1_8194 in
                                    {9207}new Ns_8196: bitstring;
                                    {9208}new ST_8197: bitstring;
                                    {9209}new TTL_8198: bitstring;
                                    {9210}let gNs_8199: bitstring = exp(g,Ns_8196) in
                                    {9211}let m2_8200: bitstring = (OpenSecureChannelResponse,gNs_8199,ST_8197,TTL_8198) in
                                    {9212}out(c, (enc(m2_8200,pkCli_8177),sign(h(m2_8200),skSess_8174)));
                                    {9213}let Ksrv_8201: bitstring = exp(PartC_8195,Ns_8196) in
                                    {9214}out(c, senc(mSrv(pkCli_8177,pkSess_8175),Ksrv_8201))
                            )
                            else
                                {9215}let v_8202: bool = (Disco_5317 = C) in
                                (
                                    {9216}if v_8202 then
                                    (
                                        {9217}let pkDisco_8203: bitstring = pub(skC) in
                                        {9218}in(c, (=pkCli_8177,em1_8204: bitstring,sigM1_8205: bitstring));
                                        {9219}let m1_8206: bitstring = dec(em1_8204,skSess_8174) in
                                        {9220}if (verify(h(m1_8206),sigM1_8205,pkCli_8177) <> true) then
                                            0
                                        else
                                            {9221}let (=OpenSecureChannelRequest,=pkCli_8177,PartC_8207: bitstring) = m1_8206 in
                                            {9222}new Ns_8208: bitstring;
                                            {9223}new ST_8209: bitstring;
                                            {9224}new TTL_8210: bitstring;
                                            {9225}let gNs_8211: bitstring = exp(g,Ns_8208) in
                                            {9226}let m2_8212: bitstring = (OpenSecureChannelResponse,gNs_8211,ST_8209,TTL_8210) in
                                            {9227}out(c, (enc(m2_8212,pkCli_8177),sign(h(m2_8212),skSess_8174)));
                                            {9228}let Ksrv_8213: bitstring = exp(PartC_8207,Ns_8208) in
                                            {9229}out(c, senc(mSrv(pkCli_8177,pkSess_8175),Ksrv_8213))
                                    )
                                    else
                                        {9230}let pkDisco_8214: bitstring = pub(sk(Disco_5317)) in
                                        {9231}in(c, (=pkCli_8177,em1_8215: bitstring,sigM1_8216: bitstring));
                                        {9232}let m1_8217: bitstring = dec(em1_8215,skSess_8174) in
                                        {9233}if (verify(h(m1_8217),sigM1_8216,pkCli_8177) <> true) then
                                            0
                                        else
                                            {9234}let (=OpenSecureChannelRequest,=pkCli_8177,PartC_8218: bitstring) = m1_8217 in
                                            {9235}new Ns_8219: bitstring;
                                            {9236}new ST_8220: bitstring;
                                            {9237}new TTL_8221: bitstring;
                                            {9238}let gNs_8222: bitstring = exp(g,Ns_8219) in
                                            {9239}let m2_8223: bitstring = (OpenSecureChannelResponse,gNs_8222,ST_8220,TTL_8221) in
                                            {9240}out(c, (enc(m2_8223,pkCli_8177),sign(h(m2_8223),skSess_8174)));
                                            {9241}let Ksrv_8224: bitstring = exp(PartC_8218,Ns_8219) in
                                            {9242}out(c, senc(mSrv(pkCli_8177,pkSess_8175),Ksrv_8224))
                                )
                                else
                                    {9243}let pkDisco_8225: bitstring = fail-any in
                                    {9244}in(c, (=pkCli_8177,em1_8226: bitstring,sigM1_8227: bitstring));
                                    {9245}let m1_8228: bitstring = dec(em1_8226,skSess_8174) in
                                    {9246}if (verify(h(m1_8228),sigM1_8227,pkCli_8177) <> true) then
                                        0
                                    else
                                        {9247}let (=OpenSecureChannelRequest,=pkCli_8177,PartC_8229: bitstring) = m1_8228 in
                                        {9248}new Ns_8230: bitstring;
                                        {9249}new ST_8231: bitstring;
                                        {9250}new TTL_8232: bitstring;
                                        {9251}let gNs_8233: bitstring = exp(g,Ns_8230) in
                                        {9252}let m2_8234: bitstring = (OpenSecureChannelResponse,gNs_8233,ST_8231,TTL_8232) in
                                        {9253}out(c, (enc(m2_8234,pkCli_8177),sign(h(m2_8234),skSess_8174)));
                                        {9254}let Ksrv_8235: bitstring = exp(PartC_8229,Ns_8230) in
                                        {9255}out(c, senc(mSrv(pkCli_8177,pkSess_8175),Ksrv_8235))
                        )
                        else
                            {9256}let pkDisco_8236: bitstring = fail-any in
                            {9257}in(c, (=pkCli_8177,em1_8237: bitstring,sigM1_8238: bitstring));
                            {9258}let m1_8239: bitstring = dec(em1_8237,skSess_8174) in
                            {9259}if (verify(h(m1_8239),sigM1_8238,pkCli_8177) <> true) then
                                0
                            else
                                {9260}let (=OpenSecureChannelRequest,=pkCli_8177,PartC_8240: bitstring) = m1_8239 in
                                {9261}new Ns_8241: bitstring;
                                {9262}new ST_8242: bitstring;
                                {9263}new TTL_8243: bitstring;
                                {9264}let gNs_8244: bitstring = exp(g,Ns_8241) in
                                {9265}let m2_8245: bitstring = (OpenSecureChannelResponse,gNs_8244,ST_8242,TTL_8243) in
                                {9266}out(c, (enc(m2_8245,pkCli_8177),sign(h(m2_8245),skSess_8174)));
                                {9267}let Ksrv_8246: bitstring = exp(PartC_8240,Ns_8241) in
                                {9268}out(c, senc(mSrv(pkCli_8177,pkSess_8175),Ksrv_8246))
                )
                else
                    {9269}let pkDisco_8247: bitstring = fail-any in
                    {9270}in(c, (=pkCli_8177,em1_8248: bitstring,sigM1_8249: bitstring));
                    {9271}let m1_8250: bitstring = dec(em1_8248,skSess_8174) in
                    {9272}if (verify(h(m1_8250),sigM1_8249,pkCli_8177) <> true) then
                        0
                    else
                        {9273}let (=OpenSecureChannelRequest,=pkCli_8177,PartC_8251: bitstring) = m1_8250 in
                        {9274}new Ns_8252: bitstring;
                        {9275}new ST_8253: bitstring;
                        {9276}new TTL_8254: bitstring;
                        {9277}let gNs_8255: bitstring = exp(g,Ns_8252) in
                        {9278}let m2_8256: bitstring = (OpenSecureChannelResponse,gNs_8255,ST_8253,TTL_8254) in
                        {9279}out(c, (enc(m2_8256,pkCli_8177),sign(h(m2_8256),skSess_8174)));
                        {9280}let Ksrv_8257: bitstring = exp(PartC_8251,Ns_8252) in
                        {9281}out(c, senc(mSrv(pkCli_8177,pkSess_8175),Ksrv_8257))
            )
            else
                {9282}let v_8258: bool = (Cli_5316 = B) in
                (
                    {9283}if v_8258 then
                    (
                        {9284}let pkCli_8259: bitstring = pub(skB) in
                        {9285}let v_8260: bool = (Disco_5317 = A) in
                        (
                            {9286}if v_8260 then
                            (
                                {9287}let pkDisco_8261: bitstring = pub(skA) in
                                {9288}in(c, (=pkCli_8259,em1_8262: bitstring,sigM1_8263: bitstring));
                                {9289}let m1_8264: bitstring = dec(em1_8262,skSess_8174) in
                                {9290}if (verify(h(m1_8264),sigM1_8263,pkCli_8259) <> true) then
                                    0
                                else
                                    {9291}let (=OpenSecureChannelRequest,=pkCli_8259,PartC_8265: bitstring) = m1_8264 in
                                    {9292}new Ns_8266: bitstring;
                                    {9293}new ST_8267: bitstring;
                                    {9294}new TTL_8268: bitstring;
                                    {9295}let gNs_8269: bitstring = exp(g,Ns_8266) in
                                    {9296}let m2_8270: bitstring = (OpenSecureChannelResponse,gNs_8269,ST_8267,TTL_8268) in
                                    {9297}out(c, (enc(m2_8270,pkCli_8259),sign(h(m2_8270),skSess_8174)));
                                    {9298}let Ksrv_8271: bitstring = exp(PartC_8265,Ns_8266) in
                                    {9299}out(c, senc(mSrv(pkCli_8259,pkSess_8175),Ksrv_8271))
                            )
                            else
                                {9300}let v_8272: bool = (Disco_5317 = B) in
                                (
                                    {9301}if v_8272 then
                                    (
                                        {9302}let pkDisco_8273: bitstring = pub(skB) in
                                        {9303}in(c, (=pkCli_8259,em1_8274: bitstring,sigM1_8275: bitstring));
                                        {9304}let m1_8276: bitstring = dec(em1_8274,skSess_8174) in
                                        {9305}if (verify(h(m1_8276),sigM1_8275,pkCli_8259) <> true) then
                                            0
                                        else
                                            {9306}let (=OpenSecureChannelRequest,=pkCli_8259,PartC_8277: bitstring) = m1_8276 in
                                            {9307}new Ns_8278: bitstring;
                                            {9308}new ST_8279: bitstring;
                                            {9309}new TTL_8280: bitstring;
                                            {9310}let gNs_8281: bitstring = exp(g,Ns_8278) in
                                            {9311}let m2_8282: bitstring = (OpenSecureChannelResponse,gNs_8281,ST_8279,TTL_8280) in
                                            {9312}out(c, (enc(m2_8282,pkCli_8259),sign(h(m2_8282),skSess_8174)));
                                            {9313}let Ksrv_8283: bitstring = exp(PartC_8277,Ns_8278) in
                                            {9314}out(c, senc(mSrv(pkCli_8259,pkSess_8175),Ksrv_8283))
                                    )
                                    else
                                        {9315}let v_8284: bool = (Disco_5317 = C) in
                                        (
                                            {9316}if v_8284 then
                                            (
                                                {9317}let pkDisco_8285: bitstring = pub(skC) in
                                                {9318}in(c, (=pkCli_8259,em1_8286: bitstring,sigM1_8287: bitstring));
                                                {9319}let m1_8288: bitstring = dec(em1_8286,skSess_8174) in
                                                {9320}if (verify(h(m1_8288),sigM1_8287,pkCli_8259) <> true) then
                                                    0
                                                else
                                                    {9321}let (=OpenSecureChannelRequest,=pkCli_8259,PartC_8289: bitstring) = m1_8288 in
                                                    {9322}new Ns_8290: bitstring;
                                                    {9323}new ST_8291: bitstring;
                                                    {9324}new TTL_8292: bitstring;
                                                    {9325}let gNs_8293: bitstring = exp(g,Ns_8290) in
                                                    {9326}let m2_8294: bitstring = (OpenSecureChannelResponse,gNs_8293,ST_8291,TTL_8292) in
                                                    {9327}out(c, (enc(m2_8294,pkCli_8259),sign(h(m2_8294),skSess_8174)));
                                                    {9328}let Ksrv_8295: bitstring = exp(PartC_8289,Ns_8290) in
                                                    {9329}out(c, senc(mSrv(pkCli_8259,pkSess_8175),Ksrv_8295))
                                            )
                                            else
                                                {9330}let pkDisco_8296: bitstring = pub(sk(Disco_5317)) in
                                                {9331}in(c, (=pkCli_8259,em1_8297: bitstring,sigM1_8298: bitstring));
                                                {9332}let m1_8299: bitstring = dec(em1_8297,skSess_8174) in
                                                {9333}if (verify(h(m1_8299),sigM1_8298,pkCli_8259) <> true) then
                                                    0
                                                else
                                                    {9334}let (=OpenSecureChannelRequest,=pkCli_8259,PartC_8300: bitstring) = m1_8299 in
                                                    {9335}new Ns_8301: bitstring;
                                                    {9336}new ST_8302: bitstring;
                                                    {9337}new TTL_8303: bitstring;
                                                    {9338}let gNs_8304: bitstring = exp(g,Ns_8301) in
                                                    {9339}let m2_8305: bitstring = (OpenSecureChannelResponse,gNs_8304,ST_8302,TTL_8303) in
                                                    {9340}out(c, (enc(m2_8305,pkCli_8259),sign(h(m2_8305),skSess_8174)));
                                                    {9341}let Ksrv_8306: bitstring = exp(PartC_8300,Ns_8301) in
                                                    {9342}out(c, senc(mSrv(pkCli_8259,pkSess_8175),Ksrv_8306))
                                        )
                                        else
                                            {9343}let pkDisco_8307: bitstring = fail-any in
                                            {9344}in(c, (=pkCli_8259,em1_8308: bitstring,sigM1_8309: bitstring));
                                            {9345}let m1_8310: bitstring = dec(em1_8308,skSess_8174) in
                                            {9346}if (verify(h(m1_8310),sigM1_8309,pkCli_8259) <> true) then
                                                0
                                            else
                                                {9347}let (=OpenSecureChannelRequest,=pkCli_8259,PartC_8311: bitstring) = m1_8310 in
                                                {9348}new Ns_8312: bitstring;
                                                {9349}new ST_8313: bitstring;
                                                {9350}new TTL_8314: bitstring;
                                                {9351}let gNs_8315: bitstring = exp(g,Ns_8312) in
                                                {9352}let m2_8316: bitstring = (OpenSecureChannelResponse,gNs_8315,ST_8313,TTL_8314) in
                                                {9353}out(c, (enc(m2_8316,pkCli_8259),sign(h(m2_8316),skSess_8174)));
                                                {9354}let Ksrv_8317: bitstring = exp(PartC_8311,Ns_8312) in
                                                {9355}out(c, senc(mSrv(pkCli_8259,pkSess_8175),Ksrv_8317))
                                )
                                else
                                    {9356}let pkDisco_8318: bitstring = fail-any in
                                    {9357}in(c, (=pkCli_8259,em1_8319: bitstring,sigM1_8320: bitstring));
                                    {9358}let m1_8321: bitstring = dec(em1_8319,skSess_8174) in
                                    {9359}if (verify(h(m1_8321),sigM1_8320,pkCli_8259) <> true) then
                                        0
                                    else
                                        {9360}let (=OpenSecureChannelRequest,=pkCli_8259,PartC_8322: bitstring) = m1_8321 in
                                        {9361}new Ns_8323: bitstring;
                                        {9362}new ST_8324: bitstring;
                                        {9363}new TTL_8325: bitstring;
                                        {9364}let gNs_8326: bitstring = exp(g,Ns_8323) in
                                        {9365}let m2_8327: bitstring = (OpenSecureChannelResponse,gNs_8326,ST_8324,TTL_8325) in
                                        {9366}out(c, (enc(m2_8327,pkCli_8259),sign(h(m2_8327),skSess_8174)));
                                        {9367}let Ksrv_8328: bitstring = exp(PartC_8322,Ns_8323) in
                                        {9368}out(c, senc(mSrv(pkCli_8259,pkSess_8175),Ksrv_8328))
                        )
                        else
                            {9369}let pkDisco_8329: bitstring = fail-any in
                            {9370}in(c, (=pkCli_8259,em1_8330: bitstring,sigM1_8331: bitstring));
                            {9371}let m1_8332: bitstring = dec(em1_8330,skSess_8174) in
                            {9372}if (verify(h(m1_8332),sigM1_8331,pkCli_8259) <> true) then
                                0
                            else
                                {9373}let (=OpenSecureChannelRequest,=pkCli_8259,PartC_8333: bitstring) = m1_8332 in
                                {9374}new Ns_8334: bitstring;
                                {9375}new ST_8335: bitstring;
                                {9376}new TTL_8336: bitstring;
                                {9377}let gNs_8337: bitstring = exp(g,Ns_8334) in
                                {9378}let m2_8338: bitstring = (OpenSecureChannelResponse,gNs_8337,ST_8335,TTL_8336) in
                                {9379}out(c, (enc(m2_8338,pkCli_8259),sign(h(m2_8338),skSess_8174)));
                                {9380}let Ksrv_8339: bitstring = exp(PartC_8333,Ns_8334) in
                                {9381}out(c, senc(mSrv(pkCli_8259,pkSess_8175),Ksrv_8339))
                    )
                    else
                        {9382}let v_8340: bool = (Cli_5316 = C) in
                        (
                            {9383}if v_8340 then
                            (
                                {9384}let pkCli_8341: bitstring = pub(skC) in
                                {9385}let v_8342: bool = (Disco_5317 = A) in
                                (
                                    {9386}if v_8342 then
                                    (
                                        {9387}let pkDisco_8343: bitstring = pub(skA) in
                                        {9388}in(c, (=pkCli_8341,em1_8344: bitstring,sigM1_8345: bitstring));
                                        {9389}let m1_8346: bitstring = dec(em1_8344,skSess_8174) in
                                        {9390}if (verify(h(m1_8346),sigM1_8345,pkCli_8341) <> true) then
                                            0
                                        else
                                            {9391}let (=OpenSecureChannelRequest,=pkCli_8341,PartC_8347: bitstring) = m1_8346 in
                                            {9392}new Ns_8348: bitstring;
                                            {9393}new ST_8349: bitstring;
                                            {9394}new TTL_8350: bitstring;
                                            {9395}let gNs_8351: bitstring = exp(g,Ns_8348) in
                                            {9396}let m2_8352: bitstring = (OpenSecureChannelResponse,gNs_8351,ST_8349,TTL_8350) in
                                            {9397}out(c, (enc(m2_8352,pkCli_8341),sign(h(m2_8352),skSess_8174)));
                                            {9398}let Ksrv_8353: bitstring = exp(PartC_8347,Ns_8348) in
                                            {9399}out(c, senc(mSrv(pkCli_8341,pkSess_8175),Ksrv_8353))
                                    )
                                    else
                                        {9400}let v_8354: bool = (Disco_5317 = B) in
                                        (
                                            {9401}if v_8354 then
                                            (
                                                {9402}let pkDisco_8355: bitstring = pub(skB) in
                                                {9403}in(c, (=pkCli_8341,em1_8356: bitstring,sigM1_8357: bitstring));
                                                {9404}let m1_8358: bitstring = dec(em1_8356,skSess_8174) in
                                                {9405}if (verify(h(m1_8358),sigM1_8357,pkCli_8341) <> true) then
                                                    0
                                                else
                                                    {9406}let (=OpenSecureChannelRequest,=pkCli_8341,PartC_8359: bitstring) = m1_8358 in
                                                    {9407}new Ns_8360: bitstring;
                                                    {9408}new ST_8361: bitstring;
                                                    {9409}new TTL_8362: bitstring;
                                                    {9410}let gNs_8363: bitstring = exp(g,Ns_8360) in
                                                    {9411}let m2_8364: bitstring = (OpenSecureChannelResponse,gNs_8363,ST_8361,TTL_8362) in
                                                    {9412}out(c, (enc(m2_8364,pkCli_8341),sign(h(m2_8364),skSess_8174)));
                                                    {9413}let Ksrv_8365: bitstring = exp(PartC_8359,Ns_8360) in
                                                    {9414}out(c, senc(mSrv(pkCli_8341,pkSess_8175),Ksrv_8365))
                                            )
                                            else
                                                {9415}let v_8366: bool = (Disco_5317 = C) in
                                                (
                                                    {9416}if v_8366 then
                                                    (
                                                        {9417}let pkDisco_8367: bitstring = pub(skC) in
                                                        {9418}in(c, (=pkCli_8341,em1_8368: bitstring,sigM1_8369: bitstring));
                                                        {9419}let m1_8370: bitstring = dec(em1_8368,skSess_8174) in
                                                        {9420}if (verify(h(m1_8370),sigM1_8369,pkCli_8341) <> true) then
                                                            0
                                                        else
                                                            {9421}let (=OpenSecureChannelRequest,=pkCli_8341,PartC_8371: bitstring) = m1_8370 in
                                                            {9422}new Ns_8372: bitstring;
                                                            {9423}new ST_8373: bitstring;
                                                            {9424}new TTL_8374: bitstring;
                                                            {9425}let gNs_8375: bitstring = exp(g,Ns_8372) in
                                                            {9426}let m2_8376: bitstring = (OpenSecureChannelResponse,gNs_8375,ST_8373,TTL_8374) in
                                                            {9427}out(c, (enc(m2_8376,pkCli_8341),sign(h(m2_8376),skSess_8174)));
                                                            {9428}let Ksrv_8377: bitstring = exp(PartC_8371,Ns_8372) in
                                                            {9429}out(c, senc(mSrv(pkCli_8341,pkSess_8175),Ksrv_8377))
                                                    )
                                                    else
                                                        {9430}let pkDisco_8378: bitstring = pub(sk(Disco_5317)) in
                                                        {9431}in(c, (=pkCli_8341,em1_8379: bitstring,sigM1_8380: bitstring));
                                                        {9432}let m1_8381: bitstring = dec(em1_8379,skSess_8174) in
                                                        {9433}if (verify(h(m1_8381),sigM1_8380,pkCli_8341) <> true) then
                                                            0
                                                        else
                                                            {9434}let (=OpenSecureChannelRequest,=pkCli_8341,PartC_8382: bitstring) = m1_8381 in
                                                            {9435}new Ns_8383: bitstring;
                                                            {9436}new ST_8384: bitstring;
                                                            {9437}new TTL_8385: bitstring;
                                                            {9438}let gNs_8386: bitstring = exp(g,Ns_8383) in
                                                            {9439}let m2_8387: bitstring = (OpenSecureChannelResponse,gNs_8386,ST_8384,TTL_8385) in
                                                            {9440}out(c, (enc(m2_8387,pkCli_8341),sign(h(m2_8387),skSess_8174)));
                                                            {9441}let Ksrv_8388: bitstring = exp(PartC_8382,Ns_8383) in
                                                            {9442}out(c, senc(mSrv(pkCli_8341,pkSess_8175),Ksrv_8388))
                                                )
                                                else
                                                    {9443}let pkDisco_8389: bitstring = fail-any in
                                                    {9444}in(c, (=pkCli_8341,em1_8390: bitstring,sigM1_8391: bitstring));
                                                    {9445}let m1_8392: bitstring = dec(em1_8390,skSess_8174) in
                                                    {9446}if (verify(h(m1_8392),sigM1_8391,pkCli_8341) <> true) then
                                                        0
                                                    else
                                                        {9447}let (=OpenSecureChannelRequest,=pkCli_8341,PartC_8393: bitstring) = m1_8392 in
                                                        {9448}new Ns_8394: bitstring;
                                                        {9449}new ST_8395: bitstring;
                                                        {9450}new TTL_8396: bitstring;
                                                        {9451}let gNs_8397: bitstring = exp(g,Ns_8394) in
                                                        {9452}let m2_8398: bitstring = (OpenSecureChannelResponse,gNs_8397,ST_8395,TTL_8396) in
                                                        {9453}out(c, (enc(m2_8398,pkCli_8341),sign(h(m2_8398),skSess_8174)));
                                                        {9454}let Ksrv_8399: bitstring = exp(PartC_8393,Ns_8394) in
                                                        {9455}out(c, senc(mSrv(pkCli_8341,pkSess_8175),Ksrv_8399))
                                        )
                                        else
                                            {9456}let pkDisco_8400: bitstring = fail-any in
                                            {9457}in(c, (=pkCli_8341,em1_8401: bitstring,sigM1_8402: bitstring));
                                            {9458}let m1_8403: bitstring = dec(em1_8401,skSess_8174) in
                                            {9459}if (verify(h(m1_8403),sigM1_8402,pkCli_8341) <> true) then
                                                0
                                            else
                                                {9460}let (=OpenSecureChannelRequest,=pkCli_8341,PartC_8404: bitstring) = m1_8403 in
                                                {9461}new Ns_8405: bitstring;
                                                {9462}new ST_8406: bitstring;
                                                {9463}new TTL_8407: bitstring;
                                                {9464}let gNs_8408: bitstring = exp(g,Ns_8405) in
                                                {9465}let m2_8409: bitstring = (OpenSecureChannelResponse,gNs_8408,ST_8406,TTL_8407) in
                                                {9466}out(c, (enc(m2_8409,pkCli_8341),sign(h(m2_8409),skSess_8174)));
                                                {9467}let Ksrv_8410: bitstring = exp(PartC_8404,Ns_8405) in
                                                {9468}out(c, senc(mSrv(pkCli_8341,pkSess_8175),Ksrv_8410))
                                )
                                else
                                    {9469}let pkDisco_8411: bitstring = fail-any in
                                    {9470}in(c, (=pkCli_8341,em1_8412: bitstring,sigM1_8413: bitstring));
                                    {9471}let m1_8414: bitstring = dec(em1_8412,skSess_8174) in
                                    {9472}if (verify(h(m1_8414),sigM1_8413,pkCli_8341) <> true) then
                                        0
                                    else
                                        {9473}let (=OpenSecureChannelRequest,=pkCli_8341,PartC_8415: bitstring) = m1_8414 in
                                        {9474}new Ns_8416: bitstring;
                                        {9475}new ST_8417: bitstring;
                                        {9476}new TTL_8418: bitstring;
                                        {9477}let gNs_8419: bitstring = exp(g,Ns_8416) in
                                        {9478}let m2_8420: bitstring = (OpenSecureChannelResponse,gNs_8419,ST_8417,TTL_8418) in
                                        {9479}out(c, (enc(m2_8420,pkCli_8341),sign(h(m2_8420),skSess_8174)));
                                        {9480}let Ksrv_8421: bitstring = exp(PartC_8415,Ns_8416) in
                                        {9481}out(c, senc(mSrv(pkCli_8341,pkSess_8175),Ksrv_8421))
                            )
                            else
                                {9482}let pkCli_8422: bitstring = pub(sk(Cli_5316)) in
                                {9483}let v_8423: bool = (Disco_5317 = A) in
                                (
                                    {9484}if v_8423 then
                                    (
                                        {9485}let pkDisco_8424: bitstring = pub(skA) in
                                        {9486}in(c, (=pkCli_8422,em1_8425: bitstring,sigM1_8426: bitstring));
                                        {9487}let m1_8427: bitstring = dec(em1_8425,skSess_8174) in
                                        {9488}if (verify(h(m1_8427),sigM1_8426,pkCli_8422) <> true) then
                                            0
                                        else
                                            {9489}let (=OpenSecureChannelRequest,=pkCli_8422,PartC_8428: bitstring) = m1_8427 in
                                            {9490}new Ns_8429: bitstring;
                                            {9491}new ST_8430: bitstring;
                                            {9492}new TTL_8431: bitstring;
                                            {9493}let gNs_8432: bitstring = exp(g,Ns_8429) in
                                            {9494}let m2_8433: bitstring = (OpenSecureChannelResponse,gNs_8432,ST_8430,TTL_8431) in
                                            {9495}out(c, (enc(m2_8433,pkCli_8422),sign(h(m2_8433),skSess_8174)));
                                            {9496}let Ksrv_8434: bitstring = exp(PartC_8428,Ns_8429) in
                                            {9497}out(c, senc(mSrv(pkCli_8422,pkSess_8175),Ksrv_8434))
                                    )
                                    else
                                        {9498}let v_8435: bool = (Disco_5317 = B) in
                                        (
                                            {9499}if v_8435 then
                                            (
                                                {9500}let pkDisco_8436: bitstring = pub(skB) in
                                                {9501}in(c, (=pkCli_8422,em1_8437: bitstring,sigM1_8438: bitstring));
                                                {9502}let m1_8439: bitstring = dec(em1_8437,skSess_8174) in
                                                {9503}if (verify(h(m1_8439),sigM1_8438,pkCli_8422) <> true) then
                                                    0
                                                else
                                                    {9504}let (=OpenSecureChannelRequest,=pkCli_8422,PartC_8440: bitstring) = m1_8439 in
                                                    {9505}new Ns_8441: bitstring;
                                                    {9506}new ST_8442: bitstring;
                                                    {9507}new TTL_8443: bitstring;
                                                    {9508}let gNs_8444: bitstring = exp(g,Ns_8441) in
                                                    {9509}let m2_8445: bitstring = (OpenSecureChannelResponse,gNs_8444,ST_8442,TTL_8443) in
                                                    {9510}out(c, (enc(m2_8445,pkCli_8422),sign(h(m2_8445),skSess_8174)));
                                                    {9511}let Ksrv_8446: bitstring = exp(PartC_8440,Ns_8441) in
                                                    {9512}out(c, senc(mSrv(pkCli_8422,pkSess_8175),Ksrv_8446))
                                            )
                                            else
                                                {9513}let v_8447: bool = (Disco_5317 = C) in
                                                (
                                                    {9514}if v_8447 then
                                                    (
                                                        {9515}let pkDisco_8448: bitstring = pub(skC) in
                                                        {9516}in(c, (=pkCli_8422,em1_8449: bitstring,sigM1_8450: bitstring));
                                                        {9517}let m1_8451: bitstring = dec(em1_8449,skSess_8174) in
                                                        {9518}if (verify(h(m1_8451),sigM1_8450,pkCli_8422) <> true) then
                                                            0
                                                        else
                                                            {9519}let (=OpenSecureChannelRequest,=pkCli_8422,PartC_8452: bitstring) = m1_8451 in
                                                            {9520}new Ns_8453: bitstring;
                                                            {9521}new ST_8454: bitstring;
                                                            {9522}new TTL_8455: bitstring;
                                                            {9523}let gNs_8456: bitstring = exp(g,Ns_8453) in
                                                            {9524}let m2_8457: bitstring = (OpenSecureChannelResponse,gNs_8456,ST_8454,TTL_8455) in
                                                            {9525}out(c, (enc(m2_8457,pkCli_8422),sign(h(m2_8457),skSess_8174)));
                                                            {9526}let Ksrv_8458: bitstring = exp(PartC_8452,Ns_8453) in
                                                            {9527}out(c, senc(mSrv(pkCli_8422,pkSess_8175),Ksrv_8458))
                                                    )
                                                    else
                                                        {9528}let pkDisco_8459: bitstring = pub(sk(Disco_5317)) in
                                                        {9529}in(c, (=pkCli_8422,em1_8460: bitstring,sigM1_8461: bitstring));
                                                        {9530}let m1_8462: bitstring = dec(em1_8460,skSess_8174) in
                                                        {9531}if (verify(h(m1_8462),sigM1_8461,pkCli_8422) <> true) then
                                                            0
                                                        else
                                                            {9532}let (=OpenSecureChannelRequest,=pkCli_8422,PartC_8463: bitstring) = m1_8462 in
                                                            {9533}new Ns_8464: bitstring;
                                                            {9534}new ST_8465: bitstring;
                                                            {9535}new TTL_8466: bitstring;
                                                            {9536}let gNs_8467: bitstring = exp(g,Ns_8464) in
                                                            {9537}let m2_8468: bitstring = (OpenSecureChannelResponse,gNs_8467,ST_8465,TTL_8466) in
                                                            {9538}out(c, (enc(m2_8468,pkCli_8422),sign(h(m2_8468),skSess_8174)));
                                                            {9539}let Ksrv_8469: bitstring = exp(PartC_8463,Ns_8464) in
                                                            {9540}out(c, senc(mSrv(pkCli_8422,pkSess_8175),Ksrv_8469))
                                                )
                                                else
                                                    {9541}let pkDisco_8470: bitstring = fail-any in
                                                    {9542}in(c, (=pkCli_8422,em1_8471: bitstring,sigM1_8472: bitstring));
                                                    {9543}let m1_8473: bitstring = dec(em1_8471,skSess_8174) in
                                                    {9544}if (verify(h(m1_8473),sigM1_8472,pkCli_8422) <> true) then
                                                        0
                                                    else
                                                        {9545}let (=OpenSecureChannelRequest,=pkCli_8422,PartC_8474: bitstring) = m1_8473 in
                                                        {9546}new Ns_8475: bitstring;
                                                        {9547}new ST_8476: bitstring;
                                                        {9548}new TTL_8477: bitstring;
                                                        {9549}let gNs_8478: bitstring = exp(g,Ns_8475) in
                                                        {9550}let m2_8479: bitstring = (OpenSecureChannelResponse,gNs_8478,ST_8476,TTL_8477) in
                                                        {9551}out(c, (enc(m2_8479,pkCli_8422),sign(h(m2_8479),skSess_8174)));
                                                        {9552}let Ksrv_8480: bitstring = exp(PartC_8474,Ns_8475) in
                                                        {9553}out(c, senc(mSrv(pkCli_8422,pkSess_8175),Ksrv_8480))
                                        )
                                        else
                                            {9554}let pkDisco_8481: bitstring = fail-any in
                                            {9555}in(c, (=pkCli_8422,em1_8482: bitstring,sigM1_8483: bitstring));
                                            {9556}let m1_8484: bitstring = dec(em1_8482,skSess_8174) in
                                            {9557}if (verify(h(m1_8484),sigM1_8483,pkCli_8422) <> true) then
                                                0
                                            else
                                                {9558}let (=OpenSecureChannelRequest,=pkCli_8422,PartC_8485: bitstring) = m1_8484 in
                                                {9559}new Ns_8486: bitstring;
                                                {9560}new ST_8487: bitstring;
                                                {9561}new TTL_8488: bitstring;
                                                {9562}let gNs_8489: bitstring = exp(g,Ns_8486) in
                                                {9563}let m2_8490: bitstring = (OpenSecureChannelResponse,gNs_8489,ST_8487,TTL_8488) in
                                                {9564}out(c, (enc(m2_8490,pkCli_8422),sign(h(m2_8490),skSess_8174)));
                                                {9565}let Ksrv_8491: bitstring = exp(PartC_8485,Ns_8486) in
                                                {9566}out(c, senc(mSrv(pkCli_8422,pkSess_8175),Ksrv_8491))
                                )
                                else
                                    {9567}let pkDisco_8492: bitstring = fail-any in
                                    {9568}in(c, (=pkCli_8422,em1_8493: bitstring,sigM1_8494: bitstring));
                                    {9569}let m1_8495: bitstring = dec(em1_8493,skSess_8174) in
                                    {9570}if (verify(h(m1_8495),sigM1_8494,pkCli_8422) <> true) then
                                        0
                                    else
                                        {9571}let (=OpenSecureChannelRequest,=pkCli_8422,PartC_8496: bitstring) = m1_8495 in
                                        {9572}new Ns_8497: bitstring;
                                        {9573}new ST_8498: bitstring;
                                        {9574}new TTL_8499: bitstring;
                                        {9575}let gNs_8500: bitstring = exp(g,Ns_8497) in
                                        {9576}let m2_8501: bitstring = (OpenSecureChannelResponse,gNs_8500,ST_8498,TTL_8499) in
                                        {9577}out(c, (enc(m2_8501,pkCli_8422),sign(h(m2_8501),skSess_8174)));
                                        {9578}let Ksrv_8502: bitstring = exp(PartC_8496,Ns_8497) in
                                        {9579}out(c, senc(mSrv(pkCli_8422,pkSess_8175),Ksrv_8502))
                        )
                        else
                            {9580}let pkCli_8503: bitstring = fail-any in
                            {9581}let v_8504: bool = (Disco_5317 = A) in
                            (
                                {9582}if v_8504 then
                                (
                                    {9583}let pkDisco_8505: bitstring = pub(skA) in
                                    {9584}in(c, (=pkCli_8503,em1_8506: bitstring,sigM1_8507: bitstring));
                                    {9585}let m1_8508: bitstring = dec(em1_8506,skSess_8174) in
                                    {9586}if (verify(h(m1_8508),sigM1_8507,pkCli_8503) <> true) then
                                        0
                                    else
                                        {9587}let (=OpenSecureChannelRequest,=pkCli_8503,PartC_8509: bitstring) = m1_8508 in
                                        {9588}new Ns_8510: bitstring;
                                        {9589}new ST_8511: bitstring;
                                        {9590}new TTL_8512: bitstring;
                                        {9591}let gNs_8513: bitstring = exp(g,Ns_8510) in
                                        {9592}let m2_8514: bitstring = (OpenSecureChannelResponse,gNs_8513,ST_8511,TTL_8512) in
                                        {9593}out(c, (enc(m2_8514,pkCli_8503),sign(h(m2_8514),skSess_8174)));
                                        {9594}let Ksrv_8515: bitstring = exp(PartC_8509,Ns_8510) in
                                        {9595}out(c, senc(mSrv(pkCli_8503,pkSess_8175),Ksrv_8515))
                                )
                                else
                                    {9596}let v_8516: bool = (Disco_5317 = B) in
                                    (
                                        {9597}if v_8516 then
                                        (
                                            {9598}let pkDisco_8517: bitstring = pub(skB) in
                                            {9599}in(c, (=pkCli_8503,em1_8518: bitstring,sigM1_8519: bitstring));
                                            {9600}let m1_8520: bitstring = dec(em1_8518,skSess_8174) in
                                            {9601}if (verify(h(m1_8520),sigM1_8519,pkCli_8503) <> true) then
                                                0
                                            else
                                                {9602}let (=OpenSecureChannelRequest,=pkCli_8503,PartC_8521: bitstring) = m1_8520 in
                                                {9603}new Ns_8522: bitstring;
                                                {9604}new ST_8523: bitstring;
                                                {9605}new TTL_8524: bitstring;
                                                {9606}let gNs_8525: bitstring = exp(g,Ns_8522) in
                                                {9607}let m2_8526: bitstring = (OpenSecureChannelResponse,gNs_8525,ST_8523,TTL_8524) in
                                                {9608}out(c, (enc(m2_8526,pkCli_8503),sign(h(m2_8526),skSess_8174)));
                                                {9609}let Ksrv_8527: bitstring = exp(PartC_8521,Ns_8522) in
                                                {9610}out(c, senc(mSrv(pkCli_8503,pkSess_8175),Ksrv_8527))
                                        )
                                        else
                                            {9611}let v_8528: bool = (Disco_5317 = C) in
                                            (
                                                {9612}if v_8528 then
                                                (
                                                    {9613}let pkDisco_8529: bitstring = pub(skC) in
                                                    {9614}in(c, (=pkCli_8503,em1_8530: bitstring,sigM1_8531: bitstring));
                                                    {9615}let m1_8532: bitstring = dec(em1_8530,skSess_8174) in
                                                    {9616}if (verify(h(m1_8532),sigM1_8531,pkCli_8503) <> true) then
                                                        0
                                                    else
                                                        {9617}let (=OpenSecureChannelRequest,=pkCli_8503,PartC_8533: bitstring) = m1_8532 in
                                                        {9618}new Ns_8534: bitstring;
                                                        {9619}new ST_8535: bitstring;
                                                        {9620}new TTL_8536: bitstring;
                                                        {9621}let gNs_8537: bitstring = exp(g,Ns_8534) in
                                                        {9622}let m2_8538: bitstring = (OpenSecureChannelResponse,gNs_8537,ST_8535,TTL_8536) in
                                                        {9623}out(c, (enc(m2_8538,pkCli_8503),sign(h(m2_8538),skSess_8174)));
                                                        {9624}let Ksrv_8539: bitstring = exp(PartC_8533,Ns_8534) in
                                                        {9625}out(c, senc(mSrv(pkCli_8503,pkSess_8175),Ksrv_8539))
                                                )
                                                else
                                                    {9626}let pkDisco_8540: bitstring = pub(sk(Disco_5317)) in
                                                    {9627}in(c, (=pkCli_8503,em1_8541: bitstring,sigM1_8542: bitstring));
                                                    {9628}let m1_8543: bitstring = dec(em1_8541,skSess_8174) in
                                                    {9629}if (verify(h(m1_8543),sigM1_8542,pkCli_8503) <> true) then
                                                        0
                                                    else
                                                        {9630}let (=OpenSecureChannelRequest,=pkCli_8503,PartC_8544: bitstring) = m1_8543 in
                                                        {9631}new Ns_8545: bitstring;
                                                        {9632}new ST_8546: bitstring;
                                                        {9633}new TTL_8547: bitstring;
                                                        {9634}let gNs_8548: bitstring = exp(g,Ns_8545) in
                                                        {9635}let m2_8549: bitstring = (OpenSecureChannelResponse,gNs_8548,ST_8546,TTL_8547) in
                                                        {9636}out(c, (enc(m2_8549,pkCli_8503),sign(h(m2_8549),skSess_8174)));
                                                        {9637}let Ksrv_8550: bitstring = exp(PartC_8544,Ns_8545) in
                                                        {9638}out(c, senc(mSrv(pkCli_8503,pkSess_8175),Ksrv_8550))
                                            )
                                            else
                                                {9639}let pkDisco_8551: bitstring = fail-any in
                                                {9640}in(c, (=pkCli_8503,em1_8552: bitstring,sigM1_8553: bitstring));
                                                {9641}let m1_8554: bitstring = dec(em1_8552,skSess_8174) in
                                                {9642}if (verify(h(m1_8554),sigM1_8553,pkCli_8503) <> true) then
                                                    0
                                                else
                                                    {9643}let (=OpenSecureChannelRequest,=pkCli_8503,PartC_8555: bitstring) = m1_8554 in
                                                    {9644}new Ns_8556: bitstring;
                                                    {9645}new ST_8557: bitstring;
                                                    {9646}new TTL_8558: bitstring;
                                                    {9647}let gNs_8559: bitstring = exp(g,Ns_8556) in
                                                    {9648}let m2_8560: bitstring = (OpenSecureChannelResponse,gNs_8559,ST_8557,TTL_8558) in
                                                    {9649}out(c, (enc(m2_8560,pkCli_8503),sign(h(m2_8560),skSess_8174)));
                                                    {9650}let Ksrv_8561: bitstring = exp(PartC_8555,Ns_8556) in
                                                    {9651}out(c, senc(mSrv(pkCli_8503,pkSess_8175),Ksrv_8561))
                                    )
                                    else
                                        {9652}let pkDisco_8562: bitstring = fail-any in
                                        {9653}in(c, (=pkCli_8503,em1_8563: bitstring,sigM1_8564: bitstring));
                                        {9654}let m1_8565: bitstring = dec(em1_8563,skSess_8174) in
                                        {9655}if (verify(h(m1_8565),sigM1_8564,pkCli_8503) <> true) then
                                            0
                                        else
                                            {9656}let (=OpenSecureChannelRequest,=pkCli_8503,PartC_8566: bitstring) = m1_8565 in
                                            {9657}new Ns_8567: bitstring;
                                            {9658}new ST_8568: bitstring;
                                            {9659}new TTL_8569: bitstring;
                                            {9660}let gNs_8570: bitstring = exp(g,Ns_8567) in
                                            {9661}let m2_8571: bitstring = (OpenSecureChannelResponse,gNs_8570,ST_8568,TTL_8569) in
                                            {9662}out(c, (enc(m2_8571,pkCli_8503),sign(h(m2_8571),skSess_8174)));
                                            {9663}let Ksrv_8572: bitstring = exp(PartC_8566,Ns_8567) in
                                            {9664}out(c, senc(mSrv(pkCli_8503,pkSess_8175),Ksrv_8572))
                            )
                            else
                                {9665}let pkDisco_8573: bitstring = fail-any in
                                {9666}in(c, (=pkCli_8503,em1_8574: bitstring,sigM1_8575: bitstring));
                                {9667}let m1_8576: bitstring = dec(em1_8574,skSess_8174) in
                                {9668}if (verify(h(m1_8576),sigM1_8575,pkCli_8503) <> true) then
                                    0
                                else
                                    {9669}let (=OpenSecureChannelRequest,=pkCli_8503,PartC_8577: bitstring) = m1_8576 in
                                    {9670}new Ns_8578: bitstring;
                                    {9671}new ST_8579: bitstring;
                                    {9672}new TTL_8580: bitstring;
                                    {9673}let gNs_8581: bitstring = exp(g,Ns_8578) in
                                    {9674}let m2_8582: bitstring = (OpenSecureChannelResponse,gNs_8581,ST_8579,TTL_8580) in
                                    {9675}out(c, (enc(m2_8582,pkCli_8503),sign(h(m2_8582),skSess_8174)));
                                    {9676}let Ksrv_8583: bitstring = exp(PartC_8577,Ns_8578) in
                                    {9677}out(c, senc(mSrv(pkCli_8503,pkSess_8175),Ksrv_8583))
                )
                else
                    {9678}let pkCli_8584: bitstring = fail-any in
                    {9679}let v_8585: bool = (Disco_5317 = A) in
                    (
                        {9680}if v_8585 then
                        (
                            {9681}let pkDisco_8586: bitstring = pub(skA) in
                            {9682}in(c, (=pkCli_8584,em1_8587: bitstring,sigM1_8588: bitstring));
                            {9683}let m1_8589: bitstring = dec(em1_8587,skSess_8174) in
                            {9684}if (verify(h(m1_8589),sigM1_8588,pkCli_8584) <> true) then
                                0
                            else
                                {9685}let (=OpenSecureChannelRequest,=pkCli_8584,PartC_8590: bitstring) = m1_8589 in
                                {9686}new Ns_8591: bitstring;
                                {9687}new ST_8592: bitstring;
                                {9688}new TTL_8593: bitstring;
                                {9689}let gNs_8594: bitstring = exp(g,Ns_8591) in
                                {9690}let m2_8595: bitstring = (OpenSecureChannelResponse,gNs_8594,ST_8592,TTL_8593) in
                                {9691}out(c, (enc(m2_8595,pkCli_8584),sign(h(m2_8595),skSess_8174)));
                                {9692}let Ksrv_8596: bitstring = exp(PartC_8590,Ns_8591) in
                                {9693}out(c, senc(mSrv(pkCli_8584,pkSess_8175),Ksrv_8596))
                        )
                        else
                            {9694}let v_8597: bool = (Disco_5317 = B) in
                            (
                                {9695}if v_8597 then
                                (
                                    {9696}let pkDisco_8598: bitstring = pub(skB) in
                                    {9697}in(c, (=pkCli_8584,em1_8599: bitstring,sigM1_8600: bitstring));
                                    {9698}let m1_8601: bitstring = dec(em1_8599,skSess_8174) in
                                    {9699}if (verify(h(m1_8601),sigM1_8600,pkCli_8584) <> true) then
                                        0
                                    else
                                        {9700}let (=OpenSecureChannelRequest,=pkCli_8584,PartC_8602: bitstring) = m1_8601 in
                                        {9701}new Ns_8603: bitstring;
                                        {9702}new ST_8604: bitstring;
                                        {9703}new TTL_8605: bitstring;
                                        {9704}let gNs_8606: bitstring = exp(g,Ns_8603) in
                                        {9705}let m2_8607: bitstring = (OpenSecureChannelResponse,gNs_8606,ST_8604,TTL_8605) in
                                        {9706}out(c, (enc(m2_8607,pkCli_8584),sign(h(m2_8607),skSess_8174)));
                                        {9707}let Ksrv_8608: bitstring = exp(PartC_8602,Ns_8603) in
                                        {9708}out(c, senc(mSrv(pkCli_8584,pkSess_8175),Ksrv_8608))
                                )
                                else
                                    {9709}let v_8609: bool = (Disco_5317 = C) in
                                    (
                                        {9710}if v_8609 then
                                        (
                                            {9711}let pkDisco_8610: bitstring = pub(skC) in
                                            {9712}in(c, (=pkCli_8584,em1_8611: bitstring,sigM1_8612: bitstring));
                                            {9713}let m1_8613: bitstring = dec(em1_8611,skSess_8174) in
                                            {9714}if (verify(h(m1_8613),sigM1_8612,pkCli_8584) <> true) then
                                                0
                                            else
                                                {9715}let (=OpenSecureChannelRequest,=pkCli_8584,PartC_8614: bitstring) = m1_8613 in
                                                {9716}new Ns_8615: bitstring;
                                                {9717}new ST_8616: bitstring;
                                                {9718}new TTL_8617: bitstring;
                                                {9719}let gNs_8618: bitstring = exp(g,Ns_8615) in
                                                {9720}let m2_8619: bitstring = (OpenSecureChannelResponse,gNs_8618,ST_8616,TTL_8617) in
                                                {9721}out(c, (enc(m2_8619,pkCli_8584),sign(h(m2_8619),skSess_8174)));
                                                {9722}let Ksrv_8620: bitstring = exp(PartC_8614,Ns_8615) in
                                                {9723}out(c, senc(mSrv(pkCli_8584,pkSess_8175),Ksrv_8620))
                                        )
                                        else
                                            {9724}let pkDisco_8621: bitstring = pub(sk(Disco_5317)) in
                                            {9725}in(c, (=pkCli_8584,em1_8622: bitstring,sigM1_8623: bitstring));
                                            {9726}let m1_8624: bitstring = dec(em1_8622,skSess_8174) in
                                            {9727}if (verify(h(m1_8624),sigM1_8623,pkCli_8584) <> true) then
                                                0
                                            else
                                                {9728}let (=OpenSecureChannelRequest,=pkCli_8584,PartC_8625: bitstring) = m1_8624 in
                                                {9729}new Ns_8626: bitstring;
                                                {9730}new ST_8627: bitstring;
                                                {9731}new TTL_8628: bitstring;
                                                {9732}let gNs_8629: bitstring = exp(g,Ns_8626) in
                                                {9733}let m2_8630: bitstring = (OpenSecureChannelResponse,gNs_8629,ST_8627,TTL_8628) in
                                                {9734}out(c, (enc(m2_8630,pkCli_8584),sign(h(m2_8630),skSess_8174)));
                                                {9735}let Ksrv_8631: bitstring = exp(PartC_8625,Ns_8626) in
                                                {9736}out(c, senc(mSrv(pkCli_8584,pkSess_8175),Ksrv_8631))
                                    )
                                    else
                                        {9737}let pkDisco_8632: bitstring = fail-any in
                                        {9738}in(c, (=pkCli_8584,em1_8633: bitstring,sigM1_8634: bitstring));
                                        {9739}let m1_8635: bitstring = dec(em1_8633,skSess_8174) in
                                        {9740}if (verify(h(m1_8635),sigM1_8634,pkCli_8584) <> true) then
                                            0
                                        else
                                            {9741}let (=OpenSecureChannelRequest,=pkCli_8584,PartC_8636: bitstring) = m1_8635 in
                                            {9742}new Ns_8637: bitstring;
                                            {9743}new ST_8638: bitstring;
                                            {9744}new TTL_8639: bitstring;
                                            {9745}let gNs_8640: bitstring = exp(g,Ns_8637) in
                                            {9746}let m2_8641: bitstring = (OpenSecureChannelResponse,gNs_8640,ST_8638,TTL_8639) in
                                            {9747}out(c, (enc(m2_8641,pkCli_8584),sign(h(m2_8641),skSess_8174)));
                                            {9748}let Ksrv_8642: bitstring = exp(PartC_8636,Ns_8637) in
                                            {9749}out(c, senc(mSrv(pkCli_8584,pkSess_8175),Ksrv_8642))
                            )
                            else
                                {9750}let pkDisco_8643: bitstring = fail-any in
                                {9751}in(c, (=pkCli_8584,em1_8644: bitstring,sigM1_8645: bitstring));
                                {9752}let m1_8646: bitstring = dec(em1_8644,skSess_8174) in
                                {9753}if (verify(h(m1_8646),sigM1_8645,pkCli_8584) <> true) then
                                    0
                                else
                                    {9754}let (=OpenSecureChannelRequest,=pkCli_8584,PartC_8647: bitstring) = m1_8646 in
                                    {9755}new Ns_8648: bitstring;
                                    {9756}new ST_8649: bitstring;
                                    {9757}new TTL_8650: bitstring;
                                    {9758}let gNs_8651: bitstring = exp(g,Ns_8648) in
                                    {9759}let m2_8652: bitstring = (OpenSecureChannelResponse,gNs_8651,ST_8649,TTL_8650) in
                                    {9760}out(c, (enc(m2_8652,pkCli_8584),sign(h(m2_8652),skSess_8174)));
                                    {9761}let Ksrv_8653: bitstring = exp(PartC_8647,Ns_8648) in
                                    {9762}out(c, senc(mSrv(pkCli_8584,pkSess_8175),Ksrv_8653))
                    )
                    else
                        {9763}let pkDisco_8654: bitstring = fail-any in
                        {9764}in(c, (=pkCli_8584,em1_8655: bitstring,sigM1_8656: bitstring));
                        {9765}let m1_8657: bitstring = dec(em1_8655,skSess_8174) in
                        {9766}if (verify(h(m1_8657),sigM1_8656,pkCli_8584) <> true) then
                            0
                        else
                            {9767}let (=OpenSecureChannelRequest,=pkCli_8584,PartC_8658: bitstring) = m1_8657 in
                            {9768}new Ns_8659: bitstring;
                            {9769}new ST_8660: bitstring;
                            {9770}new TTL_8661: bitstring;
                            {9771}let gNs_8662: bitstring = exp(g,Ns_8659) in
                            {9772}let m2_8663: bitstring = (OpenSecureChannelResponse,gNs_8662,ST_8660,TTL_8661) in
                            {9773}out(c, (enc(m2_8663,pkCli_8584),sign(h(m2_8663),skSess_8174)));
                            {9774}let Ksrv_8664: bitstring = exp(PartC_8658,Ns_8659) in
                            {9775}out(c, senc(mSrv(pkCli_8584,pkSess_8175),Ksrv_8664))
        )
        else
            {9776}let pkCli_8665: bitstring = fail-any in
            {9777}let v_8666: bool = (Disco_5317 = A) in
            (
                {9778}if v_8666 then
                (
                    {9779}let pkDisco_8667: bitstring = pub(skA) in
                    {9780}in(c, (=pkCli_8665,em1_8668: bitstring,sigM1_8669: bitstring));
                    {9781}let m1_8670: bitstring = dec(em1_8668,skSess_8174) in
                    {9782}if (verify(h(m1_8670),sigM1_8669,pkCli_8665) <> true) then
                        0
                    else
                        {9783}let (=OpenSecureChannelRequest,=pkCli_8665,PartC_8671: bitstring) = m1_8670 in
                        {9784}new Ns_8672: bitstring;
                        {9785}new ST_8673: bitstring;
                        {9786}new TTL_8674: bitstring;
                        {9787}let gNs_8675: bitstring = exp(g,Ns_8672) in
                        {9788}let m2_8676: bitstring = (OpenSecureChannelResponse,gNs_8675,ST_8673,TTL_8674) in
                        {9789}out(c, (enc(m2_8676,pkCli_8665),sign(h(m2_8676),skSess_8174)));
                        {9790}let Ksrv_8677: bitstring = exp(PartC_8671,Ns_8672) in
                        {9791}out(c, senc(mSrv(pkCli_8665,pkSess_8175),Ksrv_8677))
                )
                else
                    {9792}let v_8678: bool = (Disco_5317 = B) in
                    (
                        {9793}if v_8678 then
                        (
                            {9794}let pkDisco_8679: bitstring = pub(skB) in
                            {9795}in(c, (=pkCli_8665,em1_8680: bitstring,sigM1_8681: bitstring));
                            {9796}let m1_8682: bitstring = dec(em1_8680,skSess_8174) in
                            {9797}if (verify(h(m1_8682),sigM1_8681,pkCli_8665) <> true) then
                                0
                            else
                                {9798}let (=OpenSecureChannelRequest,=pkCli_8665,PartC_8683: bitstring) = m1_8682 in
                                {9799}new Ns_8684: bitstring;
                                {9800}new ST_8685: bitstring;
                                {9801}new TTL_8686: bitstring;
                                {9802}let gNs_8687: bitstring = exp(g,Ns_8684) in
                                {9803}let m2_8688: bitstring = (OpenSecureChannelResponse,gNs_8687,ST_8685,TTL_8686) in
                                {9804}out(c, (enc(m2_8688,pkCli_8665),sign(h(m2_8688),skSess_8174)));
                                {9805}let Ksrv_8689: bitstring = exp(PartC_8683,Ns_8684) in
                                {9806}out(c, senc(mSrv(pkCli_8665,pkSess_8175),Ksrv_8689))
                        )
                        else
                            {9807}let v_8690: bool = (Disco_5317 = C) in
                            (
                                {9808}if v_8690 then
                                (
                                    {9809}let pkDisco_8691: bitstring = pub(skC) in
                                    {9810}in(c, (=pkCli_8665,em1_8692: bitstring,sigM1_8693: bitstring));
                                    {9811}let m1_8694: bitstring = dec(em1_8692,skSess_8174) in
                                    {9812}if (verify(h(m1_8694),sigM1_8693,pkCli_8665) <> true) then
                                        0
                                    else
                                        {9813}let (=OpenSecureChannelRequest,=pkCli_8665,PartC_8695: bitstring) = m1_8694 in
                                        {9814}new Ns_8696: bitstring;
                                        {9815}new ST_8697: bitstring;
                                        {9816}new TTL_8698: bitstring;
                                        {9817}let gNs_8699: bitstring = exp(g,Ns_8696) in
                                        {9818}let m2_8700: bitstring = (OpenSecureChannelResponse,gNs_8699,ST_8697,TTL_8698) in
                                        {9819}out(c, (enc(m2_8700,pkCli_8665),sign(h(m2_8700),skSess_8174)));
                                        {9820}let Ksrv_8701: bitstring = exp(PartC_8695,Ns_8696) in
                                        {9821}out(c, senc(mSrv(pkCli_8665,pkSess_8175),Ksrv_8701))
                                )
                                else
                                    {9822}let pkDisco_8702: bitstring = pub(sk(Disco_5317)) in
                                    {9823}in(c, (=pkCli_8665,em1_8703: bitstring,sigM1_8704: bitstring));
                                    {9824}let m1_8705: bitstring = dec(em1_8703,skSess_8174) in
                                    {9825}if (verify(h(m1_8705),sigM1_8704,pkCli_8665) <> true) then
                                        0
                                    else
                                        {9826}let (=OpenSecureChannelRequest,=pkCli_8665,PartC_8706: bitstring) = m1_8705 in
                                        {9827}new Ns_8707: bitstring;
                                        {9828}new ST_8708: bitstring;
                                        {9829}new TTL_8709: bitstring;
                                        {9830}let gNs_8710: bitstring = exp(g,Ns_8707) in
                                        {9831}let m2_8711: bitstring = (OpenSecureChannelResponse,gNs_8710,ST_8708,TTL_8709) in
                                        {9832}out(c, (enc(m2_8711,pkCli_8665),sign(h(m2_8711),skSess_8174)));
                                        {9833}let Ksrv_8712: bitstring = exp(PartC_8706,Ns_8707) in
                                        {9834}out(c, senc(mSrv(pkCli_8665,pkSess_8175),Ksrv_8712))
                            )
                            else
                                {9835}let pkDisco_8713: bitstring = fail-any in
                                {9836}in(c, (=pkCli_8665,em1_8714: bitstring,sigM1_8715: bitstring));
                                {9837}let m1_8716: bitstring = dec(em1_8714,skSess_8174) in
                                {9838}if (verify(h(m1_8716),sigM1_8715,pkCli_8665) <> true) then
                                    0
                                else
                                    {9839}let (=OpenSecureChannelRequest,=pkCli_8665,PartC_8717: bitstring) = m1_8716 in
                                    {9840}new Ns_8718: bitstring;
                                    {9841}new ST_8719: bitstring;
                                    {9842}new TTL_8720: bitstring;
                                    {9843}let gNs_8721: bitstring = exp(g,Ns_8718) in
                                    {9844}let m2_8722: bitstring = (OpenSecureChannelResponse,gNs_8721,ST_8719,TTL_8720) in
                                    {9845}out(c, (enc(m2_8722,pkCli_8665),sign(h(m2_8722),skSess_8174)));
                                    {9846}let Ksrv_8723: bitstring = exp(PartC_8717,Ns_8718) in
                                    {9847}out(c, senc(mSrv(pkCli_8665,pkSess_8175),Ksrv_8723))
                    )
                    else
                        {9848}let pkDisco_8724: bitstring = fail-any in
                        {9849}in(c, (=pkCli_8665,em1_8725: bitstring,sigM1_8726: bitstring));
                        {9850}let m1_8727: bitstring = dec(em1_8725,skSess_8174) in
                        {9851}if (verify(h(m1_8727),sigM1_8726,pkCli_8665) <> true) then
                            0
                        else
                            {9852}let (=OpenSecureChannelRequest,=pkCli_8665,PartC_8728: bitstring) = m1_8727 in
                            {9853}new Ns_8729: bitstring;
                            {9854}new ST_8730: bitstring;
                            {9855}new TTL_8731: bitstring;
                            {9856}let gNs_8732: bitstring = exp(g,Ns_8729) in
                            {9857}let m2_8733: bitstring = (OpenSecureChannelResponse,gNs_8732,ST_8730,TTL_8731) in
                            {9858}out(c, (enc(m2_8733,pkCli_8665),sign(h(m2_8733),skSess_8174)));
                            {9859}let Ksrv_8734: bitstring = exp(PartC_8728,Ns_8729) in
                            {9860}out(c, senc(mSrv(pkCli_8665,pkSess_8175),Ksrv_8734))
            )
            else
                {9861}let pkDisco_8735: bitstring = fail-any in
                {9862}in(c, (=pkCli_8665,em1_8736: bitstring,sigM1_8737: bitstring));
                {9863}let m1_8738: bitstring = dec(em1_8736,skSess_8174) in
                {9864}if (verify(h(m1_8738),sigM1_8737,pkCli_8665) <> true) then
                    0
                else
                    {9865}let (=OpenSecureChannelRequest,=pkCli_8665,PartC_8739: bitstring) = m1_8738 in
                    {9866}new Ns_8740: bitstring;
                    {9867}new ST_8741: bitstring;
                    {9868}new TTL_8742: bitstring;
                    {9869}let gNs_8743: bitstring = exp(g,Ns_8740) in
                    {9870}let m2_8744: bitstring = (OpenSecureChannelResponse,gNs_8743,ST_8741,TTL_8742) in
                    {9871}out(c, (enc(m2_8744,pkCli_8665),sign(h(m2_8744),skSess_8174)));
                    {9872}let Ksrv_8745: bitstring = exp(PartC_8739,Ns_8740) in
                    {9873}out(c, senc(mSrv(pkCli_8665,pkSess_8175),Ksrv_8745))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 436 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 436 rules in the queue.
600 rules inserted. The rule base contains 324 rules. 436 rules in the queue.
800 rules inserted. The rule base contains 399 rules. 434 rules in the queue.
1000 rules inserted. The rule base contains 513 rules. 433 rules in the queue.
1200 rules inserted. The rule base contains 531 rules. 408 rules in the queue.
1400 rules inserted. The rule base contains 528 rules. 408 rules in the queue.
1600 rules inserted. The rule base contains 579 rules. 348 rules in the queue.
1800 rules inserted. The rule base contains 581 rules. 444 rules in the queue.
2000 rules inserted. The rule base contains 601 rules. 648 rules in the queue.
2200 rules inserted. The rule base contains 629 rules. 1115 rules in the queue.
2400 rules inserted. The rule base contains 678 rules. 1952 rules in the queue.
2600 rules inserted. The rule base contains 727 rules. 2622 rules in the queue.
2800 rules inserted. The rule base contains 781 rules. 3678 rules in the queue.
3000 rules inserted. The rule base contains 814 rules. 3750 rules in the queue.
3200 rules inserted. The rule base contains 859 rules. 3939 rules in the queue.
3400 rules inserted. The rule base contains 895 rules. 4129 rules in the queue.
3600 rules inserted. The rule base contains 939 rules. 4126 rules in the queue.
3800 rules inserted. The rule base contains 974 rules. 4317 rules in the queue.
4000 rules inserted. The rule base contains 1018 rules. 4410 rules in the queue.
4200 rules inserted. The rule base contains 1053 rules. 4504 rules in the queue.
4400 rules inserted. The rule base contains 1098 rules. 4597 rules in the queue.
4600 rules inserted. The rule base contains 1144 rules. 4882 rules in the queue.
4800 rules inserted. The rule base contains 1178 rules. 4881 rules in the queue.
5000 rules inserted. The rule base contains 1212 rules. 4879 rules in the queue.
5200 rules inserted. The rule base contains 1257 rules. 4842 rules in the queue.
5400 rules inserted. The rule base contains 1266 rules. 4830 rules in the queue.
5600 rules inserted. The rule base contains 1263 rules. 4824 rules in the queue.
5800 rules inserted. The rule base contains 1299 rules. 4788 rules in the queue.
6000 rules inserted. The rule base contains 1296 rules. 4782 rules in the queue.
6200 rules inserted. The rule base contains 1305 rules. 4770 rules in the queue.
6400 rules inserted. The rule base contains 1338 rules. 4734 rules in the queue.
6600 rules inserted. The rule base contains 1329 rules. 4734 rules in the queue.
6800 rules inserted. The rule base contains 1374 rules. 4691 rules in the queue.
7000 rules inserted. The rule base contains 1401 rules. 4674 rules in the queue.
7200 rules inserted. The rule base contains 1432 rules. 4660 rules in the queue.
7400 rules inserted. The rule base contains 1463 rules. 4647 rules in the queue.
7600 rules inserted. The rule base contains 1499 rules. 4621 rules in the queue.
7800 rules inserted. The rule base contains 1539 rules. 4587 rules in the queue.
8000 rules inserted. The rule base contains 1575 rules. 4577 rules in the queue.
8200 rules inserted. The rule base contains 1603 rules. 4545 rules in the queue.
8400 rules inserted. The rule base contains 1641 rules. 4523 rules in the queue.
8600 rules inserted. The rule base contains 1669 rules. 4509 rules in the queue.
8800 rules inserted. The rule base contains 1709 rules. 4472 rules in the queue.
9000 rules inserted. The rule base contains 1736 rules. 4461 rules in the queue.
9200 rules inserted. The rule base contains 1763 rules. 4460 rules in the queue.
9400 rules inserted. The rule base contains 1797 rules. 4437 rules in the queue.
9600 rules inserted. The rule base contains 1831 rules. 4412 rules in the queue.
9800 rules inserted. The rule base contains 1867 rules. 4372 rules in the queue.
10000 rules inserted. The rule base contains 1978 rules. 4262 rules in the queue.
10200 rules inserted. The rule base contains 2173 rules. 4067 rules in the queue.
10400 rules inserted. The rule base contains 2211 rules. 4029 rules in the queue.
10600 rules inserted. The rule base contains 2406 rules. 3834 rules in the queue.
10800 rules inserted. The rule base contains 2465 rules. 3775 rules in the queue.
11000 rules inserted. The rule base contains 2640 rules. 3600 rules in the queue.
11200 rules inserted. The rule base contains 2757 rules. 3483 rules in the queue.
11400 rules inserted. The rule base contains 2744 rules. 3476 rules in the queue.
11600 rules inserted. The rule base contains 2753 rules. 3451 rules in the queue.
11800 rules inserted. The rule base contains 2814 rules. 3390 rules in the queue.
12000 rules inserted. The rule base contains 2869 rules. 3334 rules in the queue.
12200 rules inserted. The rule base contains 2876 rules. 3315 rules in the queue.
12400 rules inserted. The rule base contains 2903 rules. 3280 rules in the queue.
12600 rules inserted. The rule base contains 2951 rules. 3234 rules in the queue.
12800 rules inserted. The rule base contains 2966 rules. 3190 rules in the queue.
13000 rules inserted. The rule base contains 3008 rules. 3147 rules in the queue.
13200 rules inserted. The rule base contains 2999 rules. 3144 rules in the queue.
13400 rules inserted. The rule base contains 3035 rules. 3101 rules in the queue.
13600 rules inserted. The rule base contains 3109 rules. 3028 rules in the queue.
13800 rules inserted. The rule base contains 3143 rules. 2985 rules in the queue.
14000 rules inserted. The rule base contains 3135 rules. 2982 rules in the queue.
14200 rules inserted. The rule base contains 3122 rules. 2974 rules in the queue.
14400 rules inserted. The rule base contains 3140 rules. 2964 rules in the queue.
14600 rules inserted. The rule base contains 3159 rules. 2953 rules in the queue.
14800 rules inserted. The rule base contains 3160 rules. 2955 rules in the queue.
15000 rules inserted. The rule base contains 3114 rules. 2952 rules in the queue.
15200 rules inserted. The rule base contains 3096 rules. 2950 rules in the queue.
15400 rules inserted. The rule base contains 3084 rules. 2948 rules in the queue.
15600 rules inserted. The rule base contains 3037 rules. 2948 rules in the queue.
15800 rules inserted. The rule base contains 3020 rules. 2945 rules in the queue.
16000 rules inserted. The rule base contains 2993 rules. 2943 rules in the queue.
16200 rules inserted. The rule base contains 2965 rules. 2941 rules in the queue.
16400 rules inserted. The rule base contains 2927 rules. 2941 rules in the queue.
16600 rules inserted. The rule base contains 2912 rules. 2938 rules in the queue.
16800 rules inserted. The rule base contains 2889 rules. 2936 rules in the queue.
17000 rules inserted. The rule base contains 2856 rules. 2935 rules in the queue.
17200 rules inserted. The rule base contains 2819 rules. 2934 rules in the queue.
17400 rules inserted. The rule base contains 2902 rules. 2937 rules in the queue.
17600 rules inserted. The rule base contains 2985 rules. 2940 rules in the queue.
17800 rules inserted. The rule base contains 3063 rules. 2934 rules in the queue.
18000 rules inserted. The rule base contains 3066 rules. 2934 rules in the queue.
18200 rules inserted. The rule base contains 3046 rules. 2934 rules in the queue.
18400 rules inserted. The rule base contains 3043 rules. 2928 rules in the queue.
18600 rules inserted. The rule base contains 3043 rules. 2928 rules in the queue.
18800 rules inserted. The rule base contains 3033 rules. 2924 rules in the queue.
19000 rules inserted. The rule base contains 3029 rules. 2922 rules in the queue.
19200 rules inserted. The rule base contains 3025 rules. 2919 rules in the queue.
19400 rules inserted. The rule base contains 3028 rules. 2916 rules in the queue.
19600 rules inserted. The rule base contains 3009 rules. 2916 rules in the queue.
19800 rules inserted. The rule base contains 3003 rules. 2916 rules in the queue.
20000 rules inserted. The rule base contains 3007 rules. 2910 rules in the queue.
20200 rules inserted. The rule base contains 3072 rules. 3034 rules in the queue.
20400 rules inserted. The rule base contains 3260 rules. 3293 rules in the queue.
20600 rules inserted. The rule base contains 3451 rules. 3654 rules in the queue.
20800 rules inserted. The rule base contains 3523 rules. 3635 rules in the queue.
21000 rules inserted. The rule base contains 3559 rules. 3633 rules in the queue.
21200 rules inserted. The rule base contains 3593 rules. 3633 rules in the queue.
21400 rules inserted. The rule base contains 3635 rules. 3589 rules in the queue.
21600 rules inserted. The rule base contains 3673 rules. 3585 rules in the queue.
21800 rules inserted. The rule base contains 3715 rules. 3541 rules in the queue.
22000 rules inserted. The rule base contains 3751 rules. 3536 rules in the queue.
22200 rules inserted. The rule base contains 3795 rules. 3493 rules in the queue.
22400 rules inserted. The rule base contains 3829 rules. 3487 rules in the queue.
22600 rules inserted. The rule base contains 3854 rules. 3484 rules in the queue.
22800 rules inserted. The rule base contains 3902 rules. 3452 rules in the queue.
23000 rules inserted. The rule base contains 3955 rules. 3397 rules in the queue.
23200 rules inserted. The rule base contains 3880 rules. 3286 rules in the queue.
23400 rules inserted. The rule base contains 3810 rules. 3178 rules in the queue.
23600 rules inserted. The rule base contains 3729 rules. 3071 rules in the queue.
23800 rules inserted. The rule base contains 3787 rules. 3037 rules in the queue.
24000 rules inserted. The rule base contains 3908 rules. 2905 rules in the queue.
24200 rules inserted. The rule base contains 3974 rules. 2836 rules in the queue.
24400 rules inserted. The rule base contains 4085 rules. 2717 rules in the queue.
24600 rules inserted. The rule base contains 4164 rules. 2631 rules in the queue.
24800 rules inserted. The rule base contains 4274 rules. 2515 rules in the queue.
25000 rules inserted. The rule base contains 4385 rules. 2395 rules in the queue.
25200 rules inserted. The rule base contains 4473 rules. 2302 rules in the queue.
25400 rules inserted. The rule base contains 4546 rules. 2222 rules in the queue.
25600 rules inserted. The rule base contains 4681 rules. 2077 rules in the queue.
25800 rules inserted. The rule base contains 4770 rules. 1988 rules in the queue.
26000 rules inserted. The rule base contains 4825 rules. 1957 rules in the queue.
26200 rules inserted. The rule base contains 4881 rules. 1913 rules in the queue.
26400 rules inserted. The rule base contains 4931 rules. 1875 rules in the queue.
26600 rules inserted. The rule base contains 4948 rules. 1874 rules in the queue.
26800 rules inserted. The rule base contains 5030 rules. 1800 rules in the queue.
27000 rules inserted. The rule base contains 5167 rules. 1657 rules in the queue.
27200 rules inserted. The rule base contains 5321 rules. 1493 rules in the queue.
27400 rules inserted. The rule base contains 5481 rules. 1325 rules in the queue.
27600 rules inserted. The rule base contains 5631 rules. 1167 rules in the queue.
27800 rules inserted. The rule base contains 5749 rules. 1045 rules in the queue.
28000 rules inserted. The rule base contains 5786 rules. 1008 rules in the queue.
28200 rules inserted. The rule base contains 5849 rules. 945 rules in the queue.
28400 rules inserted. The rule base contains 5894 rules. 900 rules in the queue.
28600 rules inserted. The rule base contains 5930 rules. 864 rules in the queue.
28800 rules inserted. The rule base contains 6070 rules. 714 rules in the queue.
29000 rules inserted. The rule base contains 6059 rules. 708 rules in the queue.
29200 rules inserted. The rule base contains 6054 rules. 698 rules in the queue.
29400 rules inserted. The rule base contains 6046 rules. 690 rules in the queue.
29600 rules inserted. The rule base contains 6033 rules. 672 rules in the queue.
29800 rules inserted. The rule base contains 6032 rules. 648 rules in the queue.
30000 rules inserted. The rule base contains 6028 rules. 630 rules in the queue.
30200 rules inserted. The rule base contains 6035 rules. 609 rules in the queue.
30400 rules inserted. The rule base contains 6062 rules. 582 rules in the queue.
30600 rules inserted. The rule base contains 6086 rules. 558 rules in the queue.
30800 rules inserted. The rule base contains 6112 rules. 532 rules in the queue.
31000 rules inserted. The rule base contains 6180 rules. 464 rules in the queue.
31200 rules inserted. The rule base contains 6255 rules. 389 rules in the queue.
31400 rules inserted. The rule base contains 6375 rules. 269 rules in the queue.
31600 rules inserted. The rule base contains 6527 rules. 117 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is true.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 436 rules in the queue.
400 rules inserted. The rule base contains 229 rules. 436 rules in the queue.
600 rules inserted. The rule base contains 324 rules. 436 rules in the queue.
800 rules inserted. The rule base contains 399 rules. 434 rules in the queue.
1000 rules inserted. The rule base contains 513 rules. 433 rules in the queue.
1200 rules inserted. The rule base contains 531 rules. 408 rules in the queue.
1400 rules inserted. The rule base contains 528 rules. 408 rules in the queue.
1600 rules inserted. The rule base contains 579 rules. 348 rules in the queue.
1800 rules inserted. The rule base contains 581 rules. 444 rules in the queue.
2000 rules inserted. The rule base contains 601 rules. 648 rules in the queue.
2200 rules inserted. The rule base contains 629 rules. 1115 rules in the queue.
2400 rules inserted. The rule base contains 678 rules. 1952 rules in the queue.
2600 rules inserted. The rule base contains 727 rules. 2622 rules in the queue.
2800 rules inserted. The rule base contains 781 rules. 3678 rules in the queue.
3000 rules inserted. The rule base contains 814 rules. 3750 rules in the queue.
3200 rules inserted. The rule base contains 859 rules. 3939 rules in the queue.
3400 rules inserted. The rule base contains 895 rules. 4129 rules in the queue.
3600 rules inserted. The rule base contains 939 rules. 4126 rules in the queue.
3800 rules inserted. The rule base contains 974 rules. 4317 rules in the queue.
4000 rules inserted. The rule base contains 1018 rules. 4410 rules in the queue.
4200 rules inserted. The rule base contains 1053 rules. 4504 rules in the queue.
4400 rules inserted. The rule base contains 1098 rules. 4597 rules in the queue.
4600 rules inserted. The rule base contains 1144 rules. 4882 rules in the queue.
4800 rules inserted. The rule base contains 1178 rules. 4881 rules in the queue.
5000 rules inserted. The rule base contains 1212 rules. 4879 rules in the queue.
5200 rules inserted. The rule base contains 1257 rules. 4842 rules in the queue.
5400 rules inserted. The rule base contains 1266 rules. 4830 rules in the queue.
5600 rules inserted. The rule base contains 1263 rules. 4824 rules in the queue.
5800 rules inserted. The rule base contains 1299 rules. 4788 rules in the queue.
6000 rules inserted. The rule base contains 1296 rules. 4782 rules in the queue.
6200 rules inserted. The rule base contains 1305 rules. 4770 rules in the queue.
6400 rules inserted. The rule base contains 1338 rules. 4734 rules in the queue.
6600 rules inserted. The rule base contains 1329 rules. 4734 rules in the queue.
6800 rules inserted. The rule base contains 1374 rules. 4691 rules in the queue.
7000 rules inserted. The rule base contains 1401 rules. 4674 rules in the queue.
7200 rules inserted. The rule base contains 1432 rules. 4660 rules in the queue.
7400 rules inserted. The rule base contains 1463 rules. 4647 rules in the queue.
7600 rules inserted. The rule base contains 1499 rules. 4621 rules in the queue.
7800 rules inserted. The rule base contains 1539 rules. 4587 rules in the queue.
8000 rules inserted. The rule base contains 1575 rules. 4577 rules in the queue.
8200 rules inserted. The rule base contains 1603 rules. 4545 rules in the queue.
8400 rules inserted. The rule base contains 1641 rules. 4523 rules in the queue.
8600 rules inserted. The rule base contains 1669 rules. 4509 rules in the queue.
8800 rules inserted. The rule base contains 1709 rules. 4472 rules in the queue.
9000 rules inserted. The rule base contains 1736 rules. 4461 rules in the queue.
9200 rules inserted. The rule base contains 1763 rules. 4460 rules in the queue.
9400 rules inserted. The rule base contains 1797 rules. 4437 rules in the queue.
9600 rules inserted. The rule base contains 1831 rules. 4412 rules in the queue.
9800 rules inserted. The rule base contains 1867 rules. 4372 rules in the queue.
10000 rules inserted. The rule base contains 1978 rules. 4262 rules in the queue.
10200 rules inserted. The rule base contains 2173 rules. 4067 rules in the queue.
10400 rules inserted. The rule base contains 2211 rules. 4029 rules in the queue.
10600 rules inserted. The rule base contains 2406 rules. 3834 rules in the queue.
10800 rules inserted. The rule base contains 2465 rules. 3775 rules in the queue.
11000 rules inserted. The rule base contains 2640 rules. 3600 rules in the queue.
11200 rules inserted. The rule base contains 2757 rules. 3483 rules in the queue.
11400 rules inserted. The rule base contains 2744 rules. 3476 rules in the queue.
11600 rules inserted. The rule base contains 2753 rules. 3451 rules in the queue.
11800 rules inserted. The rule base contains 2814 rules. 3390 rules in the queue.
12000 rules inserted. The rule base contains 2869 rules. 3334 rules in the queue.
12200 rules inserted. The rule base contains 2876 rules. 3315 rules in the queue.
12400 rules inserted. The rule base contains 2903 rules. 3280 rules in the queue.
12600 rules inserted. The rule base contains 2951 rules. 3234 rules in the queue.
12800 rules inserted. The rule base contains 2966 rules. 3190 rules in the queue.
13000 rules inserted. The rule base contains 3008 rules. 3147 rules in the queue.
13200 rules inserted. The rule base contains 2999 rules. 3144 rules in the queue.
13400 rules inserted. The rule base contains 3035 rules. 3101 rules in the queue.
13600 rules inserted. The rule base contains 3109 rules. 3028 rules in the queue.
13800 rules inserted. The rule base contains 3143 rules. 2985 rules in the queue.
14000 rules inserted. The rule base contains 3135 rules. 2982 rules in the queue.
14200 rules inserted. The rule base contains 3122 rules. 2974 rules in the queue.
14400 rules inserted. The rule base contains 3140 rules. 2964 rules in the queue.
14600 rules inserted. The rule base contains 3159 rules. 2953 rules in the queue.
14800 rules inserted. The rule base contains 3160 rules. 2955 rules in the queue.
15000 rules inserted. The rule base contains 3114 rules. 2952 rules in the queue.
15200 rules inserted. The rule base contains 3096 rules. 2950 rules in the queue.
15400 rules inserted. The rule base contains 3084 rules. 2948 rules in the queue.
15600 rules inserted. The rule base contains 3037 rules. 2948 rules in the queue.
15800 rules inserted. The rule base contains 3020 rules. 2945 rules in the queue.
16000 rules inserted. The rule base contains 2993 rules. 2943 rules in the queue.
16200 rules inserted. The rule base contains 2965 rules. 2941 rules in the queue.
16400 rules inserted. The rule base contains 2927 rules. 2941 rules in the queue.
16600 rules inserted. The rule base contains 2912 rules. 2938 rules in the queue.
16800 rules inserted. The rule base contains 2889 rules. 2936 rules in the queue.
17000 rules inserted. The rule base contains 2856 rules. 2935 rules in the queue.
17200 rules inserted. The rule base contains 2819 rules. 2934 rules in the queue.
17400 rules inserted. The rule base contains 2902 rules. 2937 rules in the queue.
17600 rules inserted. The rule base contains 2985 rules. 2940 rules in the queue.
17800 rules inserted. The rule base contains 3063 rules. 2934 rules in the queue.
18000 rules inserted. The rule base contains 3066 rules. 2934 rules in the queue.
18200 rules inserted. The rule base contains 3046 rules. 2934 rules in the queue.
18400 rules inserted. The rule base contains 3043 rules. 2928 rules in the queue.
18600 rules inserted. The rule base contains 3043 rules. 2928 rules in the queue.
18800 rules inserted. The rule base contains 3033 rules. 2924 rules in the queue.
19000 rules inserted. The rule base contains 3029 rules. 2922 rules in the queue.
19200 rules inserted. The rule base contains 3025 rules. 2919 rules in the queue.
19400 rules inserted. The rule base contains 3028 rules. 2916 rules in the queue.
19600 rules inserted. The rule base contains 3009 rules. 2916 rules in the queue.
19800 rules inserted. The rule base contains 3003 rules. 2916 rules in the queue.
20000 rules inserted. The rule base contains 3007 rules. 2910 rules in the queue.
20200 rules inserted. The rule base contains 3072 rules. 3034 rules in the queue.
20400 rules inserted. The rule base contains 3260 rules. 3293 rules in the queue.
20600 rules inserted. The rule base contains 3451 rules. 3654 rules in the queue.
20800 rules inserted. The rule base contains 3523 rules. 3635 rules in the queue.
21000 rules inserted. The rule base contains 3559 rules. 3633 rules in the queue.
21200 rules inserted. The rule base contains 3593 rules. 3633 rules in the queue.
21400 rules inserted. The rule base contains 3635 rules. 3589 rules in the queue.
21600 rules inserted. The rule base contains 3673 rules. 3585 rules in the queue.
21800 rules inserted. The rule base contains 3715 rules. 3541 rules in the queue.
22000 rules inserted. The rule base contains 3751 rules. 3536 rules in the queue.
22200 rules inserted. The rule base contains 3795 rules. 3493 rules in the queue.
22400 rules inserted. The rule base contains 3829 rules. 3487 rules in the queue.
22600 rules inserted. The rule base contains 3854 rules. 3484 rules in the queue.
22800 rules inserted. The rule base contains 3902 rules. 3452 rules in the queue.
23000 rules inserted. The rule base contains 3955 rules. 3397 rules in the queue.
23200 rules inserted. The rule base contains 3880 rules. 3286 rules in the queue.
23400 rules inserted. The rule base contains 3810 rules. 3178 rules in the queue.
23600 rules inserted. The rule base contains 3729 rules. 3071 rules in the queue.
23800 rules inserted. The rule base contains 3787 rules. 3037 rules in the queue.
24000 rules inserted. The rule base contains 3908 rules. 2905 rules in the queue.
24200 rules inserted. The rule base contains 3974 rules. 2836 rules in the queue.
24400 rules inserted. The rule base contains 4085 rules. 2717 rules in the queue.
24600 rules inserted. The rule base contains 4164 rules. 2631 rules in the queue.
24800 rules inserted. The rule base contains 4274 rules. 2515 rules in the queue.
25000 rules inserted. The rule base contains 4385 rules. 2395 rules in the queue.
25200 rules inserted. The rule base contains 4473 rules. 2302 rules in the queue.
25400 rules inserted. The rule base contains 4546 rules. 2222 rules in the queue.
25600 rules inserted. The rule base contains 4681 rules. 2077 rules in the queue.
25800 rules inserted. The rule base contains 4770 rules. 1988 rules in the queue.
26000 rules inserted. The rule base contains 4825 rules. 1957 rules in the queue.
26200 rules inserted. The rule base contains 4881 rules. 1913 rules in the queue.
26400 rules inserted. The rule base contains 4931 rules. 1875 rules in the queue.
26600 rules inserted. The rule base contains 4948 rules. 1874 rules in the queue.
26800 rules inserted. The rule base contains 5030 rules. 1800 rules in the queue.
27000 rules inserted. The rule base contains 5167 rules. 1657 rules in the queue.
27200 rules inserted. The rule base contains 5321 rules. 1493 rules in the queue.
27400 rules inserted. The rule base contains 5481 rules. 1325 rules in the queue.
27600 rules inserted. The rule base contains 5631 rules. 1167 rules in the queue.
27800 rules inserted. The rule base contains 5749 rules. 1045 rules in the queue.
28000 rules inserted. The rule base contains 5786 rules. 1008 rules in the queue.
28200 rules inserted. The rule base contains 5849 rules. 945 rules in the queue.
28400 rules inserted. The rule base contains 5894 rules. 900 rules in the queue.
28600 rules inserted. The rule base contains 5930 rules. 864 rules in the queue.
28800 rules inserted. The rule base contains 6070 rules. 714 rules in the queue.
29000 rules inserted. The rule base contains 6059 rules. 708 rules in the queue.
29200 rules inserted. The rule base contains 6054 rules. 698 rules in the queue.
29400 rules inserted. The rule base contains 6046 rules. 690 rules in the queue.
29600 rules inserted. The rule base contains 6033 rules. 672 rules in the queue.
29800 rules inserted. The rule base contains 6032 rules. 648 rules in the queue.
30000 rules inserted. The rule base contains 6028 rules. 630 rules in the queue.
30200 rules inserted. The rule base contains 6035 rules. 609 rules in the queue.
30400 rules inserted. The rule base contains 6062 rules. 582 rules in the queue.
30600 rules inserted. The rule base contains 6086 rules. 558 rules in the queue.
30800 rules inserted. The rule base contains 6112 rules. 532 rules in the queue.
31000 rules inserted. The rule base contains 6180 rules. 464 rules in the queue.
31200 rules inserted. The rule base contains 6255 rules. 389 rules in the queue.
31400 rules inserted. The rule base contains 6375 rules. 269 rules in the queue.
31600 rules inserted. The rule base contains 6527 rules. 117 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
goal reachable: attacker(mCli(pub(skA[]),pub(skC[])))
Abbreviations:
Nc_921503 = Nc_539[UP_538 = UP_921499,SP_537 = SP_921498,Sess = C[],Disco = A[],Cli = A[],!1 = @sid_921500]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. The attacker has some term UP_921499.
attacker(UP_921499).

5. The attacker has some term SP_921498.
attacker(SP_921498).

6. Using the function None the attacker may obtain None.
attacker(None).

7. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skC[]).
By 6, the attacker may know None.
By 5, the attacker may know SP_921498.
By 4, the attacker may know UP_921499.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skC[]),None,SP_921498,UP_921499).
attacker((GetEndpointResponse,pub(skC[]),None,SP_921498,UP_921499)).

10. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_921498,UP_921499) that the attacker may have by 9 may be received at input {48}.
So the message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_921503))) may be sent to the attacker at output {52}.
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_921503)))).

11. By 10, the attacker may know (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_921503))).
Using the function 2-proj-2-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_921503)).
attacker((OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_921503))).

12. By 11, the attacker may know (OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_921503)).
Using the function 3-proj-3-tuple the attacker may obtain exp(g,Nc_921503).
attacker(exp(g,Nc_921503)).

13. The attacker has some term TTL_921497.
attacker(TTL_921497).

14. The attacker has some term ST_921496.
attacker(ST_921496).

15. Using the function g the attacker may obtain g.
attacker(g).

16. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

17. By 16, the attacker may know OpenSecureChannelResponse.
By 15, the attacker may know g.
By 14, the attacker may know ST_921496.
By 13, the attacker may know TTL_921497.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelResponse,g,ST_921496,TTL_921497).
attacker((OpenSecureChannelResponse,g,ST_921496,TTL_921497)).

18. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_921498,UP_921499) that the attacker may have by 9 may be received at input {48}.
The message (OpenSecureChannelResponse,g,ST_921496,TTL_921497) that the attacker may have by 17 may be received at input {53}.
So the message senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_921503)) may be sent to the attacker at output {57}.
attacker(senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_921503))).

19. By 18, the attacker may know senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_921503)).
By 12, the attacker may know exp(g,Nc_921503).
Using the function sdec the attacker may obtain mCli(pub(skA[]),pub(skC[])).
attacker(mCli(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {8} in copy a_921505

out(c, GetEndpointRequest) at {47} in copy a_921505

in(c, (GetEndpointResponse,pub(skC),None,a_921504,a)) at {48} in copy a_921505

new Nc_539 creating Nc_921508 at {49} in copy a_921505

out(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),exp(g,Nc_921508)))) at {52} in copy a_921505

in(c, (OpenSecureChannelResponse,g,a_921506,a_921507)) at {53} in copy a_921505

out(c, senc(mCli(pub(skA),pub(skC)),exp(g,Nc_921508))) at {57} in copy a_921505

The attacker has the message mCli(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is false.
