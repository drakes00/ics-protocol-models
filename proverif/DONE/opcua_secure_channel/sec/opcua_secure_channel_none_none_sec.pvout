Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_516: bool = (Cli = A) in
    (
        {10}if v_516 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_517: bool = (Disco = A) in
            (
                {14}if v_517 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_518: bool = (Sess = A) in
                    (
                        {17}if v_518 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let gNc: bitstring = exp(g,Nc) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,pkCli,gNc) in
                            {24}out(c, (pkCli,m1));
                            {25}in(c, em2: bitstring);
                            {26}let m2: bitstring = em2 in
                            {27}let (=OpenSecureChannelResponse,PartS: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {28}let Kcli: bitstring = exp(PartS,Nc) in
                            {29}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {30}let v_519: bool = (Sess = B) in
                            (
                                {31}if v_519 then
                                (
                                    {32}let pkSess_520: bitstring = pub(skB) in
                                    {33}out(c, GetEndpointRequest);
                                    {34}in(c, (=GetEndpointResponse,=pkSess_520,=None,SP_521: bitstring,UP_522: bitstring));
                                    {35}new Nc_523: bitstring;
                                    {36}let gNc_524: bitstring = exp(g,Nc_523) in
                                    {37}let m1_525: bitstring = (OpenSecureChannelRequest,pkCli,gNc_524) in
                                    {38}out(c, (pkCli,m1_525));
                                    {39}in(c, em2_526: bitstring);
                                    {40}let m2_527: bitstring = em2_526 in
                                    {41}let (=OpenSecureChannelResponse,PartS_528: bitstring,ST_529: bitstring,TTL_530: bitstring) = m2_527 in
                                    {42}let Kcli_531: bitstring = exp(PartS_528,Nc_523) in
                                    {43}out(c, senc(mCli(pkCli,pkSess_520),Kcli_531))
                                )
                                else
                                    {44}let v_532: bool = (Sess = C) in
                                    (
                                        {45}if v_532 then
                                        (
                                            {46}let pkSess_533: bitstring = pub(skC) in
                                            {47}out(c, GetEndpointRequest);
                                            {48}in(c, (=GetEndpointResponse,=pkSess_533,=None,SP_534: bitstring,UP_535: bitstring));
                                            {49}new Nc_536: bitstring;
                                            {50}let gNc_537: bitstring = exp(g,Nc_536) in
                                            {51}let m1_538: bitstring = (OpenSecureChannelRequest,pkCli,gNc_537) in
                                            {52}out(c, (pkCli,m1_538));
                                            {53}in(c, em2_539: bitstring);
                                            {54}let m2_540: bitstring = em2_539 in
                                            {55}let (=OpenSecureChannelResponse,PartS_541: bitstring,ST_542: bitstring,TTL_543: bitstring) = m2_540 in
                                            {56}let Kcli_544: bitstring = exp(PartS_541,Nc_536) in
                                            {57}out(c, senc(mCli(pkCli,pkSess_533),Kcli_544))
                                        )
                                        else
                                            {58}let pkSess_545: bitstring = pub(sk(Sess)) in
                                            {59}out(c, GetEndpointRequest);
                                            {60}in(c, (=GetEndpointResponse,=pkSess_545,=None,SP_546: bitstring,UP_547: bitstring));
                                            {61}new Nc_548: bitstring;
                                            {62}let gNc_549: bitstring = exp(g,Nc_548) in
                                            {63}let m1_550: bitstring = (OpenSecureChannelRequest,pkCli,gNc_549) in
                                            {64}out(c, (pkCli,m1_550));
                                            {65}in(c, em2_551: bitstring);
                                            {66}let m2_552: bitstring = em2_551 in
                                            {67}let (=OpenSecureChannelResponse,PartS_553: bitstring,ST_554: bitstring,TTL_555: bitstring) = m2_552 in
                                            {68}let Kcli_556: bitstring = exp(PartS_553,Nc_548) in
                                            {69}out(c, senc(mCli(pkCli,pkSess_545),Kcli_556))
                                    )
                                    else
                                        {70}let pkSess_557: bitstring = fail-any in
                                        {71}out(c, GetEndpointRequest);
                                        {72}in(c, (=GetEndpointResponse,=pkSess_557,=None,SP_558: bitstring,UP_559: bitstring));
                                        {73}new Nc_560: bitstring;
                                        {74}let gNc_561: bitstring = exp(g,Nc_560) in
                                        {75}let m1_562: bitstring = (OpenSecureChannelRequest,pkCli,gNc_561) in
                                        {76}out(c, (pkCli,m1_562));
                                        {77}in(c, em2_563: bitstring);
                                        {78}let m2_564: bitstring = em2_563 in
                                        {79}let (=OpenSecureChannelResponse,PartS_565: bitstring,ST_566: bitstring,TTL_567: bitstring) = m2_564 in
                                        {80}let Kcli_568: bitstring = exp(PartS_565,Nc_560) in
                                        {81}out(c, senc(mCli(pkCli,pkSess_557),Kcli_568))
                            )
                            else
                                {82}let pkSess_569: bitstring = fail-any in
                                {83}out(c, GetEndpointRequest);
                                {84}in(c, (=GetEndpointResponse,=pkSess_569,=None,SP_570: bitstring,UP_571: bitstring));
                                {85}new Nc_572: bitstring;
                                {86}let gNc_573: bitstring = exp(g,Nc_572) in
                                {87}let m1_574: bitstring = (OpenSecureChannelRequest,pkCli,gNc_573) in
                                {88}out(c, (pkCli,m1_574));
                                {89}in(c, em2_575: bitstring);
                                {90}let m2_576: bitstring = em2_575 in
                                {91}let (=OpenSecureChannelResponse,PartS_577: bitstring,ST_578: bitstring,TTL_579: bitstring) = m2_576 in
                                {92}let Kcli_580: bitstring = exp(PartS_577,Nc_572) in
                                {93}out(c, senc(mCli(pkCli,pkSess_569),Kcli_580))
                    )
                    else
                        {94}let pkSess_581: bitstring = fail-any in
                        {95}out(c, GetEndpointRequest);
                        {96}in(c, (=GetEndpointResponse,=pkSess_581,=None,SP_582: bitstring,UP_583: bitstring));
                        {97}new Nc_584: bitstring;
                        {98}let gNc_585: bitstring = exp(g,Nc_584) in
                        {99}let m1_586: bitstring = (OpenSecureChannelRequest,pkCli,gNc_585) in
                        {100}out(c, (pkCli,m1_586));
                        {101}in(c, em2_587: bitstring);
                        {102}let m2_588: bitstring = em2_587 in
                        {103}let (=OpenSecureChannelResponse,PartS_589: bitstring,ST_590: bitstring,TTL_591: bitstring) = m2_588 in
                        {104}let Kcli_592: bitstring = exp(PartS_589,Nc_584) in
                        {105}out(c, senc(mCli(pkCli,pkSess_581),Kcli_592))
                )
                else
                    {106}let v_593: bool = (Disco = B) in
                    (
                        {107}if v_593 then
                        (
                            {108}let pkDisco_594: bitstring = pub(skB) in
                            {109}let v_595: bool = (Sess = A) in
                            (
                                {110}if v_595 then
                                (
                                    {111}let pkSess_596: bitstring = pub(skA) in
                                    {112}out(c, GetEndpointRequest);
                                    {113}in(c, (=GetEndpointResponse,=pkSess_596,=None,SP_597: bitstring,UP_598: bitstring));
                                    {114}new Nc_599: bitstring;
                                    {115}let gNc_600: bitstring = exp(g,Nc_599) in
                                    {116}let m1_601: bitstring = (OpenSecureChannelRequest,pkCli,gNc_600) in
                                    {117}out(c, (pkCli,m1_601));
                                    {118}in(c, em2_602: bitstring);
                                    {119}let m2_603: bitstring = em2_602 in
                                    {120}let (=OpenSecureChannelResponse,PartS_604: bitstring,ST_605: bitstring,TTL_606: bitstring) = m2_603 in
                                    {121}let Kcli_607: bitstring = exp(PartS_604,Nc_599) in
                                    {122}out(c, senc(mCli(pkCli,pkSess_596),Kcli_607))
                                )
                                else
                                    {123}let v_608: bool = (Sess = B) in
                                    (
                                        {124}if v_608 then
                                        (
                                            {125}let pkSess_609: bitstring = pub(skB) in
                                            {126}out(c, GetEndpointRequest);
                                            {127}in(c, (=GetEndpointResponse,=pkSess_609,=None,SP_610: bitstring,UP_611: bitstring));
                                            {128}new Nc_612: bitstring;
                                            {129}let gNc_613: bitstring = exp(g,Nc_612) in
                                            {130}let m1_614: bitstring = (OpenSecureChannelRequest,pkCli,gNc_613) in
                                            {131}out(c, (pkCli,m1_614));
                                            {132}in(c, em2_615: bitstring);
                                            {133}let m2_616: bitstring = em2_615 in
                                            {134}let (=OpenSecureChannelResponse,PartS_617: bitstring,ST_618: bitstring,TTL_619: bitstring) = m2_616 in
                                            {135}let Kcli_620: bitstring = exp(PartS_617,Nc_612) in
                                            {136}out(c, senc(mCli(pkCli,pkSess_609),Kcli_620))
                                        )
                                        else
                                            {137}let v_621: bool = (Sess = C) in
                                            (
                                                {138}if v_621 then
                                                (
                                                    {139}let pkSess_622: bitstring = pub(skC) in
                                                    {140}out(c, GetEndpointRequest);
                                                    {141}in(c, (=GetEndpointResponse,=pkSess_622,=None,SP_623: bitstring,UP_624: bitstring));
                                                    {142}new Nc_625: bitstring;
                                                    {143}let gNc_626: bitstring = exp(g,Nc_625) in
                                                    {144}let m1_627: bitstring = (OpenSecureChannelRequest,pkCli,gNc_626) in
                                                    {145}out(c, (pkCli,m1_627));
                                                    {146}in(c, em2_628: bitstring);
                                                    {147}let m2_629: bitstring = em2_628 in
                                                    {148}let (=OpenSecureChannelResponse,PartS_630: bitstring,ST_631: bitstring,TTL_632: bitstring) = m2_629 in
                                                    {149}let Kcli_633: bitstring = exp(PartS_630,Nc_625) in
                                                    {150}out(c, senc(mCli(pkCli,pkSess_622),Kcli_633))
                                                )
                                                else
                                                    {151}let pkSess_634: bitstring = pub(sk(Sess)) in
                                                    {152}out(c, GetEndpointRequest);
                                                    {153}in(c, (=GetEndpointResponse,=pkSess_634,=None,SP_635: bitstring,UP_636: bitstring));
                                                    {154}new Nc_637: bitstring;
                                                    {155}let gNc_638: bitstring = exp(g,Nc_637) in
                                                    {156}let m1_639: bitstring = (OpenSecureChannelRequest,pkCli,gNc_638) in
                                                    {157}out(c, (pkCli,m1_639));
                                                    {158}in(c, em2_640: bitstring);
                                                    {159}let m2_641: bitstring = em2_640 in
                                                    {160}let (=OpenSecureChannelResponse,PartS_642: bitstring,ST_643: bitstring,TTL_644: bitstring) = m2_641 in
                                                    {161}let Kcli_645: bitstring = exp(PartS_642,Nc_637) in
                                                    {162}out(c, senc(mCli(pkCli,pkSess_634),Kcli_645))
                                            )
                                            else
                                                {163}let pkSess_646: bitstring = fail-any in
                                                {164}out(c, GetEndpointRequest);
                                                {165}in(c, (=GetEndpointResponse,=pkSess_646,=None,SP_647: bitstring,UP_648: bitstring));
                                                {166}new Nc_649: bitstring;
                                                {167}let gNc_650: bitstring = exp(g,Nc_649) in
                                                {168}let m1_651: bitstring = (OpenSecureChannelRequest,pkCli,gNc_650) in
                                                {169}out(c, (pkCli,m1_651));
                                                {170}in(c, em2_652: bitstring);
                                                {171}let m2_653: bitstring = em2_652 in
                                                {172}let (=OpenSecureChannelResponse,PartS_654: bitstring,ST_655: bitstring,TTL_656: bitstring) = m2_653 in
                                                {173}let Kcli_657: bitstring = exp(PartS_654,Nc_649) in
                                                {174}out(c, senc(mCli(pkCli,pkSess_646),Kcli_657))
                                    )
                                    else
                                        {175}let pkSess_658: bitstring = fail-any in
                                        {176}out(c, GetEndpointRequest);
                                        {177}in(c, (=GetEndpointResponse,=pkSess_658,=None,SP_659: bitstring,UP_660: bitstring));
                                        {178}new Nc_661: bitstring;
                                        {179}let gNc_662: bitstring = exp(g,Nc_661) in
                                        {180}let m1_663: bitstring = (OpenSecureChannelRequest,pkCli,gNc_662) in
                                        {181}out(c, (pkCli,m1_663));
                                        {182}in(c, em2_664: bitstring);
                                        {183}let m2_665: bitstring = em2_664 in
                                        {184}let (=OpenSecureChannelResponse,PartS_666: bitstring,ST_667: bitstring,TTL_668: bitstring) = m2_665 in
                                        {185}let Kcli_669: bitstring = exp(PartS_666,Nc_661) in
                                        {186}out(c, senc(mCli(pkCli,pkSess_658),Kcli_669))
                            )
                            else
                                {187}let pkSess_670: bitstring = fail-any in
                                {188}out(c, GetEndpointRequest);
                                {189}in(c, (=GetEndpointResponse,=pkSess_670,=None,SP_671: bitstring,UP_672: bitstring));
                                {190}new Nc_673: bitstring;
                                {191}let gNc_674: bitstring = exp(g,Nc_673) in
                                {192}let m1_675: bitstring = (OpenSecureChannelRequest,pkCli,gNc_674) in
                                {193}out(c, (pkCli,m1_675));
                                {194}in(c, em2_676: bitstring);
                                {195}let m2_677: bitstring = em2_676 in
                                {196}let (=OpenSecureChannelResponse,PartS_678: bitstring,ST_679: bitstring,TTL_680: bitstring) = m2_677 in
                                {197}let Kcli_681: bitstring = exp(PartS_678,Nc_673) in
                                {198}out(c, senc(mCli(pkCli,pkSess_670),Kcli_681))
                        )
                        else
                            {199}let v_682: bool = (Disco = C) in
                            (
                                {200}if v_682 then
                                (
                                    {201}let pkDisco_683: bitstring = pub(skC) in
                                    {202}let v_684: bool = (Sess = A) in
                                    (
                                        {203}if v_684 then
                                        (
                                            {204}let pkSess_685: bitstring = pub(skA) in
                                            {205}out(c, GetEndpointRequest);
                                            {206}in(c, (=GetEndpointResponse,=pkSess_685,=None,SP_686: bitstring,UP_687: bitstring));
                                            {207}new Nc_688: bitstring;
                                            {208}let gNc_689: bitstring = exp(g,Nc_688) in
                                            {209}let m1_690: bitstring = (OpenSecureChannelRequest,pkCli,gNc_689) in
                                            {210}out(c, (pkCli,m1_690));
                                            {211}in(c, em2_691: bitstring);
                                            {212}let m2_692: bitstring = em2_691 in
                                            {213}let (=OpenSecureChannelResponse,PartS_693: bitstring,ST_694: bitstring,TTL_695: bitstring) = m2_692 in
                                            {214}let Kcli_696: bitstring = exp(PartS_693,Nc_688) in
                                            {215}out(c, senc(mCli(pkCli,pkSess_685),Kcli_696))
                                        )
                                        else
                                            {216}let v_697: bool = (Sess = B) in
                                            (
                                                {217}if v_697 then
                                                (
                                                    {218}let pkSess_698: bitstring = pub(skB) in
                                                    {219}out(c, GetEndpointRequest);
                                                    {220}in(c, (=GetEndpointResponse,=pkSess_698,=None,SP_699: bitstring,UP_700: bitstring));
                                                    {221}new Nc_701: bitstring;
                                                    {222}let gNc_702: bitstring = exp(g,Nc_701) in
                                                    {223}let m1_703: bitstring = (OpenSecureChannelRequest,pkCli,gNc_702) in
                                                    {224}out(c, (pkCli,m1_703));
                                                    {225}in(c, em2_704: bitstring);
                                                    {226}let m2_705: bitstring = em2_704 in
                                                    {227}let (=OpenSecureChannelResponse,PartS_706: bitstring,ST_707: bitstring,TTL_708: bitstring) = m2_705 in
                                                    {228}let Kcli_709: bitstring = exp(PartS_706,Nc_701) in
                                                    {229}out(c, senc(mCli(pkCli,pkSess_698),Kcli_709))
                                                )
                                                else
                                                    {230}let v_710: bool = (Sess = C) in
                                                    (
                                                        {231}if v_710 then
                                                        (
                                                            {232}let pkSess_711: bitstring = pub(skC) in
                                                            {233}out(c, GetEndpointRequest);
                                                            {234}in(c, (=GetEndpointResponse,=pkSess_711,=None,SP_712: bitstring,UP_713: bitstring));
                                                            {235}new Nc_714: bitstring;
                                                            {236}let gNc_715: bitstring = exp(g,Nc_714) in
                                                            {237}let m1_716: bitstring = (OpenSecureChannelRequest,pkCli,gNc_715) in
                                                            {238}out(c, (pkCli,m1_716));
                                                            {239}in(c, em2_717: bitstring);
                                                            {240}let m2_718: bitstring = em2_717 in
                                                            {241}let (=OpenSecureChannelResponse,PartS_719: bitstring,ST_720: bitstring,TTL_721: bitstring) = m2_718 in
                                                            {242}let Kcli_722: bitstring = exp(PartS_719,Nc_714) in
                                                            {243}out(c, senc(mCli(pkCli,pkSess_711),Kcli_722))
                                                        )
                                                        else
                                                            {244}let pkSess_723: bitstring = pub(sk(Sess)) in
                                                            {245}out(c, GetEndpointRequest);
                                                            {246}in(c, (=GetEndpointResponse,=pkSess_723,=None,SP_724: bitstring,UP_725: bitstring));
                                                            {247}new Nc_726: bitstring;
                                                            {248}let gNc_727: bitstring = exp(g,Nc_726) in
                                                            {249}let m1_728: bitstring = (OpenSecureChannelRequest,pkCli,gNc_727) in
                                                            {250}out(c, (pkCli,m1_728));
                                                            {251}in(c, em2_729: bitstring);
                                                            {252}let m2_730: bitstring = em2_729 in
                                                            {253}let (=OpenSecureChannelResponse,PartS_731: bitstring,ST_732: bitstring,TTL_733: bitstring) = m2_730 in
                                                            {254}let Kcli_734: bitstring = exp(PartS_731,Nc_726) in
                                                            {255}out(c, senc(mCli(pkCli,pkSess_723),Kcli_734))
                                                    )
                                                    else
                                                        {256}let pkSess_735: bitstring = fail-any in
                                                        {257}out(c, GetEndpointRequest);
                                                        {258}in(c, (=GetEndpointResponse,=pkSess_735,=None,SP_736: bitstring,UP_737: bitstring));
                                                        {259}new Nc_738: bitstring;
                                                        {260}let gNc_739: bitstring = exp(g,Nc_738) in
                                                        {261}let m1_740: bitstring = (OpenSecureChannelRequest,pkCli,gNc_739) in
                                                        {262}out(c, (pkCli,m1_740));
                                                        {263}in(c, em2_741: bitstring);
                                                        {264}let m2_742: bitstring = em2_741 in
                                                        {265}let (=OpenSecureChannelResponse,PartS_743: bitstring,ST_744: bitstring,TTL_745: bitstring) = m2_742 in
                                                        {266}let Kcli_746: bitstring = exp(PartS_743,Nc_738) in
                                                        {267}out(c, senc(mCli(pkCli,pkSess_735),Kcli_746))
                                            )
                                            else
                                                {268}let pkSess_747: bitstring = fail-any in
                                                {269}out(c, GetEndpointRequest);
                                                {270}in(c, (=GetEndpointResponse,=pkSess_747,=None,SP_748: bitstring,UP_749: bitstring));
                                                {271}new Nc_750: bitstring;
                                                {272}let gNc_751: bitstring = exp(g,Nc_750) in
                                                {273}let m1_752: bitstring = (OpenSecureChannelRequest,pkCli,gNc_751) in
                                                {274}out(c, (pkCli,m1_752));
                                                {275}in(c, em2_753: bitstring);
                                                {276}let m2_754: bitstring = em2_753 in
                                                {277}let (=OpenSecureChannelResponse,PartS_755: bitstring,ST_756: bitstring,TTL_757: bitstring) = m2_754 in
                                                {278}let Kcli_758: bitstring = exp(PartS_755,Nc_750) in
                                                {279}out(c, senc(mCli(pkCli,pkSess_747),Kcli_758))
                                    )
                                    else
                                        {280}let pkSess_759: bitstring = fail-any in
                                        {281}out(c, GetEndpointRequest);
                                        {282}in(c, (=GetEndpointResponse,=pkSess_759,=None,SP_760: bitstring,UP_761: bitstring));
                                        {283}new Nc_762: bitstring;
                                        {284}let gNc_763: bitstring = exp(g,Nc_762) in
                                        {285}let m1_764: bitstring = (OpenSecureChannelRequest,pkCli,gNc_763) in
                                        {286}out(c, (pkCli,m1_764));
                                        {287}in(c, em2_765: bitstring);
                                        {288}let m2_766: bitstring = em2_765 in
                                        {289}let (=OpenSecureChannelResponse,PartS_767: bitstring,ST_768: bitstring,TTL_769: bitstring) = m2_766 in
                                        {290}let Kcli_770: bitstring = exp(PartS_767,Nc_762) in
                                        {291}out(c, senc(mCli(pkCli,pkSess_759),Kcli_770))
                                )
                                else
                                    {292}let pkDisco_771: bitstring = pub(sk(Disco)) in
                                    {293}let v_772: bool = (Sess = A) in
                                    (
                                        {294}if v_772 then
                                        (
                                            {295}let pkSess_773: bitstring = pub(skA) in
                                            {296}out(c, GetEndpointRequest);
                                            {297}in(c, (=GetEndpointResponse,=pkSess_773,=None,SP_774: bitstring,UP_775: bitstring));
                                            {298}new Nc_776: bitstring;
                                            {299}let gNc_777: bitstring = exp(g,Nc_776) in
                                            {300}let m1_778: bitstring = (OpenSecureChannelRequest,pkCli,gNc_777) in
                                            {301}out(c, (pkCli,m1_778));
                                            {302}in(c, em2_779: bitstring);
                                            {303}let m2_780: bitstring = em2_779 in
                                            {304}let (=OpenSecureChannelResponse,PartS_781: bitstring,ST_782: bitstring,TTL_783: bitstring) = m2_780 in
                                            {305}let Kcli_784: bitstring = exp(PartS_781,Nc_776) in
                                            {306}out(c, senc(mCli(pkCli,pkSess_773),Kcli_784))
                                        )
                                        else
                                            {307}let v_785: bool = (Sess = B) in
                                            (
                                                {308}if v_785 then
                                                (
                                                    {309}let pkSess_786: bitstring = pub(skB) in
                                                    {310}out(c, GetEndpointRequest);
                                                    {311}in(c, (=GetEndpointResponse,=pkSess_786,=None,SP_787: bitstring,UP_788: bitstring));
                                                    {312}new Nc_789: bitstring;
                                                    {313}let gNc_790: bitstring = exp(g,Nc_789) in
                                                    {314}let m1_791: bitstring = (OpenSecureChannelRequest,pkCli,gNc_790) in
                                                    {315}out(c, (pkCli,m1_791));
                                                    {316}in(c, em2_792: bitstring);
                                                    {317}let m2_793: bitstring = em2_792 in
                                                    {318}let (=OpenSecureChannelResponse,PartS_794: bitstring,ST_795: bitstring,TTL_796: bitstring) = m2_793 in
                                                    {319}let Kcli_797: bitstring = exp(PartS_794,Nc_789) in
                                                    {320}out(c, senc(mCli(pkCli,pkSess_786),Kcli_797))
                                                )
                                                else
                                                    {321}let v_798: bool = (Sess = C) in
                                                    (
                                                        {322}if v_798 then
                                                        (
                                                            {323}let pkSess_799: bitstring = pub(skC) in
                                                            {324}out(c, GetEndpointRequest);
                                                            {325}in(c, (=GetEndpointResponse,=pkSess_799,=None,SP_800: bitstring,UP_801: bitstring));
                                                            {326}new Nc_802: bitstring;
                                                            {327}let gNc_803: bitstring = exp(g,Nc_802) in
                                                            {328}let m1_804: bitstring = (OpenSecureChannelRequest,pkCli,gNc_803) in
                                                            {329}out(c, (pkCli,m1_804));
                                                            {330}in(c, em2_805: bitstring);
                                                            {331}let m2_806: bitstring = em2_805 in
                                                            {332}let (=OpenSecureChannelResponse,PartS_807: bitstring,ST_808: bitstring,TTL_809: bitstring) = m2_806 in
                                                            {333}let Kcli_810: bitstring = exp(PartS_807,Nc_802) in
                                                            {334}out(c, senc(mCli(pkCli,pkSess_799),Kcli_810))
                                                        )
                                                        else
                                                            {335}let pkSess_811: bitstring = pub(sk(Sess)) in
                                                            {336}out(c, GetEndpointRequest);
                                                            {337}in(c, (=GetEndpointResponse,=pkSess_811,=None,SP_812: bitstring,UP_813: bitstring));
                                                            {338}new Nc_814: bitstring;
                                                            {339}let gNc_815: bitstring = exp(g,Nc_814) in
                                                            {340}let m1_816: bitstring = (OpenSecureChannelRequest,pkCli,gNc_815) in
                                                            {341}out(c, (pkCli,m1_816));
                                                            {342}in(c, em2_817: bitstring);
                                                            {343}let m2_818: bitstring = em2_817 in
                                                            {344}let (=OpenSecureChannelResponse,PartS_819: bitstring,ST_820: bitstring,TTL_821: bitstring) = m2_818 in
                                                            {345}let Kcli_822: bitstring = exp(PartS_819,Nc_814) in
                                                            {346}out(c, senc(mCli(pkCli,pkSess_811),Kcli_822))
                                                    )
                                                    else
                                                        {347}let pkSess_823: bitstring = fail-any in
                                                        {348}out(c, GetEndpointRequest);
                                                        {349}in(c, (=GetEndpointResponse,=pkSess_823,=None,SP_824: bitstring,UP_825: bitstring));
                                                        {350}new Nc_826: bitstring;
                                                        {351}let gNc_827: bitstring = exp(g,Nc_826) in
                                                        {352}let m1_828: bitstring = (OpenSecureChannelRequest,pkCli,gNc_827) in
                                                        {353}out(c, (pkCli,m1_828));
                                                        {354}in(c, em2_829: bitstring);
                                                        {355}let m2_830: bitstring = em2_829 in
                                                        {356}let (=OpenSecureChannelResponse,PartS_831: bitstring,ST_832: bitstring,TTL_833: bitstring) = m2_830 in
                                                        {357}let Kcli_834: bitstring = exp(PartS_831,Nc_826) in
                                                        {358}out(c, senc(mCli(pkCli,pkSess_823),Kcli_834))
                                            )
                                            else
                                                {359}let pkSess_835: bitstring = fail-any in
                                                {360}out(c, GetEndpointRequest);
                                                {361}in(c, (=GetEndpointResponse,=pkSess_835,=None,SP_836: bitstring,UP_837: bitstring));
                                                {362}new Nc_838: bitstring;
                                                {363}let gNc_839: bitstring = exp(g,Nc_838) in
                                                {364}let m1_840: bitstring = (OpenSecureChannelRequest,pkCli,gNc_839) in
                                                {365}out(c, (pkCli,m1_840));
                                                {366}in(c, em2_841: bitstring);
                                                {367}let m2_842: bitstring = em2_841 in
                                                {368}let (=OpenSecureChannelResponse,PartS_843: bitstring,ST_844: bitstring,TTL_845: bitstring) = m2_842 in
                                                {369}let Kcli_846: bitstring = exp(PartS_843,Nc_838) in
                                                {370}out(c, senc(mCli(pkCli,pkSess_835),Kcli_846))
                                    )
                                    else
                                        {371}let pkSess_847: bitstring = fail-any in
                                        {372}out(c, GetEndpointRequest);
                                        {373}in(c, (=GetEndpointResponse,=pkSess_847,=None,SP_848: bitstring,UP_849: bitstring));
                                        {374}new Nc_850: bitstring;
                                        {375}let gNc_851: bitstring = exp(g,Nc_850) in
                                        {376}let m1_852: bitstring = (OpenSecureChannelRequest,pkCli,gNc_851) in
                                        {377}out(c, (pkCli,m1_852));
                                        {378}in(c, em2_853: bitstring);
                                        {379}let m2_854: bitstring = em2_853 in
                                        {380}let (=OpenSecureChannelResponse,PartS_855: bitstring,ST_856: bitstring,TTL_857: bitstring) = m2_854 in
                                        {381}let Kcli_858: bitstring = exp(PartS_855,Nc_850) in
                                        {382}out(c, senc(mCli(pkCli,pkSess_847),Kcli_858))
                            )
                            else
                                {383}let pkDisco_859: bitstring = fail-any in
                                {384}let v_860: bool = (Sess = A) in
                                (
                                    {385}if v_860 then
                                    (
                                        {386}let pkSess_861: bitstring = pub(skA) in
                                        {387}out(c, GetEndpointRequest);
                                        {388}in(c, (=GetEndpointResponse,=pkSess_861,=None,SP_862: bitstring,UP_863: bitstring));
                                        {389}new Nc_864: bitstring;
                                        {390}let gNc_865: bitstring = exp(g,Nc_864) in
                                        {391}let m1_866: bitstring = (OpenSecureChannelRequest,pkCli,gNc_865) in
                                        {392}out(c, (pkCli,m1_866));
                                        {393}in(c, em2_867: bitstring);
                                        {394}let m2_868: bitstring = em2_867 in
                                        {395}let (=OpenSecureChannelResponse,PartS_869: bitstring,ST_870: bitstring,TTL_871: bitstring) = m2_868 in
                                        {396}let Kcli_872: bitstring = exp(PartS_869,Nc_864) in
                                        {397}out(c, senc(mCli(pkCli,pkSess_861),Kcli_872))
                                    )
                                    else
                                        {398}let v_873: bool = (Sess = B) in
                                        (
                                            {399}if v_873 then
                                            (
                                                {400}let pkSess_874: bitstring = pub(skB) in
                                                {401}out(c, GetEndpointRequest);
                                                {402}in(c, (=GetEndpointResponse,=pkSess_874,=None,SP_875: bitstring,UP_876: bitstring));
                                                {403}new Nc_877: bitstring;
                                                {404}let gNc_878: bitstring = exp(g,Nc_877) in
                                                {405}let m1_879: bitstring = (OpenSecureChannelRequest,pkCli,gNc_878) in
                                                {406}out(c, (pkCli,m1_879));
                                                {407}in(c, em2_880: bitstring);
                                                {408}let m2_881: bitstring = em2_880 in
                                                {409}let (=OpenSecureChannelResponse,PartS_882: bitstring,ST_883: bitstring,TTL_884: bitstring) = m2_881 in
                                                {410}let Kcli_885: bitstring = exp(PartS_882,Nc_877) in
                                                {411}out(c, senc(mCli(pkCli,pkSess_874),Kcli_885))
                                            )
                                            else
                                                {412}let v_886: bool = (Sess = C) in
                                                (
                                                    {413}if v_886 then
                                                    (
                                                        {414}let pkSess_887: bitstring = pub(skC) in
                                                        {415}out(c, GetEndpointRequest);
                                                        {416}in(c, (=GetEndpointResponse,=pkSess_887,=None,SP_888: bitstring,UP_889: bitstring));
                                                        {417}new Nc_890: bitstring;
                                                        {418}let gNc_891: bitstring = exp(g,Nc_890) in
                                                        {419}let m1_892: bitstring = (OpenSecureChannelRequest,pkCli,gNc_891) in
                                                        {420}out(c, (pkCli,m1_892));
                                                        {421}in(c, em2_893: bitstring);
                                                        {422}let m2_894: bitstring = em2_893 in
                                                        {423}let (=OpenSecureChannelResponse,PartS_895: bitstring,ST_896: bitstring,TTL_897: bitstring) = m2_894 in
                                                        {424}let Kcli_898: bitstring = exp(PartS_895,Nc_890) in
                                                        {425}out(c, senc(mCli(pkCli,pkSess_887),Kcli_898))
                                                    )
                                                    else
                                                        {426}let pkSess_899: bitstring = pub(sk(Sess)) in
                                                        {427}out(c, GetEndpointRequest);
                                                        {428}in(c, (=GetEndpointResponse,=pkSess_899,=None,SP_900: bitstring,UP_901: bitstring));
                                                        {429}new Nc_902: bitstring;
                                                        {430}let gNc_903: bitstring = exp(g,Nc_902) in
                                                        {431}let m1_904: bitstring = (OpenSecureChannelRequest,pkCli,gNc_903) in
                                                        {432}out(c, (pkCli,m1_904));
                                                        {433}in(c, em2_905: bitstring);
                                                        {434}let m2_906: bitstring = em2_905 in
                                                        {435}let (=OpenSecureChannelResponse,PartS_907: bitstring,ST_908: bitstring,TTL_909: bitstring) = m2_906 in
                                                        {436}let Kcli_910: bitstring = exp(PartS_907,Nc_902) in
                                                        {437}out(c, senc(mCli(pkCli,pkSess_899),Kcli_910))
                                                )
                                                else
                                                    {438}let pkSess_911: bitstring = fail-any in
                                                    {439}out(c, GetEndpointRequest);
                                                    {440}in(c, (=GetEndpointResponse,=pkSess_911,=None,SP_912: bitstring,UP_913: bitstring));
                                                    {441}new Nc_914: bitstring;
                                                    {442}let gNc_915: bitstring = exp(g,Nc_914) in
                                                    {443}let m1_916: bitstring = (OpenSecureChannelRequest,pkCli,gNc_915) in
                                                    {444}out(c, (pkCli,m1_916));
                                                    {445}in(c, em2_917: bitstring);
                                                    {446}let m2_918: bitstring = em2_917 in
                                                    {447}let (=OpenSecureChannelResponse,PartS_919: bitstring,ST_920: bitstring,TTL_921: bitstring) = m2_918 in
                                                    {448}let Kcli_922: bitstring = exp(PartS_919,Nc_914) in
                                                    {449}out(c, senc(mCli(pkCli,pkSess_911),Kcli_922))
                                        )
                                        else
                                            {450}let pkSess_923: bitstring = fail-any in
                                            {451}out(c, GetEndpointRequest);
                                            {452}in(c, (=GetEndpointResponse,=pkSess_923,=None,SP_924: bitstring,UP_925: bitstring));
                                            {453}new Nc_926: bitstring;
                                            {454}let gNc_927: bitstring = exp(g,Nc_926) in
                                            {455}let m1_928: bitstring = (OpenSecureChannelRequest,pkCli,gNc_927) in
                                            {456}out(c, (pkCli,m1_928));
                                            {457}in(c, em2_929: bitstring);
                                            {458}let m2_930: bitstring = em2_929 in
                                            {459}let (=OpenSecureChannelResponse,PartS_931: bitstring,ST_932: bitstring,TTL_933: bitstring) = m2_930 in
                                            {460}let Kcli_934: bitstring = exp(PartS_931,Nc_926) in
                                            {461}out(c, senc(mCli(pkCli,pkSess_923),Kcli_934))
                                )
                                else
                                    {462}let pkSess_935: bitstring = fail-any in
                                    {463}out(c, GetEndpointRequest);
                                    {464}in(c, (=GetEndpointResponse,=pkSess_935,=None,SP_936: bitstring,UP_937: bitstring));
                                    {465}new Nc_938: bitstring;
                                    {466}let gNc_939: bitstring = exp(g,Nc_938) in
                                    {467}let m1_940: bitstring = (OpenSecureChannelRequest,pkCli,gNc_939) in
                                    {468}out(c, (pkCli,m1_940));
                                    {469}in(c, em2_941: bitstring);
                                    {470}let m2_942: bitstring = em2_941 in
                                    {471}let (=OpenSecureChannelResponse,PartS_943: bitstring,ST_944: bitstring,TTL_945: bitstring) = m2_942 in
                                    {472}let Kcli_946: bitstring = exp(PartS_943,Nc_938) in
                                    {473}out(c, senc(mCli(pkCli,pkSess_935),Kcli_946))
                    )
                    else
                        {474}let pkDisco_947: bitstring = fail-any in
                        {475}let v_948: bool = (Sess = A) in
                        (
                            {476}if v_948 then
                            (
                                {477}let pkSess_949: bitstring = pub(skA) in
                                {478}out(c, GetEndpointRequest);
                                {479}in(c, (=GetEndpointResponse,=pkSess_949,=None,SP_950: bitstring,UP_951: bitstring));
                                {480}new Nc_952: bitstring;
                                {481}let gNc_953: bitstring = exp(g,Nc_952) in
                                {482}let m1_954: bitstring = (OpenSecureChannelRequest,pkCli,gNc_953) in
                                {483}out(c, (pkCli,m1_954));
                                {484}in(c, em2_955: bitstring);
                                {485}let m2_956: bitstring = em2_955 in
                                {486}let (=OpenSecureChannelResponse,PartS_957: bitstring,ST_958: bitstring,TTL_959: bitstring) = m2_956 in
                                {487}let Kcli_960: bitstring = exp(PartS_957,Nc_952) in
                                {488}out(c, senc(mCli(pkCli,pkSess_949),Kcli_960))
                            )
                            else
                                {489}let v_961: bool = (Sess = B) in
                                (
                                    {490}if v_961 then
                                    (
                                        {491}let pkSess_962: bitstring = pub(skB) in
                                        {492}out(c, GetEndpointRequest);
                                        {493}in(c, (=GetEndpointResponse,=pkSess_962,=None,SP_963: bitstring,UP_964: bitstring));
                                        {494}new Nc_965: bitstring;
                                        {495}let gNc_966: bitstring = exp(g,Nc_965) in
                                        {496}let m1_967: bitstring = (OpenSecureChannelRequest,pkCli,gNc_966) in
                                        {497}out(c, (pkCli,m1_967));
                                        {498}in(c, em2_968: bitstring);
                                        {499}let m2_969: bitstring = em2_968 in
                                        {500}let (=OpenSecureChannelResponse,PartS_970: bitstring,ST_971: bitstring,TTL_972: bitstring) = m2_969 in
                                        {501}let Kcli_973: bitstring = exp(PartS_970,Nc_965) in
                                        {502}out(c, senc(mCli(pkCli,pkSess_962),Kcli_973))
                                    )
                                    else
                                        {503}let v_974: bool = (Sess = C) in
                                        (
                                            {504}if v_974 then
                                            (
                                                {505}let pkSess_975: bitstring = pub(skC) in
                                                {506}out(c, GetEndpointRequest);
                                                {507}in(c, (=GetEndpointResponse,=pkSess_975,=None,SP_976: bitstring,UP_977: bitstring));
                                                {508}new Nc_978: bitstring;
                                                {509}let gNc_979: bitstring = exp(g,Nc_978) in
                                                {510}let m1_980: bitstring = (OpenSecureChannelRequest,pkCli,gNc_979) in
                                                {511}out(c, (pkCli,m1_980));
                                                {512}in(c, em2_981: bitstring);
                                                {513}let m2_982: bitstring = em2_981 in
                                                {514}let (=OpenSecureChannelResponse,PartS_983: bitstring,ST_984: bitstring,TTL_985: bitstring) = m2_982 in
                                                {515}let Kcli_986: bitstring = exp(PartS_983,Nc_978) in
                                                {516}out(c, senc(mCli(pkCli,pkSess_975),Kcli_986))
                                            )
                                            else
                                                {517}let pkSess_987: bitstring = pub(sk(Sess)) in
                                                {518}out(c, GetEndpointRequest);
                                                {519}in(c, (=GetEndpointResponse,=pkSess_987,=None,SP_988: bitstring,UP_989: bitstring));
                                                {520}new Nc_990: bitstring;
                                                {521}let gNc_991: bitstring = exp(g,Nc_990) in
                                                {522}let m1_992: bitstring = (OpenSecureChannelRequest,pkCli,gNc_991) in
                                                {523}out(c, (pkCli,m1_992));
                                                {524}in(c, em2_993: bitstring);
                                                {525}let m2_994: bitstring = em2_993 in
                                                {526}let (=OpenSecureChannelResponse,PartS_995: bitstring,ST_996: bitstring,TTL_997: bitstring) = m2_994 in
                                                {527}let Kcli_998: bitstring = exp(PartS_995,Nc_990) in
                                                {528}out(c, senc(mCli(pkCli,pkSess_987),Kcli_998))
                                        )
                                        else
                                            {529}let pkSess_999: bitstring = fail-any in
                                            {530}out(c, GetEndpointRequest);
                                            {531}in(c, (=GetEndpointResponse,=pkSess_999,=None,SP_1000: bitstring,UP_1001: bitstring));
                                            {532}new Nc_1002: bitstring;
                                            {533}let gNc_1003: bitstring = exp(g,Nc_1002) in
                                            {534}let m1_1004: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1003) in
                                            {535}out(c, (pkCli,m1_1004));
                                            {536}in(c, em2_1005: bitstring);
                                            {537}let m2_1006: bitstring = em2_1005 in
                                            {538}let (=OpenSecureChannelResponse,PartS_1007: bitstring,ST_1008: bitstring,TTL_1009: bitstring) = m2_1006 in
                                            {539}let Kcli_1010: bitstring = exp(PartS_1007,Nc_1002) in
                                            {540}out(c, senc(mCli(pkCli,pkSess_999),Kcli_1010))
                                )
                                else
                                    {541}let pkSess_1011: bitstring = fail-any in
                                    {542}out(c, GetEndpointRequest);
                                    {543}in(c, (=GetEndpointResponse,=pkSess_1011,=None,SP_1012: bitstring,UP_1013: bitstring));
                                    {544}new Nc_1014: bitstring;
                                    {545}let gNc_1015: bitstring = exp(g,Nc_1014) in
                                    {546}let m1_1016: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1015) in
                                    {547}out(c, (pkCli,m1_1016));
                                    {548}in(c, em2_1017: bitstring);
                                    {549}let m2_1018: bitstring = em2_1017 in
                                    {550}let (=OpenSecureChannelResponse,PartS_1019: bitstring,ST_1020: bitstring,TTL_1021: bitstring) = m2_1018 in
                                    {551}let Kcli_1022: bitstring = exp(PartS_1019,Nc_1014) in
                                    {552}out(c, senc(mCli(pkCli,pkSess_1011),Kcli_1022))
                        )
                        else
                            {553}let pkSess_1023: bitstring = fail-any in
                            {554}out(c, GetEndpointRequest);
                            {555}in(c, (=GetEndpointResponse,=pkSess_1023,=None,SP_1024: bitstring,UP_1025: bitstring));
                            {556}new Nc_1026: bitstring;
                            {557}let gNc_1027: bitstring = exp(g,Nc_1026) in
                            {558}let m1_1028: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1027) in
                            {559}out(c, (pkCli,m1_1028));
                            {560}in(c, em2_1029: bitstring);
                            {561}let m2_1030: bitstring = em2_1029 in
                            {562}let (=OpenSecureChannelResponse,PartS_1031: bitstring,ST_1032: bitstring,TTL_1033: bitstring) = m2_1030 in
                            {563}let Kcli_1034: bitstring = exp(PartS_1031,Nc_1026) in
                            {564}out(c, senc(mCli(pkCli,pkSess_1023),Kcli_1034))
            )
            else
                {565}let pkDisco_1035: bitstring = fail-any in
                {566}let v_1036: bool = (Sess = A) in
                (
                    {567}if v_1036 then
                    (
                        {568}let pkSess_1037: bitstring = pub(skA) in
                        {569}out(c, GetEndpointRequest);
                        {570}in(c, (=GetEndpointResponse,=pkSess_1037,=None,SP_1038: bitstring,UP_1039: bitstring));
                        {571}new Nc_1040: bitstring;
                        {572}let gNc_1041: bitstring = exp(g,Nc_1040) in
                        {573}let m1_1042: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1041) in
                        {574}out(c, (pkCli,m1_1042));
                        {575}in(c, em2_1043: bitstring);
                        {576}let m2_1044: bitstring = em2_1043 in
                        {577}let (=OpenSecureChannelResponse,PartS_1045: bitstring,ST_1046: bitstring,TTL_1047: bitstring) = m2_1044 in
                        {578}let Kcli_1048: bitstring = exp(PartS_1045,Nc_1040) in
                        {579}out(c, senc(mCli(pkCli,pkSess_1037),Kcli_1048))
                    )
                    else
                        {580}let v_1049: bool = (Sess = B) in
                        (
                            {581}if v_1049 then
                            (
                                {582}let pkSess_1050: bitstring = pub(skB) in
                                {583}out(c, GetEndpointRequest);
                                {584}in(c, (=GetEndpointResponse,=pkSess_1050,=None,SP_1051: bitstring,UP_1052: bitstring));
                                {585}new Nc_1053: bitstring;
                                {586}let gNc_1054: bitstring = exp(g,Nc_1053) in
                                {587}let m1_1055: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1054) in
                                {588}out(c, (pkCli,m1_1055));
                                {589}in(c, em2_1056: bitstring);
                                {590}let m2_1057: bitstring = em2_1056 in
                                {591}let (=OpenSecureChannelResponse,PartS_1058: bitstring,ST_1059: bitstring,TTL_1060: bitstring) = m2_1057 in
                                {592}let Kcli_1061: bitstring = exp(PartS_1058,Nc_1053) in
                                {593}out(c, senc(mCli(pkCli,pkSess_1050),Kcli_1061))
                            )
                            else
                                {594}let v_1062: bool = (Sess = C) in
                                (
                                    {595}if v_1062 then
                                    (
                                        {596}let pkSess_1063: bitstring = pub(skC) in
                                        {597}out(c, GetEndpointRequest);
                                        {598}in(c, (=GetEndpointResponse,=pkSess_1063,=None,SP_1064: bitstring,UP_1065: bitstring));
                                        {599}new Nc_1066: bitstring;
                                        {600}let gNc_1067: bitstring = exp(g,Nc_1066) in
                                        {601}let m1_1068: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1067) in
                                        {602}out(c, (pkCli,m1_1068));
                                        {603}in(c, em2_1069: bitstring);
                                        {604}let m2_1070: bitstring = em2_1069 in
                                        {605}let (=OpenSecureChannelResponse,PartS_1071: bitstring,ST_1072: bitstring,TTL_1073: bitstring) = m2_1070 in
                                        {606}let Kcli_1074: bitstring = exp(PartS_1071,Nc_1066) in
                                        {607}out(c, senc(mCli(pkCli,pkSess_1063),Kcli_1074))
                                    )
                                    else
                                        {608}let pkSess_1075: bitstring = pub(sk(Sess)) in
                                        {609}out(c, GetEndpointRequest);
                                        {610}in(c, (=GetEndpointResponse,=pkSess_1075,=None,SP_1076: bitstring,UP_1077: bitstring));
                                        {611}new Nc_1078: bitstring;
                                        {612}let gNc_1079: bitstring = exp(g,Nc_1078) in
                                        {613}let m1_1080: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1079) in
                                        {614}out(c, (pkCli,m1_1080));
                                        {615}in(c, em2_1081: bitstring);
                                        {616}let m2_1082: bitstring = em2_1081 in
                                        {617}let (=OpenSecureChannelResponse,PartS_1083: bitstring,ST_1084: bitstring,TTL_1085: bitstring) = m2_1082 in
                                        {618}let Kcli_1086: bitstring = exp(PartS_1083,Nc_1078) in
                                        {619}out(c, senc(mCli(pkCli,pkSess_1075),Kcli_1086))
                                )
                                else
                                    {620}let pkSess_1087: bitstring = fail-any in
                                    {621}out(c, GetEndpointRequest);
                                    {622}in(c, (=GetEndpointResponse,=pkSess_1087,=None,SP_1088: bitstring,UP_1089: bitstring));
                                    {623}new Nc_1090: bitstring;
                                    {624}let gNc_1091: bitstring = exp(g,Nc_1090) in
                                    {625}let m1_1092: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1091) in
                                    {626}out(c, (pkCli,m1_1092));
                                    {627}in(c, em2_1093: bitstring);
                                    {628}let m2_1094: bitstring = em2_1093 in
                                    {629}let (=OpenSecureChannelResponse,PartS_1095: bitstring,ST_1096: bitstring,TTL_1097: bitstring) = m2_1094 in
                                    {630}let Kcli_1098: bitstring = exp(PartS_1095,Nc_1090) in
                                    {631}out(c, senc(mCli(pkCli,pkSess_1087),Kcli_1098))
                        )
                        else
                            {632}let pkSess_1099: bitstring = fail-any in
                            {633}out(c, GetEndpointRequest);
                            {634}in(c, (=GetEndpointResponse,=pkSess_1099,=None,SP_1100: bitstring,UP_1101: bitstring));
                            {635}new Nc_1102: bitstring;
                            {636}let gNc_1103: bitstring = exp(g,Nc_1102) in
                            {637}let m1_1104: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1103) in
                            {638}out(c, (pkCli,m1_1104));
                            {639}in(c, em2_1105: bitstring);
                            {640}let m2_1106: bitstring = em2_1105 in
                            {641}let (=OpenSecureChannelResponse,PartS_1107: bitstring,ST_1108: bitstring,TTL_1109: bitstring) = m2_1106 in
                            {642}let Kcli_1110: bitstring = exp(PartS_1107,Nc_1102) in
                            {643}out(c, senc(mCli(pkCli,pkSess_1099),Kcli_1110))
                )
                else
                    {644}let pkSess_1111: bitstring = fail-any in
                    {645}out(c, GetEndpointRequest);
                    {646}in(c, (=GetEndpointResponse,=pkSess_1111,=None,SP_1112: bitstring,UP_1113: bitstring));
                    {647}new Nc_1114: bitstring;
                    {648}let gNc_1115: bitstring = exp(g,Nc_1114) in
                    {649}let m1_1116: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1115) in
                    {650}out(c, (pkCli,m1_1116));
                    {651}in(c, em2_1117: bitstring);
                    {652}let m2_1118: bitstring = em2_1117 in
                    {653}let (=OpenSecureChannelResponse,PartS_1119: bitstring,ST_1120: bitstring,TTL_1121: bitstring) = m2_1118 in
                    {654}let Kcli_1122: bitstring = exp(PartS_1119,Nc_1114) in
                    {655}out(c, senc(mCli(pkCli,pkSess_1111),Kcli_1122))
        )
        else
            {656}let v_1123: bool = (Cli = B) in
            (
                {657}if v_1123 then
                (
                    {658}let skCli_1124: bitstring = skB in
                    {659}let pkCli_1125: bitstring = pub(skCli_1124) in
                    {660}let v_1126: bool = (Disco = A) in
                    (
                        {661}if v_1126 then
                        (
                            {662}let pkDisco_1127: bitstring = pub(skA) in
                            {663}let v_1128: bool = (Sess = A) in
                            (
                                {664}if v_1128 then
                                (
                                    {665}let pkSess_1129: bitstring = pub(skA) in
                                    {666}out(c, GetEndpointRequest);
                                    {667}in(c, (=GetEndpointResponse,=pkSess_1129,=None,SP_1130: bitstring,UP_1131: bitstring));
                                    {668}new Nc_1132: bitstring;
                                    {669}let gNc_1133: bitstring = exp(g,Nc_1132) in
                                    {670}let m1_1134: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1133) in
                                    {671}out(c, (pkCli_1125,m1_1134));
                                    {672}in(c, em2_1135: bitstring);
                                    {673}let m2_1136: bitstring = em2_1135 in
                                    {674}let (=OpenSecureChannelResponse,PartS_1137: bitstring,ST_1138: bitstring,TTL_1139: bitstring) = m2_1136 in
                                    {675}let Kcli_1140: bitstring = exp(PartS_1137,Nc_1132) in
                                    {676}out(c, senc(mCli(pkCli_1125,pkSess_1129),Kcli_1140))
                                )
                                else
                                    {677}let v_1141: bool = (Sess = B) in
                                    (
                                        {678}if v_1141 then
                                        (
                                            {679}let pkSess_1142: bitstring = pub(skB) in
                                            {680}out(c, GetEndpointRequest);
                                            {681}in(c, (=GetEndpointResponse,=pkSess_1142,=None,SP_1143: bitstring,UP_1144: bitstring));
                                            {682}new Nc_1145: bitstring;
                                            {683}let gNc_1146: bitstring = exp(g,Nc_1145) in
                                            {684}let m1_1147: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1146) in
                                            {685}out(c, (pkCli_1125,m1_1147));
                                            {686}in(c, em2_1148: bitstring);
                                            {687}let m2_1149: bitstring = em2_1148 in
                                            {688}let (=OpenSecureChannelResponse,PartS_1150: bitstring,ST_1151: bitstring,TTL_1152: bitstring) = m2_1149 in
                                            {689}let Kcli_1153: bitstring = exp(PartS_1150,Nc_1145) in
                                            {690}out(c, senc(mCli(pkCli_1125,pkSess_1142),Kcli_1153))
                                        )
                                        else
                                            {691}let v_1154: bool = (Sess = C) in
                                            (
                                                {692}if v_1154 then
                                                (
                                                    {693}let pkSess_1155: bitstring = pub(skC) in
                                                    {694}out(c, GetEndpointRequest);
                                                    {695}in(c, (=GetEndpointResponse,=pkSess_1155,=None,SP_1156: bitstring,UP_1157: bitstring));
                                                    {696}new Nc_1158: bitstring;
                                                    {697}let gNc_1159: bitstring = exp(g,Nc_1158) in
                                                    {698}let m1_1160: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1159) in
                                                    {699}out(c, (pkCli_1125,m1_1160));
                                                    {700}in(c, em2_1161: bitstring);
                                                    {701}let m2_1162: bitstring = em2_1161 in
                                                    {702}let (=OpenSecureChannelResponse,PartS_1163: bitstring,ST_1164: bitstring,TTL_1165: bitstring) = m2_1162 in
                                                    {703}let Kcli_1166: bitstring = exp(PartS_1163,Nc_1158) in
                                                    {704}out(c, senc(mCli(pkCli_1125,pkSess_1155),Kcli_1166))
                                                )
                                                else
                                                    {705}let pkSess_1167: bitstring = pub(sk(Sess)) in
                                                    {706}out(c, GetEndpointRequest);
                                                    {707}in(c, (=GetEndpointResponse,=pkSess_1167,=None,SP_1168: bitstring,UP_1169: bitstring));
                                                    {708}new Nc_1170: bitstring;
                                                    {709}let gNc_1171: bitstring = exp(g,Nc_1170) in
                                                    {710}let m1_1172: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1171) in
                                                    {711}out(c, (pkCli_1125,m1_1172));
                                                    {712}in(c, em2_1173: bitstring);
                                                    {713}let m2_1174: bitstring = em2_1173 in
                                                    {714}let (=OpenSecureChannelResponse,PartS_1175: bitstring,ST_1176: bitstring,TTL_1177: bitstring) = m2_1174 in
                                                    {715}let Kcli_1178: bitstring = exp(PartS_1175,Nc_1170) in
                                                    {716}out(c, senc(mCli(pkCli_1125,pkSess_1167),Kcli_1178))
                                            )
                                            else
                                                {717}let pkSess_1179: bitstring = fail-any in
                                                {718}out(c, GetEndpointRequest);
                                                {719}in(c, (=GetEndpointResponse,=pkSess_1179,=None,SP_1180: bitstring,UP_1181: bitstring));
                                                {720}new Nc_1182: bitstring;
                                                {721}let gNc_1183: bitstring = exp(g,Nc_1182) in
                                                {722}let m1_1184: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1183) in
                                                {723}out(c, (pkCli_1125,m1_1184));
                                                {724}in(c, em2_1185: bitstring);
                                                {725}let m2_1186: bitstring = em2_1185 in
                                                {726}let (=OpenSecureChannelResponse,PartS_1187: bitstring,ST_1188: bitstring,TTL_1189: bitstring) = m2_1186 in
                                                {727}let Kcli_1190: bitstring = exp(PartS_1187,Nc_1182) in
                                                {728}out(c, senc(mCli(pkCli_1125,pkSess_1179),Kcli_1190))
                                    )
                                    else
                                        {729}let pkSess_1191: bitstring = fail-any in
                                        {730}out(c, GetEndpointRequest);
                                        {731}in(c, (=GetEndpointResponse,=pkSess_1191,=None,SP_1192: bitstring,UP_1193: bitstring));
                                        {732}new Nc_1194: bitstring;
                                        {733}let gNc_1195: bitstring = exp(g,Nc_1194) in
                                        {734}let m1_1196: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1195) in
                                        {735}out(c, (pkCli_1125,m1_1196));
                                        {736}in(c, em2_1197: bitstring);
                                        {737}let m2_1198: bitstring = em2_1197 in
                                        {738}let (=OpenSecureChannelResponse,PartS_1199: bitstring,ST_1200: bitstring,TTL_1201: bitstring) = m2_1198 in
                                        {739}let Kcli_1202: bitstring = exp(PartS_1199,Nc_1194) in
                                        {740}out(c, senc(mCli(pkCli_1125,pkSess_1191),Kcli_1202))
                            )
                            else
                                {741}let pkSess_1203: bitstring = fail-any in
                                {742}out(c, GetEndpointRequest);
                                {743}in(c, (=GetEndpointResponse,=pkSess_1203,=None,SP_1204: bitstring,UP_1205: bitstring));
                                {744}new Nc_1206: bitstring;
                                {745}let gNc_1207: bitstring = exp(g,Nc_1206) in
                                {746}let m1_1208: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1207) in
                                {747}out(c, (pkCli_1125,m1_1208));
                                {748}in(c, em2_1209: bitstring);
                                {749}let m2_1210: bitstring = em2_1209 in
                                {750}let (=OpenSecureChannelResponse,PartS_1211: bitstring,ST_1212: bitstring,TTL_1213: bitstring) = m2_1210 in
                                {751}let Kcli_1214: bitstring = exp(PartS_1211,Nc_1206) in
                                {752}out(c, senc(mCli(pkCli_1125,pkSess_1203),Kcli_1214))
                        )
                        else
                            {753}let v_1215: bool = (Disco = B) in
                            (
                                {754}if v_1215 then
                                (
                                    {755}let pkDisco_1216: bitstring = pub(skB) in
                                    {756}let v_1217: bool = (Sess = A) in
                                    (
                                        {757}if v_1217 then
                                        (
                                            {758}let pkSess_1218: bitstring = pub(skA) in
                                            {759}out(c, GetEndpointRequest);
                                            {760}in(c, (=GetEndpointResponse,=pkSess_1218,=None,SP_1219: bitstring,UP_1220: bitstring));
                                            {761}new Nc_1221: bitstring;
                                            {762}let gNc_1222: bitstring = exp(g,Nc_1221) in
                                            {763}let m1_1223: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1222) in
                                            {764}out(c, (pkCli_1125,m1_1223));
                                            {765}in(c, em2_1224: bitstring);
                                            {766}let m2_1225: bitstring = em2_1224 in
                                            {767}let (=OpenSecureChannelResponse,PartS_1226: bitstring,ST_1227: bitstring,TTL_1228: bitstring) = m2_1225 in
                                            {768}let Kcli_1229: bitstring = exp(PartS_1226,Nc_1221) in
                                            {769}out(c, senc(mCli(pkCli_1125,pkSess_1218),Kcli_1229))
                                        )
                                        else
                                            {770}let v_1230: bool = (Sess = B) in
                                            (
                                                {771}if v_1230 then
                                                (
                                                    {772}let pkSess_1231: bitstring = pub(skB) in
                                                    {773}out(c, GetEndpointRequest);
                                                    {774}in(c, (=GetEndpointResponse,=pkSess_1231,=None,SP_1232: bitstring,UP_1233: bitstring));
                                                    {775}new Nc_1234: bitstring;
                                                    {776}let gNc_1235: bitstring = exp(g,Nc_1234) in
                                                    {777}let m1_1236: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1235) in
                                                    {778}out(c, (pkCli_1125,m1_1236));
                                                    {779}in(c, em2_1237: bitstring);
                                                    {780}let m2_1238: bitstring = em2_1237 in
                                                    {781}let (=OpenSecureChannelResponse,PartS_1239: bitstring,ST_1240: bitstring,TTL_1241: bitstring) = m2_1238 in
                                                    {782}let Kcli_1242: bitstring = exp(PartS_1239,Nc_1234) in
                                                    {783}out(c, senc(mCli(pkCli_1125,pkSess_1231),Kcli_1242))
                                                )
                                                else
                                                    {784}let v_1243: bool = (Sess = C) in
                                                    (
                                                        {785}if v_1243 then
                                                        (
                                                            {786}let pkSess_1244: bitstring = pub(skC) in
                                                            {787}out(c, GetEndpointRequest);
                                                            {788}in(c, (=GetEndpointResponse,=pkSess_1244,=None,SP_1245: bitstring,UP_1246: bitstring));
                                                            {789}new Nc_1247: bitstring;
                                                            {790}let gNc_1248: bitstring = exp(g,Nc_1247) in
                                                            {791}let m1_1249: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1248) in
                                                            {792}out(c, (pkCli_1125,m1_1249));
                                                            {793}in(c, em2_1250: bitstring);
                                                            {794}let m2_1251: bitstring = em2_1250 in
                                                            {795}let (=OpenSecureChannelResponse,PartS_1252: bitstring,ST_1253: bitstring,TTL_1254: bitstring) = m2_1251 in
                                                            {796}let Kcli_1255: bitstring = exp(PartS_1252,Nc_1247) in
                                                            {797}out(c, senc(mCli(pkCli_1125,pkSess_1244),Kcli_1255))
                                                        )
                                                        else
                                                            {798}let pkSess_1256: bitstring = pub(sk(Sess)) in
                                                            {799}out(c, GetEndpointRequest);
                                                            {800}in(c, (=GetEndpointResponse,=pkSess_1256,=None,SP_1257: bitstring,UP_1258: bitstring));
                                                            {801}new Nc_1259: bitstring;
                                                            {802}let gNc_1260: bitstring = exp(g,Nc_1259) in
                                                            {803}let m1_1261: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1260) in
                                                            {804}out(c, (pkCli_1125,m1_1261));
                                                            {805}in(c, em2_1262: bitstring);
                                                            {806}let m2_1263: bitstring = em2_1262 in
                                                            {807}let (=OpenSecureChannelResponse,PartS_1264: bitstring,ST_1265: bitstring,TTL_1266: bitstring) = m2_1263 in
                                                            {808}let Kcli_1267: bitstring = exp(PartS_1264,Nc_1259) in
                                                            {809}out(c, senc(mCli(pkCli_1125,pkSess_1256),Kcli_1267))
                                                    )
                                                    else
                                                        {810}let pkSess_1268: bitstring = fail-any in
                                                        {811}out(c, GetEndpointRequest);
                                                        {812}in(c, (=GetEndpointResponse,=pkSess_1268,=None,SP_1269: bitstring,UP_1270: bitstring));
                                                        {813}new Nc_1271: bitstring;
                                                        {814}let gNc_1272: bitstring = exp(g,Nc_1271) in
                                                        {815}let m1_1273: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1272) in
                                                        {816}out(c, (pkCli_1125,m1_1273));
                                                        {817}in(c, em2_1274: bitstring);
                                                        {818}let m2_1275: bitstring = em2_1274 in
                                                        {819}let (=OpenSecureChannelResponse,PartS_1276: bitstring,ST_1277: bitstring,TTL_1278: bitstring) = m2_1275 in
                                                        {820}let Kcli_1279: bitstring = exp(PartS_1276,Nc_1271) in
                                                        {821}out(c, senc(mCli(pkCli_1125,pkSess_1268),Kcli_1279))
                                            )
                                            else
                                                {822}let pkSess_1280: bitstring = fail-any in
                                                {823}out(c, GetEndpointRequest);
                                                {824}in(c, (=GetEndpointResponse,=pkSess_1280,=None,SP_1281: bitstring,UP_1282: bitstring));
                                                {825}new Nc_1283: bitstring;
                                                {826}let gNc_1284: bitstring = exp(g,Nc_1283) in
                                                {827}let m1_1285: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1284) in
                                                {828}out(c, (pkCli_1125,m1_1285));
                                                {829}in(c, em2_1286: bitstring);
                                                {830}let m2_1287: bitstring = em2_1286 in
                                                {831}let (=OpenSecureChannelResponse,PartS_1288: bitstring,ST_1289: bitstring,TTL_1290: bitstring) = m2_1287 in
                                                {832}let Kcli_1291: bitstring = exp(PartS_1288,Nc_1283) in
                                                {833}out(c, senc(mCli(pkCli_1125,pkSess_1280),Kcli_1291))
                                    )
                                    else
                                        {834}let pkSess_1292: bitstring = fail-any in
                                        {835}out(c, GetEndpointRequest);
                                        {836}in(c, (=GetEndpointResponse,=pkSess_1292,=None,SP_1293: bitstring,UP_1294: bitstring));
                                        {837}new Nc_1295: bitstring;
                                        {838}let gNc_1296: bitstring = exp(g,Nc_1295) in
                                        {839}let m1_1297: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1296) in
                                        {840}out(c, (pkCli_1125,m1_1297));
                                        {841}in(c, em2_1298: bitstring);
                                        {842}let m2_1299: bitstring = em2_1298 in
                                        {843}let (=OpenSecureChannelResponse,PartS_1300: bitstring,ST_1301: bitstring,TTL_1302: bitstring) = m2_1299 in
                                        {844}let Kcli_1303: bitstring = exp(PartS_1300,Nc_1295) in
                                        {845}out(c, senc(mCli(pkCli_1125,pkSess_1292),Kcli_1303))
                                )
                                else
                                    {846}let v_1304: bool = (Disco = C) in
                                    (
                                        {847}if v_1304 then
                                        (
                                            {848}let pkDisco_1305: bitstring = pub(skC) in
                                            {849}let v_1306: bool = (Sess = A) in
                                            (
                                                {850}if v_1306 then
                                                (
                                                    {851}let pkSess_1307: bitstring = pub(skA) in
                                                    {852}out(c, GetEndpointRequest);
                                                    {853}in(c, (=GetEndpointResponse,=pkSess_1307,=None,SP_1308: bitstring,UP_1309: bitstring));
                                                    {854}new Nc_1310: bitstring;
                                                    {855}let gNc_1311: bitstring = exp(g,Nc_1310) in
                                                    {856}let m1_1312: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1311) in
                                                    {857}out(c, (pkCli_1125,m1_1312));
                                                    {858}in(c, em2_1313: bitstring);
                                                    {859}let m2_1314: bitstring = em2_1313 in
                                                    {860}let (=OpenSecureChannelResponse,PartS_1315: bitstring,ST_1316: bitstring,TTL_1317: bitstring) = m2_1314 in
                                                    {861}let Kcli_1318: bitstring = exp(PartS_1315,Nc_1310) in
                                                    {862}out(c, senc(mCli(pkCli_1125,pkSess_1307),Kcli_1318))
                                                )
                                                else
                                                    {863}let v_1319: bool = (Sess = B) in
                                                    (
                                                        {864}if v_1319 then
                                                        (
                                                            {865}let pkSess_1320: bitstring = pub(skB) in
                                                            {866}out(c, GetEndpointRequest);
                                                            {867}in(c, (=GetEndpointResponse,=pkSess_1320,=None,SP_1321: bitstring,UP_1322: bitstring));
                                                            {868}new Nc_1323: bitstring;
                                                            {869}let gNc_1324: bitstring = exp(g,Nc_1323) in
                                                            {870}let m1_1325: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1324) in
                                                            {871}out(c, (pkCli_1125,m1_1325));
                                                            {872}in(c, em2_1326: bitstring);
                                                            {873}let m2_1327: bitstring = em2_1326 in
                                                            {874}let (=OpenSecureChannelResponse,PartS_1328: bitstring,ST_1329: bitstring,TTL_1330: bitstring) = m2_1327 in
                                                            {875}let Kcli_1331: bitstring = exp(PartS_1328,Nc_1323) in
                                                            {876}out(c, senc(mCli(pkCli_1125,pkSess_1320),Kcli_1331))
                                                        )
                                                        else
                                                            {877}let v_1332: bool = (Sess = C) in
                                                            (
                                                                {878}if v_1332 then
                                                                (
                                                                    {879}let pkSess_1333: bitstring = pub(skC) in
                                                                    {880}out(c, GetEndpointRequest);
                                                                    {881}in(c, (=GetEndpointResponse,=pkSess_1333,=None,SP_1334: bitstring,UP_1335: bitstring));
                                                                    {882}new Nc_1336: bitstring;
                                                                    {883}let gNc_1337: bitstring = exp(g,Nc_1336) in
                                                                    {884}let m1_1338: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1337) in
                                                                    {885}out(c, (pkCli_1125,m1_1338));
                                                                    {886}in(c, em2_1339: bitstring);
                                                                    {887}let m2_1340: bitstring = em2_1339 in
                                                                    {888}let (=OpenSecureChannelResponse,PartS_1341: bitstring,ST_1342: bitstring,TTL_1343: bitstring) = m2_1340 in
                                                                    {889}let Kcli_1344: bitstring = exp(PartS_1341,Nc_1336) in
                                                                    {890}out(c, senc(mCli(pkCli_1125,pkSess_1333),Kcli_1344))
                                                                )
                                                                else
                                                                    {891}let pkSess_1345: bitstring = pub(sk(Sess)) in
                                                                    {892}out(c, GetEndpointRequest);
                                                                    {893}in(c, (=GetEndpointResponse,=pkSess_1345,=None,SP_1346: bitstring,UP_1347: bitstring));
                                                                    {894}new Nc_1348: bitstring;
                                                                    {895}let gNc_1349: bitstring = exp(g,Nc_1348) in
                                                                    {896}let m1_1350: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1349) in
                                                                    {897}out(c, (pkCli_1125,m1_1350));
                                                                    {898}in(c, em2_1351: bitstring);
                                                                    {899}let m2_1352: bitstring = em2_1351 in
                                                                    {900}let (=OpenSecureChannelResponse,PartS_1353: bitstring,ST_1354: bitstring,TTL_1355: bitstring) = m2_1352 in
                                                                    {901}let Kcli_1356: bitstring = exp(PartS_1353,Nc_1348) in
                                                                    {902}out(c, senc(mCli(pkCli_1125,pkSess_1345),Kcli_1356))
                                                            )
                                                            else
                                                                {903}let pkSess_1357: bitstring = fail-any in
                                                                {904}out(c, GetEndpointRequest);
                                                                {905}in(c, (=GetEndpointResponse,=pkSess_1357,=None,SP_1358: bitstring,UP_1359: bitstring));
                                                                {906}new Nc_1360: bitstring;
                                                                {907}let gNc_1361: bitstring = exp(g,Nc_1360) in
                                                                {908}let m1_1362: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1361) in
                                                                {909}out(c, (pkCli_1125,m1_1362));
                                                                {910}in(c, em2_1363: bitstring);
                                                                {911}let m2_1364: bitstring = em2_1363 in
                                                                {912}let (=OpenSecureChannelResponse,PartS_1365: bitstring,ST_1366: bitstring,TTL_1367: bitstring) = m2_1364 in
                                                                {913}let Kcli_1368: bitstring = exp(PartS_1365,Nc_1360) in
                                                                {914}out(c, senc(mCli(pkCli_1125,pkSess_1357),Kcli_1368))
                                                    )
                                                    else
                                                        {915}let pkSess_1369: bitstring = fail-any in
                                                        {916}out(c, GetEndpointRequest);
                                                        {917}in(c, (=GetEndpointResponse,=pkSess_1369,=None,SP_1370: bitstring,UP_1371: bitstring));
                                                        {918}new Nc_1372: bitstring;
                                                        {919}let gNc_1373: bitstring = exp(g,Nc_1372) in
                                                        {920}let m1_1374: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1373) in
                                                        {921}out(c, (pkCli_1125,m1_1374));
                                                        {922}in(c, em2_1375: bitstring);
                                                        {923}let m2_1376: bitstring = em2_1375 in
                                                        {924}let (=OpenSecureChannelResponse,PartS_1377: bitstring,ST_1378: bitstring,TTL_1379: bitstring) = m2_1376 in
                                                        {925}let Kcli_1380: bitstring = exp(PartS_1377,Nc_1372) in
                                                        {926}out(c, senc(mCli(pkCli_1125,pkSess_1369),Kcli_1380))
                                            )
                                            else
                                                {927}let pkSess_1381: bitstring = fail-any in
                                                {928}out(c, GetEndpointRequest);
                                                {929}in(c, (=GetEndpointResponse,=pkSess_1381,=None,SP_1382: bitstring,UP_1383: bitstring));
                                                {930}new Nc_1384: bitstring;
                                                {931}let gNc_1385: bitstring = exp(g,Nc_1384) in
                                                {932}let m1_1386: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1385) in
                                                {933}out(c, (pkCli_1125,m1_1386));
                                                {934}in(c, em2_1387: bitstring);
                                                {935}let m2_1388: bitstring = em2_1387 in
                                                {936}let (=OpenSecureChannelResponse,PartS_1389: bitstring,ST_1390: bitstring,TTL_1391: bitstring) = m2_1388 in
                                                {937}let Kcli_1392: bitstring = exp(PartS_1389,Nc_1384) in
                                                {938}out(c, senc(mCli(pkCli_1125,pkSess_1381),Kcli_1392))
                                        )
                                        else
                                            {939}let pkDisco_1393: bitstring = pub(sk(Disco)) in
                                            {940}let v_1394: bool = (Sess = A) in
                                            (
                                                {941}if v_1394 then
                                                (
                                                    {942}let pkSess_1395: bitstring = pub(skA) in
                                                    {943}out(c, GetEndpointRequest);
                                                    {944}in(c, (=GetEndpointResponse,=pkSess_1395,=None,SP_1396: bitstring,UP_1397: bitstring));
                                                    {945}new Nc_1398: bitstring;
                                                    {946}let gNc_1399: bitstring = exp(g,Nc_1398) in
                                                    {947}let m1_1400: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1399) in
                                                    {948}out(c, (pkCli_1125,m1_1400));
                                                    {949}in(c, em2_1401: bitstring);
                                                    {950}let m2_1402: bitstring = em2_1401 in
                                                    {951}let (=OpenSecureChannelResponse,PartS_1403: bitstring,ST_1404: bitstring,TTL_1405: bitstring) = m2_1402 in
                                                    {952}let Kcli_1406: bitstring = exp(PartS_1403,Nc_1398) in
                                                    {953}out(c, senc(mCli(pkCli_1125,pkSess_1395),Kcli_1406))
                                                )
                                                else
                                                    {954}let v_1407: bool = (Sess = B) in
                                                    (
                                                        {955}if v_1407 then
                                                        (
                                                            {956}let pkSess_1408: bitstring = pub(skB) in
                                                            {957}out(c, GetEndpointRequest);
                                                            {958}in(c, (=GetEndpointResponse,=pkSess_1408,=None,SP_1409: bitstring,UP_1410: bitstring));
                                                            {959}new Nc_1411: bitstring;
                                                            {960}let gNc_1412: bitstring = exp(g,Nc_1411) in
                                                            {961}let m1_1413: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1412) in
                                                            {962}out(c, (pkCli_1125,m1_1413));
                                                            {963}in(c, em2_1414: bitstring);
                                                            {964}let m2_1415: bitstring = em2_1414 in
                                                            {965}let (=OpenSecureChannelResponse,PartS_1416: bitstring,ST_1417: bitstring,TTL_1418: bitstring) = m2_1415 in
                                                            {966}let Kcli_1419: bitstring = exp(PartS_1416,Nc_1411) in
                                                            {967}out(c, senc(mCli(pkCli_1125,pkSess_1408),Kcli_1419))
                                                        )
                                                        else
                                                            {968}let v_1420: bool = (Sess = C) in
                                                            (
                                                                {969}if v_1420 then
                                                                (
                                                                    {970}let pkSess_1421: bitstring = pub(skC) in
                                                                    {971}out(c, GetEndpointRequest);
                                                                    {972}in(c, (=GetEndpointResponse,=pkSess_1421,=None,SP_1422: bitstring,UP_1423: bitstring));
                                                                    {973}new Nc_1424: bitstring;
                                                                    {974}let gNc_1425: bitstring = exp(g,Nc_1424) in
                                                                    {975}let m1_1426: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1425) in
                                                                    {976}out(c, (pkCli_1125,m1_1426));
                                                                    {977}in(c, em2_1427: bitstring);
                                                                    {978}let m2_1428: bitstring = em2_1427 in
                                                                    {979}let (=OpenSecureChannelResponse,PartS_1429: bitstring,ST_1430: bitstring,TTL_1431: bitstring) = m2_1428 in
                                                                    {980}let Kcli_1432: bitstring = exp(PartS_1429,Nc_1424) in
                                                                    {981}out(c, senc(mCli(pkCli_1125,pkSess_1421),Kcli_1432))
                                                                )
                                                                else
                                                                    {982}let pkSess_1433: bitstring = pub(sk(Sess)) in
                                                                    {983}out(c, GetEndpointRequest);
                                                                    {984}in(c, (=GetEndpointResponse,=pkSess_1433,=None,SP_1434: bitstring,UP_1435: bitstring));
                                                                    {985}new Nc_1436: bitstring;
                                                                    {986}let gNc_1437: bitstring = exp(g,Nc_1436) in
                                                                    {987}let m1_1438: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1437) in
                                                                    {988}out(c, (pkCli_1125,m1_1438));
                                                                    {989}in(c, em2_1439: bitstring);
                                                                    {990}let m2_1440: bitstring = em2_1439 in
                                                                    {991}let (=OpenSecureChannelResponse,PartS_1441: bitstring,ST_1442: bitstring,TTL_1443: bitstring) = m2_1440 in
                                                                    {992}let Kcli_1444: bitstring = exp(PartS_1441,Nc_1436) in
                                                                    {993}out(c, senc(mCli(pkCli_1125,pkSess_1433),Kcli_1444))
                                                            )
                                                            else
                                                                {994}let pkSess_1445: bitstring = fail-any in
                                                                {995}out(c, GetEndpointRequest);
                                                                {996}in(c, (=GetEndpointResponse,=pkSess_1445,=None,SP_1446: bitstring,UP_1447: bitstring));
                                                                {997}new Nc_1448: bitstring;
                                                                {998}let gNc_1449: bitstring = exp(g,Nc_1448) in
                                                                {999}let m1_1450: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1449) in
                                                                {1000}out(c, (pkCli_1125,m1_1450));
                                                                {1001}in(c, em2_1451: bitstring);
                                                                {1002}let m2_1452: bitstring = em2_1451 in
                                                                {1003}let (=OpenSecureChannelResponse,PartS_1453: bitstring,ST_1454: bitstring,TTL_1455: bitstring) = m2_1452 in
                                                                {1004}let Kcli_1456: bitstring = exp(PartS_1453,Nc_1448) in
                                                                {1005}out(c, senc(mCli(pkCli_1125,pkSess_1445),Kcli_1456))
                                                    )
                                                    else
                                                        {1006}let pkSess_1457: bitstring = fail-any in
                                                        {1007}out(c, GetEndpointRequest);
                                                        {1008}in(c, (=GetEndpointResponse,=pkSess_1457,=None,SP_1458: bitstring,UP_1459: bitstring));
                                                        {1009}new Nc_1460: bitstring;
                                                        {1010}let gNc_1461: bitstring = exp(g,Nc_1460) in
                                                        {1011}let m1_1462: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1461) in
                                                        {1012}out(c, (pkCli_1125,m1_1462));
                                                        {1013}in(c, em2_1463: bitstring);
                                                        {1014}let m2_1464: bitstring = em2_1463 in
                                                        {1015}let (=OpenSecureChannelResponse,PartS_1465: bitstring,ST_1466: bitstring,TTL_1467: bitstring) = m2_1464 in
                                                        {1016}let Kcli_1468: bitstring = exp(PartS_1465,Nc_1460) in
                                                        {1017}out(c, senc(mCli(pkCli_1125,pkSess_1457),Kcli_1468))
                                            )
                                            else
                                                {1018}let pkSess_1469: bitstring = fail-any in
                                                {1019}out(c, GetEndpointRequest);
                                                {1020}in(c, (=GetEndpointResponse,=pkSess_1469,=None,SP_1470: bitstring,UP_1471: bitstring));
                                                {1021}new Nc_1472: bitstring;
                                                {1022}let gNc_1473: bitstring = exp(g,Nc_1472) in
                                                {1023}let m1_1474: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1473) in
                                                {1024}out(c, (pkCli_1125,m1_1474));
                                                {1025}in(c, em2_1475: bitstring);
                                                {1026}let m2_1476: bitstring = em2_1475 in
                                                {1027}let (=OpenSecureChannelResponse,PartS_1477: bitstring,ST_1478: bitstring,TTL_1479: bitstring) = m2_1476 in
                                                {1028}let Kcli_1480: bitstring = exp(PartS_1477,Nc_1472) in
                                                {1029}out(c, senc(mCli(pkCli_1125,pkSess_1469),Kcli_1480))
                                    )
                                    else
                                        {1030}let pkDisco_1481: bitstring = fail-any in
                                        {1031}let v_1482: bool = (Sess = A) in
                                        (
                                            {1032}if v_1482 then
                                            (
                                                {1033}let pkSess_1483: bitstring = pub(skA) in
                                                {1034}out(c, GetEndpointRequest);
                                                {1035}in(c, (=GetEndpointResponse,=pkSess_1483,=None,SP_1484: bitstring,UP_1485: bitstring));
                                                {1036}new Nc_1486: bitstring;
                                                {1037}let gNc_1487: bitstring = exp(g,Nc_1486) in
                                                {1038}let m1_1488: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1487) in
                                                {1039}out(c, (pkCli_1125,m1_1488));
                                                {1040}in(c, em2_1489: bitstring);
                                                {1041}let m2_1490: bitstring = em2_1489 in
                                                {1042}let (=OpenSecureChannelResponse,PartS_1491: bitstring,ST_1492: bitstring,TTL_1493: bitstring) = m2_1490 in
                                                {1043}let Kcli_1494: bitstring = exp(PartS_1491,Nc_1486) in
                                                {1044}out(c, senc(mCli(pkCli_1125,pkSess_1483),Kcli_1494))
                                            )
                                            else
                                                {1045}let v_1495: bool = (Sess = B) in
                                                (
                                                    {1046}if v_1495 then
                                                    (
                                                        {1047}let pkSess_1496: bitstring = pub(skB) in
                                                        {1048}out(c, GetEndpointRequest);
                                                        {1049}in(c, (=GetEndpointResponse,=pkSess_1496,=None,SP_1497: bitstring,UP_1498: bitstring));
                                                        {1050}new Nc_1499: bitstring;
                                                        {1051}let gNc_1500: bitstring = exp(g,Nc_1499) in
                                                        {1052}let m1_1501: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1500) in
                                                        {1053}out(c, (pkCli_1125,m1_1501));
                                                        {1054}in(c, em2_1502: bitstring);
                                                        {1055}let m2_1503: bitstring = em2_1502 in
                                                        {1056}let (=OpenSecureChannelResponse,PartS_1504: bitstring,ST_1505: bitstring,TTL_1506: bitstring) = m2_1503 in
                                                        {1057}let Kcli_1507: bitstring = exp(PartS_1504,Nc_1499) in
                                                        {1058}out(c, senc(mCli(pkCli_1125,pkSess_1496),Kcli_1507))
                                                    )
                                                    else
                                                        {1059}let v_1508: bool = (Sess = C) in
                                                        (
                                                            {1060}if v_1508 then
                                                            (
                                                                {1061}let pkSess_1509: bitstring = pub(skC) in
                                                                {1062}out(c, GetEndpointRequest);
                                                                {1063}in(c, (=GetEndpointResponse,=pkSess_1509,=None,SP_1510: bitstring,UP_1511: bitstring));
                                                                {1064}new Nc_1512: bitstring;
                                                                {1065}let gNc_1513: bitstring = exp(g,Nc_1512) in
                                                                {1066}let m1_1514: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1513) in
                                                                {1067}out(c, (pkCli_1125,m1_1514));
                                                                {1068}in(c, em2_1515: bitstring);
                                                                {1069}let m2_1516: bitstring = em2_1515 in
                                                                {1070}let (=OpenSecureChannelResponse,PartS_1517: bitstring,ST_1518: bitstring,TTL_1519: bitstring) = m2_1516 in
                                                                {1071}let Kcli_1520: bitstring = exp(PartS_1517,Nc_1512) in
                                                                {1072}out(c, senc(mCli(pkCli_1125,pkSess_1509),Kcli_1520))
                                                            )
                                                            else
                                                                {1073}let pkSess_1521: bitstring = pub(sk(Sess)) in
                                                                {1074}out(c, GetEndpointRequest);
                                                                {1075}in(c, (=GetEndpointResponse,=pkSess_1521,=None,SP_1522: bitstring,UP_1523: bitstring));
                                                                {1076}new Nc_1524: bitstring;
                                                                {1077}let gNc_1525: bitstring = exp(g,Nc_1524) in
                                                                {1078}let m1_1526: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1525) in
                                                                {1079}out(c, (pkCli_1125,m1_1526));
                                                                {1080}in(c, em2_1527: bitstring);
                                                                {1081}let m2_1528: bitstring = em2_1527 in
                                                                {1082}let (=OpenSecureChannelResponse,PartS_1529: bitstring,ST_1530: bitstring,TTL_1531: bitstring) = m2_1528 in
                                                                {1083}let Kcli_1532: bitstring = exp(PartS_1529,Nc_1524) in
                                                                {1084}out(c, senc(mCli(pkCli_1125,pkSess_1521),Kcli_1532))
                                                        )
                                                        else
                                                            {1085}let pkSess_1533: bitstring = fail-any in
                                                            {1086}out(c, GetEndpointRequest);
                                                            {1087}in(c, (=GetEndpointResponse,=pkSess_1533,=None,SP_1534: bitstring,UP_1535: bitstring));
                                                            {1088}new Nc_1536: bitstring;
                                                            {1089}let gNc_1537: bitstring = exp(g,Nc_1536) in
                                                            {1090}let m1_1538: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1537) in
                                                            {1091}out(c, (pkCli_1125,m1_1538));
                                                            {1092}in(c, em2_1539: bitstring);
                                                            {1093}let m2_1540: bitstring = em2_1539 in
                                                            {1094}let (=OpenSecureChannelResponse,PartS_1541: bitstring,ST_1542: bitstring,TTL_1543: bitstring) = m2_1540 in
                                                            {1095}let Kcli_1544: bitstring = exp(PartS_1541,Nc_1536) in
                                                            {1096}out(c, senc(mCli(pkCli_1125,pkSess_1533),Kcli_1544))
                                                )
                                                else
                                                    {1097}let pkSess_1545: bitstring = fail-any in
                                                    {1098}out(c, GetEndpointRequest);
                                                    {1099}in(c, (=GetEndpointResponse,=pkSess_1545,=None,SP_1546: bitstring,UP_1547: bitstring));
                                                    {1100}new Nc_1548: bitstring;
                                                    {1101}let gNc_1549: bitstring = exp(g,Nc_1548) in
                                                    {1102}let m1_1550: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1549) in
                                                    {1103}out(c, (pkCli_1125,m1_1550));
                                                    {1104}in(c, em2_1551: bitstring);
                                                    {1105}let m2_1552: bitstring = em2_1551 in
                                                    {1106}let (=OpenSecureChannelResponse,PartS_1553: bitstring,ST_1554: bitstring,TTL_1555: bitstring) = m2_1552 in
                                                    {1107}let Kcli_1556: bitstring = exp(PartS_1553,Nc_1548) in
                                                    {1108}out(c, senc(mCli(pkCli_1125,pkSess_1545),Kcli_1556))
                                        )
                                        else
                                            {1109}let pkSess_1557: bitstring = fail-any in
                                            {1110}out(c, GetEndpointRequest);
                                            {1111}in(c, (=GetEndpointResponse,=pkSess_1557,=None,SP_1558: bitstring,UP_1559: bitstring));
                                            {1112}new Nc_1560: bitstring;
                                            {1113}let gNc_1561: bitstring = exp(g,Nc_1560) in
                                            {1114}let m1_1562: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1561) in
                                            {1115}out(c, (pkCli_1125,m1_1562));
                                            {1116}in(c, em2_1563: bitstring);
                                            {1117}let m2_1564: bitstring = em2_1563 in
                                            {1118}let (=OpenSecureChannelResponse,PartS_1565: bitstring,ST_1566: bitstring,TTL_1567: bitstring) = m2_1564 in
                                            {1119}let Kcli_1568: bitstring = exp(PartS_1565,Nc_1560) in
                                            {1120}out(c, senc(mCli(pkCli_1125,pkSess_1557),Kcli_1568))
                            )
                            else
                                {1121}let pkDisco_1569: bitstring = fail-any in
                                {1122}let v_1570: bool = (Sess = A) in
                                (
                                    {1123}if v_1570 then
                                    (
                                        {1124}let pkSess_1571: bitstring = pub(skA) in
                                        {1125}out(c, GetEndpointRequest);
                                        {1126}in(c, (=GetEndpointResponse,=pkSess_1571,=None,SP_1572: bitstring,UP_1573: bitstring));
                                        {1127}new Nc_1574: bitstring;
                                        {1128}let gNc_1575: bitstring = exp(g,Nc_1574) in
                                        {1129}let m1_1576: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1575) in
                                        {1130}out(c, (pkCli_1125,m1_1576));
                                        {1131}in(c, em2_1577: bitstring);
                                        {1132}let m2_1578: bitstring = em2_1577 in
                                        {1133}let (=OpenSecureChannelResponse,PartS_1579: bitstring,ST_1580: bitstring,TTL_1581: bitstring) = m2_1578 in
                                        {1134}let Kcli_1582: bitstring = exp(PartS_1579,Nc_1574) in
                                        {1135}out(c, senc(mCli(pkCli_1125,pkSess_1571),Kcli_1582))
                                    )
                                    else
                                        {1136}let v_1583: bool = (Sess = B) in
                                        (
                                            {1137}if v_1583 then
                                            (
                                                {1138}let pkSess_1584: bitstring = pub(skB) in
                                                {1139}out(c, GetEndpointRequest);
                                                {1140}in(c, (=GetEndpointResponse,=pkSess_1584,=None,SP_1585: bitstring,UP_1586: bitstring));
                                                {1141}new Nc_1587: bitstring;
                                                {1142}let gNc_1588: bitstring = exp(g,Nc_1587) in
                                                {1143}let m1_1589: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1588) in
                                                {1144}out(c, (pkCli_1125,m1_1589));
                                                {1145}in(c, em2_1590: bitstring);
                                                {1146}let m2_1591: bitstring = em2_1590 in
                                                {1147}let (=OpenSecureChannelResponse,PartS_1592: bitstring,ST_1593: bitstring,TTL_1594: bitstring) = m2_1591 in
                                                {1148}let Kcli_1595: bitstring = exp(PartS_1592,Nc_1587) in
                                                {1149}out(c, senc(mCli(pkCli_1125,pkSess_1584),Kcli_1595))
                                            )
                                            else
                                                {1150}let v_1596: bool = (Sess = C) in
                                                (
                                                    {1151}if v_1596 then
                                                    (
                                                        {1152}let pkSess_1597: bitstring = pub(skC) in
                                                        {1153}out(c, GetEndpointRequest);
                                                        {1154}in(c, (=GetEndpointResponse,=pkSess_1597,=None,SP_1598: bitstring,UP_1599: bitstring));
                                                        {1155}new Nc_1600: bitstring;
                                                        {1156}let gNc_1601: bitstring = exp(g,Nc_1600) in
                                                        {1157}let m1_1602: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1601) in
                                                        {1158}out(c, (pkCli_1125,m1_1602));
                                                        {1159}in(c, em2_1603: bitstring);
                                                        {1160}let m2_1604: bitstring = em2_1603 in
                                                        {1161}let (=OpenSecureChannelResponse,PartS_1605: bitstring,ST_1606: bitstring,TTL_1607: bitstring) = m2_1604 in
                                                        {1162}let Kcli_1608: bitstring = exp(PartS_1605,Nc_1600) in
                                                        {1163}out(c, senc(mCli(pkCli_1125,pkSess_1597),Kcli_1608))
                                                    )
                                                    else
                                                        {1164}let pkSess_1609: bitstring = pub(sk(Sess)) in
                                                        {1165}out(c, GetEndpointRequest);
                                                        {1166}in(c, (=GetEndpointResponse,=pkSess_1609,=None,SP_1610: bitstring,UP_1611: bitstring));
                                                        {1167}new Nc_1612: bitstring;
                                                        {1168}let gNc_1613: bitstring = exp(g,Nc_1612) in
                                                        {1169}let m1_1614: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1613) in
                                                        {1170}out(c, (pkCli_1125,m1_1614));
                                                        {1171}in(c, em2_1615: bitstring);
                                                        {1172}let m2_1616: bitstring = em2_1615 in
                                                        {1173}let (=OpenSecureChannelResponse,PartS_1617: bitstring,ST_1618: bitstring,TTL_1619: bitstring) = m2_1616 in
                                                        {1174}let Kcli_1620: bitstring = exp(PartS_1617,Nc_1612) in
                                                        {1175}out(c, senc(mCli(pkCli_1125,pkSess_1609),Kcli_1620))
                                                )
                                                else
                                                    {1176}let pkSess_1621: bitstring = fail-any in
                                                    {1177}out(c, GetEndpointRequest);
                                                    {1178}in(c, (=GetEndpointResponse,=pkSess_1621,=None,SP_1622: bitstring,UP_1623: bitstring));
                                                    {1179}new Nc_1624: bitstring;
                                                    {1180}let gNc_1625: bitstring = exp(g,Nc_1624) in
                                                    {1181}let m1_1626: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1625) in
                                                    {1182}out(c, (pkCli_1125,m1_1626));
                                                    {1183}in(c, em2_1627: bitstring);
                                                    {1184}let m2_1628: bitstring = em2_1627 in
                                                    {1185}let (=OpenSecureChannelResponse,PartS_1629: bitstring,ST_1630: bitstring,TTL_1631: bitstring) = m2_1628 in
                                                    {1186}let Kcli_1632: bitstring = exp(PartS_1629,Nc_1624) in
                                                    {1187}out(c, senc(mCli(pkCli_1125,pkSess_1621),Kcli_1632))
                                        )
                                        else
                                            {1188}let pkSess_1633: bitstring = fail-any in
                                            {1189}out(c, GetEndpointRequest);
                                            {1190}in(c, (=GetEndpointResponse,=pkSess_1633,=None,SP_1634: bitstring,UP_1635: bitstring));
                                            {1191}new Nc_1636: bitstring;
                                            {1192}let gNc_1637: bitstring = exp(g,Nc_1636) in
                                            {1193}let m1_1638: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1637) in
                                            {1194}out(c, (pkCli_1125,m1_1638));
                                            {1195}in(c, em2_1639: bitstring);
                                            {1196}let m2_1640: bitstring = em2_1639 in
                                            {1197}let (=OpenSecureChannelResponse,PartS_1641: bitstring,ST_1642: bitstring,TTL_1643: bitstring) = m2_1640 in
                                            {1198}let Kcli_1644: bitstring = exp(PartS_1641,Nc_1636) in
                                            {1199}out(c, senc(mCli(pkCli_1125,pkSess_1633),Kcli_1644))
                                )
                                else
                                    {1200}let pkSess_1645: bitstring = fail-any in
                                    {1201}out(c, GetEndpointRequest);
                                    {1202}in(c, (=GetEndpointResponse,=pkSess_1645,=None,SP_1646: bitstring,UP_1647: bitstring));
                                    {1203}new Nc_1648: bitstring;
                                    {1204}let gNc_1649: bitstring = exp(g,Nc_1648) in
                                    {1205}let m1_1650: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1649) in
                                    {1206}out(c, (pkCli_1125,m1_1650));
                                    {1207}in(c, em2_1651: bitstring);
                                    {1208}let m2_1652: bitstring = em2_1651 in
                                    {1209}let (=OpenSecureChannelResponse,PartS_1653: bitstring,ST_1654: bitstring,TTL_1655: bitstring) = m2_1652 in
                                    {1210}let Kcli_1656: bitstring = exp(PartS_1653,Nc_1648) in
                                    {1211}out(c, senc(mCli(pkCli_1125,pkSess_1645),Kcli_1656))
                    )
                    else
                        {1212}let pkDisco_1657: bitstring = fail-any in
                        {1213}let v_1658: bool = (Sess = A) in
                        (
                            {1214}if v_1658 then
                            (
                                {1215}let pkSess_1659: bitstring = pub(skA) in
                                {1216}out(c, GetEndpointRequest);
                                {1217}in(c, (=GetEndpointResponse,=pkSess_1659,=None,SP_1660: bitstring,UP_1661: bitstring));
                                {1218}new Nc_1662: bitstring;
                                {1219}let gNc_1663: bitstring = exp(g,Nc_1662) in
                                {1220}let m1_1664: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1663) in
                                {1221}out(c, (pkCli_1125,m1_1664));
                                {1222}in(c, em2_1665: bitstring);
                                {1223}let m2_1666: bitstring = em2_1665 in
                                {1224}let (=OpenSecureChannelResponse,PartS_1667: bitstring,ST_1668: bitstring,TTL_1669: bitstring) = m2_1666 in
                                {1225}let Kcli_1670: bitstring = exp(PartS_1667,Nc_1662) in
                                {1226}out(c, senc(mCli(pkCli_1125,pkSess_1659),Kcli_1670))
                            )
                            else
                                {1227}let v_1671: bool = (Sess = B) in
                                (
                                    {1228}if v_1671 then
                                    (
                                        {1229}let pkSess_1672: bitstring = pub(skB) in
                                        {1230}out(c, GetEndpointRequest);
                                        {1231}in(c, (=GetEndpointResponse,=pkSess_1672,=None,SP_1673: bitstring,UP_1674: bitstring));
                                        {1232}new Nc_1675: bitstring;
                                        {1233}let gNc_1676: bitstring = exp(g,Nc_1675) in
                                        {1234}let m1_1677: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1676) in
                                        {1235}out(c, (pkCli_1125,m1_1677));
                                        {1236}in(c, em2_1678: bitstring);
                                        {1237}let m2_1679: bitstring = em2_1678 in
                                        {1238}let (=OpenSecureChannelResponse,PartS_1680: bitstring,ST_1681: bitstring,TTL_1682: bitstring) = m2_1679 in
                                        {1239}let Kcli_1683: bitstring = exp(PartS_1680,Nc_1675) in
                                        {1240}out(c, senc(mCli(pkCli_1125,pkSess_1672),Kcli_1683))
                                    )
                                    else
                                        {1241}let v_1684: bool = (Sess = C) in
                                        (
                                            {1242}if v_1684 then
                                            (
                                                {1243}let pkSess_1685: bitstring = pub(skC) in
                                                {1244}out(c, GetEndpointRequest);
                                                {1245}in(c, (=GetEndpointResponse,=pkSess_1685,=None,SP_1686: bitstring,UP_1687: bitstring));
                                                {1246}new Nc_1688: bitstring;
                                                {1247}let gNc_1689: bitstring = exp(g,Nc_1688) in
                                                {1248}let m1_1690: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1689) in
                                                {1249}out(c, (pkCli_1125,m1_1690));
                                                {1250}in(c, em2_1691: bitstring);
                                                {1251}let m2_1692: bitstring = em2_1691 in
                                                {1252}let (=OpenSecureChannelResponse,PartS_1693: bitstring,ST_1694: bitstring,TTL_1695: bitstring) = m2_1692 in
                                                {1253}let Kcli_1696: bitstring = exp(PartS_1693,Nc_1688) in
                                                {1254}out(c, senc(mCli(pkCli_1125,pkSess_1685),Kcli_1696))
                                            )
                                            else
                                                {1255}let pkSess_1697: bitstring = pub(sk(Sess)) in
                                                {1256}out(c, GetEndpointRequest);
                                                {1257}in(c, (=GetEndpointResponse,=pkSess_1697,=None,SP_1698: bitstring,UP_1699: bitstring));
                                                {1258}new Nc_1700: bitstring;
                                                {1259}let gNc_1701: bitstring = exp(g,Nc_1700) in
                                                {1260}let m1_1702: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1701) in
                                                {1261}out(c, (pkCli_1125,m1_1702));
                                                {1262}in(c, em2_1703: bitstring);
                                                {1263}let m2_1704: bitstring = em2_1703 in
                                                {1264}let (=OpenSecureChannelResponse,PartS_1705: bitstring,ST_1706: bitstring,TTL_1707: bitstring) = m2_1704 in
                                                {1265}let Kcli_1708: bitstring = exp(PartS_1705,Nc_1700) in
                                                {1266}out(c, senc(mCli(pkCli_1125,pkSess_1697),Kcli_1708))
                                        )
                                        else
                                            {1267}let pkSess_1709: bitstring = fail-any in
                                            {1268}out(c, GetEndpointRequest);
                                            {1269}in(c, (=GetEndpointResponse,=pkSess_1709,=None,SP_1710: bitstring,UP_1711: bitstring));
                                            {1270}new Nc_1712: bitstring;
                                            {1271}let gNc_1713: bitstring = exp(g,Nc_1712) in
                                            {1272}let m1_1714: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1713) in
                                            {1273}out(c, (pkCli_1125,m1_1714));
                                            {1274}in(c, em2_1715: bitstring);
                                            {1275}let m2_1716: bitstring = em2_1715 in
                                            {1276}let (=OpenSecureChannelResponse,PartS_1717: bitstring,ST_1718: bitstring,TTL_1719: bitstring) = m2_1716 in
                                            {1277}let Kcli_1720: bitstring = exp(PartS_1717,Nc_1712) in
                                            {1278}out(c, senc(mCli(pkCli_1125,pkSess_1709),Kcli_1720))
                                )
                                else
                                    {1279}let pkSess_1721: bitstring = fail-any in
                                    {1280}out(c, GetEndpointRequest);
                                    {1281}in(c, (=GetEndpointResponse,=pkSess_1721,=None,SP_1722: bitstring,UP_1723: bitstring));
                                    {1282}new Nc_1724: bitstring;
                                    {1283}let gNc_1725: bitstring = exp(g,Nc_1724) in
                                    {1284}let m1_1726: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1725) in
                                    {1285}out(c, (pkCli_1125,m1_1726));
                                    {1286}in(c, em2_1727: bitstring);
                                    {1287}let m2_1728: bitstring = em2_1727 in
                                    {1288}let (=OpenSecureChannelResponse,PartS_1729: bitstring,ST_1730: bitstring,TTL_1731: bitstring) = m2_1728 in
                                    {1289}let Kcli_1732: bitstring = exp(PartS_1729,Nc_1724) in
                                    {1290}out(c, senc(mCli(pkCli_1125,pkSess_1721),Kcli_1732))
                        )
                        else
                            {1291}let pkSess_1733: bitstring = fail-any in
                            {1292}out(c, GetEndpointRequest);
                            {1293}in(c, (=GetEndpointResponse,=pkSess_1733,=None,SP_1734: bitstring,UP_1735: bitstring));
                            {1294}new Nc_1736: bitstring;
                            {1295}let gNc_1737: bitstring = exp(g,Nc_1736) in
                            {1296}let m1_1738: bitstring = (OpenSecureChannelRequest,pkCli_1125,gNc_1737) in
                            {1297}out(c, (pkCli_1125,m1_1738));
                            {1298}in(c, em2_1739: bitstring);
                            {1299}let m2_1740: bitstring = em2_1739 in
                            {1300}let (=OpenSecureChannelResponse,PartS_1741: bitstring,ST_1742: bitstring,TTL_1743: bitstring) = m2_1740 in
                            {1301}let Kcli_1744: bitstring = exp(PartS_1741,Nc_1736) in
                            {1302}out(c, senc(mCli(pkCli_1125,pkSess_1733),Kcli_1744))
                )
                else
                    {1303}let =true = (Cli = C) in
                    (
                        {1304}let skCli_1745: bitstring = skC in
                        {1305}let pkCli_1746: bitstring = pub(skCli_1745) in
                        {1306}let v_1747: bool = (Disco = A) in
                        (
                            {1307}if v_1747 then
                            (
                                {1308}let pkDisco_1748: bitstring = pub(skA) in
                                {1309}let v_1749: bool = (Sess = A) in
                                (
                                    {1310}if v_1749 then
                                    (
                                        {1311}let pkSess_1750: bitstring = pub(skA) in
                                        {1312}out(c, GetEndpointRequest);
                                        {1313}in(c, (=GetEndpointResponse,=pkSess_1750,=None,SP_1751: bitstring,UP_1752: bitstring));
                                        {1314}new Nc_1753: bitstring;
                                        {1315}let gNc_1754: bitstring = exp(g,Nc_1753) in
                                        {1316}let m1_1755: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1754) in
                                        {1317}out(c, (pkCli_1746,m1_1755));
                                        {1318}in(c, em2_1756: bitstring);
                                        {1319}let m2_1757: bitstring = em2_1756 in
                                        {1320}let (=OpenSecureChannelResponse,PartS_1758: bitstring,ST_1759: bitstring,TTL_1760: bitstring) = m2_1757 in
                                        {1321}let Kcli_1761: bitstring = exp(PartS_1758,Nc_1753) in
                                        {1322}out(c, senc(mCli(pkCli_1746,pkSess_1750),Kcli_1761))
                                    )
                                    else
                                        {1323}let v_1762: bool = (Sess = B) in
                                        (
                                            {1324}if v_1762 then
                                            (
                                                {1325}let pkSess_1763: bitstring = pub(skB) in
                                                {1326}out(c, GetEndpointRequest);
                                                {1327}in(c, (=GetEndpointResponse,=pkSess_1763,=None,SP_1764: bitstring,UP_1765: bitstring));
                                                {1328}new Nc_1766: bitstring;
                                                {1329}let gNc_1767: bitstring = exp(g,Nc_1766) in
                                                {1330}let m1_1768: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1767) in
                                                {1331}out(c, (pkCli_1746,m1_1768));
                                                {1332}in(c, em2_1769: bitstring);
                                                {1333}let m2_1770: bitstring = em2_1769 in
                                                {1334}let (=OpenSecureChannelResponse,PartS_1771: bitstring,ST_1772: bitstring,TTL_1773: bitstring) = m2_1770 in
                                                {1335}let Kcli_1774: bitstring = exp(PartS_1771,Nc_1766) in
                                                {1336}out(c, senc(mCli(pkCli_1746,pkSess_1763),Kcli_1774))
                                            )
                                            else
                                                {1337}let v_1775: bool = (Sess = C) in
                                                (
                                                    {1338}if v_1775 then
                                                    (
                                                        {1339}let pkSess_1776: bitstring = pub(skC) in
                                                        {1340}out(c, GetEndpointRequest);
                                                        {1341}in(c, (=GetEndpointResponse,=pkSess_1776,=None,SP_1777: bitstring,UP_1778: bitstring));
                                                        {1342}new Nc_1779: bitstring;
                                                        {1343}let gNc_1780: bitstring = exp(g,Nc_1779) in
                                                        {1344}let m1_1781: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1780) in
                                                        {1345}out(c, (pkCli_1746,m1_1781));
                                                        {1346}in(c, em2_1782: bitstring);
                                                        {1347}let m2_1783: bitstring = em2_1782 in
                                                        {1348}let (=OpenSecureChannelResponse,PartS_1784: bitstring,ST_1785: bitstring,TTL_1786: bitstring) = m2_1783 in
                                                        {1349}let Kcli_1787: bitstring = exp(PartS_1784,Nc_1779) in
                                                        {1350}out(c, senc(mCli(pkCli_1746,pkSess_1776),Kcli_1787))
                                                    )
                                                    else
                                                        {1351}let pkSess_1788: bitstring = pub(sk(Sess)) in
                                                        {1352}out(c, GetEndpointRequest);
                                                        {1353}in(c, (=GetEndpointResponse,=pkSess_1788,=None,SP_1789: bitstring,UP_1790: bitstring));
                                                        {1354}new Nc_1791: bitstring;
                                                        {1355}let gNc_1792: bitstring = exp(g,Nc_1791) in
                                                        {1356}let m1_1793: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1792) in
                                                        {1357}out(c, (pkCli_1746,m1_1793));
                                                        {1358}in(c, em2_1794: bitstring);
                                                        {1359}let m2_1795: bitstring = em2_1794 in
                                                        {1360}let (=OpenSecureChannelResponse,PartS_1796: bitstring,ST_1797: bitstring,TTL_1798: bitstring) = m2_1795 in
                                                        {1361}let Kcli_1799: bitstring = exp(PartS_1796,Nc_1791) in
                                                        {1362}out(c, senc(mCli(pkCli_1746,pkSess_1788),Kcli_1799))
                                                )
                                                else
                                                    {1363}let pkSess_1800: bitstring = fail-any in
                                                    {1364}out(c, GetEndpointRequest);
                                                    {1365}in(c, (=GetEndpointResponse,=pkSess_1800,=None,SP_1801: bitstring,UP_1802: bitstring));
                                                    {1366}new Nc_1803: bitstring;
                                                    {1367}let gNc_1804: bitstring = exp(g,Nc_1803) in
                                                    {1368}let m1_1805: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1804) in
                                                    {1369}out(c, (pkCli_1746,m1_1805));
                                                    {1370}in(c, em2_1806: bitstring);
                                                    {1371}let m2_1807: bitstring = em2_1806 in
                                                    {1372}let (=OpenSecureChannelResponse,PartS_1808: bitstring,ST_1809: bitstring,TTL_1810: bitstring) = m2_1807 in
                                                    {1373}let Kcli_1811: bitstring = exp(PartS_1808,Nc_1803) in
                                                    {1374}out(c, senc(mCli(pkCli_1746,pkSess_1800),Kcli_1811))
                                        )
                                        else
                                            {1375}let pkSess_1812: bitstring = fail-any in
                                            {1376}out(c, GetEndpointRequest);
                                            {1377}in(c, (=GetEndpointResponse,=pkSess_1812,=None,SP_1813: bitstring,UP_1814: bitstring));
                                            {1378}new Nc_1815: bitstring;
                                            {1379}let gNc_1816: bitstring = exp(g,Nc_1815) in
                                            {1380}let m1_1817: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1816) in
                                            {1381}out(c, (pkCli_1746,m1_1817));
                                            {1382}in(c, em2_1818: bitstring);
                                            {1383}let m2_1819: bitstring = em2_1818 in
                                            {1384}let (=OpenSecureChannelResponse,PartS_1820: bitstring,ST_1821: bitstring,TTL_1822: bitstring) = m2_1819 in
                                            {1385}let Kcli_1823: bitstring = exp(PartS_1820,Nc_1815) in
                                            {1386}out(c, senc(mCli(pkCli_1746,pkSess_1812),Kcli_1823))
                                )
                                else
                                    {1387}let pkSess_1824: bitstring = fail-any in
                                    {1388}out(c, GetEndpointRequest);
                                    {1389}in(c, (=GetEndpointResponse,=pkSess_1824,=None,SP_1825: bitstring,UP_1826: bitstring));
                                    {1390}new Nc_1827: bitstring;
                                    {1391}let gNc_1828: bitstring = exp(g,Nc_1827) in
                                    {1392}let m1_1829: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1828) in
                                    {1393}out(c, (pkCli_1746,m1_1829));
                                    {1394}in(c, em2_1830: bitstring);
                                    {1395}let m2_1831: bitstring = em2_1830 in
                                    {1396}let (=OpenSecureChannelResponse,PartS_1832: bitstring,ST_1833: bitstring,TTL_1834: bitstring) = m2_1831 in
                                    {1397}let Kcli_1835: bitstring = exp(PartS_1832,Nc_1827) in
                                    {1398}out(c, senc(mCli(pkCli_1746,pkSess_1824),Kcli_1835))
                            )
                            else
                                {1399}let v_1836: bool = (Disco = B) in
                                (
                                    {1400}if v_1836 then
                                    (
                                        {1401}let pkDisco_1837: bitstring = pub(skB) in
                                        {1402}let v_1838: bool = (Sess = A) in
                                        (
                                            {1403}if v_1838 then
                                            (
                                                {1404}let pkSess_1839: bitstring = pub(skA) in
                                                {1405}out(c, GetEndpointRequest);
                                                {1406}in(c, (=GetEndpointResponse,=pkSess_1839,=None,SP_1840: bitstring,UP_1841: bitstring));
                                                {1407}new Nc_1842: bitstring;
                                                {1408}let gNc_1843: bitstring = exp(g,Nc_1842) in
                                                {1409}let m1_1844: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1843) in
                                                {1410}out(c, (pkCli_1746,m1_1844));
                                                {1411}in(c, em2_1845: bitstring);
                                                {1412}let m2_1846: bitstring = em2_1845 in
                                                {1413}let (=OpenSecureChannelResponse,PartS_1847: bitstring,ST_1848: bitstring,TTL_1849: bitstring) = m2_1846 in
                                                {1414}let Kcli_1850: bitstring = exp(PartS_1847,Nc_1842) in
                                                {1415}out(c, senc(mCli(pkCli_1746,pkSess_1839),Kcli_1850))
                                            )
                                            else
                                                {1416}let v_1851: bool = (Sess = B) in
                                                (
                                                    {1417}if v_1851 then
                                                    (
                                                        {1418}let pkSess_1852: bitstring = pub(skB) in
                                                        {1419}out(c, GetEndpointRequest);
                                                        {1420}in(c, (=GetEndpointResponse,=pkSess_1852,=None,SP_1853: bitstring,UP_1854: bitstring));
                                                        {1421}new Nc_1855: bitstring;
                                                        {1422}let gNc_1856: bitstring = exp(g,Nc_1855) in
                                                        {1423}let m1_1857: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1856) in
                                                        {1424}out(c, (pkCli_1746,m1_1857));
                                                        {1425}in(c, em2_1858: bitstring);
                                                        {1426}let m2_1859: bitstring = em2_1858 in
                                                        {1427}let (=OpenSecureChannelResponse,PartS_1860: bitstring,ST_1861: bitstring,TTL_1862: bitstring) = m2_1859 in
                                                        {1428}let Kcli_1863: bitstring = exp(PartS_1860,Nc_1855) in
                                                        {1429}out(c, senc(mCli(pkCli_1746,pkSess_1852),Kcli_1863))
                                                    )
                                                    else
                                                        {1430}let v_1864: bool = (Sess = C) in
                                                        (
                                                            {1431}if v_1864 then
                                                            (
                                                                {1432}let pkSess_1865: bitstring = pub(skC) in
                                                                {1433}out(c, GetEndpointRequest);
                                                                {1434}in(c, (=GetEndpointResponse,=pkSess_1865,=None,SP_1866: bitstring,UP_1867: bitstring));
                                                                {1435}new Nc_1868: bitstring;
                                                                {1436}let gNc_1869: bitstring = exp(g,Nc_1868) in
                                                                {1437}let m1_1870: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1869) in
                                                                {1438}out(c, (pkCli_1746,m1_1870));
                                                                {1439}in(c, em2_1871: bitstring);
                                                                {1440}let m2_1872: bitstring = em2_1871 in
                                                                {1441}let (=OpenSecureChannelResponse,PartS_1873: bitstring,ST_1874: bitstring,TTL_1875: bitstring) = m2_1872 in
                                                                {1442}let Kcli_1876: bitstring = exp(PartS_1873,Nc_1868) in
                                                                {1443}out(c, senc(mCli(pkCli_1746,pkSess_1865),Kcli_1876))
                                                            )
                                                            else
                                                                {1444}let pkSess_1877: bitstring = pub(sk(Sess)) in
                                                                {1445}out(c, GetEndpointRequest);
                                                                {1446}in(c, (=GetEndpointResponse,=pkSess_1877,=None,SP_1878: bitstring,UP_1879: bitstring));
                                                                {1447}new Nc_1880: bitstring;
                                                                {1448}let gNc_1881: bitstring = exp(g,Nc_1880) in
                                                                {1449}let m1_1882: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1881) in
                                                                {1450}out(c, (pkCli_1746,m1_1882));
                                                                {1451}in(c, em2_1883: bitstring);
                                                                {1452}let m2_1884: bitstring = em2_1883 in
                                                                {1453}let (=OpenSecureChannelResponse,PartS_1885: bitstring,ST_1886: bitstring,TTL_1887: bitstring) = m2_1884 in
                                                                {1454}let Kcli_1888: bitstring = exp(PartS_1885,Nc_1880) in
                                                                {1455}out(c, senc(mCli(pkCli_1746,pkSess_1877),Kcli_1888))
                                                        )
                                                        else
                                                            {1456}let pkSess_1889: bitstring = fail-any in
                                                            {1457}out(c, GetEndpointRequest);
                                                            {1458}in(c, (=GetEndpointResponse,=pkSess_1889,=None,SP_1890: bitstring,UP_1891: bitstring));
                                                            {1459}new Nc_1892: bitstring;
                                                            {1460}let gNc_1893: bitstring = exp(g,Nc_1892) in
                                                            {1461}let m1_1894: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1893) in
                                                            {1462}out(c, (pkCli_1746,m1_1894));
                                                            {1463}in(c, em2_1895: bitstring);
                                                            {1464}let m2_1896: bitstring = em2_1895 in
                                                            {1465}let (=OpenSecureChannelResponse,PartS_1897: bitstring,ST_1898: bitstring,TTL_1899: bitstring) = m2_1896 in
                                                            {1466}let Kcli_1900: bitstring = exp(PartS_1897,Nc_1892) in
                                                            {1467}out(c, senc(mCli(pkCli_1746,pkSess_1889),Kcli_1900))
                                                )
                                                else
                                                    {1468}let pkSess_1901: bitstring = fail-any in
                                                    {1469}out(c, GetEndpointRequest);
                                                    {1470}in(c, (=GetEndpointResponse,=pkSess_1901,=None,SP_1902: bitstring,UP_1903: bitstring));
                                                    {1471}new Nc_1904: bitstring;
                                                    {1472}let gNc_1905: bitstring = exp(g,Nc_1904) in
                                                    {1473}let m1_1906: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1905) in
                                                    {1474}out(c, (pkCli_1746,m1_1906));
                                                    {1475}in(c, em2_1907: bitstring);
                                                    {1476}let m2_1908: bitstring = em2_1907 in
                                                    {1477}let (=OpenSecureChannelResponse,PartS_1909: bitstring,ST_1910: bitstring,TTL_1911: bitstring) = m2_1908 in
                                                    {1478}let Kcli_1912: bitstring = exp(PartS_1909,Nc_1904) in
                                                    {1479}out(c, senc(mCli(pkCli_1746,pkSess_1901),Kcli_1912))
                                        )
                                        else
                                            {1480}let pkSess_1913: bitstring = fail-any in
                                            {1481}out(c, GetEndpointRequest);
                                            {1482}in(c, (=GetEndpointResponse,=pkSess_1913,=None,SP_1914: bitstring,UP_1915: bitstring));
                                            {1483}new Nc_1916: bitstring;
                                            {1484}let gNc_1917: bitstring = exp(g,Nc_1916) in
                                            {1485}let m1_1918: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1917) in
                                            {1486}out(c, (pkCli_1746,m1_1918));
                                            {1487}in(c, em2_1919: bitstring);
                                            {1488}let m2_1920: bitstring = em2_1919 in
                                            {1489}let (=OpenSecureChannelResponse,PartS_1921: bitstring,ST_1922: bitstring,TTL_1923: bitstring) = m2_1920 in
                                            {1490}let Kcli_1924: bitstring = exp(PartS_1921,Nc_1916) in
                                            {1491}out(c, senc(mCli(pkCli_1746,pkSess_1913),Kcli_1924))
                                    )
                                    else
                                        {1492}let v_1925: bool = (Disco = C) in
                                        (
                                            {1493}if v_1925 then
                                            (
                                                {1494}let pkDisco_1926: bitstring = pub(skC) in
                                                {1495}let v_1927: bool = (Sess = A) in
                                                (
                                                    {1496}if v_1927 then
                                                    (
                                                        {1497}let pkSess_1928: bitstring = pub(skA) in
                                                        {1498}out(c, GetEndpointRequest);
                                                        {1499}in(c, (=GetEndpointResponse,=pkSess_1928,=None,SP_1929: bitstring,UP_1930: bitstring));
                                                        {1500}new Nc_1931: bitstring;
                                                        {1501}let gNc_1932: bitstring = exp(g,Nc_1931) in
                                                        {1502}let m1_1933: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1932) in
                                                        {1503}out(c, (pkCli_1746,m1_1933));
                                                        {1504}in(c, em2_1934: bitstring);
                                                        {1505}let m2_1935: bitstring = em2_1934 in
                                                        {1506}let (=OpenSecureChannelResponse,PartS_1936: bitstring,ST_1937: bitstring,TTL_1938: bitstring) = m2_1935 in
                                                        {1507}let Kcli_1939: bitstring = exp(PartS_1936,Nc_1931) in
                                                        {1508}out(c, senc(mCli(pkCli_1746,pkSess_1928),Kcli_1939))
                                                    )
                                                    else
                                                        {1509}let v_1940: bool = (Sess = B) in
                                                        (
                                                            {1510}if v_1940 then
                                                            (
                                                                {1511}let pkSess_1941: bitstring = pub(skB) in
                                                                {1512}out(c, GetEndpointRequest);
                                                                {1513}in(c, (=GetEndpointResponse,=pkSess_1941,=None,SP_1942: bitstring,UP_1943: bitstring));
                                                                {1514}new Nc_1944: bitstring;
                                                                {1515}let gNc_1945: bitstring = exp(g,Nc_1944) in
                                                                {1516}let m1_1946: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1945) in
                                                                {1517}out(c, (pkCli_1746,m1_1946));
                                                                {1518}in(c, em2_1947: bitstring);
                                                                {1519}let m2_1948: bitstring = em2_1947 in
                                                                {1520}let (=OpenSecureChannelResponse,PartS_1949: bitstring,ST_1950: bitstring,TTL_1951: bitstring) = m2_1948 in
                                                                {1521}let Kcli_1952: bitstring = exp(PartS_1949,Nc_1944) in
                                                                {1522}out(c, senc(mCli(pkCli_1746,pkSess_1941),Kcli_1952))
                                                            )
                                                            else
                                                                {1523}let v_1953: bool = (Sess = C) in
                                                                (
                                                                    {1524}if v_1953 then
                                                                    (
                                                                        {1525}let pkSess_1954: bitstring = pub(skC) in
                                                                        {1526}out(c, GetEndpointRequest);
                                                                        {1527}in(c, (=GetEndpointResponse,=pkSess_1954,=None,SP_1955: bitstring,UP_1956: bitstring));
                                                                        {1528}new Nc_1957: bitstring;
                                                                        {1529}let gNc_1958: bitstring = exp(g,Nc_1957) in
                                                                        {1530}let m1_1959: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1958) in
                                                                        {1531}out(c, (pkCli_1746,m1_1959));
                                                                        {1532}in(c, em2_1960: bitstring);
                                                                        {1533}let m2_1961: bitstring = em2_1960 in
                                                                        {1534}let (=OpenSecureChannelResponse,PartS_1962: bitstring,ST_1963: bitstring,TTL_1964: bitstring) = m2_1961 in
                                                                        {1535}let Kcli_1965: bitstring = exp(PartS_1962,Nc_1957) in
                                                                        {1536}out(c, senc(mCli(pkCli_1746,pkSess_1954),Kcli_1965))
                                                                    )
                                                                    else
                                                                        {1537}let pkSess_1966: bitstring = pub(sk(Sess)) in
                                                                        {1538}out(c, GetEndpointRequest);
                                                                        {1539}in(c, (=GetEndpointResponse,=pkSess_1966,=None,SP_1967: bitstring,UP_1968: bitstring));
                                                                        {1540}new Nc_1969: bitstring;
                                                                        {1541}let gNc_1970: bitstring = exp(g,Nc_1969) in
                                                                        {1542}let m1_1971: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1970) in
                                                                        {1543}out(c, (pkCli_1746,m1_1971));
                                                                        {1544}in(c, em2_1972: bitstring);
                                                                        {1545}let m2_1973: bitstring = em2_1972 in
                                                                        {1546}let (=OpenSecureChannelResponse,PartS_1974: bitstring,ST_1975: bitstring,TTL_1976: bitstring) = m2_1973 in
                                                                        {1547}let Kcli_1977: bitstring = exp(PartS_1974,Nc_1969) in
                                                                        {1548}out(c, senc(mCli(pkCli_1746,pkSess_1966),Kcli_1977))
                                                                )
                                                                else
                                                                    {1549}let pkSess_1978: bitstring = fail-any in
                                                                    {1550}out(c, GetEndpointRequest);
                                                                    {1551}in(c, (=GetEndpointResponse,=pkSess_1978,=None,SP_1979: bitstring,UP_1980: bitstring));
                                                                    {1552}new Nc_1981: bitstring;
                                                                    {1553}let gNc_1982: bitstring = exp(g,Nc_1981) in
                                                                    {1554}let m1_1983: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1982) in
                                                                    {1555}out(c, (pkCli_1746,m1_1983));
                                                                    {1556}in(c, em2_1984: bitstring);
                                                                    {1557}let m2_1985: bitstring = em2_1984 in
                                                                    {1558}let (=OpenSecureChannelResponse,PartS_1986: bitstring,ST_1987: bitstring,TTL_1988: bitstring) = m2_1985 in
                                                                    {1559}let Kcli_1989: bitstring = exp(PartS_1986,Nc_1981) in
                                                                    {1560}out(c, senc(mCli(pkCli_1746,pkSess_1978),Kcli_1989))
                                                        )
                                                        else
                                                            {1561}let pkSess_1990: bitstring = fail-any in
                                                            {1562}out(c, GetEndpointRequest);
                                                            {1563}in(c, (=GetEndpointResponse,=pkSess_1990,=None,SP_1991: bitstring,UP_1992: bitstring));
                                                            {1564}new Nc_1993: bitstring;
                                                            {1565}let gNc_1994: bitstring = exp(g,Nc_1993) in
                                                            {1566}let m1_1995: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_1994) in
                                                            {1567}out(c, (pkCli_1746,m1_1995));
                                                            {1568}in(c, em2_1996: bitstring);
                                                            {1569}let m2_1997: bitstring = em2_1996 in
                                                            {1570}let (=OpenSecureChannelResponse,PartS_1998: bitstring,ST_1999: bitstring,TTL_2000: bitstring) = m2_1997 in
                                                            {1571}let Kcli_2001: bitstring = exp(PartS_1998,Nc_1993) in
                                                            {1572}out(c, senc(mCli(pkCli_1746,pkSess_1990),Kcli_2001))
                                                )
                                                else
                                                    {1573}let pkSess_2002: bitstring = fail-any in
                                                    {1574}out(c, GetEndpointRequest);
                                                    {1575}in(c, (=GetEndpointResponse,=pkSess_2002,=None,SP_2003: bitstring,UP_2004: bitstring));
                                                    {1576}new Nc_2005: bitstring;
                                                    {1577}let gNc_2006: bitstring = exp(g,Nc_2005) in
                                                    {1578}let m1_2007: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2006) in
                                                    {1579}out(c, (pkCli_1746,m1_2007));
                                                    {1580}in(c, em2_2008: bitstring);
                                                    {1581}let m2_2009: bitstring = em2_2008 in
                                                    {1582}let (=OpenSecureChannelResponse,PartS_2010: bitstring,ST_2011: bitstring,TTL_2012: bitstring) = m2_2009 in
                                                    {1583}let Kcli_2013: bitstring = exp(PartS_2010,Nc_2005) in
                                                    {1584}out(c, senc(mCli(pkCli_1746,pkSess_2002),Kcli_2013))
                                            )
                                            else
                                                {1585}let pkDisco_2014: bitstring = pub(sk(Disco)) in
                                                {1586}let v_2015: bool = (Sess = A) in
                                                (
                                                    {1587}if v_2015 then
                                                    (
                                                        {1588}let pkSess_2016: bitstring = pub(skA) in
                                                        {1589}out(c, GetEndpointRequest);
                                                        {1590}in(c, (=GetEndpointResponse,=pkSess_2016,=None,SP_2017: bitstring,UP_2018: bitstring));
                                                        {1591}new Nc_2019: bitstring;
                                                        {1592}let gNc_2020: bitstring = exp(g,Nc_2019) in
                                                        {1593}let m1_2021: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2020) in
                                                        {1594}out(c, (pkCli_1746,m1_2021));
                                                        {1595}in(c, em2_2022: bitstring);
                                                        {1596}let m2_2023: bitstring = em2_2022 in
                                                        {1597}let (=OpenSecureChannelResponse,PartS_2024: bitstring,ST_2025: bitstring,TTL_2026: bitstring) = m2_2023 in
                                                        {1598}let Kcli_2027: bitstring = exp(PartS_2024,Nc_2019) in
                                                        {1599}out(c, senc(mCli(pkCli_1746,pkSess_2016),Kcli_2027))
                                                    )
                                                    else
                                                        {1600}let v_2028: bool = (Sess = B) in
                                                        (
                                                            {1601}if v_2028 then
                                                            (
                                                                {1602}let pkSess_2029: bitstring = pub(skB) in
                                                                {1603}out(c, GetEndpointRequest);
                                                                {1604}in(c, (=GetEndpointResponse,=pkSess_2029,=None,SP_2030: bitstring,UP_2031: bitstring));
                                                                {1605}new Nc_2032: bitstring;
                                                                {1606}let gNc_2033: bitstring = exp(g,Nc_2032) in
                                                                {1607}let m1_2034: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2033) in
                                                                {1608}out(c, (pkCli_1746,m1_2034));
                                                                {1609}in(c, em2_2035: bitstring);
                                                                {1610}let m2_2036: bitstring = em2_2035 in
                                                                {1611}let (=OpenSecureChannelResponse,PartS_2037: bitstring,ST_2038: bitstring,TTL_2039: bitstring) = m2_2036 in
                                                                {1612}let Kcli_2040: bitstring = exp(PartS_2037,Nc_2032) in
                                                                {1613}out(c, senc(mCli(pkCli_1746,pkSess_2029),Kcli_2040))
                                                            )
                                                            else
                                                                {1614}let v_2041: bool = (Sess = C) in
                                                                (
                                                                    {1615}if v_2041 then
                                                                    (
                                                                        {1616}let pkSess_2042: bitstring = pub(skC) in
                                                                        {1617}out(c, GetEndpointRequest);
                                                                        {1618}in(c, (=GetEndpointResponse,=pkSess_2042,=None,SP_2043: bitstring,UP_2044: bitstring));
                                                                        {1619}new Nc_2045: bitstring;
                                                                        {1620}let gNc_2046: bitstring = exp(g,Nc_2045) in
                                                                        {1621}let m1_2047: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2046) in
                                                                        {1622}out(c, (pkCli_1746,m1_2047));
                                                                        {1623}in(c, em2_2048: bitstring);
                                                                        {1624}let m2_2049: bitstring = em2_2048 in
                                                                        {1625}let (=OpenSecureChannelResponse,PartS_2050: bitstring,ST_2051: bitstring,TTL_2052: bitstring) = m2_2049 in
                                                                        {1626}let Kcli_2053: bitstring = exp(PartS_2050,Nc_2045) in
                                                                        {1627}out(c, senc(mCli(pkCli_1746,pkSess_2042),Kcli_2053))
                                                                    )
                                                                    else
                                                                        {1628}let pkSess_2054: bitstring = pub(sk(Sess)) in
                                                                        {1629}out(c, GetEndpointRequest);
                                                                        {1630}in(c, (=GetEndpointResponse,=pkSess_2054,=None,SP_2055: bitstring,UP_2056: bitstring));
                                                                        {1631}new Nc_2057: bitstring;
                                                                        {1632}let gNc_2058: bitstring = exp(g,Nc_2057) in
                                                                        {1633}let m1_2059: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2058) in
                                                                        {1634}out(c, (pkCli_1746,m1_2059));
                                                                        {1635}in(c, em2_2060: bitstring);
                                                                        {1636}let m2_2061: bitstring = em2_2060 in
                                                                        {1637}let (=OpenSecureChannelResponse,PartS_2062: bitstring,ST_2063: bitstring,TTL_2064: bitstring) = m2_2061 in
                                                                        {1638}let Kcli_2065: bitstring = exp(PartS_2062,Nc_2057) in
                                                                        {1639}out(c, senc(mCli(pkCli_1746,pkSess_2054),Kcli_2065))
                                                                )
                                                                else
                                                                    {1640}let pkSess_2066: bitstring = fail-any in
                                                                    {1641}out(c, GetEndpointRequest);
                                                                    {1642}in(c, (=GetEndpointResponse,=pkSess_2066,=None,SP_2067: bitstring,UP_2068: bitstring));
                                                                    {1643}new Nc_2069: bitstring;
                                                                    {1644}let gNc_2070: bitstring = exp(g,Nc_2069) in
                                                                    {1645}let m1_2071: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2070) in
                                                                    {1646}out(c, (pkCli_1746,m1_2071));
                                                                    {1647}in(c, em2_2072: bitstring);
                                                                    {1648}let m2_2073: bitstring = em2_2072 in
                                                                    {1649}let (=OpenSecureChannelResponse,PartS_2074: bitstring,ST_2075: bitstring,TTL_2076: bitstring) = m2_2073 in
                                                                    {1650}let Kcli_2077: bitstring = exp(PartS_2074,Nc_2069) in
                                                                    {1651}out(c, senc(mCli(pkCli_1746,pkSess_2066),Kcli_2077))
                                                        )
                                                        else
                                                            {1652}let pkSess_2078: bitstring = fail-any in
                                                            {1653}out(c, GetEndpointRequest);
                                                            {1654}in(c, (=GetEndpointResponse,=pkSess_2078,=None,SP_2079: bitstring,UP_2080: bitstring));
                                                            {1655}new Nc_2081: bitstring;
                                                            {1656}let gNc_2082: bitstring = exp(g,Nc_2081) in
                                                            {1657}let m1_2083: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2082) in
                                                            {1658}out(c, (pkCli_1746,m1_2083));
                                                            {1659}in(c, em2_2084: bitstring);
                                                            {1660}let m2_2085: bitstring = em2_2084 in
                                                            {1661}let (=OpenSecureChannelResponse,PartS_2086: bitstring,ST_2087: bitstring,TTL_2088: bitstring) = m2_2085 in
                                                            {1662}let Kcli_2089: bitstring = exp(PartS_2086,Nc_2081) in
                                                            {1663}out(c, senc(mCli(pkCli_1746,pkSess_2078),Kcli_2089))
                                                )
                                                else
                                                    {1664}let pkSess_2090: bitstring = fail-any in
                                                    {1665}out(c, GetEndpointRequest);
                                                    {1666}in(c, (=GetEndpointResponse,=pkSess_2090,=None,SP_2091: bitstring,UP_2092: bitstring));
                                                    {1667}new Nc_2093: bitstring;
                                                    {1668}let gNc_2094: bitstring = exp(g,Nc_2093) in
                                                    {1669}let m1_2095: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2094) in
                                                    {1670}out(c, (pkCli_1746,m1_2095));
                                                    {1671}in(c, em2_2096: bitstring);
                                                    {1672}let m2_2097: bitstring = em2_2096 in
                                                    {1673}let (=OpenSecureChannelResponse,PartS_2098: bitstring,ST_2099: bitstring,TTL_2100: bitstring) = m2_2097 in
                                                    {1674}let Kcli_2101: bitstring = exp(PartS_2098,Nc_2093) in
                                                    {1675}out(c, senc(mCli(pkCli_1746,pkSess_2090),Kcli_2101))
                                        )
                                        else
                                            {1676}let pkDisco_2102: bitstring = fail-any in
                                            {1677}let v_2103: bool = (Sess = A) in
                                            (
                                                {1678}if v_2103 then
                                                (
                                                    {1679}let pkSess_2104: bitstring = pub(skA) in
                                                    {1680}out(c, GetEndpointRequest);
                                                    {1681}in(c, (=GetEndpointResponse,=pkSess_2104,=None,SP_2105: bitstring,UP_2106: bitstring));
                                                    {1682}new Nc_2107: bitstring;
                                                    {1683}let gNc_2108: bitstring = exp(g,Nc_2107) in
                                                    {1684}let m1_2109: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2108) in
                                                    {1685}out(c, (pkCli_1746,m1_2109));
                                                    {1686}in(c, em2_2110: bitstring);
                                                    {1687}let m2_2111: bitstring = em2_2110 in
                                                    {1688}let (=OpenSecureChannelResponse,PartS_2112: bitstring,ST_2113: bitstring,TTL_2114: bitstring) = m2_2111 in
                                                    {1689}let Kcli_2115: bitstring = exp(PartS_2112,Nc_2107) in
                                                    {1690}out(c, senc(mCli(pkCli_1746,pkSess_2104),Kcli_2115))
                                                )
                                                else
                                                    {1691}let v_2116: bool = (Sess = B) in
                                                    (
                                                        {1692}if v_2116 then
                                                        (
                                                            {1693}let pkSess_2117: bitstring = pub(skB) in
                                                            {1694}out(c, GetEndpointRequest);
                                                            {1695}in(c, (=GetEndpointResponse,=pkSess_2117,=None,SP_2118: bitstring,UP_2119: bitstring));
                                                            {1696}new Nc_2120: bitstring;
                                                            {1697}let gNc_2121: bitstring = exp(g,Nc_2120) in
                                                            {1698}let m1_2122: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2121) in
                                                            {1699}out(c, (pkCli_1746,m1_2122));
                                                            {1700}in(c, em2_2123: bitstring);
                                                            {1701}let m2_2124: bitstring = em2_2123 in
                                                            {1702}let (=OpenSecureChannelResponse,PartS_2125: bitstring,ST_2126: bitstring,TTL_2127: bitstring) = m2_2124 in
                                                            {1703}let Kcli_2128: bitstring = exp(PartS_2125,Nc_2120) in
                                                            {1704}out(c, senc(mCli(pkCli_1746,pkSess_2117),Kcli_2128))
                                                        )
                                                        else
                                                            {1705}let v_2129: bool = (Sess = C) in
                                                            (
                                                                {1706}if v_2129 then
                                                                (
                                                                    {1707}let pkSess_2130: bitstring = pub(skC) in
                                                                    {1708}out(c, GetEndpointRequest);
                                                                    {1709}in(c, (=GetEndpointResponse,=pkSess_2130,=None,SP_2131: bitstring,UP_2132: bitstring));
                                                                    {1710}new Nc_2133: bitstring;
                                                                    {1711}let gNc_2134: bitstring = exp(g,Nc_2133) in
                                                                    {1712}let m1_2135: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2134) in
                                                                    {1713}out(c, (pkCli_1746,m1_2135));
                                                                    {1714}in(c, em2_2136: bitstring);
                                                                    {1715}let m2_2137: bitstring = em2_2136 in
                                                                    {1716}let (=OpenSecureChannelResponse,PartS_2138: bitstring,ST_2139: bitstring,TTL_2140: bitstring) = m2_2137 in
                                                                    {1717}let Kcli_2141: bitstring = exp(PartS_2138,Nc_2133) in
                                                                    {1718}out(c, senc(mCli(pkCli_1746,pkSess_2130),Kcli_2141))
                                                                )
                                                                else
                                                                    {1719}let pkSess_2142: bitstring = pub(sk(Sess)) in
                                                                    {1720}out(c, GetEndpointRequest);
                                                                    {1721}in(c, (=GetEndpointResponse,=pkSess_2142,=None,SP_2143: bitstring,UP_2144: bitstring));
                                                                    {1722}new Nc_2145: bitstring;
                                                                    {1723}let gNc_2146: bitstring = exp(g,Nc_2145) in
                                                                    {1724}let m1_2147: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2146) in
                                                                    {1725}out(c, (pkCli_1746,m1_2147));
                                                                    {1726}in(c, em2_2148: bitstring);
                                                                    {1727}let m2_2149: bitstring = em2_2148 in
                                                                    {1728}let (=OpenSecureChannelResponse,PartS_2150: bitstring,ST_2151: bitstring,TTL_2152: bitstring) = m2_2149 in
                                                                    {1729}let Kcli_2153: bitstring = exp(PartS_2150,Nc_2145) in
                                                                    {1730}out(c, senc(mCli(pkCli_1746,pkSess_2142),Kcli_2153))
                                                            )
                                                            else
                                                                {1731}let pkSess_2154: bitstring = fail-any in
                                                                {1732}out(c, GetEndpointRequest);
                                                                {1733}in(c, (=GetEndpointResponse,=pkSess_2154,=None,SP_2155: bitstring,UP_2156: bitstring));
                                                                {1734}new Nc_2157: bitstring;
                                                                {1735}let gNc_2158: bitstring = exp(g,Nc_2157) in
                                                                {1736}let m1_2159: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2158) in
                                                                {1737}out(c, (pkCli_1746,m1_2159));
                                                                {1738}in(c, em2_2160: bitstring);
                                                                {1739}let m2_2161: bitstring = em2_2160 in
                                                                {1740}let (=OpenSecureChannelResponse,PartS_2162: bitstring,ST_2163: bitstring,TTL_2164: bitstring) = m2_2161 in
                                                                {1741}let Kcli_2165: bitstring = exp(PartS_2162,Nc_2157) in
                                                                {1742}out(c, senc(mCli(pkCli_1746,pkSess_2154),Kcli_2165))
                                                    )
                                                    else
                                                        {1743}let pkSess_2166: bitstring = fail-any in
                                                        {1744}out(c, GetEndpointRequest);
                                                        {1745}in(c, (=GetEndpointResponse,=pkSess_2166,=None,SP_2167: bitstring,UP_2168: bitstring));
                                                        {1746}new Nc_2169: bitstring;
                                                        {1747}let gNc_2170: bitstring = exp(g,Nc_2169) in
                                                        {1748}let m1_2171: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2170) in
                                                        {1749}out(c, (pkCli_1746,m1_2171));
                                                        {1750}in(c, em2_2172: bitstring);
                                                        {1751}let m2_2173: bitstring = em2_2172 in
                                                        {1752}let (=OpenSecureChannelResponse,PartS_2174: bitstring,ST_2175: bitstring,TTL_2176: bitstring) = m2_2173 in
                                                        {1753}let Kcli_2177: bitstring = exp(PartS_2174,Nc_2169) in
                                                        {1754}out(c, senc(mCli(pkCli_1746,pkSess_2166),Kcli_2177))
                                            )
                                            else
                                                {1755}let pkSess_2178: bitstring = fail-any in
                                                {1756}out(c, GetEndpointRequest);
                                                {1757}in(c, (=GetEndpointResponse,=pkSess_2178,=None,SP_2179: bitstring,UP_2180: bitstring));
                                                {1758}new Nc_2181: bitstring;
                                                {1759}let gNc_2182: bitstring = exp(g,Nc_2181) in
                                                {1760}let m1_2183: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2182) in
                                                {1761}out(c, (pkCli_1746,m1_2183));
                                                {1762}in(c, em2_2184: bitstring);
                                                {1763}let m2_2185: bitstring = em2_2184 in
                                                {1764}let (=OpenSecureChannelResponse,PartS_2186: bitstring,ST_2187: bitstring,TTL_2188: bitstring) = m2_2185 in
                                                {1765}let Kcli_2189: bitstring = exp(PartS_2186,Nc_2181) in
                                                {1766}out(c, senc(mCli(pkCli_1746,pkSess_2178),Kcli_2189))
                                )
                                else
                                    {1767}let pkDisco_2190: bitstring = fail-any in
                                    {1768}let v_2191: bool = (Sess = A) in
                                    (
                                        {1769}if v_2191 then
                                        (
                                            {1770}let pkSess_2192: bitstring = pub(skA) in
                                            {1771}out(c, GetEndpointRequest);
                                            {1772}in(c, (=GetEndpointResponse,=pkSess_2192,=None,SP_2193: bitstring,UP_2194: bitstring));
                                            {1773}new Nc_2195: bitstring;
                                            {1774}let gNc_2196: bitstring = exp(g,Nc_2195) in
                                            {1775}let m1_2197: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2196) in
                                            {1776}out(c, (pkCli_1746,m1_2197));
                                            {1777}in(c, em2_2198: bitstring);
                                            {1778}let m2_2199: bitstring = em2_2198 in
                                            {1779}let (=OpenSecureChannelResponse,PartS_2200: bitstring,ST_2201: bitstring,TTL_2202: bitstring) = m2_2199 in
                                            {1780}let Kcli_2203: bitstring = exp(PartS_2200,Nc_2195) in
                                            {1781}out(c, senc(mCli(pkCli_1746,pkSess_2192),Kcli_2203))
                                        )
                                        else
                                            {1782}let v_2204: bool = (Sess = B) in
                                            (
                                                {1783}if v_2204 then
                                                (
                                                    {1784}let pkSess_2205: bitstring = pub(skB) in
                                                    {1785}out(c, GetEndpointRequest);
                                                    {1786}in(c, (=GetEndpointResponse,=pkSess_2205,=None,SP_2206: bitstring,UP_2207: bitstring));
                                                    {1787}new Nc_2208: bitstring;
                                                    {1788}let gNc_2209: bitstring = exp(g,Nc_2208) in
                                                    {1789}let m1_2210: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2209) in
                                                    {1790}out(c, (pkCli_1746,m1_2210));
                                                    {1791}in(c, em2_2211: bitstring);
                                                    {1792}let m2_2212: bitstring = em2_2211 in
                                                    {1793}let (=OpenSecureChannelResponse,PartS_2213: bitstring,ST_2214: bitstring,TTL_2215: bitstring) = m2_2212 in
                                                    {1794}let Kcli_2216: bitstring = exp(PartS_2213,Nc_2208) in
                                                    {1795}out(c, senc(mCli(pkCli_1746,pkSess_2205),Kcli_2216))
                                                )
                                                else
                                                    {1796}let v_2217: bool = (Sess = C) in
                                                    (
                                                        {1797}if v_2217 then
                                                        (
                                                            {1798}let pkSess_2218: bitstring = pub(skC) in
                                                            {1799}out(c, GetEndpointRequest);
                                                            {1800}in(c, (=GetEndpointResponse,=pkSess_2218,=None,SP_2219: bitstring,UP_2220: bitstring));
                                                            {1801}new Nc_2221: bitstring;
                                                            {1802}let gNc_2222: bitstring = exp(g,Nc_2221) in
                                                            {1803}let m1_2223: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2222) in
                                                            {1804}out(c, (pkCli_1746,m1_2223));
                                                            {1805}in(c, em2_2224: bitstring);
                                                            {1806}let m2_2225: bitstring = em2_2224 in
                                                            {1807}let (=OpenSecureChannelResponse,PartS_2226: bitstring,ST_2227: bitstring,TTL_2228: bitstring) = m2_2225 in
                                                            {1808}let Kcli_2229: bitstring = exp(PartS_2226,Nc_2221) in
                                                            {1809}out(c, senc(mCli(pkCli_1746,pkSess_2218),Kcli_2229))
                                                        )
                                                        else
                                                            {1810}let pkSess_2230: bitstring = pub(sk(Sess)) in
                                                            {1811}out(c, GetEndpointRequest);
                                                            {1812}in(c, (=GetEndpointResponse,=pkSess_2230,=None,SP_2231: bitstring,UP_2232: bitstring));
                                                            {1813}new Nc_2233: bitstring;
                                                            {1814}let gNc_2234: bitstring = exp(g,Nc_2233) in
                                                            {1815}let m1_2235: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2234) in
                                                            {1816}out(c, (pkCli_1746,m1_2235));
                                                            {1817}in(c, em2_2236: bitstring);
                                                            {1818}let m2_2237: bitstring = em2_2236 in
                                                            {1819}let (=OpenSecureChannelResponse,PartS_2238: bitstring,ST_2239: bitstring,TTL_2240: bitstring) = m2_2237 in
                                                            {1820}let Kcli_2241: bitstring = exp(PartS_2238,Nc_2233) in
                                                            {1821}out(c, senc(mCli(pkCli_1746,pkSess_2230),Kcli_2241))
                                                    )
                                                    else
                                                        {1822}let pkSess_2242: bitstring = fail-any in
                                                        {1823}out(c, GetEndpointRequest);
                                                        {1824}in(c, (=GetEndpointResponse,=pkSess_2242,=None,SP_2243: bitstring,UP_2244: bitstring));
                                                        {1825}new Nc_2245: bitstring;
                                                        {1826}let gNc_2246: bitstring = exp(g,Nc_2245) in
                                                        {1827}let m1_2247: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2246) in
                                                        {1828}out(c, (pkCli_1746,m1_2247));
                                                        {1829}in(c, em2_2248: bitstring);
                                                        {1830}let m2_2249: bitstring = em2_2248 in
                                                        {1831}let (=OpenSecureChannelResponse,PartS_2250: bitstring,ST_2251: bitstring,TTL_2252: bitstring) = m2_2249 in
                                                        {1832}let Kcli_2253: bitstring = exp(PartS_2250,Nc_2245) in
                                                        {1833}out(c, senc(mCli(pkCli_1746,pkSess_2242),Kcli_2253))
                                            )
                                            else
                                                {1834}let pkSess_2254: bitstring = fail-any in
                                                {1835}out(c, GetEndpointRequest);
                                                {1836}in(c, (=GetEndpointResponse,=pkSess_2254,=None,SP_2255: bitstring,UP_2256: bitstring));
                                                {1837}new Nc_2257: bitstring;
                                                {1838}let gNc_2258: bitstring = exp(g,Nc_2257) in
                                                {1839}let m1_2259: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2258) in
                                                {1840}out(c, (pkCli_1746,m1_2259));
                                                {1841}in(c, em2_2260: bitstring);
                                                {1842}let m2_2261: bitstring = em2_2260 in
                                                {1843}let (=OpenSecureChannelResponse,PartS_2262: bitstring,ST_2263: bitstring,TTL_2264: bitstring) = m2_2261 in
                                                {1844}let Kcli_2265: bitstring = exp(PartS_2262,Nc_2257) in
                                                {1845}out(c, senc(mCli(pkCli_1746,pkSess_2254),Kcli_2265))
                                    )
                                    else
                                        {1846}let pkSess_2266: bitstring = fail-any in
                                        {1847}out(c, GetEndpointRequest);
                                        {1848}in(c, (=GetEndpointResponse,=pkSess_2266,=None,SP_2267: bitstring,UP_2268: bitstring));
                                        {1849}new Nc_2269: bitstring;
                                        {1850}let gNc_2270: bitstring = exp(g,Nc_2269) in
                                        {1851}let m1_2271: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2270) in
                                        {1852}out(c, (pkCli_1746,m1_2271));
                                        {1853}in(c, em2_2272: bitstring);
                                        {1854}let m2_2273: bitstring = em2_2272 in
                                        {1855}let (=OpenSecureChannelResponse,PartS_2274: bitstring,ST_2275: bitstring,TTL_2276: bitstring) = m2_2273 in
                                        {1856}let Kcli_2277: bitstring = exp(PartS_2274,Nc_2269) in
                                        {1857}out(c, senc(mCli(pkCli_1746,pkSess_2266),Kcli_2277))
                        )
                        else
                            {1858}let pkDisco_2278: bitstring = fail-any in
                            {1859}let v_2279: bool = (Sess = A) in
                            (
                                {1860}if v_2279 then
                                (
                                    {1861}let pkSess_2280: bitstring = pub(skA) in
                                    {1862}out(c, GetEndpointRequest);
                                    {1863}in(c, (=GetEndpointResponse,=pkSess_2280,=None,SP_2281: bitstring,UP_2282: bitstring));
                                    {1864}new Nc_2283: bitstring;
                                    {1865}let gNc_2284: bitstring = exp(g,Nc_2283) in
                                    {1866}let m1_2285: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2284) in
                                    {1867}out(c, (pkCli_1746,m1_2285));
                                    {1868}in(c, em2_2286: bitstring);
                                    {1869}let m2_2287: bitstring = em2_2286 in
                                    {1870}let (=OpenSecureChannelResponse,PartS_2288: bitstring,ST_2289: bitstring,TTL_2290: bitstring) = m2_2287 in
                                    {1871}let Kcli_2291: bitstring = exp(PartS_2288,Nc_2283) in
                                    {1872}out(c, senc(mCli(pkCli_1746,pkSess_2280),Kcli_2291))
                                )
                                else
                                    {1873}let v_2292: bool = (Sess = B) in
                                    (
                                        {1874}if v_2292 then
                                        (
                                            {1875}let pkSess_2293: bitstring = pub(skB) in
                                            {1876}out(c, GetEndpointRequest);
                                            {1877}in(c, (=GetEndpointResponse,=pkSess_2293,=None,SP_2294: bitstring,UP_2295: bitstring));
                                            {1878}new Nc_2296: bitstring;
                                            {1879}let gNc_2297: bitstring = exp(g,Nc_2296) in
                                            {1880}let m1_2298: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2297) in
                                            {1881}out(c, (pkCli_1746,m1_2298));
                                            {1882}in(c, em2_2299: bitstring);
                                            {1883}let m2_2300: bitstring = em2_2299 in
                                            {1884}let (=OpenSecureChannelResponse,PartS_2301: bitstring,ST_2302: bitstring,TTL_2303: bitstring) = m2_2300 in
                                            {1885}let Kcli_2304: bitstring = exp(PartS_2301,Nc_2296) in
                                            {1886}out(c, senc(mCli(pkCli_1746,pkSess_2293),Kcli_2304))
                                        )
                                        else
                                            {1887}let v_2305: bool = (Sess = C) in
                                            (
                                                {1888}if v_2305 then
                                                (
                                                    {1889}let pkSess_2306: bitstring = pub(skC) in
                                                    {1890}out(c, GetEndpointRequest);
                                                    {1891}in(c, (=GetEndpointResponse,=pkSess_2306,=None,SP_2307: bitstring,UP_2308: bitstring));
                                                    {1892}new Nc_2309: bitstring;
                                                    {1893}let gNc_2310: bitstring = exp(g,Nc_2309) in
                                                    {1894}let m1_2311: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2310) in
                                                    {1895}out(c, (pkCli_1746,m1_2311));
                                                    {1896}in(c, em2_2312: bitstring);
                                                    {1897}let m2_2313: bitstring = em2_2312 in
                                                    {1898}let (=OpenSecureChannelResponse,PartS_2314: bitstring,ST_2315: bitstring,TTL_2316: bitstring) = m2_2313 in
                                                    {1899}let Kcli_2317: bitstring = exp(PartS_2314,Nc_2309) in
                                                    {1900}out(c, senc(mCli(pkCli_1746,pkSess_2306),Kcli_2317))
                                                )
                                                else
                                                    {1901}let pkSess_2318: bitstring = pub(sk(Sess)) in
                                                    {1902}out(c, GetEndpointRequest);
                                                    {1903}in(c, (=GetEndpointResponse,=pkSess_2318,=None,SP_2319: bitstring,UP_2320: bitstring));
                                                    {1904}new Nc_2321: bitstring;
                                                    {1905}let gNc_2322: bitstring = exp(g,Nc_2321) in
                                                    {1906}let m1_2323: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2322) in
                                                    {1907}out(c, (pkCli_1746,m1_2323));
                                                    {1908}in(c, em2_2324: bitstring);
                                                    {1909}let m2_2325: bitstring = em2_2324 in
                                                    {1910}let (=OpenSecureChannelResponse,PartS_2326: bitstring,ST_2327: bitstring,TTL_2328: bitstring) = m2_2325 in
                                                    {1911}let Kcli_2329: bitstring = exp(PartS_2326,Nc_2321) in
                                                    {1912}out(c, senc(mCli(pkCli_1746,pkSess_2318),Kcli_2329))
                                            )
                                            else
                                                {1913}let pkSess_2330: bitstring = fail-any in
                                                {1914}out(c, GetEndpointRequest);
                                                {1915}in(c, (=GetEndpointResponse,=pkSess_2330,=None,SP_2331: bitstring,UP_2332: bitstring));
                                                {1916}new Nc_2333: bitstring;
                                                {1917}let gNc_2334: bitstring = exp(g,Nc_2333) in
                                                {1918}let m1_2335: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2334) in
                                                {1919}out(c, (pkCli_1746,m1_2335));
                                                {1920}in(c, em2_2336: bitstring);
                                                {1921}let m2_2337: bitstring = em2_2336 in
                                                {1922}let (=OpenSecureChannelResponse,PartS_2338: bitstring,ST_2339: bitstring,TTL_2340: bitstring) = m2_2337 in
                                                {1923}let Kcli_2341: bitstring = exp(PartS_2338,Nc_2333) in
                                                {1924}out(c, senc(mCli(pkCli_1746,pkSess_2330),Kcli_2341))
                                    )
                                    else
                                        {1925}let pkSess_2342: bitstring = fail-any in
                                        {1926}out(c, GetEndpointRequest);
                                        {1927}in(c, (=GetEndpointResponse,=pkSess_2342,=None,SP_2343: bitstring,UP_2344: bitstring));
                                        {1928}new Nc_2345: bitstring;
                                        {1929}let gNc_2346: bitstring = exp(g,Nc_2345) in
                                        {1930}let m1_2347: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2346) in
                                        {1931}out(c, (pkCli_1746,m1_2347));
                                        {1932}in(c, em2_2348: bitstring);
                                        {1933}let m2_2349: bitstring = em2_2348 in
                                        {1934}let (=OpenSecureChannelResponse,PartS_2350: bitstring,ST_2351: bitstring,TTL_2352: bitstring) = m2_2349 in
                                        {1935}let Kcli_2353: bitstring = exp(PartS_2350,Nc_2345) in
                                        {1936}out(c, senc(mCli(pkCli_1746,pkSess_2342),Kcli_2353))
                            )
                            else
                                {1937}let pkSess_2354: bitstring = fail-any in
                                {1938}out(c, GetEndpointRequest);
                                {1939}in(c, (=GetEndpointResponse,=pkSess_2354,=None,SP_2355: bitstring,UP_2356: bitstring));
                                {1940}new Nc_2357: bitstring;
                                {1941}let gNc_2358: bitstring = exp(g,Nc_2357) in
                                {1942}let m1_2359: bitstring = (OpenSecureChannelRequest,pkCli_1746,gNc_2358) in
                                {1943}out(c, (pkCli_1746,m1_2359));
                                {1944}in(c, em2_2360: bitstring);
                                {1945}let m2_2361: bitstring = em2_2360 in
                                {1946}let (=OpenSecureChannelResponse,PartS_2362: bitstring,ST_2363: bitstring,TTL_2364: bitstring) = m2_2361 in
                                {1947}let Kcli_2365: bitstring = exp(PartS_2362,Nc_2357) in
                                {1948}out(c, senc(mCli(pkCli_1746,pkSess_2354),Kcli_2365))
                    )
                    else
                        {1949}let skCli_2366: bitstring = fail-any in
                        {1950}let pkCli_2367: bitstring = pub(skCli_2366) in
                        {1951}let v_2368: bool = (Disco = A) in
                        (
                            {1952}if v_2368 then
                            (
                                {1953}let pkDisco_2369: bitstring = pub(skA) in
                                {1954}let v_2370: bool = (Sess = A) in
                                (
                                    {1955}if v_2370 then
                                    (
                                        {1956}let pkSess_2371: bitstring = pub(skA) in
                                        {1957}out(c, GetEndpointRequest);
                                        {1958}in(c, (=GetEndpointResponse,=pkSess_2371,=None,SP_2372: bitstring,UP_2373: bitstring));
                                        {1959}new Nc_2374: bitstring;
                                        {1960}let gNc_2375: bitstring = exp(g,Nc_2374) in
                                        {1961}let m1_2376: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2375) in
                                        {1962}out(c, (pkCli_2367,m1_2376));
                                        {1963}in(c, em2_2377: bitstring);
                                        {1964}let m2_2378: bitstring = em2_2377 in
                                        {1965}let (=OpenSecureChannelResponse,PartS_2379: bitstring,ST_2380: bitstring,TTL_2381: bitstring) = m2_2378 in
                                        {1966}let Kcli_2382: bitstring = exp(PartS_2379,Nc_2374) in
                                        {1967}out(c, senc(mCli(pkCli_2367,pkSess_2371),Kcli_2382))
                                    )
                                    else
                                        {1968}let v_2383: bool = (Sess = B) in
                                        (
                                            {1969}if v_2383 then
                                            (
                                                {1970}let pkSess_2384: bitstring = pub(skB) in
                                                {1971}out(c, GetEndpointRequest);
                                                {1972}in(c, (=GetEndpointResponse,=pkSess_2384,=None,SP_2385: bitstring,UP_2386: bitstring));
                                                {1973}new Nc_2387: bitstring;
                                                {1974}let gNc_2388: bitstring = exp(g,Nc_2387) in
                                                {1975}let m1_2389: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2388) in
                                                {1976}out(c, (pkCli_2367,m1_2389));
                                                {1977}in(c, em2_2390: bitstring);
                                                {1978}let m2_2391: bitstring = em2_2390 in
                                                {1979}let (=OpenSecureChannelResponse,PartS_2392: bitstring,ST_2393: bitstring,TTL_2394: bitstring) = m2_2391 in
                                                {1980}let Kcli_2395: bitstring = exp(PartS_2392,Nc_2387) in
                                                {1981}out(c, senc(mCli(pkCli_2367,pkSess_2384),Kcli_2395))
                                            )
                                            else
                                                {1982}let v_2396: bool = (Sess = C) in
                                                (
                                                    {1983}if v_2396 then
                                                    (
                                                        {1984}let pkSess_2397: bitstring = pub(skC) in
                                                        {1985}out(c, GetEndpointRequest);
                                                        {1986}in(c, (=GetEndpointResponse,=pkSess_2397,=None,SP_2398: bitstring,UP_2399: bitstring));
                                                        {1987}new Nc_2400: bitstring;
                                                        {1988}let gNc_2401: bitstring = exp(g,Nc_2400) in
                                                        {1989}let m1_2402: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2401) in
                                                        {1990}out(c, (pkCli_2367,m1_2402));
                                                        {1991}in(c, em2_2403: bitstring);
                                                        {1992}let m2_2404: bitstring = em2_2403 in
                                                        {1993}let (=OpenSecureChannelResponse,PartS_2405: bitstring,ST_2406: bitstring,TTL_2407: bitstring) = m2_2404 in
                                                        {1994}let Kcli_2408: bitstring = exp(PartS_2405,Nc_2400) in
                                                        {1995}out(c, senc(mCli(pkCli_2367,pkSess_2397),Kcli_2408))
                                                    )
                                                    else
                                                        {1996}let pkSess_2409: bitstring = pub(sk(Sess)) in
                                                        {1997}out(c, GetEndpointRequest);
                                                        {1998}in(c, (=GetEndpointResponse,=pkSess_2409,=None,SP_2410: bitstring,UP_2411: bitstring));
                                                        {1999}new Nc_2412: bitstring;
                                                        {2000}let gNc_2413: bitstring = exp(g,Nc_2412) in
                                                        {2001}let m1_2414: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2413) in
                                                        {2002}out(c, (pkCli_2367,m1_2414));
                                                        {2003}in(c, em2_2415: bitstring);
                                                        {2004}let m2_2416: bitstring = em2_2415 in
                                                        {2005}let (=OpenSecureChannelResponse,PartS_2417: bitstring,ST_2418: bitstring,TTL_2419: bitstring) = m2_2416 in
                                                        {2006}let Kcli_2420: bitstring = exp(PartS_2417,Nc_2412) in
                                                        {2007}out(c, senc(mCli(pkCli_2367,pkSess_2409),Kcli_2420))
                                                )
                                                else
                                                    {2008}let pkSess_2421: bitstring = fail-any in
                                                    {2009}out(c, GetEndpointRequest);
                                                    {2010}in(c, (=GetEndpointResponse,=pkSess_2421,=None,SP_2422: bitstring,UP_2423: bitstring));
                                                    {2011}new Nc_2424: bitstring;
                                                    {2012}let gNc_2425: bitstring = exp(g,Nc_2424) in
                                                    {2013}let m1_2426: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2425) in
                                                    {2014}out(c, (pkCli_2367,m1_2426));
                                                    {2015}in(c, em2_2427: bitstring);
                                                    {2016}let m2_2428: bitstring = em2_2427 in
                                                    {2017}let (=OpenSecureChannelResponse,PartS_2429: bitstring,ST_2430: bitstring,TTL_2431: bitstring) = m2_2428 in
                                                    {2018}let Kcli_2432: bitstring = exp(PartS_2429,Nc_2424) in
                                                    {2019}out(c, senc(mCli(pkCli_2367,pkSess_2421),Kcli_2432))
                                        )
                                        else
                                            {2020}let pkSess_2433: bitstring = fail-any in
                                            {2021}out(c, GetEndpointRequest);
                                            {2022}in(c, (=GetEndpointResponse,=pkSess_2433,=None,SP_2434: bitstring,UP_2435: bitstring));
                                            {2023}new Nc_2436: bitstring;
                                            {2024}let gNc_2437: bitstring = exp(g,Nc_2436) in
                                            {2025}let m1_2438: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2437) in
                                            {2026}out(c, (pkCli_2367,m1_2438));
                                            {2027}in(c, em2_2439: bitstring);
                                            {2028}let m2_2440: bitstring = em2_2439 in
                                            {2029}let (=OpenSecureChannelResponse,PartS_2441: bitstring,ST_2442: bitstring,TTL_2443: bitstring) = m2_2440 in
                                            {2030}let Kcli_2444: bitstring = exp(PartS_2441,Nc_2436) in
                                            {2031}out(c, senc(mCli(pkCli_2367,pkSess_2433),Kcli_2444))
                                )
                                else
                                    {2032}let pkSess_2445: bitstring = fail-any in
                                    {2033}out(c, GetEndpointRequest);
                                    {2034}in(c, (=GetEndpointResponse,=pkSess_2445,=None,SP_2446: bitstring,UP_2447: bitstring));
                                    {2035}new Nc_2448: bitstring;
                                    {2036}let gNc_2449: bitstring = exp(g,Nc_2448) in
                                    {2037}let m1_2450: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2449) in
                                    {2038}out(c, (pkCli_2367,m1_2450));
                                    {2039}in(c, em2_2451: bitstring);
                                    {2040}let m2_2452: bitstring = em2_2451 in
                                    {2041}let (=OpenSecureChannelResponse,PartS_2453: bitstring,ST_2454: bitstring,TTL_2455: bitstring) = m2_2452 in
                                    {2042}let Kcli_2456: bitstring = exp(PartS_2453,Nc_2448) in
                                    {2043}out(c, senc(mCli(pkCli_2367,pkSess_2445),Kcli_2456))
                            )
                            else
                                {2044}let v_2457: bool = (Disco = B) in
                                (
                                    {2045}if v_2457 then
                                    (
                                        {2046}let pkDisco_2458: bitstring = pub(skB) in
                                        {2047}let v_2459: bool = (Sess = A) in
                                        (
                                            {2048}if v_2459 then
                                            (
                                                {2049}let pkSess_2460: bitstring = pub(skA) in
                                                {2050}out(c, GetEndpointRequest);
                                                {2051}in(c, (=GetEndpointResponse,=pkSess_2460,=None,SP_2461: bitstring,UP_2462: bitstring));
                                                {2052}new Nc_2463: bitstring;
                                                {2053}let gNc_2464: bitstring = exp(g,Nc_2463) in
                                                {2054}let m1_2465: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2464) in
                                                {2055}out(c, (pkCli_2367,m1_2465));
                                                {2056}in(c, em2_2466: bitstring);
                                                {2057}let m2_2467: bitstring = em2_2466 in
                                                {2058}let (=OpenSecureChannelResponse,PartS_2468: bitstring,ST_2469: bitstring,TTL_2470: bitstring) = m2_2467 in
                                                {2059}let Kcli_2471: bitstring = exp(PartS_2468,Nc_2463) in
                                                {2060}out(c, senc(mCli(pkCli_2367,pkSess_2460),Kcli_2471))
                                            )
                                            else
                                                {2061}let v_2472: bool = (Sess = B) in
                                                (
                                                    {2062}if v_2472 then
                                                    (
                                                        {2063}let pkSess_2473: bitstring = pub(skB) in
                                                        {2064}out(c, GetEndpointRequest);
                                                        {2065}in(c, (=GetEndpointResponse,=pkSess_2473,=None,SP_2474: bitstring,UP_2475: bitstring));
                                                        {2066}new Nc_2476: bitstring;
                                                        {2067}let gNc_2477: bitstring = exp(g,Nc_2476) in
                                                        {2068}let m1_2478: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2477) in
                                                        {2069}out(c, (pkCli_2367,m1_2478));
                                                        {2070}in(c, em2_2479: bitstring);
                                                        {2071}let m2_2480: bitstring = em2_2479 in
                                                        {2072}let (=OpenSecureChannelResponse,PartS_2481: bitstring,ST_2482: bitstring,TTL_2483: bitstring) = m2_2480 in
                                                        {2073}let Kcli_2484: bitstring = exp(PartS_2481,Nc_2476) in
                                                        {2074}out(c, senc(mCli(pkCli_2367,pkSess_2473),Kcli_2484))
                                                    )
                                                    else
                                                        {2075}let v_2485: bool = (Sess = C) in
                                                        (
                                                            {2076}if v_2485 then
                                                            (
                                                                {2077}let pkSess_2486: bitstring = pub(skC) in
                                                                {2078}out(c, GetEndpointRequest);
                                                                {2079}in(c, (=GetEndpointResponse,=pkSess_2486,=None,SP_2487: bitstring,UP_2488: bitstring));
                                                                {2080}new Nc_2489: bitstring;
                                                                {2081}let gNc_2490: bitstring = exp(g,Nc_2489) in
                                                                {2082}let m1_2491: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2490) in
                                                                {2083}out(c, (pkCli_2367,m1_2491));
                                                                {2084}in(c, em2_2492: bitstring);
                                                                {2085}let m2_2493: bitstring = em2_2492 in
                                                                {2086}let (=OpenSecureChannelResponse,PartS_2494: bitstring,ST_2495: bitstring,TTL_2496: bitstring) = m2_2493 in
                                                                {2087}let Kcli_2497: bitstring = exp(PartS_2494,Nc_2489) in
                                                                {2088}out(c, senc(mCli(pkCli_2367,pkSess_2486),Kcli_2497))
                                                            )
                                                            else
                                                                {2089}let pkSess_2498: bitstring = pub(sk(Sess)) in
                                                                {2090}out(c, GetEndpointRequest);
                                                                {2091}in(c, (=GetEndpointResponse,=pkSess_2498,=None,SP_2499: bitstring,UP_2500: bitstring));
                                                                {2092}new Nc_2501: bitstring;
                                                                {2093}let gNc_2502: bitstring = exp(g,Nc_2501) in
                                                                {2094}let m1_2503: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2502) in
                                                                {2095}out(c, (pkCli_2367,m1_2503));
                                                                {2096}in(c, em2_2504: bitstring);
                                                                {2097}let m2_2505: bitstring = em2_2504 in
                                                                {2098}let (=OpenSecureChannelResponse,PartS_2506: bitstring,ST_2507: bitstring,TTL_2508: bitstring) = m2_2505 in
                                                                {2099}let Kcli_2509: bitstring = exp(PartS_2506,Nc_2501) in
                                                                {2100}out(c, senc(mCli(pkCli_2367,pkSess_2498),Kcli_2509))
                                                        )
                                                        else
                                                            {2101}let pkSess_2510: bitstring = fail-any in
                                                            {2102}out(c, GetEndpointRequest);
                                                            {2103}in(c, (=GetEndpointResponse,=pkSess_2510,=None,SP_2511: bitstring,UP_2512: bitstring));
                                                            {2104}new Nc_2513: bitstring;
                                                            {2105}let gNc_2514: bitstring = exp(g,Nc_2513) in
                                                            {2106}let m1_2515: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2514) in
                                                            {2107}out(c, (pkCli_2367,m1_2515));
                                                            {2108}in(c, em2_2516: bitstring);
                                                            {2109}let m2_2517: bitstring = em2_2516 in
                                                            {2110}let (=OpenSecureChannelResponse,PartS_2518: bitstring,ST_2519: bitstring,TTL_2520: bitstring) = m2_2517 in
                                                            {2111}let Kcli_2521: bitstring = exp(PartS_2518,Nc_2513) in
                                                            {2112}out(c, senc(mCli(pkCli_2367,pkSess_2510),Kcli_2521))
                                                )
                                                else
                                                    {2113}let pkSess_2522: bitstring = fail-any in
                                                    {2114}out(c, GetEndpointRequest);
                                                    {2115}in(c, (=GetEndpointResponse,=pkSess_2522,=None,SP_2523: bitstring,UP_2524: bitstring));
                                                    {2116}new Nc_2525: bitstring;
                                                    {2117}let gNc_2526: bitstring = exp(g,Nc_2525) in
                                                    {2118}let m1_2527: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2526) in
                                                    {2119}out(c, (pkCli_2367,m1_2527));
                                                    {2120}in(c, em2_2528: bitstring);
                                                    {2121}let m2_2529: bitstring = em2_2528 in
                                                    {2122}let (=OpenSecureChannelResponse,PartS_2530: bitstring,ST_2531: bitstring,TTL_2532: bitstring) = m2_2529 in
                                                    {2123}let Kcli_2533: bitstring = exp(PartS_2530,Nc_2525) in
                                                    {2124}out(c, senc(mCli(pkCli_2367,pkSess_2522),Kcli_2533))
                                        )
                                        else
                                            {2125}let pkSess_2534: bitstring = fail-any in
                                            {2126}out(c, GetEndpointRequest);
                                            {2127}in(c, (=GetEndpointResponse,=pkSess_2534,=None,SP_2535: bitstring,UP_2536: bitstring));
                                            {2128}new Nc_2537: bitstring;
                                            {2129}let gNc_2538: bitstring = exp(g,Nc_2537) in
                                            {2130}let m1_2539: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2538) in
                                            {2131}out(c, (pkCli_2367,m1_2539));
                                            {2132}in(c, em2_2540: bitstring);
                                            {2133}let m2_2541: bitstring = em2_2540 in
                                            {2134}let (=OpenSecureChannelResponse,PartS_2542: bitstring,ST_2543: bitstring,TTL_2544: bitstring) = m2_2541 in
                                            {2135}let Kcli_2545: bitstring = exp(PartS_2542,Nc_2537) in
                                            {2136}out(c, senc(mCli(pkCli_2367,pkSess_2534),Kcli_2545))
                                    )
                                    else
                                        {2137}let v_2546: bool = (Disco = C) in
                                        (
                                            {2138}if v_2546 then
                                            (
                                                {2139}let pkDisco_2547: bitstring = pub(skC) in
                                                {2140}let v_2548: bool = (Sess = A) in
                                                (
                                                    {2141}if v_2548 then
                                                    (
                                                        {2142}let pkSess_2549: bitstring = pub(skA) in
                                                        {2143}out(c, GetEndpointRequest);
                                                        {2144}in(c, (=GetEndpointResponse,=pkSess_2549,=None,SP_2550: bitstring,UP_2551: bitstring));
                                                        {2145}new Nc_2552: bitstring;
                                                        {2146}let gNc_2553: bitstring = exp(g,Nc_2552) in
                                                        {2147}let m1_2554: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2553) in
                                                        {2148}out(c, (pkCli_2367,m1_2554));
                                                        {2149}in(c, em2_2555: bitstring);
                                                        {2150}let m2_2556: bitstring = em2_2555 in
                                                        {2151}let (=OpenSecureChannelResponse,PartS_2557: bitstring,ST_2558: bitstring,TTL_2559: bitstring) = m2_2556 in
                                                        {2152}let Kcli_2560: bitstring = exp(PartS_2557,Nc_2552) in
                                                        {2153}out(c, senc(mCli(pkCli_2367,pkSess_2549),Kcli_2560))
                                                    )
                                                    else
                                                        {2154}let v_2561: bool = (Sess = B) in
                                                        (
                                                            {2155}if v_2561 then
                                                            (
                                                                {2156}let pkSess_2562: bitstring = pub(skB) in
                                                                {2157}out(c, GetEndpointRequest);
                                                                {2158}in(c, (=GetEndpointResponse,=pkSess_2562,=None,SP_2563: bitstring,UP_2564: bitstring));
                                                                {2159}new Nc_2565: bitstring;
                                                                {2160}let gNc_2566: bitstring = exp(g,Nc_2565) in
                                                                {2161}let m1_2567: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2566) in
                                                                {2162}out(c, (pkCli_2367,m1_2567));
                                                                {2163}in(c, em2_2568: bitstring);
                                                                {2164}let m2_2569: bitstring = em2_2568 in
                                                                {2165}let (=OpenSecureChannelResponse,PartS_2570: bitstring,ST_2571: bitstring,TTL_2572: bitstring) = m2_2569 in
                                                                {2166}let Kcli_2573: bitstring = exp(PartS_2570,Nc_2565) in
                                                                {2167}out(c, senc(mCli(pkCli_2367,pkSess_2562),Kcli_2573))
                                                            )
                                                            else
                                                                {2168}let v_2574: bool = (Sess = C) in
                                                                (
                                                                    {2169}if v_2574 then
                                                                    (
                                                                        {2170}let pkSess_2575: bitstring = pub(skC) in
                                                                        {2171}out(c, GetEndpointRequest);
                                                                        {2172}in(c, (=GetEndpointResponse,=pkSess_2575,=None,SP_2576: bitstring,UP_2577: bitstring));
                                                                        {2173}new Nc_2578: bitstring;
                                                                        {2174}let gNc_2579: bitstring = exp(g,Nc_2578) in
                                                                        {2175}let m1_2580: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2579) in
                                                                        {2176}out(c, (pkCli_2367,m1_2580));
                                                                        {2177}in(c, em2_2581: bitstring);
                                                                        {2178}let m2_2582: bitstring = em2_2581 in
                                                                        {2179}let (=OpenSecureChannelResponse,PartS_2583: bitstring,ST_2584: bitstring,TTL_2585: bitstring) = m2_2582 in
                                                                        {2180}let Kcli_2586: bitstring = exp(PartS_2583,Nc_2578) in
                                                                        {2181}out(c, senc(mCli(pkCli_2367,pkSess_2575),Kcli_2586))
                                                                    )
                                                                    else
                                                                        {2182}let pkSess_2587: bitstring = pub(sk(Sess)) in
                                                                        {2183}out(c, GetEndpointRequest);
                                                                        {2184}in(c, (=GetEndpointResponse,=pkSess_2587,=None,SP_2588: bitstring,UP_2589: bitstring));
                                                                        {2185}new Nc_2590: bitstring;
                                                                        {2186}let gNc_2591: bitstring = exp(g,Nc_2590) in
                                                                        {2187}let m1_2592: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2591) in
                                                                        {2188}out(c, (pkCli_2367,m1_2592));
                                                                        {2189}in(c, em2_2593: bitstring);
                                                                        {2190}let m2_2594: bitstring = em2_2593 in
                                                                        {2191}let (=OpenSecureChannelResponse,PartS_2595: bitstring,ST_2596: bitstring,TTL_2597: bitstring) = m2_2594 in
                                                                        {2192}let Kcli_2598: bitstring = exp(PartS_2595,Nc_2590) in
                                                                        {2193}out(c, senc(mCli(pkCli_2367,pkSess_2587),Kcli_2598))
                                                                )
                                                                else
                                                                    {2194}let pkSess_2599: bitstring = fail-any in
                                                                    {2195}out(c, GetEndpointRequest);
                                                                    {2196}in(c, (=GetEndpointResponse,=pkSess_2599,=None,SP_2600: bitstring,UP_2601: bitstring));
                                                                    {2197}new Nc_2602: bitstring;
                                                                    {2198}let gNc_2603: bitstring = exp(g,Nc_2602) in
                                                                    {2199}let m1_2604: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2603) in
                                                                    {2200}out(c, (pkCli_2367,m1_2604));
                                                                    {2201}in(c, em2_2605: bitstring);
                                                                    {2202}let m2_2606: bitstring = em2_2605 in
                                                                    {2203}let (=OpenSecureChannelResponse,PartS_2607: bitstring,ST_2608: bitstring,TTL_2609: bitstring) = m2_2606 in
                                                                    {2204}let Kcli_2610: bitstring = exp(PartS_2607,Nc_2602) in
                                                                    {2205}out(c, senc(mCli(pkCli_2367,pkSess_2599),Kcli_2610))
                                                        )
                                                        else
                                                            {2206}let pkSess_2611: bitstring = fail-any in
                                                            {2207}out(c, GetEndpointRequest);
                                                            {2208}in(c, (=GetEndpointResponse,=pkSess_2611,=None,SP_2612: bitstring,UP_2613: bitstring));
                                                            {2209}new Nc_2614: bitstring;
                                                            {2210}let gNc_2615: bitstring = exp(g,Nc_2614) in
                                                            {2211}let m1_2616: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2615) in
                                                            {2212}out(c, (pkCli_2367,m1_2616));
                                                            {2213}in(c, em2_2617: bitstring);
                                                            {2214}let m2_2618: bitstring = em2_2617 in
                                                            {2215}let (=OpenSecureChannelResponse,PartS_2619: bitstring,ST_2620: bitstring,TTL_2621: bitstring) = m2_2618 in
                                                            {2216}let Kcli_2622: bitstring = exp(PartS_2619,Nc_2614) in
                                                            {2217}out(c, senc(mCli(pkCli_2367,pkSess_2611),Kcli_2622))
                                                )
                                                else
                                                    {2218}let pkSess_2623: bitstring = fail-any in
                                                    {2219}out(c, GetEndpointRequest);
                                                    {2220}in(c, (=GetEndpointResponse,=pkSess_2623,=None,SP_2624: bitstring,UP_2625: bitstring));
                                                    {2221}new Nc_2626: bitstring;
                                                    {2222}let gNc_2627: bitstring = exp(g,Nc_2626) in
                                                    {2223}let m1_2628: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2627) in
                                                    {2224}out(c, (pkCli_2367,m1_2628));
                                                    {2225}in(c, em2_2629: bitstring);
                                                    {2226}let m2_2630: bitstring = em2_2629 in
                                                    {2227}let (=OpenSecureChannelResponse,PartS_2631: bitstring,ST_2632: bitstring,TTL_2633: bitstring) = m2_2630 in
                                                    {2228}let Kcli_2634: bitstring = exp(PartS_2631,Nc_2626) in
                                                    {2229}out(c, senc(mCli(pkCli_2367,pkSess_2623),Kcli_2634))
                                            )
                                            else
                                                {2230}let pkDisco_2635: bitstring = pub(sk(Disco)) in
                                                {2231}let v_2636: bool = (Sess = A) in
                                                (
                                                    {2232}if v_2636 then
                                                    (
                                                        {2233}let pkSess_2637: bitstring = pub(skA) in
                                                        {2234}out(c, GetEndpointRequest);
                                                        {2235}in(c, (=GetEndpointResponse,=pkSess_2637,=None,SP_2638: bitstring,UP_2639: bitstring));
                                                        {2236}new Nc_2640: bitstring;
                                                        {2237}let gNc_2641: bitstring = exp(g,Nc_2640) in
                                                        {2238}let m1_2642: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2641) in
                                                        {2239}out(c, (pkCli_2367,m1_2642));
                                                        {2240}in(c, em2_2643: bitstring);
                                                        {2241}let m2_2644: bitstring = em2_2643 in
                                                        {2242}let (=OpenSecureChannelResponse,PartS_2645: bitstring,ST_2646: bitstring,TTL_2647: bitstring) = m2_2644 in
                                                        {2243}let Kcli_2648: bitstring = exp(PartS_2645,Nc_2640) in
                                                        {2244}out(c, senc(mCli(pkCli_2367,pkSess_2637),Kcli_2648))
                                                    )
                                                    else
                                                        {2245}let v_2649: bool = (Sess = B) in
                                                        (
                                                            {2246}if v_2649 then
                                                            (
                                                                {2247}let pkSess_2650: bitstring = pub(skB) in
                                                                {2248}out(c, GetEndpointRequest);
                                                                {2249}in(c, (=GetEndpointResponse,=pkSess_2650,=None,SP_2651: bitstring,UP_2652: bitstring));
                                                                {2250}new Nc_2653: bitstring;
                                                                {2251}let gNc_2654: bitstring = exp(g,Nc_2653) in
                                                                {2252}let m1_2655: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2654) in
                                                                {2253}out(c, (pkCli_2367,m1_2655));
                                                                {2254}in(c, em2_2656: bitstring);
                                                                {2255}let m2_2657: bitstring = em2_2656 in
                                                                {2256}let (=OpenSecureChannelResponse,PartS_2658: bitstring,ST_2659: bitstring,TTL_2660: bitstring) = m2_2657 in
                                                                {2257}let Kcli_2661: bitstring = exp(PartS_2658,Nc_2653) in
                                                                {2258}out(c, senc(mCli(pkCli_2367,pkSess_2650),Kcli_2661))
                                                            )
                                                            else
                                                                {2259}let v_2662: bool = (Sess = C) in
                                                                (
                                                                    {2260}if v_2662 then
                                                                    (
                                                                        {2261}let pkSess_2663: bitstring = pub(skC) in
                                                                        {2262}out(c, GetEndpointRequest);
                                                                        {2263}in(c, (=GetEndpointResponse,=pkSess_2663,=None,SP_2664: bitstring,UP_2665: bitstring));
                                                                        {2264}new Nc_2666: bitstring;
                                                                        {2265}let gNc_2667: bitstring = exp(g,Nc_2666) in
                                                                        {2266}let m1_2668: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2667) in
                                                                        {2267}out(c, (pkCli_2367,m1_2668));
                                                                        {2268}in(c, em2_2669: bitstring);
                                                                        {2269}let m2_2670: bitstring = em2_2669 in
                                                                        {2270}let (=OpenSecureChannelResponse,PartS_2671: bitstring,ST_2672: bitstring,TTL_2673: bitstring) = m2_2670 in
                                                                        {2271}let Kcli_2674: bitstring = exp(PartS_2671,Nc_2666) in
                                                                        {2272}out(c, senc(mCli(pkCli_2367,pkSess_2663),Kcli_2674))
                                                                    )
                                                                    else
                                                                        {2273}let pkSess_2675: bitstring = pub(sk(Sess)) in
                                                                        {2274}out(c, GetEndpointRequest);
                                                                        {2275}in(c, (=GetEndpointResponse,=pkSess_2675,=None,SP_2676: bitstring,UP_2677: bitstring));
                                                                        {2276}new Nc_2678: bitstring;
                                                                        {2277}let gNc_2679: bitstring = exp(g,Nc_2678) in
                                                                        {2278}let m1_2680: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2679) in
                                                                        {2279}out(c, (pkCli_2367,m1_2680));
                                                                        {2280}in(c, em2_2681: bitstring);
                                                                        {2281}let m2_2682: bitstring = em2_2681 in
                                                                        {2282}let (=OpenSecureChannelResponse,PartS_2683: bitstring,ST_2684: bitstring,TTL_2685: bitstring) = m2_2682 in
                                                                        {2283}let Kcli_2686: bitstring = exp(PartS_2683,Nc_2678) in
                                                                        {2284}out(c, senc(mCli(pkCli_2367,pkSess_2675),Kcli_2686))
                                                                )
                                                                else
                                                                    {2285}let pkSess_2687: bitstring = fail-any in
                                                                    {2286}out(c, GetEndpointRequest);
                                                                    {2287}in(c, (=GetEndpointResponse,=pkSess_2687,=None,SP_2688: bitstring,UP_2689: bitstring));
                                                                    {2288}new Nc_2690: bitstring;
                                                                    {2289}let gNc_2691: bitstring = exp(g,Nc_2690) in
                                                                    {2290}let m1_2692: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2691) in
                                                                    {2291}out(c, (pkCli_2367,m1_2692));
                                                                    {2292}in(c, em2_2693: bitstring);
                                                                    {2293}let m2_2694: bitstring = em2_2693 in
                                                                    {2294}let (=OpenSecureChannelResponse,PartS_2695: bitstring,ST_2696: bitstring,TTL_2697: bitstring) = m2_2694 in
                                                                    {2295}let Kcli_2698: bitstring = exp(PartS_2695,Nc_2690) in
                                                                    {2296}out(c, senc(mCli(pkCli_2367,pkSess_2687),Kcli_2698))
                                                        )
                                                        else
                                                            {2297}let pkSess_2699: bitstring = fail-any in
                                                            {2298}out(c, GetEndpointRequest);
                                                            {2299}in(c, (=GetEndpointResponse,=pkSess_2699,=None,SP_2700: bitstring,UP_2701: bitstring));
                                                            {2300}new Nc_2702: bitstring;
                                                            {2301}let gNc_2703: bitstring = exp(g,Nc_2702) in
                                                            {2302}let m1_2704: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2703) in
                                                            {2303}out(c, (pkCli_2367,m1_2704));
                                                            {2304}in(c, em2_2705: bitstring);
                                                            {2305}let m2_2706: bitstring = em2_2705 in
                                                            {2306}let (=OpenSecureChannelResponse,PartS_2707: bitstring,ST_2708: bitstring,TTL_2709: bitstring) = m2_2706 in
                                                            {2307}let Kcli_2710: bitstring = exp(PartS_2707,Nc_2702) in
                                                            {2308}out(c, senc(mCli(pkCli_2367,pkSess_2699),Kcli_2710))
                                                )
                                                else
                                                    {2309}let pkSess_2711: bitstring = fail-any in
                                                    {2310}out(c, GetEndpointRequest);
                                                    {2311}in(c, (=GetEndpointResponse,=pkSess_2711,=None,SP_2712: bitstring,UP_2713: bitstring));
                                                    {2312}new Nc_2714: bitstring;
                                                    {2313}let gNc_2715: bitstring = exp(g,Nc_2714) in
                                                    {2314}let m1_2716: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2715) in
                                                    {2315}out(c, (pkCli_2367,m1_2716));
                                                    {2316}in(c, em2_2717: bitstring);
                                                    {2317}let m2_2718: bitstring = em2_2717 in
                                                    {2318}let (=OpenSecureChannelResponse,PartS_2719: bitstring,ST_2720: bitstring,TTL_2721: bitstring) = m2_2718 in
                                                    {2319}let Kcli_2722: bitstring = exp(PartS_2719,Nc_2714) in
                                                    {2320}out(c, senc(mCli(pkCli_2367,pkSess_2711),Kcli_2722))
                                        )
                                        else
                                            {2321}let pkDisco_2723: bitstring = fail-any in
                                            {2322}let v_2724: bool = (Sess = A) in
                                            (
                                                {2323}if v_2724 then
                                                (
                                                    {2324}let pkSess_2725: bitstring = pub(skA) in
                                                    {2325}out(c, GetEndpointRequest);
                                                    {2326}in(c, (=GetEndpointResponse,=pkSess_2725,=None,SP_2726: bitstring,UP_2727: bitstring));
                                                    {2327}new Nc_2728: bitstring;
                                                    {2328}let gNc_2729: bitstring = exp(g,Nc_2728) in
                                                    {2329}let m1_2730: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2729) in
                                                    {2330}out(c, (pkCli_2367,m1_2730));
                                                    {2331}in(c, em2_2731: bitstring);
                                                    {2332}let m2_2732: bitstring = em2_2731 in
                                                    {2333}let (=OpenSecureChannelResponse,PartS_2733: bitstring,ST_2734: bitstring,TTL_2735: bitstring) = m2_2732 in
                                                    {2334}let Kcli_2736: bitstring = exp(PartS_2733,Nc_2728) in
                                                    {2335}out(c, senc(mCli(pkCli_2367,pkSess_2725),Kcli_2736))
                                                )
                                                else
                                                    {2336}let v_2737: bool = (Sess = B) in
                                                    (
                                                        {2337}if v_2737 then
                                                        (
                                                            {2338}let pkSess_2738: bitstring = pub(skB) in
                                                            {2339}out(c, GetEndpointRequest);
                                                            {2340}in(c, (=GetEndpointResponse,=pkSess_2738,=None,SP_2739: bitstring,UP_2740: bitstring));
                                                            {2341}new Nc_2741: bitstring;
                                                            {2342}let gNc_2742: bitstring = exp(g,Nc_2741) in
                                                            {2343}let m1_2743: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2742) in
                                                            {2344}out(c, (pkCli_2367,m1_2743));
                                                            {2345}in(c, em2_2744: bitstring);
                                                            {2346}let m2_2745: bitstring = em2_2744 in
                                                            {2347}let (=OpenSecureChannelResponse,PartS_2746: bitstring,ST_2747: bitstring,TTL_2748: bitstring) = m2_2745 in
                                                            {2348}let Kcli_2749: bitstring = exp(PartS_2746,Nc_2741) in
                                                            {2349}out(c, senc(mCli(pkCli_2367,pkSess_2738),Kcli_2749))
                                                        )
                                                        else
                                                            {2350}let v_2750: bool = (Sess = C) in
                                                            (
                                                                {2351}if v_2750 then
                                                                (
                                                                    {2352}let pkSess_2751: bitstring = pub(skC) in
                                                                    {2353}out(c, GetEndpointRequest);
                                                                    {2354}in(c, (=GetEndpointResponse,=pkSess_2751,=None,SP_2752: bitstring,UP_2753: bitstring));
                                                                    {2355}new Nc_2754: bitstring;
                                                                    {2356}let gNc_2755: bitstring = exp(g,Nc_2754) in
                                                                    {2357}let m1_2756: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2755) in
                                                                    {2358}out(c, (pkCli_2367,m1_2756));
                                                                    {2359}in(c, em2_2757: bitstring);
                                                                    {2360}let m2_2758: bitstring = em2_2757 in
                                                                    {2361}let (=OpenSecureChannelResponse,PartS_2759: bitstring,ST_2760: bitstring,TTL_2761: bitstring) = m2_2758 in
                                                                    {2362}let Kcli_2762: bitstring = exp(PartS_2759,Nc_2754) in
                                                                    {2363}out(c, senc(mCli(pkCli_2367,pkSess_2751),Kcli_2762))
                                                                )
                                                                else
                                                                    {2364}let pkSess_2763: bitstring = pub(sk(Sess)) in
                                                                    {2365}out(c, GetEndpointRequest);
                                                                    {2366}in(c, (=GetEndpointResponse,=pkSess_2763,=None,SP_2764: bitstring,UP_2765: bitstring));
                                                                    {2367}new Nc_2766: bitstring;
                                                                    {2368}let gNc_2767: bitstring = exp(g,Nc_2766) in
                                                                    {2369}let m1_2768: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2767) in
                                                                    {2370}out(c, (pkCli_2367,m1_2768));
                                                                    {2371}in(c, em2_2769: bitstring);
                                                                    {2372}let m2_2770: bitstring = em2_2769 in
                                                                    {2373}let (=OpenSecureChannelResponse,PartS_2771: bitstring,ST_2772: bitstring,TTL_2773: bitstring) = m2_2770 in
                                                                    {2374}let Kcli_2774: bitstring = exp(PartS_2771,Nc_2766) in
                                                                    {2375}out(c, senc(mCli(pkCli_2367,pkSess_2763),Kcli_2774))
                                                            )
                                                            else
                                                                {2376}let pkSess_2775: bitstring = fail-any in
                                                                {2377}out(c, GetEndpointRequest);
                                                                {2378}in(c, (=GetEndpointResponse,=pkSess_2775,=None,SP_2776: bitstring,UP_2777: bitstring));
                                                                {2379}new Nc_2778: bitstring;
                                                                {2380}let gNc_2779: bitstring = exp(g,Nc_2778) in
                                                                {2381}let m1_2780: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2779) in
                                                                {2382}out(c, (pkCli_2367,m1_2780));
                                                                {2383}in(c, em2_2781: bitstring);
                                                                {2384}let m2_2782: bitstring = em2_2781 in
                                                                {2385}let (=OpenSecureChannelResponse,PartS_2783: bitstring,ST_2784: bitstring,TTL_2785: bitstring) = m2_2782 in
                                                                {2386}let Kcli_2786: bitstring = exp(PartS_2783,Nc_2778) in
                                                                {2387}out(c, senc(mCli(pkCli_2367,pkSess_2775),Kcli_2786))
                                                    )
                                                    else
                                                        {2388}let pkSess_2787: bitstring = fail-any in
                                                        {2389}out(c, GetEndpointRequest);
                                                        {2390}in(c, (=GetEndpointResponse,=pkSess_2787,=None,SP_2788: bitstring,UP_2789: bitstring));
                                                        {2391}new Nc_2790: bitstring;
                                                        {2392}let gNc_2791: bitstring = exp(g,Nc_2790) in
                                                        {2393}let m1_2792: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2791) in
                                                        {2394}out(c, (pkCli_2367,m1_2792));
                                                        {2395}in(c, em2_2793: bitstring);
                                                        {2396}let m2_2794: bitstring = em2_2793 in
                                                        {2397}let (=OpenSecureChannelResponse,PartS_2795: bitstring,ST_2796: bitstring,TTL_2797: bitstring) = m2_2794 in
                                                        {2398}let Kcli_2798: bitstring = exp(PartS_2795,Nc_2790) in
                                                        {2399}out(c, senc(mCli(pkCli_2367,pkSess_2787),Kcli_2798))
                                            )
                                            else
                                                {2400}let pkSess_2799: bitstring = fail-any in
                                                {2401}out(c, GetEndpointRequest);
                                                {2402}in(c, (=GetEndpointResponse,=pkSess_2799,=None,SP_2800: bitstring,UP_2801: bitstring));
                                                {2403}new Nc_2802: bitstring;
                                                {2404}let gNc_2803: bitstring = exp(g,Nc_2802) in
                                                {2405}let m1_2804: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2803) in
                                                {2406}out(c, (pkCli_2367,m1_2804));
                                                {2407}in(c, em2_2805: bitstring);
                                                {2408}let m2_2806: bitstring = em2_2805 in
                                                {2409}let (=OpenSecureChannelResponse,PartS_2807: bitstring,ST_2808: bitstring,TTL_2809: bitstring) = m2_2806 in
                                                {2410}let Kcli_2810: bitstring = exp(PartS_2807,Nc_2802) in
                                                {2411}out(c, senc(mCli(pkCli_2367,pkSess_2799),Kcli_2810))
                                )
                                else
                                    {2412}let pkDisco_2811: bitstring = fail-any in
                                    {2413}let v_2812: bool = (Sess = A) in
                                    (
                                        {2414}if v_2812 then
                                        (
                                            {2415}let pkSess_2813: bitstring = pub(skA) in
                                            {2416}out(c, GetEndpointRequest);
                                            {2417}in(c, (=GetEndpointResponse,=pkSess_2813,=None,SP_2814: bitstring,UP_2815: bitstring));
                                            {2418}new Nc_2816: bitstring;
                                            {2419}let gNc_2817: bitstring = exp(g,Nc_2816) in
                                            {2420}let m1_2818: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2817) in
                                            {2421}out(c, (pkCli_2367,m1_2818));
                                            {2422}in(c, em2_2819: bitstring);
                                            {2423}let m2_2820: bitstring = em2_2819 in
                                            {2424}let (=OpenSecureChannelResponse,PartS_2821: bitstring,ST_2822: bitstring,TTL_2823: bitstring) = m2_2820 in
                                            {2425}let Kcli_2824: bitstring = exp(PartS_2821,Nc_2816) in
                                            {2426}out(c, senc(mCli(pkCli_2367,pkSess_2813),Kcli_2824))
                                        )
                                        else
                                            {2427}let v_2825: bool = (Sess = B) in
                                            (
                                                {2428}if v_2825 then
                                                (
                                                    {2429}let pkSess_2826: bitstring = pub(skB) in
                                                    {2430}out(c, GetEndpointRequest);
                                                    {2431}in(c, (=GetEndpointResponse,=pkSess_2826,=None,SP_2827: bitstring,UP_2828: bitstring));
                                                    {2432}new Nc_2829: bitstring;
                                                    {2433}let gNc_2830: bitstring = exp(g,Nc_2829) in
                                                    {2434}let m1_2831: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2830) in
                                                    {2435}out(c, (pkCli_2367,m1_2831));
                                                    {2436}in(c, em2_2832: bitstring);
                                                    {2437}let m2_2833: bitstring = em2_2832 in
                                                    {2438}let (=OpenSecureChannelResponse,PartS_2834: bitstring,ST_2835: bitstring,TTL_2836: bitstring) = m2_2833 in
                                                    {2439}let Kcli_2837: bitstring = exp(PartS_2834,Nc_2829) in
                                                    {2440}out(c, senc(mCli(pkCli_2367,pkSess_2826),Kcli_2837))
                                                )
                                                else
                                                    {2441}let v_2838: bool = (Sess = C) in
                                                    (
                                                        {2442}if v_2838 then
                                                        (
                                                            {2443}let pkSess_2839: bitstring = pub(skC) in
                                                            {2444}out(c, GetEndpointRequest);
                                                            {2445}in(c, (=GetEndpointResponse,=pkSess_2839,=None,SP_2840: bitstring,UP_2841: bitstring));
                                                            {2446}new Nc_2842: bitstring;
                                                            {2447}let gNc_2843: bitstring = exp(g,Nc_2842) in
                                                            {2448}let m1_2844: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2843) in
                                                            {2449}out(c, (pkCli_2367,m1_2844));
                                                            {2450}in(c, em2_2845: bitstring);
                                                            {2451}let m2_2846: bitstring = em2_2845 in
                                                            {2452}let (=OpenSecureChannelResponse,PartS_2847: bitstring,ST_2848: bitstring,TTL_2849: bitstring) = m2_2846 in
                                                            {2453}let Kcli_2850: bitstring = exp(PartS_2847,Nc_2842) in
                                                            {2454}out(c, senc(mCli(pkCli_2367,pkSess_2839),Kcli_2850))
                                                        )
                                                        else
                                                            {2455}let pkSess_2851: bitstring = pub(sk(Sess)) in
                                                            {2456}out(c, GetEndpointRequest);
                                                            {2457}in(c, (=GetEndpointResponse,=pkSess_2851,=None,SP_2852: bitstring,UP_2853: bitstring));
                                                            {2458}new Nc_2854: bitstring;
                                                            {2459}let gNc_2855: bitstring = exp(g,Nc_2854) in
                                                            {2460}let m1_2856: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2855) in
                                                            {2461}out(c, (pkCli_2367,m1_2856));
                                                            {2462}in(c, em2_2857: bitstring);
                                                            {2463}let m2_2858: bitstring = em2_2857 in
                                                            {2464}let (=OpenSecureChannelResponse,PartS_2859: bitstring,ST_2860: bitstring,TTL_2861: bitstring) = m2_2858 in
                                                            {2465}let Kcli_2862: bitstring = exp(PartS_2859,Nc_2854) in
                                                            {2466}out(c, senc(mCli(pkCli_2367,pkSess_2851),Kcli_2862))
                                                    )
                                                    else
                                                        {2467}let pkSess_2863: bitstring = fail-any in
                                                        {2468}out(c, GetEndpointRequest);
                                                        {2469}in(c, (=GetEndpointResponse,=pkSess_2863,=None,SP_2864: bitstring,UP_2865: bitstring));
                                                        {2470}new Nc_2866: bitstring;
                                                        {2471}let gNc_2867: bitstring = exp(g,Nc_2866) in
                                                        {2472}let m1_2868: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2867) in
                                                        {2473}out(c, (pkCli_2367,m1_2868));
                                                        {2474}in(c, em2_2869: bitstring);
                                                        {2475}let m2_2870: bitstring = em2_2869 in
                                                        {2476}let (=OpenSecureChannelResponse,PartS_2871: bitstring,ST_2872: bitstring,TTL_2873: bitstring) = m2_2870 in
                                                        {2477}let Kcli_2874: bitstring = exp(PartS_2871,Nc_2866) in
                                                        {2478}out(c, senc(mCli(pkCli_2367,pkSess_2863),Kcli_2874))
                                            )
                                            else
                                                {2479}let pkSess_2875: bitstring = fail-any in
                                                {2480}out(c, GetEndpointRequest);
                                                {2481}in(c, (=GetEndpointResponse,=pkSess_2875,=None,SP_2876: bitstring,UP_2877: bitstring));
                                                {2482}new Nc_2878: bitstring;
                                                {2483}let gNc_2879: bitstring = exp(g,Nc_2878) in
                                                {2484}let m1_2880: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2879) in
                                                {2485}out(c, (pkCli_2367,m1_2880));
                                                {2486}in(c, em2_2881: bitstring);
                                                {2487}let m2_2882: bitstring = em2_2881 in
                                                {2488}let (=OpenSecureChannelResponse,PartS_2883: bitstring,ST_2884: bitstring,TTL_2885: bitstring) = m2_2882 in
                                                {2489}let Kcli_2886: bitstring = exp(PartS_2883,Nc_2878) in
                                                {2490}out(c, senc(mCli(pkCli_2367,pkSess_2875),Kcli_2886))
                                    )
                                    else
                                        {2491}let pkSess_2887: bitstring = fail-any in
                                        {2492}out(c, GetEndpointRequest);
                                        {2493}in(c, (=GetEndpointResponse,=pkSess_2887,=None,SP_2888: bitstring,UP_2889: bitstring));
                                        {2494}new Nc_2890: bitstring;
                                        {2495}let gNc_2891: bitstring = exp(g,Nc_2890) in
                                        {2496}let m1_2892: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2891) in
                                        {2497}out(c, (pkCli_2367,m1_2892));
                                        {2498}in(c, em2_2893: bitstring);
                                        {2499}let m2_2894: bitstring = em2_2893 in
                                        {2500}let (=OpenSecureChannelResponse,PartS_2895: bitstring,ST_2896: bitstring,TTL_2897: bitstring) = m2_2894 in
                                        {2501}let Kcli_2898: bitstring = exp(PartS_2895,Nc_2890) in
                                        {2502}out(c, senc(mCli(pkCli_2367,pkSess_2887),Kcli_2898))
                        )
                        else
                            {2503}let pkDisco_2899: bitstring = fail-any in
                            {2504}let v_2900: bool = (Sess = A) in
                            (
                                {2505}if v_2900 then
                                (
                                    {2506}let pkSess_2901: bitstring = pub(skA) in
                                    {2507}out(c, GetEndpointRequest);
                                    {2508}in(c, (=GetEndpointResponse,=pkSess_2901,=None,SP_2902: bitstring,UP_2903: bitstring));
                                    {2509}new Nc_2904: bitstring;
                                    {2510}let gNc_2905: bitstring = exp(g,Nc_2904) in
                                    {2511}let m1_2906: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2905) in
                                    {2512}out(c, (pkCli_2367,m1_2906));
                                    {2513}in(c, em2_2907: bitstring);
                                    {2514}let m2_2908: bitstring = em2_2907 in
                                    {2515}let (=OpenSecureChannelResponse,PartS_2909: bitstring,ST_2910: bitstring,TTL_2911: bitstring) = m2_2908 in
                                    {2516}let Kcli_2912: bitstring = exp(PartS_2909,Nc_2904) in
                                    {2517}out(c, senc(mCli(pkCli_2367,pkSess_2901),Kcli_2912))
                                )
                                else
                                    {2518}let v_2913: bool = (Sess = B) in
                                    (
                                        {2519}if v_2913 then
                                        (
                                            {2520}let pkSess_2914: bitstring = pub(skB) in
                                            {2521}out(c, GetEndpointRequest);
                                            {2522}in(c, (=GetEndpointResponse,=pkSess_2914,=None,SP_2915: bitstring,UP_2916: bitstring));
                                            {2523}new Nc_2917: bitstring;
                                            {2524}let gNc_2918: bitstring = exp(g,Nc_2917) in
                                            {2525}let m1_2919: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2918) in
                                            {2526}out(c, (pkCli_2367,m1_2919));
                                            {2527}in(c, em2_2920: bitstring);
                                            {2528}let m2_2921: bitstring = em2_2920 in
                                            {2529}let (=OpenSecureChannelResponse,PartS_2922: bitstring,ST_2923: bitstring,TTL_2924: bitstring) = m2_2921 in
                                            {2530}let Kcli_2925: bitstring = exp(PartS_2922,Nc_2917) in
                                            {2531}out(c, senc(mCli(pkCli_2367,pkSess_2914),Kcli_2925))
                                        )
                                        else
                                            {2532}let v_2926: bool = (Sess = C) in
                                            (
                                                {2533}if v_2926 then
                                                (
                                                    {2534}let pkSess_2927: bitstring = pub(skC) in
                                                    {2535}out(c, GetEndpointRequest);
                                                    {2536}in(c, (=GetEndpointResponse,=pkSess_2927,=None,SP_2928: bitstring,UP_2929: bitstring));
                                                    {2537}new Nc_2930: bitstring;
                                                    {2538}let gNc_2931: bitstring = exp(g,Nc_2930) in
                                                    {2539}let m1_2932: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2931) in
                                                    {2540}out(c, (pkCli_2367,m1_2932));
                                                    {2541}in(c, em2_2933: bitstring);
                                                    {2542}let m2_2934: bitstring = em2_2933 in
                                                    {2543}let (=OpenSecureChannelResponse,PartS_2935: bitstring,ST_2936: bitstring,TTL_2937: bitstring) = m2_2934 in
                                                    {2544}let Kcli_2938: bitstring = exp(PartS_2935,Nc_2930) in
                                                    {2545}out(c, senc(mCli(pkCli_2367,pkSess_2927),Kcli_2938))
                                                )
                                                else
                                                    {2546}let pkSess_2939: bitstring = pub(sk(Sess)) in
                                                    {2547}out(c, GetEndpointRequest);
                                                    {2548}in(c, (=GetEndpointResponse,=pkSess_2939,=None,SP_2940: bitstring,UP_2941: bitstring));
                                                    {2549}new Nc_2942: bitstring;
                                                    {2550}let gNc_2943: bitstring = exp(g,Nc_2942) in
                                                    {2551}let m1_2944: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2943) in
                                                    {2552}out(c, (pkCli_2367,m1_2944));
                                                    {2553}in(c, em2_2945: bitstring);
                                                    {2554}let m2_2946: bitstring = em2_2945 in
                                                    {2555}let (=OpenSecureChannelResponse,PartS_2947: bitstring,ST_2948: bitstring,TTL_2949: bitstring) = m2_2946 in
                                                    {2556}let Kcli_2950: bitstring = exp(PartS_2947,Nc_2942) in
                                                    {2557}out(c, senc(mCli(pkCli_2367,pkSess_2939),Kcli_2950))
                                            )
                                            else
                                                {2558}let pkSess_2951: bitstring = fail-any in
                                                {2559}out(c, GetEndpointRequest);
                                                {2560}in(c, (=GetEndpointResponse,=pkSess_2951,=None,SP_2952: bitstring,UP_2953: bitstring));
                                                {2561}new Nc_2954: bitstring;
                                                {2562}let gNc_2955: bitstring = exp(g,Nc_2954) in
                                                {2563}let m1_2956: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2955) in
                                                {2564}out(c, (pkCli_2367,m1_2956));
                                                {2565}in(c, em2_2957: bitstring);
                                                {2566}let m2_2958: bitstring = em2_2957 in
                                                {2567}let (=OpenSecureChannelResponse,PartS_2959: bitstring,ST_2960: bitstring,TTL_2961: bitstring) = m2_2958 in
                                                {2568}let Kcli_2962: bitstring = exp(PartS_2959,Nc_2954) in
                                                {2569}out(c, senc(mCli(pkCli_2367,pkSess_2951),Kcli_2962))
                                    )
                                    else
                                        {2570}let pkSess_2963: bitstring = fail-any in
                                        {2571}out(c, GetEndpointRequest);
                                        {2572}in(c, (=GetEndpointResponse,=pkSess_2963,=None,SP_2964: bitstring,UP_2965: bitstring));
                                        {2573}new Nc_2966: bitstring;
                                        {2574}let gNc_2967: bitstring = exp(g,Nc_2966) in
                                        {2575}let m1_2968: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2967) in
                                        {2576}out(c, (pkCli_2367,m1_2968));
                                        {2577}in(c, em2_2969: bitstring);
                                        {2578}let m2_2970: bitstring = em2_2969 in
                                        {2579}let (=OpenSecureChannelResponse,PartS_2971: bitstring,ST_2972: bitstring,TTL_2973: bitstring) = m2_2970 in
                                        {2580}let Kcli_2974: bitstring = exp(PartS_2971,Nc_2966) in
                                        {2581}out(c, senc(mCli(pkCli_2367,pkSess_2963),Kcli_2974))
                            )
                            else
                                {2582}let pkSess_2975: bitstring = fail-any in
                                {2583}out(c, GetEndpointRequest);
                                {2584}in(c, (=GetEndpointResponse,=pkSess_2975,=None,SP_2976: bitstring,UP_2977: bitstring));
                                {2585}new Nc_2978: bitstring;
                                {2586}let gNc_2979: bitstring = exp(g,Nc_2978) in
                                {2587}let m1_2980: bitstring = (OpenSecureChannelRequest,pkCli_2367,gNc_2979) in
                                {2588}out(c, (pkCli_2367,m1_2980));
                                {2589}in(c, em2_2981: bitstring);
                                {2590}let m2_2982: bitstring = em2_2981 in
                                {2591}let (=OpenSecureChannelResponse,PartS_2983: bitstring,ST_2984: bitstring,TTL_2985: bitstring) = m2_2982 in
                                {2592}let Kcli_2986: bitstring = exp(PartS_2983,Nc_2978) in
                                {2593}out(c, senc(mCli(pkCli_2367,pkSess_2975),Kcli_2986))
            )
            else
                {2594}let skCli_2987: bitstring = fail-any in
                {2595}let pkCli_2988: bitstring = pub(skCli_2987) in
                {2596}let v_2989: bool = (Disco = A) in
                (
                    {2597}if v_2989 then
                    (
                        {2598}let pkDisco_2990: bitstring = pub(skA) in
                        {2599}let v_2991: bool = (Sess = A) in
                        (
                            {2600}if v_2991 then
                            (
                                {2601}let pkSess_2992: bitstring = pub(skA) in
                                {2602}out(c, GetEndpointRequest);
                                {2603}in(c, (=GetEndpointResponse,=pkSess_2992,=None,SP_2993: bitstring,UP_2994: bitstring));
                                {2604}new Nc_2995: bitstring;
                                {2605}let gNc_2996: bitstring = exp(g,Nc_2995) in
                                {2606}let m1_2997: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_2996) in
                                {2607}out(c, (pkCli_2988,m1_2997));
                                {2608}in(c, em2_2998: bitstring);
                                {2609}let m2_2999: bitstring = em2_2998 in
                                {2610}let (=OpenSecureChannelResponse,PartS_3000: bitstring,ST_3001: bitstring,TTL_3002: bitstring) = m2_2999 in
                                {2611}let Kcli_3003: bitstring = exp(PartS_3000,Nc_2995) in
                                {2612}out(c, senc(mCli(pkCli_2988,pkSess_2992),Kcli_3003))
                            )
                            else
                                {2613}let v_3004: bool = (Sess = B) in
                                (
                                    {2614}if v_3004 then
                                    (
                                        {2615}let pkSess_3005: bitstring = pub(skB) in
                                        {2616}out(c, GetEndpointRequest);
                                        {2617}in(c, (=GetEndpointResponse,=pkSess_3005,=None,SP_3006: bitstring,UP_3007: bitstring));
                                        {2618}new Nc_3008: bitstring;
                                        {2619}let gNc_3009: bitstring = exp(g,Nc_3008) in
                                        {2620}let m1_3010: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3009) in
                                        {2621}out(c, (pkCli_2988,m1_3010));
                                        {2622}in(c, em2_3011: bitstring);
                                        {2623}let m2_3012: bitstring = em2_3011 in
                                        {2624}let (=OpenSecureChannelResponse,PartS_3013: bitstring,ST_3014: bitstring,TTL_3015: bitstring) = m2_3012 in
                                        {2625}let Kcli_3016: bitstring = exp(PartS_3013,Nc_3008) in
                                        {2626}out(c, senc(mCli(pkCli_2988,pkSess_3005),Kcli_3016))
                                    )
                                    else
                                        {2627}let v_3017: bool = (Sess = C) in
                                        (
                                            {2628}if v_3017 then
                                            (
                                                {2629}let pkSess_3018: bitstring = pub(skC) in
                                                {2630}out(c, GetEndpointRequest);
                                                {2631}in(c, (=GetEndpointResponse,=pkSess_3018,=None,SP_3019: bitstring,UP_3020: bitstring));
                                                {2632}new Nc_3021: bitstring;
                                                {2633}let gNc_3022: bitstring = exp(g,Nc_3021) in
                                                {2634}let m1_3023: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3022) in
                                                {2635}out(c, (pkCli_2988,m1_3023));
                                                {2636}in(c, em2_3024: bitstring);
                                                {2637}let m2_3025: bitstring = em2_3024 in
                                                {2638}let (=OpenSecureChannelResponse,PartS_3026: bitstring,ST_3027: bitstring,TTL_3028: bitstring) = m2_3025 in
                                                {2639}let Kcli_3029: bitstring = exp(PartS_3026,Nc_3021) in
                                                {2640}out(c, senc(mCli(pkCli_2988,pkSess_3018),Kcli_3029))
                                            )
                                            else
                                                {2641}let pkSess_3030: bitstring = pub(sk(Sess)) in
                                                {2642}out(c, GetEndpointRequest);
                                                {2643}in(c, (=GetEndpointResponse,=pkSess_3030,=None,SP_3031: bitstring,UP_3032: bitstring));
                                                {2644}new Nc_3033: bitstring;
                                                {2645}let gNc_3034: bitstring = exp(g,Nc_3033) in
                                                {2646}let m1_3035: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3034) in
                                                {2647}out(c, (pkCli_2988,m1_3035));
                                                {2648}in(c, em2_3036: bitstring);
                                                {2649}let m2_3037: bitstring = em2_3036 in
                                                {2650}let (=OpenSecureChannelResponse,PartS_3038: bitstring,ST_3039: bitstring,TTL_3040: bitstring) = m2_3037 in
                                                {2651}let Kcli_3041: bitstring = exp(PartS_3038,Nc_3033) in
                                                {2652}out(c, senc(mCli(pkCli_2988,pkSess_3030),Kcli_3041))
                                        )
                                        else
                                            {2653}let pkSess_3042: bitstring = fail-any in
                                            {2654}out(c, GetEndpointRequest);
                                            {2655}in(c, (=GetEndpointResponse,=pkSess_3042,=None,SP_3043: bitstring,UP_3044: bitstring));
                                            {2656}new Nc_3045: bitstring;
                                            {2657}let gNc_3046: bitstring = exp(g,Nc_3045) in
                                            {2658}let m1_3047: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3046) in
                                            {2659}out(c, (pkCli_2988,m1_3047));
                                            {2660}in(c, em2_3048: bitstring);
                                            {2661}let m2_3049: bitstring = em2_3048 in
                                            {2662}let (=OpenSecureChannelResponse,PartS_3050: bitstring,ST_3051: bitstring,TTL_3052: bitstring) = m2_3049 in
                                            {2663}let Kcli_3053: bitstring = exp(PartS_3050,Nc_3045) in
                                            {2664}out(c, senc(mCli(pkCli_2988,pkSess_3042),Kcli_3053))
                                )
                                else
                                    {2665}let pkSess_3054: bitstring = fail-any in
                                    {2666}out(c, GetEndpointRequest);
                                    {2667}in(c, (=GetEndpointResponse,=pkSess_3054,=None,SP_3055: bitstring,UP_3056: bitstring));
                                    {2668}new Nc_3057: bitstring;
                                    {2669}let gNc_3058: bitstring = exp(g,Nc_3057) in
                                    {2670}let m1_3059: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3058) in
                                    {2671}out(c, (pkCli_2988,m1_3059));
                                    {2672}in(c, em2_3060: bitstring);
                                    {2673}let m2_3061: bitstring = em2_3060 in
                                    {2674}let (=OpenSecureChannelResponse,PartS_3062: bitstring,ST_3063: bitstring,TTL_3064: bitstring) = m2_3061 in
                                    {2675}let Kcli_3065: bitstring = exp(PartS_3062,Nc_3057) in
                                    {2676}out(c, senc(mCli(pkCli_2988,pkSess_3054),Kcli_3065))
                        )
                        else
                            {2677}let pkSess_3066: bitstring = fail-any in
                            {2678}out(c, GetEndpointRequest);
                            {2679}in(c, (=GetEndpointResponse,=pkSess_3066,=None,SP_3067: bitstring,UP_3068: bitstring));
                            {2680}new Nc_3069: bitstring;
                            {2681}let gNc_3070: bitstring = exp(g,Nc_3069) in
                            {2682}let m1_3071: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3070) in
                            {2683}out(c, (pkCli_2988,m1_3071));
                            {2684}in(c, em2_3072: bitstring);
                            {2685}let m2_3073: bitstring = em2_3072 in
                            {2686}let (=OpenSecureChannelResponse,PartS_3074: bitstring,ST_3075: bitstring,TTL_3076: bitstring) = m2_3073 in
                            {2687}let Kcli_3077: bitstring = exp(PartS_3074,Nc_3069) in
                            {2688}out(c, senc(mCli(pkCli_2988,pkSess_3066),Kcli_3077))
                    )
                    else
                        {2689}let v_3078: bool = (Disco = B) in
                        (
                            {2690}if v_3078 then
                            (
                                {2691}let pkDisco_3079: bitstring = pub(skB) in
                                {2692}let v_3080: bool = (Sess = A) in
                                (
                                    {2693}if v_3080 then
                                    (
                                        {2694}let pkSess_3081: bitstring = pub(skA) in
                                        {2695}out(c, GetEndpointRequest);
                                        {2696}in(c, (=GetEndpointResponse,=pkSess_3081,=None,SP_3082: bitstring,UP_3083: bitstring));
                                        {2697}new Nc_3084: bitstring;
                                        {2698}let gNc_3085: bitstring = exp(g,Nc_3084) in
                                        {2699}let m1_3086: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3085) in
                                        {2700}out(c, (pkCli_2988,m1_3086));
                                        {2701}in(c, em2_3087: bitstring);
                                        {2702}let m2_3088: bitstring = em2_3087 in
                                        {2703}let (=OpenSecureChannelResponse,PartS_3089: bitstring,ST_3090: bitstring,TTL_3091: bitstring) = m2_3088 in
                                        {2704}let Kcli_3092: bitstring = exp(PartS_3089,Nc_3084) in
                                        {2705}out(c, senc(mCli(pkCli_2988,pkSess_3081),Kcli_3092))
                                    )
                                    else
                                        {2706}let v_3093: bool = (Sess = B) in
                                        (
                                            {2707}if v_3093 then
                                            (
                                                {2708}let pkSess_3094: bitstring = pub(skB) in
                                                {2709}out(c, GetEndpointRequest);
                                                {2710}in(c, (=GetEndpointResponse,=pkSess_3094,=None,SP_3095: bitstring,UP_3096: bitstring));
                                                {2711}new Nc_3097: bitstring;
                                                {2712}let gNc_3098: bitstring = exp(g,Nc_3097) in
                                                {2713}let m1_3099: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3098) in
                                                {2714}out(c, (pkCli_2988,m1_3099));
                                                {2715}in(c, em2_3100: bitstring);
                                                {2716}let m2_3101: bitstring = em2_3100 in
                                                {2717}let (=OpenSecureChannelResponse,PartS_3102: bitstring,ST_3103: bitstring,TTL_3104: bitstring) = m2_3101 in
                                                {2718}let Kcli_3105: bitstring = exp(PartS_3102,Nc_3097) in
                                                {2719}out(c, senc(mCli(pkCli_2988,pkSess_3094),Kcli_3105))
                                            )
                                            else
                                                {2720}let v_3106: bool = (Sess = C) in
                                                (
                                                    {2721}if v_3106 then
                                                    (
                                                        {2722}let pkSess_3107: bitstring = pub(skC) in
                                                        {2723}out(c, GetEndpointRequest);
                                                        {2724}in(c, (=GetEndpointResponse,=pkSess_3107,=None,SP_3108: bitstring,UP_3109: bitstring));
                                                        {2725}new Nc_3110: bitstring;
                                                        {2726}let gNc_3111: bitstring = exp(g,Nc_3110) in
                                                        {2727}let m1_3112: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3111) in
                                                        {2728}out(c, (pkCli_2988,m1_3112));
                                                        {2729}in(c, em2_3113: bitstring);
                                                        {2730}let m2_3114: bitstring = em2_3113 in
                                                        {2731}let (=OpenSecureChannelResponse,PartS_3115: bitstring,ST_3116: bitstring,TTL_3117: bitstring) = m2_3114 in
                                                        {2732}let Kcli_3118: bitstring = exp(PartS_3115,Nc_3110) in
                                                        {2733}out(c, senc(mCli(pkCli_2988,pkSess_3107),Kcli_3118))
                                                    )
                                                    else
                                                        {2734}let pkSess_3119: bitstring = pub(sk(Sess)) in
                                                        {2735}out(c, GetEndpointRequest);
                                                        {2736}in(c, (=GetEndpointResponse,=pkSess_3119,=None,SP_3120: bitstring,UP_3121: bitstring));
                                                        {2737}new Nc_3122: bitstring;
                                                        {2738}let gNc_3123: bitstring = exp(g,Nc_3122) in
                                                        {2739}let m1_3124: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3123) in
                                                        {2740}out(c, (pkCli_2988,m1_3124));
                                                        {2741}in(c, em2_3125: bitstring);
                                                        {2742}let m2_3126: bitstring = em2_3125 in
                                                        {2743}let (=OpenSecureChannelResponse,PartS_3127: bitstring,ST_3128: bitstring,TTL_3129: bitstring) = m2_3126 in
                                                        {2744}let Kcli_3130: bitstring = exp(PartS_3127,Nc_3122) in
                                                        {2745}out(c, senc(mCli(pkCli_2988,pkSess_3119),Kcli_3130))
                                                )
                                                else
                                                    {2746}let pkSess_3131: bitstring = fail-any in
                                                    {2747}out(c, GetEndpointRequest);
                                                    {2748}in(c, (=GetEndpointResponse,=pkSess_3131,=None,SP_3132: bitstring,UP_3133: bitstring));
                                                    {2749}new Nc_3134: bitstring;
                                                    {2750}let gNc_3135: bitstring = exp(g,Nc_3134) in
                                                    {2751}let m1_3136: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3135) in
                                                    {2752}out(c, (pkCli_2988,m1_3136));
                                                    {2753}in(c, em2_3137: bitstring);
                                                    {2754}let m2_3138: bitstring = em2_3137 in
                                                    {2755}let (=OpenSecureChannelResponse,PartS_3139: bitstring,ST_3140: bitstring,TTL_3141: bitstring) = m2_3138 in
                                                    {2756}let Kcli_3142: bitstring = exp(PartS_3139,Nc_3134) in
                                                    {2757}out(c, senc(mCli(pkCli_2988,pkSess_3131),Kcli_3142))
                                        )
                                        else
                                            {2758}let pkSess_3143: bitstring = fail-any in
                                            {2759}out(c, GetEndpointRequest);
                                            {2760}in(c, (=GetEndpointResponse,=pkSess_3143,=None,SP_3144: bitstring,UP_3145: bitstring));
                                            {2761}new Nc_3146: bitstring;
                                            {2762}let gNc_3147: bitstring = exp(g,Nc_3146) in
                                            {2763}let m1_3148: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3147) in
                                            {2764}out(c, (pkCli_2988,m1_3148));
                                            {2765}in(c, em2_3149: bitstring);
                                            {2766}let m2_3150: bitstring = em2_3149 in
                                            {2767}let (=OpenSecureChannelResponse,PartS_3151: bitstring,ST_3152: bitstring,TTL_3153: bitstring) = m2_3150 in
                                            {2768}let Kcli_3154: bitstring = exp(PartS_3151,Nc_3146) in
                                            {2769}out(c, senc(mCli(pkCli_2988,pkSess_3143),Kcli_3154))
                                )
                                else
                                    {2770}let pkSess_3155: bitstring = fail-any in
                                    {2771}out(c, GetEndpointRequest);
                                    {2772}in(c, (=GetEndpointResponse,=pkSess_3155,=None,SP_3156: bitstring,UP_3157: bitstring));
                                    {2773}new Nc_3158: bitstring;
                                    {2774}let gNc_3159: bitstring = exp(g,Nc_3158) in
                                    {2775}let m1_3160: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3159) in
                                    {2776}out(c, (pkCli_2988,m1_3160));
                                    {2777}in(c, em2_3161: bitstring);
                                    {2778}let m2_3162: bitstring = em2_3161 in
                                    {2779}let (=OpenSecureChannelResponse,PartS_3163: bitstring,ST_3164: bitstring,TTL_3165: bitstring) = m2_3162 in
                                    {2780}let Kcli_3166: bitstring = exp(PartS_3163,Nc_3158) in
                                    {2781}out(c, senc(mCli(pkCli_2988,pkSess_3155),Kcli_3166))
                            )
                            else
                                {2782}let v_3167: bool = (Disco = C) in
                                (
                                    {2783}if v_3167 then
                                    (
                                        {2784}let pkDisco_3168: bitstring = pub(skC) in
                                        {2785}let v_3169: bool = (Sess = A) in
                                        (
                                            {2786}if v_3169 then
                                            (
                                                {2787}let pkSess_3170: bitstring = pub(skA) in
                                                {2788}out(c, GetEndpointRequest);
                                                {2789}in(c, (=GetEndpointResponse,=pkSess_3170,=None,SP_3171: bitstring,UP_3172: bitstring));
                                                {2790}new Nc_3173: bitstring;
                                                {2791}let gNc_3174: bitstring = exp(g,Nc_3173) in
                                                {2792}let m1_3175: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3174) in
                                                {2793}out(c, (pkCli_2988,m1_3175));
                                                {2794}in(c, em2_3176: bitstring);
                                                {2795}let m2_3177: bitstring = em2_3176 in
                                                {2796}let (=OpenSecureChannelResponse,PartS_3178: bitstring,ST_3179: bitstring,TTL_3180: bitstring) = m2_3177 in
                                                {2797}let Kcli_3181: bitstring = exp(PartS_3178,Nc_3173) in
                                                {2798}out(c, senc(mCli(pkCli_2988,pkSess_3170),Kcli_3181))
                                            )
                                            else
                                                {2799}let v_3182: bool = (Sess = B) in
                                                (
                                                    {2800}if v_3182 then
                                                    (
                                                        {2801}let pkSess_3183: bitstring = pub(skB) in
                                                        {2802}out(c, GetEndpointRequest);
                                                        {2803}in(c, (=GetEndpointResponse,=pkSess_3183,=None,SP_3184: bitstring,UP_3185: bitstring));
                                                        {2804}new Nc_3186: bitstring;
                                                        {2805}let gNc_3187: bitstring = exp(g,Nc_3186) in
                                                        {2806}let m1_3188: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3187) in
                                                        {2807}out(c, (pkCli_2988,m1_3188));
                                                        {2808}in(c, em2_3189: bitstring);
                                                        {2809}let m2_3190: bitstring = em2_3189 in
                                                        {2810}let (=OpenSecureChannelResponse,PartS_3191: bitstring,ST_3192: bitstring,TTL_3193: bitstring) = m2_3190 in
                                                        {2811}let Kcli_3194: bitstring = exp(PartS_3191,Nc_3186) in
                                                        {2812}out(c, senc(mCli(pkCli_2988,pkSess_3183),Kcli_3194))
                                                    )
                                                    else
                                                        {2813}let v_3195: bool = (Sess = C) in
                                                        (
                                                            {2814}if v_3195 then
                                                            (
                                                                {2815}let pkSess_3196: bitstring = pub(skC) in
                                                                {2816}out(c, GetEndpointRequest);
                                                                {2817}in(c, (=GetEndpointResponse,=pkSess_3196,=None,SP_3197: bitstring,UP_3198: bitstring));
                                                                {2818}new Nc_3199: bitstring;
                                                                {2819}let gNc_3200: bitstring = exp(g,Nc_3199) in
                                                                {2820}let m1_3201: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3200) in
                                                                {2821}out(c, (pkCli_2988,m1_3201));
                                                                {2822}in(c, em2_3202: bitstring);
                                                                {2823}let m2_3203: bitstring = em2_3202 in
                                                                {2824}let (=OpenSecureChannelResponse,PartS_3204: bitstring,ST_3205: bitstring,TTL_3206: bitstring) = m2_3203 in
                                                                {2825}let Kcli_3207: bitstring = exp(PartS_3204,Nc_3199) in
                                                                {2826}out(c, senc(mCli(pkCli_2988,pkSess_3196),Kcli_3207))
                                                            )
                                                            else
                                                                {2827}let pkSess_3208: bitstring = pub(sk(Sess)) in
                                                                {2828}out(c, GetEndpointRequest);
                                                                {2829}in(c, (=GetEndpointResponse,=pkSess_3208,=None,SP_3209: bitstring,UP_3210: bitstring));
                                                                {2830}new Nc_3211: bitstring;
                                                                {2831}let gNc_3212: bitstring = exp(g,Nc_3211) in
                                                                {2832}let m1_3213: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3212) in
                                                                {2833}out(c, (pkCli_2988,m1_3213));
                                                                {2834}in(c, em2_3214: bitstring);
                                                                {2835}let m2_3215: bitstring = em2_3214 in
                                                                {2836}let (=OpenSecureChannelResponse,PartS_3216: bitstring,ST_3217: bitstring,TTL_3218: bitstring) = m2_3215 in
                                                                {2837}let Kcli_3219: bitstring = exp(PartS_3216,Nc_3211) in
                                                                {2838}out(c, senc(mCli(pkCli_2988,pkSess_3208),Kcli_3219))
                                                        )
                                                        else
                                                            {2839}let pkSess_3220: bitstring = fail-any in
                                                            {2840}out(c, GetEndpointRequest);
                                                            {2841}in(c, (=GetEndpointResponse,=pkSess_3220,=None,SP_3221: bitstring,UP_3222: bitstring));
                                                            {2842}new Nc_3223: bitstring;
                                                            {2843}let gNc_3224: bitstring = exp(g,Nc_3223) in
                                                            {2844}let m1_3225: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3224) in
                                                            {2845}out(c, (pkCli_2988,m1_3225));
                                                            {2846}in(c, em2_3226: bitstring);
                                                            {2847}let m2_3227: bitstring = em2_3226 in
                                                            {2848}let (=OpenSecureChannelResponse,PartS_3228: bitstring,ST_3229: bitstring,TTL_3230: bitstring) = m2_3227 in
                                                            {2849}let Kcli_3231: bitstring = exp(PartS_3228,Nc_3223) in
                                                            {2850}out(c, senc(mCli(pkCli_2988,pkSess_3220),Kcli_3231))
                                                )
                                                else
                                                    {2851}let pkSess_3232: bitstring = fail-any in
                                                    {2852}out(c, GetEndpointRequest);
                                                    {2853}in(c, (=GetEndpointResponse,=pkSess_3232,=None,SP_3233: bitstring,UP_3234: bitstring));
                                                    {2854}new Nc_3235: bitstring;
                                                    {2855}let gNc_3236: bitstring = exp(g,Nc_3235) in
                                                    {2856}let m1_3237: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3236) in
                                                    {2857}out(c, (pkCli_2988,m1_3237));
                                                    {2858}in(c, em2_3238: bitstring);
                                                    {2859}let m2_3239: bitstring = em2_3238 in
                                                    {2860}let (=OpenSecureChannelResponse,PartS_3240: bitstring,ST_3241: bitstring,TTL_3242: bitstring) = m2_3239 in
                                                    {2861}let Kcli_3243: bitstring = exp(PartS_3240,Nc_3235) in
                                                    {2862}out(c, senc(mCli(pkCli_2988,pkSess_3232),Kcli_3243))
                                        )
                                        else
                                            {2863}let pkSess_3244: bitstring = fail-any in
                                            {2864}out(c, GetEndpointRequest);
                                            {2865}in(c, (=GetEndpointResponse,=pkSess_3244,=None,SP_3245: bitstring,UP_3246: bitstring));
                                            {2866}new Nc_3247: bitstring;
                                            {2867}let gNc_3248: bitstring = exp(g,Nc_3247) in
                                            {2868}let m1_3249: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3248) in
                                            {2869}out(c, (pkCli_2988,m1_3249));
                                            {2870}in(c, em2_3250: bitstring);
                                            {2871}let m2_3251: bitstring = em2_3250 in
                                            {2872}let (=OpenSecureChannelResponse,PartS_3252: bitstring,ST_3253: bitstring,TTL_3254: bitstring) = m2_3251 in
                                            {2873}let Kcli_3255: bitstring = exp(PartS_3252,Nc_3247) in
                                            {2874}out(c, senc(mCli(pkCli_2988,pkSess_3244),Kcli_3255))
                                    )
                                    else
                                        {2875}let pkDisco_3256: bitstring = pub(sk(Disco)) in
                                        {2876}let v_3257: bool = (Sess = A) in
                                        (
                                            {2877}if v_3257 then
                                            (
                                                {2878}let pkSess_3258: bitstring = pub(skA) in
                                                {2879}out(c, GetEndpointRequest);
                                                {2880}in(c, (=GetEndpointResponse,=pkSess_3258,=None,SP_3259: bitstring,UP_3260: bitstring));
                                                {2881}new Nc_3261: bitstring;
                                                {2882}let gNc_3262: bitstring = exp(g,Nc_3261) in
                                                {2883}let m1_3263: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3262) in
                                                {2884}out(c, (pkCli_2988,m1_3263));
                                                {2885}in(c, em2_3264: bitstring);
                                                {2886}let m2_3265: bitstring = em2_3264 in
                                                {2887}let (=OpenSecureChannelResponse,PartS_3266: bitstring,ST_3267: bitstring,TTL_3268: bitstring) = m2_3265 in
                                                {2888}let Kcli_3269: bitstring = exp(PartS_3266,Nc_3261) in
                                                {2889}out(c, senc(mCli(pkCli_2988,pkSess_3258),Kcli_3269))
                                            )
                                            else
                                                {2890}let v_3270: bool = (Sess = B) in
                                                (
                                                    {2891}if v_3270 then
                                                    (
                                                        {2892}let pkSess_3271: bitstring = pub(skB) in
                                                        {2893}out(c, GetEndpointRequest);
                                                        {2894}in(c, (=GetEndpointResponse,=pkSess_3271,=None,SP_3272: bitstring,UP_3273: bitstring));
                                                        {2895}new Nc_3274: bitstring;
                                                        {2896}let gNc_3275: bitstring = exp(g,Nc_3274) in
                                                        {2897}let m1_3276: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3275) in
                                                        {2898}out(c, (pkCli_2988,m1_3276));
                                                        {2899}in(c, em2_3277: bitstring);
                                                        {2900}let m2_3278: bitstring = em2_3277 in
                                                        {2901}let (=OpenSecureChannelResponse,PartS_3279: bitstring,ST_3280: bitstring,TTL_3281: bitstring) = m2_3278 in
                                                        {2902}let Kcli_3282: bitstring = exp(PartS_3279,Nc_3274) in
                                                        {2903}out(c, senc(mCli(pkCli_2988,pkSess_3271),Kcli_3282))
                                                    )
                                                    else
                                                        {2904}let v_3283: bool = (Sess = C) in
                                                        (
                                                            {2905}if v_3283 then
                                                            (
                                                                {2906}let pkSess_3284: bitstring = pub(skC) in
                                                                {2907}out(c, GetEndpointRequest);
                                                                {2908}in(c, (=GetEndpointResponse,=pkSess_3284,=None,SP_3285: bitstring,UP_3286: bitstring));
                                                                {2909}new Nc_3287: bitstring;
                                                                {2910}let gNc_3288: bitstring = exp(g,Nc_3287) in
                                                                {2911}let m1_3289: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3288) in
                                                                {2912}out(c, (pkCli_2988,m1_3289));
                                                                {2913}in(c, em2_3290: bitstring);
                                                                {2914}let m2_3291: bitstring = em2_3290 in
                                                                {2915}let (=OpenSecureChannelResponse,PartS_3292: bitstring,ST_3293: bitstring,TTL_3294: bitstring) = m2_3291 in
                                                                {2916}let Kcli_3295: bitstring = exp(PartS_3292,Nc_3287) in
                                                                {2917}out(c, senc(mCli(pkCli_2988,pkSess_3284),Kcli_3295))
                                                            )
                                                            else
                                                                {2918}let pkSess_3296: bitstring = pub(sk(Sess)) in
                                                                {2919}out(c, GetEndpointRequest);
                                                                {2920}in(c, (=GetEndpointResponse,=pkSess_3296,=None,SP_3297: bitstring,UP_3298: bitstring));
                                                                {2921}new Nc_3299: bitstring;
                                                                {2922}let gNc_3300: bitstring = exp(g,Nc_3299) in
                                                                {2923}let m1_3301: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3300) in
                                                                {2924}out(c, (pkCli_2988,m1_3301));
                                                                {2925}in(c, em2_3302: bitstring);
                                                                {2926}let m2_3303: bitstring = em2_3302 in
                                                                {2927}let (=OpenSecureChannelResponse,PartS_3304: bitstring,ST_3305: bitstring,TTL_3306: bitstring) = m2_3303 in
                                                                {2928}let Kcli_3307: bitstring = exp(PartS_3304,Nc_3299) in
                                                                {2929}out(c, senc(mCli(pkCli_2988,pkSess_3296),Kcli_3307))
                                                        )
                                                        else
                                                            {2930}let pkSess_3308: bitstring = fail-any in
                                                            {2931}out(c, GetEndpointRequest);
                                                            {2932}in(c, (=GetEndpointResponse,=pkSess_3308,=None,SP_3309: bitstring,UP_3310: bitstring));
                                                            {2933}new Nc_3311: bitstring;
                                                            {2934}let gNc_3312: bitstring = exp(g,Nc_3311) in
                                                            {2935}let m1_3313: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3312) in
                                                            {2936}out(c, (pkCli_2988,m1_3313));
                                                            {2937}in(c, em2_3314: bitstring);
                                                            {2938}let m2_3315: bitstring = em2_3314 in
                                                            {2939}let (=OpenSecureChannelResponse,PartS_3316: bitstring,ST_3317: bitstring,TTL_3318: bitstring) = m2_3315 in
                                                            {2940}let Kcli_3319: bitstring = exp(PartS_3316,Nc_3311) in
                                                            {2941}out(c, senc(mCli(pkCli_2988,pkSess_3308),Kcli_3319))
                                                )
                                                else
                                                    {2942}let pkSess_3320: bitstring = fail-any in
                                                    {2943}out(c, GetEndpointRequest);
                                                    {2944}in(c, (=GetEndpointResponse,=pkSess_3320,=None,SP_3321: bitstring,UP_3322: bitstring));
                                                    {2945}new Nc_3323: bitstring;
                                                    {2946}let gNc_3324: bitstring = exp(g,Nc_3323) in
                                                    {2947}let m1_3325: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3324) in
                                                    {2948}out(c, (pkCli_2988,m1_3325));
                                                    {2949}in(c, em2_3326: bitstring);
                                                    {2950}let m2_3327: bitstring = em2_3326 in
                                                    {2951}let (=OpenSecureChannelResponse,PartS_3328: bitstring,ST_3329: bitstring,TTL_3330: bitstring) = m2_3327 in
                                                    {2952}let Kcli_3331: bitstring = exp(PartS_3328,Nc_3323) in
                                                    {2953}out(c, senc(mCli(pkCli_2988,pkSess_3320),Kcli_3331))
                                        )
                                        else
                                            {2954}let pkSess_3332: bitstring = fail-any in
                                            {2955}out(c, GetEndpointRequest);
                                            {2956}in(c, (=GetEndpointResponse,=pkSess_3332,=None,SP_3333: bitstring,UP_3334: bitstring));
                                            {2957}new Nc_3335: bitstring;
                                            {2958}let gNc_3336: bitstring = exp(g,Nc_3335) in
                                            {2959}let m1_3337: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3336) in
                                            {2960}out(c, (pkCli_2988,m1_3337));
                                            {2961}in(c, em2_3338: bitstring);
                                            {2962}let m2_3339: bitstring = em2_3338 in
                                            {2963}let (=OpenSecureChannelResponse,PartS_3340: bitstring,ST_3341: bitstring,TTL_3342: bitstring) = m2_3339 in
                                            {2964}let Kcli_3343: bitstring = exp(PartS_3340,Nc_3335) in
                                            {2965}out(c, senc(mCli(pkCli_2988,pkSess_3332),Kcli_3343))
                                )
                                else
                                    {2966}let pkDisco_3344: bitstring = fail-any in
                                    {2967}let v_3345: bool = (Sess = A) in
                                    (
                                        {2968}if v_3345 then
                                        (
                                            {2969}let pkSess_3346: bitstring = pub(skA) in
                                            {2970}out(c, GetEndpointRequest);
                                            {2971}in(c, (=GetEndpointResponse,=pkSess_3346,=None,SP_3347: bitstring,UP_3348: bitstring));
                                            {2972}new Nc_3349: bitstring;
                                            {2973}let gNc_3350: bitstring = exp(g,Nc_3349) in
                                            {2974}let m1_3351: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3350) in
                                            {2975}out(c, (pkCli_2988,m1_3351));
                                            {2976}in(c, em2_3352: bitstring);
                                            {2977}let m2_3353: bitstring = em2_3352 in
                                            {2978}let (=OpenSecureChannelResponse,PartS_3354: bitstring,ST_3355: bitstring,TTL_3356: bitstring) = m2_3353 in
                                            {2979}let Kcli_3357: bitstring = exp(PartS_3354,Nc_3349) in
                                            {2980}out(c, senc(mCli(pkCli_2988,pkSess_3346),Kcli_3357))
                                        )
                                        else
                                            {2981}let v_3358: bool = (Sess = B) in
                                            (
                                                {2982}if v_3358 then
                                                (
                                                    {2983}let pkSess_3359: bitstring = pub(skB) in
                                                    {2984}out(c, GetEndpointRequest);
                                                    {2985}in(c, (=GetEndpointResponse,=pkSess_3359,=None,SP_3360: bitstring,UP_3361: bitstring));
                                                    {2986}new Nc_3362: bitstring;
                                                    {2987}let gNc_3363: bitstring = exp(g,Nc_3362) in
                                                    {2988}let m1_3364: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3363) in
                                                    {2989}out(c, (pkCli_2988,m1_3364));
                                                    {2990}in(c, em2_3365: bitstring);
                                                    {2991}let m2_3366: bitstring = em2_3365 in
                                                    {2992}let (=OpenSecureChannelResponse,PartS_3367: bitstring,ST_3368: bitstring,TTL_3369: bitstring) = m2_3366 in
                                                    {2993}let Kcli_3370: bitstring = exp(PartS_3367,Nc_3362) in
                                                    {2994}out(c, senc(mCli(pkCli_2988,pkSess_3359),Kcli_3370))
                                                )
                                                else
                                                    {2995}let v_3371: bool = (Sess = C) in
                                                    (
                                                        {2996}if v_3371 then
                                                        (
                                                            {2997}let pkSess_3372: bitstring = pub(skC) in
                                                            {2998}out(c, GetEndpointRequest);
                                                            {2999}in(c, (=GetEndpointResponse,=pkSess_3372,=None,SP_3373: bitstring,UP_3374: bitstring));
                                                            {3000}new Nc_3375: bitstring;
                                                            {3001}let gNc_3376: bitstring = exp(g,Nc_3375) in
                                                            {3002}let m1_3377: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3376) in
                                                            {3003}out(c, (pkCli_2988,m1_3377));
                                                            {3004}in(c, em2_3378: bitstring);
                                                            {3005}let m2_3379: bitstring = em2_3378 in
                                                            {3006}let (=OpenSecureChannelResponse,PartS_3380: bitstring,ST_3381: bitstring,TTL_3382: bitstring) = m2_3379 in
                                                            {3007}let Kcli_3383: bitstring = exp(PartS_3380,Nc_3375) in
                                                            {3008}out(c, senc(mCli(pkCli_2988,pkSess_3372),Kcli_3383))
                                                        )
                                                        else
                                                            {3009}let pkSess_3384: bitstring = pub(sk(Sess)) in
                                                            {3010}out(c, GetEndpointRequest);
                                                            {3011}in(c, (=GetEndpointResponse,=pkSess_3384,=None,SP_3385: bitstring,UP_3386: bitstring));
                                                            {3012}new Nc_3387: bitstring;
                                                            {3013}let gNc_3388: bitstring = exp(g,Nc_3387) in
                                                            {3014}let m1_3389: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3388) in
                                                            {3015}out(c, (pkCli_2988,m1_3389));
                                                            {3016}in(c, em2_3390: bitstring);
                                                            {3017}let m2_3391: bitstring = em2_3390 in
                                                            {3018}let (=OpenSecureChannelResponse,PartS_3392: bitstring,ST_3393: bitstring,TTL_3394: bitstring) = m2_3391 in
                                                            {3019}let Kcli_3395: bitstring = exp(PartS_3392,Nc_3387) in
                                                            {3020}out(c, senc(mCli(pkCli_2988,pkSess_3384),Kcli_3395))
                                                    )
                                                    else
                                                        {3021}let pkSess_3396: bitstring = fail-any in
                                                        {3022}out(c, GetEndpointRequest);
                                                        {3023}in(c, (=GetEndpointResponse,=pkSess_3396,=None,SP_3397: bitstring,UP_3398: bitstring));
                                                        {3024}new Nc_3399: bitstring;
                                                        {3025}let gNc_3400: bitstring = exp(g,Nc_3399) in
                                                        {3026}let m1_3401: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3400) in
                                                        {3027}out(c, (pkCli_2988,m1_3401));
                                                        {3028}in(c, em2_3402: bitstring);
                                                        {3029}let m2_3403: bitstring = em2_3402 in
                                                        {3030}let (=OpenSecureChannelResponse,PartS_3404: bitstring,ST_3405: bitstring,TTL_3406: bitstring) = m2_3403 in
                                                        {3031}let Kcli_3407: bitstring = exp(PartS_3404,Nc_3399) in
                                                        {3032}out(c, senc(mCli(pkCli_2988,pkSess_3396),Kcli_3407))
                                            )
                                            else
                                                {3033}let pkSess_3408: bitstring = fail-any in
                                                {3034}out(c, GetEndpointRequest);
                                                {3035}in(c, (=GetEndpointResponse,=pkSess_3408,=None,SP_3409: bitstring,UP_3410: bitstring));
                                                {3036}new Nc_3411: bitstring;
                                                {3037}let gNc_3412: bitstring = exp(g,Nc_3411) in
                                                {3038}let m1_3413: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3412) in
                                                {3039}out(c, (pkCli_2988,m1_3413));
                                                {3040}in(c, em2_3414: bitstring);
                                                {3041}let m2_3415: bitstring = em2_3414 in
                                                {3042}let (=OpenSecureChannelResponse,PartS_3416: bitstring,ST_3417: bitstring,TTL_3418: bitstring) = m2_3415 in
                                                {3043}let Kcli_3419: bitstring = exp(PartS_3416,Nc_3411) in
                                                {3044}out(c, senc(mCli(pkCli_2988,pkSess_3408),Kcli_3419))
                                    )
                                    else
                                        {3045}let pkSess_3420: bitstring = fail-any in
                                        {3046}out(c, GetEndpointRequest);
                                        {3047}in(c, (=GetEndpointResponse,=pkSess_3420,=None,SP_3421: bitstring,UP_3422: bitstring));
                                        {3048}new Nc_3423: bitstring;
                                        {3049}let gNc_3424: bitstring = exp(g,Nc_3423) in
                                        {3050}let m1_3425: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3424) in
                                        {3051}out(c, (pkCli_2988,m1_3425));
                                        {3052}in(c, em2_3426: bitstring);
                                        {3053}let m2_3427: bitstring = em2_3426 in
                                        {3054}let (=OpenSecureChannelResponse,PartS_3428: bitstring,ST_3429: bitstring,TTL_3430: bitstring) = m2_3427 in
                                        {3055}let Kcli_3431: bitstring = exp(PartS_3428,Nc_3423) in
                                        {3056}out(c, senc(mCli(pkCli_2988,pkSess_3420),Kcli_3431))
                        )
                        else
                            {3057}let pkDisco_3432: bitstring = fail-any in
                            {3058}let v_3433: bool = (Sess = A) in
                            (
                                {3059}if v_3433 then
                                (
                                    {3060}let pkSess_3434: bitstring = pub(skA) in
                                    {3061}out(c, GetEndpointRequest);
                                    {3062}in(c, (=GetEndpointResponse,=pkSess_3434,=None,SP_3435: bitstring,UP_3436: bitstring));
                                    {3063}new Nc_3437: bitstring;
                                    {3064}let gNc_3438: bitstring = exp(g,Nc_3437) in
                                    {3065}let m1_3439: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3438) in
                                    {3066}out(c, (pkCli_2988,m1_3439));
                                    {3067}in(c, em2_3440: bitstring);
                                    {3068}let m2_3441: bitstring = em2_3440 in
                                    {3069}let (=OpenSecureChannelResponse,PartS_3442: bitstring,ST_3443: bitstring,TTL_3444: bitstring) = m2_3441 in
                                    {3070}let Kcli_3445: bitstring = exp(PartS_3442,Nc_3437) in
                                    {3071}out(c, senc(mCli(pkCli_2988,pkSess_3434),Kcli_3445))
                                )
                                else
                                    {3072}let v_3446: bool = (Sess = B) in
                                    (
                                        {3073}if v_3446 then
                                        (
                                            {3074}let pkSess_3447: bitstring = pub(skB) in
                                            {3075}out(c, GetEndpointRequest);
                                            {3076}in(c, (=GetEndpointResponse,=pkSess_3447,=None,SP_3448: bitstring,UP_3449: bitstring));
                                            {3077}new Nc_3450: bitstring;
                                            {3078}let gNc_3451: bitstring = exp(g,Nc_3450) in
                                            {3079}let m1_3452: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3451) in
                                            {3080}out(c, (pkCli_2988,m1_3452));
                                            {3081}in(c, em2_3453: bitstring);
                                            {3082}let m2_3454: bitstring = em2_3453 in
                                            {3083}let (=OpenSecureChannelResponse,PartS_3455: bitstring,ST_3456: bitstring,TTL_3457: bitstring) = m2_3454 in
                                            {3084}let Kcli_3458: bitstring = exp(PartS_3455,Nc_3450) in
                                            {3085}out(c, senc(mCli(pkCli_2988,pkSess_3447),Kcli_3458))
                                        )
                                        else
                                            {3086}let v_3459: bool = (Sess = C) in
                                            (
                                                {3087}if v_3459 then
                                                (
                                                    {3088}let pkSess_3460: bitstring = pub(skC) in
                                                    {3089}out(c, GetEndpointRequest);
                                                    {3090}in(c, (=GetEndpointResponse,=pkSess_3460,=None,SP_3461: bitstring,UP_3462: bitstring));
                                                    {3091}new Nc_3463: bitstring;
                                                    {3092}let gNc_3464: bitstring = exp(g,Nc_3463) in
                                                    {3093}let m1_3465: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3464) in
                                                    {3094}out(c, (pkCli_2988,m1_3465));
                                                    {3095}in(c, em2_3466: bitstring);
                                                    {3096}let m2_3467: bitstring = em2_3466 in
                                                    {3097}let (=OpenSecureChannelResponse,PartS_3468: bitstring,ST_3469: bitstring,TTL_3470: bitstring) = m2_3467 in
                                                    {3098}let Kcli_3471: bitstring = exp(PartS_3468,Nc_3463) in
                                                    {3099}out(c, senc(mCli(pkCli_2988,pkSess_3460),Kcli_3471))
                                                )
                                                else
                                                    {3100}let pkSess_3472: bitstring = pub(sk(Sess)) in
                                                    {3101}out(c, GetEndpointRequest);
                                                    {3102}in(c, (=GetEndpointResponse,=pkSess_3472,=None,SP_3473: bitstring,UP_3474: bitstring));
                                                    {3103}new Nc_3475: bitstring;
                                                    {3104}let gNc_3476: bitstring = exp(g,Nc_3475) in
                                                    {3105}let m1_3477: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3476) in
                                                    {3106}out(c, (pkCli_2988,m1_3477));
                                                    {3107}in(c, em2_3478: bitstring);
                                                    {3108}let m2_3479: bitstring = em2_3478 in
                                                    {3109}let (=OpenSecureChannelResponse,PartS_3480: bitstring,ST_3481: bitstring,TTL_3482: bitstring) = m2_3479 in
                                                    {3110}let Kcli_3483: bitstring = exp(PartS_3480,Nc_3475) in
                                                    {3111}out(c, senc(mCli(pkCli_2988,pkSess_3472),Kcli_3483))
                                            )
                                            else
                                                {3112}let pkSess_3484: bitstring = fail-any in
                                                {3113}out(c, GetEndpointRequest);
                                                {3114}in(c, (=GetEndpointResponse,=pkSess_3484,=None,SP_3485: bitstring,UP_3486: bitstring));
                                                {3115}new Nc_3487: bitstring;
                                                {3116}let gNc_3488: bitstring = exp(g,Nc_3487) in
                                                {3117}let m1_3489: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3488) in
                                                {3118}out(c, (pkCli_2988,m1_3489));
                                                {3119}in(c, em2_3490: bitstring);
                                                {3120}let m2_3491: bitstring = em2_3490 in
                                                {3121}let (=OpenSecureChannelResponse,PartS_3492: bitstring,ST_3493: bitstring,TTL_3494: bitstring) = m2_3491 in
                                                {3122}let Kcli_3495: bitstring = exp(PartS_3492,Nc_3487) in
                                                {3123}out(c, senc(mCli(pkCli_2988,pkSess_3484),Kcli_3495))
                                    )
                                    else
                                        {3124}let pkSess_3496: bitstring = fail-any in
                                        {3125}out(c, GetEndpointRequest);
                                        {3126}in(c, (=GetEndpointResponse,=pkSess_3496,=None,SP_3497: bitstring,UP_3498: bitstring));
                                        {3127}new Nc_3499: bitstring;
                                        {3128}let gNc_3500: bitstring = exp(g,Nc_3499) in
                                        {3129}let m1_3501: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3500) in
                                        {3130}out(c, (pkCli_2988,m1_3501));
                                        {3131}in(c, em2_3502: bitstring);
                                        {3132}let m2_3503: bitstring = em2_3502 in
                                        {3133}let (=OpenSecureChannelResponse,PartS_3504: bitstring,ST_3505: bitstring,TTL_3506: bitstring) = m2_3503 in
                                        {3134}let Kcli_3507: bitstring = exp(PartS_3504,Nc_3499) in
                                        {3135}out(c, senc(mCli(pkCli_2988,pkSess_3496),Kcli_3507))
                            )
                            else
                                {3136}let pkSess_3508: bitstring = fail-any in
                                {3137}out(c, GetEndpointRequest);
                                {3138}in(c, (=GetEndpointResponse,=pkSess_3508,=None,SP_3509: bitstring,UP_3510: bitstring));
                                {3139}new Nc_3511: bitstring;
                                {3140}let gNc_3512: bitstring = exp(g,Nc_3511) in
                                {3141}let m1_3513: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3512) in
                                {3142}out(c, (pkCli_2988,m1_3513));
                                {3143}in(c, em2_3514: bitstring);
                                {3144}let m2_3515: bitstring = em2_3514 in
                                {3145}let (=OpenSecureChannelResponse,PartS_3516: bitstring,ST_3517: bitstring,TTL_3518: bitstring) = m2_3515 in
                                {3146}let Kcli_3519: bitstring = exp(PartS_3516,Nc_3511) in
                                {3147}out(c, senc(mCli(pkCli_2988,pkSess_3508),Kcli_3519))
                )
                else
                    {3148}let pkDisco_3520: bitstring = fail-any in
                    {3149}let v_3521: bool = (Sess = A) in
                    (
                        {3150}if v_3521 then
                        (
                            {3151}let pkSess_3522: bitstring = pub(skA) in
                            {3152}out(c, GetEndpointRequest);
                            {3153}in(c, (=GetEndpointResponse,=pkSess_3522,=None,SP_3523: bitstring,UP_3524: bitstring));
                            {3154}new Nc_3525: bitstring;
                            {3155}let gNc_3526: bitstring = exp(g,Nc_3525) in
                            {3156}let m1_3527: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3526) in
                            {3157}out(c, (pkCli_2988,m1_3527));
                            {3158}in(c, em2_3528: bitstring);
                            {3159}let m2_3529: bitstring = em2_3528 in
                            {3160}let (=OpenSecureChannelResponse,PartS_3530: bitstring,ST_3531: bitstring,TTL_3532: bitstring) = m2_3529 in
                            {3161}let Kcli_3533: bitstring = exp(PartS_3530,Nc_3525) in
                            {3162}out(c, senc(mCli(pkCli_2988,pkSess_3522),Kcli_3533))
                        )
                        else
                            {3163}let v_3534: bool = (Sess = B) in
                            (
                                {3164}if v_3534 then
                                (
                                    {3165}let pkSess_3535: bitstring = pub(skB) in
                                    {3166}out(c, GetEndpointRequest);
                                    {3167}in(c, (=GetEndpointResponse,=pkSess_3535,=None,SP_3536: bitstring,UP_3537: bitstring));
                                    {3168}new Nc_3538: bitstring;
                                    {3169}let gNc_3539: bitstring = exp(g,Nc_3538) in
                                    {3170}let m1_3540: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3539) in
                                    {3171}out(c, (pkCli_2988,m1_3540));
                                    {3172}in(c, em2_3541: bitstring);
                                    {3173}let m2_3542: bitstring = em2_3541 in
                                    {3174}let (=OpenSecureChannelResponse,PartS_3543: bitstring,ST_3544: bitstring,TTL_3545: bitstring) = m2_3542 in
                                    {3175}let Kcli_3546: bitstring = exp(PartS_3543,Nc_3538) in
                                    {3176}out(c, senc(mCli(pkCli_2988,pkSess_3535),Kcli_3546))
                                )
                                else
                                    {3177}let v_3547: bool = (Sess = C) in
                                    (
                                        {3178}if v_3547 then
                                        (
                                            {3179}let pkSess_3548: bitstring = pub(skC) in
                                            {3180}out(c, GetEndpointRequest);
                                            {3181}in(c, (=GetEndpointResponse,=pkSess_3548,=None,SP_3549: bitstring,UP_3550: bitstring));
                                            {3182}new Nc_3551: bitstring;
                                            {3183}let gNc_3552: bitstring = exp(g,Nc_3551) in
                                            {3184}let m1_3553: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3552) in
                                            {3185}out(c, (pkCli_2988,m1_3553));
                                            {3186}in(c, em2_3554: bitstring);
                                            {3187}let m2_3555: bitstring = em2_3554 in
                                            {3188}let (=OpenSecureChannelResponse,PartS_3556: bitstring,ST_3557: bitstring,TTL_3558: bitstring) = m2_3555 in
                                            {3189}let Kcli_3559: bitstring = exp(PartS_3556,Nc_3551) in
                                            {3190}out(c, senc(mCli(pkCli_2988,pkSess_3548),Kcli_3559))
                                        )
                                        else
                                            {3191}let pkSess_3560: bitstring = pub(sk(Sess)) in
                                            {3192}out(c, GetEndpointRequest);
                                            {3193}in(c, (=GetEndpointResponse,=pkSess_3560,=None,SP_3561: bitstring,UP_3562: bitstring));
                                            {3194}new Nc_3563: bitstring;
                                            {3195}let gNc_3564: bitstring = exp(g,Nc_3563) in
                                            {3196}let m1_3565: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3564) in
                                            {3197}out(c, (pkCli_2988,m1_3565));
                                            {3198}in(c, em2_3566: bitstring);
                                            {3199}let m2_3567: bitstring = em2_3566 in
                                            {3200}let (=OpenSecureChannelResponse,PartS_3568: bitstring,ST_3569: bitstring,TTL_3570: bitstring) = m2_3567 in
                                            {3201}let Kcli_3571: bitstring = exp(PartS_3568,Nc_3563) in
                                            {3202}out(c, senc(mCli(pkCli_2988,pkSess_3560),Kcli_3571))
                                    )
                                    else
                                        {3203}let pkSess_3572: bitstring = fail-any in
                                        {3204}out(c, GetEndpointRequest);
                                        {3205}in(c, (=GetEndpointResponse,=pkSess_3572,=None,SP_3573: bitstring,UP_3574: bitstring));
                                        {3206}new Nc_3575: bitstring;
                                        {3207}let gNc_3576: bitstring = exp(g,Nc_3575) in
                                        {3208}let m1_3577: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3576) in
                                        {3209}out(c, (pkCli_2988,m1_3577));
                                        {3210}in(c, em2_3578: bitstring);
                                        {3211}let m2_3579: bitstring = em2_3578 in
                                        {3212}let (=OpenSecureChannelResponse,PartS_3580: bitstring,ST_3581: bitstring,TTL_3582: bitstring) = m2_3579 in
                                        {3213}let Kcli_3583: bitstring = exp(PartS_3580,Nc_3575) in
                                        {3214}out(c, senc(mCli(pkCli_2988,pkSess_3572),Kcli_3583))
                            )
                            else
                                {3215}let pkSess_3584: bitstring = fail-any in
                                {3216}out(c, GetEndpointRequest);
                                {3217}in(c, (=GetEndpointResponse,=pkSess_3584,=None,SP_3585: bitstring,UP_3586: bitstring));
                                {3218}new Nc_3587: bitstring;
                                {3219}let gNc_3588: bitstring = exp(g,Nc_3587) in
                                {3220}let m1_3589: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3588) in
                                {3221}out(c, (pkCli_2988,m1_3589));
                                {3222}in(c, em2_3590: bitstring);
                                {3223}let m2_3591: bitstring = em2_3590 in
                                {3224}let (=OpenSecureChannelResponse,PartS_3592: bitstring,ST_3593: bitstring,TTL_3594: bitstring) = m2_3591 in
                                {3225}let Kcli_3595: bitstring = exp(PartS_3592,Nc_3587) in
                                {3226}out(c, senc(mCli(pkCli_2988,pkSess_3584),Kcli_3595))
                    )
                    else
                        {3227}let pkSess_3596: bitstring = fail-any in
                        {3228}out(c, GetEndpointRequest);
                        {3229}in(c, (=GetEndpointResponse,=pkSess_3596,=None,SP_3597: bitstring,UP_3598: bitstring));
                        {3230}new Nc_3599: bitstring;
                        {3231}let gNc_3600: bitstring = exp(g,Nc_3599) in
                        {3232}let m1_3601: bitstring = (OpenSecureChannelRequest,pkCli_2988,gNc_3600) in
                        {3233}out(c, (pkCli_2988,m1_3601));
                        {3234}in(c, em2_3602: bitstring);
                        {3235}let m2_3603: bitstring = em2_3602 in
                        {3236}let (=OpenSecureChannelResponse,PartS_3604: bitstring,ST_3605: bitstring,TTL_3606: bitstring) = m2_3603 in
                        {3237}let Kcli_3607: bitstring = exp(PartS_3604,Nc_3599) in
                        {3238}out(c, senc(mCli(pkCli_2988,pkSess_3596),Kcli_3607))
    )
    else
        {3239}let skCli_3608: bitstring = fail-any in
        {3240}let pkCli_3609: bitstring = pub(skCli_3608) in
        {3241}let v_3610: bool = (Disco = A) in
        (
            {3242}if v_3610 then
            (
                {3243}let pkDisco_3611: bitstring = pub(skA) in
                {3244}let v_3612: bool = (Sess = A) in
                (
                    {3245}if v_3612 then
                    (
                        {3246}let pkSess_3613: bitstring = pub(skA) in
                        {3247}out(c, GetEndpointRequest);
                        {3248}in(c, (=GetEndpointResponse,=pkSess_3613,=None,SP_3614: bitstring,UP_3615: bitstring));
                        {3249}new Nc_3616: bitstring;
                        {3250}let gNc_3617: bitstring = exp(g,Nc_3616) in
                        {3251}let m1_3618: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3617) in
                        {3252}out(c, (pkCli_3609,m1_3618));
                        {3253}in(c, em2_3619: bitstring);
                        {3254}let m2_3620: bitstring = em2_3619 in
                        {3255}let (=OpenSecureChannelResponse,PartS_3621: bitstring,ST_3622: bitstring,TTL_3623: bitstring) = m2_3620 in
                        {3256}let Kcli_3624: bitstring = exp(PartS_3621,Nc_3616) in
                        {3257}out(c, senc(mCli(pkCli_3609,pkSess_3613),Kcli_3624))
                    )
                    else
                        {3258}let v_3625: bool = (Sess = B) in
                        (
                            {3259}if v_3625 then
                            (
                                {3260}let pkSess_3626: bitstring = pub(skB) in
                                {3261}out(c, GetEndpointRequest);
                                {3262}in(c, (=GetEndpointResponse,=pkSess_3626,=None,SP_3627: bitstring,UP_3628: bitstring));
                                {3263}new Nc_3629: bitstring;
                                {3264}let gNc_3630: bitstring = exp(g,Nc_3629) in
                                {3265}let m1_3631: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3630) in
                                {3266}out(c, (pkCli_3609,m1_3631));
                                {3267}in(c, em2_3632: bitstring);
                                {3268}let m2_3633: bitstring = em2_3632 in
                                {3269}let (=OpenSecureChannelResponse,PartS_3634: bitstring,ST_3635: bitstring,TTL_3636: bitstring) = m2_3633 in
                                {3270}let Kcli_3637: bitstring = exp(PartS_3634,Nc_3629) in
                                {3271}out(c, senc(mCli(pkCli_3609,pkSess_3626),Kcli_3637))
                            )
                            else
                                {3272}let v_3638: bool = (Sess = C) in
                                (
                                    {3273}if v_3638 then
                                    (
                                        {3274}let pkSess_3639: bitstring = pub(skC) in
                                        {3275}out(c, GetEndpointRequest);
                                        {3276}in(c, (=GetEndpointResponse,=pkSess_3639,=None,SP_3640: bitstring,UP_3641: bitstring));
                                        {3277}new Nc_3642: bitstring;
                                        {3278}let gNc_3643: bitstring = exp(g,Nc_3642) in
                                        {3279}let m1_3644: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3643) in
                                        {3280}out(c, (pkCli_3609,m1_3644));
                                        {3281}in(c, em2_3645: bitstring);
                                        {3282}let m2_3646: bitstring = em2_3645 in
                                        {3283}let (=OpenSecureChannelResponse,PartS_3647: bitstring,ST_3648: bitstring,TTL_3649: bitstring) = m2_3646 in
                                        {3284}let Kcli_3650: bitstring = exp(PartS_3647,Nc_3642) in
                                        {3285}out(c, senc(mCli(pkCli_3609,pkSess_3639),Kcli_3650))
                                    )
                                    else
                                        {3286}let pkSess_3651: bitstring = pub(sk(Sess)) in
                                        {3287}out(c, GetEndpointRequest);
                                        {3288}in(c, (=GetEndpointResponse,=pkSess_3651,=None,SP_3652: bitstring,UP_3653: bitstring));
                                        {3289}new Nc_3654: bitstring;
                                        {3290}let gNc_3655: bitstring = exp(g,Nc_3654) in
                                        {3291}let m1_3656: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3655) in
                                        {3292}out(c, (pkCli_3609,m1_3656));
                                        {3293}in(c, em2_3657: bitstring);
                                        {3294}let m2_3658: bitstring = em2_3657 in
                                        {3295}let (=OpenSecureChannelResponse,PartS_3659: bitstring,ST_3660: bitstring,TTL_3661: bitstring) = m2_3658 in
                                        {3296}let Kcli_3662: bitstring = exp(PartS_3659,Nc_3654) in
                                        {3297}out(c, senc(mCli(pkCli_3609,pkSess_3651),Kcli_3662))
                                )
                                else
                                    {3298}let pkSess_3663: bitstring = fail-any in
                                    {3299}out(c, GetEndpointRequest);
                                    {3300}in(c, (=GetEndpointResponse,=pkSess_3663,=None,SP_3664: bitstring,UP_3665: bitstring));
                                    {3301}new Nc_3666: bitstring;
                                    {3302}let gNc_3667: bitstring = exp(g,Nc_3666) in
                                    {3303}let m1_3668: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3667) in
                                    {3304}out(c, (pkCli_3609,m1_3668));
                                    {3305}in(c, em2_3669: bitstring);
                                    {3306}let m2_3670: bitstring = em2_3669 in
                                    {3307}let (=OpenSecureChannelResponse,PartS_3671: bitstring,ST_3672: bitstring,TTL_3673: bitstring) = m2_3670 in
                                    {3308}let Kcli_3674: bitstring = exp(PartS_3671,Nc_3666) in
                                    {3309}out(c, senc(mCli(pkCli_3609,pkSess_3663),Kcli_3674))
                        )
                        else
                            {3310}let pkSess_3675: bitstring = fail-any in
                            {3311}out(c, GetEndpointRequest);
                            {3312}in(c, (=GetEndpointResponse,=pkSess_3675,=None,SP_3676: bitstring,UP_3677: bitstring));
                            {3313}new Nc_3678: bitstring;
                            {3314}let gNc_3679: bitstring = exp(g,Nc_3678) in
                            {3315}let m1_3680: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3679) in
                            {3316}out(c, (pkCli_3609,m1_3680));
                            {3317}in(c, em2_3681: bitstring);
                            {3318}let m2_3682: bitstring = em2_3681 in
                            {3319}let (=OpenSecureChannelResponse,PartS_3683: bitstring,ST_3684: bitstring,TTL_3685: bitstring) = m2_3682 in
                            {3320}let Kcli_3686: bitstring = exp(PartS_3683,Nc_3678) in
                            {3321}out(c, senc(mCli(pkCli_3609,pkSess_3675),Kcli_3686))
                )
                else
                    {3322}let pkSess_3687: bitstring = fail-any in
                    {3323}out(c, GetEndpointRequest);
                    {3324}in(c, (=GetEndpointResponse,=pkSess_3687,=None,SP_3688: bitstring,UP_3689: bitstring));
                    {3325}new Nc_3690: bitstring;
                    {3326}let gNc_3691: bitstring = exp(g,Nc_3690) in
                    {3327}let m1_3692: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3691) in
                    {3328}out(c, (pkCli_3609,m1_3692));
                    {3329}in(c, em2_3693: bitstring);
                    {3330}let m2_3694: bitstring = em2_3693 in
                    {3331}let (=OpenSecureChannelResponse,PartS_3695: bitstring,ST_3696: bitstring,TTL_3697: bitstring) = m2_3694 in
                    {3332}let Kcli_3698: bitstring = exp(PartS_3695,Nc_3690) in
                    {3333}out(c, senc(mCli(pkCli_3609,pkSess_3687),Kcli_3698))
            )
            else
                {3334}let v_3699: bool = (Disco = B) in
                (
                    {3335}if v_3699 then
                    (
                        {3336}let pkDisco_3700: bitstring = pub(skB) in
                        {3337}let v_3701: bool = (Sess = A) in
                        (
                            {3338}if v_3701 then
                            (
                                {3339}let pkSess_3702: bitstring = pub(skA) in
                                {3340}out(c, GetEndpointRequest);
                                {3341}in(c, (=GetEndpointResponse,=pkSess_3702,=None,SP_3703: bitstring,UP_3704: bitstring));
                                {3342}new Nc_3705: bitstring;
                                {3343}let gNc_3706: bitstring = exp(g,Nc_3705) in
                                {3344}let m1_3707: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3706) in
                                {3345}out(c, (pkCli_3609,m1_3707));
                                {3346}in(c, em2_3708: bitstring);
                                {3347}let m2_3709: bitstring = em2_3708 in
                                {3348}let (=OpenSecureChannelResponse,PartS_3710: bitstring,ST_3711: bitstring,TTL_3712: bitstring) = m2_3709 in
                                {3349}let Kcli_3713: bitstring = exp(PartS_3710,Nc_3705) in
                                {3350}out(c, senc(mCli(pkCli_3609,pkSess_3702),Kcli_3713))
                            )
                            else
                                {3351}let v_3714: bool = (Sess = B) in
                                (
                                    {3352}if v_3714 then
                                    (
                                        {3353}let pkSess_3715: bitstring = pub(skB) in
                                        {3354}out(c, GetEndpointRequest);
                                        {3355}in(c, (=GetEndpointResponse,=pkSess_3715,=None,SP_3716: bitstring,UP_3717: bitstring));
                                        {3356}new Nc_3718: bitstring;
                                        {3357}let gNc_3719: bitstring = exp(g,Nc_3718) in
                                        {3358}let m1_3720: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3719) in
                                        {3359}out(c, (pkCli_3609,m1_3720));
                                        {3360}in(c, em2_3721: bitstring);
                                        {3361}let m2_3722: bitstring = em2_3721 in
                                        {3362}let (=OpenSecureChannelResponse,PartS_3723: bitstring,ST_3724: bitstring,TTL_3725: bitstring) = m2_3722 in
                                        {3363}let Kcli_3726: bitstring = exp(PartS_3723,Nc_3718) in
                                        {3364}out(c, senc(mCli(pkCli_3609,pkSess_3715),Kcli_3726))
                                    )
                                    else
                                        {3365}let v_3727: bool = (Sess = C) in
                                        (
                                            {3366}if v_3727 then
                                            (
                                                {3367}let pkSess_3728: bitstring = pub(skC) in
                                                {3368}out(c, GetEndpointRequest);
                                                {3369}in(c, (=GetEndpointResponse,=pkSess_3728,=None,SP_3729: bitstring,UP_3730: bitstring));
                                                {3370}new Nc_3731: bitstring;
                                                {3371}let gNc_3732: bitstring = exp(g,Nc_3731) in
                                                {3372}let m1_3733: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3732) in
                                                {3373}out(c, (pkCli_3609,m1_3733));
                                                {3374}in(c, em2_3734: bitstring);
                                                {3375}let m2_3735: bitstring = em2_3734 in
                                                {3376}let (=OpenSecureChannelResponse,PartS_3736: bitstring,ST_3737: bitstring,TTL_3738: bitstring) = m2_3735 in
                                                {3377}let Kcli_3739: bitstring = exp(PartS_3736,Nc_3731) in
                                                {3378}out(c, senc(mCli(pkCli_3609,pkSess_3728),Kcli_3739))
                                            )
                                            else
                                                {3379}let pkSess_3740: bitstring = pub(sk(Sess)) in
                                                {3380}out(c, GetEndpointRequest);
                                                {3381}in(c, (=GetEndpointResponse,=pkSess_3740,=None,SP_3741: bitstring,UP_3742: bitstring));
                                                {3382}new Nc_3743: bitstring;
                                                {3383}let gNc_3744: bitstring = exp(g,Nc_3743) in
                                                {3384}let m1_3745: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3744) in
                                                {3385}out(c, (pkCli_3609,m1_3745));
                                                {3386}in(c, em2_3746: bitstring);
                                                {3387}let m2_3747: bitstring = em2_3746 in
                                                {3388}let (=OpenSecureChannelResponse,PartS_3748: bitstring,ST_3749: bitstring,TTL_3750: bitstring) = m2_3747 in
                                                {3389}let Kcli_3751: bitstring = exp(PartS_3748,Nc_3743) in
                                                {3390}out(c, senc(mCli(pkCli_3609,pkSess_3740),Kcli_3751))
                                        )
                                        else
                                            {3391}let pkSess_3752: bitstring = fail-any in
                                            {3392}out(c, GetEndpointRequest);
                                            {3393}in(c, (=GetEndpointResponse,=pkSess_3752,=None,SP_3753: bitstring,UP_3754: bitstring));
                                            {3394}new Nc_3755: bitstring;
                                            {3395}let gNc_3756: bitstring = exp(g,Nc_3755) in
                                            {3396}let m1_3757: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3756) in
                                            {3397}out(c, (pkCli_3609,m1_3757));
                                            {3398}in(c, em2_3758: bitstring);
                                            {3399}let m2_3759: bitstring = em2_3758 in
                                            {3400}let (=OpenSecureChannelResponse,PartS_3760: bitstring,ST_3761: bitstring,TTL_3762: bitstring) = m2_3759 in
                                            {3401}let Kcli_3763: bitstring = exp(PartS_3760,Nc_3755) in
                                            {3402}out(c, senc(mCli(pkCli_3609,pkSess_3752),Kcli_3763))
                                )
                                else
                                    {3403}let pkSess_3764: bitstring = fail-any in
                                    {3404}out(c, GetEndpointRequest);
                                    {3405}in(c, (=GetEndpointResponse,=pkSess_3764,=None,SP_3765: bitstring,UP_3766: bitstring));
                                    {3406}new Nc_3767: bitstring;
                                    {3407}let gNc_3768: bitstring = exp(g,Nc_3767) in
                                    {3408}let m1_3769: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3768) in
                                    {3409}out(c, (pkCli_3609,m1_3769));
                                    {3410}in(c, em2_3770: bitstring);
                                    {3411}let m2_3771: bitstring = em2_3770 in
                                    {3412}let (=OpenSecureChannelResponse,PartS_3772: bitstring,ST_3773: bitstring,TTL_3774: bitstring) = m2_3771 in
                                    {3413}let Kcli_3775: bitstring = exp(PartS_3772,Nc_3767) in
                                    {3414}out(c, senc(mCli(pkCli_3609,pkSess_3764),Kcli_3775))
                        )
                        else
                            {3415}let pkSess_3776: bitstring = fail-any in
                            {3416}out(c, GetEndpointRequest);
                            {3417}in(c, (=GetEndpointResponse,=pkSess_3776,=None,SP_3777: bitstring,UP_3778: bitstring));
                            {3418}new Nc_3779: bitstring;
                            {3419}let gNc_3780: bitstring = exp(g,Nc_3779) in
                            {3420}let m1_3781: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3780) in
                            {3421}out(c, (pkCli_3609,m1_3781));
                            {3422}in(c, em2_3782: bitstring);
                            {3423}let m2_3783: bitstring = em2_3782 in
                            {3424}let (=OpenSecureChannelResponse,PartS_3784: bitstring,ST_3785: bitstring,TTL_3786: bitstring) = m2_3783 in
                            {3425}let Kcli_3787: bitstring = exp(PartS_3784,Nc_3779) in
                            {3426}out(c, senc(mCli(pkCli_3609,pkSess_3776),Kcli_3787))
                    )
                    else
                        {3427}let v_3788: bool = (Disco = C) in
                        (
                            {3428}if v_3788 then
                            (
                                {3429}let pkDisco_3789: bitstring = pub(skC) in
                                {3430}let v_3790: bool = (Sess = A) in
                                (
                                    {3431}if v_3790 then
                                    (
                                        {3432}let pkSess_3791: bitstring = pub(skA) in
                                        {3433}out(c, GetEndpointRequest);
                                        {3434}in(c, (=GetEndpointResponse,=pkSess_3791,=None,SP_3792: bitstring,UP_3793: bitstring));
                                        {3435}new Nc_3794: bitstring;
                                        {3436}let gNc_3795: bitstring = exp(g,Nc_3794) in
                                        {3437}let m1_3796: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3795) in
                                        {3438}out(c, (pkCli_3609,m1_3796));
                                        {3439}in(c, em2_3797: bitstring);
                                        {3440}let m2_3798: bitstring = em2_3797 in
                                        {3441}let (=OpenSecureChannelResponse,PartS_3799: bitstring,ST_3800: bitstring,TTL_3801: bitstring) = m2_3798 in
                                        {3442}let Kcli_3802: bitstring = exp(PartS_3799,Nc_3794) in
                                        {3443}out(c, senc(mCli(pkCli_3609,pkSess_3791),Kcli_3802))
                                    )
                                    else
                                        {3444}let v_3803: bool = (Sess = B) in
                                        (
                                            {3445}if v_3803 then
                                            (
                                                {3446}let pkSess_3804: bitstring = pub(skB) in
                                                {3447}out(c, GetEndpointRequest);
                                                {3448}in(c, (=GetEndpointResponse,=pkSess_3804,=None,SP_3805: bitstring,UP_3806: bitstring));
                                                {3449}new Nc_3807: bitstring;
                                                {3450}let gNc_3808: bitstring = exp(g,Nc_3807) in
                                                {3451}let m1_3809: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3808) in
                                                {3452}out(c, (pkCli_3609,m1_3809));
                                                {3453}in(c, em2_3810: bitstring);
                                                {3454}let m2_3811: bitstring = em2_3810 in
                                                {3455}let (=OpenSecureChannelResponse,PartS_3812: bitstring,ST_3813: bitstring,TTL_3814: bitstring) = m2_3811 in
                                                {3456}let Kcli_3815: bitstring = exp(PartS_3812,Nc_3807) in
                                                {3457}out(c, senc(mCli(pkCli_3609,pkSess_3804),Kcli_3815))
                                            )
                                            else
                                                {3458}let v_3816: bool = (Sess = C) in
                                                (
                                                    {3459}if v_3816 then
                                                    (
                                                        {3460}let pkSess_3817: bitstring = pub(skC) in
                                                        {3461}out(c, GetEndpointRequest);
                                                        {3462}in(c, (=GetEndpointResponse,=pkSess_3817,=None,SP_3818: bitstring,UP_3819: bitstring));
                                                        {3463}new Nc_3820: bitstring;
                                                        {3464}let gNc_3821: bitstring = exp(g,Nc_3820) in
                                                        {3465}let m1_3822: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3821) in
                                                        {3466}out(c, (pkCli_3609,m1_3822));
                                                        {3467}in(c, em2_3823: bitstring);
                                                        {3468}let m2_3824: bitstring = em2_3823 in
                                                        {3469}let (=OpenSecureChannelResponse,PartS_3825: bitstring,ST_3826: bitstring,TTL_3827: bitstring) = m2_3824 in
                                                        {3470}let Kcli_3828: bitstring = exp(PartS_3825,Nc_3820) in
                                                        {3471}out(c, senc(mCli(pkCli_3609,pkSess_3817),Kcli_3828))
                                                    )
                                                    else
                                                        {3472}let pkSess_3829: bitstring = pub(sk(Sess)) in
                                                        {3473}out(c, GetEndpointRequest);
                                                        {3474}in(c, (=GetEndpointResponse,=pkSess_3829,=None,SP_3830: bitstring,UP_3831: bitstring));
                                                        {3475}new Nc_3832: bitstring;
                                                        {3476}let gNc_3833: bitstring = exp(g,Nc_3832) in
                                                        {3477}let m1_3834: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3833) in
                                                        {3478}out(c, (pkCli_3609,m1_3834));
                                                        {3479}in(c, em2_3835: bitstring);
                                                        {3480}let m2_3836: bitstring = em2_3835 in
                                                        {3481}let (=OpenSecureChannelResponse,PartS_3837: bitstring,ST_3838: bitstring,TTL_3839: bitstring) = m2_3836 in
                                                        {3482}let Kcli_3840: bitstring = exp(PartS_3837,Nc_3832) in
                                                        {3483}out(c, senc(mCli(pkCli_3609,pkSess_3829),Kcli_3840))
                                                )
                                                else
                                                    {3484}let pkSess_3841: bitstring = fail-any in
                                                    {3485}out(c, GetEndpointRequest);
                                                    {3486}in(c, (=GetEndpointResponse,=pkSess_3841,=None,SP_3842: bitstring,UP_3843: bitstring));
                                                    {3487}new Nc_3844: bitstring;
                                                    {3488}let gNc_3845: bitstring = exp(g,Nc_3844) in
                                                    {3489}let m1_3846: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3845) in
                                                    {3490}out(c, (pkCli_3609,m1_3846));
                                                    {3491}in(c, em2_3847: bitstring);
                                                    {3492}let m2_3848: bitstring = em2_3847 in
                                                    {3493}let (=OpenSecureChannelResponse,PartS_3849: bitstring,ST_3850: bitstring,TTL_3851: bitstring) = m2_3848 in
                                                    {3494}let Kcli_3852: bitstring = exp(PartS_3849,Nc_3844) in
                                                    {3495}out(c, senc(mCli(pkCli_3609,pkSess_3841),Kcli_3852))
                                        )
                                        else
                                            {3496}let pkSess_3853: bitstring = fail-any in
                                            {3497}out(c, GetEndpointRequest);
                                            {3498}in(c, (=GetEndpointResponse,=pkSess_3853,=None,SP_3854: bitstring,UP_3855: bitstring));
                                            {3499}new Nc_3856: bitstring;
                                            {3500}let gNc_3857: bitstring = exp(g,Nc_3856) in
                                            {3501}let m1_3858: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3857) in
                                            {3502}out(c, (pkCli_3609,m1_3858));
                                            {3503}in(c, em2_3859: bitstring);
                                            {3504}let m2_3860: bitstring = em2_3859 in
                                            {3505}let (=OpenSecureChannelResponse,PartS_3861: bitstring,ST_3862: bitstring,TTL_3863: bitstring) = m2_3860 in
                                            {3506}let Kcli_3864: bitstring = exp(PartS_3861,Nc_3856) in
                                            {3507}out(c, senc(mCli(pkCli_3609,pkSess_3853),Kcli_3864))
                                )
                                else
                                    {3508}let pkSess_3865: bitstring = fail-any in
                                    {3509}out(c, GetEndpointRequest);
                                    {3510}in(c, (=GetEndpointResponse,=pkSess_3865,=None,SP_3866: bitstring,UP_3867: bitstring));
                                    {3511}new Nc_3868: bitstring;
                                    {3512}let gNc_3869: bitstring = exp(g,Nc_3868) in
                                    {3513}let m1_3870: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3869) in
                                    {3514}out(c, (pkCli_3609,m1_3870));
                                    {3515}in(c, em2_3871: bitstring);
                                    {3516}let m2_3872: bitstring = em2_3871 in
                                    {3517}let (=OpenSecureChannelResponse,PartS_3873: bitstring,ST_3874: bitstring,TTL_3875: bitstring) = m2_3872 in
                                    {3518}let Kcli_3876: bitstring = exp(PartS_3873,Nc_3868) in
                                    {3519}out(c, senc(mCli(pkCli_3609,pkSess_3865),Kcli_3876))
                            )
                            else
                                {3520}let pkDisco_3877: bitstring = pub(sk(Disco)) in
                                {3521}let v_3878: bool = (Sess = A) in
                                (
                                    {3522}if v_3878 then
                                    (
                                        {3523}let pkSess_3879: bitstring = pub(skA) in
                                        {3524}out(c, GetEndpointRequest);
                                        {3525}in(c, (=GetEndpointResponse,=pkSess_3879,=None,SP_3880: bitstring,UP_3881: bitstring));
                                        {3526}new Nc_3882: bitstring;
                                        {3527}let gNc_3883: bitstring = exp(g,Nc_3882) in
                                        {3528}let m1_3884: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3883) in
                                        {3529}out(c, (pkCli_3609,m1_3884));
                                        {3530}in(c, em2_3885: bitstring);
                                        {3531}let m2_3886: bitstring = em2_3885 in
                                        {3532}let (=OpenSecureChannelResponse,PartS_3887: bitstring,ST_3888: bitstring,TTL_3889: bitstring) = m2_3886 in
                                        {3533}let Kcli_3890: bitstring = exp(PartS_3887,Nc_3882) in
                                        {3534}out(c, senc(mCli(pkCli_3609,pkSess_3879),Kcli_3890))
                                    )
                                    else
                                        {3535}let v_3891: bool = (Sess = B) in
                                        (
                                            {3536}if v_3891 then
                                            (
                                                {3537}let pkSess_3892: bitstring = pub(skB) in
                                                {3538}out(c, GetEndpointRequest);
                                                {3539}in(c, (=GetEndpointResponse,=pkSess_3892,=None,SP_3893: bitstring,UP_3894: bitstring));
                                                {3540}new Nc_3895: bitstring;
                                                {3541}let gNc_3896: bitstring = exp(g,Nc_3895) in
                                                {3542}let m1_3897: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3896) in
                                                {3543}out(c, (pkCli_3609,m1_3897));
                                                {3544}in(c, em2_3898: bitstring);
                                                {3545}let m2_3899: bitstring = em2_3898 in
                                                {3546}let (=OpenSecureChannelResponse,PartS_3900: bitstring,ST_3901: bitstring,TTL_3902: bitstring) = m2_3899 in
                                                {3547}let Kcli_3903: bitstring = exp(PartS_3900,Nc_3895) in
                                                {3548}out(c, senc(mCli(pkCli_3609,pkSess_3892),Kcli_3903))
                                            )
                                            else
                                                {3549}let v_3904: bool = (Sess = C) in
                                                (
                                                    {3550}if v_3904 then
                                                    (
                                                        {3551}let pkSess_3905: bitstring = pub(skC) in
                                                        {3552}out(c, GetEndpointRequest);
                                                        {3553}in(c, (=GetEndpointResponse,=pkSess_3905,=None,SP_3906: bitstring,UP_3907: bitstring));
                                                        {3554}new Nc_3908: bitstring;
                                                        {3555}let gNc_3909: bitstring = exp(g,Nc_3908) in
                                                        {3556}let m1_3910: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3909) in
                                                        {3557}out(c, (pkCli_3609,m1_3910));
                                                        {3558}in(c, em2_3911: bitstring);
                                                        {3559}let m2_3912: bitstring = em2_3911 in
                                                        {3560}let (=OpenSecureChannelResponse,PartS_3913: bitstring,ST_3914: bitstring,TTL_3915: bitstring) = m2_3912 in
                                                        {3561}let Kcli_3916: bitstring = exp(PartS_3913,Nc_3908) in
                                                        {3562}out(c, senc(mCli(pkCli_3609,pkSess_3905),Kcli_3916))
                                                    )
                                                    else
                                                        {3563}let pkSess_3917: bitstring = pub(sk(Sess)) in
                                                        {3564}out(c, GetEndpointRequest);
                                                        {3565}in(c, (=GetEndpointResponse,=pkSess_3917,=None,SP_3918: bitstring,UP_3919: bitstring));
                                                        {3566}new Nc_3920: bitstring;
                                                        {3567}let gNc_3921: bitstring = exp(g,Nc_3920) in
                                                        {3568}let m1_3922: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3921) in
                                                        {3569}out(c, (pkCli_3609,m1_3922));
                                                        {3570}in(c, em2_3923: bitstring);
                                                        {3571}let m2_3924: bitstring = em2_3923 in
                                                        {3572}let (=OpenSecureChannelResponse,PartS_3925: bitstring,ST_3926: bitstring,TTL_3927: bitstring) = m2_3924 in
                                                        {3573}let Kcli_3928: bitstring = exp(PartS_3925,Nc_3920) in
                                                        {3574}out(c, senc(mCli(pkCli_3609,pkSess_3917),Kcli_3928))
                                                )
                                                else
                                                    {3575}let pkSess_3929: bitstring = fail-any in
                                                    {3576}out(c, GetEndpointRequest);
                                                    {3577}in(c, (=GetEndpointResponse,=pkSess_3929,=None,SP_3930: bitstring,UP_3931: bitstring));
                                                    {3578}new Nc_3932: bitstring;
                                                    {3579}let gNc_3933: bitstring = exp(g,Nc_3932) in
                                                    {3580}let m1_3934: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3933) in
                                                    {3581}out(c, (pkCli_3609,m1_3934));
                                                    {3582}in(c, em2_3935: bitstring);
                                                    {3583}let m2_3936: bitstring = em2_3935 in
                                                    {3584}let (=OpenSecureChannelResponse,PartS_3937: bitstring,ST_3938: bitstring,TTL_3939: bitstring) = m2_3936 in
                                                    {3585}let Kcli_3940: bitstring = exp(PartS_3937,Nc_3932) in
                                                    {3586}out(c, senc(mCli(pkCli_3609,pkSess_3929),Kcli_3940))
                                        )
                                        else
                                            {3587}let pkSess_3941: bitstring = fail-any in
                                            {3588}out(c, GetEndpointRequest);
                                            {3589}in(c, (=GetEndpointResponse,=pkSess_3941,=None,SP_3942: bitstring,UP_3943: bitstring));
                                            {3590}new Nc_3944: bitstring;
                                            {3591}let gNc_3945: bitstring = exp(g,Nc_3944) in
                                            {3592}let m1_3946: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3945) in
                                            {3593}out(c, (pkCli_3609,m1_3946));
                                            {3594}in(c, em2_3947: bitstring);
                                            {3595}let m2_3948: bitstring = em2_3947 in
                                            {3596}let (=OpenSecureChannelResponse,PartS_3949: bitstring,ST_3950: bitstring,TTL_3951: bitstring) = m2_3948 in
                                            {3597}let Kcli_3952: bitstring = exp(PartS_3949,Nc_3944) in
                                            {3598}out(c, senc(mCli(pkCli_3609,pkSess_3941),Kcli_3952))
                                )
                                else
                                    {3599}let pkSess_3953: bitstring = fail-any in
                                    {3600}out(c, GetEndpointRequest);
                                    {3601}in(c, (=GetEndpointResponse,=pkSess_3953,=None,SP_3954: bitstring,UP_3955: bitstring));
                                    {3602}new Nc_3956: bitstring;
                                    {3603}let gNc_3957: bitstring = exp(g,Nc_3956) in
                                    {3604}let m1_3958: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3957) in
                                    {3605}out(c, (pkCli_3609,m1_3958));
                                    {3606}in(c, em2_3959: bitstring);
                                    {3607}let m2_3960: bitstring = em2_3959 in
                                    {3608}let (=OpenSecureChannelResponse,PartS_3961: bitstring,ST_3962: bitstring,TTL_3963: bitstring) = m2_3960 in
                                    {3609}let Kcli_3964: bitstring = exp(PartS_3961,Nc_3956) in
                                    {3610}out(c, senc(mCli(pkCli_3609,pkSess_3953),Kcli_3964))
                        )
                        else
                            {3611}let pkDisco_3965: bitstring = fail-any in
                            {3612}let v_3966: bool = (Sess = A) in
                            (
                                {3613}if v_3966 then
                                (
                                    {3614}let pkSess_3967: bitstring = pub(skA) in
                                    {3615}out(c, GetEndpointRequest);
                                    {3616}in(c, (=GetEndpointResponse,=pkSess_3967,=None,SP_3968: bitstring,UP_3969: bitstring));
                                    {3617}new Nc_3970: bitstring;
                                    {3618}let gNc_3971: bitstring = exp(g,Nc_3970) in
                                    {3619}let m1_3972: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3971) in
                                    {3620}out(c, (pkCli_3609,m1_3972));
                                    {3621}in(c, em2_3973: bitstring);
                                    {3622}let m2_3974: bitstring = em2_3973 in
                                    {3623}let (=OpenSecureChannelResponse,PartS_3975: bitstring,ST_3976: bitstring,TTL_3977: bitstring) = m2_3974 in
                                    {3624}let Kcli_3978: bitstring = exp(PartS_3975,Nc_3970) in
                                    {3625}out(c, senc(mCli(pkCli_3609,pkSess_3967),Kcli_3978))
                                )
                                else
                                    {3626}let v_3979: bool = (Sess = B) in
                                    (
                                        {3627}if v_3979 then
                                        (
                                            {3628}let pkSess_3980: bitstring = pub(skB) in
                                            {3629}out(c, GetEndpointRequest);
                                            {3630}in(c, (=GetEndpointResponse,=pkSess_3980,=None,SP_3981: bitstring,UP_3982: bitstring));
                                            {3631}new Nc_3983: bitstring;
                                            {3632}let gNc_3984: bitstring = exp(g,Nc_3983) in
                                            {3633}let m1_3985: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3984) in
                                            {3634}out(c, (pkCli_3609,m1_3985));
                                            {3635}in(c, em2_3986: bitstring);
                                            {3636}let m2_3987: bitstring = em2_3986 in
                                            {3637}let (=OpenSecureChannelResponse,PartS_3988: bitstring,ST_3989: bitstring,TTL_3990: bitstring) = m2_3987 in
                                            {3638}let Kcli_3991: bitstring = exp(PartS_3988,Nc_3983) in
                                            {3639}out(c, senc(mCli(pkCli_3609,pkSess_3980),Kcli_3991))
                                        )
                                        else
                                            {3640}let v_3992: bool = (Sess = C) in
                                            (
                                                {3641}if v_3992 then
                                                (
                                                    {3642}let pkSess_3993: bitstring = pub(skC) in
                                                    {3643}out(c, GetEndpointRequest);
                                                    {3644}in(c, (=GetEndpointResponse,=pkSess_3993,=None,SP_3994: bitstring,UP_3995: bitstring));
                                                    {3645}new Nc_3996: bitstring;
                                                    {3646}let gNc_3997: bitstring = exp(g,Nc_3996) in
                                                    {3647}let m1_3998: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_3997) in
                                                    {3648}out(c, (pkCli_3609,m1_3998));
                                                    {3649}in(c, em2_3999: bitstring);
                                                    {3650}let m2_4000: bitstring = em2_3999 in
                                                    {3651}let (=OpenSecureChannelResponse,PartS_4001: bitstring,ST_4002: bitstring,TTL_4003: bitstring) = m2_4000 in
                                                    {3652}let Kcli_4004: bitstring = exp(PartS_4001,Nc_3996) in
                                                    {3653}out(c, senc(mCli(pkCli_3609,pkSess_3993),Kcli_4004))
                                                )
                                                else
                                                    {3654}let pkSess_4005: bitstring = pub(sk(Sess)) in
                                                    {3655}out(c, GetEndpointRequest);
                                                    {3656}in(c, (=GetEndpointResponse,=pkSess_4005,=None,SP_4006: bitstring,UP_4007: bitstring));
                                                    {3657}new Nc_4008: bitstring;
                                                    {3658}let gNc_4009: bitstring = exp(g,Nc_4008) in
                                                    {3659}let m1_4010: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4009) in
                                                    {3660}out(c, (pkCli_3609,m1_4010));
                                                    {3661}in(c, em2_4011: bitstring);
                                                    {3662}let m2_4012: bitstring = em2_4011 in
                                                    {3663}let (=OpenSecureChannelResponse,PartS_4013: bitstring,ST_4014: bitstring,TTL_4015: bitstring) = m2_4012 in
                                                    {3664}let Kcli_4016: bitstring = exp(PartS_4013,Nc_4008) in
                                                    {3665}out(c, senc(mCli(pkCli_3609,pkSess_4005),Kcli_4016))
                                            )
                                            else
                                                {3666}let pkSess_4017: bitstring = fail-any in
                                                {3667}out(c, GetEndpointRequest);
                                                {3668}in(c, (=GetEndpointResponse,=pkSess_4017,=None,SP_4018: bitstring,UP_4019: bitstring));
                                                {3669}new Nc_4020: bitstring;
                                                {3670}let gNc_4021: bitstring = exp(g,Nc_4020) in
                                                {3671}let m1_4022: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4021) in
                                                {3672}out(c, (pkCli_3609,m1_4022));
                                                {3673}in(c, em2_4023: bitstring);
                                                {3674}let m2_4024: bitstring = em2_4023 in
                                                {3675}let (=OpenSecureChannelResponse,PartS_4025: bitstring,ST_4026: bitstring,TTL_4027: bitstring) = m2_4024 in
                                                {3676}let Kcli_4028: bitstring = exp(PartS_4025,Nc_4020) in
                                                {3677}out(c, senc(mCli(pkCli_3609,pkSess_4017),Kcli_4028))
                                    )
                                    else
                                        {3678}let pkSess_4029: bitstring = fail-any in
                                        {3679}out(c, GetEndpointRequest);
                                        {3680}in(c, (=GetEndpointResponse,=pkSess_4029,=None,SP_4030: bitstring,UP_4031: bitstring));
                                        {3681}new Nc_4032: bitstring;
                                        {3682}let gNc_4033: bitstring = exp(g,Nc_4032) in
                                        {3683}let m1_4034: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4033) in
                                        {3684}out(c, (pkCli_3609,m1_4034));
                                        {3685}in(c, em2_4035: bitstring);
                                        {3686}let m2_4036: bitstring = em2_4035 in
                                        {3687}let (=OpenSecureChannelResponse,PartS_4037: bitstring,ST_4038: bitstring,TTL_4039: bitstring) = m2_4036 in
                                        {3688}let Kcli_4040: bitstring = exp(PartS_4037,Nc_4032) in
                                        {3689}out(c, senc(mCli(pkCli_3609,pkSess_4029),Kcli_4040))
                            )
                            else
                                {3690}let pkSess_4041: bitstring = fail-any in
                                {3691}out(c, GetEndpointRequest);
                                {3692}in(c, (=GetEndpointResponse,=pkSess_4041,=None,SP_4042: bitstring,UP_4043: bitstring));
                                {3693}new Nc_4044: bitstring;
                                {3694}let gNc_4045: bitstring = exp(g,Nc_4044) in
                                {3695}let m1_4046: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4045) in
                                {3696}out(c, (pkCli_3609,m1_4046));
                                {3697}in(c, em2_4047: bitstring);
                                {3698}let m2_4048: bitstring = em2_4047 in
                                {3699}let (=OpenSecureChannelResponse,PartS_4049: bitstring,ST_4050: bitstring,TTL_4051: bitstring) = m2_4048 in
                                {3700}let Kcli_4052: bitstring = exp(PartS_4049,Nc_4044) in
                                {3701}out(c, senc(mCli(pkCli_3609,pkSess_4041),Kcli_4052))
                )
                else
                    {3702}let pkDisco_4053: bitstring = fail-any in
                    {3703}let v_4054: bool = (Sess = A) in
                    (
                        {3704}if v_4054 then
                        (
                            {3705}let pkSess_4055: bitstring = pub(skA) in
                            {3706}out(c, GetEndpointRequest);
                            {3707}in(c, (=GetEndpointResponse,=pkSess_4055,=None,SP_4056: bitstring,UP_4057: bitstring));
                            {3708}new Nc_4058: bitstring;
                            {3709}let gNc_4059: bitstring = exp(g,Nc_4058) in
                            {3710}let m1_4060: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4059) in
                            {3711}out(c, (pkCli_3609,m1_4060));
                            {3712}in(c, em2_4061: bitstring);
                            {3713}let m2_4062: bitstring = em2_4061 in
                            {3714}let (=OpenSecureChannelResponse,PartS_4063: bitstring,ST_4064: bitstring,TTL_4065: bitstring) = m2_4062 in
                            {3715}let Kcli_4066: bitstring = exp(PartS_4063,Nc_4058) in
                            {3716}out(c, senc(mCli(pkCli_3609,pkSess_4055),Kcli_4066))
                        )
                        else
                            {3717}let v_4067: bool = (Sess = B) in
                            (
                                {3718}if v_4067 then
                                (
                                    {3719}let pkSess_4068: bitstring = pub(skB) in
                                    {3720}out(c, GetEndpointRequest);
                                    {3721}in(c, (=GetEndpointResponse,=pkSess_4068,=None,SP_4069: bitstring,UP_4070: bitstring));
                                    {3722}new Nc_4071: bitstring;
                                    {3723}let gNc_4072: bitstring = exp(g,Nc_4071) in
                                    {3724}let m1_4073: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4072) in
                                    {3725}out(c, (pkCli_3609,m1_4073));
                                    {3726}in(c, em2_4074: bitstring);
                                    {3727}let m2_4075: bitstring = em2_4074 in
                                    {3728}let (=OpenSecureChannelResponse,PartS_4076: bitstring,ST_4077: bitstring,TTL_4078: bitstring) = m2_4075 in
                                    {3729}let Kcli_4079: bitstring = exp(PartS_4076,Nc_4071) in
                                    {3730}out(c, senc(mCli(pkCli_3609,pkSess_4068),Kcli_4079))
                                )
                                else
                                    {3731}let v_4080: bool = (Sess = C) in
                                    (
                                        {3732}if v_4080 then
                                        (
                                            {3733}let pkSess_4081: bitstring = pub(skC) in
                                            {3734}out(c, GetEndpointRequest);
                                            {3735}in(c, (=GetEndpointResponse,=pkSess_4081,=None,SP_4082: bitstring,UP_4083: bitstring));
                                            {3736}new Nc_4084: bitstring;
                                            {3737}let gNc_4085: bitstring = exp(g,Nc_4084) in
                                            {3738}let m1_4086: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4085) in
                                            {3739}out(c, (pkCli_3609,m1_4086));
                                            {3740}in(c, em2_4087: bitstring);
                                            {3741}let m2_4088: bitstring = em2_4087 in
                                            {3742}let (=OpenSecureChannelResponse,PartS_4089: bitstring,ST_4090: bitstring,TTL_4091: bitstring) = m2_4088 in
                                            {3743}let Kcli_4092: bitstring = exp(PartS_4089,Nc_4084) in
                                            {3744}out(c, senc(mCli(pkCli_3609,pkSess_4081),Kcli_4092))
                                        )
                                        else
                                            {3745}let pkSess_4093: bitstring = pub(sk(Sess)) in
                                            {3746}out(c, GetEndpointRequest);
                                            {3747}in(c, (=GetEndpointResponse,=pkSess_4093,=None,SP_4094: bitstring,UP_4095: bitstring));
                                            {3748}new Nc_4096: bitstring;
                                            {3749}let gNc_4097: bitstring = exp(g,Nc_4096) in
                                            {3750}let m1_4098: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4097) in
                                            {3751}out(c, (pkCli_3609,m1_4098));
                                            {3752}in(c, em2_4099: bitstring);
                                            {3753}let m2_4100: bitstring = em2_4099 in
                                            {3754}let (=OpenSecureChannelResponse,PartS_4101: bitstring,ST_4102: bitstring,TTL_4103: bitstring) = m2_4100 in
                                            {3755}let Kcli_4104: bitstring = exp(PartS_4101,Nc_4096) in
                                            {3756}out(c, senc(mCli(pkCli_3609,pkSess_4093),Kcli_4104))
                                    )
                                    else
                                        {3757}let pkSess_4105: bitstring = fail-any in
                                        {3758}out(c, GetEndpointRequest);
                                        {3759}in(c, (=GetEndpointResponse,=pkSess_4105,=None,SP_4106: bitstring,UP_4107: bitstring));
                                        {3760}new Nc_4108: bitstring;
                                        {3761}let gNc_4109: bitstring = exp(g,Nc_4108) in
                                        {3762}let m1_4110: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4109) in
                                        {3763}out(c, (pkCli_3609,m1_4110));
                                        {3764}in(c, em2_4111: bitstring);
                                        {3765}let m2_4112: bitstring = em2_4111 in
                                        {3766}let (=OpenSecureChannelResponse,PartS_4113: bitstring,ST_4114: bitstring,TTL_4115: bitstring) = m2_4112 in
                                        {3767}let Kcli_4116: bitstring = exp(PartS_4113,Nc_4108) in
                                        {3768}out(c, senc(mCli(pkCli_3609,pkSess_4105),Kcli_4116))
                            )
                            else
                                {3769}let pkSess_4117: bitstring = fail-any in
                                {3770}out(c, GetEndpointRequest);
                                {3771}in(c, (=GetEndpointResponse,=pkSess_4117,=None,SP_4118: bitstring,UP_4119: bitstring));
                                {3772}new Nc_4120: bitstring;
                                {3773}let gNc_4121: bitstring = exp(g,Nc_4120) in
                                {3774}let m1_4122: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4121) in
                                {3775}out(c, (pkCli_3609,m1_4122));
                                {3776}in(c, em2_4123: bitstring);
                                {3777}let m2_4124: bitstring = em2_4123 in
                                {3778}let (=OpenSecureChannelResponse,PartS_4125: bitstring,ST_4126: bitstring,TTL_4127: bitstring) = m2_4124 in
                                {3779}let Kcli_4128: bitstring = exp(PartS_4125,Nc_4120) in
                                {3780}out(c, senc(mCli(pkCli_3609,pkSess_4117),Kcli_4128))
                    )
                    else
                        {3781}let pkSess_4129: bitstring = fail-any in
                        {3782}out(c, GetEndpointRequest);
                        {3783}in(c, (=GetEndpointResponse,=pkSess_4129,=None,SP_4130: bitstring,UP_4131: bitstring));
                        {3784}new Nc_4132: bitstring;
                        {3785}let gNc_4133: bitstring = exp(g,Nc_4132) in
                        {3786}let m1_4134: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4133) in
                        {3787}out(c, (pkCli_3609,m1_4134));
                        {3788}in(c, em2_4135: bitstring);
                        {3789}let m2_4136: bitstring = em2_4135 in
                        {3790}let (=OpenSecureChannelResponse,PartS_4137: bitstring,ST_4138: bitstring,TTL_4139: bitstring) = m2_4136 in
                        {3791}let Kcli_4140: bitstring = exp(PartS_4137,Nc_4132) in
                        {3792}out(c, senc(mCli(pkCli_3609,pkSess_4129),Kcli_4140))
        )
        else
            {3793}let pkDisco_4141: bitstring = fail-any in
            {3794}let v_4142: bool = (Sess = A) in
            (
                {3795}if v_4142 then
                (
                    {3796}let pkSess_4143: bitstring = pub(skA) in
                    {3797}out(c, GetEndpointRequest);
                    {3798}in(c, (=GetEndpointResponse,=pkSess_4143,=None,SP_4144: bitstring,UP_4145: bitstring));
                    {3799}new Nc_4146: bitstring;
                    {3800}let gNc_4147: bitstring = exp(g,Nc_4146) in
                    {3801}let m1_4148: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4147) in
                    {3802}out(c, (pkCli_3609,m1_4148));
                    {3803}in(c, em2_4149: bitstring);
                    {3804}let m2_4150: bitstring = em2_4149 in
                    {3805}let (=OpenSecureChannelResponse,PartS_4151: bitstring,ST_4152: bitstring,TTL_4153: bitstring) = m2_4150 in
                    {3806}let Kcli_4154: bitstring = exp(PartS_4151,Nc_4146) in
                    {3807}out(c, senc(mCli(pkCli_3609,pkSess_4143),Kcli_4154))
                )
                else
                    {3808}let v_4155: bool = (Sess = B) in
                    (
                        {3809}if v_4155 then
                        (
                            {3810}let pkSess_4156: bitstring = pub(skB) in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_4156,=None,SP_4157: bitstring,UP_4158: bitstring));
                            {3813}new Nc_4159: bitstring;
                            {3814}let gNc_4160: bitstring = exp(g,Nc_4159) in
                            {3815}let m1_4161: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4160) in
                            {3816}out(c, (pkCli_3609,m1_4161));
                            {3817}in(c, em2_4162: bitstring);
                            {3818}let m2_4163: bitstring = em2_4162 in
                            {3819}let (=OpenSecureChannelResponse,PartS_4164: bitstring,ST_4165: bitstring,TTL_4166: bitstring) = m2_4163 in
                            {3820}let Kcli_4167: bitstring = exp(PartS_4164,Nc_4159) in
                            {3821}out(c, senc(mCli(pkCli_3609,pkSess_4156),Kcli_4167))
                        )
                        else
                            {3822}let v_4168: bool = (Sess = C) in
                            (
                                {3823}if v_4168 then
                                (
                                    {3824}let pkSess_4169: bitstring = pub(skC) in
                                    {3825}out(c, GetEndpointRequest);
                                    {3826}in(c, (=GetEndpointResponse,=pkSess_4169,=None,SP_4170: bitstring,UP_4171: bitstring));
                                    {3827}new Nc_4172: bitstring;
                                    {3828}let gNc_4173: bitstring = exp(g,Nc_4172) in
                                    {3829}let m1_4174: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4173) in
                                    {3830}out(c, (pkCli_3609,m1_4174));
                                    {3831}in(c, em2_4175: bitstring);
                                    {3832}let m2_4176: bitstring = em2_4175 in
                                    {3833}let (=OpenSecureChannelResponse,PartS_4177: bitstring,ST_4178: bitstring,TTL_4179: bitstring) = m2_4176 in
                                    {3834}let Kcli_4180: bitstring = exp(PartS_4177,Nc_4172) in
                                    {3835}out(c, senc(mCli(pkCli_3609,pkSess_4169),Kcli_4180))
                                )
                                else
                                    {3836}let pkSess_4181: bitstring = pub(sk(Sess)) in
                                    {3837}out(c, GetEndpointRequest);
                                    {3838}in(c, (=GetEndpointResponse,=pkSess_4181,=None,SP_4182: bitstring,UP_4183: bitstring));
                                    {3839}new Nc_4184: bitstring;
                                    {3840}let gNc_4185: bitstring = exp(g,Nc_4184) in
                                    {3841}let m1_4186: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4185) in
                                    {3842}out(c, (pkCli_3609,m1_4186));
                                    {3843}in(c, em2_4187: bitstring);
                                    {3844}let m2_4188: bitstring = em2_4187 in
                                    {3845}let (=OpenSecureChannelResponse,PartS_4189: bitstring,ST_4190: bitstring,TTL_4191: bitstring) = m2_4188 in
                                    {3846}let Kcli_4192: bitstring = exp(PartS_4189,Nc_4184) in
                                    {3847}out(c, senc(mCli(pkCli_3609,pkSess_4181),Kcli_4192))
                            )
                            else
                                {3848}let pkSess_4193: bitstring = fail-any in
                                {3849}out(c, GetEndpointRequest);
                                {3850}in(c, (=GetEndpointResponse,=pkSess_4193,=None,SP_4194: bitstring,UP_4195: bitstring));
                                {3851}new Nc_4196: bitstring;
                                {3852}let gNc_4197: bitstring = exp(g,Nc_4196) in
                                {3853}let m1_4198: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4197) in
                                {3854}out(c, (pkCli_3609,m1_4198));
                                {3855}in(c, em2_4199: bitstring);
                                {3856}let m2_4200: bitstring = em2_4199 in
                                {3857}let (=OpenSecureChannelResponse,PartS_4201: bitstring,ST_4202: bitstring,TTL_4203: bitstring) = m2_4200 in
                                {3858}let Kcli_4204: bitstring = exp(PartS_4201,Nc_4196) in
                                {3859}out(c, senc(mCli(pkCli_3609,pkSess_4193),Kcli_4204))
                    )
                    else
                        {3860}let pkSess_4205: bitstring = fail-any in
                        {3861}out(c, GetEndpointRequest);
                        {3862}in(c, (=GetEndpointResponse,=pkSess_4205,=None,SP_4206: bitstring,UP_4207: bitstring));
                        {3863}new Nc_4208: bitstring;
                        {3864}let gNc_4209: bitstring = exp(g,Nc_4208) in
                        {3865}let m1_4210: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4209) in
                        {3866}out(c, (pkCli_3609,m1_4210));
                        {3867}in(c, em2_4211: bitstring);
                        {3868}let m2_4212: bitstring = em2_4211 in
                        {3869}let (=OpenSecureChannelResponse,PartS_4213: bitstring,ST_4214: bitstring,TTL_4215: bitstring) = m2_4212 in
                        {3870}let Kcli_4216: bitstring = exp(PartS_4213,Nc_4208) in
                        {3871}out(c, senc(mCli(pkCli_3609,pkSess_4205),Kcli_4216))
            )
            else
                {3872}let pkSess_4217: bitstring = fail-any in
                {3873}out(c, GetEndpointRequest);
                {3874}in(c, (=GetEndpointResponse,=pkSess_4217,=None,SP_4218: bitstring,UP_4219: bitstring));
                {3875}new Nc_4220: bitstring;
                {3876}let gNc_4221: bitstring = exp(g,Nc_4220) in
                {3877}let m1_4222: bitstring = (OpenSecureChannelRequest,pkCli_3609,gNc_4221) in
                {3878}out(c, (pkCli_3609,m1_4222));
                {3879}in(c, em2_4223: bitstring);
                {3880}let m2_4224: bitstring = em2_4223 in
                {3881}let (=OpenSecureChannelResponse,PartS_4225: bitstring,ST_4226: bitstring,TTL_4227: bitstring) = m2_4224 in
                {3882}let Kcli_4228: bitstring = exp(PartS_4225,Nc_4220) in
                {3883}out(c, senc(mCli(pkCli_3609,pkSess_4217),Kcli_4228))
) | (
    {3884}!
    {3885}in(c, (Cli_4229: host,Disco_4230: host,Sess_4231: host));
    {3886}let v_4232: bool = (Disco_4230 = A) in
    (
        {3887}if v_4232 then
        (
            {3888}let skDisco: bitstring = skA in
            {3889}let pkDisco_4233: bitstring = pub(skDisco) in
            {3890}let v_4234: bool = (Cli_4229 = A) in
            (
                {3891}if v_4234 then
                (
                    {3892}let pkCli_4235: bitstring = pub(skA) in
                    {3893}let v_4236: bool = (Sess_4231 = A) in
                    (
                        {3894}if v_4236 then
                        (
                            {3895}let pkSess_4237: bitstring = pub(skA) in
                            {3896}in(c, =GetEndpointRequest);
                            {3897}new SP_4238: bitstring;
                            {3898}new UP_4239: bitstring;
                            {3899}out(c, (GetEndpointResponse,pkSess_4237,None,SP_4238,UP_4239))
                        )
                        else
                            {3900}let v_4240: bool = (Sess_4231 = B) in
                            (
                                {3901}if v_4240 then
                                (
                                    {3902}let pkSess_4241: bitstring = pub(skB) in
                                    {3903}in(c, =GetEndpointRequest);
                                    {3904}new SP_4242: bitstring;
                                    {3905}new UP_4243: bitstring;
                                    {3906}out(c, (GetEndpointResponse,pkSess_4241,None,SP_4242,UP_4243))
                                )
                                else
                                    {3907}let v_4244: bool = (Sess_4231 = C) in
                                    (
                                        {3908}if v_4244 then
                                        (
                                            {3909}let pkSess_4245: bitstring = pub(skC) in
                                            {3910}in(c, =GetEndpointRequest);
                                            {3911}new SP_4246: bitstring;
                                            {3912}new UP_4247: bitstring;
                                            {3913}out(c, (GetEndpointResponse,pkSess_4245,None,SP_4246,UP_4247))
                                        )
                                        else
                                            {3914}let pkSess_4248: bitstring = pub(sk(Sess_4231)) in
                                            {3915}in(c, =GetEndpointRequest);
                                            {3916}new SP_4249: bitstring;
                                            {3917}new UP_4250: bitstring;
                                            {3918}out(c, (GetEndpointResponse,pkSess_4248,None,SP_4249,UP_4250))
                                    )
                                    else
                                        {3919}let pkSess_4251: bitstring = fail-any in
                                        {3920}in(c, =GetEndpointRequest);
                                        {3921}new SP_4252: bitstring;
                                        {3922}new UP_4253: bitstring;
                                        {3923}out(c, (GetEndpointResponse,pkSess_4251,None,SP_4252,UP_4253))
                            )
                            else
                                {3924}let pkSess_4254: bitstring = fail-any in
                                {3925}in(c, =GetEndpointRequest);
                                {3926}new SP_4255: bitstring;
                                {3927}new UP_4256: bitstring;
                                {3928}out(c, (GetEndpointResponse,pkSess_4254,None,SP_4255,UP_4256))
                    )
                    else
                        {3929}let pkSess_4257: bitstring = fail-any in
                        {3930}in(c, =GetEndpointRequest);
                        {3931}new SP_4258: bitstring;
                        {3932}new UP_4259: bitstring;
                        {3933}out(c, (GetEndpointResponse,pkSess_4257,None,SP_4258,UP_4259))
                )
                else
                    {3934}let v_4260: bool = (Cli_4229 = B) in
                    (
                        {3935}if v_4260 then
                        (
                            {3936}let pkCli_4261: bitstring = pub(skB) in
                            {3937}let v_4262: bool = (Sess_4231 = A) in
                            (
                                {3938}if v_4262 then
                                (
                                    {3939}let pkSess_4263: bitstring = pub(skA) in
                                    {3940}in(c, =GetEndpointRequest);
                                    {3941}new SP_4264: bitstring;
                                    {3942}new UP_4265: bitstring;
                                    {3943}out(c, (GetEndpointResponse,pkSess_4263,None,SP_4264,UP_4265))
                                )
                                else
                                    {3944}let v_4266: bool = (Sess_4231 = B) in
                                    (
                                        {3945}if v_4266 then
                                        (
                                            {3946}let pkSess_4267: bitstring = pub(skB) in
                                            {3947}in(c, =GetEndpointRequest);
                                            {3948}new SP_4268: bitstring;
                                            {3949}new UP_4269: bitstring;
                                            {3950}out(c, (GetEndpointResponse,pkSess_4267,None,SP_4268,UP_4269))
                                        )
                                        else
                                            {3951}let v_4270: bool = (Sess_4231 = C) in
                                            (
                                                {3952}if v_4270 then
                                                (
                                                    {3953}let pkSess_4271: bitstring = pub(skC) in
                                                    {3954}in(c, =GetEndpointRequest);
                                                    {3955}new SP_4272: bitstring;
                                                    {3956}new UP_4273: bitstring;
                                                    {3957}out(c, (GetEndpointResponse,pkSess_4271,None,SP_4272,UP_4273))
                                                )
                                                else
                                                    {3958}let pkSess_4274: bitstring = pub(sk(Sess_4231)) in
                                                    {3959}in(c, =GetEndpointRequest);
                                                    {3960}new SP_4275: bitstring;
                                                    {3961}new UP_4276: bitstring;
                                                    {3962}out(c, (GetEndpointResponse,pkSess_4274,None,SP_4275,UP_4276))
                                            )
                                            else
                                                {3963}let pkSess_4277: bitstring = fail-any in
                                                {3964}in(c, =GetEndpointRequest);
                                                {3965}new SP_4278: bitstring;
                                                {3966}new UP_4279: bitstring;
                                                {3967}out(c, (GetEndpointResponse,pkSess_4277,None,SP_4278,UP_4279))
                                    )
                                    else
                                        {3968}let pkSess_4280: bitstring = fail-any in
                                        {3969}in(c, =GetEndpointRequest);
                                        {3970}new SP_4281: bitstring;
                                        {3971}new UP_4282: bitstring;
                                        {3972}out(c, (GetEndpointResponse,pkSess_4280,None,SP_4281,UP_4282))
                            )
                            else
                                {3973}let pkSess_4283: bitstring = fail-any in
                                {3974}in(c, =GetEndpointRequest);
                                {3975}new SP_4284: bitstring;
                                {3976}new UP_4285: bitstring;
                                {3977}out(c, (GetEndpointResponse,pkSess_4283,None,SP_4284,UP_4285))
                        )
                        else
                            {3978}let v_4286: bool = (Cli_4229 = C) in
                            (
                                {3979}if v_4286 then
                                (
                                    {3980}let pkCli_4287: bitstring = pub(skC) in
                                    {3981}let v_4288: bool = (Sess_4231 = A) in
                                    (
                                        {3982}if v_4288 then
                                        (
                                            {3983}let pkSess_4289: bitstring = pub(skA) in
                                            {3984}in(c, =GetEndpointRequest);
                                            {3985}new SP_4290: bitstring;
                                            {3986}new UP_4291: bitstring;
                                            {3987}out(c, (GetEndpointResponse,pkSess_4289,None,SP_4290,UP_4291))
                                        )
                                        else
                                            {3988}let v_4292: bool = (Sess_4231 = B) in
                                            (
                                                {3989}if v_4292 then
                                                (
                                                    {3990}let pkSess_4293: bitstring = pub(skB) in
                                                    {3991}in(c, =GetEndpointRequest);
                                                    {3992}new SP_4294: bitstring;
                                                    {3993}new UP_4295: bitstring;
                                                    {3994}out(c, (GetEndpointResponse,pkSess_4293,None,SP_4294,UP_4295))
                                                )
                                                else
                                                    {3995}let v_4296: bool = (Sess_4231 = C) in
                                                    (
                                                        {3996}if v_4296 then
                                                        (
                                                            {3997}let pkSess_4297: bitstring = pub(skC) in
                                                            {3998}in(c, =GetEndpointRequest);
                                                            {3999}new SP_4298: bitstring;
                                                            {4000}new UP_4299: bitstring;
                                                            {4001}out(c, (GetEndpointResponse,pkSess_4297,None,SP_4298,UP_4299))
                                                        )
                                                        else
                                                            {4002}let pkSess_4300: bitstring = pub(sk(Sess_4231)) in
                                                            {4003}in(c, =GetEndpointRequest);
                                                            {4004}new SP_4301: bitstring;
                                                            {4005}new UP_4302: bitstring;
                                                            {4006}out(c, (GetEndpointResponse,pkSess_4300,None,SP_4301,UP_4302))
                                                    )
                                                    else
                                                        {4007}let pkSess_4303: bitstring = fail-any in
                                                        {4008}in(c, =GetEndpointRequest);
                                                        {4009}new SP_4304: bitstring;
                                                        {4010}new UP_4305: bitstring;
                                                        {4011}out(c, (GetEndpointResponse,pkSess_4303,None,SP_4304,UP_4305))
                                            )
                                            else
                                                {4012}let pkSess_4306: bitstring = fail-any in
                                                {4013}in(c, =GetEndpointRequest);
                                                {4014}new SP_4307: bitstring;
                                                {4015}new UP_4308: bitstring;
                                                {4016}out(c, (GetEndpointResponse,pkSess_4306,None,SP_4307,UP_4308))
                                    )
                                    else
                                        {4017}let pkSess_4309: bitstring = fail-any in
                                        {4018}in(c, =GetEndpointRequest);
                                        {4019}new SP_4310: bitstring;
                                        {4020}new UP_4311: bitstring;
                                        {4021}out(c, (GetEndpointResponse,pkSess_4309,None,SP_4310,UP_4311))
                                )
                                else
                                    {4022}let pkCli_4312: bitstring = pub(sk(Cli_4229)) in
                                    {4023}let v_4313: bool = (Sess_4231 = A) in
                                    (
                                        {4024}if v_4313 then
                                        (
                                            {4025}let pkSess_4314: bitstring = pub(skA) in
                                            {4026}in(c, =GetEndpointRequest);
                                            {4027}new SP_4315: bitstring;
                                            {4028}new UP_4316: bitstring;
                                            {4029}out(c, (GetEndpointResponse,pkSess_4314,None,SP_4315,UP_4316))
                                        )
                                        else
                                            {4030}let v_4317: bool = (Sess_4231 = B) in
                                            (
                                                {4031}if v_4317 then
                                                (
                                                    {4032}let pkSess_4318: bitstring = pub(skB) in
                                                    {4033}in(c, =GetEndpointRequest);
                                                    {4034}new SP_4319: bitstring;
                                                    {4035}new UP_4320: bitstring;
                                                    {4036}out(c, (GetEndpointResponse,pkSess_4318,None,SP_4319,UP_4320))
                                                )
                                                else
                                                    {4037}let v_4321: bool = (Sess_4231 = C) in
                                                    (
                                                        {4038}if v_4321 then
                                                        (
                                                            {4039}let pkSess_4322: bitstring = pub(skC) in
                                                            {4040}in(c, =GetEndpointRequest);
                                                            {4041}new SP_4323: bitstring;
                                                            {4042}new UP_4324: bitstring;
                                                            {4043}out(c, (GetEndpointResponse,pkSess_4322,None,SP_4323,UP_4324))
                                                        )
                                                        else
                                                            {4044}let pkSess_4325: bitstring = pub(sk(Sess_4231)) in
                                                            {4045}in(c, =GetEndpointRequest);
                                                            {4046}new SP_4326: bitstring;
                                                            {4047}new UP_4327: bitstring;
                                                            {4048}out(c, (GetEndpointResponse,pkSess_4325,None,SP_4326,UP_4327))
                                                    )
                                                    else
                                                        {4049}let pkSess_4328: bitstring = fail-any in
                                                        {4050}in(c, =GetEndpointRequest);
                                                        {4051}new SP_4329: bitstring;
                                                        {4052}new UP_4330: bitstring;
                                                        {4053}out(c, (GetEndpointResponse,pkSess_4328,None,SP_4329,UP_4330))
                                            )
                                            else
                                                {4054}let pkSess_4331: bitstring = fail-any in
                                                {4055}in(c, =GetEndpointRequest);
                                                {4056}new SP_4332: bitstring;
                                                {4057}new UP_4333: bitstring;
                                                {4058}out(c, (GetEndpointResponse,pkSess_4331,None,SP_4332,UP_4333))
                                    )
                                    else
                                        {4059}let pkSess_4334: bitstring = fail-any in
                                        {4060}in(c, =GetEndpointRequest);
                                        {4061}new SP_4335: bitstring;
                                        {4062}new UP_4336: bitstring;
                                        {4063}out(c, (GetEndpointResponse,pkSess_4334,None,SP_4335,UP_4336))
                            )
                            else
                                {4064}let pkCli_4337: bitstring = fail-any in
                                {4065}let v_4338: bool = (Sess_4231 = A) in
                                (
                                    {4066}if v_4338 then
                                    (
                                        {4067}let pkSess_4339: bitstring = pub(skA) in
                                        {4068}in(c, =GetEndpointRequest);
                                        {4069}new SP_4340: bitstring;
                                        {4070}new UP_4341: bitstring;
                                        {4071}out(c, (GetEndpointResponse,pkSess_4339,None,SP_4340,UP_4341))
                                    )
                                    else
                                        {4072}let v_4342: bool = (Sess_4231 = B) in
                                        (
                                            {4073}if v_4342 then
                                            (
                                                {4074}let pkSess_4343: bitstring = pub(skB) in
                                                {4075}in(c, =GetEndpointRequest);
                                                {4076}new SP_4344: bitstring;
                                                {4077}new UP_4345: bitstring;
                                                {4078}out(c, (GetEndpointResponse,pkSess_4343,None,SP_4344,UP_4345))
                                            )
                                            else
                                                {4079}let v_4346: bool = (Sess_4231 = C) in
                                                (
                                                    {4080}if v_4346 then
                                                    (
                                                        {4081}let pkSess_4347: bitstring = pub(skC) in
                                                        {4082}in(c, =GetEndpointRequest);
                                                        {4083}new SP_4348: bitstring;
                                                        {4084}new UP_4349: bitstring;
                                                        {4085}out(c, (GetEndpointResponse,pkSess_4347,None,SP_4348,UP_4349))
                                                    )
                                                    else
                                                        {4086}let pkSess_4350: bitstring = pub(sk(Sess_4231)) in
                                                        {4087}in(c, =GetEndpointRequest);
                                                        {4088}new SP_4351: bitstring;
                                                        {4089}new UP_4352: bitstring;
                                                        {4090}out(c, (GetEndpointResponse,pkSess_4350,None,SP_4351,UP_4352))
                                                )
                                                else
                                                    {4091}let pkSess_4353: bitstring = fail-any in
                                                    {4092}in(c, =GetEndpointRequest);
                                                    {4093}new SP_4354: bitstring;
                                                    {4094}new UP_4355: bitstring;
                                                    {4095}out(c, (GetEndpointResponse,pkSess_4353,None,SP_4354,UP_4355))
                                        )
                                        else
                                            {4096}let pkSess_4356: bitstring = fail-any in
                                            {4097}in(c, =GetEndpointRequest);
                                            {4098}new SP_4357: bitstring;
                                            {4099}new UP_4358: bitstring;
                                            {4100}out(c, (GetEndpointResponse,pkSess_4356,None,SP_4357,UP_4358))
                                )
                                else
                                    {4101}let pkSess_4359: bitstring = fail-any in
                                    {4102}in(c, =GetEndpointRequest);
                                    {4103}new SP_4360: bitstring;
                                    {4104}new UP_4361: bitstring;
                                    {4105}out(c, (GetEndpointResponse,pkSess_4359,None,SP_4360,UP_4361))
                    )
                    else
                        {4106}let pkCli_4362: bitstring = fail-any in
                        {4107}let v_4363: bool = (Sess_4231 = A) in
                        (
                            {4108}if v_4363 then
                            (
                                {4109}let pkSess_4364: bitstring = pub(skA) in
                                {4110}in(c, =GetEndpointRequest);
                                {4111}new SP_4365: bitstring;
                                {4112}new UP_4366: bitstring;
                                {4113}out(c, (GetEndpointResponse,pkSess_4364,None,SP_4365,UP_4366))
                            )
                            else
                                {4114}let v_4367: bool = (Sess_4231 = B) in
                                (
                                    {4115}if v_4367 then
                                    (
                                        {4116}let pkSess_4368: bitstring = pub(skB) in
                                        {4117}in(c, =GetEndpointRequest);
                                        {4118}new SP_4369: bitstring;
                                        {4119}new UP_4370: bitstring;
                                        {4120}out(c, (GetEndpointResponse,pkSess_4368,None,SP_4369,UP_4370))
                                    )
                                    else
                                        {4121}let v_4371: bool = (Sess_4231 = C) in
                                        (
                                            {4122}if v_4371 then
                                            (
                                                {4123}let pkSess_4372: bitstring = pub(skC) in
                                                {4124}in(c, =GetEndpointRequest);
                                                {4125}new SP_4373: bitstring;
                                                {4126}new UP_4374: bitstring;
                                                {4127}out(c, (GetEndpointResponse,pkSess_4372,None,SP_4373,UP_4374))
                                            )
                                            else
                                                {4128}let pkSess_4375: bitstring = pub(sk(Sess_4231)) in
                                                {4129}in(c, =GetEndpointRequest);
                                                {4130}new SP_4376: bitstring;
                                                {4131}new UP_4377: bitstring;
                                                {4132}out(c, (GetEndpointResponse,pkSess_4375,None,SP_4376,UP_4377))
                                        )
                                        else
                                            {4133}let pkSess_4378: bitstring = fail-any in
                                            {4134}in(c, =GetEndpointRequest);
                                            {4135}new SP_4379: bitstring;
                                            {4136}new UP_4380: bitstring;
                                            {4137}out(c, (GetEndpointResponse,pkSess_4378,None,SP_4379,UP_4380))
                                )
                                else
                                    {4138}let pkSess_4381: bitstring = fail-any in
                                    {4139}in(c, =GetEndpointRequest);
                                    {4140}new SP_4382: bitstring;
                                    {4141}new UP_4383: bitstring;
                                    {4142}out(c, (GetEndpointResponse,pkSess_4381,None,SP_4382,UP_4383))
                        )
                        else
                            {4143}let pkSess_4384: bitstring = fail-any in
                            {4144}in(c, =GetEndpointRequest);
                            {4145}new SP_4385: bitstring;
                            {4146}new UP_4386: bitstring;
                            {4147}out(c, (GetEndpointResponse,pkSess_4384,None,SP_4385,UP_4386))
            )
            else
                {4148}let pkCli_4387: bitstring = fail-any in
                {4149}let v_4388: bool = (Sess_4231 = A) in
                (
                    {4150}if v_4388 then
                    (
                        {4151}let pkSess_4389: bitstring = pub(skA) in
                        {4152}in(c, =GetEndpointRequest);
                        {4153}new SP_4390: bitstring;
                        {4154}new UP_4391: bitstring;
                        {4155}out(c, (GetEndpointResponse,pkSess_4389,None,SP_4390,UP_4391))
                    )
                    else
                        {4156}let v_4392: bool = (Sess_4231 = B) in
                        (
                            {4157}if v_4392 then
                            (
                                {4158}let pkSess_4393: bitstring = pub(skB) in
                                {4159}in(c, =GetEndpointRequest);
                                {4160}new SP_4394: bitstring;
                                {4161}new UP_4395: bitstring;
                                {4162}out(c, (GetEndpointResponse,pkSess_4393,None,SP_4394,UP_4395))
                            )
                            else
                                {4163}let v_4396: bool = (Sess_4231 = C) in
                                (
                                    {4164}if v_4396 then
                                    (
                                        {4165}let pkSess_4397: bitstring = pub(skC) in
                                        {4166}in(c, =GetEndpointRequest);
                                        {4167}new SP_4398: bitstring;
                                        {4168}new UP_4399: bitstring;
                                        {4169}out(c, (GetEndpointResponse,pkSess_4397,None,SP_4398,UP_4399))
                                    )
                                    else
                                        {4170}let pkSess_4400: bitstring = pub(sk(Sess_4231)) in
                                        {4171}in(c, =GetEndpointRequest);
                                        {4172}new SP_4401: bitstring;
                                        {4173}new UP_4402: bitstring;
                                        {4174}out(c, (GetEndpointResponse,pkSess_4400,None,SP_4401,UP_4402))
                                )
                                else
                                    {4175}let pkSess_4403: bitstring = fail-any in
                                    {4176}in(c, =GetEndpointRequest);
                                    {4177}new SP_4404: bitstring;
                                    {4178}new UP_4405: bitstring;
                                    {4179}out(c, (GetEndpointResponse,pkSess_4403,None,SP_4404,UP_4405))
                        )
                        else
                            {4180}let pkSess_4406: bitstring = fail-any in
                            {4181}in(c, =GetEndpointRequest);
                            {4182}new SP_4407: bitstring;
                            {4183}new UP_4408: bitstring;
                            {4184}out(c, (GetEndpointResponse,pkSess_4406,None,SP_4407,UP_4408))
                )
                else
                    {4185}let pkSess_4409: bitstring = fail-any in
                    {4186}in(c, =GetEndpointRequest);
                    {4187}new SP_4410: bitstring;
                    {4188}new UP_4411: bitstring;
                    {4189}out(c, (GetEndpointResponse,pkSess_4409,None,SP_4410,UP_4411))
        )
        else
            {4190}let v_4412: bool = (Disco_4230 = B) in
            (
                {4191}if v_4412 then
                (
                    {4192}let skDisco_4413: bitstring = skB in
                    {4193}let pkDisco_4414: bitstring = pub(skDisco_4413) in
                    {4194}let v_4415: bool = (Cli_4229 = A) in
                    (
                        {4195}if v_4415 then
                        (
                            {4196}let pkCli_4416: bitstring = pub(skA) in
                            {4197}let v_4417: bool = (Sess_4231 = A) in
                            (
                                {4198}if v_4417 then
                                (
                                    {4199}let pkSess_4418: bitstring = pub(skA) in
                                    {4200}in(c, =GetEndpointRequest);
                                    {4201}new SP_4419: bitstring;
                                    {4202}new UP_4420: bitstring;
                                    {4203}out(c, (GetEndpointResponse,pkSess_4418,None,SP_4419,UP_4420))
                                )
                                else
                                    {4204}let v_4421: bool = (Sess_4231 = B) in
                                    (
                                        {4205}if v_4421 then
                                        (
                                            {4206}let pkSess_4422: bitstring = pub(skB) in
                                            {4207}in(c, =GetEndpointRequest);
                                            {4208}new SP_4423: bitstring;
                                            {4209}new UP_4424: bitstring;
                                            {4210}out(c, (GetEndpointResponse,pkSess_4422,None,SP_4423,UP_4424))
                                        )
                                        else
                                            {4211}let v_4425: bool = (Sess_4231 = C) in
                                            (
                                                {4212}if v_4425 then
                                                (
                                                    {4213}let pkSess_4426: bitstring = pub(skC) in
                                                    {4214}in(c, =GetEndpointRequest);
                                                    {4215}new SP_4427: bitstring;
                                                    {4216}new UP_4428: bitstring;
                                                    {4217}out(c, (GetEndpointResponse,pkSess_4426,None,SP_4427,UP_4428))
                                                )
                                                else
                                                    {4218}let pkSess_4429: bitstring = pub(sk(Sess_4231)) in
                                                    {4219}in(c, =GetEndpointRequest);
                                                    {4220}new SP_4430: bitstring;
                                                    {4221}new UP_4431: bitstring;
                                                    {4222}out(c, (GetEndpointResponse,pkSess_4429,None,SP_4430,UP_4431))
                                            )
                                            else
                                                {4223}let pkSess_4432: bitstring = fail-any in
                                                {4224}in(c, =GetEndpointRequest);
                                                {4225}new SP_4433: bitstring;
                                                {4226}new UP_4434: bitstring;
                                                {4227}out(c, (GetEndpointResponse,pkSess_4432,None,SP_4433,UP_4434))
                                    )
                                    else
                                        {4228}let pkSess_4435: bitstring = fail-any in
                                        {4229}in(c, =GetEndpointRequest);
                                        {4230}new SP_4436: bitstring;
                                        {4231}new UP_4437: bitstring;
                                        {4232}out(c, (GetEndpointResponse,pkSess_4435,None,SP_4436,UP_4437))
                            )
                            else
                                {4233}let pkSess_4438: bitstring = fail-any in
                                {4234}in(c, =GetEndpointRequest);
                                {4235}new SP_4439: bitstring;
                                {4236}new UP_4440: bitstring;
                                {4237}out(c, (GetEndpointResponse,pkSess_4438,None,SP_4439,UP_4440))
                        )
                        else
                            {4238}let v_4441: bool = (Cli_4229 = B) in
                            (
                                {4239}if v_4441 then
                                (
                                    {4240}let pkCli_4442: bitstring = pub(skB) in
                                    {4241}let v_4443: bool = (Sess_4231 = A) in
                                    (
                                        {4242}if v_4443 then
                                        (
                                            {4243}let pkSess_4444: bitstring = pub(skA) in
                                            {4244}in(c, =GetEndpointRequest);
                                            {4245}new SP_4445: bitstring;
                                            {4246}new UP_4446: bitstring;
                                            {4247}out(c, (GetEndpointResponse,pkSess_4444,None,SP_4445,UP_4446))
                                        )
                                        else
                                            {4248}let v_4447: bool = (Sess_4231 = B) in
                                            (
                                                {4249}if v_4447 then
                                                (
                                                    {4250}let pkSess_4448: bitstring = pub(skB) in
                                                    {4251}in(c, =GetEndpointRequest);
                                                    {4252}new SP_4449: bitstring;
                                                    {4253}new UP_4450: bitstring;
                                                    {4254}out(c, (GetEndpointResponse,pkSess_4448,None,SP_4449,UP_4450))
                                                )
                                                else
                                                    {4255}let v_4451: bool = (Sess_4231 = C) in
                                                    (
                                                        {4256}if v_4451 then
                                                        (
                                                            {4257}let pkSess_4452: bitstring = pub(skC) in
                                                            {4258}in(c, =GetEndpointRequest);
                                                            {4259}new SP_4453: bitstring;
                                                            {4260}new UP_4454: bitstring;
                                                            {4261}out(c, (GetEndpointResponse,pkSess_4452,None,SP_4453,UP_4454))
                                                        )
                                                        else
                                                            {4262}let pkSess_4455: bitstring = pub(sk(Sess_4231)) in
                                                            {4263}in(c, =GetEndpointRequest);
                                                            {4264}new SP_4456: bitstring;
                                                            {4265}new UP_4457: bitstring;
                                                            {4266}out(c, (GetEndpointResponse,pkSess_4455,None,SP_4456,UP_4457))
                                                    )
                                                    else
                                                        {4267}let pkSess_4458: bitstring = fail-any in
                                                        {4268}in(c, =GetEndpointRequest);
                                                        {4269}new SP_4459: bitstring;
                                                        {4270}new UP_4460: bitstring;
                                                        {4271}out(c, (GetEndpointResponse,pkSess_4458,None,SP_4459,UP_4460))
                                            )
                                            else
                                                {4272}let pkSess_4461: bitstring = fail-any in
                                                {4273}in(c, =GetEndpointRequest);
                                                {4274}new SP_4462: bitstring;
                                                {4275}new UP_4463: bitstring;
                                                {4276}out(c, (GetEndpointResponse,pkSess_4461,None,SP_4462,UP_4463))
                                    )
                                    else
                                        {4277}let pkSess_4464: bitstring = fail-any in
                                        {4278}in(c, =GetEndpointRequest);
                                        {4279}new SP_4465: bitstring;
                                        {4280}new UP_4466: bitstring;
                                        {4281}out(c, (GetEndpointResponse,pkSess_4464,None,SP_4465,UP_4466))
                                )
                                else
                                    {4282}let v_4467: bool = (Cli_4229 = C) in
                                    (
                                        {4283}if v_4467 then
                                        (
                                            {4284}let pkCli_4468: bitstring = pub(skC) in
                                            {4285}let v_4469: bool = (Sess_4231 = A) in
                                            (
                                                {4286}if v_4469 then
                                                (
                                                    {4287}let pkSess_4470: bitstring = pub(skA) in
                                                    {4288}in(c, =GetEndpointRequest);
                                                    {4289}new SP_4471: bitstring;
                                                    {4290}new UP_4472: bitstring;
                                                    {4291}out(c, (GetEndpointResponse,pkSess_4470,None,SP_4471,UP_4472))
                                                )
                                                else
                                                    {4292}let v_4473: bool = (Sess_4231 = B) in
                                                    (
                                                        {4293}if v_4473 then
                                                        (
                                                            {4294}let pkSess_4474: bitstring = pub(skB) in
                                                            {4295}in(c, =GetEndpointRequest);
                                                            {4296}new SP_4475: bitstring;
                                                            {4297}new UP_4476: bitstring;
                                                            {4298}out(c, (GetEndpointResponse,pkSess_4474,None,SP_4475,UP_4476))
                                                        )
                                                        else
                                                            {4299}let v_4477: bool = (Sess_4231 = C) in
                                                            (
                                                                {4300}if v_4477 then
                                                                (
                                                                    {4301}let pkSess_4478: bitstring = pub(skC) in
                                                                    {4302}in(c, =GetEndpointRequest);
                                                                    {4303}new SP_4479: bitstring;
                                                                    {4304}new UP_4480: bitstring;
                                                                    {4305}out(c, (GetEndpointResponse,pkSess_4478,None,SP_4479,UP_4480))
                                                                )
                                                                else
                                                                    {4306}let pkSess_4481: bitstring = pub(sk(Sess_4231)) in
                                                                    {4307}in(c, =GetEndpointRequest);
                                                                    {4308}new SP_4482: bitstring;
                                                                    {4309}new UP_4483: bitstring;
                                                                    {4310}out(c, (GetEndpointResponse,pkSess_4481,None,SP_4482,UP_4483))
                                                            )
                                                            else
                                                                {4311}let pkSess_4484: bitstring = fail-any in
                                                                {4312}in(c, =GetEndpointRequest);
                                                                {4313}new SP_4485: bitstring;
                                                                {4314}new UP_4486: bitstring;
                                                                {4315}out(c, (GetEndpointResponse,pkSess_4484,None,SP_4485,UP_4486))
                                                    )
                                                    else
                                                        {4316}let pkSess_4487: bitstring = fail-any in
                                                        {4317}in(c, =GetEndpointRequest);
                                                        {4318}new SP_4488: bitstring;
                                                        {4319}new UP_4489: bitstring;
                                                        {4320}out(c, (GetEndpointResponse,pkSess_4487,None,SP_4488,UP_4489))
                                            )
                                            else
                                                {4321}let pkSess_4490: bitstring = fail-any in
                                                {4322}in(c, =GetEndpointRequest);
                                                {4323}new SP_4491: bitstring;
                                                {4324}new UP_4492: bitstring;
                                                {4325}out(c, (GetEndpointResponse,pkSess_4490,None,SP_4491,UP_4492))
                                        )
                                        else
                                            {4326}let pkCli_4493: bitstring = pub(sk(Cli_4229)) in
                                            {4327}let v_4494: bool = (Sess_4231 = A) in
                                            (
                                                {4328}if v_4494 then
                                                (
                                                    {4329}let pkSess_4495: bitstring = pub(skA) in
                                                    {4330}in(c, =GetEndpointRequest);
                                                    {4331}new SP_4496: bitstring;
                                                    {4332}new UP_4497: bitstring;
                                                    {4333}out(c, (GetEndpointResponse,pkSess_4495,None,SP_4496,UP_4497))
                                                )
                                                else
                                                    {4334}let v_4498: bool = (Sess_4231 = B) in
                                                    (
                                                        {4335}if v_4498 then
                                                        (
                                                            {4336}let pkSess_4499: bitstring = pub(skB) in
                                                            {4337}in(c, =GetEndpointRequest);
                                                            {4338}new SP_4500: bitstring;
                                                            {4339}new UP_4501: bitstring;
                                                            {4340}out(c, (GetEndpointResponse,pkSess_4499,None,SP_4500,UP_4501))
                                                        )
                                                        else
                                                            {4341}let v_4502: bool = (Sess_4231 = C) in
                                                            (
                                                                {4342}if v_4502 then
                                                                (
                                                                    {4343}let pkSess_4503: bitstring = pub(skC) in
                                                                    {4344}in(c, =GetEndpointRequest);
                                                                    {4345}new SP_4504: bitstring;
                                                                    {4346}new UP_4505: bitstring;
                                                                    {4347}out(c, (GetEndpointResponse,pkSess_4503,None,SP_4504,UP_4505))
                                                                )
                                                                else
                                                                    {4348}let pkSess_4506: bitstring = pub(sk(Sess_4231)) in
                                                                    {4349}in(c, =GetEndpointRequest);
                                                                    {4350}new SP_4507: bitstring;
                                                                    {4351}new UP_4508: bitstring;
                                                                    {4352}out(c, (GetEndpointResponse,pkSess_4506,None,SP_4507,UP_4508))
                                                            )
                                                            else
                                                                {4353}let pkSess_4509: bitstring = fail-any in
                                                                {4354}in(c, =GetEndpointRequest);
                                                                {4355}new SP_4510: bitstring;
                                                                {4356}new UP_4511: bitstring;
                                                                {4357}out(c, (GetEndpointResponse,pkSess_4509,None,SP_4510,UP_4511))
                                                    )
                                                    else
                                                        {4358}let pkSess_4512: bitstring = fail-any in
                                                        {4359}in(c, =GetEndpointRequest);
                                                        {4360}new SP_4513: bitstring;
                                                        {4361}new UP_4514: bitstring;
                                                        {4362}out(c, (GetEndpointResponse,pkSess_4512,None,SP_4513,UP_4514))
                                            )
                                            else
                                                {4363}let pkSess_4515: bitstring = fail-any in
                                                {4364}in(c, =GetEndpointRequest);
                                                {4365}new SP_4516: bitstring;
                                                {4366}new UP_4517: bitstring;
                                                {4367}out(c, (GetEndpointResponse,pkSess_4515,None,SP_4516,UP_4517))
                                    )
                                    else
                                        {4368}let pkCli_4518: bitstring = fail-any in
                                        {4369}let v_4519: bool = (Sess_4231 = A) in
                                        (
                                            {4370}if v_4519 then
                                            (
                                                {4371}let pkSess_4520: bitstring = pub(skA) in
                                                {4372}in(c, =GetEndpointRequest);
                                                {4373}new SP_4521: bitstring;
                                                {4374}new UP_4522: bitstring;
                                                {4375}out(c, (GetEndpointResponse,pkSess_4520,None,SP_4521,UP_4522))
                                            )
                                            else
                                                {4376}let v_4523: bool = (Sess_4231 = B) in
                                                (
                                                    {4377}if v_4523 then
                                                    (
                                                        {4378}let pkSess_4524: bitstring = pub(skB) in
                                                        {4379}in(c, =GetEndpointRequest);
                                                        {4380}new SP_4525: bitstring;
                                                        {4381}new UP_4526: bitstring;
                                                        {4382}out(c, (GetEndpointResponse,pkSess_4524,None,SP_4525,UP_4526))
                                                    )
                                                    else
                                                        {4383}let v_4527: bool = (Sess_4231 = C) in
                                                        (
                                                            {4384}if v_4527 then
                                                            (
                                                                {4385}let pkSess_4528: bitstring = pub(skC) in
                                                                {4386}in(c, =GetEndpointRequest);
                                                                {4387}new SP_4529: bitstring;
                                                                {4388}new UP_4530: bitstring;
                                                                {4389}out(c, (GetEndpointResponse,pkSess_4528,None,SP_4529,UP_4530))
                                                            )
                                                            else
                                                                {4390}let pkSess_4531: bitstring = pub(sk(Sess_4231)) in
                                                                {4391}in(c, =GetEndpointRequest);
                                                                {4392}new SP_4532: bitstring;
                                                                {4393}new UP_4533: bitstring;
                                                                {4394}out(c, (GetEndpointResponse,pkSess_4531,None,SP_4532,UP_4533))
                                                        )
                                                        else
                                                            {4395}let pkSess_4534: bitstring = fail-any in
                                                            {4396}in(c, =GetEndpointRequest);
                                                            {4397}new SP_4535: bitstring;
                                                            {4398}new UP_4536: bitstring;
                                                            {4399}out(c, (GetEndpointResponse,pkSess_4534,None,SP_4535,UP_4536))
                                                )
                                                else
                                                    {4400}let pkSess_4537: bitstring = fail-any in
                                                    {4401}in(c, =GetEndpointRequest);
                                                    {4402}new SP_4538: bitstring;
                                                    {4403}new UP_4539: bitstring;
                                                    {4404}out(c, (GetEndpointResponse,pkSess_4537,None,SP_4538,UP_4539))
                                        )
                                        else
                                            {4405}let pkSess_4540: bitstring = fail-any in
                                            {4406}in(c, =GetEndpointRequest);
                                            {4407}new SP_4541: bitstring;
                                            {4408}new UP_4542: bitstring;
                                            {4409}out(c, (GetEndpointResponse,pkSess_4540,None,SP_4541,UP_4542))
                            )
                            else
                                {4410}let pkCli_4543: bitstring = fail-any in
                                {4411}let v_4544: bool = (Sess_4231 = A) in
                                (
                                    {4412}if v_4544 then
                                    (
                                        {4413}let pkSess_4545: bitstring = pub(skA) in
                                        {4414}in(c, =GetEndpointRequest);
                                        {4415}new SP_4546: bitstring;
                                        {4416}new UP_4547: bitstring;
                                        {4417}out(c, (GetEndpointResponse,pkSess_4545,None,SP_4546,UP_4547))
                                    )
                                    else
                                        {4418}let v_4548: bool = (Sess_4231 = B) in
                                        (
                                            {4419}if v_4548 then
                                            (
                                                {4420}let pkSess_4549: bitstring = pub(skB) in
                                                {4421}in(c, =GetEndpointRequest);
                                                {4422}new SP_4550: bitstring;
                                                {4423}new UP_4551: bitstring;
                                                {4424}out(c, (GetEndpointResponse,pkSess_4549,None,SP_4550,UP_4551))
                                            )
                                            else
                                                {4425}let v_4552: bool = (Sess_4231 = C) in
                                                (
                                                    {4426}if v_4552 then
                                                    (
                                                        {4427}let pkSess_4553: bitstring = pub(skC) in
                                                        {4428}in(c, =GetEndpointRequest);
                                                        {4429}new SP_4554: bitstring;
                                                        {4430}new UP_4555: bitstring;
                                                        {4431}out(c, (GetEndpointResponse,pkSess_4553,None,SP_4554,UP_4555))
                                                    )
                                                    else
                                                        {4432}let pkSess_4556: bitstring = pub(sk(Sess_4231)) in
                                                        {4433}in(c, =GetEndpointRequest);
                                                        {4434}new SP_4557: bitstring;
                                                        {4435}new UP_4558: bitstring;
                                                        {4436}out(c, (GetEndpointResponse,pkSess_4556,None,SP_4557,UP_4558))
                                                )
                                                else
                                                    {4437}let pkSess_4559: bitstring = fail-any in
                                                    {4438}in(c, =GetEndpointRequest);
                                                    {4439}new SP_4560: bitstring;
                                                    {4440}new UP_4561: bitstring;
                                                    {4441}out(c, (GetEndpointResponse,pkSess_4559,None,SP_4560,UP_4561))
                                        )
                                        else
                                            {4442}let pkSess_4562: bitstring = fail-any in
                                            {4443}in(c, =GetEndpointRequest);
                                            {4444}new SP_4563: bitstring;
                                            {4445}new UP_4564: bitstring;
                                            {4446}out(c, (GetEndpointResponse,pkSess_4562,None,SP_4563,UP_4564))
                                )
                                else
                                    {4447}let pkSess_4565: bitstring = fail-any in
                                    {4448}in(c, =GetEndpointRequest);
                                    {4449}new SP_4566: bitstring;
                                    {4450}new UP_4567: bitstring;
                                    {4451}out(c, (GetEndpointResponse,pkSess_4565,None,SP_4566,UP_4567))
                    )
                    else
                        {4452}let pkCli_4568: bitstring = fail-any in
                        {4453}let v_4569: bool = (Sess_4231 = A) in
                        (
                            {4454}if v_4569 then
                            (
                                {4455}let pkSess_4570: bitstring = pub(skA) in
                                {4456}in(c, =GetEndpointRequest);
                                {4457}new SP_4571: bitstring;
                                {4458}new UP_4572: bitstring;
                                {4459}out(c, (GetEndpointResponse,pkSess_4570,None,SP_4571,UP_4572))
                            )
                            else
                                {4460}let v_4573: bool = (Sess_4231 = B) in
                                (
                                    {4461}if v_4573 then
                                    (
                                        {4462}let pkSess_4574: bitstring = pub(skB) in
                                        {4463}in(c, =GetEndpointRequest);
                                        {4464}new SP_4575: bitstring;
                                        {4465}new UP_4576: bitstring;
                                        {4466}out(c, (GetEndpointResponse,pkSess_4574,None,SP_4575,UP_4576))
                                    )
                                    else
                                        {4467}let v_4577: bool = (Sess_4231 = C) in
                                        (
                                            {4468}if v_4577 then
                                            (
                                                {4469}let pkSess_4578: bitstring = pub(skC) in
                                                {4470}in(c, =GetEndpointRequest);
                                                {4471}new SP_4579: bitstring;
                                                {4472}new UP_4580: bitstring;
                                                {4473}out(c, (GetEndpointResponse,pkSess_4578,None,SP_4579,UP_4580))
                                            )
                                            else
                                                {4474}let pkSess_4581: bitstring = pub(sk(Sess_4231)) in
                                                {4475}in(c, =GetEndpointRequest);
                                                {4476}new SP_4582: bitstring;
                                                {4477}new UP_4583: bitstring;
                                                {4478}out(c, (GetEndpointResponse,pkSess_4581,None,SP_4582,UP_4583))
                                        )
                                        else
                                            {4479}let pkSess_4584: bitstring = fail-any in
                                            {4480}in(c, =GetEndpointRequest);
                                            {4481}new SP_4585: bitstring;
                                            {4482}new UP_4586: bitstring;
                                            {4483}out(c, (GetEndpointResponse,pkSess_4584,None,SP_4585,UP_4586))
                                )
                                else
                                    {4484}let pkSess_4587: bitstring = fail-any in
                                    {4485}in(c, =GetEndpointRequest);
                                    {4486}new SP_4588: bitstring;
                                    {4487}new UP_4589: bitstring;
                                    {4488}out(c, (GetEndpointResponse,pkSess_4587,None,SP_4588,UP_4589))
                        )
                        else
                            {4489}let pkSess_4590: bitstring = fail-any in
                            {4490}in(c, =GetEndpointRequest);
                            {4491}new SP_4591: bitstring;
                            {4492}new UP_4592: bitstring;
                            {4493}out(c, (GetEndpointResponse,pkSess_4590,None,SP_4591,UP_4592))
                )
                else
                    {4494}let =true = (Disco_4230 = C) in
                    (
                        {4495}let skDisco_4593: bitstring = skC in
                        {4496}let pkDisco_4594: bitstring = pub(skDisco_4593) in
                        {4497}let v_4595: bool = (Cli_4229 = A) in
                        (
                            {4498}if v_4595 then
                            (
                                {4499}let pkCli_4596: bitstring = pub(skA) in
                                {4500}let v_4597: bool = (Sess_4231 = A) in
                                (
                                    {4501}if v_4597 then
                                    (
                                        {4502}let pkSess_4598: bitstring = pub(skA) in
                                        {4503}in(c, =GetEndpointRequest);
                                        {4504}new SP_4599: bitstring;
                                        {4505}new UP_4600: bitstring;
                                        {4506}out(c, (GetEndpointResponse,pkSess_4598,None,SP_4599,UP_4600))
                                    )
                                    else
                                        {4507}let v_4601: bool = (Sess_4231 = B) in
                                        (
                                            {4508}if v_4601 then
                                            (
                                                {4509}let pkSess_4602: bitstring = pub(skB) in
                                                {4510}in(c, =GetEndpointRequest);
                                                {4511}new SP_4603: bitstring;
                                                {4512}new UP_4604: bitstring;
                                                {4513}out(c, (GetEndpointResponse,pkSess_4602,None,SP_4603,UP_4604))
                                            )
                                            else
                                                {4514}let v_4605: bool = (Sess_4231 = C) in
                                                (
                                                    {4515}if v_4605 then
                                                    (
                                                        {4516}let pkSess_4606: bitstring = pub(skC) in
                                                        {4517}in(c, =GetEndpointRequest);
                                                        {4518}new SP_4607: bitstring;
                                                        {4519}new UP_4608: bitstring;
                                                        {4520}out(c, (GetEndpointResponse,pkSess_4606,None,SP_4607,UP_4608))
                                                    )
                                                    else
                                                        {4521}let pkSess_4609: bitstring = pub(sk(Sess_4231)) in
                                                        {4522}in(c, =GetEndpointRequest);
                                                        {4523}new SP_4610: bitstring;
                                                        {4524}new UP_4611: bitstring;
                                                        {4525}out(c, (GetEndpointResponse,pkSess_4609,None,SP_4610,UP_4611))
                                                )
                                                else
                                                    {4526}let pkSess_4612: bitstring = fail-any in
                                                    {4527}in(c, =GetEndpointRequest);
                                                    {4528}new SP_4613: bitstring;
                                                    {4529}new UP_4614: bitstring;
                                                    {4530}out(c, (GetEndpointResponse,pkSess_4612,None,SP_4613,UP_4614))
                                        )
                                        else
                                            {4531}let pkSess_4615: bitstring = fail-any in
                                            {4532}in(c, =GetEndpointRequest);
                                            {4533}new SP_4616: bitstring;
                                            {4534}new UP_4617: bitstring;
                                            {4535}out(c, (GetEndpointResponse,pkSess_4615,None,SP_4616,UP_4617))
                                )
                                else
                                    {4536}let pkSess_4618: bitstring = fail-any in
                                    {4537}in(c, =GetEndpointRequest);
                                    {4538}new SP_4619: bitstring;
                                    {4539}new UP_4620: bitstring;
                                    {4540}out(c, (GetEndpointResponse,pkSess_4618,None,SP_4619,UP_4620))
                            )
                            else
                                {4541}let v_4621: bool = (Cli_4229 = B) in
                                (
                                    {4542}if v_4621 then
                                    (
                                        {4543}let pkCli_4622: bitstring = pub(skB) in
                                        {4544}let v_4623: bool = (Sess_4231 = A) in
                                        (
                                            {4545}if v_4623 then
                                            (
                                                {4546}let pkSess_4624: bitstring = pub(skA) in
                                                {4547}in(c, =GetEndpointRequest);
                                                {4548}new SP_4625: bitstring;
                                                {4549}new UP_4626: bitstring;
                                                {4550}out(c, (GetEndpointResponse,pkSess_4624,None,SP_4625,UP_4626))
                                            )
                                            else
                                                {4551}let v_4627: bool = (Sess_4231 = B) in
                                                (
                                                    {4552}if v_4627 then
                                                    (
                                                        {4553}let pkSess_4628: bitstring = pub(skB) in
                                                        {4554}in(c, =GetEndpointRequest);
                                                        {4555}new SP_4629: bitstring;
                                                        {4556}new UP_4630: bitstring;
                                                        {4557}out(c, (GetEndpointResponse,pkSess_4628,None,SP_4629,UP_4630))
                                                    )
                                                    else
                                                        {4558}let v_4631: bool = (Sess_4231 = C) in
                                                        (
                                                            {4559}if v_4631 then
                                                            (
                                                                {4560}let pkSess_4632: bitstring = pub(skC) in
                                                                {4561}in(c, =GetEndpointRequest);
                                                                {4562}new SP_4633: bitstring;
                                                                {4563}new UP_4634: bitstring;
                                                                {4564}out(c, (GetEndpointResponse,pkSess_4632,None,SP_4633,UP_4634))
                                                            )
                                                            else
                                                                {4565}let pkSess_4635: bitstring = pub(sk(Sess_4231)) in
                                                                {4566}in(c, =GetEndpointRequest);
                                                                {4567}new SP_4636: bitstring;
                                                                {4568}new UP_4637: bitstring;
                                                                {4569}out(c, (GetEndpointResponse,pkSess_4635,None,SP_4636,UP_4637))
                                                        )
                                                        else
                                                            {4570}let pkSess_4638: bitstring = fail-any in
                                                            {4571}in(c, =GetEndpointRequest);
                                                            {4572}new SP_4639: bitstring;
                                                            {4573}new UP_4640: bitstring;
                                                            {4574}out(c, (GetEndpointResponse,pkSess_4638,None,SP_4639,UP_4640))
                                                )
                                                else
                                                    {4575}let pkSess_4641: bitstring = fail-any in
                                                    {4576}in(c, =GetEndpointRequest);
                                                    {4577}new SP_4642: bitstring;
                                                    {4578}new UP_4643: bitstring;
                                                    {4579}out(c, (GetEndpointResponse,pkSess_4641,None,SP_4642,UP_4643))
                                        )
                                        else
                                            {4580}let pkSess_4644: bitstring = fail-any in
                                            {4581}in(c, =GetEndpointRequest);
                                            {4582}new SP_4645: bitstring;
                                            {4583}new UP_4646: bitstring;
                                            {4584}out(c, (GetEndpointResponse,pkSess_4644,None,SP_4645,UP_4646))
                                    )
                                    else
                                        {4585}let v_4647: bool = (Cli_4229 = C) in
                                        (
                                            {4586}if v_4647 then
                                            (
                                                {4587}let pkCli_4648: bitstring = pub(skC) in
                                                {4588}let v_4649: bool = (Sess_4231 = A) in
                                                (
                                                    {4589}if v_4649 then
                                                    (
                                                        {4590}let pkSess_4650: bitstring = pub(skA) in
                                                        {4591}in(c, =GetEndpointRequest);
                                                        {4592}new SP_4651: bitstring;
                                                        {4593}new UP_4652: bitstring;
                                                        {4594}out(c, (GetEndpointResponse,pkSess_4650,None,SP_4651,UP_4652))
                                                    )
                                                    else
                                                        {4595}let v_4653: bool = (Sess_4231 = B) in
                                                        (
                                                            {4596}if v_4653 then
                                                            (
                                                                {4597}let pkSess_4654: bitstring = pub(skB) in
                                                                {4598}in(c, =GetEndpointRequest);
                                                                {4599}new SP_4655: bitstring;
                                                                {4600}new UP_4656: bitstring;
                                                                {4601}out(c, (GetEndpointResponse,pkSess_4654,None,SP_4655,UP_4656))
                                                            )
                                                            else
                                                                {4602}let v_4657: bool = (Sess_4231 = C) in
                                                                (
                                                                    {4603}if v_4657 then
                                                                    (
                                                                        {4604}let pkSess_4658: bitstring = pub(skC) in
                                                                        {4605}in(c, =GetEndpointRequest);
                                                                        {4606}new SP_4659: bitstring;
                                                                        {4607}new UP_4660: bitstring;
                                                                        {4608}out(c, (GetEndpointResponse,pkSess_4658,None,SP_4659,UP_4660))
                                                                    )
                                                                    else
                                                                        {4609}let pkSess_4661: bitstring = pub(sk(Sess_4231)) in
                                                                        {4610}in(c, =GetEndpointRequest);
                                                                        {4611}new SP_4662: bitstring;
                                                                        {4612}new UP_4663: bitstring;
                                                                        {4613}out(c, (GetEndpointResponse,pkSess_4661,None,SP_4662,UP_4663))
                                                                )
                                                                else
                                                                    {4614}let pkSess_4664: bitstring = fail-any in
                                                                    {4615}in(c, =GetEndpointRequest);
                                                                    {4616}new SP_4665: bitstring;
                                                                    {4617}new UP_4666: bitstring;
                                                                    {4618}out(c, (GetEndpointResponse,pkSess_4664,None,SP_4665,UP_4666))
                                                        )
                                                        else
                                                            {4619}let pkSess_4667: bitstring = fail-any in
                                                            {4620}in(c, =GetEndpointRequest);
                                                            {4621}new SP_4668: bitstring;
                                                            {4622}new UP_4669: bitstring;
                                                            {4623}out(c, (GetEndpointResponse,pkSess_4667,None,SP_4668,UP_4669))
                                                )
                                                else
                                                    {4624}let pkSess_4670: bitstring = fail-any in
                                                    {4625}in(c, =GetEndpointRequest);
                                                    {4626}new SP_4671: bitstring;
                                                    {4627}new UP_4672: bitstring;
                                                    {4628}out(c, (GetEndpointResponse,pkSess_4670,None,SP_4671,UP_4672))
                                            )
                                            else
                                                {4629}let pkCli_4673: bitstring = pub(sk(Cli_4229)) in
                                                {4630}let v_4674: bool = (Sess_4231 = A) in
                                                (
                                                    {4631}if v_4674 then
                                                    (
                                                        {4632}let pkSess_4675: bitstring = pub(skA) in
                                                        {4633}in(c, =GetEndpointRequest);
                                                        {4634}new SP_4676: bitstring;
                                                        {4635}new UP_4677: bitstring;
                                                        {4636}out(c, (GetEndpointResponse,pkSess_4675,None,SP_4676,UP_4677))
                                                    )
                                                    else
                                                        {4637}let v_4678: bool = (Sess_4231 = B) in
                                                        (
                                                            {4638}if v_4678 then
                                                            (
                                                                {4639}let pkSess_4679: bitstring = pub(skB) in
                                                                {4640}in(c, =GetEndpointRequest);
                                                                {4641}new SP_4680: bitstring;
                                                                {4642}new UP_4681: bitstring;
                                                                {4643}out(c, (GetEndpointResponse,pkSess_4679,None,SP_4680,UP_4681))
                                                            )
                                                            else
                                                                {4644}let v_4682: bool = (Sess_4231 = C) in
                                                                (
                                                                    {4645}if v_4682 then
                                                                    (
                                                                        {4646}let pkSess_4683: bitstring = pub(skC) in
                                                                        {4647}in(c, =GetEndpointRequest);
                                                                        {4648}new SP_4684: bitstring;
                                                                        {4649}new UP_4685: bitstring;
                                                                        {4650}out(c, (GetEndpointResponse,pkSess_4683,None,SP_4684,UP_4685))
                                                                    )
                                                                    else
                                                                        {4651}let pkSess_4686: bitstring = pub(sk(Sess_4231)) in
                                                                        {4652}in(c, =GetEndpointRequest);
                                                                        {4653}new SP_4687: bitstring;
                                                                        {4654}new UP_4688: bitstring;
                                                                        {4655}out(c, (GetEndpointResponse,pkSess_4686,None,SP_4687,UP_4688))
                                                                )
                                                                else
                                                                    {4656}let pkSess_4689: bitstring = fail-any in
                                                                    {4657}in(c, =GetEndpointRequest);
                                                                    {4658}new SP_4690: bitstring;
                                                                    {4659}new UP_4691: bitstring;
                                                                    {4660}out(c, (GetEndpointResponse,pkSess_4689,None,SP_4690,UP_4691))
                                                        )
                                                        else
                                                            {4661}let pkSess_4692: bitstring = fail-any in
                                                            {4662}in(c, =GetEndpointRequest);
                                                            {4663}new SP_4693: bitstring;
                                                            {4664}new UP_4694: bitstring;
                                                            {4665}out(c, (GetEndpointResponse,pkSess_4692,None,SP_4693,UP_4694))
                                                )
                                                else
                                                    {4666}let pkSess_4695: bitstring = fail-any in
                                                    {4667}in(c, =GetEndpointRequest);
                                                    {4668}new SP_4696: bitstring;
                                                    {4669}new UP_4697: bitstring;
                                                    {4670}out(c, (GetEndpointResponse,pkSess_4695,None,SP_4696,UP_4697))
                                        )
                                        else
                                            {4671}let pkCli_4698: bitstring = fail-any in
                                            {4672}let v_4699: bool = (Sess_4231 = A) in
                                            (
                                                {4673}if v_4699 then
                                                (
                                                    {4674}let pkSess_4700: bitstring = pub(skA) in
                                                    {4675}in(c, =GetEndpointRequest);
                                                    {4676}new SP_4701: bitstring;
                                                    {4677}new UP_4702: bitstring;
                                                    {4678}out(c, (GetEndpointResponse,pkSess_4700,None,SP_4701,UP_4702))
                                                )
                                                else
                                                    {4679}let v_4703: bool = (Sess_4231 = B) in
                                                    (
                                                        {4680}if v_4703 then
                                                        (
                                                            {4681}let pkSess_4704: bitstring = pub(skB) in
                                                            {4682}in(c, =GetEndpointRequest);
                                                            {4683}new SP_4705: bitstring;
                                                            {4684}new UP_4706: bitstring;
                                                            {4685}out(c, (GetEndpointResponse,pkSess_4704,None,SP_4705,UP_4706))
                                                        )
                                                        else
                                                            {4686}let v_4707: bool = (Sess_4231 = C) in
                                                            (
                                                                {4687}if v_4707 then
                                                                (
                                                                    {4688}let pkSess_4708: bitstring = pub(skC) in
                                                                    {4689}in(c, =GetEndpointRequest);
                                                                    {4690}new SP_4709: bitstring;
                                                                    {4691}new UP_4710: bitstring;
                                                                    {4692}out(c, (GetEndpointResponse,pkSess_4708,None,SP_4709,UP_4710))
                                                                )
                                                                else
                                                                    {4693}let pkSess_4711: bitstring = pub(sk(Sess_4231)) in
                                                                    {4694}in(c, =GetEndpointRequest);
                                                                    {4695}new SP_4712: bitstring;
                                                                    {4696}new UP_4713: bitstring;
                                                                    {4697}out(c, (GetEndpointResponse,pkSess_4711,None,SP_4712,UP_4713))
                                                            )
                                                            else
                                                                {4698}let pkSess_4714: bitstring = fail-any in
                                                                {4699}in(c, =GetEndpointRequest);
                                                                {4700}new SP_4715: bitstring;
                                                                {4701}new UP_4716: bitstring;
                                                                {4702}out(c, (GetEndpointResponse,pkSess_4714,None,SP_4715,UP_4716))
                                                    )
                                                    else
                                                        {4703}let pkSess_4717: bitstring = fail-any in
                                                        {4704}in(c, =GetEndpointRequest);
                                                        {4705}new SP_4718: bitstring;
                                                        {4706}new UP_4719: bitstring;
                                                        {4707}out(c, (GetEndpointResponse,pkSess_4717,None,SP_4718,UP_4719))
                                            )
                                            else
                                                {4708}let pkSess_4720: bitstring = fail-any in
                                                {4709}in(c, =GetEndpointRequest);
                                                {4710}new SP_4721: bitstring;
                                                {4711}new UP_4722: bitstring;
                                                {4712}out(c, (GetEndpointResponse,pkSess_4720,None,SP_4721,UP_4722))
                                )
                                else
                                    {4713}let pkCli_4723: bitstring = fail-any in
                                    {4714}let v_4724: bool = (Sess_4231 = A) in
                                    (
                                        {4715}if v_4724 then
                                        (
                                            {4716}let pkSess_4725: bitstring = pub(skA) in
                                            {4717}in(c, =GetEndpointRequest);
                                            {4718}new SP_4726: bitstring;
                                            {4719}new UP_4727: bitstring;
                                            {4720}out(c, (GetEndpointResponse,pkSess_4725,None,SP_4726,UP_4727))
                                        )
                                        else
                                            {4721}let v_4728: bool = (Sess_4231 = B) in
                                            (
                                                {4722}if v_4728 then
                                                (
                                                    {4723}let pkSess_4729: bitstring = pub(skB) in
                                                    {4724}in(c, =GetEndpointRequest);
                                                    {4725}new SP_4730: bitstring;
                                                    {4726}new UP_4731: bitstring;
                                                    {4727}out(c, (GetEndpointResponse,pkSess_4729,None,SP_4730,UP_4731))
                                                )
                                                else
                                                    {4728}let v_4732: bool = (Sess_4231 = C) in
                                                    (
                                                        {4729}if v_4732 then
                                                        (
                                                            {4730}let pkSess_4733: bitstring = pub(skC) in
                                                            {4731}in(c, =GetEndpointRequest);
                                                            {4732}new SP_4734: bitstring;
                                                            {4733}new UP_4735: bitstring;
                                                            {4734}out(c, (GetEndpointResponse,pkSess_4733,None,SP_4734,UP_4735))
                                                        )
                                                        else
                                                            {4735}let pkSess_4736: bitstring = pub(sk(Sess_4231)) in
                                                            {4736}in(c, =GetEndpointRequest);
                                                            {4737}new SP_4737: bitstring;
                                                            {4738}new UP_4738: bitstring;
                                                            {4739}out(c, (GetEndpointResponse,pkSess_4736,None,SP_4737,UP_4738))
                                                    )
                                                    else
                                                        {4740}let pkSess_4739: bitstring = fail-any in
                                                        {4741}in(c, =GetEndpointRequest);
                                                        {4742}new SP_4740: bitstring;
                                                        {4743}new UP_4741: bitstring;
                                                        {4744}out(c, (GetEndpointResponse,pkSess_4739,None,SP_4740,UP_4741))
                                            )
                                            else
                                                {4745}let pkSess_4742: bitstring = fail-any in
                                                {4746}in(c, =GetEndpointRequest);
                                                {4747}new SP_4743: bitstring;
                                                {4748}new UP_4744: bitstring;
                                                {4749}out(c, (GetEndpointResponse,pkSess_4742,None,SP_4743,UP_4744))
                                    )
                                    else
                                        {4750}let pkSess_4745: bitstring = fail-any in
                                        {4751}in(c, =GetEndpointRequest);
                                        {4752}new SP_4746: bitstring;
                                        {4753}new UP_4747: bitstring;
                                        {4754}out(c, (GetEndpointResponse,pkSess_4745,None,SP_4746,UP_4747))
                        )
                        else
                            {4755}let pkCli_4748: bitstring = fail-any in
                            {4756}let v_4749: bool = (Sess_4231 = A) in
                            (
                                {4757}if v_4749 then
                                (
                                    {4758}let pkSess_4750: bitstring = pub(skA) in
                                    {4759}in(c, =GetEndpointRequest);
                                    {4760}new SP_4751: bitstring;
                                    {4761}new UP_4752: bitstring;
                                    {4762}out(c, (GetEndpointResponse,pkSess_4750,None,SP_4751,UP_4752))
                                )
                                else
                                    {4763}let v_4753: bool = (Sess_4231 = B) in
                                    (
                                        {4764}if v_4753 then
                                        (
                                            {4765}let pkSess_4754: bitstring = pub(skB) in
                                            {4766}in(c, =GetEndpointRequest);
                                            {4767}new SP_4755: bitstring;
                                            {4768}new UP_4756: bitstring;
                                            {4769}out(c, (GetEndpointResponse,pkSess_4754,None,SP_4755,UP_4756))
                                        )
                                        else
                                            {4770}let v_4757: bool = (Sess_4231 = C) in
                                            (
                                                {4771}if v_4757 then
                                                (
                                                    {4772}let pkSess_4758: bitstring = pub(skC) in
                                                    {4773}in(c, =GetEndpointRequest);
                                                    {4774}new SP_4759: bitstring;
                                                    {4775}new UP_4760: bitstring;
                                                    {4776}out(c, (GetEndpointResponse,pkSess_4758,None,SP_4759,UP_4760))
                                                )
                                                else
                                                    {4777}let pkSess_4761: bitstring = pub(sk(Sess_4231)) in
                                                    {4778}in(c, =GetEndpointRequest);
                                                    {4779}new SP_4762: bitstring;
                                                    {4780}new UP_4763: bitstring;
                                                    {4781}out(c, (GetEndpointResponse,pkSess_4761,None,SP_4762,UP_4763))
                                            )
                                            else
                                                {4782}let pkSess_4764: bitstring = fail-any in
                                                {4783}in(c, =GetEndpointRequest);
                                                {4784}new SP_4765: bitstring;
                                                {4785}new UP_4766: bitstring;
                                                {4786}out(c, (GetEndpointResponse,pkSess_4764,None,SP_4765,UP_4766))
                                    )
                                    else
                                        {4787}let pkSess_4767: bitstring = fail-any in
                                        {4788}in(c, =GetEndpointRequest);
                                        {4789}new SP_4768: bitstring;
                                        {4790}new UP_4769: bitstring;
                                        {4791}out(c, (GetEndpointResponse,pkSess_4767,None,SP_4768,UP_4769))
                            )
                            else
                                {4792}let pkSess_4770: bitstring = fail-any in
                                {4793}in(c, =GetEndpointRequest);
                                {4794}new SP_4771: bitstring;
                                {4795}new UP_4772: bitstring;
                                {4796}out(c, (GetEndpointResponse,pkSess_4770,None,SP_4771,UP_4772))
                    )
                    else
                        {4797}let skDisco_4773: bitstring = fail-any in
                        {4798}let pkDisco_4774: bitstring = pub(skDisco_4773) in
                        {4799}let v_4775: bool = (Cli_4229 = A) in
                        (
                            {4800}if v_4775 then
                            (
                                {4801}let pkCli_4776: bitstring = pub(skA) in
                                {4802}let v_4777: bool = (Sess_4231 = A) in
                                (
                                    {4803}if v_4777 then
                                    (
                                        {4804}let pkSess_4778: bitstring = pub(skA) in
                                        {4805}in(c, =GetEndpointRequest);
                                        {4806}new SP_4779: bitstring;
                                        {4807}new UP_4780: bitstring;
                                        {4808}out(c, (GetEndpointResponse,pkSess_4778,None,SP_4779,UP_4780))
                                    )
                                    else
                                        {4809}let v_4781: bool = (Sess_4231 = B) in
                                        (
                                            {4810}if v_4781 then
                                            (
                                                {4811}let pkSess_4782: bitstring = pub(skB) in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_4783: bitstring;
                                                {4814}new UP_4784: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_4782,None,SP_4783,UP_4784))
                                            )
                                            else
                                                {4816}let v_4785: bool = (Sess_4231 = C) in
                                                (
                                                    {4817}if v_4785 then
                                                    (
                                                        {4818}let pkSess_4786: bitstring = pub(skC) in
                                                        {4819}in(c, =GetEndpointRequest);
                                                        {4820}new SP_4787: bitstring;
                                                        {4821}new UP_4788: bitstring;
                                                        {4822}out(c, (GetEndpointResponse,pkSess_4786,None,SP_4787,UP_4788))
                                                    )
                                                    else
                                                        {4823}let pkSess_4789: bitstring = pub(sk(Sess_4231)) in
                                                        {4824}in(c, =GetEndpointRequest);
                                                        {4825}new SP_4790: bitstring;
                                                        {4826}new UP_4791: bitstring;
                                                        {4827}out(c, (GetEndpointResponse,pkSess_4789,None,SP_4790,UP_4791))
                                                )
                                                else
                                                    {4828}let pkSess_4792: bitstring = fail-any in
                                                    {4829}in(c, =GetEndpointRequest);
                                                    {4830}new SP_4793: bitstring;
                                                    {4831}new UP_4794: bitstring;
                                                    {4832}out(c, (GetEndpointResponse,pkSess_4792,None,SP_4793,UP_4794))
                                        )
                                        else
                                            {4833}let pkSess_4795: bitstring = fail-any in
                                            {4834}in(c, =GetEndpointRequest);
                                            {4835}new SP_4796: bitstring;
                                            {4836}new UP_4797: bitstring;
                                            {4837}out(c, (GetEndpointResponse,pkSess_4795,None,SP_4796,UP_4797))
                                )
                                else
                                    {4838}let pkSess_4798: bitstring = fail-any in
                                    {4839}in(c, =GetEndpointRequest);
                                    {4840}new SP_4799: bitstring;
                                    {4841}new UP_4800: bitstring;
                                    {4842}out(c, (GetEndpointResponse,pkSess_4798,None,SP_4799,UP_4800))
                            )
                            else
                                {4843}let v_4801: bool = (Cli_4229 = B) in
                                (
                                    {4844}if v_4801 then
                                    (
                                        {4845}let pkCli_4802: bitstring = pub(skB) in
                                        {4846}let v_4803: bool = (Sess_4231 = A) in
                                        (
                                            {4847}if v_4803 then
                                            (
                                                {4848}let pkSess_4804: bitstring = pub(skA) in
                                                {4849}in(c, =GetEndpointRequest);
                                                {4850}new SP_4805: bitstring;
                                                {4851}new UP_4806: bitstring;
                                                {4852}out(c, (GetEndpointResponse,pkSess_4804,None,SP_4805,UP_4806))
                                            )
                                            else
                                                {4853}let v_4807: bool = (Sess_4231 = B) in
                                                (
                                                    {4854}if v_4807 then
                                                    (
                                                        {4855}let pkSess_4808: bitstring = pub(skB) in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_4809: bitstring;
                                                        {4858}new UP_4810: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_4808,None,SP_4809,UP_4810))
                                                    )
                                                    else
                                                        {4860}let v_4811: bool = (Sess_4231 = C) in
                                                        (
                                                            {4861}if v_4811 then
                                                            (
                                                                {4862}let pkSess_4812: bitstring = pub(skC) in
                                                                {4863}in(c, =GetEndpointRequest);
                                                                {4864}new SP_4813: bitstring;
                                                                {4865}new UP_4814: bitstring;
                                                                {4866}out(c, (GetEndpointResponse,pkSess_4812,None,SP_4813,UP_4814))
                                                            )
                                                            else
                                                                {4867}let pkSess_4815: bitstring = pub(sk(Sess_4231)) in
                                                                {4868}in(c, =GetEndpointRequest);
                                                                {4869}new SP_4816: bitstring;
                                                                {4870}new UP_4817: bitstring;
                                                                {4871}out(c, (GetEndpointResponse,pkSess_4815,None,SP_4816,UP_4817))
                                                        )
                                                        else
                                                            {4872}let pkSess_4818: bitstring = fail-any in
                                                            {4873}in(c, =GetEndpointRequest);
                                                            {4874}new SP_4819: bitstring;
                                                            {4875}new UP_4820: bitstring;
                                                            {4876}out(c, (GetEndpointResponse,pkSess_4818,None,SP_4819,UP_4820))
                                                )
                                                else
                                                    {4877}let pkSess_4821: bitstring = fail-any in
                                                    {4878}in(c, =GetEndpointRequest);
                                                    {4879}new SP_4822: bitstring;
                                                    {4880}new UP_4823: bitstring;
                                                    {4881}out(c, (GetEndpointResponse,pkSess_4821,None,SP_4822,UP_4823))
                                        )
                                        else
                                            {4882}let pkSess_4824: bitstring = fail-any in
                                            {4883}in(c, =GetEndpointRequest);
                                            {4884}new SP_4825: bitstring;
                                            {4885}new UP_4826: bitstring;
                                            {4886}out(c, (GetEndpointResponse,pkSess_4824,None,SP_4825,UP_4826))
                                    )
                                    else
                                        {4887}let v_4827: bool = (Cli_4229 = C) in
                                        (
                                            {4888}if v_4827 then
                                            (
                                                {4889}let pkCli_4828: bitstring = pub(skC) in
                                                {4890}let v_4829: bool = (Sess_4231 = A) in
                                                (
                                                    {4891}if v_4829 then
                                                    (
                                                        {4892}let pkSess_4830: bitstring = pub(skA) in
                                                        {4893}in(c, =GetEndpointRequest);
                                                        {4894}new SP_4831: bitstring;
                                                        {4895}new UP_4832: bitstring;
                                                        {4896}out(c, (GetEndpointResponse,pkSess_4830,None,SP_4831,UP_4832))
                                                    )
                                                    else
                                                        {4897}let v_4833: bool = (Sess_4231 = B) in
                                                        (
                                                            {4898}if v_4833 then
                                                            (
                                                                {4899}let pkSess_4834: bitstring = pub(skB) in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_4835: bitstring;
                                                                {4902}new UP_4836: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_4834,None,SP_4835,UP_4836))
                                                            )
                                                            else
                                                                {4904}let v_4837: bool = (Sess_4231 = C) in
                                                                (
                                                                    {4905}if v_4837 then
                                                                    (
                                                                        {4906}let pkSess_4838: bitstring = pub(skC) in
                                                                        {4907}in(c, =GetEndpointRequest);
                                                                        {4908}new SP_4839: bitstring;
                                                                        {4909}new UP_4840: bitstring;
                                                                        {4910}out(c, (GetEndpointResponse,pkSess_4838,None,SP_4839,UP_4840))
                                                                    )
                                                                    else
                                                                        {4911}let pkSess_4841: bitstring = pub(sk(Sess_4231)) in
                                                                        {4912}in(c, =GetEndpointRequest);
                                                                        {4913}new SP_4842: bitstring;
                                                                        {4914}new UP_4843: bitstring;
                                                                        {4915}out(c, (GetEndpointResponse,pkSess_4841,None,SP_4842,UP_4843))
                                                                )
                                                                else
                                                                    {4916}let pkSess_4844: bitstring = fail-any in
                                                                    {4917}in(c, =GetEndpointRequest);
                                                                    {4918}new SP_4845: bitstring;
                                                                    {4919}new UP_4846: bitstring;
                                                                    {4920}out(c, (GetEndpointResponse,pkSess_4844,None,SP_4845,UP_4846))
                                                        )
                                                        else
                                                            {4921}let pkSess_4847: bitstring = fail-any in
                                                            {4922}in(c, =GetEndpointRequest);
                                                            {4923}new SP_4848: bitstring;
                                                            {4924}new UP_4849: bitstring;
                                                            {4925}out(c, (GetEndpointResponse,pkSess_4847,None,SP_4848,UP_4849))
                                                )
                                                else
                                                    {4926}let pkSess_4850: bitstring = fail-any in
                                                    {4927}in(c, =GetEndpointRequest);
                                                    {4928}new SP_4851: bitstring;
                                                    {4929}new UP_4852: bitstring;
                                                    {4930}out(c, (GetEndpointResponse,pkSess_4850,None,SP_4851,UP_4852))
                                            )
                                            else
                                                {4931}let pkCli_4853: bitstring = pub(sk(Cli_4229)) in
                                                {4932}let v_4854: bool = (Sess_4231 = A) in
                                                (
                                                    {4933}if v_4854 then
                                                    (
                                                        {4934}let pkSess_4855: bitstring = pub(skA) in
                                                        {4935}in(c, =GetEndpointRequest);
                                                        {4936}new SP_4856: bitstring;
                                                        {4937}new UP_4857: bitstring;
                                                        {4938}out(c, (GetEndpointResponse,pkSess_4855,None,SP_4856,UP_4857))
                                                    )
                                                    else
                                                        {4939}let v_4858: bool = (Sess_4231 = B) in
                                                        (
                                                            {4940}if v_4858 then
                                                            (
                                                                {4941}let pkSess_4859: bitstring = pub(skB) in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_4860: bitstring;
                                                                {4944}new UP_4861: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_4859,None,SP_4860,UP_4861))
                                                            )
                                                            else
                                                                {4946}let v_4862: bool = (Sess_4231 = C) in
                                                                (
                                                                    {4947}if v_4862 then
                                                                    (
                                                                        {4948}let pkSess_4863: bitstring = pub(skC) in
                                                                        {4949}in(c, =GetEndpointRequest);
                                                                        {4950}new SP_4864: bitstring;
                                                                        {4951}new UP_4865: bitstring;
                                                                        {4952}out(c, (GetEndpointResponse,pkSess_4863,None,SP_4864,UP_4865))
                                                                    )
                                                                    else
                                                                        {4953}let pkSess_4866: bitstring = pub(sk(Sess_4231)) in
                                                                        {4954}in(c, =GetEndpointRequest);
                                                                        {4955}new SP_4867: bitstring;
                                                                        {4956}new UP_4868: bitstring;
                                                                        {4957}out(c, (GetEndpointResponse,pkSess_4866,None,SP_4867,UP_4868))
                                                                )
                                                                else
                                                                    {4958}let pkSess_4869: bitstring = fail-any in
                                                                    {4959}in(c, =GetEndpointRequest);
                                                                    {4960}new SP_4870: bitstring;
                                                                    {4961}new UP_4871: bitstring;
                                                                    {4962}out(c, (GetEndpointResponse,pkSess_4869,None,SP_4870,UP_4871))
                                                        )
                                                        else
                                                            {4963}let pkSess_4872: bitstring = fail-any in
                                                            {4964}in(c, =GetEndpointRequest);
                                                            {4965}new SP_4873: bitstring;
                                                            {4966}new UP_4874: bitstring;
                                                            {4967}out(c, (GetEndpointResponse,pkSess_4872,None,SP_4873,UP_4874))
                                                )
                                                else
                                                    {4968}let pkSess_4875: bitstring = fail-any in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4876: bitstring;
                                                    {4971}new UP_4877: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4875,None,SP_4876,UP_4877))
                                        )
                                        else
                                            {4973}let pkCli_4878: bitstring = fail-any in
                                            {4974}let v_4879: bool = (Sess_4231 = A) in
                                            (
                                                {4975}if v_4879 then
                                                (
                                                    {4976}let pkSess_4880: bitstring = pub(skA) in
                                                    {4977}in(c, =GetEndpointRequest);
                                                    {4978}new SP_4881: bitstring;
                                                    {4979}new UP_4882: bitstring;
                                                    {4980}out(c, (GetEndpointResponse,pkSess_4880,None,SP_4881,UP_4882))
                                                )
                                                else
                                                    {4981}let v_4883: bool = (Sess_4231 = B) in
                                                    (
                                                        {4982}if v_4883 then
                                                        (
                                                            {4983}let pkSess_4884: bitstring = pub(skB) in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_4885: bitstring;
                                                            {4986}new UP_4886: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_4884,None,SP_4885,UP_4886))
                                                        )
                                                        else
                                                            {4988}let v_4887: bool = (Sess_4231 = C) in
                                                            (
                                                                {4989}if v_4887 then
                                                                (
                                                                    {4990}let pkSess_4888: bitstring = pub(skC) in
                                                                    {4991}in(c, =GetEndpointRequest);
                                                                    {4992}new SP_4889: bitstring;
                                                                    {4993}new UP_4890: bitstring;
                                                                    {4994}out(c, (GetEndpointResponse,pkSess_4888,None,SP_4889,UP_4890))
                                                                )
                                                                else
                                                                    {4995}let pkSess_4891: bitstring = pub(sk(Sess_4231)) in
                                                                    {4996}in(c, =GetEndpointRequest);
                                                                    {4997}new SP_4892: bitstring;
                                                                    {4998}new UP_4893: bitstring;
                                                                    {4999}out(c, (GetEndpointResponse,pkSess_4891,None,SP_4892,UP_4893))
                                                            )
                                                            else
                                                                {5000}let pkSess_4894: bitstring = fail-any in
                                                                {5001}in(c, =GetEndpointRequest);
                                                                {5002}new SP_4895: bitstring;
                                                                {5003}new UP_4896: bitstring;
                                                                {5004}out(c, (GetEndpointResponse,pkSess_4894,None,SP_4895,UP_4896))
                                                    )
                                                    else
                                                        {5005}let pkSess_4897: bitstring = fail-any in
                                                        {5006}in(c, =GetEndpointRequest);
                                                        {5007}new SP_4898: bitstring;
                                                        {5008}new UP_4899: bitstring;
                                                        {5009}out(c, (GetEndpointResponse,pkSess_4897,None,SP_4898,UP_4899))
                                            )
                                            else
                                                {5010}let pkSess_4900: bitstring = fail-any in
                                                {5011}in(c, =GetEndpointRequest);
                                                {5012}new SP_4901: bitstring;
                                                {5013}new UP_4902: bitstring;
                                                {5014}out(c, (GetEndpointResponse,pkSess_4900,None,SP_4901,UP_4902))
                                )
                                else
                                    {5015}let pkCli_4903: bitstring = fail-any in
                                    {5016}let v_4904: bool = (Sess_4231 = A) in
                                    (
                                        {5017}if v_4904 then
                                        (
                                            {5018}let pkSess_4905: bitstring = pub(skA) in
                                            {5019}in(c, =GetEndpointRequest);
                                            {5020}new SP_4906: bitstring;
                                            {5021}new UP_4907: bitstring;
                                            {5022}out(c, (GetEndpointResponse,pkSess_4905,None,SP_4906,UP_4907))
                                        )
                                        else
                                            {5023}let v_4908: bool = (Sess_4231 = B) in
                                            (
                                                {5024}if v_4908 then
                                                (
                                                    {5025}let pkSess_4909: bitstring = pub(skB) in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_4910: bitstring;
                                                    {5028}new UP_4911: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_4909,None,SP_4910,UP_4911))
                                                )
                                                else
                                                    {5030}let v_4912: bool = (Sess_4231 = C) in
                                                    (
                                                        {5031}if v_4912 then
                                                        (
                                                            {5032}let pkSess_4913: bitstring = pub(skC) in
                                                            {5033}in(c, =GetEndpointRequest);
                                                            {5034}new SP_4914: bitstring;
                                                            {5035}new UP_4915: bitstring;
                                                            {5036}out(c, (GetEndpointResponse,pkSess_4913,None,SP_4914,UP_4915))
                                                        )
                                                        else
                                                            {5037}let pkSess_4916: bitstring = pub(sk(Sess_4231)) in
                                                            {5038}in(c, =GetEndpointRequest);
                                                            {5039}new SP_4917: bitstring;
                                                            {5040}new UP_4918: bitstring;
                                                            {5041}out(c, (GetEndpointResponse,pkSess_4916,None,SP_4917,UP_4918))
                                                    )
                                                    else
                                                        {5042}let pkSess_4919: bitstring = fail-any in
                                                        {5043}in(c, =GetEndpointRequest);
                                                        {5044}new SP_4920: bitstring;
                                                        {5045}new UP_4921: bitstring;
                                                        {5046}out(c, (GetEndpointResponse,pkSess_4919,None,SP_4920,UP_4921))
                                            )
                                            else
                                                {5047}let pkSess_4922: bitstring = fail-any in
                                                {5048}in(c, =GetEndpointRequest);
                                                {5049}new SP_4923: bitstring;
                                                {5050}new UP_4924: bitstring;
                                                {5051}out(c, (GetEndpointResponse,pkSess_4922,None,SP_4923,UP_4924))
                                    )
                                    else
                                        {5052}let pkSess_4925: bitstring = fail-any in
                                        {5053}in(c, =GetEndpointRequest);
                                        {5054}new SP_4926: bitstring;
                                        {5055}new UP_4927: bitstring;
                                        {5056}out(c, (GetEndpointResponse,pkSess_4925,None,SP_4926,UP_4927))
                        )
                        else
                            {5057}let pkCli_4928: bitstring = fail-any in
                            {5058}let v_4929: bool = (Sess_4231 = A) in
                            (
                                {5059}if v_4929 then
                                (
                                    {5060}let pkSess_4930: bitstring = pub(skA) in
                                    {5061}in(c, =GetEndpointRequest);
                                    {5062}new SP_4931: bitstring;
                                    {5063}new UP_4932: bitstring;
                                    {5064}out(c, (GetEndpointResponse,pkSess_4930,None,SP_4931,UP_4932))
                                )
                                else
                                    {5065}let v_4933: bool = (Sess_4231 = B) in
                                    (
                                        {5066}if v_4933 then
                                        (
                                            {5067}let pkSess_4934: bitstring = pub(skB) in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_4935: bitstring;
                                            {5070}new UP_4936: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_4934,None,SP_4935,UP_4936))
                                        )
                                        else
                                            {5072}let v_4937: bool = (Sess_4231 = C) in
                                            (
                                                {5073}if v_4937 then
                                                (
                                                    {5074}let pkSess_4938: bitstring = pub(skC) in
                                                    {5075}in(c, =GetEndpointRequest);
                                                    {5076}new SP_4939: bitstring;
                                                    {5077}new UP_4940: bitstring;
                                                    {5078}out(c, (GetEndpointResponse,pkSess_4938,None,SP_4939,UP_4940))
                                                )
                                                else
                                                    {5079}let pkSess_4941: bitstring = pub(sk(Sess_4231)) in
                                                    {5080}in(c, =GetEndpointRequest);
                                                    {5081}new SP_4942: bitstring;
                                                    {5082}new UP_4943: bitstring;
                                                    {5083}out(c, (GetEndpointResponse,pkSess_4941,None,SP_4942,UP_4943))
                                            )
                                            else
                                                {5084}let pkSess_4944: bitstring = fail-any in
                                                {5085}in(c, =GetEndpointRequest);
                                                {5086}new SP_4945: bitstring;
                                                {5087}new UP_4946: bitstring;
                                                {5088}out(c, (GetEndpointResponse,pkSess_4944,None,SP_4945,UP_4946))
                                    )
                                    else
                                        {5089}let pkSess_4947: bitstring = fail-any in
                                        {5090}in(c, =GetEndpointRequest);
                                        {5091}new SP_4948: bitstring;
                                        {5092}new UP_4949: bitstring;
                                        {5093}out(c, (GetEndpointResponse,pkSess_4947,None,SP_4948,UP_4949))
                            )
                            else
                                {5094}let pkSess_4950: bitstring = fail-any in
                                {5095}in(c, =GetEndpointRequest);
                                {5096}new SP_4951: bitstring;
                                {5097}new UP_4952: bitstring;
                                {5098}out(c, (GetEndpointResponse,pkSess_4950,None,SP_4951,UP_4952))
            )
            else
                {5099}let skDisco_4953: bitstring = fail-any in
                {5100}let pkDisco_4954: bitstring = pub(skDisco_4953) in
                {5101}let v_4955: bool = (Cli_4229 = A) in
                (
                    {5102}if v_4955 then
                    (
                        {5103}let pkCli_4956: bitstring = pub(skA) in
                        {5104}let v_4957: bool = (Sess_4231 = A) in
                        (
                            {5105}if v_4957 then
                            (
                                {5106}let pkSess_4958: bitstring = pub(skA) in
                                {5107}in(c, =GetEndpointRequest);
                                {5108}new SP_4959: bitstring;
                                {5109}new UP_4960: bitstring;
                                {5110}out(c, (GetEndpointResponse,pkSess_4958,None,SP_4959,UP_4960))
                            )
                            else
                                {5111}let v_4961: bool = (Sess_4231 = B) in
                                (
                                    {5112}if v_4961 then
                                    (
                                        {5113}let pkSess_4962: bitstring = pub(skB) in
                                        {5114}in(c, =GetEndpointRequest);
                                        {5115}new SP_4963: bitstring;
                                        {5116}new UP_4964: bitstring;
                                        {5117}out(c, (GetEndpointResponse,pkSess_4962,None,SP_4963,UP_4964))
                                    )
                                    else
                                        {5118}let v_4965: bool = (Sess_4231 = C) in
                                        (
                                            {5119}if v_4965 then
                                            (
                                                {5120}let pkSess_4966: bitstring = pub(skC) in
                                                {5121}in(c, =GetEndpointRequest);
                                                {5122}new SP_4967: bitstring;
                                                {5123}new UP_4968: bitstring;
                                                {5124}out(c, (GetEndpointResponse,pkSess_4966,None,SP_4967,UP_4968))
                                            )
                                            else
                                                {5125}let pkSess_4969: bitstring = pub(sk(Sess_4231)) in
                                                {5126}in(c, =GetEndpointRequest);
                                                {5127}new SP_4970: bitstring;
                                                {5128}new UP_4971: bitstring;
                                                {5129}out(c, (GetEndpointResponse,pkSess_4969,None,SP_4970,UP_4971))
                                        )
                                        else
                                            {5130}let pkSess_4972: bitstring = fail-any in
                                            {5131}in(c, =GetEndpointRequest);
                                            {5132}new SP_4973: bitstring;
                                            {5133}new UP_4974: bitstring;
                                            {5134}out(c, (GetEndpointResponse,pkSess_4972,None,SP_4973,UP_4974))
                                )
                                else
                                    {5135}let pkSess_4975: bitstring = fail-any in
                                    {5136}in(c, =GetEndpointRequest);
                                    {5137}new SP_4976: bitstring;
                                    {5138}new UP_4977: bitstring;
                                    {5139}out(c, (GetEndpointResponse,pkSess_4975,None,SP_4976,UP_4977))
                        )
                        else
                            {5140}let pkSess_4978: bitstring = fail-any in
                            {5141}in(c, =GetEndpointRequest);
                            {5142}new SP_4979: bitstring;
                            {5143}new UP_4980: bitstring;
                            {5144}out(c, (GetEndpointResponse,pkSess_4978,None,SP_4979,UP_4980))
                    )
                    else
                        {5145}let v_4981: bool = (Cli_4229 = B) in
                        (
                            {5146}if v_4981 then
                            (
                                {5147}let pkCli_4982: bitstring = pub(skB) in
                                {5148}let v_4983: bool = (Sess_4231 = A) in
                                (
                                    {5149}if v_4983 then
                                    (
                                        {5150}let pkSess_4984: bitstring = pub(skA) in
                                        {5151}in(c, =GetEndpointRequest);
                                        {5152}new SP_4985: bitstring;
                                        {5153}new UP_4986: bitstring;
                                        {5154}out(c, (GetEndpointResponse,pkSess_4984,None,SP_4985,UP_4986))
                                    )
                                    else
                                        {5155}let v_4987: bool = (Sess_4231 = B) in
                                        (
                                            {5156}if v_4987 then
                                            (
                                                {5157}let pkSess_4988: bitstring = pub(skB) in
                                                {5158}in(c, =GetEndpointRequest);
                                                {5159}new SP_4989: bitstring;
                                                {5160}new UP_4990: bitstring;
                                                {5161}out(c, (GetEndpointResponse,pkSess_4988,None,SP_4989,UP_4990))
                                            )
                                            else
                                                {5162}let v_4991: bool = (Sess_4231 = C) in
                                                (
                                                    {5163}if v_4991 then
                                                    (
                                                        {5164}let pkSess_4992: bitstring = pub(skC) in
                                                        {5165}in(c, =GetEndpointRequest);
                                                        {5166}new SP_4993: bitstring;
                                                        {5167}new UP_4994: bitstring;
                                                        {5168}out(c, (GetEndpointResponse,pkSess_4992,None,SP_4993,UP_4994))
                                                    )
                                                    else
                                                        {5169}let pkSess_4995: bitstring = pub(sk(Sess_4231)) in
                                                        {5170}in(c, =GetEndpointRequest);
                                                        {5171}new SP_4996: bitstring;
                                                        {5172}new UP_4997: bitstring;
                                                        {5173}out(c, (GetEndpointResponse,pkSess_4995,None,SP_4996,UP_4997))
                                                )
                                                else
                                                    {5174}let pkSess_4998: bitstring = fail-any in
                                                    {5175}in(c, =GetEndpointRequest);
                                                    {5176}new SP_4999: bitstring;
                                                    {5177}new UP_5000: bitstring;
                                                    {5178}out(c, (GetEndpointResponse,pkSess_4998,None,SP_4999,UP_5000))
                                        )
                                        else
                                            {5179}let pkSess_5001: bitstring = fail-any in
                                            {5180}in(c, =GetEndpointRequest);
                                            {5181}new SP_5002: bitstring;
                                            {5182}new UP_5003: bitstring;
                                            {5183}out(c, (GetEndpointResponse,pkSess_5001,None,SP_5002,UP_5003))
                                )
                                else
                                    {5184}let pkSess_5004: bitstring = fail-any in
                                    {5185}in(c, =GetEndpointRequest);
                                    {5186}new SP_5005: bitstring;
                                    {5187}new UP_5006: bitstring;
                                    {5188}out(c, (GetEndpointResponse,pkSess_5004,None,SP_5005,UP_5006))
                            )
                            else
                                {5189}let v_5007: bool = (Cli_4229 = C) in
                                (
                                    {5190}if v_5007 then
                                    (
                                        {5191}let pkCli_5008: bitstring = pub(skC) in
                                        {5192}let v_5009: bool = (Sess_4231 = A) in
                                        (
                                            {5193}if v_5009 then
                                            (
                                                {5194}let pkSess_5010: bitstring = pub(skA) in
                                                {5195}in(c, =GetEndpointRequest);
                                                {5196}new SP_5011: bitstring;
                                                {5197}new UP_5012: bitstring;
                                                {5198}out(c, (GetEndpointResponse,pkSess_5010,None,SP_5011,UP_5012))
                                            )
                                            else
                                                {5199}let v_5013: bool = (Sess_4231 = B) in
                                                (
                                                    {5200}if v_5013 then
                                                    (
                                                        {5201}let pkSess_5014: bitstring = pub(skB) in
                                                        {5202}in(c, =GetEndpointRequest);
                                                        {5203}new SP_5015: bitstring;
                                                        {5204}new UP_5016: bitstring;
                                                        {5205}out(c, (GetEndpointResponse,pkSess_5014,None,SP_5015,UP_5016))
                                                    )
                                                    else
                                                        {5206}let v_5017: bool = (Sess_4231 = C) in
                                                        (
                                                            {5207}if v_5017 then
                                                            (
                                                                {5208}let pkSess_5018: bitstring = pub(skC) in
                                                                {5209}in(c, =GetEndpointRequest);
                                                                {5210}new SP_5019: bitstring;
                                                                {5211}new UP_5020: bitstring;
                                                                {5212}out(c, (GetEndpointResponse,pkSess_5018,None,SP_5019,UP_5020))
                                                            )
                                                            else
                                                                {5213}let pkSess_5021: bitstring = pub(sk(Sess_4231)) in
                                                                {5214}in(c, =GetEndpointRequest);
                                                                {5215}new SP_5022: bitstring;
                                                                {5216}new UP_5023: bitstring;
                                                                {5217}out(c, (GetEndpointResponse,pkSess_5021,None,SP_5022,UP_5023))
                                                        )
                                                        else
                                                            {5218}let pkSess_5024: bitstring = fail-any in
                                                            {5219}in(c, =GetEndpointRequest);
                                                            {5220}new SP_5025: bitstring;
                                                            {5221}new UP_5026: bitstring;
                                                            {5222}out(c, (GetEndpointResponse,pkSess_5024,None,SP_5025,UP_5026))
                                                )
                                                else
                                                    {5223}let pkSess_5027: bitstring = fail-any in
                                                    {5224}in(c, =GetEndpointRequest);
                                                    {5225}new SP_5028: bitstring;
                                                    {5226}new UP_5029: bitstring;
                                                    {5227}out(c, (GetEndpointResponse,pkSess_5027,None,SP_5028,UP_5029))
                                        )
                                        else
                                            {5228}let pkSess_5030: bitstring = fail-any in
                                            {5229}in(c, =GetEndpointRequest);
                                            {5230}new SP_5031: bitstring;
                                            {5231}new UP_5032: bitstring;
                                            {5232}out(c, (GetEndpointResponse,pkSess_5030,None,SP_5031,UP_5032))
                                    )
                                    else
                                        {5233}let pkCli_5033: bitstring = pub(sk(Cli_4229)) in
                                        {5234}let v_5034: bool = (Sess_4231 = A) in
                                        (
                                            {5235}if v_5034 then
                                            (
                                                {5236}let pkSess_5035: bitstring = pub(skA) in
                                                {5237}in(c, =GetEndpointRequest);
                                                {5238}new SP_5036: bitstring;
                                                {5239}new UP_5037: bitstring;
                                                {5240}out(c, (GetEndpointResponse,pkSess_5035,None,SP_5036,UP_5037))
                                            )
                                            else
                                                {5241}let v_5038: bool = (Sess_4231 = B) in
                                                (
                                                    {5242}if v_5038 then
                                                    (
                                                        {5243}let pkSess_5039: bitstring = pub(skB) in
                                                        {5244}in(c, =GetEndpointRequest);
                                                        {5245}new SP_5040: bitstring;
                                                        {5246}new UP_5041: bitstring;
                                                        {5247}out(c, (GetEndpointResponse,pkSess_5039,None,SP_5040,UP_5041))
                                                    )
                                                    else
                                                        {5248}let v_5042: bool = (Sess_4231 = C) in
                                                        (
                                                            {5249}if v_5042 then
                                                            (
                                                                {5250}let pkSess_5043: bitstring = pub(skC) in
                                                                {5251}in(c, =GetEndpointRequest);
                                                                {5252}new SP_5044: bitstring;
                                                                {5253}new UP_5045: bitstring;
                                                                {5254}out(c, (GetEndpointResponse,pkSess_5043,None,SP_5044,UP_5045))
                                                            )
                                                            else
                                                                {5255}let pkSess_5046: bitstring = pub(sk(Sess_4231)) in
                                                                {5256}in(c, =GetEndpointRequest);
                                                                {5257}new SP_5047: bitstring;
                                                                {5258}new UP_5048: bitstring;
                                                                {5259}out(c, (GetEndpointResponse,pkSess_5046,None,SP_5047,UP_5048))
                                                        )
                                                        else
                                                            {5260}let pkSess_5049: bitstring = fail-any in
                                                            {5261}in(c, =GetEndpointRequest);
                                                            {5262}new SP_5050: bitstring;
                                                            {5263}new UP_5051: bitstring;
                                                            {5264}out(c, (GetEndpointResponse,pkSess_5049,None,SP_5050,UP_5051))
                                                )
                                                else
                                                    {5265}let pkSess_5052: bitstring = fail-any in
                                                    {5266}in(c, =GetEndpointRequest);
                                                    {5267}new SP_5053: bitstring;
                                                    {5268}new UP_5054: bitstring;
                                                    {5269}out(c, (GetEndpointResponse,pkSess_5052,None,SP_5053,UP_5054))
                                        )
                                        else
                                            {5270}let pkSess_5055: bitstring = fail-any in
                                            {5271}in(c, =GetEndpointRequest);
                                            {5272}new SP_5056: bitstring;
                                            {5273}new UP_5057: bitstring;
                                            {5274}out(c, (GetEndpointResponse,pkSess_5055,None,SP_5056,UP_5057))
                                )
                                else
                                    {5275}let pkCli_5058: bitstring = fail-any in
                                    {5276}let v_5059: bool = (Sess_4231 = A) in
                                    (
                                        {5277}if v_5059 then
                                        (
                                            {5278}let pkSess_5060: bitstring = pub(skA) in
                                            {5279}in(c, =GetEndpointRequest);
                                            {5280}new SP_5061: bitstring;
                                            {5281}new UP_5062: bitstring;
                                            {5282}out(c, (GetEndpointResponse,pkSess_5060,None,SP_5061,UP_5062))
                                        )
                                        else
                                            {5283}let v_5063: bool = (Sess_4231 = B) in
                                            (
                                                {5284}if v_5063 then
                                                (
                                                    {5285}let pkSess_5064: bitstring = pub(skB) in
                                                    {5286}in(c, =GetEndpointRequest);
                                                    {5287}new SP_5065: bitstring;
                                                    {5288}new UP_5066: bitstring;
                                                    {5289}out(c, (GetEndpointResponse,pkSess_5064,None,SP_5065,UP_5066))
                                                )
                                                else
                                                    {5290}let v_5067: bool = (Sess_4231 = C) in
                                                    (
                                                        {5291}if v_5067 then
                                                        (
                                                            {5292}let pkSess_5068: bitstring = pub(skC) in
                                                            {5293}in(c, =GetEndpointRequest);
                                                            {5294}new SP_5069: bitstring;
                                                            {5295}new UP_5070: bitstring;
                                                            {5296}out(c, (GetEndpointResponse,pkSess_5068,None,SP_5069,UP_5070))
                                                        )
                                                        else
                                                            {5297}let pkSess_5071: bitstring = pub(sk(Sess_4231)) in
                                                            {5298}in(c, =GetEndpointRequest);
                                                            {5299}new SP_5072: bitstring;
                                                            {5300}new UP_5073: bitstring;
                                                            {5301}out(c, (GetEndpointResponse,pkSess_5071,None,SP_5072,UP_5073))
                                                    )
                                                    else
                                                        {5302}let pkSess_5074: bitstring = fail-any in
                                                        {5303}in(c, =GetEndpointRequest);
                                                        {5304}new SP_5075: bitstring;
                                                        {5305}new UP_5076: bitstring;
                                                        {5306}out(c, (GetEndpointResponse,pkSess_5074,None,SP_5075,UP_5076))
                                            )
                                            else
                                                {5307}let pkSess_5077: bitstring = fail-any in
                                                {5308}in(c, =GetEndpointRequest);
                                                {5309}new SP_5078: bitstring;
                                                {5310}new UP_5079: bitstring;
                                                {5311}out(c, (GetEndpointResponse,pkSess_5077,None,SP_5078,UP_5079))
                                    )
                                    else
                                        {5312}let pkSess_5080: bitstring = fail-any in
                                        {5313}in(c, =GetEndpointRequest);
                                        {5314}new SP_5081: bitstring;
                                        {5315}new UP_5082: bitstring;
                                        {5316}out(c, (GetEndpointResponse,pkSess_5080,None,SP_5081,UP_5082))
                        )
                        else
                            {5317}let pkCli_5083: bitstring = fail-any in
                            {5318}let v_5084: bool = (Sess_4231 = A) in
                            (
                                {5319}if v_5084 then
                                (
                                    {5320}let pkSess_5085: bitstring = pub(skA) in
                                    {5321}in(c, =GetEndpointRequest);
                                    {5322}new SP_5086: bitstring;
                                    {5323}new UP_5087: bitstring;
                                    {5324}out(c, (GetEndpointResponse,pkSess_5085,None,SP_5086,UP_5087))
                                )
                                else
                                    {5325}let v_5088: bool = (Sess_4231 = B) in
                                    (
                                        {5326}if v_5088 then
                                        (
                                            {5327}let pkSess_5089: bitstring = pub(skB) in
                                            {5328}in(c, =GetEndpointRequest);
                                            {5329}new SP_5090: bitstring;
                                            {5330}new UP_5091: bitstring;
                                            {5331}out(c, (GetEndpointResponse,pkSess_5089,None,SP_5090,UP_5091))
                                        )
                                        else
                                            {5332}let v_5092: bool = (Sess_4231 = C) in
                                            (
                                                {5333}if v_5092 then
                                                (
                                                    {5334}let pkSess_5093: bitstring = pub(skC) in
                                                    {5335}in(c, =GetEndpointRequest);
                                                    {5336}new SP_5094: bitstring;
                                                    {5337}new UP_5095: bitstring;
                                                    {5338}out(c, (GetEndpointResponse,pkSess_5093,None,SP_5094,UP_5095))
                                                )
                                                else
                                                    {5339}let pkSess_5096: bitstring = pub(sk(Sess_4231)) in
                                                    {5340}in(c, =GetEndpointRequest);
                                                    {5341}new SP_5097: bitstring;
                                                    {5342}new UP_5098: bitstring;
                                                    {5343}out(c, (GetEndpointResponse,pkSess_5096,None,SP_5097,UP_5098))
                                            )
                                            else
                                                {5344}let pkSess_5099: bitstring = fail-any in
                                                {5345}in(c, =GetEndpointRequest);
                                                {5346}new SP_5100: bitstring;
                                                {5347}new UP_5101: bitstring;
                                                {5348}out(c, (GetEndpointResponse,pkSess_5099,None,SP_5100,UP_5101))
                                    )
                                    else
                                        {5349}let pkSess_5102: bitstring = fail-any in
                                        {5350}in(c, =GetEndpointRequest);
                                        {5351}new SP_5103: bitstring;
                                        {5352}new UP_5104: bitstring;
                                        {5353}out(c, (GetEndpointResponse,pkSess_5102,None,SP_5103,UP_5104))
                            )
                            else
                                {5354}let pkSess_5105: bitstring = fail-any in
                                {5355}in(c, =GetEndpointRequest);
                                {5356}new SP_5106: bitstring;
                                {5357}new UP_5107: bitstring;
                                {5358}out(c, (GetEndpointResponse,pkSess_5105,None,SP_5106,UP_5107))
                )
                else
                    {5359}let pkCli_5108: bitstring = fail-any in
                    {5360}let v_5109: bool = (Sess_4231 = A) in
                    (
                        {5361}if v_5109 then
                        (
                            {5362}let pkSess_5110: bitstring = pub(skA) in
                            {5363}in(c, =GetEndpointRequest);
                            {5364}new SP_5111: bitstring;
                            {5365}new UP_5112: bitstring;
                            {5366}out(c, (GetEndpointResponse,pkSess_5110,None,SP_5111,UP_5112))
                        )
                        else
                            {5367}let v_5113: bool = (Sess_4231 = B) in
                            (
                                {5368}if v_5113 then
                                (
                                    {5369}let pkSess_5114: bitstring = pub(skB) in
                                    {5370}in(c, =GetEndpointRequest);
                                    {5371}new SP_5115: bitstring;
                                    {5372}new UP_5116: bitstring;
                                    {5373}out(c, (GetEndpointResponse,pkSess_5114,None,SP_5115,UP_5116))
                                )
                                else
                                    {5374}let v_5117: bool = (Sess_4231 = C) in
                                    (
                                        {5375}if v_5117 then
                                        (
                                            {5376}let pkSess_5118: bitstring = pub(skC) in
                                            {5377}in(c, =GetEndpointRequest);
                                            {5378}new SP_5119: bitstring;
                                            {5379}new UP_5120: bitstring;
                                            {5380}out(c, (GetEndpointResponse,pkSess_5118,None,SP_5119,UP_5120))
                                        )
                                        else
                                            {5381}let pkSess_5121: bitstring = pub(sk(Sess_4231)) in
                                            {5382}in(c, =GetEndpointRequest);
                                            {5383}new SP_5122: bitstring;
                                            {5384}new UP_5123: bitstring;
                                            {5385}out(c, (GetEndpointResponse,pkSess_5121,None,SP_5122,UP_5123))
                                    )
                                    else
                                        {5386}let pkSess_5124: bitstring = fail-any in
                                        {5387}in(c, =GetEndpointRequest);
                                        {5388}new SP_5125: bitstring;
                                        {5389}new UP_5126: bitstring;
                                        {5390}out(c, (GetEndpointResponse,pkSess_5124,None,SP_5125,UP_5126))
                            )
                            else
                                {5391}let pkSess_5127: bitstring = fail-any in
                                {5392}in(c, =GetEndpointRequest);
                                {5393}new SP_5128: bitstring;
                                {5394}new UP_5129: bitstring;
                                {5395}out(c, (GetEndpointResponse,pkSess_5127,None,SP_5128,UP_5129))
                    )
                    else
                        {5396}let pkSess_5130: bitstring = fail-any in
                        {5397}in(c, =GetEndpointRequest);
                        {5398}new SP_5131: bitstring;
                        {5399}new UP_5132: bitstring;
                        {5400}out(c, (GetEndpointResponse,pkSess_5130,None,SP_5131,UP_5132))
    )
    else
        {5401}let skDisco_5133: bitstring = fail-any in
        {5402}let pkDisco_5134: bitstring = pub(skDisco_5133) in
        {5403}let v_5135: bool = (Cli_4229 = A) in
        (
            {5404}if v_5135 then
            (
                {5405}let pkCli_5136: bitstring = pub(skA) in
                {5406}let v_5137: bool = (Sess_4231 = A) in
                (
                    {5407}if v_5137 then
                    (
                        {5408}let pkSess_5138: bitstring = pub(skA) in
                        {5409}in(c, =GetEndpointRequest);
                        {5410}new SP_5139: bitstring;
                        {5411}new UP_5140: bitstring;
                        {5412}out(c, (GetEndpointResponse,pkSess_5138,None,SP_5139,UP_5140))
                    )
                    else
                        {5413}let v_5141: bool = (Sess_4231 = B) in
                        (
                            {5414}if v_5141 then
                            (
                                {5415}let pkSess_5142: bitstring = pub(skB) in
                                {5416}in(c, =GetEndpointRequest);
                                {5417}new SP_5143: bitstring;
                                {5418}new UP_5144: bitstring;
                                {5419}out(c, (GetEndpointResponse,pkSess_5142,None,SP_5143,UP_5144))
                            )
                            else
                                {5420}let v_5145: bool = (Sess_4231 = C) in
                                (
                                    {5421}if v_5145 then
                                    (
                                        {5422}let pkSess_5146: bitstring = pub(skC) in
                                        {5423}in(c, =GetEndpointRequest);
                                        {5424}new SP_5147: bitstring;
                                        {5425}new UP_5148: bitstring;
                                        {5426}out(c, (GetEndpointResponse,pkSess_5146,None,SP_5147,UP_5148))
                                    )
                                    else
                                        {5427}let pkSess_5149: bitstring = pub(sk(Sess_4231)) in
                                        {5428}in(c, =GetEndpointRequest);
                                        {5429}new SP_5150: bitstring;
                                        {5430}new UP_5151: bitstring;
                                        {5431}out(c, (GetEndpointResponse,pkSess_5149,None,SP_5150,UP_5151))
                                )
                                else
                                    {5432}let pkSess_5152: bitstring = fail-any in
                                    {5433}in(c, =GetEndpointRequest);
                                    {5434}new SP_5153: bitstring;
                                    {5435}new UP_5154: bitstring;
                                    {5436}out(c, (GetEndpointResponse,pkSess_5152,None,SP_5153,UP_5154))
                        )
                        else
                            {5437}let pkSess_5155: bitstring = fail-any in
                            {5438}in(c, =GetEndpointRequest);
                            {5439}new SP_5156: bitstring;
                            {5440}new UP_5157: bitstring;
                            {5441}out(c, (GetEndpointResponse,pkSess_5155,None,SP_5156,UP_5157))
                )
                else
                    {5442}let pkSess_5158: bitstring = fail-any in
                    {5443}in(c, =GetEndpointRequest);
                    {5444}new SP_5159: bitstring;
                    {5445}new UP_5160: bitstring;
                    {5446}out(c, (GetEndpointResponse,pkSess_5158,None,SP_5159,UP_5160))
            )
            else
                {5447}let v_5161: bool = (Cli_4229 = B) in
                (
                    {5448}if v_5161 then
                    (
                        {5449}let pkCli_5162: bitstring = pub(skB) in
                        {5450}let v_5163: bool = (Sess_4231 = A) in
                        (
                            {5451}if v_5163 then
                            (
                                {5452}let pkSess_5164: bitstring = pub(skA) in
                                {5453}in(c, =GetEndpointRequest);
                                {5454}new SP_5165: bitstring;
                                {5455}new UP_5166: bitstring;
                                {5456}out(c, (GetEndpointResponse,pkSess_5164,None,SP_5165,UP_5166))
                            )
                            else
                                {5457}let v_5167: bool = (Sess_4231 = B) in
                                (
                                    {5458}if v_5167 then
                                    (
                                        {5459}let pkSess_5168: bitstring = pub(skB) in
                                        {5460}in(c, =GetEndpointRequest);
                                        {5461}new SP_5169: bitstring;
                                        {5462}new UP_5170: bitstring;
                                        {5463}out(c, (GetEndpointResponse,pkSess_5168,None,SP_5169,UP_5170))
                                    )
                                    else
                                        {5464}let v_5171: bool = (Sess_4231 = C) in
                                        (
                                            {5465}if v_5171 then
                                            (
                                                {5466}let pkSess_5172: bitstring = pub(skC) in
                                                {5467}in(c, =GetEndpointRequest);
                                                {5468}new SP_5173: bitstring;
                                                {5469}new UP_5174: bitstring;
                                                {5470}out(c, (GetEndpointResponse,pkSess_5172,None,SP_5173,UP_5174))
                                            )
                                            else
                                                {5471}let pkSess_5175: bitstring = pub(sk(Sess_4231)) in
                                                {5472}in(c, =GetEndpointRequest);
                                                {5473}new SP_5176: bitstring;
                                                {5474}new UP_5177: bitstring;
                                                {5475}out(c, (GetEndpointResponse,pkSess_5175,None,SP_5176,UP_5177))
                                        )
                                        else
                                            {5476}let pkSess_5178: bitstring = fail-any in
                                            {5477}in(c, =GetEndpointRequest);
                                            {5478}new SP_5179: bitstring;
                                            {5479}new UP_5180: bitstring;
                                            {5480}out(c, (GetEndpointResponse,pkSess_5178,None,SP_5179,UP_5180))
                                )
                                else
                                    {5481}let pkSess_5181: bitstring = fail-any in
                                    {5482}in(c, =GetEndpointRequest);
                                    {5483}new SP_5182: bitstring;
                                    {5484}new UP_5183: bitstring;
                                    {5485}out(c, (GetEndpointResponse,pkSess_5181,None,SP_5182,UP_5183))
                        )
                        else
                            {5486}let pkSess_5184: bitstring = fail-any in
                            {5487}in(c, =GetEndpointRequest);
                            {5488}new SP_5185: bitstring;
                            {5489}new UP_5186: bitstring;
                            {5490}out(c, (GetEndpointResponse,pkSess_5184,None,SP_5185,UP_5186))
                    )
                    else
                        {5491}let v_5187: bool = (Cli_4229 = C) in
                        (
                            {5492}if v_5187 then
                            (
                                {5493}let pkCli_5188: bitstring = pub(skC) in
                                {5494}let v_5189: bool = (Sess_4231 = A) in
                                (
                                    {5495}if v_5189 then
                                    (
                                        {5496}let pkSess_5190: bitstring = pub(skA) in
                                        {5497}in(c, =GetEndpointRequest);
                                        {5498}new SP_5191: bitstring;
                                        {5499}new UP_5192: bitstring;
                                        {5500}out(c, (GetEndpointResponse,pkSess_5190,None,SP_5191,UP_5192))
                                    )
                                    else
                                        {5501}let v_5193: bool = (Sess_4231 = B) in
                                        (
                                            {5502}if v_5193 then
                                            (
                                                {5503}let pkSess_5194: bitstring = pub(skB) in
                                                {5504}in(c, =GetEndpointRequest);
                                                {5505}new SP_5195: bitstring;
                                                {5506}new UP_5196: bitstring;
                                                {5507}out(c, (GetEndpointResponse,pkSess_5194,None,SP_5195,UP_5196))
                                            )
                                            else
                                                {5508}let v_5197: bool = (Sess_4231 = C) in
                                                (
                                                    {5509}if v_5197 then
                                                    (
                                                        {5510}let pkSess_5198: bitstring = pub(skC) in
                                                        {5511}in(c, =GetEndpointRequest);
                                                        {5512}new SP_5199: bitstring;
                                                        {5513}new UP_5200: bitstring;
                                                        {5514}out(c, (GetEndpointResponse,pkSess_5198,None,SP_5199,UP_5200))
                                                    )
                                                    else
                                                        {5515}let pkSess_5201: bitstring = pub(sk(Sess_4231)) in
                                                        {5516}in(c, =GetEndpointRequest);
                                                        {5517}new SP_5202: bitstring;
                                                        {5518}new UP_5203: bitstring;
                                                        {5519}out(c, (GetEndpointResponse,pkSess_5201,None,SP_5202,UP_5203))
                                                )
                                                else
                                                    {5520}let pkSess_5204: bitstring = fail-any in
                                                    {5521}in(c, =GetEndpointRequest);
                                                    {5522}new SP_5205: bitstring;
                                                    {5523}new UP_5206: bitstring;
                                                    {5524}out(c, (GetEndpointResponse,pkSess_5204,None,SP_5205,UP_5206))
                                        )
                                        else
                                            {5525}let pkSess_5207: bitstring = fail-any in
                                            {5526}in(c, =GetEndpointRequest);
                                            {5527}new SP_5208: bitstring;
                                            {5528}new UP_5209: bitstring;
                                            {5529}out(c, (GetEndpointResponse,pkSess_5207,None,SP_5208,UP_5209))
                                )
                                else
                                    {5530}let pkSess_5210: bitstring = fail-any in
                                    {5531}in(c, =GetEndpointRequest);
                                    {5532}new SP_5211: bitstring;
                                    {5533}new UP_5212: bitstring;
                                    {5534}out(c, (GetEndpointResponse,pkSess_5210,None,SP_5211,UP_5212))
                            )
                            else
                                {5535}let pkCli_5213: bitstring = pub(sk(Cli_4229)) in
                                {5536}let v_5214: bool = (Sess_4231 = A) in
                                (
                                    {5537}if v_5214 then
                                    (
                                        {5538}let pkSess_5215: bitstring = pub(skA) in
                                        {5539}in(c, =GetEndpointRequest);
                                        {5540}new SP_5216: bitstring;
                                        {5541}new UP_5217: bitstring;
                                        {5542}out(c, (GetEndpointResponse,pkSess_5215,None,SP_5216,UP_5217))
                                    )
                                    else
                                        {5543}let v_5218: bool = (Sess_4231 = B) in
                                        (
                                            {5544}if v_5218 then
                                            (
                                                {5545}let pkSess_5219: bitstring = pub(skB) in
                                                {5546}in(c, =GetEndpointRequest);
                                                {5547}new SP_5220: bitstring;
                                                {5548}new UP_5221: bitstring;
                                                {5549}out(c, (GetEndpointResponse,pkSess_5219,None,SP_5220,UP_5221))
                                            )
                                            else
                                                {5550}let v_5222: bool = (Sess_4231 = C) in
                                                (
                                                    {5551}if v_5222 then
                                                    (
                                                        {5552}let pkSess_5223: bitstring = pub(skC) in
                                                        {5553}in(c, =GetEndpointRequest);
                                                        {5554}new SP_5224: bitstring;
                                                        {5555}new UP_5225: bitstring;
                                                        {5556}out(c, (GetEndpointResponse,pkSess_5223,None,SP_5224,UP_5225))
                                                    )
                                                    else
                                                        {5557}let pkSess_5226: bitstring = pub(sk(Sess_4231)) in
                                                        {5558}in(c, =GetEndpointRequest);
                                                        {5559}new SP_5227: bitstring;
                                                        {5560}new UP_5228: bitstring;
                                                        {5561}out(c, (GetEndpointResponse,pkSess_5226,None,SP_5227,UP_5228))
                                                )
                                                else
                                                    {5562}let pkSess_5229: bitstring = fail-any in
                                                    {5563}in(c, =GetEndpointRequest);
                                                    {5564}new SP_5230: bitstring;
                                                    {5565}new UP_5231: bitstring;
                                                    {5566}out(c, (GetEndpointResponse,pkSess_5229,None,SP_5230,UP_5231))
                                        )
                                        else
                                            {5567}let pkSess_5232: bitstring = fail-any in
                                            {5568}in(c, =GetEndpointRequest);
                                            {5569}new SP_5233: bitstring;
                                            {5570}new UP_5234: bitstring;
                                            {5571}out(c, (GetEndpointResponse,pkSess_5232,None,SP_5233,UP_5234))
                                )
                                else
                                    {5572}let pkSess_5235: bitstring = fail-any in
                                    {5573}in(c, =GetEndpointRequest);
                                    {5574}new SP_5236: bitstring;
                                    {5575}new UP_5237: bitstring;
                                    {5576}out(c, (GetEndpointResponse,pkSess_5235,None,SP_5236,UP_5237))
                        )
                        else
                            {5577}let pkCli_5238: bitstring = fail-any in
                            {5578}let v_5239: bool = (Sess_4231 = A) in
                            (
                                {5579}if v_5239 then
                                (
                                    {5580}let pkSess_5240: bitstring = pub(skA) in
                                    {5581}in(c, =GetEndpointRequest);
                                    {5582}new SP_5241: bitstring;
                                    {5583}new UP_5242: bitstring;
                                    {5584}out(c, (GetEndpointResponse,pkSess_5240,None,SP_5241,UP_5242))
                                )
                                else
                                    {5585}let v_5243: bool = (Sess_4231 = B) in
                                    (
                                        {5586}if v_5243 then
                                        (
                                            {5587}let pkSess_5244: bitstring = pub(skB) in
                                            {5588}in(c, =GetEndpointRequest);
                                            {5589}new SP_5245: bitstring;
                                            {5590}new UP_5246: bitstring;
                                            {5591}out(c, (GetEndpointResponse,pkSess_5244,None,SP_5245,UP_5246))
                                        )
                                        else
                                            {5592}let v_5247: bool = (Sess_4231 = C) in
                                            (
                                                {5593}if v_5247 then
                                                (
                                                    {5594}let pkSess_5248: bitstring = pub(skC) in
                                                    {5595}in(c, =GetEndpointRequest);
                                                    {5596}new SP_5249: bitstring;
                                                    {5597}new UP_5250: bitstring;
                                                    {5598}out(c, (GetEndpointResponse,pkSess_5248,None,SP_5249,UP_5250))
                                                )
                                                else
                                                    {5599}let pkSess_5251: bitstring = pub(sk(Sess_4231)) in
                                                    {5600}in(c, =GetEndpointRequest);
                                                    {5601}new SP_5252: bitstring;
                                                    {5602}new UP_5253: bitstring;
                                                    {5603}out(c, (GetEndpointResponse,pkSess_5251,None,SP_5252,UP_5253))
                                            )
                                            else
                                                {5604}let pkSess_5254: bitstring = fail-any in
                                                {5605}in(c, =GetEndpointRequest);
                                                {5606}new SP_5255: bitstring;
                                                {5607}new UP_5256: bitstring;
                                                {5608}out(c, (GetEndpointResponse,pkSess_5254,None,SP_5255,UP_5256))
                                    )
                                    else
                                        {5609}let pkSess_5257: bitstring = fail-any in
                                        {5610}in(c, =GetEndpointRequest);
                                        {5611}new SP_5258: bitstring;
                                        {5612}new UP_5259: bitstring;
                                        {5613}out(c, (GetEndpointResponse,pkSess_5257,None,SP_5258,UP_5259))
                            )
                            else
                                {5614}let pkSess_5260: bitstring = fail-any in
                                {5615}in(c, =GetEndpointRequest);
                                {5616}new SP_5261: bitstring;
                                {5617}new UP_5262: bitstring;
                                {5618}out(c, (GetEndpointResponse,pkSess_5260,None,SP_5261,UP_5262))
                )
                else
                    {5619}let pkCli_5263: bitstring = fail-any in
                    {5620}let v_5264: bool = (Sess_4231 = A) in
                    (
                        {5621}if v_5264 then
                        (
                            {5622}let pkSess_5265: bitstring = pub(skA) in
                            {5623}in(c, =GetEndpointRequest);
                            {5624}new SP_5266: bitstring;
                            {5625}new UP_5267: bitstring;
                            {5626}out(c, (GetEndpointResponse,pkSess_5265,None,SP_5266,UP_5267))
                        )
                        else
                            {5627}let v_5268: bool = (Sess_4231 = B) in
                            (
                                {5628}if v_5268 then
                                (
                                    {5629}let pkSess_5269: bitstring = pub(skB) in
                                    {5630}in(c, =GetEndpointRequest);
                                    {5631}new SP_5270: bitstring;
                                    {5632}new UP_5271: bitstring;
                                    {5633}out(c, (GetEndpointResponse,pkSess_5269,None,SP_5270,UP_5271))
                                )
                                else
                                    {5634}let v_5272: bool = (Sess_4231 = C) in
                                    (
                                        {5635}if v_5272 then
                                        (
                                            {5636}let pkSess_5273: bitstring = pub(skC) in
                                            {5637}in(c, =GetEndpointRequest);
                                            {5638}new SP_5274: bitstring;
                                            {5639}new UP_5275: bitstring;
                                            {5640}out(c, (GetEndpointResponse,pkSess_5273,None,SP_5274,UP_5275))
                                        )
                                        else
                                            {5641}let pkSess_5276: bitstring = pub(sk(Sess_4231)) in
                                            {5642}in(c, =GetEndpointRequest);
                                            {5643}new SP_5277: bitstring;
                                            {5644}new UP_5278: bitstring;
                                            {5645}out(c, (GetEndpointResponse,pkSess_5276,None,SP_5277,UP_5278))
                                    )
                                    else
                                        {5646}let pkSess_5279: bitstring = fail-any in
                                        {5647}in(c, =GetEndpointRequest);
                                        {5648}new SP_5280: bitstring;
                                        {5649}new UP_5281: bitstring;
                                        {5650}out(c, (GetEndpointResponse,pkSess_5279,None,SP_5280,UP_5281))
                            )
                            else
                                {5651}let pkSess_5282: bitstring = fail-any in
                                {5652}in(c, =GetEndpointRequest);
                                {5653}new SP_5283: bitstring;
                                {5654}new UP_5284: bitstring;
                                {5655}out(c, (GetEndpointResponse,pkSess_5282,None,SP_5283,UP_5284))
                    )
                    else
                        {5656}let pkSess_5285: bitstring = fail-any in
                        {5657}in(c, =GetEndpointRequest);
                        {5658}new SP_5286: bitstring;
                        {5659}new UP_5287: bitstring;
                        {5660}out(c, (GetEndpointResponse,pkSess_5285,None,SP_5286,UP_5287))
        )
        else
            {5661}let pkCli_5288: bitstring = fail-any in
            {5662}let v_5289: bool = (Sess_4231 = A) in
            (
                {5663}if v_5289 then
                (
                    {5664}let pkSess_5290: bitstring = pub(skA) in
                    {5665}in(c, =GetEndpointRequest);
                    {5666}new SP_5291: bitstring;
                    {5667}new UP_5292: bitstring;
                    {5668}out(c, (GetEndpointResponse,pkSess_5290,None,SP_5291,UP_5292))
                )
                else
                    {5669}let v_5293: bool = (Sess_4231 = B) in
                    (
                        {5670}if v_5293 then
                        (
                            {5671}let pkSess_5294: bitstring = pub(skB) in
                            {5672}in(c, =GetEndpointRequest);
                            {5673}new SP_5295: bitstring;
                            {5674}new UP_5296: bitstring;
                            {5675}out(c, (GetEndpointResponse,pkSess_5294,None,SP_5295,UP_5296))
                        )
                        else
                            {5676}let v_5297: bool = (Sess_4231 = C) in
                            (
                                {5677}if v_5297 then
                                (
                                    {5678}let pkSess_5298: bitstring = pub(skC) in
                                    {5679}in(c, =GetEndpointRequest);
                                    {5680}new SP_5299: bitstring;
                                    {5681}new UP_5300: bitstring;
                                    {5682}out(c, (GetEndpointResponse,pkSess_5298,None,SP_5299,UP_5300))
                                )
                                else
                                    {5683}let pkSess_5301: bitstring = pub(sk(Sess_4231)) in
                                    {5684}in(c, =GetEndpointRequest);
                                    {5685}new SP_5302: bitstring;
                                    {5686}new UP_5303: bitstring;
                                    {5687}out(c, (GetEndpointResponse,pkSess_5301,None,SP_5302,UP_5303))
                            )
                            else
                                {5688}let pkSess_5304: bitstring = fail-any in
                                {5689}in(c, =GetEndpointRequest);
                                {5690}new SP_5305: bitstring;
                                {5691}new UP_5306: bitstring;
                                {5692}out(c, (GetEndpointResponse,pkSess_5304,None,SP_5305,UP_5306))
                    )
                    else
                        {5693}let pkSess_5307: bitstring = fail-any in
                        {5694}in(c, =GetEndpointRequest);
                        {5695}new SP_5308: bitstring;
                        {5696}new UP_5309: bitstring;
                        {5697}out(c, (GetEndpointResponse,pkSess_5307,None,SP_5308,UP_5309))
            )
            else
                {5698}let pkSess_5310: bitstring = fail-any in
                {5699}in(c, =GetEndpointRequest);
                {5700}new SP_5311: bitstring;
                {5701}new UP_5312: bitstring;
                {5702}out(c, (GetEndpointResponse,pkSess_5310,None,SP_5311,UP_5312))
) | (
    {5703}!
    {5704}in(c, (Cli_5313: host,Disco_5314: host,Sess_5315: host));
    {5705}let v_5316: bool = (Sess_5315 = A) in
    (
        {5706}if v_5316 then
        (
            {5707}let skSess: bitstring = skA in
            {5708}let pkSess_5317: bitstring = pub(skSess) in
            {5709}let v_5318: bool = (Cli_5313 = A) in
            (
                {5710}if v_5318 then
                (
                    {5711}let pkCli_5319: bitstring = pub(skA) in
                    {5712}let v_5320: bool = (Disco_5314 = A) in
                    (
                        {5713}if v_5320 then
                        (
                            {5714}let pkDisco_5321: bitstring = pub(skA) in
                            {5715}in(c, (=pkCli_5319,em1: bitstring));
                            {5716}let m1_5322: bitstring = em1 in
                            {5717}let (=OpenSecureChannelRequest,=pkCli_5319,PartC: bitstring) = m1_5322 in
                            {5718}new Ns: bitstring;
                            {5719}new ST_5323: bitstring;
                            {5720}new TTL_5324: bitstring;
                            {5721}let gNs: bitstring = exp(g,Ns) in
                            {5722}let m2_5325: bitstring = (OpenSecureChannelResponse,gNs,ST_5323,TTL_5324) in
                            {5723}out(c, m2_5325);
                            {5724}let Ksrv: bitstring = exp(PartC,Ns) in
                            {5725}out(c, senc(mSrv(pkCli_5319,pkSess_5317),Ksrv))
                        )
                        else
                            {5726}let v_5326: bool = (Disco_5314 = B) in
                            (
                                {5727}if v_5326 then
                                (
                                    {5728}let pkDisco_5327: bitstring = pub(skB) in
                                    {5729}in(c, (=pkCli_5319,em1_5328: bitstring));
                                    {5730}let m1_5329: bitstring = em1_5328 in
                                    {5731}let (=OpenSecureChannelRequest,=pkCli_5319,PartC_5330: bitstring) = m1_5329 in
                                    {5732}new Ns_5331: bitstring;
                                    {5733}new ST_5332: bitstring;
                                    {5734}new TTL_5333: bitstring;
                                    {5735}let gNs_5334: bitstring = exp(g,Ns_5331) in
                                    {5736}let m2_5335: bitstring = (OpenSecureChannelResponse,gNs_5334,ST_5332,TTL_5333) in
                                    {5737}out(c, m2_5335);
                                    {5738}let Ksrv_5336: bitstring = exp(PartC_5330,Ns_5331) in
                                    {5739}out(c, senc(mSrv(pkCli_5319,pkSess_5317),Ksrv_5336))
                                )
                                else
                                    {5740}let v_5337: bool = (Disco_5314 = C) in
                                    (
                                        {5741}if v_5337 then
                                        (
                                            {5742}let pkDisco_5338: bitstring = pub(skC) in
                                            {5743}in(c, (=pkCli_5319,em1_5339: bitstring));
                                            {5744}let m1_5340: bitstring = em1_5339 in
                                            {5745}let (=OpenSecureChannelRequest,=pkCli_5319,PartC_5341: bitstring) = m1_5340 in
                                            {5746}new Ns_5342: bitstring;
                                            {5747}new ST_5343: bitstring;
                                            {5748}new TTL_5344: bitstring;
                                            {5749}let gNs_5345: bitstring = exp(g,Ns_5342) in
                                            {5750}let m2_5346: bitstring = (OpenSecureChannelResponse,gNs_5345,ST_5343,TTL_5344) in
                                            {5751}out(c, m2_5346);
                                            {5752}let Ksrv_5347: bitstring = exp(PartC_5341,Ns_5342) in
                                            {5753}out(c, senc(mSrv(pkCli_5319,pkSess_5317),Ksrv_5347))
                                        )
                                        else
                                            {5754}let pkDisco_5348: bitstring = pub(sk(Disco_5314)) in
                                            {5755}in(c, (=pkCli_5319,em1_5349: bitstring));
                                            {5756}let m1_5350: bitstring = em1_5349 in
                                            {5757}let (=OpenSecureChannelRequest,=pkCli_5319,PartC_5351: bitstring) = m1_5350 in
                                            {5758}new Ns_5352: bitstring;
                                            {5759}new ST_5353: bitstring;
                                            {5760}new TTL_5354: bitstring;
                                            {5761}let gNs_5355: bitstring = exp(g,Ns_5352) in
                                            {5762}let m2_5356: bitstring = (OpenSecureChannelResponse,gNs_5355,ST_5353,TTL_5354) in
                                            {5763}out(c, m2_5356);
                                            {5764}let Ksrv_5357: bitstring = exp(PartC_5351,Ns_5352) in
                                            {5765}out(c, senc(mSrv(pkCli_5319,pkSess_5317),Ksrv_5357))
                                    )
                                    else
                                        {5766}let pkDisco_5358: bitstring = fail-any in
                                        {5767}in(c, (=pkCli_5319,em1_5359: bitstring));
                                        {5768}let m1_5360: bitstring = em1_5359 in
                                        {5769}let (=OpenSecureChannelRequest,=pkCli_5319,PartC_5361: bitstring) = m1_5360 in
                                        {5770}new Ns_5362: bitstring;
                                        {5771}new ST_5363: bitstring;
                                        {5772}new TTL_5364: bitstring;
                                        {5773}let gNs_5365: bitstring = exp(g,Ns_5362) in
                                        {5774}let m2_5366: bitstring = (OpenSecureChannelResponse,gNs_5365,ST_5363,TTL_5364) in
                                        {5775}out(c, m2_5366);
                                        {5776}let Ksrv_5367: bitstring = exp(PartC_5361,Ns_5362) in
                                        {5777}out(c, senc(mSrv(pkCli_5319,pkSess_5317),Ksrv_5367))
                            )
                            else
                                {5778}let pkDisco_5368: bitstring = fail-any in
                                {5779}in(c, (=pkCli_5319,em1_5369: bitstring));
                                {5780}let m1_5370: bitstring = em1_5369 in
                                {5781}let (=OpenSecureChannelRequest,=pkCli_5319,PartC_5371: bitstring) = m1_5370 in
                                {5782}new Ns_5372: bitstring;
                                {5783}new ST_5373: bitstring;
                                {5784}new TTL_5374: bitstring;
                                {5785}let gNs_5375: bitstring = exp(g,Ns_5372) in
                                {5786}let m2_5376: bitstring = (OpenSecureChannelResponse,gNs_5375,ST_5373,TTL_5374) in
                                {5787}out(c, m2_5376);
                                {5788}let Ksrv_5377: bitstring = exp(PartC_5371,Ns_5372) in
                                {5789}out(c, senc(mSrv(pkCli_5319,pkSess_5317),Ksrv_5377))
                    )
                    else
                        {5790}let pkDisco_5378: bitstring = fail-any in
                        {5791}in(c, (=pkCli_5319,em1_5379: bitstring));
                        {5792}let m1_5380: bitstring = em1_5379 in
                        {5793}let (=OpenSecureChannelRequest,=pkCli_5319,PartC_5381: bitstring) = m1_5380 in
                        {5794}new Ns_5382: bitstring;
                        {5795}new ST_5383: bitstring;
                        {5796}new TTL_5384: bitstring;
                        {5797}let gNs_5385: bitstring = exp(g,Ns_5382) in
                        {5798}let m2_5386: bitstring = (OpenSecureChannelResponse,gNs_5385,ST_5383,TTL_5384) in
                        {5799}out(c, m2_5386);
                        {5800}let Ksrv_5387: bitstring = exp(PartC_5381,Ns_5382) in
                        {5801}out(c, senc(mSrv(pkCli_5319,pkSess_5317),Ksrv_5387))
                )
                else
                    {5802}let v_5388: bool = (Cli_5313 = B) in
                    (
                        {5803}if v_5388 then
                        (
                            {5804}let pkCli_5389: bitstring = pub(skB) in
                            {5805}let v_5390: bool = (Disco_5314 = A) in
                            (
                                {5806}if v_5390 then
                                (
                                    {5807}let pkDisco_5391: bitstring = pub(skA) in
                                    {5808}in(c, (=pkCli_5389,em1_5392: bitstring));
                                    {5809}let m1_5393: bitstring = em1_5392 in
                                    {5810}let (=OpenSecureChannelRequest,=pkCli_5389,PartC_5394: bitstring) = m1_5393 in
                                    {5811}new Ns_5395: bitstring;
                                    {5812}new ST_5396: bitstring;
                                    {5813}new TTL_5397: bitstring;
                                    {5814}let gNs_5398: bitstring = exp(g,Ns_5395) in
                                    {5815}let m2_5399: bitstring = (OpenSecureChannelResponse,gNs_5398,ST_5396,TTL_5397) in
                                    {5816}out(c, m2_5399);
                                    {5817}let Ksrv_5400: bitstring = exp(PartC_5394,Ns_5395) in
                                    {5818}out(c, senc(mSrv(pkCli_5389,pkSess_5317),Ksrv_5400))
                                )
                                else
                                    {5819}let v_5401: bool = (Disco_5314 = B) in
                                    (
                                        {5820}if v_5401 then
                                        (
                                            {5821}let pkDisco_5402: bitstring = pub(skB) in
                                            {5822}in(c, (=pkCli_5389,em1_5403: bitstring));
                                            {5823}let m1_5404: bitstring = em1_5403 in
                                            {5824}let (=OpenSecureChannelRequest,=pkCli_5389,PartC_5405: bitstring) = m1_5404 in
                                            {5825}new Ns_5406: bitstring;
                                            {5826}new ST_5407: bitstring;
                                            {5827}new TTL_5408: bitstring;
                                            {5828}let gNs_5409: bitstring = exp(g,Ns_5406) in
                                            {5829}let m2_5410: bitstring = (OpenSecureChannelResponse,gNs_5409,ST_5407,TTL_5408) in
                                            {5830}out(c, m2_5410);
                                            {5831}let Ksrv_5411: bitstring = exp(PartC_5405,Ns_5406) in
                                            {5832}out(c, senc(mSrv(pkCli_5389,pkSess_5317),Ksrv_5411))
                                        )
                                        else
                                            {5833}let v_5412: bool = (Disco_5314 = C) in
                                            (
                                                {5834}if v_5412 then
                                                (
                                                    {5835}let pkDisco_5413: bitstring = pub(skC) in
                                                    {5836}in(c, (=pkCli_5389,em1_5414: bitstring));
                                                    {5837}let m1_5415: bitstring = em1_5414 in
                                                    {5838}let (=OpenSecureChannelRequest,=pkCli_5389,PartC_5416: bitstring) = m1_5415 in
                                                    {5839}new Ns_5417: bitstring;
                                                    {5840}new ST_5418: bitstring;
                                                    {5841}new TTL_5419: bitstring;
                                                    {5842}let gNs_5420: bitstring = exp(g,Ns_5417) in
                                                    {5843}let m2_5421: bitstring = (OpenSecureChannelResponse,gNs_5420,ST_5418,TTL_5419) in
                                                    {5844}out(c, m2_5421);
                                                    {5845}let Ksrv_5422: bitstring = exp(PartC_5416,Ns_5417) in
                                                    {5846}out(c, senc(mSrv(pkCli_5389,pkSess_5317),Ksrv_5422))
                                                )
                                                else
                                                    {5847}let pkDisco_5423: bitstring = pub(sk(Disco_5314)) in
                                                    {5848}in(c, (=pkCli_5389,em1_5424: bitstring));
                                                    {5849}let m1_5425: bitstring = em1_5424 in
                                                    {5850}let (=OpenSecureChannelRequest,=pkCli_5389,PartC_5426: bitstring) = m1_5425 in
                                                    {5851}new Ns_5427: bitstring;
                                                    {5852}new ST_5428: bitstring;
                                                    {5853}new TTL_5429: bitstring;
                                                    {5854}let gNs_5430: bitstring = exp(g,Ns_5427) in
                                                    {5855}let m2_5431: bitstring = (OpenSecureChannelResponse,gNs_5430,ST_5428,TTL_5429) in
                                                    {5856}out(c, m2_5431);
                                                    {5857}let Ksrv_5432: bitstring = exp(PartC_5426,Ns_5427) in
                                                    {5858}out(c, senc(mSrv(pkCli_5389,pkSess_5317),Ksrv_5432))
                                            )
                                            else
                                                {5859}let pkDisco_5433: bitstring = fail-any in
                                                {5860}in(c, (=pkCli_5389,em1_5434: bitstring));
                                                {5861}let m1_5435: bitstring = em1_5434 in
                                                {5862}let (=OpenSecureChannelRequest,=pkCli_5389,PartC_5436: bitstring) = m1_5435 in
                                                {5863}new Ns_5437: bitstring;
                                                {5864}new ST_5438: bitstring;
                                                {5865}new TTL_5439: bitstring;
                                                {5866}let gNs_5440: bitstring = exp(g,Ns_5437) in
                                                {5867}let m2_5441: bitstring = (OpenSecureChannelResponse,gNs_5440,ST_5438,TTL_5439) in
                                                {5868}out(c, m2_5441);
                                                {5869}let Ksrv_5442: bitstring = exp(PartC_5436,Ns_5437) in
                                                {5870}out(c, senc(mSrv(pkCli_5389,pkSess_5317),Ksrv_5442))
                                    )
                                    else
                                        {5871}let pkDisco_5443: bitstring = fail-any in
                                        {5872}in(c, (=pkCli_5389,em1_5444: bitstring));
                                        {5873}let m1_5445: bitstring = em1_5444 in
                                        {5874}let (=OpenSecureChannelRequest,=pkCli_5389,PartC_5446: bitstring) = m1_5445 in
                                        {5875}new Ns_5447: bitstring;
                                        {5876}new ST_5448: bitstring;
                                        {5877}new TTL_5449: bitstring;
                                        {5878}let gNs_5450: bitstring = exp(g,Ns_5447) in
                                        {5879}let m2_5451: bitstring = (OpenSecureChannelResponse,gNs_5450,ST_5448,TTL_5449) in
                                        {5880}out(c, m2_5451);
                                        {5881}let Ksrv_5452: bitstring = exp(PartC_5446,Ns_5447) in
                                        {5882}out(c, senc(mSrv(pkCli_5389,pkSess_5317),Ksrv_5452))
                            )
                            else
                                {5883}let pkDisco_5453: bitstring = fail-any in
                                {5884}in(c, (=pkCli_5389,em1_5454: bitstring));
                                {5885}let m1_5455: bitstring = em1_5454 in
                                {5886}let (=OpenSecureChannelRequest,=pkCli_5389,PartC_5456: bitstring) = m1_5455 in
                                {5887}new Ns_5457: bitstring;
                                {5888}new ST_5458: bitstring;
                                {5889}new TTL_5459: bitstring;
                                {5890}let gNs_5460: bitstring = exp(g,Ns_5457) in
                                {5891}let m2_5461: bitstring = (OpenSecureChannelResponse,gNs_5460,ST_5458,TTL_5459) in
                                {5892}out(c, m2_5461);
                                {5893}let Ksrv_5462: bitstring = exp(PartC_5456,Ns_5457) in
                                {5894}out(c, senc(mSrv(pkCli_5389,pkSess_5317),Ksrv_5462))
                        )
                        else
                            {5895}let v_5463: bool = (Cli_5313 = C) in
                            (
                                {5896}if v_5463 then
                                (
                                    {5897}let pkCli_5464: bitstring = pub(skC) in
                                    {5898}let v_5465: bool = (Disco_5314 = A) in
                                    (
                                        {5899}if v_5465 then
                                        (
                                            {5900}let pkDisco_5466: bitstring = pub(skA) in
                                            {5901}in(c, (=pkCli_5464,em1_5467: bitstring));
                                            {5902}let m1_5468: bitstring = em1_5467 in
                                            {5903}let (=OpenSecureChannelRequest,=pkCli_5464,PartC_5469: bitstring) = m1_5468 in
                                            {5904}new Ns_5470: bitstring;
                                            {5905}new ST_5471: bitstring;
                                            {5906}new TTL_5472: bitstring;
                                            {5907}let gNs_5473: bitstring = exp(g,Ns_5470) in
                                            {5908}let m2_5474: bitstring = (OpenSecureChannelResponse,gNs_5473,ST_5471,TTL_5472) in
                                            {5909}out(c, m2_5474);
                                            {5910}let Ksrv_5475: bitstring = exp(PartC_5469,Ns_5470) in
                                            {5911}out(c, senc(mSrv(pkCli_5464,pkSess_5317),Ksrv_5475))
                                        )
                                        else
                                            {5912}let v_5476: bool = (Disco_5314 = B) in
                                            (
                                                {5913}if v_5476 then
                                                (
                                                    {5914}let pkDisco_5477: bitstring = pub(skB) in
                                                    {5915}in(c, (=pkCli_5464,em1_5478: bitstring));
                                                    {5916}let m1_5479: bitstring = em1_5478 in
                                                    {5917}let (=OpenSecureChannelRequest,=pkCli_5464,PartC_5480: bitstring) = m1_5479 in
                                                    {5918}new Ns_5481: bitstring;
                                                    {5919}new ST_5482: bitstring;
                                                    {5920}new TTL_5483: bitstring;
                                                    {5921}let gNs_5484: bitstring = exp(g,Ns_5481) in
                                                    {5922}let m2_5485: bitstring = (OpenSecureChannelResponse,gNs_5484,ST_5482,TTL_5483) in
                                                    {5923}out(c, m2_5485);
                                                    {5924}let Ksrv_5486: bitstring = exp(PartC_5480,Ns_5481) in
                                                    {5925}out(c, senc(mSrv(pkCli_5464,pkSess_5317),Ksrv_5486))
                                                )
                                                else
                                                    {5926}let v_5487: bool = (Disco_5314 = C) in
                                                    (
                                                        {5927}if v_5487 then
                                                        (
                                                            {5928}let pkDisco_5488: bitstring = pub(skC) in
                                                            {5929}in(c, (=pkCli_5464,em1_5489: bitstring));
                                                            {5930}let m1_5490: bitstring = em1_5489 in
                                                            {5931}let (=OpenSecureChannelRequest,=pkCli_5464,PartC_5491: bitstring) = m1_5490 in
                                                            {5932}new Ns_5492: bitstring;
                                                            {5933}new ST_5493: bitstring;
                                                            {5934}new TTL_5494: bitstring;
                                                            {5935}let gNs_5495: bitstring = exp(g,Ns_5492) in
                                                            {5936}let m2_5496: bitstring = (OpenSecureChannelResponse,gNs_5495,ST_5493,TTL_5494) in
                                                            {5937}out(c, m2_5496);
                                                            {5938}let Ksrv_5497: bitstring = exp(PartC_5491,Ns_5492) in
                                                            {5939}out(c, senc(mSrv(pkCli_5464,pkSess_5317),Ksrv_5497))
                                                        )
                                                        else
                                                            {5940}let pkDisco_5498: bitstring = pub(sk(Disco_5314)) in
                                                            {5941}in(c, (=pkCli_5464,em1_5499: bitstring));
                                                            {5942}let m1_5500: bitstring = em1_5499 in
                                                            {5943}let (=OpenSecureChannelRequest,=pkCli_5464,PartC_5501: bitstring) = m1_5500 in
                                                            {5944}new Ns_5502: bitstring;
                                                            {5945}new ST_5503: bitstring;
                                                            {5946}new TTL_5504: bitstring;
                                                            {5947}let gNs_5505: bitstring = exp(g,Ns_5502) in
                                                            {5948}let m2_5506: bitstring = (OpenSecureChannelResponse,gNs_5505,ST_5503,TTL_5504) in
                                                            {5949}out(c, m2_5506);
                                                            {5950}let Ksrv_5507: bitstring = exp(PartC_5501,Ns_5502) in
                                                            {5951}out(c, senc(mSrv(pkCli_5464,pkSess_5317),Ksrv_5507))
                                                    )
                                                    else
                                                        {5952}let pkDisco_5508: bitstring = fail-any in
                                                        {5953}in(c, (=pkCli_5464,em1_5509: bitstring));
                                                        {5954}let m1_5510: bitstring = em1_5509 in
                                                        {5955}let (=OpenSecureChannelRequest,=pkCli_5464,PartC_5511: bitstring) = m1_5510 in
                                                        {5956}new Ns_5512: bitstring;
                                                        {5957}new ST_5513: bitstring;
                                                        {5958}new TTL_5514: bitstring;
                                                        {5959}let gNs_5515: bitstring = exp(g,Ns_5512) in
                                                        {5960}let m2_5516: bitstring = (OpenSecureChannelResponse,gNs_5515,ST_5513,TTL_5514) in
                                                        {5961}out(c, m2_5516);
                                                        {5962}let Ksrv_5517: bitstring = exp(PartC_5511,Ns_5512) in
                                                        {5963}out(c, senc(mSrv(pkCli_5464,pkSess_5317),Ksrv_5517))
                                            )
                                            else
                                                {5964}let pkDisco_5518: bitstring = fail-any in
                                                {5965}in(c, (=pkCli_5464,em1_5519: bitstring));
                                                {5966}let m1_5520: bitstring = em1_5519 in
                                                {5967}let (=OpenSecureChannelRequest,=pkCli_5464,PartC_5521: bitstring) = m1_5520 in
                                                {5968}new Ns_5522: bitstring;
                                                {5969}new ST_5523: bitstring;
                                                {5970}new TTL_5524: bitstring;
                                                {5971}let gNs_5525: bitstring = exp(g,Ns_5522) in
                                                {5972}let m2_5526: bitstring = (OpenSecureChannelResponse,gNs_5525,ST_5523,TTL_5524) in
                                                {5973}out(c, m2_5526);
                                                {5974}let Ksrv_5527: bitstring = exp(PartC_5521,Ns_5522) in
                                                {5975}out(c, senc(mSrv(pkCli_5464,pkSess_5317),Ksrv_5527))
                                    )
                                    else
                                        {5976}let pkDisco_5528: bitstring = fail-any in
                                        {5977}in(c, (=pkCli_5464,em1_5529: bitstring));
                                        {5978}let m1_5530: bitstring = em1_5529 in
                                        {5979}let (=OpenSecureChannelRequest,=pkCli_5464,PartC_5531: bitstring) = m1_5530 in
                                        {5980}new Ns_5532: bitstring;
                                        {5981}new ST_5533: bitstring;
                                        {5982}new TTL_5534: bitstring;
                                        {5983}let gNs_5535: bitstring = exp(g,Ns_5532) in
                                        {5984}let m2_5536: bitstring = (OpenSecureChannelResponse,gNs_5535,ST_5533,TTL_5534) in
                                        {5985}out(c, m2_5536);
                                        {5986}let Ksrv_5537: bitstring = exp(PartC_5531,Ns_5532) in
                                        {5987}out(c, senc(mSrv(pkCli_5464,pkSess_5317),Ksrv_5537))
                                )
                                else
                                    {5988}let pkCli_5538: bitstring = pub(sk(Cli_5313)) in
                                    {5989}let v_5539: bool = (Disco_5314 = A) in
                                    (
                                        {5990}if v_5539 then
                                        (
                                            {5991}let pkDisco_5540: bitstring = pub(skA) in
                                            {5992}in(c, (=pkCli_5538,em1_5541: bitstring));
                                            {5993}let m1_5542: bitstring = em1_5541 in
                                            {5994}let (=OpenSecureChannelRequest,=pkCli_5538,PartC_5543: bitstring) = m1_5542 in
                                            {5995}new Ns_5544: bitstring;
                                            {5996}new ST_5545: bitstring;
                                            {5997}new TTL_5546: bitstring;
                                            {5998}let gNs_5547: bitstring = exp(g,Ns_5544) in
                                            {5999}let m2_5548: bitstring = (OpenSecureChannelResponse,gNs_5547,ST_5545,TTL_5546) in
                                            {6000}out(c, m2_5548);
                                            {6001}let Ksrv_5549: bitstring = exp(PartC_5543,Ns_5544) in
                                            {6002}out(c, senc(mSrv(pkCli_5538,pkSess_5317),Ksrv_5549))
                                        )
                                        else
                                            {6003}let v_5550: bool = (Disco_5314 = B) in
                                            (
                                                {6004}if v_5550 then
                                                (
                                                    {6005}let pkDisco_5551: bitstring = pub(skB) in
                                                    {6006}in(c, (=pkCli_5538,em1_5552: bitstring));
                                                    {6007}let m1_5553: bitstring = em1_5552 in
                                                    {6008}let (=OpenSecureChannelRequest,=pkCli_5538,PartC_5554: bitstring) = m1_5553 in
                                                    {6009}new Ns_5555: bitstring;
                                                    {6010}new ST_5556: bitstring;
                                                    {6011}new TTL_5557: bitstring;
                                                    {6012}let gNs_5558: bitstring = exp(g,Ns_5555) in
                                                    {6013}let m2_5559: bitstring = (OpenSecureChannelResponse,gNs_5558,ST_5556,TTL_5557) in
                                                    {6014}out(c, m2_5559);
                                                    {6015}let Ksrv_5560: bitstring = exp(PartC_5554,Ns_5555) in
                                                    {6016}out(c, senc(mSrv(pkCli_5538,pkSess_5317),Ksrv_5560))
                                                )
                                                else
                                                    {6017}let v_5561: bool = (Disco_5314 = C) in
                                                    (
                                                        {6018}if v_5561 then
                                                        (
                                                            {6019}let pkDisco_5562: bitstring = pub(skC) in
                                                            {6020}in(c, (=pkCli_5538,em1_5563: bitstring));
                                                            {6021}let m1_5564: bitstring = em1_5563 in
                                                            {6022}let (=OpenSecureChannelRequest,=pkCli_5538,PartC_5565: bitstring) = m1_5564 in
                                                            {6023}new Ns_5566: bitstring;
                                                            {6024}new ST_5567: bitstring;
                                                            {6025}new TTL_5568: bitstring;
                                                            {6026}let gNs_5569: bitstring = exp(g,Ns_5566) in
                                                            {6027}let m2_5570: bitstring = (OpenSecureChannelResponse,gNs_5569,ST_5567,TTL_5568) in
                                                            {6028}out(c, m2_5570);
                                                            {6029}let Ksrv_5571: bitstring = exp(PartC_5565,Ns_5566) in
                                                            {6030}out(c, senc(mSrv(pkCli_5538,pkSess_5317),Ksrv_5571))
                                                        )
                                                        else
                                                            {6031}let pkDisco_5572: bitstring = pub(sk(Disco_5314)) in
                                                            {6032}in(c, (=pkCli_5538,em1_5573: bitstring));
                                                            {6033}let m1_5574: bitstring = em1_5573 in
                                                            {6034}let (=OpenSecureChannelRequest,=pkCli_5538,PartC_5575: bitstring) = m1_5574 in
                                                            {6035}new Ns_5576: bitstring;
                                                            {6036}new ST_5577: bitstring;
                                                            {6037}new TTL_5578: bitstring;
                                                            {6038}let gNs_5579: bitstring = exp(g,Ns_5576) in
                                                            {6039}let m2_5580: bitstring = (OpenSecureChannelResponse,gNs_5579,ST_5577,TTL_5578) in
                                                            {6040}out(c, m2_5580);
                                                            {6041}let Ksrv_5581: bitstring = exp(PartC_5575,Ns_5576) in
                                                            {6042}out(c, senc(mSrv(pkCli_5538,pkSess_5317),Ksrv_5581))
                                                    )
                                                    else
                                                        {6043}let pkDisco_5582: bitstring = fail-any in
                                                        {6044}in(c, (=pkCli_5538,em1_5583: bitstring));
                                                        {6045}let m1_5584: bitstring = em1_5583 in
                                                        {6046}let (=OpenSecureChannelRequest,=pkCli_5538,PartC_5585: bitstring) = m1_5584 in
                                                        {6047}new Ns_5586: bitstring;
                                                        {6048}new ST_5587: bitstring;
                                                        {6049}new TTL_5588: bitstring;
                                                        {6050}let gNs_5589: bitstring = exp(g,Ns_5586) in
                                                        {6051}let m2_5590: bitstring = (OpenSecureChannelResponse,gNs_5589,ST_5587,TTL_5588) in
                                                        {6052}out(c, m2_5590);
                                                        {6053}let Ksrv_5591: bitstring = exp(PartC_5585,Ns_5586) in
                                                        {6054}out(c, senc(mSrv(pkCli_5538,pkSess_5317),Ksrv_5591))
                                            )
                                            else
                                                {6055}let pkDisco_5592: bitstring = fail-any in
                                                {6056}in(c, (=pkCli_5538,em1_5593: bitstring));
                                                {6057}let m1_5594: bitstring = em1_5593 in
                                                {6058}let (=OpenSecureChannelRequest,=pkCli_5538,PartC_5595: bitstring) = m1_5594 in
                                                {6059}new Ns_5596: bitstring;
                                                {6060}new ST_5597: bitstring;
                                                {6061}new TTL_5598: bitstring;
                                                {6062}let gNs_5599: bitstring = exp(g,Ns_5596) in
                                                {6063}let m2_5600: bitstring = (OpenSecureChannelResponse,gNs_5599,ST_5597,TTL_5598) in
                                                {6064}out(c, m2_5600);
                                                {6065}let Ksrv_5601: bitstring = exp(PartC_5595,Ns_5596) in
                                                {6066}out(c, senc(mSrv(pkCli_5538,pkSess_5317),Ksrv_5601))
                                    )
                                    else
                                        {6067}let pkDisco_5602: bitstring = fail-any in
                                        {6068}in(c, (=pkCli_5538,em1_5603: bitstring));
                                        {6069}let m1_5604: bitstring = em1_5603 in
                                        {6070}let (=OpenSecureChannelRequest,=pkCli_5538,PartC_5605: bitstring) = m1_5604 in
                                        {6071}new Ns_5606: bitstring;
                                        {6072}new ST_5607: bitstring;
                                        {6073}new TTL_5608: bitstring;
                                        {6074}let gNs_5609: bitstring = exp(g,Ns_5606) in
                                        {6075}let m2_5610: bitstring = (OpenSecureChannelResponse,gNs_5609,ST_5607,TTL_5608) in
                                        {6076}out(c, m2_5610);
                                        {6077}let Ksrv_5611: bitstring = exp(PartC_5605,Ns_5606) in
                                        {6078}out(c, senc(mSrv(pkCli_5538,pkSess_5317),Ksrv_5611))
                            )
                            else
                                {6079}let pkCli_5612: bitstring = fail-any in
                                {6080}let v_5613: bool = (Disco_5314 = A) in
                                (
                                    {6081}if v_5613 then
                                    (
                                        {6082}let pkDisco_5614: bitstring = pub(skA) in
                                        {6083}in(c, (=pkCli_5612,em1_5615: bitstring));
                                        {6084}let m1_5616: bitstring = em1_5615 in
                                        {6085}let (=OpenSecureChannelRequest,=pkCli_5612,PartC_5617: bitstring) = m1_5616 in
                                        {6086}new Ns_5618: bitstring;
                                        {6087}new ST_5619: bitstring;
                                        {6088}new TTL_5620: bitstring;
                                        {6089}let gNs_5621: bitstring = exp(g,Ns_5618) in
                                        {6090}let m2_5622: bitstring = (OpenSecureChannelResponse,gNs_5621,ST_5619,TTL_5620) in
                                        {6091}out(c, m2_5622);
                                        {6092}let Ksrv_5623: bitstring = exp(PartC_5617,Ns_5618) in
                                        {6093}out(c, senc(mSrv(pkCli_5612,pkSess_5317),Ksrv_5623))
                                    )
                                    else
                                        {6094}let v_5624: bool = (Disco_5314 = B) in
                                        (
                                            {6095}if v_5624 then
                                            (
                                                {6096}let pkDisco_5625: bitstring = pub(skB) in
                                                {6097}in(c, (=pkCli_5612,em1_5626: bitstring));
                                                {6098}let m1_5627: bitstring = em1_5626 in
                                                {6099}let (=OpenSecureChannelRequest,=pkCli_5612,PartC_5628: bitstring) = m1_5627 in
                                                {6100}new Ns_5629: bitstring;
                                                {6101}new ST_5630: bitstring;
                                                {6102}new TTL_5631: bitstring;
                                                {6103}let gNs_5632: bitstring = exp(g,Ns_5629) in
                                                {6104}let m2_5633: bitstring = (OpenSecureChannelResponse,gNs_5632,ST_5630,TTL_5631) in
                                                {6105}out(c, m2_5633);
                                                {6106}let Ksrv_5634: bitstring = exp(PartC_5628,Ns_5629) in
                                                {6107}out(c, senc(mSrv(pkCli_5612,pkSess_5317),Ksrv_5634))
                                            )
                                            else
                                                {6108}let v_5635: bool = (Disco_5314 = C) in
                                                (
                                                    {6109}if v_5635 then
                                                    (
                                                        {6110}let pkDisco_5636: bitstring = pub(skC) in
                                                        {6111}in(c, (=pkCli_5612,em1_5637: bitstring));
                                                        {6112}let m1_5638: bitstring = em1_5637 in
                                                        {6113}let (=OpenSecureChannelRequest,=pkCli_5612,PartC_5639: bitstring) = m1_5638 in
                                                        {6114}new Ns_5640: bitstring;
                                                        {6115}new ST_5641: bitstring;
                                                        {6116}new TTL_5642: bitstring;
                                                        {6117}let gNs_5643: bitstring = exp(g,Ns_5640) in
                                                        {6118}let m2_5644: bitstring = (OpenSecureChannelResponse,gNs_5643,ST_5641,TTL_5642) in
                                                        {6119}out(c, m2_5644);
                                                        {6120}let Ksrv_5645: bitstring = exp(PartC_5639,Ns_5640) in
                                                        {6121}out(c, senc(mSrv(pkCli_5612,pkSess_5317),Ksrv_5645))
                                                    )
                                                    else
                                                        {6122}let pkDisco_5646: bitstring = pub(sk(Disco_5314)) in
                                                        {6123}in(c, (=pkCli_5612,em1_5647: bitstring));
                                                        {6124}let m1_5648: bitstring = em1_5647 in
                                                        {6125}let (=OpenSecureChannelRequest,=pkCli_5612,PartC_5649: bitstring) = m1_5648 in
                                                        {6126}new Ns_5650: bitstring;
                                                        {6127}new ST_5651: bitstring;
                                                        {6128}new TTL_5652: bitstring;
                                                        {6129}let gNs_5653: bitstring = exp(g,Ns_5650) in
                                                        {6130}let m2_5654: bitstring = (OpenSecureChannelResponse,gNs_5653,ST_5651,TTL_5652) in
                                                        {6131}out(c, m2_5654);
                                                        {6132}let Ksrv_5655: bitstring = exp(PartC_5649,Ns_5650) in
                                                        {6133}out(c, senc(mSrv(pkCli_5612,pkSess_5317),Ksrv_5655))
                                                )
                                                else
                                                    {6134}let pkDisco_5656: bitstring = fail-any in
                                                    {6135}in(c, (=pkCli_5612,em1_5657: bitstring));
                                                    {6136}let m1_5658: bitstring = em1_5657 in
                                                    {6137}let (=OpenSecureChannelRequest,=pkCli_5612,PartC_5659: bitstring) = m1_5658 in
                                                    {6138}new Ns_5660: bitstring;
                                                    {6139}new ST_5661: bitstring;
                                                    {6140}new TTL_5662: bitstring;
                                                    {6141}let gNs_5663: bitstring = exp(g,Ns_5660) in
                                                    {6142}let m2_5664: bitstring = (OpenSecureChannelResponse,gNs_5663,ST_5661,TTL_5662) in
                                                    {6143}out(c, m2_5664);
                                                    {6144}let Ksrv_5665: bitstring = exp(PartC_5659,Ns_5660) in
                                                    {6145}out(c, senc(mSrv(pkCli_5612,pkSess_5317),Ksrv_5665))
                                        )
                                        else
                                            {6146}let pkDisco_5666: bitstring = fail-any in
                                            {6147}in(c, (=pkCli_5612,em1_5667: bitstring));
                                            {6148}let m1_5668: bitstring = em1_5667 in
                                            {6149}let (=OpenSecureChannelRequest,=pkCli_5612,PartC_5669: bitstring) = m1_5668 in
                                            {6150}new Ns_5670: bitstring;
                                            {6151}new ST_5671: bitstring;
                                            {6152}new TTL_5672: bitstring;
                                            {6153}let gNs_5673: bitstring = exp(g,Ns_5670) in
                                            {6154}let m2_5674: bitstring = (OpenSecureChannelResponse,gNs_5673,ST_5671,TTL_5672) in
                                            {6155}out(c, m2_5674);
                                            {6156}let Ksrv_5675: bitstring = exp(PartC_5669,Ns_5670) in
                                            {6157}out(c, senc(mSrv(pkCli_5612,pkSess_5317),Ksrv_5675))
                                )
                                else
                                    {6158}let pkDisco_5676: bitstring = fail-any in
                                    {6159}in(c, (=pkCli_5612,em1_5677: bitstring));
                                    {6160}let m1_5678: bitstring = em1_5677 in
                                    {6161}let (=OpenSecureChannelRequest,=pkCli_5612,PartC_5679: bitstring) = m1_5678 in
                                    {6162}new Ns_5680: bitstring;
                                    {6163}new ST_5681: bitstring;
                                    {6164}new TTL_5682: bitstring;
                                    {6165}let gNs_5683: bitstring = exp(g,Ns_5680) in
                                    {6166}let m2_5684: bitstring = (OpenSecureChannelResponse,gNs_5683,ST_5681,TTL_5682) in
                                    {6167}out(c, m2_5684);
                                    {6168}let Ksrv_5685: bitstring = exp(PartC_5679,Ns_5680) in
                                    {6169}out(c, senc(mSrv(pkCli_5612,pkSess_5317),Ksrv_5685))
                    )
                    else
                        {6170}let pkCli_5686: bitstring = fail-any in
                        {6171}let v_5687: bool = (Disco_5314 = A) in
                        (
                            {6172}if v_5687 then
                            (
                                {6173}let pkDisco_5688: bitstring = pub(skA) in
                                {6174}in(c, (=pkCli_5686,em1_5689: bitstring));
                                {6175}let m1_5690: bitstring = em1_5689 in
                                {6176}let (=OpenSecureChannelRequest,=pkCli_5686,PartC_5691: bitstring) = m1_5690 in
                                {6177}new Ns_5692: bitstring;
                                {6178}new ST_5693: bitstring;
                                {6179}new TTL_5694: bitstring;
                                {6180}let gNs_5695: bitstring = exp(g,Ns_5692) in
                                {6181}let m2_5696: bitstring = (OpenSecureChannelResponse,gNs_5695,ST_5693,TTL_5694) in
                                {6182}out(c, m2_5696);
                                {6183}let Ksrv_5697: bitstring = exp(PartC_5691,Ns_5692) in
                                {6184}out(c, senc(mSrv(pkCli_5686,pkSess_5317),Ksrv_5697))
                            )
                            else
                                {6185}let v_5698: bool = (Disco_5314 = B) in
                                (
                                    {6186}if v_5698 then
                                    (
                                        {6187}let pkDisco_5699: bitstring = pub(skB) in
                                        {6188}in(c, (=pkCli_5686,em1_5700: bitstring));
                                        {6189}let m1_5701: bitstring = em1_5700 in
                                        {6190}let (=OpenSecureChannelRequest,=pkCli_5686,PartC_5702: bitstring) = m1_5701 in
                                        {6191}new Ns_5703: bitstring;
                                        {6192}new ST_5704: bitstring;
                                        {6193}new TTL_5705: bitstring;
                                        {6194}let gNs_5706: bitstring = exp(g,Ns_5703) in
                                        {6195}let m2_5707: bitstring = (OpenSecureChannelResponse,gNs_5706,ST_5704,TTL_5705) in
                                        {6196}out(c, m2_5707);
                                        {6197}let Ksrv_5708: bitstring = exp(PartC_5702,Ns_5703) in
                                        {6198}out(c, senc(mSrv(pkCli_5686,pkSess_5317),Ksrv_5708))
                                    )
                                    else
                                        {6199}let v_5709: bool = (Disco_5314 = C) in
                                        (
                                            {6200}if v_5709 then
                                            (
                                                {6201}let pkDisco_5710: bitstring = pub(skC) in
                                                {6202}in(c, (=pkCli_5686,em1_5711: bitstring));
                                                {6203}let m1_5712: bitstring = em1_5711 in
                                                {6204}let (=OpenSecureChannelRequest,=pkCli_5686,PartC_5713: bitstring) = m1_5712 in
                                                {6205}new Ns_5714: bitstring;
                                                {6206}new ST_5715: bitstring;
                                                {6207}new TTL_5716: bitstring;
                                                {6208}let gNs_5717: bitstring = exp(g,Ns_5714) in
                                                {6209}let m2_5718: bitstring = (OpenSecureChannelResponse,gNs_5717,ST_5715,TTL_5716) in
                                                {6210}out(c, m2_5718);
                                                {6211}let Ksrv_5719: bitstring = exp(PartC_5713,Ns_5714) in
                                                {6212}out(c, senc(mSrv(pkCli_5686,pkSess_5317),Ksrv_5719))
                                            )
                                            else
                                                {6213}let pkDisco_5720: bitstring = pub(sk(Disco_5314)) in
                                                {6214}in(c, (=pkCli_5686,em1_5721: bitstring));
                                                {6215}let m1_5722: bitstring = em1_5721 in
                                                {6216}let (=OpenSecureChannelRequest,=pkCli_5686,PartC_5723: bitstring) = m1_5722 in
                                                {6217}new Ns_5724: bitstring;
                                                {6218}new ST_5725: bitstring;
                                                {6219}new TTL_5726: bitstring;
                                                {6220}let gNs_5727: bitstring = exp(g,Ns_5724) in
                                                {6221}let m2_5728: bitstring = (OpenSecureChannelResponse,gNs_5727,ST_5725,TTL_5726) in
                                                {6222}out(c, m2_5728);
                                                {6223}let Ksrv_5729: bitstring = exp(PartC_5723,Ns_5724) in
                                                {6224}out(c, senc(mSrv(pkCli_5686,pkSess_5317),Ksrv_5729))
                                        )
                                        else
                                            {6225}let pkDisco_5730: bitstring = fail-any in
                                            {6226}in(c, (=pkCli_5686,em1_5731: bitstring));
                                            {6227}let m1_5732: bitstring = em1_5731 in
                                            {6228}let (=OpenSecureChannelRequest,=pkCli_5686,PartC_5733: bitstring) = m1_5732 in
                                            {6229}new Ns_5734: bitstring;
                                            {6230}new ST_5735: bitstring;
                                            {6231}new TTL_5736: bitstring;
                                            {6232}let gNs_5737: bitstring = exp(g,Ns_5734) in
                                            {6233}let m2_5738: bitstring = (OpenSecureChannelResponse,gNs_5737,ST_5735,TTL_5736) in
                                            {6234}out(c, m2_5738);
                                            {6235}let Ksrv_5739: bitstring = exp(PartC_5733,Ns_5734) in
                                            {6236}out(c, senc(mSrv(pkCli_5686,pkSess_5317),Ksrv_5739))
                                )
                                else
                                    {6237}let pkDisco_5740: bitstring = fail-any in
                                    {6238}in(c, (=pkCli_5686,em1_5741: bitstring));
                                    {6239}let m1_5742: bitstring = em1_5741 in
                                    {6240}let (=OpenSecureChannelRequest,=pkCli_5686,PartC_5743: bitstring) = m1_5742 in
                                    {6241}new Ns_5744: bitstring;
                                    {6242}new ST_5745: bitstring;
                                    {6243}new TTL_5746: bitstring;
                                    {6244}let gNs_5747: bitstring = exp(g,Ns_5744) in
                                    {6245}let m2_5748: bitstring = (OpenSecureChannelResponse,gNs_5747,ST_5745,TTL_5746) in
                                    {6246}out(c, m2_5748);
                                    {6247}let Ksrv_5749: bitstring = exp(PartC_5743,Ns_5744) in
                                    {6248}out(c, senc(mSrv(pkCli_5686,pkSess_5317),Ksrv_5749))
                        )
                        else
                            {6249}let pkDisco_5750: bitstring = fail-any in
                            {6250}in(c, (=pkCli_5686,em1_5751: bitstring));
                            {6251}let m1_5752: bitstring = em1_5751 in
                            {6252}let (=OpenSecureChannelRequest,=pkCli_5686,PartC_5753: bitstring) = m1_5752 in
                            {6253}new Ns_5754: bitstring;
                            {6254}new ST_5755: bitstring;
                            {6255}new TTL_5756: bitstring;
                            {6256}let gNs_5757: bitstring = exp(g,Ns_5754) in
                            {6257}let m2_5758: bitstring = (OpenSecureChannelResponse,gNs_5757,ST_5755,TTL_5756) in
                            {6258}out(c, m2_5758);
                            {6259}let Ksrv_5759: bitstring = exp(PartC_5753,Ns_5754) in
                            {6260}out(c, senc(mSrv(pkCli_5686,pkSess_5317),Ksrv_5759))
            )
            else
                {6261}let pkCli_5760: bitstring = fail-any in
                {6262}let v_5761: bool = (Disco_5314 = A) in
                (
                    {6263}if v_5761 then
                    (
                        {6264}let pkDisco_5762: bitstring = pub(skA) in
                        {6265}in(c, (=pkCli_5760,em1_5763: bitstring));
                        {6266}let m1_5764: bitstring = em1_5763 in
                        {6267}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5765: bitstring) = m1_5764 in
                        {6268}new Ns_5766: bitstring;
                        {6269}new ST_5767: bitstring;
                        {6270}new TTL_5768: bitstring;
                        {6271}let gNs_5769: bitstring = exp(g,Ns_5766) in
                        {6272}let m2_5770: bitstring = (OpenSecureChannelResponse,gNs_5769,ST_5767,TTL_5768) in
                        {6273}out(c, m2_5770);
                        {6274}let Ksrv_5771: bitstring = exp(PartC_5765,Ns_5766) in
                        {6275}out(c, senc(mSrv(pkCli_5760,pkSess_5317),Ksrv_5771))
                    )
                    else
                        {6276}let v_5772: bool = (Disco_5314 = B) in
                        (
                            {6277}if v_5772 then
                            (
                                {6278}let pkDisco_5773: bitstring = pub(skB) in
                                {6279}in(c, (=pkCli_5760,em1_5774: bitstring));
                                {6280}let m1_5775: bitstring = em1_5774 in
                                {6281}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5776: bitstring) = m1_5775 in
                                {6282}new Ns_5777: bitstring;
                                {6283}new ST_5778: bitstring;
                                {6284}new TTL_5779: bitstring;
                                {6285}let gNs_5780: bitstring = exp(g,Ns_5777) in
                                {6286}let m2_5781: bitstring = (OpenSecureChannelResponse,gNs_5780,ST_5778,TTL_5779) in
                                {6287}out(c, m2_5781);
                                {6288}let Ksrv_5782: bitstring = exp(PartC_5776,Ns_5777) in
                                {6289}out(c, senc(mSrv(pkCli_5760,pkSess_5317),Ksrv_5782))
                            )
                            else
                                {6290}let v_5783: bool = (Disco_5314 = C) in
                                (
                                    {6291}if v_5783 then
                                    (
                                        {6292}let pkDisco_5784: bitstring = pub(skC) in
                                        {6293}in(c, (=pkCli_5760,em1_5785: bitstring));
                                        {6294}let m1_5786: bitstring = em1_5785 in
                                        {6295}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5787: bitstring) = m1_5786 in
                                        {6296}new Ns_5788: bitstring;
                                        {6297}new ST_5789: bitstring;
                                        {6298}new TTL_5790: bitstring;
                                        {6299}let gNs_5791: bitstring = exp(g,Ns_5788) in
                                        {6300}let m2_5792: bitstring = (OpenSecureChannelResponse,gNs_5791,ST_5789,TTL_5790) in
                                        {6301}out(c, m2_5792);
                                        {6302}let Ksrv_5793: bitstring = exp(PartC_5787,Ns_5788) in
                                        {6303}out(c, senc(mSrv(pkCli_5760,pkSess_5317),Ksrv_5793))
                                    )
                                    else
                                        {6304}let pkDisco_5794: bitstring = pub(sk(Disco_5314)) in
                                        {6305}in(c, (=pkCli_5760,em1_5795: bitstring));
                                        {6306}let m1_5796: bitstring = em1_5795 in
                                        {6307}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5797: bitstring) = m1_5796 in
                                        {6308}new Ns_5798: bitstring;
                                        {6309}new ST_5799: bitstring;
                                        {6310}new TTL_5800: bitstring;
                                        {6311}let gNs_5801: bitstring = exp(g,Ns_5798) in
                                        {6312}let m2_5802: bitstring = (OpenSecureChannelResponse,gNs_5801,ST_5799,TTL_5800) in
                                        {6313}out(c, m2_5802);
                                        {6314}let Ksrv_5803: bitstring = exp(PartC_5797,Ns_5798) in
                                        {6315}out(c, senc(mSrv(pkCli_5760,pkSess_5317),Ksrv_5803))
                                )
                                else
                                    {6316}let pkDisco_5804: bitstring = fail-any in
                                    {6317}in(c, (=pkCli_5760,em1_5805: bitstring));
                                    {6318}let m1_5806: bitstring = em1_5805 in
                                    {6319}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5807: bitstring) = m1_5806 in
                                    {6320}new Ns_5808: bitstring;
                                    {6321}new ST_5809: bitstring;
                                    {6322}new TTL_5810: bitstring;
                                    {6323}let gNs_5811: bitstring = exp(g,Ns_5808) in
                                    {6324}let m2_5812: bitstring = (OpenSecureChannelResponse,gNs_5811,ST_5809,TTL_5810) in
                                    {6325}out(c, m2_5812);
                                    {6326}let Ksrv_5813: bitstring = exp(PartC_5807,Ns_5808) in
                                    {6327}out(c, senc(mSrv(pkCli_5760,pkSess_5317),Ksrv_5813))
                        )
                        else
                            {6328}let pkDisco_5814: bitstring = fail-any in
                            {6329}in(c, (=pkCli_5760,em1_5815: bitstring));
                            {6330}let m1_5816: bitstring = em1_5815 in
                            {6331}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5817: bitstring) = m1_5816 in
                            {6332}new Ns_5818: bitstring;
                            {6333}new ST_5819: bitstring;
                            {6334}new TTL_5820: bitstring;
                            {6335}let gNs_5821: bitstring = exp(g,Ns_5818) in
                            {6336}let m2_5822: bitstring = (OpenSecureChannelResponse,gNs_5821,ST_5819,TTL_5820) in
                            {6337}out(c, m2_5822);
                            {6338}let Ksrv_5823: bitstring = exp(PartC_5817,Ns_5818) in
                            {6339}out(c, senc(mSrv(pkCli_5760,pkSess_5317),Ksrv_5823))
                )
                else
                    {6340}let pkDisco_5824: bitstring = fail-any in
                    {6341}in(c, (=pkCli_5760,em1_5825: bitstring));
                    {6342}let m1_5826: bitstring = em1_5825 in
                    {6343}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5827: bitstring) = m1_5826 in
                    {6344}new Ns_5828: bitstring;
                    {6345}new ST_5829: bitstring;
                    {6346}new TTL_5830: bitstring;
                    {6347}let gNs_5831: bitstring = exp(g,Ns_5828) in
                    {6348}let m2_5832: bitstring = (OpenSecureChannelResponse,gNs_5831,ST_5829,TTL_5830) in
                    {6349}out(c, m2_5832);
                    {6350}let Ksrv_5833: bitstring = exp(PartC_5827,Ns_5828) in
                    {6351}out(c, senc(mSrv(pkCli_5760,pkSess_5317),Ksrv_5833))
        )
        else
            {6352}let v_5834: bool = (Sess_5315 = B) in
            (
                {6353}if v_5834 then
                (
                    {6354}let skSess_5835: bitstring = skB in
                    {6355}let pkSess_5836: bitstring = pub(skSess_5835) in
                    {6356}let v_5837: bool = (Cli_5313 = A) in
                    (
                        {6357}if v_5837 then
                        (
                            {6358}let pkCli_5838: bitstring = pub(skA) in
                            {6359}let v_5839: bool = (Disco_5314 = A) in
                            (
                                {6360}if v_5839 then
                                (
                                    {6361}let pkDisco_5840: bitstring = pub(skA) in
                                    {6362}in(c, (=pkCli_5838,em1_5841: bitstring));
                                    {6363}let m1_5842: bitstring = em1_5841 in
                                    {6364}let (=OpenSecureChannelRequest,=pkCli_5838,PartC_5843: bitstring) = m1_5842 in
                                    {6365}new Ns_5844: bitstring;
                                    {6366}new ST_5845: bitstring;
                                    {6367}new TTL_5846: bitstring;
                                    {6368}let gNs_5847: bitstring = exp(g,Ns_5844) in
                                    {6369}let m2_5848: bitstring = (OpenSecureChannelResponse,gNs_5847,ST_5845,TTL_5846) in
                                    {6370}out(c, m2_5848);
                                    {6371}let Ksrv_5849: bitstring = exp(PartC_5843,Ns_5844) in
                                    {6372}out(c, senc(mSrv(pkCli_5838,pkSess_5836),Ksrv_5849))
                                )
                                else
                                    {6373}let v_5850: bool = (Disco_5314 = B) in
                                    (
                                        {6374}if v_5850 then
                                        (
                                            {6375}let pkDisco_5851: bitstring = pub(skB) in
                                            {6376}in(c, (=pkCli_5838,em1_5852: bitstring));
                                            {6377}let m1_5853: bitstring = em1_5852 in
                                            {6378}let (=OpenSecureChannelRequest,=pkCli_5838,PartC_5854: bitstring) = m1_5853 in
                                            {6379}new Ns_5855: bitstring;
                                            {6380}new ST_5856: bitstring;
                                            {6381}new TTL_5857: bitstring;
                                            {6382}let gNs_5858: bitstring = exp(g,Ns_5855) in
                                            {6383}let m2_5859: bitstring = (OpenSecureChannelResponse,gNs_5858,ST_5856,TTL_5857) in
                                            {6384}out(c, m2_5859);
                                            {6385}let Ksrv_5860: bitstring = exp(PartC_5854,Ns_5855) in
                                            {6386}out(c, senc(mSrv(pkCli_5838,pkSess_5836),Ksrv_5860))
                                        )
                                        else
                                            {6387}let v_5861: bool = (Disco_5314 = C) in
                                            (
                                                {6388}if v_5861 then
                                                (
                                                    {6389}let pkDisco_5862: bitstring = pub(skC) in
                                                    {6390}in(c, (=pkCli_5838,em1_5863: bitstring));
                                                    {6391}let m1_5864: bitstring = em1_5863 in
                                                    {6392}let (=OpenSecureChannelRequest,=pkCli_5838,PartC_5865: bitstring) = m1_5864 in
                                                    {6393}new Ns_5866: bitstring;
                                                    {6394}new ST_5867: bitstring;
                                                    {6395}new TTL_5868: bitstring;
                                                    {6396}let gNs_5869: bitstring = exp(g,Ns_5866) in
                                                    {6397}let m2_5870: bitstring = (OpenSecureChannelResponse,gNs_5869,ST_5867,TTL_5868) in
                                                    {6398}out(c, m2_5870);
                                                    {6399}let Ksrv_5871: bitstring = exp(PartC_5865,Ns_5866) in
                                                    {6400}out(c, senc(mSrv(pkCli_5838,pkSess_5836),Ksrv_5871))
                                                )
                                                else
                                                    {6401}let pkDisco_5872: bitstring = pub(sk(Disco_5314)) in
                                                    {6402}in(c, (=pkCli_5838,em1_5873: bitstring));
                                                    {6403}let m1_5874: bitstring = em1_5873 in
                                                    {6404}let (=OpenSecureChannelRequest,=pkCli_5838,PartC_5875: bitstring) = m1_5874 in
                                                    {6405}new Ns_5876: bitstring;
                                                    {6406}new ST_5877: bitstring;
                                                    {6407}new TTL_5878: bitstring;
                                                    {6408}let gNs_5879: bitstring = exp(g,Ns_5876) in
                                                    {6409}let m2_5880: bitstring = (OpenSecureChannelResponse,gNs_5879,ST_5877,TTL_5878) in
                                                    {6410}out(c, m2_5880);
                                                    {6411}let Ksrv_5881: bitstring = exp(PartC_5875,Ns_5876) in
                                                    {6412}out(c, senc(mSrv(pkCli_5838,pkSess_5836),Ksrv_5881))
                                            )
                                            else
                                                {6413}let pkDisco_5882: bitstring = fail-any in
                                                {6414}in(c, (=pkCli_5838,em1_5883: bitstring));
                                                {6415}let m1_5884: bitstring = em1_5883 in
                                                {6416}let (=OpenSecureChannelRequest,=pkCli_5838,PartC_5885: bitstring) = m1_5884 in
                                                {6417}new Ns_5886: bitstring;
                                                {6418}new ST_5887: bitstring;
                                                {6419}new TTL_5888: bitstring;
                                                {6420}let gNs_5889: bitstring = exp(g,Ns_5886) in
                                                {6421}let m2_5890: bitstring = (OpenSecureChannelResponse,gNs_5889,ST_5887,TTL_5888) in
                                                {6422}out(c, m2_5890);
                                                {6423}let Ksrv_5891: bitstring = exp(PartC_5885,Ns_5886) in
                                                {6424}out(c, senc(mSrv(pkCli_5838,pkSess_5836),Ksrv_5891))
                                    )
                                    else
                                        {6425}let pkDisco_5892: bitstring = fail-any in
                                        {6426}in(c, (=pkCli_5838,em1_5893: bitstring));
                                        {6427}let m1_5894: bitstring = em1_5893 in
                                        {6428}let (=OpenSecureChannelRequest,=pkCli_5838,PartC_5895: bitstring) = m1_5894 in
                                        {6429}new Ns_5896: bitstring;
                                        {6430}new ST_5897: bitstring;
                                        {6431}new TTL_5898: bitstring;
                                        {6432}let gNs_5899: bitstring = exp(g,Ns_5896) in
                                        {6433}let m2_5900: bitstring = (OpenSecureChannelResponse,gNs_5899,ST_5897,TTL_5898) in
                                        {6434}out(c, m2_5900);
                                        {6435}let Ksrv_5901: bitstring = exp(PartC_5895,Ns_5896) in
                                        {6436}out(c, senc(mSrv(pkCli_5838,pkSess_5836),Ksrv_5901))
                            )
                            else
                                {6437}let pkDisco_5902: bitstring = fail-any in
                                {6438}in(c, (=pkCli_5838,em1_5903: bitstring));
                                {6439}let m1_5904: bitstring = em1_5903 in
                                {6440}let (=OpenSecureChannelRequest,=pkCli_5838,PartC_5905: bitstring) = m1_5904 in
                                {6441}new Ns_5906: bitstring;
                                {6442}new ST_5907: bitstring;
                                {6443}new TTL_5908: bitstring;
                                {6444}let gNs_5909: bitstring = exp(g,Ns_5906) in
                                {6445}let m2_5910: bitstring = (OpenSecureChannelResponse,gNs_5909,ST_5907,TTL_5908) in
                                {6446}out(c, m2_5910);
                                {6447}let Ksrv_5911: bitstring = exp(PartC_5905,Ns_5906) in
                                {6448}out(c, senc(mSrv(pkCli_5838,pkSess_5836),Ksrv_5911))
                        )
                        else
                            {6449}let v_5912: bool = (Cli_5313 = B) in
                            (
                                {6450}if v_5912 then
                                (
                                    {6451}let pkCli_5913: bitstring = pub(skB) in
                                    {6452}let v_5914: bool = (Disco_5314 = A) in
                                    (
                                        {6453}if v_5914 then
                                        (
                                            {6454}let pkDisco_5915: bitstring = pub(skA) in
                                            {6455}in(c, (=pkCli_5913,em1_5916: bitstring));
                                            {6456}let m1_5917: bitstring = em1_5916 in
                                            {6457}let (=OpenSecureChannelRequest,=pkCli_5913,PartC_5918: bitstring) = m1_5917 in
                                            {6458}new Ns_5919: bitstring;
                                            {6459}new ST_5920: bitstring;
                                            {6460}new TTL_5921: bitstring;
                                            {6461}let gNs_5922: bitstring = exp(g,Ns_5919) in
                                            {6462}let m2_5923: bitstring = (OpenSecureChannelResponse,gNs_5922,ST_5920,TTL_5921) in
                                            {6463}out(c, m2_5923);
                                            {6464}let Ksrv_5924: bitstring = exp(PartC_5918,Ns_5919) in
                                            {6465}out(c, senc(mSrv(pkCli_5913,pkSess_5836),Ksrv_5924))
                                        )
                                        else
                                            {6466}let v_5925: bool = (Disco_5314 = B) in
                                            (
                                                {6467}if v_5925 then
                                                (
                                                    {6468}let pkDisco_5926: bitstring = pub(skB) in
                                                    {6469}in(c, (=pkCli_5913,em1_5927: bitstring));
                                                    {6470}let m1_5928: bitstring = em1_5927 in
                                                    {6471}let (=OpenSecureChannelRequest,=pkCli_5913,PartC_5929: bitstring) = m1_5928 in
                                                    {6472}new Ns_5930: bitstring;
                                                    {6473}new ST_5931: bitstring;
                                                    {6474}new TTL_5932: bitstring;
                                                    {6475}let gNs_5933: bitstring = exp(g,Ns_5930) in
                                                    {6476}let m2_5934: bitstring = (OpenSecureChannelResponse,gNs_5933,ST_5931,TTL_5932) in
                                                    {6477}out(c, m2_5934);
                                                    {6478}let Ksrv_5935: bitstring = exp(PartC_5929,Ns_5930) in
                                                    {6479}out(c, senc(mSrv(pkCli_5913,pkSess_5836),Ksrv_5935))
                                                )
                                                else
                                                    {6480}let v_5936: bool = (Disco_5314 = C) in
                                                    (
                                                        {6481}if v_5936 then
                                                        (
                                                            {6482}let pkDisco_5937: bitstring = pub(skC) in
                                                            {6483}in(c, (=pkCli_5913,em1_5938: bitstring));
                                                            {6484}let m1_5939: bitstring = em1_5938 in
                                                            {6485}let (=OpenSecureChannelRequest,=pkCli_5913,PartC_5940: bitstring) = m1_5939 in
                                                            {6486}new Ns_5941: bitstring;
                                                            {6487}new ST_5942: bitstring;
                                                            {6488}new TTL_5943: bitstring;
                                                            {6489}let gNs_5944: bitstring = exp(g,Ns_5941) in
                                                            {6490}let m2_5945: bitstring = (OpenSecureChannelResponse,gNs_5944,ST_5942,TTL_5943) in
                                                            {6491}out(c, m2_5945);
                                                            {6492}let Ksrv_5946: bitstring = exp(PartC_5940,Ns_5941) in
                                                            {6493}out(c, senc(mSrv(pkCli_5913,pkSess_5836),Ksrv_5946))
                                                        )
                                                        else
                                                            {6494}let pkDisco_5947: bitstring = pub(sk(Disco_5314)) in
                                                            {6495}in(c, (=pkCli_5913,em1_5948: bitstring));
                                                            {6496}let m1_5949: bitstring = em1_5948 in
                                                            {6497}let (=OpenSecureChannelRequest,=pkCli_5913,PartC_5950: bitstring) = m1_5949 in
                                                            {6498}new Ns_5951: bitstring;
                                                            {6499}new ST_5952: bitstring;
                                                            {6500}new TTL_5953: bitstring;
                                                            {6501}let gNs_5954: bitstring = exp(g,Ns_5951) in
                                                            {6502}let m2_5955: bitstring = (OpenSecureChannelResponse,gNs_5954,ST_5952,TTL_5953) in
                                                            {6503}out(c, m2_5955);
                                                            {6504}let Ksrv_5956: bitstring = exp(PartC_5950,Ns_5951) in
                                                            {6505}out(c, senc(mSrv(pkCli_5913,pkSess_5836),Ksrv_5956))
                                                    )
                                                    else
                                                        {6506}let pkDisco_5957: bitstring = fail-any in
                                                        {6507}in(c, (=pkCli_5913,em1_5958: bitstring));
                                                        {6508}let m1_5959: bitstring = em1_5958 in
                                                        {6509}let (=OpenSecureChannelRequest,=pkCli_5913,PartC_5960: bitstring) = m1_5959 in
                                                        {6510}new Ns_5961: bitstring;
                                                        {6511}new ST_5962: bitstring;
                                                        {6512}new TTL_5963: bitstring;
                                                        {6513}let gNs_5964: bitstring = exp(g,Ns_5961) in
                                                        {6514}let m2_5965: bitstring = (OpenSecureChannelResponse,gNs_5964,ST_5962,TTL_5963) in
                                                        {6515}out(c, m2_5965);
                                                        {6516}let Ksrv_5966: bitstring = exp(PartC_5960,Ns_5961) in
                                                        {6517}out(c, senc(mSrv(pkCli_5913,pkSess_5836),Ksrv_5966))
                                            )
                                            else
                                                {6518}let pkDisco_5967: bitstring = fail-any in
                                                {6519}in(c, (=pkCli_5913,em1_5968: bitstring));
                                                {6520}let m1_5969: bitstring = em1_5968 in
                                                {6521}let (=OpenSecureChannelRequest,=pkCli_5913,PartC_5970: bitstring) = m1_5969 in
                                                {6522}new Ns_5971: bitstring;
                                                {6523}new ST_5972: bitstring;
                                                {6524}new TTL_5973: bitstring;
                                                {6525}let gNs_5974: bitstring = exp(g,Ns_5971) in
                                                {6526}let m2_5975: bitstring = (OpenSecureChannelResponse,gNs_5974,ST_5972,TTL_5973) in
                                                {6527}out(c, m2_5975);
                                                {6528}let Ksrv_5976: bitstring = exp(PartC_5970,Ns_5971) in
                                                {6529}out(c, senc(mSrv(pkCli_5913,pkSess_5836),Ksrv_5976))
                                    )
                                    else
                                        {6530}let pkDisco_5977: bitstring = fail-any in
                                        {6531}in(c, (=pkCli_5913,em1_5978: bitstring));
                                        {6532}let m1_5979: bitstring = em1_5978 in
                                        {6533}let (=OpenSecureChannelRequest,=pkCli_5913,PartC_5980: bitstring) = m1_5979 in
                                        {6534}new Ns_5981: bitstring;
                                        {6535}new ST_5982: bitstring;
                                        {6536}new TTL_5983: bitstring;
                                        {6537}let gNs_5984: bitstring = exp(g,Ns_5981) in
                                        {6538}let m2_5985: bitstring = (OpenSecureChannelResponse,gNs_5984,ST_5982,TTL_5983) in
                                        {6539}out(c, m2_5985);
                                        {6540}let Ksrv_5986: bitstring = exp(PartC_5980,Ns_5981) in
                                        {6541}out(c, senc(mSrv(pkCli_5913,pkSess_5836),Ksrv_5986))
                                )
                                else
                                    {6542}let v_5987: bool = (Cli_5313 = C) in
                                    (
                                        {6543}if v_5987 then
                                        (
                                            {6544}let pkCli_5988: bitstring = pub(skC) in
                                            {6545}let v_5989: bool = (Disco_5314 = A) in
                                            (
                                                {6546}if v_5989 then
                                                (
                                                    {6547}let pkDisco_5990: bitstring = pub(skA) in
                                                    {6548}in(c, (=pkCli_5988,em1_5991: bitstring));
                                                    {6549}let m1_5992: bitstring = em1_5991 in
                                                    {6550}let (=OpenSecureChannelRequest,=pkCli_5988,PartC_5993: bitstring) = m1_5992 in
                                                    {6551}new Ns_5994: bitstring;
                                                    {6552}new ST_5995: bitstring;
                                                    {6553}new TTL_5996: bitstring;
                                                    {6554}let gNs_5997: bitstring = exp(g,Ns_5994) in
                                                    {6555}let m2_5998: bitstring = (OpenSecureChannelResponse,gNs_5997,ST_5995,TTL_5996) in
                                                    {6556}out(c, m2_5998);
                                                    {6557}let Ksrv_5999: bitstring = exp(PartC_5993,Ns_5994) in
                                                    {6558}out(c, senc(mSrv(pkCli_5988,pkSess_5836),Ksrv_5999))
                                                )
                                                else
                                                    {6559}let v_6000: bool = (Disco_5314 = B) in
                                                    (
                                                        {6560}if v_6000 then
                                                        (
                                                            {6561}let pkDisco_6001: bitstring = pub(skB) in
                                                            {6562}in(c, (=pkCli_5988,em1_6002: bitstring));
                                                            {6563}let m1_6003: bitstring = em1_6002 in
                                                            {6564}let (=OpenSecureChannelRequest,=pkCli_5988,PartC_6004: bitstring) = m1_6003 in
                                                            {6565}new Ns_6005: bitstring;
                                                            {6566}new ST_6006: bitstring;
                                                            {6567}new TTL_6007: bitstring;
                                                            {6568}let gNs_6008: bitstring = exp(g,Ns_6005) in
                                                            {6569}let m2_6009: bitstring = (OpenSecureChannelResponse,gNs_6008,ST_6006,TTL_6007) in
                                                            {6570}out(c, m2_6009);
                                                            {6571}let Ksrv_6010: bitstring = exp(PartC_6004,Ns_6005) in
                                                            {6572}out(c, senc(mSrv(pkCli_5988,pkSess_5836),Ksrv_6010))
                                                        )
                                                        else
                                                            {6573}let v_6011: bool = (Disco_5314 = C) in
                                                            (
                                                                {6574}if v_6011 then
                                                                (
                                                                    {6575}let pkDisco_6012: bitstring = pub(skC) in
                                                                    {6576}in(c, (=pkCli_5988,em1_6013: bitstring));
                                                                    {6577}let m1_6014: bitstring = em1_6013 in
                                                                    {6578}let (=OpenSecureChannelRequest,=pkCli_5988,PartC_6015: bitstring) = m1_6014 in
                                                                    {6579}new Ns_6016: bitstring;
                                                                    {6580}new ST_6017: bitstring;
                                                                    {6581}new TTL_6018: bitstring;
                                                                    {6582}let gNs_6019: bitstring = exp(g,Ns_6016) in
                                                                    {6583}let m2_6020: bitstring = (OpenSecureChannelResponse,gNs_6019,ST_6017,TTL_6018) in
                                                                    {6584}out(c, m2_6020);
                                                                    {6585}let Ksrv_6021: bitstring = exp(PartC_6015,Ns_6016) in
                                                                    {6586}out(c, senc(mSrv(pkCli_5988,pkSess_5836),Ksrv_6021))
                                                                )
                                                                else
                                                                    {6587}let pkDisco_6022: bitstring = pub(sk(Disco_5314)) in
                                                                    {6588}in(c, (=pkCli_5988,em1_6023: bitstring));
                                                                    {6589}let m1_6024: bitstring = em1_6023 in
                                                                    {6590}let (=OpenSecureChannelRequest,=pkCli_5988,PartC_6025: bitstring) = m1_6024 in
                                                                    {6591}new Ns_6026: bitstring;
                                                                    {6592}new ST_6027: bitstring;
                                                                    {6593}new TTL_6028: bitstring;
                                                                    {6594}let gNs_6029: bitstring = exp(g,Ns_6026) in
                                                                    {6595}let m2_6030: bitstring = (OpenSecureChannelResponse,gNs_6029,ST_6027,TTL_6028) in
                                                                    {6596}out(c, m2_6030);
                                                                    {6597}let Ksrv_6031: bitstring = exp(PartC_6025,Ns_6026) in
                                                                    {6598}out(c, senc(mSrv(pkCli_5988,pkSess_5836),Ksrv_6031))
                                                            )
                                                            else
                                                                {6599}let pkDisco_6032: bitstring = fail-any in
                                                                {6600}in(c, (=pkCli_5988,em1_6033: bitstring));
                                                                {6601}let m1_6034: bitstring = em1_6033 in
                                                                {6602}let (=OpenSecureChannelRequest,=pkCli_5988,PartC_6035: bitstring) = m1_6034 in
                                                                {6603}new Ns_6036: bitstring;
                                                                {6604}new ST_6037: bitstring;
                                                                {6605}new TTL_6038: bitstring;
                                                                {6606}let gNs_6039: bitstring = exp(g,Ns_6036) in
                                                                {6607}let m2_6040: bitstring = (OpenSecureChannelResponse,gNs_6039,ST_6037,TTL_6038) in
                                                                {6608}out(c, m2_6040);
                                                                {6609}let Ksrv_6041: bitstring = exp(PartC_6035,Ns_6036) in
                                                                {6610}out(c, senc(mSrv(pkCli_5988,pkSess_5836),Ksrv_6041))
                                                    )
                                                    else
                                                        {6611}let pkDisco_6042: bitstring = fail-any in
                                                        {6612}in(c, (=pkCli_5988,em1_6043: bitstring));
                                                        {6613}let m1_6044: bitstring = em1_6043 in
                                                        {6614}let (=OpenSecureChannelRequest,=pkCli_5988,PartC_6045: bitstring) = m1_6044 in
                                                        {6615}new Ns_6046: bitstring;
                                                        {6616}new ST_6047: bitstring;
                                                        {6617}new TTL_6048: bitstring;
                                                        {6618}let gNs_6049: bitstring = exp(g,Ns_6046) in
                                                        {6619}let m2_6050: bitstring = (OpenSecureChannelResponse,gNs_6049,ST_6047,TTL_6048) in
                                                        {6620}out(c, m2_6050);
                                                        {6621}let Ksrv_6051: bitstring = exp(PartC_6045,Ns_6046) in
                                                        {6622}out(c, senc(mSrv(pkCli_5988,pkSess_5836),Ksrv_6051))
                                            )
                                            else
                                                {6623}let pkDisco_6052: bitstring = fail-any in
                                                {6624}in(c, (=pkCli_5988,em1_6053: bitstring));
                                                {6625}let m1_6054: bitstring = em1_6053 in
                                                {6626}let (=OpenSecureChannelRequest,=pkCli_5988,PartC_6055: bitstring) = m1_6054 in
                                                {6627}new Ns_6056: bitstring;
                                                {6628}new ST_6057: bitstring;
                                                {6629}new TTL_6058: bitstring;
                                                {6630}let gNs_6059: bitstring = exp(g,Ns_6056) in
                                                {6631}let m2_6060: bitstring = (OpenSecureChannelResponse,gNs_6059,ST_6057,TTL_6058) in
                                                {6632}out(c, m2_6060);
                                                {6633}let Ksrv_6061: bitstring = exp(PartC_6055,Ns_6056) in
                                                {6634}out(c, senc(mSrv(pkCli_5988,pkSess_5836),Ksrv_6061))
                                        )
                                        else
                                            {6635}let pkCli_6062: bitstring = pub(sk(Cli_5313)) in
                                            {6636}let v_6063: bool = (Disco_5314 = A) in
                                            (
                                                {6637}if v_6063 then
                                                (
                                                    {6638}let pkDisco_6064: bitstring = pub(skA) in
                                                    {6639}in(c, (=pkCli_6062,em1_6065: bitstring));
                                                    {6640}let m1_6066: bitstring = em1_6065 in
                                                    {6641}let (=OpenSecureChannelRequest,=pkCli_6062,PartC_6067: bitstring) = m1_6066 in
                                                    {6642}new Ns_6068: bitstring;
                                                    {6643}new ST_6069: bitstring;
                                                    {6644}new TTL_6070: bitstring;
                                                    {6645}let gNs_6071: bitstring = exp(g,Ns_6068) in
                                                    {6646}let m2_6072: bitstring = (OpenSecureChannelResponse,gNs_6071,ST_6069,TTL_6070) in
                                                    {6647}out(c, m2_6072);
                                                    {6648}let Ksrv_6073: bitstring = exp(PartC_6067,Ns_6068) in
                                                    {6649}out(c, senc(mSrv(pkCli_6062,pkSess_5836),Ksrv_6073))
                                                )
                                                else
                                                    {6650}let v_6074: bool = (Disco_5314 = B) in
                                                    (
                                                        {6651}if v_6074 then
                                                        (
                                                            {6652}let pkDisco_6075: bitstring = pub(skB) in
                                                            {6653}in(c, (=pkCli_6062,em1_6076: bitstring));
                                                            {6654}let m1_6077: bitstring = em1_6076 in
                                                            {6655}let (=OpenSecureChannelRequest,=pkCli_6062,PartC_6078: bitstring) = m1_6077 in
                                                            {6656}new Ns_6079: bitstring;
                                                            {6657}new ST_6080: bitstring;
                                                            {6658}new TTL_6081: bitstring;
                                                            {6659}let gNs_6082: bitstring = exp(g,Ns_6079) in
                                                            {6660}let m2_6083: bitstring = (OpenSecureChannelResponse,gNs_6082,ST_6080,TTL_6081) in
                                                            {6661}out(c, m2_6083);
                                                            {6662}let Ksrv_6084: bitstring = exp(PartC_6078,Ns_6079) in
                                                            {6663}out(c, senc(mSrv(pkCli_6062,pkSess_5836),Ksrv_6084))
                                                        )
                                                        else
                                                            {6664}let v_6085: bool = (Disco_5314 = C) in
                                                            (
                                                                {6665}if v_6085 then
                                                                (
                                                                    {6666}let pkDisco_6086: bitstring = pub(skC) in
                                                                    {6667}in(c, (=pkCli_6062,em1_6087: bitstring));
                                                                    {6668}let m1_6088: bitstring = em1_6087 in
                                                                    {6669}let (=OpenSecureChannelRequest,=pkCli_6062,PartC_6089: bitstring) = m1_6088 in
                                                                    {6670}new Ns_6090: bitstring;
                                                                    {6671}new ST_6091: bitstring;
                                                                    {6672}new TTL_6092: bitstring;
                                                                    {6673}let gNs_6093: bitstring = exp(g,Ns_6090) in
                                                                    {6674}let m2_6094: bitstring = (OpenSecureChannelResponse,gNs_6093,ST_6091,TTL_6092) in
                                                                    {6675}out(c, m2_6094);
                                                                    {6676}let Ksrv_6095: bitstring = exp(PartC_6089,Ns_6090) in
                                                                    {6677}out(c, senc(mSrv(pkCli_6062,pkSess_5836),Ksrv_6095))
                                                                )
                                                                else
                                                                    {6678}let pkDisco_6096: bitstring = pub(sk(Disco_5314)) in
                                                                    {6679}in(c, (=pkCli_6062,em1_6097: bitstring));
                                                                    {6680}let m1_6098: bitstring = em1_6097 in
                                                                    {6681}let (=OpenSecureChannelRequest,=pkCli_6062,PartC_6099: bitstring) = m1_6098 in
                                                                    {6682}new Ns_6100: bitstring;
                                                                    {6683}new ST_6101: bitstring;
                                                                    {6684}new TTL_6102: bitstring;
                                                                    {6685}let gNs_6103: bitstring = exp(g,Ns_6100) in
                                                                    {6686}let m2_6104: bitstring = (OpenSecureChannelResponse,gNs_6103,ST_6101,TTL_6102) in
                                                                    {6687}out(c, m2_6104);
                                                                    {6688}let Ksrv_6105: bitstring = exp(PartC_6099,Ns_6100) in
                                                                    {6689}out(c, senc(mSrv(pkCli_6062,pkSess_5836),Ksrv_6105))
                                                            )
                                                            else
                                                                {6690}let pkDisco_6106: bitstring = fail-any in
                                                                {6691}in(c, (=pkCli_6062,em1_6107: bitstring));
                                                                {6692}let m1_6108: bitstring = em1_6107 in
                                                                {6693}let (=OpenSecureChannelRequest,=pkCli_6062,PartC_6109: bitstring) = m1_6108 in
                                                                {6694}new Ns_6110: bitstring;
                                                                {6695}new ST_6111: bitstring;
                                                                {6696}new TTL_6112: bitstring;
                                                                {6697}let gNs_6113: bitstring = exp(g,Ns_6110) in
                                                                {6698}let m2_6114: bitstring = (OpenSecureChannelResponse,gNs_6113,ST_6111,TTL_6112) in
                                                                {6699}out(c, m2_6114);
                                                                {6700}let Ksrv_6115: bitstring = exp(PartC_6109,Ns_6110) in
                                                                {6701}out(c, senc(mSrv(pkCli_6062,pkSess_5836),Ksrv_6115))
                                                    )
                                                    else
                                                        {6702}let pkDisco_6116: bitstring = fail-any in
                                                        {6703}in(c, (=pkCli_6062,em1_6117: bitstring));
                                                        {6704}let m1_6118: bitstring = em1_6117 in
                                                        {6705}let (=OpenSecureChannelRequest,=pkCli_6062,PartC_6119: bitstring) = m1_6118 in
                                                        {6706}new Ns_6120: bitstring;
                                                        {6707}new ST_6121: bitstring;
                                                        {6708}new TTL_6122: bitstring;
                                                        {6709}let gNs_6123: bitstring = exp(g,Ns_6120) in
                                                        {6710}let m2_6124: bitstring = (OpenSecureChannelResponse,gNs_6123,ST_6121,TTL_6122) in
                                                        {6711}out(c, m2_6124);
                                                        {6712}let Ksrv_6125: bitstring = exp(PartC_6119,Ns_6120) in
                                                        {6713}out(c, senc(mSrv(pkCli_6062,pkSess_5836),Ksrv_6125))
                                            )
                                            else
                                                {6714}let pkDisco_6126: bitstring = fail-any in
                                                {6715}in(c, (=pkCli_6062,em1_6127: bitstring));
                                                {6716}let m1_6128: bitstring = em1_6127 in
                                                {6717}let (=OpenSecureChannelRequest,=pkCli_6062,PartC_6129: bitstring) = m1_6128 in
                                                {6718}new Ns_6130: bitstring;
                                                {6719}new ST_6131: bitstring;
                                                {6720}new TTL_6132: bitstring;
                                                {6721}let gNs_6133: bitstring = exp(g,Ns_6130) in
                                                {6722}let m2_6134: bitstring = (OpenSecureChannelResponse,gNs_6133,ST_6131,TTL_6132) in
                                                {6723}out(c, m2_6134);
                                                {6724}let Ksrv_6135: bitstring = exp(PartC_6129,Ns_6130) in
                                                {6725}out(c, senc(mSrv(pkCli_6062,pkSess_5836),Ksrv_6135))
                                    )
                                    else
                                        {6726}let pkCli_6136: bitstring = fail-any in
                                        {6727}let v_6137: bool = (Disco_5314 = A) in
                                        (
                                            {6728}if v_6137 then
                                            (
                                                {6729}let pkDisco_6138: bitstring = pub(skA) in
                                                {6730}in(c, (=pkCli_6136,em1_6139: bitstring));
                                                {6731}let m1_6140: bitstring = em1_6139 in
                                                {6732}let (=OpenSecureChannelRequest,=pkCli_6136,PartC_6141: bitstring) = m1_6140 in
                                                {6733}new Ns_6142: bitstring;
                                                {6734}new ST_6143: bitstring;
                                                {6735}new TTL_6144: bitstring;
                                                {6736}let gNs_6145: bitstring = exp(g,Ns_6142) in
                                                {6737}let m2_6146: bitstring = (OpenSecureChannelResponse,gNs_6145,ST_6143,TTL_6144) in
                                                {6738}out(c, m2_6146);
                                                {6739}let Ksrv_6147: bitstring = exp(PartC_6141,Ns_6142) in
                                                {6740}out(c, senc(mSrv(pkCli_6136,pkSess_5836),Ksrv_6147))
                                            )
                                            else
                                                {6741}let v_6148: bool = (Disco_5314 = B) in
                                                (
                                                    {6742}if v_6148 then
                                                    (
                                                        {6743}let pkDisco_6149: bitstring = pub(skB) in
                                                        {6744}in(c, (=pkCli_6136,em1_6150: bitstring));
                                                        {6745}let m1_6151: bitstring = em1_6150 in
                                                        {6746}let (=OpenSecureChannelRequest,=pkCli_6136,PartC_6152: bitstring) = m1_6151 in
                                                        {6747}new Ns_6153: bitstring;
                                                        {6748}new ST_6154: bitstring;
                                                        {6749}new TTL_6155: bitstring;
                                                        {6750}let gNs_6156: bitstring = exp(g,Ns_6153) in
                                                        {6751}let m2_6157: bitstring = (OpenSecureChannelResponse,gNs_6156,ST_6154,TTL_6155) in
                                                        {6752}out(c, m2_6157);
                                                        {6753}let Ksrv_6158: bitstring = exp(PartC_6152,Ns_6153) in
                                                        {6754}out(c, senc(mSrv(pkCli_6136,pkSess_5836),Ksrv_6158))
                                                    )
                                                    else
                                                        {6755}let v_6159: bool = (Disco_5314 = C) in
                                                        (
                                                            {6756}if v_6159 then
                                                            (
                                                                {6757}let pkDisco_6160: bitstring = pub(skC) in
                                                                {6758}in(c, (=pkCli_6136,em1_6161: bitstring));
                                                                {6759}let m1_6162: bitstring = em1_6161 in
                                                                {6760}let (=OpenSecureChannelRequest,=pkCli_6136,PartC_6163: bitstring) = m1_6162 in
                                                                {6761}new Ns_6164: bitstring;
                                                                {6762}new ST_6165: bitstring;
                                                                {6763}new TTL_6166: bitstring;
                                                                {6764}let gNs_6167: bitstring = exp(g,Ns_6164) in
                                                                {6765}let m2_6168: bitstring = (OpenSecureChannelResponse,gNs_6167,ST_6165,TTL_6166) in
                                                                {6766}out(c, m2_6168);
                                                                {6767}let Ksrv_6169: bitstring = exp(PartC_6163,Ns_6164) in
                                                                {6768}out(c, senc(mSrv(pkCli_6136,pkSess_5836),Ksrv_6169))
                                                            )
                                                            else
                                                                {6769}let pkDisco_6170: bitstring = pub(sk(Disco_5314)) in
                                                                {6770}in(c, (=pkCli_6136,em1_6171: bitstring));
                                                                {6771}let m1_6172: bitstring = em1_6171 in
                                                                {6772}let (=OpenSecureChannelRequest,=pkCli_6136,PartC_6173: bitstring) = m1_6172 in
                                                                {6773}new Ns_6174: bitstring;
                                                                {6774}new ST_6175: bitstring;
                                                                {6775}new TTL_6176: bitstring;
                                                                {6776}let gNs_6177: bitstring = exp(g,Ns_6174) in
                                                                {6777}let m2_6178: bitstring = (OpenSecureChannelResponse,gNs_6177,ST_6175,TTL_6176) in
                                                                {6778}out(c, m2_6178);
                                                                {6779}let Ksrv_6179: bitstring = exp(PartC_6173,Ns_6174) in
                                                                {6780}out(c, senc(mSrv(pkCli_6136,pkSess_5836),Ksrv_6179))
                                                        )
                                                        else
                                                            {6781}let pkDisco_6180: bitstring = fail-any in
                                                            {6782}in(c, (=pkCli_6136,em1_6181: bitstring));
                                                            {6783}let m1_6182: bitstring = em1_6181 in
                                                            {6784}let (=OpenSecureChannelRequest,=pkCli_6136,PartC_6183: bitstring) = m1_6182 in
                                                            {6785}new Ns_6184: bitstring;
                                                            {6786}new ST_6185: bitstring;
                                                            {6787}new TTL_6186: bitstring;
                                                            {6788}let gNs_6187: bitstring = exp(g,Ns_6184) in
                                                            {6789}let m2_6188: bitstring = (OpenSecureChannelResponse,gNs_6187,ST_6185,TTL_6186) in
                                                            {6790}out(c, m2_6188);
                                                            {6791}let Ksrv_6189: bitstring = exp(PartC_6183,Ns_6184) in
                                                            {6792}out(c, senc(mSrv(pkCli_6136,pkSess_5836),Ksrv_6189))
                                                )
                                                else
                                                    {6793}let pkDisco_6190: bitstring = fail-any in
                                                    {6794}in(c, (=pkCli_6136,em1_6191: bitstring));
                                                    {6795}let m1_6192: bitstring = em1_6191 in
                                                    {6796}let (=OpenSecureChannelRequest,=pkCli_6136,PartC_6193: bitstring) = m1_6192 in
                                                    {6797}new Ns_6194: bitstring;
                                                    {6798}new ST_6195: bitstring;
                                                    {6799}new TTL_6196: bitstring;
                                                    {6800}let gNs_6197: bitstring = exp(g,Ns_6194) in
                                                    {6801}let m2_6198: bitstring = (OpenSecureChannelResponse,gNs_6197,ST_6195,TTL_6196) in
                                                    {6802}out(c, m2_6198);
                                                    {6803}let Ksrv_6199: bitstring = exp(PartC_6193,Ns_6194) in
                                                    {6804}out(c, senc(mSrv(pkCli_6136,pkSess_5836),Ksrv_6199))
                                        )
                                        else
                                            {6805}let pkDisco_6200: bitstring = fail-any in
                                            {6806}in(c, (=pkCli_6136,em1_6201: bitstring));
                                            {6807}let m1_6202: bitstring = em1_6201 in
                                            {6808}let (=OpenSecureChannelRequest,=pkCli_6136,PartC_6203: bitstring) = m1_6202 in
                                            {6809}new Ns_6204: bitstring;
                                            {6810}new ST_6205: bitstring;
                                            {6811}new TTL_6206: bitstring;
                                            {6812}let gNs_6207: bitstring = exp(g,Ns_6204) in
                                            {6813}let m2_6208: bitstring = (OpenSecureChannelResponse,gNs_6207,ST_6205,TTL_6206) in
                                            {6814}out(c, m2_6208);
                                            {6815}let Ksrv_6209: bitstring = exp(PartC_6203,Ns_6204) in
                                            {6816}out(c, senc(mSrv(pkCli_6136,pkSess_5836),Ksrv_6209))
                            )
                            else
                                {6817}let pkCli_6210: bitstring = fail-any in
                                {6818}let v_6211: bool = (Disco_5314 = A) in
                                (
                                    {6819}if v_6211 then
                                    (
                                        {6820}let pkDisco_6212: bitstring = pub(skA) in
                                        {6821}in(c, (=pkCli_6210,em1_6213: bitstring));
                                        {6822}let m1_6214: bitstring = em1_6213 in
                                        {6823}let (=OpenSecureChannelRequest,=pkCli_6210,PartC_6215: bitstring) = m1_6214 in
                                        {6824}new Ns_6216: bitstring;
                                        {6825}new ST_6217: bitstring;
                                        {6826}new TTL_6218: bitstring;
                                        {6827}let gNs_6219: bitstring = exp(g,Ns_6216) in
                                        {6828}let m2_6220: bitstring = (OpenSecureChannelResponse,gNs_6219,ST_6217,TTL_6218) in
                                        {6829}out(c, m2_6220);
                                        {6830}let Ksrv_6221: bitstring = exp(PartC_6215,Ns_6216) in
                                        {6831}out(c, senc(mSrv(pkCli_6210,pkSess_5836),Ksrv_6221))
                                    )
                                    else
                                        {6832}let v_6222: bool = (Disco_5314 = B) in
                                        (
                                            {6833}if v_6222 then
                                            (
                                                {6834}let pkDisco_6223: bitstring = pub(skB) in
                                                {6835}in(c, (=pkCli_6210,em1_6224: bitstring));
                                                {6836}let m1_6225: bitstring = em1_6224 in
                                                {6837}let (=OpenSecureChannelRequest,=pkCli_6210,PartC_6226: bitstring) = m1_6225 in
                                                {6838}new Ns_6227: bitstring;
                                                {6839}new ST_6228: bitstring;
                                                {6840}new TTL_6229: bitstring;
                                                {6841}let gNs_6230: bitstring = exp(g,Ns_6227) in
                                                {6842}let m2_6231: bitstring = (OpenSecureChannelResponse,gNs_6230,ST_6228,TTL_6229) in
                                                {6843}out(c, m2_6231);
                                                {6844}let Ksrv_6232: bitstring = exp(PartC_6226,Ns_6227) in
                                                {6845}out(c, senc(mSrv(pkCli_6210,pkSess_5836),Ksrv_6232))
                                            )
                                            else
                                                {6846}let v_6233: bool = (Disco_5314 = C) in
                                                (
                                                    {6847}if v_6233 then
                                                    (
                                                        {6848}let pkDisco_6234: bitstring = pub(skC) in
                                                        {6849}in(c, (=pkCli_6210,em1_6235: bitstring));
                                                        {6850}let m1_6236: bitstring = em1_6235 in
                                                        {6851}let (=OpenSecureChannelRequest,=pkCli_6210,PartC_6237: bitstring) = m1_6236 in
                                                        {6852}new Ns_6238: bitstring;
                                                        {6853}new ST_6239: bitstring;
                                                        {6854}new TTL_6240: bitstring;
                                                        {6855}let gNs_6241: bitstring = exp(g,Ns_6238) in
                                                        {6856}let m2_6242: bitstring = (OpenSecureChannelResponse,gNs_6241,ST_6239,TTL_6240) in
                                                        {6857}out(c, m2_6242);
                                                        {6858}let Ksrv_6243: bitstring = exp(PartC_6237,Ns_6238) in
                                                        {6859}out(c, senc(mSrv(pkCli_6210,pkSess_5836),Ksrv_6243))
                                                    )
                                                    else
                                                        {6860}let pkDisco_6244: bitstring = pub(sk(Disco_5314)) in
                                                        {6861}in(c, (=pkCli_6210,em1_6245: bitstring));
                                                        {6862}let m1_6246: bitstring = em1_6245 in
                                                        {6863}let (=OpenSecureChannelRequest,=pkCli_6210,PartC_6247: bitstring) = m1_6246 in
                                                        {6864}new Ns_6248: bitstring;
                                                        {6865}new ST_6249: bitstring;
                                                        {6866}new TTL_6250: bitstring;
                                                        {6867}let gNs_6251: bitstring = exp(g,Ns_6248) in
                                                        {6868}let m2_6252: bitstring = (OpenSecureChannelResponse,gNs_6251,ST_6249,TTL_6250) in
                                                        {6869}out(c, m2_6252);
                                                        {6870}let Ksrv_6253: bitstring = exp(PartC_6247,Ns_6248) in
                                                        {6871}out(c, senc(mSrv(pkCli_6210,pkSess_5836),Ksrv_6253))
                                                )
                                                else
                                                    {6872}let pkDisco_6254: bitstring = fail-any in
                                                    {6873}in(c, (=pkCli_6210,em1_6255: bitstring));
                                                    {6874}let m1_6256: bitstring = em1_6255 in
                                                    {6875}let (=OpenSecureChannelRequest,=pkCli_6210,PartC_6257: bitstring) = m1_6256 in
                                                    {6876}new Ns_6258: bitstring;
                                                    {6877}new ST_6259: bitstring;
                                                    {6878}new TTL_6260: bitstring;
                                                    {6879}let gNs_6261: bitstring = exp(g,Ns_6258) in
                                                    {6880}let m2_6262: bitstring = (OpenSecureChannelResponse,gNs_6261,ST_6259,TTL_6260) in
                                                    {6881}out(c, m2_6262);
                                                    {6882}let Ksrv_6263: bitstring = exp(PartC_6257,Ns_6258) in
                                                    {6883}out(c, senc(mSrv(pkCli_6210,pkSess_5836),Ksrv_6263))
                                        )
                                        else
                                            {6884}let pkDisco_6264: bitstring = fail-any in
                                            {6885}in(c, (=pkCli_6210,em1_6265: bitstring));
                                            {6886}let m1_6266: bitstring = em1_6265 in
                                            {6887}let (=OpenSecureChannelRequest,=pkCli_6210,PartC_6267: bitstring) = m1_6266 in
                                            {6888}new Ns_6268: bitstring;
                                            {6889}new ST_6269: bitstring;
                                            {6890}new TTL_6270: bitstring;
                                            {6891}let gNs_6271: bitstring = exp(g,Ns_6268) in
                                            {6892}let m2_6272: bitstring = (OpenSecureChannelResponse,gNs_6271,ST_6269,TTL_6270) in
                                            {6893}out(c, m2_6272);
                                            {6894}let Ksrv_6273: bitstring = exp(PartC_6267,Ns_6268) in
                                            {6895}out(c, senc(mSrv(pkCli_6210,pkSess_5836),Ksrv_6273))
                                )
                                else
                                    {6896}let pkDisco_6274: bitstring = fail-any in
                                    {6897}in(c, (=pkCli_6210,em1_6275: bitstring));
                                    {6898}let m1_6276: bitstring = em1_6275 in
                                    {6899}let (=OpenSecureChannelRequest,=pkCli_6210,PartC_6277: bitstring) = m1_6276 in
                                    {6900}new Ns_6278: bitstring;
                                    {6901}new ST_6279: bitstring;
                                    {6902}new TTL_6280: bitstring;
                                    {6903}let gNs_6281: bitstring = exp(g,Ns_6278) in
                                    {6904}let m2_6282: bitstring = (OpenSecureChannelResponse,gNs_6281,ST_6279,TTL_6280) in
                                    {6905}out(c, m2_6282);
                                    {6906}let Ksrv_6283: bitstring = exp(PartC_6277,Ns_6278) in
                                    {6907}out(c, senc(mSrv(pkCli_6210,pkSess_5836),Ksrv_6283))
                    )
                    else
                        {6908}let pkCli_6284: bitstring = fail-any in
                        {6909}let v_6285: bool = (Disco_5314 = A) in
                        (
                            {6910}if v_6285 then
                            (
                                {6911}let pkDisco_6286: bitstring = pub(skA) in
                                {6912}in(c, (=pkCli_6284,em1_6287: bitstring));
                                {6913}let m1_6288: bitstring = em1_6287 in
                                {6914}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6289: bitstring) = m1_6288 in
                                {6915}new Ns_6290: bitstring;
                                {6916}new ST_6291: bitstring;
                                {6917}new TTL_6292: bitstring;
                                {6918}let gNs_6293: bitstring = exp(g,Ns_6290) in
                                {6919}let m2_6294: bitstring = (OpenSecureChannelResponse,gNs_6293,ST_6291,TTL_6292) in
                                {6920}out(c, m2_6294);
                                {6921}let Ksrv_6295: bitstring = exp(PartC_6289,Ns_6290) in
                                {6922}out(c, senc(mSrv(pkCli_6284,pkSess_5836),Ksrv_6295))
                            )
                            else
                                {6923}let v_6296: bool = (Disco_5314 = B) in
                                (
                                    {6924}if v_6296 then
                                    (
                                        {6925}let pkDisco_6297: bitstring = pub(skB) in
                                        {6926}in(c, (=pkCli_6284,em1_6298: bitstring));
                                        {6927}let m1_6299: bitstring = em1_6298 in
                                        {6928}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6300: bitstring) = m1_6299 in
                                        {6929}new Ns_6301: bitstring;
                                        {6930}new ST_6302: bitstring;
                                        {6931}new TTL_6303: bitstring;
                                        {6932}let gNs_6304: bitstring = exp(g,Ns_6301) in
                                        {6933}let m2_6305: bitstring = (OpenSecureChannelResponse,gNs_6304,ST_6302,TTL_6303) in
                                        {6934}out(c, m2_6305);
                                        {6935}let Ksrv_6306: bitstring = exp(PartC_6300,Ns_6301) in
                                        {6936}out(c, senc(mSrv(pkCli_6284,pkSess_5836),Ksrv_6306))
                                    )
                                    else
                                        {6937}let v_6307: bool = (Disco_5314 = C) in
                                        (
                                            {6938}if v_6307 then
                                            (
                                                {6939}let pkDisco_6308: bitstring = pub(skC) in
                                                {6940}in(c, (=pkCli_6284,em1_6309: bitstring));
                                                {6941}let m1_6310: bitstring = em1_6309 in
                                                {6942}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6311: bitstring) = m1_6310 in
                                                {6943}new Ns_6312: bitstring;
                                                {6944}new ST_6313: bitstring;
                                                {6945}new TTL_6314: bitstring;
                                                {6946}let gNs_6315: bitstring = exp(g,Ns_6312) in
                                                {6947}let m2_6316: bitstring = (OpenSecureChannelResponse,gNs_6315,ST_6313,TTL_6314) in
                                                {6948}out(c, m2_6316);
                                                {6949}let Ksrv_6317: bitstring = exp(PartC_6311,Ns_6312) in
                                                {6950}out(c, senc(mSrv(pkCli_6284,pkSess_5836),Ksrv_6317))
                                            )
                                            else
                                                {6951}let pkDisco_6318: bitstring = pub(sk(Disco_5314)) in
                                                {6952}in(c, (=pkCli_6284,em1_6319: bitstring));
                                                {6953}let m1_6320: bitstring = em1_6319 in
                                                {6954}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6321: bitstring) = m1_6320 in
                                                {6955}new Ns_6322: bitstring;
                                                {6956}new ST_6323: bitstring;
                                                {6957}new TTL_6324: bitstring;
                                                {6958}let gNs_6325: bitstring = exp(g,Ns_6322) in
                                                {6959}let m2_6326: bitstring = (OpenSecureChannelResponse,gNs_6325,ST_6323,TTL_6324) in
                                                {6960}out(c, m2_6326);
                                                {6961}let Ksrv_6327: bitstring = exp(PartC_6321,Ns_6322) in
                                                {6962}out(c, senc(mSrv(pkCli_6284,pkSess_5836),Ksrv_6327))
                                        )
                                        else
                                            {6963}let pkDisco_6328: bitstring = fail-any in
                                            {6964}in(c, (=pkCli_6284,em1_6329: bitstring));
                                            {6965}let m1_6330: bitstring = em1_6329 in
                                            {6966}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6331: bitstring) = m1_6330 in
                                            {6967}new Ns_6332: bitstring;
                                            {6968}new ST_6333: bitstring;
                                            {6969}new TTL_6334: bitstring;
                                            {6970}let gNs_6335: bitstring = exp(g,Ns_6332) in
                                            {6971}let m2_6336: bitstring = (OpenSecureChannelResponse,gNs_6335,ST_6333,TTL_6334) in
                                            {6972}out(c, m2_6336);
                                            {6973}let Ksrv_6337: bitstring = exp(PartC_6331,Ns_6332) in
                                            {6974}out(c, senc(mSrv(pkCli_6284,pkSess_5836),Ksrv_6337))
                                )
                                else
                                    {6975}let pkDisco_6338: bitstring = fail-any in
                                    {6976}in(c, (=pkCli_6284,em1_6339: bitstring));
                                    {6977}let m1_6340: bitstring = em1_6339 in
                                    {6978}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6341: bitstring) = m1_6340 in
                                    {6979}new Ns_6342: bitstring;
                                    {6980}new ST_6343: bitstring;
                                    {6981}new TTL_6344: bitstring;
                                    {6982}let gNs_6345: bitstring = exp(g,Ns_6342) in
                                    {6983}let m2_6346: bitstring = (OpenSecureChannelResponse,gNs_6345,ST_6343,TTL_6344) in
                                    {6984}out(c, m2_6346);
                                    {6985}let Ksrv_6347: bitstring = exp(PartC_6341,Ns_6342) in
                                    {6986}out(c, senc(mSrv(pkCli_6284,pkSess_5836),Ksrv_6347))
                        )
                        else
                            {6987}let pkDisco_6348: bitstring = fail-any in
                            {6988}in(c, (=pkCli_6284,em1_6349: bitstring));
                            {6989}let m1_6350: bitstring = em1_6349 in
                            {6990}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6351: bitstring) = m1_6350 in
                            {6991}new Ns_6352: bitstring;
                            {6992}new ST_6353: bitstring;
                            {6993}new TTL_6354: bitstring;
                            {6994}let gNs_6355: bitstring = exp(g,Ns_6352) in
                            {6995}let m2_6356: bitstring = (OpenSecureChannelResponse,gNs_6355,ST_6353,TTL_6354) in
                            {6996}out(c, m2_6356);
                            {6997}let Ksrv_6357: bitstring = exp(PartC_6351,Ns_6352) in
                            {6998}out(c, senc(mSrv(pkCli_6284,pkSess_5836),Ksrv_6357))
                )
                else
                    {6999}let =true = (Sess_5315 = C) in
                    (
                        {7000}let skSess_6358: bitstring = skC in
                        {7001}let pkSess_6359: bitstring = pub(skSess_6358) in
                        {7002}let v_6360: bool = (Cli_5313 = A) in
                        (
                            {7003}if v_6360 then
                            (
                                {7004}let pkCli_6361: bitstring = pub(skA) in
                                {7005}let v_6362: bool = (Disco_5314 = A) in
                                (
                                    {7006}if v_6362 then
                                    (
                                        {7007}let pkDisco_6363: bitstring = pub(skA) in
                                        {7008}in(c, (=pkCli_6361,em1_6364: bitstring));
                                        {7009}let m1_6365: bitstring = em1_6364 in
                                        {7010}let (=OpenSecureChannelRequest,=pkCli_6361,PartC_6366: bitstring) = m1_6365 in
                                        {7011}new Ns_6367: bitstring;
                                        {7012}new ST_6368: bitstring;
                                        {7013}new TTL_6369: bitstring;
                                        {7014}let gNs_6370: bitstring = exp(g,Ns_6367) in
                                        {7015}let m2_6371: bitstring = (OpenSecureChannelResponse,gNs_6370,ST_6368,TTL_6369) in
                                        {7016}out(c, m2_6371);
                                        {7017}let Ksrv_6372: bitstring = exp(PartC_6366,Ns_6367) in
                                        {7018}out(c, senc(mSrv(pkCli_6361,pkSess_6359),Ksrv_6372))
                                    )
                                    else
                                        {7019}let v_6373: bool = (Disco_5314 = B) in
                                        (
                                            {7020}if v_6373 then
                                            (
                                                {7021}let pkDisco_6374: bitstring = pub(skB) in
                                                {7022}in(c, (=pkCli_6361,em1_6375: bitstring));
                                                {7023}let m1_6376: bitstring = em1_6375 in
                                                {7024}let (=OpenSecureChannelRequest,=pkCli_6361,PartC_6377: bitstring) = m1_6376 in
                                                {7025}new Ns_6378: bitstring;
                                                {7026}new ST_6379: bitstring;
                                                {7027}new TTL_6380: bitstring;
                                                {7028}let gNs_6381: bitstring = exp(g,Ns_6378) in
                                                {7029}let m2_6382: bitstring = (OpenSecureChannelResponse,gNs_6381,ST_6379,TTL_6380) in
                                                {7030}out(c, m2_6382);
                                                {7031}let Ksrv_6383: bitstring = exp(PartC_6377,Ns_6378) in
                                                {7032}out(c, senc(mSrv(pkCli_6361,pkSess_6359),Ksrv_6383))
                                            )
                                            else
                                                {7033}let v_6384: bool = (Disco_5314 = C) in
                                                (
                                                    {7034}if v_6384 then
                                                    (
                                                        {7035}let pkDisco_6385: bitstring = pub(skC) in
                                                        {7036}in(c, (=pkCli_6361,em1_6386: bitstring));
                                                        {7037}let m1_6387: bitstring = em1_6386 in
                                                        {7038}let (=OpenSecureChannelRequest,=pkCli_6361,PartC_6388: bitstring) = m1_6387 in
                                                        {7039}new Ns_6389: bitstring;
                                                        {7040}new ST_6390: bitstring;
                                                        {7041}new TTL_6391: bitstring;
                                                        {7042}let gNs_6392: bitstring = exp(g,Ns_6389) in
                                                        {7043}let m2_6393: bitstring = (OpenSecureChannelResponse,gNs_6392,ST_6390,TTL_6391) in
                                                        {7044}out(c, m2_6393);
                                                        {7045}let Ksrv_6394: bitstring = exp(PartC_6388,Ns_6389) in
                                                        {7046}out(c, senc(mSrv(pkCli_6361,pkSess_6359),Ksrv_6394))
                                                    )
                                                    else
                                                        {7047}let pkDisco_6395: bitstring = pub(sk(Disco_5314)) in
                                                        {7048}in(c, (=pkCli_6361,em1_6396: bitstring));
                                                        {7049}let m1_6397: bitstring = em1_6396 in
                                                        {7050}let (=OpenSecureChannelRequest,=pkCli_6361,PartC_6398: bitstring) = m1_6397 in
                                                        {7051}new Ns_6399: bitstring;
                                                        {7052}new ST_6400: bitstring;
                                                        {7053}new TTL_6401: bitstring;
                                                        {7054}let gNs_6402: bitstring = exp(g,Ns_6399) in
                                                        {7055}let m2_6403: bitstring = (OpenSecureChannelResponse,gNs_6402,ST_6400,TTL_6401) in
                                                        {7056}out(c, m2_6403);
                                                        {7057}let Ksrv_6404: bitstring = exp(PartC_6398,Ns_6399) in
                                                        {7058}out(c, senc(mSrv(pkCli_6361,pkSess_6359),Ksrv_6404))
                                                )
                                                else
                                                    {7059}let pkDisco_6405: bitstring = fail-any in
                                                    {7060}in(c, (=pkCli_6361,em1_6406: bitstring));
                                                    {7061}let m1_6407: bitstring = em1_6406 in
                                                    {7062}let (=OpenSecureChannelRequest,=pkCli_6361,PartC_6408: bitstring) = m1_6407 in
                                                    {7063}new Ns_6409: bitstring;
                                                    {7064}new ST_6410: bitstring;
                                                    {7065}new TTL_6411: bitstring;
                                                    {7066}let gNs_6412: bitstring = exp(g,Ns_6409) in
                                                    {7067}let m2_6413: bitstring = (OpenSecureChannelResponse,gNs_6412,ST_6410,TTL_6411) in
                                                    {7068}out(c, m2_6413);
                                                    {7069}let Ksrv_6414: bitstring = exp(PartC_6408,Ns_6409) in
                                                    {7070}out(c, senc(mSrv(pkCli_6361,pkSess_6359),Ksrv_6414))
                                        )
                                        else
                                            {7071}let pkDisco_6415: bitstring = fail-any in
                                            {7072}in(c, (=pkCli_6361,em1_6416: bitstring));
                                            {7073}let m1_6417: bitstring = em1_6416 in
                                            {7074}let (=OpenSecureChannelRequest,=pkCli_6361,PartC_6418: bitstring) = m1_6417 in
                                            {7075}new Ns_6419: bitstring;
                                            {7076}new ST_6420: bitstring;
                                            {7077}new TTL_6421: bitstring;
                                            {7078}let gNs_6422: bitstring = exp(g,Ns_6419) in
                                            {7079}let m2_6423: bitstring = (OpenSecureChannelResponse,gNs_6422,ST_6420,TTL_6421) in
                                            {7080}out(c, m2_6423);
                                            {7081}let Ksrv_6424: bitstring = exp(PartC_6418,Ns_6419) in
                                            {7082}out(c, senc(mSrv(pkCli_6361,pkSess_6359),Ksrv_6424))
                                )
                                else
                                    {7083}let pkDisco_6425: bitstring = fail-any in
                                    {7084}in(c, (=pkCli_6361,em1_6426: bitstring));
                                    {7085}let m1_6427: bitstring = em1_6426 in
                                    {7086}let (=OpenSecureChannelRequest,=pkCli_6361,PartC_6428: bitstring) = m1_6427 in
                                    {7087}new Ns_6429: bitstring;
                                    {7088}new ST_6430: bitstring;
                                    {7089}new TTL_6431: bitstring;
                                    {7090}let gNs_6432: bitstring = exp(g,Ns_6429) in
                                    {7091}let m2_6433: bitstring = (OpenSecureChannelResponse,gNs_6432,ST_6430,TTL_6431) in
                                    {7092}out(c, m2_6433);
                                    {7093}let Ksrv_6434: bitstring = exp(PartC_6428,Ns_6429) in
                                    {7094}out(c, senc(mSrv(pkCli_6361,pkSess_6359),Ksrv_6434))
                            )
                            else
                                {7095}let v_6435: bool = (Cli_5313 = B) in
                                (
                                    {7096}if v_6435 then
                                    (
                                        {7097}let pkCli_6436: bitstring = pub(skB) in
                                        {7098}let v_6437: bool = (Disco_5314 = A) in
                                        (
                                            {7099}if v_6437 then
                                            (
                                                {7100}let pkDisco_6438: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_6436,em1_6439: bitstring));
                                                {7102}let m1_6440: bitstring = em1_6439 in
                                                {7103}let (=OpenSecureChannelRequest,=pkCli_6436,PartC_6441: bitstring) = m1_6440 in
                                                {7104}new Ns_6442: bitstring;
                                                {7105}new ST_6443: bitstring;
                                                {7106}new TTL_6444: bitstring;
                                                {7107}let gNs_6445: bitstring = exp(g,Ns_6442) in
                                                {7108}let m2_6446: bitstring = (OpenSecureChannelResponse,gNs_6445,ST_6443,TTL_6444) in
                                                {7109}out(c, m2_6446);
                                                {7110}let Ksrv_6447: bitstring = exp(PartC_6441,Ns_6442) in
                                                {7111}out(c, senc(mSrv(pkCli_6436,pkSess_6359),Ksrv_6447))
                                            )
                                            else
                                                {7112}let v_6448: bool = (Disco_5314 = B) in
                                                (
                                                    {7113}if v_6448 then
                                                    (
                                                        {7114}let pkDisco_6449: bitstring = pub(skB) in
                                                        {7115}in(c, (=pkCli_6436,em1_6450: bitstring));
                                                        {7116}let m1_6451: bitstring = em1_6450 in
                                                        {7117}let (=OpenSecureChannelRequest,=pkCli_6436,PartC_6452: bitstring) = m1_6451 in
                                                        {7118}new Ns_6453: bitstring;
                                                        {7119}new ST_6454: bitstring;
                                                        {7120}new TTL_6455: bitstring;
                                                        {7121}let gNs_6456: bitstring = exp(g,Ns_6453) in
                                                        {7122}let m2_6457: bitstring = (OpenSecureChannelResponse,gNs_6456,ST_6454,TTL_6455) in
                                                        {7123}out(c, m2_6457);
                                                        {7124}let Ksrv_6458: bitstring = exp(PartC_6452,Ns_6453) in
                                                        {7125}out(c, senc(mSrv(pkCli_6436,pkSess_6359),Ksrv_6458))
                                                    )
                                                    else
                                                        {7126}let v_6459: bool = (Disco_5314 = C) in
                                                        (
                                                            {7127}if v_6459 then
                                                            (
                                                                {7128}let pkDisco_6460: bitstring = pub(skC) in
                                                                {7129}in(c, (=pkCli_6436,em1_6461: bitstring));
                                                                {7130}let m1_6462: bitstring = em1_6461 in
                                                                {7131}let (=OpenSecureChannelRequest,=pkCli_6436,PartC_6463: bitstring) = m1_6462 in
                                                                {7132}new Ns_6464: bitstring;
                                                                {7133}new ST_6465: bitstring;
                                                                {7134}new TTL_6466: bitstring;
                                                                {7135}let gNs_6467: bitstring = exp(g,Ns_6464) in
                                                                {7136}let m2_6468: bitstring = (OpenSecureChannelResponse,gNs_6467,ST_6465,TTL_6466) in
                                                                {7137}out(c, m2_6468);
                                                                {7138}let Ksrv_6469: bitstring = exp(PartC_6463,Ns_6464) in
                                                                {7139}out(c, senc(mSrv(pkCli_6436,pkSess_6359),Ksrv_6469))
                                                            )
                                                            else
                                                                {7140}let pkDisco_6470: bitstring = pub(sk(Disco_5314)) in
                                                                {7141}in(c, (=pkCli_6436,em1_6471: bitstring));
                                                                {7142}let m1_6472: bitstring = em1_6471 in
                                                                {7143}let (=OpenSecureChannelRequest,=pkCli_6436,PartC_6473: bitstring) = m1_6472 in
                                                                {7144}new Ns_6474: bitstring;
                                                                {7145}new ST_6475: bitstring;
                                                                {7146}new TTL_6476: bitstring;
                                                                {7147}let gNs_6477: bitstring = exp(g,Ns_6474) in
                                                                {7148}let m2_6478: bitstring = (OpenSecureChannelResponse,gNs_6477,ST_6475,TTL_6476) in
                                                                {7149}out(c, m2_6478);
                                                                {7150}let Ksrv_6479: bitstring = exp(PartC_6473,Ns_6474) in
                                                                {7151}out(c, senc(mSrv(pkCli_6436,pkSess_6359),Ksrv_6479))
                                                        )
                                                        else
                                                            {7152}let pkDisco_6480: bitstring = fail-any in
                                                            {7153}in(c, (=pkCli_6436,em1_6481: bitstring));
                                                            {7154}let m1_6482: bitstring = em1_6481 in
                                                            {7155}let (=OpenSecureChannelRequest,=pkCli_6436,PartC_6483: bitstring) = m1_6482 in
                                                            {7156}new Ns_6484: bitstring;
                                                            {7157}new ST_6485: bitstring;
                                                            {7158}new TTL_6486: bitstring;
                                                            {7159}let gNs_6487: bitstring = exp(g,Ns_6484) in
                                                            {7160}let m2_6488: bitstring = (OpenSecureChannelResponse,gNs_6487,ST_6485,TTL_6486) in
                                                            {7161}out(c, m2_6488);
                                                            {7162}let Ksrv_6489: bitstring = exp(PartC_6483,Ns_6484) in
                                                            {7163}out(c, senc(mSrv(pkCli_6436,pkSess_6359),Ksrv_6489))
                                                )
                                                else
                                                    {7164}let pkDisco_6490: bitstring = fail-any in
                                                    {7165}in(c, (=pkCli_6436,em1_6491: bitstring));
                                                    {7166}let m1_6492: bitstring = em1_6491 in
                                                    {7167}let (=OpenSecureChannelRequest,=pkCli_6436,PartC_6493: bitstring) = m1_6492 in
                                                    {7168}new Ns_6494: bitstring;
                                                    {7169}new ST_6495: bitstring;
                                                    {7170}new TTL_6496: bitstring;
                                                    {7171}let gNs_6497: bitstring = exp(g,Ns_6494) in
                                                    {7172}let m2_6498: bitstring = (OpenSecureChannelResponse,gNs_6497,ST_6495,TTL_6496) in
                                                    {7173}out(c, m2_6498);
                                                    {7174}let Ksrv_6499: bitstring = exp(PartC_6493,Ns_6494) in
                                                    {7175}out(c, senc(mSrv(pkCli_6436,pkSess_6359),Ksrv_6499))
                                        )
                                        else
                                            {7176}let pkDisco_6500: bitstring = fail-any in
                                            {7177}in(c, (=pkCli_6436,em1_6501: bitstring));
                                            {7178}let m1_6502: bitstring = em1_6501 in
                                            {7179}let (=OpenSecureChannelRequest,=pkCli_6436,PartC_6503: bitstring) = m1_6502 in
                                            {7180}new Ns_6504: bitstring;
                                            {7181}new ST_6505: bitstring;
                                            {7182}new TTL_6506: bitstring;
                                            {7183}let gNs_6507: bitstring = exp(g,Ns_6504) in
                                            {7184}let m2_6508: bitstring = (OpenSecureChannelResponse,gNs_6507,ST_6505,TTL_6506) in
                                            {7185}out(c, m2_6508);
                                            {7186}let Ksrv_6509: bitstring = exp(PartC_6503,Ns_6504) in
                                            {7187}out(c, senc(mSrv(pkCli_6436,pkSess_6359),Ksrv_6509))
                                    )
                                    else
                                        {7188}let v_6510: bool = (Cli_5313 = C) in
                                        (
                                            {7189}if v_6510 then
                                            (
                                                {7190}let pkCli_6511: bitstring = pub(skC) in
                                                {7191}let v_6512: bool = (Disco_5314 = A) in
                                                (
                                                    {7192}if v_6512 then
                                                    (
                                                        {7193}let pkDisco_6513: bitstring = pub(skA) in
                                                        {7194}in(c, (=pkCli_6511,em1_6514: bitstring));
                                                        {7195}let m1_6515: bitstring = em1_6514 in
                                                        {7196}let (=OpenSecureChannelRequest,=pkCli_6511,PartC_6516: bitstring) = m1_6515 in
                                                        {7197}new Ns_6517: bitstring;
                                                        {7198}new ST_6518: bitstring;
                                                        {7199}new TTL_6519: bitstring;
                                                        {7200}let gNs_6520: bitstring = exp(g,Ns_6517) in
                                                        {7201}let m2_6521: bitstring = (OpenSecureChannelResponse,gNs_6520,ST_6518,TTL_6519) in
                                                        {7202}out(c, m2_6521);
                                                        {7203}let Ksrv_6522: bitstring = exp(PartC_6516,Ns_6517) in
                                                        {7204}out(c, senc(mSrv(pkCli_6511,pkSess_6359),Ksrv_6522))
                                                    )
                                                    else
                                                        {7205}let v_6523: bool = (Disco_5314 = B) in
                                                        (
                                                            {7206}if v_6523 then
                                                            (
                                                                {7207}let pkDisco_6524: bitstring = pub(skB) in
                                                                {7208}in(c, (=pkCli_6511,em1_6525: bitstring));
                                                                {7209}let m1_6526: bitstring = em1_6525 in
                                                                {7210}let (=OpenSecureChannelRequest,=pkCli_6511,PartC_6527: bitstring) = m1_6526 in
                                                                {7211}new Ns_6528: bitstring;
                                                                {7212}new ST_6529: bitstring;
                                                                {7213}new TTL_6530: bitstring;
                                                                {7214}let gNs_6531: bitstring = exp(g,Ns_6528) in
                                                                {7215}let m2_6532: bitstring = (OpenSecureChannelResponse,gNs_6531,ST_6529,TTL_6530) in
                                                                {7216}out(c, m2_6532);
                                                                {7217}let Ksrv_6533: bitstring = exp(PartC_6527,Ns_6528) in
                                                                {7218}out(c, senc(mSrv(pkCli_6511,pkSess_6359),Ksrv_6533))
                                                            )
                                                            else
                                                                {7219}let v_6534: bool = (Disco_5314 = C) in
                                                                (
                                                                    {7220}if v_6534 then
                                                                    (
                                                                        {7221}let pkDisco_6535: bitstring = pub(skC) in
                                                                        {7222}in(c, (=pkCli_6511,em1_6536: bitstring));
                                                                        {7223}let m1_6537: bitstring = em1_6536 in
                                                                        {7224}let (=OpenSecureChannelRequest,=pkCli_6511,PartC_6538: bitstring) = m1_6537 in
                                                                        {7225}new Ns_6539: bitstring;
                                                                        {7226}new ST_6540: bitstring;
                                                                        {7227}new TTL_6541: bitstring;
                                                                        {7228}let gNs_6542: bitstring = exp(g,Ns_6539) in
                                                                        {7229}let m2_6543: bitstring = (OpenSecureChannelResponse,gNs_6542,ST_6540,TTL_6541) in
                                                                        {7230}out(c, m2_6543);
                                                                        {7231}let Ksrv_6544: bitstring = exp(PartC_6538,Ns_6539) in
                                                                        {7232}out(c, senc(mSrv(pkCli_6511,pkSess_6359),Ksrv_6544))
                                                                    )
                                                                    else
                                                                        {7233}let pkDisco_6545: bitstring = pub(sk(Disco_5314)) in
                                                                        {7234}in(c, (=pkCli_6511,em1_6546: bitstring));
                                                                        {7235}let m1_6547: bitstring = em1_6546 in
                                                                        {7236}let (=OpenSecureChannelRequest,=pkCli_6511,PartC_6548: bitstring) = m1_6547 in
                                                                        {7237}new Ns_6549: bitstring;
                                                                        {7238}new ST_6550: bitstring;
                                                                        {7239}new TTL_6551: bitstring;
                                                                        {7240}let gNs_6552: bitstring = exp(g,Ns_6549) in
                                                                        {7241}let m2_6553: bitstring = (OpenSecureChannelResponse,gNs_6552,ST_6550,TTL_6551) in
                                                                        {7242}out(c, m2_6553);
                                                                        {7243}let Ksrv_6554: bitstring = exp(PartC_6548,Ns_6549) in
                                                                        {7244}out(c, senc(mSrv(pkCli_6511,pkSess_6359),Ksrv_6554))
                                                                )
                                                                else
                                                                    {7245}let pkDisco_6555: bitstring = fail-any in
                                                                    {7246}in(c, (=pkCli_6511,em1_6556: bitstring));
                                                                    {7247}let m1_6557: bitstring = em1_6556 in
                                                                    {7248}let (=OpenSecureChannelRequest,=pkCli_6511,PartC_6558: bitstring) = m1_6557 in
                                                                    {7249}new Ns_6559: bitstring;
                                                                    {7250}new ST_6560: bitstring;
                                                                    {7251}new TTL_6561: bitstring;
                                                                    {7252}let gNs_6562: bitstring = exp(g,Ns_6559) in
                                                                    {7253}let m2_6563: bitstring = (OpenSecureChannelResponse,gNs_6562,ST_6560,TTL_6561) in
                                                                    {7254}out(c, m2_6563);
                                                                    {7255}let Ksrv_6564: bitstring = exp(PartC_6558,Ns_6559) in
                                                                    {7256}out(c, senc(mSrv(pkCli_6511,pkSess_6359),Ksrv_6564))
                                                        )
                                                        else
                                                            {7257}let pkDisco_6565: bitstring = fail-any in
                                                            {7258}in(c, (=pkCli_6511,em1_6566: bitstring));
                                                            {7259}let m1_6567: bitstring = em1_6566 in
                                                            {7260}let (=OpenSecureChannelRequest,=pkCli_6511,PartC_6568: bitstring) = m1_6567 in
                                                            {7261}new Ns_6569: bitstring;
                                                            {7262}new ST_6570: bitstring;
                                                            {7263}new TTL_6571: bitstring;
                                                            {7264}let gNs_6572: bitstring = exp(g,Ns_6569) in
                                                            {7265}let m2_6573: bitstring = (OpenSecureChannelResponse,gNs_6572,ST_6570,TTL_6571) in
                                                            {7266}out(c, m2_6573);
                                                            {7267}let Ksrv_6574: bitstring = exp(PartC_6568,Ns_6569) in
                                                            {7268}out(c, senc(mSrv(pkCli_6511,pkSess_6359),Ksrv_6574))
                                                )
                                                else
                                                    {7269}let pkDisco_6575: bitstring = fail-any in
                                                    {7270}in(c, (=pkCli_6511,em1_6576: bitstring));
                                                    {7271}let m1_6577: bitstring = em1_6576 in
                                                    {7272}let (=OpenSecureChannelRequest,=pkCli_6511,PartC_6578: bitstring) = m1_6577 in
                                                    {7273}new Ns_6579: bitstring;
                                                    {7274}new ST_6580: bitstring;
                                                    {7275}new TTL_6581: bitstring;
                                                    {7276}let gNs_6582: bitstring = exp(g,Ns_6579) in
                                                    {7277}let m2_6583: bitstring = (OpenSecureChannelResponse,gNs_6582,ST_6580,TTL_6581) in
                                                    {7278}out(c, m2_6583);
                                                    {7279}let Ksrv_6584: bitstring = exp(PartC_6578,Ns_6579) in
                                                    {7280}out(c, senc(mSrv(pkCli_6511,pkSess_6359),Ksrv_6584))
                                            )
                                            else
                                                {7281}let pkCli_6585: bitstring = pub(sk(Cli_5313)) in
                                                {7282}let v_6586: bool = (Disco_5314 = A) in
                                                (
                                                    {7283}if v_6586 then
                                                    (
                                                        {7284}let pkDisco_6587: bitstring = pub(skA) in
                                                        {7285}in(c, (=pkCli_6585,em1_6588: bitstring));
                                                        {7286}let m1_6589: bitstring = em1_6588 in
                                                        {7287}let (=OpenSecureChannelRequest,=pkCli_6585,PartC_6590: bitstring) = m1_6589 in
                                                        {7288}new Ns_6591: bitstring;
                                                        {7289}new ST_6592: bitstring;
                                                        {7290}new TTL_6593: bitstring;
                                                        {7291}let gNs_6594: bitstring = exp(g,Ns_6591) in
                                                        {7292}let m2_6595: bitstring = (OpenSecureChannelResponse,gNs_6594,ST_6592,TTL_6593) in
                                                        {7293}out(c, m2_6595);
                                                        {7294}let Ksrv_6596: bitstring = exp(PartC_6590,Ns_6591) in
                                                        {7295}out(c, senc(mSrv(pkCli_6585,pkSess_6359),Ksrv_6596))
                                                    )
                                                    else
                                                        {7296}let v_6597: bool = (Disco_5314 = B) in
                                                        (
                                                            {7297}if v_6597 then
                                                            (
                                                                {7298}let pkDisco_6598: bitstring = pub(skB) in
                                                                {7299}in(c, (=pkCli_6585,em1_6599: bitstring));
                                                                {7300}let m1_6600: bitstring = em1_6599 in
                                                                {7301}let (=OpenSecureChannelRequest,=pkCli_6585,PartC_6601: bitstring) = m1_6600 in
                                                                {7302}new Ns_6602: bitstring;
                                                                {7303}new ST_6603: bitstring;
                                                                {7304}new TTL_6604: bitstring;
                                                                {7305}let gNs_6605: bitstring = exp(g,Ns_6602) in
                                                                {7306}let m2_6606: bitstring = (OpenSecureChannelResponse,gNs_6605,ST_6603,TTL_6604) in
                                                                {7307}out(c, m2_6606);
                                                                {7308}let Ksrv_6607: bitstring = exp(PartC_6601,Ns_6602) in
                                                                {7309}out(c, senc(mSrv(pkCli_6585,pkSess_6359),Ksrv_6607))
                                                            )
                                                            else
                                                                {7310}let v_6608: bool = (Disco_5314 = C) in
                                                                (
                                                                    {7311}if v_6608 then
                                                                    (
                                                                        {7312}let pkDisco_6609: bitstring = pub(skC) in
                                                                        {7313}in(c, (=pkCli_6585,em1_6610: bitstring));
                                                                        {7314}let m1_6611: bitstring = em1_6610 in
                                                                        {7315}let (=OpenSecureChannelRequest,=pkCli_6585,PartC_6612: bitstring) = m1_6611 in
                                                                        {7316}new Ns_6613: bitstring;
                                                                        {7317}new ST_6614: bitstring;
                                                                        {7318}new TTL_6615: bitstring;
                                                                        {7319}let gNs_6616: bitstring = exp(g,Ns_6613) in
                                                                        {7320}let m2_6617: bitstring = (OpenSecureChannelResponse,gNs_6616,ST_6614,TTL_6615) in
                                                                        {7321}out(c, m2_6617);
                                                                        {7322}let Ksrv_6618: bitstring = exp(PartC_6612,Ns_6613) in
                                                                        {7323}out(c, senc(mSrv(pkCli_6585,pkSess_6359),Ksrv_6618))
                                                                    )
                                                                    else
                                                                        {7324}let pkDisco_6619: bitstring = pub(sk(Disco_5314)) in
                                                                        {7325}in(c, (=pkCli_6585,em1_6620: bitstring));
                                                                        {7326}let m1_6621: bitstring = em1_6620 in
                                                                        {7327}let (=OpenSecureChannelRequest,=pkCli_6585,PartC_6622: bitstring) = m1_6621 in
                                                                        {7328}new Ns_6623: bitstring;
                                                                        {7329}new ST_6624: bitstring;
                                                                        {7330}new TTL_6625: bitstring;
                                                                        {7331}let gNs_6626: bitstring = exp(g,Ns_6623) in
                                                                        {7332}let m2_6627: bitstring = (OpenSecureChannelResponse,gNs_6626,ST_6624,TTL_6625) in
                                                                        {7333}out(c, m2_6627);
                                                                        {7334}let Ksrv_6628: bitstring = exp(PartC_6622,Ns_6623) in
                                                                        {7335}out(c, senc(mSrv(pkCli_6585,pkSess_6359),Ksrv_6628))
                                                                )
                                                                else
                                                                    {7336}let pkDisco_6629: bitstring = fail-any in
                                                                    {7337}in(c, (=pkCli_6585,em1_6630: bitstring));
                                                                    {7338}let m1_6631: bitstring = em1_6630 in
                                                                    {7339}let (=OpenSecureChannelRequest,=pkCli_6585,PartC_6632: bitstring) = m1_6631 in
                                                                    {7340}new Ns_6633: bitstring;
                                                                    {7341}new ST_6634: bitstring;
                                                                    {7342}new TTL_6635: bitstring;
                                                                    {7343}let gNs_6636: bitstring = exp(g,Ns_6633) in
                                                                    {7344}let m2_6637: bitstring = (OpenSecureChannelResponse,gNs_6636,ST_6634,TTL_6635) in
                                                                    {7345}out(c, m2_6637);
                                                                    {7346}let Ksrv_6638: bitstring = exp(PartC_6632,Ns_6633) in
                                                                    {7347}out(c, senc(mSrv(pkCli_6585,pkSess_6359),Ksrv_6638))
                                                        )
                                                        else
                                                            {7348}let pkDisco_6639: bitstring = fail-any in
                                                            {7349}in(c, (=pkCli_6585,em1_6640: bitstring));
                                                            {7350}let m1_6641: bitstring = em1_6640 in
                                                            {7351}let (=OpenSecureChannelRequest,=pkCli_6585,PartC_6642: bitstring) = m1_6641 in
                                                            {7352}new Ns_6643: bitstring;
                                                            {7353}new ST_6644: bitstring;
                                                            {7354}new TTL_6645: bitstring;
                                                            {7355}let gNs_6646: bitstring = exp(g,Ns_6643) in
                                                            {7356}let m2_6647: bitstring = (OpenSecureChannelResponse,gNs_6646,ST_6644,TTL_6645) in
                                                            {7357}out(c, m2_6647);
                                                            {7358}let Ksrv_6648: bitstring = exp(PartC_6642,Ns_6643) in
                                                            {7359}out(c, senc(mSrv(pkCli_6585,pkSess_6359),Ksrv_6648))
                                                )
                                                else
                                                    {7360}let pkDisco_6649: bitstring = fail-any in
                                                    {7361}in(c, (=pkCli_6585,em1_6650: bitstring));
                                                    {7362}let m1_6651: bitstring = em1_6650 in
                                                    {7363}let (=OpenSecureChannelRequest,=pkCli_6585,PartC_6652: bitstring) = m1_6651 in
                                                    {7364}new Ns_6653: bitstring;
                                                    {7365}new ST_6654: bitstring;
                                                    {7366}new TTL_6655: bitstring;
                                                    {7367}let gNs_6656: bitstring = exp(g,Ns_6653) in
                                                    {7368}let m2_6657: bitstring = (OpenSecureChannelResponse,gNs_6656,ST_6654,TTL_6655) in
                                                    {7369}out(c, m2_6657);
                                                    {7370}let Ksrv_6658: bitstring = exp(PartC_6652,Ns_6653) in
                                                    {7371}out(c, senc(mSrv(pkCli_6585,pkSess_6359),Ksrv_6658))
                                        )
                                        else
                                            {7372}let pkCli_6659: bitstring = fail-any in
                                            {7373}let v_6660: bool = (Disco_5314 = A) in
                                            (
                                                {7374}if v_6660 then
                                                (
                                                    {7375}let pkDisco_6661: bitstring = pub(skA) in
                                                    {7376}in(c, (=pkCli_6659,em1_6662: bitstring));
                                                    {7377}let m1_6663: bitstring = em1_6662 in
                                                    {7378}let (=OpenSecureChannelRequest,=pkCli_6659,PartC_6664: bitstring) = m1_6663 in
                                                    {7379}new Ns_6665: bitstring;
                                                    {7380}new ST_6666: bitstring;
                                                    {7381}new TTL_6667: bitstring;
                                                    {7382}let gNs_6668: bitstring = exp(g,Ns_6665) in
                                                    {7383}let m2_6669: bitstring = (OpenSecureChannelResponse,gNs_6668,ST_6666,TTL_6667) in
                                                    {7384}out(c, m2_6669);
                                                    {7385}let Ksrv_6670: bitstring = exp(PartC_6664,Ns_6665) in
                                                    {7386}out(c, senc(mSrv(pkCli_6659,pkSess_6359),Ksrv_6670))
                                                )
                                                else
                                                    {7387}let v_6671: bool = (Disco_5314 = B) in
                                                    (
                                                        {7388}if v_6671 then
                                                        (
                                                            {7389}let pkDisco_6672: bitstring = pub(skB) in
                                                            {7390}in(c, (=pkCli_6659,em1_6673: bitstring));
                                                            {7391}let m1_6674: bitstring = em1_6673 in
                                                            {7392}let (=OpenSecureChannelRequest,=pkCli_6659,PartC_6675: bitstring) = m1_6674 in
                                                            {7393}new Ns_6676: bitstring;
                                                            {7394}new ST_6677: bitstring;
                                                            {7395}new TTL_6678: bitstring;
                                                            {7396}let gNs_6679: bitstring = exp(g,Ns_6676) in
                                                            {7397}let m2_6680: bitstring = (OpenSecureChannelResponse,gNs_6679,ST_6677,TTL_6678) in
                                                            {7398}out(c, m2_6680);
                                                            {7399}let Ksrv_6681: bitstring = exp(PartC_6675,Ns_6676) in
                                                            {7400}out(c, senc(mSrv(pkCli_6659,pkSess_6359),Ksrv_6681))
                                                        )
                                                        else
                                                            {7401}let v_6682: bool = (Disco_5314 = C) in
                                                            (
                                                                {7402}if v_6682 then
                                                                (
                                                                    {7403}let pkDisco_6683: bitstring = pub(skC) in
                                                                    {7404}in(c, (=pkCli_6659,em1_6684: bitstring));
                                                                    {7405}let m1_6685: bitstring = em1_6684 in
                                                                    {7406}let (=OpenSecureChannelRequest,=pkCli_6659,PartC_6686: bitstring) = m1_6685 in
                                                                    {7407}new Ns_6687: bitstring;
                                                                    {7408}new ST_6688: bitstring;
                                                                    {7409}new TTL_6689: bitstring;
                                                                    {7410}let gNs_6690: bitstring = exp(g,Ns_6687) in
                                                                    {7411}let m2_6691: bitstring = (OpenSecureChannelResponse,gNs_6690,ST_6688,TTL_6689) in
                                                                    {7412}out(c, m2_6691);
                                                                    {7413}let Ksrv_6692: bitstring = exp(PartC_6686,Ns_6687) in
                                                                    {7414}out(c, senc(mSrv(pkCli_6659,pkSess_6359),Ksrv_6692))
                                                                )
                                                                else
                                                                    {7415}let pkDisco_6693: bitstring = pub(sk(Disco_5314)) in
                                                                    {7416}in(c, (=pkCli_6659,em1_6694: bitstring));
                                                                    {7417}let m1_6695: bitstring = em1_6694 in
                                                                    {7418}let (=OpenSecureChannelRequest,=pkCli_6659,PartC_6696: bitstring) = m1_6695 in
                                                                    {7419}new Ns_6697: bitstring;
                                                                    {7420}new ST_6698: bitstring;
                                                                    {7421}new TTL_6699: bitstring;
                                                                    {7422}let gNs_6700: bitstring = exp(g,Ns_6697) in
                                                                    {7423}let m2_6701: bitstring = (OpenSecureChannelResponse,gNs_6700,ST_6698,TTL_6699) in
                                                                    {7424}out(c, m2_6701);
                                                                    {7425}let Ksrv_6702: bitstring = exp(PartC_6696,Ns_6697) in
                                                                    {7426}out(c, senc(mSrv(pkCli_6659,pkSess_6359),Ksrv_6702))
                                                            )
                                                            else
                                                                {7427}let pkDisco_6703: bitstring = fail-any in
                                                                {7428}in(c, (=pkCli_6659,em1_6704: bitstring));
                                                                {7429}let m1_6705: bitstring = em1_6704 in
                                                                {7430}let (=OpenSecureChannelRequest,=pkCli_6659,PartC_6706: bitstring) = m1_6705 in
                                                                {7431}new Ns_6707: bitstring;
                                                                {7432}new ST_6708: bitstring;
                                                                {7433}new TTL_6709: bitstring;
                                                                {7434}let gNs_6710: bitstring = exp(g,Ns_6707) in
                                                                {7435}let m2_6711: bitstring = (OpenSecureChannelResponse,gNs_6710,ST_6708,TTL_6709) in
                                                                {7436}out(c, m2_6711);
                                                                {7437}let Ksrv_6712: bitstring = exp(PartC_6706,Ns_6707) in
                                                                {7438}out(c, senc(mSrv(pkCli_6659,pkSess_6359),Ksrv_6712))
                                                    )
                                                    else
                                                        {7439}let pkDisco_6713: bitstring = fail-any in
                                                        {7440}in(c, (=pkCli_6659,em1_6714: bitstring));
                                                        {7441}let m1_6715: bitstring = em1_6714 in
                                                        {7442}let (=OpenSecureChannelRequest,=pkCli_6659,PartC_6716: bitstring) = m1_6715 in
                                                        {7443}new Ns_6717: bitstring;
                                                        {7444}new ST_6718: bitstring;
                                                        {7445}new TTL_6719: bitstring;
                                                        {7446}let gNs_6720: bitstring = exp(g,Ns_6717) in
                                                        {7447}let m2_6721: bitstring = (OpenSecureChannelResponse,gNs_6720,ST_6718,TTL_6719) in
                                                        {7448}out(c, m2_6721);
                                                        {7449}let Ksrv_6722: bitstring = exp(PartC_6716,Ns_6717) in
                                                        {7450}out(c, senc(mSrv(pkCli_6659,pkSess_6359),Ksrv_6722))
                                            )
                                            else
                                                {7451}let pkDisco_6723: bitstring = fail-any in
                                                {7452}in(c, (=pkCli_6659,em1_6724: bitstring));
                                                {7453}let m1_6725: bitstring = em1_6724 in
                                                {7454}let (=OpenSecureChannelRequest,=pkCli_6659,PartC_6726: bitstring) = m1_6725 in
                                                {7455}new Ns_6727: bitstring;
                                                {7456}new ST_6728: bitstring;
                                                {7457}new TTL_6729: bitstring;
                                                {7458}let gNs_6730: bitstring = exp(g,Ns_6727) in
                                                {7459}let m2_6731: bitstring = (OpenSecureChannelResponse,gNs_6730,ST_6728,TTL_6729) in
                                                {7460}out(c, m2_6731);
                                                {7461}let Ksrv_6732: bitstring = exp(PartC_6726,Ns_6727) in
                                                {7462}out(c, senc(mSrv(pkCli_6659,pkSess_6359),Ksrv_6732))
                                )
                                else
                                    {7463}let pkCli_6733: bitstring = fail-any in
                                    {7464}let v_6734: bool = (Disco_5314 = A) in
                                    (
                                        {7465}if v_6734 then
                                        (
                                            {7466}let pkDisco_6735: bitstring = pub(skA) in
                                            {7467}in(c, (=pkCli_6733,em1_6736: bitstring));
                                            {7468}let m1_6737: bitstring = em1_6736 in
                                            {7469}let (=OpenSecureChannelRequest,=pkCli_6733,PartC_6738: bitstring) = m1_6737 in
                                            {7470}new Ns_6739: bitstring;
                                            {7471}new ST_6740: bitstring;
                                            {7472}new TTL_6741: bitstring;
                                            {7473}let gNs_6742: bitstring = exp(g,Ns_6739) in
                                            {7474}let m2_6743: bitstring = (OpenSecureChannelResponse,gNs_6742,ST_6740,TTL_6741) in
                                            {7475}out(c, m2_6743);
                                            {7476}let Ksrv_6744: bitstring = exp(PartC_6738,Ns_6739) in
                                            {7477}out(c, senc(mSrv(pkCli_6733,pkSess_6359),Ksrv_6744))
                                        )
                                        else
                                            {7478}let v_6745: bool = (Disco_5314 = B) in
                                            (
                                                {7479}if v_6745 then
                                                (
                                                    {7480}let pkDisco_6746: bitstring = pub(skB) in
                                                    {7481}in(c, (=pkCli_6733,em1_6747: bitstring));
                                                    {7482}let m1_6748: bitstring = em1_6747 in
                                                    {7483}let (=OpenSecureChannelRequest,=pkCli_6733,PartC_6749: bitstring) = m1_6748 in
                                                    {7484}new Ns_6750: bitstring;
                                                    {7485}new ST_6751: bitstring;
                                                    {7486}new TTL_6752: bitstring;
                                                    {7487}let gNs_6753: bitstring = exp(g,Ns_6750) in
                                                    {7488}let m2_6754: bitstring = (OpenSecureChannelResponse,gNs_6753,ST_6751,TTL_6752) in
                                                    {7489}out(c, m2_6754);
                                                    {7490}let Ksrv_6755: bitstring = exp(PartC_6749,Ns_6750) in
                                                    {7491}out(c, senc(mSrv(pkCli_6733,pkSess_6359),Ksrv_6755))
                                                )
                                                else
                                                    {7492}let v_6756: bool = (Disco_5314 = C) in
                                                    (
                                                        {7493}if v_6756 then
                                                        (
                                                            {7494}let pkDisco_6757: bitstring = pub(skC) in
                                                            {7495}in(c, (=pkCli_6733,em1_6758: bitstring));
                                                            {7496}let m1_6759: bitstring = em1_6758 in
                                                            {7497}let (=OpenSecureChannelRequest,=pkCli_6733,PartC_6760: bitstring) = m1_6759 in
                                                            {7498}new Ns_6761: bitstring;
                                                            {7499}new ST_6762: bitstring;
                                                            {7500}new TTL_6763: bitstring;
                                                            {7501}let gNs_6764: bitstring = exp(g,Ns_6761) in
                                                            {7502}let m2_6765: bitstring = (OpenSecureChannelResponse,gNs_6764,ST_6762,TTL_6763) in
                                                            {7503}out(c, m2_6765);
                                                            {7504}let Ksrv_6766: bitstring = exp(PartC_6760,Ns_6761) in
                                                            {7505}out(c, senc(mSrv(pkCli_6733,pkSess_6359),Ksrv_6766))
                                                        )
                                                        else
                                                            {7506}let pkDisco_6767: bitstring = pub(sk(Disco_5314)) in
                                                            {7507}in(c, (=pkCli_6733,em1_6768: bitstring));
                                                            {7508}let m1_6769: bitstring = em1_6768 in
                                                            {7509}let (=OpenSecureChannelRequest,=pkCli_6733,PartC_6770: bitstring) = m1_6769 in
                                                            {7510}new Ns_6771: bitstring;
                                                            {7511}new ST_6772: bitstring;
                                                            {7512}new TTL_6773: bitstring;
                                                            {7513}let gNs_6774: bitstring = exp(g,Ns_6771) in
                                                            {7514}let m2_6775: bitstring = (OpenSecureChannelResponse,gNs_6774,ST_6772,TTL_6773) in
                                                            {7515}out(c, m2_6775);
                                                            {7516}let Ksrv_6776: bitstring = exp(PartC_6770,Ns_6771) in
                                                            {7517}out(c, senc(mSrv(pkCli_6733,pkSess_6359),Ksrv_6776))
                                                    )
                                                    else
                                                        {7518}let pkDisco_6777: bitstring = fail-any in
                                                        {7519}in(c, (=pkCli_6733,em1_6778: bitstring));
                                                        {7520}let m1_6779: bitstring = em1_6778 in
                                                        {7521}let (=OpenSecureChannelRequest,=pkCli_6733,PartC_6780: bitstring) = m1_6779 in
                                                        {7522}new Ns_6781: bitstring;
                                                        {7523}new ST_6782: bitstring;
                                                        {7524}new TTL_6783: bitstring;
                                                        {7525}let gNs_6784: bitstring = exp(g,Ns_6781) in
                                                        {7526}let m2_6785: bitstring = (OpenSecureChannelResponse,gNs_6784,ST_6782,TTL_6783) in
                                                        {7527}out(c, m2_6785);
                                                        {7528}let Ksrv_6786: bitstring = exp(PartC_6780,Ns_6781) in
                                                        {7529}out(c, senc(mSrv(pkCli_6733,pkSess_6359),Ksrv_6786))
                                            )
                                            else
                                                {7530}let pkDisco_6787: bitstring = fail-any in
                                                {7531}in(c, (=pkCli_6733,em1_6788: bitstring));
                                                {7532}let m1_6789: bitstring = em1_6788 in
                                                {7533}let (=OpenSecureChannelRequest,=pkCli_6733,PartC_6790: bitstring) = m1_6789 in
                                                {7534}new Ns_6791: bitstring;
                                                {7535}new ST_6792: bitstring;
                                                {7536}new TTL_6793: bitstring;
                                                {7537}let gNs_6794: bitstring = exp(g,Ns_6791) in
                                                {7538}let m2_6795: bitstring = (OpenSecureChannelResponse,gNs_6794,ST_6792,TTL_6793) in
                                                {7539}out(c, m2_6795);
                                                {7540}let Ksrv_6796: bitstring = exp(PartC_6790,Ns_6791) in
                                                {7541}out(c, senc(mSrv(pkCli_6733,pkSess_6359),Ksrv_6796))
                                    )
                                    else
                                        {7542}let pkDisco_6797: bitstring = fail-any in
                                        {7543}in(c, (=pkCli_6733,em1_6798: bitstring));
                                        {7544}let m1_6799: bitstring = em1_6798 in
                                        {7545}let (=OpenSecureChannelRequest,=pkCli_6733,PartC_6800: bitstring) = m1_6799 in
                                        {7546}new Ns_6801: bitstring;
                                        {7547}new ST_6802: bitstring;
                                        {7548}new TTL_6803: bitstring;
                                        {7549}let gNs_6804: bitstring = exp(g,Ns_6801) in
                                        {7550}let m2_6805: bitstring = (OpenSecureChannelResponse,gNs_6804,ST_6802,TTL_6803) in
                                        {7551}out(c, m2_6805);
                                        {7552}let Ksrv_6806: bitstring = exp(PartC_6800,Ns_6801) in
                                        {7553}out(c, senc(mSrv(pkCli_6733,pkSess_6359),Ksrv_6806))
                        )
                        else
                            {7554}let pkCli_6807: bitstring = fail-any in
                            {7555}let v_6808: bool = (Disco_5314 = A) in
                            (
                                {7556}if v_6808 then
                                (
                                    {7557}let pkDisco_6809: bitstring = pub(skA) in
                                    {7558}in(c, (=pkCli_6807,em1_6810: bitstring));
                                    {7559}let m1_6811: bitstring = em1_6810 in
                                    {7560}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6812: bitstring) = m1_6811 in
                                    {7561}new Ns_6813: bitstring;
                                    {7562}new ST_6814: bitstring;
                                    {7563}new TTL_6815: bitstring;
                                    {7564}let gNs_6816: bitstring = exp(g,Ns_6813) in
                                    {7565}let m2_6817: bitstring = (OpenSecureChannelResponse,gNs_6816,ST_6814,TTL_6815) in
                                    {7566}out(c, m2_6817);
                                    {7567}let Ksrv_6818: bitstring = exp(PartC_6812,Ns_6813) in
                                    {7568}out(c, senc(mSrv(pkCli_6807,pkSess_6359),Ksrv_6818))
                                )
                                else
                                    {7569}let v_6819: bool = (Disco_5314 = B) in
                                    (
                                        {7570}if v_6819 then
                                        (
                                            {7571}let pkDisco_6820: bitstring = pub(skB) in
                                            {7572}in(c, (=pkCli_6807,em1_6821: bitstring));
                                            {7573}let m1_6822: bitstring = em1_6821 in
                                            {7574}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6823: bitstring) = m1_6822 in
                                            {7575}new Ns_6824: bitstring;
                                            {7576}new ST_6825: bitstring;
                                            {7577}new TTL_6826: bitstring;
                                            {7578}let gNs_6827: bitstring = exp(g,Ns_6824) in
                                            {7579}let m2_6828: bitstring = (OpenSecureChannelResponse,gNs_6827,ST_6825,TTL_6826) in
                                            {7580}out(c, m2_6828);
                                            {7581}let Ksrv_6829: bitstring = exp(PartC_6823,Ns_6824) in
                                            {7582}out(c, senc(mSrv(pkCli_6807,pkSess_6359),Ksrv_6829))
                                        )
                                        else
                                            {7583}let v_6830: bool = (Disco_5314 = C) in
                                            (
                                                {7584}if v_6830 then
                                                (
                                                    {7585}let pkDisco_6831: bitstring = pub(skC) in
                                                    {7586}in(c, (=pkCli_6807,em1_6832: bitstring));
                                                    {7587}let m1_6833: bitstring = em1_6832 in
                                                    {7588}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6834: bitstring) = m1_6833 in
                                                    {7589}new Ns_6835: bitstring;
                                                    {7590}new ST_6836: bitstring;
                                                    {7591}new TTL_6837: bitstring;
                                                    {7592}let gNs_6838: bitstring = exp(g,Ns_6835) in
                                                    {7593}let m2_6839: bitstring = (OpenSecureChannelResponse,gNs_6838,ST_6836,TTL_6837) in
                                                    {7594}out(c, m2_6839);
                                                    {7595}let Ksrv_6840: bitstring = exp(PartC_6834,Ns_6835) in
                                                    {7596}out(c, senc(mSrv(pkCli_6807,pkSess_6359),Ksrv_6840))
                                                )
                                                else
                                                    {7597}let pkDisco_6841: bitstring = pub(sk(Disco_5314)) in
                                                    {7598}in(c, (=pkCli_6807,em1_6842: bitstring));
                                                    {7599}let m1_6843: bitstring = em1_6842 in
                                                    {7600}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6844: bitstring) = m1_6843 in
                                                    {7601}new Ns_6845: bitstring;
                                                    {7602}new ST_6846: bitstring;
                                                    {7603}new TTL_6847: bitstring;
                                                    {7604}let gNs_6848: bitstring = exp(g,Ns_6845) in
                                                    {7605}let m2_6849: bitstring = (OpenSecureChannelResponse,gNs_6848,ST_6846,TTL_6847) in
                                                    {7606}out(c, m2_6849);
                                                    {7607}let Ksrv_6850: bitstring = exp(PartC_6844,Ns_6845) in
                                                    {7608}out(c, senc(mSrv(pkCli_6807,pkSess_6359),Ksrv_6850))
                                            )
                                            else
                                                {7609}let pkDisco_6851: bitstring = fail-any in
                                                {7610}in(c, (=pkCli_6807,em1_6852: bitstring));
                                                {7611}let m1_6853: bitstring = em1_6852 in
                                                {7612}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6854: bitstring) = m1_6853 in
                                                {7613}new Ns_6855: bitstring;
                                                {7614}new ST_6856: bitstring;
                                                {7615}new TTL_6857: bitstring;
                                                {7616}let gNs_6858: bitstring = exp(g,Ns_6855) in
                                                {7617}let m2_6859: bitstring = (OpenSecureChannelResponse,gNs_6858,ST_6856,TTL_6857) in
                                                {7618}out(c, m2_6859);
                                                {7619}let Ksrv_6860: bitstring = exp(PartC_6854,Ns_6855) in
                                                {7620}out(c, senc(mSrv(pkCli_6807,pkSess_6359),Ksrv_6860))
                                    )
                                    else
                                        {7621}let pkDisco_6861: bitstring = fail-any in
                                        {7622}in(c, (=pkCli_6807,em1_6862: bitstring));
                                        {7623}let m1_6863: bitstring = em1_6862 in
                                        {7624}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6864: bitstring) = m1_6863 in
                                        {7625}new Ns_6865: bitstring;
                                        {7626}new ST_6866: bitstring;
                                        {7627}new TTL_6867: bitstring;
                                        {7628}let gNs_6868: bitstring = exp(g,Ns_6865) in
                                        {7629}let m2_6869: bitstring = (OpenSecureChannelResponse,gNs_6868,ST_6866,TTL_6867) in
                                        {7630}out(c, m2_6869);
                                        {7631}let Ksrv_6870: bitstring = exp(PartC_6864,Ns_6865) in
                                        {7632}out(c, senc(mSrv(pkCli_6807,pkSess_6359),Ksrv_6870))
                            )
                            else
                                {7633}let pkDisco_6871: bitstring = fail-any in
                                {7634}in(c, (=pkCli_6807,em1_6872: bitstring));
                                {7635}let m1_6873: bitstring = em1_6872 in
                                {7636}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6874: bitstring) = m1_6873 in
                                {7637}new Ns_6875: bitstring;
                                {7638}new ST_6876: bitstring;
                                {7639}new TTL_6877: bitstring;
                                {7640}let gNs_6878: bitstring = exp(g,Ns_6875) in
                                {7641}let m2_6879: bitstring = (OpenSecureChannelResponse,gNs_6878,ST_6876,TTL_6877) in
                                {7642}out(c, m2_6879);
                                {7643}let Ksrv_6880: bitstring = exp(PartC_6874,Ns_6875) in
                                {7644}out(c, senc(mSrv(pkCli_6807,pkSess_6359),Ksrv_6880))
                    )
                    else
                        {7645}let skSess_6881: bitstring = fail-any in
                        {7646}let pkSess_6882: bitstring = pub(skSess_6881) in
                        {7647}let v_6883: bool = (Cli_5313 = A) in
                        (
                            {7648}if v_6883 then
                            (
                                {7649}let pkCli_6884: bitstring = pub(skA) in
                                {7650}let v_6885: bool = (Disco_5314 = A) in
                                (
                                    {7651}if v_6885 then
                                    (
                                        {7652}let pkDisco_6886: bitstring = pub(skA) in
                                        {7653}in(c, (=pkCli_6884,em1_6887: bitstring));
                                        {7654}let m1_6888: bitstring = em1_6887 in
                                        {7655}let (=OpenSecureChannelRequest,=pkCli_6884,PartC_6889: bitstring) = m1_6888 in
                                        {7656}new Ns_6890: bitstring;
                                        {7657}new ST_6891: bitstring;
                                        {7658}new TTL_6892: bitstring;
                                        {7659}let gNs_6893: bitstring = exp(g,Ns_6890) in
                                        {7660}let m2_6894: bitstring = (OpenSecureChannelResponse,gNs_6893,ST_6891,TTL_6892) in
                                        {7661}out(c, m2_6894);
                                        {7662}let Ksrv_6895: bitstring = exp(PartC_6889,Ns_6890) in
                                        {7663}out(c, senc(mSrv(pkCli_6884,pkSess_6882),Ksrv_6895))
                                    )
                                    else
                                        {7664}let v_6896: bool = (Disco_5314 = B) in
                                        (
                                            {7665}if v_6896 then
                                            (
                                                {7666}let pkDisco_6897: bitstring = pub(skB) in
                                                {7667}in(c, (=pkCli_6884,em1_6898: bitstring));
                                                {7668}let m1_6899: bitstring = em1_6898 in
                                                {7669}let (=OpenSecureChannelRequest,=pkCli_6884,PartC_6900: bitstring) = m1_6899 in
                                                {7670}new Ns_6901: bitstring;
                                                {7671}new ST_6902: bitstring;
                                                {7672}new TTL_6903: bitstring;
                                                {7673}let gNs_6904: bitstring = exp(g,Ns_6901) in
                                                {7674}let m2_6905: bitstring = (OpenSecureChannelResponse,gNs_6904,ST_6902,TTL_6903) in
                                                {7675}out(c, m2_6905);
                                                {7676}let Ksrv_6906: bitstring = exp(PartC_6900,Ns_6901) in
                                                {7677}out(c, senc(mSrv(pkCli_6884,pkSess_6882),Ksrv_6906))
                                            )
                                            else
                                                {7678}let v_6907: bool = (Disco_5314 = C) in
                                                (
                                                    {7679}if v_6907 then
                                                    (
                                                        {7680}let pkDisco_6908: bitstring = pub(skC) in
                                                        {7681}in(c, (=pkCli_6884,em1_6909: bitstring));
                                                        {7682}let m1_6910: bitstring = em1_6909 in
                                                        {7683}let (=OpenSecureChannelRequest,=pkCli_6884,PartC_6911: bitstring) = m1_6910 in
                                                        {7684}new Ns_6912: bitstring;
                                                        {7685}new ST_6913: bitstring;
                                                        {7686}new TTL_6914: bitstring;
                                                        {7687}let gNs_6915: bitstring = exp(g,Ns_6912) in
                                                        {7688}let m2_6916: bitstring = (OpenSecureChannelResponse,gNs_6915,ST_6913,TTL_6914) in
                                                        {7689}out(c, m2_6916);
                                                        {7690}let Ksrv_6917: bitstring = exp(PartC_6911,Ns_6912) in
                                                        {7691}out(c, senc(mSrv(pkCli_6884,pkSess_6882),Ksrv_6917))
                                                    )
                                                    else
                                                        {7692}let pkDisco_6918: bitstring = pub(sk(Disco_5314)) in
                                                        {7693}in(c, (=pkCli_6884,em1_6919: bitstring));
                                                        {7694}let m1_6920: bitstring = em1_6919 in
                                                        {7695}let (=OpenSecureChannelRequest,=pkCli_6884,PartC_6921: bitstring) = m1_6920 in
                                                        {7696}new Ns_6922: bitstring;
                                                        {7697}new ST_6923: bitstring;
                                                        {7698}new TTL_6924: bitstring;
                                                        {7699}let gNs_6925: bitstring = exp(g,Ns_6922) in
                                                        {7700}let m2_6926: bitstring = (OpenSecureChannelResponse,gNs_6925,ST_6923,TTL_6924) in
                                                        {7701}out(c, m2_6926);
                                                        {7702}let Ksrv_6927: bitstring = exp(PartC_6921,Ns_6922) in
                                                        {7703}out(c, senc(mSrv(pkCli_6884,pkSess_6882),Ksrv_6927))
                                                )
                                                else
                                                    {7704}let pkDisco_6928: bitstring = fail-any in
                                                    {7705}in(c, (=pkCli_6884,em1_6929: bitstring));
                                                    {7706}let m1_6930: bitstring = em1_6929 in
                                                    {7707}let (=OpenSecureChannelRequest,=pkCli_6884,PartC_6931: bitstring) = m1_6930 in
                                                    {7708}new Ns_6932: bitstring;
                                                    {7709}new ST_6933: bitstring;
                                                    {7710}new TTL_6934: bitstring;
                                                    {7711}let gNs_6935: bitstring = exp(g,Ns_6932) in
                                                    {7712}let m2_6936: bitstring = (OpenSecureChannelResponse,gNs_6935,ST_6933,TTL_6934) in
                                                    {7713}out(c, m2_6936);
                                                    {7714}let Ksrv_6937: bitstring = exp(PartC_6931,Ns_6932) in
                                                    {7715}out(c, senc(mSrv(pkCli_6884,pkSess_6882),Ksrv_6937))
                                        )
                                        else
                                            {7716}let pkDisco_6938: bitstring = fail-any in
                                            {7717}in(c, (=pkCli_6884,em1_6939: bitstring));
                                            {7718}let m1_6940: bitstring = em1_6939 in
                                            {7719}let (=OpenSecureChannelRequest,=pkCli_6884,PartC_6941: bitstring) = m1_6940 in
                                            {7720}new Ns_6942: bitstring;
                                            {7721}new ST_6943: bitstring;
                                            {7722}new TTL_6944: bitstring;
                                            {7723}let gNs_6945: bitstring = exp(g,Ns_6942) in
                                            {7724}let m2_6946: bitstring = (OpenSecureChannelResponse,gNs_6945,ST_6943,TTL_6944) in
                                            {7725}out(c, m2_6946);
                                            {7726}let Ksrv_6947: bitstring = exp(PartC_6941,Ns_6942) in
                                            {7727}out(c, senc(mSrv(pkCli_6884,pkSess_6882),Ksrv_6947))
                                )
                                else
                                    {7728}let pkDisco_6948: bitstring = fail-any in
                                    {7729}in(c, (=pkCli_6884,em1_6949: bitstring));
                                    {7730}let m1_6950: bitstring = em1_6949 in
                                    {7731}let (=OpenSecureChannelRequest,=pkCli_6884,PartC_6951: bitstring) = m1_6950 in
                                    {7732}new Ns_6952: bitstring;
                                    {7733}new ST_6953: bitstring;
                                    {7734}new TTL_6954: bitstring;
                                    {7735}let gNs_6955: bitstring = exp(g,Ns_6952) in
                                    {7736}let m2_6956: bitstring = (OpenSecureChannelResponse,gNs_6955,ST_6953,TTL_6954) in
                                    {7737}out(c, m2_6956);
                                    {7738}let Ksrv_6957: bitstring = exp(PartC_6951,Ns_6952) in
                                    {7739}out(c, senc(mSrv(pkCli_6884,pkSess_6882),Ksrv_6957))
                            )
                            else
                                {7740}let v_6958: bool = (Cli_5313 = B) in
                                (
                                    {7741}if v_6958 then
                                    (
                                        {7742}let pkCli_6959: bitstring = pub(skB) in
                                        {7743}let v_6960: bool = (Disco_5314 = A) in
                                        (
                                            {7744}if v_6960 then
                                            (
                                                {7745}let pkDisco_6961: bitstring = pub(skA) in
                                                {7746}in(c, (=pkCli_6959,em1_6962: bitstring));
                                                {7747}let m1_6963: bitstring = em1_6962 in
                                                {7748}let (=OpenSecureChannelRequest,=pkCli_6959,PartC_6964: bitstring) = m1_6963 in
                                                {7749}new Ns_6965: bitstring;
                                                {7750}new ST_6966: bitstring;
                                                {7751}new TTL_6967: bitstring;
                                                {7752}let gNs_6968: bitstring = exp(g,Ns_6965) in
                                                {7753}let m2_6969: bitstring = (OpenSecureChannelResponse,gNs_6968,ST_6966,TTL_6967) in
                                                {7754}out(c, m2_6969);
                                                {7755}let Ksrv_6970: bitstring = exp(PartC_6964,Ns_6965) in
                                                {7756}out(c, senc(mSrv(pkCli_6959,pkSess_6882),Ksrv_6970))
                                            )
                                            else
                                                {7757}let v_6971: bool = (Disco_5314 = B) in
                                                (
                                                    {7758}if v_6971 then
                                                    (
                                                        {7759}let pkDisco_6972: bitstring = pub(skB) in
                                                        {7760}in(c, (=pkCli_6959,em1_6973: bitstring));
                                                        {7761}let m1_6974: bitstring = em1_6973 in
                                                        {7762}let (=OpenSecureChannelRequest,=pkCli_6959,PartC_6975: bitstring) = m1_6974 in
                                                        {7763}new Ns_6976: bitstring;
                                                        {7764}new ST_6977: bitstring;
                                                        {7765}new TTL_6978: bitstring;
                                                        {7766}let gNs_6979: bitstring = exp(g,Ns_6976) in
                                                        {7767}let m2_6980: bitstring = (OpenSecureChannelResponse,gNs_6979,ST_6977,TTL_6978) in
                                                        {7768}out(c, m2_6980);
                                                        {7769}let Ksrv_6981: bitstring = exp(PartC_6975,Ns_6976) in
                                                        {7770}out(c, senc(mSrv(pkCli_6959,pkSess_6882),Ksrv_6981))
                                                    )
                                                    else
                                                        {7771}let v_6982: bool = (Disco_5314 = C) in
                                                        (
                                                            {7772}if v_6982 then
                                                            (
                                                                {7773}let pkDisco_6983: bitstring = pub(skC) in
                                                                {7774}in(c, (=pkCli_6959,em1_6984: bitstring));
                                                                {7775}let m1_6985: bitstring = em1_6984 in
                                                                {7776}let (=OpenSecureChannelRequest,=pkCli_6959,PartC_6986: bitstring) = m1_6985 in
                                                                {7777}new Ns_6987: bitstring;
                                                                {7778}new ST_6988: bitstring;
                                                                {7779}new TTL_6989: bitstring;
                                                                {7780}let gNs_6990: bitstring = exp(g,Ns_6987) in
                                                                {7781}let m2_6991: bitstring = (OpenSecureChannelResponse,gNs_6990,ST_6988,TTL_6989) in
                                                                {7782}out(c, m2_6991);
                                                                {7783}let Ksrv_6992: bitstring = exp(PartC_6986,Ns_6987) in
                                                                {7784}out(c, senc(mSrv(pkCli_6959,pkSess_6882),Ksrv_6992))
                                                            )
                                                            else
                                                                {7785}let pkDisco_6993: bitstring = pub(sk(Disco_5314)) in
                                                                {7786}in(c, (=pkCli_6959,em1_6994: bitstring));
                                                                {7787}let m1_6995: bitstring = em1_6994 in
                                                                {7788}let (=OpenSecureChannelRequest,=pkCli_6959,PartC_6996: bitstring) = m1_6995 in
                                                                {7789}new Ns_6997: bitstring;
                                                                {7790}new ST_6998: bitstring;
                                                                {7791}new TTL_6999: bitstring;
                                                                {7792}let gNs_7000: bitstring = exp(g,Ns_6997) in
                                                                {7793}let m2_7001: bitstring = (OpenSecureChannelResponse,gNs_7000,ST_6998,TTL_6999) in
                                                                {7794}out(c, m2_7001);
                                                                {7795}let Ksrv_7002: bitstring = exp(PartC_6996,Ns_6997) in
                                                                {7796}out(c, senc(mSrv(pkCli_6959,pkSess_6882),Ksrv_7002))
                                                        )
                                                        else
                                                            {7797}let pkDisco_7003: bitstring = fail-any in
                                                            {7798}in(c, (=pkCli_6959,em1_7004: bitstring));
                                                            {7799}let m1_7005: bitstring = em1_7004 in
                                                            {7800}let (=OpenSecureChannelRequest,=pkCli_6959,PartC_7006: bitstring) = m1_7005 in
                                                            {7801}new Ns_7007: bitstring;
                                                            {7802}new ST_7008: bitstring;
                                                            {7803}new TTL_7009: bitstring;
                                                            {7804}let gNs_7010: bitstring = exp(g,Ns_7007) in
                                                            {7805}let m2_7011: bitstring = (OpenSecureChannelResponse,gNs_7010,ST_7008,TTL_7009) in
                                                            {7806}out(c, m2_7011);
                                                            {7807}let Ksrv_7012: bitstring = exp(PartC_7006,Ns_7007) in
                                                            {7808}out(c, senc(mSrv(pkCli_6959,pkSess_6882),Ksrv_7012))
                                                )
                                                else
                                                    {7809}let pkDisco_7013: bitstring = fail-any in
                                                    {7810}in(c, (=pkCli_6959,em1_7014: bitstring));
                                                    {7811}let m1_7015: bitstring = em1_7014 in
                                                    {7812}let (=OpenSecureChannelRequest,=pkCli_6959,PartC_7016: bitstring) = m1_7015 in
                                                    {7813}new Ns_7017: bitstring;
                                                    {7814}new ST_7018: bitstring;
                                                    {7815}new TTL_7019: bitstring;
                                                    {7816}let gNs_7020: bitstring = exp(g,Ns_7017) in
                                                    {7817}let m2_7021: bitstring = (OpenSecureChannelResponse,gNs_7020,ST_7018,TTL_7019) in
                                                    {7818}out(c, m2_7021);
                                                    {7819}let Ksrv_7022: bitstring = exp(PartC_7016,Ns_7017) in
                                                    {7820}out(c, senc(mSrv(pkCli_6959,pkSess_6882),Ksrv_7022))
                                        )
                                        else
                                            {7821}let pkDisco_7023: bitstring = fail-any in
                                            {7822}in(c, (=pkCli_6959,em1_7024: bitstring));
                                            {7823}let m1_7025: bitstring = em1_7024 in
                                            {7824}let (=OpenSecureChannelRequest,=pkCli_6959,PartC_7026: bitstring) = m1_7025 in
                                            {7825}new Ns_7027: bitstring;
                                            {7826}new ST_7028: bitstring;
                                            {7827}new TTL_7029: bitstring;
                                            {7828}let gNs_7030: bitstring = exp(g,Ns_7027) in
                                            {7829}let m2_7031: bitstring = (OpenSecureChannelResponse,gNs_7030,ST_7028,TTL_7029) in
                                            {7830}out(c, m2_7031);
                                            {7831}let Ksrv_7032: bitstring = exp(PartC_7026,Ns_7027) in
                                            {7832}out(c, senc(mSrv(pkCli_6959,pkSess_6882),Ksrv_7032))
                                    )
                                    else
                                        {7833}let v_7033: bool = (Cli_5313 = C) in
                                        (
                                            {7834}if v_7033 then
                                            (
                                                {7835}let pkCli_7034: bitstring = pub(skC) in
                                                {7836}let v_7035: bool = (Disco_5314 = A) in
                                                (
                                                    {7837}if v_7035 then
                                                    (
                                                        {7838}let pkDisco_7036: bitstring = pub(skA) in
                                                        {7839}in(c, (=pkCli_7034,em1_7037: bitstring));
                                                        {7840}let m1_7038: bitstring = em1_7037 in
                                                        {7841}let (=OpenSecureChannelRequest,=pkCli_7034,PartC_7039: bitstring) = m1_7038 in
                                                        {7842}new Ns_7040: bitstring;
                                                        {7843}new ST_7041: bitstring;
                                                        {7844}new TTL_7042: bitstring;
                                                        {7845}let gNs_7043: bitstring = exp(g,Ns_7040) in
                                                        {7846}let m2_7044: bitstring = (OpenSecureChannelResponse,gNs_7043,ST_7041,TTL_7042) in
                                                        {7847}out(c, m2_7044);
                                                        {7848}let Ksrv_7045: bitstring = exp(PartC_7039,Ns_7040) in
                                                        {7849}out(c, senc(mSrv(pkCli_7034,pkSess_6882),Ksrv_7045))
                                                    )
                                                    else
                                                        {7850}let v_7046: bool = (Disco_5314 = B) in
                                                        (
                                                            {7851}if v_7046 then
                                                            (
                                                                {7852}let pkDisco_7047: bitstring = pub(skB) in
                                                                {7853}in(c, (=pkCli_7034,em1_7048: bitstring));
                                                                {7854}let m1_7049: bitstring = em1_7048 in
                                                                {7855}let (=OpenSecureChannelRequest,=pkCli_7034,PartC_7050: bitstring) = m1_7049 in
                                                                {7856}new Ns_7051: bitstring;
                                                                {7857}new ST_7052: bitstring;
                                                                {7858}new TTL_7053: bitstring;
                                                                {7859}let gNs_7054: bitstring = exp(g,Ns_7051) in
                                                                {7860}let m2_7055: bitstring = (OpenSecureChannelResponse,gNs_7054,ST_7052,TTL_7053) in
                                                                {7861}out(c, m2_7055);
                                                                {7862}let Ksrv_7056: bitstring = exp(PartC_7050,Ns_7051) in
                                                                {7863}out(c, senc(mSrv(pkCli_7034,pkSess_6882),Ksrv_7056))
                                                            )
                                                            else
                                                                {7864}let v_7057: bool = (Disco_5314 = C) in
                                                                (
                                                                    {7865}if v_7057 then
                                                                    (
                                                                        {7866}let pkDisco_7058: bitstring = pub(skC) in
                                                                        {7867}in(c, (=pkCli_7034,em1_7059: bitstring));
                                                                        {7868}let m1_7060: bitstring = em1_7059 in
                                                                        {7869}let (=OpenSecureChannelRequest,=pkCli_7034,PartC_7061: bitstring) = m1_7060 in
                                                                        {7870}new Ns_7062: bitstring;
                                                                        {7871}new ST_7063: bitstring;
                                                                        {7872}new TTL_7064: bitstring;
                                                                        {7873}let gNs_7065: bitstring = exp(g,Ns_7062) in
                                                                        {7874}let m2_7066: bitstring = (OpenSecureChannelResponse,gNs_7065,ST_7063,TTL_7064) in
                                                                        {7875}out(c, m2_7066);
                                                                        {7876}let Ksrv_7067: bitstring = exp(PartC_7061,Ns_7062) in
                                                                        {7877}out(c, senc(mSrv(pkCli_7034,pkSess_6882),Ksrv_7067))
                                                                    )
                                                                    else
                                                                        {7878}let pkDisco_7068: bitstring = pub(sk(Disco_5314)) in
                                                                        {7879}in(c, (=pkCli_7034,em1_7069: bitstring));
                                                                        {7880}let m1_7070: bitstring = em1_7069 in
                                                                        {7881}let (=OpenSecureChannelRequest,=pkCli_7034,PartC_7071: bitstring) = m1_7070 in
                                                                        {7882}new Ns_7072: bitstring;
                                                                        {7883}new ST_7073: bitstring;
                                                                        {7884}new TTL_7074: bitstring;
                                                                        {7885}let gNs_7075: bitstring = exp(g,Ns_7072) in
                                                                        {7886}let m2_7076: bitstring = (OpenSecureChannelResponse,gNs_7075,ST_7073,TTL_7074) in
                                                                        {7887}out(c, m2_7076);
                                                                        {7888}let Ksrv_7077: bitstring = exp(PartC_7071,Ns_7072) in
                                                                        {7889}out(c, senc(mSrv(pkCli_7034,pkSess_6882),Ksrv_7077))
                                                                )
                                                                else
                                                                    {7890}let pkDisco_7078: bitstring = fail-any in
                                                                    {7891}in(c, (=pkCli_7034,em1_7079: bitstring));
                                                                    {7892}let m1_7080: bitstring = em1_7079 in
                                                                    {7893}let (=OpenSecureChannelRequest,=pkCli_7034,PartC_7081: bitstring) = m1_7080 in
                                                                    {7894}new Ns_7082: bitstring;
                                                                    {7895}new ST_7083: bitstring;
                                                                    {7896}new TTL_7084: bitstring;
                                                                    {7897}let gNs_7085: bitstring = exp(g,Ns_7082) in
                                                                    {7898}let m2_7086: bitstring = (OpenSecureChannelResponse,gNs_7085,ST_7083,TTL_7084) in
                                                                    {7899}out(c, m2_7086);
                                                                    {7900}let Ksrv_7087: bitstring = exp(PartC_7081,Ns_7082) in
                                                                    {7901}out(c, senc(mSrv(pkCli_7034,pkSess_6882),Ksrv_7087))
                                                        )
                                                        else
                                                            {7902}let pkDisco_7088: bitstring = fail-any in
                                                            {7903}in(c, (=pkCli_7034,em1_7089: bitstring));
                                                            {7904}let m1_7090: bitstring = em1_7089 in
                                                            {7905}let (=OpenSecureChannelRequest,=pkCli_7034,PartC_7091: bitstring) = m1_7090 in
                                                            {7906}new Ns_7092: bitstring;
                                                            {7907}new ST_7093: bitstring;
                                                            {7908}new TTL_7094: bitstring;
                                                            {7909}let gNs_7095: bitstring = exp(g,Ns_7092) in
                                                            {7910}let m2_7096: bitstring = (OpenSecureChannelResponse,gNs_7095,ST_7093,TTL_7094) in
                                                            {7911}out(c, m2_7096);
                                                            {7912}let Ksrv_7097: bitstring = exp(PartC_7091,Ns_7092) in
                                                            {7913}out(c, senc(mSrv(pkCli_7034,pkSess_6882),Ksrv_7097))
                                                )
                                                else
                                                    {7914}let pkDisco_7098: bitstring = fail-any in
                                                    {7915}in(c, (=pkCli_7034,em1_7099: bitstring));
                                                    {7916}let m1_7100: bitstring = em1_7099 in
                                                    {7917}let (=OpenSecureChannelRequest,=pkCli_7034,PartC_7101: bitstring) = m1_7100 in
                                                    {7918}new Ns_7102: bitstring;
                                                    {7919}new ST_7103: bitstring;
                                                    {7920}new TTL_7104: bitstring;
                                                    {7921}let gNs_7105: bitstring = exp(g,Ns_7102) in
                                                    {7922}let m2_7106: bitstring = (OpenSecureChannelResponse,gNs_7105,ST_7103,TTL_7104) in
                                                    {7923}out(c, m2_7106);
                                                    {7924}let Ksrv_7107: bitstring = exp(PartC_7101,Ns_7102) in
                                                    {7925}out(c, senc(mSrv(pkCli_7034,pkSess_6882),Ksrv_7107))
                                            )
                                            else
                                                {7926}let pkCli_7108: bitstring = pub(sk(Cli_5313)) in
                                                {7927}let v_7109: bool = (Disco_5314 = A) in
                                                (
                                                    {7928}if v_7109 then
                                                    (
                                                        {7929}let pkDisco_7110: bitstring = pub(skA) in
                                                        {7930}in(c, (=pkCli_7108,em1_7111: bitstring));
                                                        {7931}let m1_7112: bitstring = em1_7111 in
                                                        {7932}let (=OpenSecureChannelRequest,=pkCli_7108,PartC_7113: bitstring) = m1_7112 in
                                                        {7933}new Ns_7114: bitstring;
                                                        {7934}new ST_7115: bitstring;
                                                        {7935}new TTL_7116: bitstring;
                                                        {7936}let gNs_7117: bitstring = exp(g,Ns_7114) in
                                                        {7937}let m2_7118: bitstring = (OpenSecureChannelResponse,gNs_7117,ST_7115,TTL_7116) in
                                                        {7938}out(c, m2_7118);
                                                        {7939}let Ksrv_7119: bitstring = exp(PartC_7113,Ns_7114) in
                                                        {7940}out(c, senc(mSrv(pkCli_7108,pkSess_6882),Ksrv_7119))
                                                    )
                                                    else
                                                        {7941}let v_7120: bool = (Disco_5314 = B) in
                                                        (
                                                            {7942}if v_7120 then
                                                            (
                                                                {7943}let pkDisco_7121: bitstring = pub(skB) in
                                                                {7944}in(c, (=pkCli_7108,em1_7122: bitstring));
                                                                {7945}let m1_7123: bitstring = em1_7122 in
                                                                {7946}let (=OpenSecureChannelRequest,=pkCli_7108,PartC_7124: bitstring) = m1_7123 in
                                                                {7947}new Ns_7125: bitstring;
                                                                {7948}new ST_7126: bitstring;
                                                                {7949}new TTL_7127: bitstring;
                                                                {7950}let gNs_7128: bitstring = exp(g,Ns_7125) in
                                                                {7951}let m2_7129: bitstring = (OpenSecureChannelResponse,gNs_7128,ST_7126,TTL_7127) in
                                                                {7952}out(c, m2_7129);
                                                                {7953}let Ksrv_7130: bitstring = exp(PartC_7124,Ns_7125) in
                                                                {7954}out(c, senc(mSrv(pkCli_7108,pkSess_6882),Ksrv_7130))
                                                            )
                                                            else
                                                                {7955}let v_7131: bool = (Disco_5314 = C) in
                                                                (
                                                                    {7956}if v_7131 then
                                                                    (
                                                                        {7957}let pkDisco_7132: bitstring = pub(skC) in
                                                                        {7958}in(c, (=pkCli_7108,em1_7133: bitstring));
                                                                        {7959}let m1_7134: bitstring = em1_7133 in
                                                                        {7960}let (=OpenSecureChannelRequest,=pkCli_7108,PartC_7135: bitstring) = m1_7134 in
                                                                        {7961}new Ns_7136: bitstring;
                                                                        {7962}new ST_7137: bitstring;
                                                                        {7963}new TTL_7138: bitstring;
                                                                        {7964}let gNs_7139: bitstring = exp(g,Ns_7136) in
                                                                        {7965}let m2_7140: bitstring = (OpenSecureChannelResponse,gNs_7139,ST_7137,TTL_7138) in
                                                                        {7966}out(c, m2_7140);
                                                                        {7967}let Ksrv_7141: bitstring = exp(PartC_7135,Ns_7136) in
                                                                        {7968}out(c, senc(mSrv(pkCli_7108,pkSess_6882),Ksrv_7141))
                                                                    )
                                                                    else
                                                                        {7969}let pkDisco_7142: bitstring = pub(sk(Disco_5314)) in
                                                                        {7970}in(c, (=pkCli_7108,em1_7143: bitstring));
                                                                        {7971}let m1_7144: bitstring = em1_7143 in
                                                                        {7972}let (=OpenSecureChannelRequest,=pkCli_7108,PartC_7145: bitstring) = m1_7144 in
                                                                        {7973}new Ns_7146: bitstring;
                                                                        {7974}new ST_7147: bitstring;
                                                                        {7975}new TTL_7148: bitstring;
                                                                        {7976}let gNs_7149: bitstring = exp(g,Ns_7146) in
                                                                        {7977}let m2_7150: bitstring = (OpenSecureChannelResponse,gNs_7149,ST_7147,TTL_7148) in
                                                                        {7978}out(c, m2_7150);
                                                                        {7979}let Ksrv_7151: bitstring = exp(PartC_7145,Ns_7146) in
                                                                        {7980}out(c, senc(mSrv(pkCli_7108,pkSess_6882),Ksrv_7151))
                                                                )
                                                                else
                                                                    {7981}let pkDisco_7152: bitstring = fail-any in
                                                                    {7982}in(c, (=pkCli_7108,em1_7153: bitstring));
                                                                    {7983}let m1_7154: bitstring = em1_7153 in
                                                                    {7984}let (=OpenSecureChannelRequest,=pkCli_7108,PartC_7155: bitstring) = m1_7154 in
                                                                    {7985}new Ns_7156: bitstring;
                                                                    {7986}new ST_7157: bitstring;
                                                                    {7987}new TTL_7158: bitstring;
                                                                    {7988}let gNs_7159: bitstring = exp(g,Ns_7156) in
                                                                    {7989}let m2_7160: bitstring = (OpenSecureChannelResponse,gNs_7159,ST_7157,TTL_7158) in
                                                                    {7990}out(c, m2_7160);
                                                                    {7991}let Ksrv_7161: bitstring = exp(PartC_7155,Ns_7156) in
                                                                    {7992}out(c, senc(mSrv(pkCli_7108,pkSess_6882),Ksrv_7161))
                                                        )
                                                        else
                                                            {7993}let pkDisco_7162: bitstring = fail-any in
                                                            {7994}in(c, (=pkCli_7108,em1_7163: bitstring));
                                                            {7995}let m1_7164: bitstring = em1_7163 in
                                                            {7996}let (=OpenSecureChannelRequest,=pkCli_7108,PartC_7165: bitstring) = m1_7164 in
                                                            {7997}new Ns_7166: bitstring;
                                                            {7998}new ST_7167: bitstring;
                                                            {7999}new TTL_7168: bitstring;
                                                            {8000}let gNs_7169: bitstring = exp(g,Ns_7166) in
                                                            {8001}let m2_7170: bitstring = (OpenSecureChannelResponse,gNs_7169,ST_7167,TTL_7168) in
                                                            {8002}out(c, m2_7170);
                                                            {8003}let Ksrv_7171: bitstring = exp(PartC_7165,Ns_7166) in
                                                            {8004}out(c, senc(mSrv(pkCli_7108,pkSess_6882),Ksrv_7171))
                                                )
                                                else
                                                    {8005}let pkDisco_7172: bitstring = fail-any in
                                                    {8006}in(c, (=pkCli_7108,em1_7173: bitstring));
                                                    {8007}let m1_7174: bitstring = em1_7173 in
                                                    {8008}let (=OpenSecureChannelRequest,=pkCli_7108,PartC_7175: bitstring) = m1_7174 in
                                                    {8009}new Ns_7176: bitstring;
                                                    {8010}new ST_7177: bitstring;
                                                    {8011}new TTL_7178: bitstring;
                                                    {8012}let gNs_7179: bitstring = exp(g,Ns_7176) in
                                                    {8013}let m2_7180: bitstring = (OpenSecureChannelResponse,gNs_7179,ST_7177,TTL_7178) in
                                                    {8014}out(c, m2_7180);
                                                    {8015}let Ksrv_7181: bitstring = exp(PartC_7175,Ns_7176) in
                                                    {8016}out(c, senc(mSrv(pkCli_7108,pkSess_6882),Ksrv_7181))
                                        )
                                        else
                                            {8017}let pkCli_7182: bitstring = fail-any in
                                            {8018}let v_7183: bool = (Disco_5314 = A) in
                                            (
                                                {8019}if v_7183 then
                                                (
                                                    {8020}let pkDisco_7184: bitstring = pub(skA) in
                                                    {8021}in(c, (=pkCli_7182,em1_7185: bitstring));
                                                    {8022}let m1_7186: bitstring = em1_7185 in
                                                    {8023}let (=OpenSecureChannelRequest,=pkCli_7182,PartC_7187: bitstring) = m1_7186 in
                                                    {8024}new Ns_7188: bitstring;
                                                    {8025}new ST_7189: bitstring;
                                                    {8026}new TTL_7190: bitstring;
                                                    {8027}let gNs_7191: bitstring = exp(g,Ns_7188) in
                                                    {8028}let m2_7192: bitstring = (OpenSecureChannelResponse,gNs_7191,ST_7189,TTL_7190) in
                                                    {8029}out(c, m2_7192);
                                                    {8030}let Ksrv_7193: bitstring = exp(PartC_7187,Ns_7188) in
                                                    {8031}out(c, senc(mSrv(pkCli_7182,pkSess_6882),Ksrv_7193))
                                                )
                                                else
                                                    {8032}let v_7194: bool = (Disco_5314 = B) in
                                                    (
                                                        {8033}if v_7194 then
                                                        (
                                                            {8034}let pkDisco_7195: bitstring = pub(skB) in
                                                            {8035}in(c, (=pkCli_7182,em1_7196: bitstring));
                                                            {8036}let m1_7197: bitstring = em1_7196 in
                                                            {8037}let (=OpenSecureChannelRequest,=pkCli_7182,PartC_7198: bitstring) = m1_7197 in
                                                            {8038}new Ns_7199: bitstring;
                                                            {8039}new ST_7200: bitstring;
                                                            {8040}new TTL_7201: bitstring;
                                                            {8041}let gNs_7202: bitstring = exp(g,Ns_7199) in
                                                            {8042}let m2_7203: bitstring = (OpenSecureChannelResponse,gNs_7202,ST_7200,TTL_7201) in
                                                            {8043}out(c, m2_7203);
                                                            {8044}let Ksrv_7204: bitstring = exp(PartC_7198,Ns_7199) in
                                                            {8045}out(c, senc(mSrv(pkCli_7182,pkSess_6882),Ksrv_7204))
                                                        )
                                                        else
                                                            {8046}let v_7205: bool = (Disco_5314 = C) in
                                                            (
                                                                {8047}if v_7205 then
                                                                (
                                                                    {8048}let pkDisco_7206: bitstring = pub(skC) in
                                                                    {8049}in(c, (=pkCli_7182,em1_7207: bitstring));
                                                                    {8050}let m1_7208: bitstring = em1_7207 in
                                                                    {8051}let (=OpenSecureChannelRequest,=pkCli_7182,PartC_7209: bitstring) = m1_7208 in
                                                                    {8052}new Ns_7210: bitstring;
                                                                    {8053}new ST_7211: bitstring;
                                                                    {8054}new TTL_7212: bitstring;
                                                                    {8055}let gNs_7213: bitstring = exp(g,Ns_7210) in
                                                                    {8056}let m2_7214: bitstring = (OpenSecureChannelResponse,gNs_7213,ST_7211,TTL_7212) in
                                                                    {8057}out(c, m2_7214);
                                                                    {8058}let Ksrv_7215: bitstring = exp(PartC_7209,Ns_7210) in
                                                                    {8059}out(c, senc(mSrv(pkCli_7182,pkSess_6882),Ksrv_7215))
                                                                )
                                                                else
                                                                    {8060}let pkDisco_7216: bitstring = pub(sk(Disco_5314)) in
                                                                    {8061}in(c, (=pkCli_7182,em1_7217: bitstring));
                                                                    {8062}let m1_7218: bitstring = em1_7217 in
                                                                    {8063}let (=OpenSecureChannelRequest,=pkCli_7182,PartC_7219: bitstring) = m1_7218 in
                                                                    {8064}new Ns_7220: bitstring;
                                                                    {8065}new ST_7221: bitstring;
                                                                    {8066}new TTL_7222: bitstring;
                                                                    {8067}let gNs_7223: bitstring = exp(g,Ns_7220) in
                                                                    {8068}let m2_7224: bitstring = (OpenSecureChannelResponse,gNs_7223,ST_7221,TTL_7222) in
                                                                    {8069}out(c, m2_7224);
                                                                    {8070}let Ksrv_7225: bitstring = exp(PartC_7219,Ns_7220) in
                                                                    {8071}out(c, senc(mSrv(pkCli_7182,pkSess_6882),Ksrv_7225))
                                                            )
                                                            else
                                                                {8072}let pkDisco_7226: bitstring = fail-any in
                                                                {8073}in(c, (=pkCli_7182,em1_7227: bitstring));
                                                                {8074}let m1_7228: bitstring = em1_7227 in
                                                                {8075}let (=OpenSecureChannelRequest,=pkCli_7182,PartC_7229: bitstring) = m1_7228 in
                                                                {8076}new Ns_7230: bitstring;
                                                                {8077}new ST_7231: bitstring;
                                                                {8078}new TTL_7232: bitstring;
                                                                {8079}let gNs_7233: bitstring = exp(g,Ns_7230) in
                                                                {8080}let m2_7234: bitstring = (OpenSecureChannelResponse,gNs_7233,ST_7231,TTL_7232) in
                                                                {8081}out(c, m2_7234);
                                                                {8082}let Ksrv_7235: bitstring = exp(PartC_7229,Ns_7230) in
                                                                {8083}out(c, senc(mSrv(pkCli_7182,pkSess_6882),Ksrv_7235))
                                                    )
                                                    else
                                                        {8084}let pkDisco_7236: bitstring = fail-any in
                                                        {8085}in(c, (=pkCli_7182,em1_7237: bitstring));
                                                        {8086}let m1_7238: bitstring = em1_7237 in
                                                        {8087}let (=OpenSecureChannelRequest,=pkCli_7182,PartC_7239: bitstring) = m1_7238 in
                                                        {8088}new Ns_7240: bitstring;
                                                        {8089}new ST_7241: bitstring;
                                                        {8090}new TTL_7242: bitstring;
                                                        {8091}let gNs_7243: bitstring = exp(g,Ns_7240) in
                                                        {8092}let m2_7244: bitstring = (OpenSecureChannelResponse,gNs_7243,ST_7241,TTL_7242) in
                                                        {8093}out(c, m2_7244);
                                                        {8094}let Ksrv_7245: bitstring = exp(PartC_7239,Ns_7240) in
                                                        {8095}out(c, senc(mSrv(pkCli_7182,pkSess_6882),Ksrv_7245))
                                            )
                                            else
                                                {8096}let pkDisco_7246: bitstring = fail-any in
                                                {8097}in(c, (=pkCli_7182,em1_7247: bitstring));
                                                {8098}let m1_7248: bitstring = em1_7247 in
                                                {8099}let (=OpenSecureChannelRequest,=pkCli_7182,PartC_7249: bitstring) = m1_7248 in
                                                {8100}new Ns_7250: bitstring;
                                                {8101}new ST_7251: bitstring;
                                                {8102}new TTL_7252: bitstring;
                                                {8103}let gNs_7253: bitstring = exp(g,Ns_7250) in
                                                {8104}let m2_7254: bitstring = (OpenSecureChannelResponse,gNs_7253,ST_7251,TTL_7252) in
                                                {8105}out(c, m2_7254);
                                                {8106}let Ksrv_7255: bitstring = exp(PartC_7249,Ns_7250) in
                                                {8107}out(c, senc(mSrv(pkCli_7182,pkSess_6882),Ksrv_7255))
                                )
                                else
                                    {8108}let pkCli_7256: bitstring = fail-any in
                                    {8109}let v_7257: bool = (Disco_5314 = A) in
                                    (
                                        {8110}if v_7257 then
                                        (
                                            {8111}let pkDisco_7258: bitstring = pub(skA) in
                                            {8112}in(c, (=pkCli_7256,em1_7259: bitstring));
                                            {8113}let m1_7260: bitstring = em1_7259 in
                                            {8114}let (=OpenSecureChannelRequest,=pkCli_7256,PartC_7261: bitstring) = m1_7260 in
                                            {8115}new Ns_7262: bitstring;
                                            {8116}new ST_7263: bitstring;
                                            {8117}new TTL_7264: bitstring;
                                            {8118}let gNs_7265: bitstring = exp(g,Ns_7262) in
                                            {8119}let m2_7266: bitstring = (OpenSecureChannelResponse,gNs_7265,ST_7263,TTL_7264) in
                                            {8120}out(c, m2_7266);
                                            {8121}let Ksrv_7267: bitstring = exp(PartC_7261,Ns_7262) in
                                            {8122}out(c, senc(mSrv(pkCli_7256,pkSess_6882),Ksrv_7267))
                                        )
                                        else
                                            {8123}let v_7268: bool = (Disco_5314 = B) in
                                            (
                                                {8124}if v_7268 then
                                                (
                                                    {8125}let pkDisco_7269: bitstring = pub(skB) in
                                                    {8126}in(c, (=pkCli_7256,em1_7270: bitstring));
                                                    {8127}let m1_7271: bitstring = em1_7270 in
                                                    {8128}let (=OpenSecureChannelRequest,=pkCli_7256,PartC_7272: bitstring) = m1_7271 in
                                                    {8129}new Ns_7273: bitstring;
                                                    {8130}new ST_7274: bitstring;
                                                    {8131}new TTL_7275: bitstring;
                                                    {8132}let gNs_7276: bitstring = exp(g,Ns_7273) in
                                                    {8133}let m2_7277: bitstring = (OpenSecureChannelResponse,gNs_7276,ST_7274,TTL_7275) in
                                                    {8134}out(c, m2_7277);
                                                    {8135}let Ksrv_7278: bitstring = exp(PartC_7272,Ns_7273) in
                                                    {8136}out(c, senc(mSrv(pkCli_7256,pkSess_6882),Ksrv_7278))
                                                )
                                                else
                                                    {8137}let v_7279: bool = (Disco_5314 = C) in
                                                    (
                                                        {8138}if v_7279 then
                                                        (
                                                            {8139}let pkDisco_7280: bitstring = pub(skC) in
                                                            {8140}in(c, (=pkCli_7256,em1_7281: bitstring));
                                                            {8141}let m1_7282: bitstring = em1_7281 in
                                                            {8142}let (=OpenSecureChannelRequest,=pkCli_7256,PartC_7283: bitstring) = m1_7282 in
                                                            {8143}new Ns_7284: bitstring;
                                                            {8144}new ST_7285: bitstring;
                                                            {8145}new TTL_7286: bitstring;
                                                            {8146}let gNs_7287: bitstring = exp(g,Ns_7284) in
                                                            {8147}let m2_7288: bitstring = (OpenSecureChannelResponse,gNs_7287,ST_7285,TTL_7286) in
                                                            {8148}out(c, m2_7288);
                                                            {8149}let Ksrv_7289: bitstring = exp(PartC_7283,Ns_7284) in
                                                            {8150}out(c, senc(mSrv(pkCli_7256,pkSess_6882),Ksrv_7289))
                                                        )
                                                        else
                                                            {8151}let pkDisco_7290: bitstring = pub(sk(Disco_5314)) in
                                                            {8152}in(c, (=pkCli_7256,em1_7291: bitstring));
                                                            {8153}let m1_7292: bitstring = em1_7291 in
                                                            {8154}let (=OpenSecureChannelRequest,=pkCli_7256,PartC_7293: bitstring) = m1_7292 in
                                                            {8155}new Ns_7294: bitstring;
                                                            {8156}new ST_7295: bitstring;
                                                            {8157}new TTL_7296: bitstring;
                                                            {8158}let gNs_7297: bitstring = exp(g,Ns_7294) in
                                                            {8159}let m2_7298: bitstring = (OpenSecureChannelResponse,gNs_7297,ST_7295,TTL_7296) in
                                                            {8160}out(c, m2_7298);
                                                            {8161}let Ksrv_7299: bitstring = exp(PartC_7293,Ns_7294) in
                                                            {8162}out(c, senc(mSrv(pkCli_7256,pkSess_6882),Ksrv_7299))
                                                    )
                                                    else
                                                        {8163}let pkDisco_7300: bitstring = fail-any in
                                                        {8164}in(c, (=pkCli_7256,em1_7301: bitstring));
                                                        {8165}let m1_7302: bitstring = em1_7301 in
                                                        {8166}let (=OpenSecureChannelRequest,=pkCli_7256,PartC_7303: bitstring) = m1_7302 in
                                                        {8167}new Ns_7304: bitstring;
                                                        {8168}new ST_7305: bitstring;
                                                        {8169}new TTL_7306: bitstring;
                                                        {8170}let gNs_7307: bitstring = exp(g,Ns_7304) in
                                                        {8171}let m2_7308: bitstring = (OpenSecureChannelResponse,gNs_7307,ST_7305,TTL_7306) in
                                                        {8172}out(c, m2_7308);
                                                        {8173}let Ksrv_7309: bitstring = exp(PartC_7303,Ns_7304) in
                                                        {8174}out(c, senc(mSrv(pkCli_7256,pkSess_6882),Ksrv_7309))
                                            )
                                            else
                                                {8175}let pkDisco_7310: bitstring = fail-any in
                                                {8176}in(c, (=pkCli_7256,em1_7311: bitstring));
                                                {8177}let m1_7312: bitstring = em1_7311 in
                                                {8178}let (=OpenSecureChannelRequest,=pkCli_7256,PartC_7313: bitstring) = m1_7312 in
                                                {8179}new Ns_7314: bitstring;
                                                {8180}new ST_7315: bitstring;
                                                {8181}new TTL_7316: bitstring;
                                                {8182}let gNs_7317: bitstring = exp(g,Ns_7314) in
                                                {8183}let m2_7318: bitstring = (OpenSecureChannelResponse,gNs_7317,ST_7315,TTL_7316) in
                                                {8184}out(c, m2_7318);
                                                {8185}let Ksrv_7319: bitstring = exp(PartC_7313,Ns_7314) in
                                                {8186}out(c, senc(mSrv(pkCli_7256,pkSess_6882),Ksrv_7319))
                                    )
                                    else
                                        {8187}let pkDisco_7320: bitstring = fail-any in
                                        {8188}in(c, (=pkCli_7256,em1_7321: bitstring));
                                        {8189}let m1_7322: bitstring = em1_7321 in
                                        {8190}let (=OpenSecureChannelRequest,=pkCli_7256,PartC_7323: bitstring) = m1_7322 in
                                        {8191}new Ns_7324: bitstring;
                                        {8192}new ST_7325: bitstring;
                                        {8193}new TTL_7326: bitstring;
                                        {8194}let gNs_7327: bitstring = exp(g,Ns_7324) in
                                        {8195}let m2_7328: bitstring = (OpenSecureChannelResponse,gNs_7327,ST_7325,TTL_7326) in
                                        {8196}out(c, m2_7328);
                                        {8197}let Ksrv_7329: bitstring = exp(PartC_7323,Ns_7324) in
                                        {8198}out(c, senc(mSrv(pkCli_7256,pkSess_6882),Ksrv_7329))
                        )
                        else
                            {8199}let pkCli_7330: bitstring = fail-any in
                            {8200}let v_7331: bool = (Disco_5314 = A) in
                            (
                                {8201}if v_7331 then
                                (
                                    {8202}let pkDisco_7332: bitstring = pub(skA) in
                                    {8203}in(c, (=pkCli_7330,em1_7333: bitstring));
                                    {8204}let m1_7334: bitstring = em1_7333 in
                                    {8205}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7335: bitstring) = m1_7334 in
                                    {8206}new Ns_7336: bitstring;
                                    {8207}new ST_7337: bitstring;
                                    {8208}new TTL_7338: bitstring;
                                    {8209}let gNs_7339: bitstring = exp(g,Ns_7336) in
                                    {8210}let m2_7340: bitstring = (OpenSecureChannelResponse,gNs_7339,ST_7337,TTL_7338) in
                                    {8211}out(c, m2_7340);
                                    {8212}let Ksrv_7341: bitstring = exp(PartC_7335,Ns_7336) in
                                    {8213}out(c, senc(mSrv(pkCli_7330,pkSess_6882),Ksrv_7341))
                                )
                                else
                                    {8214}let v_7342: bool = (Disco_5314 = B) in
                                    (
                                        {8215}if v_7342 then
                                        (
                                            {8216}let pkDisco_7343: bitstring = pub(skB) in
                                            {8217}in(c, (=pkCli_7330,em1_7344: bitstring));
                                            {8218}let m1_7345: bitstring = em1_7344 in
                                            {8219}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7346: bitstring) = m1_7345 in
                                            {8220}new Ns_7347: bitstring;
                                            {8221}new ST_7348: bitstring;
                                            {8222}new TTL_7349: bitstring;
                                            {8223}let gNs_7350: bitstring = exp(g,Ns_7347) in
                                            {8224}let m2_7351: bitstring = (OpenSecureChannelResponse,gNs_7350,ST_7348,TTL_7349) in
                                            {8225}out(c, m2_7351);
                                            {8226}let Ksrv_7352: bitstring = exp(PartC_7346,Ns_7347) in
                                            {8227}out(c, senc(mSrv(pkCli_7330,pkSess_6882),Ksrv_7352))
                                        )
                                        else
                                            {8228}let v_7353: bool = (Disco_5314 = C) in
                                            (
                                                {8229}if v_7353 then
                                                (
                                                    {8230}let pkDisco_7354: bitstring = pub(skC) in
                                                    {8231}in(c, (=pkCli_7330,em1_7355: bitstring));
                                                    {8232}let m1_7356: bitstring = em1_7355 in
                                                    {8233}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7357: bitstring) = m1_7356 in
                                                    {8234}new Ns_7358: bitstring;
                                                    {8235}new ST_7359: bitstring;
                                                    {8236}new TTL_7360: bitstring;
                                                    {8237}let gNs_7361: bitstring = exp(g,Ns_7358) in
                                                    {8238}let m2_7362: bitstring = (OpenSecureChannelResponse,gNs_7361,ST_7359,TTL_7360) in
                                                    {8239}out(c, m2_7362);
                                                    {8240}let Ksrv_7363: bitstring = exp(PartC_7357,Ns_7358) in
                                                    {8241}out(c, senc(mSrv(pkCli_7330,pkSess_6882),Ksrv_7363))
                                                )
                                                else
                                                    {8242}let pkDisco_7364: bitstring = pub(sk(Disco_5314)) in
                                                    {8243}in(c, (=pkCli_7330,em1_7365: bitstring));
                                                    {8244}let m1_7366: bitstring = em1_7365 in
                                                    {8245}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7367: bitstring) = m1_7366 in
                                                    {8246}new Ns_7368: bitstring;
                                                    {8247}new ST_7369: bitstring;
                                                    {8248}new TTL_7370: bitstring;
                                                    {8249}let gNs_7371: bitstring = exp(g,Ns_7368) in
                                                    {8250}let m2_7372: bitstring = (OpenSecureChannelResponse,gNs_7371,ST_7369,TTL_7370) in
                                                    {8251}out(c, m2_7372);
                                                    {8252}let Ksrv_7373: bitstring = exp(PartC_7367,Ns_7368) in
                                                    {8253}out(c, senc(mSrv(pkCli_7330,pkSess_6882),Ksrv_7373))
                                            )
                                            else
                                                {8254}let pkDisco_7374: bitstring = fail-any in
                                                {8255}in(c, (=pkCli_7330,em1_7375: bitstring));
                                                {8256}let m1_7376: bitstring = em1_7375 in
                                                {8257}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7377: bitstring) = m1_7376 in
                                                {8258}new Ns_7378: bitstring;
                                                {8259}new ST_7379: bitstring;
                                                {8260}new TTL_7380: bitstring;
                                                {8261}let gNs_7381: bitstring = exp(g,Ns_7378) in
                                                {8262}let m2_7382: bitstring = (OpenSecureChannelResponse,gNs_7381,ST_7379,TTL_7380) in
                                                {8263}out(c, m2_7382);
                                                {8264}let Ksrv_7383: bitstring = exp(PartC_7377,Ns_7378) in
                                                {8265}out(c, senc(mSrv(pkCli_7330,pkSess_6882),Ksrv_7383))
                                    )
                                    else
                                        {8266}let pkDisco_7384: bitstring = fail-any in
                                        {8267}in(c, (=pkCli_7330,em1_7385: bitstring));
                                        {8268}let m1_7386: bitstring = em1_7385 in
                                        {8269}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7387: bitstring) = m1_7386 in
                                        {8270}new Ns_7388: bitstring;
                                        {8271}new ST_7389: bitstring;
                                        {8272}new TTL_7390: bitstring;
                                        {8273}let gNs_7391: bitstring = exp(g,Ns_7388) in
                                        {8274}let m2_7392: bitstring = (OpenSecureChannelResponse,gNs_7391,ST_7389,TTL_7390) in
                                        {8275}out(c, m2_7392);
                                        {8276}let Ksrv_7393: bitstring = exp(PartC_7387,Ns_7388) in
                                        {8277}out(c, senc(mSrv(pkCli_7330,pkSess_6882),Ksrv_7393))
                            )
                            else
                                {8278}let pkDisco_7394: bitstring = fail-any in
                                {8279}in(c, (=pkCli_7330,em1_7395: bitstring));
                                {8280}let m1_7396: bitstring = em1_7395 in
                                {8281}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7397: bitstring) = m1_7396 in
                                {8282}new Ns_7398: bitstring;
                                {8283}new ST_7399: bitstring;
                                {8284}new TTL_7400: bitstring;
                                {8285}let gNs_7401: bitstring = exp(g,Ns_7398) in
                                {8286}let m2_7402: bitstring = (OpenSecureChannelResponse,gNs_7401,ST_7399,TTL_7400) in
                                {8287}out(c, m2_7402);
                                {8288}let Ksrv_7403: bitstring = exp(PartC_7397,Ns_7398) in
                                {8289}out(c, senc(mSrv(pkCli_7330,pkSess_6882),Ksrv_7403))
            )
            else
                {8290}let skSess_7404: bitstring = fail-any in
                {8291}let pkSess_7405: bitstring = pub(skSess_7404) in
                {8292}let v_7406: bool = (Cli_5313 = A) in
                (
                    {8293}if v_7406 then
                    (
                        {8294}let pkCli_7407: bitstring = pub(skA) in
                        {8295}let v_7408: bool = (Disco_5314 = A) in
                        (
                            {8296}if v_7408 then
                            (
                                {8297}let pkDisco_7409: bitstring = pub(skA) in
                                {8298}in(c, (=pkCli_7407,em1_7410: bitstring));
                                {8299}let m1_7411: bitstring = em1_7410 in
                                {8300}let (=OpenSecureChannelRequest,=pkCli_7407,PartC_7412: bitstring) = m1_7411 in
                                {8301}new Ns_7413: bitstring;
                                {8302}new ST_7414: bitstring;
                                {8303}new TTL_7415: bitstring;
                                {8304}let gNs_7416: bitstring = exp(g,Ns_7413) in
                                {8305}let m2_7417: bitstring = (OpenSecureChannelResponse,gNs_7416,ST_7414,TTL_7415) in
                                {8306}out(c, m2_7417);
                                {8307}let Ksrv_7418: bitstring = exp(PartC_7412,Ns_7413) in
                                {8308}out(c, senc(mSrv(pkCli_7407,pkSess_7405),Ksrv_7418))
                            )
                            else
                                {8309}let v_7419: bool = (Disco_5314 = B) in
                                (
                                    {8310}if v_7419 then
                                    (
                                        {8311}let pkDisco_7420: bitstring = pub(skB) in
                                        {8312}in(c, (=pkCli_7407,em1_7421: bitstring));
                                        {8313}let m1_7422: bitstring = em1_7421 in
                                        {8314}let (=OpenSecureChannelRequest,=pkCli_7407,PartC_7423: bitstring) = m1_7422 in
                                        {8315}new Ns_7424: bitstring;
                                        {8316}new ST_7425: bitstring;
                                        {8317}new TTL_7426: bitstring;
                                        {8318}let gNs_7427: bitstring = exp(g,Ns_7424) in
                                        {8319}let m2_7428: bitstring = (OpenSecureChannelResponse,gNs_7427,ST_7425,TTL_7426) in
                                        {8320}out(c, m2_7428);
                                        {8321}let Ksrv_7429: bitstring = exp(PartC_7423,Ns_7424) in
                                        {8322}out(c, senc(mSrv(pkCli_7407,pkSess_7405),Ksrv_7429))
                                    )
                                    else
                                        {8323}let v_7430: bool = (Disco_5314 = C) in
                                        (
                                            {8324}if v_7430 then
                                            (
                                                {8325}let pkDisco_7431: bitstring = pub(skC) in
                                                {8326}in(c, (=pkCli_7407,em1_7432: bitstring));
                                                {8327}let m1_7433: bitstring = em1_7432 in
                                                {8328}let (=OpenSecureChannelRequest,=pkCli_7407,PartC_7434: bitstring) = m1_7433 in
                                                {8329}new Ns_7435: bitstring;
                                                {8330}new ST_7436: bitstring;
                                                {8331}new TTL_7437: bitstring;
                                                {8332}let gNs_7438: bitstring = exp(g,Ns_7435) in
                                                {8333}let m2_7439: bitstring = (OpenSecureChannelResponse,gNs_7438,ST_7436,TTL_7437) in
                                                {8334}out(c, m2_7439);
                                                {8335}let Ksrv_7440: bitstring = exp(PartC_7434,Ns_7435) in
                                                {8336}out(c, senc(mSrv(pkCli_7407,pkSess_7405),Ksrv_7440))
                                            )
                                            else
                                                {8337}let pkDisco_7441: bitstring = pub(sk(Disco_5314)) in
                                                {8338}in(c, (=pkCli_7407,em1_7442: bitstring));
                                                {8339}let m1_7443: bitstring = em1_7442 in
                                                {8340}let (=OpenSecureChannelRequest,=pkCli_7407,PartC_7444: bitstring) = m1_7443 in
                                                {8341}new Ns_7445: bitstring;
                                                {8342}new ST_7446: bitstring;
                                                {8343}new TTL_7447: bitstring;
                                                {8344}let gNs_7448: bitstring = exp(g,Ns_7445) in
                                                {8345}let m2_7449: bitstring = (OpenSecureChannelResponse,gNs_7448,ST_7446,TTL_7447) in
                                                {8346}out(c, m2_7449);
                                                {8347}let Ksrv_7450: bitstring = exp(PartC_7444,Ns_7445) in
                                                {8348}out(c, senc(mSrv(pkCli_7407,pkSess_7405),Ksrv_7450))
                                        )
                                        else
                                            {8349}let pkDisco_7451: bitstring = fail-any in
                                            {8350}in(c, (=pkCli_7407,em1_7452: bitstring));
                                            {8351}let m1_7453: bitstring = em1_7452 in
                                            {8352}let (=OpenSecureChannelRequest,=pkCli_7407,PartC_7454: bitstring) = m1_7453 in
                                            {8353}new Ns_7455: bitstring;
                                            {8354}new ST_7456: bitstring;
                                            {8355}new TTL_7457: bitstring;
                                            {8356}let gNs_7458: bitstring = exp(g,Ns_7455) in
                                            {8357}let m2_7459: bitstring = (OpenSecureChannelResponse,gNs_7458,ST_7456,TTL_7457) in
                                            {8358}out(c, m2_7459);
                                            {8359}let Ksrv_7460: bitstring = exp(PartC_7454,Ns_7455) in
                                            {8360}out(c, senc(mSrv(pkCli_7407,pkSess_7405),Ksrv_7460))
                                )
                                else
                                    {8361}let pkDisco_7461: bitstring = fail-any in
                                    {8362}in(c, (=pkCli_7407,em1_7462: bitstring));
                                    {8363}let m1_7463: bitstring = em1_7462 in
                                    {8364}let (=OpenSecureChannelRequest,=pkCli_7407,PartC_7464: bitstring) = m1_7463 in
                                    {8365}new Ns_7465: bitstring;
                                    {8366}new ST_7466: bitstring;
                                    {8367}new TTL_7467: bitstring;
                                    {8368}let gNs_7468: bitstring = exp(g,Ns_7465) in
                                    {8369}let m2_7469: bitstring = (OpenSecureChannelResponse,gNs_7468,ST_7466,TTL_7467) in
                                    {8370}out(c, m2_7469);
                                    {8371}let Ksrv_7470: bitstring = exp(PartC_7464,Ns_7465) in
                                    {8372}out(c, senc(mSrv(pkCli_7407,pkSess_7405),Ksrv_7470))
                        )
                        else
                            {8373}let pkDisco_7471: bitstring = fail-any in
                            {8374}in(c, (=pkCli_7407,em1_7472: bitstring));
                            {8375}let m1_7473: bitstring = em1_7472 in
                            {8376}let (=OpenSecureChannelRequest,=pkCli_7407,PartC_7474: bitstring) = m1_7473 in
                            {8377}new Ns_7475: bitstring;
                            {8378}new ST_7476: bitstring;
                            {8379}new TTL_7477: bitstring;
                            {8380}let gNs_7478: bitstring = exp(g,Ns_7475) in
                            {8381}let m2_7479: bitstring = (OpenSecureChannelResponse,gNs_7478,ST_7476,TTL_7477) in
                            {8382}out(c, m2_7479);
                            {8383}let Ksrv_7480: bitstring = exp(PartC_7474,Ns_7475) in
                            {8384}out(c, senc(mSrv(pkCli_7407,pkSess_7405),Ksrv_7480))
                    )
                    else
                        {8385}let v_7481: bool = (Cli_5313 = B) in
                        (
                            {8386}if v_7481 then
                            (
                                {8387}let pkCli_7482: bitstring = pub(skB) in
                                {8388}let v_7483: bool = (Disco_5314 = A) in
                                (
                                    {8389}if v_7483 then
                                    (
                                        {8390}let pkDisco_7484: bitstring = pub(skA) in
                                        {8391}in(c, (=pkCli_7482,em1_7485: bitstring));
                                        {8392}let m1_7486: bitstring = em1_7485 in
                                        {8393}let (=OpenSecureChannelRequest,=pkCli_7482,PartC_7487: bitstring) = m1_7486 in
                                        {8394}new Ns_7488: bitstring;
                                        {8395}new ST_7489: bitstring;
                                        {8396}new TTL_7490: bitstring;
                                        {8397}let gNs_7491: bitstring = exp(g,Ns_7488) in
                                        {8398}let m2_7492: bitstring = (OpenSecureChannelResponse,gNs_7491,ST_7489,TTL_7490) in
                                        {8399}out(c, m2_7492);
                                        {8400}let Ksrv_7493: bitstring = exp(PartC_7487,Ns_7488) in
                                        {8401}out(c, senc(mSrv(pkCli_7482,pkSess_7405),Ksrv_7493))
                                    )
                                    else
                                        {8402}let v_7494: bool = (Disco_5314 = B) in
                                        (
                                            {8403}if v_7494 then
                                            (
                                                {8404}let pkDisco_7495: bitstring = pub(skB) in
                                                {8405}in(c, (=pkCli_7482,em1_7496: bitstring));
                                                {8406}let m1_7497: bitstring = em1_7496 in
                                                {8407}let (=OpenSecureChannelRequest,=pkCli_7482,PartC_7498: bitstring) = m1_7497 in
                                                {8408}new Ns_7499: bitstring;
                                                {8409}new ST_7500: bitstring;
                                                {8410}new TTL_7501: bitstring;
                                                {8411}let gNs_7502: bitstring = exp(g,Ns_7499) in
                                                {8412}let m2_7503: bitstring = (OpenSecureChannelResponse,gNs_7502,ST_7500,TTL_7501) in
                                                {8413}out(c, m2_7503);
                                                {8414}let Ksrv_7504: bitstring = exp(PartC_7498,Ns_7499) in
                                                {8415}out(c, senc(mSrv(pkCli_7482,pkSess_7405),Ksrv_7504))
                                            )
                                            else
                                                {8416}let v_7505: bool = (Disco_5314 = C) in
                                                (
                                                    {8417}if v_7505 then
                                                    (
                                                        {8418}let pkDisco_7506: bitstring = pub(skC) in
                                                        {8419}in(c, (=pkCli_7482,em1_7507: bitstring));
                                                        {8420}let m1_7508: bitstring = em1_7507 in
                                                        {8421}let (=OpenSecureChannelRequest,=pkCli_7482,PartC_7509: bitstring) = m1_7508 in
                                                        {8422}new Ns_7510: bitstring;
                                                        {8423}new ST_7511: bitstring;
                                                        {8424}new TTL_7512: bitstring;
                                                        {8425}let gNs_7513: bitstring = exp(g,Ns_7510) in
                                                        {8426}let m2_7514: bitstring = (OpenSecureChannelResponse,gNs_7513,ST_7511,TTL_7512) in
                                                        {8427}out(c, m2_7514);
                                                        {8428}let Ksrv_7515: bitstring = exp(PartC_7509,Ns_7510) in
                                                        {8429}out(c, senc(mSrv(pkCli_7482,pkSess_7405),Ksrv_7515))
                                                    )
                                                    else
                                                        {8430}let pkDisco_7516: bitstring = pub(sk(Disco_5314)) in
                                                        {8431}in(c, (=pkCli_7482,em1_7517: bitstring));
                                                        {8432}let m1_7518: bitstring = em1_7517 in
                                                        {8433}let (=OpenSecureChannelRequest,=pkCli_7482,PartC_7519: bitstring) = m1_7518 in
                                                        {8434}new Ns_7520: bitstring;
                                                        {8435}new ST_7521: bitstring;
                                                        {8436}new TTL_7522: bitstring;
                                                        {8437}let gNs_7523: bitstring = exp(g,Ns_7520) in
                                                        {8438}let m2_7524: bitstring = (OpenSecureChannelResponse,gNs_7523,ST_7521,TTL_7522) in
                                                        {8439}out(c, m2_7524);
                                                        {8440}let Ksrv_7525: bitstring = exp(PartC_7519,Ns_7520) in
                                                        {8441}out(c, senc(mSrv(pkCli_7482,pkSess_7405),Ksrv_7525))
                                                )
                                                else
                                                    {8442}let pkDisco_7526: bitstring = fail-any in
                                                    {8443}in(c, (=pkCli_7482,em1_7527: bitstring));
                                                    {8444}let m1_7528: bitstring = em1_7527 in
                                                    {8445}let (=OpenSecureChannelRequest,=pkCli_7482,PartC_7529: bitstring) = m1_7528 in
                                                    {8446}new Ns_7530: bitstring;
                                                    {8447}new ST_7531: bitstring;
                                                    {8448}new TTL_7532: bitstring;
                                                    {8449}let gNs_7533: bitstring = exp(g,Ns_7530) in
                                                    {8450}let m2_7534: bitstring = (OpenSecureChannelResponse,gNs_7533,ST_7531,TTL_7532) in
                                                    {8451}out(c, m2_7534);
                                                    {8452}let Ksrv_7535: bitstring = exp(PartC_7529,Ns_7530) in
                                                    {8453}out(c, senc(mSrv(pkCli_7482,pkSess_7405),Ksrv_7535))
                                        )
                                        else
                                            {8454}let pkDisco_7536: bitstring = fail-any in
                                            {8455}in(c, (=pkCli_7482,em1_7537: bitstring));
                                            {8456}let m1_7538: bitstring = em1_7537 in
                                            {8457}let (=OpenSecureChannelRequest,=pkCli_7482,PartC_7539: bitstring) = m1_7538 in
                                            {8458}new Ns_7540: bitstring;
                                            {8459}new ST_7541: bitstring;
                                            {8460}new TTL_7542: bitstring;
                                            {8461}let gNs_7543: bitstring = exp(g,Ns_7540) in
                                            {8462}let m2_7544: bitstring = (OpenSecureChannelResponse,gNs_7543,ST_7541,TTL_7542) in
                                            {8463}out(c, m2_7544);
                                            {8464}let Ksrv_7545: bitstring = exp(PartC_7539,Ns_7540) in
                                            {8465}out(c, senc(mSrv(pkCli_7482,pkSess_7405),Ksrv_7545))
                                )
                                else
                                    {8466}let pkDisco_7546: bitstring = fail-any in
                                    {8467}in(c, (=pkCli_7482,em1_7547: bitstring));
                                    {8468}let m1_7548: bitstring = em1_7547 in
                                    {8469}let (=OpenSecureChannelRequest,=pkCli_7482,PartC_7549: bitstring) = m1_7548 in
                                    {8470}new Ns_7550: bitstring;
                                    {8471}new ST_7551: bitstring;
                                    {8472}new TTL_7552: bitstring;
                                    {8473}let gNs_7553: bitstring = exp(g,Ns_7550) in
                                    {8474}let m2_7554: bitstring = (OpenSecureChannelResponse,gNs_7553,ST_7551,TTL_7552) in
                                    {8475}out(c, m2_7554);
                                    {8476}let Ksrv_7555: bitstring = exp(PartC_7549,Ns_7550) in
                                    {8477}out(c, senc(mSrv(pkCli_7482,pkSess_7405),Ksrv_7555))
                            )
                            else
                                {8478}let v_7556: bool = (Cli_5313 = C) in
                                (
                                    {8479}if v_7556 then
                                    (
                                        {8480}let pkCli_7557: bitstring = pub(skC) in
                                        {8481}let v_7558: bool = (Disco_5314 = A) in
                                        (
                                            {8482}if v_7558 then
                                            (
                                                {8483}let pkDisco_7559: bitstring = pub(skA) in
                                                {8484}in(c, (=pkCli_7557,em1_7560: bitstring));
                                                {8485}let m1_7561: bitstring = em1_7560 in
                                                {8486}let (=OpenSecureChannelRequest,=pkCli_7557,PartC_7562: bitstring) = m1_7561 in
                                                {8487}new Ns_7563: bitstring;
                                                {8488}new ST_7564: bitstring;
                                                {8489}new TTL_7565: bitstring;
                                                {8490}let gNs_7566: bitstring = exp(g,Ns_7563) in
                                                {8491}let m2_7567: bitstring = (OpenSecureChannelResponse,gNs_7566,ST_7564,TTL_7565) in
                                                {8492}out(c, m2_7567);
                                                {8493}let Ksrv_7568: bitstring = exp(PartC_7562,Ns_7563) in
                                                {8494}out(c, senc(mSrv(pkCli_7557,pkSess_7405),Ksrv_7568))
                                            )
                                            else
                                                {8495}let v_7569: bool = (Disco_5314 = B) in
                                                (
                                                    {8496}if v_7569 then
                                                    (
                                                        {8497}let pkDisco_7570: bitstring = pub(skB) in
                                                        {8498}in(c, (=pkCli_7557,em1_7571: bitstring));
                                                        {8499}let m1_7572: bitstring = em1_7571 in
                                                        {8500}let (=OpenSecureChannelRequest,=pkCli_7557,PartC_7573: bitstring) = m1_7572 in
                                                        {8501}new Ns_7574: bitstring;
                                                        {8502}new ST_7575: bitstring;
                                                        {8503}new TTL_7576: bitstring;
                                                        {8504}let gNs_7577: bitstring = exp(g,Ns_7574) in
                                                        {8505}let m2_7578: bitstring = (OpenSecureChannelResponse,gNs_7577,ST_7575,TTL_7576) in
                                                        {8506}out(c, m2_7578);
                                                        {8507}let Ksrv_7579: bitstring = exp(PartC_7573,Ns_7574) in
                                                        {8508}out(c, senc(mSrv(pkCli_7557,pkSess_7405),Ksrv_7579))
                                                    )
                                                    else
                                                        {8509}let v_7580: bool = (Disco_5314 = C) in
                                                        (
                                                            {8510}if v_7580 then
                                                            (
                                                                {8511}let pkDisco_7581: bitstring = pub(skC) in
                                                                {8512}in(c, (=pkCli_7557,em1_7582: bitstring));
                                                                {8513}let m1_7583: bitstring = em1_7582 in
                                                                {8514}let (=OpenSecureChannelRequest,=pkCli_7557,PartC_7584: bitstring) = m1_7583 in
                                                                {8515}new Ns_7585: bitstring;
                                                                {8516}new ST_7586: bitstring;
                                                                {8517}new TTL_7587: bitstring;
                                                                {8518}let gNs_7588: bitstring = exp(g,Ns_7585) in
                                                                {8519}let m2_7589: bitstring = (OpenSecureChannelResponse,gNs_7588,ST_7586,TTL_7587) in
                                                                {8520}out(c, m2_7589);
                                                                {8521}let Ksrv_7590: bitstring = exp(PartC_7584,Ns_7585) in
                                                                {8522}out(c, senc(mSrv(pkCli_7557,pkSess_7405),Ksrv_7590))
                                                            )
                                                            else
                                                                {8523}let pkDisco_7591: bitstring = pub(sk(Disco_5314)) in
                                                                {8524}in(c, (=pkCli_7557,em1_7592: bitstring));
                                                                {8525}let m1_7593: bitstring = em1_7592 in
                                                                {8526}let (=OpenSecureChannelRequest,=pkCli_7557,PartC_7594: bitstring) = m1_7593 in
                                                                {8527}new Ns_7595: bitstring;
                                                                {8528}new ST_7596: bitstring;
                                                                {8529}new TTL_7597: bitstring;
                                                                {8530}let gNs_7598: bitstring = exp(g,Ns_7595) in
                                                                {8531}let m2_7599: bitstring = (OpenSecureChannelResponse,gNs_7598,ST_7596,TTL_7597) in
                                                                {8532}out(c, m2_7599);
                                                                {8533}let Ksrv_7600: bitstring = exp(PartC_7594,Ns_7595) in
                                                                {8534}out(c, senc(mSrv(pkCli_7557,pkSess_7405),Ksrv_7600))
                                                        )
                                                        else
                                                            {8535}let pkDisco_7601: bitstring = fail-any in
                                                            {8536}in(c, (=pkCli_7557,em1_7602: bitstring));
                                                            {8537}let m1_7603: bitstring = em1_7602 in
                                                            {8538}let (=OpenSecureChannelRequest,=pkCli_7557,PartC_7604: bitstring) = m1_7603 in
                                                            {8539}new Ns_7605: bitstring;
                                                            {8540}new ST_7606: bitstring;
                                                            {8541}new TTL_7607: bitstring;
                                                            {8542}let gNs_7608: bitstring = exp(g,Ns_7605) in
                                                            {8543}let m2_7609: bitstring = (OpenSecureChannelResponse,gNs_7608,ST_7606,TTL_7607) in
                                                            {8544}out(c, m2_7609);
                                                            {8545}let Ksrv_7610: bitstring = exp(PartC_7604,Ns_7605) in
                                                            {8546}out(c, senc(mSrv(pkCli_7557,pkSess_7405),Ksrv_7610))
                                                )
                                                else
                                                    {8547}let pkDisco_7611: bitstring = fail-any in
                                                    {8548}in(c, (=pkCli_7557,em1_7612: bitstring));
                                                    {8549}let m1_7613: bitstring = em1_7612 in
                                                    {8550}let (=OpenSecureChannelRequest,=pkCli_7557,PartC_7614: bitstring) = m1_7613 in
                                                    {8551}new Ns_7615: bitstring;
                                                    {8552}new ST_7616: bitstring;
                                                    {8553}new TTL_7617: bitstring;
                                                    {8554}let gNs_7618: bitstring = exp(g,Ns_7615) in
                                                    {8555}let m2_7619: bitstring = (OpenSecureChannelResponse,gNs_7618,ST_7616,TTL_7617) in
                                                    {8556}out(c, m2_7619);
                                                    {8557}let Ksrv_7620: bitstring = exp(PartC_7614,Ns_7615) in
                                                    {8558}out(c, senc(mSrv(pkCli_7557,pkSess_7405),Ksrv_7620))
                                        )
                                        else
                                            {8559}let pkDisco_7621: bitstring = fail-any in
                                            {8560}in(c, (=pkCli_7557,em1_7622: bitstring));
                                            {8561}let m1_7623: bitstring = em1_7622 in
                                            {8562}let (=OpenSecureChannelRequest,=pkCli_7557,PartC_7624: bitstring) = m1_7623 in
                                            {8563}new Ns_7625: bitstring;
                                            {8564}new ST_7626: bitstring;
                                            {8565}new TTL_7627: bitstring;
                                            {8566}let gNs_7628: bitstring = exp(g,Ns_7625) in
                                            {8567}let m2_7629: bitstring = (OpenSecureChannelResponse,gNs_7628,ST_7626,TTL_7627) in
                                            {8568}out(c, m2_7629);
                                            {8569}let Ksrv_7630: bitstring = exp(PartC_7624,Ns_7625) in
                                            {8570}out(c, senc(mSrv(pkCli_7557,pkSess_7405),Ksrv_7630))
                                    )
                                    else
                                        {8571}let pkCli_7631: bitstring = pub(sk(Cli_5313)) in
                                        {8572}let v_7632: bool = (Disco_5314 = A) in
                                        (
                                            {8573}if v_7632 then
                                            (
                                                {8574}let pkDisco_7633: bitstring = pub(skA) in
                                                {8575}in(c, (=pkCli_7631,em1_7634: bitstring));
                                                {8576}let m1_7635: bitstring = em1_7634 in
                                                {8577}let (=OpenSecureChannelRequest,=pkCli_7631,PartC_7636: bitstring) = m1_7635 in
                                                {8578}new Ns_7637: bitstring;
                                                {8579}new ST_7638: bitstring;
                                                {8580}new TTL_7639: bitstring;
                                                {8581}let gNs_7640: bitstring = exp(g,Ns_7637) in
                                                {8582}let m2_7641: bitstring = (OpenSecureChannelResponse,gNs_7640,ST_7638,TTL_7639) in
                                                {8583}out(c, m2_7641);
                                                {8584}let Ksrv_7642: bitstring = exp(PartC_7636,Ns_7637) in
                                                {8585}out(c, senc(mSrv(pkCli_7631,pkSess_7405),Ksrv_7642))
                                            )
                                            else
                                                {8586}let v_7643: bool = (Disco_5314 = B) in
                                                (
                                                    {8587}if v_7643 then
                                                    (
                                                        {8588}let pkDisco_7644: bitstring = pub(skB) in
                                                        {8589}in(c, (=pkCli_7631,em1_7645: bitstring));
                                                        {8590}let m1_7646: bitstring = em1_7645 in
                                                        {8591}let (=OpenSecureChannelRequest,=pkCli_7631,PartC_7647: bitstring) = m1_7646 in
                                                        {8592}new Ns_7648: bitstring;
                                                        {8593}new ST_7649: bitstring;
                                                        {8594}new TTL_7650: bitstring;
                                                        {8595}let gNs_7651: bitstring = exp(g,Ns_7648) in
                                                        {8596}let m2_7652: bitstring = (OpenSecureChannelResponse,gNs_7651,ST_7649,TTL_7650) in
                                                        {8597}out(c, m2_7652);
                                                        {8598}let Ksrv_7653: bitstring = exp(PartC_7647,Ns_7648) in
                                                        {8599}out(c, senc(mSrv(pkCli_7631,pkSess_7405),Ksrv_7653))
                                                    )
                                                    else
                                                        {8600}let v_7654: bool = (Disco_5314 = C) in
                                                        (
                                                            {8601}if v_7654 then
                                                            (
                                                                {8602}let pkDisco_7655: bitstring = pub(skC) in
                                                                {8603}in(c, (=pkCli_7631,em1_7656: bitstring));
                                                                {8604}let m1_7657: bitstring = em1_7656 in
                                                                {8605}let (=OpenSecureChannelRequest,=pkCli_7631,PartC_7658: bitstring) = m1_7657 in
                                                                {8606}new Ns_7659: bitstring;
                                                                {8607}new ST_7660: bitstring;
                                                                {8608}new TTL_7661: bitstring;
                                                                {8609}let gNs_7662: bitstring = exp(g,Ns_7659) in
                                                                {8610}let m2_7663: bitstring = (OpenSecureChannelResponse,gNs_7662,ST_7660,TTL_7661) in
                                                                {8611}out(c, m2_7663);
                                                                {8612}let Ksrv_7664: bitstring = exp(PartC_7658,Ns_7659) in
                                                                {8613}out(c, senc(mSrv(pkCli_7631,pkSess_7405),Ksrv_7664))
                                                            )
                                                            else
                                                                {8614}let pkDisco_7665: bitstring = pub(sk(Disco_5314)) in
                                                                {8615}in(c, (=pkCli_7631,em1_7666: bitstring));
                                                                {8616}let m1_7667: bitstring = em1_7666 in
                                                                {8617}let (=OpenSecureChannelRequest,=pkCli_7631,PartC_7668: bitstring) = m1_7667 in
                                                                {8618}new Ns_7669: bitstring;
                                                                {8619}new ST_7670: bitstring;
                                                                {8620}new TTL_7671: bitstring;
                                                                {8621}let gNs_7672: bitstring = exp(g,Ns_7669) in
                                                                {8622}let m2_7673: bitstring = (OpenSecureChannelResponse,gNs_7672,ST_7670,TTL_7671) in
                                                                {8623}out(c, m2_7673);
                                                                {8624}let Ksrv_7674: bitstring = exp(PartC_7668,Ns_7669) in
                                                                {8625}out(c, senc(mSrv(pkCli_7631,pkSess_7405),Ksrv_7674))
                                                        )
                                                        else
                                                            {8626}let pkDisco_7675: bitstring = fail-any in
                                                            {8627}in(c, (=pkCli_7631,em1_7676: bitstring));
                                                            {8628}let m1_7677: bitstring = em1_7676 in
                                                            {8629}let (=OpenSecureChannelRequest,=pkCli_7631,PartC_7678: bitstring) = m1_7677 in
                                                            {8630}new Ns_7679: bitstring;
                                                            {8631}new ST_7680: bitstring;
                                                            {8632}new TTL_7681: bitstring;
                                                            {8633}let gNs_7682: bitstring = exp(g,Ns_7679) in
                                                            {8634}let m2_7683: bitstring = (OpenSecureChannelResponse,gNs_7682,ST_7680,TTL_7681) in
                                                            {8635}out(c, m2_7683);
                                                            {8636}let Ksrv_7684: bitstring = exp(PartC_7678,Ns_7679) in
                                                            {8637}out(c, senc(mSrv(pkCli_7631,pkSess_7405),Ksrv_7684))
                                                )
                                                else
                                                    {8638}let pkDisco_7685: bitstring = fail-any in
                                                    {8639}in(c, (=pkCli_7631,em1_7686: bitstring));
                                                    {8640}let m1_7687: bitstring = em1_7686 in
                                                    {8641}let (=OpenSecureChannelRequest,=pkCli_7631,PartC_7688: bitstring) = m1_7687 in
                                                    {8642}new Ns_7689: bitstring;
                                                    {8643}new ST_7690: bitstring;
                                                    {8644}new TTL_7691: bitstring;
                                                    {8645}let gNs_7692: bitstring = exp(g,Ns_7689) in
                                                    {8646}let m2_7693: bitstring = (OpenSecureChannelResponse,gNs_7692,ST_7690,TTL_7691) in
                                                    {8647}out(c, m2_7693);
                                                    {8648}let Ksrv_7694: bitstring = exp(PartC_7688,Ns_7689) in
                                                    {8649}out(c, senc(mSrv(pkCli_7631,pkSess_7405),Ksrv_7694))
                                        )
                                        else
                                            {8650}let pkDisco_7695: bitstring = fail-any in
                                            {8651}in(c, (=pkCli_7631,em1_7696: bitstring));
                                            {8652}let m1_7697: bitstring = em1_7696 in
                                            {8653}let (=OpenSecureChannelRequest,=pkCli_7631,PartC_7698: bitstring) = m1_7697 in
                                            {8654}new Ns_7699: bitstring;
                                            {8655}new ST_7700: bitstring;
                                            {8656}new TTL_7701: bitstring;
                                            {8657}let gNs_7702: bitstring = exp(g,Ns_7699) in
                                            {8658}let m2_7703: bitstring = (OpenSecureChannelResponse,gNs_7702,ST_7700,TTL_7701) in
                                            {8659}out(c, m2_7703);
                                            {8660}let Ksrv_7704: bitstring = exp(PartC_7698,Ns_7699) in
                                            {8661}out(c, senc(mSrv(pkCli_7631,pkSess_7405),Ksrv_7704))
                                )
                                else
                                    {8662}let pkCli_7705: bitstring = fail-any in
                                    {8663}let v_7706: bool = (Disco_5314 = A) in
                                    (
                                        {8664}if v_7706 then
                                        (
                                            {8665}let pkDisco_7707: bitstring = pub(skA) in
                                            {8666}in(c, (=pkCli_7705,em1_7708: bitstring));
                                            {8667}let m1_7709: bitstring = em1_7708 in
                                            {8668}let (=OpenSecureChannelRequest,=pkCli_7705,PartC_7710: bitstring) = m1_7709 in
                                            {8669}new Ns_7711: bitstring;
                                            {8670}new ST_7712: bitstring;
                                            {8671}new TTL_7713: bitstring;
                                            {8672}let gNs_7714: bitstring = exp(g,Ns_7711) in
                                            {8673}let m2_7715: bitstring = (OpenSecureChannelResponse,gNs_7714,ST_7712,TTL_7713) in
                                            {8674}out(c, m2_7715);
                                            {8675}let Ksrv_7716: bitstring = exp(PartC_7710,Ns_7711) in
                                            {8676}out(c, senc(mSrv(pkCli_7705,pkSess_7405),Ksrv_7716))
                                        )
                                        else
                                            {8677}let v_7717: bool = (Disco_5314 = B) in
                                            (
                                                {8678}if v_7717 then
                                                (
                                                    {8679}let pkDisco_7718: bitstring = pub(skB) in
                                                    {8680}in(c, (=pkCli_7705,em1_7719: bitstring));
                                                    {8681}let m1_7720: bitstring = em1_7719 in
                                                    {8682}let (=OpenSecureChannelRequest,=pkCli_7705,PartC_7721: bitstring) = m1_7720 in
                                                    {8683}new Ns_7722: bitstring;
                                                    {8684}new ST_7723: bitstring;
                                                    {8685}new TTL_7724: bitstring;
                                                    {8686}let gNs_7725: bitstring = exp(g,Ns_7722) in
                                                    {8687}let m2_7726: bitstring = (OpenSecureChannelResponse,gNs_7725,ST_7723,TTL_7724) in
                                                    {8688}out(c, m2_7726);
                                                    {8689}let Ksrv_7727: bitstring = exp(PartC_7721,Ns_7722) in
                                                    {8690}out(c, senc(mSrv(pkCli_7705,pkSess_7405),Ksrv_7727))
                                                )
                                                else
                                                    {8691}let v_7728: bool = (Disco_5314 = C) in
                                                    (
                                                        {8692}if v_7728 then
                                                        (
                                                            {8693}let pkDisco_7729: bitstring = pub(skC) in
                                                            {8694}in(c, (=pkCli_7705,em1_7730: bitstring));
                                                            {8695}let m1_7731: bitstring = em1_7730 in
                                                            {8696}let (=OpenSecureChannelRequest,=pkCli_7705,PartC_7732: bitstring) = m1_7731 in
                                                            {8697}new Ns_7733: bitstring;
                                                            {8698}new ST_7734: bitstring;
                                                            {8699}new TTL_7735: bitstring;
                                                            {8700}let gNs_7736: bitstring = exp(g,Ns_7733) in
                                                            {8701}let m2_7737: bitstring = (OpenSecureChannelResponse,gNs_7736,ST_7734,TTL_7735) in
                                                            {8702}out(c, m2_7737);
                                                            {8703}let Ksrv_7738: bitstring = exp(PartC_7732,Ns_7733) in
                                                            {8704}out(c, senc(mSrv(pkCli_7705,pkSess_7405),Ksrv_7738))
                                                        )
                                                        else
                                                            {8705}let pkDisco_7739: bitstring = pub(sk(Disco_5314)) in
                                                            {8706}in(c, (=pkCli_7705,em1_7740: bitstring));
                                                            {8707}let m1_7741: bitstring = em1_7740 in
                                                            {8708}let (=OpenSecureChannelRequest,=pkCli_7705,PartC_7742: bitstring) = m1_7741 in
                                                            {8709}new Ns_7743: bitstring;
                                                            {8710}new ST_7744: bitstring;
                                                            {8711}new TTL_7745: bitstring;
                                                            {8712}let gNs_7746: bitstring = exp(g,Ns_7743) in
                                                            {8713}let m2_7747: bitstring = (OpenSecureChannelResponse,gNs_7746,ST_7744,TTL_7745) in
                                                            {8714}out(c, m2_7747);
                                                            {8715}let Ksrv_7748: bitstring = exp(PartC_7742,Ns_7743) in
                                                            {8716}out(c, senc(mSrv(pkCli_7705,pkSess_7405),Ksrv_7748))
                                                    )
                                                    else
                                                        {8717}let pkDisco_7749: bitstring = fail-any in
                                                        {8718}in(c, (=pkCli_7705,em1_7750: bitstring));
                                                        {8719}let m1_7751: bitstring = em1_7750 in
                                                        {8720}let (=OpenSecureChannelRequest,=pkCli_7705,PartC_7752: bitstring) = m1_7751 in
                                                        {8721}new Ns_7753: bitstring;
                                                        {8722}new ST_7754: bitstring;
                                                        {8723}new TTL_7755: bitstring;
                                                        {8724}let gNs_7756: bitstring = exp(g,Ns_7753) in
                                                        {8725}let m2_7757: bitstring = (OpenSecureChannelResponse,gNs_7756,ST_7754,TTL_7755) in
                                                        {8726}out(c, m2_7757);
                                                        {8727}let Ksrv_7758: bitstring = exp(PartC_7752,Ns_7753) in
                                                        {8728}out(c, senc(mSrv(pkCli_7705,pkSess_7405),Ksrv_7758))
                                            )
                                            else
                                                {8729}let pkDisco_7759: bitstring = fail-any in
                                                {8730}in(c, (=pkCli_7705,em1_7760: bitstring));
                                                {8731}let m1_7761: bitstring = em1_7760 in
                                                {8732}let (=OpenSecureChannelRequest,=pkCli_7705,PartC_7762: bitstring) = m1_7761 in
                                                {8733}new Ns_7763: bitstring;
                                                {8734}new ST_7764: bitstring;
                                                {8735}new TTL_7765: bitstring;
                                                {8736}let gNs_7766: bitstring = exp(g,Ns_7763) in
                                                {8737}let m2_7767: bitstring = (OpenSecureChannelResponse,gNs_7766,ST_7764,TTL_7765) in
                                                {8738}out(c, m2_7767);
                                                {8739}let Ksrv_7768: bitstring = exp(PartC_7762,Ns_7763) in
                                                {8740}out(c, senc(mSrv(pkCli_7705,pkSess_7405),Ksrv_7768))
                                    )
                                    else
                                        {8741}let pkDisco_7769: bitstring = fail-any in
                                        {8742}in(c, (=pkCli_7705,em1_7770: bitstring));
                                        {8743}let m1_7771: bitstring = em1_7770 in
                                        {8744}let (=OpenSecureChannelRequest,=pkCli_7705,PartC_7772: bitstring) = m1_7771 in
                                        {8745}new Ns_7773: bitstring;
                                        {8746}new ST_7774: bitstring;
                                        {8747}new TTL_7775: bitstring;
                                        {8748}let gNs_7776: bitstring = exp(g,Ns_7773) in
                                        {8749}let m2_7777: bitstring = (OpenSecureChannelResponse,gNs_7776,ST_7774,TTL_7775) in
                                        {8750}out(c, m2_7777);
                                        {8751}let Ksrv_7778: bitstring = exp(PartC_7772,Ns_7773) in
                                        {8752}out(c, senc(mSrv(pkCli_7705,pkSess_7405),Ksrv_7778))
                        )
                        else
                            {8753}let pkCli_7779: bitstring = fail-any in
                            {8754}let v_7780: bool = (Disco_5314 = A) in
                            (
                                {8755}if v_7780 then
                                (
                                    {8756}let pkDisco_7781: bitstring = pub(skA) in
                                    {8757}in(c, (=pkCli_7779,em1_7782: bitstring));
                                    {8758}let m1_7783: bitstring = em1_7782 in
                                    {8759}let (=OpenSecureChannelRequest,=pkCli_7779,PartC_7784: bitstring) = m1_7783 in
                                    {8760}new Ns_7785: bitstring;
                                    {8761}new ST_7786: bitstring;
                                    {8762}new TTL_7787: bitstring;
                                    {8763}let gNs_7788: bitstring = exp(g,Ns_7785) in
                                    {8764}let m2_7789: bitstring = (OpenSecureChannelResponse,gNs_7788,ST_7786,TTL_7787) in
                                    {8765}out(c, m2_7789);
                                    {8766}let Ksrv_7790: bitstring = exp(PartC_7784,Ns_7785) in
                                    {8767}out(c, senc(mSrv(pkCli_7779,pkSess_7405),Ksrv_7790))
                                )
                                else
                                    {8768}let v_7791: bool = (Disco_5314 = B) in
                                    (
                                        {8769}if v_7791 then
                                        (
                                            {8770}let pkDisco_7792: bitstring = pub(skB) in
                                            {8771}in(c, (=pkCli_7779,em1_7793: bitstring));
                                            {8772}let m1_7794: bitstring = em1_7793 in
                                            {8773}let (=OpenSecureChannelRequest,=pkCli_7779,PartC_7795: bitstring) = m1_7794 in
                                            {8774}new Ns_7796: bitstring;
                                            {8775}new ST_7797: bitstring;
                                            {8776}new TTL_7798: bitstring;
                                            {8777}let gNs_7799: bitstring = exp(g,Ns_7796) in
                                            {8778}let m2_7800: bitstring = (OpenSecureChannelResponse,gNs_7799,ST_7797,TTL_7798) in
                                            {8779}out(c, m2_7800);
                                            {8780}let Ksrv_7801: bitstring = exp(PartC_7795,Ns_7796) in
                                            {8781}out(c, senc(mSrv(pkCli_7779,pkSess_7405),Ksrv_7801))
                                        )
                                        else
                                            {8782}let v_7802: bool = (Disco_5314 = C) in
                                            (
                                                {8783}if v_7802 then
                                                (
                                                    {8784}let pkDisco_7803: bitstring = pub(skC) in
                                                    {8785}in(c, (=pkCli_7779,em1_7804: bitstring));
                                                    {8786}let m1_7805: bitstring = em1_7804 in
                                                    {8787}let (=OpenSecureChannelRequest,=pkCli_7779,PartC_7806: bitstring) = m1_7805 in
                                                    {8788}new Ns_7807: bitstring;
                                                    {8789}new ST_7808: bitstring;
                                                    {8790}new TTL_7809: bitstring;
                                                    {8791}let gNs_7810: bitstring = exp(g,Ns_7807) in
                                                    {8792}let m2_7811: bitstring = (OpenSecureChannelResponse,gNs_7810,ST_7808,TTL_7809) in
                                                    {8793}out(c, m2_7811);
                                                    {8794}let Ksrv_7812: bitstring = exp(PartC_7806,Ns_7807) in
                                                    {8795}out(c, senc(mSrv(pkCli_7779,pkSess_7405),Ksrv_7812))
                                                )
                                                else
                                                    {8796}let pkDisco_7813: bitstring = pub(sk(Disco_5314)) in
                                                    {8797}in(c, (=pkCli_7779,em1_7814: bitstring));
                                                    {8798}let m1_7815: bitstring = em1_7814 in
                                                    {8799}let (=OpenSecureChannelRequest,=pkCli_7779,PartC_7816: bitstring) = m1_7815 in
                                                    {8800}new Ns_7817: bitstring;
                                                    {8801}new ST_7818: bitstring;
                                                    {8802}new TTL_7819: bitstring;
                                                    {8803}let gNs_7820: bitstring = exp(g,Ns_7817) in
                                                    {8804}let m2_7821: bitstring = (OpenSecureChannelResponse,gNs_7820,ST_7818,TTL_7819) in
                                                    {8805}out(c, m2_7821);
                                                    {8806}let Ksrv_7822: bitstring = exp(PartC_7816,Ns_7817) in
                                                    {8807}out(c, senc(mSrv(pkCli_7779,pkSess_7405),Ksrv_7822))
                                            )
                                            else
                                                {8808}let pkDisco_7823: bitstring = fail-any in
                                                {8809}in(c, (=pkCli_7779,em1_7824: bitstring));
                                                {8810}let m1_7825: bitstring = em1_7824 in
                                                {8811}let (=OpenSecureChannelRequest,=pkCli_7779,PartC_7826: bitstring) = m1_7825 in
                                                {8812}new Ns_7827: bitstring;
                                                {8813}new ST_7828: bitstring;
                                                {8814}new TTL_7829: bitstring;
                                                {8815}let gNs_7830: bitstring = exp(g,Ns_7827) in
                                                {8816}let m2_7831: bitstring = (OpenSecureChannelResponse,gNs_7830,ST_7828,TTL_7829) in
                                                {8817}out(c, m2_7831);
                                                {8818}let Ksrv_7832: bitstring = exp(PartC_7826,Ns_7827) in
                                                {8819}out(c, senc(mSrv(pkCli_7779,pkSess_7405),Ksrv_7832))
                                    )
                                    else
                                        {8820}let pkDisco_7833: bitstring = fail-any in
                                        {8821}in(c, (=pkCli_7779,em1_7834: bitstring));
                                        {8822}let m1_7835: bitstring = em1_7834 in
                                        {8823}let (=OpenSecureChannelRequest,=pkCli_7779,PartC_7836: bitstring) = m1_7835 in
                                        {8824}new Ns_7837: bitstring;
                                        {8825}new ST_7838: bitstring;
                                        {8826}new TTL_7839: bitstring;
                                        {8827}let gNs_7840: bitstring = exp(g,Ns_7837) in
                                        {8828}let m2_7841: bitstring = (OpenSecureChannelResponse,gNs_7840,ST_7838,TTL_7839) in
                                        {8829}out(c, m2_7841);
                                        {8830}let Ksrv_7842: bitstring = exp(PartC_7836,Ns_7837) in
                                        {8831}out(c, senc(mSrv(pkCli_7779,pkSess_7405),Ksrv_7842))
                            )
                            else
                                {8832}let pkDisco_7843: bitstring = fail-any in
                                {8833}in(c, (=pkCli_7779,em1_7844: bitstring));
                                {8834}let m1_7845: bitstring = em1_7844 in
                                {8835}let (=OpenSecureChannelRequest,=pkCli_7779,PartC_7846: bitstring) = m1_7845 in
                                {8836}new Ns_7847: bitstring;
                                {8837}new ST_7848: bitstring;
                                {8838}new TTL_7849: bitstring;
                                {8839}let gNs_7850: bitstring = exp(g,Ns_7847) in
                                {8840}let m2_7851: bitstring = (OpenSecureChannelResponse,gNs_7850,ST_7848,TTL_7849) in
                                {8841}out(c, m2_7851);
                                {8842}let Ksrv_7852: bitstring = exp(PartC_7846,Ns_7847) in
                                {8843}out(c, senc(mSrv(pkCli_7779,pkSess_7405),Ksrv_7852))
                )
                else
                    {8844}let pkCli_7853: bitstring = fail-any in
                    {8845}let v_7854: bool = (Disco_5314 = A) in
                    (
                        {8846}if v_7854 then
                        (
                            {8847}let pkDisco_7855: bitstring = pub(skA) in
                            {8848}in(c, (=pkCli_7853,em1_7856: bitstring));
                            {8849}let m1_7857: bitstring = em1_7856 in
                            {8850}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7858: bitstring) = m1_7857 in
                            {8851}new Ns_7859: bitstring;
                            {8852}new ST_7860: bitstring;
                            {8853}new TTL_7861: bitstring;
                            {8854}let gNs_7862: bitstring = exp(g,Ns_7859) in
                            {8855}let m2_7863: bitstring = (OpenSecureChannelResponse,gNs_7862,ST_7860,TTL_7861) in
                            {8856}out(c, m2_7863);
                            {8857}let Ksrv_7864: bitstring = exp(PartC_7858,Ns_7859) in
                            {8858}out(c, senc(mSrv(pkCli_7853,pkSess_7405),Ksrv_7864))
                        )
                        else
                            {8859}let v_7865: bool = (Disco_5314 = B) in
                            (
                                {8860}if v_7865 then
                                (
                                    {8861}let pkDisco_7866: bitstring = pub(skB) in
                                    {8862}in(c, (=pkCli_7853,em1_7867: bitstring));
                                    {8863}let m1_7868: bitstring = em1_7867 in
                                    {8864}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7869: bitstring) = m1_7868 in
                                    {8865}new Ns_7870: bitstring;
                                    {8866}new ST_7871: bitstring;
                                    {8867}new TTL_7872: bitstring;
                                    {8868}let gNs_7873: bitstring = exp(g,Ns_7870) in
                                    {8869}let m2_7874: bitstring = (OpenSecureChannelResponse,gNs_7873,ST_7871,TTL_7872) in
                                    {8870}out(c, m2_7874);
                                    {8871}let Ksrv_7875: bitstring = exp(PartC_7869,Ns_7870) in
                                    {8872}out(c, senc(mSrv(pkCli_7853,pkSess_7405),Ksrv_7875))
                                )
                                else
                                    {8873}let v_7876: bool = (Disco_5314 = C) in
                                    (
                                        {8874}if v_7876 then
                                        (
                                            {8875}let pkDisco_7877: bitstring = pub(skC) in
                                            {8876}in(c, (=pkCli_7853,em1_7878: bitstring));
                                            {8877}let m1_7879: bitstring = em1_7878 in
                                            {8878}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7880: bitstring) = m1_7879 in
                                            {8879}new Ns_7881: bitstring;
                                            {8880}new ST_7882: bitstring;
                                            {8881}new TTL_7883: bitstring;
                                            {8882}let gNs_7884: bitstring = exp(g,Ns_7881) in
                                            {8883}let m2_7885: bitstring = (OpenSecureChannelResponse,gNs_7884,ST_7882,TTL_7883) in
                                            {8884}out(c, m2_7885);
                                            {8885}let Ksrv_7886: bitstring = exp(PartC_7880,Ns_7881) in
                                            {8886}out(c, senc(mSrv(pkCli_7853,pkSess_7405),Ksrv_7886))
                                        )
                                        else
                                            {8887}let pkDisco_7887: bitstring = pub(sk(Disco_5314)) in
                                            {8888}in(c, (=pkCli_7853,em1_7888: bitstring));
                                            {8889}let m1_7889: bitstring = em1_7888 in
                                            {8890}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7890: bitstring) = m1_7889 in
                                            {8891}new Ns_7891: bitstring;
                                            {8892}new ST_7892: bitstring;
                                            {8893}new TTL_7893: bitstring;
                                            {8894}let gNs_7894: bitstring = exp(g,Ns_7891) in
                                            {8895}let m2_7895: bitstring = (OpenSecureChannelResponse,gNs_7894,ST_7892,TTL_7893) in
                                            {8896}out(c, m2_7895);
                                            {8897}let Ksrv_7896: bitstring = exp(PartC_7890,Ns_7891) in
                                            {8898}out(c, senc(mSrv(pkCli_7853,pkSess_7405),Ksrv_7896))
                                    )
                                    else
                                        {8899}let pkDisco_7897: bitstring = fail-any in
                                        {8900}in(c, (=pkCli_7853,em1_7898: bitstring));
                                        {8901}let m1_7899: bitstring = em1_7898 in
                                        {8902}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7900: bitstring) = m1_7899 in
                                        {8903}new Ns_7901: bitstring;
                                        {8904}new ST_7902: bitstring;
                                        {8905}new TTL_7903: bitstring;
                                        {8906}let gNs_7904: bitstring = exp(g,Ns_7901) in
                                        {8907}let m2_7905: bitstring = (OpenSecureChannelResponse,gNs_7904,ST_7902,TTL_7903) in
                                        {8908}out(c, m2_7905);
                                        {8909}let Ksrv_7906: bitstring = exp(PartC_7900,Ns_7901) in
                                        {8910}out(c, senc(mSrv(pkCli_7853,pkSess_7405),Ksrv_7906))
                            )
                            else
                                {8911}let pkDisco_7907: bitstring = fail-any in
                                {8912}in(c, (=pkCli_7853,em1_7908: bitstring));
                                {8913}let m1_7909: bitstring = em1_7908 in
                                {8914}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7910: bitstring) = m1_7909 in
                                {8915}new Ns_7911: bitstring;
                                {8916}new ST_7912: bitstring;
                                {8917}new TTL_7913: bitstring;
                                {8918}let gNs_7914: bitstring = exp(g,Ns_7911) in
                                {8919}let m2_7915: bitstring = (OpenSecureChannelResponse,gNs_7914,ST_7912,TTL_7913) in
                                {8920}out(c, m2_7915);
                                {8921}let Ksrv_7916: bitstring = exp(PartC_7910,Ns_7911) in
                                {8922}out(c, senc(mSrv(pkCli_7853,pkSess_7405),Ksrv_7916))
                    )
                    else
                        {8923}let pkDisco_7917: bitstring = fail-any in
                        {8924}in(c, (=pkCli_7853,em1_7918: bitstring));
                        {8925}let m1_7919: bitstring = em1_7918 in
                        {8926}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7920: bitstring) = m1_7919 in
                        {8927}new Ns_7921: bitstring;
                        {8928}new ST_7922: bitstring;
                        {8929}new TTL_7923: bitstring;
                        {8930}let gNs_7924: bitstring = exp(g,Ns_7921) in
                        {8931}let m2_7925: bitstring = (OpenSecureChannelResponse,gNs_7924,ST_7922,TTL_7923) in
                        {8932}out(c, m2_7925);
                        {8933}let Ksrv_7926: bitstring = exp(PartC_7920,Ns_7921) in
                        {8934}out(c, senc(mSrv(pkCli_7853,pkSess_7405),Ksrv_7926))
    )
    else
        {8935}let skSess_7927: bitstring = fail-any in
        {8936}let pkSess_7928: bitstring = pub(skSess_7927) in
        {8937}let v_7929: bool = (Cli_5313 = A) in
        (
            {8938}if v_7929 then
            (
                {8939}let pkCli_7930: bitstring = pub(skA) in
                {8940}let v_7931: bool = (Disco_5314 = A) in
                (
                    {8941}if v_7931 then
                    (
                        {8942}let pkDisco_7932: bitstring = pub(skA) in
                        {8943}in(c, (=pkCli_7930,em1_7933: bitstring));
                        {8944}let m1_7934: bitstring = em1_7933 in
                        {8945}let (=OpenSecureChannelRequest,=pkCli_7930,PartC_7935: bitstring) = m1_7934 in
                        {8946}new Ns_7936: bitstring;
                        {8947}new ST_7937: bitstring;
                        {8948}new TTL_7938: bitstring;
                        {8949}let gNs_7939: bitstring = exp(g,Ns_7936) in
                        {8950}let m2_7940: bitstring = (OpenSecureChannelResponse,gNs_7939,ST_7937,TTL_7938) in
                        {8951}out(c, m2_7940);
                        {8952}let Ksrv_7941: bitstring = exp(PartC_7935,Ns_7936) in
                        {8953}out(c, senc(mSrv(pkCli_7930,pkSess_7928),Ksrv_7941))
                    )
                    else
                        {8954}let v_7942: bool = (Disco_5314 = B) in
                        (
                            {8955}if v_7942 then
                            (
                                {8956}let pkDisco_7943: bitstring = pub(skB) in
                                {8957}in(c, (=pkCli_7930,em1_7944: bitstring));
                                {8958}let m1_7945: bitstring = em1_7944 in
                                {8959}let (=OpenSecureChannelRequest,=pkCli_7930,PartC_7946: bitstring) = m1_7945 in
                                {8960}new Ns_7947: bitstring;
                                {8961}new ST_7948: bitstring;
                                {8962}new TTL_7949: bitstring;
                                {8963}let gNs_7950: bitstring = exp(g,Ns_7947) in
                                {8964}let m2_7951: bitstring = (OpenSecureChannelResponse,gNs_7950,ST_7948,TTL_7949) in
                                {8965}out(c, m2_7951);
                                {8966}let Ksrv_7952: bitstring = exp(PartC_7946,Ns_7947) in
                                {8967}out(c, senc(mSrv(pkCli_7930,pkSess_7928),Ksrv_7952))
                            )
                            else
                                {8968}let v_7953: bool = (Disco_5314 = C) in
                                (
                                    {8969}if v_7953 then
                                    (
                                        {8970}let pkDisco_7954: bitstring = pub(skC) in
                                        {8971}in(c, (=pkCli_7930,em1_7955: bitstring));
                                        {8972}let m1_7956: bitstring = em1_7955 in
                                        {8973}let (=OpenSecureChannelRequest,=pkCli_7930,PartC_7957: bitstring) = m1_7956 in
                                        {8974}new Ns_7958: bitstring;
                                        {8975}new ST_7959: bitstring;
                                        {8976}new TTL_7960: bitstring;
                                        {8977}let gNs_7961: bitstring = exp(g,Ns_7958) in
                                        {8978}let m2_7962: bitstring = (OpenSecureChannelResponse,gNs_7961,ST_7959,TTL_7960) in
                                        {8979}out(c, m2_7962);
                                        {8980}let Ksrv_7963: bitstring = exp(PartC_7957,Ns_7958) in
                                        {8981}out(c, senc(mSrv(pkCli_7930,pkSess_7928),Ksrv_7963))
                                    )
                                    else
                                        {8982}let pkDisco_7964: bitstring = pub(sk(Disco_5314)) in
                                        {8983}in(c, (=pkCli_7930,em1_7965: bitstring));
                                        {8984}let m1_7966: bitstring = em1_7965 in
                                        {8985}let (=OpenSecureChannelRequest,=pkCli_7930,PartC_7967: bitstring) = m1_7966 in
                                        {8986}new Ns_7968: bitstring;
                                        {8987}new ST_7969: bitstring;
                                        {8988}new TTL_7970: bitstring;
                                        {8989}let gNs_7971: bitstring = exp(g,Ns_7968) in
                                        {8990}let m2_7972: bitstring = (OpenSecureChannelResponse,gNs_7971,ST_7969,TTL_7970) in
                                        {8991}out(c, m2_7972);
                                        {8992}let Ksrv_7973: bitstring = exp(PartC_7967,Ns_7968) in
                                        {8993}out(c, senc(mSrv(pkCli_7930,pkSess_7928),Ksrv_7973))
                                )
                                else
                                    {8994}let pkDisco_7974: bitstring = fail-any in
                                    {8995}in(c, (=pkCli_7930,em1_7975: bitstring));
                                    {8996}let m1_7976: bitstring = em1_7975 in
                                    {8997}let (=OpenSecureChannelRequest,=pkCli_7930,PartC_7977: bitstring) = m1_7976 in
                                    {8998}new Ns_7978: bitstring;
                                    {8999}new ST_7979: bitstring;
                                    {9000}new TTL_7980: bitstring;
                                    {9001}let gNs_7981: bitstring = exp(g,Ns_7978) in
                                    {9002}let m2_7982: bitstring = (OpenSecureChannelResponse,gNs_7981,ST_7979,TTL_7980) in
                                    {9003}out(c, m2_7982);
                                    {9004}let Ksrv_7983: bitstring = exp(PartC_7977,Ns_7978) in
                                    {9005}out(c, senc(mSrv(pkCli_7930,pkSess_7928),Ksrv_7983))
                        )
                        else
                            {9006}let pkDisco_7984: bitstring = fail-any in
                            {9007}in(c, (=pkCli_7930,em1_7985: bitstring));
                            {9008}let m1_7986: bitstring = em1_7985 in
                            {9009}let (=OpenSecureChannelRequest,=pkCli_7930,PartC_7987: bitstring) = m1_7986 in
                            {9010}new Ns_7988: bitstring;
                            {9011}new ST_7989: bitstring;
                            {9012}new TTL_7990: bitstring;
                            {9013}let gNs_7991: bitstring = exp(g,Ns_7988) in
                            {9014}let m2_7992: bitstring = (OpenSecureChannelResponse,gNs_7991,ST_7989,TTL_7990) in
                            {9015}out(c, m2_7992);
                            {9016}let Ksrv_7993: bitstring = exp(PartC_7987,Ns_7988) in
                            {9017}out(c, senc(mSrv(pkCli_7930,pkSess_7928),Ksrv_7993))
                )
                else
                    {9018}let pkDisco_7994: bitstring = fail-any in
                    {9019}in(c, (=pkCli_7930,em1_7995: bitstring));
                    {9020}let m1_7996: bitstring = em1_7995 in
                    {9021}let (=OpenSecureChannelRequest,=pkCli_7930,PartC_7997: bitstring) = m1_7996 in
                    {9022}new Ns_7998: bitstring;
                    {9023}new ST_7999: bitstring;
                    {9024}new TTL_8000: bitstring;
                    {9025}let gNs_8001: bitstring = exp(g,Ns_7998) in
                    {9026}let m2_8002: bitstring = (OpenSecureChannelResponse,gNs_8001,ST_7999,TTL_8000) in
                    {9027}out(c, m2_8002);
                    {9028}let Ksrv_8003: bitstring = exp(PartC_7997,Ns_7998) in
                    {9029}out(c, senc(mSrv(pkCli_7930,pkSess_7928),Ksrv_8003))
            )
            else
                {9030}let v_8004: bool = (Cli_5313 = B) in
                (
                    {9031}if v_8004 then
                    (
                        {9032}let pkCli_8005: bitstring = pub(skB) in
                        {9033}let v_8006: bool = (Disco_5314 = A) in
                        (
                            {9034}if v_8006 then
                            (
                                {9035}let pkDisco_8007: bitstring = pub(skA) in
                                {9036}in(c, (=pkCli_8005,em1_8008: bitstring));
                                {9037}let m1_8009: bitstring = em1_8008 in
                                {9038}let (=OpenSecureChannelRequest,=pkCli_8005,PartC_8010: bitstring) = m1_8009 in
                                {9039}new Ns_8011: bitstring;
                                {9040}new ST_8012: bitstring;
                                {9041}new TTL_8013: bitstring;
                                {9042}let gNs_8014: bitstring = exp(g,Ns_8011) in
                                {9043}let m2_8015: bitstring = (OpenSecureChannelResponse,gNs_8014,ST_8012,TTL_8013) in
                                {9044}out(c, m2_8015);
                                {9045}let Ksrv_8016: bitstring = exp(PartC_8010,Ns_8011) in
                                {9046}out(c, senc(mSrv(pkCli_8005,pkSess_7928),Ksrv_8016))
                            )
                            else
                                {9047}let v_8017: bool = (Disco_5314 = B) in
                                (
                                    {9048}if v_8017 then
                                    (
                                        {9049}let pkDisco_8018: bitstring = pub(skB) in
                                        {9050}in(c, (=pkCli_8005,em1_8019: bitstring));
                                        {9051}let m1_8020: bitstring = em1_8019 in
                                        {9052}let (=OpenSecureChannelRequest,=pkCli_8005,PartC_8021: bitstring) = m1_8020 in
                                        {9053}new Ns_8022: bitstring;
                                        {9054}new ST_8023: bitstring;
                                        {9055}new TTL_8024: bitstring;
                                        {9056}let gNs_8025: bitstring = exp(g,Ns_8022) in
                                        {9057}let m2_8026: bitstring = (OpenSecureChannelResponse,gNs_8025,ST_8023,TTL_8024) in
                                        {9058}out(c, m2_8026);
                                        {9059}let Ksrv_8027: bitstring = exp(PartC_8021,Ns_8022) in
                                        {9060}out(c, senc(mSrv(pkCli_8005,pkSess_7928),Ksrv_8027))
                                    )
                                    else
                                        {9061}let v_8028: bool = (Disco_5314 = C) in
                                        (
                                            {9062}if v_8028 then
                                            (
                                                {9063}let pkDisco_8029: bitstring = pub(skC) in
                                                {9064}in(c, (=pkCli_8005,em1_8030: bitstring));
                                                {9065}let m1_8031: bitstring = em1_8030 in
                                                {9066}let (=OpenSecureChannelRequest,=pkCli_8005,PartC_8032: bitstring) = m1_8031 in
                                                {9067}new Ns_8033: bitstring;
                                                {9068}new ST_8034: bitstring;
                                                {9069}new TTL_8035: bitstring;
                                                {9070}let gNs_8036: bitstring = exp(g,Ns_8033) in
                                                {9071}let m2_8037: bitstring = (OpenSecureChannelResponse,gNs_8036,ST_8034,TTL_8035) in
                                                {9072}out(c, m2_8037);
                                                {9073}let Ksrv_8038: bitstring = exp(PartC_8032,Ns_8033) in
                                                {9074}out(c, senc(mSrv(pkCli_8005,pkSess_7928),Ksrv_8038))
                                            )
                                            else
                                                {9075}let pkDisco_8039: bitstring = pub(sk(Disco_5314)) in
                                                {9076}in(c, (=pkCli_8005,em1_8040: bitstring));
                                                {9077}let m1_8041: bitstring = em1_8040 in
                                                {9078}let (=OpenSecureChannelRequest,=pkCli_8005,PartC_8042: bitstring) = m1_8041 in
                                                {9079}new Ns_8043: bitstring;
                                                {9080}new ST_8044: bitstring;
                                                {9081}new TTL_8045: bitstring;
                                                {9082}let gNs_8046: bitstring = exp(g,Ns_8043) in
                                                {9083}let m2_8047: bitstring = (OpenSecureChannelResponse,gNs_8046,ST_8044,TTL_8045) in
                                                {9084}out(c, m2_8047);
                                                {9085}let Ksrv_8048: bitstring = exp(PartC_8042,Ns_8043) in
                                                {9086}out(c, senc(mSrv(pkCli_8005,pkSess_7928),Ksrv_8048))
                                        )
                                        else
                                            {9087}let pkDisco_8049: bitstring = fail-any in
                                            {9088}in(c, (=pkCli_8005,em1_8050: bitstring));
                                            {9089}let m1_8051: bitstring = em1_8050 in
                                            {9090}let (=OpenSecureChannelRequest,=pkCli_8005,PartC_8052: bitstring) = m1_8051 in
                                            {9091}new Ns_8053: bitstring;
                                            {9092}new ST_8054: bitstring;
                                            {9093}new TTL_8055: bitstring;
                                            {9094}let gNs_8056: bitstring = exp(g,Ns_8053) in
                                            {9095}let m2_8057: bitstring = (OpenSecureChannelResponse,gNs_8056,ST_8054,TTL_8055) in
                                            {9096}out(c, m2_8057);
                                            {9097}let Ksrv_8058: bitstring = exp(PartC_8052,Ns_8053) in
                                            {9098}out(c, senc(mSrv(pkCli_8005,pkSess_7928),Ksrv_8058))
                                )
                                else
                                    {9099}let pkDisco_8059: bitstring = fail-any in
                                    {9100}in(c, (=pkCli_8005,em1_8060: bitstring));
                                    {9101}let m1_8061: bitstring = em1_8060 in
                                    {9102}let (=OpenSecureChannelRequest,=pkCli_8005,PartC_8062: bitstring) = m1_8061 in
                                    {9103}new Ns_8063: bitstring;
                                    {9104}new ST_8064: bitstring;
                                    {9105}new TTL_8065: bitstring;
                                    {9106}let gNs_8066: bitstring = exp(g,Ns_8063) in
                                    {9107}let m2_8067: bitstring = (OpenSecureChannelResponse,gNs_8066,ST_8064,TTL_8065) in
                                    {9108}out(c, m2_8067);
                                    {9109}let Ksrv_8068: bitstring = exp(PartC_8062,Ns_8063) in
                                    {9110}out(c, senc(mSrv(pkCli_8005,pkSess_7928),Ksrv_8068))
                        )
                        else
                            {9111}let pkDisco_8069: bitstring = fail-any in
                            {9112}in(c, (=pkCli_8005,em1_8070: bitstring));
                            {9113}let m1_8071: bitstring = em1_8070 in
                            {9114}let (=OpenSecureChannelRequest,=pkCli_8005,PartC_8072: bitstring) = m1_8071 in
                            {9115}new Ns_8073: bitstring;
                            {9116}new ST_8074: bitstring;
                            {9117}new TTL_8075: bitstring;
                            {9118}let gNs_8076: bitstring = exp(g,Ns_8073) in
                            {9119}let m2_8077: bitstring = (OpenSecureChannelResponse,gNs_8076,ST_8074,TTL_8075) in
                            {9120}out(c, m2_8077);
                            {9121}let Ksrv_8078: bitstring = exp(PartC_8072,Ns_8073) in
                            {9122}out(c, senc(mSrv(pkCli_8005,pkSess_7928),Ksrv_8078))
                    )
                    else
                        {9123}let v_8079: bool = (Cli_5313 = C) in
                        (
                            {9124}if v_8079 then
                            (
                                {9125}let pkCli_8080: bitstring = pub(skC) in
                                {9126}let v_8081: bool = (Disco_5314 = A) in
                                (
                                    {9127}if v_8081 then
                                    (
                                        {9128}let pkDisco_8082: bitstring = pub(skA) in
                                        {9129}in(c, (=pkCli_8080,em1_8083: bitstring));
                                        {9130}let m1_8084: bitstring = em1_8083 in
                                        {9131}let (=OpenSecureChannelRequest,=pkCli_8080,PartC_8085: bitstring) = m1_8084 in
                                        {9132}new Ns_8086: bitstring;
                                        {9133}new ST_8087: bitstring;
                                        {9134}new TTL_8088: bitstring;
                                        {9135}let gNs_8089: bitstring = exp(g,Ns_8086) in
                                        {9136}let m2_8090: bitstring = (OpenSecureChannelResponse,gNs_8089,ST_8087,TTL_8088) in
                                        {9137}out(c, m2_8090);
                                        {9138}let Ksrv_8091: bitstring = exp(PartC_8085,Ns_8086) in
                                        {9139}out(c, senc(mSrv(pkCli_8080,pkSess_7928),Ksrv_8091))
                                    )
                                    else
                                        {9140}let v_8092: bool = (Disco_5314 = B) in
                                        (
                                            {9141}if v_8092 then
                                            (
                                                {9142}let pkDisco_8093: bitstring = pub(skB) in
                                                {9143}in(c, (=pkCli_8080,em1_8094: bitstring));
                                                {9144}let m1_8095: bitstring = em1_8094 in
                                                {9145}let (=OpenSecureChannelRequest,=pkCli_8080,PartC_8096: bitstring) = m1_8095 in
                                                {9146}new Ns_8097: bitstring;
                                                {9147}new ST_8098: bitstring;
                                                {9148}new TTL_8099: bitstring;
                                                {9149}let gNs_8100: bitstring = exp(g,Ns_8097) in
                                                {9150}let m2_8101: bitstring = (OpenSecureChannelResponse,gNs_8100,ST_8098,TTL_8099) in
                                                {9151}out(c, m2_8101);
                                                {9152}let Ksrv_8102: bitstring = exp(PartC_8096,Ns_8097) in
                                                {9153}out(c, senc(mSrv(pkCli_8080,pkSess_7928),Ksrv_8102))
                                            )
                                            else
                                                {9154}let v_8103: bool = (Disco_5314 = C) in
                                                (
                                                    {9155}if v_8103 then
                                                    (
                                                        {9156}let pkDisco_8104: bitstring = pub(skC) in
                                                        {9157}in(c, (=pkCli_8080,em1_8105: bitstring));
                                                        {9158}let m1_8106: bitstring = em1_8105 in
                                                        {9159}let (=OpenSecureChannelRequest,=pkCli_8080,PartC_8107: bitstring) = m1_8106 in
                                                        {9160}new Ns_8108: bitstring;
                                                        {9161}new ST_8109: bitstring;
                                                        {9162}new TTL_8110: bitstring;
                                                        {9163}let gNs_8111: bitstring = exp(g,Ns_8108) in
                                                        {9164}let m2_8112: bitstring = (OpenSecureChannelResponse,gNs_8111,ST_8109,TTL_8110) in
                                                        {9165}out(c, m2_8112);
                                                        {9166}let Ksrv_8113: bitstring = exp(PartC_8107,Ns_8108) in
                                                        {9167}out(c, senc(mSrv(pkCli_8080,pkSess_7928),Ksrv_8113))
                                                    )
                                                    else
                                                        {9168}let pkDisco_8114: bitstring = pub(sk(Disco_5314)) in
                                                        {9169}in(c, (=pkCli_8080,em1_8115: bitstring));
                                                        {9170}let m1_8116: bitstring = em1_8115 in
                                                        {9171}let (=OpenSecureChannelRequest,=pkCli_8080,PartC_8117: bitstring) = m1_8116 in
                                                        {9172}new Ns_8118: bitstring;
                                                        {9173}new ST_8119: bitstring;
                                                        {9174}new TTL_8120: bitstring;
                                                        {9175}let gNs_8121: bitstring = exp(g,Ns_8118) in
                                                        {9176}let m2_8122: bitstring = (OpenSecureChannelResponse,gNs_8121,ST_8119,TTL_8120) in
                                                        {9177}out(c, m2_8122);
                                                        {9178}let Ksrv_8123: bitstring = exp(PartC_8117,Ns_8118) in
                                                        {9179}out(c, senc(mSrv(pkCli_8080,pkSess_7928),Ksrv_8123))
                                                )
                                                else
                                                    {9180}let pkDisco_8124: bitstring = fail-any in
                                                    {9181}in(c, (=pkCli_8080,em1_8125: bitstring));
                                                    {9182}let m1_8126: bitstring = em1_8125 in
                                                    {9183}let (=OpenSecureChannelRequest,=pkCli_8080,PartC_8127: bitstring) = m1_8126 in
                                                    {9184}new Ns_8128: bitstring;
                                                    {9185}new ST_8129: bitstring;
                                                    {9186}new TTL_8130: bitstring;
                                                    {9187}let gNs_8131: bitstring = exp(g,Ns_8128) in
                                                    {9188}let m2_8132: bitstring = (OpenSecureChannelResponse,gNs_8131,ST_8129,TTL_8130) in
                                                    {9189}out(c, m2_8132);
                                                    {9190}let Ksrv_8133: bitstring = exp(PartC_8127,Ns_8128) in
                                                    {9191}out(c, senc(mSrv(pkCli_8080,pkSess_7928),Ksrv_8133))
                                        )
                                        else
                                            {9192}let pkDisco_8134: bitstring = fail-any in
                                            {9193}in(c, (=pkCli_8080,em1_8135: bitstring));
                                            {9194}let m1_8136: bitstring = em1_8135 in
                                            {9195}let (=OpenSecureChannelRequest,=pkCli_8080,PartC_8137: bitstring) = m1_8136 in
                                            {9196}new Ns_8138: bitstring;
                                            {9197}new ST_8139: bitstring;
                                            {9198}new TTL_8140: bitstring;
                                            {9199}let gNs_8141: bitstring = exp(g,Ns_8138) in
                                            {9200}let m2_8142: bitstring = (OpenSecureChannelResponse,gNs_8141,ST_8139,TTL_8140) in
                                            {9201}out(c, m2_8142);
                                            {9202}let Ksrv_8143: bitstring = exp(PartC_8137,Ns_8138) in
                                            {9203}out(c, senc(mSrv(pkCli_8080,pkSess_7928),Ksrv_8143))
                                )
                                else
                                    {9204}let pkDisco_8144: bitstring = fail-any in
                                    {9205}in(c, (=pkCli_8080,em1_8145: bitstring));
                                    {9206}let m1_8146: bitstring = em1_8145 in
                                    {9207}let (=OpenSecureChannelRequest,=pkCli_8080,PartC_8147: bitstring) = m1_8146 in
                                    {9208}new Ns_8148: bitstring;
                                    {9209}new ST_8149: bitstring;
                                    {9210}new TTL_8150: bitstring;
                                    {9211}let gNs_8151: bitstring = exp(g,Ns_8148) in
                                    {9212}let m2_8152: bitstring = (OpenSecureChannelResponse,gNs_8151,ST_8149,TTL_8150) in
                                    {9213}out(c, m2_8152);
                                    {9214}let Ksrv_8153: bitstring = exp(PartC_8147,Ns_8148) in
                                    {9215}out(c, senc(mSrv(pkCli_8080,pkSess_7928),Ksrv_8153))
                            )
                            else
                                {9216}let pkCli_8154: bitstring = pub(sk(Cli_5313)) in
                                {9217}let v_8155: bool = (Disco_5314 = A) in
                                (
                                    {9218}if v_8155 then
                                    (
                                        {9219}let pkDisco_8156: bitstring = pub(skA) in
                                        {9220}in(c, (=pkCli_8154,em1_8157: bitstring));
                                        {9221}let m1_8158: bitstring = em1_8157 in
                                        {9222}let (=OpenSecureChannelRequest,=pkCli_8154,PartC_8159: bitstring) = m1_8158 in
                                        {9223}new Ns_8160: bitstring;
                                        {9224}new ST_8161: bitstring;
                                        {9225}new TTL_8162: bitstring;
                                        {9226}let gNs_8163: bitstring = exp(g,Ns_8160) in
                                        {9227}let m2_8164: bitstring = (OpenSecureChannelResponse,gNs_8163,ST_8161,TTL_8162) in
                                        {9228}out(c, m2_8164);
                                        {9229}let Ksrv_8165: bitstring = exp(PartC_8159,Ns_8160) in
                                        {9230}out(c, senc(mSrv(pkCli_8154,pkSess_7928),Ksrv_8165))
                                    )
                                    else
                                        {9231}let v_8166: bool = (Disco_5314 = B) in
                                        (
                                            {9232}if v_8166 then
                                            (
                                                {9233}let pkDisco_8167: bitstring = pub(skB) in
                                                {9234}in(c, (=pkCli_8154,em1_8168: bitstring));
                                                {9235}let m1_8169: bitstring = em1_8168 in
                                                {9236}let (=OpenSecureChannelRequest,=pkCli_8154,PartC_8170: bitstring) = m1_8169 in
                                                {9237}new Ns_8171: bitstring;
                                                {9238}new ST_8172: bitstring;
                                                {9239}new TTL_8173: bitstring;
                                                {9240}let gNs_8174: bitstring = exp(g,Ns_8171) in
                                                {9241}let m2_8175: bitstring = (OpenSecureChannelResponse,gNs_8174,ST_8172,TTL_8173) in
                                                {9242}out(c, m2_8175);
                                                {9243}let Ksrv_8176: bitstring = exp(PartC_8170,Ns_8171) in
                                                {9244}out(c, senc(mSrv(pkCli_8154,pkSess_7928),Ksrv_8176))
                                            )
                                            else
                                                {9245}let v_8177: bool = (Disco_5314 = C) in
                                                (
                                                    {9246}if v_8177 then
                                                    (
                                                        {9247}let pkDisco_8178: bitstring = pub(skC) in
                                                        {9248}in(c, (=pkCli_8154,em1_8179: bitstring));
                                                        {9249}let m1_8180: bitstring = em1_8179 in
                                                        {9250}let (=OpenSecureChannelRequest,=pkCli_8154,PartC_8181: bitstring) = m1_8180 in
                                                        {9251}new Ns_8182: bitstring;
                                                        {9252}new ST_8183: bitstring;
                                                        {9253}new TTL_8184: bitstring;
                                                        {9254}let gNs_8185: bitstring = exp(g,Ns_8182) in
                                                        {9255}let m2_8186: bitstring = (OpenSecureChannelResponse,gNs_8185,ST_8183,TTL_8184) in
                                                        {9256}out(c, m2_8186);
                                                        {9257}let Ksrv_8187: bitstring = exp(PartC_8181,Ns_8182) in
                                                        {9258}out(c, senc(mSrv(pkCli_8154,pkSess_7928),Ksrv_8187))
                                                    )
                                                    else
                                                        {9259}let pkDisco_8188: bitstring = pub(sk(Disco_5314)) in
                                                        {9260}in(c, (=pkCli_8154,em1_8189: bitstring));
                                                        {9261}let m1_8190: bitstring = em1_8189 in
                                                        {9262}let (=OpenSecureChannelRequest,=pkCli_8154,PartC_8191: bitstring) = m1_8190 in
                                                        {9263}new Ns_8192: bitstring;
                                                        {9264}new ST_8193: bitstring;
                                                        {9265}new TTL_8194: bitstring;
                                                        {9266}let gNs_8195: bitstring = exp(g,Ns_8192) in
                                                        {9267}let m2_8196: bitstring = (OpenSecureChannelResponse,gNs_8195,ST_8193,TTL_8194) in
                                                        {9268}out(c, m2_8196);
                                                        {9269}let Ksrv_8197: bitstring = exp(PartC_8191,Ns_8192) in
                                                        {9270}out(c, senc(mSrv(pkCli_8154,pkSess_7928),Ksrv_8197))
                                                )
                                                else
                                                    {9271}let pkDisco_8198: bitstring = fail-any in
                                                    {9272}in(c, (=pkCli_8154,em1_8199: bitstring));
                                                    {9273}let m1_8200: bitstring = em1_8199 in
                                                    {9274}let (=OpenSecureChannelRequest,=pkCli_8154,PartC_8201: bitstring) = m1_8200 in
                                                    {9275}new Ns_8202: bitstring;
                                                    {9276}new ST_8203: bitstring;
                                                    {9277}new TTL_8204: bitstring;
                                                    {9278}let gNs_8205: bitstring = exp(g,Ns_8202) in
                                                    {9279}let m2_8206: bitstring = (OpenSecureChannelResponse,gNs_8205,ST_8203,TTL_8204) in
                                                    {9280}out(c, m2_8206);
                                                    {9281}let Ksrv_8207: bitstring = exp(PartC_8201,Ns_8202) in
                                                    {9282}out(c, senc(mSrv(pkCli_8154,pkSess_7928),Ksrv_8207))
                                        )
                                        else
                                            {9283}let pkDisco_8208: bitstring = fail-any in
                                            {9284}in(c, (=pkCli_8154,em1_8209: bitstring));
                                            {9285}let m1_8210: bitstring = em1_8209 in
                                            {9286}let (=OpenSecureChannelRequest,=pkCli_8154,PartC_8211: bitstring) = m1_8210 in
                                            {9287}new Ns_8212: bitstring;
                                            {9288}new ST_8213: bitstring;
                                            {9289}new TTL_8214: bitstring;
                                            {9290}let gNs_8215: bitstring = exp(g,Ns_8212) in
                                            {9291}let m2_8216: bitstring = (OpenSecureChannelResponse,gNs_8215,ST_8213,TTL_8214) in
                                            {9292}out(c, m2_8216);
                                            {9293}let Ksrv_8217: bitstring = exp(PartC_8211,Ns_8212) in
                                            {9294}out(c, senc(mSrv(pkCli_8154,pkSess_7928),Ksrv_8217))
                                )
                                else
                                    {9295}let pkDisco_8218: bitstring = fail-any in
                                    {9296}in(c, (=pkCli_8154,em1_8219: bitstring));
                                    {9297}let m1_8220: bitstring = em1_8219 in
                                    {9298}let (=OpenSecureChannelRequest,=pkCli_8154,PartC_8221: bitstring) = m1_8220 in
                                    {9299}new Ns_8222: bitstring;
                                    {9300}new ST_8223: bitstring;
                                    {9301}new TTL_8224: bitstring;
                                    {9302}let gNs_8225: bitstring = exp(g,Ns_8222) in
                                    {9303}let m2_8226: bitstring = (OpenSecureChannelResponse,gNs_8225,ST_8223,TTL_8224) in
                                    {9304}out(c, m2_8226);
                                    {9305}let Ksrv_8227: bitstring = exp(PartC_8221,Ns_8222) in
                                    {9306}out(c, senc(mSrv(pkCli_8154,pkSess_7928),Ksrv_8227))
                        )
                        else
                            {9307}let pkCli_8228: bitstring = fail-any in
                            {9308}let v_8229: bool = (Disco_5314 = A) in
                            (
                                {9309}if v_8229 then
                                (
                                    {9310}let pkDisco_8230: bitstring = pub(skA) in
                                    {9311}in(c, (=pkCli_8228,em1_8231: bitstring));
                                    {9312}let m1_8232: bitstring = em1_8231 in
                                    {9313}let (=OpenSecureChannelRequest,=pkCli_8228,PartC_8233: bitstring) = m1_8232 in
                                    {9314}new Ns_8234: bitstring;
                                    {9315}new ST_8235: bitstring;
                                    {9316}new TTL_8236: bitstring;
                                    {9317}let gNs_8237: bitstring = exp(g,Ns_8234) in
                                    {9318}let m2_8238: bitstring = (OpenSecureChannelResponse,gNs_8237,ST_8235,TTL_8236) in
                                    {9319}out(c, m2_8238);
                                    {9320}let Ksrv_8239: bitstring = exp(PartC_8233,Ns_8234) in
                                    {9321}out(c, senc(mSrv(pkCli_8228,pkSess_7928),Ksrv_8239))
                                )
                                else
                                    {9322}let v_8240: bool = (Disco_5314 = B) in
                                    (
                                        {9323}if v_8240 then
                                        (
                                            {9324}let pkDisco_8241: bitstring = pub(skB) in
                                            {9325}in(c, (=pkCli_8228,em1_8242: bitstring));
                                            {9326}let m1_8243: bitstring = em1_8242 in
                                            {9327}let (=OpenSecureChannelRequest,=pkCli_8228,PartC_8244: bitstring) = m1_8243 in
                                            {9328}new Ns_8245: bitstring;
                                            {9329}new ST_8246: bitstring;
                                            {9330}new TTL_8247: bitstring;
                                            {9331}let gNs_8248: bitstring = exp(g,Ns_8245) in
                                            {9332}let m2_8249: bitstring = (OpenSecureChannelResponse,gNs_8248,ST_8246,TTL_8247) in
                                            {9333}out(c, m2_8249);
                                            {9334}let Ksrv_8250: bitstring = exp(PartC_8244,Ns_8245) in
                                            {9335}out(c, senc(mSrv(pkCli_8228,pkSess_7928),Ksrv_8250))
                                        )
                                        else
                                            {9336}let v_8251: bool = (Disco_5314 = C) in
                                            (
                                                {9337}if v_8251 then
                                                (
                                                    {9338}let pkDisco_8252: bitstring = pub(skC) in
                                                    {9339}in(c, (=pkCli_8228,em1_8253: bitstring));
                                                    {9340}let m1_8254: bitstring = em1_8253 in
                                                    {9341}let (=OpenSecureChannelRequest,=pkCli_8228,PartC_8255: bitstring) = m1_8254 in
                                                    {9342}new Ns_8256: bitstring;
                                                    {9343}new ST_8257: bitstring;
                                                    {9344}new TTL_8258: bitstring;
                                                    {9345}let gNs_8259: bitstring = exp(g,Ns_8256) in
                                                    {9346}let m2_8260: bitstring = (OpenSecureChannelResponse,gNs_8259,ST_8257,TTL_8258) in
                                                    {9347}out(c, m2_8260);
                                                    {9348}let Ksrv_8261: bitstring = exp(PartC_8255,Ns_8256) in
                                                    {9349}out(c, senc(mSrv(pkCli_8228,pkSess_7928),Ksrv_8261))
                                                )
                                                else
                                                    {9350}let pkDisco_8262: bitstring = pub(sk(Disco_5314)) in
                                                    {9351}in(c, (=pkCli_8228,em1_8263: bitstring));
                                                    {9352}let m1_8264: bitstring = em1_8263 in
                                                    {9353}let (=OpenSecureChannelRequest,=pkCli_8228,PartC_8265: bitstring) = m1_8264 in
                                                    {9354}new Ns_8266: bitstring;
                                                    {9355}new ST_8267: bitstring;
                                                    {9356}new TTL_8268: bitstring;
                                                    {9357}let gNs_8269: bitstring = exp(g,Ns_8266) in
                                                    {9358}let m2_8270: bitstring = (OpenSecureChannelResponse,gNs_8269,ST_8267,TTL_8268) in
                                                    {9359}out(c, m2_8270);
                                                    {9360}let Ksrv_8271: bitstring = exp(PartC_8265,Ns_8266) in
                                                    {9361}out(c, senc(mSrv(pkCli_8228,pkSess_7928),Ksrv_8271))
                                            )
                                            else
                                                {9362}let pkDisco_8272: bitstring = fail-any in
                                                {9363}in(c, (=pkCli_8228,em1_8273: bitstring));
                                                {9364}let m1_8274: bitstring = em1_8273 in
                                                {9365}let (=OpenSecureChannelRequest,=pkCli_8228,PartC_8275: bitstring) = m1_8274 in
                                                {9366}new Ns_8276: bitstring;
                                                {9367}new ST_8277: bitstring;
                                                {9368}new TTL_8278: bitstring;
                                                {9369}let gNs_8279: bitstring = exp(g,Ns_8276) in
                                                {9370}let m2_8280: bitstring = (OpenSecureChannelResponse,gNs_8279,ST_8277,TTL_8278) in
                                                {9371}out(c, m2_8280);
                                                {9372}let Ksrv_8281: bitstring = exp(PartC_8275,Ns_8276) in
                                                {9373}out(c, senc(mSrv(pkCli_8228,pkSess_7928),Ksrv_8281))
                                    )
                                    else
                                        {9374}let pkDisco_8282: bitstring = fail-any in
                                        {9375}in(c, (=pkCli_8228,em1_8283: bitstring));
                                        {9376}let m1_8284: bitstring = em1_8283 in
                                        {9377}let (=OpenSecureChannelRequest,=pkCli_8228,PartC_8285: bitstring) = m1_8284 in
                                        {9378}new Ns_8286: bitstring;
                                        {9379}new ST_8287: bitstring;
                                        {9380}new TTL_8288: bitstring;
                                        {9381}let gNs_8289: bitstring = exp(g,Ns_8286) in
                                        {9382}let m2_8290: bitstring = (OpenSecureChannelResponse,gNs_8289,ST_8287,TTL_8288) in
                                        {9383}out(c, m2_8290);
                                        {9384}let Ksrv_8291: bitstring = exp(PartC_8285,Ns_8286) in
                                        {9385}out(c, senc(mSrv(pkCli_8228,pkSess_7928),Ksrv_8291))
                            )
                            else
                                {9386}let pkDisco_8292: bitstring = fail-any in
                                {9387}in(c, (=pkCli_8228,em1_8293: bitstring));
                                {9388}let m1_8294: bitstring = em1_8293 in
                                {9389}let (=OpenSecureChannelRequest,=pkCli_8228,PartC_8295: bitstring) = m1_8294 in
                                {9390}new Ns_8296: bitstring;
                                {9391}new ST_8297: bitstring;
                                {9392}new TTL_8298: bitstring;
                                {9393}let gNs_8299: bitstring = exp(g,Ns_8296) in
                                {9394}let m2_8300: bitstring = (OpenSecureChannelResponse,gNs_8299,ST_8297,TTL_8298) in
                                {9395}out(c, m2_8300);
                                {9396}let Ksrv_8301: bitstring = exp(PartC_8295,Ns_8296) in
                                {9397}out(c, senc(mSrv(pkCli_8228,pkSess_7928),Ksrv_8301))
                )
                else
                    {9398}let pkCli_8302: bitstring = fail-any in
                    {9399}let v_8303: bool = (Disco_5314 = A) in
                    (
                        {9400}if v_8303 then
                        (
                            {9401}let pkDisco_8304: bitstring = pub(skA) in
                            {9402}in(c, (=pkCli_8302,em1_8305: bitstring));
                            {9403}let m1_8306: bitstring = em1_8305 in
                            {9404}let (=OpenSecureChannelRequest,=pkCli_8302,PartC_8307: bitstring) = m1_8306 in
                            {9405}new Ns_8308: bitstring;
                            {9406}new ST_8309: bitstring;
                            {9407}new TTL_8310: bitstring;
                            {9408}let gNs_8311: bitstring = exp(g,Ns_8308) in
                            {9409}let m2_8312: bitstring = (OpenSecureChannelResponse,gNs_8311,ST_8309,TTL_8310) in
                            {9410}out(c, m2_8312);
                            {9411}let Ksrv_8313: bitstring = exp(PartC_8307,Ns_8308) in
                            {9412}out(c, senc(mSrv(pkCli_8302,pkSess_7928),Ksrv_8313))
                        )
                        else
                            {9413}let v_8314: bool = (Disco_5314 = B) in
                            (
                                {9414}if v_8314 then
                                (
                                    {9415}let pkDisco_8315: bitstring = pub(skB) in
                                    {9416}in(c, (=pkCli_8302,em1_8316: bitstring));
                                    {9417}let m1_8317: bitstring = em1_8316 in
                                    {9418}let (=OpenSecureChannelRequest,=pkCli_8302,PartC_8318: bitstring) = m1_8317 in
                                    {9419}new Ns_8319: bitstring;
                                    {9420}new ST_8320: bitstring;
                                    {9421}new TTL_8321: bitstring;
                                    {9422}let gNs_8322: bitstring = exp(g,Ns_8319) in
                                    {9423}let m2_8323: bitstring = (OpenSecureChannelResponse,gNs_8322,ST_8320,TTL_8321) in
                                    {9424}out(c, m2_8323);
                                    {9425}let Ksrv_8324: bitstring = exp(PartC_8318,Ns_8319) in
                                    {9426}out(c, senc(mSrv(pkCli_8302,pkSess_7928),Ksrv_8324))
                                )
                                else
                                    {9427}let v_8325: bool = (Disco_5314 = C) in
                                    (
                                        {9428}if v_8325 then
                                        (
                                            {9429}let pkDisco_8326: bitstring = pub(skC) in
                                            {9430}in(c, (=pkCli_8302,em1_8327: bitstring));
                                            {9431}let m1_8328: bitstring = em1_8327 in
                                            {9432}let (=OpenSecureChannelRequest,=pkCli_8302,PartC_8329: bitstring) = m1_8328 in
                                            {9433}new Ns_8330: bitstring;
                                            {9434}new ST_8331: bitstring;
                                            {9435}new TTL_8332: bitstring;
                                            {9436}let gNs_8333: bitstring = exp(g,Ns_8330) in
                                            {9437}let m2_8334: bitstring = (OpenSecureChannelResponse,gNs_8333,ST_8331,TTL_8332) in
                                            {9438}out(c, m2_8334);
                                            {9439}let Ksrv_8335: bitstring = exp(PartC_8329,Ns_8330) in
                                            {9440}out(c, senc(mSrv(pkCli_8302,pkSess_7928),Ksrv_8335))
                                        )
                                        else
                                            {9441}let pkDisco_8336: bitstring = pub(sk(Disco_5314)) in
                                            {9442}in(c, (=pkCli_8302,em1_8337: bitstring));
                                            {9443}let m1_8338: bitstring = em1_8337 in
                                            {9444}let (=OpenSecureChannelRequest,=pkCli_8302,PartC_8339: bitstring) = m1_8338 in
                                            {9445}new Ns_8340: bitstring;
                                            {9446}new ST_8341: bitstring;
                                            {9447}new TTL_8342: bitstring;
                                            {9448}let gNs_8343: bitstring = exp(g,Ns_8340) in
                                            {9449}let m2_8344: bitstring = (OpenSecureChannelResponse,gNs_8343,ST_8341,TTL_8342) in
                                            {9450}out(c, m2_8344);
                                            {9451}let Ksrv_8345: bitstring = exp(PartC_8339,Ns_8340) in
                                            {9452}out(c, senc(mSrv(pkCli_8302,pkSess_7928),Ksrv_8345))
                                    )
                                    else
                                        {9453}let pkDisco_8346: bitstring = fail-any in
                                        {9454}in(c, (=pkCli_8302,em1_8347: bitstring));
                                        {9455}let m1_8348: bitstring = em1_8347 in
                                        {9456}let (=OpenSecureChannelRequest,=pkCli_8302,PartC_8349: bitstring) = m1_8348 in
                                        {9457}new Ns_8350: bitstring;
                                        {9458}new ST_8351: bitstring;
                                        {9459}new TTL_8352: bitstring;
                                        {9460}let gNs_8353: bitstring = exp(g,Ns_8350) in
                                        {9461}let m2_8354: bitstring = (OpenSecureChannelResponse,gNs_8353,ST_8351,TTL_8352) in
                                        {9462}out(c, m2_8354);
                                        {9463}let Ksrv_8355: bitstring = exp(PartC_8349,Ns_8350) in
                                        {9464}out(c, senc(mSrv(pkCli_8302,pkSess_7928),Ksrv_8355))
                            )
                            else
                                {9465}let pkDisco_8356: bitstring = fail-any in
                                {9466}in(c, (=pkCli_8302,em1_8357: bitstring));
                                {9467}let m1_8358: bitstring = em1_8357 in
                                {9468}let (=OpenSecureChannelRequest,=pkCli_8302,PartC_8359: bitstring) = m1_8358 in
                                {9469}new Ns_8360: bitstring;
                                {9470}new ST_8361: bitstring;
                                {9471}new TTL_8362: bitstring;
                                {9472}let gNs_8363: bitstring = exp(g,Ns_8360) in
                                {9473}let m2_8364: bitstring = (OpenSecureChannelResponse,gNs_8363,ST_8361,TTL_8362) in
                                {9474}out(c, m2_8364);
                                {9475}let Ksrv_8365: bitstring = exp(PartC_8359,Ns_8360) in
                                {9476}out(c, senc(mSrv(pkCli_8302,pkSess_7928),Ksrv_8365))
                    )
                    else
                        {9477}let pkDisco_8366: bitstring = fail-any in
                        {9478}in(c, (=pkCli_8302,em1_8367: bitstring));
                        {9479}let m1_8368: bitstring = em1_8367 in
                        {9480}let (=OpenSecureChannelRequest,=pkCli_8302,PartC_8369: bitstring) = m1_8368 in
                        {9481}new Ns_8370: bitstring;
                        {9482}new ST_8371: bitstring;
                        {9483}new TTL_8372: bitstring;
                        {9484}let gNs_8373: bitstring = exp(g,Ns_8370) in
                        {9485}let m2_8374: bitstring = (OpenSecureChannelResponse,gNs_8373,ST_8371,TTL_8372) in
                        {9486}out(c, m2_8374);
                        {9487}let Ksrv_8375: bitstring = exp(PartC_8369,Ns_8370) in
                        {9488}out(c, senc(mSrv(pkCli_8302,pkSess_7928),Ksrv_8375))
        )
        else
            {9489}let pkCli_8376: bitstring = fail-any in
            {9490}let v_8377: bool = (Disco_5314 = A) in
            (
                {9491}if v_8377 then
                (
                    {9492}let pkDisco_8378: bitstring = pub(skA) in
                    {9493}in(c, (=pkCli_8376,em1_8379: bitstring));
                    {9494}let m1_8380: bitstring = em1_8379 in
                    {9495}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8381: bitstring) = m1_8380 in
                    {9496}new Ns_8382: bitstring;
                    {9497}new ST_8383: bitstring;
                    {9498}new TTL_8384: bitstring;
                    {9499}let gNs_8385: bitstring = exp(g,Ns_8382) in
                    {9500}let m2_8386: bitstring = (OpenSecureChannelResponse,gNs_8385,ST_8383,TTL_8384) in
                    {9501}out(c, m2_8386);
                    {9502}let Ksrv_8387: bitstring = exp(PartC_8381,Ns_8382) in
                    {9503}out(c, senc(mSrv(pkCli_8376,pkSess_7928),Ksrv_8387))
                )
                else
                    {9504}let v_8388: bool = (Disco_5314 = B) in
                    (
                        {9505}if v_8388 then
                        (
                            {9506}let pkDisco_8389: bitstring = pub(skB) in
                            {9507}in(c, (=pkCli_8376,em1_8390: bitstring));
                            {9508}let m1_8391: bitstring = em1_8390 in
                            {9509}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8392: bitstring) = m1_8391 in
                            {9510}new Ns_8393: bitstring;
                            {9511}new ST_8394: bitstring;
                            {9512}new TTL_8395: bitstring;
                            {9513}let gNs_8396: bitstring = exp(g,Ns_8393) in
                            {9514}let m2_8397: bitstring = (OpenSecureChannelResponse,gNs_8396,ST_8394,TTL_8395) in
                            {9515}out(c, m2_8397);
                            {9516}let Ksrv_8398: bitstring = exp(PartC_8392,Ns_8393) in
                            {9517}out(c, senc(mSrv(pkCli_8376,pkSess_7928),Ksrv_8398))
                        )
                        else
                            {9518}let v_8399: bool = (Disco_5314 = C) in
                            (
                                {9519}if v_8399 then
                                (
                                    {9520}let pkDisco_8400: bitstring = pub(skC) in
                                    {9521}in(c, (=pkCli_8376,em1_8401: bitstring));
                                    {9522}let m1_8402: bitstring = em1_8401 in
                                    {9523}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8403: bitstring) = m1_8402 in
                                    {9524}new Ns_8404: bitstring;
                                    {9525}new ST_8405: bitstring;
                                    {9526}new TTL_8406: bitstring;
                                    {9527}let gNs_8407: bitstring = exp(g,Ns_8404) in
                                    {9528}let m2_8408: bitstring = (OpenSecureChannelResponse,gNs_8407,ST_8405,TTL_8406) in
                                    {9529}out(c, m2_8408);
                                    {9530}let Ksrv_8409: bitstring = exp(PartC_8403,Ns_8404) in
                                    {9531}out(c, senc(mSrv(pkCli_8376,pkSess_7928),Ksrv_8409))
                                )
                                else
                                    {9532}let pkDisco_8410: bitstring = pub(sk(Disco_5314)) in
                                    {9533}in(c, (=pkCli_8376,em1_8411: bitstring));
                                    {9534}let m1_8412: bitstring = em1_8411 in
                                    {9535}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8413: bitstring) = m1_8412 in
                                    {9536}new Ns_8414: bitstring;
                                    {9537}new ST_8415: bitstring;
                                    {9538}new TTL_8416: bitstring;
                                    {9539}let gNs_8417: bitstring = exp(g,Ns_8414) in
                                    {9540}let m2_8418: bitstring = (OpenSecureChannelResponse,gNs_8417,ST_8415,TTL_8416) in
                                    {9541}out(c, m2_8418);
                                    {9542}let Ksrv_8419: bitstring = exp(PartC_8413,Ns_8414) in
                                    {9543}out(c, senc(mSrv(pkCli_8376,pkSess_7928),Ksrv_8419))
                            )
                            else
                                {9544}let pkDisco_8420: bitstring = fail-any in
                                {9545}in(c, (=pkCli_8376,em1_8421: bitstring));
                                {9546}let m1_8422: bitstring = em1_8421 in
                                {9547}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8423: bitstring) = m1_8422 in
                                {9548}new Ns_8424: bitstring;
                                {9549}new ST_8425: bitstring;
                                {9550}new TTL_8426: bitstring;
                                {9551}let gNs_8427: bitstring = exp(g,Ns_8424) in
                                {9552}let m2_8428: bitstring = (OpenSecureChannelResponse,gNs_8427,ST_8425,TTL_8426) in
                                {9553}out(c, m2_8428);
                                {9554}let Ksrv_8429: bitstring = exp(PartC_8423,Ns_8424) in
                                {9555}out(c, senc(mSrv(pkCli_8376,pkSess_7928),Ksrv_8429))
                    )
                    else
                        {9556}let pkDisco_8430: bitstring = fail-any in
                        {9557}in(c, (=pkCli_8376,em1_8431: bitstring));
                        {9558}let m1_8432: bitstring = em1_8431 in
                        {9559}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8433: bitstring) = m1_8432 in
                        {9560}new Ns_8434: bitstring;
                        {9561}new ST_8435: bitstring;
                        {9562}new TTL_8436: bitstring;
                        {9563}let gNs_8437: bitstring = exp(g,Ns_8434) in
                        {9564}let m2_8438: bitstring = (OpenSecureChannelResponse,gNs_8437,ST_8435,TTL_8436) in
                        {9565}out(c, m2_8438);
                        {9566}let Ksrv_8439: bitstring = exp(PartC_8433,Ns_8434) in
                        {9567}out(c, senc(mSrv(pkCli_8376,pkSess_7928),Ksrv_8439))
            )
            else
                {9568}let pkDisco_8440: bitstring = fail-any in
                {9569}in(c, (=pkCli_8376,em1_8441: bitstring));
                {9570}let m1_8442: bitstring = em1_8441 in
                {9571}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8443: bitstring) = m1_8442 in
                {9572}new Ns_8444: bitstring;
                {9573}new ST_8445: bitstring;
                {9574}new TTL_8446: bitstring;
                {9575}let gNs_8447: bitstring = exp(g,Ns_8444) in
                {9576}let m2_8448: bitstring = (OpenSecureChannelResponse,gNs_8447,ST_8445,TTL_8446) in
                {9577}out(c, m2_8448);
                {9578}let Ksrv_8449: bitstring = exp(PartC_8443,Ns_8444) in
                {9579}out(c, senc(mSrv(pkCli_8376,pkSess_7928),Ksrv_8449))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 484 rules in the queue.
400 rules inserted. The rule base contains 143 rules. 484 rules in the queue.
600 rules inserted. The rule base contains 188 rules. 484 rules in the queue.
800 rules inserted. The rule base contains 199 rules. 482 rules in the queue.
1000 rules inserted. The rule base contains 239 rules. 482 rules in the queue.
1200 rules inserted. The rule base contains 239 rules. 472 rules in the queue.
1400 rules inserted. The rule base contains 237 rules. 456 rules in the queue.
1600 rules inserted. The rule base contains 199 rules. 456 rules in the queue.
1800 rules inserted. The rule base contains 263 rules. 584 rules in the queue.
2000 rules inserted. The rule base contains 281 rules. 1152 rules in the queue.
2200 rules inserted. The rule base contains 308 rules. 1524 rules in the queue.
2400 rules inserted. The rule base contains 379 rules. 2744 rules in the queue.
2600 rules inserted. The rule base contains 411 rules. 2935 rules in the queue.
2800 rules inserted. The rule base contains 479 rules. 4157 rules in the queue.
3000 rules inserted. The rule base contains 511 rules. 4344 rules in the queue.
3200 rules inserted. The rule base contains 537 rules. 5590 rules in the queue.
3400 rules inserted. The rule base contains 570 rules. 6356 rules in the queue.
3600 rules inserted. The rule base contains 594 rules. 7123 rules in the queue.
3800 rules inserted. The rule base contains 607 rules. 7212 rules in the queue.
4000 rules inserted. The rule base contains 628 rules. 7210 rules in the queue.
4200 rules inserted. The rule base contains 650 rules. 7210 rules in the queue.
4400 rules inserted. The rule base contains 681 rules. 7302 rules in the queue.
4600 rules inserted. The rule base contains 713 rules. 7396 rules in the queue.
4800 rules inserted. The rule base contains 747 rules. 7584 rules in the queue.
5000 rules inserted. The rule base contains 775 rules. 7584 rules in the queue.
5200 rules inserted. The rule base contains 806 rules. 7676 rules in the queue.
5400 rules inserted. The rule base contains 819 rules. 7669 rules in the queue.
5600 rules inserted. The rule base contains 837 rules. 7761 rules in the queue.
5800 rules inserted. The rule base contains 865 rules. 7761 rules in the queue.
6000 rules inserted. The rule base contains 899 rules. 7949 rules in the queue.
6200 rules inserted. The rule base contains 931 rules. 8043 rules in the queue.
6400 rules inserted. The rule base contains 962 rules. 8135 rules in the queue.
6600 rules inserted. The rule base contains 990 rules. 8135 rules in the queue.
6800 rules inserted. The rule base contains 1019 rules. 8133 rules in the queue.
7000 rules inserted. The rule base contains 1028 rules. 8126 rules in the queue.
7200 rules inserted. The rule base contains 1052 rules. 8314 rules in the queue.
7400 rules inserted. The rule base contains 1068 rules. 8315 rules in the queue.
7600 rules inserted. The rule base contains 1096 rules. 8313 rules in the queue.
7800 rules inserted. The rule base contains 1125 rules. 8311 rules in the queue.
8000 rules inserted. The rule base contains 1154 rules. 8597 rules in the queue.
8200 rules inserted. The rule base contains 1170 rules. 8692 rules in the queue.
8400 rules inserted. The rule base contains 1198 rules. 8690 rules in the queue.
8600 rules inserted. The rule base contains 1227 rules. 8688 rules in the queue.
8800 rules inserted. The rule base contains 1255 rules. 8878 rules in the queue.
9000 rules inserted. The rule base contains 1272 rules. 8879 rules in the queue.
9200 rules inserted. The rule base contains 1300 rules. 8973 rules in the queue.
9400 rules inserted. The rule base contains 1328 rules. 9067 rules in the queue.
9600 rules inserted. The rule base contains 1345 rules. 9066 rules in the queue.
9800 rules inserted. The rule base contains 1374 rules. 9160 rules in the queue.
10000 rules inserted. The rule base contains 1403 rules. 9350 rules in the queue.
10200 rules inserted. The rule base contains 1431 rules. 9444 rules in the queue.
10400 rules inserted. The rule base contains 1447 rules. 9445 rules in the queue.
10600 rules inserted. The rule base contains 1476 rules. 9443 rules in the queue.
10800 rules inserted. The rule base contains 1491 rules. 9442 rules in the queue.
11000 rules inserted. The rule base contains 1510 rules. 9434 rules in the queue.
11200 rules inserted. The rule base contains 1516 rules. 9426 rules in the queue.
11400 rules inserted. The rule base contains 1514 rules. 9420 rules in the queue.
11600 rules inserted. The rule base contains 1528 rules. 9418 rules in the queue.
11800 rules inserted. The rule base contains 1535 rules. 9411 rules in the queue.
12000 rules inserted. The rule base contains 1541 rules. 9409 rules in the queue.
12200 rules inserted. The rule base contains 1552 rules. 9402 rules in the queue.
12400 rules inserted. The rule base contains 1567 rules. 9400 rules in the queue.
12600 rules inserted. The rule base contains 1567 rules. 9392 rules in the queue.
12800 rules inserted. The rule base contains 1581 rules. 9390 rules in the queue.
13000 rules inserted. The rule base contains 1589 rules. 9382 rules in the queue.
13200 rules inserted. The rule base contains 1595 rules. 9375 rules in the queue.
13400 rules inserted. The rule base contains 1606 rules. 9368 rules in the queue.
13600 rules inserted. The rule base contains 1608 rules. 9366 rules in the queue.
13800 rules inserted. The rule base contains 1620 rules. 9359 rules in the queue.
14000 rules inserted. The rule base contains 1634 rules. 9357 rules in the queue.
14200 rules inserted. The rule base contains 1645 rules. 9350 rules in the queue.
14400 rules inserted. The rule base contains 1647 rules. 9348 rules in the queue.
14600 rules inserted. The rule base contains 1658 rules. 9341 rules in the queue.
14800 rules inserted. The rule base contains 1660 rules. 9339 rules in the queue.
15000 rules inserted. The rule base contains 1668 rules. 9331 rules in the queue.
15200 rules inserted. The rule base contains 1679 rules. 9324 rules in the queue.
15400 rules inserted. The rule base contains 1703 rules. 9322 rules in the queue.
15600 rules inserted. The rule base contains 1707 rules. 9309 rules in the queue.
15800 rules inserted. The rule base contains 1707 rules. 9305 rules in the queue.
16000 rules inserted. The rule base contains 1709 rules. 9309 rules in the queue.
16200 rules inserted. The rule base contains 1719 rules. 9309 rules in the queue.
16400 rules inserted. The rule base contains 1738 rules. 9307 rules in the queue.
16600 rules inserted. The rule base contains 1752 rules. 9306 rules in the queue.
16800 rules inserted. The rule base contains 1773 rules. 9299 rules in the queue.
17000 rules inserted. The rule base contains 1775 rules. 9298 rules in the queue.
17200 rules inserted. The rule base contains 1778 rules. 9300 rules in the queue.
17400 rules inserted. The rule base contains 1793 rules. 9299 rules in the queue.
17600 rules inserted. The rule base contains 1810 rules. 9296 rules in the queue.
17800 rules inserted. The rule base contains 1813 rules. 9288 rules in the queue.
18000 rules inserted. The rule base contains 1828 rules. 9289 rules in the queue.
18200 rules inserted. The rule base contains 1829 rules. 9289 rules in the queue.
18400 rules inserted. The rule base contains 1846 rules. 9286 rules in the queue.
18600 rules inserted. The rule base contains 1852 rules. 9281 rules in the queue.
18800 rules inserted. The rule base contains 1854 rules. 9283 rules in the queue.
19000 rules inserted. The rule base contains 1869 rules. 9282 rules in the queue.
19200 rules inserted. The rule base contains 1897 rules. 9280 rules in the queue.
19400 rules inserted. The rule base contains 1899 rules. 9282 rules in the queue.
19600 rules inserted. The rule base contains 1914 rules. 9281 rules in the queue.
19800 rules inserted. The rule base contains 1918 rules. 9269 rules in the queue.
20000 rules inserted. The rule base contains 1920 rules. 9271 rules in the queue.
20200 rules inserted. The rule base contains 1928 rules. 9264 rules in the queue.
20400 rules inserted. The rule base contains 1953 rules. 9228 rules in the queue.
20600 rules inserted. The rule base contains 1981 rules. 9192 rules in the queue.
20800 rules inserted. The rule base contains 1990 rules. 9179 rules in the queue.
21000 rules inserted. The rule base contains 1996 rules. 9172 rules in the queue.
21200 rules inserted. The rule base contains 2003 rules. 9164 rules in the queue.
21400 rules inserted. The rule base contains 2017 rules. 9150 rules in the queue.
21600 rules inserted. The rule base contains 2022 rules. 9144 rules in the queue.
21800 rules inserted. The rule base contains 2031 rules. 9134 rules in the queue.
22000 rules inserted. The rule base contains 2041 rules. 9124 rules in the queue.
22200 rules inserted. The rule base contains 2051 rules. 9113 rules in the queue.
22400 rules inserted. The rule base contains 2077 rules. 9075 rules in the queue.
22600 rules inserted. The rule base contains 2095 rules. 9045 rules in the queue.
22800 rules inserted. The rule base contains 2109 rules. 9031 rules in the queue.
23000 rules inserted. The rule base contains 2115 rules. 9025 rules in the queue.
23200 rules inserted. The rule base contains 2123 rules. 9017 rules in the queue.
23400 rules inserted. The rule base contains 2135 rules. 9004 rules in the queue.
23600 rules inserted. The rule base contains 2142 rules. 8996 rules in the queue.
23800 rules inserted. The rule base contains 2151 rules. 8987 rules in the queue.
24000 rules inserted. The rule base contains 2164 rules. 8974 rules in the queue.
24200 rules inserted. The rule base contains 2177 rules. 8961 rules in the queue.
24400 rules inserted. The rule base contains 2226 rules. 8900 rules in the queue.
24600 rules inserted. The rule base contains 2217 rules. 8897 rules in the queue.
24800 rules inserted. The rule base contains 2231 rules. 8883 rules in the queue.
25000 rules inserted. The rule base contains 2256 rules. 8846 rules in the queue.
25200 rules inserted. The rule base contains 2264 rules. 8822 rules in the queue.
25400 rules inserted. The rule base contains 2275 rules. 8803 rules in the queue.
25600 rules inserted. The rule base contains 2276 rules. 8802 rules in the queue.
25800 rules inserted. The rule base contains 2282 rules. 8795 rules in the queue.
26000 rules inserted. The rule base contains 2289 rules. 8788 rules in the queue.
26200 rules inserted. The rule base contains 2316 rules. 8749 rules in the queue.
26400 rules inserted. The rule base contains 2330 rules. 8735 rules in the queue.
26600 rules inserted. The rule base contains 2339 rules. 8718 rules in the queue.
26800 rules inserted. The rule base contains 2344 rules. 8715 rules in the queue.
27000 rules inserted. The rule base contains 2371 rules. 8676 rules in the queue.
27200 rules inserted. The rule base contains 2374 rules. 8656 rules in the queue.
27400 rules inserted. The rule base contains 2385 rules. 8644 rules in the queue.
27600 rules inserted. The rule base contains 2393 rules. 8636 rules in the queue.
27800 rules inserted. The rule base contains 2418 rules. 8599 rules in the queue.
28000 rules inserted. The rule base contains 2432 rules. 8585 rules in the queue.
28200 rules inserted. The rule base contains 2437 rules. 8573 rules in the queue.
28400 rules inserted. The rule base contains 2439 rules. 8572 rules in the queue.
28600 rules inserted. The rule base contains 2448 rules. 8554 rules in the queue.
28800 rules inserted. The rule base contains 2456 rules. 8547 rules in the queue.
29000 rules inserted. The rule base contains 2483 rules. 8508 rules in the queue.
29200 rules inserted. The rule base contains 2495 rules. 8487 rules in the queue.
29400 rules inserted. The rule base contains 2520 rules. 8450 rules in the queue.
29600 rules inserted. The rule base contains 2561 rules. 8403 rules in the queue.
29800 rules inserted. The rule base contains 2601 rules. 8345 rules in the queue.
30000 rules inserted. The rule base contains 2625 rules. 8297 rules in the queue.
30200 rules inserted. The rule base contains 2671 rules. 8235 rules in the queue.
30400 rules inserted. The rule base contains 2691 rules. 8199 rules in the queue.
30600 rules inserted. The rule base contains 2723 rules. 8139 rules in the queue.
30800 rules inserted. The rule base contains 2742 rules. 8120 rules in the queue.
31000 rules inserted. The rule base contains 2792 rules. 8046 rules in the queue.
31200 rules inserted. The rule base contains 2824 rules. 8001 rules in the queue.
31400 rules inserted. The rule base contains 2845 rules. 7957 rules in the queue.
31600 rules inserted. The rule base contains 2879 rules. 7911 rules in the queue.
31800 rules inserted. The rule base contains 2920 rules. 7851 rules in the queue.
32000 rules inserted. The rule base contains 2939 rules. 7815 rules in the queue.
32200 rules inserted. The rule base contains 2966 rules. 7776 rules in the queue.
32400 rules inserted. The rule base contains 3002 rules. 7716 rules in the queue.
32600 rules inserted. The rule base contains 3050 rules. 7656 rules in the queue.
32800 rules inserted. The rule base contains 3074 rules. 7617 rules in the queue.
33000 rules inserted. The rule base contains 3105 rules. 7557 rules in the queue.
33200 rules inserted. The rule base contains 3140 rules. 7494 rules in the queue.
33400 rules inserted. The rule base contains 3167 rules. 7467 rules in the queue.
33600 rules inserted. The rule base contains 3192 rules. 7430 rules in the queue.
33800 rules inserted. The rule base contains 3248 rules. 7359 rules in the queue.
34000 rules inserted. The rule base contains 3282 rules. 7297 rules in the queue.
34200 rules inserted. The rule base contains 3314 rules. 7236 rules in the queue.
34400 rules inserted. The rule base contains 3328 rules. 7220 rules in the queue.
34600 rules inserted. The rule base contains 3362 rules. 7173 rules in the queue.
34800 rules inserted. The rule base contains 3386 rules. 7136 rules in the queue.
35000 rules inserted. The rule base contains 3424 rules. 7076 rules in the queue.
35200 rules inserted. The rule base contains 3466 rules. 7008 rules in the queue.
35400 rules inserted. The rule base contains 3486 rules. 6976 rules in the queue.
35600 rules inserted. The rule base contains 3521 rules. 6929 rules in the queue.
35800 rules inserted. The rule base contains 3559 rules. 6868 rules in the queue.
36000 rules inserted. The rule base contains 3587 rules. 6826 rules in the queue.
36200 rules inserted. The rule base contains 3620 rules. 6780 rules in the queue.
36400 rules inserted. The rule base contains 3660 rules. 6721 rules in the queue.
36600 rules inserted. The rule base contains 3691 rules. 6661 rules in the queue.
36800 rules inserted. The rule base contains 3719 rules. 6621 rules in the queue.
37000 rules inserted. The rule base contains 3742 rules. 6597 rules in the queue.
37200 rules inserted. The rule base contains 3771 rules. 6544 rules in the queue.
37400 rules inserted. The rule base contains 3820 rules. 6481 rules in the queue.
37600 rules inserted. The rule base contains 3847 rules. 6432 rules in the queue.
37800 rules inserted. The rule base contains 3889 rules. 6366 rules in the queue.
38000 rules inserted. The rule base contains 3925 rules. 6318 rules in the queue.
38200 rules inserted. The rule base contains 3957 rules. 6286 rules in the queue.
38400 rules inserted. The rule base contains 3997 rules. 6234 rules in the queue.
38600 rules inserted. The rule base contains 4039 rules. 6180 rules in the queue.
38800 rules inserted. The rule base contains 4088 rules. 6126 rules in the queue.
39000 rules inserted. The rule base contains 4123 rules. 6072 rules in the queue.
39200 rules inserted. The rule base contains 4165 rules. 6018 rules in the queue.
39400 rules inserted. The rule base contains 4195 rules. 5988 rules in the queue.
39600 rules inserted. The rule base contains 4231 rules. 5940 rules in the queue.
39800 rules inserted. The rule base contains 4279 rules. 5886 rules in the queue.
40000 rules inserted. The rule base contains 4315 rules. 5832 rules in the queue.
40200 rules inserted. The rule base contains 4357 rules. 5778 rules in the queue.
40400 rules inserted. The rule base contains 4393 rules. 5730 rules in the queue.
40600 rules inserted. The rule base contains 4435 rules. 5688 rules in the queue.
40800 rules inserted. The rule base contains 4466 rules. 5657 rules in the queue.
41000 rules inserted. The rule base contains 4507 rules. 5592 rules in the queue.
41200 rules inserted. The rule base contains 4537 rules. 5560 rules in the queue.
41400 rules inserted. The rule base contains 4583 rules. 5514 rules in the queue.
41600 rules inserted. The rule base contains 4623 rules. 5454 rules in the queue.
41800 rules inserted. The rule base contains 4661 rules. 5400 rules in the queue.
42000 rules inserted. The rule base contains 4695 rules. 5352 rules in the queue.
42200 rules inserted. The rule base contains 4731 rules. 5316 rules in the queue.
42400 rules inserted. The rule base contains 4790 rules. 5244 rules in the queue.
42600 rules inserted. The rule base contains 4807 rules. 5214 rules in the queue.
42800 rules inserted. The rule base contains 4849 rules. 5160 rules in the queue.
43000 rules inserted. The rule base contains 4891 rules. 5106 rules in the queue.
43200 rules inserted. The rule base contains 4919 rules. 5076 rules in the queue.
43400 rules inserted. The rule base contains 4961 rules. 5022 rules in the queue.
43600 rules inserted. The rule base contains 5005 rules. 4954 rules in the queue.
43800 rules inserted. The rule base contains 5039 rules. 4908 rules in the queue.
44000 rules inserted. The rule base contains 5079 rules. 4866 rules in the queue.
44200 rules inserted. The rule base contains 5109 rules. 4834 rules in the queue.
44400 rules inserted. The rule base contains 5165 rules. 4778 rules in the queue.
44600 rules inserted. The rule base contains 5217 rules. 4726 rules in the queue.
44800 rules inserted. The rule base contains 5246 rules. 4697 rules in the queue.
45000 rules inserted. The rule base contains 5281 rules. 4662 rules in the queue.
45200 rules inserted. The rule base contains 5311 rules. 4632 rules in the queue.
45400 rules inserted. The rule base contains 5358 rules. 4585 rules in the queue.
45600 rules inserted. The rule base contains 5412 rules. 4531 rules in the queue.
45800 rules inserted. The rule base contains 5449 rules. 4494 rules in the queue.
46000 rules inserted. The rule base contains 5476 rules. 4467 rules in the queue.
46200 rules inserted. The rule base contains 5506 rules. 4437 rules in the queue.
46400 rules inserted. The rule base contains 5549 rules. 4394 rules in the queue.
46600 rules inserted. The rule base contains 5614 rules. 4329 rules in the queue.
46800 rules inserted. The rule base contains 5662 rules. 4279 rules in the queue.
47000 rules inserted. The rule base contains 5691 rules. 4248 rules in the queue.
47200 rules inserted. The rule base contains 5722 rules. 4215 rules in the queue.
47400 rules inserted. The rule base contains 5774 rules. 4161 rules in the queue.
47600 rules inserted. The rule base contains 5805 rules. 4128 rules in the queue.
47800 rules inserted. The rule base contains 5854 rules. 4077 rules in the queue.
48000 rules inserted. The rule base contains 5881 rules. 4048 rules in the queue.
48200 rules inserted. The rule base contains 5933 rules. 3994 rules in the queue.
48400 rules inserted. The rule base contains 5961 rules. 3964 rules in the queue.
48600 rules inserted. The rule base contains 5994 rules. 3931 rules in the queue.
48800 rules inserted. The rule base contains 6022 rules. 3901 rules in the queue.
49000 rules inserted. The rule base contains 6075 rules. 3845 rules in the queue.
49200 rules inserted. The rule base contains 6195 rules. 3724 rules in the queue.
49400 rules inserted. The rule base contains 6308 rules. 3611 rules in the queue.
49600 rules inserted. The rule base contains 6412 rules. 3507 rules in the queue.
49800 rules inserted. The rule base contains 6509 rules. 3410 rules in the queue.
50000 rules inserted. The rule base contains 6631 rules. 3288 rules in the queue.
50200 rules inserted. The rule base contains 6730 rules. 3189 rules in the queue.
50400 rules inserted. The rule base contains 6830 rules. 3089 rules in the queue.
50600 rules inserted. The rule base contains 6919 rules. 3000 rules in the queue.
50800 rules inserted. The rule base contains 7065 rules. 2854 rules in the queue.
51000 rules inserted. The rule base contains 7157 rules. 2762 rules in the queue.
51200 rules inserted. The rule base contains 7293 rules. 2618 rules in the queue.
51400 rules inserted. The rule base contains 7346 rules. 2560 rules in the queue.
51600 rules inserted. The rule base contains 7455 rules. 2442 rules in the queue.
51800 rules inserted. The rule base contains 7539 rules. 2353 rules in the queue.
52000 rules inserted. The rule base contains 7649 rules. 2237 rules in the queue.
52200 rules inserted. The rule base contains 7756 rules. 2120 rules in the queue.
52400 rules inserted. The rule base contains 7862 rules. 2008 rules in the queue.
52600 rules inserted. The rule base contains 7930 rules. 1935 rules in the queue.
52800 rules inserted. The rule base contains 8054 rules. 1802 rules in the queue.
53000 rules inserted. The rule base contains 8215 rules. 1638 rules in the queue.
53200 rules inserted. The rule base contains 8379 rules. 1474 rules in the queue.
53400 rules inserted. The rule base contains 8545 rules. 1308 rules in the queue.
53600 rules inserted. The rule base contains 8707 rules. 1146 rules in the queue.
53800 rules inserted. The rule base contains 8881 rules. 970 rules in the queue.
54000 rules inserted. The rule base contains 9029 rules. 814 rules in the queue.
54200 rules inserted. The rule base contains 9193 rules. 642 rules in the queue.
54400 rules inserted. The rule base contains 9347 rules. 478 rules in the queue.
54600 rules inserted. The rule base contains 9504 rules. 314 rules in the queue.
54800 rules inserted. The rule base contains 9702 rules. 114 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
goal reachable: attacker(mSrv(pub(skA[]),pub(skC[])))
Abbreviations:
Ns_848241 = Ns_6367[em1_6364 = (OpenSecureChannelRequest,pub(skA[]),g),Sess_5315 = C[],Disco_5314 = A[],Cli_5313 = A[],!1 = @sid_848238]
ST_848242 = ST_6368[em1_6364 = (OpenSecureChannelRequest,pub(skA[]),g),Sess_5315 = C[],Disco_5314 = A[],Cli_5313 = A[],!1 = @sid_848238]
TTL_848243 = TTL_6369[em1_6364 = (OpenSecureChannelRequest,pub(skA[]),g),Sess_5315 = C[],Disco_5314 = A[],Cli_5313 = A[],!1 = @sid_848238]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

6. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

7. By 6, the attacker may know OpenSecureChannelRequest.
By 5, the attacker may know pub(skA[]).
By 4, the attacker may know g.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),g).
attacker((OpenSecureChannelRequest,pub(skA[]),g)).

8. By 5, the attacker may know pub(skA[]).
By 7, the attacker may know (OpenSecureChannelRequest,pub(skA[]),g).
Using the function 2-tuple the attacker may obtain (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g)).
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g))).

9. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {5704}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g)) that the attacker may have by 8 may be received at input {7008}.
So the message (OpenSecureChannelResponse,exp(g,Ns_848241),ST_848242,TTL_848243) may be sent to the attacker at output {7016}.
attacker((OpenSecureChannelResponse,exp(g,Ns_848241),ST_848242,TTL_848243)).

10. By 9, the attacker may know (OpenSecureChannelResponse,exp(g,Ns_848241),ST_848242,TTL_848243).
Using the function 2-proj-4-tuple the attacker may obtain exp(g,Ns_848241).
attacker(exp(g,Ns_848241)).

11. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {5704}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g)) that the attacker may have by 8 may be received at input {7008}.
So the message senc(mSrv(pub(skA[]),pub(skC[])),exp(g,Ns_848241)) may be sent to the attacker at output {7018}.
attacker(senc(mSrv(pub(skA[]),pub(skC[])),exp(g,Ns_848241))).

12. By 11, the attacker may know senc(mSrv(pub(skA[]),pub(skC[])),exp(g,Ns_848241)).
By 10, the attacker may know exp(g,Ns_848241).
Using the function sdec the attacker may obtain mSrv(pub(skA[]),pub(skC[])).
attacker(mSrv(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {5704} in copy a

in(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),g))) at {7008} in copy a

new Ns_6367 creating Ns_848244 at {7011} in copy a

new ST_6368 creating ST_848245 at {7012} in copy a

new TTL_6369 creating TTL_848246 at {7013} in copy a

out(c, (OpenSecureChannelResponse,exp(g,Ns_848244),ST_848245,TTL_848246)) at {7016} in copy a

out(c, senc(mSrv(pub(skA),pub(skC)),exp(g,Ns_848244))) at {7018} in copy a

The attacker has the message mSrv(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is false.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 123 rules. 484 rules in the queue.
400 rules inserted. The rule base contains 143 rules. 484 rules in the queue.
600 rules inserted. The rule base contains 188 rules. 484 rules in the queue.
800 rules inserted. The rule base contains 199 rules. 482 rules in the queue.
1000 rules inserted. The rule base contains 239 rules. 482 rules in the queue.
1200 rules inserted. The rule base contains 239 rules. 472 rules in the queue.
1400 rules inserted. The rule base contains 237 rules. 456 rules in the queue.
1600 rules inserted. The rule base contains 199 rules. 456 rules in the queue.
1800 rules inserted. The rule base contains 263 rules. 584 rules in the queue.
2000 rules inserted. The rule base contains 281 rules. 1152 rules in the queue.
2200 rules inserted. The rule base contains 308 rules. 1524 rules in the queue.
2400 rules inserted. The rule base contains 379 rules. 2744 rules in the queue.
2600 rules inserted. The rule base contains 411 rules. 2935 rules in the queue.
2800 rules inserted. The rule base contains 479 rules. 4157 rules in the queue.
3000 rules inserted. The rule base contains 511 rules. 4344 rules in the queue.
3200 rules inserted. The rule base contains 537 rules. 5590 rules in the queue.
3400 rules inserted. The rule base contains 570 rules. 6356 rules in the queue.
3600 rules inserted. The rule base contains 594 rules. 7123 rules in the queue.
3800 rules inserted. The rule base contains 607 rules. 7212 rules in the queue.
4000 rules inserted. The rule base contains 628 rules. 7210 rules in the queue.
4200 rules inserted. The rule base contains 650 rules. 7210 rules in the queue.
4400 rules inserted. The rule base contains 681 rules. 7302 rules in the queue.
4600 rules inserted. The rule base contains 713 rules. 7396 rules in the queue.
4800 rules inserted. The rule base contains 747 rules. 7584 rules in the queue.
5000 rules inserted. The rule base contains 775 rules. 7584 rules in the queue.
5200 rules inserted. The rule base contains 806 rules. 7676 rules in the queue.
5400 rules inserted. The rule base contains 819 rules. 7669 rules in the queue.
5600 rules inserted. The rule base contains 837 rules. 7761 rules in the queue.
5800 rules inserted. The rule base contains 865 rules. 7761 rules in the queue.
6000 rules inserted. The rule base contains 899 rules. 7949 rules in the queue.
6200 rules inserted. The rule base contains 931 rules. 8043 rules in the queue.
6400 rules inserted. The rule base contains 962 rules. 8135 rules in the queue.
6600 rules inserted. The rule base contains 990 rules. 8135 rules in the queue.
6800 rules inserted. The rule base contains 1019 rules. 8133 rules in the queue.
7000 rules inserted. The rule base contains 1028 rules. 8126 rules in the queue.
7200 rules inserted. The rule base contains 1052 rules. 8314 rules in the queue.
7400 rules inserted. The rule base contains 1068 rules. 8315 rules in the queue.
7600 rules inserted. The rule base contains 1096 rules. 8313 rules in the queue.
7800 rules inserted. The rule base contains 1125 rules. 8311 rules in the queue.
8000 rules inserted. The rule base contains 1154 rules. 8597 rules in the queue.
8200 rules inserted. The rule base contains 1170 rules. 8692 rules in the queue.
8400 rules inserted. The rule base contains 1198 rules. 8690 rules in the queue.
8600 rules inserted. The rule base contains 1227 rules. 8688 rules in the queue.
8800 rules inserted. The rule base contains 1255 rules. 8878 rules in the queue.
9000 rules inserted. The rule base contains 1272 rules. 8879 rules in the queue.
9200 rules inserted. The rule base contains 1300 rules. 8973 rules in the queue.
9400 rules inserted. The rule base contains 1328 rules. 9067 rules in the queue.
9600 rules inserted. The rule base contains 1345 rules. 9066 rules in the queue.
9800 rules inserted. The rule base contains 1374 rules. 9160 rules in the queue.
10000 rules inserted. The rule base contains 1403 rules. 9350 rules in the queue.
10200 rules inserted. The rule base contains 1431 rules. 9444 rules in the queue.
10400 rules inserted. The rule base contains 1447 rules. 9445 rules in the queue.
10600 rules inserted. The rule base contains 1476 rules. 9443 rules in the queue.
10800 rules inserted. The rule base contains 1491 rules. 9442 rules in the queue.
11000 rules inserted. The rule base contains 1510 rules. 9434 rules in the queue.
11200 rules inserted. The rule base contains 1516 rules. 9426 rules in the queue.
11400 rules inserted. The rule base contains 1514 rules. 9420 rules in the queue.
11600 rules inserted. The rule base contains 1528 rules. 9418 rules in the queue.
11800 rules inserted. The rule base contains 1535 rules. 9411 rules in the queue.
12000 rules inserted. The rule base contains 1541 rules. 9409 rules in the queue.
12200 rules inserted. The rule base contains 1552 rules. 9402 rules in the queue.
12400 rules inserted. The rule base contains 1567 rules. 9400 rules in the queue.
12600 rules inserted. The rule base contains 1567 rules. 9392 rules in the queue.
12800 rules inserted. The rule base contains 1581 rules. 9390 rules in the queue.
13000 rules inserted. The rule base contains 1589 rules. 9382 rules in the queue.
13200 rules inserted. The rule base contains 1595 rules. 9375 rules in the queue.
13400 rules inserted. The rule base contains 1606 rules. 9368 rules in the queue.
13600 rules inserted. The rule base contains 1608 rules. 9366 rules in the queue.
13800 rules inserted. The rule base contains 1620 rules. 9359 rules in the queue.
14000 rules inserted. The rule base contains 1634 rules. 9357 rules in the queue.
14200 rules inserted. The rule base contains 1645 rules. 9350 rules in the queue.
14400 rules inserted. The rule base contains 1647 rules. 9348 rules in the queue.
14600 rules inserted. The rule base contains 1658 rules. 9341 rules in the queue.
14800 rules inserted. The rule base contains 1660 rules. 9339 rules in the queue.
15000 rules inserted. The rule base contains 1668 rules. 9331 rules in the queue.
15200 rules inserted. The rule base contains 1679 rules. 9324 rules in the queue.
15400 rules inserted. The rule base contains 1703 rules. 9322 rules in the queue.
15600 rules inserted. The rule base contains 1707 rules. 9309 rules in the queue.
15800 rules inserted. The rule base contains 1707 rules. 9305 rules in the queue.
16000 rules inserted. The rule base contains 1709 rules. 9309 rules in the queue.
16200 rules inserted. The rule base contains 1719 rules. 9309 rules in the queue.
16400 rules inserted. The rule base contains 1738 rules. 9307 rules in the queue.
16600 rules inserted. The rule base contains 1752 rules. 9306 rules in the queue.
16800 rules inserted. The rule base contains 1773 rules. 9299 rules in the queue.
17000 rules inserted. The rule base contains 1775 rules. 9298 rules in the queue.
17200 rules inserted. The rule base contains 1778 rules. 9300 rules in the queue.
17400 rules inserted. The rule base contains 1793 rules. 9299 rules in the queue.
17600 rules inserted. The rule base contains 1810 rules. 9296 rules in the queue.
17800 rules inserted. The rule base contains 1813 rules. 9288 rules in the queue.
18000 rules inserted. The rule base contains 1828 rules. 9289 rules in the queue.
18200 rules inserted. The rule base contains 1829 rules. 9289 rules in the queue.
18400 rules inserted. The rule base contains 1846 rules. 9286 rules in the queue.
18600 rules inserted. The rule base contains 1852 rules. 9281 rules in the queue.
18800 rules inserted. The rule base contains 1854 rules. 9283 rules in the queue.
19000 rules inserted. The rule base contains 1869 rules. 9282 rules in the queue.
19200 rules inserted. The rule base contains 1897 rules. 9280 rules in the queue.
19400 rules inserted. The rule base contains 1899 rules. 9282 rules in the queue.
19600 rules inserted. The rule base contains 1914 rules. 9281 rules in the queue.
19800 rules inserted. The rule base contains 1918 rules. 9269 rules in the queue.
20000 rules inserted. The rule base contains 1920 rules. 9271 rules in the queue.
20200 rules inserted. The rule base contains 1928 rules. 9264 rules in the queue.
20400 rules inserted. The rule base contains 1953 rules. 9228 rules in the queue.
20600 rules inserted. The rule base contains 1981 rules. 9192 rules in the queue.
20800 rules inserted. The rule base contains 1990 rules. 9179 rules in the queue.
21000 rules inserted. The rule base contains 1996 rules. 9172 rules in the queue.
21200 rules inserted. The rule base contains 2003 rules. 9164 rules in the queue.
21400 rules inserted. The rule base contains 2017 rules. 9150 rules in the queue.
21600 rules inserted. The rule base contains 2022 rules. 9144 rules in the queue.
21800 rules inserted. The rule base contains 2031 rules. 9134 rules in the queue.
22000 rules inserted. The rule base contains 2041 rules. 9124 rules in the queue.
22200 rules inserted. The rule base contains 2051 rules. 9113 rules in the queue.
22400 rules inserted. The rule base contains 2077 rules. 9075 rules in the queue.
22600 rules inserted. The rule base contains 2095 rules. 9045 rules in the queue.
22800 rules inserted. The rule base contains 2109 rules. 9031 rules in the queue.
23000 rules inserted. The rule base contains 2115 rules. 9025 rules in the queue.
23200 rules inserted. The rule base contains 2123 rules. 9017 rules in the queue.
23400 rules inserted. The rule base contains 2135 rules. 9004 rules in the queue.
23600 rules inserted. The rule base contains 2142 rules. 8996 rules in the queue.
23800 rules inserted. The rule base contains 2151 rules. 8987 rules in the queue.
24000 rules inserted. The rule base contains 2164 rules. 8974 rules in the queue.
24200 rules inserted. The rule base contains 2177 rules. 8961 rules in the queue.
24400 rules inserted. The rule base contains 2226 rules. 8900 rules in the queue.
24600 rules inserted. The rule base contains 2217 rules. 8897 rules in the queue.
24800 rules inserted. The rule base contains 2231 rules. 8883 rules in the queue.
25000 rules inserted. The rule base contains 2256 rules. 8846 rules in the queue.
25200 rules inserted. The rule base contains 2264 rules. 8822 rules in the queue.
25400 rules inserted. The rule base contains 2275 rules. 8803 rules in the queue.
25600 rules inserted. The rule base contains 2276 rules. 8802 rules in the queue.
25800 rules inserted. The rule base contains 2282 rules. 8795 rules in the queue.
26000 rules inserted. The rule base contains 2289 rules. 8788 rules in the queue.
26200 rules inserted. The rule base contains 2316 rules. 8749 rules in the queue.
26400 rules inserted. The rule base contains 2330 rules. 8735 rules in the queue.
26600 rules inserted. The rule base contains 2339 rules. 8718 rules in the queue.
26800 rules inserted. The rule base contains 2344 rules. 8715 rules in the queue.
27000 rules inserted. The rule base contains 2371 rules. 8676 rules in the queue.
27200 rules inserted. The rule base contains 2374 rules. 8656 rules in the queue.
27400 rules inserted. The rule base contains 2385 rules. 8644 rules in the queue.
27600 rules inserted. The rule base contains 2393 rules. 8636 rules in the queue.
27800 rules inserted. The rule base contains 2418 rules. 8599 rules in the queue.
28000 rules inserted. The rule base contains 2432 rules. 8585 rules in the queue.
28200 rules inserted. The rule base contains 2437 rules. 8573 rules in the queue.
28400 rules inserted. The rule base contains 2439 rules. 8572 rules in the queue.
28600 rules inserted. The rule base contains 2448 rules. 8554 rules in the queue.
28800 rules inserted. The rule base contains 2456 rules. 8547 rules in the queue.
29000 rules inserted. The rule base contains 2483 rules. 8508 rules in the queue.
29200 rules inserted. The rule base contains 2495 rules. 8487 rules in the queue.
29400 rules inserted. The rule base contains 2520 rules. 8450 rules in the queue.
29600 rules inserted. The rule base contains 2561 rules. 8403 rules in the queue.
29800 rules inserted. The rule base contains 2601 rules. 8345 rules in the queue.
30000 rules inserted. The rule base contains 2625 rules. 8297 rules in the queue.
30200 rules inserted. The rule base contains 2671 rules. 8235 rules in the queue.
30400 rules inserted. The rule base contains 2691 rules. 8199 rules in the queue.
30600 rules inserted. The rule base contains 2723 rules. 8139 rules in the queue.
30800 rules inserted. The rule base contains 2742 rules. 8120 rules in the queue.
31000 rules inserted. The rule base contains 2792 rules. 8046 rules in the queue.
31200 rules inserted. The rule base contains 2824 rules. 8001 rules in the queue.
31400 rules inserted. The rule base contains 2845 rules. 7957 rules in the queue.
31600 rules inserted. The rule base contains 2879 rules. 7911 rules in the queue.
31800 rules inserted. The rule base contains 2920 rules. 7851 rules in the queue.
32000 rules inserted. The rule base contains 2939 rules. 7815 rules in the queue.
32200 rules inserted. The rule base contains 2966 rules. 7776 rules in the queue.
32400 rules inserted. The rule base contains 3002 rules. 7716 rules in the queue.
32600 rules inserted. The rule base contains 3050 rules. 7656 rules in the queue.
32800 rules inserted. The rule base contains 3074 rules. 7617 rules in the queue.
33000 rules inserted. The rule base contains 3105 rules. 7557 rules in the queue.
33200 rules inserted. The rule base contains 3140 rules. 7494 rules in the queue.
33400 rules inserted. The rule base contains 3167 rules. 7467 rules in the queue.
33600 rules inserted. The rule base contains 3192 rules. 7430 rules in the queue.
33800 rules inserted. The rule base contains 3248 rules. 7359 rules in the queue.
34000 rules inserted. The rule base contains 3282 rules. 7297 rules in the queue.
34200 rules inserted. The rule base contains 3314 rules. 7236 rules in the queue.
34400 rules inserted. The rule base contains 3328 rules. 7220 rules in the queue.
34600 rules inserted. The rule base contains 3362 rules. 7173 rules in the queue.
34800 rules inserted. The rule base contains 3386 rules. 7136 rules in the queue.
35000 rules inserted. The rule base contains 3424 rules. 7076 rules in the queue.
35200 rules inserted. The rule base contains 3466 rules. 7008 rules in the queue.
35400 rules inserted. The rule base contains 3486 rules. 6976 rules in the queue.
35600 rules inserted. The rule base contains 3521 rules. 6929 rules in the queue.
35800 rules inserted. The rule base contains 3559 rules. 6868 rules in the queue.
36000 rules inserted. The rule base contains 3587 rules. 6826 rules in the queue.
36200 rules inserted. The rule base contains 3620 rules. 6780 rules in the queue.
36400 rules inserted. The rule base contains 3660 rules. 6721 rules in the queue.
36600 rules inserted. The rule base contains 3691 rules. 6661 rules in the queue.
36800 rules inserted. The rule base contains 3719 rules. 6621 rules in the queue.
37000 rules inserted. The rule base contains 3742 rules. 6597 rules in the queue.
37200 rules inserted. The rule base contains 3771 rules. 6544 rules in the queue.
37400 rules inserted. The rule base contains 3820 rules. 6481 rules in the queue.
37600 rules inserted. The rule base contains 3847 rules. 6432 rules in the queue.
37800 rules inserted. The rule base contains 3889 rules. 6366 rules in the queue.
38000 rules inserted. The rule base contains 3925 rules. 6318 rules in the queue.
38200 rules inserted. The rule base contains 3957 rules. 6286 rules in the queue.
38400 rules inserted. The rule base contains 3997 rules. 6234 rules in the queue.
38600 rules inserted. The rule base contains 4039 rules. 6180 rules in the queue.
38800 rules inserted. The rule base contains 4088 rules. 6126 rules in the queue.
39000 rules inserted. The rule base contains 4123 rules. 6072 rules in the queue.
39200 rules inserted. The rule base contains 4165 rules. 6018 rules in the queue.
39400 rules inserted. The rule base contains 4195 rules. 5988 rules in the queue.
39600 rules inserted. The rule base contains 4231 rules. 5940 rules in the queue.
39800 rules inserted. The rule base contains 4279 rules. 5886 rules in the queue.
40000 rules inserted. The rule base contains 4315 rules. 5832 rules in the queue.
40200 rules inserted. The rule base contains 4357 rules. 5778 rules in the queue.
40400 rules inserted. The rule base contains 4393 rules. 5730 rules in the queue.
40600 rules inserted. The rule base contains 4435 rules. 5688 rules in the queue.
40800 rules inserted. The rule base contains 4466 rules. 5657 rules in the queue.
41000 rules inserted. The rule base contains 4507 rules. 5592 rules in the queue.
41200 rules inserted. The rule base contains 4537 rules. 5560 rules in the queue.
41400 rules inserted. The rule base contains 4583 rules. 5514 rules in the queue.
41600 rules inserted. The rule base contains 4623 rules. 5454 rules in the queue.
41800 rules inserted. The rule base contains 4661 rules. 5400 rules in the queue.
42000 rules inserted. The rule base contains 4695 rules. 5352 rules in the queue.
42200 rules inserted. The rule base contains 4731 rules. 5316 rules in the queue.
42400 rules inserted. The rule base contains 4790 rules. 5244 rules in the queue.
42600 rules inserted. The rule base contains 4807 rules. 5214 rules in the queue.
42800 rules inserted. The rule base contains 4849 rules. 5160 rules in the queue.
43000 rules inserted. The rule base contains 4891 rules. 5106 rules in the queue.
43200 rules inserted. The rule base contains 4919 rules. 5076 rules in the queue.
43400 rules inserted. The rule base contains 4961 rules. 5022 rules in the queue.
43600 rules inserted. The rule base contains 5005 rules. 4954 rules in the queue.
43800 rules inserted. The rule base contains 5039 rules. 4908 rules in the queue.
44000 rules inserted. The rule base contains 5079 rules. 4866 rules in the queue.
44200 rules inserted. The rule base contains 5109 rules. 4834 rules in the queue.
44400 rules inserted. The rule base contains 5165 rules. 4778 rules in the queue.
44600 rules inserted. The rule base contains 5217 rules. 4726 rules in the queue.
44800 rules inserted. The rule base contains 5246 rules. 4697 rules in the queue.
45000 rules inserted. The rule base contains 5281 rules. 4662 rules in the queue.
45200 rules inserted. The rule base contains 5311 rules. 4632 rules in the queue.
45400 rules inserted. The rule base contains 5358 rules. 4585 rules in the queue.
45600 rules inserted. The rule base contains 5412 rules. 4531 rules in the queue.
45800 rules inserted. The rule base contains 5449 rules. 4494 rules in the queue.
46000 rules inserted. The rule base contains 5476 rules. 4467 rules in the queue.
46200 rules inserted. The rule base contains 5506 rules. 4437 rules in the queue.
46400 rules inserted. The rule base contains 5549 rules. 4394 rules in the queue.
46600 rules inserted. The rule base contains 5614 rules. 4329 rules in the queue.
46800 rules inserted. The rule base contains 5662 rules. 4279 rules in the queue.
47000 rules inserted. The rule base contains 5691 rules. 4248 rules in the queue.
47200 rules inserted. The rule base contains 5722 rules. 4215 rules in the queue.
47400 rules inserted. The rule base contains 5774 rules. 4161 rules in the queue.
47600 rules inserted. The rule base contains 5805 rules. 4128 rules in the queue.
47800 rules inserted. The rule base contains 5854 rules. 4077 rules in the queue.
48000 rules inserted. The rule base contains 5881 rules. 4048 rules in the queue.
48200 rules inserted. The rule base contains 5933 rules. 3994 rules in the queue.
48400 rules inserted. The rule base contains 5961 rules. 3964 rules in the queue.
48600 rules inserted. The rule base contains 5994 rules. 3931 rules in the queue.
48800 rules inserted. The rule base contains 6022 rules. 3901 rules in the queue.
49000 rules inserted. The rule base contains 6075 rules. 3845 rules in the queue.
49200 rules inserted. The rule base contains 6195 rules. 3724 rules in the queue.
49400 rules inserted. The rule base contains 6308 rules. 3611 rules in the queue.
49600 rules inserted. The rule base contains 6412 rules. 3507 rules in the queue.
49800 rules inserted. The rule base contains 6509 rules. 3410 rules in the queue.
50000 rules inserted. The rule base contains 6631 rules. 3288 rules in the queue.
50200 rules inserted. The rule base contains 6730 rules. 3189 rules in the queue.
50400 rules inserted. The rule base contains 6830 rules. 3089 rules in the queue.
50600 rules inserted. The rule base contains 6919 rules. 3000 rules in the queue.
50800 rules inserted. The rule base contains 7065 rules. 2854 rules in the queue.
51000 rules inserted. The rule base contains 7157 rules. 2762 rules in the queue.
51200 rules inserted. The rule base contains 7293 rules. 2618 rules in the queue.
51400 rules inserted. The rule base contains 7346 rules. 2560 rules in the queue.
51600 rules inserted. The rule base contains 7455 rules. 2442 rules in the queue.
51800 rules inserted. The rule base contains 7539 rules. 2353 rules in the queue.
52000 rules inserted. The rule base contains 7649 rules. 2237 rules in the queue.
52200 rules inserted. The rule base contains 7756 rules. 2120 rules in the queue.
52400 rules inserted. The rule base contains 7862 rules. 2008 rules in the queue.
52600 rules inserted. The rule base contains 7930 rules. 1935 rules in the queue.
52800 rules inserted. The rule base contains 8054 rules. 1802 rules in the queue.
53000 rules inserted. The rule base contains 8215 rules. 1638 rules in the queue.
53200 rules inserted. The rule base contains 8379 rules. 1474 rules in the queue.
53400 rules inserted. The rule base contains 8545 rules. 1308 rules in the queue.
53600 rules inserted. The rule base contains 8707 rules. 1146 rules in the queue.
53800 rules inserted. The rule base contains 8881 rules. 970 rules in the queue.
54000 rules inserted. The rule base contains 9029 rules. 814 rules in the queue.
54200 rules inserted. The rule base contains 9193 rules. 642 rules in the queue.
54400 rules inserted. The rule base contains 9347 rules. 478 rules in the queue.
54600 rules inserted. The rule base contains 9504 rules. 314 rules in the queue.
54800 rules inserted. The rule base contains 9702 rules. 114 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
goal reachable: attacker(mCli(pub(skA[]),pub(skC[])))
Abbreviations:
Nc_1715612 = Nc_536[UP_535 = UP_1715608,SP_534 = SP_1715607,Sess = C[],Disco = A[],Cli = A[],!1 = @sid_1715609]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. The attacker has some term UP_1715608.
attacker(UP_1715608).

5. The attacker has some term SP_1715607.
attacker(SP_1715607).

6. Using the function None the attacker may obtain None.
attacker(None).

7. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skC[]).
By 6, the attacker may know None.
By 5, the attacker may know SP_1715607.
By 4, the attacker may know UP_1715608.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skC[]),None,SP_1715607,UP_1715608).
attacker((GetEndpointResponse,pub(skC[]),None,SP_1715607,UP_1715608)).

10. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_1715607,UP_1715608) that the attacker may have by 9 may be received at input {48}.
So the message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_1715612))) may be sent to the attacker at output {52}.
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_1715612)))).

11. By 10, the attacker may know (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_1715612))).
Using the function 2-proj-2-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_1715612)).
attacker((OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_1715612))).

12. By 11, the attacker may know (OpenSecureChannelRequest,pub(skA[]),exp(g,Nc_1715612)).
Using the function 3-proj-3-tuple the attacker may obtain exp(g,Nc_1715612).
attacker(exp(g,Nc_1715612)).

13. The attacker has some term TTL_1715606.
attacker(TTL_1715606).

14. The attacker has some term ST_1715605.
attacker(ST_1715605).

15. Using the function g the attacker may obtain g.
attacker(g).

16. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

17. By 16, the attacker may know OpenSecureChannelResponse.
By 15, the attacker may know g.
By 14, the attacker may know ST_1715605.
By 13, the attacker may know TTL_1715606.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelResponse,g,ST_1715605,TTL_1715606).
attacker((OpenSecureChannelResponse,g,ST_1715605,TTL_1715606)).

18. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_1715607,UP_1715608) that the attacker may have by 9 may be received at input {48}.
The message (OpenSecureChannelResponse,g,ST_1715605,TTL_1715606) that the attacker may have by 17 may be received at input {53}.
So the message senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_1715612)) may be sent to the attacker at output {57}.
attacker(senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_1715612))).

19. By 18, the attacker may know senc(mCli(pub(skA[]),pub(skC[])),exp(g,Nc_1715612)).
By 12, the attacker may know exp(g,Nc_1715612).
Using the function sdec the attacker may obtain mCli(pub(skA[]),pub(skC[])).
attacker(mCli(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {8} in copy a_1715615

out(c, GetEndpointRequest) at {47} in copy a_1715615

in(c, (GetEndpointResponse,pub(skC),None,a_1715614,a_1715613)) at {48} in copy a_1715615

new Nc_536 creating Nc_1715618 at {49} in copy a_1715615

out(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),exp(g,Nc_1715618)))) at {52} in copy a_1715615

in(c, (OpenSecureChannelResponse,g,a_1715616,a_1715617)) at {53} in copy a_1715615

out(c, senc(mCli(pub(skA),pub(skC)),exp(g,Nc_1715618))) at {57} in copy a_1715615

The attacker has the message mCli(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is false.
