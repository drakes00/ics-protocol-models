Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
{7}new skI: bitstring;
{8}out(c, skI);
(
    {9}!
    {10}in(c, (Cli: host,Disco: host,Sess: host));
    {11}let v_594: bool = (Cli = A) in
    (
        {12}if v_594 then
        (
            {13}let skCli: bitstring = skA in
            {14}let pkCli: bitstring = pub(skCli) in
            {15}let v_595: bool = (Disco = A) in
            (
                {16}if v_595 then
                (
                    {17}let pkDisco: bitstring = pub(skA) in
                    {18}let v_596: bool = (Sess = A) in
                    (
                        {19}if v_596 then
                        (
                            {20}let pkSess: bitstring = pub(skA) in
                            {21}out(c, GetEndpointRequest);
                            {22}in(c, (SPs: bitstring,=SignAndEncrypt,UP: bitstring,=pkSess));
                            {23}new SPc: bitstring;
                            {24}new Nc: bitstring;
                            {25}let gNc: bitstring = exp(g,Nc) in
                            {26}let m1: bitstring = (SPc,gNc) in
                            {27}out(c, (pkCli,enc(m1,pkSess),sign(m1,skCli)));
                            {28}event beginCli(Cli,Sess,gNc);
                            {29}in(c, (ePartS: bitstring,sigPartS: bitstring));
                            {30}let PartS: bitstring = dec(ePartS,skCli) in
                            {31}if (verify(PartS,sigPartS,pkSess) <> true) then
                                0
                            else
                                {32}event endCli(Sess,Cli,PartS)
                        )
                        else
                            {33}let v_597: bool = (Sess = B) in
                            (
                                {34}if v_597 then
                                (
                                    {35}let pkSess_598: bitstring = pub(skB) in
                                    {36}out(c, GetEndpointRequest);
                                    {37}in(c, (SPs_599: bitstring,=SignAndEncrypt,UP_600: bitstring,=pkSess_598));
                                    {38}new SPc_601: bitstring;
                                    {39}new Nc_602: bitstring;
                                    {40}let gNc_603: bitstring = exp(g,Nc_602) in
                                    {41}let m1_604: bitstring = (SPc_601,gNc_603) in
                                    {42}out(c, (pkCli,enc(m1_604,pkSess_598),sign(m1_604,skCli)));
                                    {43}event beginCli(Cli,Sess,gNc_603);
                                    {44}in(c, (ePartS_605: bitstring,sigPartS_606: bitstring));
                                    {45}let PartS_607: bitstring = dec(ePartS_605,skCli) in
                                    {46}if (verify(PartS_607,sigPartS_606,pkSess_598) <> true) then
                                        0
                                    else
                                        {47}event endCli(Sess,Cli,PartS_607)
                                )
                                else
                                    {48}let v_608: bool = (Sess = C) in
                                    (
                                        {49}if v_608 then
                                        (
                                            {50}let pkSess_609: bitstring = pub(skC) in
                                            {51}out(c, GetEndpointRequest);
                                            {52}in(c, (SPs_610: bitstring,=SignAndEncrypt,UP_611: bitstring,=pkSess_609));
                                            {53}new SPc_612: bitstring;
                                            {54}new Nc_613: bitstring;
                                            {55}let gNc_614: bitstring = exp(g,Nc_613) in
                                            {56}let m1_615: bitstring = (SPc_612,gNc_614) in
                                            {57}out(c, (pkCli,enc(m1_615,pkSess_609),sign(m1_615,skCli)));
                                            {58}event beginCli(Cli,Sess,gNc_614);
                                            {59}in(c, (ePartS_616: bitstring,sigPartS_617: bitstring));
                                            {60}let PartS_618: bitstring = dec(ePartS_616,skCli) in
                                            {61}if (verify(PartS_618,sigPartS_617,pkSess_609) <> true) then
                                                0
                                            else
                                                {62}event endCli(Sess,Cli,PartS_618)
                                        )
                                        else
                                            {63}let pkSess_619: bitstring = pub(skI) in
                                            {64}out(c, GetEndpointRequest);
                                            {65}in(c, (SPs_620: bitstring,=SignAndEncrypt,UP_621: bitstring,=pkSess_619));
                                            {66}new SPc_622: bitstring;
                                            {67}new Nc_623: bitstring;
                                            {68}let gNc_624: bitstring = exp(g,Nc_623) in
                                            {69}let m1_625: bitstring = (SPc_622,gNc_624) in
                                            {70}out(c, (pkCli,enc(m1_625,pkSess_619),sign(m1_625,skCli)));
                                            {71}event beginCli(Cli,Sess,gNc_624);
                                            {72}in(c, (ePartS_626: bitstring,sigPartS_627: bitstring));
                                            {73}let PartS_628: bitstring = dec(ePartS_626,skCli) in
                                            {74}if (verify(PartS_628,sigPartS_627,pkSess_619) <> true) then
                                                0
                                            else
                                                {75}event endCli(Sess,Cli,PartS_628)
                                    )
                                    else
                                        {76}let pkSess_629: bitstring = fail-any in
                                        {77}out(c, GetEndpointRequest);
                                        {78}in(c, (SPs_630: bitstring,=SignAndEncrypt,UP_631: bitstring,=pkSess_629));
                                        {79}new SPc_632: bitstring;
                                        {80}new Nc_633: bitstring;
                                        {81}let gNc_634: bitstring = exp(g,Nc_633) in
                                        {82}let m1_635: bitstring = (SPc_632,gNc_634) in
                                        {83}out(c, (pkCli,enc(m1_635,pkSess_629),sign(m1_635,skCli)));
                                        {84}event beginCli(Cli,Sess,gNc_634);
                                        {85}in(c, (ePartS_636: bitstring,sigPartS_637: bitstring));
                                        {86}let PartS_638: bitstring = dec(ePartS_636,skCli) in
                                        {87}if (verify(PartS_638,sigPartS_637,pkSess_629) <> true) then
                                            0
                                        else
                                            {88}event endCli(Sess,Cli,PartS_638)
                            )
                            else
                                {89}let pkSess_639: bitstring = fail-any in
                                {90}out(c, GetEndpointRequest);
                                {91}in(c, (SPs_640: bitstring,=SignAndEncrypt,UP_641: bitstring,=pkSess_639));
                                {92}new SPc_642: bitstring;
                                {93}new Nc_643: bitstring;
                                {94}let gNc_644: bitstring = exp(g,Nc_643) in
                                {95}let m1_645: bitstring = (SPc_642,gNc_644) in
                                {96}out(c, (pkCli,enc(m1_645,pkSess_639),sign(m1_645,skCli)));
                                {97}event beginCli(Cli,Sess,gNc_644);
                                {98}in(c, (ePartS_646: bitstring,sigPartS_647: bitstring));
                                {99}let PartS_648: bitstring = dec(ePartS_646,skCli) in
                                {100}if (verify(PartS_648,sigPartS_647,pkSess_639) <> true) then
                                    0
                                else
                                    {101}event endCli(Sess,Cli,PartS_648)
                    )
                    else
                        {102}let pkSess_649: bitstring = fail-any in
                        {103}out(c, GetEndpointRequest);
                        {104}in(c, (SPs_650: bitstring,=SignAndEncrypt,UP_651: bitstring,=pkSess_649));
                        {105}new SPc_652: bitstring;
                        {106}new Nc_653: bitstring;
                        {107}let gNc_654: bitstring = exp(g,Nc_653) in
                        {108}let m1_655: bitstring = (SPc_652,gNc_654) in
                        {109}out(c, (pkCli,enc(m1_655,pkSess_649),sign(m1_655,skCli)));
                        {110}event beginCli(Cli,Sess,gNc_654);
                        {111}in(c, (ePartS_656: bitstring,sigPartS_657: bitstring));
                        {112}let PartS_658: bitstring = dec(ePartS_656,skCli) in
                        {113}if (verify(PartS_658,sigPartS_657,pkSess_649) <> true) then
                            0
                        else
                            {114}event endCli(Sess,Cli,PartS_658)
                )
                else
                    {115}let v_659: bool = (Disco = B) in
                    (
                        {116}if v_659 then
                        (
                            {117}let pkDisco_660: bitstring = pub(skB) in
                            {118}let v_661: bool = (Sess = A) in
                            (
                                {119}if v_661 then
                                (
                                    {120}let pkSess_662: bitstring = pub(skA) in
                                    {121}out(c, GetEndpointRequest);
                                    {122}in(c, (SPs_663: bitstring,=SignAndEncrypt,UP_664: bitstring,=pkSess_662));
                                    {123}new SPc_665: bitstring;
                                    {124}new Nc_666: bitstring;
                                    {125}let gNc_667: bitstring = exp(g,Nc_666) in
                                    {126}let m1_668: bitstring = (SPc_665,gNc_667) in
                                    {127}out(c, (pkCli,enc(m1_668,pkSess_662),sign(m1_668,skCli)));
                                    {128}event beginCli(Cli,Sess,gNc_667);
                                    {129}in(c, (ePartS_669: bitstring,sigPartS_670: bitstring));
                                    {130}let PartS_671: bitstring = dec(ePartS_669,skCli) in
                                    {131}if (verify(PartS_671,sigPartS_670,pkSess_662) <> true) then
                                        0
                                    else
                                        {132}event endCli(Sess,Cli,PartS_671)
                                )
                                else
                                    {133}let v_672: bool = (Sess = B) in
                                    (
                                        {134}if v_672 then
                                        (
                                            {135}let pkSess_673: bitstring = pub(skB) in
                                            {136}out(c, GetEndpointRequest);
                                            {137}in(c, (SPs_674: bitstring,=SignAndEncrypt,UP_675: bitstring,=pkSess_673));
                                            {138}new SPc_676: bitstring;
                                            {139}new Nc_677: bitstring;
                                            {140}let gNc_678: bitstring = exp(g,Nc_677) in
                                            {141}let m1_679: bitstring = (SPc_676,gNc_678) in
                                            {142}out(c, (pkCli,enc(m1_679,pkSess_673),sign(m1_679,skCli)));
                                            {143}event beginCli(Cli,Sess,gNc_678);
                                            {144}in(c, (ePartS_680: bitstring,sigPartS_681: bitstring));
                                            {145}let PartS_682: bitstring = dec(ePartS_680,skCli) in
                                            {146}if (verify(PartS_682,sigPartS_681,pkSess_673) <> true) then
                                                0
                                            else
                                                {147}event endCli(Sess,Cli,PartS_682)
                                        )
                                        else
                                            {148}let v_683: bool = (Sess = C) in
                                            (
                                                {149}if v_683 then
                                                (
                                                    {150}let pkSess_684: bitstring = pub(skC) in
                                                    {151}out(c, GetEndpointRequest);
                                                    {152}in(c, (SPs_685: bitstring,=SignAndEncrypt,UP_686: bitstring,=pkSess_684));
                                                    {153}new SPc_687: bitstring;
                                                    {154}new Nc_688: bitstring;
                                                    {155}let gNc_689: bitstring = exp(g,Nc_688) in
                                                    {156}let m1_690: bitstring = (SPc_687,gNc_689) in
                                                    {157}out(c, (pkCli,enc(m1_690,pkSess_684),sign(m1_690,skCli)));
                                                    {158}event beginCli(Cli,Sess,gNc_689);
                                                    {159}in(c, (ePartS_691: bitstring,sigPartS_692: bitstring));
                                                    {160}let PartS_693: bitstring = dec(ePartS_691,skCli) in
                                                    {161}if (verify(PartS_693,sigPartS_692,pkSess_684) <> true) then
                                                        0
                                                    else
                                                        {162}event endCli(Sess,Cli,PartS_693)
                                                )
                                                else
                                                    {163}let pkSess_694: bitstring = pub(skI) in
                                                    {164}out(c, GetEndpointRequest);
                                                    {165}in(c, (SPs_695: bitstring,=SignAndEncrypt,UP_696: bitstring,=pkSess_694));
                                                    {166}new SPc_697: bitstring;
                                                    {167}new Nc_698: bitstring;
                                                    {168}let gNc_699: bitstring = exp(g,Nc_698) in
                                                    {169}let m1_700: bitstring = (SPc_697,gNc_699) in
                                                    {170}out(c, (pkCli,enc(m1_700,pkSess_694),sign(m1_700,skCli)));
                                                    {171}event beginCli(Cli,Sess,gNc_699);
                                                    {172}in(c, (ePartS_701: bitstring,sigPartS_702: bitstring));
                                                    {173}let PartS_703: bitstring = dec(ePartS_701,skCli) in
                                                    {174}if (verify(PartS_703,sigPartS_702,pkSess_694) <> true) then
                                                        0
                                                    else
                                                        {175}event endCli(Sess,Cli,PartS_703)
                                            )
                                            else
                                                {176}let pkSess_704: bitstring = fail-any in
                                                {177}out(c, GetEndpointRequest);
                                                {178}in(c, (SPs_705: bitstring,=SignAndEncrypt,UP_706: bitstring,=pkSess_704));
                                                {179}new SPc_707: bitstring;
                                                {180}new Nc_708: bitstring;
                                                {181}let gNc_709: bitstring = exp(g,Nc_708) in
                                                {182}let m1_710: bitstring = (SPc_707,gNc_709) in
                                                {183}out(c, (pkCli,enc(m1_710,pkSess_704),sign(m1_710,skCli)));
                                                {184}event beginCli(Cli,Sess,gNc_709);
                                                {185}in(c, (ePartS_711: bitstring,sigPartS_712: bitstring));
                                                {186}let PartS_713: bitstring = dec(ePartS_711,skCli) in
                                                {187}if (verify(PartS_713,sigPartS_712,pkSess_704) <> true) then
                                                    0
                                                else
                                                    {188}event endCli(Sess,Cli,PartS_713)
                                    )
                                    else
                                        {189}let pkSess_714: bitstring = fail-any in
                                        {190}out(c, GetEndpointRequest);
                                        {191}in(c, (SPs_715: bitstring,=SignAndEncrypt,UP_716: bitstring,=pkSess_714));
                                        {192}new SPc_717: bitstring;
                                        {193}new Nc_718: bitstring;
                                        {194}let gNc_719: bitstring = exp(g,Nc_718) in
                                        {195}let m1_720: bitstring = (SPc_717,gNc_719) in
                                        {196}out(c, (pkCli,enc(m1_720,pkSess_714),sign(m1_720,skCli)));
                                        {197}event beginCli(Cli,Sess,gNc_719);
                                        {198}in(c, (ePartS_721: bitstring,sigPartS_722: bitstring));
                                        {199}let PartS_723: bitstring = dec(ePartS_721,skCli) in
                                        {200}if (verify(PartS_723,sigPartS_722,pkSess_714) <> true) then
                                            0
                                        else
                                            {201}event endCli(Sess,Cli,PartS_723)
                            )
                            else
                                {202}let pkSess_724: bitstring = fail-any in
                                {203}out(c, GetEndpointRequest);
                                {204}in(c, (SPs_725: bitstring,=SignAndEncrypt,UP_726: bitstring,=pkSess_724));
                                {205}new SPc_727: bitstring;
                                {206}new Nc_728: bitstring;
                                {207}let gNc_729: bitstring = exp(g,Nc_728) in
                                {208}let m1_730: bitstring = (SPc_727,gNc_729) in
                                {209}out(c, (pkCli,enc(m1_730,pkSess_724),sign(m1_730,skCli)));
                                {210}event beginCli(Cli,Sess,gNc_729);
                                {211}in(c, (ePartS_731: bitstring,sigPartS_732: bitstring));
                                {212}let PartS_733: bitstring = dec(ePartS_731,skCli) in
                                {213}if (verify(PartS_733,sigPartS_732,pkSess_724) <> true) then
                                    0
                                else
                                    {214}event endCli(Sess,Cli,PartS_733)
                        )
                        else
                            {215}let v_734: bool = (Disco = C) in
                            (
                                {216}if v_734 then
                                (
                                    {217}let pkDisco_735: bitstring = pub(skC) in
                                    {218}let v_736: bool = (Sess = A) in
                                    (
                                        {219}if v_736 then
                                        (
                                            {220}let pkSess_737: bitstring = pub(skA) in
                                            {221}out(c, GetEndpointRequest);
                                            {222}in(c, (SPs_738: bitstring,=SignAndEncrypt,UP_739: bitstring,=pkSess_737));
                                            {223}new SPc_740: bitstring;
                                            {224}new Nc_741: bitstring;
                                            {225}let gNc_742: bitstring = exp(g,Nc_741) in
                                            {226}let m1_743: bitstring = (SPc_740,gNc_742) in
                                            {227}out(c, (pkCli,enc(m1_743,pkSess_737),sign(m1_743,skCli)));
                                            {228}event beginCli(Cli,Sess,gNc_742);
                                            {229}in(c, (ePartS_744: bitstring,sigPartS_745: bitstring));
                                            {230}let PartS_746: bitstring = dec(ePartS_744,skCli) in
                                            {231}if (verify(PartS_746,sigPartS_745,pkSess_737) <> true) then
                                                0
                                            else
                                                {232}event endCli(Sess,Cli,PartS_746)
                                        )
                                        else
                                            {233}let v_747: bool = (Sess = B) in
                                            (
                                                {234}if v_747 then
                                                (
                                                    {235}let pkSess_748: bitstring = pub(skB) in
                                                    {236}out(c, GetEndpointRequest);
                                                    {237}in(c, (SPs_749: bitstring,=SignAndEncrypt,UP_750: bitstring,=pkSess_748));
                                                    {238}new SPc_751: bitstring;
                                                    {239}new Nc_752: bitstring;
                                                    {240}let gNc_753: bitstring = exp(g,Nc_752) in
                                                    {241}let m1_754: bitstring = (SPc_751,gNc_753) in
                                                    {242}out(c, (pkCli,enc(m1_754,pkSess_748),sign(m1_754,skCli)));
                                                    {243}event beginCli(Cli,Sess,gNc_753);
                                                    {244}in(c, (ePartS_755: bitstring,sigPartS_756: bitstring));
                                                    {245}let PartS_757: bitstring = dec(ePartS_755,skCli) in
                                                    {246}if (verify(PartS_757,sigPartS_756,pkSess_748) <> true) then
                                                        0
                                                    else
                                                        {247}event endCli(Sess,Cli,PartS_757)
                                                )
                                                else
                                                    {248}let v_758: bool = (Sess = C) in
                                                    (
                                                        {249}if v_758 then
                                                        (
                                                            {250}let pkSess_759: bitstring = pub(skC) in
                                                            {251}out(c, GetEndpointRequest);
                                                            {252}in(c, (SPs_760: bitstring,=SignAndEncrypt,UP_761: bitstring,=pkSess_759));
                                                            {253}new SPc_762: bitstring;
                                                            {254}new Nc_763: bitstring;
                                                            {255}let gNc_764: bitstring = exp(g,Nc_763) in
                                                            {256}let m1_765: bitstring = (SPc_762,gNc_764) in
                                                            {257}out(c, (pkCli,enc(m1_765,pkSess_759),sign(m1_765,skCli)));
                                                            {258}event beginCli(Cli,Sess,gNc_764);
                                                            {259}in(c, (ePartS_766: bitstring,sigPartS_767: bitstring));
                                                            {260}let PartS_768: bitstring = dec(ePartS_766,skCli) in
                                                            {261}if (verify(PartS_768,sigPartS_767,pkSess_759) <> true) then
                                                                0
                                                            else
                                                                {262}event endCli(Sess,Cli,PartS_768)
                                                        )
                                                        else
                                                            {263}let pkSess_769: bitstring = pub(skI) in
                                                            {264}out(c, GetEndpointRequest);
                                                            {265}in(c, (SPs_770: bitstring,=SignAndEncrypt,UP_771: bitstring,=pkSess_769));
                                                            {266}new SPc_772: bitstring;
                                                            {267}new Nc_773: bitstring;
                                                            {268}let gNc_774: bitstring = exp(g,Nc_773) in
                                                            {269}let m1_775: bitstring = (SPc_772,gNc_774) in
                                                            {270}out(c, (pkCli,enc(m1_775,pkSess_769),sign(m1_775,skCli)));
                                                            {271}event beginCli(Cli,Sess,gNc_774);
                                                            {272}in(c, (ePartS_776: bitstring,sigPartS_777: bitstring));
                                                            {273}let PartS_778: bitstring = dec(ePartS_776,skCli) in
                                                            {274}if (verify(PartS_778,sigPartS_777,pkSess_769) <> true) then
                                                                0
                                                            else
                                                                {275}event endCli(Sess,Cli,PartS_778)
                                                    )
                                                    else
                                                        {276}let pkSess_779: bitstring = fail-any in
                                                        {277}out(c, GetEndpointRequest);
                                                        {278}in(c, (SPs_780: bitstring,=SignAndEncrypt,UP_781: bitstring,=pkSess_779));
                                                        {279}new SPc_782: bitstring;
                                                        {280}new Nc_783: bitstring;
                                                        {281}let gNc_784: bitstring = exp(g,Nc_783) in
                                                        {282}let m1_785: bitstring = (SPc_782,gNc_784) in
                                                        {283}out(c, (pkCli,enc(m1_785,pkSess_779),sign(m1_785,skCli)));
                                                        {284}event beginCli(Cli,Sess,gNc_784);
                                                        {285}in(c, (ePartS_786: bitstring,sigPartS_787: bitstring));
                                                        {286}let PartS_788: bitstring = dec(ePartS_786,skCli) in
                                                        {287}if (verify(PartS_788,sigPartS_787,pkSess_779) <> true) then
                                                            0
                                                        else
                                                            {288}event endCli(Sess,Cli,PartS_788)
                                            )
                                            else
                                                {289}let pkSess_789: bitstring = fail-any in
                                                {290}out(c, GetEndpointRequest);
                                                {291}in(c, (SPs_790: bitstring,=SignAndEncrypt,UP_791: bitstring,=pkSess_789));
                                                {292}new SPc_792: bitstring;
                                                {293}new Nc_793: bitstring;
                                                {294}let gNc_794: bitstring = exp(g,Nc_793) in
                                                {295}let m1_795: bitstring = (SPc_792,gNc_794) in
                                                {296}out(c, (pkCli,enc(m1_795,pkSess_789),sign(m1_795,skCli)));
                                                {297}event beginCli(Cli,Sess,gNc_794);
                                                {298}in(c, (ePartS_796: bitstring,sigPartS_797: bitstring));
                                                {299}let PartS_798: bitstring = dec(ePartS_796,skCli) in
                                                {300}if (verify(PartS_798,sigPartS_797,pkSess_789) <> true) then
                                                    0
                                                else
                                                    {301}event endCli(Sess,Cli,PartS_798)
                                    )
                                    else
                                        {302}let pkSess_799: bitstring = fail-any in
                                        {303}out(c, GetEndpointRequest);
                                        {304}in(c, (SPs_800: bitstring,=SignAndEncrypt,UP_801: bitstring,=pkSess_799));
                                        {305}new SPc_802: bitstring;
                                        {306}new Nc_803: bitstring;
                                        {307}let gNc_804: bitstring = exp(g,Nc_803) in
                                        {308}let m1_805: bitstring = (SPc_802,gNc_804) in
                                        {309}out(c, (pkCli,enc(m1_805,pkSess_799),sign(m1_805,skCli)));
                                        {310}event beginCli(Cli,Sess,gNc_804);
                                        {311}in(c, (ePartS_806: bitstring,sigPartS_807: bitstring));
                                        {312}let PartS_808: bitstring = dec(ePartS_806,skCli) in
                                        {313}if (verify(PartS_808,sigPartS_807,pkSess_799) <> true) then
                                            0
                                        else
                                            {314}event endCli(Sess,Cli,PartS_808)
                                )
                                else
                                    {315}let pkDisco_809: bitstring = pub(skI) in
                                    {316}let v_810: bool = (Sess = A) in
                                    (
                                        {317}if v_810 then
                                        (
                                            {318}let pkSess_811: bitstring = pub(skA) in
                                            {319}out(c, GetEndpointRequest);
                                            {320}in(c, (SPs_812: bitstring,=SignAndEncrypt,UP_813: bitstring,=pkSess_811));
                                            {321}new SPc_814: bitstring;
                                            {322}new Nc_815: bitstring;
                                            {323}let gNc_816: bitstring = exp(g,Nc_815) in
                                            {324}let m1_817: bitstring = (SPc_814,gNc_816) in
                                            {325}out(c, (pkCli,enc(m1_817,pkSess_811),sign(m1_817,skCli)));
                                            {326}event beginCli(Cli,Sess,gNc_816);
                                            {327}in(c, (ePartS_818: bitstring,sigPartS_819: bitstring));
                                            {328}let PartS_820: bitstring = dec(ePartS_818,skCli) in
                                            {329}if (verify(PartS_820,sigPartS_819,pkSess_811) <> true) then
                                                0
                                            else
                                                {330}event endCli(Sess,Cli,PartS_820)
                                        )
                                        else
                                            {331}let v_821: bool = (Sess = B) in
                                            (
                                                {332}if v_821 then
                                                (
                                                    {333}let pkSess_822: bitstring = pub(skB) in
                                                    {334}out(c, GetEndpointRequest);
                                                    {335}in(c, (SPs_823: bitstring,=SignAndEncrypt,UP_824: bitstring,=pkSess_822));
                                                    {336}new SPc_825: bitstring;
                                                    {337}new Nc_826: bitstring;
                                                    {338}let gNc_827: bitstring = exp(g,Nc_826) in
                                                    {339}let m1_828: bitstring = (SPc_825,gNc_827) in
                                                    {340}out(c, (pkCli,enc(m1_828,pkSess_822),sign(m1_828,skCli)));
                                                    {341}event beginCli(Cli,Sess,gNc_827);
                                                    {342}in(c, (ePartS_829: bitstring,sigPartS_830: bitstring));
                                                    {343}let PartS_831: bitstring = dec(ePartS_829,skCli) in
                                                    {344}if (verify(PartS_831,sigPartS_830,pkSess_822) <> true) then
                                                        0
                                                    else
                                                        {345}event endCli(Sess,Cli,PartS_831)
                                                )
                                                else
                                                    {346}let v_832: bool = (Sess = C) in
                                                    (
                                                        {347}if v_832 then
                                                        (
                                                            {348}let pkSess_833: bitstring = pub(skC) in
                                                            {349}out(c, GetEndpointRequest);
                                                            {350}in(c, (SPs_834: bitstring,=SignAndEncrypt,UP_835: bitstring,=pkSess_833));
                                                            {351}new SPc_836: bitstring;
                                                            {352}new Nc_837: bitstring;
                                                            {353}let gNc_838: bitstring = exp(g,Nc_837) in
                                                            {354}let m1_839: bitstring = (SPc_836,gNc_838) in
                                                            {355}out(c, (pkCli,enc(m1_839,pkSess_833),sign(m1_839,skCli)));
                                                            {356}event beginCli(Cli,Sess,gNc_838);
                                                            {357}in(c, (ePartS_840: bitstring,sigPartS_841: bitstring));
                                                            {358}let PartS_842: bitstring = dec(ePartS_840,skCli) in
                                                            {359}if (verify(PartS_842,sigPartS_841,pkSess_833) <> true) then
                                                                0
                                                            else
                                                                {360}event endCli(Sess,Cli,PartS_842)
                                                        )
                                                        else
                                                            {361}let pkSess_843: bitstring = pub(skI) in
                                                            {362}out(c, GetEndpointRequest);
                                                            {363}in(c, (SPs_844: bitstring,=SignAndEncrypt,UP_845: bitstring,=pkSess_843));
                                                            {364}new SPc_846: bitstring;
                                                            {365}new Nc_847: bitstring;
                                                            {366}let gNc_848: bitstring = exp(g,Nc_847) in
                                                            {367}let m1_849: bitstring = (SPc_846,gNc_848) in
                                                            {368}out(c, (pkCli,enc(m1_849,pkSess_843),sign(m1_849,skCli)));
                                                            {369}event beginCli(Cli,Sess,gNc_848);
                                                            {370}in(c, (ePartS_850: bitstring,sigPartS_851: bitstring));
                                                            {371}let PartS_852: bitstring = dec(ePartS_850,skCli) in
                                                            {372}if (verify(PartS_852,sigPartS_851,pkSess_843) <> true) then
                                                                0
                                                            else
                                                                {373}event endCli(Sess,Cli,PartS_852)
                                                    )
                                                    else
                                                        {374}let pkSess_853: bitstring = fail-any in
                                                        {375}out(c, GetEndpointRequest);
                                                        {376}in(c, (SPs_854: bitstring,=SignAndEncrypt,UP_855: bitstring,=pkSess_853));
                                                        {377}new SPc_856: bitstring;
                                                        {378}new Nc_857: bitstring;
                                                        {379}let gNc_858: bitstring = exp(g,Nc_857) in
                                                        {380}let m1_859: bitstring = (SPc_856,gNc_858) in
                                                        {381}out(c, (pkCli,enc(m1_859,pkSess_853),sign(m1_859,skCli)));
                                                        {382}event beginCli(Cli,Sess,gNc_858);
                                                        {383}in(c, (ePartS_860: bitstring,sigPartS_861: bitstring));
                                                        {384}let PartS_862: bitstring = dec(ePartS_860,skCli) in
                                                        {385}if (verify(PartS_862,sigPartS_861,pkSess_853) <> true) then
                                                            0
                                                        else
                                                            {386}event endCli(Sess,Cli,PartS_862)
                                            )
                                            else
                                                {387}let pkSess_863: bitstring = fail-any in
                                                {388}out(c, GetEndpointRequest);
                                                {389}in(c, (SPs_864: bitstring,=SignAndEncrypt,UP_865: bitstring,=pkSess_863));
                                                {390}new SPc_866: bitstring;
                                                {391}new Nc_867: bitstring;
                                                {392}let gNc_868: bitstring = exp(g,Nc_867) in
                                                {393}let m1_869: bitstring = (SPc_866,gNc_868) in
                                                {394}out(c, (pkCli,enc(m1_869,pkSess_863),sign(m1_869,skCli)));
                                                {395}event beginCli(Cli,Sess,gNc_868);
                                                {396}in(c, (ePartS_870: bitstring,sigPartS_871: bitstring));
                                                {397}let PartS_872: bitstring = dec(ePartS_870,skCli) in
                                                {398}if (verify(PartS_872,sigPartS_871,pkSess_863) <> true) then
                                                    0
                                                else
                                                    {399}event endCli(Sess,Cli,PartS_872)
                                    )
                                    else
                                        {400}let pkSess_873: bitstring = fail-any in
                                        {401}out(c, GetEndpointRequest);
                                        {402}in(c, (SPs_874: bitstring,=SignAndEncrypt,UP_875: bitstring,=pkSess_873));
                                        {403}new SPc_876: bitstring;
                                        {404}new Nc_877: bitstring;
                                        {405}let gNc_878: bitstring = exp(g,Nc_877) in
                                        {406}let m1_879: bitstring = (SPc_876,gNc_878) in
                                        {407}out(c, (pkCli,enc(m1_879,pkSess_873),sign(m1_879,skCli)));
                                        {408}event beginCli(Cli,Sess,gNc_878);
                                        {409}in(c, (ePartS_880: bitstring,sigPartS_881: bitstring));
                                        {410}let PartS_882: bitstring = dec(ePartS_880,skCli) in
                                        {411}if (verify(PartS_882,sigPartS_881,pkSess_873) <> true) then
                                            0
                                        else
                                            {412}event endCli(Sess,Cli,PartS_882)
                            )
                            else
                                {413}let pkDisco_883: bitstring = fail-any in
                                {414}let v_884: bool = (Sess = A) in
                                (
                                    {415}if v_884 then
                                    (
                                        {416}let pkSess_885: bitstring = pub(skA) in
                                        {417}out(c, GetEndpointRequest);
                                        {418}in(c, (SPs_886: bitstring,=SignAndEncrypt,UP_887: bitstring,=pkSess_885));
                                        {419}new SPc_888: bitstring;
                                        {420}new Nc_889: bitstring;
                                        {421}let gNc_890: bitstring = exp(g,Nc_889) in
                                        {422}let m1_891: bitstring = (SPc_888,gNc_890) in
                                        {423}out(c, (pkCli,enc(m1_891,pkSess_885),sign(m1_891,skCli)));
                                        {424}event beginCli(Cli,Sess,gNc_890);
                                        {425}in(c, (ePartS_892: bitstring,sigPartS_893: bitstring));
                                        {426}let PartS_894: bitstring = dec(ePartS_892,skCli) in
                                        {427}if (verify(PartS_894,sigPartS_893,pkSess_885) <> true) then
                                            0
                                        else
                                            {428}event endCli(Sess,Cli,PartS_894)
                                    )
                                    else
                                        {429}let v_895: bool = (Sess = B) in
                                        (
                                            {430}if v_895 then
                                            (
                                                {431}let pkSess_896: bitstring = pub(skB) in
                                                {432}out(c, GetEndpointRequest);
                                                {433}in(c, (SPs_897: bitstring,=SignAndEncrypt,UP_898: bitstring,=pkSess_896));
                                                {434}new SPc_899: bitstring;
                                                {435}new Nc_900: bitstring;
                                                {436}let gNc_901: bitstring = exp(g,Nc_900) in
                                                {437}let m1_902: bitstring = (SPc_899,gNc_901) in
                                                {438}out(c, (pkCli,enc(m1_902,pkSess_896),sign(m1_902,skCli)));
                                                {439}event beginCli(Cli,Sess,gNc_901);
                                                {440}in(c, (ePartS_903: bitstring,sigPartS_904: bitstring));
                                                {441}let PartS_905: bitstring = dec(ePartS_903,skCli) in
                                                {442}if (verify(PartS_905,sigPartS_904,pkSess_896) <> true) then
                                                    0
                                                else
                                                    {443}event endCli(Sess,Cli,PartS_905)
                                            )
                                            else
                                                {444}let v_906: bool = (Sess = C) in
                                                (
                                                    {445}if v_906 then
                                                    (
                                                        {446}let pkSess_907: bitstring = pub(skC) in
                                                        {447}out(c, GetEndpointRequest);
                                                        {448}in(c, (SPs_908: bitstring,=SignAndEncrypt,UP_909: bitstring,=pkSess_907));
                                                        {449}new SPc_910: bitstring;
                                                        {450}new Nc_911: bitstring;
                                                        {451}let gNc_912: bitstring = exp(g,Nc_911) in
                                                        {452}let m1_913: bitstring = (SPc_910,gNc_912) in
                                                        {453}out(c, (pkCli,enc(m1_913,pkSess_907),sign(m1_913,skCli)));
                                                        {454}event beginCli(Cli,Sess,gNc_912);
                                                        {455}in(c, (ePartS_914: bitstring,sigPartS_915: bitstring));
                                                        {456}let PartS_916: bitstring = dec(ePartS_914,skCli) in
                                                        {457}if (verify(PartS_916,sigPartS_915,pkSess_907) <> true) then
                                                            0
                                                        else
                                                            {458}event endCli(Sess,Cli,PartS_916)
                                                    )
                                                    else
                                                        {459}let pkSess_917: bitstring = pub(skI) in
                                                        {460}out(c, GetEndpointRequest);
                                                        {461}in(c, (SPs_918: bitstring,=SignAndEncrypt,UP_919: bitstring,=pkSess_917));
                                                        {462}new SPc_920: bitstring;
                                                        {463}new Nc_921: bitstring;
                                                        {464}let gNc_922: bitstring = exp(g,Nc_921) in
                                                        {465}let m1_923: bitstring = (SPc_920,gNc_922) in
                                                        {466}out(c, (pkCli,enc(m1_923,pkSess_917),sign(m1_923,skCli)));
                                                        {467}event beginCli(Cli,Sess,gNc_922);
                                                        {468}in(c, (ePartS_924: bitstring,sigPartS_925: bitstring));
                                                        {469}let PartS_926: bitstring = dec(ePartS_924,skCli) in
                                                        {470}if (verify(PartS_926,sigPartS_925,pkSess_917) <> true) then
                                                            0
                                                        else
                                                            {471}event endCli(Sess,Cli,PartS_926)
                                                )
                                                else
                                                    {472}let pkSess_927: bitstring = fail-any in
                                                    {473}out(c, GetEndpointRequest);
                                                    {474}in(c, (SPs_928: bitstring,=SignAndEncrypt,UP_929: bitstring,=pkSess_927));
                                                    {475}new SPc_930: bitstring;
                                                    {476}new Nc_931: bitstring;
                                                    {477}let gNc_932: bitstring = exp(g,Nc_931) in
                                                    {478}let m1_933: bitstring = (SPc_930,gNc_932) in
                                                    {479}out(c, (pkCli,enc(m1_933,pkSess_927),sign(m1_933,skCli)));
                                                    {480}event beginCli(Cli,Sess,gNc_932);
                                                    {481}in(c, (ePartS_934: bitstring,sigPartS_935: bitstring));
                                                    {482}let PartS_936: bitstring = dec(ePartS_934,skCli) in
                                                    {483}if (verify(PartS_936,sigPartS_935,pkSess_927) <> true) then
                                                        0
                                                    else
                                                        {484}event endCli(Sess,Cli,PartS_936)
                                        )
                                        else
                                            {485}let pkSess_937: bitstring = fail-any in
                                            {486}out(c, GetEndpointRequest);
                                            {487}in(c, (SPs_938: bitstring,=SignAndEncrypt,UP_939: bitstring,=pkSess_937));
                                            {488}new SPc_940: bitstring;
                                            {489}new Nc_941: bitstring;
                                            {490}let gNc_942: bitstring = exp(g,Nc_941) in
                                            {491}let m1_943: bitstring = (SPc_940,gNc_942) in
                                            {492}out(c, (pkCli,enc(m1_943,pkSess_937),sign(m1_943,skCli)));
                                            {493}event beginCli(Cli,Sess,gNc_942);
                                            {494}in(c, (ePartS_944: bitstring,sigPartS_945: bitstring));
                                            {495}let PartS_946: bitstring = dec(ePartS_944,skCli) in
                                            {496}if (verify(PartS_946,sigPartS_945,pkSess_937) <> true) then
                                                0
                                            else
                                                {497}event endCli(Sess,Cli,PartS_946)
                                )
                                else
                                    {498}let pkSess_947: bitstring = fail-any in
                                    {499}out(c, GetEndpointRequest);
                                    {500}in(c, (SPs_948: bitstring,=SignAndEncrypt,UP_949: bitstring,=pkSess_947));
                                    {501}new SPc_950: bitstring;
                                    {502}new Nc_951: bitstring;
                                    {503}let gNc_952: bitstring = exp(g,Nc_951) in
                                    {504}let m1_953: bitstring = (SPc_950,gNc_952) in
                                    {505}out(c, (pkCli,enc(m1_953,pkSess_947),sign(m1_953,skCli)));
                                    {506}event beginCli(Cli,Sess,gNc_952);
                                    {507}in(c, (ePartS_954: bitstring,sigPartS_955: bitstring));
                                    {508}let PartS_956: bitstring = dec(ePartS_954,skCli) in
                                    {509}if (verify(PartS_956,sigPartS_955,pkSess_947) <> true) then
                                        0
                                    else
                                        {510}event endCli(Sess,Cli,PartS_956)
                    )
                    else
                        {511}let pkDisco_957: bitstring = fail-any in
                        {512}let v_958: bool = (Sess = A) in
                        (
                            {513}if v_958 then
                            (
                                {514}let pkSess_959: bitstring = pub(skA) in
                                {515}out(c, GetEndpointRequest);
                                {516}in(c, (SPs_960: bitstring,=SignAndEncrypt,UP_961: bitstring,=pkSess_959));
                                {517}new SPc_962: bitstring;
                                {518}new Nc_963: bitstring;
                                {519}let gNc_964: bitstring = exp(g,Nc_963) in
                                {520}let m1_965: bitstring = (SPc_962,gNc_964) in
                                {521}out(c, (pkCli,enc(m1_965,pkSess_959),sign(m1_965,skCli)));
                                {522}event beginCli(Cli,Sess,gNc_964);
                                {523}in(c, (ePartS_966: bitstring,sigPartS_967: bitstring));
                                {524}let PartS_968: bitstring = dec(ePartS_966,skCli) in
                                {525}if (verify(PartS_968,sigPartS_967,pkSess_959) <> true) then
                                    0
                                else
                                    {526}event endCli(Sess,Cli,PartS_968)
                            )
                            else
                                {527}let v_969: bool = (Sess = B) in
                                (
                                    {528}if v_969 then
                                    (
                                        {529}let pkSess_970: bitstring = pub(skB) in
                                        {530}out(c, GetEndpointRequest);
                                        {531}in(c, (SPs_971: bitstring,=SignAndEncrypt,UP_972: bitstring,=pkSess_970));
                                        {532}new SPc_973: bitstring;
                                        {533}new Nc_974: bitstring;
                                        {534}let gNc_975: bitstring = exp(g,Nc_974) in
                                        {535}let m1_976: bitstring = (SPc_973,gNc_975) in
                                        {536}out(c, (pkCli,enc(m1_976,pkSess_970),sign(m1_976,skCli)));
                                        {537}event beginCli(Cli,Sess,gNc_975);
                                        {538}in(c, (ePartS_977: bitstring,sigPartS_978: bitstring));
                                        {539}let PartS_979: bitstring = dec(ePartS_977,skCli) in
                                        {540}if (verify(PartS_979,sigPartS_978,pkSess_970) <> true) then
                                            0
                                        else
                                            {541}event endCli(Sess,Cli,PartS_979)
                                    )
                                    else
                                        {542}let v_980: bool = (Sess = C) in
                                        (
                                            {543}if v_980 then
                                            (
                                                {544}let pkSess_981: bitstring = pub(skC) in
                                                {545}out(c, GetEndpointRequest);
                                                {546}in(c, (SPs_982: bitstring,=SignAndEncrypt,UP_983: bitstring,=pkSess_981));
                                                {547}new SPc_984: bitstring;
                                                {548}new Nc_985: bitstring;
                                                {549}let gNc_986: bitstring = exp(g,Nc_985) in
                                                {550}let m1_987: bitstring = (SPc_984,gNc_986) in
                                                {551}out(c, (pkCli,enc(m1_987,pkSess_981),sign(m1_987,skCli)));
                                                {552}event beginCli(Cli,Sess,gNc_986);
                                                {553}in(c, (ePartS_988: bitstring,sigPartS_989: bitstring));
                                                {554}let PartS_990: bitstring = dec(ePartS_988,skCli) in
                                                {555}if (verify(PartS_990,sigPartS_989,pkSess_981) <> true) then
                                                    0
                                                else
                                                    {556}event endCli(Sess,Cli,PartS_990)
                                            )
                                            else
                                                {557}let pkSess_991: bitstring = pub(skI) in
                                                {558}out(c, GetEndpointRequest);
                                                {559}in(c, (SPs_992: bitstring,=SignAndEncrypt,UP_993: bitstring,=pkSess_991));
                                                {560}new SPc_994: bitstring;
                                                {561}new Nc_995: bitstring;
                                                {562}let gNc_996: bitstring = exp(g,Nc_995) in
                                                {563}let m1_997: bitstring = (SPc_994,gNc_996) in
                                                {564}out(c, (pkCli,enc(m1_997,pkSess_991),sign(m1_997,skCli)));
                                                {565}event beginCli(Cli,Sess,gNc_996);
                                                {566}in(c, (ePartS_998: bitstring,sigPartS_999: bitstring));
                                                {567}let PartS_1000: bitstring = dec(ePartS_998,skCli) in
                                                {568}if (verify(PartS_1000,sigPartS_999,pkSess_991) <> true) then
                                                    0
                                                else
                                                    {569}event endCli(Sess,Cli,PartS_1000)
                                        )
                                        else
                                            {570}let pkSess_1001: bitstring = fail-any in
                                            {571}out(c, GetEndpointRequest);
                                            {572}in(c, (SPs_1002: bitstring,=SignAndEncrypt,UP_1003: bitstring,=pkSess_1001));
                                            {573}new SPc_1004: bitstring;
                                            {574}new Nc_1005: bitstring;
                                            {575}let gNc_1006: bitstring = exp(g,Nc_1005) in
                                            {576}let m1_1007: bitstring = (SPc_1004,gNc_1006) in
                                            {577}out(c, (pkCli,enc(m1_1007,pkSess_1001),sign(m1_1007,skCli)));
                                            {578}event beginCli(Cli,Sess,gNc_1006);
                                            {579}in(c, (ePartS_1008: bitstring,sigPartS_1009: bitstring));
                                            {580}let PartS_1010: bitstring = dec(ePartS_1008,skCli) in
                                            {581}if (verify(PartS_1010,sigPartS_1009,pkSess_1001) <> true) then
                                                0
                                            else
                                                {582}event endCli(Sess,Cli,PartS_1010)
                                )
                                else
                                    {583}let pkSess_1011: bitstring = fail-any in
                                    {584}out(c, GetEndpointRequest);
                                    {585}in(c, (SPs_1012: bitstring,=SignAndEncrypt,UP_1013: bitstring,=pkSess_1011));
                                    {586}new SPc_1014: bitstring;
                                    {587}new Nc_1015: bitstring;
                                    {588}let gNc_1016: bitstring = exp(g,Nc_1015) in
                                    {589}let m1_1017: bitstring = (SPc_1014,gNc_1016) in
                                    {590}out(c, (pkCli,enc(m1_1017,pkSess_1011),sign(m1_1017,skCli)));
                                    {591}event beginCli(Cli,Sess,gNc_1016);
                                    {592}in(c, (ePartS_1018: bitstring,sigPartS_1019: bitstring));
                                    {593}let PartS_1020: bitstring = dec(ePartS_1018,skCli) in
                                    {594}if (verify(PartS_1020,sigPartS_1019,pkSess_1011) <> true) then
                                        0
                                    else
                                        {595}event endCli(Sess,Cli,PartS_1020)
                        )
                        else
                            {596}let pkSess_1021: bitstring = fail-any in
                            {597}out(c, GetEndpointRequest);
                            {598}in(c, (SPs_1022: bitstring,=SignAndEncrypt,UP_1023: bitstring,=pkSess_1021));
                            {599}new SPc_1024: bitstring;
                            {600}new Nc_1025: bitstring;
                            {601}let gNc_1026: bitstring = exp(g,Nc_1025) in
                            {602}let m1_1027: bitstring = (SPc_1024,gNc_1026) in
                            {603}out(c, (pkCli,enc(m1_1027,pkSess_1021),sign(m1_1027,skCli)));
                            {604}event beginCli(Cli,Sess,gNc_1026);
                            {605}in(c, (ePartS_1028: bitstring,sigPartS_1029: bitstring));
                            {606}let PartS_1030: bitstring = dec(ePartS_1028,skCli) in
                            {607}if (verify(PartS_1030,sigPartS_1029,pkSess_1021) <> true) then
                                0
                            else
                                {608}event endCli(Sess,Cli,PartS_1030)
            )
            else
                {609}let pkDisco_1031: bitstring = fail-any in
                {610}let v_1032: bool = (Sess = A) in
                (
                    {611}if v_1032 then
                    (
                        {612}let pkSess_1033: bitstring = pub(skA) in
                        {613}out(c, GetEndpointRequest);
                        {614}in(c, (SPs_1034: bitstring,=SignAndEncrypt,UP_1035: bitstring,=pkSess_1033));
                        {615}new SPc_1036: bitstring;
                        {616}new Nc_1037: bitstring;
                        {617}let gNc_1038: bitstring = exp(g,Nc_1037) in
                        {618}let m1_1039: bitstring = (SPc_1036,gNc_1038) in
                        {619}out(c, (pkCli,enc(m1_1039,pkSess_1033),sign(m1_1039,skCli)));
                        {620}event beginCli(Cli,Sess,gNc_1038);
                        {621}in(c, (ePartS_1040: bitstring,sigPartS_1041: bitstring));
                        {622}let PartS_1042: bitstring = dec(ePartS_1040,skCli) in
                        {623}if (verify(PartS_1042,sigPartS_1041,pkSess_1033) <> true) then
                            0
                        else
                            {624}event endCli(Sess,Cli,PartS_1042)
                    )
                    else
                        {625}let v_1043: bool = (Sess = B) in
                        (
                            {626}if v_1043 then
                            (
                                {627}let pkSess_1044: bitstring = pub(skB) in
                                {628}out(c, GetEndpointRequest);
                                {629}in(c, (SPs_1045: bitstring,=SignAndEncrypt,UP_1046: bitstring,=pkSess_1044));
                                {630}new SPc_1047: bitstring;
                                {631}new Nc_1048: bitstring;
                                {632}let gNc_1049: bitstring = exp(g,Nc_1048) in
                                {633}let m1_1050: bitstring = (SPc_1047,gNc_1049) in
                                {634}out(c, (pkCli,enc(m1_1050,pkSess_1044),sign(m1_1050,skCli)));
                                {635}event beginCli(Cli,Sess,gNc_1049);
                                {636}in(c, (ePartS_1051: bitstring,sigPartS_1052: bitstring));
                                {637}let PartS_1053: bitstring = dec(ePartS_1051,skCli) in
                                {638}if (verify(PartS_1053,sigPartS_1052,pkSess_1044) <> true) then
                                    0
                                else
                                    {639}event endCli(Sess,Cli,PartS_1053)
                            )
                            else
                                {640}let v_1054: bool = (Sess = C) in
                                (
                                    {641}if v_1054 then
                                    (
                                        {642}let pkSess_1055: bitstring = pub(skC) in
                                        {643}out(c, GetEndpointRequest);
                                        {644}in(c, (SPs_1056: bitstring,=SignAndEncrypt,UP_1057: bitstring,=pkSess_1055));
                                        {645}new SPc_1058: bitstring;
                                        {646}new Nc_1059: bitstring;
                                        {647}let gNc_1060: bitstring = exp(g,Nc_1059) in
                                        {648}let m1_1061: bitstring = (SPc_1058,gNc_1060) in
                                        {649}out(c, (pkCli,enc(m1_1061,pkSess_1055),sign(m1_1061,skCli)));
                                        {650}event beginCli(Cli,Sess,gNc_1060);
                                        {651}in(c, (ePartS_1062: bitstring,sigPartS_1063: bitstring));
                                        {652}let PartS_1064: bitstring = dec(ePartS_1062,skCli) in
                                        {653}if (verify(PartS_1064,sigPartS_1063,pkSess_1055) <> true) then
                                            0
                                        else
                                            {654}event endCli(Sess,Cli,PartS_1064)
                                    )
                                    else
                                        {655}let pkSess_1065: bitstring = pub(skI) in
                                        {656}out(c, GetEndpointRequest);
                                        {657}in(c, (SPs_1066: bitstring,=SignAndEncrypt,UP_1067: bitstring,=pkSess_1065));
                                        {658}new SPc_1068: bitstring;
                                        {659}new Nc_1069: bitstring;
                                        {660}let gNc_1070: bitstring = exp(g,Nc_1069) in
                                        {661}let m1_1071: bitstring = (SPc_1068,gNc_1070) in
                                        {662}out(c, (pkCli,enc(m1_1071,pkSess_1065),sign(m1_1071,skCli)));
                                        {663}event beginCli(Cli,Sess,gNc_1070);
                                        {664}in(c, (ePartS_1072: bitstring,sigPartS_1073: bitstring));
                                        {665}let PartS_1074: bitstring = dec(ePartS_1072,skCli) in
                                        {666}if (verify(PartS_1074,sigPartS_1073,pkSess_1065) <> true) then
                                            0
                                        else
                                            {667}event endCli(Sess,Cli,PartS_1074)
                                )
                                else
                                    {668}let pkSess_1075: bitstring = fail-any in
                                    {669}out(c, GetEndpointRequest);
                                    {670}in(c, (SPs_1076: bitstring,=SignAndEncrypt,UP_1077: bitstring,=pkSess_1075));
                                    {671}new SPc_1078: bitstring;
                                    {672}new Nc_1079: bitstring;
                                    {673}let gNc_1080: bitstring = exp(g,Nc_1079) in
                                    {674}let m1_1081: bitstring = (SPc_1078,gNc_1080) in
                                    {675}out(c, (pkCli,enc(m1_1081,pkSess_1075),sign(m1_1081,skCli)));
                                    {676}event beginCli(Cli,Sess,gNc_1080);
                                    {677}in(c, (ePartS_1082: bitstring,sigPartS_1083: bitstring));
                                    {678}let PartS_1084: bitstring = dec(ePartS_1082,skCli) in
                                    {679}if (verify(PartS_1084,sigPartS_1083,pkSess_1075) <> true) then
                                        0
                                    else
                                        {680}event endCli(Sess,Cli,PartS_1084)
                        )
                        else
                            {681}let pkSess_1085: bitstring = fail-any in
                            {682}out(c, GetEndpointRequest);
                            {683}in(c, (SPs_1086: bitstring,=SignAndEncrypt,UP_1087: bitstring,=pkSess_1085));
                            {684}new SPc_1088: bitstring;
                            {685}new Nc_1089: bitstring;
                            {686}let gNc_1090: bitstring = exp(g,Nc_1089) in
                            {687}let m1_1091: bitstring = (SPc_1088,gNc_1090) in
                            {688}out(c, (pkCli,enc(m1_1091,pkSess_1085),sign(m1_1091,skCli)));
                            {689}event beginCli(Cli,Sess,gNc_1090);
                            {690}in(c, (ePartS_1092: bitstring,sigPartS_1093: bitstring));
                            {691}let PartS_1094: bitstring = dec(ePartS_1092,skCli) in
                            {692}if (verify(PartS_1094,sigPartS_1093,pkSess_1085) <> true) then
                                0
                            else
                                {693}event endCli(Sess,Cli,PartS_1094)
                )
                else
                    {694}let pkSess_1095: bitstring = fail-any in
                    {695}out(c, GetEndpointRequest);
                    {696}in(c, (SPs_1096: bitstring,=SignAndEncrypt,UP_1097: bitstring,=pkSess_1095));
                    {697}new SPc_1098: bitstring;
                    {698}new Nc_1099: bitstring;
                    {699}let gNc_1100: bitstring = exp(g,Nc_1099) in
                    {700}let m1_1101: bitstring = (SPc_1098,gNc_1100) in
                    {701}out(c, (pkCli,enc(m1_1101,pkSess_1095),sign(m1_1101,skCli)));
                    {702}event beginCli(Cli,Sess,gNc_1100);
                    {703}in(c, (ePartS_1102: bitstring,sigPartS_1103: bitstring));
                    {704}let PartS_1104: bitstring = dec(ePartS_1102,skCli) in
                    {705}if (verify(PartS_1104,sigPartS_1103,pkSess_1095) <> true) then
                        0
                    else
                        {706}event endCli(Sess,Cli,PartS_1104)
        )
        else
            {707}let v_1105: bool = (Cli = B) in
            (
                {708}if v_1105 then
                (
                    {709}let skCli_1106: bitstring = skB in
                    {710}let pkCli_1107: bitstring = pub(skCli_1106) in
                    {711}let v_1108: bool = (Disco = A) in
                    (
                        {712}if v_1108 then
                        (
                            {713}let pkDisco_1109: bitstring = pub(skA) in
                            {714}let v_1110: bool = (Sess = A) in
                            (
                                {715}if v_1110 then
                                (
                                    {716}let pkSess_1111: bitstring = pub(skA) in
                                    {717}out(c, GetEndpointRequest);
                                    {718}in(c, (SPs_1112: bitstring,=SignAndEncrypt,UP_1113: bitstring,=pkSess_1111));
                                    {719}new SPc_1114: bitstring;
                                    {720}new Nc_1115: bitstring;
                                    {721}let gNc_1116: bitstring = exp(g,Nc_1115) in
                                    {722}let m1_1117: bitstring = (SPc_1114,gNc_1116) in
                                    {723}out(c, (pkCli_1107,enc(m1_1117,pkSess_1111),sign(m1_1117,skCli_1106)));
                                    {724}event beginCli(Cli,Sess,gNc_1116);
                                    {725}in(c, (ePartS_1118: bitstring,sigPartS_1119: bitstring));
                                    {726}let PartS_1120: bitstring = dec(ePartS_1118,skCli_1106) in
                                    {727}if (verify(PartS_1120,sigPartS_1119,pkSess_1111) <> true) then
                                        0
                                    else
                                        {728}event endCli(Sess,Cli,PartS_1120)
                                )
                                else
                                    {729}let v_1121: bool = (Sess = B) in
                                    (
                                        {730}if v_1121 then
                                        (
                                            {731}let pkSess_1122: bitstring = pub(skB) in
                                            {732}out(c, GetEndpointRequest);
                                            {733}in(c, (SPs_1123: bitstring,=SignAndEncrypt,UP_1124: bitstring,=pkSess_1122));
                                            {734}new SPc_1125: bitstring;
                                            {735}new Nc_1126: bitstring;
                                            {736}let gNc_1127: bitstring = exp(g,Nc_1126) in
                                            {737}let m1_1128: bitstring = (SPc_1125,gNc_1127) in
                                            {738}out(c, (pkCli_1107,enc(m1_1128,pkSess_1122),sign(m1_1128,skCli_1106)));
                                            {739}event beginCli(Cli,Sess,gNc_1127);
                                            {740}in(c, (ePartS_1129: bitstring,sigPartS_1130: bitstring));
                                            {741}let PartS_1131: bitstring = dec(ePartS_1129,skCli_1106) in
                                            {742}if (verify(PartS_1131,sigPartS_1130,pkSess_1122) <> true) then
                                                0
                                            else
                                                {743}event endCli(Sess,Cli,PartS_1131)
                                        )
                                        else
                                            {744}let v_1132: bool = (Sess = C) in
                                            (
                                                {745}if v_1132 then
                                                (
                                                    {746}let pkSess_1133: bitstring = pub(skC) in
                                                    {747}out(c, GetEndpointRequest);
                                                    {748}in(c, (SPs_1134: bitstring,=SignAndEncrypt,UP_1135: bitstring,=pkSess_1133));
                                                    {749}new SPc_1136: bitstring;
                                                    {750}new Nc_1137: bitstring;
                                                    {751}let gNc_1138: bitstring = exp(g,Nc_1137) in
                                                    {752}let m1_1139: bitstring = (SPc_1136,gNc_1138) in
                                                    {753}out(c, (pkCli_1107,enc(m1_1139,pkSess_1133),sign(m1_1139,skCli_1106)));
                                                    {754}event beginCli(Cli,Sess,gNc_1138);
                                                    {755}in(c, (ePartS_1140: bitstring,sigPartS_1141: bitstring));
                                                    {756}let PartS_1142: bitstring = dec(ePartS_1140,skCli_1106) in
                                                    {757}if (verify(PartS_1142,sigPartS_1141,pkSess_1133) <> true) then
                                                        0
                                                    else
                                                        {758}event endCli(Sess,Cli,PartS_1142)
                                                )
                                                else
                                                    {759}let pkSess_1143: bitstring = pub(skI) in
                                                    {760}out(c, GetEndpointRequest);
                                                    {761}in(c, (SPs_1144: bitstring,=SignAndEncrypt,UP_1145: bitstring,=pkSess_1143));
                                                    {762}new SPc_1146: bitstring;
                                                    {763}new Nc_1147: bitstring;
                                                    {764}let gNc_1148: bitstring = exp(g,Nc_1147) in
                                                    {765}let m1_1149: bitstring = (SPc_1146,gNc_1148) in
                                                    {766}out(c, (pkCli_1107,enc(m1_1149,pkSess_1143),sign(m1_1149,skCli_1106)));
                                                    {767}event beginCli(Cli,Sess,gNc_1148);
                                                    {768}in(c, (ePartS_1150: bitstring,sigPartS_1151: bitstring));
                                                    {769}let PartS_1152: bitstring = dec(ePartS_1150,skCli_1106) in
                                                    {770}if (verify(PartS_1152,sigPartS_1151,pkSess_1143) <> true) then
                                                        0
                                                    else
                                                        {771}event endCli(Sess,Cli,PartS_1152)
                                            )
                                            else
                                                {772}let pkSess_1153: bitstring = fail-any in
                                                {773}out(c, GetEndpointRequest);
                                                {774}in(c, (SPs_1154: bitstring,=SignAndEncrypt,UP_1155: bitstring,=pkSess_1153));
                                                {775}new SPc_1156: bitstring;
                                                {776}new Nc_1157: bitstring;
                                                {777}let gNc_1158: bitstring = exp(g,Nc_1157) in
                                                {778}let m1_1159: bitstring = (SPc_1156,gNc_1158) in
                                                {779}out(c, (pkCli_1107,enc(m1_1159,pkSess_1153),sign(m1_1159,skCli_1106)));
                                                {780}event beginCli(Cli,Sess,gNc_1158);
                                                {781}in(c, (ePartS_1160: bitstring,sigPartS_1161: bitstring));
                                                {782}let PartS_1162: bitstring = dec(ePartS_1160,skCli_1106) in
                                                {783}if (verify(PartS_1162,sigPartS_1161,pkSess_1153) <> true) then
                                                    0
                                                else
                                                    {784}event endCli(Sess,Cli,PartS_1162)
                                    )
                                    else
                                        {785}let pkSess_1163: bitstring = fail-any in
                                        {786}out(c, GetEndpointRequest);
                                        {787}in(c, (SPs_1164: bitstring,=SignAndEncrypt,UP_1165: bitstring,=pkSess_1163));
                                        {788}new SPc_1166: bitstring;
                                        {789}new Nc_1167: bitstring;
                                        {790}let gNc_1168: bitstring = exp(g,Nc_1167) in
                                        {791}let m1_1169: bitstring = (SPc_1166,gNc_1168) in
                                        {792}out(c, (pkCli_1107,enc(m1_1169,pkSess_1163),sign(m1_1169,skCli_1106)));
                                        {793}event beginCli(Cli,Sess,gNc_1168);
                                        {794}in(c, (ePartS_1170: bitstring,sigPartS_1171: bitstring));
                                        {795}let PartS_1172: bitstring = dec(ePartS_1170,skCli_1106) in
                                        {796}if (verify(PartS_1172,sigPartS_1171,pkSess_1163) <> true) then
                                            0
                                        else
                                            {797}event endCli(Sess,Cli,PartS_1172)
                            )
                            else
                                {798}let pkSess_1173: bitstring = fail-any in
                                {799}out(c, GetEndpointRequest);
                                {800}in(c, (SPs_1174: bitstring,=SignAndEncrypt,UP_1175: bitstring,=pkSess_1173));
                                {801}new SPc_1176: bitstring;
                                {802}new Nc_1177: bitstring;
                                {803}let gNc_1178: bitstring = exp(g,Nc_1177) in
                                {804}let m1_1179: bitstring = (SPc_1176,gNc_1178) in
                                {805}out(c, (pkCli_1107,enc(m1_1179,pkSess_1173),sign(m1_1179,skCli_1106)));
                                {806}event beginCli(Cli,Sess,gNc_1178);
                                {807}in(c, (ePartS_1180: bitstring,sigPartS_1181: bitstring));
                                {808}let PartS_1182: bitstring = dec(ePartS_1180,skCli_1106) in
                                {809}if (verify(PartS_1182,sigPartS_1181,pkSess_1173) <> true) then
                                    0
                                else
                                    {810}event endCli(Sess,Cli,PartS_1182)
                        )
                        else
                            {811}let v_1183: bool = (Disco = B) in
                            (
                                {812}if v_1183 then
                                (
                                    {813}let pkDisco_1184: bitstring = pub(skB) in
                                    {814}let v_1185: bool = (Sess = A) in
                                    (
                                        {815}if v_1185 then
                                        (
                                            {816}let pkSess_1186: bitstring = pub(skA) in
                                            {817}out(c, GetEndpointRequest);
                                            {818}in(c, (SPs_1187: bitstring,=SignAndEncrypt,UP_1188: bitstring,=pkSess_1186));
                                            {819}new SPc_1189: bitstring;
                                            {820}new Nc_1190: bitstring;
                                            {821}let gNc_1191: bitstring = exp(g,Nc_1190) in
                                            {822}let m1_1192: bitstring = (SPc_1189,gNc_1191) in
                                            {823}out(c, (pkCli_1107,enc(m1_1192,pkSess_1186),sign(m1_1192,skCli_1106)));
                                            {824}event beginCli(Cli,Sess,gNc_1191);
                                            {825}in(c, (ePartS_1193: bitstring,sigPartS_1194: bitstring));
                                            {826}let PartS_1195: bitstring = dec(ePartS_1193,skCli_1106) in
                                            {827}if (verify(PartS_1195,sigPartS_1194,pkSess_1186) <> true) then
                                                0
                                            else
                                                {828}event endCli(Sess,Cli,PartS_1195)
                                        )
                                        else
                                            {829}let v_1196: bool = (Sess = B) in
                                            (
                                                {830}if v_1196 then
                                                (
                                                    {831}let pkSess_1197: bitstring = pub(skB) in
                                                    {832}out(c, GetEndpointRequest);
                                                    {833}in(c, (SPs_1198: bitstring,=SignAndEncrypt,UP_1199: bitstring,=pkSess_1197));
                                                    {834}new SPc_1200: bitstring;
                                                    {835}new Nc_1201: bitstring;
                                                    {836}let gNc_1202: bitstring = exp(g,Nc_1201) in
                                                    {837}let m1_1203: bitstring = (SPc_1200,gNc_1202) in
                                                    {838}out(c, (pkCli_1107,enc(m1_1203,pkSess_1197),sign(m1_1203,skCli_1106)));
                                                    {839}event beginCli(Cli,Sess,gNc_1202);
                                                    {840}in(c, (ePartS_1204: bitstring,sigPartS_1205: bitstring));
                                                    {841}let PartS_1206: bitstring = dec(ePartS_1204,skCli_1106) in
                                                    {842}if (verify(PartS_1206,sigPartS_1205,pkSess_1197) <> true) then
                                                        0
                                                    else
                                                        {843}event endCli(Sess,Cli,PartS_1206)
                                                )
                                                else
                                                    {844}let v_1207: bool = (Sess = C) in
                                                    (
                                                        {845}if v_1207 then
                                                        (
                                                            {846}let pkSess_1208: bitstring = pub(skC) in
                                                            {847}out(c, GetEndpointRequest);
                                                            {848}in(c, (SPs_1209: bitstring,=SignAndEncrypt,UP_1210: bitstring,=pkSess_1208));
                                                            {849}new SPc_1211: bitstring;
                                                            {850}new Nc_1212: bitstring;
                                                            {851}let gNc_1213: bitstring = exp(g,Nc_1212) in
                                                            {852}let m1_1214: bitstring = (SPc_1211,gNc_1213) in
                                                            {853}out(c, (pkCli_1107,enc(m1_1214,pkSess_1208),sign(m1_1214,skCli_1106)));
                                                            {854}event beginCli(Cli,Sess,gNc_1213);
                                                            {855}in(c, (ePartS_1215: bitstring,sigPartS_1216: bitstring));
                                                            {856}let PartS_1217: bitstring = dec(ePartS_1215,skCli_1106) in
                                                            {857}if (verify(PartS_1217,sigPartS_1216,pkSess_1208) <> true) then
                                                                0
                                                            else
                                                                {858}event endCli(Sess,Cli,PartS_1217)
                                                        )
                                                        else
                                                            {859}let pkSess_1218: bitstring = pub(skI) in
                                                            {860}out(c, GetEndpointRequest);
                                                            {861}in(c, (SPs_1219: bitstring,=SignAndEncrypt,UP_1220: bitstring,=pkSess_1218));
                                                            {862}new SPc_1221: bitstring;
                                                            {863}new Nc_1222: bitstring;
                                                            {864}let gNc_1223: bitstring = exp(g,Nc_1222) in
                                                            {865}let m1_1224: bitstring = (SPc_1221,gNc_1223) in
                                                            {866}out(c, (pkCli_1107,enc(m1_1224,pkSess_1218),sign(m1_1224,skCli_1106)));
                                                            {867}event beginCli(Cli,Sess,gNc_1223);
                                                            {868}in(c, (ePartS_1225: bitstring,sigPartS_1226: bitstring));
                                                            {869}let PartS_1227: bitstring = dec(ePartS_1225,skCli_1106) in
                                                            {870}if (verify(PartS_1227,sigPartS_1226,pkSess_1218) <> true) then
                                                                0
                                                            else
                                                                {871}event endCli(Sess,Cli,PartS_1227)
                                                    )
                                                    else
                                                        {872}let pkSess_1228: bitstring = fail-any in
                                                        {873}out(c, GetEndpointRequest);
                                                        {874}in(c, (SPs_1229: bitstring,=SignAndEncrypt,UP_1230: bitstring,=pkSess_1228));
                                                        {875}new SPc_1231: bitstring;
                                                        {876}new Nc_1232: bitstring;
                                                        {877}let gNc_1233: bitstring = exp(g,Nc_1232) in
                                                        {878}let m1_1234: bitstring = (SPc_1231,gNc_1233) in
                                                        {879}out(c, (pkCli_1107,enc(m1_1234,pkSess_1228),sign(m1_1234,skCli_1106)));
                                                        {880}event beginCli(Cli,Sess,gNc_1233);
                                                        {881}in(c, (ePartS_1235: bitstring,sigPartS_1236: bitstring));
                                                        {882}let PartS_1237: bitstring = dec(ePartS_1235,skCli_1106) in
                                                        {883}if (verify(PartS_1237,sigPartS_1236,pkSess_1228) <> true) then
                                                            0
                                                        else
                                                            {884}event endCli(Sess,Cli,PartS_1237)
                                            )
                                            else
                                                {885}let pkSess_1238: bitstring = fail-any in
                                                {886}out(c, GetEndpointRequest);
                                                {887}in(c, (SPs_1239: bitstring,=SignAndEncrypt,UP_1240: bitstring,=pkSess_1238));
                                                {888}new SPc_1241: bitstring;
                                                {889}new Nc_1242: bitstring;
                                                {890}let gNc_1243: bitstring = exp(g,Nc_1242) in
                                                {891}let m1_1244: bitstring = (SPc_1241,gNc_1243) in
                                                {892}out(c, (pkCli_1107,enc(m1_1244,pkSess_1238),sign(m1_1244,skCli_1106)));
                                                {893}event beginCli(Cli,Sess,gNc_1243);
                                                {894}in(c, (ePartS_1245: bitstring,sigPartS_1246: bitstring));
                                                {895}let PartS_1247: bitstring = dec(ePartS_1245,skCli_1106) in
                                                {896}if (verify(PartS_1247,sigPartS_1246,pkSess_1238) <> true) then
                                                    0
                                                else
                                                    {897}event endCli(Sess,Cli,PartS_1247)
                                    )
                                    else
                                        {898}let pkSess_1248: bitstring = fail-any in
                                        {899}out(c, GetEndpointRequest);
                                        {900}in(c, (SPs_1249: bitstring,=SignAndEncrypt,UP_1250: bitstring,=pkSess_1248));
                                        {901}new SPc_1251: bitstring;
                                        {902}new Nc_1252: bitstring;
                                        {903}let gNc_1253: bitstring = exp(g,Nc_1252) in
                                        {904}let m1_1254: bitstring = (SPc_1251,gNc_1253) in
                                        {905}out(c, (pkCli_1107,enc(m1_1254,pkSess_1248),sign(m1_1254,skCli_1106)));
                                        {906}event beginCli(Cli,Sess,gNc_1253);
                                        {907}in(c, (ePartS_1255: bitstring,sigPartS_1256: bitstring));
                                        {908}let PartS_1257: bitstring = dec(ePartS_1255,skCli_1106) in
                                        {909}if (verify(PartS_1257,sigPartS_1256,pkSess_1248) <> true) then
                                            0
                                        else
                                            {910}event endCli(Sess,Cli,PartS_1257)
                                )
                                else
                                    {911}let v_1258: bool = (Disco = C) in
                                    (
                                        {912}if v_1258 then
                                        (
                                            {913}let pkDisco_1259: bitstring = pub(skC) in
                                            {914}let v_1260: bool = (Sess = A) in
                                            (
                                                {915}if v_1260 then
                                                (
                                                    {916}let pkSess_1261: bitstring = pub(skA) in
                                                    {917}out(c, GetEndpointRequest);
                                                    {918}in(c, (SPs_1262: bitstring,=SignAndEncrypt,UP_1263: bitstring,=pkSess_1261));
                                                    {919}new SPc_1264: bitstring;
                                                    {920}new Nc_1265: bitstring;
                                                    {921}let gNc_1266: bitstring = exp(g,Nc_1265) in
                                                    {922}let m1_1267: bitstring = (SPc_1264,gNc_1266) in
                                                    {923}out(c, (pkCli_1107,enc(m1_1267,pkSess_1261),sign(m1_1267,skCli_1106)));
                                                    {924}event beginCli(Cli,Sess,gNc_1266);
                                                    {925}in(c, (ePartS_1268: bitstring,sigPartS_1269: bitstring));
                                                    {926}let PartS_1270: bitstring = dec(ePartS_1268,skCli_1106) in
                                                    {927}if (verify(PartS_1270,sigPartS_1269,pkSess_1261) <> true) then
                                                        0
                                                    else
                                                        {928}event endCli(Sess,Cli,PartS_1270)
                                                )
                                                else
                                                    {929}let v_1271: bool = (Sess = B) in
                                                    (
                                                        {930}if v_1271 then
                                                        (
                                                            {931}let pkSess_1272: bitstring = pub(skB) in
                                                            {932}out(c, GetEndpointRequest);
                                                            {933}in(c, (SPs_1273: bitstring,=SignAndEncrypt,UP_1274: bitstring,=pkSess_1272));
                                                            {934}new SPc_1275: bitstring;
                                                            {935}new Nc_1276: bitstring;
                                                            {936}let gNc_1277: bitstring = exp(g,Nc_1276) in
                                                            {937}let m1_1278: bitstring = (SPc_1275,gNc_1277) in
                                                            {938}out(c, (pkCli_1107,enc(m1_1278,pkSess_1272),sign(m1_1278,skCli_1106)));
                                                            {939}event beginCli(Cli,Sess,gNc_1277);
                                                            {940}in(c, (ePartS_1279: bitstring,sigPartS_1280: bitstring));
                                                            {941}let PartS_1281: bitstring = dec(ePartS_1279,skCli_1106) in
                                                            {942}if (verify(PartS_1281,sigPartS_1280,pkSess_1272) <> true) then
                                                                0
                                                            else
                                                                {943}event endCli(Sess,Cli,PartS_1281)
                                                        )
                                                        else
                                                            {944}let v_1282: bool = (Sess = C) in
                                                            (
                                                                {945}if v_1282 then
                                                                (
                                                                    {946}let pkSess_1283: bitstring = pub(skC) in
                                                                    {947}out(c, GetEndpointRequest);
                                                                    {948}in(c, (SPs_1284: bitstring,=SignAndEncrypt,UP_1285: bitstring,=pkSess_1283));
                                                                    {949}new SPc_1286: bitstring;
                                                                    {950}new Nc_1287: bitstring;
                                                                    {951}let gNc_1288: bitstring = exp(g,Nc_1287) in
                                                                    {952}let m1_1289: bitstring = (SPc_1286,gNc_1288) in
                                                                    {953}out(c, (pkCli_1107,enc(m1_1289,pkSess_1283),sign(m1_1289,skCli_1106)));
                                                                    {954}event beginCli(Cli,Sess,gNc_1288);
                                                                    {955}in(c, (ePartS_1290: bitstring,sigPartS_1291: bitstring));
                                                                    {956}let PartS_1292: bitstring = dec(ePartS_1290,skCli_1106) in
                                                                    {957}if (verify(PartS_1292,sigPartS_1291,pkSess_1283) <> true) then
                                                                        0
                                                                    else
                                                                        {958}event endCli(Sess,Cli,PartS_1292)
                                                                )
                                                                else
                                                                    {959}let pkSess_1293: bitstring = pub(skI) in
                                                                    {960}out(c, GetEndpointRequest);
                                                                    {961}in(c, (SPs_1294: bitstring,=SignAndEncrypt,UP_1295: bitstring,=pkSess_1293));
                                                                    {962}new SPc_1296: bitstring;
                                                                    {963}new Nc_1297: bitstring;
                                                                    {964}let gNc_1298: bitstring = exp(g,Nc_1297) in
                                                                    {965}let m1_1299: bitstring = (SPc_1296,gNc_1298) in
                                                                    {966}out(c, (pkCli_1107,enc(m1_1299,pkSess_1293),sign(m1_1299,skCli_1106)));
                                                                    {967}event beginCli(Cli,Sess,gNc_1298);
                                                                    {968}in(c, (ePartS_1300: bitstring,sigPartS_1301: bitstring));
                                                                    {969}let PartS_1302: bitstring = dec(ePartS_1300,skCli_1106) in
                                                                    {970}if (verify(PartS_1302,sigPartS_1301,pkSess_1293) <> true) then
                                                                        0
                                                                    else
                                                                        {971}event endCli(Sess,Cli,PartS_1302)
                                                            )
                                                            else
                                                                {972}let pkSess_1303: bitstring = fail-any in
                                                                {973}out(c, GetEndpointRequest);
                                                                {974}in(c, (SPs_1304: bitstring,=SignAndEncrypt,UP_1305: bitstring,=pkSess_1303));
                                                                {975}new SPc_1306: bitstring;
                                                                {976}new Nc_1307: bitstring;
                                                                {977}let gNc_1308: bitstring = exp(g,Nc_1307) in
                                                                {978}let m1_1309: bitstring = (SPc_1306,gNc_1308) in
                                                                {979}out(c, (pkCli_1107,enc(m1_1309,pkSess_1303),sign(m1_1309,skCli_1106)));
                                                                {980}event beginCli(Cli,Sess,gNc_1308);
                                                                {981}in(c, (ePartS_1310: bitstring,sigPartS_1311: bitstring));
                                                                {982}let PartS_1312: bitstring = dec(ePartS_1310,skCli_1106) in
                                                                {983}if (verify(PartS_1312,sigPartS_1311,pkSess_1303) <> true) then
                                                                    0
                                                                else
                                                                    {984}event endCli(Sess,Cli,PartS_1312)
                                                    )
                                                    else
                                                        {985}let pkSess_1313: bitstring = fail-any in
                                                        {986}out(c, GetEndpointRequest);
                                                        {987}in(c, (SPs_1314: bitstring,=SignAndEncrypt,UP_1315: bitstring,=pkSess_1313));
                                                        {988}new SPc_1316: bitstring;
                                                        {989}new Nc_1317: bitstring;
                                                        {990}let gNc_1318: bitstring = exp(g,Nc_1317) in
                                                        {991}let m1_1319: bitstring = (SPc_1316,gNc_1318) in
                                                        {992}out(c, (pkCli_1107,enc(m1_1319,pkSess_1313),sign(m1_1319,skCli_1106)));
                                                        {993}event beginCli(Cli,Sess,gNc_1318);
                                                        {994}in(c, (ePartS_1320: bitstring,sigPartS_1321: bitstring));
                                                        {995}let PartS_1322: bitstring = dec(ePartS_1320,skCli_1106) in
                                                        {996}if (verify(PartS_1322,sigPartS_1321,pkSess_1313) <> true) then
                                                            0
                                                        else
                                                            {997}event endCli(Sess,Cli,PartS_1322)
                                            )
                                            else
                                                {998}let pkSess_1323: bitstring = fail-any in
                                                {999}out(c, GetEndpointRequest);
                                                {1000}in(c, (SPs_1324: bitstring,=SignAndEncrypt,UP_1325: bitstring,=pkSess_1323));
                                                {1001}new SPc_1326: bitstring;
                                                {1002}new Nc_1327: bitstring;
                                                {1003}let gNc_1328: bitstring = exp(g,Nc_1327) in
                                                {1004}let m1_1329: bitstring = (SPc_1326,gNc_1328) in
                                                {1005}out(c, (pkCli_1107,enc(m1_1329,pkSess_1323),sign(m1_1329,skCli_1106)));
                                                {1006}event beginCli(Cli,Sess,gNc_1328);
                                                {1007}in(c, (ePartS_1330: bitstring,sigPartS_1331: bitstring));
                                                {1008}let PartS_1332: bitstring = dec(ePartS_1330,skCli_1106) in
                                                {1009}if (verify(PartS_1332,sigPartS_1331,pkSess_1323) <> true) then
                                                    0
                                                else
                                                    {1010}event endCli(Sess,Cli,PartS_1332)
                                        )
                                        else
                                            {1011}let pkDisco_1333: bitstring = pub(skI) in
                                            {1012}let v_1334: bool = (Sess = A) in
                                            (
                                                {1013}if v_1334 then
                                                (
                                                    {1014}let pkSess_1335: bitstring = pub(skA) in
                                                    {1015}out(c, GetEndpointRequest);
                                                    {1016}in(c, (SPs_1336: bitstring,=SignAndEncrypt,UP_1337: bitstring,=pkSess_1335));
                                                    {1017}new SPc_1338: bitstring;
                                                    {1018}new Nc_1339: bitstring;
                                                    {1019}let gNc_1340: bitstring = exp(g,Nc_1339) in
                                                    {1020}let m1_1341: bitstring = (SPc_1338,gNc_1340) in
                                                    {1021}out(c, (pkCli_1107,enc(m1_1341,pkSess_1335),sign(m1_1341,skCli_1106)));
                                                    {1022}event beginCli(Cli,Sess,gNc_1340);
                                                    {1023}in(c, (ePartS_1342: bitstring,sigPartS_1343: bitstring));
                                                    {1024}let PartS_1344: bitstring = dec(ePartS_1342,skCli_1106) in
                                                    {1025}if (verify(PartS_1344,sigPartS_1343,pkSess_1335) <> true) then
                                                        0
                                                    else
                                                        {1026}event endCli(Sess,Cli,PartS_1344)
                                                )
                                                else
                                                    {1027}let v_1345: bool = (Sess = B) in
                                                    (
                                                        {1028}if v_1345 then
                                                        (
                                                            {1029}let pkSess_1346: bitstring = pub(skB) in
                                                            {1030}out(c, GetEndpointRequest);
                                                            {1031}in(c, (SPs_1347: bitstring,=SignAndEncrypt,UP_1348: bitstring,=pkSess_1346));
                                                            {1032}new SPc_1349: bitstring;
                                                            {1033}new Nc_1350: bitstring;
                                                            {1034}let gNc_1351: bitstring = exp(g,Nc_1350) in
                                                            {1035}let m1_1352: bitstring = (SPc_1349,gNc_1351) in
                                                            {1036}out(c, (pkCli_1107,enc(m1_1352,pkSess_1346),sign(m1_1352,skCli_1106)));
                                                            {1037}event beginCli(Cli,Sess,gNc_1351);
                                                            {1038}in(c, (ePartS_1353: bitstring,sigPartS_1354: bitstring));
                                                            {1039}let PartS_1355: bitstring = dec(ePartS_1353,skCli_1106) in
                                                            {1040}if (verify(PartS_1355,sigPartS_1354,pkSess_1346) <> true) then
                                                                0
                                                            else
                                                                {1041}event endCli(Sess,Cli,PartS_1355)
                                                        )
                                                        else
                                                            {1042}let v_1356: bool = (Sess = C) in
                                                            (
                                                                {1043}if v_1356 then
                                                                (
                                                                    {1044}let pkSess_1357: bitstring = pub(skC) in
                                                                    {1045}out(c, GetEndpointRequest);
                                                                    {1046}in(c, (SPs_1358: bitstring,=SignAndEncrypt,UP_1359: bitstring,=pkSess_1357));
                                                                    {1047}new SPc_1360: bitstring;
                                                                    {1048}new Nc_1361: bitstring;
                                                                    {1049}let gNc_1362: bitstring = exp(g,Nc_1361) in
                                                                    {1050}let m1_1363: bitstring = (SPc_1360,gNc_1362) in
                                                                    {1051}out(c, (pkCli_1107,enc(m1_1363,pkSess_1357),sign(m1_1363,skCli_1106)));
                                                                    {1052}event beginCli(Cli,Sess,gNc_1362);
                                                                    {1053}in(c, (ePartS_1364: bitstring,sigPartS_1365: bitstring));
                                                                    {1054}let PartS_1366: bitstring = dec(ePartS_1364,skCli_1106) in
                                                                    {1055}if (verify(PartS_1366,sigPartS_1365,pkSess_1357) <> true) then
                                                                        0
                                                                    else
                                                                        {1056}event endCli(Sess,Cli,PartS_1366)
                                                                )
                                                                else
                                                                    {1057}let pkSess_1367: bitstring = pub(skI) in
                                                                    {1058}out(c, GetEndpointRequest);
                                                                    {1059}in(c, (SPs_1368: bitstring,=SignAndEncrypt,UP_1369: bitstring,=pkSess_1367));
                                                                    {1060}new SPc_1370: bitstring;
                                                                    {1061}new Nc_1371: bitstring;
                                                                    {1062}let gNc_1372: bitstring = exp(g,Nc_1371) in
                                                                    {1063}let m1_1373: bitstring = (SPc_1370,gNc_1372) in
                                                                    {1064}out(c, (pkCli_1107,enc(m1_1373,pkSess_1367),sign(m1_1373,skCli_1106)));
                                                                    {1065}event beginCli(Cli,Sess,gNc_1372);
                                                                    {1066}in(c, (ePartS_1374: bitstring,sigPartS_1375: bitstring));
                                                                    {1067}let PartS_1376: bitstring = dec(ePartS_1374,skCli_1106) in
                                                                    {1068}if (verify(PartS_1376,sigPartS_1375,pkSess_1367) <> true) then
                                                                        0
                                                                    else
                                                                        {1069}event endCli(Sess,Cli,PartS_1376)
                                                            )
                                                            else
                                                                {1070}let pkSess_1377: bitstring = fail-any in
                                                                {1071}out(c, GetEndpointRequest);
                                                                {1072}in(c, (SPs_1378: bitstring,=SignAndEncrypt,UP_1379: bitstring,=pkSess_1377));
                                                                {1073}new SPc_1380: bitstring;
                                                                {1074}new Nc_1381: bitstring;
                                                                {1075}let gNc_1382: bitstring = exp(g,Nc_1381) in
                                                                {1076}let m1_1383: bitstring = (SPc_1380,gNc_1382) in
                                                                {1077}out(c, (pkCli_1107,enc(m1_1383,pkSess_1377),sign(m1_1383,skCli_1106)));
                                                                {1078}event beginCli(Cli,Sess,gNc_1382);
                                                                {1079}in(c, (ePartS_1384: bitstring,sigPartS_1385: bitstring));
                                                                {1080}let PartS_1386: bitstring = dec(ePartS_1384,skCli_1106) in
                                                                {1081}if (verify(PartS_1386,sigPartS_1385,pkSess_1377) <> true) then
                                                                    0
                                                                else
                                                                    {1082}event endCli(Sess,Cli,PartS_1386)
                                                    )
                                                    else
                                                        {1083}let pkSess_1387: bitstring = fail-any in
                                                        {1084}out(c, GetEndpointRequest);
                                                        {1085}in(c, (SPs_1388: bitstring,=SignAndEncrypt,UP_1389: bitstring,=pkSess_1387));
                                                        {1086}new SPc_1390: bitstring;
                                                        {1087}new Nc_1391: bitstring;
                                                        {1088}let gNc_1392: bitstring = exp(g,Nc_1391) in
                                                        {1089}let m1_1393: bitstring = (SPc_1390,gNc_1392) in
                                                        {1090}out(c, (pkCli_1107,enc(m1_1393,pkSess_1387),sign(m1_1393,skCli_1106)));
                                                        {1091}event beginCli(Cli,Sess,gNc_1392);
                                                        {1092}in(c, (ePartS_1394: bitstring,sigPartS_1395: bitstring));
                                                        {1093}let PartS_1396: bitstring = dec(ePartS_1394,skCli_1106) in
                                                        {1094}if (verify(PartS_1396,sigPartS_1395,pkSess_1387) <> true) then
                                                            0
                                                        else
                                                            {1095}event endCli(Sess,Cli,PartS_1396)
                                            )
                                            else
                                                {1096}let pkSess_1397: bitstring = fail-any in
                                                {1097}out(c, GetEndpointRequest);
                                                {1098}in(c, (SPs_1398: bitstring,=SignAndEncrypt,UP_1399: bitstring,=pkSess_1397));
                                                {1099}new SPc_1400: bitstring;
                                                {1100}new Nc_1401: bitstring;
                                                {1101}let gNc_1402: bitstring = exp(g,Nc_1401) in
                                                {1102}let m1_1403: bitstring = (SPc_1400,gNc_1402) in
                                                {1103}out(c, (pkCli_1107,enc(m1_1403,pkSess_1397),sign(m1_1403,skCli_1106)));
                                                {1104}event beginCli(Cli,Sess,gNc_1402);
                                                {1105}in(c, (ePartS_1404: bitstring,sigPartS_1405: bitstring));
                                                {1106}let PartS_1406: bitstring = dec(ePartS_1404,skCli_1106) in
                                                {1107}if (verify(PartS_1406,sigPartS_1405,pkSess_1397) <> true) then
                                                    0
                                                else
                                                    {1108}event endCli(Sess,Cli,PartS_1406)
                                    )
                                    else
                                        {1109}let pkDisco_1407: bitstring = fail-any in
                                        {1110}let v_1408: bool = (Sess = A) in
                                        (
                                            {1111}if v_1408 then
                                            (
                                                {1112}let pkSess_1409: bitstring = pub(skA) in
                                                {1113}out(c, GetEndpointRequest);
                                                {1114}in(c, (SPs_1410: bitstring,=SignAndEncrypt,UP_1411: bitstring,=pkSess_1409));
                                                {1115}new SPc_1412: bitstring;
                                                {1116}new Nc_1413: bitstring;
                                                {1117}let gNc_1414: bitstring = exp(g,Nc_1413) in
                                                {1118}let m1_1415: bitstring = (SPc_1412,gNc_1414) in
                                                {1119}out(c, (pkCli_1107,enc(m1_1415,pkSess_1409),sign(m1_1415,skCli_1106)));
                                                {1120}event beginCli(Cli,Sess,gNc_1414);
                                                {1121}in(c, (ePartS_1416: bitstring,sigPartS_1417: bitstring));
                                                {1122}let PartS_1418: bitstring = dec(ePartS_1416,skCli_1106) in
                                                {1123}if (verify(PartS_1418,sigPartS_1417,pkSess_1409) <> true) then
                                                    0
                                                else
                                                    {1124}event endCli(Sess,Cli,PartS_1418)
                                            )
                                            else
                                                {1125}let v_1419: bool = (Sess = B) in
                                                (
                                                    {1126}if v_1419 then
                                                    (
                                                        {1127}let pkSess_1420: bitstring = pub(skB) in
                                                        {1128}out(c, GetEndpointRequest);
                                                        {1129}in(c, (SPs_1421: bitstring,=SignAndEncrypt,UP_1422: bitstring,=pkSess_1420));
                                                        {1130}new SPc_1423: bitstring;
                                                        {1131}new Nc_1424: bitstring;
                                                        {1132}let gNc_1425: bitstring = exp(g,Nc_1424) in
                                                        {1133}let m1_1426: bitstring = (SPc_1423,gNc_1425) in
                                                        {1134}out(c, (pkCli_1107,enc(m1_1426,pkSess_1420),sign(m1_1426,skCli_1106)));
                                                        {1135}event beginCli(Cli,Sess,gNc_1425);
                                                        {1136}in(c, (ePartS_1427: bitstring,sigPartS_1428: bitstring));
                                                        {1137}let PartS_1429: bitstring = dec(ePartS_1427,skCli_1106) in
                                                        {1138}if (verify(PartS_1429,sigPartS_1428,pkSess_1420) <> true) then
                                                            0
                                                        else
                                                            {1139}event endCli(Sess,Cli,PartS_1429)
                                                    )
                                                    else
                                                        {1140}let v_1430: bool = (Sess = C) in
                                                        (
                                                            {1141}if v_1430 then
                                                            (
                                                                {1142}let pkSess_1431: bitstring = pub(skC) in
                                                                {1143}out(c, GetEndpointRequest);
                                                                {1144}in(c, (SPs_1432: bitstring,=SignAndEncrypt,UP_1433: bitstring,=pkSess_1431));
                                                                {1145}new SPc_1434: bitstring;
                                                                {1146}new Nc_1435: bitstring;
                                                                {1147}let gNc_1436: bitstring = exp(g,Nc_1435) in
                                                                {1148}let m1_1437: bitstring = (SPc_1434,gNc_1436) in
                                                                {1149}out(c, (pkCli_1107,enc(m1_1437,pkSess_1431),sign(m1_1437,skCli_1106)));
                                                                {1150}event beginCli(Cli,Sess,gNc_1436);
                                                                {1151}in(c, (ePartS_1438: bitstring,sigPartS_1439: bitstring));
                                                                {1152}let PartS_1440: bitstring = dec(ePartS_1438,skCli_1106) in
                                                                {1153}if (verify(PartS_1440,sigPartS_1439,pkSess_1431) <> true) then
                                                                    0
                                                                else
                                                                    {1154}event endCli(Sess,Cli,PartS_1440)
                                                            )
                                                            else
                                                                {1155}let pkSess_1441: bitstring = pub(skI) in
                                                                {1156}out(c, GetEndpointRequest);
                                                                {1157}in(c, (SPs_1442: bitstring,=SignAndEncrypt,UP_1443: bitstring,=pkSess_1441));
                                                                {1158}new SPc_1444: bitstring;
                                                                {1159}new Nc_1445: bitstring;
                                                                {1160}let gNc_1446: bitstring = exp(g,Nc_1445) in
                                                                {1161}let m1_1447: bitstring = (SPc_1444,gNc_1446) in
                                                                {1162}out(c, (pkCli_1107,enc(m1_1447,pkSess_1441),sign(m1_1447,skCli_1106)));
                                                                {1163}event beginCli(Cli,Sess,gNc_1446);
                                                                {1164}in(c, (ePartS_1448: bitstring,sigPartS_1449: bitstring));
                                                                {1165}let PartS_1450: bitstring = dec(ePartS_1448,skCli_1106) in
                                                                {1166}if (verify(PartS_1450,sigPartS_1449,pkSess_1441) <> true) then
                                                                    0
                                                                else
                                                                    {1167}event endCli(Sess,Cli,PartS_1450)
                                                        )
                                                        else
                                                            {1168}let pkSess_1451: bitstring = fail-any in
                                                            {1169}out(c, GetEndpointRequest);
                                                            {1170}in(c, (SPs_1452: bitstring,=SignAndEncrypt,UP_1453: bitstring,=pkSess_1451));
                                                            {1171}new SPc_1454: bitstring;
                                                            {1172}new Nc_1455: bitstring;
                                                            {1173}let gNc_1456: bitstring = exp(g,Nc_1455) in
                                                            {1174}let m1_1457: bitstring = (SPc_1454,gNc_1456) in
                                                            {1175}out(c, (pkCli_1107,enc(m1_1457,pkSess_1451),sign(m1_1457,skCli_1106)));
                                                            {1176}event beginCli(Cli,Sess,gNc_1456);
                                                            {1177}in(c, (ePartS_1458: bitstring,sigPartS_1459: bitstring));
                                                            {1178}let PartS_1460: bitstring = dec(ePartS_1458,skCli_1106) in
                                                            {1179}if (verify(PartS_1460,sigPartS_1459,pkSess_1451) <> true) then
                                                                0
                                                            else
                                                                {1180}event endCli(Sess,Cli,PartS_1460)
                                                )
                                                else
                                                    {1181}let pkSess_1461: bitstring = fail-any in
                                                    {1182}out(c, GetEndpointRequest);
                                                    {1183}in(c, (SPs_1462: bitstring,=SignAndEncrypt,UP_1463: bitstring,=pkSess_1461));
                                                    {1184}new SPc_1464: bitstring;
                                                    {1185}new Nc_1465: bitstring;
                                                    {1186}let gNc_1466: bitstring = exp(g,Nc_1465) in
                                                    {1187}let m1_1467: bitstring = (SPc_1464,gNc_1466) in
                                                    {1188}out(c, (pkCli_1107,enc(m1_1467,pkSess_1461),sign(m1_1467,skCli_1106)));
                                                    {1189}event beginCli(Cli,Sess,gNc_1466);
                                                    {1190}in(c, (ePartS_1468: bitstring,sigPartS_1469: bitstring));
                                                    {1191}let PartS_1470: bitstring = dec(ePartS_1468,skCli_1106) in
                                                    {1192}if (verify(PartS_1470,sigPartS_1469,pkSess_1461) <> true) then
                                                        0
                                                    else
                                                        {1193}event endCli(Sess,Cli,PartS_1470)
                                        )
                                        else
                                            {1194}let pkSess_1471: bitstring = fail-any in
                                            {1195}out(c, GetEndpointRequest);
                                            {1196}in(c, (SPs_1472: bitstring,=SignAndEncrypt,UP_1473: bitstring,=pkSess_1471));
                                            {1197}new SPc_1474: bitstring;
                                            {1198}new Nc_1475: bitstring;
                                            {1199}let gNc_1476: bitstring = exp(g,Nc_1475) in
                                            {1200}let m1_1477: bitstring = (SPc_1474,gNc_1476) in
                                            {1201}out(c, (pkCli_1107,enc(m1_1477,pkSess_1471),sign(m1_1477,skCli_1106)));
                                            {1202}event beginCli(Cli,Sess,gNc_1476);
                                            {1203}in(c, (ePartS_1478: bitstring,sigPartS_1479: bitstring));
                                            {1204}let PartS_1480: bitstring = dec(ePartS_1478,skCli_1106) in
                                            {1205}if (verify(PartS_1480,sigPartS_1479,pkSess_1471) <> true) then
                                                0
                                            else
                                                {1206}event endCli(Sess,Cli,PartS_1480)
                            )
                            else
                                {1207}let pkDisco_1481: bitstring = fail-any in
                                {1208}let v_1482: bool = (Sess = A) in
                                (
                                    {1209}if v_1482 then
                                    (
                                        {1210}let pkSess_1483: bitstring = pub(skA) in
                                        {1211}out(c, GetEndpointRequest);
                                        {1212}in(c, (SPs_1484: bitstring,=SignAndEncrypt,UP_1485: bitstring,=pkSess_1483));
                                        {1213}new SPc_1486: bitstring;
                                        {1214}new Nc_1487: bitstring;
                                        {1215}let gNc_1488: bitstring = exp(g,Nc_1487) in
                                        {1216}let m1_1489: bitstring = (SPc_1486,gNc_1488) in
                                        {1217}out(c, (pkCli_1107,enc(m1_1489,pkSess_1483),sign(m1_1489,skCli_1106)));
                                        {1218}event beginCli(Cli,Sess,gNc_1488);
                                        {1219}in(c, (ePartS_1490: bitstring,sigPartS_1491: bitstring));
                                        {1220}let PartS_1492: bitstring = dec(ePartS_1490,skCli_1106) in
                                        {1221}if (verify(PartS_1492,sigPartS_1491,pkSess_1483) <> true) then
                                            0
                                        else
                                            {1222}event endCli(Sess,Cli,PartS_1492)
                                    )
                                    else
                                        {1223}let v_1493: bool = (Sess = B) in
                                        (
                                            {1224}if v_1493 then
                                            (
                                                {1225}let pkSess_1494: bitstring = pub(skB) in
                                                {1226}out(c, GetEndpointRequest);
                                                {1227}in(c, (SPs_1495: bitstring,=SignAndEncrypt,UP_1496: bitstring,=pkSess_1494));
                                                {1228}new SPc_1497: bitstring;
                                                {1229}new Nc_1498: bitstring;
                                                {1230}let gNc_1499: bitstring = exp(g,Nc_1498) in
                                                {1231}let m1_1500: bitstring = (SPc_1497,gNc_1499) in
                                                {1232}out(c, (pkCli_1107,enc(m1_1500,pkSess_1494),sign(m1_1500,skCli_1106)));
                                                {1233}event beginCli(Cli,Sess,gNc_1499);
                                                {1234}in(c, (ePartS_1501: bitstring,sigPartS_1502: bitstring));
                                                {1235}let PartS_1503: bitstring = dec(ePartS_1501,skCli_1106) in
                                                {1236}if (verify(PartS_1503,sigPartS_1502,pkSess_1494) <> true) then
                                                    0
                                                else
                                                    {1237}event endCli(Sess,Cli,PartS_1503)
                                            )
                                            else
                                                {1238}let v_1504: bool = (Sess = C) in
                                                (
                                                    {1239}if v_1504 then
                                                    (
                                                        {1240}let pkSess_1505: bitstring = pub(skC) in
                                                        {1241}out(c, GetEndpointRequest);
                                                        {1242}in(c, (SPs_1506: bitstring,=SignAndEncrypt,UP_1507: bitstring,=pkSess_1505));
                                                        {1243}new SPc_1508: bitstring;
                                                        {1244}new Nc_1509: bitstring;
                                                        {1245}let gNc_1510: bitstring = exp(g,Nc_1509) in
                                                        {1246}let m1_1511: bitstring = (SPc_1508,gNc_1510) in
                                                        {1247}out(c, (pkCli_1107,enc(m1_1511,pkSess_1505),sign(m1_1511,skCli_1106)));
                                                        {1248}event beginCli(Cli,Sess,gNc_1510);
                                                        {1249}in(c, (ePartS_1512: bitstring,sigPartS_1513: bitstring));
                                                        {1250}let PartS_1514: bitstring = dec(ePartS_1512,skCli_1106) in
                                                        {1251}if (verify(PartS_1514,sigPartS_1513,pkSess_1505) <> true) then
                                                            0
                                                        else
                                                            {1252}event endCli(Sess,Cli,PartS_1514)
                                                    )
                                                    else
                                                        {1253}let pkSess_1515: bitstring = pub(skI) in
                                                        {1254}out(c, GetEndpointRequest);
                                                        {1255}in(c, (SPs_1516: bitstring,=SignAndEncrypt,UP_1517: bitstring,=pkSess_1515));
                                                        {1256}new SPc_1518: bitstring;
                                                        {1257}new Nc_1519: bitstring;
                                                        {1258}let gNc_1520: bitstring = exp(g,Nc_1519) in
                                                        {1259}let m1_1521: bitstring = (SPc_1518,gNc_1520) in
                                                        {1260}out(c, (pkCli_1107,enc(m1_1521,pkSess_1515),sign(m1_1521,skCli_1106)));
                                                        {1261}event beginCli(Cli,Sess,gNc_1520);
                                                        {1262}in(c, (ePartS_1522: bitstring,sigPartS_1523: bitstring));
                                                        {1263}let PartS_1524: bitstring = dec(ePartS_1522,skCli_1106) in
                                                        {1264}if (verify(PartS_1524,sigPartS_1523,pkSess_1515) <> true) then
                                                            0
                                                        else
                                                            {1265}event endCli(Sess,Cli,PartS_1524)
                                                )
                                                else
                                                    {1266}let pkSess_1525: bitstring = fail-any in
                                                    {1267}out(c, GetEndpointRequest);
                                                    {1268}in(c, (SPs_1526: bitstring,=SignAndEncrypt,UP_1527: bitstring,=pkSess_1525));
                                                    {1269}new SPc_1528: bitstring;
                                                    {1270}new Nc_1529: bitstring;
                                                    {1271}let gNc_1530: bitstring = exp(g,Nc_1529) in
                                                    {1272}let m1_1531: bitstring = (SPc_1528,gNc_1530) in
                                                    {1273}out(c, (pkCli_1107,enc(m1_1531,pkSess_1525),sign(m1_1531,skCli_1106)));
                                                    {1274}event beginCli(Cli,Sess,gNc_1530);
                                                    {1275}in(c, (ePartS_1532: bitstring,sigPartS_1533: bitstring));
                                                    {1276}let PartS_1534: bitstring = dec(ePartS_1532,skCli_1106) in
                                                    {1277}if (verify(PartS_1534,sigPartS_1533,pkSess_1525) <> true) then
                                                        0
                                                    else
                                                        {1278}event endCli(Sess,Cli,PartS_1534)
                                        )
                                        else
                                            {1279}let pkSess_1535: bitstring = fail-any in
                                            {1280}out(c, GetEndpointRequest);
                                            {1281}in(c, (SPs_1536: bitstring,=SignAndEncrypt,UP_1537: bitstring,=pkSess_1535));
                                            {1282}new SPc_1538: bitstring;
                                            {1283}new Nc_1539: bitstring;
                                            {1284}let gNc_1540: bitstring = exp(g,Nc_1539) in
                                            {1285}let m1_1541: bitstring = (SPc_1538,gNc_1540) in
                                            {1286}out(c, (pkCli_1107,enc(m1_1541,pkSess_1535),sign(m1_1541,skCli_1106)));
                                            {1287}event beginCli(Cli,Sess,gNc_1540);
                                            {1288}in(c, (ePartS_1542: bitstring,sigPartS_1543: bitstring));
                                            {1289}let PartS_1544: bitstring = dec(ePartS_1542,skCli_1106) in
                                            {1290}if (verify(PartS_1544,sigPartS_1543,pkSess_1535) <> true) then
                                                0
                                            else
                                                {1291}event endCli(Sess,Cli,PartS_1544)
                                )
                                else
                                    {1292}let pkSess_1545: bitstring = fail-any in
                                    {1293}out(c, GetEndpointRequest);
                                    {1294}in(c, (SPs_1546: bitstring,=SignAndEncrypt,UP_1547: bitstring,=pkSess_1545));
                                    {1295}new SPc_1548: bitstring;
                                    {1296}new Nc_1549: bitstring;
                                    {1297}let gNc_1550: bitstring = exp(g,Nc_1549) in
                                    {1298}let m1_1551: bitstring = (SPc_1548,gNc_1550) in
                                    {1299}out(c, (pkCli_1107,enc(m1_1551,pkSess_1545),sign(m1_1551,skCli_1106)));
                                    {1300}event beginCli(Cli,Sess,gNc_1550);
                                    {1301}in(c, (ePartS_1552: bitstring,sigPartS_1553: bitstring));
                                    {1302}let PartS_1554: bitstring = dec(ePartS_1552,skCli_1106) in
                                    {1303}if (verify(PartS_1554,sigPartS_1553,pkSess_1545) <> true) then
                                        0
                                    else
                                        {1304}event endCli(Sess,Cli,PartS_1554)
                    )
                    else
                        {1305}let pkDisco_1555: bitstring = fail-any in
                        {1306}let v_1556: bool = (Sess = A) in
                        (
                            {1307}if v_1556 then
                            (
                                {1308}let pkSess_1557: bitstring = pub(skA) in
                                {1309}out(c, GetEndpointRequest);
                                {1310}in(c, (SPs_1558: bitstring,=SignAndEncrypt,UP_1559: bitstring,=pkSess_1557));
                                {1311}new SPc_1560: bitstring;
                                {1312}new Nc_1561: bitstring;
                                {1313}let gNc_1562: bitstring = exp(g,Nc_1561) in
                                {1314}let m1_1563: bitstring = (SPc_1560,gNc_1562) in
                                {1315}out(c, (pkCli_1107,enc(m1_1563,pkSess_1557),sign(m1_1563,skCli_1106)));
                                {1316}event beginCli(Cli,Sess,gNc_1562);
                                {1317}in(c, (ePartS_1564: bitstring,sigPartS_1565: bitstring));
                                {1318}let PartS_1566: bitstring = dec(ePartS_1564,skCli_1106) in
                                {1319}if (verify(PartS_1566,sigPartS_1565,pkSess_1557) <> true) then
                                    0
                                else
                                    {1320}event endCli(Sess,Cli,PartS_1566)
                            )
                            else
                                {1321}let v_1567: bool = (Sess = B) in
                                (
                                    {1322}if v_1567 then
                                    (
                                        {1323}let pkSess_1568: bitstring = pub(skB) in
                                        {1324}out(c, GetEndpointRequest);
                                        {1325}in(c, (SPs_1569: bitstring,=SignAndEncrypt,UP_1570: bitstring,=pkSess_1568));
                                        {1326}new SPc_1571: bitstring;
                                        {1327}new Nc_1572: bitstring;
                                        {1328}let gNc_1573: bitstring = exp(g,Nc_1572) in
                                        {1329}let m1_1574: bitstring = (SPc_1571,gNc_1573) in
                                        {1330}out(c, (pkCli_1107,enc(m1_1574,pkSess_1568),sign(m1_1574,skCli_1106)));
                                        {1331}event beginCli(Cli,Sess,gNc_1573);
                                        {1332}in(c, (ePartS_1575: bitstring,sigPartS_1576: bitstring));
                                        {1333}let PartS_1577: bitstring = dec(ePartS_1575,skCli_1106) in
                                        {1334}if (verify(PartS_1577,sigPartS_1576,pkSess_1568) <> true) then
                                            0
                                        else
                                            {1335}event endCli(Sess,Cli,PartS_1577)
                                    )
                                    else
                                        {1336}let v_1578: bool = (Sess = C) in
                                        (
                                            {1337}if v_1578 then
                                            (
                                                {1338}let pkSess_1579: bitstring = pub(skC) in
                                                {1339}out(c, GetEndpointRequest);
                                                {1340}in(c, (SPs_1580: bitstring,=SignAndEncrypt,UP_1581: bitstring,=pkSess_1579));
                                                {1341}new SPc_1582: bitstring;
                                                {1342}new Nc_1583: bitstring;
                                                {1343}let gNc_1584: bitstring = exp(g,Nc_1583) in
                                                {1344}let m1_1585: bitstring = (SPc_1582,gNc_1584) in
                                                {1345}out(c, (pkCli_1107,enc(m1_1585,pkSess_1579),sign(m1_1585,skCli_1106)));
                                                {1346}event beginCli(Cli,Sess,gNc_1584);
                                                {1347}in(c, (ePartS_1586: bitstring,sigPartS_1587: bitstring));
                                                {1348}let PartS_1588: bitstring = dec(ePartS_1586,skCli_1106) in
                                                {1349}if (verify(PartS_1588,sigPartS_1587,pkSess_1579) <> true) then
                                                    0
                                                else
                                                    {1350}event endCli(Sess,Cli,PartS_1588)
                                            )
                                            else
                                                {1351}let pkSess_1589: bitstring = pub(skI) in
                                                {1352}out(c, GetEndpointRequest);
                                                {1353}in(c, (SPs_1590: bitstring,=SignAndEncrypt,UP_1591: bitstring,=pkSess_1589));
                                                {1354}new SPc_1592: bitstring;
                                                {1355}new Nc_1593: bitstring;
                                                {1356}let gNc_1594: bitstring = exp(g,Nc_1593) in
                                                {1357}let m1_1595: bitstring = (SPc_1592,gNc_1594) in
                                                {1358}out(c, (pkCli_1107,enc(m1_1595,pkSess_1589),sign(m1_1595,skCli_1106)));
                                                {1359}event beginCli(Cli,Sess,gNc_1594);
                                                {1360}in(c, (ePartS_1596: bitstring,sigPartS_1597: bitstring));
                                                {1361}let PartS_1598: bitstring = dec(ePartS_1596,skCli_1106) in
                                                {1362}if (verify(PartS_1598,sigPartS_1597,pkSess_1589) <> true) then
                                                    0
                                                else
                                                    {1363}event endCli(Sess,Cli,PartS_1598)
                                        )
                                        else
                                            {1364}let pkSess_1599: bitstring = fail-any in
                                            {1365}out(c, GetEndpointRequest);
                                            {1366}in(c, (SPs_1600: bitstring,=SignAndEncrypt,UP_1601: bitstring,=pkSess_1599));
                                            {1367}new SPc_1602: bitstring;
                                            {1368}new Nc_1603: bitstring;
                                            {1369}let gNc_1604: bitstring = exp(g,Nc_1603) in
                                            {1370}let m1_1605: bitstring = (SPc_1602,gNc_1604) in
                                            {1371}out(c, (pkCli_1107,enc(m1_1605,pkSess_1599),sign(m1_1605,skCli_1106)));
                                            {1372}event beginCli(Cli,Sess,gNc_1604);
                                            {1373}in(c, (ePartS_1606: bitstring,sigPartS_1607: bitstring));
                                            {1374}let PartS_1608: bitstring = dec(ePartS_1606,skCli_1106) in
                                            {1375}if (verify(PartS_1608,sigPartS_1607,pkSess_1599) <> true) then
                                                0
                                            else
                                                {1376}event endCli(Sess,Cli,PartS_1608)
                                )
                                else
                                    {1377}let pkSess_1609: bitstring = fail-any in
                                    {1378}out(c, GetEndpointRequest);
                                    {1379}in(c, (SPs_1610: bitstring,=SignAndEncrypt,UP_1611: bitstring,=pkSess_1609));
                                    {1380}new SPc_1612: bitstring;
                                    {1381}new Nc_1613: bitstring;
                                    {1382}let gNc_1614: bitstring = exp(g,Nc_1613) in
                                    {1383}let m1_1615: bitstring = (SPc_1612,gNc_1614) in
                                    {1384}out(c, (pkCli_1107,enc(m1_1615,pkSess_1609),sign(m1_1615,skCli_1106)));
                                    {1385}event beginCli(Cli,Sess,gNc_1614);
                                    {1386}in(c, (ePartS_1616: bitstring,sigPartS_1617: bitstring));
                                    {1387}let PartS_1618: bitstring = dec(ePartS_1616,skCli_1106) in
                                    {1388}if (verify(PartS_1618,sigPartS_1617,pkSess_1609) <> true) then
                                        0
                                    else
                                        {1389}event endCli(Sess,Cli,PartS_1618)
                        )
                        else
                            {1390}let pkSess_1619: bitstring = fail-any in
                            {1391}out(c, GetEndpointRequest);
                            {1392}in(c, (SPs_1620: bitstring,=SignAndEncrypt,UP_1621: bitstring,=pkSess_1619));
                            {1393}new SPc_1622: bitstring;
                            {1394}new Nc_1623: bitstring;
                            {1395}let gNc_1624: bitstring = exp(g,Nc_1623) in
                            {1396}let m1_1625: bitstring = (SPc_1622,gNc_1624) in
                            {1397}out(c, (pkCli_1107,enc(m1_1625,pkSess_1619),sign(m1_1625,skCli_1106)));
                            {1398}event beginCli(Cli,Sess,gNc_1624);
                            {1399}in(c, (ePartS_1626: bitstring,sigPartS_1627: bitstring));
                            {1400}let PartS_1628: bitstring = dec(ePartS_1626,skCli_1106) in
                            {1401}if (verify(PartS_1628,sigPartS_1627,pkSess_1619) <> true) then
                                0
                            else
                                {1402}event endCli(Sess,Cli,PartS_1628)
                )
                else
                    {1403}let v_1629: bool = (Cli = C) in
                    (
                        {1404}if v_1629 then
                        (
                            {1405}let skCli_1630: bitstring = skC in
                            {1406}let pkCli_1631: bitstring = pub(skCli_1630) in
                            {1407}let v_1632: bool = (Disco = A) in
                            (
                                {1408}if v_1632 then
                                (
                                    {1409}let pkDisco_1633: bitstring = pub(skA) in
                                    {1410}let v_1634: bool = (Sess = A) in
                                    (
                                        {1411}if v_1634 then
                                        (
                                            {1412}let pkSess_1635: bitstring = pub(skA) in
                                            {1413}out(c, GetEndpointRequest);
                                            {1414}in(c, (SPs_1636: bitstring,=SignAndEncrypt,UP_1637: bitstring,=pkSess_1635));
                                            {1415}new SPc_1638: bitstring;
                                            {1416}new Nc_1639: bitstring;
                                            {1417}let gNc_1640: bitstring = exp(g,Nc_1639) in
                                            {1418}let m1_1641: bitstring = (SPc_1638,gNc_1640) in
                                            {1419}out(c, (pkCli_1631,enc(m1_1641,pkSess_1635),sign(m1_1641,skCli_1630)));
                                            {1420}event beginCli(Cli,Sess,gNc_1640);
                                            {1421}in(c, (ePartS_1642: bitstring,sigPartS_1643: bitstring));
                                            {1422}let PartS_1644: bitstring = dec(ePartS_1642,skCli_1630) in
                                            {1423}if (verify(PartS_1644,sigPartS_1643,pkSess_1635) <> true) then
                                                0
                                            else
                                                {1424}event endCli(Sess,Cli,PartS_1644)
                                        )
                                        else
                                            {1425}let v_1645: bool = (Sess = B) in
                                            (
                                                {1426}if v_1645 then
                                                (
                                                    {1427}let pkSess_1646: bitstring = pub(skB) in
                                                    {1428}out(c, GetEndpointRequest);
                                                    {1429}in(c, (SPs_1647: bitstring,=SignAndEncrypt,UP_1648: bitstring,=pkSess_1646));
                                                    {1430}new SPc_1649: bitstring;
                                                    {1431}new Nc_1650: bitstring;
                                                    {1432}let gNc_1651: bitstring = exp(g,Nc_1650) in
                                                    {1433}let m1_1652: bitstring = (SPc_1649,gNc_1651) in
                                                    {1434}out(c, (pkCli_1631,enc(m1_1652,pkSess_1646),sign(m1_1652,skCli_1630)));
                                                    {1435}event beginCli(Cli,Sess,gNc_1651);
                                                    {1436}in(c, (ePartS_1653: bitstring,sigPartS_1654: bitstring));
                                                    {1437}let PartS_1655: bitstring = dec(ePartS_1653,skCli_1630) in
                                                    {1438}if (verify(PartS_1655,sigPartS_1654,pkSess_1646) <> true) then
                                                        0
                                                    else
                                                        {1439}event endCli(Sess,Cli,PartS_1655)
                                                )
                                                else
                                                    {1440}let v_1656: bool = (Sess = C) in
                                                    (
                                                        {1441}if v_1656 then
                                                        (
                                                            {1442}let pkSess_1657: bitstring = pub(skC) in
                                                            {1443}out(c, GetEndpointRequest);
                                                            {1444}in(c, (SPs_1658: bitstring,=SignAndEncrypt,UP_1659: bitstring,=pkSess_1657));
                                                            {1445}new SPc_1660: bitstring;
                                                            {1446}new Nc_1661: bitstring;
                                                            {1447}let gNc_1662: bitstring = exp(g,Nc_1661) in
                                                            {1448}let m1_1663: bitstring = (SPc_1660,gNc_1662) in
                                                            {1449}out(c, (pkCli_1631,enc(m1_1663,pkSess_1657),sign(m1_1663,skCli_1630)));
                                                            {1450}event beginCli(Cli,Sess,gNc_1662);
                                                            {1451}in(c, (ePartS_1664: bitstring,sigPartS_1665: bitstring));
                                                            {1452}let PartS_1666: bitstring = dec(ePartS_1664,skCli_1630) in
                                                            {1453}if (verify(PartS_1666,sigPartS_1665,pkSess_1657) <> true) then
                                                                0
                                                            else
                                                                {1454}event endCli(Sess,Cli,PartS_1666)
                                                        )
                                                        else
                                                            {1455}let pkSess_1667: bitstring = pub(skI) in
                                                            {1456}out(c, GetEndpointRequest);
                                                            {1457}in(c, (SPs_1668: bitstring,=SignAndEncrypt,UP_1669: bitstring,=pkSess_1667));
                                                            {1458}new SPc_1670: bitstring;
                                                            {1459}new Nc_1671: bitstring;
                                                            {1460}let gNc_1672: bitstring = exp(g,Nc_1671) in
                                                            {1461}let m1_1673: bitstring = (SPc_1670,gNc_1672) in
                                                            {1462}out(c, (pkCli_1631,enc(m1_1673,pkSess_1667),sign(m1_1673,skCli_1630)));
                                                            {1463}event beginCli(Cli,Sess,gNc_1672);
                                                            {1464}in(c, (ePartS_1674: bitstring,sigPartS_1675: bitstring));
                                                            {1465}let PartS_1676: bitstring = dec(ePartS_1674,skCli_1630) in
                                                            {1466}if (verify(PartS_1676,sigPartS_1675,pkSess_1667) <> true) then
                                                                0
                                                            else
                                                                {1467}event endCli(Sess,Cli,PartS_1676)
                                                    )
                                                    else
                                                        {1468}let pkSess_1677: bitstring = fail-any in
                                                        {1469}out(c, GetEndpointRequest);
                                                        {1470}in(c, (SPs_1678: bitstring,=SignAndEncrypt,UP_1679: bitstring,=pkSess_1677));
                                                        {1471}new SPc_1680: bitstring;
                                                        {1472}new Nc_1681: bitstring;
                                                        {1473}let gNc_1682: bitstring = exp(g,Nc_1681) in
                                                        {1474}let m1_1683: bitstring = (SPc_1680,gNc_1682) in
                                                        {1475}out(c, (pkCli_1631,enc(m1_1683,pkSess_1677),sign(m1_1683,skCli_1630)));
                                                        {1476}event beginCli(Cli,Sess,gNc_1682);
                                                        {1477}in(c, (ePartS_1684: bitstring,sigPartS_1685: bitstring));
                                                        {1478}let PartS_1686: bitstring = dec(ePartS_1684,skCli_1630) in
                                                        {1479}if (verify(PartS_1686,sigPartS_1685,pkSess_1677) <> true) then
                                                            0
                                                        else
                                                            {1480}event endCli(Sess,Cli,PartS_1686)
                                            )
                                            else
                                                {1481}let pkSess_1687: bitstring = fail-any in
                                                {1482}out(c, GetEndpointRequest);
                                                {1483}in(c, (SPs_1688: bitstring,=SignAndEncrypt,UP_1689: bitstring,=pkSess_1687));
                                                {1484}new SPc_1690: bitstring;
                                                {1485}new Nc_1691: bitstring;
                                                {1486}let gNc_1692: bitstring = exp(g,Nc_1691) in
                                                {1487}let m1_1693: bitstring = (SPc_1690,gNc_1692) in
                                                {1488}out(c, (pkCli_1631,enc(m1_1693,pkSess_1687),sign(m1_1693,skCli_1630)));
                                                {1489}event beginCli(Cli,Sess,gNc_1692);
                                                {1490}in(c, (ePartS_1694: bitstring,sigPartS_1695: bitstring));
                                                {1491}let PartS_1696: bitstring = dec(ePartS_1694,skCli_1630) in
                                                {1492}if (verify(PartS_1696,sigPartS_1695,pkSess_1687) <> true) then
                                                    0
                                                else
                                                    {1493}event endCli(Sess,Cli,PartS_1696)
                                    )
                                    else
                                        {1494}let pkSess_1697: bitstring = fail-any in
                                        {1495}out(c, GetEndpointRequest);
                                        {1496}in(c, (SPs_1698: bitstring,=SignAndEncrypt,UP_1699: bitstring,=pkSess_1697));
                                        {1497}new SPc_1700: bitstring;
                                        {1498}new Nc_1701: bitstring;
                                        {1499}let gNc_1702: bitstring = exp(g,Nc_1701) in
                                        {1500}let m1_1703: bitstring = (SPc_1700,gNc_1702) in
                                        {1501}out(c, (pkCli_1631,enc(m1_1703,pkSess_1697),sign(m1_1703,skCli_1630)));
                                        {1502}event beginCli(Cli,Sess,gNc_1702);
                                        {1503}in(c, (ePartS_1704: bitstring,sigPartS_1705: bitstring));
                                        {1504}let PartS_1706: bitstring = dec(ePartS_1704,skCli_1630) in
                                        {1505}if (verify(PartS_1706,sigPartS_1705,pkSess_1697) <> true) then
                                            0
                                        else
                                            {1506}event endCli(Sess,Cli,PartS_1706)
                                )
                                else
                                    {1507}let v_1707: bool = (Disco = B) in
                                    (
                                        {1508}if v_1707 then
                                        (
                                            {1509}let pkDisco_1708: bitstring = pub(skB) in
                                            {1510}let v_1709: bool = (Sess = A) in
                                            (
                                                {1511}if v_1709 then
                                                (
                                                    {1512}let pkSess_1710: bitstring = pub(skA) in
                                                    {1513}out(c, GetEndpointRequest);
                                                    {1514}in(c, (SPs_1711: bitstring,=SignAndEncrypt,UP_1712: bitstring,=pkSess_1710));
                                                    {1515}new SPc_1713: bitstring;
                                                    {1516}new Nc_1714: bitstring;
                                                    {1517}let gNc_1715: bitstring = exp(g,Nc_1714) in
                                                    {1518}let m1_1716: bitstring = (SPc_1713,gNc_1715) in
                                                    {1519}out(c, (pkCli_1631,enc(m1_1716,pkSess_1710),sign(m1_1716,skCli_1630)));
                                                    {1520}event beginCli(Cli,Sess,gNc_1715);
                                                    {1521}in(c, (ePartS_1717: bitstring,sigPartS_1718: bitstring));
                                                    {1522}let PartS_1719: bitstring = dec(ePartS_1717,skCli_1630) in
                                                    {1523}if (verify(PartS_1719,sigPartS_1718,pkSess_1710) <> true) then
                                                        0
                                                    else
                                                        {1524}event endCli(Sess,Cli,PartS_1719)
                                                )
                                                else
                                                    {1525}let v_1720: bool = (Sess = B) in
                                                    (
                                                        {1526}if v_1720 then
                                                        (
                                                            {1527}let pkSess_1721: bitstring = pub(skB) in
                                                            {1528}out(c, GetEndpointRequest);
                                                            {1529}in(c, (SPs_1722: bitstring,=SignAndEncrypt,UP_1723: bitstring,=pkSess_1721));
                                                            {1530}new SPc_1724: bitstring;
                                                            {1531}new Nc_1725: bitstring;
                                                            {1532}let gNc_1726: bitstring = exp(g,Nc_1725) in
                                                            {1533}let m1_1727: bitstring = (SPc_1724,gNc_1726) in
                                                            {1534}out(c, (pkCli_1631,enc(m1_1727,pkSess_1721),sign(m1_1727,skCli_1630)));
                                                            {1535}event beginCli(Cli,Sess,gNc_1726);
                                                            {1536}in(c, (ePartS_1728: bitstring,sigPartS_1729: bitstring));
                                                            {1537}let PartS_1730: bitstring = dec(ePartS_1728,skCli_1630) in
                                                            {1538}if (verify(PartS_1730,sigPartS_1729,pkSess_1721) <> true) then
                                                                0
                                                            else
                                                                {1539}event endCli(Sess,Cli,PartS_1730)
                                                        )
                                                        else
                                                            {1540}let v_1731: bool = (Sess = C) in
                                                            (
                                                                {1541}if v_1731 then
                                                                (
                                                                    {1542}let pkSess_1732: bitstring = pub(skC) in
                                                                    {1543}out(c, GetEndpointRequest);
                                                                    {1544}in(c, (SPs_1733: bitstring,=SignAndEncrypt,UP_1734: bitstring,=pkSess_1732));
                                                                    {1545}new SPc_1735: bitstring;
                                                                    {1546}new Nc_1736: bitstring;
                                                                    {1547}let gNc_1737: bitstring = exp(g,Nc_1736) in
                                                                    {1548}let m1_1738: bitstring = (SPc_1735,gNc_1737) in
                                                                    {1549}out(c, (pkCli_1631,enc(m1_1738,pkSess_1732),sign(m1_1738,skCli_1630)));
                                                                    {1550}event beginCli(Cli,Sess,gNc_1737);
                                                                    {1551}in(c, (ePartS_1739: bitstring,sigPartS_1740: bitstring));
                                                                    {1552}let PartS_1741: bitstring = dec(ePartS_1739,skCli_1630) in
                                                                    {1553}if (verify(PartS_1741,sigPartS_1740,pkSess_1732) <> true) then
                                                                        0
                                                                    else
                                                                        {1554}event endCli(Sess,Cli,PartS_1741)
                                                                )
                                                                else
                                                                    {1555}let pkSess_1742: bitstring = pub(skI) in
                                                                    {1556}out(c, GetEndpointRequest);
                                                                    {1557}in(c, (SPs_1743: bitstring,=SignAndEncrypt,UP_1744: bitstring,=pkSess_1742));
                                                                    {1558}new SPc_1745: bitstring;
                                                                    {1559}new Nc_1746: bitstring;
                                                                    {1560}let gNc_1747: bitstring = exp(g,Nc_1746) in
                                                                    {1561}let m1_1748: bitstring = (SPc_1745,gNc_1747) in
                                                                    {1562}out(c, (pkCli_1631,enc(m1_1748,pkSess_1742),sign(m1_1748,skCli_1630)));
                                                                    {1563}event beginCli(Cli,Sess,gNc_1747);
                                                                    {1564}in(c, (ePartS_1749: bitstring,sigPartS_1750: bitstring));
                                                                    {1565}let PartS_1751: bitstring = dec(ePartS_1749,skCli_1630) in
                                                                    {1566}if (verify(PartS_1751,sigPartS_1750,pkSess_1742) <> true) then
                                                                        0
                                                                    else
                                                                        {1567}event endCli(Sess,Cli,PartS_1751)
                                                            )
                                                            else
                                                                {1568}let pkSess_1752: bitstring = fail-any in
                                                                {1569}out(c, GetEndpointRequest);
                                                                {1570}in(c, (SPs_1753: bitstring,=SignAndEncrypt,UP_1754: bitstring,=pkSess_1752));
                                                                {1571}new SPc_1755: bitstring;
                                                                {1572}new Nc_1756: bitstring;
                                                                {1573}let gNc_1757: bitstring = exp(g,Nc_1756) in
                                                                {1574}let m1_1758: bitstring = (SPc_1755,gNc_1757) in
                                                                {1575}out(c, (pkCli_1631,enc(m1_1758,pkSess_1752),sign(m1_1758,skCli_1630)));
                                                                {1576}event beginCli(Cli,Sess,gNc_1757);
                                                                {1577}in(c, (ePartS_1759: bitstring,sigPartS_1760: bitstring));
                                                                {1578}let PartS_1761: bitstring = dec(ePartS_1759,skCli_1630) in
                                                                {1579}if (verify(PartS_1761,sigPartS_1760,pkSess_1752) <> true) then
                                                                    0
                                                                else
                                                                    {1580}event endCli(Sess,Cli,PartS_1761)
                                                    )
                                                    else
                                                        {1581}let pkSess_1762: bitstring = fail-any in
                                                        {1582}out(c, GetEndpointRequest);
                                                        {1583}in(c, (SPs_1763: bitstring,=SignAndEncrypt,UP_1764: bitstring,=pkSess_1762));
                                                        {1584}new SPc_1765: bitstring;
                                                        {1585}new Nc_1766: bitstring;
                                                        {1586}let gNc_1767: bitstring = exp(g,Nc_1766) in
                                                        {1587}let m1_1768: bitstring = (SPc_1765,gNc_1767) in
                                                        {1588}out(c, (pkCli_1631,enc(m1_1768,pkSess_1762),sign(m1_1768,skCli_1630)));
                                                        {1589}event beginCli(Cli,Sess,gNc_1767);
                                                        {1590}in(c, (ePartS_1769: bitstring,sigPartS_1770: bitstring));
                                                        {1591}let PartS_1771: bitstring = dec(ePartS_1769,skCli_1630) in
                                                        {1592}if (verify(PartS_1771,sigPartS_1770,pkSess_1762) <> true) then
                                                            0
                                                        else
                                                            {1593}event endCli(Sess,Cli,PartS_1771)
                                            )
                                            else
                                                {1594}let pkSess_1772: bitstring = fail-any in
                                                {1595}out(c, GetEndpointRequest);
                                                {1596}in(c, (SPs_1773: bitstring,=SignAndEncrypt,UP_1774: bitstring,=pkSess_1772));
                                                {1597}new SPc_1775: bitstring;
                                                {1598}new Nc_1776: bitstring;
                                                {1599}let gNc_1777: bitstring = exp(g,Nc_1776) in
                                                {1600}let m1_1778: bitstring = (SPc_1775,gNc_1777) in
                                                {1601}out(c, (pkCli_1631,enc(m1_1778,pkSess_1772),sign(m1_1778,skCli_1630)));
                                                {1602}event beginCli(Cli,Sess,gNc_1777);
                                                {1603}in(c, (ePartS_1779: bitstring,sigPartS_1780: bitstring));
                                                {1604}let PartS_1781: bitstring = dec(ePartS_1779,skCli_1630) in
                                                {1605}if (verify(PartS_1781,sigPartS_1780,pkSess_1772) <> true) then
                                                    0
                                                else
                                                    {1606}event endCli(Sess,Cli,PartS_1781)
                                        )
                                        else
                                            {1607}let v_1782: bool = (Disco = C) in
                                            (
                                                {1608}if v_1782 then
                                                (
                                                    {1609}let pkDisco_1783: bitstring = pub(skC) in
                                                    {1610}let v_1784: bool = (Sess = A) in
                                                    (
                                                        {1611}if v_1784 then
                                                        (
                                                            {1612}let pkSess_1785: bitstring = pub(skA) in
                                                            {1613}out(c, GetEndpointRequest);
                                                            {1614}in(c, (SPs_1786: bitstring,=SignAndEncrypt,UP_1787: bitstring,=pkSess_1785));
                                                            {1615}new SPc_1788: bitstring;
                                                            {1616}new Nc_1789: bitstring;
                                                            {1617}let gNc_1790: bitstring = exp(g,Nc_1789) in
                                                            {1618}let m1_1791: bitstring = (SPc_1788,gNc_1790) in
                                                            {1619}out(c, (pkCli_1631,enc(m1_1791,pkSess_1785),sign(m1_1791,skCli_1630)));
                                                            {1620}event beginCli(Cli,Sess,gNc_1790);
                                                            {1621}in(c, (ePartS_1792: bitstring,sigPartS_1793: bitstring));
                                                            {1622}let PartS_1794: bitstring = dec(ePartS_1792,skCli_1630) in
                                                            {1623}if (verify(PartS_1794,sigPartS_1793,pkSess_1785) <> true) then
                                                                0
                                                            else
                                                                {1624}event endCli(Sess,Cli,PartS_1794)
                                                        )
                                                        else
                                                            {1625}let v_1795: bool = (Sess = B) in
                                                            (
                                                                {1626}if v_1795 then
                                                                (
                                                                    {1627}let pkSess_1796: bitstring = pub(skB) in
                                                                    {1628}out(c, GetEndpointRequest);
                                                                    {1629}in(c, (SPs_1797: bitstring,=SignAndEncrypt,UP_1798: bitstring,=pkSess_1796));
                                                                    {1630}new SPc_1799: bitstring;
                                                                    {1631}new Nc_1800: bitstring;
                                                                    {1632}let gNc_1801: bitstring = exp(g,Nc_1800) in
                                                                    {1633}let m1_1802: bitstring = (SPc_1799,gNc_1801) in
                                                                    {1634}out(c, (pkCli_1631,enc(m1_1802,pkSess_1796),sign(m1_1802,skCli_1630)));
                                                                    {1635}event beginCli(Cli,Sess,gNc_1801);
                                                                    {1636}in(c, (ePartS_1803: bitstring,sigPartS_1804: bitstring));
                                                                    {1637}let PartS_1805: bitstring = dec(ePartS_1803,skCli_1630) in
                                                                    {1638}if (verify(PartS_1805,sigPartS_1804,pkSess_1796) <> true) then
                                                                        0
                                                                    else
                                                                        {1639}event endCli(Sess,Cli,PartS_1805)
                                                                )
                                                                else
                                                                    {1640}let v_1806: bool = (Sess = C) in
                                                                    (
                                                                        {1641}if v_1806 then
                                                                        (
                                                                            {1642}let pkSess_1807: bitstring = pub(skC) in
                                                                            {1643}out(c, GetEndpointRequest);
                                                                            {1644}in(c, (SPs_1808: bitstring,=SignAndEncrypt,UP_1809: bitstring,=pkSess_1807));
                                                                            {1645}new SPc_1810: bitstring;
                                                                            {1646}new Nc_1811: bitstring;
                                                                            {1647}let gNc_1812: bitstring = exp(g,Nc_1811) in
                                                                            {1648}let m1_1813: bitstring = (SPc_1810,gNc_1812) in
                                                                            {1649}out(c, (pkCli_1631,enc(m1_1813,pkSess_1807),sign(m1_1813,skCli_1630)));
                                                                            {1650}event beginCli(Cli,Sess,gNc_1812);
                                                                            {1651}in(c, (ePartS_1814: bitstring,sigPartS_1815: bitstring));
                                                                            {1652}let PartS_1816: bitstring = dec(ePartS_1814,skCli_1630) in
                                                                            {1653}if (verify(PartS_1816,sigPartS_1815,pkSess_1807) <> true) then
                                                                                0
                                                                            else
                                                                                {1654}event endCli(Sess,Cli,PartS_1816)
                                                                        )
                                                                        else
                                                                            {1655}let pkSess_1817: bitstring = pub(skI) in
                                                                            {1656}out(c, GetEndpointRequest);
                                                                            {1657}in(c, (SPs_1818: bitstring,=SignAndEncrypt,UP_1819: bitstring,=pkSess_1817));
                                                                            {1658}new SPc_1820: bitstring;
                                                                            {1659}new Nc_1821: bitstring;
                                                                            {1660}let gNc_1822: bitstring = exp(g,Nc_1821) in
                                                                            {1661}let m1_1823: bitstring = (SPc_1820,gNc_1822) in
                                                                            {1662}out(c, (pkCli_1631,enc(m1_1823,pkSess_1817),sign(m1_1823,skCli_1630)));
                                                                            {1663}event beginCli(Cli,Sess,gNc_1822);
                                                                            {1664}in(c, (ePartS_1824: bitstring,sigPartS_1825: bitstring));
                                                                            {1665}let PartS_1826: bitstring = dec(ePartS_1824,skCli_1630) in
                                                                            {1666}if (verify(PartS_1826,sigPartS_1825,pkSess_1817) <> true) then
                                                                                0
                                                                            else
                                                                                {1667}event endCli(Sess,Cli,PartS_1826)
                                                                    )
                                                                    else
                                                                        {1668}let pkSess_1827: bitstring = fail-any in
                                                                        {1669}out(c, GetEndpointRequest);
                                                                        {1670}in(c, (SPs_1828: bitstring,=SignAndEncrypt,UP_1829: bitstring,=pkSess_1827));
                                                                        {1671}new SPc_1830: bitstring;
                                                                        {1672}new Nc_1831: bitstring;
                                                                        {1673}let gNc_1832: bitstring = exp(g,Nc_1831) in
                                                                        {1674}let m1_1833: bitstring = (SPc_1830,gNc_1832) in
                                                                        {1675}out(c, (pkCli_1631,enc(m1_1833,pkSess_1827),sign(m1_1833,skCli_1630)));
                                                                        {1676}event beginCli(Cli,Sess,gNc_1832);
                                                                        {1677}in(c, (ePartS_1834: bitstring,sigPartS_1835: bitstring));
                                                                        {1678}let PartS_1836: bitstring = dec(ePartS_1834,skCli_1630) in
                                                                        {1679}if (verify(PartS_1836,sigPartS_1835,pkSess_1827) <> true) then
                                                                            0
                                                                        else
                                                                            {1680}event endCli(Sess,Cli,PartS_1836)
                                                            )
                                                            else
                                                                {1681}let pkSess_1837: bitstring = fail-any in
                                                                {1682}out(c, GetEndpointRequest);
                                                                {1683}in(c, (SPs_1838: bitstring,=SignAndEncrypt,UP_1839: bitstring,=pkSess_1837));
                                                                {1684}new SPc_1840: bitstring;
                                                                {1685}new Nc_1841: bitstring;
                                                                {1686}let gNc_1842: bitstring = exp(g,Nc_1841) in
                                                                {1687}let m1_1843: bitstring = (SPc_1840,gNc_1842) in
                                                                {1688}out(c, (pkCli_1631,enc(m1_1843,pkSess_1837),sign(m1_1843,skCli_1630)));
                                                                {1689}event beginCli(Cli,Sess,gNc_1842);
                                                                {1690}in(c, (ePartS_1844: bitstring,sigPartS_1845: bitstring));
                                                                {1691}let PartS_1846: bitstring = dec(ePartS_1844,skCli_1630) in
                                                                {1692}if (verify(PartS_1846,sigPartS_1845,pkSess_1837) <> true) then
                                                                    0
                                                                else
                                                                    {1693}event endCli(Sess,Cli,PartS_1846)
                                                    )
                                                    else
                                                        {1694}let pkSess_1847: bitstring = fail-any in
                                                        {1695}out(c, GetEndpointRequest);
                                                        {1696}in(c, (SPs_1848: bitstring,=SignAndEncrypt,UP_1849: bitstring,=pkSess_1847));
                                                        {1697}new SPc_1850: bitstring;
                                                        {1698}new Nc_1851: bitstring;
                                                        {1699}let gNc_1852: bitstring = exp(g,Nc_1851) in
                                                        {1700}let m1_1853: bitstring = (SPc_1850,gNc_1852) in
                                                        {1701}out(c, (pkCli_1631,enc(m1_1853,pkSess_1847),sign(m1_1853,skCli_1630)));
                                                        {1702}event beginCli(Cli,Sess,gNc_1852);
                                                        {1703}in(c, (ePartS_1854: bitstring,sigPartS_1855: bitstring));
                                                        {1704}let PartS_1856: bitstring = dec(ePartS_1854,skCli_1630) in
                                                        {1705}if (verify(PartS_1856,sigPartS_1855,pkSess_1847) <> true) then
                                                            0
                                                        else
                                                            {1706}event endCli(Sess,Cli,PartS_1856)
                                                )
                                                else
                                                    {1707}let pkDisco_1857: bitstring = pub(skI) in
                                                    {1708}let v_1858: bool = (Sess = A) in
                                                    (
                                                        {1709}if v_1858 then
                                                        (
                                                            {1710}let pkSess_1859: bitstring = pub(skA) in
                                                            {1711}out(c, GetEndpointRequest);
                                                            {1712}in(c, (SPs_1860: bitstring,=SignAndEncrypt,UP_1861: bitstring,=pkSess_1859));
                                                            {1713}new SPc_1862: bitstring;
                                                            {1714}new Nc_1863: bitstring;
                                                            {1715}let gNc_1864: bitstring = exp(g,Nc_1863) in
                                                            {1716}let m1_1865: bitstring = (SPc_1862,gNc_1864) in
                                                            {1717}out(c, (pkCli_1631,enc(m1_1865,pkSess_1859),sign(m1_1865,skCli_1630)));
                                                            {1718}event beginCli(Cli,Sess,gNc_1864);
                                                            {1719}in(c, (ePartS_1866: bitstring,sigPartS_1867: bitstring));
                                                            {1720}let PartS_1868: bitstring = dec(ePartS_1866,skCli_1630) in
                                                            {1721}if (verify(PartS_1868,sigPartS_1867,pkSess_1859) <> true) then
                                                                0
                                                            else
                                                                {1722}event endCli(Sess,Cli,PartS_1868)
                                                        )
                                                        else
                                                            {1723}let v_1869: bool = (Sess = B) in
                                                            (
                                                                {1724}if v_1869 then
                                                                (
                                                                    {1725}let pkSess_1870: bitstring = pub(skB) in
                                                                    {1726}out(c, GetEndpointRequest);
                                                                    {1727}in(c, (SPs_1871: bitstring,=SignAndEncrypt,UP_1872: bitstring,=pkSess_1870));
                                                                    {1728}new SPc_1873: bitstring;
                                                                    {1729}new Nc_1874: bitstring;
                                                                    {1730}let gNc_1875: bitstring = exp(g,Nc_1874) in
                                                                    {1731}let m1_1876: bitstring = (SPc_1873,gNc_1875) in
                                                                    {1732}out(c, (pkCli_1631,enc(m1_1876,pkSess_1870),sign(m1_1876,skCli_1630)));
                                                                    {1733}event beginCli(Cli,Sess,gNc_1875);
                                                                    {1734}in(c, (ePartS_1877: bitstring,sigPartS_1878: bitstring));
                                                                    {1735}let PartS_1879: bitstring = dec(ePartS_1877,skCli_1630) in
                                                                    {1736}if (verify(PartS_1879,sigPartS_1878,pkSess_1870) <> true) then
                                                                        0
                                                                    else
                                                                        {1737}event endCli(Sess,Cli,PartS_1879)
                                                                )
                                                                else
                                                                    {1738}let v_1880: bool = (Sess = C) in
                                                                    (
                                                                        {1739}if v_1880 then
                                                                        (
                                                                            {1740}let pkSess_1881: bitstring = pub(skC) in
                                                                            {1741}out(c, GetEndpointRequest);
                                                                            {1742}in(c, (SPs_1882: bitstring,=SignAndEncrypt,UP_1883: bitstring,=pkSess_1881));
                                                                            {1743}new SPc_1884: bitstring;
                                                                            {1744}new Nc_1885: bitstring;
                                                                            {1745}let gNc_1886: bitstring = exp(g,Nc_1885) in
                                                                            {1746}let m1_1887: bitstring = (SPc_1884,gNc_1886) in
                                                                            {1747}out(c, (pkCli_1631,enc(m1_1887,pkSess_1881),sign(m1_1887,skCli_1630)));
                                                                            {1748}event beginCli(Cli,Sess,gNc_1886);
                                                                            {1749}in(c, (ePartS_1888: bitstring,sigPartS_1889: bitstring));
                                                                            {1750}let PartS_1890: bitstring = dec(ePartS_1888,skCli_1630) in
                                                                            {1751}if (verify(PartS_1890,sigPartS_1889,pkSess_1881) <> true) then
                                                                                0
                                                                            else
                                                                                {1752}event endCli(Sess,Cli,PartS_1890)
                                                                        )
                                                                        else
                                                                            {1753}let pkSess_1891: bitstring = pub(skI) in
                                                                            {1754}out(c, GetEndpointRequest);
                                                                            {1755}in(c, (SPs_1892: bitstring,=SignAndEncrypt,UP_1893: bitstring,=pkSess_1891));
                                                                            {1756}new SPc_1894: bitstring;
                                                                            {1757}new Nc_1895: bitstring;
                                                                            {1758}let gNc_1896: bitstring = exp(g,Nc_1895) in
                                                                            {1759}let m1_1897: bitstring = (SPc_1894,gNc_1896) in
                                                                            {1760}out(c, (pkCli_1631,enc(m1_1897,pkSess_1891),sign(m1_1897,skCli_1630)));
                                                                            {1761}event beginCli(Cli,Sess,gNc_1896);
                                                                            {1762}in(c, (ePartS_1898: bitstring,sigPartS_1899: bitstring));
                                                                            {1763}let PartS_1900: bitstring = dec(ePartS_1898,skCli_1630) in
                                                                            {1764}if (verify(PartS_1900,sigPartS_1899,pkSess_1891) <> true) then
                                                                                0
                                                                            else
                                                                                {1765}event endCli(Sess,Cli,PartS_1900)
                                                                    )
                                                                    else
                                                                        {1766}let pkSess_1901: bitstring = fail-any in
                                                                        {1767}out(c, GetEndpointRequest);
                                                                        {1768}in(c, (SPs_1902: bitstring,=SignAndEncrypt,UP_1903: bitstring,=pkSess_1901));
                                                                        {1769}new SPc_1904: bitstring;
                                                                        {1770}new Nc_1905: bitstring;
                                                                        {1771}let gNc_1906: bitstring = exp(g,Nc_1905) in
                                                                        {1772}let m1_1907: bitstring = (SPc_1904,gNc_1906) in
                                                                        {1773}out(c, (pkCli_1631,enc(m1_1907,pkSess_1901),sign(m1_1907,skCli_1630)));
                                                                        {1774}event beginCli(Cli,Sess,gNc_1906);
                                                                        {1775}in(c, (ePartS_1908: bitstring,sigPartS_1909: bitstring));
                                                                        {1776}let PartS_1910: bitstring = dec(ePartS_1908,skCli_1630) in
                                                                        {1777}if (verify(PartS_1910,sigPartS_1909,pkSess_1901) <> true) then
                                                                            0
                                                                        else
                                                                            {1778}event endCli(Sess,Cli,PartS_1910)
                                                            )
                                                            else
                                                                {1779}let pkSess_1911: bitstring = fail-any in
                                                                {1780}out(c, GetEndpointRequest);
                                                                {1781}in(c, (SPs_1912: bitstring,=SignAndEncrypt,UP_1913: bitstring,=pkSess_1911));
                                                                {1782}new SPc_1914: bitstring;
                                                                {1783}new Nc_1915: bitstring;
                                                                {1784}let gNc_1916: bitstring = exp(g,Nc_1915) in
                                                                {1785}let m1_1917: bitstring = (SPc_1914,gNc_1916) in
                                                                {1786}out(c, (pkCli_1631,enc(m1_1917,pkSess_1911),sign(m1_1917,skCli_1630)));
                                                                {1787}event beginCli(Cli,Sess,gNc_1916);
                                                                {1788}in(c, (ePartS_1918: bitstring,sigPartS_1919: bitstring));
                                                                {1789}let PartS_1920: bitstring = dec(ePartS_1918,skCli_1630) in
                                                                {1790}if (verify(PartS_1920,sigPartS_1919,pkSess_1911) <> true) then
                                                                    0
                                                                else
                                                                    {1791}event endCli(Sess,Cli,PartS_1920)
                                                    )
                                                    else
                                                        {1792}let pkSess_1921: bitstring = fail-any in
                                                        {1793}out(c, GetEndpointRequest);
                                                        {1794}in(c, (SPs_1922: bitstring,=SignAndEncrypt,UP_1923: bitstring,=pkSess_1921));
                                                        {1795}new SPc_1924: bitstring;
                                                        {1796}new Nc_1925: bitstring;
                                                        {1797}let gNc_1926: bitstring = exp(g,Nc_1925) in
                                                        {1798}let m1_1927: bitstring = (SPc_1924,gNc_1926) in
                                                        {1799}out(c, (pkCli_1631,enc(m1_1927,pkSess_1921),sign(m1_1927,skCli_1630)));
                                                        {1800}event beginCli(Cli,Sess,gNc_1926);
                                                        {1801}in(c, (ePartS_1928: bitstring,sigPartS_1929: bitstring));
                                                        {1802}let PartS_1930: bitstring = dec(ePartS_1928,skCli_1630) in
                                                        {1803}if (verify(PartS_1930,sigPartS_1929,pkSess_1921) <> true) then
                                                            0
                                                        else
                                                            {1804}event endCli(Sess,Cli,PartS_1930)
                                            )
                                            else
                                                {1805}let pkDisco_1931: bitstring = fail-any in
                                                {1806}let v_1932: bool = (Sess = A) in
                                                (
                                                    {1807}if v_1932 then
                                                    (
                                                        {1808}let pkSess_1933: bitstring = pub(skA) in
                                                        {1809}out(c, GetEndpointRequest);
                                                        {1810}in(c, (SPs_1934: bitstring,=SignAndEncrypt,UP_1935: bitstring,=pkSess_1933));
                                                        {1811}new SPc_1936: bitstring;
                                                        {1812}new Nc_1937: bitstring;
                                                        {1813}let gNc_1938: bitstring = exp(g,Nc_1937) in
                                                        {1814}let m1_1939: bitstring = (SPc_1936,gNc_1938) in
                                                        {1815}out(c, (pkCli_1631,enc(m1_1939,pkSess_1933),sign(m1_1939,skCli_1630)));
                                                        {1816}event beginCli(Cli,Sess,gNc_1938);
                                                        {1817}in(c, (ePartS_1940: bitstring,sigPartS_1941: bitstring));
                                                        {1818}let PartS_1942: bitstring = dec(ePartS_1940,skCli_1630) in
                                                        {1819}if (verify(PartS_1942,sigPartS_1941,pkSess_1933) <> true) then
                                                            0
                                                        else
                                                            {1820}event endCli(Sess,Cli,PartS_1942)
                                                    )
                                                    else
                                                        {1821}let v_1943: bool = (Sess = B) in
                                                        (
                                                            {1822}if v_1943 then
                                                            (
                                                                {1823}let pkSess_1944: bitstring = pub(skB) in
                                                                {1824}out(c, GetEndpointRequest);
                                                                {1825}in(c, (SPs_1945: bitstring,=SignAndEncrypt,UP_1946: bitstring,=pkSess_1944));
                                                                {1826}new SPc_1947: bitstring;
                                                                {1827}new Nc_1948: bitstring;
                                                                {1828}let gNc_1949: bitstring = exp(g,Nc_1948) in
                                                                {1829}let m1_1950: bitstring = (SPc_1947,gNc_1949) in
                                                                {1830}out(c, (pkCli_1631,enc(m1_1950,pkSess_1944),sign(m1_1950,skCli_1630)));
                                                                {1831}event beginCli(Cli,Sess,gNc_1949);
                                                                {1832}in(c, (ePartS_1951: bitstring,sigPartS_1952: bitstring));
                                                                {1833}let PartS_1953: bitstring = dec(ePartS_1951,skCli_1630) in
                                                                {1834}if (verify(PartS_1953,sigPartS_1952,pkSess_1944) <> true) then
                                                                    0
                                                                else
                                                                    {1835}event endCli(Sess,Cli,PartS_1953)
                                                            )
                                                            else
                                                                {1836}let v_1954: bool = (Sess = C) in
                                                                (
                                                                    {1837}if v_1954 then
                                                                    (
                                                                        {1838}let pkSess_1955: bitstring = pub(skC) in
                                                                        {1839}out(c, GetEndpointRequest);
                                                                        {1840}in(c, (SPs_1956: bitstring,=SignAndEncrypt,UP_1957: bitstring,=pkSess_1955));
                                                                        {1841}new SPc_1958: bitstring;
                                                                        {1842}new Nc_1959: bitstring;
                                                                        {1843}let gNc_1960: bitstring = exp(g,Nc_1959) in
                                                                        {1844}let m1_1961: bitstring = (SPc_1958,gNc_1960) in
                                                                        {1845}out(c, (pkCli_1631,enc(m1_1961,pkSess_1955),sign(m1_1961,skCli_1630)));
                                                                        {1846}event beginCli(Cli,Sess,gNc_1960);
                                                                        {1847}in(c, (ePartS_1962: bitstring,sigPartS_1963: bitstring));
                                                                        {1848}let PartS_1964: bitstring = dec(ePartS_1962,skCli_1630) in
                                                                        {1849}if (verify(PartS_1964,sigPartS_1963,pkSess_1955) <> true) then
                                                                            0
                                                                        else
                                                                            {1850}event endCli(Sess,Cli,PartS_1964)
                                                                    )
                                                                    else
                                                                        {1851}let pkSess_1965: bitstring = pub(skI) in
                                                                        {1852}out(c, GetEndpointRequest);
                                                                        {1853}in(c, (SPs_1966: bitstring,=SignAndEncrypt,UP_1967: bitstring,=pkSess_1965));
                                                                        {1854}new SPc_1968: bitstring;
                                                                        {1855}new Nc_1969: bitstring;
                                                                        {1856}let gNc_1970: bitstring = exp(g,Nc_1969) in
                                                                        {1857}let m1_1971: bitstring = (SPc_1968,gNc_1970) in
                                                                        {1858}out(c, (pkCli_1631,enc(m1_1971,pkSess_1965),sign(m1_1971,skCli_1630)));
                                                                        {1859}event beginCli(Cli,Sess,gNc_1970);
                                                                        {1860}in(c, (ePartS_1972: bitstring,sigPartS_1973: bitstring));
                                                                        {1861}let PartS_1974: bitstring = dec(ePartS_1972,skCli_1630) in
                                                                        {1862}if (verify(PartS_1974,sigPartS_1973,pkSess_1965) <> true) then
                                                                            0
                                                                        else
                                                                            {1863}event endCli(Sess,Cli,PartS_1974)
                                                                )
                                                                else
                                                                    {1864}let pkSess_1975: bitstring = fail-any in
                                                                    {1865}out(c, GetEndpointRequest);
                                                                    {1866}in(c, (SPs_1976: bitstring,=SignAndEncrypt,UP_1977: bitstring,=pkSess_1975));
                                                                    {1867}new SPc_1978: bitstring;
                                                                    {1868}new Nc_1979: bitstring;
                                                                    {1869}let gNc_1980: bitstring = exp(g,Nc_1979) in
                                                                    {1870}let m1_1981: bitstring = (SPc_1978,gNc_1980) in
                                                                    {1871}out(c, (pkCli_1631,enc(m1_1981,pkSess_1975),sign(m1_1981,skCli_1630)));
                                                                    {1872}event beginCli(Cli,Sess,gNc_1980);
                                                                    {1873}in(c, (ePartS_1982: bitstring,sigPartS_1983: bitstring));
                                                                    {1874}let PartS_1984: bitstring = dec(ePartS_1982,skCli_1630) in
                                                                    {1875}if (verify(PartS_1984,sigPartS_1983,pkSess_1975) <> true) then
                                                                        0
                                                                    else
                                                                        {1876}event endCli(Sess,Cli,PartS_1984)
                                                        )
                                                        else
                                                            {1877}let pkSess_1985: bitstring = fail-any in
                                                            {1878}out(c, GetEndpointRequest);
                                                            {1879}in(c, (SPs_1986: bitstring,=SignAndEncrypt,UP_1987: bitstring,=pkSess_1985));
                                                            {1880}new SPc_1988: bitstring;
                                                            {1881}new Nc_1989: bitstring;
                                                            {1882}let gNc_1990: bitstring = exp(g,Nc_1989) in
                                                            {1883}let m1_1991: bitstring = (SPc_1988,gNc_1990) in
                                                            {1884}out(c, (pkCli_1631,enc(m1_1991,pkSess_1985),sign(m1_1991,skCli_1630)));
                                                            {1885}event beginCli(Cli,Sess,gNc_1990);
                                                            {1886}in(c, (ePartS_1992: bitstring,sigPartS_1993: bitstring));
                                                            {1887}let PartS_1994: bitstring = dec(ePartS_1992,skCli_1630) in
                                                            {1888}if (verify(PartS_1994,sigPartS_1993,pkSess_1985) <> true) then
                                                                0
                                                            else
                                                                {1889}event endCli(Sess,Cli,PartS_1994)
                                                )
                                                else
                                                    {1890}let pkSess_1995: bitstring = fail-any in
                                                    {1891}out(c, GetEndpointRequest);
                                                    {1892}in(c, (SPs_1996: bitstring,=SignAndEncrypt,UP_1997: bitstring,=pkSess_1995));
                                                    {1893}new SPc_1998: bitstring;
                                                    {1894}new Nc_1999: bitstring;
                                                    {1895}let gNc_2000: bitstring = exp(g,Nc_1999) in
                                                    {1896}let m1_2001: bitstring = (SPc_1998,gNc_2000) in
                                                    {1897}out(c, (pkCli_1631,enc(m1_2001,pkSess_1995),sign(m1_2001,skCli_1630)));
                                                    {1898}event beginCli(Cli,Sess,gNc_2000);
                                                    {1899}in(c, (ePartS_2002: bitstring,sigPartS_2003: bitstring));
                                                    {1900}let PartS_2004: bitstring = dec(ePartS_2002,skCli_1630) in
                                                    {1901}if (verify(PartS_2004,sigPartS_2003,pkSess_1995) <> true) then
                                                        0
                                                    else
                                                        {1902}event endCli(Sess,Cli,PartS_2004)
                                    )
                                    else
                                        {1903}let pkDisco_2005: bitstring = fail-any in
                                        {1904}let v_2006: bool = (Sess = A) in
                                        (
                                            {1905}if v_2006 then
                                            (
                                                {1906}let pkSess_2007: bitstring = pub(skA) in
                                                {1907}out(c, GetEndpointRequest);
                                                {1908}in(c, (SPs_2008: bitstring,=SignAndEncrypt,UP_2009: bitstring,=pkSess_2007));
                                                {1909}new SPc_2010: bitstring;
                                                {1910}new Nc_2011: bitstring;
                                                {1911}let gNc_2012: bitstring = exp(g,Nc_2011) in
                                                {1912}let m1_2013: bitstring = (SPc_2010,gNc_2012) in
                                                {1913}out(c, (pkCli_1631,enc(m1_2013,pkSess_2007),sign(m1_2013,skCli_1630)));
                                                {1914}event beginCli(Cli,Sess,gNc_2012);
                                                {1915}in(c, (ePartS_2014: bitstring,sigPartS_2015: bitstring));
                                                {1916}let PartS_2016: bitstring = dec(ePartS_2014,skCli_1630) in
                                                {1917}if (verify(PartS_2016,sigPartS_2015,pkSess_2007) <> true) then
                                                    0
                                                else
                                                    {1918}event endCli(Sess,Cli,PartS_2016)
                                            )
                                            else
                                                {1919}let v_2017: bool = (Sess = B) in
                                                (
                                                    {1920}if v_2017 then
                                                    (
                                                        {1921}let pkSess_2018: bitstring = pub(skB) in
                                                        {1922}out(c, GetEndpointRequest);
                                                        {1923}in(c, (SPs_2019: bitstring,=SignAndEncrypt,UP_2020: bitstring,=pkSess_2018));
                                                        {1924}new SPc_2021: bitstring;
                                                        {1925}new Nc_2022: bitstring;
                                                        {1926}let gNc_2023: bitstring = exp(g,Nc_2022) in
                                                        {1927}let m1_2024: bitstring = (SPc_2021,gNc_2023) in
                                                        {1928}out(c, (pkCli_1631,enc(m1_2024,pkSess_2018),sign(m1_2024,skCli_1630)));
                                                        {1929}event beginCli(Cli,Sess,gNc_2023);
                                                        {1930}in(c, (ePartS_2025: bitstring,sigPartS_2026: bitstring));
                                                        {1931}let PartS_2027: bitstring = dec(ePartS_2025,skCli_1630) in
                                                        {1932}if (verify(PartS_2027,sigPartS_2026,pkSess_2018) <> true) then
                                                            0
                                                        else
                                                            {1933}event endCli(Sess,Cli,PartS_2027)
                                                    )
                                                    else
                                                        {1934}let v_2028: bool = (Sess = C) in
                                                        (
                                                            {1935}if v_2028 then
                                                            (
                                                                {1936}let pkSess_2029: bitstring = pub(skC) in
                                                                {1937}out(c, GetEndpointRequest);
                                                                {1938}in(c, (SPs_2030: bitstring,=SignAndEncrypt,UP_2031: bitstring,=pkSess_2029));
                                                                {1939}new SPc_2032: bitstring;
                                                                {1940}new Nc_2033: bitstring;
                                                                {1941}let gNc_2034: bitstring = exp(g,Nc_2033) in
                                                                {1942}let m1_2035: bitstring = (SPc_2032,gNc_2034) in
                                                                {1943}out(c, (pkCli_1631,enc(m1_2035,pkSess_2029),sign(m1_2035,skCli_1630)));
                                                                {1944}event beginCli(Cli,Sess,gNc_2034);
                                                                {1945}in(c, (ePartS_2036: bitstring,sigPartS_2037: bitstring));
                                                                {1946}let PartS_2038: bitstring = dec(ePartS_2036,skCli_1630) in
                                                                {1947}if (verify(PartS_2038,sigPartS_2037,pkSess_2029) <> true) then
                                                                    0
                                                                else
                                                                    {1948}event endCli(Sess,Cli,PartS_2038)
                                                            )
                                                            else
                                                                {1949}let pkSess_2039: bitstring = pub(skI) in
                                                                {1950}out(c, GetEndpointRequest);
                                                                {1951}in(c, (SPs_2040: bitstring,=SignAndEncrypt,UP_2041: bitstring,=pkSess_2039));
                                                                {1952}new SPc_2042: bitstring;
                                                                {1953}new Nc_2043: bitstring;
                                                                {1954}let gNc_2044: bitstring = exp(g,Nc_2043) in
                                                                {1955}let m1_2045: bitstring = (SPc_2042,gNc_2044) in
                                                                {1956}out(c, (pkCli_1631,enc(m1_2045,pkSess_2039),sign(m1_2045,skCli_1630)));
                                                                {1957}event beginCli(Cli,Sess,gNc_2044);
                                                                {1958}in(c, (ePartS_2046: bitstring,sigPartS_2047: bitstring));
                                                                {1959}let PartS_2048: bitstring = dec(ePartS_2046,skCli_1630) in
                                                                {1960}if (verify(PartS_2048,sigPartS_2047,pkSess_2039) <> true) then
                                                                    0
                                                                else
                                                                    {1961}event endCli(Sess,Cli,PartS_2048)
                                                        )
                                                        else
                                                            {1962}let pkSess_2049: bitstring = fail-any in
                                                            {1963}out(c, GetEndpointRequest);
                                                            {1964}in(c, (SPs_2050: bitstring,=SignAndEncrypt,UP_2051: bitstring,=pkSess_2049));
                                                            {1965}new SPc_2052: bitstring;
                                                            {1966}new Nc_2053: bitstring;
                                                            {1967}let gNc_2054: bitstring = exp(g,Nc_2053) in
                                                            {1968}let m1_2055: bitstring = (SPc_2052,gNc_2054) in
                                                            {1969}out(c, (pkCli_1631,enc(m1_2055,pkSess_2049),sign(m1_2055,skCli_1630)));
                                                            {1970}event beginCli(Cli,Sess,gNc_2054);
                                                            {1971}in(c, (ePartS_2056: bitstring,sigPartS_2057: bitstring));
                                                            {1972}let PartS_2058: bitstring = dec(ePartS_2056,skCli_1630) in
                                                            {1973}if (verify(PartS_2058,sigPartS_2057,pkSess_2049) <> true) then
                                                                0
                                                            else
                                                                {1974}event endCli(Sess,Cli,PartS_2058)
                                                )
                                                else
                                                    {1975}let pkSess_2059: bitstring = fail-any in
                                                    {1976}out(c, GetEndpointRequest);
                                                    {1977}in(c, (SPs_2060: bitstring,=SignAndEncrypt,UP_2061: bitstring,=pkSess_2059));
                                                    {1978}new SPc_2062: bitstring;
                                                    {1979}new Nc_2063: bitstring;
                                                    {1980}let gNc_2064: bitstring = exp(g,Nc_2063) in
                                                    {1981}let m1_2065: bitstring = (SPc_2062,gNc_2064) in
                                                    {1982}out(c, (pkCli_1631,enc(m1_2065,pkSess_2059),sign(m1_2065,skCli_1630)));
                                                    {1983}event beginCli(Cli,Sess,gNc_2064);
                                                    {1984}in(c, (ePartS_2066: bitstring,sigPartS_2067: bitstring));
                                                    {1985}let PartS_2068: bitstring = dec(ePartS_2066,skCli_1630) in
                                                    {1986}if (verify(PartS_2068,sigPartS_2067,pkSess_2059) <> true) then
                                                        0
                                                    else
                                                        {1987}event endCli(Sess,Cli,PartS_2068)
                                        )
                                        else
                                            {1988}let pkSess_2069: bitstring = fail-any in
                                            {1989}out(c, GetEndpointRequest);
                                            {1990}in(c, (SPs_2070: bitstring,=SignAndEncrypt,UP_2071: bitstring,=pkSess_2069));
                                            {1991}new SPc_2072: bitstring;
                                            {1992}new Nc_2073: bitstring;
                                            {1993}let gNc_2074: bitstring = exp(g,Nc_2073) in
                                            {1994}let m1_2075: bitstring = (SPc_2072,gNc_2074) in
                                            {1995}out(c, (pkCli_1631,enc(m1_2075,pkSess_2069),sign(m1_2075,skCli_1630)));
                                            {1996}event beginCli(Cli,Sess,gNc_2074);
                                            {1997}in(c, (ePartS_2076: bitstring,sigPartS_2077: bitstring));
                                            {1998}let PartS_2078: bitstring = dec(ePartS_2076,skCli_1630) in
                                            {1999}if (verify(PartS_2078,sigPartS_2077,pkSess_2069) <> true) then
                                                0
                                            else
                                                {2000}event endCli(Sess,Cli,PartS_2078)
                            )
                            else
                                {2001}let pkDisco_2079: bitstring = fail-any in
                                {2002}let v_2080: bool = (Sess = A) in
                                (
                                    {2003}if v_2080 then
                                    (
                                        {2004}let pkSess_2081: bitstring = pub(skA) in
                                        {2005}out(c, GetEndpointRequest);
                                        {2006}in(c, (SPs_2082: bitstring,=SignAndEncrypt,UP_2083: bitstring,=pkSess_2081));
                                        {2007}new SPc_2084: bitstring;
                                        {2008}new Nc_2085: bitstring;
                                        {2009}let gNc_2086: bitstring = exp(g,Nc_2085) in
                                        {2010}let m1_2087: bitstring = (SPc_2084,gNc_2086) in
                                        {2011}out(c, (pkCli_1631,enc(m1_2087,pkSess_2081),sign(m1_2087,skCli_1630)));
                                        {2012}event beginCli(Cli,Sess,gNc_2086);
                                        {2013}in(c, (ePartS_2088: bitstring,sigPartS_2089: bitstring));
                                        {2014}let PartS_2090: bitstring = dec(ePartS_2088,skCli_1630) in
                                        {2015}if (verify(PartS_2090,sigPartS_2089,pkSess_2081) <> true) then
                                            0
                                        else
                                            {2016}event endCli(Sess,Cli,PartS_2090)
                                    )
                                    else
                                        {2017}let v_2091: bool = (Sess = B) in
                                        (
                                            {2018}if v_2091 then
                                            (
                                                {2019}let pkSess_2092: bitstring = pub(skB) in
                                                {2020}out(c, GetEndpointRequest);
                                                {2021}in(c, (SPs_2093: bitstring,=SignAndEncrypt,UP_2094: bitstring,=pkSess_2092));
                                                {2022}new SPc_2095: bitstring;
                                                {2023}new Nc_2096: bitstring;
                                                {2024}let gNc_2097: bitstring = exp(g,Nc_2096) in
                                                {2025}let m1_2098: bitstring = (SPc_2095,gNc_2097) in
                                                {2026}out(c, (pkCli_1631,enc(m1_2098,pkSess_2092),sign(m1_2098,skCli_1630)));
                                                {2027}event beginCli(Cli,Sess,gNc_2097);
                                                {2028}in(c, (ePartS_2099: bitstring,sigPartS_2100: bitstring));
                                                {2029}let PartS_2101: bitstring = dec(ePartS_2099,skCli_1630) in
                                                {2030}if (verify(PartS_2101,sigPartS_2100,pkSess_2092) <> true) then
                                                    0
                                                else
                                                    {2031}event endCli(Sess,Cli,PartS_2101)
                                            )
                                            else
                                                {2032}let v_2102: bool = (Sess = C) in
                                                (
                                                    {2033}if v_2102 then
                                                    (
                                                        {2034}let pkSess_2103: bitstring = pub(skC) in
                                                        {2035}out(c, GetEndpointRequest);
                                                        {2036}in(c, (SPs_2104: bitstring,=SignAndEncrypt,UP_2105: bitstring,=pkSess_2103));
                                                        {2037}new SPc_2106: bitstring;
                                                        {2038}new Nc_2107: bitstring;
                                                        {2039}let gNc_2108: bitstring = exp(g,Nc_2107) in
                                                        {2040}let m1_2109: bitstring = (SPc_2106,gNc_2108) in
                                                        {2041}out(c, (pkCli_1631,enc(m1_2109,pkSess_2103),sign(m1_2109,skCli_1630)));
                                                        {2042}event beginCli(Cli,Sess,gNc_2108);
                                                        {2043}in(c, (ePartS_2110: bitstring,sigPartS_2111: bitstring));
                                                        {2044}let PartS_2112: bitstring = dec(ePartS_2110,skCli_1630) in
                                                        {2045}if (verify(PartS_2112,sigPartS_2111,pkSess_2103) <> true) then
                                                            0
                                                        else
                                                            {2046}event endCli(Sess,Cli,PartS_2112)
                                                    )
                                                    else
                                                        {2047}let pkSess_2113: bitstring = pub(skI) in
                                                        {2048}out(c, GetEndpointRequest);
                                                        {2049}in(c, (SPs_2114: bitstring,=SignAndEncrypt,UP_2115: bitstring,=pkSess_2113));
                                                        {2050}new SPc_2116: bitstring;
                                                        {2051}new Nc_2117: bitstring;
                                                        {2052}let gNc_2118: bitstring = exp(g,Nc_2117) in
                                                        {2053}let m1_2119: bitstring = (SPc_2116,gNc_2118) in
                                                        {2054}out(c, (pkCli_1631,enc(m1_2119,pkSess_2113),sign(m1_2119,skCli_1630)));
                                                        {2055}event beginCli(Cli,Sess,gNc_2118);
                                                        {2056}in(c, (ePartS_2120: bitstring,sigPartS_2121: bitstring));
                                                        {2057}let PartS_2122: bitstring = dec(ePartS_2120,skCli_1630) in
                                                        {2058}if (verify(PartS_2122,sigPartS_2121,pkSess_2113) <> true) then
                                                            0
                                                        else
                                                            {2059}event endCli(Sess,Cli,PartS_2122)
                                                )
                                                else
                                                    {2060}let pkSess_2123: bitstring = fail-any in
                                                    {2061}out(c, GetEndpointRequest);
                                                    {2062}in(c, (SPs_2124: bitstring,=SignAndEncrypt,UP_2125: bitstring,=pkSess_2123));
                                                    {2063}new SPc_2126: bitstring;
                                                    {2064}new Nc_2127: bitstring;
                                                    {2065}let gNc_2128: bitstring = exp(g,Nc_2127) in
                                                    {2066}let m1_2129: bitstring = (SPc_2126,gNc_2128) in
                                                    {2067}out(c, (pkCli_1631,enc(m1_2129,pkSess_2123),sign(m1_2129,skCli_1630)));
                                                    {2068}event beginCli(Cli,Sess,gNc_2128);
                                                    {2069}in(c, (ePartS_2130: bitstring,sigPartS_2131: bitstring));
                                                    {2070}let PartS_2132: bitstring = dec(ePartS_2130,skCli_1630) in
                                                    {2071}if (verify(PartS_2132,sigPartS_2131,pkSess_2123) <> true) then
                                                        0
                                                    else
                                                        {2072}event endCli(Sess,Cli,PartS_2132)
                                        )
                                        else
                                            {2073}let pkSess_2133: bitstring = fail-any in
                                            {2074}out(c, GetEndpointRequest);
                                            {2075}in(c, (SPs_2134: bitstring,=SignAndEncrypt,UP_2135: bitstring,=pkSess_2133));
                                            {2076}new SPc_2136: bitstring;
                                            {2077}new Nc_2137: bitstring;
                                            {2078}let gNc_2138: bitstring = exp(g,Nc_2137) in
                                            {2079}let m1_2139: bitstring = (SPc_2136,gNc_2138) in
                                            {2080}out(c, (pkCli_1631,enc(m1_2139,pkSess_2133),sign(m1_2139,skCli_1630)));
                                            {2081}event beginCli(Cli,Sess,gNc_2138);
                                            {2082}in(c, (ePartS_2140: bitstring,sigPartS_2141: bitstring));
                                            {2083}let PartS_2142: bitstring = dec(ePartS_2140,skCli_1630) in
                                            {2084}if (verify(PartS_2142,sigPartS_2141,pkSess_2133) <> true) then
                                                0
                                            else
                                                {2085}event endCli(Sess,Cli,PartS_2142)
                                )
                                else
                                    {2086}let pkSess_2143: bitstring = fail-any in
                                    {2087}out(c, GetEndpointRequest);
                                    {2088}in(c, (SPs_2144: bitstring,=SignAndEncrypt,UP_2145: bitstring,=pkSess_2143));
                                    {2089}new SPc_2146: bitstring;
                                    {2090}new Nc_2147: bitstring;
                                    {2091}let gNc_2148: bitstring = exp(g,Nc_2147) in
                                    {2092}let m1_2149: bitstring = (SPc_2146,gNc_2148) in
                                    {2093}out(c, (pkCli_1631,enc(m1_2149,pkSess_2143),sign(m1_2149,skCli_1630)));
                                    {2094}event beginCli(Cli,Sess,gNc_2148);
                                    {2095}in(c, (ePartS_2150: bitstring,sigPartS_2151: bitstring));
                                    {2096}let PartS_2152: bitstring = dec(ePartS_2150,skCli_1630) in
                                    {2097}if (verify(PartS_2152,sigPartS_2151,pkSess_2143) <> true) then
                                        0
                                    else
                                        {2098}event endCli(Sess,Cli,PartS_2152)
                        )
                        else
                            {2099}let skCli_2153: bitstring = skI in
                            {2100}let pkCli_2154: bitstring = pub(skCli_2153) in
                            {2101}let v_2155: bool = (Disco = A) in
                            (
                                {2102}if v_2155 then
                                (
                                    {2103}let pkDisco_2156: bitstring = pub(skA) in
                                    {2104}let v_2157: bool = (Sess = A) in
                                    (
                                        {2105}if v_2157 then
                                        (
                                            {2106}let pkSess_2158: bitstring = pub(skA) in
                                            {2107}out(c, GetEndpointRequest);
                                            {2108}in(c, (SPs_2159: bitstring,=SignAndEncrypt,UP_2160: bitstring,=pkSess_2158));
                                            {2109}new SPc_2161: bitstring;
                                            {2110}new Nc_2162: bitstring;
                                            {2111}let gNc_2163: bitstring = exp(g,Nc_2162) in
                                            {2112}let m1_2164: bitstring = (SPc_2161,gNc_2163) in
                                            {2113}out(c, (pkCli_2154,enc(m1_2164,pkSess_2158),sign(m1_2164,skCli_2153)));
                                            {2114}event beginCli(Cli,Sess,gNc_2163);
                                            {2115}in(c, (ePartS_2165: bitstring,sigPartS_2166: bitstring));
                                            {2116}let PartS_2167: bitstring = dec(ePartS_2165,skCli_2153) in
                                            {2117}if (verify(PartS_2167,sigPartS_2166,pkSess_2158) <> true) then
                                                0
                                            else
                                                {2118}event endCli(Sess,Cli,PartS_2167)
                                        )
                                        else
                                            {2119}let v_2168: bool = (Sess = B) in
                                            (
                                                {2120}if v_2168 then
                                                (
                                                    {2121}let pkSess_2169: bitstring = pub(skB) in
                                                    {2122}out(c, GetEndpointRequest);
                                                    {2123}in(c, (SPs_2170: bitstring,=SignAndEncrypt,UP_2171: bitstring,=pkSess_2169));
                                                    {2124}new SPc_2172: bitstring;
                                                    {2125}new Nc_2173: bitstring;
                                                    {2126}let gNc_2174: bitstring = exp(g,Nc_2173) in
                                                    {2127}let m1_2175: bitstring = (SPc_2172,gNc_2174) in
                                                    {2128}out(c, (pkCli_2154,enc(m1_2175,pkSess_2169),sign(m1_2175,skCli_2153)));
                                                    {2129}event beginCli(Cli,Sess,gNc_2174);
                                                    {2130}in(c, (ePartS_2176: bitstring,sigPartS_2177: bitstring));
                                                    {2131}let PartS_2178: bitstring = dec(ePartS_2176,skCli_2153) in
                                                    {2132}if (verify(PartS_2178,sigPartS_2177,pkSess_2169) <> true) then
                                                        0
                                                    else
                                                        {2133}event endCli(Sess,Cli,PartS_2178)
                                                )
                                                else
                                                    {2134}let v_2179: bool = (Sess = C) in
                                                    (
                                                        {2135}if v_2179 then
                                                        (
                                                            {2136}let pkSess_2180: bitstring = pub(skC) in
                                                            {2137}out(c, GetEndpointRequest);
                                                            {2138}in(c, (SPs_2181: bitstring,=SignAndEncrypt,UP_2182: bitstring,=pkSess_2180));
                                                            {2139}new SPc_2183: bitstring;
                                                            {2140}new Nc_2184: bitstring;
                                                            {2141}let gNc_2185: bitstring = exp(g,Nc_2184) in
                                                            {2142}let m1_2186: bitstring = (SPc_2183,gNc_2185) in
                                                            {2143}out(c, (pkCli_2154,enc(m1_2186,pkSess_2180),sign(m1_2186,skCli_2153)));
                                                            {2144}event beginCli(Cli,Sess,gNc_2185);
                                                            {2145}in(c, (ePartS_2187: bitstring,sigPartS_2188: bitstring));
                                                            {2146}let PartS_2189: bitstring = dec(ePartS_2187,skCli_2153) in
                                                            {2147}if (verify(PartS_2189,sigPartS_2188,pkSess_2180) <> true) then
                                                                0
                                                            else
                                                                {2148}event endCli(Sess,Cli,PartS_2189)
                                                        )
                                                        else
                                                            {2149}let pkSess_2190: bitstring = pub(skI) in
                                                            {2150}out(c, GetEndpointRequest);
                                                            {2151}in(c, (SPs_2191: bitstring,=SignAndEncrypt,UP_2192: bitstring,=pkSess_2190));
                                                            {2152}new SPc_2193: bitstring;
                                                            {2153}new Nc_2194: bitstring;
                                                            {2154}let gNc_2195: bitstring = exp(g,Nc_2194) in
                                                            {2155}let m1_2196: bitstring = (SPc_2193,gNc_2195) in
                                                            {2156}out(c, (pkCli_2154,enc(m1_2196,pkSess_2190),sign(m1_2196,skCli_2153)));
                                                            {2157}event beginCli(Cli,Sess,gNc_2195);
                                                            {2158}in(c, (ePartS_2197: bitstring,sigPartS_2198: bitstring));
                                                            {2159}let PartS_2199: bitstring = dec(ePartS_2197,skCli_2153) in
                                                            {2160}if (verify(PartS_2199,sigPartS_2198,pkSess_2190) <> true) then
                                                                0
                                                            else
                                                                {2161}event endCli(Sess,Cli,PartS_2199)
                                                    )
                                                    else
                                                        {2162}let pkSess_2200: bitstring = fail-any in
                                                        {2163}out(c, GetEndpointRequest);
                                                        {2164}in(c, (SPs_2201: bitstring,=SignAndEncrypt,UP_2202: bitstring,=pkSess_2200));
                                                        {2165}new SPc_2203: bitstring;
                                                        {2166}new Nc_2204: bitstring;
                                                        {2167}let gNc_2205: bitstring = exp(g,Nc_2204) in
                                                        {2168}let m1_2206: bitstring = (SPc_2203,gNc_2205) in
                                                        {2169}out(c, (pkCli_2154,enc(m1_2206,pkSess_2200),sign(m1_2206,skCli_2153)));
                                                        {2170}event beginCli(Cli,Sess,gNc_2205);
                                                        {2171}in(c, (ePartS_2207: bitstring,sigPartS_2208: bitstring));
                                                        {2172}let PartS_2209: bitstring = dec(ePartS_2207,skCli_2153) in
                                                        {2173}if (verify(PartS_2209,sigPartS_2208,pkSess_2200) <> true) then
                                                            0
                                                        else
                                                            {2174}event endCli(Sess,Cli,PartS_2209)
                                            )
                                            else
                                                {2175}let pkSess_2210: bitstring = fail-any in
                                                {2176}out(c, GetEndpointRequest);
                                                {2177}in(c, (SPs_2211: bitstring,=SignAndEncrypt,UP_2212: bitstring,=pkSess_2210));
                                                {2178}new SPc_2213: bitstring;
                                                {2179}new Nc_2214: bitstring;
                                                {2180}let gNc_2215: bitstring = exp(g,Nc_2214) in
                                                {2181}let m1_2216: bitstring = (SPc_2213,gNc_2215) in
                                                {2182}out(c, (pkCli_2154,enc(m1_2216,pkSess_2210),sign(m1_2216,skCli_2153)));
                                                {2183}event beginCli(Cli,Sess,gNc_2215);
                                                {2184}in(c, (ePartS_2217: bitstring,sigPartS_2218: bitstring));
                                                {2185}let PartS_2219: bitstring = dec(ePartS_2217,skCli_2153) in
                                                {2186}if (verify(PartS_2219,sigPartS_2218,pkSess_2210) <> true) then
                                                    0
                                                else
                                                    {2187}event endCli(Sess,Cli,PartS_2219)
                                    )
                                    else
                                        {2188}let pkSess_2220: bitstring = fail-any in
                                        {2189}out(c, GetEndpointRequest);
                                        {2190}in(c, (SPs_2221: bitstring,=SignAndEncrypt,UP_2222: bitstring,=pkSess_2220));
                                        {2191}new SPc_2223: bitstring;
                                        {2192}new Nc_2224: bitstring;
                                        {2193}let gNc_2225: bitstring = exp(g,Nc_2224) in
                                        {2194}let m1_2226: bitstring = (SPc_2223,gNc_2225) in
                                        {2195}out(c, (pkCli_2154,enc(m1_2226,pkSess_2220),sign(m1_2226,skCli_2153)));
                                        {2196}event beginCli(Cli,Sess,gNc_2225);
                                        {2197}in(c, (ePartS_2227: bitstring,sigPartS_2228: bitstring));
                                        {2198}let PartS_2229: bitstring = dec(ePartS_2227,skCli_2153) in
                                        {2199}if (verify(PartS_2229,sigPartS_2228,pkSess_2220) <> true) then
                                            0
                                        else
                                            {2200}event endCli(Sess,Cli,PartS_2229)
                                )
                                else
                                    {2201}let v_2230: bool = (Disco = B) in
                                    (
                                        {2202}if v_2230 then
                                        (
                                            {2203}let pkDisco_2231: bitstring = pub(skB) in
                                            {2204}let v_2232: bool = (Sess = A) in
                                            (
                                                {2205}if v_2232 then
                                                (
                                                    {2206}let pkSess_2233: bitstring = pub(skA) in
                                                    {2207}out(c, GetEndpointRequest);
                                                    {2208}in(c, (SPs_2234: bitstring,=SignAndEncrypt,UP_2235: bitstring,=pkSess_2233));
                                                    {2209}new SPc_2236: bitstring;
                                                    {2210}new Nc_2237: bitstring;
                                                    {2211}let gNc_2238: bitstring = exp(g,Nc_2237) in
                                                    {2212}let m1_2239: bitstring = (SPc_2236,gNc_2238) in
                                                    {2213}out(c, (pkCli_2154,enc(m1_2239,pkSess_2233),sign(m1_2239,skCli_2153)));
                                                    {2214}event beginCli(Cli,Sess,gNc_2238);
                                                    {2215}in(c, (ePartS_2240: bitstring,sigPartS_2241: bitstring));
                                                    {2216}let PartS_2242: bitstring = dec(ePartS_2240,skCli_2153) in
                                                    {2217}if (verify(PartS_2242,sigPartS_2241,pkSess_2233) <> true) then
                                                        0
                                                    else
                                                        {2218}event endCli(Sess,Cli,PartS_2242)
                                                )
                                                else
                                                    {2219}let v_2243: bool = (Sess = B) in
                                                    (
                                                        {2220}if v_2243 then
                                                        (
                                                            {2221}let pkSess_2244: bitstring = pub(skB) in
                                                            {2222}out(c, GetEndpointRequest);
                                                            {2223}in(c, (SPs_2245: bitstring,=SignAndEncrypt,UP_2246: bitstring,=pkSess_2244));
                                                            {2224}new SPc_2247: bitstring;
                                                            {2225}new Nc_2248: bitstring;
                                                            {2226}let gNc_2249: bitstring = exp(g,Nc_2248) in
                                                            {2227}let m1_2250: bitstring = (SPc_2247,gNc_2249) in
                                                            {2228}out(c, (pkCli_2154,enc(m1_2250,pkSess_2244),sign(m1_2250,skCli_2153)));
                                                            {2229}event beginCli(Cli,Sess,gNc_2249);
                                                            {2230}in(c, (ePartS_2251: bitstring,sigPartS_2252: bitstring));
                                                            {2231}let PartS_2253: bitstring = dec(ePartS_2251,skCli_2153) in
                                                            {2232}if (verify(PartS_2253,sigPartS_2252,pkSess_2244) <> true) then
                                                                0
                                                            else
                                                                {2233}event endCli(Sess,Cli,PartS_2253)
                                                        )
                                                        else
                                                            {2234}let v_2254: bool = (Sess = C) in
                                                            (
                                                                {2235}if v_2254 then
                                                                (
                                                                    {2236}let pkSess_2255: bitstring = pub(skC) in
                                                                    {2237}out(c, GetEndpointRequest);
                                                                    {2238}in(c, (SPs_2256: bitstring,=SignAndEncrypt,UP_2257: bitstring,=pkSess_2255));
                                                                    {2239}new SPc_2258: bitstring;
                                                                    {2240}new Nc_2259: bitstring;
                                                                    {2241}let gNc_2260: bitstring = exp(g,Nc_2259) in
                                                                    {2242}let m1_2261: bitstring = (SPc_2258,gNc_2260) in
                                                                    {2243}out(c, (pkCli_2154,enc(m1_2261,pkSess_2255),sign(m1_2261,skCli_2153)));
                                                                    {2244}event beginCli(Cli,Sess,gNc_2260);
                                                                    {2245}in(c, (ePartS_2262: bitstring,sigPartS_2263: bitstring));
                                                                    {2246}let PartS_2264: bitstring = dec(ePartS_2262,skCli_2153) in
                                                                    {2247}if (verify(PartS_2264,sigPartS_2263,pkSess_2255) <> true) then
                                                                        0
                                                                    else
                                                                        {2248}event endCli(Sess,Cli,PartS_2264)
                                                                )
                                                                else
                                                                    {2249}let pkSess_2265: bitstring = pub(skI) in
                                                                    {2250}out(c, GetEndpointRequest);
                                                                    {2251}in(c, (SPs_2266: bitstring,=SignAndEncrypt,UP_2267: bitstring,=pkSess_2265));
                                                                    {2252}new SPc_2268: bitstring;
                                                                    {2253}new Nc_2269: bitstring;
                                                                    {2254}let gNc_2270: bitstring = exp(g,Nc_2269) in
                                                                    {2255}let m1_2271: bitstring = (SPc_2268,gNc_2270) in
                                                                    {2256}out(c, (pkCli_2154,enc(m1_2271,pkSess_2265),sign(m1_2271,skCli_2153)));
                                                                    {2257}event beginCli(Cli,Sess,gNc_2270);
                                                                    {2258}in(c, (ePartS_2272: bitstring,sigPartS_2273: bitstring));
                                                                    {2259}let PartS_2274: bitstring = dec(ePartS_2272,skCli_2153) in
                                                                    {2260}if (verify(PartS_2274,sigPartS_2273,pkSess_2265) <> true) then
                                                                        0
                                                                    else
                                                                        {2261}event endCli(Sess,Cli,PartS_2274)
                                                            )
                                                            else
                                                                {2262}let pkSess_2275: bitstring = fail-any in
                                                                {2263}out(c, GetEndpointRequest);
                                                                {2264}in(c, (SPs_2276: bitstring,=SignAndEncrypt,UP_2277: bitstring,=pkSess_2275));
                                                                {2265}new SPc_2278: bitstring;
                                                                {2266}new Nc_2279: bitstring;
                                                                {2267}let gNc_2280: bitstring = exp(g,Nc_2279) in
                                                                {2268}let m1_2281: bitstring = (SPc_2278,gNc_2280) in
                                                                {2269}out(c, (pkCli_2154,enc(m1_2281,pkSess_2275),sign(m1_2281,skCli_2153)));
                                                                {2270}event beginCli(Cli,Sess,gNc_2280);
                                                                {2271}in(c, (ePartS_2282: bitstring,sigPartS_2283: bitstring));
                                                                {2272}let PartS_2284: bitstring = dec(ePartS_2282,skCli_2153) in
                                                                {2273}if (verify(PartS_2284,sigPartS_2283,pkSess_2275) <> true) then
                                                                    0
                                                                else
                                                                    {2274}event endCli(Sess,Cli,PartS_2284)
                                                    )
                                                    else
                                                        {2275}let pkSess_2285: bitstring = fail-any in
                                                        {2276}out(c, GetEndpointRequest);
                                                        {2277}in(c, (SPs_2286: bitstring,=SignAndEncrypt,UP_2287: bitstring,=pkSess_2285));
                                                        {2278}new SPc_2288: bitstring;
                                                        {2279}new Nc_2289: bitstring;
                                                        {2280}let gNc_2290: bitstring = exp(g,Nc_2289) in
                                                        {2281}let m1_2291: bitstring = (SPc_2288,gNc_2290) in
                                                        {2282}out(c, (pkCli_2154,enc(m1_2291,pkSess_2285),sign(m1_2291,skCli_2153)));
                                                        {2283}event beginCli(Cli,Sess,gNc_2290);
                                                        {2284}in(c, (ePartS_2292: bitstring,sigPartS_2293: bitstring));
                                                        {2285}let PartS_2294: bitstring = dec(ePartS_2292,skCli_2153) in
                                                        {2286}if (verify(PartS_2294,sigPartS_2293,pkSess_2285) <> true) then
                                                            0
                                                        else
                                                            {2287}event endCli(Sess,Cli,PartS_2294)
                                            )
                                            else
                                                {2288}let pkSess_2295: bitstring = fail-any in
                                                {2289}out(c, GetEndpointRequest);
                                                {2290}in(c, (SPs_2296: bitstring,=SignAndEncrypt,UP_2297: bitstring,=pkSess_2295));
                                                {2291}new SPc_2298: bitstring;
                                                {2292}new Nc_2299: bitstring;
                                                {2293}let gNc_2300: bitstring = exp(g,Nc_2299) in
                                                {2294}let m1_2301: bitstring = (SPc_2298,gNc_2300) in
                                                {2295}out(c, (pkCli_2154,enc(m1_2301,pkSess_2295),sign(m1_2301,skCli_2153)));
                                                {2296}event beginCli(Cli,Sess,gNc_2300);
                                                {2297}in(c, (ePartS_2302: bitstring,sigPartS_2303: bitstring));
                                                {2298}let PartS_2304: bitstring = dec(ePartS_2302,skCli_2153) in
                                                {2299}if (verify(PartS_2304,sigPartS_2303,pkSess_2295) <> true) then
                                                    0
                                                else
                                                    {2300}event endCli(Sess,Cli,PartS_2304)
                                        )
                                        else
                                            {2301}let v_2305: bool = (Disco = C) in
                                            (
                                                {2302}if v_2305 then
                                                (
                                                    {2303}let pkDisco_2306: bitstring = pub(skC) in
                                                    {2304}let v_2307: bool = (Sess = A) in
                                                    (
                                                        {2305}if v_2307 then
                                                        (
                                                            {2306}let pkSess_2308: bitstring = pub(skA) in
                                                            {2307}out(c, GetEndpointRequest);
                                                            {2308}in(c, (SPs_2309: bitstring,=SignAndEncrypt,UP_2310: bitstring,=pkSess_2308));
                                                            {2309}new SPc_2311: bitstring;
                                                            {2310}new Nc_2312: bitstring;
                                                            {2311}let gNc_2313: bitstring = exp(g,Nc_2312) in
                                                            {2312}let m1_2314: bitstring = (SPc_2311,gNc_2313) in
                                                            {2313}out(c, (pkCli_2154,enc(m1_2314,pkSess_2308),sign(m1_2314,skCli_2153)));
                                                            {2314}event beginCli(Cli,Sess,gNc_2313);
                                                            {2315}in(c, (ePartS_2315: bitstring,sigPartS_2316: bitstring));
                                                            {2316}let PartS_2317: bitstring = dec(ePartS_2315,skCli_2153) in
                                                            {2317}if (verify(PartS_2317,sigPartS_2316,pkSess_2308) <> true) then
                                                                0
                                                            else
                                                                {2318}event endCli(Sess,Cli,PartS_2317)
                                                        )
                                                        else
                                                            {2319}let v_2318: bool = (Sess = B) in
                                                            (
                                                                {2320}if v_2318 then
                                                                (
                                                                    {2321}let pkSess_2319: bitstring = pub(skB) in
                                                                    {2322}out(c, GetEndpointRequest);
                                                                    {2323}in(c, (SPs_2320: bitstring,=SignAndEncrypt,UP_2321: bitstring,=pkSess_2319));
                                                                    {2324}new SPc_2322: bitstring;
                                                                    {2325}new Nc_2323: bitstring;
                                                                    {2326}let gNc_2324: bitstring = exp(g,Nc_2323) in
                                                                    {2327}let m1_2325: bitstring = (SPc_2322,gNc_2324) in
                                                                    {2328}out(c, (pkCli_2154,enc(m1_2325,pkSess_2319),sign(m1_2325,skCli_2153)));
                                                                    {2329}event beginCli(Cli,Sess,gNc_2324);
                                                                    {2330}in(c, (ePartS_2326: bitstring,sigPartS_2327: bitstring));
                                                                    {2331}let PartS_2328: bitstring = dec(ePartS_2326,skCli_2153) in
                                                                    {2332}if (verify(PartS_2328,sigPartS_2327,pkSess_2319) <> true) then
                                                                        0
                                                                    else
                                                                        {2333}event endCli(Sess,Cli,PartS_2328)
                                                                )
                                                                else
                                                                    {2334}let v_2329: bool = (Sess = C) in
                                                                    (
                                                                        {2335}if v_2329 then
                                                                        (
                                                                            {2336}let pkSess_2330: bitstring = pub(skC) in
                                                                            {2337}out(c, GetEndpointRequest);
                                                                            {2338}in(c, (SPs_2331: bitstring,=SignAndEncrypt,UP_2332: bitstring,=pkSess_2330));
                                                                            {2339}new SPc_2333: bitstring;
                                                                            {2340}new Nc_2334: bitstring;
                                                                            {2341}let gNc_2335: bitstring = exp(g,Nc_2334) in
                                                                            {2342}let m1_2336: bitstring = (SPc_2333,gNc_2335) in
                                                                            {2343}out(c, (pkCli_2154,enc(m1_2336,pkSess_2330),sign(m1_2336,skCli_2153)));
                                                                            {2344}event beginCli(Cli,Sess,gNc_2335);
                                                                            {2345}in(c, (ePartS_2337: bitstring,sigPartS_2338: bitstring));
                                                                            {2346}let PartS_2339: bitstring = dec(ePartS_2337,skCli_2153) in
                                                                            {2347}if (verify(PartS_2339,sigPartS_2338,pkSess_2330) <> true) then
                                                                                0
                                                                            else
                                                                                {2348}event endCli(Sess,Cli,PartS_2339)
                                                                        )
                                                                        else
                                                                            {2349}let pkSess_2340: bitstring = pub(skI) in
                                                                            {2350}out(c, GetEndpointRequest);
                                                                            {2351}in(c, (SPs_2341: bitstring,=SignAndEncrypt,UP_2342: bitstring,=pkSess_2340));
                                                                            {2352}new SPc_2343: bitstring;
                                                                            {2353}new Nc_2344: bitstring;
                                                                            {2354}let gNc_2345: bitstring = exp(g,Nc_2344) in
                                                                            {2355}let m1_2346: bitstring = (SPc_2343,gNc_2345) in
                                                                            {2356}out(c, (pkCli_2154,enc(m1_2346,pkSess_2340),sign(m1_2346,skCli_2153)));
                                                                            {2357}event beginCli(Cli,Sess,gNc_2345);
                                                                            {2358}in(c, (ePartS_2347: bitstring,sigPartS_2348: bitstring));
                                                                            {2359}let PartS_2349: bitstring = dec(ePartS_2347,skCli_2153) in
                                                                            {2360}if (verify(PartS_2349,sigPartS_2348,pkSess_2340) <> true) then
                                                                                0
                                                                            else
                                                                                {2361}event endCli(Sess,Cli,PartS_2349)
                                                                    )
                                                                    else
                                                                        {2362}let pkSess_2350: bitstring = fail-any in
                                                                        {2363}out(c, GetEndpointRequest);
                                                                        {2364}in(c, (SPs_2351: bitstring,=SignAndEncrypt,UP_2352: bitstring,=pkSess_2350));
                                                                        {2365}new SPc_2353: bitstring;
                                                                        {2366}new Nc_2354: bitstring;
                                                                        {2367}let gNc_2355: bitstring = exp(g,Nc_2354) in
                                                                        {2368}let m1_2356: bitstring = (SPc_2353,gNc_2355) in
                                                                        {2369}out(c, (pkCli_2154,enc(m1_2356,pkSess_2350),sign(m1_2356,skCli_2153)));
                                                                        {2370}event beginCli(Cli,Sess,gNc_2355);
                                                                        {2371}in(c, (ePartS_2357: bitstring,sigPartS_2358: bitstring));
                                                                        {2372}let PartS_2359: bitstring = dec(ePartS_2357,skCli_2153) in
                                                                        {2373}if (verify(PartS_2359,sigPartS_2358,pkSess_2350) <> true) then
                                                                            0
                                                                        else
                                                                            {2374}event endCli(Sess,Cli,PartS_2359)
                                                            )
                                                            else
                                                                {2375}let pkSess_2360: bitstring = fail-any in
                                                                {2376}out(c, GetEndpointRequest);
                                                                {2377}in(c, (SPs_2361: bitstring,=SignAndEncrypt,UP_2362: bitstring,=pkSess_2360));
                                                                {2378}new SPc_2363: bitstring;
                                                                {2379}new Nc_2364: bitstring;
                                                                {2380}let gNc_2365: bitstring = exp(g,Nc_2364) in
                                                                {2381}let m1_2366: bitstring = (SPc_2363,gNc_2365) in
                                                                {2382}out(c, (pkCli_2154,enc(m1_2366,pkSess_2360),sign(m1_2366,skCli_2153)));
                                                                {2383}event beginCli(Cli,Sess,gNc_2365);
                                                                {2384}in(c, (ePartS_2367: bitstring,sigPartS_2368: bitstring));
                                                                {2385}let PartS_2369: bitstring = dec(ePartS_2367,skCli_2153) in
                                                                {2386}if (verify(PartS_2369,sigPartS_2368,pkSess_2360) <> true) then
                                                                    0
                                                                else
                                                                    {2387}event endCli(Sess,Cli,PartS_2369)
                                                    )
                                                    else
                                                        {2388}let pkSess_2370: bitstring = fail-any in
                                                        {2389}out(c, GetEndpointRequest);
                                                        {2390}in(c, (SPs_2371: bitstring,=SignAndEncrypt,UP_2372: bitstring,=pkSess_2370));
                                                        {2391}new SPc_2373: bitstring;
                                                        {2392}new Nc_2374: bitstring;
                                                        {2393}let gNc_2375: bitstring = exp(g,Nc_2374) in
                                                        {2394}let m1_2376: bitstring = (SPc_2373,gNc_2375) in
                                                        {2395}out(c, (pkCli_2154,enc(m1_2376,pkSess_2370),sign(m1_2376,skCli_2153)));
                                                        {2396}event beginCli(Cli,Sess,gNc_2375);
                                                        {2397}in(c, (ePartS_2377: bitstring,sigPartS_2378: bitstring));
                                                        {2398}let PartS_2379: bitstring = dec(ePartS_2377,skCli_2153) in
                                                        {2399}if (verify(PartS_2379,sigPartS_2378,pkSess_2370) <> true) then
                                                            0
                                                        else
                                                            {2400}event endCli(Sess,Cli,PartS_2379)
                                                )
                                                else
                                                    {2401}let pkDisco_2380: bitstring = pub(skI) in
                                                    {2402}let v_2381: bool = (Sess = A) in
                                                    (
                                                        {2403}if v_2381 then
                                                        (
                                                            {2404}let pkSess_2382: bitstring = pub(skA) in
                                                            {2405}out(c, GetEndpointRequest);
                                                            {2406}in(c, (SPs_2383: bitstring,=SignAndEncrypt,UP_2384: bitstring,=pkSess_2382));
                                                            {2407}new SPc_2385: bitstring;
                                                            {2408}new Nc_2386: bitstring;
                                                            {2409}let gNc_2387: bitstring = exp(g,Nc_2386) in
                                                            {2410}let m1_2388: bitstring = (SPc_2385,gNc_2387) in
                                                            {2411}out(c, (pkCli_2154,enc(m1_2388,pkSess_2382),sign(m1_2388,skCli_2153)));
                                                            {2412}event beginCli(Cli,Sess,gNc_2387);
                                                            {2413}in(c, (ePartS_2389: bitstring,sigPartS_2390: bitstring));
                                                            {2414}let PartS_2391: bitstring = dec(ePartS_2389,skCli_2153) in
                                                            {2415}if (verify(PartS_2391,sigPartS_2390,pkSess_2382) <> true) then
                                                                0
                                                            else
                                                                {2416}event endCli(Sess,Cli,PartS_2391)
                                                        )
                                                        else
                                                            {2417}let v_2392: bool = (Sess = B) in
                                                            (
                                                                {2418}if v_2392 then
                                                                (
                                                                    {2419}let pkSess_2393: bitstring = pub(skB) in
                                                                    {2420}out(c, GetEndpointRequest);
                                                                    {2421}in(c, (SPs_2394: bitstring,=SignAndEncrypt,UP_2395: bitstring,=pkSess_2393));
                                                                    {2422}new SPc_2396: bitstring;
                                                                    {2423}new Nc_2397: bitstring;
                                                                    {2424}let gNc_2398: bitstring = exp(g,Nc_2397) in
                                                                    {2425}let m1_2399: bitstring = (SPc_2396,gNc_2398) in
                                                                    {2426}out(c, (pkCli_2154,enc(m1_2399,pkSess_2393),sign(m1_2399,skCli_2153)));
                                                                    {2427}event beginCli(Cli,Sess,gNc_2398);
                                                                    {2428}in(c, (ePartS_2400: bitstring,sigPartS_2401: bitstring));
                                                                    {2429}let PartS_2402: bitstring = dec(ePartS_2400,skCli_2153) in
                                                                    {2430}if (verify(PartS_2402,sigPartS_2401,pkSess_2393) <> true) then
                                                                        0
                                                                    else
                                                                        {2431}event endCli(Sess,Cli,PartS_2402)
                                                                )
                                                                else
                                                                    {2432}let v_2403: bool = (Sess = C) in
                                                                    (
                                                                        {2433}if v_2403 then
                                                                        (
                                                                            {2434}let pkSess_2404: bitstring = pub(skC) in
                                                                            {2435}out(c, GetEndpointRequest);
                                                                            {2436}in(c, (SPs_2405: bitstring,=SignAndEncrypt,UP_2406: bitstring,=pkSess_2404));
                                                                            {2437}new SPc_2407: bitstring;
                                                                            {2438}new Nc_2408: bitstring;
                                                                            {2439}let gNc_2409: bitstring = exp(g,Nc_2408) in
                                                                            {2440}let m1_2410: bitstring = (SPc_2407,gNc_2409) in
                                                                            {2441}out(c, (pkCli_2154,enc(m1_2410,pkSess_2404),sign(m1_2410,skCli_2153)));
                                                                            {2442}event beginCli(Cli,Sess,gNc_2409);
                                                                            {2443}in(c, (ePartS_2411: bitstring,sigPartS_2412: bitstring));
                                                                            {2444}let PartS_2413: bitstring = dec(ePartS_2411,skCli_2153) in
                                                                            {2445}if (verify(PartS_2413,sigPartS_2412,pkSess_2404) <> true) then
                                                                                0
                                                                            else
                                                                                {2446}event endCli(Sess,Cli,PartS_2413)
                                                                        )
                                                                        else
                                                                            {2447}let pkSess_2414: bitstring = pub(skI) in
                                                                            {2448}out(c, GetEndpointRequest);
                                                                            {2449}in(c, (SPs_2415: bitstring,=SignAndEncrypt,UP_2416: bitstring,=pkSess_2414));
                                                                            {2450}new SPc_2417: bitstring;
                                                                            {2451}new Nc_2418: bitstring;
                                                                            {2452}let gNc_2419: bitstring = exp(g,Nc_2418) in
                                                                            {2453}let m1_2420: bitstring = (SPc_2417,gNc_2419) in
                                                                            {2454}out(c, (pkCli_2154,enc(m1_2420,pkSess_2414),sign(m1_2420,skCli_2153)));
                                                                            {2455}event beginCli(Cli,Sess,gNc_2419);
                                                                            {2456}in(c, (ePartS_2421: bitstring,sigPartS_2422: bitstring));
                                                                            {2457}let PartS_2423: bitstring = dec(ePartS_2421,skCli_2153) in
                                                                            {2458}if (verify(PartS_2423,sigPartS_2422,pkSess_2414) <> true) then
                                                                                0
                                                                            else
                                                                                {2459}event endCli(Sess,Cli,PartS_2423)
                                                                    )
                                                                    else
                                                                        {2460}let pkSess_2424: bitstring = fail-any in
                                                                        {2461}out(c, GetEndpointRequest);
                                                                        {2462}in(c, (SPs_2425: bitstring,=SignAndEncrypt,UP_2426: bitstring,=pkSess_2424));
                                                                        {2463}new SPc_2427: bitstring;
                                                                        {2464}new Nc_2428: bitstring;
                                                                        {2465}let gNc_2429: bitstring = exp(g,Nc_2428) in
                                                                        {2466}let m1_2430: bitstring = (SPc_2427,gNc_2429) in
                                                                        {2467}out(c, (pkCli_2154,enc(m1_2430,pkSess_2424),sign(m1_2430,skCli_2153)));
                                                                        {2468}event beginCli(Cli,Sess,gNc_2429);
                                                                        {2469}in(c, (ePartS_2431: bitstring,sigPartS_2432: bitstring));
                                                                        {2470}let PartS_2433: bitstring = dec(ePartS_2431,skCli_2153) in
                                                                        {2471}if (verify(PartS_2433,sigPartS_2432,pkSess_2424) <> true) then
                                                                            0
                                                                        else
                                                                            {2472}event endCli(Sess,Cli,PartS_2433)
                                                            )
                                                            else
                                                                {2473}let pkSess_2434: bitstring = fail-any in
                                                                {2474}out(c, GetEndpointRequest);
                                                                {2475}in(c, (SPs_2435: bitstring,=SignAndEncrypt,UP_2436: bitstring,=pkSess_2434));
                                                                {2476}new SPc_2437: bitstring;
                                                                {2477}new Nc_2438: bitstring;
                                                                {2478}let gNc_2439: bitstring = exp(g,Nc_2438) in
                                                                {2479}let m1_2440: bitstring = (SPc_2437,gNc_2439) in
                                                                {2480}out(c, (pkCli_2154,enc(m1_2440,pkSess_2434),sign(m1_2440,skCli_2153)));
                                                                {2481}event beginCli(Cli,Sess,gNc_2439);
                                                                {2482}in(c, (ePartS_2441: bitstring,sigPartS_2442: bitstring));
                                                                {2483}let PartS_2443: bitstring = dec(ePartS_2441,skCli_2153) in
                                                                {2484}if (verify(PartS_2443,sigPartS_2442,pkSess_2434) <> true) then
                                                                    0
                                                                else
                                                                    {2485}event endCli(Sess,Cli,PartS_2443)
                                                    )
                                                    else
                                                        {2486}let pkSess_2444: bitstring = fail-any in
                                                        {2487}out(c, GetEndpointRequest);
                                                        {2488}in(c, (SPs_2445: bitstring,=SignAndEncrypt,UP_2446: bitstring,=pkSess_2444));
                                                        {2489}new SPc_2447: bitstring;
                                                        {2490}new Nc_2448: bitstring;
                                                        {2491}let gNc_2449: bitstring = exp(g,Nc_2448) in
                                                        {2492}let m1_2450: bitstring = (SPc_2447,gNc_2449) in
                                                        {2493}out(c, (pkCli_2154,enc(m1_2450,pkSess_2444),sign(m1_2450,skCli_2153)));
                                                        {2494}event beginCli(Cli,Sess,gNc_2449);
                                                        {2495}in(c, (ePartS_2451: bitstring,sigPartS_2452: bitstring));
                                                        {2496}let PartS_2453: bitstring = dec(ePartS_2451,skCli_2153) in
                                                        {2497}if (verify(PartS_2453,sigPartS_2452,pkSess_2444) <> true) then
                                                            0
                                                        else
                                                            {2498}event endCli(Sess,Cli,PartS_2453)
                                            )
                                            else
                                                {2499}let pkDisco_2454: bitstring = fail-any in
                                                {2500}let v_2455: bool = (Sess = A) in
                                                (
                                                    {2501}if v_2455 then
                                                    (
                                                        {2502}let pkSess_2456: bitstring = pub(skA) in
                                                        {2503}out(c, GetEndpointRequest);
                                                        {2504}in(c, (SPs_2457: bitstring,=SignAndEncrypt,UP_2458: bitstring,=pkSess_2456));
                                                        {2505}new SPc_2459: bitstring;
                                                        {2506}new Nc_2460: bitstring;
                                                        {2507}let gNc_2461: bitstring = exp(g,Nc_2460) in
                                                        {2508}let m1_2462: bitstring = (SPc_2459,gNc_2461) in
                                                        {2509}out(c, (pkCli_2154,enc(m1_2462,pkSess_2456),sign(m1_2462,skCli_2153)));
                                                        {2510}event beginCli(Cli,Sess,gNc_2461);
                                                        {2511}in(c, (ePartS_2463: bitstring,sigPartS_2464: bitstring));
                                                        {2512}let PartS_2465: bitstring = dec(ePartS_2463,skCli_2153) in
                                                        {2513}if (verify(PartS_2465,sigPartS_2464,pkSess_2456) <> true) then
                                                            0
                                                        else
                                                            {2514}event endCli(Sess,Cli,PartS_2465)
                                                    )
                                                    else
                                                        {2515}let v_2466: bool = (Sess = B) in
                                                        (
                                                            {2516}if v_2466 then
                                                            (
                                                                {2517}let pkSess_2467: bitstring = pub(skB) in
                                                                {2518}out(c, GetEndpointRequest);
                                                                {2519}in(c, (SPs_2468: bitstring,=SignAndEncrypt,UP_2469: bitstring,=pkSess_2467));
                                                                {2520}new SPc_2470: bitstring;
                                                                {2521}new Nc_2471: bitstring;
                                                                {2522}let gNc_2472: bitstring = exp(g,Nc_2471) in
                                                                {2523}let m1_2473: bitstring = (SPc_2470,gNc_2472) in
                                                                {2524}out(c, (pkCli_2154,enc(m1_2473,pkSess_2467),sign(m1_2473,skCli_2153)));
                                                                {2525}event beginCli(Cli,Sess,gNc_2472);
                                                                {2526}in(c, (ePartS_2474: bitstring,sigPartS_2475: bitstring));
                                                                {2527}let PartS_2476: bitstring = dec(ePartS_2474,skCli_2153) in
                                                                {2528}if (verify(PartS_2476,sigPartS_2475,pkSess_2467) <> true) then
                                                                    0
                                                                else
                                                                    {2529}event endCli(Sess,Cli,PartS_2476)
                                                            )
                                                            else
                                                                {2530}let v_2477: bool = (Sess = C) in
                                                                (
                                                                    {2531}if v_2477 then
                                                                    (
                                                                        {2532}let pkSess_2478: bitstring = pub(skC) in
                                                                        {2533}out(c, GetEndpointRequest);
                                                                        {2534}in(c, (SPs_2479: bitstring,=SignAndEncrypt,UP_2480: bitstring,=pkSess_2478));
                                                                        {2535}new SPc_2481: bitstring;
                                                                        {2536}new Nc_2482: bitstring;
                                                                        {2537}let gNc_2483: bitstring = exp(g,Nc_2482) in
                                                                        {2538}let m1_2484: bitstring = (SPc_2481,gNc_2483) in
                                                                        {2539}out(c, (pkCli_2154,enc(m1_2484,pkSess_2478),sign(m1_2484,skCli_2153)));
                                                                        {2540}event beginCli(Cli,Sess,gNc_2483);
                                                                        {2541}in(c, (ePartS_2485: bitstring,sigPartS_2486: bitstring));
                                                                        {2542}let PartS_2487: bitstring = dec(ePartS_2485,skCli_2153) in
                                                                        {2543}if (verify(PartS_2487,sigPartS_2486,pkSess_2478) <> true) then
                                                                            0
                                                                        else
                                                                            {2544}event endCli(Sess,Cli,PartS_2487)
                                                                    )
                                                                    else
                                                                        {2545}let pkSess_2488: bitstring = pub(skI) in
                                                                        {2546}out(c, GetEndpointRequest);
                                                                        {2547}in(c, (SPs_2489: bitstring,=SignAndEncrypt,UP_2490: bitstring,=pkSess_2488));
                                                                        {2548}new SPc_2491: bitstring;
                                                                        {2549}new Nc_2492: bitstring;
                                                                        {2550}let gNc_2493: bitstring = exp(g,Nc_2492) in
                                                                        {2551}let m1_2494: bitstring = (SPc_2491,gNc_2493) in
                                                                        {2552}out(c, (pkCli_2154,enc(m1_2494,pkSess_2488),sign(m1_2494,skCli_2153)));
                                                                        {2553}event beginCli(Cli,Sess,gNc_2493);
                                                                        {2554}in(c, (ePartS_2495: bitstring,sigPartS_2496: bitstring));
                                                                        {2555}let PartS_2497: bitstring = dec(ePartS_2495,skCli_2153) in
                                                                        {2556}if (verify(PartS_2497,sigPartS_2496,pkSess_2488) <> true) then
                                                                            0
                                                                        else
                                                                            {2557}event endCli(Sess,Cli,PartS_2497)
                                                                )
                                                                else
                                                                    {2558}let pkSess_2498: bitstring = fail-any in
                                                                    {2559}out(c, GetEndpointRequest);
                                                                    {2560}in(c, (SPs_2499: bitstring,=SignAndEncrypt,UP_2500: bitstring,=pkSess_2498));
                                                                    {2561}new SPc_2501: bitstring;
                                                                    {2562}new Nc_2502: bitstring;
                                                                    {2563}let gNc_2503: bitstring = exp(g,Nc_2502) in
                                                                    {2564}let m1_2504: bitstring = (SPc_2501,gNc_2503) in
                                                                    {2565}out(c, (pkCli_2154,enc(m1_2504,pkSess_2498),sign(m1_2504,skCli_2153)));
                                                                    {2566}event beginCli(Cli,Sess,gNc_2503);
                                                                    {2567}in(c, (ePartS_2505: bitstring,sigPartS_2506: bitstring));
                                                                    {2568}let PartS_2507: bitstring = dec(ePartS_2505,skCli_2153) in
                                                                    {2569}if (verify(PartS_2507,sigPartS_2506,pkSess_2498) <> true) then
                                                                        0
                                                                    else
                                                                        {2570}event endCli(Sess,Cli,PartS_2507)
                                                        )
                                                        else
                                                            {2571}let pkSess_2508: bitstring = fail-any in
                                                            {2572}out(c, GetEndpointRequest);
                                                            {2573}in(c, (SPs_2509: bitstring,=SignAndEncrypt,UP_2510: bitstring,=pkSess_2508));
                                                            {2574}new SPc_2511: bitstring;
                                                            {2575}new Nc_2512: bitstring;
                                                            {2576}let gNc_2513: bitstring = exp(g,Nc_2512) in
                                                            {2577}let m1_2514: bitstring = (SPc_2511,gNc_2513) in
                                                            {2578}out(c, (pkCli_2154,enc(m1_2514,pkSess_2508),sign(m1_2514,skCli_2153)));
                                                            {2579}event beginCli(Cli,Sess,gNc_2513);
                                                            {2580}in(c, (ePartS_2515: bitstring,sigPartS_2516: bitstring));
                                                            {2581}let PartS_2517: bitstring = dec(ePartS_2515,skCli_2153) in
                                                            {2582}if (verify(PartS_2517,sigPartS_2516,pkSess_2508) <> true) then
                                                                0
                                                            else
                                                                {2583}event endCli(Sess,Cli,PartS_2517)
                                                )
                                                else
                                                    {2584}let pkSess_2518: bitstring = fail-any in
                                                    {2585}out(c, GetEndpointRequest);
                                                    {2586}in(c, (SPs_2519: bitstring,=SignAndEncrypt,UP_2520: bitstring,=pkSess_2518));
                                                    {2587}new SPc_2521: bitstring;
                                                    {2588}new Nc_2522: bitstring;
                                                    {2589}let gNc_2523: bitstring = exp(g,Nc_2522) in
                                                    {2590}let m1_2524: bitstring = (SPc_2521,gNc_2523) in
                                                    {2591}out(c, (pkCli_2154,enc(m1_2524,pkSess_2518),sign(m1_2524,skCli_2153)));
                                                    {2592}event beginCli(Cli,Sess,gNc_2523);
                                                    {2593}in(c, (ePartS_2525: bitstring,sigPartS_2526: bitstring));
                                                    {2594}let PartS_2527: bitstring = dec(ePartS_2525,skCli_2153) in
                                                    {2595}if (verify(PartS_2527,sigPartS_2526,pkSess_2518) <> true) then
                                                        0
                                                    else
                                                        {2596}event endCli(Sess,Cli,PartS_2527)
                                    )
                                    else
                                        {2597}let pkDisco_2528: bitstring = fail-any in
                                        {2598}let v_2529: bool = (Sess = A) in
                                        (
                                            {2599}if v_2529 then
                                            (
                                                {2600}let pkSess_2530: bitstring = pub(skA) in
                                                {2601}out(c, GetEndpointRequest);
                                                {2602}in(c, (SPs_2531: bitstring,=SignAndEncrypt,UP_2532: bitstring,=pkSess_2530));
                                                {2603}new SPc_2533: bitstring;
                                                {2604}new Nc_2534: bitstring;
                                                {2605}let gNc_2535: bitstring = exp(g,Nc_2534) in
                                                {2606}let m1_2536: bitstring = (SPc_2533,gNc_2535) in
                                                {2607}out(c, (pkCli_2154,enc(m1_2536,pkSess_2530),sign(m1_2536,skCli_2153)));
                                                {2608}event beginCli(Cli,Sess,gNc_2535);
                                                {2609}in(c, (ePartS_2537: bitstring,sigPartS_2538: bitstring));
                                                {2610}let PartS_2539: bitstring = dec(ePartS_2537,skCli_2153) in
                                                {2611}if (verify(PartS_2539,sigPartS_2538,pkSess_2530) <> true) then
                                                    0
                                                else
                                                    {2612}event endCli(Sess,Cli,PartS_2539)
                                            )
                                            else
                                                {2613}let v_2540: bool = (Sess = B) in
                                                (
                                                    {2614}if v_2540 then
                                                    (
                                                        {2615}let pkSess_2541: bitstring = pub(skB) in
                                                        {2616}out(c, GetEndpointRequest);
                                                        {2617}in(c, (SPs_2542: bitstring,=SignAndEncrypt,UP_2543: bitstring,=pkSess_2541));
                                                        {2618}new SPc_2544: bitstring;
                                                        {2619}new Nc_2545: bitstring;
                                                        {2620}let gNc_2546: bitstring = exp(g,Nc_2545) in
                                                        {2621}let m1_2547: bitstring = (SPc_2544,gNc_2546) in
                                                        {2622}out(c, (pkCli_2154,enc(m1_2547,pkSess_2541),sign(m1_2547,skCli_2153)));
                                                        {2623}event beginCli(Cli,Sess,gNc_2546);
                                                        {2624}in(c, (ePartS_2548: bitstring,sigPartS_2549: bitstring));
                                                        {2625}let PartS_2550: bitstring = dec(ePartS_2548,skCli_2153) in
                                                        {2626}if (verify(PartS_2550,sigPartS_2549,pkSess_2541) <> true) then
                                                            0
                                                        else
                                                            {2627}event endCli(Sess,Cli,PartS_2550)
                                                    )
                                                    else
                                                        {2628}let v_2551: bool = (Sess = C) in
                                                        (
                                                            {2629}if v_2551 then
                                                            (
                                                                {2630}let pkSess_2552: bitstring = pub(skC) in
                                                                {2631}out(c, GetEndpointRequest);
                                                                {2632}in(c, (SPs_2553: bitstring,=SignAndEncrypt,UP_2554: bitstring,=pkSess_2552));
                                                                {2633}new SPc_2555: bitstring;
                                                                {2634}new Nc_2556: bitstring;
                                                                {2635}let gNc_2557: bitstring = exp(g,Nc_2556) in
                                                                {2636}let m1_2558: bitstring = (SPc_2555,gNc_2557) in
                                                                {2637}out(c, (pkCli_2154,enc(m1_2558,pkSess_2552),sign(m1_2558,skCli_2153)));
                                                                {2638}event beginCli(Cli,Sess,gNc_2557);
                                                                {2639}in(c, (ePartS_2559: bitstring,sigPartS_2560: bitstring));
                                                                {2640}let PartS_2561: bitstring = dec(ePartS_2559,skCli_2153) in
                                                                {2641}if (verify(PartS_2561,sigPartS_2560,pkSess_2552) <> true) then
                                                                    0
                                                                else
                                                                    {2642}event endCli(Sess,Cli,PartS_2561)
                                                            )
                                                            else
                                                                {2643}let pkSess_2562: bitstring = pub(skI) in
                                                                {2644}out(c, GetEndpointRequest);
                                                                {2645}in(c, (SPs_2563: bitstring,=SignAndEncrypt,UP_2564: bitstring,=pkSess_2562));
                                                                {2646}new SPc_2565: bitstring;
                                                                {2647}new Nc_2566: bitstring;
                                                                {2648}let gNc_2567: bitstring = exp(g,Nc_2566) in
                                                                {2649}let m1_2568: bitstring = (SPc_2565,gNc_2567) in
                                                                {2650}out(c, (pkCli_2154,enc(m1_2568,pkSess_2562),sign(m1_2568,skCli_2153)));
                                                                {2651}event beginCli(Cli,Sess,gNc_2567);
                                                                {2652}in(c, (ePartS_2569: bitstring,sigPartS_2570: bitstring));
                                                                {2653}let PartS_2571: bitstring = dec(ePartS_2569,skCli_2153) in
                                                                {2654}if (verify(PartS_2571,sigPartS_2570,pkSess_2562) <> true) then
                                                                    0
                                                                else
                                                                    {2655}event endCli(Sess,Cli,PartS_2571)
                                                        )
                                                        else
                                                            {2656}let pkSess_2572: bitstring = fail-any in
                                                            {2657}out(c, GetEndpointRequest);
                                                            {2658}in(c, (SPs_2573: bitstring,=SignAndEncrypt,UP_2574: bitstring,=pkSess_2572));
                                                            {2659}new SPc_2575: bitstring;
                                                            {2660}new Nc_2576: bitstring;
                                                            {2661}let gNc_2577: bitstring = exp(g,Nc_2576) in
                                                            {2662}let m1_2578: bitstring = (SPc_2575,gNc_2577) in
                                                            {2663}out(c, (pkCli_2154,enc(m1_2578,pkSess_2572),sign(m1_2578,skCli_2153)));
                                                            {2664}event beginCli(Cli,Sess,gNc_2577);
                                                            {2665}in(c, (ePartS_2579: bitstring,sigPartS_2580: bitstring));
                                                            {2666}let PartS_2581: bitstring = dec(ePartS_2579,skCli_2153) in
                                                            {2667}if (verify(PartS_2581,sigPartS_2580,pkSess_2572) <> true) then
                                                                0
                                                            else
                                                                {2668}event endCli(Sess,Cli,PartS_2581)
                                                )
                                                else
                                                    {2669}let pkSess_2582: bitstring = fail-any in
                                                    {2670}out(c, GetEndpointRequest);
                                                    {2671}in(c, (SPs_2583: bitstring,=SignAndEncrypt,UP_2584: bitstring,=pkSess_2582));
                                                    {2672}new SPc_2585: bitstring;
                                                    {2673}new Nc_2586: bitstring;
                                                    {2674}let gNc_2587: bitstring = exp(g,Nc_2586) in
                                                    {2675}let m1_2588: bitstring = (SPc_2585,gNc_2587) in
                                                    {2676}out(c, (pkCli_2154,enc(m1_2588,pkSess_2582),sign(m1_2588,skCli_2153)));
                                                    {2677}event beginCli(Cli,Sess,gNc_2587);
                                                    {2678}in(c, (ePartS_2589: bitstring,sigPartS_2590: bitstring));
                                                    {2679}let PartS_2591: bitstring = dec(ePartS_2589,skCli_2153) in
                                                    {2680}if (verify(PartS_2591,sigPartS_2590,pkSess_2582) <> true) then
                                                        0
                                                    else
                                                        {2681}event endCli(Sess,Cli,PartS_2591)
                                        )
                                        else
                                            {2682}let pkSess_2592: bitstring = fail-any in
                                            {2683}out(c, GetEndpointRequest);
                                            {2684}in(c, (SPs_2593: bitstring,=SignAndEncrypt,UP_2594: bitstring,=pkSess_2592));
                                            {2685}new SPc_2595: bitstring;
                                            {2686}new Nc_2596: bitstring;
                                            {2687}let gNc_2597: bitstring = exp(g,Nc_2596) in
                                            {2688}let m1_2598: bitstring = (SPc_2595,gNc_2597) in
                                            {2689}out(c, (pkCli_2154,enc(m1_2598,pkSess_2592),sign(m1_2598,skCli_2153)));
                                            {2690}event beginCli(Cli,Sess,gNc_2597);
                                            {2691}in(c, (ePartS_2599: bitstring,sigPartS_2600: bitstring));
                                            {2692}let PartS_2601: bitstring = dec(ePartS_2599,skCli_2153) in
                                            {2693}if (verify(PartS_2601,sigPartS_2600,pkSess_2592) <> true) then
                                                0
                                            else
                                                {2694}event endCli(Sess,Cli,PartS_2601)
                            )
                            else
                                {2695}let pkDisco_2602: bitstring = fail-any in
                                {2696}let v_2603: bool = (Sess = A) in
                                (
                                    {2697}if v_2603 then
                                    (
                                        {2698}let pkSess_2604: bitstring = pub(skA) in
                                        {2699}out(c, GetEndpointRequest);
                                        {2700}in(c, (SPs_2605: bitstring,=SignAndEncrypt,UP_2606: bitstring,=pkSess_2604));
                                        {2701}new SPc_2607: bitstring;
                                        {2702}new Nc_2608: bitstring;
                                        {2703}let gNc_2609: bitstring = exp(g,Nc_2608) in
                                        {2704}let m1_2610: bitstring = (SPc_2607,gNc_2609) in
                                        {2705}out(c, (pkCli_2154,enc(m1_2610,pkSess_2604),sign(m1_2610,skCli_2153)));
                                        {2706}event beginCli(Cli,Sess,gNc_2609);
                                        {2707}in(c, (ePartS_2611: bitstring,sigPartS_2612: bitstring));
                                        {2708}let PartS_2613: bitstring = dec(ePartS_2611,skCli_2153) in
                                        {2709}if (verify(PartS_2613,sigPartS_2612,pkSess_2604) <> true) then
                                            0
                                        else
                                            {2710}event endCli(Sess,Cli,PartS_2613)
                                    )
                                    else
                                        {2711}let v_2614: bool = (Sess = B) in
                                        (
                                            {2712}if v_2614 then
                                            (
                                                {2713}let pkSess_2615: bitstring = pub(skB) in
                                                {2714}out(c, GetEndpointRequest);
                                                {2715}in(c, (SPs_2616: bitstring,=SignAndEncrypt,UP_2617: bitstring,=pkSess_2615));
                                                {2716}new SPc_2618: bitstring;
                                                {2717}new Nc_2619: bitstring;
                                                {2718}let gNc_2620: bitstring = exp(g,Nc_2619) in
                                                {2719}let m1_2621: bitstring = (SPc_2618,gNc_2620) in
                                                {2720}out(c, (pkCli_2154,enc(m1_2621,pkSess_2615),sign(m1_2621,skCli_2153)));
                                                {2721}event beginCli(Cli,Sess,gNc_2620);
                                                {2722}in(c, (ePartS_2622: bitstring,sigPartS_2623: bitstring));
                                                {2723}let PartS_2624: bitstring = dec(ePartS_2622,skCli_2153) in
                                                {2724}if (verify(PartS_2624,sigPartS_2623,pkSess_2615) <> true) then
                                                    0
                                                else
                                                    {2725}event endCli(Sess,Cli,PartS_2624)
                                            )
                                            else
                                                {2726}let v_2625: bool = (Sess = C) in
                                                (
                                                    {2727}if v_2625 then
                                                    (
                                                        {2728}let pkSess_2626: bitstring = pub(skC) in
                                                        {2729}out(c, GetEndpointRequest);
                                                        {2730}in(c, (SPs_2627: bitstring,=SignAndEncrypt,UP_2628: bitstring,=pkSess_2626));
                                                        {2731}new SPc_2629: bitstring;
                                                        {2732}new Nc_2630: bitstring;
                                                        {2733}let gNc_2631: bitstring = exp(g,Nc_2630) in
                                                        {2734}let m1_2632: bitstring = (SPc_2629,gNc_2631) in
                                                        {2735}out(c, (pkCli_2154,enc(m1_2632,pkSess_2626),sign(m1_2632,skCli_2153)));
                                                        {2736}event beginCli(Cli,Sess,gNc_2631);
                                                        {2737}in(c, (ePartS_2633: bitstring,sigPartS_2634: bitstring));
                                                        {2738}let PartS_2635: bitstring = dec(ePartS_2633,skCli_2153) in
                                                        {2739}if (verify(PartS_2635,sigPartS_2634,pkSess_2626) <> true) then
                                                            0
                                                        else
                                                            {2740}event endCli(Sess,Cli,PartS_2635)
                                                    )
                                                    else
                                                        {2741}let pkSess_2636: bitstring = pub(skI) in
                                                        {2742}out(c, GetEndpointRequest);
                                                        {2743}in(c, (SPs_2637: bitstring,=SignAndEncrypt,UP_2638: bitstring,=pkSess_2636));
                                                        {2744}new SPc_2639: bitstring;
                                                        {2745}new Nc_2640: bitstring;
                                                        {2746}let gNc_2641: bitstring = exp(g,Nc_2640) in
                                                        {2747}let m1_2642: bitstring = (SPc_2639,gNc_2641) in
                                                        {2748}out(c, (pkCli_2154,enc(m1_2642,pkSess_2636),sign(m1_2642,skCli_2153)));
                                                        {2749}event beginCli(Cli,Sess,gNc_2641);
                                                        {2750}in(c, (ePartS_2643: bitstring,sigPartS_2644: bitstring));
                                                        {2751}let PartS_2645: bitstring = dec(ePartS_2643,skCli_2153) in
                                                        {2752}if (verify(PartS_2645,sigPartS_2644,pkSess_2636) <> true) then
                                                            0
                                                        else
                                                            {2753}event endCli(Sess,Cli,PartS_2645)
                                                )
                                                else
                                                    {2754}let pkSess_2646: bitstring = fail-any in
                                                    {2755}out(c, GetEndpointRequest);
                                                    {2756}in(c, (SPs_2647: bitstring,=SignAndEncrypt,UP_2648: bitstring,=pkSess_2646));
                                                    {2757}new SPc_2649: bitstring;
                                                    {2758}new Nc_2650: bitstring;
                                                    {2759}let gNc_2651: bitstring = exp(g,Nc_2650) in
                                                    {2760}let m1_2652: bitstring = (SPc_2649,gNc_2651) in
                                                    {2761}out(c, (pkCli_2154,enc(m1_2652,pkSess_2646),sign(m1_2652,skCli_2153)));
                                                    {2762}event beginCli(Cli,Sess,gNc_2651);
                                                    {2763}in(c, (ePartS_2653: bitstring,sigPartS_2654: bitstring));
                                                    {2764}let PartS_2655: bitstring = dec(ePartS_2653,skCli_2153) in
                                                    {2765}if (verify(PartS_2655,sigPartS_2654,pkSess_2646) <> true) then
                                                        0
                                                    else
                                                        {2766}event endCli(Sess,Cli,PartS_2655)
                                        )
                                        else
                                            {2767}let pkSess_2656: bitstring = fail-any in
                                            {2768}out(c, GetEndpointRequest);
                                            {2769}in(c, (SPs_2657: bitstring,=SignAndEncrypt,UP_2658: bitstring,=pkSess_2656));
                                            {2770}new SPc_2659: bitstring;
                                            {2771}new Nc_2660: bitstring;
                                            {2772}let gNc_2661: bitstring = exp(g,Nc_2660) in
                                            {2773}let m1_2662: bitstring = (SPc_2659,gNc_2661) in
                                            {2774}out(c, (pkCli_2154,enc(m1_2662,pkSess_2656),sign(m1_2662,skCli_2153)));
                                            {2775}event beginCli(Cli,Sess,gNc_2661);
                                            {2776}in(c, (ePartS_2663: bitstring,sigPartS_2664: bitstring));
                                            {2777}let PartS_2665: bitstring = dec(ePartS_2663,skCli_2153) in
                                            {2778}if (verify(PartS_2665,sigPartS_2664,pkSess_2656) <> true) then
                                                0
                                            else
                                                {2779}event endCli(Sess,Cli,PartS_2665)
                                )
                                else
                                    {2780}let pkSess_2666: bitstring = fail-any in
                                    {2781}out(c, GetEndpointRequest);
                                    {2782}in(c, (SPs_2667: bitstring,=SignAndEncrypt,UP_2668: bitstring,=pkSess_2666));
                                    {2783}new SPc_2669: bitstring;
                                    {2784}new Nc_2670: bitstring;
                                    {2785}let gNc_2671: bitstring = exp(g,Nc_2670) in
                                    {2786}let m1_2672: bitstring = (SPc_2669,gNc_2671) in
                                    {2787}out(c, (pkCli_2154,enc(m1_2672,pkSess_2666),sign(m1_2672,skCli_2153)));
                                    {2788}event beginCli(Cli,Sess,gNc_2671);
                                    {2789}in(c, (ePartS_2673: bitstring,sigPartS_2674: bitstring));
                                    {2790}let PartS_2675: bitstring = dec(ePartS_2673,skCli_2153) in
                                    {2791}if (verify(PartS_2675,sigPartS_2674,pkSess_2666) <> true) then
                                        0
                                    else
                                        {2792}event endCli(Sess,Cli,PartS_2675)
                    )
                    else
                        {2793}let skCli_2676: bitstring = fail-any in
                        {2794}let pkCli_2677: bitstring = pub(skCli_2676) in
                        {2795}let v_2678: bool = (Disco = A) in
                        (
                            {2796}if v_2678 then
                            (
                                {2797}let pkDisco_2679: bitstring = pub(skA) in
                                {2798}let v_2680: bool = (Sess = A) in
                                (
                                    {2799}if v_2680 then
                                    (
                                        {2800}let pkSess_2681: bitstring = pub(skA) in
                                        {2801}out(c, GetEndpointRequest);
                                        {2802}in(c, (SPs_2682: bitstring,=SignAndEncrypt,UP_2683: bitstring,=pkSess_2681));
                                        {2803}new SPc_2684: bitstring;
                                        {2804}new Nc_2685: bitstring;
                                        {2805}let gNc_2686: bitstring = exp(g,Nc_2685) in
                                        {2806}let m1_2687: bitstring = (SPc_2684,gNc_2686) in
                                        {2807}out(c, (pkCli_2677,enc(m1_2687,pkSess_2681),sign(m1_2687,skCli_2676)));
                                        {2808}event beginCli(Cli,Sess,gNc_2686);
                                        {2809}in(c, (ePartS_2688: bitstring,sigPartS_2689: bitstring));
                                        {2810}let PartS_2690: bitstring = dec(ePartS_2688,skCli_2676) in
                                        {2811}if (verify(PartS_2690,sigPartS_2689,pkSess_2681) <> true) then
                                            0
                                        else
                                            {2812}event endCli(Sess,Cli,PartS_2690)
                                    )
                                    else
                                        {2813}let v_2691: bool = (Sess = B) in
                                        (
                                            {2814}if v_2691 then
                                            (
                                                {2815}let pkSess_2692: bitstring = pub(skB) in
                                                {2816}out(c, GetEndpointRequest);
                                                {2817}in(c, (SPs_2693: bitstring,=SignAndEncrypt,UP_2694: bitstring,=pkSess_2692));
                                                {2818}new SPc_2695: bitstring;
                                                {2819}new Nc_2696: bitstring;
                                                {2820}let gNc_2697: bitstring = exp(g,Nc_2696) in
                                                {2821}let m1_2698: bitstring = (SPc_2695,gNc_2697) in
                                                {2822}out(c, (pkCli_2677,enc(m1_2698,pkSess_2692),sign(m1_2698,skCli_2676)));
                                                {2823}event beginCli(Cli,Sess,gNc_2697);
                                                {2824}in(c, (ePartS_2699: bitstring,sigPartS_2700: bitstring));
                                                {2825}let PartS_2701: bitstring = dec(ePartS_2699,skCli_2676) in
                                                {2826}if (verify(PartS_2701,sigPartS_2700,pkSess_2692) <> true) then
                                                    0
                                                else
                                                    {2827}event endCli(Sess,Cli,PartS_2701)
                                            )
                                            else
                                                {2828}let v_2702: bool = (Sess = C) in
                                                (
                                                    {2829}if v_2702 then
                                                    (
                                                        {2830}let pkSess_2703: bitstring = pub(skC) in
                                                        {2831}out(c, GetEndpointRequest);
                                                        {2832}in(c, (SPs_2704: bitstring,=SignAndEncrypt,UP_2705: bitstring,=pkSess_2703));
                                                        {2833}new SPc_2706: bitstring;
                                                        {2834}new Nc_2707: bitstring;
                                                        {2835}let gNc_2708: bitstring = exp(g,Nc_2707) in
                                                        {2836}let m1_2709: bitstring = (SPc_2706,gNc_2708) in
                                                        {2837}out(c, (pkCli_2677,enc(m1_2709,pkSess_2703),sign(m1_2709,skCli_2676)));
                                                        {2838}event beginCli(Cli,Sess,gNc_2708);
                                                        {2839}in(c, (ePartS_2710: bitstring,sigPartS_2711: bitstring));
                                                        {2840}let PartS_2712: bitstring = dec(ePartS_2710,skCli_2676) in
                                                        {2841}if (verify(PartS_2712,sigPartS_2711,pkSess_2703) <> true) then
                                                            0
                                                        else
                                                            {2842}event endCli(Sess,Cli,PartS_2712)
                                                    )
                                                    else
                                                        {2843}let pkSess_2713: bitstring = pub(skI) in
                                                        {2844}out(c, GetEndpointRequest);
                                                        {2845}in(c, (SPs_2714: bitstring,=SignAndEncrypt,UP_2715: bitstring,=pkSess_2713));
                                                        {2846}new SPc_2716: bitstring;
                                                        {2847}new Nc_2717: bitstring;
                                                        {2848}let gNc_2718: bitstring = exp(g,Nc_2717) in
                                                        {2849}let m1_2719: bitstring = (SPc_2716,gNc_2718) in
                                                        {2850}out(c, (pkCli_2677,enc(m1_2719,pkSess_2713),sign(m1_2719,skCli_2676)));
                                                        {2851}event beginCli(Cli,Sess,gNc_2718);
                                                        {2852}in(c, (ePartS_2720: bitstring,sigPartS_2721: bitstring));
                                                        {2853}let PartS_2722: bitstring = dec(ePartS_2720,skCli_2676) in
                                                        {2854}if (verify(PartS_2722,sigPartS_2721,pkSess_2713) <> true) then
                                                            0
                                                        else
                                                            {2855}event endCli(Sess,Cli,PartS_2722)
                                                )
                                                else
                                                    {2856}let pkSess_2723: bitstring = fail-any in
                                                    {2857}out(c, GetEndpointRequest);
                                                    {2858}in(c, (SPs_2724: bitstring,=SignAndEncrypt,UP_2725: bitstring,=pkSess_2723));
                                                    {2859}new SPc_2726: bitstring;
                                                    {2860}new Nc_2727: bitstring;
                                                    {2861}let gNc_2728: bitstring = exp(g,Nc_2727) in
                                                    {2862}let m1_2729: bitstring = (SPc_2726,gNc_2728) in
                                                    {2863}out(c, (pkCli_2677,enc(m1_2729,pkSess_2723),sign(m1_2729,skCli_2676)));
                                                    {2864}event beginCli(Cli,Sess,gNc_2728);
                                                    {2865}in(c, (ePartS_2730: bitstring,sigPartS_2731: bitstring));
                                                    {2866}let PartS_2732: bitstring = dec(ePartS_2730,skCli_2676) in
                                                    {2867}if (verify(PartS_2732,sigPartS_2731,pkSess_2723) <> true) then
                                                        0
                                                    else
                                                        {2868}event endCli(Sess,Cli,PartS_2732)
                                        )
                                        else
                                            {2869}let pkSess_2733: bitstring = fail-any in
                                            {2870}out(c, GetEndpointRequest);
                                            {2871}in(c, (SPs_2734: bitstring,=SignAndEncrypt,UP_2735: bitstring,=pkSess_2733));
                                            {2872}new SPc_2736: bitstring;
                                            {2873}new Nc_2737: bitstring;
                                            {2874}let gNc_2738: bitstring = exp(g,Nc_2737) in
                                            {2875}let m1_2739: bitstring = (SPc_2736,gNc_2738) in
                                            {2876}out(c, (pkCli_2677,enc(m1_2739,pkSess_2733),sign(m1_2739,skCli_2676)));
                                            {2877}event beginCli(Cli,Sess,gNc_2738);
                                            {2878}in(c, (ePartS_2740: bitstring,sigPartS_2741: bitstring));
                                            {2879}let PartS_2742: bitstring = dec(ePartS_2740,skCli_2676) in
                                            {2880}if (verify(PartS_2742,sigPartS_2741,pkSess_2733) <> true) then
                                                0
                                            else
                                                {2881}event endCli(Sess,Cli,PartS_2742)
                                )
                                else
                                    {2882}let pkSess_2743: bitstring = fail-any in
                                    {2883}out(c, GetEndpointRequest);
                                    {2884}in(c, (SPs_2744: bitstring,=SignAndEncrypt,UP_2745: bitstring,=pkSess_2743));
                                    {2885}new SPc_2746: bitstring;
                                    {2886}new Nc_2747: bitstring;
                                    {2887}let gNc_2748: bitstring = exp(g,Nc_2747) in
                                    {2888}let m1_2749: bitstring = (SPc_2746,gNc_2748) in
                                    {2889}out(c, (pkCli_2677,enc(m1_2749,pkSess_2743),sign(m1_2749,skCli_2676)));
                                    {2890}event beginCli(Cli,Sess,gNc_2748);
                                    {2891}in(c, (ePartS_2750: bitstring,sigPartS_2751: bitstring));
                                    {2892}let PartS_2752: bitstring = dec(ePartS_2750,skCli_2676) in
                                    {2893}if (verify(PartS_2752,sigPartS_2751,pkSess_2743) <> true) then
                                        0
                                    else
                                        {2894}event endCli(Sess,Cli,PartS_2752)
                            )
                            else
                                {2895}let v_2753: bool = (Disco = B) in
                                (
                                    {2896}if v_2753 then
                                    (
                                        {2897}let pkDisco_2754: bitstring = pub(skB) in
                                        {2898}let v_2755: bool = (Sess = A) in
                                        (
                                            {2899}if v_2755 then
                                            (
                                                {2900}let pkSess_2756: bitstring = pub(skA) in
                                                {2901}out(c, GetEndpointRequest);
                                                {2902}in(c, (SPs_2757: bitstring,=SignAndEncrypt,UP_2758: bitstring,=pkSess_2756));
                                                {2903}new SPc_2759: bitstring;
                                                {2904}new Nc_2760: bitstring;
                                                {2905}let gNc_2761: bitstring = exp(g,Nc_2760) in
                                                {2906}let m1_2762: bitstring = (SPc_2759,gNc_2761) in
                                                {2907}out(c, (pkCli_2677,enc(m1_2762,pkSess_2756),sign(m1_2762,skCli_2676)));
                                                {2908}event beginCli(Cli,Sess,gNc_2761);
                                                {2909}in(c, (ePartS_2763: bitstring,sigPartS_2764: bitstring));
                                                {2910}let PartS_2765: bitstring = dec(ePartS_2763,skCli_2676) in
                                                {2911}if (verify(PartS_2765,sigPartS_2764,pkSess_2756) <> true) then
                                                    0
                                                else
                                                    {2912}event endCli(Sess,Cli,PartS_2765)
                                            )
                                            else
                                                {2913}let v_2766: bool = (Sess = B) in
                                                (
                                                    {2914}if v_2766 then
                                                    (
                                                        {2915}let pkSess_2767: bitstring = pub(skB) in
                                                        {2916}out(c, GetEndpointRequest);
                                                        {2917}in(c, (SPs_2768: bitstring,=SignAndEncrypt,UP_2769: bitstring,=pkSess_2767));
                                                        {2918}new SPc_2770: bitstring;
                                                        {2919}new Nc_2771: bitstring;
                                                        {2920}let gNc_2772: bitstring = exp(g,Nc_2771) in
                                                        {2921}let m1_2773: bitstring = (SPc_2770,gNc_2772) in
                                                        {2922}out(c, (pkCli_2677,enc(m1_2773,pkSess_2767),sign(m1_2773,skCli_2676)));
                                                        {2923}event beginCli(Cli,Sess,gNc_2772);
                                                        {2924}in(c, (ePartS_2774: bitstring,sigPartS_2775: bitstring));
                                                        {2925}let PartS_2776: bitstring = dec(ePartS_2774,skCli_2676) in
                                                        {2926}if (verify(PartS_2776,sigPartS_2775,pkSess_2767) <> true) then
                                                            0
                                                        else
                                                            {2927}event endCli(Sess,Cli,PartS_2776)
                                                    )
                                                    else
                                                        {2928}let v_2777: bool = (Sess = C) in
                                                        (
                                                            {2929}if v_2777 then
                                                            (
                                                                {2930}let pkSess_2778: bitstring = pub(skC) in
                                                                {2931}out(c, GetEndpointRequest);
                                                                {2932}in(c, (SPs_2779: bitstring,=SignAndEncrypt,UP_2780: bitstring,=pkSess_2778));
                                                                {2933}new SPc_2781: bitstring;
                                                                {2934}new Nc_2782: bitstring;
                                                                {2935}let gNc_2783: bitstring = exp(g,Nc_2782) in
                                                                {2936}let m1_2784: bitstring = (SPc_2781,gNc_2783) in
                                                                {2937}out(c, (pkCli_2677,enc(m1_2784,pkSess_2778),sign(m1_2784,skCli_2676)));
                                                                {2938}event beginCli(Cli,Sess,gNc_2783);
                                                                {2939}in(c, (ePartS_2785: bitstring,sigPartS_2786: bitstring));
                                                                {2940}let PartS_2787: bitstring = dec(ePartS_2785,skCli_2676) in
                                                                {2941}if (verify(PartS_2787,sigPartS_2786,pkSess_2778) <> true) then
                                                                    0
                                                                else
                                                                    {2942}event endCli(Sess,Cli,PartS_2787)
                                                            )
                                                            else
                                                                {2943}let pkSess_2788: bitstring = pub(skI) in
                                                                {2944}out(c, GetEndpointRequest);
                                                                {2945}in(c, (SPs_2789: bitstring,=SignAndEncrypt,UP_2790: bitstring,=pkSess_2788));
                                                                {2946}new SPc_2791: bitstring;
                                                                {2947}new Nc_2792: bitstring;
                                                                {2948}let gNc_2793: bitstring = exp(g,Nc_2792) in
                                                                {2949}let m1_2794: bitstring = (SPc_2791,gNc_2793) in
                                                                {2950}out(c, (pkCli_2677,enc(m1_2794,pkSess_2788),sign(m1_2794,skCli_2676)));
                                                                {2951}event beginCli(Cli,Sess,gNc_2793);
                                                                {2952}in(c, (ePartS_2795: bitstring,sigPartS_2796: bitstring));
                                                                {2953}let PartS_2797: bitstring = dec(ePartS_2795,skCli_2676) in
                                                                {2954}if (verify(PartS_2797,sigPartS_2796,pkSess_2788) <> true) then
                                                                    0
                                                                else
                                                                    {2955}event endCli(Sess,Cli,PartS_2797)
                                                        )
                                                        else
                                                            {2956}let pkSess_2798: bitstring = fail-any in
                                                            {2957}out(c, GetEndpointRequest);
                                                            {2958}in(c, (SPs_2799: bitstring,=SignAndEncrypt,UP_2800: bitstring,=pkSess_2798));
                                                            {2959}new SPc_2801: bitstring;
                                                            {2960}new Nc_2802: bitstring;
                                                            {2961}let gNc_2803: bitstring = exp(g,Nc_2802) in
                                                            {2962}let m1_2804: bitstring = (SPc_2801,gNc_2803) in
                                                            {2963}out(c, (pkCli_2677,enc(m1_2804,pkSess_2798),sign(m1_2804,skCli_2676)));
                                                            {2964}event beginCli(Cli,Sess,gNc_2803);
                                                            {2965}in(c, (ePartS_2805: bitstring,sigPartS_2806: bitstring));
                                                            {2966}let PartS_2807: bitstring = dec(ePartS_2805,skCli_2676) in
                                                            {2967}if (verify(PartS_2807,sigPartS_2806,pkSess_2798) <> true) then
                                                                0
                                                            else
                                                                {2968}event endCli(Sess,Cli,PartS_2807)
                                                )
                                                else
                                                    {2969}let pkSess_2808: bitstring = fail-any in
                                                    {2970}out(c, GetEndpointRequest);
                                                    {2971}in(c, (SPs_2809: bitstring,=SignAndEncrypt,UP_2810: bitstring,=pkSess_2808));
                                                    {2972}new SPc_2811: bitstring;
                                                    {2973}new Nc_2812: bitstring;
                                                    {2974}let gNc_2813: bitstring = exp(g,Nc_2812) in
                                                    {2975}let m1_2814: bitstring = (SPc_2811,gNc_2813) in
                                                    {2976}out(c, (pkCli_2677,enc(m1_2814,pkSess_2808),sign(m1_2814,skCli_2676)));
                                                    {2977}event beginCli(Cli,Sess,gNc_2813);
                                                    {2978}in(c, (ePartS_2815: bitstring,sigPartS_2816: bitstring));
                                                    {2979}let PartS_2817: bitstring = dec(ePartS_2815,skCli_2676) in
                                                    {2980}if (verify(PartS_2817,sigPartS_2816,pkSess_2808) <> true) then
                                                        0
                                                    else
                                                        {2981}event endCli(Sess,Cli,PartS_2817)
                                        )
                                        else
                                            {2982}let pkSess_2818: bitstring = fail-any in
                                            {2983}out(c, GetEndpointRequest);
                                            {2984}in(c, (SPs_2819: bitstring,=SignAndEncrypt,UP_2820: bitstring,=pkSess_2818));
                                            {2985}new SPc_2821: bitstring;
                                            {2986}new Nc_2822: bitstring;
                                            {2987}let gNc_2823: bitstring = exp(g,Nc_2822) in
                                            {2988}let m1_2824: bitstring = (SPc_2821,gNc_2823) in
                                            {2989}out(c, (pkCli_2677,enc(m1_2824,pkSess_2818),sign(m1_2824,skCli_2676)));
                                            {2990}event beginCli(Cli,Sess,gNc_2823);
                                            {2991}in(c, (ePartS_2825: bitstring,sigPartS_2826: bitstring));
                                            {2992}let PartS_2827: bitstring = dec(ePartS_2825,skCli_2676) in
                                            {2993}if (verify(PartS_2827,sigPartS_2826,pkSess_2818) <> true) then
                                                0
                                            else
                                                {2994}event endCli(Sess,Cli,PartS_2827)
                                    )
                                    else
                                        {2995}let v_2828: bool = (Disco = C) in
                                        (
                                            {2996}if v_2828 then
                                            (
                                                {2997}let pkDisco_2829: bitstring = pub(skC) in
                                                {2998}let v_2830: bool = (Sess = A) in
                                                (
                                                    {2999}if v_2830 then
                                                    (
                                                        {3000}let pkSess_2831: bitstring = pub(skA) in
                                                        {3001}out(c, GetEndpointRequest);
                                                        {3002}in(c, (SPs_2832: bitstring,=SignAndEncrypt,UP_2833: bitstring,=pkSess_2831));
                                                        {3003}new SPc_2834: bitstring;
                                                        {3004}new Nc_2835: bitstring;
                                                        {3005}let gNc_2836: bitstring = exp(g,Nc_2835) in
                                                        {3006}let m1_2837: bitstring = (SPc_2834,gNc_2836) in
                                                        {3007}out(c, (pkCli_2677,enc(m1_2837,pkSess_2831),sign(m1_2837,skCli_2676)));
                                                        {3008}event beginCli(Cli,Sess,gNc_2836);
                                                        {3009}in(c, (ePartS_2838: bitstring,sigPartS_2839: bitstring));
                                                        {3010}let PartS_2840: bitstring = dec(ePartS_2838,skCli_2676) in
                                                        {3011}if (verify(PartS_2840,sigPartS_2839,pkSess_2831) <> true) then
                                                            0
                                                        else
                                                            {3012}event endCli(Sess,Cli,PartS_2840)
                                                    )
                                                    else
                                                        {3013}let v_2841: bool = (Sess = B) in
                                                        (
                                                            {3014}if v_2841 then
                                                            (
                                                                {3015}let pkSess_2842: bitstring = pub(skB) in
                                                                {3016}out(c, GetEndpointRequest);
                                                                {3017}in(c, (SPs_2843: bitstring,=SignAndEncrypt,UP_2844: bitstring,=pkSess_2842));
                                                                {3018}new SPc_2845: bitstring;
                                                                {3019}new Nc_2846: bitstring;
                                                                {3020}let gNc_2847: bitstring = exp(g,Nc_2846) in
                                                                {3021}let m1_2848: bitstring = (SPc_2845,gNc_2847) in
                                                                {3022}out(c, (pkCli_2677,enc(m1_2848,pkSess_2842),sign(m1_2848,skCli_2676)));
                                                                {3023}event beginCli(Cli,Sess,gNc_2847);
                                                                {3024}in(c, (ePartS_2849: bitstring,sigPartS_2850: bitstring));
                                                                {3025}let PartS_2851: bitstring = dec(ePartS_2849,skCli_2676) in
                                                                {3026}if (verify(PartS_2851,sigPartS_2850,pkSess_2842) <> true) then
                                                                    0
                                                                else
                                                                    {3027}event endCli(Sess,Cli,PartS_2851)
                                                            )
                                                            else
                                                                {3028}let v_2852: bool = (Sess = C) in
                                                                (
                                                                    {3029}if v_2852 then
                                                                    (
                                                                        {3030}let pkSess_2853: bitstring = pub(skC) in
                                                                        {3031}out(c, GetEndpointRequest);
                                                                        {3032}in(c, (SPs_2854: bitstring,=SignAndEncrypt,UP_2855: bitstring,=pkSess_2853));
                                                                        {3033}new SPc_2856: bitstring;
                                                                        {3034}new Nc_2857: bitstring;
                                                                        {3035}let gNc_2858: bitstring = exp(g,Nc_2857) in
                                                                        {3036}let m1_2859: bitstring = (SPc_2856,gNc_2858) in
                                                                        {3037}out(c, (pkCli_2677,enc(m1_2859,pkSess_2853),sign(m1_2859,skCli_2676)));
                                                                        {3038}event beginCli(Cli,Sess,gNc_2858);
                                                                        {3039}in(c, (ePartS_2860: bitstring,sigPartS_2861: bitstring));
                                                                        {3040}let PartS_2862: bitstring = dec(ePartS_2860,skCli_2676) in
                                                                        {3041}if (verify(PartS_2862,sigPartS_2861,pkSess_2853) <> true) then
                                                                            0
                                                                        else
                                                                            {3042}event endCli(Sess,Cli,PartS_2862)
                                                                    )
                                                                    else
                                                                        {3043}let pkSess_2863: bitstring = pub(skI) in
                                                                        {3044}out(c, GetEndpointRequest);
                                                                        {3045}in(c, (SPs_2864: bitstring,=SignAndEncrypt,UP_2865: bitstring,=pkSess_2863));
                                                                        {3046}new SPc_2866: bitstring;
                                                                        {3047}new Nc_2867: bitstring;
                                                                        {3048}let gNc_2868: bitstring = exp(g,Nc_2867) in
                                                                        {3049}let m1_2869: bitstring = (SPc_2866,gNc_2868) in
                                                                        {3050}out(c, (pkCli_2677,enc(m1_2869,pkSess_2863),sign(m1_2869,skCli_2676)));
                                                                        {3051}event beginCli(Cli,Sess,gNc_2868);
                                                                        {3052}in(c, (ePartS_2870: bitstring,sigPartS_2871: bitstring));
                                                                        {3053}let PartS_2872: bitstring = dec(ePartS_2870,skCli_2676) in
                                                                        {3054}if (verify(PartS_2872,sigPartS_2871,pkSess_2863) <> true) then
                                                                            0
                                                                        else
                                                                            {3055}event endCli(Sess,Cli,PartS_2872)
                                                                )
                                                                else
                                                                    {3056}let pkSess_2873: bitstring = fail-any in
                                                                    {3057}out(c, GetEndpointRequest);
                                                                    {3058}in(c, (SPs_2874: bitstring,=SignAndEncrypt,UP_2875: bitstring,=pkSess_2873));
                                                                    {3059}new SPc_2876: bitstring;
                                                                    {3060}new Nc_2877: bitstring;
                                                                    {3061}let gNc_2878: bitstring = exp(g,Nc_2877) in
                                                                    {3062}let m1_2879: bitstring = (SPc_2876,gNc_2878) in
                                                                    {3063}out(c, (pkCli_2677,enc(m1_2879,pkSess_2873),sign(m1_2879,skCli_2676)));
                                                                    {3064}event beginCli(Cli,Sess,gNc_2878);
                                                                    {3065}in(c, (ePartS_2880: bitstring,sigPartS_2881: bitstring));
                                                                    {3066}let PartS_2882: bitstring = dec(ePartS_2880,skCli_2676) in
                                                                    {3067}if (verify(PartS_2882,sigPartS_2881,pkSess_2873) <> true) then
                                                                        0
                                                                    else
                                                                        {3068}event endCli(Sess,Cli,PartS_2882)
                                                        )
                                                        else
                                                            {3069}let pkSess_2883: bitstring = fail-any in
                                                            {3070}out(c, GetEndpointRequest);
                                                            {3071}in(c, (SPs_2884: bitstring,=SignAndEncrypt,UP_2885: bitstring,=pkSess_2883));
                                                            {3072}new SPc_2886: bitstring;
                                                            {3073}new Nc_2887: bitstring;
                                                            {3074}let gNc_2888: bitstring = exp(g,Nc_2887) in
                                                            {3075}let m1_2889: bitstring = (SPc_2886,gNc_2888) in
                                                            {3076}out(c, (pkCli_2677,enc(m1_2889,pkSess_2883),sign(m1_2889,skCli_2676)));
                                                            {3077}event beginCli(Cli,Sess,gNc_2888);
                                                            {3078}in(c, (ePartS_2890: bitstring,sigPartS_2891: bitstring));
                                                            {3079}let PartS_2892: bitstring = dec(ePartS_2890,skCli_2676) in
                                                            {3080}if (verify(PartS_2892,sigPartS_2891,pkSess_2883) <> true) then
                                                                0
                                                            else
                                                                {3081}event endCli(Sess,Cli,PartS_2892)
                                                )
                                                else
                                                    {3082}let pkSess_2893: bitstring = fail-any in
                                                    {3083}out(c, GetEndpointRequest);
                                                    {3084}in(c, (SPs_2894: bitstring,=SignAndEncrypt,UP_2895: bitstring,=pkSess_2893));
                                                    {3085}new SPc_2896: bitstring;
                                                    {3086}new Nc_2897: bitstring;
                                                    {3087}let gNc_2898: bitstring = exp(g,Nc_2897) in
                                                    {3088}let m1_2899: bitstring = (SPc_2896,gNc_2898) in
                                                    {3089}out(c, (pkCli_2677,enc(m1_2899,pkSess_2893),sign(m1_2899,skCli_2676)));
                                                    {3090}event beginCli(Cli,Sess,gNc_2898);
                                                    {3091}in(c, (ePartS_2900: bitstring,sigPartS_2901: bitstring));
                                                    {3092}let PartS_2902: bitstring = dec(ePartS_2900,skCli_2676) in
                                                    {3093}if (verify(PartS_2902,sigPartS_2901,pkSess_2893) <> true) then
                                                        0
                                                    else
                                                        {3094}event endCli(Sess,Cli,PartS_2902)
                                            )
                                            else
                                                {3095}let pkDisco_2903: bitstring = pub(skI) in
                                                {3096}let v_2904: bool = (Sess = A) in
                                                (
                                                    {3097}if v_2904 then
                                                    (
                                                        {3098}let pkSess_2905: bitstring = pub(skA) in
                                                        {3099}out(c, GetEndpointRequest);
                                                        {3100}in(c, (SPs_2906: bitstring,=SignAndEncrypt,UP_2907: bitstring,=pkSess_2905));
                                                        {3101}new SPc_2908: bitstring;
                                                        {3102}new Nc_2909: bitstring;
                                                        {3103}let gNc_2910: bitstring = exp(g,Nc_2909) in
                                                        {3104}let m1_2911: bitstring = (SPc_2908,gNc_2910) in
                                                        {3105}out(c, (pkCli_2677,enc(m1_2911,pkSess_2905),sign(m1_2911,skCli_2676)));
                                                        {3106}event beginCli(Cli,Sess,gNc_2910);
                                                        {3107}in(c, (ePartS_2912: bitstring,sigPartS_2913: bitstring));
                                                        {3108}let PartS_2914: bitstring = dec(ePartS_2912,skCli_2676) in
                                                        {3109}if (verify(PartS_2914,sigPartS_2913,pkSess_2905) <> true) then
                                                            0
                                                        else
                                                            {3110}event endCli(Sess,Cli,PartS_2914)
                                                    )
                                                    else
                                                        {3111}let v_2915: bool = (Sess = B) in
                                                        (
                                                            {3112}if v_2915 then
                                                            (
                                                                {3113}let pkSess_2916: bitstring = pub(skB) in
                                                                {3114}out(c, GetEndpointRequest);
                                                                {3115}in(c, (SPs_2917: bitstring,=SignAndEncrypt,UP_2918: bitstring,=pkSess_2916));
                                                                {3116}new SPc_2919: bitstring;
                                                                {3117}new Nc_2920: bitstring;
                                                                {3118}let gNc_2921: bitstring = exp(g,Nc_2920) in
                                                                {3119}let m1_2922: bitstring = (SPc_2919,gNc_2921) in
                                                                {3120}out(c, (pkCli_2677,enc(m1_2922,pkSess_2916),sign(m1_2922,skCli_2676)));
                                                                {3121}event beginCli(Cli,Sess,gNc_2921);
                                                                {3122}in(c, (ePartS_2923: bitstring,sigPartS_2924: bitstring));
                                                                {3123}let PartS_2925: bitstring = dec(ePartS_2923,skCli_2676) in
                                                                {3124}if (verify(PartS_2925,sigPartS_2924,pkSess_2916) <> true) then
                                                                    0
                                                                else
                                                                    {3125}event endCli(Sess,Cli,PartS_2925)
                                                            )
                                                            else
                                                                {3126}let v_2926: bool = (Sess = C) in
                                                                (
                                                                    {3127}if v_2926 then
                                                                    (
                                                                        {3128}let pkSess_2927: bitstring = pub(skC) in
                                                                        {3129}out(c, GetEndpointRequest);
                                                                        {3130}in(c, (SPs_2928: bitstring,=SignAndEncrypt,UP_2929: bitstring,=pkSess_2927));
                                                                        {3131}new SPc_2930: bitstring;
                                                                        {3132}new Nc_2931: bitstring;
                                                                        {3133}let gNc_2932: bitstring = exp(g,Nc_2931) in
                                                                        {3134}let m1_2933: bitstring = (SPc_2930,gNc_2932) in
                                                                        {3135}out(c, (pkCli_2677,enc(m1_2933,pkSess_2927),sign(m1_2933,skCli_2676)));
                                                                        {3136}event beginCli(Cli,Sess,gNc_2932);
                                                                        {3137}in(c, (ePartS_2934: bitstring,sigPartS_2935: bitstring));
                                                                        {3138}let PartS_2936: bitstring = dec(ePartS_2934,skCli_2676) in
                                                                        {3139}if (verify(PartS_2936,sigPartS_2935,pkSess_2927) <> true) then
                                                                            0
                                                                        else
                                                                            {3140}event endCli(Sess,Cli,PartS_2936)
                                                                    )
                                                                    else
                                                                        {3141}let pkSess_2937: bitstring = pub(skI) in
                                                                        {3142}out(c, GetEndpointRequest);
                                                                        {3143}in(c, (SPs_2938: bitstring,=SignAndEncrypt,UP_2939: bitstring,=pkSess_2937));
                                                                        {3144}new SPc_2940: bitstring;
                                                                        {3145}new Nc_2941: bitstring;
                                                                        {3146}let gNc_2942: bitstring = exp(g,Nc_2941) in
                                                                        {3147}let m1_2943: bitstring = (SPc_2940,gNc_2942) in
                                                                        {3148}out(c, (pkCli_2677,enc(m1_2943,pkSess_2937),sign(m1_2943,skCli_2676)));
                                                                        {3149}event beginCli(Cli,Sess,gNc_2942);
                                                                        {3150}in(c, (ePartS_2944: bitstring,sigPartS_2945: bitstring));
                                                                        {3151}let PartS_2946: bitstring = dec(ePartS_2944,skCli_2676) in
                                                                        {3152}if (verify(PartS_2946,sigPartS_2945,pkSess_2937) <> true) then
                                                                            0
                                                                        else
                                                                            {3153}event endCli(Sess,Cli,PartS_2946)
                                                                )
                                                                else
                                                                    {3154}let pkSess_2947: bitstring = fail-any in
                                                                    {3155}out(c, GetEndpointRequest);
                                                                    {3156}in(c, (SPs_2948: bitstring,=SignAndEncrypt,UP_2949: bitstring,=pkSess_2947));
                                                                    {3157}new SPc_2950: bitstring;
                                                                    {3158}new Nc_2951: bitstring;
                                                                    {3159}let gNc_2952: bitstring = exp(g,Nc_2951) in
                                                                    {3160}let m1_2953: bitstring = (SPc_2950,gNc_2952) in
                                                                    {3161}out(c, (pkCli_2677,enc(m1_2953,pkSess_2947),sign(m1_2953,skCli_2676)));
                                                                    {3162}event beginCli(Cli,Sess,gNc_2952);
                                                                    {3163}in(c, (ePartS_2954: bitstring,sigPartS_2955: bitstring));
                                                                    {3164}let PartS_2956: bitstring = dec(ePartS_2954,skCli_2676) in
                                                                    {3165}if (verify(PartS_2956,sigPartS_2955,pkSess_2947) <> true) then
                                                                        0
                                                                    else
                                                                        {3166}event endCli(Sess,Cli,PartS_2956)
                                                        )
                                                        else
                                                            {3167}let pkSess_2957: bitstring = fail-any in
                                                            {3168}out(c, GetEndpointRequest);
                                                            {3169}in(c, (SPs_2958: bitstring,=SignAndEncrypt,UP_2959: bitstring,=pkSess_2957));
                                                            {3170}new SPc_2960: bitstring;
                                                            {3171}new Nc_2961: bitstring;
                                                            {3172}let gNc_2962: bitstring = exp(g,Nc_2961) in
                                                            {3173}let m1_2963: bitstring = (SPc_2960,gNc_2962) in
                                                            {3174}out(c, (pkCli_2677,enc(m1_2963,pkSess_2957),sign(m1_2963,skCli_2676)));
                                                            {3175}event beginCli(Cli,Sess,gNc_2962);
                                                            {3176}in(c, (ePartS_2964: bitstring,sigPartS_2965: bitstring));
                                                            {3177}let PartS_2966: bitstring = dec(ePartS_2964,skCli_2676) in
                                                            {3178}if (verify(PartS_2966,sigPartS_2965,pkSess_2957) <> true) then
                                                                0
                                                            else
                                                                {3179}event endCli(Sess,Cli,PartS_2966)
                                                )
                                                else
                                                    {3180}let pkSess_2967: bitstring = fail-any in
                                                    {3181}out(c, GetEndpointRequest);
                                                    {3182}in(c, (SPs_2968: bitstring,=SignAndEncrypt,UP_2969: bitstring,=pkSess_2967));
                                                    {3183}new SPc_2970: bitstring;
                                                    {3184}new Nc_2971: bitstring;
                                                    {3185}let gNc_2972: bitstring = exp(g,Nc_2971) in
                                                    {3186}let m1_2973: bitstring = (SPc_2970,gNc_2972) in
                                                    {3187}out(c, (pkCli_2677,enc(m1_2973,pkSess_2967),sign(m1_2973,skCli_2676)));
                                                    {3188}event beginCli(Cli,Sess,gNc_2972);
                                                    {3189}in(c, (ePartS_2974: bitstring,sigPartS_2975: bitstring));
                                                    {3190}let PartS_2976: bitstring = dec(ePartS_2974,skCli_2676) in
                                                    {3191}if (verify(PartS_2976,sigPartS_2975,pkSess_2967) <> true) then
                                                        0
                                                    else
                                                        {3192}event endCli(Sess,Cli,PartS_2976)
                                        )
                                        else
                                            {3193}let pkDisco_2977: bitstring = fail-any in
                                            {3194}let v_2978: bool = (Sess = A) in
                                            (
                                                {3195}if v_2978 then
                                                (
                                                    {3196}let pkSess_2979: bitstring = pub(skA) in
                                                    {3197}out(c, GetEndpointRequest);
                                                    {3198}in(c, (SPs_2980: bitstring,=SignAndEncrypt,UP_2981: bitstring,=pkSess_2979));
                                                    {3199}new SPc_2982: bitstring;
                                                    {3200}new Nc_2983: bitstring;
                                                    {3201}let gNc_2984: bitstring = exp(g,Nc_2983) in
                                                    {3202}let m1_2985: bitstring = (SPc_2982,gNc_2984) in
                                                    {3203}out(c, (pkCli_2677,enc(m1_2985,pkSess_2979),sign(m1_2985,skCli_2676)));
                                                    {3204}event beginCli(Cli,Sess,gNc_2984);
                                                    {3205}in(c, (ePartS_2986: bitstring,sigPartS_2987: bitstring));
                                                    {3206}let PartS_2988: bitstring = dec(ePartS_2986,skCli_2676) in
                                                    {3207}if (verify(PartS_2988,sigPartS_2987,pkSess_2979) <> true) then
                                                        0
                                                    else
                                                        {3208}event endCli(Sess,Cli,PartS_2988)
                                                )
                                                else
                                                    {3209}let v_2989: bool = (Sess = B) in
                                                    (
                                                        {3210}if v_2989 then
                                                        (
                                                            {3211}let pkSess_2990: bitstring = pub(skB) in
                                                            {3212}out(c, GetEndpointRequest);
                                                            {3213}in(c, (SPs_2991: bitstring,=SignAndEncrypt,UP_2992: bitstring,=pkSess_2990));
                                                            {3214}new SPc_2993: bitstring;
                                                            {3215}new Nc_2994: bitstring;
                                                            {3216}let gNc_2995: bitstring = exp(g,Nc_2994) in
                                                            {3217}let m1_2996: bitstring = (SPc_2993,gNc_2995) in
                                                            {3218}out(c, (pkCli_2677,enc(m1_2996,pkSess_2990),sign(m1_2996,skCli_2676)));
                                                            {3219}event beginCli(Cli,Sess,gNc_2995);
                                                            {3220}in(c, (ePartS_2997: bitstring,sigPartS_2998: bitstring));
                                                            {3221}let PartS_2999: bitstring = dec(ePartS_2997,skCli_2676) in
                                                            {3222}if (verify(PartS_2999,sigPartS_2998,pkSess_2990) <> true) then
                                                                0
                                                            else
                                                                {3223}event endCli(Sess,Cli,PartS_2999)
                                                        )
                                                        else
                                                            {3224}let v_3000: bool = (Sess = C) in
                                                            (
                                                                {3225}if v_3000 then
                                                                (
                                                                    {3226}let pkSess_3001: bitstring = pub(skC) in
                                                                    {3227}out(c, GetEndpointRequest);
                                                                    {3228}in(c, (SPs_3002: bitstring,=SignAndEncrypt,UP_3003: bitstring,=pkSess_3001));
                                                                    {3229}new SPc_3004: bitstring;
                                                                    {3230}new Nc_3005: bitstring;
                                                                    {3231}let gNc_3006: bitstring = exp(g,Nc_3005) in
                                                                    {3232}let m1_3007: bitstring = (SPc_3004,gNc_3006) in
                                                                    {3233}out(c, (pkCli_2677,enc(m1_3007,pkSess_3001),sign(m1_3007,skCli_2676)));
                                                                    {3234}event beginCli(Cli,Sess,gNc_3006);
                                                                    {3235}in(c, (ePartS_3008: bitstring,sigPartS_3009: bitstring));
                                                                    {3236}let PartS_3010: bitstring = dec(ePartS_3008,skCli_2676) in
                                                                    {3237}if (verify(PartS_3010,sigPartS_3009,pkSess_3001) <> true) then
                                                                        0
                                                                    else
                                                                        {3238}event endCli(Sess,Cli,PartS_3010)
                                                                )
                                                                else
                                                                    {3239}let pkSess_3011: bitstring = pub(skI) in
                                                                    {3240}out(c, GetEndpointRequest);
                                                                    {3241}in(c, (SPs_3012: bitstring,=SignAndEncrypt,UP_3013: bitstring,=pkSess_3011));
                                                                    {3242}new SPc_3014: bitstring;
                                                                    {3243}new Nc_3015: bitstring;
                                                                    {3244}let gNc_3016: bitstring = exp(g,Nc_3015) in
                                                                    {3245}let m1_3017: bitstring = (SPc_3014,gNc_3016) in
                                                                    {3246}out(c, (pkCli_2677,enc(m1_3017,pkSess_3011),sign(m1_3017,skCli_2676)));
                                                                    {3247}event beginCli(Cli,Sess,gNc_3016);
                                                                    {3248}in(c, (ePartS_3018: bitstring,sigPartS_3019: bitstring));
                                                                    {3249}let PartS_3020: bitstring = dec(ePartS_3018,skCli_2676) in
                                                                    {3250}if (verify(PartS_3020,sigPartS_3019,pkSess_3011) <> true) then
                                                                        0
                                                                    else
                                                                        {3251}event endCli(Sess,Cli,PartS_3020)
                                                            )
                                                            else
                                                                {3252}let pkSess_3021: bitstring = fail-any in
                                                                {3253}out(c, GetEndpointRequest);
                                                                {3254}in(c, (SPs_3022: bitstring,=SignAndEncrypt,UP_3023: bitstring,=pkSess_3021));
                                                                {3255}new SPc_3024: bitstring;
                                                                {3256}new Nc_3025: bitstring;
                                                                {3257}let gNc_3026: bitstring = exp(g,Nc_3025) in
                                                                {3258}let m1_3027: bitstring = (SPc_3024,gNc_3026) in
                                                                {3259}out(c, (pkCli_2677,enc(m1_3027,pkSess_3021),sign(m1_3027,skCli_2676)));
                                                                {3260}event beginCli(Cli,Sess,gNc_3026);
                                                                {3261}in(c, (ePartS_3028: bitstring,sigPartS_3029: bitstring));
                                                                {3262}let PartS_3030: bitstring = dec(ePartS_3028,skCli_2676) in
                                                                {3263}if (verify(PartS_3030,sigPartS_3029,pkSess_3021) <> true) then
                                                                    0
                                                                else
                                                                    {3264}event endCli(Sess,Cli,PartS_3030)
                                                    )
                                                    else
                                                        {3265}let pkSess_3031: bitstring = fail-any in
                                                        {3266}out(c, GetEndpointRequest);
                                                        {3267}in(c, (SPs_3032: bitstring,=SignAndEncrypt,UP_3033: bitstring,=pkSess_3031));
                                                        {3268}new SPc_3034: bitstring;
                                                        {3269}new Nc_3035: bitstring;
                                                        {3270}let gNc_3036: bitstring = exp(g,Nc_3035) in
                                                        {3271}let m1_3037: bitstring = (SPc_3034,gNc_3036) in
                                                        {3272}out(c, (pkCli_2677,enc(m1_3037,pkSess_3031),sign(m1_3037,skCli_2676)));
                                                        {3273}event beginCli(Cli,Sess,gNc_3036);
                                                        {3274}in(c, (ePartS_3038: bitstring,sigPartS_3039: bitstring));
                                                        {3275}let PartS_3040: bitstring = dec(ePartS_3038,skCli_2676) in
                                                        {3276}if (verify(PartS_3040,sigPartS_3039,pkSess_3031) <> true) then
                                                            0
                                                        else
                                                            {3277}event endCli(Sess,Cli,PartS_3040)
                                            )
                                            else
                                                {3278}let pkSess_3041: bitstring = fail-any in
                                                {3279}out(c, GetEndpointRequest);
                                                {3280}in(c, (SPs_3042: bitstring,=SignAndEncrypt,UP_3043: bitstring,=pkSess_3041));
                                                {3281}new SPc_3044: bitstring;
                                                {3282}new Nc_3045: bitstring;
                                                {3283}let gNc_3046: bitstring = exp(g,Nc_3045) in
                                                {3284}let m1_3047: bitstring = (SPc_3044,gNc_3046) in
                                                {3285}out(c, (pkCli_2677,enc(m1_3047,pkSess_3041),sign(m1_3047,skCli_2676)));
                                                {3286}event beginCli(Cli,Sess,gNc_3046);
                                                {3287}in(c, (ePartS_3048: bitstring,sigPartS_3049: bitstring));
                                                {3288}let PartS_3050: bitstring = dec(ePartS_3048,skCli_2676) in
                                                {3289}if (verify(PartS_3050,sigPartS_3049,pkSess_3041) <> true) then
                                                    0
                                                else
                                                    {3290}event endCli(Sess,Cli,PartS_3050)
                                )
                                else
                                    {3291}let pkDisco_3051: bitstring = fail-any in
                                    {3292}let v_3052: bool = (Sess = A) in
                                    (
                                        {3293}if v_3052 then
                                        (
                                            {3294}let pkSess_3053: bitstring = pub(skA) in
                                            {3295}out(c, GetEndpointRequest);
                                            {3296}in(c, (SPs_3054: bitstring,=SignAndEncrypt,UP_3055: bitstring,=pkSess_3053));
                                            {3297}new SPc_3056: bitstring;
                                            {3298}new Nc_3057: bitstring;
                                            {3299}let gNc_3058: bitstring = exp(g,Nc_3057) in
                                            {3300}let m1_3059: bitstring = (SPc_3056,gNc_3058) in
                                            {3301}out(c, (pkCli_2677,enc(m1_3059,pkSess_3053),sign(m1_3059,skCli_2676)));
                                            {3302}event beginCli(Cli,Sess,gNc_3058);
                                            {3303}in(c, (ePartS_3060: bitstring,sigPartS_3061: bitstring));
                                            {3304}let PartS_3062: bitstring = dec(ePartS_3060,skCli_2676) in
                                            {3305}if (verify(PartS_3062,sigPartS_3061,pkSess_3053) <> true) then
                                                0
                                            else
                                                {3306}event endCli(Sess,Cli,PartS_3062)
                                        )
                                        else
                                            {3307}let v_3063: bool = (Sess = B) in
                                            (
                                                {3308}if v_3063 then
                                                (
                                                    {3309}let pkSess_3064: bitstring = pub(skB) in
                                                    {3310}out(c, GetEndpointRequest);
                                                    {3311}in(c, (SPs_3065: bitstring,=SignAndEncrypt,UP_3066: bitstring,=pkSess_3064));
                                                    {3312}new SPc_3067: bitstring;
                                                    {3313}new Nc_3068: bitstring;
                                                    {3314}let gNc_3069: bitstring = exp(g,Nc_3068) in
                                                    {3315}let m1_3070: bitstring = (SPc_3067,gNc_3069) in
                                                    {3316}out(c, (pkCli_2677,enc(m1_3070,pkSess_3064),sign(m1_3070,skCli_2676)));
                                                    {3317}event beginCli(Cli,Sess,gNc_3069);
                                                    {3318}in(c, (ePartS_3071: bitstring,sigPartS_3072: bitstring));
                                                    {3319}let PartS_3073: bitstring = dec(ePartS_3071,skCli_2676) in
                                                    {3320}if (verify(PartS_3073,sigPartS_3072,pkSess_3064) <> true) then
                                                        0
                                                    else
                                                        {3321}event endCli(Sess,Cli,PartS_3073)
                                                )
                                                else
                                                    {3322}let v_3074: bool = (Sess = C) in
                                                    (
                                                        {3323}if v_3074 then
                                                        (
                                                            {3324}let pkSess_3075: bitstring = pub(skC) in
                                                            {3325}out(c, GetEndpointRequest);
                                                            {3326}in(c, (SPs_3076: bitstring,=SignAndEncrypt,UP_3077: bitstring,=pkSess_3075));
                                                            {3327}new SPc_3078: bitstring;
                                                            {3328}new Nc_3079: bitstring;
                                                            {3329}let gNc_3080: bitstring = exp(g,Nc_3079) in
                                                            {3330}let m1_3081: bitstring = (SPc_3078,gNc_3080) in
                                                            {3331}out(c, (pkCli_2677,enc(m1_3081,pkSess_3075),sign(m1_3081,skCli_2676)));
                                                            {3332}event beginCli(Cli,Sess,gNc_3080);
                                                            {3333}in(c, (ePartS_3082: bitstring,sigPartS_3083: bitstring));
                                                            {3334}let PartS_3084: bitstring = dec(ePartS_3082,skCli_2676) in
                                                            {3335}if (verify(PartS_3084,sigPartS_3083,pkSess_3075) <> true) then
                                                                0
                                                            else
                                                                {3336}event endCli(Sess,Cli,PartS_3084)
                                                        )
                                                        else
                                                            {3337}let pkSess_3085: bitstring = pub(skI) in
                                                            {3338}out(c, GetEndpointRequest);
                                                            {3339}in(c, (SPs_3086: bitstring,=SignAndEncrypt,UP_3087: bitstring,=pkSess_3085));
                                                            {3340}new SPc_3088: bitstring;
                                                            {3341}new Nc_3089: bitstring;
                                                            {3342}let gNc_3090: bitstring = exp(g,Nc_3089) in
                                                            {3343}let m1_3091: bitstring = (SPc_3088,gNc_3090) in
                                                            {3344}out(c, (pkCli_2677,enc(m1_3091,pkSess_3085),sign(m1_3091,skCli_2676)));
                                                            {3345}event beginCli(Cli,Sess,gNc_3090);
                                                            {3346}in(c, (ePartS_3092: bitstring,sigPartS_3093: bitstring));
                                                            {3347}let PartS_3094: bitstring = dec(ePartS_3092,skCli_2676) in
                                                            {3348}if (verify(PartS_3094,sigPartS_3093,pkSess_3085) <> true) then
                                                                0
                                                            else
                                                                {3349}event endCli(Sess,Cli,PartS_3094)
                                                    )
                                                    else
                                                        {3350}let pkSess_3095: bitstring = fail-any in
                                                        {3351}out(c, GetEndpointRequest);
                                                        {3352}in(c, (SPs_3096: bitstring,=SignAndEncrypt,UP_3097: bitstring,=pkSess_3095));
                                                        {3353}new SPc_3098: bitstring;
                                                        {3354}new Nc_3099: bitstring;
                                                        {3355}let gNc_3100: bitstring = exp(g,Nc_3099) in
                                                        {3356}let m1_3101: bitstring = (SPc_3098,gNc_3100) in
                                                        {3357}out(c, (pkCli_2677,enc(m1_3101,pkSess_3095),sign(m1_3101,skCli_2676)));
                                                        {3358}event beginCli(Cli,Sess,gNc_3100);
                                                        {3359}in(c, (ePartS_3102: bitstring,sigPartS_3103: bitstring));
                                                        {3360}let PartS_3104: bitstring = dec(ePartS_3102,skCli_2676) in
                                                        {3361}if (verify(PartS_3104,sigPartS_3103,pkSess_3095) <> true) then
                                                            0
                                                        else
                                                            {3362}event endCli(Sess,Cli,PartS_3104)
                                            )
                                            else
                                                {3363}let pkSess_3105: bitstring = fail-any in
                                                {3364}out(c, GetEndpointRequest);
                                                {3365}in(c, (SPs_3106: bitstring,=SignAndEncrypt,UP_3107: bitstring,=pkSess_3105));
                                                {3366}new SPc_3108: bitstring;
                                                {3367}new Nc_3109: bitstring;
                                                {3368}let gNc_3110: bitstring = exp(g,Nc_3109) in
                                                {3369}let m1_3111: bitstring = (SPc_3108,gNc_3110) in
                                                {3370}out(c, (pkCli_2677,enc(m1_3111,pkSess_3105),sign(m1_3111,skCli_2676)));
                                                {3371}event beginCli(Cli,Sess,gNc_3110);
                                                {3372}in(c, (ePartS_3112: bitstring,sigPartS_3113: bitstring));
                                                {3373}let PartS_3114: bitstring = dec(ePartS_3112,skCli_2676) in
                                                {3374}if (verify(PartS_3114,sigPartS_3113,pkSess_3105) <> true) then
                                                    0
                                                else
                                                    {3375}event endCli(Sess,Cli,PartS_3114)
                                    )
                                    else
                                        {3376}let pkSess_3115: bitstring = fail-any in
                                        {3377}out(c, GetEndpointRequest);
                                        {3378}in(c, (SPs_3116: bitstring,=SignAndEncrypt,UP_3117: bitstring,=pkSess_3115));
                                        {3379}new SPc_3118: bitstring;
                                        {3380}new Nc_3119: bitstring;
                                        {3381}let gNc_3120: bitstring = exp(g,Nc_3119) in
                                        {3382}let m1_3121: bitstring = (SPc_3118,gNc_3120) in
                                        {3383}out(c, (pkCli_2677,enc(m1_3121,pkSess_3115),sign(m1_3121,skCli_2676)));
                                        {3384}event beginCli(Cli,Sess,gNc_3120);
                                        {3385}in(c, (ePartS_3122: bitstring,sigPartS_3123: bitstring));
                                        {3386}let PartS_3124: bitstring = dec(ePartS_3122,skCli_2676) in
                                        {3387}if (verify(PartS_3124,sigPartS_3123,pkSess_3115) <> true) then
                                            0
                                        else
                                            {3388}event endCli(Sess,Cli,PartS_3124)
                        )
                        else
                            {3389}let pkDisco_3125: bitstring = fail-any in
                            {3390}let v_3126: bool = (Sess = A) in
                            (
                                {3391}if v_3126 then
                                (
                                    {3392}let pkSess_3127: bitstring = pub(skA) in
                                    {3393}out(c, GetEndpointRequest);
                                    {3394}in(c, (SPs_3128: bitstring,=SignAndEncrypt,UP_3129: bitstring,=pkSess_3127));
                                    {3395}new SPc_3130: bitstring;
                                    {3396}new Nc_3131: bitstring;
                                    {3397}let gNc_3132: bitstring = exp(g,Nc_3131) in
                                    {3398}let m1_3133: bitstring = (SPc_3130,gNc_3132) in
                                    {3399}out(c, (pkCli_2677,enc(m1_3133,pkSess_3127),sign(m1_3133,skCli_2676)));
                                    {3400}event beginCli(Cli,Sess,gNc_3132);
                                    {3401}in(c, (ePartS_3134: bitstring,sigPartS_3135: bitstring));
                                    {3402}let PartS_3136: bitstring = dec(ePartS_3134,skCli_2676) in
                                    {3403}if (verify(PartS_3136,sigPartS_3135,pkSess_3127) <> true) then
                                        0
                                    else
                                        {3404}event endCli(Sess,Cli,PartS_3136)
                                )
                                else
                                    {3405}let v_3137: bool = (Sess = B) in
                                    (
                                        {3406}if v_3137 then
                                        (
                                            {3407}let pkSess_3138: bitstring = pub(skB) in
                                            {3408}out(c, GetEndpointRequest);
                                            {3409}in(c, (SPs_3139: bitstring,=SignAndEncrypt,UP_3140: bitstring,=pkSess_3138));
                                            {3410}new SPc_3141: bitstring;
                                            {3411}new Nc_3142: bitstring;
                                            {3412}let gNc_3143: bitstring = exp(g,Nc_3142) in
                                            {3413}let m1_3144: bitstring = (SPc_3141,gNc_3143) in
                                            {3414}out(c, (pkCli_2677,enc(m1_3144,pkSess_3138),sign(m1_3144,skCli_2676)));
                                            {3415}event beginCli(Cli,Sess,gNc_3143);
                                            {3416}in(c, (ePartS_3145: bitstring,sigPartS_3146: bitstring));
                                            {3417}let PartS_3147: bitstring = dec(ePartS_3145,skCli_2676) in
                                            {3418}if (verify(PartS_3147,sigPartS_3146,pkSess_3138) <> true) then
                                                0
                                            else
                                                {3419}event endCli(Sess,Cli,PartS_3147)
                                        )
                                        else
                                            {3420}let v_3148: bool = (Sess = C) in
                                            (
                                                {3421}if v_3148 then
                                                (
                                                    {3422}let pkSess_3149: bitstring = pub(skC) in
                                                    {3423}out(c, GetEndpointRequest);
                                                    {3424}in(c, (SPs_3150: bitstring,=SignAndEncrypt,UP_3151: bitstring,=pkSess_3149));
                                                    {3425}new SPc_3152: bitstring;
                                                    {3426}new Nc_3153: bitstring;
                                                    {3427}let gNc_3154: bitstring = exp(g,Nc_3153) in
                                                    {3428}let m1_3155: bitstring = (SPc_3152,gNc_3154) in
                                                    {3429}out(c, (pkCli_2677,enc(m1_3155,pkSess_3149),sign(m1_3155,skCli_2676)));
                                                    {3430}event beginCli(Cli,Sess,gNc_3154);
                                                    {3431}in(c, (ePartS_3156: bitstring,sigPartS_3157: bitstring));
                                                    {3432}let PartS_3158: bitstring = dec(ePartS_3156,skCli_2676) in
                                                    {3433}if (verify(PartS_3158,sigPartS_3157,pkSess_3149) <> true) then
                                                        0
                                                    else
                                                        {3434}event endCli(Sess,Cli,PartS_3158)
                                                )
                                                else
                                                    {3435}let pkSess_3159: bitstring = pub(skI) in
                                                    {3436}out(c, GetEndpointRequest);
                                                    {3437}in(c, (SPs_3160: bitstring,=SignAndEncrypt,UP_3161: bitstring,=pkSess_3159));
                                                    {3438}new SPc_3162: bitstring;
                                                    {3439}new Nc_3163: bitstring;
                                                    {3440}let gNc_3164: bitstring = exp(g,Nc_3163) in
                                                    {3441}let m1_3165: bitstring = (SPc_3162,gNc_3164) in
                                                    {3442}out(c, (pkCli_2677,enc(m1_3165,pkSess_3159),sign(m1_3165,skCli_2676)));
                                                    {3443}event beginCli(Cli,Sess,gNc_3164);
                                                    {3444}in(c, (ePartS_3166: bitstring,sigPartS_3167: bitstring));
                                                    {3445}let PartS_3168: bitstring = dec(ePartS_3166,skCli_2676) in
                                                    {3446}if (verify(PartS_3168,sigPartS_3167,pkSess_3159) <> true) then
                                                        0
                                                    else
                                                        {3447}event endCli(Sess,Cli,PartS_3168)
                                            )
                                            else
                                                {3448}let pkSess_3169: bitstring = fail-any in
                                                {3449}out(c, GetEndpointRequest);
                                                {3450}in(c, (SPs_3170: bitstring,=SignAndEncrypt,UP_3171: bitstring,=pkSess_3169));
                                                {3451}new SPc_3172: bitstring;
                                                {3452}new Nc_3173: bitstring;
                                                {3453}let gNc_3174: bitstring = exp(g,Nc_3173) in
                                                {3454}let m1_3175: bitstring = (SPc_3172,gNc_3174) in
                                                {3455}out(c, (pkCli_2677,enc(m1_3175,pkSess_3169),sign(m1_3175,skCli_2676)));
                                                {3456}event beginCli(Cli,Sess,gNc_3174);
                                                {3457}in(c, (ePartS_3176: bitstring,sigPartS_3177: bitstring));
                                                {3458}let PartS_3178: bitstring = dec(ePartS_3176,skCli_2676) in
                                                {3459}if (verify(PartS_3178,sigPartS_3177,pkSess_3169) <> true) then
                                                    0
                                                else
                                                    {3460}event endCli(Sess,Cli,PartS_3178)
                                    )
                                    else
                                        {3461}let pkSess_3179: bitstring = fail-any in
                                        {3462}out(c, GetEndpointRequest);
                                        {3463}in(c, (SPs_3180: bitstring,=SignAndEncrypt,UP_3181: bitstring,=pkSess_3179));
                                        {3464}new SPc_3182: bitstring;
                                        {3465}new Nc_3183: bitstring;
                                        {3466}let gNc_3184: bitstring = exp(g,Nc_3183) in
                                        {3467}let m1_3185: bitstring = (SPc_3182,gNc_3184) in
                                        {3468}out(c, (pkCli_2677,enc(m1_3185,pkSess_3179),sign(m1_3185,skCli_2676)));
                                        {3469}event beginCli(Cli,Sess,gNc_3184);
                                        {3470}in(c, (ePartS_3186: bitstring,sigPartS_3187: bitstring));
                                        {3471}let PartS_3188: bitstring = dec(ePartS_3186,skCli_2676) in
                                        {3472}if (verify(PartS_3188,sigPartS_3187,pkSess_3179) <> true) then
                                            0
                                        else
                                            {3473}event endCli(Sess,Cli,PartS_3188)
                            )
                            else
                                {3474}let pkSess_3189: bitstring = fail-any in
                                {3475}out(c, GetEndpointRequest);
                                {3476}in(c, (SPs_3190: bitstring,=SignAndEncrypt,UP_3191: bitstring,=pkSess_3189));
                                {3477}new SPc_3192: bitstring;
                                {3478}new Nc_3193: bitstring;
                                {3479}let gNc_3194: bitstring = exp(g,Nc_3193) in
                                {3480}let m1_3195: bitstring = (SPc_3192,gNc_3194) in
                                {3481}out(c, (pkCli_2677,enc(m1_3195,pkSess_3189),sign(m1_3195,skCli_2676)));
                                {3482}event beginCli(Cli,Sess,gNc_3194);
                                {3483}in(c, (ePartS_3196: bitstring,sigPartS_3197: bitstring));
                                {3484}let PartS_3198: bitstring = dec(ePartS_3196,skCli_2676) in
                                {3485}if (verify(PartS_3198,sigPartS_3197,pkSess_3189) <> true) then
                                    0
                                else
                                    {3486}event endCli(Sess,Cli,PartS_3198)
            )
            else
                {3487}let skCli_3199: bitstring = fail-any in
                {3488}let pkCli_3200: bitstring = pub(skCli_3199) in
                {3489}let v_3201: bool = (Disco = A) in
                (
                    {3490}if v_3201 then
                    (
                        {3491}let pkDisco_3202: bitstring = pub(skA) in
                        {3492}let v_3203: bool = (Sess = A) in
                        (
                            {3493}if v_3203 then
                            (
                                {3494}let pkSess_3204: bitstring = pub(skA) in
                                {3495}out(c, GetEndpointRequest);
                                {3496}in(c, (SPs_3205: bitstring,=SignAndEncrypt,UP_3206: bitstring,=pkSess_3204));
                                {3497}new SPc_3207: bitstring;
                                {3498}new Nc_3208: bitstring;
                                {3499}let gNc_3209: bitstring = exp(g,Nc_3208) in
                                {3500}let m1_3210: bitstring = (SPc_3207,gNc_3209) in
                                {3501}out(c, (pkCli_3200,enc(m1_3210,pkSess_3204),sign(m1_3210,skCli_3199)));
                                {3502}event beginCli(Cli,Sess,gNc_3209);
                                {3503}in(c, (ePartS_3211: bitstring,sigPartS_3212: bitstring));
                                {3504}let PartS_3213: bitstring = dec(ePartS_3211,skCli_3199) in
                                {3505}if (verify(PartS_3213,sigPartS_3212,pkSess_3204) <> true) then
                                    0
                                else
                                    {3506}event endCli(Sess,Cli,PartS_3213)
                            )
                            else
                                {3507}let v_3214: bool = (Sess = B) in
                                (
                                    {3508}if v_3214 then
                                    (
                                        {3509}let pkSess_3215: bitstring = pub(skB) in
                                        {3510}out(c, GetEndpointRequest);
                                        {3511}in(c, (SPs_3216: bitstring,=SignAndEncrypt,UP_3217: bitstring,=pkSess_3215));
                                        {3512}new SPc_3218: bitstring;
                                        {3513}new Nc_3219: bitstring;
                                        {3514}let gNc_3220: bitstring = exp(g,Nc_3219) in
                                        {3515}let m1_3221: bitstring = (SPc_3218,gNc_3220) in
                                        {3516}out(c, (pkCli_3200,enc(m1_3221,pkSess_3215),sign(m1_3221,skCli_3199)));
                                        {3517}event beginCli(Cli,Sess,gNc_3220);
                                        {3518}in(c, (ePartS_3222: bitstring,sigPartS_3223: bitstring));
                                        {3519}let PartS_3224: bitstring = dec(ePartS_3222,skCli_3199) in
                                        {3520}if (verify(PartS_3224,sigPartS_3223,pkSess_3215) <> true) then
                                            0
                                        else
                                            {3521}event endCli(Sess,Cli,PartS_3224)
                                    )
                                    else
                                        {3522}let v_3225: bool = (Sess = C) in
                                        (
                                            {3523}if v_3225 then
                                            (
                                                {3524}let pkSess_3226: bitstring = pub(skC) in
                                                {3525}out(c, GetEndpointRequest);
                                                {3526}in(c, (SPs_3227: bitstring,=SignAndEncrypt,UP_3228: bitstring,=pkSess_3226));
                                                {3527}new SPc_3229: bitstring;
                                                {3528}new Nc_3230: bitstring;
                                                {3529}let gNc_3231: bitstring = exp(g,Nc_3230) in
                                                {3530}let m1_3232: bitstring = (SPc_3229,gNc_3231) in
                                                {3531}out(c, (pkCli_3200,enc(m1_3232,pkSess_3226),sign(m1_3232,skCli_3199)));
                                                {3532}event beginCli(Cli,Sess,gNc_3231);
                                                {3533}in(c, (ePartS_3233: bitstring,sigPartS_3234: bitstring));
                                                {3534}let PartS_3235: bitstring = dec(ePartS_3233,skCli_3199) in
                                                {3535}if (verify(PartS_3235,sigPartS_3234,pkSess_3226) <> true) then
                                                    0
                                                else
                                                    {3536}event endCli(Sess,Cli,PartS_3235)
                                            )
                                            else
                                                {3537}let pkSess_3236: bitstring = pub(skI) in
                                                {3538}out(c, GetEndpointRequest);
                                                {3539}in(c, (SPs_3237: bitstring,=SignAndEncrypt,UP_3238: bitstring,=pkSess_3236));
                                                {3540}new SPc_3239: bitstring;
                                                {3541}new Nc_3240: bitstring;
                                                {3542}let gNc_3241: bitstring = exp(g,Nc_3240) in
                                                {3543}let m1_3242: bitstring = (SPc_3239,gNc_3241) in
                                                {3544}out(c, (pkCli_3200,enc(m1_3242,pkSess_3236),sign(m1_3242,skCli_3199)));
                                                {3545}event beginCli(Cli,Sess,gNc_3241);
                                                {3546}in(c, (ePartS_3243: bitstring,sigPartS_3244: bitstring));
                                                {3547}let PartS_3245: bitstring = dec(ePartS_3243,skCli_3199) in
                                                {3548}if (verify(PartS_3245,sigPartS_3244,pkSess_3236) <> true) then
                                                    0
                                                else
                                                    {3549}event endCli(Sess,Cli,PartS_3245)
                                        )
                                        else
                                            {3550}let pkSess_3246: bitstring = fail-any in
                                            {3551}out(c, GetEndpointRequest);
                                            {3552}in(c, (SPs_3247: bitstring,=SignAndEncrypt,UP_3248: bitstring,=pkSess_3246));
                                            {3553}new SPc_3249: bitstring;
                                            {3554}new Nc_3250: bitstring;
                                            {3555}let gNc_3251: bitstring = exp(g,Nc_3250) in
                                            {3556}let m1_3252: bitstring = (SPc_3249,gNc_3251) in
                                            {3557}out(c, (pkCli_3200,enc(m1_3252,pkSess_3246),sign(m1_3252,skCli_3199)));
                                            {3558}event beginCli(Cli,Sess,gNc_3251);
                                            {3559}in(c, (ePartS_3253: bitstring,sigPartS_3254: bitstring));
                                            {3560}let PartS_3255: bitstring = dec(ePartS_3253,skCli_3199) in
                                            {3561}if (verify(PartS_3255,sigPartS_3254,pkSess_3246) <> true) then
                                                0
                                            else
                                                {3562}event endCli(Sess,Cli,PartS_3255)
                                )
                                else
                                    {3563}let pkSess_3256: bitstring = fail-any in
                                    {3564}out(c, GetEndpointRequest);
                                    {3565}in(c, (SPs_3257: bitstring,=SignAndEncrypt,UP_3258: bitstring,=pkSess_3256));
                                    {3566}new SPc_3259: bitstring;
                                    {3567}new Nc_3260: bitstring;
                                    {3568}let gNc_3261: bitstring = exp(g,Nc_3260) in
                                    {3569}let m1_3262: bitstring = (SPc_3259,gNc_3261) in
                                    {3570}out(c, (pkCli_3200,enc(m1_3262,pkSess_3256),sign(m1_3262,skCli_3199)));
                                    {3571}event beginCli(Cli,Sess,gNc_3261);
                                    {3572}in(c, (ePartS_3263: bitstring,sigPartS_3264: bitstring));
                                    {3573}let PartS_3265: bitstring = dec(ePartS_3263,skCli_3199) in
                                    {3574}if (verify(PartS_3265,sigPartS_3264,pkSess_3256) <> true) then
                                        0
                                    else
                                        {3575}event endCli(Sess,Cli,PartS_3265)
                        )
                        else
                            {3576}let pkSess_3266: bitstring = fail-any in
                            {3577}out(c, GetEndpointRequest);
                            {3578}in(c, (SPs_3267: bitstring,=SignAndEncrypt,UP_3268: bitstring,=pkSess_3266));
                            {3579}new SPc_3269: bitstring;
                            {3580}new Nc_3270: bitstring;
                            {3581}let gNc_3271: bitstring = exp(g,Nc_3270) in
                            {3582}let m1_3272: bitstring = (SPc_3269,gNc_3271) in
                            {3583}out(c, (pkCli_3200,enc(m1_3272,pkSess_3266),sign(m1_3272,skCli_3199)));
                            {3584}event beginCli(Cli,Sess,gNc_3271);
                            {3585}in(c, (ePartS_3273: bitstring,sigPartS_3274: bitstring));
                            {3586}let PartS_3275: bitstring = dec(ePartS_3273,skCli_3199) in
                            {3587}if (verify(PartS_3275,sigPartS_3274,pkSess_3266) <> true) then
                                0
                            else
                                {3588}event endCli(Sess,Cli,PartS_3275)
                    )
                    else
                        {3589}let v_3276: bool = (Disco = B) in
                        (
                            {3590}if v_3276 then
                            (
                                {3591}let pkDisco_3277: bitstring = pub(skB) in
                                {3592}let v_3278: bool = (Sess = A) in
                                (
                                    {3593}if v_3278 then
                                    (
                                        {3594}let pkSess_3279: bitstring = pub(skA) in
                                        {3595}out(c, GetEndpointRequest);
                                        {3596}in(c, (SPs_3280: bitstring,=SignAndEncrypt,UP_3281: bitstring,=pkSess_3279));
                                        {3597}new SPc_3282: bitstring;
                                        {3598}new Nc_3283: bitstring;
                                        {3599}let gNc_3284: bitstring = exp(g,Nc_3283) in
                                        {3600}let m1_3285: bitstring = (SPc_3282,gNc_3284) in
                                        {3601}out(c, (pkCli_3200,enc(m1_3285,pkSess_3279),sign(m1_3285,skCli_3199)));
                                        {3602}event beginCli(Cli,Sess,gNc_3284);
                                        {3603}in(c, (ePartS_3286: bitstring,sigPartS_3287: bitstring));
                                        {3604}let PartS_3288: bitstring = dec(ePartS_3286,skCli_3199) in
                                        {3605}if (verify(PartS_3288,sigPartS_3287,pkSess_3279) <> true) then
                                            0
                                        else
                                            {3606}event endCli(Sess,Cli,PartS_3288)
                                    )
                                    else
                                        {3607}let v_3289: bool = (Sess = B) in
                                        (
                                            {3608}if v_3289 then
                                            (
                                                {3609}let pkSess_3290: bitstring = pub(skB) in
                                                {3610}out(c, GetEndpointRequest);
                                                {3611}in(c, (SPs_3291: bitstring,=SignAndEncrypt,UP_3292: bitstring,=pkSess_3290));
                                                {3612}new SPc_3293: bitstring;
                                                {3613}new Nc_3294: bitstring;
                                                {3614}let gNc_3295: bitstring = exp(g,Nc_3294) in
                                                {3615}let m1_3296: bitstring = (SPc_3293,gNc_3295) in
                                                {3616}out(c, (pkCli_3200,enc(m1_3296,pkSess_3290),sign(m1_3296,skCli_3199)));
                                                {3617}event beginCli(Cli,Sess,gNc_3295);
                                                {3618}in(c, (ePartS_3297: bitstring,sigPartS_3298: bitstring));
                                                {3619}let PartS_3299: bitstring = dec(ePartS_3297,skCli_3199) in
                                                {3620}if (verify(PartS_3299,sigPartS_3298,pkSess_3290) <> true) then
                                                    0
                                                else
                                                    {3621}event endCli(Sess,Cli,PartS_3299)
                                            )
                                            else
                                                {3622}let v_3300: bool = (Sess = C) in
                                                (
                                                    {3623}if v_3300 then
                                                    (
                                                        {3624}let pkSess_3301: bitstring = pub(skC) in
                                                        {3625}out(c, GetEndpointRequest);
                                                        {3626}in(c, (SPs_3302: bitstring,=SignAndEncrypt,UP_3303: bitstring,=pkSess_3301));
                                                        {3627}new SPc_3304: bitstring;
                                                        {3628}new Nc_3305: bitstring;
                                                        {3629}let gNc_3306: bitstring = exp(g,Nc_3305) in
                                                        {3630}let m1_3307: bitstring = (SPc_3304,gNc_3306) in
                                                        {3631}out(c, (pkCli_3200,enc(m1_3307,pkSess_3301),sign(m1_3307,skCli_3199)));
                                                        {3632}event beginCli(Cli,Sess,gNc_3306);
                                                        {3633}in(c, (ePartS_3308: bitstring,sigPartS_3309: bitstring));
                                                        {3634}let PartS_3310: bitstring = dec(ePartS_3308,skCli_3199) in
                                                        {3635}if (verify(PartS_3310,sigPartS_3309,pkSess_3301) <> true) then
                                                            0
                                                        else
                                                            {3636}event endCli(Sess,Cli,PartS_3310)
                                                    )
                                                    else
                                                        {3637}let pkSess_3311: bitstring = pub(skI) in
                                                        {3638}out(c, GetEndpointRequest);
                                                        {3639}in(c, (SPs_3312: bitstring,=SignAndEncrypt,UP_3313: bitstring,=pkSess_3311));
                                                        {3640}new SPc_3314: bitstring;
                                                        {3641}new Nc_3315: bitstring;
                                                        {3642}let gNc_3316: bitstring = exp(g,Nc_3315) in
                                                        {3643}let m1_3317: bitstring = (SPc_3314,gNc_3316) in
                                                        {3644}out(c, (pkCli_3200,enc(m1_3317,pkSess_3311),sign(m1_3317,skCli_3199)));
                                                        {3645}event beginCli(Cli,Sess,gNc_3316);
                                                        {3646}in(c, (ePartS_3318: bitstring,sigPartS_3319: bitstring));
                                                        {3647}let PartS_3320: bitstring = dec(ePartS_3318,skCli_3199) in
                                                        {3648}if (verify(PartS_3320,sigPartS_3319,pkSess_3311) <> true) then
                                                            0
                                                        else
                                                            {3649}event endCli(Sess,Cli,PartS_3320)
                                                )
                                                else
                                                    {3650}let pkSess_3321: bitstring = fail-any in
                                                    {3651}out(c, GetEndpointRequest);
                                                    {3652}in(c, (SPs_3322: bitstring,=SignAndEncrypt,UP_3323: bitstring,=pkSess_3321));
                                                    {3653}new SPc_3324: bitstring;
                                                    {3654}new Nc_3325: bitstring;
                                                    {3655}let gNc_3326: bitstring = exp(g,Nc_3325) in
                                                    {3656}let m1_3327: bitstring = (SPc_3324,gNc_3326) in
                                                    {3657}out(c, (pkCli_3200,enc(m1_3327,pkSess_3321),sign(m1_3327,skCli_3199)));
                                                    {3658}event beginCli(Cli,Sess,gNc_3326);
                                                    {3659}in(c, (ePartS_3328: bitstring,sigPartS_3329: bitstring));
                                                    {3660}let PartS_3330: bitstring = dec(ePartS_3328,skCli_3199) in
                                                    {3661}if (verify(PartS_3330,sigPartS_3329,pkSess_3321) <> true) then
                                                        0
                                                    else
                                                        {3662}event endCli(Sess,Cli,PartS_3330)
                                        )
                                        else
                                            {3663}let pkSess_3331: bitstring = fail-any in
                                            {3664}out(c, GetEndpointRequest);
                                            {3665}in(c, (SPs_3332: bitstring,=SignAndEncrypt,UP_3333: bitstring,=pkSess_3331));
                                            {3666}new SPc_3334: bitstring;
                                            {3667}new Nc_3335: bitstring;
                                            {3668}let gNc_3336: bitstring = exp(g,Nc_3335) in
                                            {3669}let m1_3337: bitstring = (SPc_3334,gNc_3336) in
                                            {3670}out(c, (pkCli_3200,enc(m1_3337,pkSess_3331),sign(m1_3337,skCli_3199)));
                                            {3671}event beginCli(Cli,Sess,gNc_3336);
                                            {3672}in(c, (ePartS_3338: bitstring,sigPartS_3339: bitstring));
                                            {3673}let PartS_3340: bitstring = dec(ePartS_3338,skCli_3199) in
                                            {3674}if (verify(PartS_3340,sigPartS_3339,pkSess_3331) <> true) then
                                                0
                                            else
                                                {3675}event endCli(Sess,Cli,PartS_3340)
                                )
                                else
                                    {3676}let pkSess_3341: bitstring = fail-any in
                                    {3677}out(c, GetEndpointRequest);
                                    {3678}in(c, (SPs_3342: bitstring,=SignAndEncrypt,UP_3343: bitstring,=pkSess_3341));
                                    {3679}new SPc_3344: bitstring;
                                    {3680}new Nc_3345: bitstring;
                                    {3681}let gNc_3346: bitstring = exp(g,Nc_3345) in
                                    {3682}let m1_3347: bitstring = (SPc_3344,gNc_3346) in
                                    {3683}out(c, (pkCli_3200,enc(m1_3347,pkSess_3341),sign(m1_3347,skCli_3199)));
                                    {3684}event beginCli(Cli,Sess,gNc_3346);
                                    {3685}in(c, (ePartS_3348: bitstring,sigPartS_3349: bitstring));
                                    {3686}let PartS_3350: bitstring = dec(ePartS_3348,skCli_3199) in
                                    {3687}if (verify(PartS_3350,sigPartS_3349,pkSess_3341) <> true) then
                                        0
                                    else
                                        {3688}event endCli(Sess,Cli,PartS_3350)
                            )
                            else
                                {3689}let v_3351: bool = (Disco = C) in
                                (
                                    {3690}if v_3351 then
                                    (
                                        {3691}let pkDisco_3352: bitstring = pub(skC) in
                                        {3692}let v_3353: bool = (Sess = A) in
                                        (
                                            {3693}if v_3353 then
                                            (
                                                {3694}let pkSess_3354: bitstring = pub(skA) in
                                                {3695}out(c, GetEndpointRequest);
                                                {3696}in(c, (SPs_3355: bitstring,=SignAndEncrypt,UP_3356: bitstring,=pkSess_3354));
                                                {3697}new SPc_3357: bitstring;
                                                {3698}new Nc_3358: bitstring;
                                                {3699}let gNc_3359: bitstring = exp(g,Nc_3358) in
                                                {3700}let m1_3360: bitstring = (SPc_3357,gNc_3359) in
                                                {3701}out(c, (pkCli_3200,enc(m1_3360,pkSess_3354),sign(m1_3360,skCli_3199)));
                                                {3702}event beginCli(Cli,Sess,gNc_3359);
                                                {3703}in(c, (ePartS_3361: bitstring,sigPartS_3362: bitstring));
                                                {3704}let PartS_3363: bitstring = dec(ePartS_3361,skCli_3199) in
                                                {3705}if (verify(PartS_3363,sigPartS_3362,pkSess_3354) <> true) then
                                                    0
                                                else
                                                    {3706}event endCli(Sess,Cli,PartS_3363)
                                            )
                                            else
                                                {3707}let v_3364: bool = (Sess = B) in
                                                (
                                                    {3708}if v_3364 then
                                                    (
                                                        {3709}let pkSess_3365: bitstring = pub(skB) in
                                                        {3710}out(c, GetEndpointRequest);
                                                        {3711}in(c, (SPs_3366: bitstring,=SignAndEncrypt,UP_3367: bitstring,=pkSess_3365));
                                                        {3712}new SPc_3368: bitstring;
                                                        {3713}new Nc_3369: bitstring;
                                                        {3714}let gNc_3370: bitstring = exp(g,Nc_3369) in
                                                        {3715}let m1_3371: bitstring = (SPc_3368,gNc_3370) in
                                                        {3716}out(c, (pkCli_3200,enc(m1_3371,pkSess_3365),sign(m1_3371,skCli_3199)));
                                                        {3717}event beginCli(Cli,Sess,gNc_3370);
                                                        {3718}in(c, (ePartS_3372: bitstring,sigPartS_3373: bitstring));
                                                        {3719}let PartS_3374: bitstring = dec(ePartS_3372,skCli_3199) in
                                                        {3720}if (verify(PartS_3374,sigPartS_3373,pkSess_3365) <> true) then
                                                            0
                                                        else
                                                            {3721}event endCli(Sess,Cli,PartS_3374)
                                                    )
                                                    else
                                                        {3722}let v_3375: bool = (Sess = C) in
                                                        (
                                                            {3723}if v_3375 then
                                                            (
                                                                {3724}let pkSess_3376: bitstring = pub(skC) in
                                                                {3725}out(c, GetEndpointRequest);
                                                                {3726}in(c, (SPs_3377: bitstring,=SignAndEncrypt,UP_3378: bitstring,=pkSess_3376));
                                                                {3727}new SPc_3379: bitstring;
                                                                {3728}new Nc_3380: bitstring;
                                                                {3729}let gNc_3381: bitstring = exp(g,Nc_3380) in
                                                                {3730}let m1_3382: bitstring = (SPc_3379,gNc_3381) in
                                                                {3731}out(c, (pkCli_3200,enc(m1_3382,pkSess_3376),sign(m1_3382,skCli_3199)));
                                                                {3732}event beginCli(Cli,Sess,gNc_3381);
                                                                {3733}in(c, (ePartS_3383: bitstring,sigPartS_3384: bitstring));
                                                                {3734}let PartS_3385: bitstring = dec(ePartS_3383,skCli_3199) in
                                                                {3735}if (verify(PartS_3385,sigPartS_3384,pkSess_3376) <> true) then
                                                                    0
                                                                else
                                                                    {3736}event endCli(Sess,Cli,PartS_3385)
                                                            )
                                                            else
                                                                {3737}let pkSess_3386: bitstring = pub(skI) in
                                                                {3738}out(c, GetEndpointRequest);
                                                                {3739}in(c, (SPs_3387: bitstring,=SignAndEncrypt,UP_3388: bitstring,=pkSess_3386));
                                                                {3740}new SPc_3389: bitstring;
                                                                {3741}new Nc_3390: bitstring;
                                                                {3742}let gNc_3391: bitstring = exp(g,Nc_3390) in
                                                                {3743}let m1_3392: bitstring = (SPc_3389,gNc_3391) in
                                                                {3744}out(c, (pkCli_3200,enc(m1_3392,pkSess_3386),sign(m1_3392,skCli_3199)));
                                                                {3745}event beginCli(Cli,Sess,gNc_3391);
                                                                {3746}in(c, (ePartS_3393: bitstring,sigPartS_3394: bitstring));
                                                                {3747}let PartS_3395: bitstring = dec(ePartS_3393,skCli_3199) in
                                                                {3748}if (verify(PartS_3395,sigPartS_3394,pkSess_3386) <> true) then
                                                                    0
                                                                else
                                                                    {3749}event endCli(Sess,Cli,PartS_3395)
                                                        )
                                                        else
                                                            {3750}let pkSess_3396: bitstring = fail-any in
                                                            {3751}out(c, GetEndpointRequest);
                                                            {3752}in(c, (SPs_3397: bitstring,=SignAndEncrypt,UP_3398: bitstring,=pkSess_3396));
                                                            {3753}new SPc_3399: bitstring;
                                                            {3754}new Nc_3400: bitstring;
                                                            {3755}let gNc_3401: bitstring = exp(g,Nc_3400) in
                                                            {3756}let m1_3402: bitstring = (SPc_3399,gNc_3401) in
                                                            {3757}out(c, (pkCli_3200,enc(m1_3402,pkSess_3396),sign(m1_3402,skCli_3199)));
                                                            {3758}event beginCli(Cli,Sess,gNc_3401);
                                                            {3759}in(c, (ePartS_3403: bitstring,sigPartS_3404: bitstring));
                                                            {3760}let PartS_3405: bitstring = dec(ePartS_3403,skCli_3199) in
                                                            {3761}if (verify(PartS_3405,sigPartS_3404,pkSess_3396) <> true) then
                                                                0
                                                            else
                                                                {3762}event endCli(Sess,Cli,PartS_3405)
                                                )
                                                else
                                                    {3763}let pkSess_3406: bitstring = fail-any in
                                                    {3764}out(c, GetEndpointRequest);
                                                    {3765}in(c, (SPs_3407: bitstring,=SignAndEncrypt,UP_3408: bitstring,=pkSess_3406));
                                                    {3766}new SPc_3409: bitstring;
                                                    {3767}new Nc_3410: bitstring;
                                                    {3768}let gNc_3411: bitstring = exp(g,Nc_3410) in
                                                    {3769}let m1_3412: bitstring = (SPc_3409,gNc_3411) in
                                                    {3770}out(c, (pkCli_3200,enc(m1_3412,pkSess_3406),sign(m1_3412,skCli_3199)));
                                                    {3771}event beginCli(Cli,Sess,gNc_3411);
                                                    {3772}in(c, (ePartS_3413: bitstring,sigPartS_3414: bitstring));
                                                    {3773}let PartS_3415: bitstring = dec(ePartS_3413,skCli_3199) in
                                                    {3774}if (verify(PartS_3415,sigPartS_3414,pkSess_3406) <> true) then
                                                        0
                                                    else
                                                        {3775}event endCli(Sess,Cli,PartS_3415)
                                        )
                                        else
                                            {3776}let pkSess_3416: bitstring = fail-any in
                                            {3777}out(c, GetEndpointRequest);
                                            {3778}in(c, (SPs_3417: bitstring,=SignAndEncrypt,UP_3418: bitstring,=pkSess_3416));
                                            {3779}new SPc_3419: bitstring;
                                            {3780}new Nc_3420: bitstring;
                                            {3781}let gNc_3421: bitstring = exp(g,Nc_3420) in
                                            {3782}let m1_3422: bitstring = (SPc_3419,gNc_3421) in
                                            {3783}out(c, (pkCli_3200,enc(m1_3422,pkSess_3416),sign(m1_3422,skCli_3199)));
                                            {3784}event beginCli(Cli,Sess,gNc_3421);
                                            {3785}in(c, (ePartS_3423: bitstring,sigPartS_3424: bitstring));
                                            {3786}let PartS_3425: bitstring = dec(ePartS_3423,skCli_3199) in
                                            {3787}if (verify(PartS_3425,sigPartS_3424,pkSess_3416) <> true) then
                                                0
                                            else
                                                {3788}event endCli(Sess,Cli,PartS_3425)
                                    )
                                    else
                                        {3789}let pkDisco_3426: bitstring = pub(skI) in
                                        {3790}let v_3427: bool = (Sess = A) in
                                        (
                                            {3791}if v_3427 then
                                            (
                                                {3792}let pkSess_3428: bitstring = pub(skA) in
                                                {3793}out(c, GetEndpointRequest);
                                                {3794}in(c, (SPs_3429: bitstring,=SignAndEncrypt,UP_3430: bitstring,=pkSess_3428));
                                                {3795}new SPc_3431: bitstring;
                                                {3796}new Nc_3432: bitstring;
                                                {3797}let gNc_3433: bitstring = exp(g,Nc_3432) in
                                                {3798}let m1_3434: bitstring = (SPc_3431,gNc_3433) in
                                                {3799}out(c, (pkCli_3200,enc(m1_3434,pkSess_3428),sign(m1_3434,skCli_3199)));
                                                {3800}event beginCli(Cli,Sess,gNc_3433);
                                                {3801}in(c, (ePartS_3435: bitstring,sigPartS_3436: bitstring));
                                                {3802}let PartS_3437: bitstring = dec(ePartS_3435,skCli_3199) in
                                                {3803}if (verify(PartS_3437,sigPartS_3436,pkSess_3428) <> true) then
                                                    0
                                                else
                                                    {3804}event endCli(Sess,Cli,PartS_3437)
                                            )
                                            else
                                                {3805}let v_3438: bool = (Sess = B) in
                                                (
                                                    {3806}if v_3438 then
                                                    (
                                                        {3807}let pkSess_3439: bitstring = pub(skB) in
                                                        {3808}out(c, GetEndpointRequest);
                                                        {3809}in(c, (SPs_3440: bitstring,=SignAndEncrypt,UP_3441: bitstring,=pkSess_3439));
                                                        {3810}new SPc_3442: bitstring;
                                                        {3811}new Nc_3443: bitstring;
                                                        {3812}let gNc_3444: bitstring = exp(g,Nc_3443) in
                                                        {3813}let m1_3445: bitstring = (SPc_3442,gNc_3444) in
                                                        {3814}out(c, (pkCli_3200,enc(m1_3445,pkSess_3439),sign(m1_3445,skCli_3199)));
                                                        {3815}event beginCli(Cli,Sess,gNc_3444);
                                                        {3816}in(c, (ePartS_3446: bitstring,sigPartS_3447: bitstring));
                                                        {3817}let PartS_3448: bitstring = dec(ePartS_3446,skCli_3199) in
                                                        {3818}if (verify(PartS_3448,sigPartS_3447,pkSess_3439) <> true) then
                                                            0
                                                        else
                                                            {3819}event endCli(Sess,Cli,PartS_3448)
                                                    )
                                                    else
                                                        {3820}let v_3449: bool = (Sess = C) in
                                                        (
                                                            {3821}if v_3449 then
                                                            (
                                                                {3822}let pkSess_3450: bitstring = pub(skC) in
                                                                {3823}out(c, GetEndpointRequest);
                                                                {3824}in(c, (SPs_3451: bitstring,=SignAndEncrypt,UP_3452: bitstring,=pkSess_3450));
                                                                {3825}new SPc_3453: bitstring;
                                                                {3826}new Nc_3454: bitstring;
                                                                {3827}let gNc_3455: bitstring = exp(g,Nc_3454) in
                                                                {3828}let m1_3456: bitstring = (SPc_3453,gNc_3455) in
                                                                {3829}out(c, (pkCli_3200,enc(m1_3456,pkSess_3450),sign(m1_3456,skCli_3199)));
                                                                {3830}event beginCli(Cli,Sess,gNc_3455);
                                                                {3831}in(c, (ePartS_3457: bitstring,sigPartS_3458: bitstring));
                                                                {3832}let PartS_3459: bitstring = dec(ePartS_3457,skCli_3199) in
                                                                {3833}if (verify(PartS_3459,sigPartS_3458,pkSess_3450) <> true) then
                                                                    0
                                                                else
                                                                    {3834}event endCli(Sess,Cli,PartS_3459)
                                                            )
                                                            else
                                                                {3835}let pkSess_3460: bitstring = pub(skI) in
                                                                {3836}out(c, GetEndpointRequest);
                                                                {3837}in(c, (SPs_3461: bitstring,=SignAndEncrypt,UP_3462: bitstring,=pkSess_3460));
                                                                {3838}new SPc_3463: bitstring;
                                                                {3839}new Nc_3464: bitstring;
                                                                {3840}let gNc_3465: bitstring = exp(g,Nc_3464) in
                                                                {3841}let m1_3466: bitstring = (SPc_3463,gNc_3465) in
                                                                {3842}out(c, (pkCli_3200,enc(m1_3466,pkSess_3460),sign(m1_3466,skCli_3199)));
                                                                {3843}event beginCli(Cli,Sess,gNc_3465);
                                                                {3844}in(c, (ePartS_3467: bitstring,sigPartS_3468: bitstring));
                                                                {3845}let PartS_3469: bitstring = dec(ePartS_3467,skCli_3199) in
                                                                {3846}if (verify(PartS_3469,sigPartS_3468,pkSess_3460) <> true) then
                                                                    0
                                                                else
                                                                    {3847}event endCli(Sess,Cli,PartS_3469)
                                                        )
                                                        else
                                                            {3848}let pkSess_3470: bitstring = fail-any in
                                                            {3849}out(c, GetEndpointRequest);
                                                            {3850}in(c, (SPs_3471: bitstring,=SignAndEncrypt,UP_3472: bitstring,=pkSess_3470));
                                                            {3851}new SPc_3473: bitstring;
                                                            {3852}new Nc_3474: bitstring;
                                                            {3853}let gNc_3475: bitstring = exp(g,Nc_3474) in
                                                            {3854}let m1_3476: bitstring = (SPc_3473,gNc_3475) in
                                                            {3855}out(c, (pkCli_3200,enc(m1_3476,pkSess_3470),sign(m1_3476,skCli_3199)));
                                                            {3856}event beginCli(Cli,Sess,gNc_3475);
                                                            {3857}in(c, (ePartS_3477: bitstring,sigPartS_3478: bitstring));
                                                            {3858}let PartS_3479: bitstring = dec(ePartS_3477,skCli_3199) in
                                                            {3859}if (verify(PartS_3479,sigPartS_3478,pkSess_3470) <> true) then
                                                                0
                                                            else
                                                                {3860}event endCli(Sess,Cli,PartS_3479)
                                                )
                                                else
                                                    {3861}let pkSess_3480: bitstring = fail-any in
                                                    {3862}out(c, GetEndpointRequest);
                                                    {3863}in(c, (SPs_3481: bitstring,=SignAndEncrypt,UP_3482: bitstring,=pkSess_3480));
                                                    {3864}new SPc_3483: bitstring;
                                                    {3865}new Nc_3484: bitstring;
                                                    {3866}let gNc_3485: bitstring = exp(g,Nc_3484) in
                                                    {3867}let m1_3486: bitstring = (SPc_3483,gNc_3485) in
                                                    {3868}out(c, (pkCli_3200,enc(m1_3486,pkSess_3480),sign(m1_3486,skCli_3199)));
                                                    {3869}event beginCli(Cli,Sess,gNc_3485);
                                                    {3870}in(c, (ePartS_3487: bitstring,sigPartS_3488: bitstring));
                                                    {3871}let PartS_3489: bitstring = dec(ePartS_3487,skCli_3199) in
                                                    {3872}if (verify(PartS_3489,sigPartS_3488,pkSess_3480) <> true) then
                                                        0
                                                    else
                                                        {3873}event endCli(Sess,Cli,PartS_3489)
                                        )
                                        else
                                            {3874}let pkSess_3490: bitstring = fail-any in
                                            {3875}out(c, GetEndpointRequest);
                                            {3876}in(c, (SPs_3491: bitstring,=SignAndEncrypt,UP_3492: bitstring,=pkSess_3490));
                                            {3877}new SPc_3493: bitstring;
                                            {3878}new Nc_3494: bitstring;
                                            {3879}let gNc_3495: bitstring = exp(g,Nc_3494) in
                                            {3880}let m1_3496: bitstring = (SPc_3493,gNc_3495) in
                                            {3881}out(c, (pkCli_3200,enc(m1_3496,pkSess_3490),sign(m1_3496,skCli_3199)));
                                            {3882}event beginCli(Cli,Sess,gNc_3495);
                                            {3883}in(c, (ePartS_3497: bitstring,sigPartS_3498: bitstring));
                                            {3884}let PartS_3499: bitstring = dec(ePartS_3497,skCli_3199) in
                                            {3885}if (verify(PartS_3499,sigPartS_3498,pkSess_3490) <> true) then
                                                0
                                            else
                                                {3886}event endCli(Sess,Cli,PartS_3499)
                                )
                                else
                                    {3887}let pkDisco_3500: bitstring = fail-any in
                                    {3888}let v_3501: bool = (Sess = A) in
                                    (
                                        {3889}if v_3501 then
                                        (
                                            {3890}let pkSess_3502: bitstring = pub(skA) in
                                            {3891}out(c, GetEndpointRequest);
                                            {3892}in(c, (SPs_3503: bitstring,=SignAndEncrypt,UP_3504: bitstring,=pkSess_3502));
                                            {3893}new SPc_3505: bitstring;
                                            {3894}new Nc_3506: bitstring;
                                            {3895}let gNc_3507: bitstring = exp(g,Nc_3506) in
                                            {3896}let m1_3508: bitstring = (SPc_3505,gNc_3507) in
                                            {3897}out(c, (pkCli_3200,enc(m1_3508,pkSess_3502),sign(m1_3508,skCli_3199)));
                                            {3898}event beginCli(Cli,Sess,gNc_3507);
                                            {3899}in(c, (ePartS_3509: bitstring,sigPartS_3510: bitstring));
                                            {3900}let PartS_3511: bitstring = dec(ePartS_3509,skCli_3199) in
                                            {3901}if (verify(PartS_3511,sigPartS_3510,pkSess_3502) <> true) then
                                                0
                                            else
                                                {3902}event endCli(Sess,Cli,PartS_3511)
                                        )
                                        else
                                            {3903}let v_3512: bool = (Sess = B) in
                                            (
                                                {3904}if v_3512 then
                                                (
                                                    {3905}let pkSess_3513: bitstring = pub(skB) in
                                                    {3906}out(c, GetEndpointRequest);
                                                    {3907}in(c, (SPs_3514: bitstring,=SignAndEncrypt,UP_3515: bitstring,=pkSess_3513));
                                                    {3908}new SPc_3516: bitstring;
                                                    {3909}new Nc_3517: bitstring;
                                                    {3910}let gNc_3518: bitstring = exp(g,Nc_3517) in
                                                    {3911}let m1_3519: bitstring = (SPc_3516,gNc_3518) in
                                                    {3912}out(c, (pkCli_3200,enc(m1_3519,pkSess_3513),sign(m1_3519,skCli_3199)));
                                                    {3913}event beginCli(Cli,Sess,gNc_3518);
                                                    {3914}in(c, (ePartS_3520: bitstring,sigPartS_3521: bitstring));
                                                    {3915}let PartS_3522: bitstring = dec(ePartS_3520,skCli_3199) in
                                                    {3916}if (verify(PartS_3522,sigPartS_3521,pkSess_3513) <> true) then
                                                        0
                                                    else
                                                        {3917}event endCli(Sess,Cli,PartS_3522)
                                                )
                                                else
                                                    {3918}let v_3523: bool = (Sess = C) in
                                                    (
                                                        {3919}if v_3523 then
                                                        (
                                                            {3920}let pkSess_3524: bitstring = pub(skC) in
                                                            {3921}out(c, GetEndpointRequest);
                                                            {3922}in(c, (SPs_3525: bitstring,=SignAndEncrypt,UP_3526: bitstring,=pkSess_3524));
                                                            {3923}new SPc_3527: bitstring;
                                                            {3924}new Nc_3528: bitstring;
                                                            {3925}let gNc_3529: bitstring = exp(g,Nc_3528) in
                                                            {3926}let m1_3530: bitstring = (SPc_3527,gNc_3529) in
                                                            {3927}out(c, (pkCli_3200,enc(m1_3530,pkSess_3524),sign(m1_3530,skCli_3199)));
                                                            {3928}event beginCli(Cli,Sess,gNc_3529);
                                                            {3929}in(c, (ePartS_3531: bitstring,sigPartS_3532: bitstring));
                                                            {3930}let PartS_3533: bitstring = dec(ePartS_3531,skCli_3199) in
                                                            {3931}if (verify(PartS_3533,sigPartS_3532,pkSess_3524) <> true) then
                                                                0
                                                            else
                                                                {3932}event endCli(Sess,Cli,PartS_3533)
                                                        )
                                                        else
                                                            {3933}let pkSess_3534: bitstring = pub(skI) in
                                                            {3934}out(c, GetEndpointRequest);
                                                            {3935}in(c, (SPs_3535: bitstring,=SignAndEncrypt,UP_3536: bitstring,=pkSess_3534));
                                                            {3936}new SPc_3537: bitstring;
                                                            {3937}new Nc_3538: bitstring;
                                                            {3938}let gNc_3539: bitstring = exp(g,Nc_3538) in
                                                            {3939}let m1_3540: bitstring = (SPc_3537,gNc_3539) in
                                                            {3940}out(c, (pkCli_3200,enc(m1_3540,pkSess_3534),sign(m1_3540,skCli_3199)));
                                                            {3941}event beginCli(Cli,Sess,gNc_3539);
                                                            {3942}in(c, (ePartS_3541: bitstring,sigPartS_3542: bitstring));
                                                            {3943}let PartS_3543: bitstring = dec(ePartS_3541,skCli_3199) in
                                                            {3944}if (verify(PartS_3543,sigPartS_3542,pkSess_3534) <> true) then
                                                                0
                                                            else
                                                                {3945}event endCli(Sess,Cli,PartS_3543)
                                                    )
                                                    else
                                                        {3946}let pkSess_3544: bitstring = fail-any in
                                                        {3947}out(c, GetEndpointRequest);
                                                        {3948}in(c, (SPs_3545: bitstring,=SignAndEncrypt,UP_3546: bitstring,=pkSess_3544));
                                                        {3949}new SPc_3547: bitstring;
                                                        {3950}new Nc_3548: bitstring;
                                                        {3951}let gNc_3549: bitstring = exp(g,Nc_3548) in
                                                        {3952}let m1_3550: bitstring = (SPc_3547,gNc_3549) in
                                                        {3953}out(c, (pkCli_3200,enc(m1_3550,pkSess_3544),sign(m1_3550,skCli_3199)));
                                                        {3954}event beginCli(Cli,Sess,gNc_3549);
                                                        {3955}in(c, (ePartS_3551: bitstring,sigPartS_3552: bitstring));
                                                        {3956}let PartS_3553: bitstring = dec(ePartS_3551,skCli_3199) in
                                                        {3957}if (verify(PartS_3553,sigPartS_3552,pkSess_3544) <> true) then
                                                            0
                                                        else
                                                            {3958}event endCli(Sess,Cli,PartS_3553)
                                            )
                                            else
                                                {3959}let pkSess_3554: bitstring = fail-any in
                                                {3960}out(c, GetEndpointRequest);
                                                {3961}in(c, (SPs_3555: bitstring,=SignAndEncrypt,UP_3556: bitstring,=pkSess_3554));
                                                {3962}new SPc_3557: bitstring;
                                                {3963}new Nc_3558: bitstring;
                                                {3964}let gNc_3559: bitstring = exp(g,Nc_3558) in
                                                {3965}let m1_3560: bitstring = (SPc_3557,gNc_3559) in
                                                {3966}out(c, (pkCli_3200,enc(m1_3560,pkSess_3554),sign(m1_3560,skCli_3199)));
                                                {3967}event beginCli(Cli,Sess,gNc_3559);
                                                {3968}in(c, (ePartS_3561: bitstring,sigPartS_3562: bitstring));
                                                {3969}let PartS_3563: bitstring = dec(ePartS_3561,skCli_3199) in
                                                {3970}if (verify(PartS_3563,sigPartS_3562,pkSess_3554) <> true) then
                                                    0
                                                else
                                                    {3971}event endCli(Sess,Cli,PartS_3563)
                                    )
                                    else
                                        {3972}let pkSess_3564: bitstring = fail-any in
                                        {3973}out(c, GetEndpointRequest);
                                        {3974}in(c, (SPs_3565: bitstring,=SignAndEncrypt,UP_3566: bitstring,=pkSess_3564));
                                        {3975}new SPc_3567: bitstring;
                                        {3976}new Nc_3568: bitstring;
                                        {3977}let gNc_3569: bitstring = exp(g,Nc_3568) in
                                        {3978}let m1_3570: bitstring = (SPc_3567,gNc_3569) in
                                        {3979}out(c, (pkCli_3200,enc(m1_3570,pkSess_3564),sign(m1_3570,skCli_3199)));
                                        {3980}event beginCli(Cli,Sess,gNc_3569);
                                        {3981}in(c, (ePartS_3571: bitstring,sigPartS_3572: bitstring));
                                        {3982}let PartS_3573: bitstring = dec(ePartS_3571,skCli_3199) in
                                        {3983}if (verify(PartS_3573,sigPartS_3572,pkSess_3564) <> true) then
                                            0
                                        else
                                            {3984}event endCli(Sess,Cli,PartS_3573)
                        )
                        else
                            {3985}let pkDisco_3574: bitstring = fail-any in
                            {3986}let v_3575: bool = (Sess = A) in
                            (
                                {3987}if v_3575 then
                                (
                                    {3988}let pkSess_3576: bitstring = pub(skA) in
                                    {3989}out(c, GetEndpointRequest);
                                    {3990}in(c, (SPs_3577: bitstring,=SignAndEncrypt,UP_3578: bitstring,=pkSess_3576));
                                    {3991}new SPc_3579: bitstring;
                                    {3992}new Nc_3580: bitstring;
                                    {3993}let gNc_3581: bitstring = exp(g,Nc_3580) in
                                    {3994}let m1_3582: bitstring = (SPc_3579,gNc_3581) in
                                    {3995}out(c, (pkCli_3200,enc(m1_3582,pkSess_3576),sign(m1_3582,skCli_3199)));
                                    {3996}event beginCli(Cli,Sess,gNc_3581);
                                    {3997}in(c, (ePartS_3583: bitstring,sigPartS_3584: bitstring));
                                    {3998}let PartS_3585: bitstring = dec(ePartS_3583,skCli_3199) in
                                    {3999}if (verify(PartS_3585,sigPartS_3584,pkSess_3576) <> true) then
                                        0
                                    else
                                        {4000}event endCli(Sess,Cli,PartS_3585)
                                )
                                else
                                    {4001}let v_3586: bool = (Sess = B) in
                                    (
                                        {4002}if v_3586 then
                                        (
                                            {4003}let pkSess_3587: bitstring = pub(skB) in
                                            {4004}out(c, GetEndpointRequest);
                                            {4005}in(c, (SPs_3588: bitstring,=SignAndEncrypt,UP_3589: bitstring,=pkSess_3587));
                                            {4006}new SPc_3590: bitstring;
                                            {4007}new Nc_3591: bitstring;
                                            {4008}let gNc_3592: bitstring = exp(g,Nc_3591) in
                                            {4009}let m1_3593: bitstring = (SPc_3590,gNc_3592) in
                                            {4010}out(c, (pkCli_3200,enc(m1_3593,pkSess_3587),sign(m1_3593,skCli_3199)));
                                            {4011}event beginCli(Cli,Sess,gNc_3592);
                                            {4012}in(c, (ePartS_3594: bitstring,sigPartS_3595: bitstring));
                                            {4013}let PartS_3596: bitstring = dec(ePartS_3594,skCli_3199) in
                                            {4014}if (verify(PartS_3596,sigPartS_3595,pkSess_3587) <> true) then
                                                0
                                            else
                                                {4015}event endCli(Sess,Cli,PartS_3596)
                                        )
                                        else
                                            {4016}let v_3597: bool = (Sess = C) in
                                            (
                                                {4017}if v_3597 then
                                                (
                                                    {4018}let pkSess_3598: bitstring = pub(skC) in
                                                    {4019}out(c, GetEndpointRequest);
                                                    {4020}in(c, (SPs_3599: bitstring,=SignAndEncrypt,UP_3600: bitstring,=pkSess_3598));
                                                    {4021}new SPc_3601: bitstring;
                                                    {4022}new Nc_3602: bitstring;
                                                    {4023}let gNc_3603: bitstring = exp(g,Nc_3602) in
                                                    {4024}let m1_3604: bitstring = (SPc_3601,gNc_3603) in
                                                    {4025}out(c, (pkCli_3200,enc(m1_3604,pkSess_3598),sign(m1_3604,skCli_3199)));
                                                    {4026}event beginCli(Cli,Sess,gNc_3603);
                                                    {4027}in(c, (ePartS_3605: bitstring,sigPartS_3606: bitstring));
                                                    {4028}let PartS_3607: bitstring = dec(ePartS_3605,skCli_3199) in
                                                    {4029}if (verify(PartS_3607,sigPartS_3606,pkSess_3598) <> true) then
                                                        0
                                                    else
                                                        {4030}event endCli(Sess,Cli,PartS_3607)
                                                )
                                                else
                                                    {4031}let pkSess_3608: bitstring = pub(skI) in
                                                    {4032}out(c, GetEndpointRequest);
                                                    {4033}in(c, (SPs_3609: bitstring,=SignAndEncrypt,UP_3610: bitstring,=pkSess_3608));
                                                    {4034}new SPc_3611: bitstring;
                                                    {4035}new Nc_3612: bitstring;
                                                    {4036}let gNc_3613: bitstring = exp(g,Nc_3612) in
                                                    {4037}let m1_3614: bitstring = (SPc_3611,gNc_3613) in
                                                    {4038}out(c, (pkCli_3200,enc(m1_3614,pkSess_3608),sign(m1_3614,skCli_3199)));
                                                    {4039}event beginCli(Cli,Sess,gNc_3613);
                                                    {4040}in(c, (ePartS_3615: bitstring,sigPartS_3616: bitstring));
                                                    {4041}let PartS_3617: bitstring = dec(ePartS_3615,skCli_3199) in
                                                    {4042}if (verify(PartS_3617,sigPartS_3616,pkSess_3608) <> true) then
                                                        0
                                                    else
                                                        {4043}event endCli(Sess,Cli,PartS_3617)
                                            )
                                            else
                                                {4044}let pkSess_3618: bitstring = fail-any in
                                                {4045}out(c, GetEndpointRequest);
                                                {4046}in(c, (SPs_3619: bitstring,=SignAndEncrypt,UP_3620: bitstring,=pkSess_3618));
                                                {4047}new SPc_3621: bitstring;
                                                {4048}new Nc_3622: bitstring;
                                                {4049}let gNc_3623: bitstring = exp(g,Nc_3622) in
                                                {4050}let m1_3624: bitstring = (SPc_3621,gNc_3623) in
                                                {4051}out(c, (pkCli_3200,enc(m1_3624,pkSess_3618),sign(m1_3624,skCli_3199)));
                                                {4052}event beginCli(Cli,Sess,gNc_3623);
                                                {4053}in(c, (ePartS_3625: bitstring,sigPartS_3626: bitstring));
                                                {4054}let PartS_3627: bitstring = dec(ePartS_3625,skCli_3199) in
                                                {4055}if (verify(PartS_3627,sigPartS_3626,pkSess_3618) <> true) then
                                                    0
                                                else
                                                    {4056}event endCli(Sess,Cli,PartS_3627)
                                    )
                                    else
                                        {4057}let pkSess_3628: bitstring = fail-any in
                                        {4058}out(c, GetEndpointRequest);
                                        {4059}in(c, (SPs_3629: bitstring,=SignAndEncrypt,UP_3630: bitstring,=pkSess_3628));
                                        {4060}new SPc_3631: bitstring;
                                        {4061}new Nc_3632: bitstring;
                                        {4062}let gNc_3633: bitstring = exp(g,Nc_3632) in
                                        {4063}let m1_3634: bitstring = (SPc_3631,gNc_3633) in
                                        {4064}out(c, (pkCli_3200,enc(m1_3634,pkSess_3628),sign(m1_3634,skCli_3199)));
                                        {4065}event beginCli(Cli,Sess,gNc_3633);
                                        {4066}in(c, (ePartS_3635: bitstring,sigPartS_3636: bitstring));
                                        {4067}let PartS_3637: bitstring = dec(ePartS_3635,skCli_3199) in
                                        {4068}if (verify(PartS_3637,sigPartS_3636,pkSess_3628) <> true) then
                                            0
                                        else
                                            {4069}event endCli(Sess,Cli,PartS_3637)
                            )
                            else
                                {4070}let pkSess_3638: bitstring = fail-any in
                                {4071}out(c, GetEndpointRequest);
                                {4072}in(c, (SPs_3639: bitstring,=SignAndEncrypt,UP_3640: bitstring,=pkSess_3638));
                                {4073}new SPc_3641: bitstring;
                                {4074}new Nc_3642: bitstring;
                                {4075}let gNc_3643: bitstring = exp(g,Nc_3642) in
                                {4076}let m1_3644: bitstring = (SPc_3641,gNc_3643) in
                                {4077}out(c, (pkCli_3200,enc(m1_3644,pkSess_3638),sign(m1_3644,skCli_3199)));
                                {4078}event beginCli(Cli,Sess,gNc_3643);
                                {4079}in(c, (ePartS_3645: bitstring,sigPartS_3646: bitstring));
                                {4080}let PartS_3647: bitstring = dec(ePartS_3645,skCli_3199) in
                                {4081}if (verify(PartS_3647,sigPartS_3646,pkSess_3638) <> true) then
                                    0
                                else
                                    {4082}event endCli(Sess,Cli,PartS_3647)
                )
                else
                    {4083}let pkDisco_3648: bitstring = fail-any in
                    {4084}let v_3649: bool = (Sess = A) in
                    (
                        {4085}if v_3649 then
                        (
                            {4086}let pkSess_3650: bitstring = pub(skA) in
                            {4087}out(c, GetEndpointRequest);
                            {4088}in(c, (SPs_3651: bitstring,=SignAndEncrypt,UP_3652: bitstring,=pkSess_3650));
                            {4089}new SPc_3653: bitstring;
                            {4090}new Nc_3654: bitstring;
                            {4091}let gNc_3655: bitstring = exp(g,Nc_3654) in
                            {4092}let m1_3656: bitstring = (SPc_3653,gNc_3655) in
                            {4093}out(c, (pkCli_3200,enc(m1_3656,pkSess_3650),sign(m1_3656,skCli_3199)));
                            {4094}event beginCli(Cli,Sess,gNc_3655);
                            {4095}in(c, (ePartS_3657: bitstring,sigPartS_3658: bitstring));
                            {4096}let PartS_3659: bitstring = dec(ePartS_3657,skCli_3199) in
                            {4097}if (verify(PartS_3659,sigPartS_3658,pkSess_3650) <> true) then
                                0
                            else
                                {4098}event endCli(Sess,Cli,PartS_3659)
                        )
                        else
                            {4099}let v_3660: bool = (Sess = B) in
                            (
                                {4100}if v_3660 then
                                (
                                    {4101}let pkSess_3661: bitstring = pub(skB) in
                                    {4102}out(c, GetEndpointRequest);
                                    {4103}in(c, (SPs_3662: bitstring,=SignAndEncrypt,UP_3663: bitstring,=pkSess_3661));
                                    {4104}new SPc_3664: bitstring;
                                    {4105}new Nc_3665: bitstring;
                                    {4106}let gNc_3666: bitstring = exp(g,Nc_3665) in
                                    {4107}let m1_3667: bitstring = (SPc_3664,gNc_3666) in
                                    {4108}out(c, (pkCli_3200,enc(m1_3667,pkSess_3661),sign(m1_3667,skCli_3199)));
                                    {4109}event beginCli(Cli,Sess,gNc_3666);
                                    {4110}in(c, (ePartS_3668: bitstring,sigPartS_3669: bitstring));
                                    {4111}let PartS_3670: bitstring = dec(ePartS_3668,skCli_3199) in
                                    {4112}if (verify(PartS_3670,sigPartS_3669,pkSess_3661) <> true) then
                                        0
                                    else
                                        {4113}event endCli(Sess,Cli,PartS_3670)
                                )
                                else
                                    {4114}let v_3671: bool = (Sess = C) in
                                    (
                                        {4115}if v_3671 then
                                        (
                                            {4116}let pkSess_3672: bitstring = pub(skC) in
                                            {4117}out(c, GetEndpointRequest);
                                            {4118}in(c, (SPs_3673: bitstring,=SignAndEncrypt,UP_3674: bitstring,=pkSess_3672));
                                            {4119}new SPc_3675: bitstring;
                                            {4120}new Nc_3676: bitstring;
                                            {4121}let gNc_3677: bitstring = exp(g,Nc_3676) in
                                            {4122}let m1_3678: bitstring = (SPc_3675,gNc_3677) in
                                            {4123}out(c, (pkCli_3200,enc(m1_3678,pkSess_3672),sign(m1_3678,skCli_3199)));
                                            {4124}event beginCli(Cli,Sess,gNc_3677);
                                            {4125}in(c, (ePartS_3679: bitstring,sigPartS_3680: bitstring));
                                            {4126}let PartS_3681: bitstring = dec(ePartS_3679,skCli_3199) in
                                            {4127}if (verify(PartS_3681,sigPartS_3680,pkSess_3672) <> true) then
                                                0
                                            else
                                                {4128}event endCli(Sess,Cli,PartS_3681)
                                        )
                                        else
                                            {4129}let pkSess_3682: bitstring = pub(skI) in
                                            {4130}out(c, GetEndpointRequest);
                                            {4131}in(c, (SPs_3683: bitstring,=SignAndEncrypt,UP_3684: bitstring,=pkSess_3682));
                                            {4132}new SPc_3685: bitstring;
                                            {4133}new Nc_3686: bitstring;
                                            {4134}let gNc_3687: bitstring = exp(g,Nc_3686) in
                                            {4135}let m1_3688: bitstring = (SPc_3685,gNc_3687) in
                                            {4136}out(c, (pkCli_3200,enc(m1_3688,pkSess_3682),sign(m1_3688,skCli_3199)));
                                            {4137}event beginCli(Cli,Sess,gNc_3687);
                                            {4138}in(c, (ePartS_3689: bitstring,sigPartS_3690: bitstring));
                                            {4139}let PartS_3691: bitstring = dec(ePartS_3689,skCli_3199) in
                                            {4140}if (verify(PartS_3691,sigPartS_3690,pkSess_3682) <> true) then
                                                0
                                            else
                                                {4141}event endCli(Sess,Cli,PartS_3691)
                                    )
                                    else
                                        {4142}let pkSess_3692: bitstring = fail-any in
                                        {4143}out(c, GetEndpointRequest);
                                        {4144}in(c, (SPs_3693: bitstring,=SignAndEncrypt,UP_3694: bitstring,=pkSess_3692));
                                        {4145}new SPc_3695: bitstring;
                                        {4146}new Nc_3696: bitstring;
                                        {4147}let gNc_3697: bitstring = exp(g,Nc_3696) in
                                        {4148}let m1_3698: bitstring = (SPc_3695,gNc_3697) in
                                        {4149}out(c, (pkCli_3200,enc(m1_3698,pkSess_3692),sign(m1_3698,skCli_3199)));
                                        {4150}event beginCli(Cli,Sess,gNc_3697);
                                        {4151}in(c, (ePartS_3699: bitstring,sigPartS_3700: bitstring));
                                        {4152}let PartS_3701: bitstring = dec(ePartS_3699,skCli_3199) in
                                        {4153}if (verify(PartS_3701,sigPartS_3700,pkSess_3692) <> true) then
                                            0
                                        else
                                            {4154}event endCli(Sess,Cli,PartS_3701)
                            )
                            else
                                {4155}let pkSess_3702: bitstring = fail-any in
                                {4156}out(c, GetEndpointRequest);
                                {4157}in(c, (SPs_3703: bitstring,=SignAndEncrypt,UP_3704: bitstring,=pkSess_3702));
                                {4158}new SPc_3705: bitstring;
                                {4159}new Nc_3706: bitstring;
                                {4160}let gNc_3707: bitstring = exp(g,Nc_3706) in
                                {4161}let m1_3708: bitstring = (SPc_3705,gNc_3707) in
                                {4162}out(c, (pkCli_3200,enc(m1_3708,pkSess_3702),sign(m1_3708,skCli_3199)));
                                {4163}event beginCli(Cli,Sess,gNc_3707);
                                {4164}in(c, (ePartS_3709: bitstring,sigPartS_3710: bitstring));
                                {4165}let PartS_3711: bitstring = dec(ePartS_3709,skCli_3199) in
                                {4166}if (verify(PartS_3711,sigPartS_3710,pkSess_3702) <> true) then
                                    0
                                else
                                    {4167}event endCli(Sess,Cli,PartS_3711)
                    )
                    else
                        {4168}let pkSess_3712: bitstring = fail-any in
                        {4169}out(c, GetEndpointRequest);
                        {4170}in(c, (SPs_3713: bitstring,=SignAndEncrypt,UP_3714: bitstring,=pkSess_3712));
                        {4171}new SPc_3715: bitstring;
                        {4172}new Nc_3716: bitstring;
                        {4173}let gNc_3717: bitstring = exp(g,Nc_3716) in
                        {4174}let m1_3718: bitstring = (SPc_3715,gNc_3717) in
                        {4175}out(c, (pkCli_3200,enc(m1_3718,pkSess_3712),sign(m1_3718,skCli_3199)));
                        {4176}event beginCli(Cli,Sess,gNc_3717);
                        {4177}in(c, (ePartS_3719: bitstring,sigPartS_3720: bitstring));
                        {4178}let PartS_3721: bitstring = dec(ePartS_3719,skCli_3199) in
                        {4179}if (verify(PartS_3721,sigPartS_3720,pkSess_3712) <> true) then
                            0
                        else
                            {4180}event endCli(Sess,Cli,PartS_3721)
    )
    else
        {4181}let skCli_3722: bitstring = fail-any in
        {4182}let pkCli_3723: bitstring = pub(skCli_3722) in
        {4183}let v_3724: bool = (Disco = A) in
        (
            {4184}if v_3724 then
            (
                {4185}let pkDisco_3725: bitstring = pub(skA) in
                {4186}let v_3726: bool = (Sess = A) in
                (
                    {4187}if v_3726 then
                    (
                        {4188}let pkSess_3727: bitstring = pub(skA) in
                        {4189}out(c, GetEndpointRequest);
                        {4190}in(c, (SPs_3728: bitstring,=SignAndEncrypt,UP_3729: bitstring,=pkSess_3727));
                        {4191}new SPc_3730: bitstring;
                        {4192}new Nc_3731: bitstring;
                        {4193}let gNc_3732: bitstring = exp(g,Nc_3731) in
                        {4194}let m1_3733: bitstring = (SPc_3730,gNc_3732) in
                        {4195}out(c, (pkCli_3723,enc(m1_3733,pkSess_3727),sign(m1_3733,skCli_3722)));
                        {4196}event beginCli(Cli,Sess,gNc_3732);
                        {4197}in(c, (ePartS_3734: bitstring,sigPartS_3735: bitstring));
                        {4198}let PartS_3736: bitstring = dec(ePartS_3734,skCli_3722) in
                        {4199}if (verify(PartS_3736,sigPartS_3735,pkSess_3727) <> true) then
                            0
                        else
                            {4200}event endCli(Sess,Cli,PartS_3736)
                    )
                    else
                        {4201}let v_3737: bool = (Sess = B) in
                        (
                            {4202}if v_3737 then
                            (
                                {4203}let pkSess_3738: bitstring = pub(skB) in
                                {4204}out(c, GetEndpointRequest);
                                {4205}in(c, (SPs_3739: bitstring,=SignAndEncrypt,UP_3740: bitstring,=pkSess_3738));
                                {4206}new SPc_3741: bitstring;
                                {4207}new Nc_3742: bitstring;
                                {4208}let gNc_3743: bitstring = exp(g,Nc_3742) in
                                {4209}let m1_3744: bitstring = (SPc_3741,gNc_3743) in
                                {4210}out(c, (pkCli_3723,enc(m1_3744,pkSess_3738),sign(m1_3744,skCli_3722)));
                                {4211}event beginCli(Cli,Sess,gNc_3743);
                                {4212}in(c, (ePartS_3745: bitstring,sigPartS_3746: bitstring));
                                {4213}let PartS_3747: bitstring = dec(ePartS_3745,skCli_3722) in
                                {4214}if (verify(PartS_3747,sigPartS_3746,pkSess_3738) <> true) then
                                    0
                                else
                                    {4215}event endCli(Sess,Cli,PartS_3747)
                            )
                            else
                                {4216}let v_3748: bool = (Sess = C) in
                                (
                                    {4217}if v_3748 then
                                    (
                                        {4218}let pkSess_3749: bitstring = pub(skC) in
                                        {4219}out(c, GetEndpointRequest);
                                        {4220}in(c, (SPs_3750: bitstring,=SignAndEncrypt,UP_3751: bitstring,=pkSess_3749));
                                        {4221}new SPc_3752: bitstring;
                                        {4222}new Nc_3753: bitstring;
                                        {4223}let gNc_3754: bitstring = exp(g,Nc_3753) in
                                        {4224}let m1_3755: bitstring = (SPc_3752,gNc_3754) in
                                        {4225}out(c, (pkCli_3723,enc(m1_3755,pkSess_3749),sign(m1_3755,skCli_3722)));
                                        {4226}event beginCli(Cli,Sess,gNc_3754);
                                        {4227}in(c, (ePartS_3756: bitstring,sigPartS_3757: bitstring));
                                        {4228}let PartS_3758: bitstring = dec(ePartS_3756,skCli_3722) in
                                        {4229}if (verify(PartS_3758,sigPartS_3757,pkSess_3749) <> true) then
                                            0
                                        else
                                            {4230}event endCli(Sess,Cli,PartS_3758)
                                    )
                                    else
                                        {4231}let pkSess_3759: bitstring = pub(skI) in
                                        {4232}out(c, GetEndpointRequest);
                                        {4233}in(c, (SPs_3760: bitstring,=SignAndEncrypt,UP_3761: bitstring,=pkSess_3759));
                                        {4234}new SPc_3762: bitstring;
                                        {4235}new Nc_3763: bitstring;
                                        {4236}let gNc_3764: bitstring = exp(g,Nc_3763) in
                                        {4237}let m1_3765: bitstring = (SPc_3762,gNc_3764) in
                                        {4238}out(c, (pkCli_3723,enc(m1_3765,pkSess_3759),sign(m1_3765,skCli_3722)));
                                        {4239}event beginCli(Cli,Sess,gNc_3764);
                                        {4240}in(c, (ePartS_3766: bitstring,sigPartS_3767: bitstring));
                                        {4241}let PartS_3768: bitstring = dec(ePartS_3766,skCli_3722) in
                                        {4242}if (verify(PartS_3768,sigPartS_3767,pkSess_3759) <> true) then
                                            0
                                        else
                                            {4243}event endCli(Sess,Cli,PartS_3768)
                                )
                                else
                                    {4244}let pkSess_3769: bitstring = fail-any in
                                    {4245}out(c, GetEndpointRequest);
                                    {4246}in(c, (SPs_3770: bitstring,=SignAndEncrypt,UP_3771: bitstring,=pkSess_3769));
                                    {4247}new SPc_3772: bitstring;
                                    {4248}new Nc_3773: bitstring;
                                    {4249}let gNc_3774: bitstring = exp(g,Nc_3773) in
                                    {4250}let m1_3775: bitstring = (SPc_3772,gNc_3774) in
                                    {4251}out(c, (pkCli_3723,enc(m1_3775,pkSess_3769),sign(m1_3775,skCli_3722)));
                                    {4252}event beginCli(Cli,Sess,gNc_3774);
                                    {4253}in(c, (ePartS_3776: bitstring,sigPartS_3777: bitstring));
                                    {4254}let PartS_3778: bitstring = dec(ePartS_3776,skCli_3722) in
                                    {4255}if (verify(PartS_3778,sigPartS_3777,pkSess_3769) <> true) then
                                        0
                                    else
                                        {4256}event endCli(Sess,Cli,PartS_3778)
                        )
                        else
                            {4257}let pkSess_3779: bitstring = fail-any in
                            {4258}out(c, GetEndpointRequest);
                            {4259}in(c, (SPs_3780: bitstring,=SignAndEncrypt,UP_3781: bitstring,=pkSess_3779));
                            {4260}new SPc_3782: bitstring;
                            {4261}new Nc_3783: bitstring;
                            {4262}let gNc_3784: bitstring = exp(g,Nc_3783) in
                            {4263}let m1_3785: bitstring = (SPc_3782,gNc_3784) in
                            {4264}out(c, (pkCli_3723,enc(m1_3785,pkSess_3779),sign(m1_3785,skCli_3722)));
                            {4265}event beginCli(Cli,Sess,gNc_3784);
                            {4266}in(c, (ePartS_3786: bitstring,sigPartS_3787: bitstring));
                            {4267}let PartS_3788: bitstring = dec(ePartS_3786,skCli_3722) in
                            {4268}if (verify(PartS_3788,sigPartS_3787,pkSess_3779) <> true) then
                                0
                            else
                                {4269}event endCli(Sess,Cli,PartS_3788)
                )
                else
                    {4270}let pkSess_3789: bitstring = fail-any in
                    {4271}out(c, GetEndpointRequest);
                    {4272}in(c, (SPs_3790: bitstring,=SignAndEncrypt,UP_3791: bitstring,=pkSess_3789));
                    {4273}new SPc_3792: bitstring;
                    {4274}new Nc_3793: bitstring;
                    {4275}let gNc_3794: bitstring = exp(g,Nc_3793) in
                    {4276}let m1_3795: bitstring = (SPc_3792,gNc_3794) in
                    {4277}out(c, (pkCli_3723,enc(m1_3795,pkSess_3789),sign(m1_3795,skCli_3722)));
                    {4278}event beginCli(Cli,Sess,gNc_3794);
                    {4279}in(c, (ePartS_3796: bitstring,sigPartS_3797: bitstring));
                    {4280}let PartS_3798: bitstring = dec(ePartS_3796,skCli_3722) in
                    {4281}if (verify(PartS_3798,sigPartS_3797,pkSess_3789) <> true) then
                        0
                    else
                        {4282}event endCli(Sess,Cli,PartS_3798)
            )
            else
                {4283}let v_3799: bool = (Disco = B) in
                (
                    {4284}if v_3799 then
                    (
                        {4285}let pkDisco_3800: bitstring = pub(skB) in
                        {4286}let v_3801: bool = (Sess = A) in
                        (
                            {4287}if v_3801 then
                            (
                                {4288}let pkSess_3802: bitstring = pub(skA) in
                                {4289}out(c, GetEndpointRequest);
                                {4290}in(c, (SPs_3803: bitstring,=SignAndEncrypt,UP_3804: bitstring,=pkSess_3802));
                                {4291}new SPc_3805: bitstring;
                                {4292}new Nc_3806: bitstring;
                                {4293}let gNc_3807: bitstring = exp(g,Nc_3806) in
                                {4294}let m1_3808: bitstring = (SPc_3805,gNc_3807) in
                                {4295}out(c, (pkCli_3723,enc(m1_3808,pkSess_3802),sign(m1_3808,skCli_3722)));
                                {4296}event beginCli(Cli,Sess,gNc_3807);
                                {4297}in(c, (ePartS_3809: bitstring,sigPartS_3810: bitstring));
                                {4298}let PartS_3811: bitstring = dec(ePartS_3809,skCli_3722) in
                                {4299}if (verify(PartS_3811,sigPartS_3810,pkSess_3802) <> true) then
                                    0
                                else
                                    {4300}event endCli(Sess,Cli,PartS_3811)
                            )
                            else
                                {4301}let v_3812: bool = (Sess = B) in
                                (
                                    {4302}if v_3812 then
                                    (
                                        {4303}let pkSess_3813: bitstring = pub(skB) in
                                        {4304}out(c, GetEndpointRequest);
                                        {4305}in(c, (SPs_3814: bitstring,=SignAndEncrypt,UP_3815: bitstring,=pkSess_3813));
                                        {4306}new SPc_3816: bitstring;
                                        {4307}new Nc_3817: bitstring;
                                        {4308}let gNc_3818: bitstring = exp(g,Nc_3817) in
                                        {4309}let m1_3819: bitstring = (SPc_3816,gNc_3818) in
                                        {4310}out(c, (pkCli_3723,enc(m1_3819,pkSess_3813),sign(m1_3819,skCli_3722)));
                                        {4311}event beginCli(Cli,Sess,gNc_3818);
                                        {4312}in(c, (ePartS_3820: bitstring,sigPartS_3821: bitstring));
                                        {4313}let PartS_3822: bitstring = dec(ePartS_3820,skCli_3722) in
                                        {4314}if (verify(PartS_3822,sigPartS_3821,pkSess_3813) <> true) then
                                            0
                                        else
                                            {4315}event endCli(Sess,Cli,PartS_3822)
                                    )
                                    else
                                        {4316}let v_3823: bool = (Sess = C) in
                                        (
                                            {4317}if v_3823 then
                                            (
                                                {4318}let pkSess_3824: bitstring = pub(skC) in
                                                {4319}out(c, GetEndpointRequest);
                                                {4320}in(c, (SPs_3825: bitstring,=SignAndEncrypt,UP_3826: bitstring,=pkSess_3824));
                                                {4321}new SPc_3827: bitstring;
                                                {4322}new Nc_3828: bitstring;
                                                {4323}let gNc_3829: bitstring = exp(g,Nc_3828) in
                                                {4324}let m1_3830: bitstring = (SPc_3827,gNc_3829) in
                                                {4325}out(c, (pkCli_3723,enc(m1_3830,pkSess_3824),sign(m1_3830,skCli_3722)));
                                                {4326}event beginCli(Cli,Sess,gNc_3829);
                                                {4327}in(c, (ePartS_3831: bitstring,sigPartS_3832: bitstring));
                                                {4328}let PartS_3833: bitstring = dec(ePartS_3831,skCli_3722) in
                                                {4329}if (verify(PartS_3833,sigPartS_3832,pkSess_3824) <> true) then
                                                    0
                                                else
                                                    {4330}event endCli(Sess,Cli,PartS_3833)
                                            )
                                            else
                                                {4331}let pkSess_3834: bitstring = pub(skI) in
                                                {4332}out(c, GetEndpointRequest);
                                                {4333}in(c, (SPs_3835: bitstring,=SignAndEncrypt,UP_3836: bitstring,=pkSess_3834));
                                                {4334}new SPc_3837: bitstring;
                                                {4335}new Nc_3838: bitstring;
                                                {4336}let gNc_3839: bitstring = exp(g,Nc_3838) in
                                                {4337}let m1_3840: bitstring = (SPc_3837,gNc_3839) in
                                                {4338}out(c, (pkCli_3723,enc(m1_3840,pkSess_3834),sign(m1_3840,skCli_3722)));
                                                {4339}event beginCli(Cli,Sess,gNc_3839);
                                                {4340}in(c, (ePartS_3841: bitstring,sigPartS_3842: bitstring));
                                                {4341}let PartS_3843: bitstring = dec(ePartS_3841,skCli_3722) in
                                                {4342}if (verify(PartS_3843,sigPartS_3842,pkSess_3834) <> true) then
                                                    0
                                                else
                                                    {4343}event endCli(Sess,Cli,PartS_3843)
                                        )
                                        else
                                            {4344}let pkSess_3844: bitstring = fail-any in
                                            {4345}out(c, GetEndpointRequest);
                                            {4346}in(c, (SPs_3845: bitstring,=SignAndEncrypt,UP_3846: bitstring,=pkSess_3844));
                                            {4347}new SPc_3847: bitstring;
                                            {4348}new Nc_3848: bitstring;
                                            {4349}let gNc_3849: bitstring = exp(g,Nc_3848) in
                                            {4350}let m1_3850: bitstring = (SPc_3847,gNc_3849) in
                                            {4351}out(c, (pkCli_3723,enc(m1_3850,pkSess_3844),sign(m1_3850,skCli_3722)));
                                            {4352}event beginCli(Cli,Sess,gNc_3849);
                                            {4353}in(c, (ePartS_3851: bitstring,sigPartS_3852: bitstring));
                                            {4354}let PartS_3853: bitstring = dec(ePartS_3851,skCli_3722) in
                                            {4355}if (verify(PartS_3853,sigPartS_3852,pkSess_3844) <> true) then
                                                0
                                            else
                                                {4356}event endCli(Sess,Cli,PartS_3853)
                                )
                                else
                                    {4357}let pkSess_3854: bitstring = fail-any in
                                    {4358}out(c, GetEndpointRequest);
                                    {4359}in(c, (SPs_3855: bitstring,=SignAndEncrypt,UP_3856: bitstring,=pkSess_3854));
                                    {4360}new SPc_3857: bitstring;
                                    {4361}new Nc_3858: bitstring;
                                    {4362}let gNc_3859: bitstring = exp(g,Nc_3858) in
                                    {4363}let m1_3860: bitstring = (SPc_3857,gNc_3859) in
                                    {4364}out(c, (pkCli_3723,enc(m1_3860,pkSess_3854),sign(m1_3860,skCli_3722)));
                                    {4365}event beginCli(Cli,Sess,gNc_3859);
                                    {4366}in(c, (ePartS_3861: bitstring,sigPartS_3862: bitstring));
                                    {4367}let PartS_3863: bitstring = dec(ePartS_3861,skCli_3722) in
                                    {4368}if (verify(PartS_3863,sigPartS_3862,pkSess_3854) <> true) then
                                        0
                                    else
                                        {4369}event endCli(Sess,Cli,PartS_3863)
                        )
                        else
                            {4370}let pkSess_3864: bitstring = fail-any in
                            {4371}out(c, GetEndpointRequest);
                            {4372}in(c, (SPs_3865: bitstring,=SignAndEncrypt,UP_3866: bitstring,=pkSess_3864));
                            {4373}new SPc_3867: bitstring;
                            {4374}new Nc_3868: bitstring;
                            {4375}let gNc_3869: bitstring = exp(g,Nc_3868) in
                            {4376}let m1_3870: bitstring = (SPc_3867,gNc_3869) in
                            {4377}out(c, (pkCli_3723,enc(m1_3870,pkSess_3864),sign(m1_3870,skCli_3722)));
                            {4378}event beginCli(Cli,Sess,gNc_3869);
                            {4379}in(c, (ePartS_3871: bitstring,sigPartS_3872: bitstring));
                            {4380}let PartS_3873: bitstring = dec(ePartS_3871,skCli_3722) in
                            {4381}if (verify(PartS_3873,sigPartS_3872,pkSess_3864) <> true) then
                                0
                            else
                                {4382}event endCli(Sess,Cli,PartS_3873)
                    )
                    else
                        {4383}let v_3874: bool = (Disco = C) in
                        (
                            {4384}if v_3874 then
                            (
                                {4385}let pkDisco_3875: bitstring = pub(skC) in
                                {4386}let v_3876: bool = (Sess = A) in
                                (
                                    {4387}if v_3876 then
                                    (
                                        {4388}let pkSess_3877: bitstring = pub(skA) in
                                        {4389}out(c, GetEndpointRequest);
                                        {4390}in(c, (SPs_3878: bitstring,=SignAndEncrypt,UP_3879: bitstring,=pkSess_3877));
                                        {4391}new SPc_3880: bitstring;
                                        {4392}new Nc_3881: bitstring;
                                        {4393}let gNc_3882: bitstring = exp(g,Nc_3881) in
                                        {4394}let m1_3883: bitstring = (SPc_3880,gNc_3882) in
                                        {4395}out(c, (pkCli_3723,enc(m1_3883,pkSess_3877),sign(m1_3883,skCli_3722)));
                                        {4396}event beginCli(Cli,Sess,gNc_3882);
                                        {4397}in(c, (ePartS_3884: bitstring,sigPartS_3885: bitstring));
                                        {4398}let PartS_3886: bitstring = dec(ePartS_3884,skCli_3722) in
                                        {4399}if (verify(PartS_3886,sigPartS_3885,pkSess_3877) <> true) then
                                            0
                                        else
                                            {4400}event endCli(Sess,Cli,PartS_3886)
                                    )
                                    else
                                        {4401}let v_3887: bool = (Sess = B) in
                                        (
                                            {4402}if v_3887 then
                                            (
                                                {4403}let pkSess_3888: bitstring = pub(skB) in
                                                {4404}out(c, GetEndpointRequest);
                                                {4405}in(c, (SPs_3889: bitstring,=SignAndEncrypt,UP_3890: bitstring,=pkSess_3888));
                                                {4406}new SPc_3891: bitstring;
                                                {4407}new Nc_3892: bitstring;
                                                {4408}let gNc_3893: bitstring = exp(g,Nc_3892) in
                                                {4409}let m1_3894: bitstring = (SPc_3891,gNc_3893) in
                                                {4410}out(c, (pkCli_3723,enc(m1_3894,pkSess_3888),sign(m1_3894,skCli_3722)));
                                                {4411}event beginCli(Cli,Sess,gNc_3893);
                                                {4412}in(c, (ePartS_3895: bitstring,sigPartS_3896: bitstring));
                                                {4413}let PartS_3897: bitstring = dec(ePartS_3895,skCli_3722) in
                                                {4414}if (verify(PartS_3897,sigPartS_3896,pkSess_3888) <> true) then
                                                    0
                                                else
                                                    {4415}event endCli(Sess,Cli,PartS_3897)
                                            )
                                            else
                                                {4416}let v_3898: bool = (Sess = C) in
                                                (
                                                    {4417}if v_3898 then
                                                    (
                                                        {4418}let pkSess_3899: bitstring = pub(skC) in
                                                        {4419}out(c, GetEndpointRequest);
                                                        {4420}in(c, (SPs_3900: bitstring,=SignAndEncrypt,UP_3901: bitstring,=pkSess_3899));
                                                        {4421}new SPc_3902: bitstring;
                                                        {4422}new Nc_3903: bitstring;
                                                        {4423}let gNc_3904: bitstring = exp(g,Nc_3903) in
                                                        {4424}let m1_3905: bitstring = (SPc_3902,gNc_3904) in
                                                        {4425}out(c, (pkCli_3723,enc(m1_3905,pkSess_3899),sign(m1_3905,skCli_3722)));
                                                        {4426}event beginCli(Cli,Sess,gNc_3904);
                                                        {4427}in(c, (ePartS_3906: bitstring,sigPartS_3907: bitstring));
                                                        {4428}let PartS_3908: bitstring = dec(ePartS_3906,skCli_3722) in
                                                        {4429}if (verify(PartS_3908,sigPartS_3907,pkSess_3899) <> true) then
                                                            0
                                                        else
                                                            {4430}event endCli(Sess,Cli,PartS_3908)
                                                    )
                                                    else
                                                        {4431}let pkSess_3909: bitstring = pub(skI) in
                                                        {4432}out(c, GetEndpointRequest);
                                                        {4433}in(c, (SPs_3910: bitstring,=SignAndEncrypt,UP_3911: bitstring,=pkSess_3909));
                                                        {4434}new SPc_3912: bitstring;
                                                        {4435}new Nc_3913: bitstring;
                                                        {4436}let gNc_3914: bitstring = exp(g,Nc_3913) in
                                                        {4437}let m1_3915: bitstring = (SPc_3912,gNc_3914) in
                                                        {4438}out(c, (pkCli_3723,enc(m1_3915,pkSess_3909),sign(m1_3915,skCli_3722)));
                                                        {4439}event beginCli(Cli,Sess,gNc_3914);
                                                        {4440}in(c, (ePartS_3916: bitstring,sigPartS_3917: bitstring));
                                                        {4441}let PartS_3918: bitstring = dec(ePartS_3916,skCli_3722) in
                                                        {4442}if (verify(PartS_3918,sigPartS_3917,pkSess_3909) <> true) then
                                                            0
                                                        else
                                                            {4443}event endCli(Sess,Cli,PartS_3918)
                                                )
                                                else
                                                    {4444}let pkSess_3919: bitstring = fail-any in
                                                    {4445}out(c, GetEndpointRequest);
                                                    {4446}in(c, (SPs_3920: bitstring,=SignAndEncrypt,UP_3921: bitstring,=pkSess_3919));
                                                    {4447}new SPc_3922: bitstring;
                                                    {4448}new Nc_3923: bitstring;
                                                    {4449}let gNc_3924: bitstring = exp(g,Nc_3923) in
                                                    {4450}let m1_3925: bitstring = (SPc_3922,gNc_3924) in
                                                    {4451}out(c, (pkCli_3723,enc(m1_3925,pkSess_3919),sign(m1_3925,skCli_3722)));
                                                    {4452}event beginCli(Cli,Sess,gNc_3924);
                                                    {4453}in(c, (ePartS_3926: bitstring,sigPartS_3927: bitstring));
                                                    {4454}let PartS_3928: bitstring = dec(ePartS_3926,skCli_3722) in
                                                    {4455}if (verify(PartS_3928,sigPartS_3927,pkSess_3919) <> true) then
                                                        0
                                                    else
                                                        {4456}event endCli(Sess,Cli,PartS_3928)
                                        )
                                        else
                                            {4457}let pkSess_3929: bitstring = fail-any in
                                            {4458}out(c, GetEndpointRequest);
                                            {4459}in(c, (SPs_3930: bitstring,=SignAndEncrypt,UP_3931: bitstring,=pkSess_3929));
                                            {4460}new SPc_3932: bitstring;
                                            {4461}new Nc_3933: bitstring;
                                            {4462}let gNc_3934: bitstring = exp(g,Nc_3933) in
                                            {4463}let m1_3935: bitstring = (SPc_3932,gNc_3934) in
                                            {4464}out(c, (pkCli_3723,enc(m1_3935,pkSess_3929),sign(m1_3935,skCli_3722)));
                                            {4465}event beginCli(Cli,Sess,gNc_3934);
                                            {4466}in(c, (ePartS_3936: bitstring,sigPartS_3937: bitstring));
                                            {4467}let PartS_3938: bitstring = dec(ePartS_3936,skCli_3722) in
                                            {4468}if (verify(PartS_3938,sigPartS_3937,pkSess_3929) <> true) then
                                                0
                                            else
                                                {4469}event endCli(Sess,Cli,PartS_3938)
                                )
                                else
                                    {4470}let pkSess_3939: bitstring = fail-any in
                                    {4471}out(c, GetEndpointRequest);
                                    {4472}in(c, (SPs_3940: bitstring,=SignAndEncrypt,UP_3941: bitstring,=pkSess_3939));
                                    {4473}new SPc_3942: bitstring;
                                    {4474}new Nc_3943: bitstring;
                                    {4475}let gNc_3944: bitstring = exp(g,Nc_3943) in
                                    {4476}let m1_3945: bitstring = (SPc_3942,gNc_3944) in
                                    {4477}out(c, (pkCli_3723,enc(m1_3945,pkSess_3939),sign(m1_3945,skCli_3722)));
                                    {4478}event beginCli(Cli,Sess,gNc_3944);
                                    {4479}in(c, (ePartS_3946: bitstring,sigPartS_3947: bitstring));
                                    {4480}let PartS_3948: bitstring = dec(ePartS_3946,skCli_3722) in
                                    {4481}if (verify(PartS_3948,sigPartS_3947,pkSess_3939) <> true) then
                                        0
                                    else
                                        {4482}event endCli(Sess,Cli,PartS_3948)
                            )
                            else
                                {4483}let pkDisco_3949: bitstring = pub(skI) in
                                {4484}let v_3950: bool = (Sess = A) in
                                (
                                    {4485}if v_3950 then
                                    (
                                        {4486}let pkSess_3951: bitstring = pub(skA) in
                                        {4487}out(c, GetEndpointRequest);
                                        {4488}in(c, (SPs_3952: bitstring,=SignAndEncrypt,UP_3953: bitstring,=pkSess_3951));
                                        {4489}new SPc_3954: bitstring;
                                        {4490}new Nc_3955: bitstring;
                                        {4491}let gNc_3956: bitstring = exp(g,Nc_3955) in
                                        {4492}let m1_3957: bitstring = (SPc_3954,gNc_3956) in
                                        {4493}out(c, (pkCli_3723,enc(m1_3957,pkSess_3951),sign(m1_3957,skCli_3722)));
                                        {4494}event beginCli(Cli,Sess,gNc_3956);
                                        {4495}in(c, (ePartS_3958: bitstring,sigPartS_3959: bitstring));
                                        {4496}let PartS_3960: bitstring = dec(ePartS_3958,skCli_3722) in
                                        {4497}if (verify(PartS_3960,sigPartS_3959,pkSess_3951) <> true) then
                                            0
                                        else
                                            {4498}event endCli(Sess,Cli,PartS_3960)
                                    )
                                    else
                                        {4499}let v_3961: bool = (Sess = B) in
                                        (
                                            {4500}if v_3961 then
                                            (
                                                {4501}let pkSess_3962: bitstring = pub(skB) in
                                                {4502}out(c, GetEndpointRequest);
                                                {4503}in(c, (SPs_3963: bitstring,=SignAndEncrypt,UP_3964: bitstring,=pkSess_3962));
                                                {4504}new SPc_3965: bitstring;
                                                {4505}new Nc_3966: bitstring;
                                                {4506}let gNc_3967: bitstring = exp(g,Nc_3966) in
                                                {4507}let m1_3968: bitstring = (SPc_3965,gNc_3967) in
                                                {4508}out(c, (pkCli_3723,enc(m1_3968,pkSess_3962),sign(m1_3968,skCli_3722)));
                                                {4509}event beginCli(Cli,Sess,gNc_3967);
                                                {4510}in(c, (ePartS_3969: bitstring,sigPartS_3970: bitstring));
                                                {4511}let PartS_3971: bitstring = dec(ePartS_3969,skCli_3722) in
                                                {4512}if (verify(PartS_3971,sigPartS_3970,pkSess_3962) <> true) then
                                                    0
                                                else
                                                    {4513}event endCli(Sess,Cli,PartS_3971)
                                            )
                                            else
                                                {4514}let v_3972: bool = (Sess = C) in
                                                (
                                                    {4515}if v_3972 then
                                                    (
                                                        {4516}let pkSess_3973: bitstring = pub(skC) in
                                                        {4517}out(c, GetEndpointRequest);
                                                        {4518}in(c, (SPs_3974: bitstring,=SignAndEncrypt,UP_3975: bitstring,=pkSess_3973));
                                                        {4519}new SPc_3976: bitstring;
                                                        {4520}new Nc_3977: bitstring;
                                                        {4521}let gNc_3978: bitstring = exp(g,Nc_3977) in
                                                        {4522}let m1_3979: bitstring = (SPc_3976,gNc_3978) in
                                                        {4523}out(c, (pkCli_3723,enc(m1_3979,pkSess_3973),sign(m1_3979,skCli_3722)));
                                                        {4524}event beginCli(Cli,Sess,gNc_3978);
                                                        {4525}in(c, (ePartS_3980: bitstring,sigPartS_3981: bitstring));
                                                        {4526}let PartS_3982: bitstring = dec(ePartS_3980,skCli_3722) in
                                                        {4527}if (verify(PartS_3982,sigPartS_3981,pkSess_3973) <> true) then
                                                            0
                                                        else
                                                            {4528}event endCli(Sess,Cli,PartS_3982)
                                                    )
                                                    else
                                                        {4529}let pkSess_3983: bitstring = pub(skI) in
                                                        {4530}out(c, GetEndpointRequest);
                                                        {4531}in(c, (SPs_3984: bitstring,=SignAndEncrypt,UP_3985: bitstring,=pkSess_3983));
                                                        {4532}new SPc_3986: bitstring;
                                                        {4533}new Nc_3987: bitstring;
                                                        {4534}let gNc_3988: bitstring = exp(g,Nc_3987) in
                                                        {4535}let m1_3989: bitstring = (SPc_3986,gNc_3988) in
                                                        {4536}out(c, (pkCli_3723,enc(m1_3989,pkSess_3983),sign(m1_3989,skCli_3722)));
                                                        {4537}event beginCli(Cli,Sess,gNc_3988);
                                                        {4538}in(c, (ePartS_3990: bitstring,sigPartS_3991: bitstring));
                                                        {4539}let PartS_3992: bitstring = dec(ePartS_3990,skCli_3722) in
                                                        {4540}if (verify(PartS_3992,sigPartS_3991,pkSess_3983) <> true) then
                                                            0
                                                        else
                                                            {4541}event endCli(Sess,Cli,PartS_3992)
                                                )
                                                else
                                                    {4542}let pkSess_3993: bitstring = fail-any in
                                                    {4543}out(c, GetEndpointRequest);
                                                    {4544}in(c, (SPs_3994: bitstring,=SignAndEncrypt,UP_3995: bitstring,=pkSess_3993));
                                                    {4545}new SPc_3996: bitstring;
                                                    {4546}new Nc_3997: bitstring;
                                                    {4547}let gNc_3998: bitstring = exp(g,Nc_3997) in
                                                    {4548}let m1_3999: bitstring = (SPc_3996,gNc_3998) in
                                                    {4549}out(c, (pkCli_3723,enc(m1_3999,pkSess_3993),sign(m1_3999,skCli_3722)));
                                                    {4550}event beginCli(Cli,Sess,gNc_3998);
                                                    {4551}in(c, (ePartS_4000: bitstring,sigPartS_4001: bitstring));
                                                    {4552}let PartS_4002: bitstring = dec(ePartS_4000,skCli_3722) in
                                                    {4553}if (verify(PartS_4002,sigPartS_4001,pkSess_3993) <> true) then
                                                        0
                                                    else
                                                        {4554}event endCli(Sess,Cli,PartS_4002)
                                        )
                                        else
                                            {4555}let pkSess_4003: bitstring = fail-any in
                                            {4556}out(c, GetEndpointRequest);
                                            {4557}in(c, (SPs_4004: bitstring,=SignAndEncrypt,UP_4005: bitstring,=pkSess_4003));
                                            {4558}new SPc_4006: bitstring;
                                            {4559}new Nc_4007: bitstring;
                                            {4560}let gNc_4008: bitstring = exp(g,Nc_4007) in
                                            {4561}let m1_4009: bitstring = (SPc_4006,gNc_4008) in
                                            {4562}out(c, (pkCli_3723,enc(m1_4009,pkSess_4003),sign(m1_4009,skCli_3722)));
                                            {4563}event beginCli(Cli,Sess,gNc_4008);
                                            {4564}in(c, (ePartS_4010: bitstring,sigPartS_4011: bitstring));
                                            {4565}let PartS_4012: bitstring = dec(ePartS_4010,skCli_3722) in
                                            {4566}if (verify(PartS_4012,sigPartS_4011,pkSess_4003) <> true) then
                                                0
                                            else
                                                {4567}event endCli(Sess,Cli,PartS_4012)
                                )
                                else
                                    {4568}let pkSess_4013: bitstring = fail-any in
                                    {4569}out(c, GetEndpointRequest);
                                    {4570}in(c, (SPs_4014: bitstring,=SignAndEncrypt,UP_4015: bitstring,=pkSess_4013));
                                    {4571}new SPc_4016: bitstring;
                                    {4572}new Nc_4017: bitstring;
                                    {4573}let gNc_4018: bitstring = exp(g,Nc_4017) in
                                    {4574}let m1_4019: bitstring = (SPc_4016,gNc_4018) in
                                    {4575}out(c, (pkCli_3723,enc(m1_4019,pkSess_4013),sign(m1_4019,skCli_3722)));
                                    {4576}event beginCli(Cli,Sess,gNc_4018);
                                    {4577}in(c, (ePartS_4020: bitstring,sigPartS_4021: bitstring));
                                    {4578}let PartS_4022: bitstring = dec(ePartS_4020,skCli_3722) in
                                    {4579}if (verify(PartS_4022,sigPartS_4021,pkSess_4013) <> true) then
                                        0
                                    else
                                        {4580}event endCli(Sess,Cli,PartS_4022)
                        )
                        else
                            {4581}let pkDisco_4023: bitstring = fail-any in
                            {4582}let v_4024: bool = (Sess = A) in
                            (
                                {4583}if v_4024 then
                                (
                                    {4584}let pkSess_4025: bitstring = pub(skA) in
                                    {4585}out(c, GetEndpointRequest);
                                    {4586}in(c, (SPs_4026: bitstring,=SignAndEncrypt,UP_4027: bitstring,=pkSess_4025));
                                    {4587}new SPc_4028: bitstring;
                                    {4588}new Nc_4029: bitstring;
                                    {4589}let gNc_4030: bitstring = exp(g,Nc_4029) in
                                    {4590}let m1_4031: bitstring = (SPc_4028,gNc_4030) in
                                    {4591}out(c, (pkCli_3723,enc(m1_4031,pkSess_4025),sign(m1_4031,skCli_3722)));
                                    {4592}event beginCli(Cli,Sess,gNc_4030);
                                    {4593}in(c, (ePartS_4032: bitstring,sigPartS_4033: bitstring));
                                    {4594}let PartS_4034: bitstring = dec(ePartS_4032,skCli_3722) in
                                    {4595}if (verify(PartS_4034,sigPartS_4033,pkSess_4025) <> true) then
                                        0
                                    else
                                        {4596}event endCli(Sess,Cli,PartS_4034)
                                )
                                else
                                    {4597}let v_4035: bool = (Sess = B) in
                                    (
                                        {4598}if v_4035 then
                                        (
                                            {4599}let pkSess_4036: bitstring = pub(skB) in
                                            {4600}out(c, GetEndpointRequest);
                                            {4601}in(c, (SPs_4037: bitstring,=SignAndEncrypt,UP_4038: bitstring,=pkSess_4036));
                                            {4602}new SPc_4039: bitstring;
                                            {4603}new Nc_4040: bitstring;
                                            {4604}let gNc_4041: bitstring = exp(g,Nc_4040) in
                                            {4605}let m1_4042: bitstring = (SPc_4039,gNc_4041) in
                                            {4606}out(c, (pkCli_3723,enc(m1_4042,pkSess_4036),sign(m1_4042,skCli_3722)));
                                            {4607}event beginCli(Cli,Sess,gNc_4041);
                                            {4608}in(c, (ePartS_4043: bitstring,sigPartS_4044: bitstring));
                                            {4609}let PartS_4045: bitstring = dec(ePartS_4043,skCli_3722) in
                                            {4610}if (verify(PartS_4045,sigPartS_4044,pkSess_4036) <> true) then
                                                0
                                            else
                                                {4611}event endCli(Sess,Cli,PartS_4045)
                                        )
                                        else
                                            {4612}let v_4046: bool = (Sess = C) in
                                            (
                                                {4613}if v_4046 then
                                                (
                                                    {4614}let pkSess_4047: bitstring = pub(skC) in
                                                    {4615}out(c, GetEndpointRequest);
                                                    {4616}in(c, (SPs_4048: bitstring,=SignAndEncrypt,UP_4049: bitstring,=pkSess_4047));
                                                    {4617}new SPc_4050: bitstring;
                                                    {4618}new Nc_4051: bitstring;
                                                    {4619}let gNc_4052: bitstring = exp(g,Nc_4051) in
                                                    {4620}let m1_4053: bitstring = (SPc_4050,gNc_4052) in
                                                    {4621}out(c, (pkCli_3723,enc(m1_4053,pkSess_4047),sign(m1_4053,skCli_3722)));
                                                    {4622}event beginCli(Cli,Sess,gNc_4052);
                                                    {4623}in(c, (ePartS_4054: bitstring,sigPartS_4055: bitstring));
                                                    {4624}let PartS_4056: bitstring = dec(ePartS_4054,skCli_3722) in
                                                    {4625}if (verify(PartS_4056,sigPartS_4055,pkSess_4047) <> true) then
                                                        0
                                                    else
                                                        {4626}event endCli(Sess,Cli,PartS_4056)
                                                )
                                                else
                                                    {4627}let pkSess_4057: bitstring = pub(skI) in
                                                    {4628}out(c, GetEndpointRequest);
                                                    {4629}in(c, (SPs_4058: bitstring,=SignAndEncrypt,UP_4059: bitstring,=pkSess_4057));
                                                    {4630}new SPc_4060: bitstring;
                                                    {4631}new Nc_4061: bitstring;
                                                    {4632}let gNc_4062: bitstring = exp(g,Nc_4061) in
                                                    {4633}let m1_4063: bitstring = (SPc_4060,gNc_4062) in
                                                    {4634}out(c, (pkCli_3723,enc(m1_4063,pkSess_4057),sign(m1_4063,skCli_3722)));
                                                    {4635}event beginCli(Cli,Sess,gNc_4062);
                                                    {4636}in(c, (ePartS_4064: bitstring,sigPartS_4065: bitstring));
                                                    {4637}let PartS_4066: bitstring = dec(ePartS_4064,skCli_3722) in
                                                    {4638}if (verify(PartS_4066,sigPartS_4065,pkSess_4057) <> true) then
                                                        0
                                                    else
                                                        {4639}event endCli(Sess,Cli,PartS_4066)
                                            )
                                            else
                                                {4640}let pkSess_4067: bitstring = fail-any in
                                                {4641}out(c, GetEndpointRequest);
                                                {4642}in(c, (SPs_4068: bitstring,=SignAndEncrypt,UP_4069: bitstring,=pkSess_4067));
                                                {4643}new SPc_4070: bitstring;
                                                {4644}new Nc_4071: bitstring;
                                                {4645}let gNc_4072: bitstring = exp(g,Nc_4071) in
                                                {4646}let m1_4073: bitstring = (SPc_4070,gNc_4072) in
                                                {4647}out(c, (pkCli_3723,enc(m1_4073,pkSess_4067),sign(m1_4073,skCli_3722)));
                                                {4648}event beginCli(Cli,Sess,gNc_4072);
                                                {4649}in(c, (ePartS_4074: bitstring,sigPartS_4075: bitstring));
                                                {4650}let PartS_4076: bitstring = dec(ePartS_4074,skCli_3722) in
                                                {4651}if (verify(PartS_4076,sigPartS_4075,pkSess_4067) <> true) then
                                                    0
                                                else
                                                    {4652}event endCli(Sess,Cli,PartS_4076)
                                    )
                                    else
                                        {4653}let pkSess_4077: bitstring = fail-any in
                                        {4654}out(c, GetEndpointRequest);
                                        {4655}in(c, (SPs_4078: bitstring,=SignAndEncrypt,UP_4079: bitstring,=pkSess_4077));
                                        {4656}new SPc_4080: bitstring;
                                        {4657}new Nc_4081: bitstring;
                                        {4658}let gNc_4082: bitstring = exp(g,Nc_4081) in
                                        {4659}let m1_4083: bitstring = (SPc_4080,gNc_4082) in
                                        {4660}out(c, (pkCli_3723,enc(m1_4083,pkSess_4077),sign(m1_4083,skCli_3722)));
                                        {4661}event beginCli(Cli,Sess,gNc_4082);
                                        {4662}in(c, (ePartS_4084: bitstring,sigPartS_4085: bitstring));
                                        {4663}let PartS_4086: bitstring = dec(ePartS_4084,skCli_3722) in
                                        {4664}if (verify(PartS_4086,sigPartS_4085,pkSess_4077) <> true) then
                                            0
                                        else
                                            {4665}event endCli(Sess,Cli,PartS_4086)
                            )
                            else
                                {4666}let pkSess_4087: bitstring = fail-any in
                                {4667}out(c, GetEndpointRequest);
                                {4668}in(c, (SPs_4088: bitstring,=SignAndEncrypt,UP_4089: bitstring,=pkSess_4087));
                                {4669}new SPc_4090: bitstring;
                                {4670}new Nc_4091: bitstring;
                                {4671}let gNc_4092: bitstring = exp(g,Nc_4091) in
                                {4672}let m1_4093: bitstring = (SPc_4090,gNc_4092) in
                                {4673}out(c, (pkCli_3723,enc(m1_4093,pkSess_4087),sign(m1_4093,skCli_3722)));
                                {4674}event beginCli(Cli,Sess,gNc_4092);
                                {4675}in(c, (ePartS_4094: bitstring,sigPartS_4095: bitstring));
                                {4676}let PartS_4096: bitstring = dec(ePartS_4094,skCli_3722) in
                                {4677}if (verify(PartS_4096,sigPartS_4095,pkSess_4087) <> true) then
                                    0
                                else
                                    {4678}event endCli(Sess,Cli,PartS_4096)
                )
                else
                    {4679}let pkDisco_4097: bitstring = fail-any in
                    {4680}let v_4098: bool = (Sess = A) in
                    (
                        {4681}if v_4098 then
                        (
                            {4682}let pkSess_4099: bitstring = pub(skA) in
                            {4683}out(c, GetEndpointRequest);
                            {4684}in(c, (SPs_4100: bitstring,=SignAndEncrypt,UP_4101: bitstring,=pkSess_4099));
                            {4685}new SPc_4102: bitstring;
                            {4686}new Nc_4103: bitstring;
                            {4687}let gNc_4104: bitstring = exp(g,Nc_4103) in
                            {4688}let m1_4105: bitstring = (SPc_4102,gNc_4104) in
                            {4689}out(c, (pkCli_3723,enc(m1_4105,pkSess_4099),sign(m1_4105,skCli_3722)));
                            {4690}event beginCli(Cli,Sess,gNc_4104);
                            {4691}in(c, (ePartS_4106: bitstring,sigPartS_4107: bitstring));
                            {4692}let PartS_4108: bitstring = dec(ePartS_4106,skCli_3722) in
                            {4693}if (verify(PartS_4108,sigPartS_4107,pkSess_4099) <> true) then
                                0
                            else
                                {4694}event endCli(Sess,Cli,PartS_4108)
                        )
                        else
                            {4695}let v_4109: bool = (Sess = B) in
                            (
                                {4696}if v_4109 then
                                (
                                    {4697}let pkSess_4110: bitstring = pub(skB) in
                                    {4698}out(c, GetEndpointRequest);
                                    {4699}in(c, (SPs_4111: bitstring,=SignAndEncrypt,UP_4112: bitstring,=pkSess_4110));
                                    {4700}new SPc_4113: bitstring;
                                    {4701}new Nc_4114: bitstring;
                                    {4702}let gNc_4115: bitstring = exp(g,Nc_4114) in
                                    {4703}let m1_4116: bitstring = (SPc_4113,gNc_4115) in
                                    {4704}out(c, (pkCli_3723,enc(m1_4116,pkSess_4110),sign(m1_4116,skCli_3722)));
                                    {4705}event beginCli(Cli,Sess,gNc_4115);
                                    {4706}in(c, (ePartS_4117: bitstring,sigPartS_4118: bitstring));
                                    {4707}let PartS_4119: bitstring = dec(ePartS_4117,skCli_3722) in
                                    {4708}if (verify(PartS_4119,sigPartS_4118,pkSess_4110) <> true) then
                                        0
                                    else
                                        {4709}event endCli(Sess,Cli,PartS_4119)
                                )
                                else
                                    {4710}let v_4120: bool = (Sess = C) in
                                    (
                                        {4711}if v_4120 then
                                        (
                                            {4712}let pkSess_4121: bitstring = pub(skC) in
                                            {4713}out(c, GetEndpointRequest);
                                            {4714}in(c, (SPs_4122: bitstring,=SignAndEncrypt,UP_4123: bitstring,=pkSess_4121));
                                            {4715}new SPc_4124: bitstring;
                                            {4716}new Nc_4125: bitstring;
                                            {4717}let gNc_4126: bitstring = exp(g,Nc_4125) in
                                            {4718}let m1_4127: bitstring = (SPc_4124,gNc_4126) in
                                            {4719}out(c, (pkCli_3723,enc(m1_4127,pkSess_4121),sign(m1_4127,skCli_3722)));
                                            {4720}event beginCli(Cli,Sess,gNc_4126);
                                            {4721}in(c, (ePartS_4128: bitstring,sigPartS_4129: bitstring));
                                            {4722}let PartS_4130: bitstring = dec(ePartS_4128,skCli_3722) in
                                            {4723}if (verify(PartS_4130,sigPartS_4129,pkSess_4121) <> true) then
                                                0
                                            else
                                                {4724}event endCli(Sess,Cli,PartS_4130)
                                        )
                                        else
                                            {4725}let pkSess_4131: bitstring = pub(skI) in
                                            {4726}out(c, GetEndpointRequest);
                                            {4727}in(c, (SPs_4132: bitstring,=SignAndEncrypt,UP_4133: bitstring,=pkSess_4131));
                                            {4728}new SPc_4134: bitstring;
                                            {4729}new Nc_4135: bitstring;
                                            {4730}let gNc_4136: bitstring = exp(g,Nc_4135) in
                                            {4731}let m1_4137: bitstring = (SPc_4134,gNc_4136) in
                                            {4732}out(c, (pkCli_3723,enc(m1_4137,pkSess_4131),sign(m1_4137,skCli_3722)));
                                            {4733}event beginCli(Cli,Sess,gNc_4136);
                                            {4734}in(c, (ePartS_4138: bitstring,sigPartS_4139: bitstring));
                                            {4735}let PartS_4140: bitstring = dec(ePartS_4138,skCli_3722) in
                                            {4736}if (verify(PartS_4140,sigPartS_4139,pkSess_4131) <> true) then
                                                0
                                            else
                                                {4737}event endCli(Sess,Cli,PartS_4140)
                                    )
                                    else
                                        {4738}let pkSess_4141: bitstring = fail-any in
                                        {4739}out(c, GetEndpointRequest);
                                        {4740}in(c, (SPs_4142: bitstring,=SignAndEncrypt,UP_4143: bitstring,=pkSess_4141));
                                        {4741}new SPc_4144: bitstring;
                                        {4742}new Nc_4145: bitstring;
                                        {4743}let gNc_4146: bitstring = exp(g,Nc_4145) in
                                        {4744}let m1_4147: bitstring = (SPc_4144,gNc_4146) in
                                        {4745}out(c, (pkCli_3723,enc(m1_4147,pkSess_4141),sign(m1_4147,skCli_3722)));
                                        {4746}event beginCli(Cli,Sess,gNc_4146);
                                        {4747}in(c, (ePartS_4148: bitstring,sigPartS_4149: bitstring));
                                        {4748}let PartS_4150: bitstring = dec(ePartS_4148,skCli_3722) in
                                        {4749}if (verify(PartS_4150,sigPartS_4149,pkSess_4141) <> true) then
                                            0
                                        else
                                            {4750}event endCli(Sess,Cli,PartS_4150)
                            )
                            else
                                {4751}let pkSess_4151: bitstring = fail-any in
                                {4752}out(c, GetEndpointRequest);
                                {4753}in(c, (SPs_4152: bitstring,=SignAndEncrypt,UP_4153: bitstring,=pkSess_4151));
                                {4754}new SPc_4154: bitstring;
                                {4755}new Nc_4155: bitstring;
                                {4756}let gNc_4156: bitstring = exp(g,Nc_4155) in
                                {4757}let m1_4157: bitstring = (SPc_4154,gNc_4156) in
                                {4758}out(c, (pkCli_3723,enc(m1_4157,pkSess_4151),sign(m1_4157,skCli_3722)));
                                {4759}event beginCli(Cli,Sess,gNc_4156);
                                {4760}in(c, (ePartS_4158: bitstring,sigPartS_4159: bitstring));
                                {4761}let PartS_4160: bitstring = dec(ePartS_4158,skCli_3722) in
                                {4762}if (verify(PartS_4160,sigPartS_4159,pkSess_4151) <> true) then
                                    0
                                else
                                    {4763}event endCli(Sess,Cli,PartS_4160)
                    )
                    else
                        {4764}let pkSess_4161: bitstring = fail-any in
                        {4765}out(c, GetEndpointRequest);
                        {4766}in(c, (SPs_4162: bitstring,=SignAndEncrypt,UP_4163: bitstring,=pkSess_4161));
                        {4767}new SPc_4164: bitstring;
                        {4768}new Nc_4165: bitstring;
                        {4769}let gNc_4166: bitstring = exp(g,Nc_4165) in
                        {4770}let m1_4167: bitstring = (SPc_4164,gNc_4166) in
                        {4771}out(c, (pkCli_3723,enc(m1_4167,pkSess_4161),sign(m1_4167,skCli_3722)));
                        {4772}event beginCli(Cli,Sess,gNc_4166);
                        {4773}in(c, (ePartS_4168: bitstring,sigPartS_4169: bitstring));
                        {4774}let PartS_4170: bitstring = dec(ePartS_4168,skCli_3722) in
                        {4775}if (verify(PartS_4170,sigPartS_4169,pkSess_4161) <> true) then
                            0
                        else
                            {4776}event endCli(Sess,Cli,PartS_4170)
        )
        else
            {4777}let pkDisco_4171: bitstring = fail-any in
            {4778}let v_4172: bool = (Sess = A) in
            (
                {4779}if v_4172 then
                (
                    {4780}let pkSess_4173: bitstring = pub(skA) in
                    {4781}out(c, GetEndpointRequest);
                    {4782}in(c, (SPs_4174: bitstring,=SignAndEncrypt,UP_4175: bitstring,=pkSess_4173));
                    {4783}new SPc_4176: bitstring;
                    {4784}new Nc_4177: bitstring;
                    {4785}let gNc_4178: bitstring = exp(g,Nc_4177) in
                    {4786}let m1_4179: bitstring = (SPc_4176,gNc_4178) in
                    {4787}out(c, (pkCli_3723,enc(m1_4179,pkSess_4173),sign(m1_4179,skCli_3722)));
                    {4788}event beginCli(Cli,Sess,gNc_4178);
                    {4789}in(c, (ePartS_4180: bitstring,sigPartS_4181: bitstring));
                    {4790}let PartS_4182: bitstring = dec(ePartS_4180,skCli_3722) in
                    {4791}if (verify(PartS_4182,sigPartS_4181,pkSess_4173) <> true) then
                        0
                    else
                        {4792}event endCli(Sess,Cli,PartS_4182)
                )
                else
                    {4793}let v_4183: bool = (Sess = B) in
                    (
                        {4794}if v_4183 then
                        (
                            {4795}let pkSess_4184: bitstring = pub(skB) in
                            {4796}out(c, GetEndpointRequest);
                            {4797}in(c, (SPs_4185: bitstring,=SignAndEncrypt,UP_4186: bitstring,=pkSess_4184));
                            {4798}new SPc_4187: bitstring;
                            {4799}new Nc_4188: bitstring;
                            {4800}let gNc_4189: bitstring = exp(g,Nc_4188) in
                            {4801}let m1_4190: bitstring = (SPc_4187,gNc_4189) in
                            {4802}out(c, (pkCli_3723,enc(m1_4190,pkSess_4184),sign(m1_4190,skCli_3722)));
                            {4803}event beginCli(Cli,Sess,gNc_4189);
                            {4804}in(c, (ePartS_4191: bitstring,sigPartS_4192: bitstring));
                            {4805}let PartS_4193: bitstring = dec(ePartS_4191,skCli_3722) in
                            {4806}if (verify(PartS_4193,sigPartS_4192,pkSess_4184) <> true) then
                                0
                            else
                                {4807}event endCli(Sess,Cli,PartS_4193)
                        )
                        else
                            {4808}let v_4194: bool = (Sess = C) in
                            (
                                {4809}if v_4194 then
                                (
                                    {4810}let pkSess_4195: bitstring = pub(skC) in
                                    {4811}out(c, GetEndpointRequest);
                                    {4812}in(c, (SPs_4196: bitstring,=SignAndEncrypt,UP_4197: bitstring,=pkSess_4195));
                                    {4813}new SPc_4198: bitstring;
                                    {4814}new Nc_4199: bitstring;
                                    {4815}let gNc_4200: bitstring = exp(g,Nc_4199) in
                                    {4816}let m1_4201: bitstring = (SPc_4198,gNc_4200) in
                                    {4817}out(c, (pkCli_3723,enc(m1_4201,pkSess_4195),sign(m1_4201,skCli_3722)));
                                    {4818}event beginCli(Cli,Sess,gNc_4200);
                                    {4819}in(c, (ePartS_4202: bitstring,sigPartS_4203: bitstring));
                                    {4820}let PartS_4204: bitstring = dec(ePartS_4202,skCli_3722) in
                                    {4821}if (verify(PartS_4204,sigPartS_4203,pkSess_4195) <> true) then
                                        0
                                    else
                                        {4822}event endCli(Sess,Cli,PartS_4204)
                                )
                                else
                                    {4823}let pkSess_4205: bitstring = pub(skI) in
                                    {4824}out(c, GetEndpointRequest);
                                    {4825}in(c, (SPs_4206: bitstring,=SignAndEncrypt,UP_4207: bitstring,=pkSess_4205));
                                    {4826}new SPc_4208: bitstring;
                                    {4827}new Nc_4209: bitstring;
                                    {4828}let gNc_4210: bitstring = exp(g,Nc_4209) in
                                    {4829}let m1_4211: bitstring = (SPc_4208,gNc_4210) in
                                    {4830}out(c, (pkCli_3723,enc(m1_4211,pkSess_4205),sign(m1_4211,skCli_3722)));
                                    {4831}event beginCli(Cli,Sess,gNc_4210);
                                    {4832}in(c, (ePartS_4212: bitstring,sigPartS_4213: bitstring));
                                    {4833}let PartS_4214: bitstring = dec(ePartS_4212,skCli_3722) in
                                    {4834}if (verify(PartS_4214,sigPartS_4213,pkSess_4205) <> true) then
                                        0
                                    else
                                        {4835}event endCli(Sess,Cli,PartS_4214)
                            )
                            else
                                {4836}let pkSess_4215: bitstring = fail-any in
                                {4837}out(c, GetEndpointRequest);
                                {4838}in(c, (SPs_4216: bitstring,=SignAndEncrypt,UP_4217: bitstring,=pkSess_4215));
                                {4839}new SPc_4218: bitstring;
                                {4840}new Nc_4219: bitstring;
                                {4841}let gNc_4220: bitstring = exp(g,Nc_4219) in
                                {4842}let m1_4221: bitstring = (SPc_4218,gNc_4220) in
                                {4843}out(c, (pkCli_3723,enc(m1_4221,pkSess_4215),sign(m1_4221,skCli_3722)));
                                {4844}event beginCli(Cli,Sess,gNc_4220);
                                {4845}in(c, (ePartS_4222: bitstring,sigPartS_4223: bitstring));
                                {4846}let PartS_4224: bitstring = dec(ePartS_4222,skCli_3722) in
                                {4847}if (verify(PartS_4224,sigPartS_4223,pkSess_4215) <> true) then
                                    0
                                else
                                    {4848}event endCli(Sess,Cli,PartS_4224)
                    )
                    else
                        {4849}let pkSess_4225: bitstring = fail-any in
                        {4850}out(c, GetEndpointRequest);
                        {4851}in(c, (SPs_4226: bitstring,=SignAndEncrypt,UP_4227: bitstring,=pkSess_4225));
                        {4852}new SPc_4228: bitstring;
                        {4853}new Nc_4229: bitstring;
                        {4854}let gNc_4230: bitstring = exp(g,Nc_4229) in
                        {4855}let m1_4231: bitstring = (SPc_4228,gNc_4230) in
                        {4856}out(c, (pkCli_3723,enc(m1_4231,pkSess_4225),sign(m1_4231,skCli_3722)));
                        {4857}event beginCli(Cli,Sess,gNc_4230);
                        {4858}in(c, (ePartS_4232: bitstring,sigPartS_4233: bitstring));
                        {4859}let PartS_4234: bitstring = dec(ePartS_4232,skCli_3722) in
                        {4860}if (verify(PartS_4234,sigPartS_4233,pkSess_4225) <> true) then
                            0
                        else
                            {4861}event endCli(Sess,Cli,PartS_4234)
            )
            else
                {4862}let pkSess_4235: bitstring = fail-any in
                {4863}out(c, GetEndpointRequest);
                {4864}in(c, (SPs_4236: bitstring,=SignAndEncrypt,UP_4237: bitstring,=pkSess_4235));
                {4865}new SPc_4238: bitstring;
                {4866}new Nc_4239: bitstring;
                {4867}let gNc_4240: bitstring = exp(g,Nc_4239) in
                {4868}let m1_4241: bitstring = (SPc_4238,gNc_4240) in
                {4869}out(c, (pkCli_3723,enc(m1_4241,pkSess_4235),sign(m1_4241,skCli_3722)));
                {4870}event beginCli(Cli,Sess,gNc_4240);
                {4871}in(c, (ePartS_4242: bitstring,sigPartS_4243: bitstring));
                {4872}let PartS_4244: bitstring = dec(ePartS_4242,skCli_3722) in
                {4873}if (verify(PartS_4244,sigPartS_4243,pkSess_4235) <> true) then
                    0
                else
                    {4874}event endCli(Sess,Cli,PartS_4244)
) | (
    {4875}!
    {4876}in(c, (Cli_4245: host,Disco_4246: host,Sess_4247: host));
    {4877}let v_4248: bool = (Disco_4246 = A) in
    (
        {4878}if v_4248 then
        (
            {4879}let skDisco: bitstring = skA in
            {4880}let pkDisco_4249: bitstring = pub(skDisco) in
            {4881}let v_4250: bool = (Cli_4245 = A) in
            (
                {4882}if v_4250 then
                (
                    {4883}let pkCli_4251: bitstring = pub(skA) in
                    {4884}let v_4252: bool = (Sess_4247 = A) in
                    (
                        {4885}if v_4252 then
                        (
                            {4886}let pkSess_4253: bitstring = pub(skA) in
                            {4887}in(c, =GetEndpointRequest);
                            {4888}new SPs_4254: bitstring;
                            {4889}new UP_4255: bitstring;
                            {4890}out(c, (SPs_4254,SignAndEncrypt,UP_4255,pkSess_4253))
                        )
                        else
                            {4891}let v_4256: bool = (Sess_4247 = B) in
                            (
                                {4892}if v_4256 then
                                (
                                    {4893}let pkSess_4257: bitstring = pub(skB) in
                                    {4894}in(c, =GetEndpointRequest);
                                    {4895}new SPs_4258: bitstring;
                                    {4896}new UP_4259: bitstring;
                                    {4897}out(c, (SPs_4258,SignAndEncrypt,UP_4259,pkSess_4257))
                                )
                                else
                                    {4898}let v_4260: bool = (Sess_4247 = C) in
                                    (
                                        {4899}if v_4260 then
                                        (
                                            {4900}let pkSess_4261: bitstring = pub(skC) in
                                            {4901}in(c, =GetEndpointRequest);
                                            {4902}new SPs_4262: bitstring;
                                            {4903}new UP_4263: bitstring;
                                            {4904}out(c, (SPs_4262,SignAndEncrypt,UP_4263,pkSess_4261))
                                        )
                                        else
                                            {4905}let pkSess_4264: bitstring = pub(skI) in
                                            {4906}in(c, =GetEndpointRequest);
                                            {4907}new SPs_4265: bitstring;
                                            {4908}new UP_4266: bitstring;
                                            {4909}out(c, (SPs_4265,SignAndEncrypt,UP_4266,pkSess_4264))
                                    )
                                    else
                                        {4910}let pkSess_4267: bitstring = fail-any in
                                        {4911}in(c, =GetEndpointRequest);
                                        {4912}new SPs_4268: bitstring;
                                        {4913}new UP_4269: bitstring;
                                        {4914}out(c, (SPs_4268,SignAndEncrypt,UP_4269,pkSess_4267))
                            )
                            else
                                {4915}let pkSess_4270: bitstring = fail-any in
                                {4916}in(c, =GetEndpointRequest);
                                {4917}new SPs_4271: bitstring;
                                {4918}new UP_4272: bitstring;
                                {4919}out(c, (SPs_4271,SignAndEncrypt,UP_4272,pkSess_4270))
                    )
                    else
                        {4920}let pkSess_4273: bitstring = fail-any in
                        {4921}in(c, =GetEndpointRequest);
                        {4922}new SPs_4274: bitstring;
                        {4923}new UP_4275: bitstring;
                        {4924}out(c, (SPs_4274,SignAndEncrypt,UP_4275,pkSess_4273))
                )
                else
                    {4925}let v_4276: bool = (Cli_4245 = B) in
                    (
                        {4926}if v_4276 then
                        (
                            {4927}let pkCli_4277: bitstring = pub(skB) in
                            {4928}let v_4278: bool = (Sess_4247 = A) in
                            (
                                {4929}if v_4278 then
                                (
                                    {4930}let pkSess_4279: bitstring = pub(skA) in
                                    {4931}in(c, =GetEndpointRequest);
                                    {4932}new SPs_4280: bitstring;
                                    {4933}new UP_4281: bitstring;
                                    {4934}out(c, (SPs_4280,SignAndEncrypt,UP_4281,pkSess_4279))
                                )
                                else
                                    {4935}let v_4282: bool = (Sess_4247 = B) in
                                    (
                                        {4936}if v_4282 then
                                        (
                                            {4937}let pkSess_4283: bitstring = pub(skB) in
                                            {4938}in(c, =GetEndpointRequest);
                                            {4939}new SPs_4284: bitstring;
                                            {4940}new UP_4285: bitstring;
                                            {4941}out(c, (SPs_4284,SignAndEncrypt,UP_4285,pkSess_4283))
                                        )
                                        else
                                            {4942}let v_4286: bool = (Sess_4247 = C) in
                                            (
                                                {4943}if v_4286 then
                                                (
                                                    {4944}let pkSess_4287: bitstring = pub(skC) in
                                                    {4945}in(c, =GetEndpointRequest);
                                                    {4946}new SPs_4288: bitstring;
                                                    {4947}new UP_4289: bitstring;
                                                    {4948}out(c, (SPs_4288,SignAndEncrypt,UP_4289,pkSess_4287))
                                                )
                                                else
                                                    {4949}let pkSess_4290: bitstring = pub(skI) in
                                                    {4950}in(c, =GetEndpointRequest);
                                                    {4951}new SPs_4291: bitstring;
                                                    {4952}new UP_4292: bitstring;
                                                    {4953}out(c, (SPs_4291,SignAndEncrypt,UP_4292,pkSess_4290))
                                            )
                                            else
                                                {4954}let pkSess_4293: bitstring = fail-any in
                                                {4955}in(c, =GetEndpointRequest);
                                                {4956}new SPs_4294: bitstring;
                                                {4957}new UP_4295: bitstring;
                                                {4958}out(c, (SPs_4294,SignAndEncrypt,UP_4295,pkSess_4293))
                                    )
                                    else
                                        {4959}let pkSess_4296: bitstring = fail-any in
                                        {4960}in(c, =GetEndpointRequest);
                                        {4961}new SPs_4297: bitstring;
                                        {4962}new UP_4298: bitstring;
                                        {4963}out(c, (SPs_4297,SignAndEncrypt,UP_4298,pkSess_4296))
                            )
                            else
                                {4964}let pkSess_4299: bitstring = fail-any in
                                {4965}in(c, =GetEndpointRequest);
                                {4966}new SPs_4300: bitstring;
                                {4967}new UP_4301: bitstring;
                                {4968}out(c, (SPs_4300,SignAndEncrypt,UP_4301,pkSess_4299))
                        )
                        else
                            {4969}let v_4302: bool = (Cli_4245 = C) in
                            (
                                {4970}if v_4302 then
                                (
                                    {4971}let pkCli_4303: bitstring = pub(skC) in
                                    {4972}let v_4304: bool = (Sess_4247 = A) in
                                    (
                                        {4973}if v_4304 then
                                        (
                                            {4974}let pkSess_4305: bitstring = pub(skA) in
                                            {4975}in(c, =GetEndpointRequest);
                                            {4976}new SPs_4306: bitstring;
                                            {4977}new UP_4307: bitstring;
                                            {4978}out(c, (SPs_4306,SignAndEncrypt,UP_4307,pkSess_4305))
                                        )
                                        else
                                            {4979}let v_4308: bool = (Sess_4247 = B) in
                                            (
                                                {4980}if v_4308 then
                                                (
                                                    {4981}let pkSess_4309: bitstring = pub(skB) in
                                                    {4982}in(c, =GetEndpointRequest);
                                                    {4983}new SPs_4310: bitstring;
                                                    {4984}new UP_4311: bitstring;
                                                    {4985}out(c, (SPs_4310,SignAndEncrypt,UP_4311,pkSess_4309))
                                                )
                                                else
                                                    {4986}let v_4312: bool = (Sess_4247 = C) in
                                                    (
                                                        {4987}if v_4312 then
                                                        (
                                                            {4988}let pkSess_4313: bitstring = pub(skC) in
                                                            {4989}in(c, =GetEndpointRequest);
                                                            {4990}new SPs_4314: bitstring;
                                                            {4991}new UP_4315: bitstring;
                                                            {4992}out(c, (SPs_4314,SignAndEncrypt,UP_4315,pkSess_4313))
                                                        )
                                                        else
                                                            {4993}let pkSess_4316: bitstring = pub(skI) in
                                                            {4994}in(c, =GetEndpointRequest);
                                                            {4995}new SPs_4317: bitstring;
                                                            {4996}new UP_4318: bitstring;
                                                            {4997}out(c, (SPs_4317,SignAndEncrypt,UP_4318,pkSess_4316))
                                                    )
                                                    else
                                                        {4998}let pkSess_4319: bitstring = fail-any in
                                                        {4999}in(c, =GetEndpointRequest);
                                                        {5000}new SPs_4320: bitstring;
                                                        {5001}new UP_4321: bitstring;
                                                        {5002}out(c, (SPs_4320,SignAndEncrypt,UP_4321,pkSess_4319))
                                            )
                                            else
                                                {5003}let pkSess_4322: bitstring = fail-any in
                                                {5004}in(c, =GetEndpointRequest);
                                                {5005}new SPs_4323: bitstring;
                                                {5006}new UP_4324: bitstring;
                                                {5007}out(c, (SPs_4323,SignAndEncrypt,UP_4324,pkSess_4322))
                                    )
                                    else
                                        {5008}let pkSess_4325: bitstring = fail-any in
                                        {5009}in(c, =GetEndpointRequest);
                                        {5010}new SPs_4326: bitstring;
                                        {5011}new UP_4327: bitstring;
                                        {5012}out(c, (SPs_4326,SignAndEncrypt,UP_4327,pkSess_4325))
                                )
                                else
                                    {5013}let pkCli_4328: bitstring = pub(skI) in
                                    {5014}let v_4329: bool = (Sess_4247 = A) in
                                    (
                                        {5015}if v_4329 then
                                        (
                                            {5016}let pkSess_4330: bitstring = pub(skA) in
                                            {5017}in(c, =GetEndpointRequest);
                                            {5018}new SPs_4331: bitstring;
                                            {5019}new UP_4332: bitstring;
                                            {5020}out(c, (SPs_4331,SignAndEncrypt,UP_4332,pkSess_4330))
                                        )
                                        else
                                            {5021}let v_4333: bool = (Sess_4247 = B) in
                                            (
                                                {5022}if v_4333 then
                                                (
                                                    {5023}let pkSess_4334: bitstring = pub(skB) in
                                                    {5024}in(c, =GetEndpointRequest);
                                                    {5025}new SPs_4335: bitstring;
                                                    {5026}new UP_4336: bitstring;
                                                    {5027}out(c, (SPs_4335,SignAndEncrypt,UP_4336,pkSess_4334))
                                                )
                                                else
                                                    {5028}let v_4337: bool = (Sess_4247 = C) in
                                                    (
                                                        {5029}if v_4337 then
                                                        (
                                                            {5030}let pkSess_4338: bitstring = pub(skC) in
                                                            {5031}in(c, =GetEndpointRequest);
                                                            {5032}new SPs_4339: bitstring;
                                                            {5033}new UP_4340: bitstring;
                                                            {5034}out(c, (SPs_4339,SignAndEncrypt,UP_4340,pkSess_4338))
                                                        )
                                                        else
                                                            {5035}let pkSess_4341: bitstring = pub(skI) in
                                                            {5036}in(c, =GetEndpointRequest);
                                                            {5037}new SPs_4342: bitstring;
                                                            {5038}new UP_4343: bitstring;
                                                            {5039}out(c, (SPs_4342,SignAndEncrypt,UP_4343,pkSess_4341))
                                                    )
                                                    else
                                                        {5040}let pkSess_4344: bitstring = fail-any in
                                                        {5041}in(c, =GetEndpointRequest);
                                                        {5042}new SPs_4345: bitstring;
                                                        {5043}new UP_4346: bitstring;
                                                        {5044}out(c, (SPs_4345,SignAndEncrypt,UP_4346,pkSess_4344))
                                            )
                                            else
                                                {5045}let pkSess_4347: bitstring = fail-any in
                                                {5046}in(c, =GetEndpointRequest);
                                                {5047}new SPs_4348: bitstring;
                                                {5048}new UP_4349: bitstring;
                                                {5049}out(c, (SPs_4348,SignAndEncrypt,UP_4349,pkSess_4347))
                                    )
                                    else
                                        {5050}let pkSess_4350: bitstring = fail-any in
                                        {5051}in(c, =GetEndpointRequest);
                                        {5052}new SPs_4351: bitstring;
                                        {5053}new UP_4352: bitstring;
                                        {5054}out(c, (SPs_4351,SignAndEncrypt,UP_4352,pkSess_4350))
                            )
                            else
                                {5055}let pkCli_4353: bitstring = fail-any in
                                {5056}let v_4354: bool = (Sess_4247 = A) in
                                (
                                    {5057}if v_4354 then
                                    (
                                        {5058}let pkSess_4355: bitstring = pub(skA) in
                                        {5059}in(c, =GetEndpointRequest);
                                        {5060}new SPs_4356: bitstring;
                                        {5061}new UP_4357: bitstring;
                                        {5062}out(c, (SPs_4356,SignAndEncrypt,UP_4357,pkSess_4355))
                                    )
                                    else
                                        {5063}let v_4358: bool = (Sess_4247 = B) in
                                        (
                                            {5064}if v_4358 then
                                            (
                                                {5065}let pkSess_4359: bitstring = pub(skB) in
                                                {5066}in(c, =GetEndpointRequest);
                                                {5067}new SPs_4360: bitstring;
                                                {5068}new UP_4361: bitstring;
                                                {5069}out(c, (SPs_4360,SignAndEncrypt,UP_4361,pkSess_4359))
                                            )
                                            else
                                                {5070}let v_4362: bool = (Sess_4247 = C) in
                                                (
                                                    {5071}if v_4362 then
                                                    (
                                                        {5072}let pkSess_4363: bitstring = pub(skC) in
                                                        {5073}in(c, =GetEndpointRequest);
                                                        {5074}new SPs_4364: bitstring;
                                                        {5075}new UP_4365: bitstring;
                                                        {5076}out(c, (SPs_4364,SignAndEncrypt,UP_4365,pkSess_4363))
                                                    )
                                                    else
                                                        {5077}let pkSess_4366: bitstring = pub(skI) in
                                                        {5078}in(c, =GetEndpointRequest);
                                                        {5079}new SPs_4367: bitstring;
                                                        {5080}new UP_4368: bitstring;
                                                        {5081}out(c, (SPs_4367,SignAndEncrypt,UP_4368,pkSess_4366))
                                                )
                                                else
                                                    {5082}let pkSess_4369: bitstring = fail-any in
                                                    {5083}in(c, =GetEndpointRequest);
                                                    {5084}new SPs_4370: bitstring;
                                                    {5085}new UP_4371: bitstring;
                                                    {5086}out(c, (SPs_4370,SignAndEncrypt,UP_4371,pkSess_4369))
                                        )
                                        else
                                            {5087}let pkSess_4372: bitstring = fail-any in
                                            {5088}in(c, =GetEndpointRequest);
                                            {5089}new SPs_4373: bitstring;
                                            {5090}new UP_4374: bitstring;
                                            {5091}out(c, (SPs_4373,SignAndEncrypt,UP_4374,pkSess_4372))
                                )
                                else
                                    {5092}let pkSess_4375: bitstring = fail-any in
                                    {5093}in(c, =GetEndpointRequest);
                                    {5094}new SPs_4376: bitstring;
                                    {5095}new UP_4377: bitstring;
                                    {5096}out(c, (SPs_4376,SignAndEncrypt,UP_4377,pkSess_4375))
                    )
                    else
                        {5097}let pkCli_4378: bitstring = fail-any in
                        {5098}let v_4379: bool = (Sess_4247 = A) in
                        (
                            {5099}if v_4379 then
                            (
                                {5100}let pkSess_4380: bitstring = pub(skA) in
                                {5101}in(c, =GetEndpointRequest);
                                {5102}new SPs_4381: bitstring;
                                {5103}new UP_4382: bitstring;
                                {5104}out(c, (SPs_4381,SignAndEncrypt,UP_4382,pkSess_4380))
                            )
                            else
                                {5105}let v_4383: bool = (Sess_4247 = B) in
                                (
                                    {5106}if v_4383 then
                                    (
                                        {5107}let pkSess_4384: bitstring = pub(skB) in
                                        {5108}in(c, =GetEndpointRequest);
                                        {5109}new SPs_4385: bitstring;
                                        {5110}new UP_4386: bitstring;
                                        {5111}out(c, (SPs_4385,SignAndEncrypt,UP_4386,pkSess_4384))
                                    )
                                    else
                                        {5112}let v_4387: bool = (Sess_4247 = C) in
                                        (
                                            {5113}if v_4387 then
                                            (
                                                {5114}let pkSess_4388: bitstring = pub(skC) in
                                                {5115}in(c, =GetEndpointRequest);
                                                {5116}new SPs_4389: bitstring;
                                                {5117}new UP_4390: bitstring;
                                                {5118}out(c, (SPs_4389,SignAndEncrypt,UP_4390,pkSess_4388))
                                            )
                                            else
                                                {5119}let pkSess_4391: bitstring = pub(skI) in
                                                {5120}in(c, =GetEndpointRequest);
                                                {5121}new SPs_4392: bitstring;
                                                {5122}new UP_4393: bitstring;
                                                {5123}out(c, (SPs_4392,SignAndEncrypt,UP_4393,pkSess_4391))
                                        )
                                        else
                                            {5124}let pkSess_4394: bitstring = fail-any in
                                            {5125}in(c, =GetEndpointRequest);
                                            {5126}new SPs_4395: bitstring;
                                            {5127}new UP_4396: bitstring;
                                            {5128}out(c, (SPs_4395,SignAndEncrypt,UP_4396,pkSess_4394))
                                )
                                else
                                    {5129}let pkSess_4397: bitstring = fail-any in
                                    {5130}in(c, =GetEndpointRequest);
                                    {5131}new SPs_4398: bitstring;
                                    {5132}new UP_4399: bitstring;
                                    {5133}out(c, (SPs_4398,SignAndEncrypt,UP_4399,pkSess_4397))
                        )
                        else
                            {5134}let pkSess_4400: bitstring = fail-any in
                            {5135}in(c, =GetEndpointRequest);
                            {5136}new SPs_4401: bitstring;
                            {5137}new UP_4402: bitstring;
                            {5138}out(c, (SPs_4401,SignAndEncrypt,UP_4402,pkSess_4400))
            )
            else
                {5139}let pkCli_4403: bitstring = fail-any in
                {5140}let v_4404: bool = (Sess_4247 = A) in
                (
                    {5141}if v_4404 then
                    (
                        {5142}let pkSess_4405: bitstring = pub(skA) in
                        {5143}in(c, =GetEndpointRequest);
                        {5144}new SPs_4406: bitstring;
                        {5145}new UP_4407: bitstring;
                        {5146}out(c, (SPs_4406,SignAndEncrypt,UP_4407,pkSess_4405))
                    )
                    else
                        {5147}let v_4408: bool = (Sess_4247 = B) in
                        (
                            {5148}if v_4408 then
                            (
                                {5149}let pkSess_4409: bitstring = pub(skB) in
                                {5150}in(c, =GetEndpointRequest);
                                {5151}new SPs_4410: bitstring;
                                {5152}new UP_4411: bitstring;
                                {5153}out(c, (SPs_4410,SignAndEncrypt,UP_4411,pkSess_4409))
                            )
                            else
                                {5154}let v_4412: bool = (Sess_4247 = C) in
                                (
                                    {5155}if v_4412 then
                                    (
                                        {5156}let pkSess_4413: bitstring = pub(skC) in
                                        {5157}in(c, =GetEndpointRequest);
                                        {5158}new SPs_4414: bitstring;
                                        {5159}new UP_4415: bitstring;
                                        {5160}out(c, (SPs_4414,SignAndEncrypt,UP_4415,pkSess_4413))
                                    )
                                    else
                                        {5161}let pkSess_4416: bitstring = pub(skI) in
                                        {5162}in(c, =GetEndpointRequest);
                                        {5163}new SPs_4417: bitstring;
                                        {5164}new UP_4418: bitstring;
                                        {5165}out(c, (SPs_4417,SignAndEncrypt,UP_4418,pkSess_4416))
                                )
                                else
                                    {5166}let pkSess_4419: bitstring = fail-any in
                                    {5167}in(c, =GetEndpointRequest);
                                    {5168}new SPs_4420: bitstring;
                                    {5169}new UP_4421: bitstring;
                                    {5170}out(c, (SPs_4420,SignAndEncrypt,UP_4421,pkSess_4419))
                        )
                        else
                            {5171}let pkSess_4422: bitstring = fail-any in
                            {5172}in(c, =GetEndpointRequest);
                            {5173}new SPs_4423: bitstring;
                            {5174}new UP_4424: bitstring;
                            {5175}out(c, (SPs_4423,SignAndEncrypt,UP_4424,pkSess_4422))
                )
                else
                    {5176}let pkSess_4425: bitstring = fail-any in
                    {5177}in(c, =GetEndpointRequest);
                    {5178}new SPs_4426: bitstring;
                    {5179}new UP_4427: bitstring;
                    {5180}out(c, (SPs_4426,SignAndEncrypt,UP_4427,pkSess_4425))
        )
        else
            {5181}let v_4428: bool = (Disco_4246 = B) in
            (
                {5182}if v_4428 then
                (
                    {5183}let skDisco_4429: bitstring = skB in
                    {5184}let pkDisco_4430: bitstring = pub(skDisco_4429) in
                    {5185}let v_4431: bool = (Cli_4245 = A) in
                    (
                        {5186}if v_4431 then
                        (
                            {5187}let pkCli_4432: bitstring = pub(skA) in
                            {5188}let v_4433: bool = (Sess_4247 = A) in
                            (
                                {5189}if v_4433 then
                                (
                                    {5190}let pkSess_4434: bitstring = pub(skA) in
                                    {5191}in(c, =GetEndpointRequest);
                                    {5192}new SPs_4435: bitstring;
                                    {5193}new UP_4436: bitstring;
                                    {5194}out(c, (SPs_4435,SignAndEncrypt,UP_4436,pkSess_4434))
                                )
                                else
                                    {5195}let v_4437: bool = (Sess_4247 = B) in
                                    (
                                        {5196}if v_4437 then
                                        (
                                            {5197}let pkSess_4438: bitstring = pub(skB) in
                                            {5198}in(c, =GetEndpointRequest);
                                            {5199}new SPs_4439: bitstring;
                                            {5200}new UP_4440: bitstring;
                                            {5201}out(c, (SPs_4439,SignAndEncrypt,UP_4440,pkSess_4438))
                                        )
                                        else
                                            {5202}let v_4441: bool = (Sess_4247 = C) in
                                            (
                                                {5203}if v_4441 then
                                                (
                                                    {5204}let pkSess_4442: bitstring = pub(skC) in
                                                    {5205}in(c, =GetEndpointRequest);
                                                    {5206}new SPs_4443: bitstring;
                                                    {5207}new UP_4444: bitstring;
                                                    {5208}out(c, (SPs_4443,SignAndEncrypt,UP_4444,pkSess_4442))
                                                )
                                                else
                                                    {5209}let pkSess_4445: bitstring = pub(skI) in
                                                    {5210}in(c, =GetEndpointRequest);
                                                    {5211}new SPs_4446: bitstring;
                                                    {5212}new UP_4447: bitstring;
                                                    {5213}out(c, (SPs_4446,SignAndEncrypt,UP_4447,pkSess_4445))
                                            )
                                            else
                                                {5214}let pkSess_4448: bitstring = fail-any in
                                                {5215}in(c, =GetEndpointRequest);
                                                {5216}new SPs_4449: bitstring;
                                                {5217}new UP_4450: bitstring;
                                                {5218}out(c, (SPs_4449,SignAndEncrypt,UP_4450,pkSess_4448))
                                    )
                                    else
                                        {5219}let pkSess_4451: bitstring = fail-any in
                                        {5220}in(c, =GetEndpointRequest);
                                        {5221}new SPs_4452: bitstring;
                                        {5222}new UP_4453: bitstring;
                                        {5223}out(c, (SPs_4452,SignAndEncrypt,UP_4453,pkSess_4451))
                            )
                            else
                                {5224}let pkSess_4454: bitstring = fail-any in
                                {5225}in(c, =GetEndpointRequest);
                                {5226}new SPs_4455: bitstring;
                                {5227}new UP_4456: bitstring;
                                {5228}out(c, (SPs_4455,SignAndEncrypt,UP_4456,pkSess_4454))
                        )
                        else
                            {5229}let v_4457: bool = (Cli_4245 = B) in
                            (
                                {5230}if v_4457 then
                                (
                                    {5231}let pkCli_4458: bitstring = pub(skB) in
                                    {5232}let v_4459: bool = (Sess_4247 = A) in
                                    (
                                        {5233}if v_4459 then
                                        (
                                            {5234}let pkSess_4460: bitstring = pub(skA) in
                                            {5235}in(c, =GetEndpointRequest);
                                            {5236}new SPs_4461: bitstring;
                                            {5237}new UP_4462: bitstring;
                                            {5238}out(c, (SPs_4461,SignAndEncrypt,UP_4462,pkSess_4460))
                                        )
                                        else
                                            {5239}let v_4463: bool = (Sess_4247 = B) in
                                            (
                                                {5240}if v_4463 then
                                                (
                                                    {5241}let pkSess_4464: bitstring = pub(skB) in
                                                    {5242}in(c, =GetEndpointRequest);
                                                    {5243}new SPs_4465: bitstring;
                                                    {5244}new UP_4466: bitstring;
                                                    {5245}out(c, (SPs_4465,SignAndEncrypt,UP_4466,pkSess_4464))
                                                )
                                                else
                                                    {5246}let v_4467: bool = (Sess_4247 = C) in
                                                    (
                                                        {5247}if v_4467 then
                                                        (
                                                            {5248}let pkSess_4468: bitstring = pub(skC) in
                                                            {5249}in(c, =GetEndpointRequest);
                                                            {5250}new SPs_4469: bitstring;
                                                            {5251}new UP_4470: bitstring;
                                                            {5252}out(c, (SPs_4469,SignAndEncrypt,UP_4470,pkSess_4468))
                                                        )
                                                        else
                                                            {5253}let pkSess_4471: bitstring = pub(skI) in
                                                            {5254}in(c, =GetEndpointRequest);
                                                            {5255}new SPs_4472: bitstring;
                                                            {5256}new UP_4473: bitstring;
                                                            {5257}out(c, (SPs_4472,SignAndEncrypt,UP_4473,pkSess_4471))
                                                    )
                                                    else
                                                        {5258}let pkSess_4474: bitstring = fail-any in
                                                        {5259}in(c, =GetEndpointRequest);
                                                        {5260}new SPs_4475: bitstring;
                                                        {5261}new UP_4476: bitstring;
                                                        {5262}out(c, (SPs_4475,SignAndEncrypt,UP_4476,pkSess_4474))
                                            )
                                            else
                                                {5263}let pkSess_4477: bitstring = fail-any in
                                                {5264}in(c, =GetEndpointRequest);
                                                {5265}new SPs_4478: bitstring;
                                                {5266}new UP_4479: bitstring;
                                                {5267}out(c, (SPs_4478,SignAndEncrypt,UP_4479,pkSess_4477))
                                    )
                                    else
                                        {5268}let pkSess_4480: bitstring = fail-any in
                                        {5269}in(c, =GetEndpointRequest);
                                        {5270}new SPs_4481: bitstring;
                                        {5271}new UP_4482: bitstring;
                                        {5272}out(c, (SPs_4481,SignAndEncrypt,UP_4482,pkSess_4480))
                                )
                                else
                                    {5273}let v_4483: bool = (Cli_4245 = C) in
                                    (
                                        {5274}if v_4483 then
                                        (
                                            {5275}let pkCli_4484: bitstring = pub(skC) in
                                            {5276}let v_4485: bool = (Sess_4247 = A) in
                                            (
                                                {5277}if v_4485 then
                                                (
                                                    {5278}let pkSess_4486: bitstring = pub(skA) in
                                                    {5279}in(c, =GetEndpointRequest);
                                                    {5280}new SPs_4487: bitstring;
                                                    {5281}new UP_4488: bitstring;
                                                    {5282}out(c, (SPs_4487,SignAndEncrypt,UP_4488,pkSess_4486))
                                                )
                                                else
                                                    {5283}let v_4489: bool = (Sess_4247 = B) in
                                                    (
                                                        {5284}if v_4489 then
                                                        (
                                                            {5285}let pkSess_4490: bitstring = pub(skB) in
                                                            {5286}in(c, =GetEndpointRequest);
                                                            {5287}new SPs_4491: bitstring;
                                                            {5288}new UP_4492: bitstring;
                                                            {5289}out(c, (SPs_4491,SignAndEncrypt,UP_4492,pkSess_4490))
                                                        )
                                                        else
                                                            {5290}let v_4493: bool = (Sess_4247 = C) in
                                                            (
                                                                {5291}if v_4493 then
                                                                (
                                                                    {5292}let pkSess_4494: bitstring = pub(skC) in
                                                                    {5293}in(c, =GetEndpointRequest);
                                                                    {5294}new SPs_4495: bitstring;
                                                                    {5295}new UP_4496: bitstring;
                                                                    {5296}out(c, (SPs_4495,SignAndEncrypt,UP_4496,pkSess_4494))
                                                                )
                                                                else
                                                                    {5297}let pkSess_4497: bitstring = pub(skI) in
                                                                    {5298}in(c, =GetEndpointRequest);
                                                                    {5299}new SPs_4498: bitstring;
                                                                    {5300}new UP_4499: bitstring;
                                                                    {5301}out(c, (SPs_4498,SignAndEncrypt,UP_4499,pkSess_4497))
                                                            )
                                                            else
                                                                {5302}let pkSess_4500: bitstring = fail-any in
                                                                {5303}in(c, =GetEndpointRequest);
                                                                {5304}new SPs_4501: bitstring;
                                                                {5305}new UP_4502: bitstring;
                                                                {5306}out(c, (SPs_4501,SignAndEncrypt,UP_4502,pkSess_4500))
                                                    )
                                                    else
                                                        {5307}let pkSess_4503: bitstring = fail-any in
                                                        {5308}in(c, =GetEndpointRequest);
                                                        {5309}new SPs_4504: bitstring;
                                                        {5310}new UP_4505: bitstring;
                                                        {5311}out(c, (SPs_4504,SignAndEncrypt,UP_4505,pkSess_4503))
                                            )
                                            else
                                                {5312}let pkSess_4506: bitstring = fail-any in
                                                {5313}in(c, =GetEndpointRequest);
                                                {5314}new SPs_4507: bitstring;
                                                {5315}new UP_4508: bitstring;
                                                {5316}out(c, (SPs_4507,SignAndEncrypt,UP_4508,pkSess_4506))
                                        )
                                        else
                                            {5317}let pkCli_4509: bitstring = pub(skI) in
                                            {5318}let v_4510: bool = (Sess_4247 = A) in
                                            (
                                                {5319}if v_4510 then
                                                (
                                                    {5320}let pkSess_4511: bitstring = pub(skA) in
                                                    {5321}in(c, =GetEndpointRequest);
                                                    {5322}new SPs_4512: bitstring;
                                                    {5323}new UP_4513: bitstring;
                                                    {5324}out(c, (SPs_4512,SignAndEncrypt,UP_4513,pkSess_4511))
                                                )
                                                else
                                                    {5325}let v_4514: bool = (Sess_4247 = B) in
                                                    (
                                                        {5326}if v_4514 then
                                                        (
                                                            {5327}let pkSess_4515: bitstring = pub(skB) in
                                                            {5328}in(c, =GetEndpointRequest);
                                                            {5329}new SPs_4516: bitstring;
                                                            {5330}new UP_4517: bitstring;
                                                            {5331}out(c, (SPs_4516,SignAndEncrypt,UP_4517,pkSess_4515))
                                                        )
                                                        else
                                                            {5332}let v_4518: bool = (Sess_4247 = C) in
                                                            (
                                                                {5333}if v_4518 then
                                                                (
                                                                    {5334}let pkSess_4519: bitstring = pub(skC) in
                                                                    {5335}in(c, =GetEndpointRequest);
                                                                    {5336}new SPs_4520: bitstring;
                                                                    {5337}new UP_4521: bitstring;
                                                                    {5338}out(c, (SPs_4520,SignAndEncrypt,UP_4521,pkSess_4519))
                                                                )
                                                                else
                                                                    {5339}let pkSess_4522: bitstring = pub(skI) in
                                                                    {5340}in(c, =GetEndpointRequest);
                                                                    {5341}new SPs_4523: bitstring;
                                                                    {5342}new UP_4524: bitstring;
                                                                    {5343}out(c, (SPs_4523,SignAndEncrypt,UP_4524,pkSess_4522))
                                                            )
                                                            else
                                                                {5344}let pkSess_4525: bitstring = fail-any in
                                                                {5345}in(c, =GetEndpointRequest);
                                                                {5346}new SPs_4526: bitstring;
                                                                {5347}new UP_4527: bitstring;
                                                                {5348}out(c, (SPs_4526,SignAndEncrypt,UP_4527,pkSess_4525))
                                                    )
                                                    else
                                                        {5349}let pkSess_4528: bitstring = fail-any in
                                                        {5350}in(c, =GetEndpointRequest);
                                                        {5351}new SPs_4529: bitstring;
                                                        {5352}new UP_4530: bitstring;
                                                        {5353}out(c, (SPs_4529,SignAndEncrypt,UP_4530,pkSess_4528))
                                            )
                                            else
                                                {5354}let pkSess_4531: bitstring = fail-any in
                                                {5355}in(c, =GetEndpointRequest);
                                                {5356}new SPs_4532: bitstring;
                                                {5357}new UP_4533: bitstring;
                                                {5358}out(c, (SPs_4532,SignAndEncrypt,UP_4533,pkSess_4531))
                                    )
                                    else
                                        {5359}let pkCli_4534: bitstring = fail-any in
                                        {5360}let v_4535: bool = (Sess_4247 = A) in
                                        (
                                            {5361}if v_4535 then
                                            (
                                                {5362}let pkSess_4536: bitstring = pub(skA) in
                                                {5363}in(c, =GetEndpointRequest);
                                                {5364}new SPs_4537: bitstring;
                                                {5365}new UP_4538: bitstring;
                                                {5366}out(c, (SPs_4537,SignAndEncrypt,UP_4538,pkSess_4536))
                                            )
                                            else
                                                {5367}let v_4539: bool = (Sess_4247 = B) in
                                                (
                                                    {5368}if v_4539 then
                                                    (
                                                        {5369}let pkSess_4540: bitstring = pub(skB) in
                                                        {5370}in(c, =GetEndpointRequest);
                                                        {5371}new SPs_4541: bitstring;
                                                        {5372}new UP_4542: bitstring;
                                                        {5373}out(c, (SPs_4541,SignAndEncrypt,UP_4542,pkSess_4540))
                                                    )
                                                    else
                                                        {5374}let v_4543: bool = (Sess_4247 = C) in
                                                        (
                                                            {5375}if v_4543 then
                                                            (
                                                                {5376}let pkSess_4544: bitstring = pub(skC) in
                                                                {5377}in(c, =GetEndpointRequest);
                                                                {5378}new SPs_4545: bitstring;
                                                                {5379}new UP_4546: bitstring;
                                                                {5380}out(c, (SPs_4545,SignAndEncrypt,UP_4546,pkSess_4544))
                                                            )
                                                            else
                                                                {5381}let pkSess_4547: bitstring = pub(skI) in
                                                                {5382}in(c, =GetEndpointRequest);
                                                                {5383}new SPs_4548: bitstring;
                                                                {5384}new UP_4549: bitstring;
                                                                {5385}out(c, (SPs_4548,SignAndEncrypt,UP_4549,pkSess_4547))
                                                        )
                                                        else
                                                            {5386}let pkSess_4550: bitstring = fail-any in
                                                            {5387}in(c, =GetEndpointRequest);
                                                            {5388}new SPs_4551: bitstring;
                                                            {5389}new UP_4552: bitstring;
                                                            {5390}out(c, (SPs_4551,SignAndEncrypt,UP_4552,pkSess_4550))
                                                )
                                                else
                                                    {5391}let pkSess_4553: bitstring = fail-any in
                                                    {5392}in(c, =GetEndpointRequest);
                                                    {5393}new SPs_4554: bitstring;
                                                    {5394}new UP_4555: bitstring;
                                                    {5395}out(c, (SPs_4554,SignAndEncrypt,UP_4555,pkSess_4553))
                                        )
                                        else
                                            {5396}let pkSess_4556: bitstring = fail-any in
                                            {5397}in(c, =GetEndpointRequest);
                                            {5398}new SPs_4557: bitstring;
                                            {5399}new UP_4558: bitstring;
                                            {5400}out(c, (SPs_4557,SignAndEncrypt,UP_4558,pkSess_4556))
                            )
                            else
                                {5401}let pkCli_4559: bitstring = fail-any in
                                {5402}let v_4560: bool = (Sess_4247 = A) in
                                (
                                    {5403}if v_4560 then
                                    (
                                        {5404}let pkSess_4561: bitstring = pub(skA) in
                                        {5405}in(c, =GetEndpointRequest);
                                        {5406}new SPs_4562: bitstring;
                                        {5407}new UP_4563: bitstring;
                                        {5408}out(c, (SPs_4562,SignAndEncrypt,UP_4563,pkSess_4561))
                                    )
                                    else
                                        {5409}let v_4564: bool = (Sess_4247 = B) in
                                        (
                                            {5410}if v_4564 then
                                            (
                                                {5411}let pkSess_4565: bitstring = pub(skB) in
                                                {5412}in(c, =GetEndpointRequest);
                                                {5413}new SPs_4566: bitstring;
                                                {5414}new UP_4567: bitstring;
                                                {5415}out(c, (SPs_4566,SignAndEncrypt,UP_4567,pkSess_4565))
                                            )
                                            else
                                                {5416}let v_4568: bool = (Sess_4247 = C) in
                                                (
                                                    {5417}if v_4568 then
                                                    (
                                                        {5418}let pkSess_4569: bitstring = pub(skC) in
                                                        {5419}in(c, =GetEndpointRequest);
                                                        {5420}new SPs_4570: bitstring;
                                                        {5421}new UP_4571: bitstring;
                                                        {5422}out(c, (SPs_4570,SignAndEncrypt,UP_4571,pkSess_4569))
                                                    )
                                                    else
                                                        {5423}let pkSess_4572: bitstring = pub(skI) in
                                                        {5424}in(c, =GetEndpointRequest);
                                                        {5425}new SPs_4573: bitstring;
                                                        {5426}new UP_4574: bitstring;
                                                        {5427}out(c, (SPs_4573,SignAndEncrypt,UP_4574,pkSess_4572))
                                                )
                                                else
                                                    {5428}let pkSess_4575: bitstring = fail-any in
                                                    {5429}in(c, =GetEndpointRequest);
                                                    {5430}new SPs_4576: bitstring;
                                                    {5431}new UP_4577: bitstring;
                                                    {5432}out(c, (SPs_4576,SignAndEncrypt,UP_4577,pkSess_4575))
                                        )
                                        else
                                            {5433}let pkSess_4578: bitstring = fail-any in
                                            {5434}in(c, =GetEndpointRequest);
                                            {5435}new SPs_4579: bitstring;
                                            {5436}new UP_4580: bitstring;
                                            {5437}out(c, (SPs_4579,SignAndEncrypt,UP_4580,pkSess_4578))
                                )
                                else
                                    {5438}let pkSess_4581: bitstring = fail-any in
                                    {5439}in(c, =GetEndpointRequest);
                                    {5440}new SPs_4582: bitstring;
                                    {5441}new UP_4583: bitstring;
                                    {5442}out(c, (SPs_4582,SignAndEncrypt,UP_4583,pkSess_4581))
                    )
                    else
                        {5443}let pkCli_4584: bitstring = fail-any in
                        {5444}let v_4585: bool = (Sess_4247 = A) in
                        (
                            {5445}if v_4585 then
                            (
                                {5446}let pkSess_4586: bitstring = pub(skA) in
                                {5447}in(c, =GetEndpointRequest);
                                {5448}new SPs_4587: bitstring;
                                {5449}new UP_4588: bitstring;
                                {5450}out(c, (SPs_4587,SignAndEncrypt,UP_4588,pkSess_4586))
                            )
                            else
                                {5451}let v_4589: bool = (Sess_4247 = B) in
                                (
                                    {5452}if v_4589 then
                                    (
                                        {5453}let pkSess_4590: bitstring = pub(skB) in
                                        {5454}in(c, =GetEndpointRequest);
                                        {5455}new SPs_4591: bitstring;
                                        {5456}new UP_4592: bitstring;
                                        {5457}out(c, (SPs_4591,SignAndEncrypt,UP_4592,pkSess_4590))
                                    )
                                    else
                                        {5458}let v_4593: bool = (Sess_4247 = C) in
                                        (
                                            {5459}if v_4593 then
                                            (
                                                {5460}let pkSess_4594: bitstring = pub(skC) in
                                                {5461}in(c, =GetEndpointRequest);
                                                {5462}new SPs_4595: bitstring;
                                                {5463}new UP_4596: bitstring;
                                                {5464}out(c, (SPs_4595,SignAndEncrypt,UP_4596,pkSess_4594))
                                            )
                                            else
                                                {5465}let pkSess_4597: bitstring = pub(skI) in
                                                {5466}in(c, =GetEndpointRequest);
                                                {5467}new SPs_4598: bitstring;
                                                {5468}new UP_4599: bitstring;
                                                {5469}out(c, (SPs_4598,SignAndEncrypt,UP_4599,pkSess_4597))
                                        )
                                        else
                                            {5470}let pkSess_4600: bitstring = fail-any in
                                            {5471}in(c, =GetEndpointRequest);
                                            {5472}new SPs_4601: bitstring;
                                            {5473}new UP_4602: bitstring;
                                            {5474}out(c, (SPs_4601,SignAndEncrypt,UP_4602,pkSess_4600))
                                )
                                else
                                    {5475}let pkSess_4603: bitstring = fail-any in
                                    {5476}in(c, =GetEndpointRequest);
                                    {5477}new SPs_4604: bitstring;
                                    {5478}new UP_4605: bitstring;
                                    {5479}out(c, (SPs_4604,SignAndEncrypt,UP_4605,pkSess_4603))
                        )
                        else
                            {5480}let pkSess_4606: bitstring = fail-any in
                            {5481}in(c, =GetEndpointRequest);
                            {5482}new SPs_4607: bitstring;
                            {5483}new UP_4608: bitstring;
                            {5484}out(c, (SPs_4607,SignAndEncrypt,UP_4608,pkSess_4606))
                )
                else
                    {5485}let v_4609: bool = (Disco_4246 = C) in
                    (
                        {5486}if v_4609 then
                        (
                            {5487}let skDisco_4610: bitstring = skC in
                            {5488}let pkDisco_4611: bitstring = pub(skDisco_4610) in
                            {5489}let v_4612: bool = (Cli_4245 = A) in
                            (
                                {5490}if v_4612 then
                                (
                                    {5491}let pkCli_4613: bitstring = pub(skA) in
                                    {5492}let v_4614: bool = (Sess_4247 = A) in
                                    (
                                        {5493}if v_4614 then
                                        (
                                            {5494}let pkSess_4615: bitstring = pub(skA) in
                                            {5495}in(c, =GetEndpointRequest);
                                            {5496}new SPs_4616: bitstring;
                                            {5497}new UP_4617: bitstring;
                                            {5498}out(c, (SPs_4616,SignAndEncrypt,UP_4617,pkSess_4615))
                                        )
                                        else
                                            {5499}let v_4618: bool = (Sess_4247 = B) in
                                            (
                                                {5500}if v_4618 then
                                                (
                                                    {5501}let pkSess_4619: bitstring = pub(skB) in
                                                    {5502}in(c, =GetEndpointRequest);
                                                    {5503}new SPs_4620: bitstring;
                                                    {5504}new UP_4621: bitstring;
                                                    {5505}out(c, (SPs_4620,SignAndEncrypt,UP_4621,pkSess_4619))
                                                )
                                                else
                                                    {5506}let v_4622: bool = (Sess_4247 = C) in
                                                    (
                                                        {5507}if v_4622 then
                                                        (
                                                            {5508}let pkSess_4623: bitstring = pub(skC) in
                                                            {5509}in(c, =GetEndpointRequest);
                                                            {5510}new SPs_4624: bitstring;
                                                            {5511}new UP_4625: bitstring;
                                                            {5512}out(c, (SPs_4624,SignAndEncrypt,UP_4625,pkSess_4623))
                                                        )
                                                        else
                                                            {5513}let pkSess_4626: bitstring = pub(skI) in
                                                            {5514}in(c, =GetEndpointRequest);
                                                            {5515}new SPs_4627: bitstring;
                                                            {5516}new UP_4628: bitstring;
                                                            {5517}out(c, (SPs_4627,SignAndEncrypt,UP_4628,pkSess_4626))
                                                    )
                                                    else
                                                        {5518}let pkSess_4629: bitstring = fail-any in
                                                        {5519}in(c, =GetEndpointRequest);
                                                        {5520}new SPs_4630: bitstring;
                                                        {5521}new UP_4631: bitstring;
                                                        {5522}out(c, (SPs_4630,SignAndEncrypt,UP_4631,pkSess_4629))
                                            )
                                            else
                                                {5523}let pkSess_4632: bitstring = fail-any in
                                                {5524}in(c, =GetEndpointRequest);
                                                {5525}new SPs_4633: bitstring;
                                                {5526}new UP_4634: bitstring;
                                                {5527}out(c, (SPs_4633,SignAndEncrypt,UP_4634,pkSess_4632))
                                    )
                                    else
                                        {5528}let pkSess_4635: bitstring = fail-any in
                                        {5529}in(c, =GetEndpointRequest);
                                        {5530}new SPs_4636: bitstring;
                                        {5531}new UP_4637: bitstring;
                                        {5532}out(c, (SPs_4636,SignAndEncrypt,UP_4637,pkSess_4635))
                                )
                                else
                                    {5533}let v_4638: bool = (Cli_4245 = B) in
                                    (
                                        {5534}if v_4638 then
                                        (
                                            {5535}let pkCli_4639: bitstring = pub(skB) in
                                            {5536}let v_4640: bool = (Sess_4247 = A) in
                                            (
                                                {5537}if v_4640 then
                                                (
                                                    {5538}let pkSess_4641: bitstring = pub(skA) in
                                                    {5539}in(c, =GetEndpointRequest);
                                                    {5540}new SPs_4642: bitstring;
                                                    {5541}new UP_4643: bitstring;
                                                    {5542}out(c, (SPs_4642,SignAndEncrypt,UP_4643,pkSess_4641))
                                                )
                                                else
                                                    {5543}let v_4644: bool = (Sess_4247 = B) in
                                                    (
                                                        {5544}if v_4644 then
                                                        (
                                                            {5545}let pkSess_4645: bitstring = pub(skB) in
                                                            {5546}in(c, =GetEndpointRequest);
                                                            {5547}new SPs_4646: bitstring;
                                                            {5548}new UP_4647: bitstring;
                                                            {5549}out(c, (SPs_4646,SignAndEncrypt,UP_4647,pkSess_4645))
                                                        )
                                                        else
                                                            {5550}let v_4648: bool = (Sess_4247 = C) in
                                                            (
                                                                {5551}if v_4648 then
                                                                (
                                                                    {5552}let pkSess_4649: bitstring = pub(skC) in
                                                                    {5553}in(c, =GetEndpointRequest);
                                                                    {5554}new SPs_4650: bitstring;
                                                                    {5555}new UP_4651: bitstring;
                                                                    {5556}out(c, (SPs_4650,SignAndEncrypt,UP_4651,pkSess_4649))
                                                                )
                                                                else
                                                                    {5557}let pkSess_4652: bitstring = pub(skI) in
                                                                    {5558}in(c, =GetEndpointRequest);
                                                                    {5559}new SPs_4653: bitstring;
                                                                    {5560}new UP_4654: bitstring;
                                                                    {5561}out(c, (SPs_4653,SignAndEncrypt,UP_4654,pkSess_4652))
                                                            )
                                                            else
                                                                {5562}let pkSess_4655: bitstring = fail-any in
                                                                {5563}in(c, =GetEndpointRequest);
                                                                {5564}new SPs_4656: bitstring;
                                                                {5565}new UP_4657: bitstring;
                                                                {5566}out(c, (SPs_4656,SignAndEncrypt,UP_4657,pkSess_4655))
                                                    )
                                                    else
                                                        {5567}let pkSess_4658: bitstring = fail-any in
                                                        {5568}in(c, =GetEndpointRequest);
                                                        {5569}new SPs_4659: bitstring;
                                                        {5570}new UP_4660: bitstring;
                                                        {5571}out(c, (SPs_4659,SignAndEncrypt,UP_4660,pkSess_4658))
                                            )
                                            else
                                                {5572}let pkSess_4661: bitstring = fail-any in
                                                {5573}in(c, =GetEndpointRequest);
                                                {5574}new SPs_4662: bitstring;
                                                {5575}new UP_4663: bitstring;
                                                {5576}out(c, (SPs_4662,SignAndEncrypt,UP_4663,pkSess_4661))
                                        )
                                        else
                                            {5577}let v_4664: bool = (Cli_4245 = C) in
                                            (
                                                {5578}if v_4664 then
                                                (
                                                    {5579}let pkCli_4665: bitstring = pub(skC) in
                                                    {5580}let v_4666: bool = (Sess_4247 = A) in
                                                    (
                                                        {5581}if v_4666 then
                                                        (
                                                            {5582}let pkSess_4667: bitstring = pub(skA) in
                                                            {5583}in(c, =GetEndpointRequest);
                                                            {5584}new SPs_4668: bitstring;
                                                            {5585}new UP_4669: bitstring;
                                                            {5586}out(c, (SPs_4668,SignAndEncrypt,UP_4669,pkSess_4667))
                                                        )
                                                        else
                                                            {5587}let v_4670: bool = (Sess_4247 = B) in
                                                            (
                                                                {5588}if v_4670 then
                                                                (
                                                                    {5589}let pkSess_4671: bitstring = pub(skB) in
                                                                    {5590}in(c, =GetEndpointRequest);
                                                                    {5591}new SPs_4672: bitstring;
                                                                    {5592}new UP_4673: bitstring;
                                                                    {5593}out(c, (SPs_4672,SignAndEncrypt,UP_4673,pkSess_4671))
                                                                )
                                                                else
                                                                    {5594}let v_4674: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5595}if v_4674 then
                                                                        (
                                                                            {5596}let pkSess_4675: bitstring = pub(skC) in
                                                                            {5597}in(c, =GetEndpointRequest);
                                                                            {5598}new SPs_4676: bitstring;
                                                                            {5599}new UP_4677: bitstring;
                                                                            {5600}out(c, (SPs_4676,SignAndEncrypt,UP_4677,pkSess_4675))
                                                                        )
                                                                        else
                                                                            {5601}let pkSess_4678: bitstring = pub(skI) in
                                                                            {5602}in(c, =GetEndpointRequest);
                                                                            {5603}new SPs_4679: bitstring;
                                                                            {5604}new UP_4680: bitstring;
                                                                            {5605}out(c, (SPs_4679,SignAndEncrypt,UP_4680,pkSess_4678))
                                                                    )
                                                                    else
                                                                        {5606}let pkSess_4681: bitstring = fail-any in
                                                                        {5607}in(c, =GetEndpointRequest);
                                                                        {5608}new SPs_4682: bitstring;
                                                                        {5609}new UP_4683: bitstring;
                                                                        {5610}out(c, (SPs_4682,SignAndEncrypt,UP_4683,pkSess_4681))
                                                            )
                                                            else
                                                                {5611}let pkSess_4684: bitstring = fail-any in
                                                                {5612}in(c, =GetEndpointRequest);
                                                                {5613}new SPs_4685: bitstring;
                                                                {5614}new UP_4686: bitstring;
                                                                {5615}out(c, (SPs_4685,SignAndEncrypt,UP_4686,pkSess_4684))
                                                    )
                                                    else
                                                        {5616}let pkSess_4687: bitstring = fail-any in
                                                        {5617}in(c, =GetEndpointRequest);
                                                        {5618}new SPs_4688: bitstring;
                                                        {5619}new UP_4689: bitstring;
                                                        {5620}out(c, (SPs_4688,SignAndEncrypt,UP_4689,pkSess_4687))
                                                )
                                                else
                                                    {5621}let pkCli_4690: bitstring = pub(skI) in
                                                    {5622}let v_4691: bool = (Sess_4247 = A) in
                                                    (
                                                        {5623}if v_4691 then
                                                        (
                                                            {5624}let pkSess_4692: bitstring = pub(skA) in
                                                            {5625}in(c, =GetEndpointRequest);
                                                            {5626}new SPs_4693: bitstring;
                                                            {5627}new UP_4694: bitstring;
                                                            {5628}out(c, (SPs_4693,SignAndEncrypt,UP_4694,pkSess_4692))
                                                        )
                                                        else
                                                            {5629}let v_4695: bool = (Sess_4247 = B) in
                                                            (
                                                                {5630}if v_4695 then
                                                                (
                                                                    {5631}let pkSess_4696: bitstring = pub(skB) in
                                                                    {5632}in(c, =GetEndpointRequest);
                                                                    {5633}new SPs_4697: bitstring;
                                                                    {5634}new UP_4698: bitstring;
                                                                    {5635}out(c, (SPs_4697,SignAndEncrypt,UP_4698,pkSess_4696))
                                                                )
                                                                else
                                                                    {5636}let v_4699: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5637}if v_4699 then
                                                                        (
                                                                            {5638}let pkSess_4700: bitstring = pub(skC) in
                                                                            {5639}in(c, =GetEndpointRequest);
                                                                            {5640}new SPs_4701: bitstring;
                                                                            {5641}new UP_4702: bitstring;
                                                                            {5642}out(c, (SPs_4701,SignAndEncrypt,UP_4702,pkSess_4700))
                                                                        )
                                                                        else
                                                                            {5643}let pkSess_4703: bitstring = pub(skI) in
                                                                            {5644}in(c, =GetEndpointRequest);
                                                                            {5645}new SPs_4704: bitstring;
                                                                            {5646}new UP_4705: bitstring;
                                                                            {5647}out(c, (SPs_4704,SignAndEncrypt,UP_4705,pkSess_4703))
                                                                    )
                                                                    else
                                                                        {5648}let pkSess_4706: bitstring = fail-any in
                                                                        {5649}in(c, =GetEndpointRequest);
                                                                        {5650}new SPs_4707: bitstring;
                                                                        {5651}new UP_4708: bitstring;
                                                                        {5652}out(c, (SPs_4707,SignAndEncrypt,UP_4708,pkSess_4706))
                                                            )
                                                            else
                                                                {5653}let pkSess_4709: bitstring = fail-any in
                                                                {5654}in(c, =GetEndpointRequest);
                                                                {5655}new SPs_4710: bitstring;
                                                                {5656}new UP_4711: bitstring;
                                                                {5657}out(c, (SPs_4710,SignAndEncrypt,UP_4711,pkSess_4709))
                                                    )
                                                    else
                                                        {5658}let pkSess_4712: bitstring = fail-any in
                                                        {5659}in(c, =GetEndpointRequest);
                                                        {5660}new SPs_4713: bitstring;
                                                        {5661}new UP_4714: bitstring;
                                                        {5662}out(c, (SPs_4713,SignAndEncrypt,UP_4714,pkSess_4712))
                                            )
                                            else
                                                {5663}let pkCli_4715: bitstring = fail-any in
                                                {5664}let v_4716: bool = (Sess_4247 = A) in
                                                (
                                                    {5665}if v_4716 then
                                                    (
                                                        {5666}let pkSess_4717: bitstring = pub(skA) in
                                                        {5667}in(c, =GetEndpointRequest);
                                                        {5668}new SPs_4718: bitstring;
                                                        {5669}new UP_4719: bitstring;
                                                        {5670}out(c, (SPs_4718,SignAndEncrypt,UP_4719,pkSess_4717))
                                                    )
                                                    else
                                                        {5671}let v_4720: bool = (Sess_4247 = B) in
                                                        (
                                                            {5672}if v_4720 then
                                                            (
                                                                {5673}let pkSess_4721: bitstring = pub(skB) in
                                                                {5674}in(c, =GetEndpointRequest);
                                                                {5675}new SPs_4722: bitstring;
                                                                {5676}new UP_4723: bitstring;
                                                                {5677}out(c, (SPs_4722,SignAndEncrypt,UP_4723,pkSess_4721))
                                                            )
                                                            else
                                                                {5678}let v_4724: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5679}if v_4724 then
                                                                    (
                                                                        {5680}let pkSess_4725: bitstring = pub(skC) in
                                                                        {5681}in(c, =GetEndpointRequest);
                                                                        {5682}new SPs_4726: bitstring;
                                                                        {5683}new UP_4727: bitstring;
                                                                        {5684}out(c, (SPs_4726,SignAndEncrypt,UP_4727,pkSess_4725))
                                                                    )
                                                                    else
                                                                        {5685}let pkSess_4728: bitstring = pub(skI) in
                                                                        {5686}in(c, =GetEndpointRequest);
                                                                        {5687}new SPs_4729: bitstring;
                                                                        {5688}new UP_4730: bitstring;
                                                                        {5689}out(c, (SPs_4729,SignAndEncrypt,UP_4730,pkSess_4728))
                                                                )
                                                                else
                                                                    {5690}let pkSess_4731: bitstring = fail-any in
                                                                    {5691}in(c, =GetEndpointRequest);
                                                                    {5692}new SPs_4732: bitstring;
                                                                    {5693}new UP_4733: bitstring;
                                                                    {5694}out(c, (SPs_4732,SignAndEncrypt,UP_4733,pkSess_4731))
                                                        )
                                                        else
                                                            {5695}let pkSess_4734: bitstring = fail-any in
                                                            {5696}in(c, =GetEndpointRequest);
                                                            {5697}new SPs_4735: bitstring;
                                                            {5698}new UP_4736: bitstring;
                                                            {5699}out(c, (SPs_4735,SignAndEncrypt,UP_4736,pkSess_4734))
                                                )
                                                else
                                                    {5700}let pkSess_4737: bitstring = fail-any in
                                                    {5701}in(c, =GetEndpointRequest);
                                                    {5702}new SPs_4738: bitstring;
                                                    {5703}new UP_4739: bitstring;
                                                    {5704}out(c, (SPs_4738,SignAndEncrypt,UP_4739,pkSess_4737))
                                    )
                                    else
                                        {5705}let pkCli_4740: bitstring = fail-any in
                                        {5706}let v_4741: bool = (Sess_4247 = A) in
                                        (
                                            {5707}if v_4741 then
                                            (
                                                {5708}let pkSess_4742: bitstring = pub(skA) in
                                                {5709}in(c, =GetEndpointRequest);
                                                {5710}new SPs_4743: bitstring;
                                                {5711}new UP_4744: bitstring;
                                                {5712}out(c, (SPs_4743,SignAndEncrypt,UP_4744,pkSess_4742))
                                            )
                                            else
                                                {5713}let v_4745: bool = (Sess_4247 = B) in
                                                (
                                                    {5714}if v_4745 then
                                                    (
                                                        {5715}let pkSess_4746: bitstring = pub(skB) in
                                                        {5716}in(c, =GetEndpointRequest);
                                                        {5717}new SPs_4747: bitstring;
                                                        {5718}new UP_4748: bitstring;
                                                        {5719}out(c, (SPs_4747,SignAndEncrypt,UP_4748,pkSess_4746))
                                                    )
                                                    else
                                                        {5720}let v_4749: bool = (Sess_4247 = C) in
                                                        (
                                                            {5721}if v_4749 then
                                                            (
                                                                {5722}let pkSess_4750: bitstring = pub(skC) in
                                                                {5723}in(c, =GetEndpointRequest);
                                                                {5724}new SPs_4751: bitstring;
                                                                {5725}new UP_4752: bitstring;
                                                                {5726}out(c, (SPs_4751,SignAndEncrypt,UP_4752,pkSess_4750))
                                                            )
                                                            else
                                                                {5727}let pkSess_4753: bitstring = pub(skI) in
                                                                {5728}in(c, =GetEndpointRequest);
                                                                {5729}new SPs_4754: bitstring;
                                                                {5730}new UP_4755: bitstring;
                                                                {5731}out(c, (SPs_4754,SignAndEncrypt,UP_4755,pkSess_4753))
                                                        )
                                                        else
                                                            {5732}let pkSess_4756: bitstring = fail-any in
                                                            {5733}in(c, =GetEndpointRequest);
                                                            {5734}new SPs_4757: bitstring;
                                                            {5735}new UP_4758: bitstring;
                                                            {5736}out(c, (SPs_4757,SignAndEncrypt,UP_4758,pkSess_4756))
                                                )
                                                else
                                                    {5737}let pkSess_4759: bitstring = fail-any in
                                                    {5738}in(c, =GetEndpointRequest);
                                                    {5739}new SPs_4760: bitstring;
                                                    {5740}new UP_4761: bitstring;
                                                    {5741}out(c, (SPs_4760,SignAndEncrypt,UP_4761,pkSess_4759))
                                        )
                                        else
                                            {5742}let pkSess_4762: bitstring = fail-any in
                                            {5743}in(c, =GetEndpointRequest);
                                            {5744}new SPs_4763: bitstring;
                                            {5745}new UP_4764: bitstring;
                                            {5746}out(c, (SPs_4763,SignAndEncrypt,UP_4764,pkSess_4762))
                            )
                            else
                                {5747}let pkCli_4765: bitstring = fail-any in
                                {5748}let v_4766: bool = (Sess_4247 = A) in
                                (
                                    {5749}if v_4766 then
                                    (
                                        {5750}let pkSess_4767: bitstring = pub(skA) in
                                        {5751}in(c, =GetEndpointRequest);
                                        {5752}new SPs_4768: bitstring;
                                        {5753}new UP_4769: bitstring;
                                        {5754}out(c, (SPs_4768,SignAndEncrypt,UP_4769,pkSess_4767))
                                    )
                                    else
                                        {5755}let v_4770: bool = (Sess_4247 = B) in
                                        (
                                            {5756}if v_4770 then
                                            (
                                                {5757}let pkSess_4771: bitstring = pub(skB) in
                                                {5758}in(c, =GetEndpointRequest);
                                                {5759}new SPs_4772: bitstring;
                                                {5760}new UP_4773: bitstring;
                                                {5761}out(c, (SPs_4772,SignAndEncrypt,UP_4773,pkSess_4771))
                                            )
                                            else
                                                {5762}let v_4774: bool = (Sess_4247 = C) in
                                                (
                                                    {5763}if v_4774 then
                                                    (
                                                        {5764}let pkSess_4775: bitstring = pub(skC) in
                                                        {5765}in(c, =GetEndpointRequest);
                                                        {5766}new SPs_4776: bitstring;
                                                        {5767}new UP_4777: bitstring;
                                                        {5768}out(c, (SPs_4776,SignAndEncrypt,UP_4777,pkSess_4775))
                                                    )
                                                    else
                                                        {5769}let pkSess_4778: bitstring = pub(skI) in
                                                        {5770}in(c, =GetEndpointRequest);
                                                        {5771}new SPs_4779: bitstring;
                                                        {5772}new UP_4780: bitstring;
                                                        {5773}out(c, (SPs_4779,SignAndEncrypt,UP_4780,pkSess_4778))
                                                )
                                                else
                                                    {5774}let pkSess_4781: bitstring = fail-any in
                                                    {5775}in(c, =GetEndpointRequest);
                                                    {5776}new SPs_4782: bitstring;
                                                    {5777}new UP_4783: bitstring;
                                                    {5778}out(c, (SPs_4782,SignAndEncrypt,UP_4783,pkSess_4781))
                                        )
                                        else
                                            {5779}let pkSess_4784: bitstring = fail-any in
                                            {5780}in(c, =GetEndpointRequest);
                                            {5781}new SPs_4785: bitstring;
                                            {5782}new UP_4786: bitstring;
                                            {5783}out(c, (SPs_4785,SignAndEncrypt,UP_4786,pkSess_4784))
                                )
                                else
                                    {5784}let pkSess_4787: bitstring = fail-any in
                                    {5785}in(c, =GetEndpointRequest);
                                    {5786}new SPs_4788: bitstring;
                                    {5787}new UP_4789: bitstring;
                                    {5788}out(c, (SPs_4788,SignAndEncrypt,UP_4789,pkSess_4787))
                        )
                        else
                            {5789}let skDisco_4790: bitstring = skI in
                            {5790}let pkDisco_4791: bitstring = pub(skDisco_4790) in
                            {5791}let v_4792: bool = (Cli_4245 = A) in
                            (
                                {5792}if v_4792 then
                                (
                                    {5793}let pkCli_4793: bitstring = pub(skA) in
                                    {5794}let v_4794: bool = (Sess_4247 = A) in
                                    (
                                        {5795}if v_4794 then
                                        (
                                            {5796}let pkSess_4795: bitstring = pub(skA) in
                                            {5797}in(c, =GetEndpointRequest);
                                            {5798}new SPs_4796: bitstring;
                                            {5799}new UP_4797: bitstring;
                                            {5800}out(c, (SPs_4796,SignAndEncrypt,UP_4797,pkSess_4795))
                                        )
                                        else
                                            {5801}let v_4798: bool = (Sess_4247 = B) in
                                            (
                                                {5802}if v_4798 then
                                                (
                                                    {5803}let pkSess_4799: bitstring = pub(skB) in
                                                    {5804}in(c, =GetEndpointRequest);
                                                    {5805}new SPs_4800: bitstring;
                                                    {5806}new UP_4801: bitstring;
                                                    {5807}out(c, (SPs_4800,SignAndEncrypt,UP_4801,pkSess_4799))
                                                )
                                                else
                                                    {5808}let v_4802: bool = (Sess_4247 = C) in
                                                    (
                                                        {5809}if v_4802 then
                                                        (
                                                            {5810}let pkSess_4803: bitstring = pub(skC) in
                                                            {5811}in(c, =GetEndpointRequest);
                                                            {5812}new SPs_4804: bitstring;
                                                            {5813}new UP_4805: bitstring;
                                                            {5814}out(c, (SPs_4804,SignAndEncrypt,UP_4805,pkSess_4803))
                                                        )
                                                        else
                                                            {5815}let pkSess_4806: bitstring = pub(skI) in
                                                            {5816}in(c, =GetEndpointRequest);
                                                            {5817}new SPs_4807: bitstring;
                                                            {5818}new UP_4808: bitstring;
                                                            {5819}out(c, (SPs_4807,SignAndEncrypt,UP_4808,pkSess_4806))
                                                    )
                                                    else
                                                        {5820}let pkSess_4809: bitstring = fail-any in
                                                        {5821}in(c, =GetEndpointRequest);
                                                        {5822}new SPs_4810: bitstring;
                                                        {5823}new UP_4811: bitstring;
                                                        {5824}out(c, (SPs_4810,SignAndEncrypt,UP_4811,pkSess_4809))
                                            )
                                            else
                                                {5825}let pkSess_4812: bitstring = fail-any in
                                                {5826}in(c, =GetEndpointRequest);
                                                {5827}new SPs_4813: bitstring;
                                                {5828}new UP_4814: bitstring;
                                                {5829}out(c, (SPs_4813,SignAndEncrypt,UP_4814,pkSess_4812))
                                    )
                                    else
                                        {5830}let pkSess_4815: bitstring = fail-any in
                                        {5831}in(c, =GetEndpointRequest);
                                        {5832}new SPs_4816: bitstring;
                                        {5833}new UP_4817: bitstring;
                                        {5834}out(c, (SPs_4816,SignAndEncrypt,UP_4817,pkSess_4815))
                                )
                                else
                                    {5835}let v_4818: bool = (Cli_4245 = B) in
                                    (
                                        {5836}if v_4818 then
                                        (
                                            {5837}let pkCli_4819: bitstring = pub(skB) in
                                            {5838}let v_4820: bool = (Sess_4247 = A) in
                                            (
                                                {5839}if v_4820 then
                                                (
                                                    {5840}let pkSess_4821: bitstring = pub(skA) in
                                                    {5841}in(c, =GetEndpointRequest);
                                                    {5842}new SPs_4822: bitstring;
                                                    {5843}new UP_4823: bitstring;
                                                    {5844}out(c, (SPs_4822,SignAndEncrypt,UP_4823,pkSess_4821))
                                                )
                                                else
                                                    {5845}let v_4824: bool = (Sess_4247 = B) in
                                                    (
                                                        {5846}if v_4824 then
                                                        (
                                                            {5847}let pkSess_4825: bitstring = pub(skB) in
                                                            {5848}in(c, =GetEndpointRequest);
                                                            {5849}new SPs_4826: bitstring;
                                                            {5850}new UP_4827: bitstring;
                                                            {5851}out(c, (SPs_4826,SignAndEncrypt,UP_4827,pkSess_4825))
                                                        )
                                                        else
                                                            {5852}let v_4828: bool = (Sess_4247 = C) in
                                                            (
                                                                {5853}if v_4828 then
                                                                (
                                                                    {5854}let pkSess_4829: bitstring = pub(skC) in
                                                                    {5855}in(c, =GetEndpointRequest);
                                                                    {5856}new SPs_4830: bitstring;
                                                                    {5857}new UP_4831: bitstring;
                                                                    {5858}out(c, (SPs_4830,SignAndEncrypt,UP_4831,pkSess_4829))
                                                                )
                                                                else
                                                                    {5859}let pkSess_4832: bitstring = pub(skI) in
                                                                    {5860}in(c, =GetEndpointRequest);
                                                                    {5861}new SPs_4833: bitstring;
                                                                    {5862}new UP_4834: bitstring;
                                                                    {5863}out(c, (SPs_4833,SignAndEncrypt,UP_4834,pkSess_4832))
                                                            )
                                                            else
                                                                {5864}let pkSess_4835: bitstring = fail-any in
                                                                {5865}in(c, =GetEndpointRequest);
                                                                {5866}new SPs_4836: bitstring;
                                                                {5867}new UP_4837: bitstring;
                                                                {5868}out(c, (SPs_4836,SignAndEncrypt,UP_4837,pkSess_4835))
                                                    )
                                                    else
                                                        {5869}let pkSess_4838: bitstring = fail-any in
                                                        {5870}in(c, =GetEndpointRequest);
                                                        {5871}new SPs_4839: bitstring;
                                                        {5872}new UP_4840: bitstring;
                                                        {5873}out(c, (SPs_4839,SignAndEncrypt,UP_4840,pkSess_4838))
                                            )
                                            else
                                                {5874}let pkSess_4841: bitstring = fail-any in
                                                {5875}in(c, =GetEndpointRequest);
                                                {5876}new SPs_4842: bitstring;
                                                {5877}new UP_4843: bitstring;
                                                {5878}out(c, (SPs_4842,SignAndEncrypt,UP_4843,pkSess_4841))
                                        )
                                        else
                                            {5879}let v_4844: bool = (Cli_4245 = C) in
                                            (
                                                {5880}if v_4844 then
                                                (
                                                    {5881}let pkCli_4845: bitstring = pub(skC) in
                                                    {5882}let v_4846: bool = (Sess_4247 = A) in
                                                    (
                                                        {5883}if v_4846 then
                                                        (
                                                            {5884}let pkSess_4847: bitstring = pub(skA) in
                                                            {5885}in(c, =GetEndpointRequest);
                                                            {5886}new SPs_4848: bitstring;
                                                            {5887}new UP_4849: bitstring;
                                                            {5888}out(c, (SPs_4848,SignAndEncrypt,UP_4849,pkSess_4847))
                                                        )
                                                        else
                                                            {5889}let v_4850: bool = (Sess_4247 = B) in
                                                            (
                                                                {5890}if v_4850 then
                                                                (
                                                                    {5891}let pkSess_4851: bitstring = pub(skB) in
                                                                    {5892}in(c, =GetEndpointRequest);
                                                                    {5893}new SPs_4852: bitstring;
                                                                    {5894}new UP_4853: bitstring;
                                                                    {5895}out(c, (SPs_4852,SignAndEncrypt,UP_4853,pkSess_4851))
                                                                )
                                                                else
                                                                    {5896}let v_4854: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5897}if v_4854 then
                                                                        (
                                                                            {5898}let pkSess_4855: bitstring = pub(skC) in
                                                                            {5899}in(c, =GetEndpointRequest);
                                                                            {5900}new SPs_4856: bitstring;
                                                                            {5901}new UP_4857: bitstring;
                                                                            {5902}out(c, (SPs_4856,SignAndEncrypt,UP_4857,pkSess_4855))
                                                                        )
                                                                        else
                                                                            {5903}let pkSess_4858: bitstring = pub(skI) in
                                                                            {5904}in(c, =GetEndpointRequest);
                                                                            {5905}new SPs_4859: bitstring;
                                                                            {5906}new UP_4860: bitstring;
                                                                            {5907}out(c, (SPs_4859,SignAndEncrypt,UP_4860,pkSess_4858))
                                                                    )
                                                                    else
                                                                        {5908}let pkSess_4861: bitstring = fail-any in
                                                                        {5909}in(c, =GetEndpointRequest);
                                                                        {5910}new SPs_4862: bitstring;
                                                                        {5911}new UP_4863: bitstring;
                                                                        {5912}out(c, (SPs_4862,SignAndEncrypt,UP_4863,pkSess_4861))
                                                            )
                                                            else
                                                                {5913}let pkSess_4864: bitstring = fail-any in
                                                                {5914}in(c, =GetEndpointRequest);
                                                                {5915}new SPs_4865: bitstring;
                                                                {5916}new UP_4866: bitstring;
                                                                {5917}out(c, (SPs_4865,SignAndEncrypt,UP_4866,pkSess_4864))
                                                    )
                                                    else
                                                        {5918}let pkSess_4867: bitstring = fail-any in
                                                        {5919}in(c, =GetEndpointRequest);
                                                        {5920}new SPs_4868: bitstring;
                                                        {5921}new UP_4869: bitstring;
                                                        {5922}out(c, (SPs_4868,SignAndEncrypt,UP_4869,pkSess_4867))
                                                )
                                                else
                                                    {5923}let pkCli_4870: bitstring = pub(skI) in
                                                    {5924}let v_4871: bool = (Sess_4247 = A) in
                                                    (
                                                        {5925}if v_4871 then
                                                        (
                                                            {5926}let pkSess_4872: bitstring = pub(skA) in
                                                            {5927}in(c, =GetEndpointRequest);
                                                            {5928}new SPs_4873: bitstring;
                                                            {5929}new UP_4874: bitstring;
                                                            {5930}out(c, (SPs_4873,SignAndEncrypt,UP_4874,pkSess_4872))
                                                        )
                                                        else
                                                            {5931}let v_4875: bool = (Sess_4247 = B) in
                                                            (
                                                                {5932}if v_4875 then
                                                                (
                                                                    {5933}let pkSess_4876: bitstring = pub(skB) in
                                                                    {5934}in(c, =GetEndpointRequest);
                                                                    {5935}new SPs_4877: bitstring;
                                                                    {5936}new UP_4878: bitstring;
                                                                    {5937}out(c, (SPs_4877,SignAndEncrypt,UP_4878,pkSess_4876))
                                                                )
                                                                else
                                                                    {5938}let v_4879: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5939}if v_4879 then
                                                                        (
                                                                            {5940}let pkSess_4880: bitstring = pub(skC) in
                                                                            {5941}in(c, =GetEndpointRequest);
                                                                            {5942}new SPs_4881: bitstring;
                                                                            {5943}new UP_4882: bitstring;
                                                                            {5944}out(c, (SPs_4881,SignAndEncrypt,UP_4882,pkSess_4880))
                                                                        )
                                                                        else
                                                                            {5945}let pkSess_4883: bitstring = pub(skI) in
                                                                            {5946}in(c, =GetEndpointRequest);
                                                                            {5947}new SPs_4884: bitstring;
                                                                            {5948}new UP_4885: bitstring;
                                                                            {5949}out(c, (SPs_4884,SignAndEncrypt,UP_4885,pkSess_4883))
                                                                    )
                                                                    else
                                                                        {5950}let pkSess_4886: bitstring = fail-any in
                                                                        {5951}in(c, =GetEndpointRequest);
                                                                        {5952}new SPs_4887: bitstring;
                                                                        {5953}new UP_4888: bitstring;
                                                                        {5954}out(c, (SPs_4887,SignAndEncrypt,UP_4888,pkSess_4886))
                                                            )
                                                            else
                                                                {5955}let pkSess_4889: bitstring = fail-any in
                                                                {5956}in(c, =GetEndpointRequest);
                                                                {5957}new SPs_4890: bitstring;
                                                                {5958}new UP_4891: bitstring;
                                                                {5959}out(c, (SPs_4890,SignAndEncrypt,UP_4891,pkSess_4889))
                                                    )
                                                    else
                                                        {5960}let pkSess_4892: bitstring = fail-any in
                                                        {5961}in(c, =GetEndpointRequest);
                                                        {5962}new SPs_4893: bitstring;
                                                        {5963}new UP_4894: bitstring;
                                                        {5964}out(c, (SPs_4893,SignAndEncrypt,UP_4894,pkSess_4892))
                                            )
                                            else
                                                {5965}let pkCli_4895: bitstring = fail-any in
                                                {5966}let v_4896: bool = (Sess_4247 = A) in
                                                (
                                                    {5967}if v_4896 then
                                                    (
                                                        {5968}let pkSess_4897: bitstring = pub(skA) in
                                                        {5969}in(c, =GetEndpointRequest);
                                                        {5970}new SPs_4898: bitstring;
                                                        {5971}new UP_4899: bitstring;
                                                        {5972}out(c, (SPs_4898,SignAndEncrypt,UP_4899,pkSess_4897))
                                                    )
                                                    else
                                                        {5973}let v_4900: bool = (Sess_4247 = B) in
                                                        (
                                                            {5974}if v_4900 then
                                                            (
                                                                {5975}let pkSess_4901: bitstring = pub(skB) in
                                                                {5976}in(c, =GetEndpointRequest);
                                                                {5977}new SPs_4902: bitstring;
                                                                {5978}new UP_4903: bitstring;
                                                                {5979}out(c, (SPs_4902,SignAndEncrypt,UP_4903,pkSess_4901))
                                                            )
                                                            else
                                                                {5980}let v_4904: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5981}if v_4904 then
                                                                    (
                                                                        {5982}let pkSess_4905: bitstring = pub(skC) in
                                                                        {5983}in(c, =GetEndpointRequest);
                                                                        {5984}new SPs_4906: bitstring;
                                                                        {5985}new UP_4907: bitstring;
                                                                        {5986}out(c, (SPs_4906,SignAndEncrypt,UP_4907,pkSess_4905))
                                                                    )
                                                                    else
                                                                        {5987}let pkSess_4908: bitstring = pub(skI) in
                                                                        {5988}in(c, =GetEndpointRequest);
                                                                        {5989}new SPs_4909: bitstring;
                                                                        {5990}new UP_4910: bitstring;
                                                                        {5991}out(c, (SPs_4909,SignAndEncrypt,UP_4910,pkSess_4908))
                                                                )
                                                                else
                                                                    {5992}let pkSess_4911: bitstring = fail-any in
                                                                    {5993}in(c, =GetEndpointRequest);
                                                                    {5994}new SPs_4912: bitstring;
                                                                    {5995}new UP_4913: bitstring;
                                                                    {5996}out(c, (SPs_4912,SignAndEncrypt,UP_4913,pkSess_4911))
                                                        )
                                                        else
                                                            {5997}let pkSess_4914: bitstring = fail-any in
                                                            {5998}in(c, =GetEndpointRequest);
                                                            {5999}new SPs_4915: bitstring;
                                                            {6000}new UP_4916: bitstring;
                                                            {6001}out(c, (SPs_4915,SignAndEncrypt,UP_4916,pkSess_4914))
                                                )
                                                else
                                                    {6002}let pkSess_4917: bitstring = fail-any in
                                                    {6003}in(c, =GetEndpointRequest);
                                                    {6004}new SPs_4918: bitstring;
                                                    {6005}new UP_4919: bitstring;
                                                    {6006}out(c, (SPs_4918,SignAndEncrypt,UP_4919,pkSess_4917))
                                    )
                                    else
                                        {6007}let pkCli_4920: bitstring = fail-any in
                                        {6008}let v_4921: bool = (Sess_4247 = A) in
                                        (
                                            {6009}if v_4921 then
                                            (
                                                {6010}let pkSess_4922: bitstring = pub(skA) in
                                                {6011}in(c, =GetEndpointRequest);
                                                {6012}new SPs_4923: bitstring;
                                                {6013}new UP_4924: bitstring;
                                                {6014}out(c, (SPs_4923,SignAndEncrypt,UP_4924,pkSess_4922))
                                            )
                                            else
                                                {6015}let v_4925: bool = (Sess_4247 = B) in
                                                (
                                                    {6016}if v_4925 then
                                                    (
                                                        {6017}let pkSess_4926: bitstring = pub(skB) in
                                                        {6018}in(c, =GetEndpointRequest);
                                                        {6019}new SPs_4927: bitstring;
                                                        {6020}new UP_4928: bitstring;
                                                        {6021}out(c, (SPs_4927,SignAndEncrypt,UP_4928,pkSess_4926))
                                                    )
                                                    else
                                                        {6022}let v_4929: bool = (Sess_4247 = C) in
                                                        (
                                                            {6023}if v_4929 then
                                                            (
                                                                {6024}let pkSess_4930: bitstring = pub(skC) in
                                                                {6025}in(c, =GetEndpointRequest);
                                                                {6026}new SPs_4931: bitstring;
                                                                {6027}new UP_4932: bitstring;
                                                                {6028}out(c, (SPs_4931,SignAndEncrypt,UP_4932,pkSess_4930))
                                                            )
                                                            else
                                                                {6029}let pkSess_4933: bitstring = pub(skI) in
                                                                {6030}in(c, =GetEndpointRequest);
                                                                {6031}new SPs_4934: bitstring;
                                                                {6032}new UP_4935: bitstring;
                                                                {6033}out(c, (SPs_4934,SignAndEncrypt,UP_4935,pkSess_4933))
                                                        )
                                                        else
                                                            {6034}let pkSess_4936: bitstring = fail-any in
                                                            {6035}in(c, =GetEndpointRequest);
                                                            {6036}new SPs_4937: bitstring;
                                                            {6037}new UP_4938: bitstring;
                                                            {6038}out(c, (SPs_4937,SignAndEncrypt,UP_4938,pkSess_4936))
                                                )
                                                else
                                                    {6039}let pkSess_4939: bitstring = fail-any in
                                                    {6040}in(c, =GetEndpointRequest);
                                                    {6041}new SPs_4940: bitstring;
                                                    {6042}new UP_4941: bitstring;
                                                    {6043}out(c, (SPs_4940,SignAndEncrypt,UP_4941,pkSess_4939))
                                        )
                                        else
                                            {6044}let pkSess_4942: bitstring = fail-any in
                                            {6045}in(c, =GetEndpointRequest);
                                            {6046}new SPs_4943: bitstring;
                                            {6047}new UP_4944: bitstring;
                                            {6048}out(c, (SPs_4943,SignAndEncrypt,UP_4944,pkSess_4942))
                            )
                            else
                                {6049}let pkCli_4945: bitstring = fail-any in
                                {6050}let v_4946: bool = (Sess_4247 = A) in
                                (
                                    {6051}if v_4946 then
                                    (
                                        {6052}let pkSess_4947: bitstring = pub(skA) in
                                        {6053}in(c, =GetEndpointRequest);
                                        {6054}new SPs_4948: bitstring;
                                        {6055}new UP_4949: bitstring;
                                        {6056}out(c, (SPs_4948,SignAndEncrypt,UP_4949,pkSess_4947))
                                    )
                                    else
                                        {6057}let v_4950: bool = (Sess_4247 = B) in
                                        (
                                            {6058}if v_4950 then
                                            (
                                                {6059}let pkSess_4951: bitstring = pub(skB) in
                                                {6060}in(c, =GetEndpointRequest);
                                                {6061}new SPs_4952: bitstring;
                                                {6062}new UP_4953: bitstring;
                                                {6063}out(c, (SPs_4952,SignAndEncrypt,UP_4953,pkSess_4951))
                                            )
                                            else
                                                {6064}let v_4954: bool = (Sess_4247 = C) in
                                                (
                                                    {6065}if v_4954 then
                                                    (
                                                        {6066}let pkSess_4955: bitstring = pub(skC) in
                                                        {6067}in(c, =GetEndpointRequest);
                                                        {6068}new SPs_4956: bitstring;
                                                        {6069}new UP_4957: bitstring;
                                                        {6070}out(c, (SPs_4956,SignAndEncrypt,UP_4957,pkSess_4955))
                                                    )
                                                    else
                                                        {6071}let pkSess_4958: bitstring = pub(skI) in
                                                        {6072}in(c, =GetEndpointRequest);
                                                        {6073}new SPs_4959: bitstring;
                                                        {6074}new UP_4960: bitstring;
                                                        {6075}out(c, (SPs_4959,SignAndEncrypt,UP_4960,pkSess_4958))
                                                )
                                                else
                                                    {6076}let pkSess_4961: bitstring = fail-any in
                                                    {6077}in(c, =GetEndpointRequest);
                                                    {6078}new SPs_4962: bitstring;
                                                    {6079}new UP_4963: bitstring;
                                                    {6080}out(c, (SPs_4962,SignAndEncrypt,UP_4963,pkSess_4961))
                                        )
                                        else
                                            {6081}let pkSess_4964: bitstring = fail-any in
                                            {6082}in(c, =GetEndpointRequest);
                                            {6083}new SPs_4965: bitstring;
                                            {6084}new UP_4966: bitstring;
                                            {6085}out(c, (SPs_4965,SignAndEncrypt,UP_4966,pkSess_4964))
                                )
                                else
                                    {6086}let pkSess_4967: bitstring = fail-any in
                                    {6087}in(c, =GetEndpointRequest);
                                    {6088}new SPs_4968: bitstring;
                                    {6089}new UP_4969: bitstring;
                                    {6090}out(c, (SPs_4968,SignAndEncrypt,UP_4969,pkSess_4967))
                    )
                    else
                        {6091}let skDisco_4970: bitstring = fail-any in
                        {6092}let pkDisco_4971: bitstring = pub(skDisco_4970) in
                        {6093}let v_4972: bool = (Cli_4245 = A) in
                        (
                            {6094}if v_4972 then
                            (
                                {6095}let pkCli_4973: bitstring = pub(skA) in
                                {6096}let v_4974: bool = (Sess_4247 = A) in
                                (
                                    {6097}if v_4974 then
                                    (
                                        {6098}let pkSess_4975: bitstring = pub(skA) in
                                        {6099}in(c, =GetEndpointRequest);
                                        {6100}new SPs_4976: bitstring;
                                        {6101}new UP_4977: bitstring;
                                        {6102}out(c, (SPs_4976,SignAndEncrypt,UP_4977,pkSess_4975))
                                    )
                                    else
                                        {6103}let v_4978: bool = (Sess_4247 = B) in
                                        (
                                            {6104}if v_4978 then
                                            (
                                                {6105}let pkSess_4979: bitstring = pub(skB) in
                                                {6106}in(c, =GetEndpointRequest);
                                                {6107}new SPs_4980: bitstring;
                                                {6108}new UP_4981: bitstring;
                                                {6109}out(c, (SPs_4980,SignAndEncrypt,UP_4981,pkSess_4979))
                                            )
                                            else
                                                {6110}let v_4982: bool = (Sess_4247 = C) in
                                                (
                                                    {6111}if v_4982 then
                                                    (
                                                        {6112}let pkSess_4983: bitstring = pub(skC) in
                                                        {6113}in(c, =GetEndpointRequest);
                                                        {6114}new SPs_4984: bitstring;
                                                        {6115}new UP_4985: bitstring;
                                                        {6116}out(c, (SPs_4984,SignAndEncrypt,UP_4985,pkSess_4983))
                                                    )
                                                    else
                                                        {6117}let pkSess_4986: bitstring = pub(skI) in
                                                        {6118}in(c, =GetEndpointRequest);
                                                        {6119}new SPs_4987: bitstring;
                                                        {6120}new UP_4988: bitstring;
                                                        {6121}out(c, (SPs_4987,SignAndEncrypt,UP_4988,pkSess_4986))
                                                )
                                                else
                                                    {6122}let pkSess_4989: bitstring = fail-any in
                                                    {6123}in(c, =GetEndpointRequest);
                                                    {6124}new SPs_4990: bitstring;
                                                    {6125}new UP_4991: bitstring;
                                                    {6126}out(c, (SPs_4990,SignAndEncrypt,UP_4991,pkSess_4989))
                                        )
                                        else
                                            {6127}let pkSess_4992: bitstring = fail-any in
                                            {6128}in(c, =GetEndpointRequest);
                                            {6129}new SPs_4993: bitstring;
                                            {6130}new UP_4994: bitstring;
                                            {6131}out(c, (SPs_4993,SignAndEncrypt,UP_4994,pkSess_4992))
                                )
                                else
                                    {6132}let pkSess_4995: bitstring = fail-any in
                                    {6133}in(c, =GetEndpointRequest);
                                    {6134}new SPs_4996: bitstring;
                                    {6135}new UP_4997: bitstring;
                                    {6136}out(c, (SPs_4996,SignAndEncrypt,UP_4997,pkSess_4995))
                            )
                            else
                                {6137}let v_4998: bool = (Cli_4245 = B) in
                                (
                                    {6138}if v_4998 then
                                    (
                                        {6139}let pkCli_4999: bitstring = pub(skB) in
                                        {6140}let v_5000: bool = (Sess_4247 = A) in
                                        (
                                            {6141}if v_5000 then
                                            (
                                                {6142}let pkSess_5001: bitstring = pub(skA) in
                                                {6143}in(c, =GetEndpointRequest);
                                                {6144}new SPs_5002: bitstring;
                                                {6145}new UP_5003: bitstring;
                                                {6146}out(c, (SPs_5002,SignAndEncrypt,UP_5003,pkSess_5001))
                                            )
                                            else
                                                {6147}let v_5004: bool = (Sess_4247 = B) in
                                                (
                                                    {6148}if v_5004 then
                                                    (
                                                        {6149}let pkSess_5005: bitstring = pub(skB) in
                                                        {6150}in(c, =GetEndpointRequest);
                                                        {6151}new SPs_5006: bitstring;
                                                        {6152}new UP_5007: bitstring;
                                                        {6153}out(c, (SPs_5006,SignAndEncrypt,UP_5007,pkSess_5005))
                                                    )
                                                    else
                                                        {6154}let v_5008: bool = (Sess_4247 = C) in
                                                        (
                                                            {6155}if v_5008 then
                                                            (
                                                                {6156}let pkSess_5009: bitstring = pub(skC) in
                                                                {6157}in(c, =GetEndpointRequest);
                                                                {6158}new SPs_5010: bitstring;
                                                                {6159}new UP_5011: bitstring;
                                                                {6160}out(c, (SPs_5010,SignAndEncrypt,UP_5011,pkSess_5009))
                                                            )
                                                            else
                                                                {6161}let pkSess_5012: bitstring = pub(skI) in
                                                                {6162}in(c, =GetEndpointRequest);
                                                                {6163}new SPs_5013: bitstring;
                                                                {6164}new UP_5014: bitstring;
                                                                {6165}out(c, (SPs_5013,SignAndEncrypt,UP_5014,pkSess_5012))
                                                        )
                                                        else
                                                            {6166}let pkSess_5015: bitstring = fail-any in
                                                            {6167}in(c, =GetEndpointRequest);
                                                            {6168}new SPs_5016: bitstring;
                                                            {6169}new UP_5017: bitstring;
                                                            {6170}out(c, (SPs_5016,SignAndEncrypt,UP_5017,pkSess_5015))
                                                )
                                                else
                                                    {6171}let pkSess_5018: bitstring = fail-any in
                                                    {6172}in(c, =GetEndpointRequest);
                                                    {6173}new SPs_5019: bitstring;
                                                    {6174}new UP_5020: bitstring;
                                                    {6175}out(c, (SPs_5019,SignAndEncrypt,UP_5020,pkSess_5018))
                                        )
                                        else
                                            {6176}let pkSess_5021: bitstring = fail-any in
                                            {6177}in(c, =GetEndpointRequest);
                                            {6178}new SPs_5022: bitstring;
                                            {6179}new UP_5023: bitstring;
                                            {6180}out(c, (SPs_5022,SignAndEncrypt,UP_5023,pkSess_5021))
                                    )
                                    else
                                        {6181}let v_5024: bool = (Cli_4245 = C) in
                                        (
                                            {6182}if v_5024 then
                                            (
                                                {6183}let pkCli_5025: bitstring = pub(skC) in
                                                {6184}let v_5026: bool = (Sess_4247 = A) in
                                                (
                                                    {6185}if v_5026 then
                                                    (
                                                        {6186}let pkSess_5027: bitstring = pub(skA) in
                                                        {6187}in(c, =GetEndpointRequest);
                                                        {6188}new SPs_5028: bitstring;
                                                        {6189}new UP_5029: bitstring;
                                                        {6190}out(c, (SPs_5028,SignAndEncrypt,UP_5029,pkSess_5027))
                                                    )
                                                    else
                                                        {6191}let v_5030: bool = (Sess_4247 = B) in
                                                        (
                                                            {6192}if v_5030 then
                                                            (
                                                                {6193}let pkSess_5031: bitstring = pub(skB) in
                                                                {6194}in(c, =GetEndpointRequest);
                                                                {6195}new SPs_5032: bitstring;
                                                                {6196}new UP_5033: bitstring;
                                                                {6197}out(c, (SPs_5032,SignAndEncrypt,UP_5033,pkSess_5031))
                                                            )
                                                            else
                                                                {6198}let v_5034: bool = (Sess_4247 = C) in
                                                                (
                                                                    {6199}if v_5034 then
                                                                    (
                                                                        {6200}let pkSess_5035: bitstring = pub(skC) in
                                                                        {6201}in(c, =GetEndpointRequest);
                                                                        {6202}new SPs_5036: bitstring;
                                                                        {6203}new UP_5037: bitstring;
                                                                        {6204}out(c, (SPs_5036,SignAndEncrypt,UP_5037,pkSess_5035))
                                                                    )
                                                                    else
                                                                        {6205}let pkSess_5038: bitstring = pub(skI) in
                                                                        {6206}in(c, =GetEndpointRequest);
                                                                        {6207}new SPs_5039: bitstring;
                                                                        {6208}new UP_5040: bitstring;
                                                                        {6209}out(c, (SPs_5039,SignAndEncrypt,UP_5040,pkSess_5038))
                                                                )
                                                                else
                                                                    {6210}let pkSess_5041: bitstring = fail-any in
                                                                    {6211}in(c, =GetEndpointRequest);
                                                                    {6212}new SPs_5042: bitstring;
                                                                    {6213}new UP_5043: bitstring;
                                                                    {6214}out(c, (SPs_5042,SignAndEncrypt,UP_5043,pkSess_5041))
                                                        )
                                                        else
                                                            {6215}let pkSess_5044: bitstring = fail-any in
                                                            {6216}in(c, =GetEndpointRequest);
                                                            {6217}new SPs_5045: bitstring;
                                                            {6218}new UP_5046: bitstring;
                                                            {6219}out(c, (SPs_5045,SignAndEncrypt,UP_5046,pkSess_5044))
                                                )
                                                else
                                                    {6220}let pkSess_5047: bitstring = fail-any in
                                                    {6221}in(c, =GetEndpointRequest);
                                                    {6222}new SPs_5048: bitstring;
                                                    {6223}new UP_5049: bitstring;
                                                    {6224}out(c, (SPs_5048,SignAndEncrypt,UP_5049,pkSess_5047))
                                            )
                                            else
                                                {6225}let pkCli_5050: bitstring = pub(skI) in
                                                {6226}let v_5051: bool = (Sess_4247 = A) in
                                                (
                                                    {6227}if v_5051 then
                                                    (
                                                        {6228}let pkSess_5052: bitstring = pub(skA) in
                                                        {6229}in(c, =GetEndpointRequest);
                                                        {6230}new SPs_5053: bitstring;
                                                        {6231}new UP_5054: bitstring;
                                                        {6232}out(c, (SPs_5053,SignAndEncrypt,UP_5054,pkSess_5052))
                                                    )
                                                    else
                                                        {6233}let v_5055: bool = (Sess_4247 = B) in
                                                        (
                                                            {6234}if v_5055 then
                                                            (
                                                                {6235}let pkSess_5056: bitstring = pub(skB) in
                                                                {6236}in(c, =GetEndpointRequest);
                                                                {6237}new SPs_5057: bitstring;
                                                                {6238}new UP_5058: bitstring;
                                                                {6239}out(c, (SPs_5057,SignAndEncrypt,UP_5058,pkSess_5056))
                                                            )
                                                            else
                                                                {6240}let v_5059: bool = (Sess_4247 = C) in
                                                                (
                                                                    {6241}if v_5059 then
                                                                    (
                                                                        {6242}let pkSess_5060: bitstring = pub(skC) in
                                                                        {6243}in(c, =GetEndpointRequest);
                                                                        {6244}new SPs_5061: bitstring;
                                                                        {6245}new UP_5062: bitstring;
                                                                        {6246}out(c, (SPs_5061,SignAndEncrypt,UP_5062,pkSess_5060))
                                                                    )
                                                                    else
                                                                        {6247}let pkSess_5063: bitstring = pub(skI) in
                                                                        {6248}in(c, =GetEndpointRequest);
                                                                        {6249}new SPs_5064: bitstring;
                                                                        {6250}new UP_5065: bitstring;
                                                                        {6251}out(c, (SPs_5064,SignAndEncrypt,UP_5065,pkSess_5063))
                                                                )
                                                                else
                                                                    {6252}let pkSess_5066: bitstring = fail-any in
                                                                    {6253}in(c, =GetEndpointRequest);
                                                                    {6254}new SPs_5067: bitstring;
                                                                    {6255}new UP_5068: bitstring;
                                                                    {6256}out(c, (SPs_5067,SignAndEncrypt,UP_5068,pkSess_5066))
                                                        )
                                                        else
                                                            {6257}let pkSess_5069: bitstring = fail-any in
                                                            {6258}in(c, =GetEndpointRequest);
                                                            {6259}new SPs_5070: bitstring;
                                                            {6260}new UP_5071: bitstring;
                                                            {6261}out(c, (SPs_5070,SignAndEncrypt,UP_5071,pkSess_5069))
                                                )
                                                else
                                                    {6262}let pkSess_5072: bitstring = fail-any in
                                                    {6263}in(c, =GetEndpointRequest);
                                                    {6264}new SPs_5073: bitstring;
                                                    {6265}new UP_5074: bitstring;
                                                    {6266}out(c, (SPs_5073,SignAndEncrypt,UP_5074,pkSess_5072))
                                        )
                                        else
                                            {6267}let pkCli_5075: bitstring = fail-any in
                                            {6268}let v_5076: bool = (Sess_4247 = A) in
                                            (
                                                {6269}if v_5076 then
                                                (
                                                    {6270}let pkSess_5077: bitstring = pub(skA) in
                                                    {6271}in(c, =GetEndpointRequest);
                                                    {6272}new SPs_5078: bitstring;
                                                    {6273}new UP_5079: bitstring;
                                                    {6274}out(c, (SPs_5078,SignAndEncrypt,UP_5079,pkSess_5077))
                                                )
                                                else
                                                    {6275}let v_5080: bool = (Sess_4247 = B) in
                                                    (
                                                        {6276}if v_5080 then
                                                        (
                                                            {6277}let pkSess_5081: bitstring = pub(skB) in
                                                            {6278}in(c, =GetEndpointRequest);
                                                            {6279}new SPs_5082: bitstring;
                                                            {6280}new UP_5083: bitstring;
                                                            {6281}out(c, (SPs_5082,SignAndEncrypt,UP_5083,pkSess_5081))
                                                        )
                                                        else
                                                            {6282}let v_5084: bool = (Sess_4247 = C) in
                                                            (
                                                                {6283}if v_5084 then
                                                                (
                                                                    {6284}let pkSess_5085: bitstring = pub(skC) in
                                                                    {6285}in(c, =GetEndpointRequest);
                                                                    {6286}new SPs_5086: bitstring;
                                                                    {6287}new UP_5087: bitstring;
                                                                    {6288}out(c, (SPs_5086,SignAndEncrypt,UP_5087,pkSess_5085))
                                                                )
                                                                else
                                                                    {6289}let pkSess_5088: bitstring = pub(skI) in
                                                                    {6290}in(c, =GetEndpointRequest);
                                                                    {6291}new SPs_5089: bitstring;
                                                                    {6292}new UP_5090: bitstring;
                                                                    {6293}out(c, (SPs_5089,SignAndEncrypt,UP_5090,pkSess_5088))
                                                            )
                                                            else
                                                                {6294}let pkSess_5091: bitstring = fail-any in
                                                                {6295}in(c, =GetEndpointRequest);
                                                                {6296}new SPs_5092: bitstring;
                                                                {6297}new UP_5093: bitstring;
                                                                {6298}out(c, (SPs_5092,SignAndEncrypt,UP_5093,pkSess_5091))
                                                    )
                                                    else
                                                        {6299}let pkSess_5094: bitstring = fail-any in
                                                        {6300}in(c, =GetEndpointRequest);
                                                        {6301}new SPs_5095: bitstring;
                                                        {6302}new UP_5096: bitstring;
                                                        {6303}out(c, (SPs_5095,SignAndEncrypt,UP_5096,pkSess_5094))
                                            )
                                            else
                                                {6304}let pkSess_5097: bitstring = fail-any in
                                                {6305}in(c, =GetEndpointRequest);
                                                {6306}new SPs_5098: bitstring;
                                                {6307}new UP_5099: bitstring;
                                                {6308}out(c, (SPs_5098,SignAndEncrypt,UP_5099,pkSess_5097))
                                )
                                else
                                    {6309}let pkCli_5100: bitstring = fail-any in
                                    {6310}let v_5101: bool = (Sess_4247 = A) in
                                    (
                                        {6311}if v_5101 then
                                        (
                                            {6312}let pkSess_5102: bitstring = pub(skA) in
                                            {6313}in(c, =GetEndpointRequest);
                                            {6314}new SPs_5103: bitstring;
                                            {6315}new UP_5104: bitstring;
                                            {6316}out(c, (SPs_5103,SignAndEncrypt,UP_5104,pkSess_5102))
                                        )
                                        else
                                            {6317}let v_5105: bool = (Sess_4247 = B) in
                                            (
                                                {6318}if v_5105 then
                                                (
                                                    {6319}let pkSess_5106: bitstring = pub(skB) in
                                                    {6320}in(c, =GetEndpointRequest);
                                                    {6321}new SPs_5107: bitstring;
                                                    {6322}new UP_5108: bitstring;
                                                    {6323}out(c, (SPs_5107,SignAndEncrypt,UP_5108,pkSess_5106))
                                                )
                                                else
                                                    {6324}let v_5109: bool = (Sess_4247 = C) in
                                                    (
                                                        {6325}if v_5109 then
                                                        (
                                                            {6326}let pkSess_5110: bitstring = pub(skC) in
                                                            {6327}in(c, =GetEndpointRequest);
                                                            {6328}new SPs_5111: bitstring;
                                                            {6329}new UP_5112: bitstring;
                                                            {6330}out(c, (SPs_5111,SignAndEncrypt,UP_5112,pkSess_5110))
                                                        )
                                                        else
                                                            {6331}let pkSess_5113: bitstring = pub(skI) in
                                                            {6332}in(c, =GetEndpointRequest);
                                                            {6333}new SPs_5114: bitstring;
                                                            {6334}new UP_5115: bitstring;
                                                            {6335}out(c, (SPs_5114,SignAndEncrypt,UP_5115,pkSess_5113))
                                                    )
                                                    else
                                                        {6336}let pkSess_5116: bitstring = fail-any in
                                                        {6337}in(c, =GetEndpointRequest);
                                                        {6338}new SPs_5117: bitstring;
                                                        {6339}new UP_5118: bitstring;
                                                        {6340}out(c, (SPs_5117,SignAndEncrypt,UP_5118,pkSess_5116))
                                            )
                                            else
                                                {6341}let pkSess_5119: bitstring = fail-any in
                                                {6342}in(c, =GetEndpointRequest);
                                                {6343}new SPs_5120: bitstring;
                                                {6344}new UP_5121: bitstring;
                                                {6345}out(c, (SPs_5120,SignAndEncrypt,UP_5121,pkSess_5119))
                                    )
                                    else
                                        {6346}let pkSess_5122: bitstring = fail-any in
                                        {6347}in(c, =GetEndpointRequest);
                                        {6348}new SPs_5123: bitstring;
                                        {6349}new UP_5124: bitstring;
                                        {6350}out(c, (SPs_5123,SignAndEncrypt,UP_5124,pkSess_5122))
                        )
                        else
                            {6351}let pkCli_5125: bitstring = fail-any in
                            {6352}let v_5126: bool = (Sess_4247 = A) in
                            (
                                {6353}if v_5126 then
                                (
                                    {6354}let pkSess_5127: bitstring = pub(skA) in
                                    {6355}in(c, =GetEndpointRequest);
                                    {6356}new SPs_5128: bitstring;
                                    {6357}new UP_5129: bitstring;
                                    {6358}out(c, (SPs_5128,SignAndEncrypt,UP_5129,pkSess_5127))
                                )
                                else
                                    {6359}let v_5130: bool = (Sess_4247 = B) in
                                    (
                                        {6360}if v_5130 then
                                        (
                                            {6361}let pkSess_5131: bitstring = pub(skB) in
                                            {6362}in(c, =GetEndpointRequest);
                                            {6363}new SPs_5132: bitstring;
                                            {6364}new UP_5133: bitstring;
                                            {6365}out(c, (SPs_5132,SignAndEncrypt,UP_5133,pkSess_5131))
                                        )
                                        else
                                            {6366}let v_5134: bool = (Sess_4247 = C) in
                                            (
                                                {6367}if v_5134 then
                                                (
                                                    {6368}let pkSess_5135: bitstring = pub(skC) in
                                                    {6369}in(c, =GetEndpointRequest);
                                                    {6370}new SPs_5136: bitstring;
                                                    {6371}new UP_5137: bitstring;
                                                    {6372}out(c, (SPs_5136,SignAndEncrypt,UP_5137,pkSess_5135))
                                                )
                                                else
                                                    {6373}let pkSess_5138: bitstring = pub(skI) in
                                                    {6374}in(c, =GetEndpointRequest);
                                                    {6375}new SPs_5139: bitstring;
                                                    {6376}new UP_5140: bitstring;
                                                    {6377}out(c, (SPs_5139,SignAndEncrypt,UP_5140,pkSess_5138))
                                            )
                                            else
                                                {6378}let pkSess_5141: bitstring = fail-any in
                                                {6379}in(c, =GetEndpointRequest);
                                                {6380}new SPs_5142: bitstring;
                                                {6381}new UP_5143: bitstring;
                                                {6382}out(c, (SPs_5142,SignAndEncrypt,UP_5143,pkSess_5141))
                                    )
                                    else
                                        {6383}let pkSess_5144: bitstring = fail-any in
                                        {6384}in(c, =GetEndpointRequest);
                                        {6385}new SPs_5145: bitstring;
                                        {6386}new UP_5146: bitstring;
                                        {6387}out(c, (SPs_5145,SignAndEncrypt,UP_5146,pkSess_5144))
                            )
                            else
                                {6388}let pkSess_5147: bitstring = fail-any in
                                {6389}in(c, =GetEndpointRequest);
                                {6390}new SPs_5148: bitstring;
                                {6391}new UP_5149: bitstring;
                                {6392}out(c, (SPs_5148,SignAndEncrypt,UP_5149,pkSess_5147))
            )
            else
                {6393}let skDisco_5150: bitstring = fail-any in
                {6394}let pkDisco_5151: bitstring = pub(skDisco_5150) in
                {6395}let v_5152: bool = (Cli_4245 = A) in
                (
                    {6396}if v_5152 then
                    (
                        {6397}let pkCli_5153: bitstring = pub(skA) in
                        {6398}let v_5154: bool = (Sess_4247 = A) in
                        (
                            {6399}if v_5154 then
                            (
                                {6400}let pkSess_5155: bitstring = pub(skA) in
                                {6401}in(c, =GetEndpointRequest);
                                {6402}new SPs_5156: bitstring;
                                {6403}new UP_5157: bitstring;
                                {6404}out(c, (SPs_5156,SignAndEncrypt,UP_5157,pkSess_5155))
                            )
                            else
                                {6405}let v_5158: bool = (Sess_4247 = B) in
                                (
                                    {6406}if v_5158 then
                                    (
                                        {6407}let pkSess_5159: bitstring = pub(skB) in
                                        {6408}in(c, =GetEndpointRequest);
                                        {6409}new SPs_5160: bitstring;
                                        {6410}new UP_5161: bitstring;
                                        {6411}out(c, (SPs_5160,SignAndEncrypt,UP_5161,pkSess_5159))
                                    )
                                    else
                                        {6412}let v_5162: bool = (Sess_4247 = C) in
                                        (
                                            {6413}if v_5162 then
                                            (
                                                {6414}let pkSess_5163: bitstring = pub(skC) in
                                                {6415}in(c, =GetEndpointRequest);
                                                {6416}new SPs_5164: bitstring;
                                                {6417}new UP_5165: bitstring;
                                                {6418}out(c, (SPs_5164,SignAndEncrypt,UP_5165,pkSess_5163))
                                            )
                                            else
                                                {6419}let pkSess_5166: bitstring = pub(skI) in
                                                {6420}in(c, =GetEndpointRequest);
                                                {6421}new SPs_5167: bitstring;
                                                {6422}new UP_5168: bitstring;
                                                {6423}out(c, (SPs_5167,SignAndEncrypt,UP_5168,pkSess_5166))
                                        )
                                        else
                                            {6424}let pkSess_5169: bitstring = fail-any in
                                            {6425}in(c, =GetEndpointRequest);
                                            {6426}new SPs_5170: bitstring;
                                            {6427}new UP_5171: bitstring;
                                            {6428}out(c, (SPs_5170,SignAndEncrypt,UP_5171,pkSess_5169))
                                )
                                else
                                    {6429}let pkSess_5172: bitstring = fail-any in
                                    {6430}in(c, =GetEndpointRequest);
                                    {6431}new SPs_5173: bitstring;
                                    {6432}new UP_5174: bitstring;
                                    {6433}out(c, (SPs_5173,SignAndEncrypt,UP_5174,pkSess_5172))
                        )
                        else
                            {6434}let pkSess_5175: bitstring = fail-any in
                            {6435}in(c, =GetEndpointRequest);
                            {6436}new SPs_5176: bitstring;
                            {6437}new UP_5177: bitstring;
                            {6438}out(c, (SPs_5176,SignAndEncrypt,UP_5177,pkSess_5175))
                    )
                    else
                        {6439}let v_5178: bool = (Cli_4245 = B) in
                        (
                            {6440}if v_5178 then
                            (
                                {6441}let pkCli_5179: bitstring = pub(skB) in
                                {6442}let v_5180: bool = (Sess_4247 = A) in
                                (
                                    {6443}if v_5180 then
                                    (
                                        {6444}let pkSess_5181: bitstring = pub(skA) in
                                        {6445}in(c, =GetEndpointRequest);
                                        {6446}new SPs_5182: bitstring;
                                        {6447}new UP_5183: bitstring;
                                        {6448}out(c, (SPs_5182,SignAndEncrypt,UP_5183,pkSess_5181))
                                    )
                                    else
                                        {6449}let v_5184: bool = (Sess_4247 = B) in
                                        (
                                            {6450}if v_5184 then
                                            (
                                                {6451}let pkSess_5185: bitstring = pub(skB) in
                                                {6452}in(c, =GetEndpointRequest);
                                                {6453}new SPs_5186: bitstring;
                                                {6454}new UP_5187: bitstring;
                                                {6455}out(c, (SPs_5186,SignAndEncrypt,UP_5187,pkSess_5185))
                                            )
                                            else
                                                {6456}let v_5188: bool = (Sess_4247 = C) in
                                                (
                                                    {6457}if v_5188 then
                                                    (
                                                        {6458}let pkSess_5189: bitstring = pub(skC) in
                                                        {6459}in(c, =GetEndpointRequest);
                                                        {6460}new SPs_5190: bitstring;
                                                        {6461}new UP_5191: bitstring;
                                                        {6462}out(c, (SPs_5190,SignAndEncrypt,UP_5191,pkSess_5189))
                                                    )
                                                    else
                                                        {6463}let pkSess_5192: bitstring = pub(skI) in
                                                        {6464}in(c, =GetEndpointRequest);
                                                        {6465}new SPs_5193: bitstring;
                                                        {6466}new UP_5194: bitstring;
                                                        {6467}out(c, (SPs_5193,SignAndEncrypt,UP_5194,pkSess_5192))
                                                )
                                                else
                                                    {6468}let pkSess_5195: bitstring = fail-any in
                                                    {6469}in(c, =GetEndpointRequest);
                                                    {6470}new SPs_5196: bitstring;
                                                    {6471}new UP_5197: bitstring;
                                                    {6472}out(c, (SPs_5196,SignAndEncrypt,UP_5197,pkSess_5195))
                                        )
                                        else
                                            {6473}let pkSess_5198: bitstring = fail-any in
                                            {6474}in(c, =GetEndpointRequest);
                                            {6475}new SPs_5199: bitstring;
                                            {6476}new UP_5200: bitstring;
                                            {6477}out(c, (SPs_5199,SignAndEncrypt,UP_5200,pkSess_5198))
                                )
                                else
                                    {6478}let pkSess_5201: bitstring = fail-any in
                                    {6479}in(c, =GetEndpointRequest);
                                    {6480}new SPs_5202: bitstring;
                                    {6481}new UP_5203: bitstring;
                                    {6482}out(c, (SPs_5202,SignAndEncrypt,UP_5203,pkSess_5201))
                            )
                            else
                                {6483}let v_5204: bool = (Cli_4245 = C) in
                                (
                                    {6484}if v_5204 then
                                    (
                                        {6485}let pkCli_5205: bitstring = pub(skC) in
                                        {6486}let v_5206: bool = (Sess_4247 = A) in
                                        (
                                            {6487}if v_5206 then
                                            (
                                                {6488}let pkSess_5207: bitstring = pub(skA) in
                                                {6489}in(c, =GetEndpointRequest);
                                                {6490}new SPs_5208: bitstring;
                                                {6491}new UP_5209: bitstring;
                                                {6492}out(c, (SPs_5208,SignAndEncrypt,UP_5209,pkSess_5207))
                                            )
                                            else
                                                {6493}let v_5210: bool = (Sess_4247 = B) in
                                                (
                                                    {6494}if v_5210 then
                                                    (
                                                        {6495}let pkSess_5211: bitstring = pub(skB) in
                                                        {6496}in(c, =GetEndpointRequest);
                                                        {6497}new SPs_5212: bitstring;
                                                        {6498}new UP_5213: bitstring;
                                                        {6499}out(c, (SPs_5212,SignAndEncrypt,UP_5213,pkSess_5211))
                                                    )
                                                    else
                                                        {6500}let v_5214: bool = (Sess_4247 = C) in
                                                        (
                                                            {6501}if v_5214 then
                                                            (
                                                                {6502}let pkSess_5215: bitstring = pub(skC) in
                                                                {6503}in(c, =GetEndpointRequest);
                                                                {6504}new SPs_5216: bitstring;
                                                                {6505}new UP_5217: bitstring;
                                                                {6506}out(c, (SPs_5216,SignAndEncrypt,UP_5217,pkSess_5215))
                                                            )
                                                            else
                                                                {6507}let pkSess_5218: bitstring = pub(skI) in
                                                                {6508}in(c, =GetEndpointRequest);
                                                                {6509}new SPs_5219: bitstring;
                                                                {6510}new UP_5220: bitstring;
                                                                {6511}out(c, (SPs_5219,SignAndEncrypt,UP_5220,pkSess_5218))
                                                        )
                                                        else
                                                            {6512}let pkSess_5221: bitstring = fail-any in
                                                            {6513}in(c, =GetEndpointRequest);
                                                            {6514}new SPs_5222: bitstring;
                                                            {6515}new UP_5223: bitstring;
                                                            {6516}out(c, (SPs_5222,SignAndEncrypt,UP_5223,pkSess_5221))
                                                )
                                                else
                                                    {6517}let pkSess_5224: bitstring = fail-any in
                                                    {6518}in(c, =GetEndpointRequest);
                                                    {6519}new SPs_5225: bitstring;
                                                    {6520}new UP_5226: bitstring;
                                                    {6521}out(c, (SPs_5225,SignAndEncrypt,UP_5226,pkSess_5224))
                                        )
                                        else
                                            {6522}let pkSess_5227: bitstring = fail-any in
                                            {6523}in(c, =GetEndpointRequest);
                                            {6524}new SPs_5228: bitstring;
                                            {6525}new UP_5229: bitstring;
                                            {6526}out(c, (SPs_5228,SignAndEncrypt,UP_5229,pkSess_5227))
                                    )
                                    else
                                        {6527}let pkCli_5230: bitstring = pub(skI) in
                                        {6528}let v_5231: bool = (Sess_4247 = A) in
                                        (
                                            {6529}if v_5231 then
                                            (
                                                {6530}let pkSess_5232: bitstring = pub(skA) in
                                                {6531}in(c, =GetEndpointRequest);
                                                {6532}new SPs_5233: bitstring;
                                                {6533}new UP_5234: bitstring;
                                                {6534}out(c, (SPs_5233,SignAndEncrypt,UP_5234,pkSess_5232))
                                            )
                                            else
                                                {6535}let v_5235: bool = (Sess_4247 = B) in
                                                (
                                                    {6536}if v_5235 then
                                                    (
                                                        {6537}let pkSess_5236: bitstring = pub(skB) in
                                                        {6538}in(c, =GetEndpointRequest);
                                                        {6539}new SPs_5237: bitstring;
                                                        {6540}new UP_5238: bitstring;
                                                        {6541}out(c, (SPs_5237,SignAndEncrypt,UP_5238,pkSess_5236))
                                                    )
                                                    else
                                                        {6542}let v_5239: bool = (Sess_4247 = C) in
                                                        (
                                                            {6543}if v_5239 then
                                                            (
                                                                {6544}let pkSess_5240: bitstring = pub(skC) in
                                                                {6545}in(c, =GetEndpointRequest);
                                                                {6546}new SPs_5241: bitstring;
                                                                {6547}new UP_5242: bitstring;
                                                                {6548}out(c, (SPs_5241,SignAndEncrypt,UP_5242,pkSess_5240))
                                                            )
                                                            else
                                                                {6549}let pkSess_5243: bitstring = pub(skI) in
                                                                {6550}in(c, =GetEndpointRequest);
                                                                {6551}new SPs_5244: bitstring;
                                                                {6552}new UP_5245: bitstring;
                                                                {6553}out(c, (SPs_5244,SignAndEncrypt,UP_5245,pkSess_5243))
                                                        )
                                                        else
                                                            {6554}let pkSess_5246: bitstring = fail-any in
                                                            {6555}in(c, =GetEndpointRequest);
                                                            {6556}new SPs_5247: bitstring;
                                                            {6557}new UP_5248: bitstring;
                                                            {6558}out(c, (SPs_5247,SignAndEncrypt,UP_5248,pkSess_5246))
                                                )
                                                else
                                                    {6559}let pkSess_5249: bitstring = fail-any in
                                                    {6560}in(c, =GetEndpointRequest);
                                                    {6561}new SPs_5250: bitstring;
                                                    {6562}new UP_5251: bitstring;
                                                    {6563}out(c, (SPs_5250,SignAndEncrypt,UP_5251,pkSess_5249))
                                        )
                                        else
                                            {6564}let pkSess_5252: bitstring = fail-any in
                                            {6565}in(c, =GetEndpointRequest);
                                            {6566}new SPs_5253: bitstring;
                                            {6567}new UP_5254: bitstring;
                                            {6568}out(c, (SPs_5253,SignAndEncrypt,UP_5254,pkSess_5252))
                                )
                                else
                                    {6569}let pkCli_5255: bitstring = fail-any in
                                    {6570}let v_5256: bool = (Sess_4247 = A) in
                                    (
                                        {6571}if v_5256 then
                                        (
                                            {6572}let pkSess_5257: bitstring = pub(skA) in
                                            {6573}in(c, =GetEndpointRequest);
                                            {6574}new SPs_5258: bitstring;
                                            {6575}new UP_5259: bitstring;
                                            {6576}out(c, (SPs_5258,SignAndEncrypt,UP_5259,pkSess_5257))
                                        )
                                        else
                                            {6577}let v_5260: bool = (Sess_4247 = B) in
                                            (
                                                {6578}if v_5260 then
                                                (
                                                    {6579}let pkSess_5261: bitstring = pub(skB) in
                                                    {6580}in(c, =GetEndpointRequest);
                                                    {6581}new SPs_5262: bitstring;
                                                    {6582}new UP_5263: bitstring;
                                                    {6583}out(c, (SPs_5262,SignAndEncrypt,UP_5263,pkSess_5261))
                                                )
                                                else
                                                    {6584}let v_5264: bool = (Sess_4247 = C) in
                                                    (
                                                        {6585}if v_5264 then
                                                        (
                                                            {6586}let pkSess_5265: bitstring = pub(skC) in
                                                            {6587}in(c, =GetEndpointRequest);
                                                            {6588}new SPs_5266: bitstring;
                                                            {6589}new UP_5267: bitstring;
                                                            {6590}out(c, (SPs_5266,SignAndEncrypt,UP_5267,pkSess_5265))
                                                        )
                                                        else
                                                            {6591}let pkSess_5268: bitstring = pub(skI) in
                                                            {6592}in(c, =GetEndpointRequest);
                                                            {6593}new SPs_5269: bitstring;
                                                            {6594}new UP_5270: bitstring;
                                                            {6595}out(c, (SPs_5269,SignAndEncrypt,UP_5270,pkSess_5268))
                                                    )
                                                    else
                                                        {6596}let pkSess_5271: bitstring = fail-any in
                                                        {6597}in(c, =GetEndpointRequest);
                                                        {6598}new SPs_5272: bitstring;
                                                        {6599}new UP_5273: bitstring;
                                                        {6600}out(c, (SPs_5272,SignAndEncrypt,UP_5273,pkSess_5271))
                                            )
                                            else
                                                {6601}let pkSess_5274: bitstring = fail-any in
                                                {6602}in(c, =GetEndpointRequest);
                                                {6603}new SPs_5275: bitstring;
                                                {6604}new UP_5276: bitstring;
                                                {6605}out(c, (SPs_5275,SignAndEncrypt,UP_5276,pkSess_5274))
                                    )
                                    else
                                        {6606}let pkSess_5277: bitstring = fail-any in
                                        {6607}in(c, =GetEndpointRequest);
                                        {6608}new SPs_5278: bitstring;
                                        {6609}new UP_5279: bitstring;
                                        {6610}out(c, (SPs_5278,SignAndEncrypt,UP_5279,pkSess_5277))
                        )
                        else
                            {6611}let pkCli_5280: bitstring = fail-any in
                            {6612}let v_5281: bool = (Sess_4247 = A) in
                            (
                                {6613}if v_5281 then
                                (
                                    {6614}let pkSess_5282: bitstring = pub(skA) in
                                    {6615}in(c, =GetEndpointRequest);
                                    {6616}new SPs_5283: bitstring;
                                    {6617}new UP_5284: bitstring;
                                    {6618}out(c, (SPs_5283,SignAndEncrypt,UP_5284,pkSess_5282))
                                )
                                else
                                    {6619}let v_5285: bool = (Sess_4247 = B) in
                                    (
                                        {6620}if v_5285 then
                                        (
                                            {6621}let pkSess_5286: bitstring = pub(skB) in
                                            {6622}in(c, =GetEndpointRequest);
                                            {6623}new SPs_5287: bitstring;
                                            {6624}new UP_5288: bitstring;
                                            {6625}out(c, (SPs_5287,SignAndEncrypt,UP_5288,pkSess_5286))
                                        )
                                        else
                                            {6626}let v_5289: bool = (Sess_4247 = C) in
                                            (
                                                {6627}if v_5289 then
                                                (
                                                    {6628}let pkSess_5290: bitstring = pub(skC) in
                                                    {6629}in(c, =GetEndpointRequest);
                                                    {6630}new SPs_5291: bitstring;
                                                    {6631}new UP_5292: bitstring;
                                                    {6632}out(c, (SPs_5291,SignAndEncrypt,UP_5292,pkSess_5290))
                                                )
                                                else
                                                    {6633}let pkSess_5293: bitstring = pub(skI) in
                                                    {6634}in(c, =GetEndpointRequest);
                                                    {6635}new SPs_5294: bitstring;
                                                    {6636}new UP_5295: bitstring;
                                                    {6637}out(c, (SPs_5294,SignAndEncrypt,UP_5295,pkSess_5293))
                                            )
                                            else
                                                {6638}let pkSess_5296: bitstring = fail-any in
                                                {6639}in(c, =GetEndpointRequest);
                                                {6640}new SPs_5297: bitstring;
                                                {6641}new UP_5298: bitstring;
                                                {6642}out(c, (SPs_5297,SignAndEncrypt,UP_5298,pkSess_5296))
                                    )
                                    else
                                        {6643}let pkSess_5299: bitstring = fail-any in
                                        {6644}in(c, =GetEndpointRequest);
                                        {6645}new SPs_5300: bitstring;
                                        {6646}new UP_5301: bitstring;
                                        {6647}out(c, (SPs_5300,SignAndEncrypt,UP_5301,pkSess_5299))
                            )
                            else
                                {6648}let pkSess_5302: bitstring = fail-any in
                                {6649}in(c, =GetEndpointRequest);
                                {6650}new SPs_5303: bitstring;
                                {6651}new UP_5304: bitstring;
                                {6652}out(c, (SPs_5303,SignAndEncrypt,UP_5304,pkSess_5302))
                )
                else
                    {6653}let pkCli_5305: bitstring = fail-any in
                    {6654}let v_5306: bool = (Sess_4247 = A) in
                    (
                        {6655}if v_5306 then
                        (
                            {6656}let pkSess_5307: bitstring = pub(skA) in
                            {6657}in(c, =GetEndpointRequest);
                            {6658}new SPs_5308: bitstring;
                            {6659}new UP_5309: bitstring;
                            {6660}out(c, (SPs_5308,SignAndEncrypt,UP_5309,pkSess_5307))
                        )
                        else
                            {6661}let v_5310: bool = (Sess_4247 = B) in
                            (
                                {6662}if v_5310 then
                                (
                                    {6663}let pkSess_5311: bitstring = pub(skB) in
                                    {6664}in(c, =GetEndpointRequest);
                                    {6665}new SPs_5312: bitstring;
                                    {6666}new UP_5313: bitstring;
                                    {6667}out(c, (SPs_5312,SignAndEncrypt,UP_5313,pkSess_5311))
                                )
                                else
                                    {6668}let v_5314: bool = (Sess_4247 = C) in
                                    (
                                        {6669}if v_5314 then
                                        (
                                            {6670}let pkSess_5315: bitstring = pub(skC) in
                                            {6671}in(c, =GetEndpointRequest);
                                            {6672}new SPs_5316: bitstring;
                                            {6673}new UP_5317: bitstring;
                                            {6674}out(c, (SPs_5316,SignAndEncrypt,UP_5317,pkSess_5315))
                                        )
                                        else
                                            {6675}let pkSess_5318: bitstring = pub(skI) in
                                            {6676}in(c, =GetEndpointRequest);
                                            {6677}new SPs_5319: bitstring;
                                            {6678}new UP_5320: bitstring;
                                            {6679}out(c, (SPs_5319,SignAndEncrypt,UP_5320,pkSess_5318))
                                    )
                                    else
                                        {6680}let pkSess_5321: bitstring = fail-any in
                                        {6681}in(c, =GetEndpointRequest);
                                        {6682}new SPs_5322: bitstring;
                                        {6683}new UP_5323: bitstring;
                                        {6684}out(c, (SPs_5322,SignAndEncrypt,UP_5323,pkSess_5321))
                            )
                            else
                                {6685}let pkSess_5324: bitstring = fail-any in
                                {6686}in(c, =GetEndpointRequest);
                                {6687}new SPs_5325: bitstring;
                                {6688}new UP_5326: bitstring;
                                {6689}out(c, (SPs_5325,SignAndEncrypt,UP_5326,pkSess_5324))
                    )
                    else
                        {6690}let pkSess_5327: bitstring = fail-any in
                        {6691}in(c, =GetEndpointRequest);
                        {6692}new SPs_5328: bitstring;
                        {6693}new UP_5329: bitstring;
                        {6694}out(c, (SPs_5328,SignAndEncrypt,UP_5329,pkSess_5327))
    )
    else
        {6695}let skDisco_5330: bitstring = fail-any in
        {6696}let pkDisco_5331: bitstring = pub(skDisco_5330) in
        {6697}let v_5332: bool = (Cli_4245 = A) in
        (
            {6698}if v_5332 then
            (
                {6699}let pkCli_5333: bitstring = pub(skA) in
                {6700}let v_5334: bool = (Sess_4247 = A) in
                (
                    {6701}if v_5334 then
                    (
                        {6702}let pkSess_5335: bitstring = pub(skA) in
                        {6703}in(c, =GetEndpointRequest);
                        {6704}new SPs_5336: bitstring;
                        {6705}new UP_5337: bitstring;
                        {6706}out(c, (SPs_5336,SignAndEncrypt,UP_5337,pkSess_5335))
                    )
                    else
                        {6707}let v_5338: bool = (Sess_4247 = B) in
                        (
                            {6708}if v_5338 then
                            (
                                {6709}let pkSess_5339: bitstring = pub(skB) in
                                {6710}in(c, =GetEndpointRequest);
                                {6711}new SPs_5340: bitstring;
                                {6712}new UP_5341: bitstring;
                                {6713}out(c, (SPs_5340,SignAndEncrypt,UP_5341,pkSess_5339))
                            )
                            else
                                {6714}let v_5342: bool = (Sess_4247 = C) in
                                (
                                    {6715}if v_5342 then
                                    (
                                        {6716}let pkSess_5343: bitstring = pub(skC) in
                                        {6717}in(c, =GetEndpointRequest);
                                        {6718}new SPs_5344: bitstring;
                                        {6719}new UP_5345: bitstring;
                                        {6720}out(c, (SPs_5344,SignAndEncrypt,UP_5345,pkSess_5343))
                                    )
                                    else
                                        {6721}let pkSess_5346: bitstring = pub(skI) in
                                        {6722}in(c, =GetEndpointRequest);
                                        {6723}new SPs_5347: bitstring;
                                        {6724}new UP_5348: bitstring;
                                        {6725}out(c, (SPs_5347,SignAndEncrypt,UP_5348,pkSess_5346))
                                )
                                else
                                    {6726}let pkSess_5349: bitstring = fail-any in
                                    {6727}in(c, =GetEndpointRequest);
                                    {6728}new SPs_5350: bitstring;
                                    {6729}new UP_5351: bitstring;
                                    {6730}out(c, (SPs_5350,SignAndEncrypt,UP_5351,pkSess_5349))
                        )
                        else
                            {6731}let pkSess_5352: bitstring = fail-any in
                            {6732}in(c, =GetEndpointRequest);
                            {6733}new SPs_5353: bitstring;
                            {6734}new UP_5354: bitstring;
                            {6735}out(c, (SPs_5353,SignAndEncrypt,UP_5354,pkSess_5352))
                )
                else
                    {6736}let pkSess_5355: bitstring = fail-any in
                    {6737}in(c, =GetEndpointRequest);
                    {6738}new SPs_5356: bitstring;
                    {6739}new UP_5357: bitstring;
                    {6740}out(c, (SPs_5356,SignAndEncrypt,UP_5357,pkSess_5355))
            )
            else
                {6741}let v_5358: bool = (Cli_4245 = B) in
                (
                    {6742}if v_5358 then
                    (
                        {6743}let pkCli_5359: bitstring = pub(skB) in
                        {6744}let v_5360: bool = (Sess_4247 = A) in
                        (
                            {6745}if v_5360 then
                            (
                                {6746}let pkSess_5361: bitstring = pub(skA) in
                                {6747}in(c, =GetEndpointRequest);
                                {6748}new SPs_5362: bitstring;
                                {6749}new UP_5363: bitstring;
                                {6750}out(c, (SPs_5362,SignAndEncrypt,UP_5363,pkSess_5361))
                            )
                            else
                                {6751}let v_5364: bool = (Sess_4247 = B) in
                                (
                                    {6752}if v_5364 then
                                    (
                                        {6753}let pkSess_5365: bitstring = pub(skB) in
                                        {6754}in(c, =GetEndpointRequest);
                                        {6755}new SPs_5366: bitstring;
                                        {6756}new UP_5367: bitstring;
                                        {6757}out(c, (SPs_5366,SignAndEncrypt,UP_5367,pkSess_5365))
                                    )
                                    else
                                        {6758}let v_5368: bool = (Sess_4247 = C) in
                                        (
                                            {6759}if v_5368 then
                                            (
                                                {6760}let pkSess_5369: bitstring = pub(skC) in
                                                {6761}in(c, =GetEndpointRequest);
                                                {6762}new SPs_5370: bitstring;
                                                {6763}new UP_5371: bitstring;
                                                {6764}out(c, (SPs_5370,SignAndEncrypt,UP_5371,pkSess_5369))
                                            )
                                            else
                                                {6765}let pkSess_5372: bitstring = pub(skI) in
                                                {6766}in(c, =GetEndpointRequest);
                                                {6767}new SPs_5373: bitstring;
                                                {6768}new UP_5374: bitstring;
                                                {6769}out(c, (SPs_5373,SignAndEncrypt,UP_5374,pkSess_5372))
                                        )
                                        else
                                            {6770}let pkSess_5375: bitstring = fail-any in
                                            {6771}in(c, =GetEndpointRequest);
                                            {6772}new SPs_5376: bitstring;
                                            {6773}new UP_5377: bitstring;
                                            {6774}out(c, (SPs_5376,SignAndEncrypt,UP_5377,pkSess_5375))
                                )
                                else
                                    {6775}let pkSess_5378: bitstring = fail-any in
                                    {6776}in(c, =GetEndpointRequest);
                                    {6777}new SPs_5379: bitstring;
                                    {6778}new UP_5380: bitstring;
                                    {6779}out(c, (SPs_5379,SignAndEncrypt,UP_5380,pkSess_5378))
                        )
                        else
                            {6780}let pkSess_5381: bitstring = fail-any in
                            {6781}in(c, =GetEndpointRequest);
                            {6782}new SPs_5382: bitstring;
                            {6783}new UP_5383: bitstring;
                            {6784}out(c, (SPs_5382,SignAndEncrypt,UP_5383,pkSess_5381))
                    )
                    else
                        {6785}let v_5384: bool = (Cli_4245 = C) in
                        (
                            {6786}if v_5384 then
                            (
                                {6787}let pkCli_5385: bitstring = pub(skC) in
                                {6788}let v_5386: bool = (Sess_4247 = A) in
                                (
                                    {6789}if v_5386 then
                                    (
                                        {6790}let pkSess_5387: bitstring = pub(skA) in
                                        {6791}in(c, =GetEndpointRequest);
                                        {6792}new SPs_5388: bitstring;
                                        {6793}new UP_5389: bitstring;
                                        {6794}out(c, (SPs_5388,SignAndEncrypt,UP_5389,pkSess_5387))
                                    )
                                    else
                                        {6795}let v_5390: bool = (Sess_4247 = B) in
                                        (
                                            {6796}if v_5390 then
                                            (
                                                {6797}let pkSess_5391: bitstring = pub(skB) in
                                                {6798}in(c, =GetEndpointRequest);
                                                {6799}new SPs_5392: bitstring;
                                                {6800}new UP_5393: bitstring;
                                                {6801}out(c, (SPs_5392,SignAndEncrypt,UP_5393,pkSess_5391))
                                            )
                                            else
                                                {6802}let v_5394: bool = (Sess_4247 = C) in
                                                (
                                                    {6803}if v_5394 then
                                                    (
                                                        {6804}let pkSess_5395: bitstring = pub(skC) in
                                                        {6805}in(c, =GetEndpointRequest);
                                                        {6806}new SPs_5396: bitstring;
                                                        {6807}new UP_5397: bitstring;
                                                        {6808}out(c, (SPs_5396,SignAndEncrypt,UP_5397,pkSess_5395))
                                                    )
                                                    else
                                                        {6809}let pkSess_5398: bitstring = pub(skI) in
                                                        {6810}in(c, =GetEndpointRequest);
                                                        {6811}new SPs_5399: bitstring;
                                                        {6812}new UP_5400: bitstring;
                                                        {6813}out(c, (SPs_5399,SignAndEncrypt,UP_5400,pkSess_5398))
                                                )
                                                else
                                                    {6814}let pkSess_5401: bitstring = fail-any in
                                                    {6815}in(c, =GetEndpointRequest);
                                                    {6816}new SPs_5402: bitstring;
                                                    {6817}new UP_5403: bitstring;
                                                    {6818}out(c, (SPs_5402,SignAndEncrypt,UP_5403,pkSess_5401))
                                        )
                                        else
                                            {6819}let pkSess_5404: bitstring = fail-any in
                                            {6820}in(c, =GetEndpointRequest);
                                            {6821}new SPs_5405: bitstring;
                                            {6822}new UP_5406: bitstring;
                                            {6823}out(c, (SPs_5405,SignAndEncrypt,UP_5406,pkSess_5404))
                                )
                                else
                                    {6824}let pkSess_5407: bitstring = fail-any in
                                    {6825}in(c, =GetEndpointRequest);
                                    {6826}new SPs_5408: bitstring;
                                    {6827}new UP_5409: bitstring;
                                    {6828}out(c, (SPs_5408,SignAndEncrypt,UP_5409,pkSess_5407))
                            )
                            else
                                {6829}let pkCli_5410: bitstring = pub(skI) in
                                {6830}let v_5411: bool = (Sess_4247 = A) in
                                (
                                    {6831}if v_5411 then
                                    (
                                        {6832}let pkSess_5412: bitstring = pub(skA) in
                                        {6833}in(c, =GetEndpointRequest);
                                        {6834}new SPs_5413: bitstring;
                                        {6835}new UP_5414: bitstring;
                                        {6836}out(c, (SPs_5413,SignAndEncrypt,UP_5414,pkSess_5412))
                                    )
                                    else
                                        {6837}let v_5415: bool = (Sess_4247 = B) in
                                        (
                                            {6838}if v_5415 then
                                            (
                                                {6839}let pkSess_5416: bitstring = pub(skB) in
                                                {6840}in(c, =GetEndpointRequest);
                                                {6841}new SPs_5417: bitstring;
                                                {6842}new UP_5418: bitstring;
                                                {6843}out(c, (SPs_5417,SignAndEncrypt,UP_5418,pkSess_5416))
                                            )
                                            else
                                                {6844}let v_5419: bool = (Sess_4247 = C) in
                                                (
                                                    {6845}if v_5419 then
                                                    (
                                                        {6846}let pkSess_5420: bitstring = pub(skC) in
                                                        {6847}in(c, =GetEndpointRequest);
                                                        {6848}new SPs_5421: bitstring;
                                                        {6849}new UP_5422: bitstring;
                                                        {6850}out(c, (SPs_5421,SignAndEncrypt,UP_5422,pkSess_5420))
                                                    )
                                                    else
                                                        {6851}let pkSess_5423: bitstring = pub(skI) in
                                                        {6852}in(c, =GetEndpointRequest);
                                                        {6853}new SPs_5424: bitstring;
                                                        {6854}new UP_5425: bitstring;
                                                        {6855}out(c, (SPs_5424,SignAndEncrypt,UP_5425,pkSess_5423))
                                                )
                                                else
                                                    {6856}let pkSess_5426: bitstring = fail-any in
                                                    {6857}in(c, =GetEndpointRequest);
                                                    {6858}new SPs_5427: bitstring;
                                                    {6859}new UP_5428: bitstring;
                                                    {6860}out(c, (SPs_5427,SignAndEncrypt,UP_5428,pkSess_5426))
                                        )
                                        else
                                            {6861}let pkSess_5429: bitstring = fail-any in
                                            {6862}in(c, =GetEndpointRequest);
                                            {6863}new SPs_5430: bitstring;
                                            {6864}new UP_5431: bitstring;
                                            {6865}out(c, (SPs_5430,SignAndEncrypt,UP_5431,pkSess_5429))
                                )
                                else
                                    {6866}let pkSess_5432: bitstring = fail-any in
                                    {6867}in(c, =GetEndpointRequest);
                                    {6868}new SPs_5433: bitstring;
                                    {6869}new UP_5434: bitstring;
                                    {6870}out(c, (SPs_5433,SignAndEncrypt,UP_5434,pkSess_5432))
                        )
                        else
                            {6871}let pkCli_5435: bitstring = fail-any in
                            {6872}let v_5436: bool = (Sess_4247 = A) in
                            (
                                {6873}if v_5436 then
                                (
                                    {6874}let pkSess_5437: bitstring = pub(skA) in
                                    {6875}in(c, =GetEndpointRequest);
                                    {6876}new SPs_5438: bitstring;
                                    {6877}new UP_5439: bitstring;
                                    {6878}out(c, (SPs_5438,SignAndEncrypt,UP_5439,pkSess_5437))
                                )
                                else
                                    {6879}let v_5440: bool = (Sess_4247 = B) in
                                    (
                                        {6880}if v_5440 then
                                        (
                                            {6881}let pkSess_5441: bitstring = pub(skB) in
                                            {6882}in(c, =GetEndpointRequest);
                                            {6883}new SPs_5442: bitstring;
                                            {6884}new UP_5443: bitstring;
                                            {6885}out(c, (SPs_5442,SignAndEncrypt,UP_5443,pkSess_5441))
                                        )
                                        else
                                            {6886}let v_5444: bool = (Sess_4247 = C) in
                                            (
                                                {6887}if v_5444 then
                                                (
                                                    {6888}let pkSess_5445: bitstring = pub(skC) in
                                                    {6889}in(c, =GetEndpointRequest);
                                                    {6890}new SPs_5446: bitstring;
                                                    {6891}new UP_5447: bitstring;
                                                    {6892}out(c, (SPs_5446,SignAndEncrypt,UP_5447,pkSess_5445))
                                                )
                                                else
                                                    {6893}let pkSess_5448: bitstring = pub(skI) in
                                                    {6894}in(c, =GetEndpointRequest);
                                                    {6895}new SPs_5449: bitstring;
                                                    {6896}new UP_5450: bitstring;
                                                    {6897}out(c, (SPs_5449,SignAndEncrypt,UP_5450,pkSess_5448))
                                            )
                                            else
                                                {6898}let pkSess_5451: bitstring = fail-any in
                                                {6899}in(c, =GetEndpointRequest);
                                                {6900}new SPs_5452: bitstring;
                                                {6901}new UP_5453: bitstring;
                                                {6902}out(c, (SPs_5452,SignAndEncrypt,UP_5453,pkSess_5451))
                                    )
                                    else
                                        {6903}let pkSess_5454: bitstring = fail-any in
                                        {6904}in(c, =GetEndpointRequest);
                                        {6905}new SPs_5455: bitstring;
                                        {6906}new UP_5456: bitstring;
                                        {6907}out(c, (SPs_5455,SignAndEncrypt,UP_5456,pkSess_5454))
                            )
                            else
                                {6908}let pkSess_5457: bitstring = fail-any in
                                {6909}in(c, =GetEndpointRequest);
                                {6910}new SPs_5458: bitstring;
                                {6911}new UP_5459: bitstring;
                                {6912}out(c, (SPs_5458,SignAndEncrypt,UP_5459,pkSess_5457))
                )
                else
                    {6913}let pkCli_5460: bitstring = fail-any in
                    {6914}let v_5461: bool = (Sess_4247 = A) in
                    (
                        {6915}if v_5461 then
                        (
                            {6916}let pkSess_5462: bitstring = pub(skA) in
                            {6917}in(c, =GetEndpointRequest);
                            {6918}new SPs_5463: bitstring;
                            {6919}new UP_5464: bitstring;
                            {6920}out(c, (SPs_5463,SignAndEncrypt,UP_5464,pkSess_5462))
                        )
                        else
                            {6921}let v_5465: bool = (Sess_4247 = B) in
                            (
                                {6922}if v_5465 then
                                (
                                    {6923}let pkSess_5466: bitstring = pub(skB) in
                                    {6924}in(c, =GetEndpointRequest);
                                    {6925}new SPs_5467: bitstring;
                                    {6926}new UP_5468: bitstring;
                                    {6927}out(c, (SPs_5467,SignAndEncrypt,UP_5468,pkSess_5466))
                                )
                                else
                                    {6928}let v_5469: bool = (Sess_4247 = C) in
                                    (
                                        {6929}if v_5469 then
                                        (
                                            {6930}let pkSess_5470: bitstring = pub(skC) in
                                            {6931}in(c, =GetEndpointRequest);
                                            {6932}new SPs_5471: bitstring;
                                            {6933}new UP_5472: bitstring;
                                            {6934}out(c, (SPs_5471,SignAndEncrypt,UP_5472,pkSess_5470))
                                        )
                                        else
                                            {6935}let pkSess_5473: bitstring = pub(skI) in
                                            {6936}in(c, =GetEndpointRequest);
                                            {6937}new SPs_5474: bitstring;
                                            {6938}new UP_5475: bitstring;
                                            {6939}out(c, (SPs_5474,SignAndEncrypt,UP_5475,pkSess_5473))
                                    )
                                    else
                                        {6940}let pkSess_5476: bitstring = fail-any in
                                        {6941}in(c, =GetEndpointRequest);
                                        {6942}new SPs_5477: bitstring;
                                        {6943}new UP_5478: bitstring;
                                        {6944}out(c, (SPs_5477,SignAndEncrypt,UP_5478,pkSess_5476))
                            )
                            else
                                {6945}let pkSess_5479: bitstring = fail-any in
                                {6946}in(c, =GetEndpointRequest);
                                {6947}new SPs_5480: bitstring;
                                {6948}new UP_5481: bitstring;
                                {6949}out(c, (SPs_5480,SignAndEncrypt,UP_5481,pkSess_5479))
                    )
                    else
                        {6950}let pkSess_5482: bitstring = fail-any in
                        {6951}in(c, =GetEndpointRequest);
                        {6952}new SPs_5483: bitstring;
                        {6953}new UP_5484: bitstring;
                        {6954}out(c, (SPs_5483,SignAndEncrypt,UP_5484,pkSess_5482))
        )
        else
            {6955}let pkCli_5485: bitstring = fail-any in
            {6956}let v_5486: bool = (Sess_4247 = A) in
            (
                {6957}if v_5486 then
                (
                    {6958}let pkSess_5487: bitstring = pub(skA) in
                    {6959}in(c, =GetEndpointRequest);
                    {6960}new SPs_5488: bitstring;
                    {6961}new UP_5489: bitstring;
                    {6962}out(c, (SPs_5488,SignAndEncrypt,UP_5489,pkSess_5487))
                )
                else
                    {6963}let v_5490: bool = (Sess_4247 = B) in
                    (
                        {6964}if v_5490 then
                        (
                            {6965}let pkSess_5491: bitstring = pub(skB) in
                            {6966}in(c, =GetEndpointRequest);
                            {6967}new SPs_5492: bitstring;
                            {6968}new UP_5493: bitstring;
                            {6969}out(c, (SPs_5492,SignAndEncrypt,UP_5493,pkSess_5491))
                        )
                        else
                            {6970}let v_5494: bool = (Sess_4247 = C) in
                            (
                                {6971}if v_5494 then
                                (
                                    {6972}let pkSess_5495: bitstring = pub(skC) in
                                    {6973}in(c, =GetEndpointRequest);
                                    {6974}new SPs_5496: bitstring;
                                    {6975}new UP_5497: bitstring;
                                    {6976}out(c, (SPs_5496,SignAndEncrypt,UP_5497,pkSess_5495))
                                )
                                else
                                    {6977}let pkSess_5498: bitstring = pub(skI) in
                                    {6978}in(c, =GetEndpointRequest);
                                    {6979}new SPs_5499: bitstring;
                                    {6980}new UP_5500: bitstring;
                                    {6981}out(c, (SPs_5499,SignAndEncrypt,UP_5500,pkSess_5498))
                            )
                            else
                                {6982}let pkSess_5501: bitstring = fail-any in
                                {6983}in(c, =GetEndpointRequest);
                                {6984}new SPs_5502: bitstring;
                                {6985}new UP_5503: bitstring;
                                {6986}out(c, (SPs_5502,SignAndEncrypt,UP_5503,pkSess_5501))
                    )
                    else
                        {6987}let pkSess_5504: bitstring = fail-any in
                        {6988}in(c, =GetEndpointRequest);
                        {6989}new SPs_5505: bitstring;
                        {6990}new UP_5506: bitstring;
                        {6991}out(c, (SPs_5505,SignAndEncrypt,UP_5506,pkSess_5504))
            )
            else
                {6992}let pkSess_5507: bitstring = fail-any in
                {6993}in(c, =GetEndpointRequest);
                {6994}new SPs_5508: bitstring;
                {6995}new UP_5509: bitstring;
                {6996}out(c, (SPs_5508,SignAndEncrypt,UP_5509,pkSess_5507))
) | (
    {6997}!
    {6998}in(c, (Cli_5510: host,Disco_5511: host,Sess_5512: host));
    {6999}let v_5513: bool = (Sess_5512 = A) in
    (
        {7000}if v_5513 then
        (
            {7001}let skSess: bitstring = skA in
            {7002}let pkSess_5514: bitstring = pub(skSess) in
            {7003}let v_5515: bool = (Cli_5510 = A) in
            (
                {7004}if v_5515 then
                (
                    {7005}let pkCli_5516: bitstring = pub(skA) in
                    {7006}let v_5517: bool = (Disco_5511 = A) in
                    (
                        {7007}if v_5517 then
                        (
                            {7008}let pkDisco_5518: bitstring = pub(skA) in
                            {7009}in(c, (=pkCli_5516,em1: bitstring,sigM1: bitstring));
                            {7010}let m1_5519: bitstring = dec(em1,skSess) in
                            {7011}if (verify(m1_5519,sigM1,pkCli_5516) <> true) then
                                0
                            else
                                {7012}let (SPc_5520: bitstring,PartC: bitstring) = m1_5519 in
                                {7013}event endSrv(Cli_5510,Sess_5512,PartC);
                                {7014}new Ns: bitstring;
                                {7015}let gNs: bitstring = exp(g,Ns) in
                                {7016}let m2: bitstring = gNs in
                                {7017}out(c, (enc(m2,pkCli_5516),sign(m2,skSess)));
                                {7018}event beginSrv(Sess_5512,Cli_5510,gNs)
                        )
                        else
                            {7019}let v_5521: bool = (Disco_5511 = B) in
                            (
                                {7020}if v_5521 then
                                (
                                    {7021}let pkDisco_5522: bitstring = pub(skB) in
                                    {7022}in(c, (=pkCli_5516,em1_5523: bitstring,sigM1_5524: bitstring));
                                    {7023}let m1_5525: bitstring = dec(em1_5523,skSess) in
                                    {7024}if (verify(m1_5525,sigM1_5524,pkCli_5516) <> true) then
                                        0
                                    else
                                        {7025}let (SPc_5526: bitstring,PartC_5527: bitstring) = m1_5525 in
                                        {7026}event endSrv(Cli_5510,Sess_5512,PartC_5527);
                                        {7027}new Ns_5528: bitstring;
                                        {7028}let gNs_5529: bitstring = exp(g,Ns_5528) in
                                        {7029}let m2_5530: bitstring = gNs_5529 in
                                        {7030}out(c, (enc(m2_5530,pkCli_5516),sign(m2_5530,skSess)));
                                        {7031}event beginSrv(Sess_5512,Cli_5510,gNs_5529)
                                )
                                else
                                    {7032}let v_5531: bool = (Disco_5511 = C) in
                                    (
                                        {7033}if v_5531 then
                                        (
                                            {7034}let pkDisco_5532: bitstring = pub(skC) in
                                            {7035}in(c, (=pkCli_5516,em1_5533: bitstring,sigM1_5534: bitstring));
                                            {7036}let m1_5535: bitstring = dec(em1_5533,skSess) in
                                            {7037}if (verify(m1_5535,sigM1_5534,pkCli_5516) <> true) then
                                                0
                                            else
                                                {7038}let (SPc_5536: bitstring,PartC_5537: bitstring) = m1_5535 in
                                                {7039}event endSrv(Cli_5510,Sess_5512,PartC_5537);
                                                {7040}new Ns_5538: bitstring;
                                                {7041}let gNs_5539: bitstring = exp(g,Ns_5538) in
                                                {7042}let m2_5540: bitstring = gNs_5539 in
                                                {7043}out(c, (enc(m2_5540,pkCli_5516),sign(m2_5540,skSess)));
                                                {7044}event beginSrv(Sess_5512,Cli_5510,gNs_5539)
                                        )
                                        else
                                            {7045}let pkDisco_5541: bitstring = pub(skI) in
                                            {7046}in(c, (=pkCli_5516,em1_5542: bitstring,sigM1_5543: bitstring));
                                            {7047}let m1_5544: bitstring = dec(em1_5542,skSess) in
                                            {7048}if (verify(m1_5544,sigM1_5543,pkCli_5516) <> true) then
                                                0
                                            else
                                                {7049}let (SPc_5545: bitstring,PartC_5546: bitstring) = m1_5544 in
                                                {7050}event endSrv(Cli_5510,Sess_5512,PartC_5546);
                                                {7051}new Ns_5547: bitstring;
                                                {7052}let gNs_5548: bitstring = exp(g,Ns_5547) in
                                                {7053}let m2_5549: bitstring = gNs_5548 in
                                                {7054}out(c, (enc(m2_5549,pkCli_5516),sign(m2_5549,skSess)));
                                                {7055}event beginSrv(Sess_5512,Cli_5510,gNs_5548)
                                    )
                                    else
                                        {7056}let pkDisco_5550: bitstring = fail-any in
                                        {7057}in(c, (=pkCli_5516,em1_5551: bitstring,sigM1_5552: bitstring));
                                        {7058}let m1_5553: bitstring = dec(em1_5551,skSess) in
                                        {7059}if (verify(m1_5553,sigM1_5552,pkCli_5516) <> true) then
                                            0
                                        else
                                            {7060}let (SPc_5554: bitstring,PartC_5555: bitstring) = m1_5553 in
                                            {7061}event endSrv(Cli_5510,Sess_5512,PartC_5555);
                                            {7062}new Ns_5556: bitstring;
                                            {7063}let gNs_5557: bitstring = exp(g,Ns_5556) in
                                            {7064}let m2_5558: bitstring = gNs_5557 in
                                            {7065}out(c, (enc(m2_5558,pkCli_5516),sign(m2_5558,skSess)));
                                            {7066}event beginSrv(Sess_5512,Cli_5510,gNs_5557)
                            )
                            else
                                {7067}let pkDisco_5559: bitstring = fail-any in
                                {7068}in(c, (=pkCli_5516,em1_5560: bitstring,sigM1_5561: bitstring));
                                {7069}let m1_5562: bitstring = dec(em1_5560,skSess) in
                                {7070}if (verify(m1_5562,sigM1_5561,pkCli_5516) <> true) then
                                    0
                                else
                                    {7071}let (SPc_5563: bitstring,PartC_5564: bitstring) = m1_5562 in
                                    {7072}event endSrv(Cli_5510,Sess_5512,PartC_5564);
                                    {7073}new Ns_5565: bitstring;
                                    {7074}let gNs_5566: bitstring = exp(g,Ns_5565) in
                                    {7075}let m2_5567: bitstring = gNs_5566 in
                                    {7076}out(c, (enc(m2_5567,pkCli_5516),sign(m2_5567,skSess)));
                                    {7077}event beginSrv(Sess_5512,Cli_5510,gNs_5566)
                    )
                    else
                        {7078}let pkDisco_5568: bitstring = fail-any in
                        {7079}in(c, (=pkCli_5516,em1_5569: bitstring,sigM1_5570: bitstring));
                        {7080}let m1_5571: bitstring = dec(em1_5569,skSess) in
                        {7081}if (verify(m1_5571,sigM1_5570,pkCli_5516) <> true) then
                            0
                        else
                            {7082}let (SPc_5572: bitstring,PartC_5573: bitstring) = m1_5571 in
                            {7083}event endSrv(Cli_5510,Sess_5512,PartC_5573);
                            {7084}new Ns_5574: bitstring;
                            {7085}let gNs_5575: bitstring = exp(g,Ns_5574) in
                            {7086}let m2_5576: bitstring = gNs_5575 in
                            {7087}out(c, (enc(m2_5576,pkCli_5516),sign(m2_5576,skSess)));
                            {7088}event beginSrv(Sess_5512,Cli_5510,gNs_5575)
                )
                else
                    {7089}let v_5577: bool = (Cli_5510 = B) in
                    (
                        {7090}if v_5577 then
                        (
                            {7091}let pkCli_5578: bitstring = pub(skB) in
                            {7092}let v_5579: bool = (Disco_5511 = A) in
                            (
                                {7093}if v_5579 then
                                (
                                    {7094}let pkDisco_5580: bitstring = pub(skA) in
                                    {7095}in(c, (=pkCli_5578,em1_5581: bitstring,sigM1_5582: bitstring));
                                    {7096}let m1_5583: bitstring = dec(em1_5581,skSess) in
                                    {7097}if (verify(m1_5583,sigM1_5582,pkCli_5578) <> true) then
                                        0
                                    else
                                        {7098}let (SPc_5584: bitstring,PartC_5585: bitstring) = m1_5583 in
                                        {7099}event endSrv(Cli_5510,Sess_5512,PartC_5585);
                                        {7100}new Ns_5586: bitstring;
                                        {7101}let gNs_5587: bitstring = exp(g,Ns_5586) in
                                        {7102}let m2_5588: bitstring = gNs_5587 in
                                        {7103}out(c, (enc(m2_5588,pkCli_5578),sign(m2_5588,skSess)));
                                        {7104}event beginSrv(Sess_5512,Cli_5510,gNs_5587)
                                )
                                else
                                    {7105}let v_5589: bool = (Disco_5511 = B) in
                                    (
                                        {7106}if v_5589 then
                                        (
                                            {7107}let pkDisco_5590: bitstring = pub(skB) in
                                            {7108}in(c, (=pkCli_5578,em1_5591: bitstring,sigM1_5592: bitstring));
                                            {7109}let m1_5593: bitstring = dec(em1_5591,skSess) in
                                            {7110}if (verify(m1_5593,sigM1_5592,pkCli_5578) <> true) then
                                                0
                                            else
                                                {7111}let (SPc_5594: bitstring,PartC_5595: bitstring) = m1_5593 in
                                                {7112}event endSrv(Cli_5510,Sess_5512,PartC_5595);
                                                {7113}new Ns_5596: bitstring;
                                                {7114}let gNs_5597: bitstring = exp(g,Ns_5596) in
                                                {7115}let m2_5598: bitstring = gNs_5597 in
                                                {7116}out(c, (enc(m2_5598,pkCli_5578),sign(m2_5598,skSess)));
                                                {7117}event beginSrv(Sess_5512,Cli_5510,gNs_5597)
                                        )
                                        else
                                            {7118}let v_5599: bool = (Disco_5511 = C) in
                                            (
                                                {7119}if v_5599 then
                                                (
                                                    {7120}let pkDisco_5600: bitstring = pub(skC) in
                                                    {7121}in(c, (=pkCli_5578,em1_5601: bitstring,sigM1_5602: bitstring));
                                                    {7122}let m1_5603: bitstring = dec(em1_5601,skSess) in
                                                    {7123}if (verify(m1_5603,sigM1_5602,pkCli_5578) <> true) then
                                                        0
                                                    else
                                                        {7124}let (SPc_5604: bitstring,PartC_5605: bitstring) = m1_5603 in
                                                        {7125}event endSrv(Cli_5510,Sess_5512,PartC_5605);
                                                        {7126}new Ns_5606: bitstring;
                                                        {7127}let gNs_5607: bitstring = exp(g,Ns_5606) in
                                                        {7128}let m2_5608: bitstring = gNs_5607 in
                                                        {7129}out(c, (enc(m2_5608,pkCli_5578),sign(m2_5608,skSess)));
                                                        {7130}event beginSrv(Sess_5512,Cli_5510,gNs_5607)
                                                )
                                                else
                                                    {7131}let pkDisco_5609: bitstring = pub(skI) in
                                                    {7132}in(c, (=pkCli_5578,em1_5610: bitstring,sigM1_5611: bitstring));
                                                    {7133}let m1_5612: bitstring = dec(em1_5610,skSess) in
                                                    {7134}if (verify(m1_5612,sigM1_5611,pkCli_5578) <> true) then
                                                        0
                                                    else
                                                        {7135}let (SPc_5613: bitstring,PartC_5614: bitstring) = m1_5612 in
                                                        {7136}event endSrv(Cli_5510,Sess_5512,PartC_5614);
                                                        {7137}new Ns_5615: bitstring;
                                                        {7138}let gNs_5616: bitstring = exp(g,Ns_5615) in
                                                        {7139}let m2_5617: bitstring = gNs_5616 in
                                                        {7140}out(c, (enc(m2_5617,pkCli_5578),sign(m2_5617,skSess)));
                                                        {7141}event beginSrv(Sess_5512,Cli_5510,gNs_5616)
                                            )
                                            else
                                                {7142}let pkDisco_5618: bitstring = fail-any in
                                                {7143}in(c, (=pkCli_5578,em1_5619: bitstring,sigM1_5620: bitstring));
                                                {7144}let m1_5621: bitstring = dec(em1_5619,skSess) in
                                                {7145}if (verify(m1_5621,sigM1_5620,pkCli_5578) <> true) then
                                                    0
                                                else
                                                    {7146}let (SPc_5622: bitstring,PartC_5623: bitstring) = m1_5621 in
                                                    {7147}event endSrv(Cli_5510,Sess_5512,PartC_5623);
                                                    {7148}new Ns_5624: bitstring;
                                                    {7149}let gNs_5625: bitstring = exp(g,Ns_5624) in
                                                    {7150}let m2_5626: bitstring = gNs_5625 in
                                                    {7151}out(c, (enc(m2_5626,pkCli_5578),sign(m2_5626,skSess)));
                                                    {7152}event beginSrv(Sess_5512,Cli_5510,gNs_5625)
                                    )
                                    else
                                        {7153}let pkDisco_5627: bitstring = fail-any in
                                        {7154}in(c, (=pkCli_5578,em1_5628: bitstring,sigM1_5629: bitstring));
                                        {7155}let m1_5630: bitstring = dec(em1_5628,skSess) in
                                        {7156}if (verify(m1_5630,sigM1_5629,pkCli_5578) <> true) then
                                            0
                                        else
                                            {7157}let (SPc_5631: bitstring,PartC_5632: bitstring) = m1_5630 in
                                            {7158}event endSrv(Cli_5510,Sess_5512,PartC_5632);
                                            {7159}new Ns_5633: bitstring;
                                            {7160}let gNs_5634: bitstring = exp(g,Ns_5633) in
                                            {7161}let m2_5635: bitstring = gNs_5634 in
                                            {7162}out(c, (enc(m2_5635,pkCli_5578),sign(m2_5635,skSess)));
                                            {7163}event beginSrv(Sess_5512,Cli_5510,gNs_5634)
                            )
                            else
                                {7164}let pkDisco_5636: bitstring = fail-any in
                                {7165}in(c, (=pkCli_5578,em1_5637: bitstring,sigM1_5638: bitstring));
                                {7166}let m1_5639: bitstring = dec(em1_5637,skSess) in
                                {7167}if (verify(m1_5639,sigM1_5638,pkCli_5578) <> true) then
                                    0
                                else
                                    {7168}let (SPc_5640: bitstring,PartC_5641: bitstring) = m1_5639 in
                                    {7169}event endSrv(Cli_5510,Sess_5512,PartC_5641);
                                    {7170}new Ns_5642: bitstring;
                                    {7171}let gNs_5643: bitstring = exp(g,Ns_5642) in
                                    {7172}let m2_5644: bitstring = gNs_5643 in
                                    {7173}out(c, (enc(m2_5644,pkCli_5578),sign(m2_5644,skSess)));
                                    {7174}event beginSrv(Sess_5512,Cli_5510,gNs_5643)
                        )
                        else
                            {7175}let v_5645: bool = (Cli_5510 = C) in
                            (
                                {7176}if v_5645 then
                                (
                                    {7177}let pkCli_5646: bitstring = pub(skC) in
                                    {7178}let v_5647: bool = (Disco_5511 = A) in
                                    (
                                        {7179}if v_5647 then
                                        (
                                            {7180}let pkDisco_5648: bitstring = pub(skA) in
                                            {7181}in(c, (=pkCli_5646,em1_5649: bitstring,sigM1_5650: bitstring));
                                            {7182}let m1_5651: bitstring = dec(em1_5649,skSess) in
                                            {7183}if (verify(m1_5651,sigM1_5650,pkCli_5646) <> true) then
                                                0
                                            else
                                                {7184}let (SPc_5652: bitstring,PartC_5653: bitstring) = m1_5651 in
                                                {7185}event endSrv(Cli_5510,Sess_5512,PartC_5653);
                                                {7186}new Ns_5654: bitstring;
                                                {7187}let gNs_5655: bitstring = exp(g,Ns_5654) in
                                                {7188}let m2_5656: bitstring = gNs_5655 in
                                                {7189}out(c, (enc(m2_5656,pkCli_5646),sign(m2_5656,skSess)));
                                                {7190}event beginSrv(Sess_5512,Cli_5510,gNs_5655)
                                        )
                                        else
                                            {7191}let v_5657: bool = (Disco_5511 = B) in
                                            (
                                                {7192}if v_5657 then
                                                (
                                                    {7193}let pkDisco_5658: bitstring = pub(skB) in
                                                    {7194}in(c, (=pkCli_5646,em1_5659: bitstring,sigM1_5660: bitstring));
                                                    {7195}let m1_5661: bitstring = dec(em1_5659,skSess) in
                                                    {7196}if (verify(m1_5661,sigM1_5660,pkCli_5646) <> true) then
                                                        0
                                                    else
                                                        {7197}let (SPc_5662: bitstring,PartC_5663: bitstring) = m1_5661 in
                                                        {7198}event endSrv(Cli_5510,Sess_5512,PartC_5663);
                                                        {7199}new Ns_5664: bitstring;
                                                        {7200}let gNs_5665: bitstring = exp(g,Ns_5664) in
                                                        {7201}let m2_5666: bitstring = gNs_5665 in
                                                        {7202}out(c, (enc(m2_5666,pkCli_5646),sign(m2_5666,skSess)));
                                                        {7203}event beginSrv(Sess_5512,Cli_5510,gNs_5665)
                                                )
                                                else
                                                    {7204}let v_5667: bool = (Disco_5511 = C) in
                                                    (
                                                        {7205}if v_5667 then
                                                        (
                                                            {7206}let pkDisco_5668: bitstring = pub(skC) in
                                                            {7207}in(c, (=pkCli_5646,em1_5669: bitstring,sigM1_5670: bitstring));
                                                            {7208}let m1_5671: bitstring = dec(em1_5669,skSess) in
                                                            {7209}if (verify(m1_5671,sigM1_5670,pkCli_5646) <> true) then
                                                                0
                                                            else
                                                                {7210}let (SPc_5672: bitstring,PartC_5673: bitstring) = m1_5671 in
                                                                {7211}event endSrv(Cli_5510,Sess_5512,PartC_5673);
                                                                {7212}new Ns_5674: bitstring;
                                                                {7213}let gNs_5675: bitstring = exp(g,Ns_5674) in
                                                                {7214}let m2_5676: bitstring = gNs_5675 in
                                                                {7215}out(c, (enc(m2_5676,pkCli_5646),sign(m2_5676,skSess)));
                                                                {7216}event beginSrv(Sess_5512,Cli_5510,gNs_5675)
                                                        )
                                                        else
                                                            {7217}let pkDisco_5677: bitstring = pub(skI) in
                                                            {7218}in(c, (=pkCli_5646,em1_5678: bitstring,sigM1_5679: bitstring));
                                                            {7219}let m1_5680: bitstring = dec(em1_5678,skSess) in
                                                            {7220}if (verify(m1_5680,sigM1_5679,pkCli_5646) <> true) then
                                                                0
                                                            else
                                                                {7221}let (SPc_5681: bitstring,PartC_5682: bitstring) = m1_5680 in
                                                                {7222}event endSrv(Cli_5510,Sess_5512,PartC_5682);
                                                                {7223}new Ns_5683: bitstring;
                                                                {7224}let gNs_5684: bitstring = exp(g,Ns_5683) in
                                                                {7225}let m2_5685: bitstring = gNs_5684 in
                                                                {7226}out(c, (enc(m2_5685,pkCli_5646),sign(m2_5685,skSess)));
                                                                {7227}event beginSrv(Sess_5512,Cli_5510,gNs_5684)
                                                    )
                                                    else
                                                        {7228}let pkDisco_5686: bitstring = fail-any in
                                                        {7229}in(c, (=pkCli_5646,em1_5687: bitstring,sigM1_5688: bitstring));
                                                        {7230}let m1_5689: bitstring = dec(em1_5687,skSess) in
                                                        {7231}if (verify(m1_5689,sigM1_5688,pkCli_5646) <> true) then
                                                            0
                                                        else
                                                            {7232}let (SPc_5690: bitstring,PartC_5691: bitstring) = m1_5689 in
                                                            {7233}event endSrv(Cli_5510,Sess_5512,PartC_5691);
                                                            {7234}new Ns_5692: bitstring;
                                                            {7235}let gNs_5693: bitstring = exp(g,Ns_5692) in
                                                            {7236}let m2_5694: bitstring = gNs_5693 in
                                                            {7237}out(c, (enc(m2_5694,pkCli_5646),sign(m2_5694,skSess)));
                                                            {7238}event beginSrv(Sess_5512,Cli_5510,gNs_5693)
                                            )
                                            else
                                                {7239}let pkDisco_5695: bitstring = fail-any in
                                                {7240}in(c, (=pkCli_5646,em1_5696: bitstring,sigM1_5697: bitstring));
                                                {7241}let m1_5698: bitstring = dec(em1_5696,skSess) in
                                                {7242}if (verify(m1_5698,sigM1_5697,pkCli_5646) <> true) then
                                                    0
                                                else
                                                    {7243}let (SPc_5699: bitstring,PartC_5700: bitstring) = m1_5698 in
                                                    {7244}event endSrv(Cli_5510,Sess_5512,PartC_5700);
                                                    {7245}new Ns_5701: bitstring;
                                                    {7246}let gNs_5702: bitstring = exp(g,Ns_5701) in
                                                    {7247}let m2_5703: bitstring = gNs_5702 in
                                                    {7248}out(c, (enc(m2_5703,pkCli_5646),sign(m2_5703,skSess)));
                                                    {7249}event beginSrv(Sess_5512,Cli_5510,gNs_5702)
                                    )
                                    else
                                        {7250}let pkDisco_5704: bitstring = fail-any in
                                        {7251}in(c, (=pkCli_5646,em1_5705: bitstring,sigM1_5706: bitstring));
                                        {7252}let m1_5707: bitstring = dec(em1_5705,skSess) in
                                        {7253}if (verify(m1_5707,sigM1_5706,pkCli_5646) <> true) then
                                            0
                                        else
                                            {7254}let (SPc_5708: bitstring,PartC_5709: bitstring) = m1_5707 in
                                            {7255}event endSrv(Cli_5510,Sess_5512,PartC_5709);
                                            {7256}new Ns_5710: bitstring;
                                            {7257}let gNs_5711: bitstring = exp(g,Ns_5710) in
                                            {7258}let m2_5712: bitstring = gNs_5711 in
                                            {7259}out(c, (enc(m2_5712,pkCli_5646),sign(m2_5712,skSess)));
                                            {7260}event beginSrv(Sess_5512,Cli_5510,gNs_5711)
                                )
                                else
                                    {7261}let pkCli_5713: bitstring = pub(skI) in
                                    {7262}let v_5714: bool = (Disco_5511 = A) in
                                    (
                                        {7263}if v_5714 then
                                        (
                                            {7264}let pkDisco_5715: bitstring = pub(skA) in
                                            {7265}in(c, (=pkCli_5713,em1_5716: bitstring,sigM1_5717: bitstring));
                                            {7266}let m1_5718: bitstring = dec(em1_5716,skSess) in
                                            {7267}if (verify(m1_5718,sigM1_5717,pkCli_5713) <> true) then
                                                0
                                            else
                                                {7268}let (SPc_5719: bitstring,PartC_5720: bitstring) = m1_5718 in
                                                {7269}event endSrv(Cli_5510,Sess_5512,PartC_5720);
                                                {7270}new Ns_5721: bitstring;
                                                {7271}let gNs_5722: bitstring = exp(g,Ns_5721) in
                                                {7272}let m2_5723: bitstring = gNs_5722 in
                                                {7273}out(c, (enc(m2_5723,pkCli_5713),sign(m2_5723,skSess)));
                                                {7274}event beginSrv(Sess_5512,Cli_5510,gNs_5722)
                                        )
                                        else
                                            {7275}let v_5724: bool = (Disco_5511 = B) in
                                            (
                                                {7276}if v_5724 then
                                                (
                                                    {7277}let pkDisco_5725: bitstring = pub(skB) in
                                                    {7278}in(c, (=pkCli_5713,em1_5726: bitstring,sigM1_5727: bitstring));
                                                    {7279}let m1_5728: bitstring = dec(em1_5726,skSess) in
                                                    {7280}if (verify(m1_5728,sigM1_5727,pkCli_5713) <> true) then
                                                        0
                                                    else
                                                        {7281}let (SPc_5729: bitstring,PartC_5730: bitstring) = m1_5728 in
                                                        {7282}event endSrv(Cli_5510,Sess_5512,PartC_5730);
                                                        {7283}new Ns_5731: bitstring;
                                                        {7284}let gNs_5732: bitstring = exp(g,Ns_5731) in
                                                        {7285}let m2_5733: bitstring = gNs_5732 in
                                                        {7286}out(c, (enc(m2_5733,pkCli_5713),sign(m2_5733,skSess)));
                                                        {7287}event beginSrv(Sess_5512,Cli_5510,gNs_5732)
                                                )
                                                else
                                                    {7288}let v_5734: bool = (Disco_5511 = C) in
                                                    (
                                                        {7289}if v_5734 then
                                                        (
                                                            {7290}let pkDisco_5735: bitstring = pub(skC) in
                                                            {7291}in(c, (=pkCli_5713,em1_5736: bitstring,sigM1_5737: bitstring));
                                                            {7292}let m1_5738: bitstring = dec(em1_5736,skSess) in
                                                            {7293}if (verify(m1_5738,sigM1_5737,pkCli_5713) <> true) then
                                                                0
                                                            else
                                                                {7294}let (SPc_5739: bitstring,PartC_5740: bitstring) = m1_5738 in
                                                                {7295}event endSrv(Cli_5510,Sess_5512,PartC_5740);
                                                                {7296}new Ns_5741: bitstring;
                                                                {7297}let gNs_5742: bitstring = exp(g,Ns_5741) in
                                                                {7298}let m2_5743: bitstring = gNs_5742 in
                                                                {7299}out(c, (enc(m2_5743,pkCli_5713),sign(m2_5743,skSess)));
                                                                {7300}event beginSrv(Sess_5512,Cli_5510,gNs_5742)
                                                        )
                                                        else
                                                            {7301}let pkDisco_5744: bitstring = pub(skI) in
                                                            {7302}in(c, (=pkCli_5713,em1_5745: bitstring,sigM1_5746: bitstring));
                                                            {7303}let m1_5747: bitstring = dec(em1_5745,skSess) in
                                                            {7304}if (verify(m1_5747,sigM1_5746,pkCli_5713) <> true) then
                                                                0
                                                            else
                                                                {7305}let (SPc_5748: bitstring,PartC_5749: bitstring) = m1_5747 in
                                                                {7306}event endSrv(Cli_5510,Sess_5512,PartC_5749);
                                                                {7307}new Ns_5750: bitstring;
                                                                {7308}let gNs_5751: bitstring = exp(g,Ns_5750) in
                                                                {7309}let m2_5752: bitstring = gNs_5751 in
                                                                {7310}out(c, (enc(m2_5752,pkCli_5713),sign(m2_5752,skSess)));
                                                                {7311}event beginSrv(Sess_5512,Cli_5510,gNs_5751)
                                                    )
                                                    else
                                                        {7312}let pkDisco_5753: bitstring = fail-any in
                                                        {7313}in(c, (=pkCli_5713,em1_5754: bitstring,sigM1_5755: bitstring));
                                                        {7314}let m1_5756: bitstring = dec(em1_5754,skSess) in
                                                        {7315}if (verify(m1_5756,sigM1_5755,pkCli_5713) <> true) then
                                                            0
                                                        else
                                                            {7316}let (SPc_5757: bitstring,PartC_5758: bitstring) = m1_5756 in
                                                            {7317}event endSrv(Cli_5510,Sess_5512,PartC_5758);
                                                            {7318}new Ns_5759: bitstring;
                                                            {7319}let gNs_5760: bitstring = exp(g,Ns_5759) in
                                                            {7320}let m2_5761: bitstring = gNs_5760 in
                                                            {7321}out(c, (enc(m2_5761,pkCli_5713),sign(m2_5761,skSess)));
                                                            {7322}event beginSrv(Sess_5512,Cli_5510,gNs_5760)
                                            )
                                            else
                                                {7323}let pkDisco_5762: bitstring = fail-any in
                                                {7324}in(c, (=pkCli_5713,em1_5763: bitstring,sigM1_5764: bitstring));
                                                {7325}let m1_5765: bitstring = dec(em1_5763,skSess) in
                                                {7326}if (verify(m1_5765,sigM1_5764,pkCli_5713) <> true) then
                                                    0
                                                else
                                                    {7327}let (SPc_5766: bitstring,PartC_5767: bitstring) = m1_5765 in
                                                    {7328}event endSrv(Cli_5510,Sess_5512,PartC_5767);
                                                    {7329}new Ns_5768: bitstring;
                                                    {7330}let gNs_5769: bitstring = exp(g,Ns_5768) in
                                                    {7331}let m2_5770: bitstring = gNs_5769 in
                                                    {7332}out(c, (enc(m2_5770,pkCli_5713),sign(m2_5770,skSess)));
                                                    {7333}event beginSrv(Sess_5512,Cli_5510,gNs_5769)
                                    )
                                    else
                                        {7334}let pkDisco_5771: bitstring = fail-any in
                                        {7335}in(c, (=pkCli_5713,em1_5772: bitstring,sigM1_5773: bitstring));
                                        {7336}let m1_5774: bitstring = dec(em1_5772,skSess) in
                                        {7337}if (verify(m1_5774,sigM1_5773,pkCli_5713) <> true) then
                                            0
                                        else
                                            {7338}let (SPc_5775: bitstring,PartC_5776: bitstring) = m1_5774 in
                                            {7339}event endSrv(Cli_5510,Sess_5512,PartC_5776);
                                            {7340}new Ns_5777: bitstring;
                                            {7341}let gNs_5778: bitstring = exp(g,Ns_5777) in
                                            {7342}let m2_5779: bitstring = gNs_5778 in
                                            {7343}out(c, (enc(m2_5779,pkCli_5713),sign(m2_5779,skSess)));
                                            {7344}event beginSrv(Sess_5512,Cli_5510,gNs_5778)
                            )
                            else
                                {7345}let pkCli_5780: bitstring = fail-any in
                                {7346}let v_5781: bool = (Disco_5511 = A) in
                                (
                                    {7347}if v_5781 then
                                    (
                                        {7348}let pkDisco_5782: bitstring = pub(skA) in
                                        {7349}in(c, (=pkCli_5780,em1_5783: bitstring,sigM1_5784: bitstring));
                                        {7350}let m1_5785: bitstring = dec(em1_5783,skSess) in
                                        {7351}if (verify(m1_5785,sigM1_5784,pkCli_5780) <> true) then
                                            0
                                        else
                                            {7352}let (SPc_5786: bitstring,PartC_5787: bitstring) = m1_5785 in
                                            {7353}event endSrv(Cli_5510,Sess_5512,PartC_5787);
                                            {7354}new Ns_5788: bitstring;
                                            {7355}let gNs_5789: bitstring = exp(g,Ns_5788) in
                                            {7356}let m2_5790: bitstring = gNs_5789 in
                                            {7357}out(c, (enc(m2_5790,pkCli_5780),sign(m2_5790,skSess)));
                                            {7358}event beginSrv(Sess_5512,Cli_5510,gNs_5789)
                                    )
                                    else
                                        {7359}let v_5791: bool = (Disco_5511 = B) in
                                        (
                                            {7360}if v_5791 then
                                            (
                                                {7361}let pkDisco_5792: bitstring = pub(skB) in
                                                {7362}in(c, (=pkCli_5780,em1_5793: bitstring,sigM1_5794: bitstring));
                                                {7363}let m1_5795: bitstring = dec(em1_5793,skSess) in
                                                {7364}if (verify(m1_5795,sigM1_5794,pkCli_5780) <> true) then
                                                    0
                                                else
                                                    {7365}let (SPc_5796: bitstring,PartC_5797: bitstring) = m1_5795 in
                                                    {7366}event endSrv(Cli_5510,Sess_5512,PartC_5797);
                                                    {7367}new Ns_5798: bitstring;
                                                    {7368}let gNs_5799: bitstring = exp(g,Ns_5798) in
                                                    {7369}let m2_5800: bitstring = gNs_5799 in
                                                    {7370}out(c, (enc(m2_5800,pkCli_5780),sign(m2_5800,skSess)));
                                                    {7371}event beginSrv(Sess_5512,Cli_5510,gNs_5799)
                                            )
                                            else
                                                {7372}let v_5801: bool = (Disco_5511 = C) in
                                                (
                                                    {7373}if v_5801 then
                                                    (
                                                        {7374}let pkDisco_5802: bitstring = pub(skC) in
                                                        {7375}in(c, (=pkCli_5780,em1_5803: bitstring,sigM1_5804: bitstring));
                                                        {7376}let m1_5805: bitstring = dec(em1_5803,skSess) in
                                                        {7377}if (verify(m1_5805,sigM1_5804,pkCli_5780) <> true) then
                                                            0
                                                        else
                                                            {7378}let (SPc_5806: bitstring,PartC_5807: bitstring) = m1_5805 in
                                                            {7379}event endSrv(Cli_5510,Sess_5512,PartC_5807);
                                                            {7380}new Ns_5808: bitstring;
                                                            {7381}let gNs_5809: bitstring = exp(g,Ns_5808) in
                                                            {7382}let m2_5810: bitstring = gNs_5809 in
                                                            {7383}out(c, (enc(m2_5810,pkCli_5780),sign(m2_5810,skSess)));
                                                            {7384}event beginSrv(Sess_5512,Cli_5510,gNs_5809)
                                                    )
                                                    else
                                                        {7385}let pkDisco_5811: bitstring = pub(skI) in
                                                        {7386}in(c, (=pkCli_5780,em1_5812: bitstring,sigM1_5813: bitstring));
                                                        {7387}let m1_5814: bitstring = dec(em1_5812,skSess) in
                                                        {7388}if (verify(m1_5814,sigM1_5813,pkCli_5780) <> true) then
                                                            0
                                                        else
                                                            {7389}let (SPc_5815: bitstring,PartC_5816: bitstring) = m1_5814 in
                                                            {7390}event endSrv(Cli_5510,Sess_5512,PartC_5816);
                                                            {7391}new Ns_5817: bitstring;
                                                            {7392}let gNs_5818: bitstring = exp(g,Ns_5817) in
                                                            {7393}let m2_5819: bitstring = gNs_5818 in
                                                            {7394}out(c, (enc(m2_5819,pkCli_5780),sign(m2_5819,skSess)));
                                                            {7395}event beginSrv(Sess_5512,Cli_5510,gNs_5818)
                                                )
                                                else
                                                    {7396}let pkDisco_5820: bitstring = fail-any in
                                                    {7397}in(c, (=pkCli_5780,em1_5821: bitstring,sigM1_5822: bitstring));
                                                    {7398}let m1_5823: bitstring = dec(em1_5821,skSess) in
                                                    {7399}if (verify(m1_5823,sigM1_5822,pkCli_5780) <> true) then
                                                        0
                                                    else
                                                        {7400}let (SPc_5824: bitstring,PartC_5825: bitstring) = m1_5823 in
                                                        {7401}event endSrv(Cli_5510,Sess_5512,PartC_5825);
                                                        {7402}new Ns_5826: bitstring;
                                                        {7403}let gNs_5827: bitstring = exp(g,Ns_5826) in
                                                        {7404}let m2_5828: bitstring = gNs_5827 in
                                                        {7405}out(c, (enc(m2_5828,pkCli_5780),sign(m2_5828,skSess)));
                                                        {7406}event beginSrv(Sess_5512,Cli_5510,gNs_5827)
                                        )
                                        else
                                            {7407}let pkDisco_5829: bitstring = fail-any in
                                            {7408}in(c, (=pkCli_5780,em1_5830: bitstring,sigM1_5831: bitstring));
                                            {7409}let m1_5832: bitstring = dec(em1_5830,skSess) in
                                            {7410}if (verify(m1_5832,sigM1_5831,pkCli_5780) <> true) then
                                                0
                                            else
                                                {7411}let (SPc_5833: bitstring,PartC_5834: bitstring) = m1_5832 in
                                                {7412}event endSrv(Cli_5510,Sess_5512,PartC_5834);
                                                {7413}new Ns_5835: bitstring;
                                                {7414}let gNs_5836: bitstring = exp(g,Ns_5835) in
                                                {7415}let m2_5837: bitstring = gNs_5836 in
                                                {7416}out(c, (enc(m2_5837,pkCli_5780),sign(m2_5837,skSess)));
                                                {7417}event beginSrv(Sess_5512,Cli_5510,gNs_5836)
                                )
                                else
                                    {7418}let pkDisco_5838: bitstring = fail-any in
                                    {7419}in(c, (=pkCli_5780,em1_5839: bitstring,sigM1_5840: bitstring));
                                    {7420}let m1_5841: bitstring = dec(em1_5839,skSess) in
                                    {7421}if (verify(m1_5841,sigM1_5840,pkCli_5780) <> true) then
                                        0
                                    else
                                        {7422}let (SPc_5842: bitstring,PartC_5843: bitstring) = m1_5841 in
                                        {7423}event endSrv(Cli_5510,Sess_5512,PartC_5843);
                                        {7424}new Ns_5844: bitstring;
                                        {7425}let gNs_5845: bitstring = exp(g,Ns_5844) in
                                        {7426}let m2_5846: bitstring = gNs_5845 in
                                        {7427}out(c, (enc(m2_5846,pkCli_5780),sign(m2_5846,skSess)));
                                        {7428}event beginSrv(Sess_5512,Cli_5510,gNs_5845)
                    )
                    else
                        {7429}let pkCli_5847: bitstring = fail-any in
                        {7430}let v_5848: bool = (Disco_5511 = A) in
                        (
                            {7431}if v_5848 then
                            (
                                {7432}let pkDisco_5849: bitstring = pub(skA) in
                                {7433}in(c, (=pkCli_5847,em1_5850: bitstring,sigM1_5851: bitstring));
                                {7434}let m1_5852: bitstring = dec(em1_5850,skSess) in
                                {7435}if (verify(m1_5852,sigM1_5851,pkCli_5847) <> true) then
                                    0
                                else
                                    {7436}let (SPc_5853: bitstring,PartC_5854: bitstring) = m1_5852 in
                                    {7437}event endSrv(Cli_5510,Sess_5512,PartC_5854);
                                    {7438}new Ns_5855: bitstring;
                                    {7439}let gNs_5856: bitstring = exp(g,Ns_5855) in
                                    {7440}let m2_5857: bitstring = gNs_5856 in
                                    {7441}out(c, (enc(m2_5857,pkCli_5847),sign(m2_5857,skSess)));
                                    {7442}event beginSrv(Sess_5512,Cli_5510,gNs_5856)
                            )
                            else
                                {7443}let v_5858: bool = (Disco_5511 = B) in
                                (
                                    {7444}if v_5858 then
                                    (
                                        {7445}let pkDisco_5859: bitstring = pub(skB) in
                                        {7446}in(c, (=pkCli_5847,em1_5860: bitstring,sigM1_5861: bitstring));
                                        {7447}let m1_5862: bitstring = dec(em1_5860,skSess) in
                                        {7448}if (verify(m1_5862,sigM1_5861,pkCli_5847) <> true) then
                                            0
                                        else
                                            {7449}let (SPc_5863: bitstring,PartC_5864: bitstring) = m1_5862 in
                                            {7450}event endSrv(Cli_5510,Sess_5512,PartC_5864);
                                            {7451}new Ns_5865: bitstring;
                                            {7452}let gNs_5866: bitstring = exp(g,Ns_5865) in
                                            {7453}let m2_5867: bitstring = gNs_5866 in
                                            {7454}out(c, (enc(m2_5867,pkCli_5847),sign(m2_5867,skSess)));
                                            {7455}event beginSrv(Sess_5512,Cli_5510,gNs_5866)
                                    )
                                    else
                                        {7456}let v_5868: bool = (Disco_5511 = C) in
                                        (
                                            {7457}if v_5868 then
                                            (
                                                {7458}let pkDisco_5869: bitstring = pub(skC) in
                                                {7459}in(c, (=pkCli_5847,em1_5870: bitstring,sigM1_5871: bitstring));
                                                {7460}let m1_5872: bitstring = dec(em1_5870,skSess) in
                                                {7461}if (verify(m1_5872,sigM1_5871,pkCli_5847) <> true) then
                                                    0
                                                else
                                                    {7462}let (SPc_5873: bitstring,PartC_5874: bitstring) = m1_5872 in
                                                    {7463}event endSrv(Cli_5510,Sess_5512,PartC_5874);
                                                    {7464}new Ns_5875: bitstring;
                                                    {7465}let gNs_5876: bitstring = exp(g,Ns_5875) in
                                                    {7466}let m2_5877: bitstring = gNs_5876 in
                                                    {7467}out(c, (enc(m2_5877,pkCli_5847),sign(m2_5877,skSess)));
                                                    {7468}event beginSrv(Sess_5512,Cli_5510,gNs_5876)
                                            )
                                            else
                                                {7469}let pkDisco_5878: bitstring = pub(skI) in
                                                {7470}in(c, (=pkCli_5847,em1_5879: bitstring,sigM1_5880: bitstring));
                                                {7471}let m1_5881: bitstring = dec(em1_5879,skSess) in
                                                {7472}if (verify(m1_5881,sigM1_5880,pkCli_5847) <> true) then
                                                    0
                                                else
                                                    {7473}let (SPc_5882: bitstring,PartC_5883: bitstring) = m1_5881 in
                                                    {7474}event endSrv(Cli_5510,Sess_5512,PartC_5883);
                                                    {7475}new Ns_5884: bitstring;
                                                    {7476}let gNs_5885: bitstring = exp(g,Ns_5884) in
                                                    {7477}let m2_5886: bitstring = gNs_5885 in
                                                    {7478}out(c, (enc(m2_5886,pkCli_5847),sign(m2_5886,skSess)));
                                                    {7479}event beginSrv(Sess_5512,Cli_5510,gNs_5885)
                                        )
                                        else
                                            {7480}let pkDisco_5887: bitstring = fail-any in
                                            {7481}in(c, (=pkCli_5847,em1_5888: bitstring,sigM1_5889: bitstring));
                                            {7482}let m1_5890: bitstring = dec(em1_5888,skSess) in
                                            {7483}if (verify(m1_5890,sigM1_5889,pkCli_5847) <> true) then
                                                0
                                            else
                                                {7484}let (SPc_5891: bitstring,PartC_5892: bitstring) = m1_5890 in
                                                {7485}event endSrv(Cli_5510,Sess_5512,PartC_5892);
                                                {7486}new Ns_5893: bitstring;
                                                {7487}let gNs_5894: bitstring = exp(g,Ns_5893) in
                                                {7488}let m2_5895: bitstring = gNs_5894 in
                                                {7489}out(c, (enc(m2_5895,pkCli_5847),sign(m2_5895,skSess)));
                                                {7490}event beginSrv(Sess_5512,Cli_5510,gNs_5894)
                                )
                                else
                                    {7491}let pkDisco_5896: bitstring = fail-any in
                                    {7492}in(c, (=pkCli_5847,em1_5897: bitstring,sigM1_5898: bitstring));
                                    {7493}let m1_5899: bitstring = dec(em1_5897,skSess) in
                                    {7494}if (verify(m1_5899,sigM1_5898,pkCli_5847) <> true) then
                                        0
                                    else
                                        {7495}let (SPc_5900: bitstring,PartC_5901: bitstring) = m1_5899 in
                                        {7496}event endSrv(Cli_5510,Sess_5512,PartC_5901);
                                        {7497}new Ns_5902: bitstring;
                                        {7498}let gNs_5903: bitstring = exp(g,Ns_5902) in
                                        {7499}let m2_5904: bitstring = gNs_5903 in
                                        {7500}out(c, (enc(m2_5904,pkCli_5847),sign(m2_5904,skSess)));
                                        {7501}event beginSrv(Sess_5512,Cli_5510,gNs_5903)
                        )
                        else
                            {7502}let pkDisco_5905: bitstring = fail-any in
                            {7503}in(c, (=pkCli_5847,em1_5906: bitstring,sigM1_5907: bitstring));
                            {7504}let m1_5908: bitstring = dec(em1_5906,skSess) in
                            {7505}if (verify(m1_5908,sigM1_5907,pkCli_5847) <> true) then
                                0
                            else
                                {7506}let (SPc_5909: bitstring,PartC_5910: bitstring) = m1_5908 in
                                {7507}event endSrv(Cli_5510,Sess_5512,PartC_5910);
                                {7508}new Ns_5911: bitstring;
                                {7509}let gNs_5912: bitstring = exp(g,Ns_5911) in
                                {7510}let m2_5913: bitstring = gNs_5912 in
                                {7511}out(c, (enc(m2_5913,pkCli_5847),sign(m2_5913,skSess)));
                                {7512}event beginSrv(Sess_5512,Cli_5510,gNs_5912)
            )
            else
                {7513}let pkCli_5914: bitstring = fail-any in
                {7514}let v_5915: bool = (Disco_5511 = A) in
                (
                    {7515}if v_5915 then
                    (
                        {7516}let pkDisco_5916: bitstring = pub(skA) in
                        {7517}in(c, (=pkCli_5914,em1_5917: bitstring,sigM1_5918: bitstring));
                        {7518}let m1_5919: bitstring = dec(em1_5917,skSess) in
                        {7519}if (verify(m1_5919,sigM1_5918,pkCli_5914) <> true) then
                            0
                        else
                            {7520}let (SPc_5920: bitstring,PartC_5921: bitstring) = m1_5919 in
                            {7521}event endSrv(Cli_5510,Sess_5512,PartC_5921);
                            {7522}new Ns_5922: bitstring;
                            {7523}let gNs_5923: bitstring = exp(g,Ns_5922) in
                            {7524}let m2_5924: bitstring = gNs_5923 in
                            {7525}out(c, (enc(m2_5924,pkCli_5914),sign(m2_5924,skSess)));
                            {7526}event beginSrv(Sess_5512,Cli_5510,gNs_5923)
                    )
                    else
                        {7527}let v_5925: bool = (Disco_5511 = B) in
                        (
                            {7528}if v_5925 then
                            (
                                {7529}let pkDisco_5926: bitstring = pub(skB) in
                                {7530}in(c, (=pkCli_5914,em1_5927: bitstring,sigM1_5928: bitstring));
                                {7531}let m1_5929: bitstring = dec(em1_5927,skSess) in
                                {7532}if (verify(m1_5929,sigM1_5928,pkCli_5914) <> true) then
                                    0
                                else
                                    {7533}let (SPc_5930: bitstring,PartC_5931: bitstring) = m1_5929 in
                                    {7534}event endSrv(Cli_5510,Sess_5512,PartC_5931);
                                    {7535}new Ns_5932: bitstring;
                                    {7536}let gNs_5933: bitstring = exp(g,Ns_5932) in
                                    {7537}let m2_5934: bitstring = gNs_5933 in
                                    {7538}out(c, (enc(m2_5934,pkCli_5914),sign(m2_5934,skSess)));
                                    {7539}event beginSrv(Sess_5512,Cli_5510,gNs_5933)
                            )
                            else
                                {7540}let v_5935: bool = (Disco_5511 = C) in
                                (
                                    {7541}if v_5935 then
                                    (
                                        {7542}let pkDisco_5936: bitstring = pub(skC) in
                                        {7543}in(c, (=pkCli_5914,em1_5937: bitstring,sigM1_5938: bitstring));
                                        {7544}let m1_5939: bitstring = dec(em1_5937,skSess) in
                                        {7545}if (verify(m1_5939,sigM1_5938,pkCli_5914) <> true) then
                                            0
                                        else
                                            {7546}let (SPc_5940: bitstring,PartC_5941: bitstring) = m1_5939 in
                                            {7547}event endSrv(Cli_5510,Sess_5512,PartC_5941);
                                            {7548}new Ns_5942: bitstring;
                                            {7549}let gNs_5943: bitstring = exp(g,Ns_5942) in
                                            {7550}let m2_5944: bitstring = gNs_5943 in
                                            {7551}out(c, (enc(m2_5944,pkCli_5914),sign(m2_5944,skSess)));
                                            {7552}event beginSrv(Sess_5512,Cli_5510,gNs_5943)
                                    )
                                    else
                                        {7553}let pkDisco_5945: bitstring = pub(skI) in
                                        {7554}in(c, (=pkCli_5914,em1_5946: bitstring,sigM1_5947: bitstring));
                                        {7555}let m1_5948: bitstring = dec(em1_5946,skSess) in
                                        {7556}if (verify(m1_5948,sigM1_5947,pkCli_5914) <> true) then
                                            0
                                        else
                                            {7557}let (SPc_5949: bitstring,PartC_5950: bitstring) = m1_5948 in
                                            {7558}event endSrv(Cli_5510,Sess_5512,PartC_5950);
                                            {7559}new Ns_5951: bitstring;
                                            {7560}let gNs_5952: bitstring = exp(g,Ns_5951) in
                                            {7561}let m2_5953: bitstring = gNs_5952 in
                                            {7562}out(c, (enc(m2_5953,pkCli_5914),sign(m2_5953,skSess)));
                                            {7563}event beginSrv(Sess_5512,Cli_5510,gNs_5952)
                                )
                                else
                                    {7564}let pkDisco_5954: bitstring = fail-any in
                                    {7565}in(c, (=pkCli_5914,em1_5955: bitstring,sigM1_5956: bitstring));
                                    {7566}let m1_5957: bitstring = dec(em1_5955,skSess) in
                                    {7567}if (verify(m1_5957,sigM1_5956,pkCli_5914) <> true) then
                                        0
                                    else
                                        {7568}let (SPc_5958: bitstring,PartC_5959: bitstring) = m1_5957 in
                                        {7569}event endSrv(Cli_5510,Sess_5512,PartC_5959);
                                        {7570}new Ns_5960: bitstring;
                                        {7571}let gNs_5961: bitstring = exp(g,Ns_5960) in
                                        {7572}let m2_5962: bitstring = gNs_5961 in
                                        {7573}out(c, (enc(m2_5962,pkCli_5914),sign(m2_5962,skSess)));
                                        {7574}event beginSrv(Sess_5512,Cli_5510,gNs_5961)
                        )
                        else
                            {7575}let pkDisco_5963: bitstring = fail-any in
                            {7576}in(c, (=pkCli_5914,em1_5964: bitstring,sigM1_5965: bitstring));
                            {7577}let m1_5966: bitstring = dec(em1_5964,skSess) in
                            {7578}if (verify(m1_5966,sigM1_5965,pkCli_5914) <> true) then
                                0
                            else
                                {7579}let (SPc_5967: bitstring,PartC_5968: bitstring) = m1_5966 in
                                {7580}event endSrv(Cli_5510,Sess_5512,PartC_5968);
                                {7581}new Ns_5969: bitstring;
                                {7582}let gNs_5970: bitstring = exp(g,Ns_5969) in
                                {7583}let m2_5971: bitstring = gNs_5970 in
                                {7584}out(c, (enc(m2_5971,pkCli_5914),sign(m2_5971,skSess)));
                                {7585}event beginSrv(Sess_5512,Cli_5510,gNs_5970)
                )
                else
                    {7586}let pkDisco_5972: bitstring = fail-any in
                    {7587}in(c, (=pkCli_5914,em1_5973: bitstring,sigM1_5974: bitstring));
                    {7588}let m1_5975: bitstring = dec(em1_5973,skSess) in
                    {7589}if (verify(m1_5975,sigM1_5974,pkCli_5914) <> true) then
                        0
                    else
                        {7590}let (SPc_5976: bitstring,PartC_5977: bitstring) = m1_5975 in
                        {7591}event endSrv(Cli_5510,Sess_5512,PartC_5977);
                        {7592}new Ns_5978: bitstring;
                        {7593}let gNs_5979: bitstring = exp(g,Ns_5978) in
                        {7594}let m2_5980: bitstring = gNs_5979 in
                        {7595}out(c, (enc(m2_5980,pkCli_5914),sign(m2_5980,skSess)));
                        {7596}event beginSrv(Sess_5512,Cli_5510,gNs_5979)
        )
        else
            {7597}let v_5981: bool = (Sess_5512 = B) in
            (
                {7598}if v_5981 then
                (
                    {7599}let skSess_5982: bitstring = skB in
                    {7600}let pkSess_5983: bitstring = pub(skSess_5982) in
                    {7601}let v_5984: bool = (Cli_5510 = A) in
                    (
                        {7602}if v_5984 then
                        (
                            {7603}let pkCli_5985: bitstring = pub(skA) in
                            {7604}let v_5986: bool = (Disco_5511 = A) in
                            (
                                {7605}if v_5986 then
                                (
                                    {7606}let pkDisco_5987: bitstring = pub(skA) in
                                    {7607}in(c, (=pkCli_5985,em1_5988: bitstring,sigM1_5989: bitstring));
                                    {7608}let m1_5990: bitstring = dec(em1_5988,skSess_5982) in
                                    {7609}if (verify(m1_5990,sigM1_5989,pkCli_5985) <> true) then
                                        0
                                    else
                                        {7610}let (SPc_5991: bitstring,PartC_5992: bitstring) = m1_5990 in
                                        {7611}event endSrv(Cli_5510,Sess_5512,PartC_5992);
                                        {7612}new Ns_5993: bitstring;
                                        {7613}let gNs_5994: bitstring = exp(g,Ns_5993) in
                                        {7614}let m2_5995: bitstring = gNs_5994 in
                                        {7615}out(c, (enc(m2_5995,pkCli_5985),sign(m2_5995,skSess_5982)));
                                        {7616}event beginSrv(Sess_5512,Cli_5510,gNs_5994)
                                )
                                else
                                    {7617}let v_5996: bool = (Disco_5511 = B) in
                                    (
                                        {7618}if v_5996 then
                                        (
                                            {7619}let pkDisco_5997: bitstring = pub(skB) in
                                            {7620}in(c, (=pkCli_5985,em1_5998: bitstring,sigM1_5999: bitstring));
                                            {7621}let m1_6000: bitstring = dec(em1_5998,skSess_5982) in
                                            {7622}if (verify(m1_6000,sigM1_5999,pkCli_5985) <> true) then
                                                0
                                            else
                                                {7623}let (SPc_6001: bitstring,PartC_6002: bitstring) = m1_6000 in
                                                {7624}event endSrv(Cli_5510,Sess_5512,PartC_6002);
                                                {7625}new Ns_6003: bitstring;
                                                {7626}let gNs_6004: bitstring = exp(g,Ns_6003) in
                                                {7627}let m2_6005: bitstring = gNs_6004 in
                                                {7628}out(c, (enc(m2_6005,pkCli_5985),sign(m2_6005,skSess_5982)));
                                                {7629}event beginSrv(Sess_5512,Cli_5510,gNs_6004)
                                        )
                                        else
                                            {7630}let v_6006: bool = (Disco_5511 = C) in
                                            (
                                                {7631}if v_6006 then
                                                (
                                                    {7632}let pkDisco_6007: bitstring = pub(skC) in
                                                    {7633}in(c, (=pkCli_5985,em1_6008: bitstring,sigM1_6009: bitstring));
                                                    {7634}let m1_6010: bitstring = dec(em1_6008,skSess_5982) in
                                                    {7635}if (verify(m1_6010,sigM1_6009,pkCli_5985) <> true) then
                                                        0
                                                    else
                                                        {7636}let (SPc_6011: bitstring,PartC_6012: bitstring) = m1_6010 in
                                                        {7637}event endSrv(Cli_5510,Sess_5512,PartC_6012);
                                                        {7638}new Ns_6013: bitstring;
                                                        {7639}let gNs_6014: bitstring = exp(g,Ns_6013) in
                                                        {7640}let m2_6015: bitstring = gNs_6014 in
                                                        {7641}out(c, (enc(m2_6015,pkCli_5985),sign(m2_6015,skSess_5982)));
                                                        {7642}event beginSrv(Sess_5512,Cli_5510,gNs_6014)
                                                )
                                                else
                                                    {7643}let pkDisco_6016: bitstring = pub(skI) in
                                                    {7644}in(c, (=pkCli_5985,em1_6017: bitstring,sigM1_6018: bitstring));
                                                    {7645}let m1_6019: bitstring = dec(em1_6017,skSess_5982) in
                                                    {7646}if (verify(m1_6019,sigM1_6018,pkCli_5985) <> true) then
                                                        0
                                                    else
                                                        {7647}let (SPc_6020: bitstring,PartC_6021: bitstring) = m1_6019 in
                                                        {7648}event endSrv(Cli_5510,Sess_5512,PartC_6021);
                                                        {7649}new Ns_6022: bitstring;
                                                        {7650}let gNs_6023: bitstring = exp(g,Ns_6022) in
                                                        {7651}let m2_6024: bitstring = gNs_6023 in
                                                        {7652}out(c, (enc(m2_6024,pkCli_5985),sign(m2_6024,skSess_5982)));
                                                        {7653}event beginSrv(Sess_5512,Cli_5510,gNs_6023)
                                            )
                                            else
                                                {7654}let pkDisco_6025: bitstring = fail-any in
                                                {7655}in(c, (=pkCli_5985,em1_6026: bitstring,sigM1_6027: bitstring));
                                                {7656}let m1_6028: bitstring = dec(em1_6026,skSess_5982) in
                                                {7657}if (verify(m1_6028,sigM1_6027,pkCli_5985) <> true) then
                                                    0
                                                else
                                                    {7658}let (SPc_6029: bitstring,PartC_6030: bitstring) = m1_6028 in
                                                    {7659}event endSrv(Cli_5510,Sess_5512,PartC_6030);
                                                    {7660}new Ns_6031: bitstring;
                                                    {7661}let gNs_6032: bitstring = exp(g,Ns_6031) in
                                                    {7662}let m2_6033: bitstring = gNs_6032 in
                                                    {7663}out(c, (enc(m2_6033,pkCli_5985),sign(m2_6033,skSess_5982)));
                                                    {7664}event beginSrv(Sess_5512,Cli_5510,gNs_6032)
                                    )
                                    else
                                        {7665}let pkDisco_6034: bitstring = fail-any in
                                        {7666}in(c, (=pkCli_5985,em1_6035: bitstring,sigM1_6036: bitstring));
                                        {7667}let m1_6037: bitstring = dec(em1_6035,skSess_5982) in
                                        {7668}if (verify(m1_6037,sigM1_6036,pkCli_5985) <> true) then
                                            0
                                        else
                                            {7669}let (SPc_6038: bitstring,PartC_6039: bitstring) = m1_6037 in
                                            {7670}event endSrv(Cli_5510,Sess_5512,PartC_6039);
                                            {7671}new Ns_6040: bitstring;
                                            {7672}let gNs_6041: bitstring = exp(g,Ns_6040) in
                                            {7673}let m2_6042: bitstring = gNs_6041 in
                                            {7674}out(c, (enc(m2_6042,pkCli_5985),sign(m2_6042,skSess_5982)));
                                            {7675}event beginSrv(Sess_5512,Cli_5510,gNs_6041)
                            )
                            else
                                {7676}let pkDisco_6043: bitstring = fail-any in
                                {7677}in(c, (=pkCli_5985,em1_6044: bitstring,sigM1_6045: bitstring));
                                {7678}let m1_6046: bitstring = dec(em1_6044,skSess_5982) in
                                {7679}if (verify(m1_6046,sigM1_6045,pkCli_5985) <> true) then
                                    0
                                else
                                    {7680}let (SPc_6047: bitstring,PartC_6048: bitstring) = m1_6046 in
                                    {7681}event endSrv(Cli_5510,Sess_5512,PartC_6048);
                                    {7682}new Ns_6049: bitstring;
                                    {7683}let gNs_6050: bitstring = exp(g,Ns_6049) in
                                    {7684}let m2_6051: bitstring = gNs_6050 in
                                    {7685}out(c, (enc(m2_6051,pkCli_5985),sign(m2_6051,skSess_5982)));
                                    {7686}event beginSrv(Sess_5512,Cli_5510,gNs_6050)
                        )
                        else
                            {7687}let v_6052: bool = (Cli_5510 = B) in
                            (
                                {7688}if v_6052 then
                                (
                                    {7689}let pkCli_6053: bitstring = pub(skB) in
                                    {7690}let v_6054: bool = (Disco_5511 = A) in
                                    (
                                        {7691}if v_6054 then
                                        (
                                            {7692}let pkDisco_6055: bitstring = pub(skA) in
                                            {7693}in(c, (=pkCli_6053,em1_6056: bitstring,sigM1_6057: bitstring));
                                            {7694}let m1_6058: bitstring = dec(em1_6056,skSess_5982) in
                                            {7695}if (verify(m1_6058,sigM1_6057,pkCli_6053) <> true) then
                                                0
                                            else
                                                {7696}let (SPc_6059: bitstring,PartC_6060: bitstring) = m1_6058 in
                                                {7697}event endSrv(Cli_5510,Sess_5512,PartC_6060);
                                                {7698}new Ns_6061: bitstring;
                                                {7699}let gNs_6062: bitstring = exp(g,Ns_6061) in
                                                {7700}let m2_6063: bitstring = gNs_6062 in
                                                {7701}out(c, (enc(m2_6063,pkCli_6053),sign(m2_6063,skSess_5982)));
                                                {7702}event beginSrv(Sess_5512,Cli_5510,gNs_6062)
                                        )
                                        else
                                            {7703}let v_6064: bool = (Disco_5511 = B) in
                                            (
                                                {7704}if v_6064 then
                                                (
                                                    {7705}let pkDisco_6065: bitstring = pub(skB) in
                                                    {7706}in(c, (=pkCli_6053,em1_6066: bitstring,sigM1_6067: bitstring));
                                                    {7707}let m1_6068: bitstring = dec(em1_6066,skSess_5982) in
                                                    {7708}if (verify(m1_6068,sigM1_6067,pkCli_6053) <> true) then
                                                        0
                                                    else
                                                        {7709}let (SPc_6069: bitstring,PartC_6070: bitstring) = m1_6068 in
                                                        {7710}event endSrv(Cli_5510,Sess_5512,PartC_6070);
                                                        {7711}new Ns_6071: bitstring;
                                                        {7712}let gNs_6072: bitstring = exp(g,Ns_6071) in
                                                        {7713}let m2_6073: bitstring = gNs_6072 in
                                                        {7714}out(c, (enc(m2_6073,pkCli_6053),sign(m2_6073,skSess_5982)));
                                                        {7715}event beginSrv(Sess_5512,Cli_5510,gNs_6072)
                                                )
                                                else
                                                    {7716}let v_6074: bool = (Disco_5511 = C) in
                                                    (
                                                        {7717}if v_6074 then
                                                        (
                                                            {7718}let pkDisco_6075: bitstring = pub(skC) in
                                                            {7719}in(c, (=pkCli_6053,em1_6076: bitstring,sigM1_6077: bitstring));
                                                            {7720}let m1_6078: bitstring = dec(em1_6076,skSess_5982) in
                                                            {7721}if (verify(m1_6078,sigM1_6077,pkCli_6053) <> true) then
                                                                0
                                                            else
                                                                {7722}let (SPc_6079: bitstring,PartC_6080: bitstring) = m1_6078 in
                                                                {7723}event endSrv(Cli_5510,Sess_5512,PartC_6080);
                                                                {7724}new Ns_6081: bitstring;
                                                                {7725}let gNs_6082: bitstring = exp(g,Ns_6081) in
                                                                {7726}let m2_6083: bitstring = gNs_6082 in
                                                                {7727}out(c, (enc(m2_6083,pkCli_6053),sign(m2_6083,skSess_5982)));
                                                                {7728}event beginSrv(Sess_5512,Cli_5510,gNs_6082)
                                                        )
                                                        else
                                                            {7729}let pkDisco_6084: bitstring = pub(skI) in
                                                            {7730}in(c, (=pkCli_6053,em1_6085: bitstring,sigM1_6086: bitstring));
                                                            {7731}let m1_6087: bitstring = dec(em1_6085,skSess_5982) in
                                                            {7732}if (verify(m1_6087,sigM1_6086,pkCli_6053) <> true) then
                                                                0
                                                            else
                                                                {7733}let (SPc_6088: bitstring,PartC_6089: bitstring) = m1_6087 in
                                                                {7734}event endSrv(Cli_5510,Sess_5512,PartC_6089);
                                                                {7735}new Ns_6090: bitstring;
                                                                {7736}let gNs_6091: bitstring = exp(g,Ns_6090) in
                                                                {7737}let m2_6092: bitstring = gNs_6091 in
                                                                {7738}out(c, (enc(m2_6092,pkCli_6053),sign(m2_6092,skSess_5982)));
                                                                {7739}event beginSrv(Sess_5512,Cli_5510,gNs_6091)
                                                    )
                                                    else
                                                        {7740}let pkDisco_6093: bitstring = fail-any in
                                                        {7741}in(c, (=pkCli_6053,em1_6094: bitstring,sigM1_6095: bitstring));
                                                        {7742}let m1_6096: bitstring = dec(em1_6094,skSess_5982) in
                                                        {7743}if (verify(m1_6096,sigM1_6095,pkCli_6053) <> true) then
                                                            0
                                                        else
                                                            {7744}let (SPc_6097: bitstring,PartC_6098: bitstring) = m1_6096 in
                                                            {7745}event endSrv(Cli_5510,Sess_5512,PartC_6098);
                                                            {7746}new Ns_6099: bitstring;
                                                            {7747}let gNs_6100: bitstring = exp(g,Ns_6099) in
                                                            {7748}let m2_6101: bitstring = gNs_6100 in
                                                            {7749}out(c, (enc(m2_6101,pkCli_6053),sign(m2_6101,skSess_5982)));
                                                            {7750}event beginSrv(Sess_5512,Cli_5510,gNs_6100)
                                            )
                                            else
                                                {7751}let pkDisco_6102: bitstring = fail-any in
                                                {7752}in(c, (=pkCli_6053,em1_6103: bitstring,sigM1_6104: bitstring));
                                                {7753}let m1_6105: bitstring = dec(em1_6103,skSess_5982) in
                                                {7754}if (verify(m1_6105,sigM1_6104,pkCli_6053) <> true) then
                                                    0
                                                else
                                                    {7755}let (SPc_6106: bitstring,PartC_6107: bitstring) = m1_6105 in
                                                    {7756}event endSrv(Cli_5510,Sess_5512,PartC_6107);
                                                    {7757}new Ns_6108: bitstring;
                                                    {7758}let gNs_6109: bitstring = exp(g,Ns_6108) in
                                                    {7759}let m2_6110: bitstring = gNs_6109 in
                                                    {7760}out(c, (enc(m2_6110,pkCli_6053),sign(m2_6110,skSess_5982)));
                                                    {7761}event beginSrv(Sess_5512,Cli_5510,gNs_6109)
                                    )
                                    else
                                        {7762}let pkDisco_6111: bitstring = fail-any in
                                        {7763}in(c, (=pkCli_6053,em1_6112: bitstring,sigM1_6113: bitstring));
                                        {7764}let m1_6114: bitstring = dec(em1_6112,skSess_5982) in
                                        {7765}if (verify(m1_6114,sigM1_6113,pkCli_6053) <> true) then
                                            0
                                        else
                                            {7766}let (SPc_6115: bitstring,PartC_6116: bitstring) = m1_6114 in
                                            {7767}event endSrv(Cli_5510,Sess_5512,PartC_6116);
                                            {7768}new Ns_6117: bitstring;
                                            {7769}let gNs_6118: bitstring = exp(g,Ns_6117) in
                                            {7770}let m2_6119: bitstring = gNs_6118 in
                                            {7771}out(c, (enc(m2_6119,pkCli_6053),sign(m2_6119,skSess_5982)));
                                            {7772}event beginSrv(Sess_5512,Cli_5510,gNs_6118)
                                )
                                else
                                    {7773}let v_6120: bool = (Cli_5510 = C) in
                                    (
                                        {7774}if v_6120 then
                                        (
                                            {7775}let pkCli_6121: bitstring = pub(skC) in
                                            {7776}let v_6122: bool = (Disco_5511 = A) in
                                            (
                                                {7777}if v_6122 then
                                                (
                                                    {7778}let pkDisco_6123: bitstring = pub(skA) in
                                                    {7779}in(c, (=pkCli_6121,em1_6124: bitstring,sigM1_6125: bitstring));
                                                    {7780}let m1_6126: bitstring = dec(em1_6124,skSess_5982) in
                                                    {7781}if (verify(m1_6126,sigM1_6125,pkCli_6121) <> true) then
                                                        0
                                                    else
                                                        {7782}let (SPc_6127: bitstring,PartC_6128: bitstring) = m1_6126 in
                                                        {7783}event endSrv(Cli_5510,Sess_5512,PartC_6128);
                                                        {7784}new Ns_6129: bitstring;
                                                        {7785}let gNs_6130: bitstring = exp(g,Ns_6129) in
                                                        {7786}let m2_6131: bitstring = gNs_6130 in
                                                        {7787}out(c, (enc(m2_6131,pkCli_6121),sign(m2_6131,skSess_5982)));
                                                        {7788}event beginSrv(Sess_5512,Cli_5510,gNs_6130)
                                                )
                                                else
                                                    {7789}let v_6132: bool = (Disco_5511 = B) in
                                                    (
                                                        {7790}if v_6132 then
                                                        (
                                                            {7791}let pkDisco_6133: bitstring = pub(skB) in
                                                            {7792}in(c, (=pkCli_6121,em1_6134: bitstring,sigM1_6135: bitstring));
                                                            {7793}let m1_6136: bitstring = dec(em1_6134,skSess_5982) in
                                                            {7794}if (verify(m1_6136,sigM1_6135,pkCli_6121) <> true) then
                                                                0
                                                            else
                                                                {7795}let (SPc_6137: bitstring,PartC_6138: bitstring) = m1_6136 in
                                                                {7796}event endSrv(Cli_5510,Sess_5512,PartC_6138);
                                                                {7797}new Ns_6139: bitstring;
                                                                {7798}let gNs_6140: bitstring = exp(g,Ns_6139) in
                                                                {7799}let m2_6141: bitstring = gNs_6140 in
                                                                {7800}out(c, (enc(m2_6141,pkCli_6121),sign(m2_6141,skSess_5982)));
                                                                {7801}event beginSrv(Sess_5512,Cli_5510,gNs_6140)
                                                        )
                                                        else
                                                            {7802}let v_6142: bool = (Disco_5511 = C) in
                                                            (
                                                                {7803}if v_6142 then
                                                                (
                                                                    {7804}let pkDisco_6143: bitstring = pub(skC) in
                                                                    {7805}in(c, (=pkCli_6121,em1_6144: bitstring,sigM1_6145: bitstring));
                                                                    {7806}let m1_6146: bitstring = dec(em1_6144,skSess_5982) in
                                                                    {7807}if (verify(m1_6146,sigM1_6145,pkCli_6121) <> true) then
                                                                        0
                                                                    else
                                                                        {7808}let (SPc_6147: bitstring,PartC_6148: bitstring) = m1_6146 in
                                                                        {7809}event endSrv(Cli_5510,Sess_5512,PartC_6148);
                                                                        {7810}new Ns_6149: bitstring;
                                                                        {7811}let gNs_6150: bitstring = exp(g,Ns_6149) in
                                                                        {7812}let m2_6151: bitstring = gNs_6150 in
                                                                        {7813}out(c, (enc(m2_6151,pkCli_6121),sign(m2_6151,skSess_5982)));
                                                                        {7814}event beginSrv(Sess_5512,Cli_5510,gNs_6150)
                                                                )
                                                                else
                                                                    {7815}let pkDisco_6152: bitstring = pub(skI) in
                                                                    {7816}in(c, (=pkCli_6121,em1_6153: bitstring,sigM1_6154: bitstring));
                                                                    {7817}let m1_6155: bitstring = dec(em1_6153,skSess_5982) in
                                                                    {7818}if (verify(m1_6155,sigM1_6154,pkCli_6121) <> true) then
                                                                        0
                                                                    else
                                                                        {7819}let (SPc_6156: bitstring,PartC_6157: bitstring) = m1_6155 in
                                                                        {7820}event endSrv(Cli_5510,Sess_5512,PartC_6157);
                                                                        {7821}new Ns_6158: bitstring;
                                                                        {7822}let gNs_6159: bitstring = exp(g,Ns_6158) in
                                                                        {7823}let m2_6160: bitstring = gNs_6159 in
                                                                        {7824}out(c, (enc(m2_6160,pkCli_6121),sign(m2_6160,skSess_5982)));
                                                                        {7825}event beginSrv(Sess_5512,Cli_5510,gNs_6159)
                                                            )
                                                            else
                                                                {7826}let pkDisco_6161: bitstring = fail-any in
                                                                {7827}in(c, (=pkCli_6121,em1_6162: bitstring,sigM1_6163: bitstring));
                                                                {7828}let m1_6164: bitstring = dec(em1_6162,skSess_5982) in
                                                                {7829}if (verify(m1_6164,sigM1_6163,pkCli_6121) <> true) then
                                                                    0
                                                                else
                                                                    {7830}let (SPc_6165: bitstring,PartC_6166: bitstring) = m1_6164 in
                                                                    {7831}event endSrv(Cli_5510,Sess_5512,PartC_6166);
                                                                    {7832}new Ns_6167: bitstring;
                                                                    {7833}let gNs_6168: bitstring = exp(g,Ns_6167) in
                                                                    {7834}let m2_6169: bitstring = gNs_6168 in
                                                                    {7835}out(c, (enc(m2_6169,pkCli_6121),sign(m2_6169,skSess_5982)));
                                                                    {7836}event beginSrv(Sess_5512,Cli_5510,gNs_6168)
                                                    )
                                                    else
                                                        {7837}let pkDisco_6170: bitstring = fail-any in
                                                        {7838}in(c, (=pkCli_6121,em1_6171: bitstring,sigM1_6172: bitstring));
                                                        {7839}let m1_6173: bitstring = dec(em1_6171,skSess_5982) in
                                                        {7840}if (verify(m1_6173,sigM1_6172,pkCli_6121) <> true) then
                                                            0
                                                        else
                                                            {7841}let (SPc_6174: bitstring,PartC_6175: bitstring) = m1_6173 in
                                                            {7842}event endSrv(Cli_5510,Sess_5512,PartC_6175);
                                                            {7843}new Ns_6176: bitstring;
                                                            {7844}let gNs_6177: bitstring = exp(g,Ns_6176) in
                                                            {7845}let m2_6178: bitstring = gNs_6177 in
                                                            {7846}out(c, (enc(m2_6178,pkCli_6121),sign(m2_6178,skSess_5982)));
                                                            {7847}event beginSrv(Sess_5512,Cli_5510,gNs_6177)
                                            )
                                            else
                                                {7848}let pkDisco_6179: bitstring = fail-any in
                                                {7849}in(c, (=pkCli_6121,em1_6180: bitstring,sigM1_6181: bitstring));
                                                {7850}let m1_6182: bitstring = dec(em1_6180,skSess_5982) in
                                                {7851}if (verify(m1_6182,sigM1_6181,pkCli_6121) <> true) then
                                                    0
                                                else
                                                    {7852}let (SPc_6183: bitstring,PartC_6184: bitstring) = m1_6182 in
                                                    {7853}event endSrv(Cli_5510,Sess_5512,PartC_6184);
                                                    {7854}new Ns_6185: bitstring;
                                                    {7855}let gNs_6186: bitstring = exp(g,Ns_6185) in
                                                    {7856}let m2_6187: bitstring = gNs_6186 in
                                                    {7857}out(c, (enc(m2_6187,pkCli_6121),sign(m2_6187,skSess_5982)));
                                                    {7858}event beginSrv(Sess_5512,Cli_5510,gNs_6186)
                                        )
                                        else
                                            {7859}let pkCli_6188: bitstring = pub(skI) in
                                            {7860}let v_6189: bool = (Disco_5511 = A) in
                                            (
                                                {7861}if v_6189 then
                                                (
                                                    {7862}let pkDisco_6190: bitstring = pub(skA) in
                                                    {7863}in(c, (=pkCli_6188,em1_6191: bitstring,sigM1_6192: bitstring));
                                                    {7864}let m1_6193: bitstring = dec(em1_6191,skSess_5982) in
                                                    {7865}if (verify(m1_6193,sigM1_6192,pkCli_6188) <> true) then
                                                        0
                                                    else
                                                        {7866}let (SPc_6194: bitstring,PartC_6195: bitstring) = m1_6193 in
                                                        {7867}event endSrv(Cli_5510,Sess_5512,PartC_6195);
                                                        {7868}new Ns_6196: bitstring;
                                                        {7869}let gNs_6197: bitstring = exp(g,Ns_6196) in
                                                        {7870}let m2_6198: bitstring = gNs_6197 in
                                                        {7871}out(c, (enc(m2_6198,pkCli_6188),sign(m2_6198,skSess_5982)));
                                                        {7872}event beginSrv(Sess_5512,Cli_5510,gNs_6197)
                                                )
                                                else
                                                    {7873}let v_6199: bool = (Disco_5511 = B) in
                                                    (
                                                        {7874}if v_6199 then
                                                        (
                                                            {7875}let pkDisco_6200: bitstring = pub(skB) in
                                                            {7876}in(c, (=pkCli_6188,em1_6201: bitstring,sigM1_6202: bitstring));
                                                            {7877}let m1_6203: bitstring = dec(em1_6201,skSess_5982) in
                                                            {7878}if (verify(m1_6203,sigM1_6202,pkCli_6188) <> true) then
                                                                0
                                                            else
                                                                {7879}let (SPc_6204: bitstring,PartC_6205: bitstring) = m1_6203 in
                                                                {7880}event endSrv(Cli_5510,Sess_5512,PartC_6205);
                                                                {7881}new Ns_6206: bitstring;
                                                                {7882}let gNs_6207: bitstring = exp(g,Ns_6206) in
                                                                {7883}let m2_6208: bitstring = gNs_6207 in
                                                                {7884}out(c, (enc(m2_6208,pkCli_6188),sign(m2_6208,skSess_5982)));
                                                                {7885}event beginSrv(Sess_5512,Cli_5510,gNs_6207)
                                                        )
                                                        else
                                                            {7886}let v_6209: bool = (Disco_5511 = C) in
                                                            (
                                                                {7887}if v_6209 then
                                                                (
                                                                    {7888}let pkDisco_6210: bitstring = pub(skC) in
                                                                    {7889}in(c, (=pkCli_6188,em1_6211: bitstring,sigM1_6212: bitstring));
                                                                    {7890}let m1_6213: bitstring = dec(em1_6211,skSess_5982) in
                                                                    {7891}if (verify(m1_6213,sigM1_6212,pkCli_6188) <> true) then
                                                                        0
                                                                    else
                                                                        {7892}let (SPc_6214: bitstring,PartC_6215: bitstring) = m1_6213 in
                                                                        {7893}event endSrv(Cli_5510,Sess_5512,PartC_6215);
                                                                        {7894}new Ns_6216: bitstring;
                                                                        {7895}let gNs_6217: bitstring = exp(g,Ns_6216) in
                                                                        {7896}let m2_6218: bitstring = gNs_6217 in
                                                                        {7897}out(c, (enc(m2_6218,pkCli_6188),sign(m2_6218,skSess_5982)));
                                                                        {7898}event beginSrv(Sess_5512,Cli_5510,gNs_6217)
                                                                )
                                                                else
                                                                    {7899}let pkDisco_6219: bitstring = pub(skI) in
                                                                    {7900}in(c, (=pkCli_6188,em1_6220: bitstring,sigM1_6221: bitstring));
                                                                    {7901}let m1_6222: bitstring = dec(em1_6220,skSess_5982) in
                                                                    {7902}if (verify(m1_6222,sigM1_6221,pkCli_6188) <> true) then
                                                                        0
                                                                    else
                                                                        {7903}let (SPc_6223: bitstring,PartC_6224: bitstring) = m1_6222 in
                                                                        {7904}event endSrv(Cli_5510,Sess_5512,PartC_6224);
                                                                        {7905}new Ns_6225: bitstring;
                                                                        {7906}let gNs_6226: bitstring = exp(g,Ns_6225) in
                                                                        {7907}let m2_6227: bitstring = gNs_6226 in
                                                                        {7908}out(c, (enc(m2_6227,pkCli_6188),sign(m2_6227,skSess_5982)));
                                                                        {7909}event beginSrv(Sess_5512,Cli_5510,gNs_6226)
                                                            )
                                                            else
                                                                {7910}let pkDisco_6228: bitstring = fail-any in
                                                                {7911}in(c, (=pkCli_6188,em1_6229: bitstring,sigM1_6230: bitstring));
                                                                {7912}let m1_6231: bitstring = dec(em1_6229,skSess_5982) in
                                                                {7913}if (verify(m1_6231,sigM1_6230,pkCli_6188) <> true) then
                                                                    0
                                                                else
                                                                    {7914}let (SPc_6232: bitstring,PartC_6233: bitstring) = m1_6231 in
                                                                    {7915}event endSrv(Cli_5510,Sess_5512,PartC_6233);
                                                                    {7916}new Ns_6234: bitstring;
                                                                    {7917}let gNs_6235: bitstring = exp(g,Ns_6234) in
                                                                    {7918}let m2_6236: bitstring = gNs_6235 in
                                                                    {7919}out(c, (enc(m2_6236,pkCli_6188),sign(m2_6236,skSess_5982)));
                                                                    {7920}event beginSrv(Sess_5512,Cli_5510,gNs_6235)
                                                    )
                                                    else
                                                        {7921}let pkDisco_6237: bitstring = fail-any in
                                                        {7922}in(c, (=pkCli_6188,em1_6238: bitstring,sigM1_6239: bitstring));
                                                        {7923}let m1_6240: bitstring = dec(em1_6238,skSess_5982) in
                                                        {7924}if (verify(m1_6240,sigM1_6239,pkCli_6188) <> true) then
                                                            0
                                                        else
                                                            {7925}let (SPc_6241: bitstring,PartC_6242: bitstring) = m1_6240 in
                                                            {7926}event endSrv(Cli_5510,Sess_5512,PartC_6242);
                                                            {7927}new Ns_6243: bitstring;
                                                            {7928}let gNs_6244: bitstring = exp(g,Ns_6243) in
                                                            {7929}let m2_6245: bitstring = gNs_6244 in
                                                            {7930}out(c, (enc(m2_6245,pkCli_6188),sign(m2_6245,skSess_5982)));
                                                            {7931}event beginSrv(Sess_5512,Cli_5510,gNs_6244)
                                            )
                                            else
                                                {7932}let pkDisco_6246: bitstring = fail-any in
                                                {7933}in(c, (=pkCli_6188,em1_6247: bitstring,sigM1_6248: bitstring));
                                                {7934}let m1_6249: bitstring = dec(em1_6247,skSess_5982) in
                                                {7935}if (verify(m1_6249,sigM1_6248,pkCli_6188) <> true) then
                                                    0
                                                else
                                                    {7936}let (SPc_6250: bitstring,PartC_6251: bitstring) = m1_6249 in
                                                    {7937}event endSrv(Cli_5510,Sess_5512,PartC_6251);
                                                    {7938}new Ns_6252: bitstring;
                                                    {7939}let gNs_6253: bitstring = exp(g,Ns_6252) in
                                                    {7940}let m2_6254: bitstring = gNs_6253 in
                                                    {7941}out(c, (enc(m2_6254,pkCli_6188),sign(m2_6254,skSess_5982)));
                                                    {7942}event beginSrv(Sess_5512,Cli_5510,gNs_6253)
                                    )
                                    else
                                        {7943}let pkCli_6255: bitstring = fail-any in
                                        {7944}let v_6256: bool = (Disco_5511 = A) in
                                        (
                                            {7945}if v_6256 then
                                            (
                                                {7946}let pkDisco_6257: bitstring = pub(skA) in
                                                {7947}in(c, (=pkCli_6255,em1_6258: bitstring,sigM1_6259: bitstring));
                                                {7948}let m1_6260: bitstring = dec(em1_6258,skSess_5982) in
                                                {7949}if (verify(m1_6260,sigM1_6259,pkCli_6255) <> true) then
                                                    0
                                                else
                                                    {7950}let (SPc_6261: bitstring,PartC_6262: bitstring) = m1_6260 in
                                                    {7951}event endSrv(Cli_5510,Sess_5512,PartC_6262);
                                                    {7952}new Ns_6263: bitstring;
                                                    {7953}let gNs_6264: bitstring = exp(g,Ns_6263) in
                                                    {7954}let m2_6265: bitstring = gNs_6264 in
                                                    {7955}out(c, (enc(m2_6265,pkCli_6255),sign(m2_6265,skSess_5982)));
                                                    {7956}event beginSrv(Sess_5512,Cli_5510,gNs_6264)
                                            )
                                            else
                                                {7957}let v_6266: bool = (Disco_5511 = B) in
                                                (
                                                    {7958}if v_6266 then
                                                    (
                                                        {7959}let pkDisco_6267: bitstring = pub(skB) in
                                                        {7960}in(c, (=pkCli_6255,em1_6268: bitstring,sigM1_6269: bitstring));
                                                        {7961}let m1_6270: bitstring = dec(em1_6268,skSess_5982) in
                                                        {7962}if (verify(m1_6270,sigM1_6269,pkCli_6255) <> true) then
                                                            0
                                                        else
                                                            {7963}let (SPc_6271: bitstring,PartC_6272: bitstring) = m1_6270 in
                                                            {7964}event endSrv(Cli_5510,Sess_5512,PartC_6272);
                                                            {7965}new Ns_6273: bitstring;
                                                            {7966}let gNs_6274: bitstring = exp(g,Ns_6273) in
                                                            {7967}let m2_6275: bitstring = gNs_6274 in
                                                            {7968}out(c, (enc(m2_6275,pkCli_6255),sign(m2_6275,skSess_5982)));
                                                            {7969}event beginSrv(Sess_5512,Cli_5510,gNs_6274)
                                                    )
                                                    else
                                                        {7970}let v_6276: bool = (Disco_5511 = C) in
                                                        (
                                                            {7971}if v_6276 then
                                                            (
                                                                {7972}let pkDisco_6277: bitstring = pub(skC) in
                                                                {7973}in(c, (=pkCli_6255,em1_6278: bitstring,sigM1_6279: bitstring));
                                                                {7974}let m1_6280: bitstring = dec(em1_6278,skSess_5982) in
                                                                {7975}if (verify(m1_6280,sigM1_6279,pkCli_6255) <> true) then
                                                                    0
                                                                else
                                                                    {7976}let (SPc_6281: bitstring,PartC_6282: bitstring) = m1_6280 in
                                                                    {7977}event endSrv(Cli_5510,Sess_5512,PartC_6282);
                                                                    {7978}new Ns_6283: bitstring;
                                                                    {7979}let gNs_6284: bitstring = exp(g,Ns_6283) in
                                                                    {7980}let m2_6285: bitstring = gNs_6284 in
                                                                    {7981}out(c, (enc(m2_6285,pkCli_6255),sign(m2_6285,skSess_5982)));
                                                                    {7982}event beginSrv(Sess_5512,Cli_5510,gNs_6284)
                                                            )
                                                            else
                                                                {7983}let pkDisco_6286: bitstring = pub(skI) in
                                                                {7984}in(c, (=pkCli_6255,em1_6287: bitstring,sigM1_6288: bitstring));
                                                                {7985}let m1_6289: bitstring = dec(em1_6287,skSess_5982) in
                                                                {7986}if (verify(m1_6289,sigM1_6288,pkCli_6255) <> true) then
                                                                    0
                                                                else
                                                                    {7987}let (SPc_6290: bitstring,PartC_6291: bitstring) = m1_6289 in
                                                                    {7988}event endSrv(Cli_5510,Sess_5512,PartC_6291);
                                                                    {7989}new Ns_6292: bitstring;
                                                                    {7990}let gNs_6293: bitstring = exp(g,Ns_6292) in
                                                                    {7991}let m2_6294: bitstring = gNs_6293 in
                                                                    {7992}out(c, (enc(m2_6294,pkCli_6255),sign(m2_6294,skSess_5982)));
                                                                    {7993}event beginSrv(Sess_5512,Cli_5510,gNs_6293)
                                                        )
                                                        else
                                                            {7994}let pkDisco_6295: bitstring = fail-any in
                                                            {7995}in(c, (=pkCli_6255,em1_6296: bitstring,sigM1_6297: bitstring));
                                                            {7996}let m1_6298: bitstring = dec(em1_6296,skSess_5982) in
                                                            {7997}if (verify(m1_6298,sigM1_6297,pkCli_6255) <> true) then
                                                                0
                                                            else
                                                                {7998}let (SPc_6299: bitstring,PartC_6300: bitstring) = m1_6298 in
                                                                {7999}event endSrv(Cli_5510,Sess_5512,PartC_6300);
                                                                {8000}new Ns_6301: bitstring;
                                                                {8001}let gNs_6302: bitstring = exp(g,Ns_6301) in
                                                                {8002}let m2_6303: bitstring = gNs_6302 in
                                                                {8003}out(c, (enc(m2_6303,pkCli_6255),sign(m2_6303,skSess_5982)));
                                                                {8004}event beginSrv(Sess_5512,Cli_5510,gNs_6302)
                                                )
                                                else
                                                    {8005}let pkDisco_6304: bitstring = fail-any in
                                                    {8006}in(c, (=pkCli_6255,em1_6305: bitstring,sigM1_6306: bitstring));
                                                    {8007}let m1_6307: bitstring = dec(em1_6305,skSess_5982) in
                                                    {8008}if (verify(m1_6307,sigM1_6306,pkCli_6255) <> true) then
                                                        0
                                                    else
                                                        {8009}let (SPc_6308: bitstring,PartC_6309: bitstring) = m1_6307 in
                                                        {8010}event endSrv(Cli_5510,Sess_5512,PartC_6309);
                                                        {8011}new Ns_6310: bitstring;
                                                        {8012}let gNs_6311: bitstring = exp(g,Ns_6310) in
                                                        {8013}let m2_6312: bitstring = gNs_6311 in
                                                        {8014}out(c, (enc(m2_6312,pkCli_6255),sign(m2_6312,skSess_5982)));
                                                        {8015}event beginSrv(Sess_5512,Cli_5510,gNs_6311)
                                        )
                                        else
                                            {8016}let pkDisco_6313: bitstring = fail-any in
                                            {8017}in(c, (=pkCli_6255,em1_6314: bitstring,sigM1_6315: bitstring));
                                            {8018}let m1_6316: bitstring = dec(em1_6314,skSess_5982) in
                                            {8019}if (verify(m1_6316,sigM1_6315,pkCli_6255) <> true) then
                                                0
                                            else
                                                {8020}let (SPc_6317: bitstring,PartC_6318: bitstring) = m1_6316 in
                                                {8021}event endSrv(Cli_5510,Sess_5512,PartC_6318);
                                                {8022}new Ns_6319: bitstring;
                                                {8023}let gNs_6320: bitstring = exp(g,Ns_6319) in
                                                {8024}let m2_6321: bitstring = gNs_6320 in
                                                {8025}out(c, (enc(m2_6321,pkCli_6255),sign(m2_6321,skSess_5982)));
                                                {8026}event beginSrv(Sess_5512,Cli_5510,gNs_6320)
                            )
                            else
                                {8027}let pkCli_6322: bitstring = fail-any in
                                {8028}let v_6323: bool = (Disco_5511 = A) in
                                (
                                    {8029}if v_6323 then
                                    (
                                        {8030}let pkDisco_6324: bitstring = pub(skA) in
                                        {8031}in(c, (=pkCli_6322,em1_6325: bitstring,sigM1_6326: bitstring));
                                        {8032}let m1_6327: bitstring = dec(em1_6325,skSess_5982) in
                                        {8033}if (verify(m1_6327,sigM1_6326,pkCli_6322) <> true) then
                                            0
                                        else
                                            {8034}let (SPc_6328: bitstring,PartC_6329: bitstring) = m1_6327 in
                                            {8035}event endSrv(Cli_5510,Sess_5512,PartC_6329);
                                            {8036}new Ns_6330: bitstring;
                                            {8037}let gNs_6331: bitstring = exp(g,Ns_6330) in
                                            {8038}let m2_6332: bitstring = gNs_6331 in
                                            {8039}out(c, (enc(m2_6332,pkCli_6322),sign(m2_6332,skSess_5982)));
                                            {8040}event beginSrv(Sess_5512,Cli_5510,gNs_6331)
                                    )
                                    else
                                        {8041}let v_6333: bool = (Disco_5511 = B) in
                                        (
                                            {8042}if v_6333 then
                                            (
                                                {8043}let pkDisco_6334: bitstring = pub(skB) in
                                                {8044}in(c, (=pkCli_6322,em1_6335: bitstring,sigM1_6336: bitstring));
                                                {8045}let m1_6337: bitstring = dec(em1_6335,skSess_5982) in
                                                {8046}if (verify(m1_6337,sigM1_6336,pkCli_6322) <> true) then
                                                    0
                                                else
                                                    {8047}let (SPc_6338: bitstring,PartC_6339: bitstring) = m1_6337 in
                                                    {8048}event endSrv(Cli_5510,Sess_5512,PartC_6339);
                                                    {8049}new Ns_6340: bitstring;
                                                    {8050}let gNs_6341: bitstring = exp(g,Ns_6340) in
                                                    {8051}let m2_6342: bitstring = gNs_6341 in
                                                    {8052}out(c, (enc(m2_6342,pkCli_6322),sign(m2_6342,skSess_5982)));
                                                    {8053}event beginSrv(Sess_5512,Cli_5510,gNs_6341)
                                            )
                                            else
                                                {8054}let v_6343: bool = (Disco_5511 = C) in
                                                (
                                                    {8055}if v_6343 then
                                                    (
                                                        {8056}let pkDisco_6344: bitstring = pub(skC) in
                                                        {8057}in(c, (=pkCli_6322,em1_6345: bitstring,sigM1_6346: bitstring));
                                                        {8058}let m1_6347: bitstring = dec(em1_6345,skSess_5982) in
                                                        {8059}if (verify(m1_6347,sigM1_6346,pkCli_6322) <> true) then
                                                            0
                                                        else
                                                            {8060}let (SPc_6348: bitstring,PartC_6349: bitstring) = m1_6347 in
                                                            {8061}event endSrv(Cli_5510,Sess_5512,PartC_6349);
                                                            {8062}new Ns_6350: bitstring;
                                                            {8063}let gNs_6351: bitstring = exp(g,Ns_6350) in
                                                            {8064}let m2_6352: bitstring = gNs_6351 in
                                                            {8065}out(c, (enc(m2_6352,pkCli_6322),sign(m2_6352,skSess_5982)));
                                                            {8066}event beginSrv(Sess_5512,Cli_5510,gNs_6351)
                                                    )
                                                    else
                                                        {8067}let pkDisco_6353: bitstring = pub(skI) in
                                                        {8068}in(c, (=pkCli_6322,em1_6354: bitstring,sigM1_6355: bitstring));
                                                        {8069}let m1_6356: bitstring = dec(em1_6354,skSess_5982) in
                                                        {8070}if (verify(m1_6356,sigM1_6355,pkCli_6322) <> true) then
                                                            0
                                                        else
                                                            {8071}let (SPc_6357: bitstring,PartC_6358: bitstring) = m1_6356 in
                                                            {8072}event endSrv(Cli_5510,Sess_5512,PartC_6358);
                                                            {8073}new Ns_6359: bitstring;
                                                            {8074}let gNs_6360: bitstring = exp(g,Ns_6359) in
                                                            {8075}let m2_6361: bitstring = gNs_6360 in
                                                            {8076}out(c, (enc(m2_6361,pkCli_6322),sign(m2_6361,skSess_5982)));
                                                            {8077}event beginSrv(Sess_5512,Cli_5510,gNs_6360)
                                                )
                                                else
                                                    {8078}let pkDisco_6362: bitstring = fail-any in
                                                    {8079}in(c, (=pkCli_6322,em1_6363: bitstring,sigM1_6364: bitstring));
                                                    {8080}let m1_6365: bitstring = dec(em1_6363,skSess_5982) in
                                                    {8081}if (verify(m1_6365,sigM1_6364,pkCli_6322) <> true) then
                                                        0
                                                    else
                                                        {8082}let (SPc_6366: bitstring,PartC_6367: bitstring) = m1_6365 in
                                                        {8083}event endSrv(Cli_5510,Sess_5512,PartC_6367);
                                                        {8084}new Ns_6368: bitstring;
                                                        {8085}let gNs_6369: bitstring = exp(g,Ns_6368) in
                                                        {8086}let m2_6370: bitstring = gNs_6369 in
                                                        {8087}out(c, (enc(m2_6370,pkCli_6322),sign(m2_6370,skSess_5982)));
                                                        {8088}event beginSrv(Sess_5512,Cli_5510,gNs_6369)
                                        )
                                        else
                                            {8089}let pkDisco_6371: bitstring = fail-any in
                                            {8090}in(c, (=pkCli_6322,em1_6372: bitstring,sigM1_6373: bitstring));
                                            {8091}let m1_6374: bitstring = dec(em1_6372,skSess_5982) in
                                            {8092}if (verify(m1_6374,sigM1_6373,pkCli_6322) <> true) then
                                                0
                                            else
                                                {8093}let (SPc_6375: bitstring,PartC_6376: bitstring) = m1_6374 in
                                                {8094}event endSrv(Cli_5510,Sess_5512,PartC_6376);
                                                {8095}new Ns_6377: bitstring;
                                                {8096}let gNs_6378: bitstring = exp(g,Ns_6377) in
                                                {8097}let m2_6379: bitstring = gNs_6378 in
                                                {8098}out(c, (enc(m2_6379,pkCli_6322),sign(m2_6379,skSess_5982)));
                                                {8099}event beginSrv(Sess_5512,Cli_5510,gNs_6378)
                                )
                                else
                                    {8100}let pkDisco_6380: bitstring = fail-any in
                                    {8101}in(c, (=pkCli_6322,em1_6381: bitstring,sigM1_6382: bitstring));
                                    {8102}let m1_6383: bitstring = dec(em1_6381,skSess_5982) in
                                    {8103}if (verify(m1_6383,sigM1_6382,pkCli_6322) <> true) then
                                        0
                                    else
                                        {8104}let (SPc_6384: bitstring,PartC_6385: bitstring) = m1_6383 in
                                        {8105}event endSrv(Cli_5510,Sess_5512,PartC_6385);
                                        {8106}new Ns_6386: bitstring;
                                        {8107}let gNs_6387: bitstring = exp(g,Ns_6386) in
                                        {8108}let m2_6388: bitstring = gNs_6387 in
                                        {8109}out(c, (enc(m2_6388,pkCli_6322),sign(m2_6388,skSess_5982)));
                                        {8110}event beginSrv(Sess_5512,Cli_5510,gNs_6387)
                    )
                    else
                        {8111}let pkCli_6389: bitstring = fail-any in
                        {8112}let v_6390: bool = (Disco_5511 = A) in
                        (
                            {8113}if v_6390 then
                            (
                                {8114}let pkDisco_6391: bitstring = pub(skA) in
                                {8115}in(c, (=pkCli_6389,em1_6392: bitstring,sigM1_6393: bitstring));
                                {8116}let m1_6394: bitstring = dec(em1_6392,skSess_5982) in
                                {8117}if (verify(m1_6394,sigM1_6393,pkCli_6389) <> true) then
                                    0
                                else
                                    {8118}let (SPc_6395: bitstring,PartC_6396: bitstring) = m1_6394 in
                                    {8119}event endSrv(Cli_5510,Sess_5512,PartC_6396);
                                    {8120}new Ns_6397: bitstring;
                                    {8121}let gNs_6398: bitstring = exp(g,Ns_6397) in
                                    {8122}let m2_6399: bitstring = gNs_6398 in
                                    {8123}out(c, (enc(m2_6399,pkCli_6389),sign(m2_6399,skSess_5982)));
                                    {8124}event beginSrv(Sess_5512,Cli_5510,gNs_6398)
                            )
                            else
                                {8125}let v_6400: bool = (Disco_5511 = B) in
                                (
                                    {8126}if v_6400 then
                                    (
                                        {8127}let pkDisco_6401: bitstring = pub(skB) in
                                        {8128}in(c, (=pkCli_6389,em1_6402: bitstring,sigM1_6403: bitstring));
                                        {8129}let m1_6404: bitstring = dec(em1_6402,skSess_5982) in
                                        {8130}if (verify(m1_6404,sigM1_6403,pkCli_6389) <> true) then
                                            0
                                        else
                                            {8131}let (SPc_6405: bitstring,PartC_6406: bitstring) = m1_6404 in
                                            {8132}event endSrv(Cli_5510,Sess_5512,PartC_6406);
                                            {8133}new Ns_6407: bitstring;
                                            {8134}let gNs_6408: bitstring = exp(g,Ns_6407) in
                                            {8135}let m2_6409: bitstring = gNs_6408 in
                                            {8136}out(c, (enc(m2_6409,pkCli_6389),sign(m2_6409,skSess_5982)));
                                            {8137}event beginSrv(Sess_5512,Cli_5510,gNs_6408)
                                    )
                                    else
                                        {8138}let v_6410: bool = (Disco_5511 = C) in
                                        (
                                            {8139}if v_6410 then
                                            (
                                                {8140}let pkDisco_6411: bitstring = pub(skC) in
                                                {8141}in(c, (=pkCli_6389,em1_6412: bitstring,sigM1_6413: bitstring));
                                                {8142}let m1_6414: bitstring = dec(em1_6412,skSess_5982) in
                                                {8143}if (verify(m1_6414,sigM1_6413,pkCli_6389) <> true) then
                                                    0
                                                else
                                                    {8144}let (SPc_6415: bitstring,PartC_6416: bitstring) = m1_6414 in
                                                    {8145}event endSrv(Cli_5510,Sess_5512,PartC_6416);
                                                    {8146}new Ns_6417: bitstring;
                                                    {8147}let gNs_6418: bitstring = exp(g,Ns_6417) in
                                                    {8148}let m2_6419: bitstring = gNs_6418 in
                                                    {8149}out(c, (enc(m2_6419,pkCli_6389),sign(m2_6419,skSess_5982)));
                                                    {8150}event beginSrv(Sess_5512,Cli_5510,gNs_6418)
                                            )
                                            else
                                                {8151}let pkDisco_6420: bitstring = pub(skI) in
                                                {8152}in(c, (=pkCli_6389,em1_6421: bitstring,sigM1_6422: bitstring));
                                                {8153}let m1_6423: bitstring = dec(em1_6421,skSess_5982) in
                                                {8154}if (verify(m1_6423,sigM1_6422,pkCli_6389) <> true) then
                                                    0
                                                else
                                                    {8155}let (SPc_6424: bitstring,PartC_6425: bitstring) = m1_6423 in
                                                    {8156}event endSrv(Cli_5510,Sess_5512,PartC_6425);
                                                    {8157}new Ns_6426: bitstring;
                                                    {8158}let gNs_6427: bitstring = exp(g,Ns_6426) in
                                                    {8159}let m2_6428: bitstring = gNs_6427 in
                                                    {8160}out(c, (enc(m2_6428,pkCli_6389),sign(m2_6428,skSess_5982)));
                                                    {8161}event beginSrv(Sess_5512,Cli_5510,gNs_6427)
                                        )
                                        else
                                            {8162}let pkDisco_6429: bitstring = fail-any in
                                            {8163}in(c, (=pkCli_6389,em1_6430: bitstring,sigM1_6431: bitstring));
                                            {8164}let m1_6432: bitstring = dec(em1_6430,skSess_5982) in
                                            {8165}if (verify(m1_6432,sigM1_6431,pkCli_6389) <> true) then
                                                0
                                            else
                                                {8166}let (SPc_6433: bitstring,PartC_6434: bitstring) = m1_6432 in
                                                {8167}event endSrv(Cli_5510,Sess_5512,PartC_6434);
                                                {8168}new Ns_6435: bitstring;
                                                {8169}let gNs_6436: bitstring = exp(g,Ns_6435) in
                                                {8170}let m2_6437: bitstring = gNs_6436 in
                                                {8171}out(c, (enc(m2_6437,pkCli_6389),sign(m2_6437,skSess_5982)));
                                                {8172}event beginSrv(Sess_5512,Cli_5510,gNs_6436)
                                )
                                else
                                    {8173}let pkDisco_6438: bitstring = fail-any in
                                    {8174}in(c, (=pkCli_6389,em1_6439: bitstring,sigM1_6440: bitstring));
                                    {8175}let m1_6441: bitstring = dec(em1_6439,skSess_5982) in
                                    {8176}if (verify(m1_6441,sigM1_6440,pkCli_6389) <> true) then
                                        0
                                    else
                                        {8177}let (SPc_6442: bitstring,PartC_6443: bitstring) = m1_6441 in
                                        {8178}event endSrv(Cli_5510,Sess_5512,PartC_6443);
                                        {8179}new Ns_6444: bitstring;
                                        {8180}let gNs_6445: bitstring = exp(g,Ns_6444) in
                                        {8181}let m2_6446: bitstring = gNs_6445 in
                                        {8182}out(c, (enc(m2_6446,pkCli_6389),sign(m2_6446,skSess_5982)));
                                        {8183}event beginSrv(Sess_5512,Cli_5510,gNs_6445)
                        )
                        else
                            {8184}let pkDisco_6447: bitstring = fail-any in
                            {8185}in(c, (=pkCli_6389,em1_6448: bitstring,sigM1_6449: bitstring));
                            {8186}let m1_6450: bitstring = dec(em1_6448,skSess_5982) in
                            {8187}if (verify(m1_6450,sigM1_6449,pkCli_6389) <> true) then
                                0
                            else
                                {8188}let (SPc_6451: bitstring,PartC_6452: bitstring) = m1_6450 in
                                {8189}event endSrv(Cli_5510,Sess_5512,PartC_6452);
                                {8190}new Ns_6453: bitstring;
                                {8191}let gNs_6454: bitstring = exp(g,Ns_6453) in
                                {8192}let m2_6455: bitstring = gNs_6454 in
                                {8193}out(c, (enc(m2_6455,pkCli_6389),sign(m2_6455,skSess_5982)));
                                {8194}event beginSrv(Sess_5512,Cli_5510,gNs_6454)
                )
                else
                    {8195}let v_6456: bool = (Sess_5512 = C) in
                    (
                        {8196}if v_6456 then
                        (
                            {8197}let skSess_6457: bitstring = skC in
                            {8198}let pkSess_6458: bitstring = pub(skSess_6457) in
                            {8199}let v_6459: bool = (Cli_5510 = A) in
                            (
                                {8200}if v_6459 then
                                (
                                    {8201}let pkCli_6460: bitstring = pub(skA) in
                                    {8202}let v_6461: bool = (Disco_5511 = A) in
                                    (
                                        {8203}if v_6461 then
                                        (
                                            {8204}let pkDisco_6462: bitstring = pub(skA) in
                                            {8205}in(c, (=pkCli_6460,em1_6463: bitstring,sigM1_6464: bitstring));
                                            {8206}let m1_6465: bitstring = dec(em1_6463,skSess_6457) in
                                            {8207}if (verify(m1_6465,sigM1_6464,pkCli_6460) <> true) then
                                                0
                                            else
                                                {8208}let (SPc_6466: bitstring,PartC_6467: bitstring) = m1_6465 in
                                                {8209}event endSrv(Cli_5510,Sess_5512,PartC_6467);
                                                {8210}new Ns_6468: bitstring;
                                                {8211}let gNs_6469: bitstring = exp(g,Ns_6468) in
                                                {8212}let m2_6470: bitstring = gNs_6469 in
                                                {8213}out(c, (enc(m2_6470,pkCli_6460),sign(m2_6470,skSess_6457)));
                                                {8214}event beginSrv(Sess_5512,Cli_5510,gNs_6469)
                                        )
                                        else
                                            {8215}let v_6471: bool = (Disco_5511 = B) in
                                            (
                                                {8216}if v_6471 then
                                                (
                                                    {8217}let pkDisco_6472: bitstring = pub(skB) in
                                                    {8218}in(c, (=pkCli_6460,em1_6473: bitstring,sigM1_6474: bitstring));
                                                    {8219}let m1_6475: bitstring = dec(em1_6473,skSess_6457) in
                                                    {8220}if (verify(m1_6475,sigM1_6474,pkCli_6460) <> true) then
                                                        0
                                                    else
                                                        {8221}let (SPc_6476: bitstring,PartC_6477: bitstring) = m1_6475 in
                                                        {8222}event endSrv(Cli_5510,Sess_5512,PartC_6477);
                                                        {8223}new Ns_6478: bitstring;
                                                        {8224}let gNs_6479: bitstring = exp(g,Ns_6478) in
                                                        {8225}let m2_6480: bitstring = gNs_6479 in
                                                        {8226}out(c, (enc(m2_6480,pkCli_6460),sign(m2_6480,skSess_6457)));
                                                        {8227}event beginSrv(Sess_5512,Cli_5510,gNs_6479)
                                                )
                                                else
                                                    {8228}let v_6481: bool = (Disco_5511 = C) in
                                                    (
                                                        {8229}if v_6481 then
                                                        (
                                                            {8230}let pkDisco_6482: bitstring = pub(skC) in
                                                            {8231}in(c, (=pkCli_6460,em1_6483: bitstring,sigM1_6484: bitstring));
                                                            {8232}let m1_6485: bitstring = dec(em1_6483,skSess_6457) in
                                                            {8233}if (verify(m1_6485,sigM1_6484,pkCli_6460) <> true) then
                                                                0
                                                            else
                                                                {8234}let (SPc_6486: bitstring,PartC_6487: bitstring) = m1_6485 in
                                                                {8235}event endSrv(Cli_5510,Sess_5512,PartC_6487);
                                                                {8236}new Ns_6488: bitstring;
                                                                {8237}let gNs_6489: bitstring = exp(g,Ns_6488) in
                                                                {8238}let m2_6490: bitstring = gNs_6489 in
                                                                {8239}out(c, (enc(m2_6490,pkCli_6460),sign(m2_6490,skSess_6457)));
                                                                {8240}event beginSrv(Sess_5512,Cli_5510,gNs_6489)
                                                        )
                                                        else
                                                            {8241}let pkDisco_6491: bitstring = pub(skI) in
                                                            {8242}in(c, (=pkCli_6460,em1_6492: bitstring,sigM1_6493: bitstring));
                                                            {8243}let m1_6494: bitstring = dec(em1_6492,skSess_6457) in
                                                            {8244}if (verify(m1_6494,sigM1_6493,pkCli_6460) <> true) then
                                                                0
                                                            else
                                                                {8245}let (SPc_6495: bitstring,PartC_6496: bitstring) = m1_6494 in
                                                                {8246}event endSrv(Cli_5510,Sess_5512,PartC_6496);
                                                                {8247}new Ns_6497: bitstring;
                                                                {8248}let gNs_6498: bitstring = exp(g,Ns_6497) in
                                                                {8249}let m2_6499: bitstring = gNs_6498 in
                                                                {8250}out(c, (enc(m2_6499,pkCli_6460),sign(m2_6499,skSess_6457)));
                                                                {8251}event beginSrv(Sess_5512,Cli_5510,gNs_6498)
                                                    )
                                                    else
                                                        {8252}let pkDisco_6500: bitstring = fail-any in
                                                        {8253}in(c, (=pkCli_6460,em1_6501: bitstring,sigM1_6502: bitstring));
                                                        {8254}let m1_6503: bitstring = dec(em1_6501,skSess_6457) in
                                                        {8255}if (verify(m1_6503,sigM1_6502,pkCli_6460) <> true) then
                                                            0
                                                        else
                                                            {8256}let (SPc_6504: bitstring,PartC_6505: bitstring) = m1_6503 in
                                                            {8257}event endSrv(Cli_5510,Sess_5512,PartC_6505);
                                                            {8258}new Ns_6506: bitstring;
                                                            {8259}let gNs_6507: bitstring = exp(g,Ns_6506) in
                                                            {8260}let m2_6508: bitstring = gNs_6507 in
                                                            {8261}out(c, (enc(m2_6508,pkCli_6460),sign(m2_6508,skSess_6457)));
                                                            {8262}event beginSrv(Sess_5512,Cli_5510,gNs_6507)
                                            )
                                            else
                                                {8263}let pkDisco_6509: bitstring = fail-any in
                                                {8264}in(c, (=pkCli_6460,em1_6510: bitstring,sigM1_6511: bitstring));
                                                {8265}let m1_6512: bitstring = dec(em1_6510,skSess_6457) in
                                                {8266}if (verify(m1_6512,sigM1_6511,pkCli_6460) <> true) then
                                                    0
                                                else
                                                    {8267}let (SPc_6513: bitstring,PartC_6514: bitstring) = m1_6512 in
                                                    {8268}event endSrv(Cli_5510,Sess_5512,PartC_6514);
                                                    {8269}new Ns_6515: bitstring;
                                                    {8270}let gNs_6516: bitstring = exp(g,Ns_6515) in
                                                    {8271}let m2_6517: bitstring = gNs_6516 in
                                                    {8272}out(c, (enc(m2_6517,pkCli_6460),sign(m2_6517,skSess_6457)));
                                                    {8273}event beginSrv(Sess_5512,Cli_5510,gNs_6516)
                                    )
                                    else
                                        {8274}let pkDisco_6518: bitstring = fail-any in
                                        {8275}in(c, (=pkCli_6460,em1_6519: bitstring,sigM1_6520: bitstring));
                                        {8276}let m1_6521: bitstring = dec(em1_6519,skSess_6457) in
                                        {8277}if (verify(m1_6521,sigM1_6520,pkCli_6460) <> true) then
                                            0
                                        else
                                            {8278}let (SPc_6522: bitstring,PartC_6523: bitstring) = m1_6521 in
                                            {8279}event endSrv(Cli_5510,Sess_5512,PartC_6523);
                                            {8280}new Ns_6524: bitstring;
                                            {8281}let gNs_6525: bitstring = exp(g,Ns_6524) in
                                            {8282}let m2_6526: bitstring = gNs_6525 in
                                            {8283}out(c, (enc(m2_6526,pkCli_6460),sign(m2_6526,skSess_6457)));
                                            {8284}event beginSrv(Sess_5512,Cli_5510,gNs_6525)
                                )
                                else
                                    {8285}let v_6527: bool = (Cli_5510 = B) in
                                    (
                                        {8286}if v_6527 then
                                        (
                                            {8287}let pkCli_6528: bitstring = pub(skB) in
                                            {8288}let v_6529: bool = (Disco_5511 = A) in
                                            (
                                                {8289}if v_6529 then
                                                (
                                                    {8290}let pkDisco_6530: bitstring = pub(skA) in
                                                    {8291}in(c, (=pkCli_6528,em1_6531: bitstring,sigM1_6532: bitstring));
                                                    {8292}let m1_6533: bitstring = dec(em1_6531,skSess_6457) in
                                                    {8293}if (verify(m1_6533,sigM1_6532,pkCli_6528) <> true) then
                                                        0
                                                    else
                                                        {8294}let (SPc_6534: bitstring,PartC_6535: bitstring) = m1_6533 in
                                                        {8295}event endSrv(Cli_5510,Sess_5512,PartC_6535);
                                                        {8296}new Ns_6536: bitstring;
                                                        {8297}let gNs_6537: bitstring = exp(g,Ns_6536) in
                                                        {8298}let m2_6538: bitstring = gNs_6537 in
                                                        {8299}out(c, (enc(m2_6538,pkCli_6528),sign(m2_6538,skSess_6457)));
                                                        {8300}event beginSrv(Sess_5512,Cli_5510,gNs_6537)
                                                )
                                                else
                                                    {8301}let v_6539: bool = (Disco_5511 = B) in
                                                    (
                                                        {8302}if v_6539 then
                                                        (
                                                            {8303}let pkDisco_6540: bitstring = pub(skB) in
                                                            {8304}in(c, (=pkCli_6528,em1_6541: bitstring,sigM1_6542: bitstring));
                                                            {8305}let m1_6543: bitstring = dec(em1_6541,skSess_6457) in
                                                            {8306}if (verify(m1_6543,sigM1_6542,pkCli_6528) <> true) then
                                                                0
                                                            else
                                                                {8307}let (SPc_6544: bitstring,PartC_6545: bitstring) = m1_6543 in
                                                                {8308}event endSrv(Cli_5510,Sess_5512,PartC_6545);
                                                                {8309}new Ns_6546: bitstring;
                                                                {8310}let gNs_6547: bitstring = exp(g,Ns_6546) in
                                                                {8311}let m2_6548: bitstring = gNs_6547 in
                                                                {8312}out(c, (enc(m2_6548,pkCli_6528),sign(m2_6548,skSess_6457)));
                                                                {8313}event beginSrv(Sess_5512,Cli_5510,gNs_6547)
                                                        )
                                                        else
                                                            {8314}let v_6549: bool = (Disco_5511 = C) in
                                                            (
                                                                {8315}if v_6549 then
                                                                (
                                                                    {8316}let pkDisco_6550: bitstring = pub(skC) in
                                                                    {8317}in(c, (=pkCli_6528,em1_6551: bitstring,sigM1_6552: bitstring));
                                                                    {8318}let m1_6553: bitstring = dec(em1_6551,skSess_6457) in
                                                                    {8319}if (verify(m1_6553,sigM1_6552,pkCli_6528) <> true) then
                                                                        0
                                                                    else
                                                                        {8320}let (SPc_6554: bitstring,PartC_6555: bitstring) = m1_6553 in
                                                                        {8321}event endSrv(Cli_5510,Sess_5512,PartC_6555);
                                                                        {8322}new Ns_6556: bitstring;
                                                                        {8323}let gNs_6557: bitstring = exp(g,Ns_6556) in
                                                                        {8324}let m2_6558: bitstring = gNs_6557 in
                                                                        {8325}out(c, (enc(m2_6558,pkCli_6528),sign(m2_6558,skSess_6457)));
                                                                        {8326}event beginSrv(Sess_5512,Cli_5510,gNs_6557)
                                                                )
                                                                else
                                                                    {8327}let pkDisco_6559: bitstring = pub(skI) in
                                                                    {8328}in(c, (=pkCli_6528,em1_6560: bitstring,sigM1_6561: bitstring));
                                                                    {8329}let m1_6562: bitstring = dec(em1_6560,skSess_6457) in
                                                                    {8330}if (verify(m1_6562,sigM1_6561,pkCli_6528) <> true) then
                                                                        0
                                                                    else
                                                                        {8331}let (SPc_6563: bitstring,PartC_6564: bitstring) = m1_6562 in
                                                                        {8332}event endSrv(Cli_5510,Sess_5512,PartC_6564);
                                                                        {8333}new Ns_6565: bitstring;
                                                                        {8334}let gNs_6566: bitstring = exp(g,Ns_6565) in
                                                                        {8335}let m2_6567: bitstring = gNs_6566 in
                                                                        {8336}out(c, (enc(m2_6567,pkCli_6528),sign(m2_6567,skSess_6457)));
                                                                        {8337}event beginSrv(Sess_5512,Cli_5510,gNs_6566)
                                                            )
                                                            else
                                                                {8338}let pkDisco_6568: bitstring = fail-any in
                                                                {8339}in(c, (=pkCli_6528,em1_6569: bitstring,sigM1_6570: bitstring));
                                                                {8340}let m1_6571: bitstring = dec(em1_6569,skSess_6457) in
                                                                {8341}if (verify(m1_6571,sigM1_6570,pkCli_6528) <> true) then
                                                                    0
                                                                else
                                                                    {8342}let (SPc_6572: bitstring,PartC_6573: bitstring) = m1_6571 in
                                                                    {8343}event endSrv(Cli_5510,Sess_5512,PartC_6573);
                                                                    {8344}new Ns_6574: bitstring;
                                                                    {8345}let gNs_6575: bitstring = exp(g,Ns_6574) in
                                                                    {8346}let m2_6576: bitstring = gNs_6575 in
                                                                    {8347}out(c, (enc(m2_6576,pkCli_6528),sign(m2_6576,skSess_6457)));
                                                                    {8348}event beginSrv(Sess_5512,Cli_5510,gNs_6575)
                                                    )
                                                    else
                                                        {8349}let pkDisco_6577: bitstring = fail-any in
                                                        {8350}in(c, (=pkCli_6528,em1_6578: bitstring,sigM1_6579: bitstring));
                                                        {8351}let m1_6580: bitstring = dec(em1_6578,skSess_6457) in
                                                        {8352}if (verify(m1_6580,sigM1_6579,pkCli_6528) <> true) then
                                                            0
                                                        else
                                                            {8353}let (SPc_6581: bitstring,PartC_6582: bitstring) = m1_6580 in
                                                            {8354}event endSrv(Cli_5510,Sess_5512,PartC_6582);
                                                            {8355}new Ns_6583: bitstring;
                                                            {8356}let gNs_6584: bitstring = exp(g,Ns_6583) in
                                                            {8357}let m2_6585: bitstring = gNs_6584 in
                                                            {8358}out(c, (enc(m2_6585,pkCli_6528),sign(m2_6585,skSess_6457)));
                                                            {8359}event beginSrv(Sess_5512,Cli_5510,gNs_6584)
                                            )
                                            else
                                                {8360}let pkDisco_6586: bitstring = fail-any in
                                                {8361}in(c, (=pkCli_6528,em1_6587: bitstring,sigM1_6588: bitstring));
                                                {8362}let m1_6589: bitstring = dec(em1_6587,skSess_6457) in
                                                {8363}if (verify(m1_6589,sigM1_6588,pkCli_6528) <> true) then
                                                    0
                                                else
                                                    {8364}let (SPc_6590: bitstring,PartC_6591: bitstring) = m1_6589 in
                                                    {8365}event endSrv(Cli_5510,Sess_5512,PartC_6591);
                                                    {8366}new Ns_6592: bitstring;
                                                    {8367}let gNs_6593: bitstring = exp(g,Ns_6592) in
                                                    {8368}let m2_6594: bitstring = gNs_6593 in
                                                    {8369}out(c, (enc(m2_6594,pkCli_6528),sign(m2_6594,skSess_6457)));
                                                    {8370}event beginSrv(Sess_5512,Cli_5510,gNs_6593)
                                        )
                                        else
                                            {8371}let v_6595: bool = (Cli_5510 = C) in
                                            (
                                                {8372}if v_6595 then
                                                (
                                                    {8373}let pkCli_6596: bitstring = pub(skC) in
                                                    {8374}let v_6597: bool = (Disco_5511 = A) in
                                                    (
                                                        {8375}if v_6597 then
                                                        (
                                                            {8376}let pkDisco_6598: bitstring = pub(skA) in
                                                            {8377}in(c, (=pkCli_6596,em1_6599: bitstring,sigM1_6600: bitstring));
                                                            {8378}let m1_6601: bitstring = dec(em1_6599,skSess_6457) in
                                                            {8379}if (verify(m1_6601,sigM1_6600,pkCli_6596) <> true) then
                                                                0
                                                            else
                                                                {8380}let (SPc_6602: bitstring,PartC_6603: bitstring) = m1_6601 in
                                                                {8381}event endSrv(Cli_5510,Sess_5512,PartC_6603);
                                                                {8382}new Ns_6604: bitstring;
                                                                {8383}let gNs_6605: bitstring = exp(g,Ns_6604) in
                                                                {8384}let m2_6606: bitstring = gNs_6605 in
                                                                {8385}out(c, (enc(m2_6606,pkCli_6596),sign(m2_6606,skSess_6457)));
                                                                {8386}event beginSrv(Sess_5512,Cli_5510,gNs_6605)
                                                        )
                                                        else
                                                            {8387}let v_6607: bool = (Disco_5511 = B) in
                                                            (
                                                                {8388}if v_6607 then
                                                                (
                                                                    {8389}let pkDisco_6608: bitstring = pub(skB) in
                                                                    {8390}in(c, (=pkCli_6596,em1_6609: bitstring,sigM1_6610: bitstring));
                                                                    {8391}let m1_6611: bitstring = dec(em1_6609,skSess_6457) in
                                                                    {8392}if (verify(m1_6611,sigM1_6610,pkCli_6596) <> true) then
                                                                        0
                                                                    else
                                                                        {8393}let (SPc_6612: bitstring,PartC_6613: bitstring) = m1_6611 in
                                                                        {8394}event endSrv(Cli_5510,Sess_5512,PartC_6613);
                                                                        {8395}new Ns_6614: bitstring;
                                                                        {8396}let gNs_6615: bitstring = exp(g,Ns_6614) in
                                                                        {8397}let m2_6616: bitstring = gNs_6615 in
                                                                        {8398}out(c, (enc(m2_6616,pkCli_6596),sign(m2_6616,skSess_6457)));
                                                                        {8399}event beginSrv(Sess_5512,Cli_5510,gNs_6615)
                                                                )
                                                                else
                                                                    {8400}let v_6617: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8401}if v_6617 then
                                                                        (
                                                                            {8402}let pkDisco_6618: bitstring = pub(skC) in
                                                                            {8403}in(c, (=pkCli_6596,em1_6619: bitstring,sigM1_6620: bitstring));
                                                                            {8404}let m1_6621: bitstring = dec(em1_6619,skSess_6457) in
                                                                            {8405}if (verify(m1_6621,sigM1_6620,pkCli_6596) <> true) then
                                                                                0
                                                                            else
                                                                                {8406}let (SPc_6622: bitstring,PartC_6623: bitstring) = m1_6621 in
                                                                                {8407}event endSrv(Cli_5510,Sess_5512,PartC_6623);
                                                                                {8408}new Ns_6624: bitstring;
                                                                                {8409}let gNs_6625: bitstring = exp(g,Ns_6624) in
                                                                                {8410}let m2_6626: bitstring = gNs_6625 in
                                                                                {8411}out(c, (enc(m2_6626,pkCli_6596),sign(m2_6626,skSess_6457)));
                                                                                {8412}event beginSrv(Sess_5512,Cli_5510,gNs_6625)
                                                                        )
                                                                        else
                                                                            {8413}let pkDisco_6627: bitstring = pub(skI) in
                                                                            {8414}in(c, (=pkCli_6596,em1_6628: bitstring,sigM1_6629: bitstring));
                                                                            {8415}let m1_6630: bitstring = dec(em1_6628,skSess_6457) in
                                                                            {8416}if (verify(m1_6630,sigM1_6629,pkCli_6596) <> true) then
                                                                                0
                                                                            else
                                                                                {8417}let (SPc_6631: bitstring,PartC_6632: bitstring) = m1_6630 in
                                                                                {8418}event endSrv(Cli_5510,Sess_5512,PartC_6632);
                                                                                {8419}new Ns_6633: bitstring;
                                                                                {8420}let gNs_6634: bitstring = exp(g,Ns_6633) in
                                                                                {8421}let m2_6635: bitstring = gNs_6634 in
                                                                                {8422}out(c, (enc(m2_6635,pkCli_6596),sign(m2_6635,skSess_6457)));
                                                                                {8423}event beginSrv(Sess_5512,Cli_5510,gNs_6634)
                                                                    )
                                                                    else
                                                                        {8424}let pkDisco_6636: bitstring = fail-any in
                                                                        {8425}in(c, (=pkCli_6596,em1_6637: bitstring,sigM1_6638: bitstring));
                                                                        {8426}let m1_6639: bitstring = dec(em1_6637,skSess_6457) in
                                                                        {8427}if (verify(m1_6639,sigM1_6638,pkCli_6596) <> true) then
                                                                            0
                                                                        else
                                                                            {8428}let (SPc_6640: bitstring,PartC_6641: bitstring) = m1_6639 in
                                                                            {8429}event endSrv(Cli_5510,Sess_5512,PartC_6641);
                                                                            {8430}new Ns_6642: bitstring;
                                                                            {8431}let gNs_6643: bitstring = exp(g,Ns_6642) in
                                                                            {8432}let m2_6644: bitstring = gNs_6643 in
                                                                            {8433}out(c, (enc(m2_6644,pkCli_6596),sign(m2_6644,skSess_6457)));
                                                                            {8434}event beginSrv(Sess_5512,Cli_5510,gNs_6643)
                                                            )
                                                            else
                                                                {8435}let pkDisco_6645: bitstring = fail-any in
                                                                {8436}in(c, (=pkCli_6596,em1_6646: bitstring,sigM1_6647: bitstring));
                                                                {8437}let m1_6648: bitstring = dec(em1_6646,skSess_6457) in
                                                                {8438}if (verify(m1_6648,sigM1_6647,pkCli_6596) <> true) then
                                                                    0
                                                                else
                                                                    {8439}let (SPc_6649: bitstring,PartC_6650: bitstring) = m1_6648 in
                                                                    {8440}event endSrv(Cli_5510,Sess_5512,PartC_6650);
                                                                    {8441}new Ns_6651: bitstring;
                                                                    {8442}let gNs_6652: bitstring = exp(g,Ns_6651) in
                                                                    {8443}let m2_6653: bitstring = gNs_6652 in
                                                                    {8444}out(c, (enc(m2_6653,pkCli_6596),sign(m2_6653,skSess_6457)));
                                                                    {8445}event beginSrv(Sess_5512,Cli_5510,gNs_6652)
                                                    )
                                                    else
                                                        {8446}let pkDisco_6654: bitstring = fail-any in
                                                        {8447}in(c, (=pkCli_6596,em1_6655: bitstring,sigM1_6656: bitstring));
                                                        {8448}let m1_6657: bitstring = dec(em1_6655,skSess_6457) in
                                                        {8449}if (verify(m1_6657,sigM1_6656,pkCli_6596) <> true) then
                                                            0
                                                        else
                                                            {8450}let (SPc_6658: bitstring,PartC_6659: bitstring) = m1_6657 in
                                                            {8451}event endSrv(Cli_5510,Sess_5512,PartC_6659);
                                                            {8452}new Ns_6660: bitstring;
                                                            {8453}let gNs_6661: bitstring = exp(g,Ns_6660) in
                                                            {8454}let m2_6662: bitstring = gNs_6661 in
                                                            {8455}out(c, (enc(m2_6662,pkCli_6596),sign(m2_6662,skSess_6457)));
                                                            {8456}event beginSrv(Sess_5512,Cli_5510,gNs_6661)
                                                )
                                                else
                                                    {8457}let pkCli_6663: bitstring = pub(skI) in
                                                    {8458}let v_6664: bool = (Disco_5511 = A) in
                                                    (
                                                        {8459}if v_6664 then
                                                        (
                                                            {8460}let pkDisco_6665: bitstring = pub(skA) in
                                                            {8461}in(c, (=pkCli_6663,em1_6666: bitstring,sigM1_6667: bitstring));
                                                            {8462}let m1_6668: bitstring = dec(em1_6666,skSess_6457) in
                                                            {8463}if (verify(m1_6668,sigM1_6667,pkCli_6663) <> true) then
                                                                0
                                                            else
                                                                {8464}let (SPc_6669: bitstring,PartC_6670: bitstring) = m1_6668 in
                                                                {8465}event endSrv(Cli_5510,Sess_5512,PartC_6670);
                                                                {8466}new Ns_6671: bitstring;
                                                                {8467}let gNs_6672: bitstring = exp(g,Ns_6671) in
                                                                {8468}let m2_6673: bitstring = gNs_6672 in
                                                                {8469}out(c, (enc(m2_6673,pkCli_6663),sign(m2_6673,skSess_6457)));
                                                                {8470}event beginSrv(Sess_5512,Cli_5510,gNs_6672)
                                                        )
                                                        else
                                                            {8471}let v_6674: bool = (Disco_5511 = B) in
                                                            (
                                                                {8472}if v_6674 then
                                                                (
                                                                    {8473}let pkDisco_6675: bitstring = pub(skB) in
                                                                    {8474}in(c, (=pkCli_6663,em1_6676: bitstring,sigM1_6677: bitstring));
                                                                    {8475}let m1_6678: bitstring = dec(em1_6676,skSess_6457) in
                                                                    {8476}if (verify(m1_6678,sigM1_6677,pkCli_6663) <> true) then
                                                                        0
                                                                    else
                                                                        {8477}let (SPc_6679: bitstring,PartC_6680: bitstring) = m1_6678 in
                                                                        {8478}event endSrv(Cli_5510,Sess_5512,PartC_6680);
                                                                        {8479}new Ns_6681: bitstring;
                                                                        {8480}let gNs_6682: bitstring = exp(g,Ns_6681) in
                                                                        {8481}let m2_6683: bitstring = gNs_6682 in
                                                                        {8482}out(c, (enc(m2_6683,pkCli_6663),sign(m2_6683,skSess_6457)));
                                                                        {8483}event beginSrv(Sess_5512,Cli_5510,gNs_6682)
                                                                )
                                                                else
                                                                    {8484}let v_6684: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8485}if v_6684 then
                                                                        (
                                                                            {8486}let pkDisco_6685: bitstring = pub(skC) in
                                                                            {8487}in(c, (=pkCli_6663,em1_6686: bitstring,sigM1_6687: bitstring));
                                                                            {8488}let m1_6688: bitstring = dec(em1_6686,skSess_6457) in
                                                                            {8489}if (verify(m1_6688,sigM1_6687,pkCli_6663) <> true) then
                                                                                0
                                                                            else
                                                                                {8490}let (SPc_6689: bitstring,PartC_6690: bitstring) = m1_6688 in
                                                                                {8491}event endSrv(Cli_5510,Sess_5512,PartC_6690);
                                                                                {8492}new Ns_6691: bitstring;
                                                                                {8493}let gNs_6692: bitstring = exp(g,Ns_6691) in
                                                                                {8494}let m2_6693: bitstring = gNs_6692 in
                                                                                {8495}out(c, (enc(m2_6693,pkCli_6663),sign(m2_6693,skSess_6457)));
                                                                                {8496}event beginSrv(Sess_5512,Cli_5510,gNs_6692)
                                                                        )
                                                                        else
                                                                            {8497}let pkDisco_6694: bitstring = pub(skI) in
                                                                            {8498}in(c, (=pkCli_6663,em1_6695: bitstring,sigM1_6696: bitstring));
                                                                            {8499}let m1_6697: bitstring = dec(em1_6695,skSess_6457) in
                                                                            {8500}if (verify(m1_6697,sigM1_6696,pkCli_6663) <> true) then
                                                                                0
                                                                            else
                                                                                {8501}let (SPc_6698: bitstring,PartC_6699: bitstring) = m1_6697 in
                                                                                {8502}event endSrv(Cli_5510,Sess_5512,PartC_6699);
                                                                                {8503}new Ns_6700: bitstring;
                                                                                {8504}let gNs_6701: bitstring = exp(g,Ns_6700) in
                                                                                {8505}let m2_6702: bitstring = gNs_6701 in
                                                                                {8506}out(c, (enc(m2_6702,pkCli_6663),sign(m2_6702,skSess_6457)));
                                                                                {8507}event beginSrv(Sess_5512,Cli_5510,gNs_6701)
                                                                    )
                                                                    else
                                                                        {8508}let pkDisco_6703: bitstring = fail-any in
                                                                        {8509}in(c, (=pkCli_6663,em1_6704: bitstring,sigM1_6705: bitstring));
                                                                        {8510}let m1_6706: bitstring = dec(em1_6704,skSess_6457) in
                                                                        {8511}if (verify(m1_6706,sigM1_6705,pkCli_6663) <> true) then
                                                                            0
                                                                        else
                                                                            {8512}let (SPc_6707: bitstring,PartC_6708: bitstring) = m1_6706 in
                                                                            {8513}event endSrv(Cli_5510,Sess_5512,PartC_6708);
                                                                            {8514}new Ns_6709: bitstring;
                                                                            {8515}let gNs_6710: bitstring = exp(g,Ns_6709) in
                                                                            {8516}let m2_6711: bitstring = gNs_6710 in
                                                                            {8517}out(c, (enc(m2_6711,pkCli_6663),sign(m2_6711,skSess_6457)));
                                                                            {8518}event beginSrv(Sess_5512,Cli_5510,gNs_6710)
                                                            )
                                                            else
                                                                {8519}let pkDisco_6712: bitstring = fail-any in
                                                                {8520}in(c, (=pkCli_6663,em1_6713: bitstring,sigM1_6714: bitstring));
                                                                {8521}let m1_6715: bitstring = dec(em1_6713,skSess_6457) in
                                                                {8522}if (verify(m1_6715,sigM1_6714,pkCli_6663) <> true) then
                                                                    0
                                                                else
                                                                    {8523}let (SPc_6716: bitstring,PartC_6717: bitstring) = m1_6715 in
                                                                    {8524}event endSrv(Cli_5510,Sess_5512,PartC_6717);
                                                                    {8525}new Ns_6718: bitstring;
                                                                    {8526}let gNs_6719: bitstring = exp(g,Ns_6718) in
                                                                    {8527}let m2_6720: bitstring = gNs_6719 in
                                                                    {8528}out(c, (enc(m2_6720,pkCli_6663),sign(m2_6720,skSess_6457)));
                                                                    {8529}event beginSrv(Sess_5512,Cli_5510,gNs_6719)
                                                    )
                                                    else
                                                        {8530}let pkDisco_6721: bitstring = fail-any in
                                                        {8531}in(c, (=pkCli_6663,em1_6722: bitstring,sigM1_6723: bitstring));
                                                        {8532}let m1_6724: bitstring = dec(em1_6722,skSess_6457) in
                                                        {8533}if (verify(m1_6724,sigM1_6723,pkCli_6663) <> true) then
                                                            0
                                                        else
                                                            {8534}let (SPc_6725: bitstring,PartC_6726: bitstring) = m1_6724 in
                                                            {8535}event endSrv(Cli_5510,Sess_5512,PartC_6726);
                                                            {8536}new Ns_6727: bitstring;
                                                            {8537}let gNs_6728: bitstring = exp(g,Ns_6727) in
                                                            {8538}let m2_6729: bitstring = gNs_6728 in
                                                            {8539}out(c, (enc(m2_6729,pkCli_6663),sign(m2_6729,skSess_6457)));
                                                            {8540}event beginSrv(Sess_5512,Cli_5510,gNs_6728)
                                            )
                                            else
                                                {8541}let pkCli_6730: bitstring = fail-any in
                                                {8542}let v_6731: bool = (Disco_5511 = A) in
                                                (
                                                    {8543}if v_6731 then
                                                    (
                                                        {8544}let pkDisco_6732: bitstring = pub(skA) in
                                                        {8545}in(c, (=pkCli_6730,em1_6733: bitstring,sigM1_6734: bitstring));
                                                        {8546}let m1_6735: bitstring = dec(em1_6733,skSess_6457) in
                                                        {8547}if (verify(m1_6735,sigM1_6734,pkCli_6730) <> true) then
                                                            0
                                                        else
                                                            {8548}let (SPc_6736: bitstring,PartC_6737: bitstring) = m1_6735 in
                                                            {8549}event endSrv(Cli_5510,Sess_5512,PartC_6737);
                                                            {8550}new Ns_6738: bitstring;
                                                            {8551}let gNs_6739: bitstring = exp(g,Ns_6738) in
                                                            {8552}let m2_6740: bitstring = gNs_6739 in
                                                            {8553}out(c, (enc(m2_6740,pkCli_6730),sign(m2_6740,skSess_6457)));
                                                            {8554}event beginSrv(Sess_5512,Cli_5510,gNs_6739)
                                                    )
                                                    else
                                                        {8555}let v_6741: bool = (Disco_5511 = B) in
                                                        (
                                                            {8556}if v_6741 then
                                                            (
                                                                {8557}let pkDisco_6742: bitstring = pub(skB) in
                                                                {8558}in(c, (=pkCli_6730,em1_6743: bitstring,sigM1_6744: bitstring));
                                                                {8559}let m1_6745: bitstring = dec(em1_6743,skSess_6457) in
                                                                {8560}if (verify(m1_6745,sigM1_6744,pkCli_6730) <> true) then
                                                                    0
                                                                else
                                                                    {8561}let (SPc_6746: bitstring,PartC_6747: bitstring) = m1_6745 in
                                                                    {8562}event endSrv(Cli_5510,Sess_5512,PartC_6747);
                                                                    {8563}new Ns_6748: bitstring;
                                                                    {8564}let gNs_6749: bitstring = exp(g,Ns_6748) in
                                                                    {8565}let m2_6750: bitstring = gNs_6749 in
                                                                    {8566}out(c, (enc(m2_6750,pkCli_6730),sign(m2_6750,skSess_6457)));
                                                                    {8567}event beginSrv(Sess_5512,Cli_5510,gNs_6749)
                                                            )
                                                            else
                                                                {8568}let v_6751: bool = (Disco_5511 = C) in
                                                                (
                                                                    {8569}if v_6751 then
                                                                    (
                                                                        {8570}let pkDisco_6752: bitstring = pub(skC) in
                                                                        {8571}in(c, (=pkCli_6730,em1_6753: bitstring,sigM1_6754: bitstring));
                                                                        {8572}let m1_6755: bitstring = dec(em1_6753,skSess_6457) in
                                                                        {8573}if (verify(m1_6755,sigM1_6754,pkCli_6730) <> true) then
                                                                            0
                                                                        else
                                                                            {8574}let (SPc_6756: bitstring,PartC_6757: bitstring) = m1_6755 in
                                                                            {8575}event endSrv(Cli_5510,Sess_5512,PartC_6757);
                                                                            {8576}new Ns_6758: bitstring;
                                                                            {8577}let gNs_6759: bitstring = exp(g,Ns_6758) in
                                                                            {8578}let m2_6760: bitstring = gNs_6759 in
                                                                            {8579}out(c, (enc(m2_6760,pkCli_6730),sign(m2_6760,skSess_6457)));
                                                                            {8580}event beginSrv(Sess_5512,Cli_5510,gNs_6759)
                                                                    )
                                                                    else
                                                                        {8581}let pkDisco_6761: bitstring = pub(skI) in
                                                                        {8582}in(c, (=pkCli_6730,em1_6762: bitstring,sigM1_6763: bitstring));
                                                                        {8583}let m1_6764: bitstring = dec(em1_6762,skSess_6457) in
                                                                        {8584}if (verify(m1_6764,sigM1_6763,pkCli_6730) <> true) then
                                                                            0
                                                                        else
                                                                            {8585}let (SPc_6765: bitstring,PartC_6766: bitstring) = m1_6764 in
                                                                            {8586}event endSrv(Cli_5510,Sess_5512,PartC_6766);
                                                                            {8587}new Ns_6767: bitstring;
                                                                            {8588}let gNs_6768: bitstring = exp(g,Ns_6767) in
                                                                            {8589}let m2_6769: bitstring = gNs_6768 in
                                                                            {8590}out(c, (enc(m2_6769,pkCli_6730),sign(m2_6769,skSess_6457)));
                                                                            {8591}event beginSrv(Sess_5512,Cli_5510,gNs_6768)
                                                                )
                                                                else
                                                                    {8592}let pkDisco_6770: bitstring = fail-any in
                                                                    {8593}in(c, (=pkCli_6730,em1_6771: bitstring,sigM1_6772: bitstring));
                                                                    {8594}let m1_6773: bitstring = dec(em1_6771,skSess_6457) in
                                                                    {8595}if (verify(m1_6773,sigM1_6772,pkCli_6730) <> true) then
                                                                        0
                                                                    else
                                                                        {8596}let (SPc_6774: bitstring,PartC_6775: bitstring) = m1_6773 in
                                                                        {8597}event endSrv(Cli_5510,Sess_5512,PartC_6775);
                                                                        {8598}new Ns_6776: bitstring;
                                                                        {8599}let gNs_6777: bitstring = exp(g,Ns_6776) in
                                                                        {8600}let m2_6778: bitstring = gNs_6777 in
                                                                        {8601}out(c, (enc(m2_6778,pkCli_6730),sign(m2_6778,skSess_6457)));
                                                                        {8602}event beginSrv(Sess_5512,Cli_5510,gNs_6777)
                                                        )
                                                        else
                                                            {8603}let pkDisco_6779: bitstring = fail-any in
                                                            {8604}in(c, (=pkCli_6730,em1_6780: bitstring,sigM1_6781: bitstring));
                                                            {8605}let m1_6782: bitstring = dec(em1_6780,skSess_6457) in
                                                            {8606}if (verify(m1_6782,sigM1_6781,pkCli_6730) <> true) then
                                                                0
                                                            else
                                                                {8607}let (SPc_6783: bitstring,PartC_6784: bitstring) = m1_6782 in
                                                                {8608}event endSrv(Cli_5510,Sess_5512,PartC_6784);
                                                                {8609}new Ns_6785: bitstring;
                                                                {8610}let gNs_6786: bitstring = exp(g,Ns_6785) in
                                                                {8611}let m2_6787: bitstring = gNs_6786 in
                                                                {8612}out(c, (enc(m2_6787,pkCli_6730),sign(m2_6787,skSess_6457)));
                                                                {8613}event beginSrv(Sess_5512,Cli_5510,gNs_6786)
                                                )
                                                else
                                                    {8614}let pkDisco_6788: bitstring = fail-any in
                                                    {8615}in(c, (=pkCli_6730,em1_6789: bitstring,sigM1_6790: bitstring));
                                                    {8616}let m1_6791: bitstring = dec(em1_6789,skSess_6457) in
                                                    {8617}if (verify(m1_6791,sigM1_6790,pkCli_6730) <> true) then
                                                        0
                                                    else
                                                        {8618}let (SPc_6792: bitstring,PartC_6793: bitstring) = m1_6791 in
                                                        {8619}event endSrv(Cli_5510,Sess_5512,PartC_6793);
                                                        {8620}new Ns_6794: bitstring;
                                                        {8621}let gNs_6795: bitstring = exp(g,Ns_6794) in
                                                        {8622}let m2_6796: bitstring = gNs_6795 in
                                                        {8623}out(c, (enc(m2_6796,pkCli_6730),sign(m2_6796,skSess_6457)));
                                                        {8624}event beginSrv(Sess_5512,Cli_5510,gNs_6795)
                                    )
                                    else
                                        {8625}let pkCli_6797: bitstring = fail-any in
                                        {8626}let v_6798: bool = (Disco_5511 = A) in
                                        (
                                            {8627}if v_6798 then
                                            (
                                                {8628}let pkDisco_6799: bitstring = pub(skA) in
                                                {8629}in(c, (=pkCli_6797,em1_6800: bitstring,sigM1_6801: bitstring));
                                                {8630}let m1_6802: bitstring = dec(em1_6800,skSess_6457) in
                                                {8631}if (verify(m1_6802,sigM1_6801,pkCli_6797) <> true) then
                                                    0
                                                else
                                                    {8632}let (SPc_6803: bitstring,PartC_6804: bitstring) = m1_6802 in
                                                    {8633}event endSrv(Cli_5510,Sess_5512,PartC_6804);
                                                    {8634}new Ns_6805: bitstring;
                                                    {8635}let gNs_6806: bitstring = exp(g,Ns_6805) in
                                                    {8636}let m2_6807: bitstring = gNs_6806 in
                                                    {8637}out(c, (enc(m2_6807,pkCli_6797),sign(m2_6807,skSess_6457)));
                                                    {8638}event beginSrv(Sess_5512,Cli_5510,gNs_6806)
                                            )
                                            else
                                                {8639}let v_6808: bool = (Disco_5511 = B) in
                                                (
                                                    {8640}if v_6808 then
                                                    (
                                                        {8641}let pkDisco_6809: bitstring = pub(skB) in
                                                        {8642}in(c, (=pkCli_6797,em1_6810: bitstring,sigM1_6811: bitstring));
                                                        {8643}let m1_6812: bitstring = dec(em1_6810,skSess_6457) in
                                                        {8644}if (verify(m1_6812,sigM1_6811,pkCli_6797) <> true) then
                                                            0
                                                        else
                                                            {8645}let (SPc_6813: bitstring,PartC_6814: bitstring) = m1_6812 in
                                                            {8646}event endSrv(Cli_5510,Sess_5512,PartC_6814);
                                                            {8647}new Ns_6815: bitstring;
                                                            {8648}let gNs_6816: bitstring = exp(g,Ns_6815) in
                                                            {8649}let m2_6817: bitstring = gNs_6816 in
                                                            {8650}out(c, (enc(m2_6817,pkCli_6797),sign(m2_6817,skSess_6457)));
                                                            {8651}event beginSrv(Sess_5512,Cli_5510,gNs_6816)
                                                    )
                                                    else
                                                        {8652}let v_6818: bool = (Disco_5511 = C) in
                                                        (
                                                            {8653}if v_6818 then
                                                            (
                                                                {8654}let pkDisco_6819: bitstring = pub(skC) in
                                                                {8655}in(c, (=pkCli_6797,em1_6820: bitstring,sigM1_6821: bitstring));
                                                                {8656}let m1_6822: bitstring = dec(em1_6820,skSess_6457) in
                                                                {8657}if (verify(m1_6822,sigM1_6821,pkCli_6797) <> true) then
                                                                    0
                                                                else
                                                                    {8658}let (SPc_6823: bitstring,PartC_6824: bitstring) = m1_6822 in
                                                                    {8659}event endSrv(Cli_5510,Sess_5512,PartC_6824);
                                                                    {8660}new Ns_6825: bitstring;
                                                                    {8661}let gNs_6826: bitstring = exp(g,Ns_6825) in
                                                                    {8662}let m2_6827: bitstring = gNs_6826 in
                                                                    {8663}out(c, (enc(m2_6827,pkCli_6797),sign(m2_6827,skSess_6457)));
                                                                    {8664}event beginSrv(Sess_5512,Cli_5510,gNs_6826)
                                                            )
                                                            else
                                                                {8665}let pkDisco_6828: bitstring = pub(skI) in
                                                                {8666}in(c, (=pkCli_6797,em1_6829: bitstring,sigM1_6830: bitstring));
                                                                {8667}let m1_6831: bitstring = dec(em1_6829,skSess_6457) in
                                                                {8668}if (verify(m1_6831,sigM1_6830,pkCli_6797) <> true) then
                                                                    0
                                                                else
                                                                    {8669}let (SPc_6832: bitstring,PartC_6833: bitstring) = m1_6831 in
                                                                    {8670}event endSrv(Cli_5510,Sess_5512,PartC_6833);
                                                                    {8671}new Ns_6834: bitstring;
                                                                    {8672}let gNs_6835: bitstring = exp(g,Ns_6834) in
                                                                    {8673}let m2_6836: bitstring = gNs_6835 in
                                                                    {8674}out(c, (enc(m2_6836,pkCli_6797),sign(m2_6836,skSess_6457)));
                                                                    {8675}event beginSrv(Sess_5512,Cli_5510,gNs_6835)
                                                        )
                                                        else
                                                            {8676}let pkDisco_6837: bitstring = fail-any in
                                                            {8677}in(c, (=pkCli_6797,em1_6838: bitstring,sigM1_6839: bitstring));
                                                            {8678}let m1_6840: bitstring = dec(em1_6838,skSess_6457) in
                                                            {8679}if (verify(m1_6840,sigM1_6839,pkCli_6797) <> true) then
                                                                0
                                                            else
                                                                {8680}let (SPc_6841: bitstring,PartC_6842: bitstring) = m1_6840 in
                                                                {8681}event endSrv(Cli_5510,Sess_5512,PartC_6842);
                                                                {8682}new Ns_6843: bitstring;
                                                                {8683}let gNs_6844: bitstring = exp(g,Ns_6843) in
                                                                {8684}let m2_6845: bitstring = gNs_6844 in
                                                                {8685}out(c, (enc(m2_6845,pkCli_6797),sign(m2_6845,skSess_6457)));
                                                                {8686}event beginSrv(Sess_5512,Cli_5510,gNs_6844)
                                                )
                                                else
                                                    {8687}let pkDisco_6846: bitstring = fail-any in
                                                    {8688}in(c, (=pkCli_6797,em1_6847: bitstring,sigM1_6848: bitstring));
                                                    {8689}let m1_6849: bitstring = dec(em1_6847,skSess_6457) in
                                                    {8690}if (verify(m1_6849,sigM1_6848,pkCli_6797) <> true) then
                                                        0
                                                    else
                                                        {8691}let (SPc_6850: bitstring,PartC_6851: bitstring) = m1_6849 in
                                                        {8692}event endSrv(Cli_5510,Sess_5512,PartC_6851);
                                                        {8693}new Ns_6852: bitstring;
                                                        {8694}let gNs_6853: bitstring = exp(g,Ns_6852) in
                                                        {8695}let m2_6854: bitstring = gNs_6853 in
                                                        {8696}out(c, (enc(m2_6854,pkCli_6797),sign(m2_6854,skSess_6457)));
                                                        {8697}event beginSrv(Sess_5512,Cli_5510,gNs_6853)
                                        )
                                        else
                                            {8698}let pkDisco_6855: bitstring = fail-any in
                                            {8699}in(c, (=pkCli_6797,em1_6856: bitstring,sigM1_6857: bitstring));
                                            {8700}let m1_6858: bitstring = dec(em1_6856,skSess_6457) in
                                            {8701}if (verify(m1_6858,sigM1_6857,pkCli_6797) <> true) then
                                                0
                                            else
                                                {8702}let (SPc_6859: bitstring,PartC_6860: bitstring) = m1_6858 in
                                                {8703}event endSrv(Cli_5510,Sess_5512,PartC_6860);
                                                {8704}new Ns_6861: bitstring;
                                                {8705}let gNs_6862: bitstring = exp(g,Ns_6861) in
                                                {8706}let m2_6863: bitstring = gNs_6862 in
                                                {8707}out(c, (enc(m2_6863,pkCli_6797),sign(m2_6863,skSess_6457)));
                                                {8708}event beginSrv(Sess_5512,Cli_5510,gNs_6862)
                            )
                            else
                                {8709}let pkCli_6864: bitstring = fail-any in
                                {8710}let v_6865: bool = (Disco_5511 = A) in
                                (
                                    {8711}if v_6865 then
                                    (
                                        {8712}let pkDisco_6866: bitstring = pub(skA) in
                                        {8713}in(c, (=pkCli_6864,em1_6867: bitstring,sigM1_6868: bitstring));
                                        {8714}let m1_6869: bitstring = dec(em1_6867,skSess_6457) in
                                        {8715}if (verify(m1_6869,sigM1_6868,pkCli_6864) <> true) then
                                            0
                                        else
                                            {8716}let (SPc_6870: bitstring,PartC_6871: bitstring) = m1_6869 in
                                            {8717}event endSrv(Cli_5510,Sess_5512,PartC_6871);
                                            {8718}new Ns_6872: bitstring;
                                            {8719}let gNs_6873: bitstring = exp(g,Ns_6872) in
                                            {8720}let m2_6874: bitstring = gNs_6873 in
                                            {8721}out(c, (enc(m2_6874,pkCli_6864),sign(m2_6874,skSess_6457)));
                                            {8722}event beginSrv(Sess_5512,Cli_5510,gNs_6873)
                                    )
                                    else
                                        {8723}let v_6875: bool = (Disco_5511 = B) in
                                        (
                                            {8724}if v_6875 then
                                            (
                                                {8725}let pkDisco_6876: bitstring = pub(skB) in
                                                {8726}in(c, (=pkCli_6864,em1_6877: bitstring,sigM1_6878: bitstring));
                                                {8727}let m1_6879: bitstring = dec(em1_6877,skSess_6457) in
                                                {8728}if (verify(m1_6879,sigM1_6878,pkCli_6864) <> true) then
                                                    0
                                                else
                                                    {8729}let (SPc_6880: bitstring,PartC_6881: bitstring) = m1_6879 in
                                                    {8730}event endSrv(Cli_5510,Sess_5512,PartC_6881);
                                                    {8731}new Ns_6882: bitstring;
                                                    {8732}let gNs_6883: bitstring = exp(g,Ns_6882) in
                                                    {8733}let m2_6884: bitstring = gNs_6883 in
                                                    {8734}out(c, (enc(m2_6884,pkCli_6864),sign(m2_6884,skSess_6457)));
                                                    {8735}event beginSrv(Sess_5512,Cli_5510,gNs_6883)
                                            )
                                            else
                                                {8736}let v_6885: bool = (Disco_5511 = C) in
                                                (
                                                    {8737}if v_6885 then
                                                    (
                                                        {8738}let pkDisco_6886: bitstring = pub(skC) in
                                                        {8739}in(c, (=pkCli_6864,em1_6887: bitstring,sigM1_6888: bitstring));
                                                        {8740}let m1_6889: bitstring = dec(em1_6887,skSess_6457) in
                                                        {8741}if (verify(m1_6889,sigM1_6888,pkCli_6864) <> true) then
                                                            0
                                                        else
                                                            {8742}let (SPc_6890: bitstring,PartC_6891: bitstring) = m1_6889 in
                                                            {8743}event endSrv(Cli_5510,Sess_5512,PartC_6891);
                                                            {8744}new Ns_6892: bitstring;
                                                            {8745}let gNs_6893: bitstring = exp(g,Ns_6892) in
                                                            {8746}let m2_6894: bitstring = gNs_6893 in
                                                            {8747}out(c, (enc(m2_6894,pkCli_6864),sign(m2_6894,skSess_6457)));
                                                            {8748}event beginSrv(Sess_5512,Cli_5510,gNs_6893)
                                                    )
                                                    else
                                                        {8749}let pkDisco_6895: bitstring = pub(skI) in
                                                        {8750}in(c, (=pkCli_6864,em1_6896: bitstring,sigM1_6897: bitstring));
                                                        {8751}let m1_6898: bitstring = dec(em1_6896,skSess_6457) in
                                                        {8752}if (verify(m1_6898,sigM1_6897,pkCli_6864) <> true) then
                                                            0
                                                        else
                                                            {8753}let (SPc_6899: bitstring,PartC_6900: bitstring) = m1_6898 in
                                                            {8754}event endSrv(Cli_5510,Sess_5512,PartC_6900);
                                                            {8755}new Ns_6901: bitstring;
                                                            {8756}let gNs_6902: bitstring = exp(g,Ns_6901) in
                                                            {8757}let m2_6903: bitstring = gNs_6902 in
                                                            {8758}out(c, (enc(m2_6903,pkCli_6864),sign(m2_6903,skSess_6457)));
                                                            {8759}event beginSrv(Sess_5512,Cli_5510,gNs_6902)
                                                )
                                                else
                                                    {8760}let pkDisco_6904: bitstring = fail-any in
                                                    {8761}in(c, (=pkCli_6864,em1_6905: bitstring,sigM1_6906: bitstring));
                                                    {8762}let m1_6907: bitstring = dec(em1_6905,skSess_6457) in
                                                    {8763}if (verify(m1_6907,sigM1_6906,pkCli_6864) <> true) then
                                                        0
                                                    else
                                                        {8764}let (SPc_6908: bitstring,PartC_6909: bitstring) = m1_6907 in
                                                        {8765}event endSrv(Cli_5510,Sess_5512,PartC_6909);
                                                        {8766}new Ns_6910: bitstring;
                                                        {8767}let gNs_6911: bitstring = exp(g,Ns_6910) in
                                                        {8768}let m2_6912: bitstring = gNs_6911 in
                                                        {8769}out(c, (enc(m2_6912,pkCli_6864),sign(m2_6912,skSess_6457)));
                                                        {8770}event beginSrv(Sess_5512,Cli_5510,gNs_6911)
                                        )
                                        else
                                            {8771}let pkDisco_6913: bitstring = fail-any in
                                            {8772}in(c, (=pkCli_6864,em1_6914: bitstring,sigM1_6915: bitstring));
                                            {8773}let m1_6916: bitstring = dec(em1_6914,skSess_6457) in
                                            {8774}if (verify(m1_6916,sigM1_6915,pkCli_6864) <> true) then
                                                0
                                            else
                                                {8775}let (SPc_6917: bitstring,PartC_6918: bitstring) = m1_6916 in
                                                {8776}event endSrv(Cli_5510,Sess_5512,PartC_6918);
                                                {8777}new Ns_6919: bitstring;
                                                {8778}let gNs_6920: bitstring = exp(g,Ns_6919) in
                                                {8779}let m2_6921: bitstring = gNs_6920 in
                                                {8780}out(c, (enc(m2_6921,pkCli_6864),sign(m2_6921,skSess_6457)));
                                                {8781}event beginSrv(Sess_5512,Cli_5510,gNs_6920)
                                )
                                else
                                    {8782}let pkDisco_6922: bitstring = fail-any in
                                    {8783}in(c, (=pkCli_6864,em1_6923: bitstring,sigM1_6924: bitstring));
                                    {8784}let m1_6925: bitstring = dec(em1_6923,skSess_6457) in
                                    {8785}if (verify(m1_6925,sigM1_6924,pkCli_6864) <> true) then
                                        0
                                    else
                                        {8786}let (SPc_6926: bitstring,PartC_6927: bitstring) = m1_6925 in
                                        {8787}event endSrv(Cli_5510,Sess_5512,PartC_6927);
                                        {8788}new Ns_6928: bitstring;
                                        {8789}let gNs_6929: bitstring = exp(g,Ns_6928) in
                                        {8790}let m2_6930: bitstring = gNs_6929 in
                                        {8791}out(c, (enc(m2_6930,pkCli_6864),sign(m2_6930,skSess_6457)));
                                        {8792}event beginSrv(Sess_5512,Cli_5510,gNs_6929)
                        )
                        else
                            {8793}let skSess_6931: bitstring = skI in
                            {8794}let pkSess_6932: bitstring = pub(skSess_6931) in
                            {8795}let v_6933: bool = (Cli_5510 = A) in
                            (
                                {8796}if v_6933 then
                                (
                                    {8797}let pkCli_6934: bitstring = pub(skA) in
                                    {8798}let v_6935: bool = (Disco_5511 = A) in
                                    (
                                        {8799}if v_6935 then
                                        (
                                            {8800}let pkDisco_6936: bitstring = pub(skA) in
                                            {8801}in(c, (=pkCli_6934,em1_6937: bitstring,sigM1_6938: bitstring));
                                            {8802}let m1_6939: bitstring = dec(em1_6937,skSess_6931) in
                                            {8803}if (verify(m1_6939,sigM1_6938,pkCli_6934) <> true) then
                                                0
                                            else
                                                {8804}let (SPc_6940: bitstring,PartC_6941: bitstring) = m1_6939 in
                                                {8805}event endSrv(Cli_5510,Sess_5512,PartC_6941);
                                                {8806}new Ns_6942: bitstring;
                                                {8807}let gNs_6943: bitstring = exp(g,Ns_6942) in
                                                {8808}let m2_6944: bitstring = gNs_6943 in
                                                {8809}out(c, (enc(m2_6944,pkCli_6934),sign(m2_6944,skSess_6931)));
                                                {8810}event beginSrv(Sess_5512,Cli_5510,gNs_6943)
                                        )
                                        else
                                            {8811}let v_6945: bool = (Disco_5511 = B) in
                                            (
                                                {8812}if v_6945 then
                                                (
                                                    {8813}let pkDisco_6946: bitstring = pub(skB) in
                                                    {8814}in(c, (=pkCli_6934,em1_6947: bitstring,sigM1_6948: bitstring));
                                                    {8815}let m1_6949: bitstring = dec(em1_6947,skSess_6931) in
                                                    {8816}if (verify(m1_6949,sigM1_6948,pkCli_6934) <> true) then
                                                        0
                                                    else
                                                        {8817}let (SPc_6950: bitstring,PartC_6951: bitstring) = m1_6949 in
                                                        {8818}event endSrv(Cli_5510,Sess_5512,PartC_6951);
                                                        {8819}new Ns_6952: bitstring;
                                                        {8820}let gNs_6953: bitstring = exp(g,Ns_6952) in
                                                        {8821}let m2_6954: bitstring = gNs_6953 in
                                                        {8822}out(c, (enc(m2_6954,pkCli_6934),sign(m2_6954,skSess_6931)));
                                                        {8823}event beginSrv(Sess_5512,Cli_5510,gNs_6953)
                                                )
                                                else
                                                    {8824}let v_6955: bool = (Disco_5511 = C) in
                                                    (
                                                        {8825}if v_6955 then
                                                        (
                                                            {8826}let pkDisco_6956: bitstring = pub(skC) in
                                                            {8827}in(c, (=pkCli_6934,em1_6957: bitstring,sigM1_6958: bitstring));
                                                            {8828}let m1_6959: bitstring = dec(em1_6957,skSess_6931) in
                                                            {8829}if (verify(m1_6959,sigM1_6958,pkCli_6934) <> true) then
                                                                0
                                                            else
                                                                {8830}let (SPc_6960: bitstring,PartC_6961: bitstring) = m1_6959 in
                                                                {8831}event endSrv(Cli_5510,Sess_5512,PartC_6961);
                                                                {8832}new Ns_6962: bitstring;
                                                                {8833}let gNs_6963: bitstring = exp(g,Ns_6962) in
                                                                {8834}let m2_6964: bitstring = gNs_6963 in
                                                                {8835}out(c, (enc(m2_6964,pkCli_6934),sign(m2_6964,skSess_6931)));
                                                                {8836}event beginSrv(Sess_5512,Cli_5510,gNs_6963)
                                                        )
                                                        else
                                                            {8837}let pkDisco_6965: bitstring = pub(skI) in
                                                            {8838}in(c, (=pkCli_6934,em1_6966: bitstring,sigM1_6967: bitstring));
                                                            {8839}let m1_6968: bitstring = dec(em1_6966,skSess_6931) in
                                                            {8840}if (verify(m1_6968,sigM1_6967,pkCli_6934) <> true) then
                                                                0
                                                            else
                                                                {8841}let (SPc_6969: bitstring,PartC_6970: bitstring) = m1_6968 in
                                                                {8842}event endSrv(Cli_5510,Sess_5512,PartC_6970);
                                                                {8843}new Ns_6971: bitstring;
                                                                {8844}let gNs_6972: bitstring = exp(g,Ns_6971) in
                                                                {8845}let m2_6973: bitstring = gNs_6972 in
                                                                {8846}out(c, (enc(m2_6973,pkCli_6934),sign(m2_6973,skSess_6931)));
                                                                {8847}event beginSrv(Sess_5512,Cli_5510,gNs_6972)
                                                    )
                                                    else
                                                        {8848}let pkDisco_6974: bitstring = fail-any in
                                                        {8849}in(c, (=pkCli_6934,em1_6975: bitstring,sigM1_6976: bitstring));
                                                        {8850}let m1_6977: bitstring = dec(em1_6975,skSess_6931) in
                                                        {8851}if (verify(m1_6977,sigM1_6976,pkCli_6934) <> true) then
                                                            0
                                                        else
                                                            {8852}let (SPc_6978: bitstring,PartC_6979: bitstring) = m1_6977 in
                                                            {8853}event endSrv(Cli_5510,Sess_5512,PartC_6979);
                                                            {8854}new Ns_6980: bitstring;
                                                            {8855}let gNs_6981: bitstring = exp(g,Ns_6980) in
                                                            {8856}let m2_6982: bitstring = gNs_6981 in
                                                            {8857}out(c, (enc(m2_6982,pkCli_6934),sign(m2_6982,skSess_6931)));
                                                            {8858}event beginSrv(Sess_5512,Cli_5510,gNs_6981)
                                            )
                                            else
                                                {8859}let pkDisco_6983: bitstring = fail-any in
                                                {8860}in(c, (=pkCli_6934,em1_6984: bitstring,sigM1_6985: bitstring));
                                                {8861}let m1_6986: bitstring = dec(em1_6984,skSess_6931) in
                                                {8862}if (verify(m1_6986,sigM1_6985,pkCli_6934) <> true) then
                                                    0
                                                else
                                                    {8863}let (SPc_6987: bitstring,PartC_6988: bitstring) = m1_6986 in
                                                    {8864}event endSrv(Cli_5510,Sess_5512,PartC_6988);
                                                    {8865}new Ns_6989: bitstring;
                                                    {8866}let gNs_6990: bitstring = exp(g,Ns_6989) in
                                                    {8867}let m2_6991: bitstring = gNs_6990 in
                                                    {8868}out(c, (enc(m2_6991,pkCli_6934),sign(m2_6991,skSess_6931)));
                                                    {8869}event beginSrv(Sess_5512,Cli_5510,gNs_6990)
                                    )
                                    else
                                        {8870}let pkDisco_6992: bitstring = fail-any in
                                        {8871}in(c, (=pkCli_6934,em1_6993: bitstring,sigM1_6994: bitstring));
                                        {8872}let m1_6995: bitstring = dec(em1_6993,skSess_6931) in
                                        {8873}if (verify(m1_6995,sigM1_6994,pkCli_6934) <> true) then
                                            0
                                        else
                                            {8874}let (SPc_6996: bitstring,PartC_6997: bitstring) = m1_6995 in
                                            {8875}event endSrv(Cli_5510,Sess_5512,PartC_6997);
                                            {8876}new Ns_6998: bitstring;
                                            {8877}let gNs_6999: bitstring = exp(g,Ns_6998) in
                                            {8878}let m2_7000: bitstring = gNs_6999 in
                                            {8879}out(c, (enc(m2_7000,pkCli_6934),sign(m2_7000,skSess_6931)));
                                            {8880}event beginSrv(Sess_5512,Cli_5510,gNs_6999)
                                )
                                else
                                    {8881}let v_7001: bool = (Cli_5510 = B) in
                                    (
                                        {8882}if v_7001 then
                                        (
                                            {8883}let pkCli_7002: bitstring = pub(skB) in
                                            {8884}let v_7003: bool = (Disco_5511 = A) in
                                            (
                                                {8885}if v_7003 then
                                                (
                                                    {8886}let pkDisco_7004: bitstring = pub(skA) in
                                                    {8887}in(c, (=pkCli_7002,em1_7005: bitstring,sigM1_7006: bitstring));
                                                    {8888}let m1_7007: bitstring = dec(em1_7005,skSess_6931) in
                                                    {8889}if (verify(m1_7007,sigM1_7006,pkCli_7002) <> true) then
                                                        0
                                                    else
                                                        {8890}let (SPc_7008: bitstring,PartC_7009: bitstring) = m1_7007 in
                                                        {8891}event endSrv(Cli_5510,Sess_5512,PartC_7009);
                                                        {8892}new Ns_7010: bitstring;
                                                        {8893}let gNs_7011: bitstring = exp(g,Ns_7010) in
                                                        {8894}let m2_7012: bitstring = gNs_7011 in
                                                        {8895}out(c, (enc(m2_7012,pkCli_7002),sign(m2_7012,skSess_6931)));
                                                        {8896}event beginSrv(Sess_5512,Cli_5510,gNs_7011)
                                                )
                                                else
                                                    {8897}let v_7013: bool = (Disco_5511 = B) in
                                                    (
                                                        {8898}if v_7013 then
                                                        (
                                                            {8899}let pkDisco_7014: bitstring = pub(skB) in
                                                            {8900}in(c, (=pkCli_7002,em1_7015: bitstring,sigM1_7016: bitstring));
                                                            {8901}let m1_7017: bitstring = dec(em1_7015,skSess_6931) in
                                                            {8902}if (verify(m1_7017,sigM1_7016,pkCli_7002) <> true) then
                                                                0
                                                            else
                                                                {8903}let (SPc_7018: bitstring,PartC_7019: bitstring) = m1_7017 in
                                                                {8904}event endSrv(Cli_5510,Sess_5512,PartC_7019);
                                                                {8905}new Ns_7020: bitstring;
                                                                {8906}let gNs_7021: bitstring = exp(g,Ns_7020) in
                                                                {8907}let m2_7022: bitstring = gNs_7021 in
                                                                {8908}out(c, (enc(m2_7022,pkCli_7002),sign(m2_7022,skSess_6931)));
                                                                {8909}event beginSrv(Sess_5512,Cli_5510,gNs_7021)
                                                        )
                                                        else
                                                            {8910}let v_7023: bool = (Disco_5511 = C) in
                                                            (
                                                                {8911}if v_7023 then
                                                                (
                                                                    {8912}let pkDisco_7024: bitstring = pub(skC) in
                                                                    {8913}in(c, (=pkCli_7002,em1_7025: bitstring,sigM1_7026: bitstring));
                                                                    {8914}let m1_7027: bitstring = dec(em1_7025,skSess_6931) in
                                                                    {8915}if (verify(m1_7027,sigM1_7026,pkCli_7002) <> true) then
                                                                        0
                                                                    else
                                                                        {8916}let (SPc_7028: bitstring,PartC_7029: bitstring) = m1_7027 in
                                                                        {8917}event endSrv(Cli_5510,Sess_5512,PartC_7029);
                                                                        {8918}new Ns_7030: bitstring;
                                                                        {8919}let gNs_7031: bitstring = exp(g,Ns_7030) in
                                                                        {8920}let m2_7032: bitstring = gNs_7031 in
                                                                        {8921}out(c, (enc(m2_7032,pkCli_7002),sign(m2_7032,skSess_6931)));
                                                                        {8922}event beginSrv(Sess_5512,Cli_5510,gNs_7031)
                                                                )
                                                                else
                                                                    {8923}let pkDisco_7033: bitstring = pub(skI) in
                                                                    {8924}in(c, (=pkCli_7002,em1_7034: bitstring,sigM1_7035: bitstring));
                                                                    {8925}let m1_7036: bitstring = dec(em1_7034,skSess_6931) in
                                                                    {8926}if (verify(m1_7036,sigM1_7035,pkCli_7002) <> true) then
                                                                        0
                                                                    else
                                                                        {8927}let (SPc_7037: bitstring,PartC_7038: bitstring) = m1_7036 in
                                                                        {8928}event endSrv(Cli_5510,Sess_5512,PartC_7038);
                                                                        {8929}new Ns_7039: bitstring;
                                                                        {8930}let gNs_7040: bitstring = exp(g,Ns_7039) in
                                                                        {8931}let m2_7041: bitstring = gNs_7040 in
                                                                        {8932}out(c, (enc(m2_7041,pkCli_7002),sign(m2_7041,skSess_6931)));
                                                                        {8933}event beginSrv(Sess_5512,Cli_5510,gNs_7040)
                                                            )
                                                            else
                                                                {8934}let pkDisco_7042: bitstring = fail-any in
                                                                {8935}in(c, (=pkCli_7002,em1_7043: bitstring,sigM1_7044: bitstring));
                                                                {8936}let m1_7045: bitstring = dec(em1_7043,skSess_6931) in
                                                                {8937}if (verify(m1_7045,sigM1_7044,pkCli_7002) <> true) then
                                                                    0
                                                                else
                                                                    {8938}let (SPc_7046: bitstring,PartC_7047: bitstring) = m1_7045 in
                                                                    {8939}event endSrv(Cli_5510,Sess_5512,PartC_7047);
                                                                    {8940}new Ns_7048: bitstring;
                                                                    {8941}let gNs_7049: bitstring = exp(g,Ns_7048) in
                                                                    {8942}let m2_7050: bitstring = gNs_7049 in
                                                                    {8943}out(c, (enc(m2_7050,pkCli_7002),sign(m2_7050,skSess_6931)));
                                                                    {8944}event beginSrv(Sess_5512,Cli_5510,gNs_7049)
                                                    )
                                                    else
                                                        {8945}let pkDisco_7051: bitstring = fail-any in
                                                        {8946}in(c, (=pkCli_7002,em1_7052: bitstring,sigM1_7053: bitstring));
                                                        {8947}let m1_7054: bitstring = dec(em1_7052,skSess_6931) in
                                                        {8948}if (verify(m1_7054,sigM1_7053,pkCli_7002) <> true) then
                                                            0
                                                        else
                                                            {8949}let (SPc_7055: bitstring,PartC_7056: bitstring) = m1_7054 in
                                                            {8950}event endSrv(Cli_5510,Sess_5512,PartC_7056);
                                                            {8951}new Ns_7057: bitstring;
                                                            {8952}let gNs_7058: bitstring = exp(g,Ns_7057) in
                                                            {8953}let m2_7059: bitstring = gNs_7058 in
                                                            {8954}out(c, (enc(m2_7059,pkCli_7002),sign(m2_7059,skSess_6931)));
                                                            {8955}event beginSrv(Sess_5512,Cli_5510,gNs_7058)
                                            )
                                            else
                                                {8956}let pkDisco_7060: bitstring = fail-any in
                                                {8957}in(c, (=pkCli_7002,em1_7061: bitstring,sigM1_7062: bitstring));
                                                {8958}let m1_7063: bitstring = dec(em1_7061,skSess_6931) in
                                                {8959}if (verify(m1_7063,sigM1_7062,pkCli_7002) <> true) then
                                                    0
                                                else
                                                    {8960}let (SPc_7064: bitstring,PartC_7065: bitstring) = m1_7063 in
                                                    {8961}event endSrv(Cli_5510,Sess_5512,PartC_7065);
                                                    {8962}new Ns_7066: bitstring;
                                                    {8963}let gNs_7067: bitstring = exp(g,Ns_7066) in
                                                    {8964}let m2_7068: bitstring = gNs_7067 in
                                                    {8965}out(c, (enc(m2_7068,pkCli_7002),sign(m2_7068,skSess_6931)));
                                                    {8966}event beginSrv(Sess_5512,Cli_5510,gNs_7067)
                                        )
                                        else
                                            {8967}let v_7069: bool = (Cli_5510 = C) in
                                            (
                                                {8968}if v_7069 then
                                                (
                                                    {8969}let pkCli_7070: bitstring = pub(skC) in
                                                    {8970}let v_7071: bool = (Disco_5511 = A) in
                                                    (
                                                        {8971}if v_7071 then
                                                        (
                                                            {8972}let pkDisco_7072: bitstring = pub(skA) in
                                                            {8973}in(c, (=pkCli_7070,em1_7073: bitstring,sigM1_7074: bitstring));
                                                            {8974}let m1_7075: bitstring = dec(em1_7073,skSess_6931) in
                                                            {8975}if (verify(m1_7075,sigM1_7074,pkCli_7070) <> true) then
                                                                0
                                                            else
                                                                {8976}let (SPc_7076: bitstring,PartC_7077: bitstring) = m1_7075 in
                                                                {8977}event endSrv(Cli_5510,Sess_5512,PartC_7077);
                                                                {8978}new Ns_7078: bitstring;
                                                                {8979}let gNs_7079: bitstring = exp(g,Ns_7078) in
                                                                {8980}let m2_7080: bitstring = gNs_7079 in
                                                                {8981}out(c, (enc(m2_7080,pkCli_7070),sign(m2_7080,skSess_6931)));
                                                                {8982}event beginSrv(Sess_5512,Cli_5510,gNs_7079)
                                                        )
                                                        else
                                                            {8983}let v_7081: bool = (Disco_5511 = B) in
                                                            (
                                                                {8984}if v_7081 then
                                                                (
                                                                    {8985}let pkDisco_7082: bitstring = pub(skB) in
                                                                    {8986}in(c, (=pkCli_7070,em1_7083: bitstring,sigM1_7084: bitstring));
                                                                    {8987}let m1_7085: bitstring = dec(em1_7083,skSess_6931) in
                                                                    {8988}if (verify(m1_7085,sigM1_7084,pkCli_7070) <> true) then
                                                                        0
                                                                    else
                                                                        {8989}let (SPc_7086: bitstring,PartC_7087: bitstring) = m1_7085 in
                                                                        {8990}event endSrv(Cli_5510,Sess_5512,PartC_7087);
                                                                        {8991}new Ns_7088: bitstring;
                                                                        {8992}let gNs_7089: bitstring = exp(g,Ns_7088) in
                                                                        {8993}let m2_7090: bitstring = gNs_7089 in
                                                                        {8994}out(c, (enc(m2_7090,pkCli_7070),sign(m2_7090,skSess_6931)));
                                                                        {8995}event beginSrv(Sess_5512,Cli_5510,gNs_7089)
                                                                )
                                                                else
                                                                    {8996}let v_7091: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8997}if v_7091 then
                                                                        (
                                                                            {8998}let pkDisco_7092: bitstring = pub(skC) in
                                                                            {8999}in(c, (=pkCli_7070,em1_7093: bitstring,sigM1_7094: bitstring));
                                                                            {9000}let m1_7095: bitstring = dec(em1_7093,skSess_6931) in
                                                                            {9001}if (verify(m1_7095,sigM1_7094,pkCli_7070) <> true) then
                                                                                0
                                                                            else
                                                                                {9002}let (SPc_7096: bitstring,PartC_7097: bitstring) = m1_7095 in
                                                                                {9003}event endSrv(Cli_5510,Sess_5512,PartC_7097);
                                                                                {9004}new Ns_7098: bitstring;
                                                                                {9005}let gNs_7099: bitstring = exp(g,Ns_7098) in
                                                                                {9006}let m2_7100: bitstring = gNs_7099 in
                                                                                {9007}out(c, (enc(m2_7100,pkCli_7070),sign(m2_7100,skSess_6931)));
                                                                                {9008}event beginSrv(Sess_5512,Cli_5510,gNs_7099)
                                                                        )
                                                                        else
                                                                            {9009}let pkDisco_7101: bitstring = pub(skI) in
                                                                            {9010}in(c, (=pkCli_7070,em1_7102: bitstring,sigM1_7103: bitstring));
                                                                            {9011}let m1_7104: bitstring = dec(em1_7102,skSess_6931) in
                                                                            {9012}if (verify(m1_7104,sigM1_7103,pkCli_7070) <> true) then
                                                                                0
                                                                            else
                                                                                {9013}let (SPc_7105: bitstring,PartC_7106: bitstring) = m1_7104 in
                                                                                {9014}event endSrv(Cli_5510,Sess_5512,PartC_7106);
                                                                                {9015}new Ns_7107: bitstring;
                                                                                {9016}let gNs_7108: bitstring = exp(g,Ns_7107) in
                                                                                {9017}let m2_7109: bitstring = gNs_7108 in
                                                                                {9018}out(c, (enc(m2_7109,pkCli_7070),sign(m2_7109,skSess_6931)));
                                                                                {9019}event beginSrv(Sess_5512,Cli_5510,gNs_7108)
                                                                    )
                                                                    else
                                                                        {9020}let pkDisco_7110: bitstring = fail-any in
                                                                        {9021}in(c, (=pkCli_7070,em1_7111: bitstring,sigM1_7112: bitstring));
                                                                        {9022}let m1_7113: bitstring = dec(em1_7111,skSess_6931) in
                                                                        {9023}if (verify(m1_7113,sigM1_7112,pkCli_7070) <> true) then
                                                                            0
                                                                        else
                                                                            {9024}let (SPc_7114: bitstring,PartC_7115: bitstring) = m1_7113 in
                                                                            {9025}event endSrv(Cli_5510,Sess_5512,PartC_7115);
                                                                            {9026}new Ns_7116: bitstring;
                                                                            {9027}let gNs_7117: bitstring = exp(g,Ns_7116) in
                                                                            {9028}let m2_7118: bitstring = gNs_7117 in
                                                                            {9029}out(c, (enc(m2_7118,pkCli_7070),sign(m2_7118,skSess_6931)));
                                                                            {9030}event beginSrv(Sess_5512,Cli_5510,gNs_7117)
                                                            )
                                                            else
                                                                {9031}let pkDisco_7119: bitstring = fail-any in
                                                                {9032}in(c, (=pkCli_7070,em1_7120: bitstring,sigM1_7121: bitstring));
                                                                {9033}let m1_7122: bitstring = dec(em1_7120,skSess_6931) in
                                                                {9034}if (verify(m1_7122,sigM1_7121,pkCli_7070) <> true) then
                                                                    0
                                                                else
                                                                    {9035}let (SPc_7123: bitstring,PartC_7124: bitstring) = m1_7122 in
                                                                    {9036}event endSrv(Cli_5510,Sess_5512,PartC_7124);
                                                                    {9037}new Ns_7125: bitstring;
                                                                    {9038}let gNs_7126: bitstring = exp(g,Ns_7125) in
                                                                    {9039}let m2_7127: bitstring = gNs_7126 in
                                                                    {9040}out(c, (enc(m2_7127,pkCli_7070),sign(m2_7127,skSess_6931)));
                                                                    {9041}event beginSrv(Sess_5512,Cli_5510,gNs_7126)
                                                    )
                                                    else
                                                        {9042}let pkDisco_7128: bitstring = fail-any in
                                                        {9043}in(c, (=pkCli_7070,em1_7129: bitstring,sigM1_7130: bitstring));
                                                        {9044}let m1_7131: bitstring = dec(em1_7129,skSess_6931) in
                                                        {9045}if (verify(m1_7131,sigM1_7130,pkCli_7070) <> true) then
                                                            0
                                                        else
                                                            {9046}let (SPc_7132: bitstring,PartC_7133: bitstring) = m1_7131 in
                                                            {9047}event endSrv(Cli_5510,Sess_5512,PartC_7133);
                                                            {9048}new Ns_7134: bitstring;
                                                            {9049}let gNs_7135: bitstring = exp(g,Ns_7134) in
                                                            {9050}let m2_7136: bitstring = gNs_7135 in
                                                            {9051}out(c, (enc(m2_7136,pkCli_7070),sign(m2_7136,skSess_6931)));
                                                            {9052}event beginSrv(Sess_5512,Cli_5510,gNs_7135)
                                                )
                                                else
                                                    {9053}let pkCli_7137: bitstring = pub(skI) in
                                                    {9054}let v_7138: bool = (Disco_5511 = A) in
                                                    (
                                                        {9055}if v_7138 then
                                                        (
                                                            {9056}let pkDisco_7139: bitstring = pub(skA) in
                                                            {9057}in(c, (=pkCli_7137,em1_7140: bitstring,sigM1_7141: bitstring));
                                                            {9058}let m1_7142: bitstring = dec(em1_7140,skSess_6931) in
                                                            {9059}if (verify(m1_7142,sigM1_7141,pkCli_7137) <> true) then
                                                                0
                                                            else
                                                                {9060}let (SPc_7143: bitstring,PartC_7144: bitstring) = m1_7142 in
                                                                {9061}event endSrv(Cli_5510,Sess_5512,PartC_7144);
                                                                {9062}new Ns_7145: bitstring;
                                                                {9063}let gNs_7146: bitstring = exp(g,Ns_7145) in
                                                                {9064}let m2_7147: bitstring = gNs_7146 in
                                                                {9065}out(c, (enc(m2_7147,pkCli_7137),sign(m2_7147,skSess_6931)));
                                                                {9066}event beginSrv(Sess_5512,Cli_5510,gNs_7146)
                                                        )
                                                        else
                                                            {9067}let v_7148: bool = (Disco_5511 = B) in
                                                            (
                                                                {9068}if v_7148 then
                                                                (
                                                                    {9069}let pkDisco_7149: bitstring = pub(skB) in
                                                                    {9070}in(c, (=pkCli_7137,em1_7150: bitstring,sigM1_7151: bitstring));
                                                                    {9071}let m1_7152: bitstring = dec(em1_7150,skSess_6931) in
                                                                    {9072}if (verify(m1_7152,sigM1_7151,pkCli_7137) <> true) then
                                                                        0
                                                                    else
                                                                        {9073}let (SPc_7153: bitstring,PartC_7154: bitstring) = m1_7152 in
                                                                        {9074}event endSrv(Cli_5510,Sess_5512,PartC_7154);
                                                                        {9075}new Ns_7155: bitstring;
                                                                        {9076}let gNs_7156: bitstring = exp(g,Ns_7155) in
                                                                        {9077}let m2_7157: bitstring = gNs_7156 in
                                                                        {9078}out(c, (enc(m2_7157,pkCli_7137),sign(m2_7157,skSess_6931)));
                                                                        {9079}event beginSrv(Sess_5512,Cli_5510,gNs_7156)
                                                                )
                                                                else
                                                                    {9080}let v_7158: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {9081}if v_7158 then
                                                                        (
                                                                            {9082}let pkDisco_7159: bitstring = pub(skC) in
                                                                            {9083}in(c, (=pkCli_7137,em1_7160: bitstring,sigM1_7161: bitstring));
                                                                            {9084}let m1_7162: bitstring = dec(em1_7160,skSess_6931) in
                                                                            {9085}if (verify(m1_7162,sigM1_7161,pkCli_7137) <> true) then
                                                                                0
                                                                            else
                                                                                {9086}let (SPc_7163: bitstring,PartC_7164: bitstring) = m1_7162 in
                                                                                {9087}event endSrv(Cli_5510,Sess_5512,PartC_7164);
                                                                                {9088}new Ns_7165: bitstring;
                                                                                {9089}let gNs_7166: bitstring = exp(g,Ns_7165) in
                                                                                {9090}let m2_7167: bitstring = gNs_7166 in
                                                                                {9091}out(c, (enc(m2_7167,pkCli_7137),sign(m2_7167,skSess_6931)));
                                                                                {9092}event beginSrv(Sess_5512,Cli_5510,gNs_7166)
                                                                        )
                                                                        else
                                                                            {9093}let pkDisco_7168: bitstring = pub(skI) in
                                                                            {9094}in(c, (=pkCli_7137,em1_7169: bitstring,sigM1_7170: bitstring));
                                                                            {9095}let m1_7171: bitstring = dec(em1_7169,skSess_6931) in
                                                                            {9096}if (verify(m1_7171,sigM1_7170,pkCli_7137) <> true) then
                                                                                0
                                                                            else
                                                                                {9097}let (SPc_7172: bitstring,PartC_7173: bitstring) = m1_7171 in
                                                                                {9098}event endSrv(Cli_5510,Sess_5512,PartC_7173);
                                                                                {9099}new Ns_7174: bitstring;
                                                                                {9100}let gNs_7175: bitstring = exp(g,Ns_7174) in
                                                                                {9101}let m2_7176: bitstring = gNs_7175 in
                                                                                {9102}out(c, (enc(m2_7176,pkCli_7137),sign(m2_7176,skSess_6931)));
                                                                                {9103}event beginSrv(Sess_5512,Cli_5510,gNs_7175)
                                                                    )
                                                                    else
                                                                        {9104}let pkDisco_7177: bitstring = fail-any in
                                                                        {9105}in(c, (=pkCli_7137,em1_7178: bitstring,sigM1_7179: bitstring));
                                                                        {9106}let m1_7180: bitstring = dec(em1_7178,skSess_6931) in
                                                                        {9107}if (verify(m1_7180,sigM1_7179,pkCli_7137) <> true) then
                                                                            0
                                                                        else
                                                                            {9108}let (SPc_7181: bitstring,PartC_7182: bitstring) = m1_7180 in
                                                                            {9109}event endSrv(Cli_5510,Sess_5512,PartC_7182);
                                                                            {9110}new Ns_7183: bitstring;
                                                                            {9111}let gNs_7184: bitstring = exp(g,Ns_7183) in
                                                                            {9112}let m2_7185: bitstring = gNs_7184 in
                                                                            {9113}out(c, (enc(m2_7185,pkCli_7137),sign(m2_7185,skSess_6931)));
                                                                            {9114}event beginSrv(Sess_5512,Cli_5510,gNs_7184)
                                                            )
                                                            else
                                                                {9115}let pkDisco_7186: bitstring = fail-any in
                                                                {9116}in(c, (=pkCli_7137,em1_7187: bitstring,sigM1_7188: bitstring));
                                                                {9117}let m1_7189: bitstring = dec(em1_7187,skSess_6931) in
                                                                {9118}if (verify(m1_7189,sigM1_7188,pkCli_7137) <> true) then
                                                                    0
                                                                else
                                                                    {9119}let (SPc_7190: bitstring,PartC_7191: bitstring) = m1_7189 in
                                                                    {9120}event endSrv(Cli_5510,Sess_5512,PartC_7191);
                                                                    {9121}new Ns_7192: bitstring;
                                                                    {9122}let gNs_7193: bitstring = exp(g,Ns_7192) in
                                                                    {9123}let m2_7194: bitstring = gNs_7193 in
                                                                    {9124}out(c, (enc(m2_7194,pkCli_7137),sign(m2_7194,skSess_6931)));
                                                                    {9125}event beginSrv(Sess_5512,Cli_5510,gNs_7193)
                                                    )
                                                    else
                                                        {9126}let pkDisco_7195: bitstring = fail-any in
                                                        {9127}in(c, (=pkCli_7137,em1_7196: bitstring,sigM1_7197: bitstring));
                                                        {9128}let m1_7198: bitstring = dec(em1_7196,skSess_6931) in
                                                        {9129}if (verify(m1_7198,sigM1_7197,pkCli_7137) <> true) then
                                                            0
                                                        else
                                                            {9130}let (SPc_7199: bitstring,PartC_7200: bitstring) = m1_7198 in
                                                            {9131}event endSrv(Cli_5510,Sess_5512,PartC_7200);
                                                            {9132}new Ns_7201: bitstring;
                                                            {9133}let gNs_7202: bitstring = exp(g,Ns_7201) in
                                                            {9134}let m2_7203: bitstring = gNs_7202 in
                                                            {9135}out(c, (enc(m2_7203,pkCli_7137),sign(m2_7203,skSess_6931)));
                                                            {9136}event beginSrv(Sess_5512,Cli_5510,gNs_7202)
                                            )
                                            else
                                                {9137}let pkCli_7204: bitstring = fail-any in
                                                {9138}let v_7205: bool = (Disco_5511 = A) in
                                                (
                                                    {9139}if v_7205 then
                                                    (
                                                        {9140}let pkDisco_7206: bitstring = pub(skA) in
                                                        {9141}in(c, (=pkCli_7204,em1_7207: bitstring,sigM1_7208: bitstring));
                                                        {9142}let m1_7209: bitstring = dec(em1_7207,skSess_6931) in
                                                        {9143}if (verify(m1_7209,sigM1_7208,pkCli_7204) <> true) then
                                                            0
                                                        else
                                                            {9144}let (SPc_7210: bitstring,PartC_7211: bitstring) = m1_7209 in
                                                            {9145}event endSrv(Cli_5510,Sess_5512,PartC_7211);
                                                            {9146}new Ns_7212: bitstring;
                                                            {9147}let gNs_7213: bitstring = exp(g,Ns_7212) in
                                                            {9148}let m2_7214: bitstring = gNs_7213 in
                                                            {9149}out(c, (enc(m2_7214,pkCli_7204),sign(m2_7214,skSess_6931)));
                                                            {9150}event beginSrv(Sess_5512,Cli_5510,gNs_7213)
                                                    )
                                                    else
                                                        {9151}let v_7215: bool = (Disco_5511 = B) in
                                                        (
                                                            {9152}if v_7215 then
                                                            (
                                                                {9153}let pkDisco_7216: bitstring = pub(skB) in
                                                                {9154}in(c, (=pkCli_7204,em1_7217: bitstring,sigM1_7218: bitstring));
                                                                {9155}let m1_7219: bitstring = dec(em1_7217,skSess_6931) in
                                                                {9156}if (verify(m1_7219,sigM1_7218,pkCli_7204) <> true) then
                                                                    0
                                                                else
                                                                    {9157}let (SPc_7220: bitstring,PartC_7221: bitstring) = m1_7219 in
                                                                    {9158}event endSrv(Cli_5510,Sess_5512,PartC_7221);
                                                                    {9159}new Ns_7222: bitstring;
                                                                    {9160}let gNs_7223: bitstring = exp(g,Ns_7222) in
                                                                    {9161}let m2_7224: bitstring = gNs_7223 in
                                                                    {9162}out(c, (enc(m2_7224,pkCli_7204),sign(m2_7224,skSess_6931)));
                                                                    {9163}event beginSrv(Sess_5512,Cli_5510,gNs_7223)
                                                            )
                                                            else
                                                                {9164}let v_7225: bool = (Disco_5511 = C) in
                                                                (
                                                                    {9165}if v_7225 then
                                                                    (
                                                                        {9166}let pkDisco_7226: bitstring = pub(skC) in
                                                                        {9167}in(c, (=pkCli_7204,em1_7227: bitstring,sigM1_7228: bitstring));
                                                                        {9168}let m1_7229: bitstring = dec(em1_7227,skSess_6931) in
                                                                        {9169}if (verify(m1_7229,sigM1_7228,pkCli_7204) <> true) then
                                                                            0
                                                                        else
                                                                            {9170}let (SPc_7230: bitstring,PartC_7231: bitstring) = m1_7229 in
                                                                            {9171}event endSrv(Cli_5510,Sess_5512,PartC_7231);
                                                                            {9172}new Ns_7232: bitstring;
                                                                            {9173}let gNs_7233: bitstring = exp(g,Ns_7232) in
                                                                            {9174}let m2_7234: bitstring = gNs_7233 in
                                                                            {9175}out(c, (enc(m2_7234,pkCli_7204),sign(m2_7234,skSess_6931)));
                                                                            {9176}event beginSrv(Sess_5512,Cli_5510,gNs_7233)
                                                                    )
                                                                    else
                                                                        {9177}let pkDisco_7235: bitstring = pub(skI) in
                                                                        {9178}in(c, (=pkCli_7204,em1_7236: bitstring,sigM1_7237: bitstring));
                                                                        {9179}let m1_7238: bitstring = dec(em1_7236,skSess_6931) in
                                                                        {9180}if (verify(m1_7238,sigM1_7237,pkCli_7204) <> true) then
                                                                            0
                                                                        else
                                                                            {9181}let (SPc_7239: bitstring,PartC_7240: bitstring) = m1_7238 in
                                                                            {9182}event endSrv(Cli_5510,Sess_5512,PartC_7240);
                                                                            {9183}new Ns_7241: bitstring;
                                                                            {9184}let gNs_7242: bitstring = exp(g,Ns_7241) in
                                                                            {9185}let m2_7243: bitstring = gNs_7242 in
                                                                            {9186}out(c, (enc(m2_7243,pkCli_7204),sign(m2_7243,skSess_6931)));
                                                                            {9187}event beginSrv(Sess_5512,Cli_5510,gNs_7242)
                                                                )
                                                                else
                                                                    {9188}let pkDisco_7244: bitstring = fail-any in
                                                                    {9189}in(c, (=pkCli_7204,em1_7245: bitstring,sigM1_7246: bitstring));
                                                                    {9190}let m1_7247: bitstring = dec(em1_7245,skSess_6931) in
                                                                    {9191}if (verify(m1_7247,sigM1_7246,pkCli_7204) <> true) then
                                                                        0
                                                                    else
                                                                        {9192}let (SPc_7248: bitstring,PartC_7249: bitstring) = m1_7247 in
                                                                        {9193}event endSrv(Cli_5510,Sess_5512,PartC_7249);
                                                                        {9194}new Ns_7250: bitstring;
                                                                        {9195}let gNs_7251: bitstring = exp(g,Ns_7250) in
                                                                        {9196}let m2_7252: bitstring = gNs_7251 in
                                                                        {9197}out(c, (enc(m2_7252,pkCli_7204),sign(m2_7252,skSess_6931)));
                                                                        {9198}event beginSrv(Sess_5512,Cli_5510,gNs_7251)
                                                        )
                                                        else
                                                            {9199}let pkDisco_7253: bitstring = fail-any in
                                                            {9200}in(c, (=pkCli_7204,em1_7254: bitstring,sigM1_7255: bitstring));
                                                            {9201}let m1_7256: bitstring = dec(em1_7254,skSess_6931) in
                                                            {9202}if (verify(m1_7256,sigM1_7255,pkCli_7204) <> true) then
                                                                0
                                                            else
                                                                {9203}let (SPc_7257: bitstring,PartC_7258: bitstring) = m1_7256 in
                                                                {9204}event endSrv(Cli_5510,Sess_5512,PartC_7258);
                                                                {9205}new Ns_7259: bitstring;
                                                                {9206}let gNs_7260: bitstring = exp(g,Ns_7259) in
                                                                {9207}let m2_7261: bitstring = gNs_7260 in
                                                                {9208}out(c, (enc(m2_7261,pkCli_7204),sign(m2_7261,skSess_6931)));
                                                                {9209}event beginSrv(Sess_5512,Cli_5510,gNs_7260)
                                                )
                                                else
                                                    {9210}let pkDisco_7262: bitstring = fail-any in
                                                    {9211}in(c, (=pkCli_7204,em1_7263: bitstring,sigM1_7264: bitstring));
                                                    {9212}let m1_7265: bitstring = dec(em1_7263,skSess_6931) in
                                                    {9213}if (verify(m1_7265,sigM1_7264,pkCli_7204) <> true) then
                                                        0
                                                    else
                                                        {9214}let (SPc_7266: bitstring,PartC_7267: bitstring) = m1_7265 in
                                                        {9215}event endSrv(Cli_5510,Sess_5512,PartC_7267);
                                                        {9216}new Ns_7268: bitstring;
                                                        {9217}let gNs_7269: bitstring = exp(g,Ns_7268) in
                                                        {9218}let m2_7270: bitstring = gNs_7269 in
                                                        {9219}out(c, (enc(m2_7270,pkCli_7204),sign(m2_7270,skSess_6931)));
                                                        {9220}event beginSrv(Sess_5512,Cli_5510,gNs_7269)
                                    )
                                    else
                                        {9221}let pkCli_7271: bitstring = fail-any in
                                        {9222}let v_7272: bool = (Disco_5511 = A) in
                                        (
                                            {9223}if v_7272 then
                                            (
                                                {9224}let pkDisco_7273: bitstring = pub(skA) in
                                                {9225}in(c, (=pkCli_7271,em1_7274: bitstring,sigM1_7275: bitstring));
                                                {9226}let m1_7276: bitstring = dec(em1_7274,skSess_6931) in
                                                {9227}if (verify(m1_7276,sigM1_7275,pkCli_7271) <> true) then
                                                    0
                                                else
                                                    {9228}let (SPc_7277: bitstring,PartC_7278: bitstring) = m1_7276 in
                                                    {9229}event endSrv(Cli_5510,Sess_5512,PartC_7278);
                                                    {9230}new Ns_7279: bitstring;
                                                    {9231}let gNs_7280: bitstring = exp(g,Ns_7279) in
                                                    {9232}let m2_7281: bitstring = gNs_7280 in
                                                    {9233}out(c, (enc(m2_7281,pkCli_7271),sign(m2_7281,skSess_6931)));
                                                    {9234}event beginSrv(Sess_5512,Cli_5510,gNs_7280)
                                            )
                                            else
                                                {9235}let v_7282: bool = (Disco_5511 = B) in
                                                (
                                                    {9236}if v_7282 then
                                                    (
                                                        {9237}let pkDisco_7283: bitstring = pub(skB) in
                                                        {9238}in(c, (=pkCli_7271,em1_7284: bitstring,sigM1_7285: bitstring));
                                                        {9239}let m1_7286: bitstring = dec(em1_7284,skSess_6931) in
                                                        {9240}if (verify(m1_7286,sigM1_7285,pkCli_7271) <> true) then
                                                            0
                                                        else
                                                            {9241}let (SPc_7287: bitstring,PartC_7288: bitstring) = m1_7286 in
                                                            {9242}event endSrv(Cli_5510,Sess_5512,PartC_7288);
                                                            {9243}new Ns_7289: bitstring;
                                                            {9244}let gNs_7290: bitstring = exp(g,Ns_7289) in
                                                            {9245}let m2_7291: bitstring = gNs_7290 in
                                                            {9246}out(c, (enc(m2_7291,pkCli_7271),sign(m2_7291,skSess_6931)));
                                                            {9247}event beginSrv(Sess_5512,Cli_5510,gNs_7290)
                                                    )
                                                    else
                                                        {9248}let v_7292: bool = (Disco_5511 = C) in
                                                        (
                                                            {9249}if v_7292 then
                                                            (
                                                                {9250}let pkDisco_7293: bitstring = pub(skC) in
                                                                {9251}in(c, (=pkCli_7271,em1_7294: bitstring,sigM1_7295: bitstring));
                                                                {9252}let m1_7296: bitstring = dec(em1_7294,skSess_6931) in
                                                                {9253}if (verify(m1_7296,sigM1_7295,pkCli_7271) <> true) then
                                                                    0
                                                                else
                                                                    {9254}let (SPc_7297: bitstring,PartC_7298: bitstring) = m1_7296 in
                                                                    {9255}event endSrv(Cli_5510,Sess_5512,PartC_7298);
                                                                    {9256}new Ns_7299: bitstring;
                                                                    {9257}let gNs_7300: bitstring = exp(g,Ns_7299) in
                                                                    {9258}let m2_7301: bitstring = gNs_7300 in
                                                                    {9259}out(c, (enc(m2_7301,pkCli_7271),sign(m2_7301,skSess_6931)));
                                                                    {9260}event beginSrv(Sess_5512,Cli_5510,gNs_7300)
                                                            )
                                                            else
                                                                {9261}let pkDisco_7302: bitstring = pub(skI) in
                                                                {9262}in(c, (=pkCli_7271,em1_7303: bitstring,sigM1_7304: bitstring));
                                                                {9263}let m1_7305: bitstring = dec(em1_7303,skSess_6931) in
                                                                {9264}if (verify(m1_7305,sigM1_7304,pkCli_7271) <> true) then
                                                                    0
                                                                else
                                                                    {9265}let (SPc_7306: bitstring,PartC_7307: bitstring) = m1_7305 in
                                                                    {9266}event endSrv(Cli_5510,Sess_5512,PartC_7307);
                                                                    {9267}new Ns_7308: bitstring;
                                                                    {9268}let gNs_7309: bitstring = exp(g,Ns_7308) in
                                                                    {9269}let m2_7310: bitstring = gNs_7309 in
                                                                    {9270}out(c, (enc(m2_7310,pkCli_7271),sign(m2_7310,skSess_6931)));
                                                                    {9271}event beginSrv(Sess_5512,Cli_5510,gNs_7309)
                                                        )
                                                        else
                                                            {9272}let pkDisco_7311: bitstring = fail-any in
                                                            {9273}in(c, (=pkCli_7271,em1_7312: bitstring,sigM1_7313: bitstring));
                                                            {9274}let m1_7314: bitstring = dec(em1_7312,skSess_6931) in
                                                            {9275}if (verify(m1_7314,sigM1_7313,pkCli_7271) <> true) then
                                                                0
                                                            else
                                                                {9276}let (SPc_7315: bitstring,PartC_7316: bitstring) = m1_7314 in
                                                                {9277}event endSrv(Cli_5510,Sess_5512,PartC_7316);
                                                                {9278}new Ns_7317: bitstring;
                                                                {9279}let gNs_7318: bitstring = exp(g,Ns_7317) in
                                                                {9280}let m2_7319: bitstring = gNs_7318 in
                                                                {9281}out(c, (enc(m2_7319,pkCli_7271),sign(m2_7319,skSess_6931)));
                                                                {9282}event beginSrv(Sess_5512,Cli_5510,gNs_7318)
                                                )
                                                else
                                                    {9283}let pkDisco_7320: bitstring = fail-any in
                                                    {9284}in(c, (=pkCli_7271,em1_7321: bitstring,sigM1_7322: bitstring));
                                                    {9285}let m1_7323: bitstring = dec(em1_7321,skSess_6931) in
                                                    {9286}if (verify(m1_7323,sigM1_7322,pkCli_7271) <> true) then
                                                        0
                                                    else
                                                        {9287}let (SPc_7324: bitstring,PartC_7325: bitstring) = m1_7323 in
                                                        {9288}event endSrv(Cli_5510,Sess_5512,PartC_7325);
                                                        {9289}new Ns_7326: bitstring;
                                                        {9290}let gNs_7327: bitstring = exp(g,Ns_7326) in
                                                        {9291}let m2_7328: bitstring = gNs_7327 in
                                                        {9292}out(c, (enc(m2_7328,pkCli_7271),sign(m2_7328,skSess_6931)));
                                                        {9293}event beginSrv(Sess_5512,Cli_5510,gNs_7327)
                                        )
                                        else
                                            {9294}let pkDisco_7329: bitstring = fail-any in
                                            {9295}in(c, (=pkCli_7271,em1_7330: bitstring,sigM1_7331: bitstring));
                                            {9296}let m1_7332: bitstring = dec(em1_7330,skSess_6931) in
                                            {9297}if (verify(m1_7332,sigM1_7331,pkCli_7271) <> true) then
                                                0
                                            else
                                                {9298}let (SPc_7333: bitstring,PartC_7334: bitstring) = m1_7332 in
                                                {9299}event endSrv(Cli_5510,Sess_5512,PartC_7334);
                                                {9300}new Ns_7335: bitstring;
                                                {9301}let gNs_7336: bitstring = exp(g,Ns_7335) in
                                                {9302}let m2_7337: bitstring = gNs_7336 in
                                                {9303}out(c, (enc(m2_7337,pkCli_7271),sign(m2_7337,skSess_6931)));
                                                {9304}event beginSrv(Sess_5512,Cli_5510,gNs_7336)
                            )
                            else
                                {9305}let pkCli_7338: bitstring = fail-any in
                                {9306}let v_7339: bool = (Disco_5511 = A) in
                                (
                                    {9307}if v_7339 then
                                    (
                                        {9308}let pkDisco_7340: bitstring = pub(skA) in
                                        {9309}in(c, (=pkCli_7338,em1_7341: bitstring,sigM1_7342: bitstring));
                                        {9310}let m1_7343: bitstring = dec(em1_7341,skSess_6931) in
                                        {9311}if (verify(m1_7343,sigM1_7342,pkCli_7338) <> true) then
                                            0
                                        else
                                            {9312}let (SPc_7344: bitstring,PartC_7345: bitstring) = m1_7343 in
                                            {9313}event endSrv(Cli_5510,Sess_5512,PartC_7345);
                                            {9314}new Ns_7346: bitstring;
                                            {9315}let gNs_7347: bitstring = exp(g,Ns_7346) in
                                            {9316}let m2_7348: bitstring = gNs_7347 in
                                            {9317}out(c, (enc(m2_7348,pkCli_7338),sign(m2_7348,skSess_6931)));
                                            {9318}event beginSrv(Sess_5512,Cli_5510,gNs_7347)
                                    )
                                    else
                                        {9319}let v_7349: bool = (Disco_5511 = B) in
                                        (
                                            {9320}if v_7349 then
                                            (
                                                {9321}let pkDisco_7350: bitstring = pub(skB) in
                                                {9322}in(c, (=pkCli_7338,em1_7351: bitstring,sigM1_7352: bitstring));
                                                {9323}let m1_7353: bitstring = dec(em1_7351,skSess_6931) in
                                                {9324}if (verify(m1_7353,sigM1_7352,pkCli_7338) <> true) then
                                                    0
                                                else
                                                    {9325}let (SPc_7354: bitstring,PartC_7355: bitstring) = m1_7353 in
                                                    {9326}event endSrv(Cli_5510,Sess_5512,PartC_7355);
                                                    {9327}new Ns_7356: bitstring;
                                                    {9328}let gNs_7357: bitstring = exp(g,Ns_7356) in
                                                    {9329}let m2_7358: bitstring = gNs_7357 in
                                                    {9330}out(c, (enc(m2_7358,pkCli_7338),sign(m2_7358,skSess_6931)));
                                                    {9331}event beginSrv(Sess_5512,Cli_5510,gNs_7357)
                                            )
                                            else
                                                {9332}let v_7359: bool = (Disco_5511 = C) in
                                                (
                                                    {9333}if v_7359 then
                                                    (
                                                        {9334}let pkDisco_7360: bitstring = pub(skC) in
                                                        {9335}in(c, (=pkCli_7338,em1_7361: bitstring,sigM1_7362: bitstring));
                                                        {9336}let m1_7363: bitstring = dec(em1_7361,skSess_6931) in
                                                        {9337}if (verify(m1_7363,sigM1_7362,pkCli_7338) <> true) then
                                                            0
                                                        else
                                                            {9338}let (SPc_7364: bitstring,PartC_7365: bitstring) = m1_7363 in
                                                            {9339}event endSrv(Cli_5510,Sess_5512,PartC_7365);
                                                            {9340}new Ns_7366: bitstring;
                                                            {9341}let gNs_7367: bitstring = exp(g,Ns_7366) in
                                                            {9342}let m2_7368: bitstring = gNs_7367 in
                                                            {9343}out(c, (enc(m2_7368,pkCli_7338),sign(m2_7368,skSess_6931)));
                                                            {9344}event beginSrv(Sess_5512,Cli_5510,gNs_7367)
                                                    )
                                                    else
                                                        {9345}let pkDisco_7369: bitstring = pub(skI) in
                                                        {9346}in(c, (=pkCli_7338,em1_7370: bitstring,sigM1_7371: bitstring));
                                                        {9347}let m1_7372: bitstring = dec(em1_7370,skSess_6931) in
                                                        {9348}if (verify(m1_7372,sigM1_7371,pkCli_7338) <> true) then
                                                            0
                                                        else
                                                            {9349}let (SPc_7373: bitstring,PartC_7374: bitstring) = m1_7372 in
                                                            {9350}event endSrv(Cli_5510,Sess_5512,PartC_7374);
                                                            {9351}new Ns_7375: bitstring;
                                                            {9352}let gNs_7376: bitstring = exp(g,Ns_7375) in
                                                            {9353}let m2_7377: bitstring = gNs_7376 in
                                                            {9354}out(c, (enc(m2_7377,pkCli_7338),sign(m2_7377,skSess_6931)));
                                                            {9355}event beginSrv(Sess_5512,Cli_5510,gNs_7376)
                                                )
                                                else
                                                    {9356}let pkDisco_7378: bitstring = fail-any in
                                                    {9357}in(c, (=pkCli_7338,em1_7379: bitstring,sigM1_7380: bitstring));
                                                    {9358}let m1_7381: bitstring = dec(em1_7379,skSess_6931) in
                                                    {9359}if (verify(m1_7381,sigM1_7380,pkCli_7338) <> true) then
                                                        0
                                                    else
                                                        {9360}let (SPc_7382: bitstring,PartC_7383: bitstring) = m1_7381 in
                                                        {9361}event endSrv(Cli_5510,Sess_5512,PartC_7383);
                                                        {9362}new Ns_7384: bitstring;
                                                        {9363}let gNs_7385: bitstring = exp(g,Ns_7384) in
                                                        {9364}let m2_7386: bitstring = gNs_7385 in
                                                        {9365}out(c, (enc(m2_7386,pkCli_7338),sign(m2_7386,skSess_6931)));
                                                        {9366}event beginSrv(Sess_5512,Cli_5510,gNs_7385)
                                        )
                                        else
                                            {9367}let pkDisco_7387: bitstring = fail-any in
                                            {9368}in(c, (=pkCli_7338,em1_7388: bitstring,sigM1_7389: bitstring));
                                            {9369}let m1_7390: bitstring = dec(em1_7388,skSess_6931) in
                                            {9370}if (verify(m1_7390,sigM1_7389,pkCli_7338) <> true) then
                                                0
                                            else
                                                {9371}let (SPc_7391: bitstring,PartC_7392: bitstring) = m1_7390 in
                                                {9372}event endSrv(Cli_5510,Sess_5512,PartC_7392);
                                                {9373}new Ns_7393: bitstring;
                                                {9374}let gNs_7394: bitstring = exp(g,Ns_7393) in
                                                {9375}let m2_7395: bitstring = gNs_7394 in
                                                {9376}out(c, (enc(m2_7395,pkCli_7338),sign(m2_7395,skSess_6931)));
                                                {9377}event beginSrv(Sess_5512,Cli_5510,gNs_7394)
                                )
                                else
                                    {9378}let pkDisco_7396: bitstring = fail-any in
                                    {9379}in(c, (=pkCli_7338,em1_7397: bitstring,sigM1_7398: bitstring));
                                    {9380}let m1_7399: bitstring = dec(em1_7397,skSess_6931) in
                                    {9381}if (verify(m1_7399,sigM1_7398,pkCli_7338) <> true) then
                                        0
                                    else
                                        {9382}let (SPc_7400: bitstring,PartC_7401: bitstring) = m1_7399 in
                                        {9383}event endSrv(Cli_5510,Sess_5512,PartC_7401);
                                        {9384}new Ns_7402: bitstring;
                                        {9385}let gNs_7403: bitstring = exp(g,Ns_7402) in
                                        {9386}let m2_7404: bitstring = gNs_7403 in
                                        {9387}out(c, (enc(m2_7404,pkCli_7338),sign(m2_7404,skSess_6931)));
                                        {9388}event beginSrv(Sess_5512,Cli_5510,gNs_7403)
                    )
                    else
                        {9389}let skSess_7405: bitstring = fail-any in
                        {9390}let pkSess_7406: bitstring = pub(skSess_7405) in
                        {9391}let v_7407: bool = (Cli_5510 = A) in
                        (
                            {9392}if v_7407 then
                            (
                                {9393}let pkCli_7408: bitstring = pub(skA) in
                                {9394}let v_7409: bool = (Disco_5511 = A) in
                                (
                                    {9395}if v_7409 then
                                    (
                                        {9396}let pkDisco_7410: bitstring = pub(skA) in
                                        {9397}in(c, (=pkCli_7408,em1_7411: bitstring,sigM1_7412: bitstring));
                                        {9398}let m1_7413: bitstring = dec(em1_7411,skSess_7405) in
                                        {9399}if (verify(m1_7413,sigM1_7412,pkCli_7408) <> true) then
                                            0
                                        else
                                            {9400}let (SPc_7414: bitstring,PartC_7415: bitstring) = m1_7413 in
                                            {9401}event endSrv(Cli_5510,Sess_5512,PartC_7415);
                                            {9402}new Ns_7416: bitstring;
                                            {9403}let gNs_7417: bitstring = exp(g,Ns_7416) in
                                            {9404}let m2_7418: bitstring = gNs_7417 in
                                            {9405}out(c, (enc(m2_7418,pkCli_7408),sign(m2_7418,skSess_7405)));
                                            {9406}event beginSrv(Sess_5512,Cli_5510,gNs_7417)
                                    )
                                    else
                                        {9407}let v_7419: bool = (Disco_5511 = B) in
                                        (
                                            {9408}if v_7419 then
                                            (
                                                {9409}let pkDisco_7420: bitstring = pub(skB) in
                                                {9410}in(c, (=pkCli_7408,em1_7421: bitstring,sigM1_7422: bitstring));
                                                {9411}let m1_7423: bitstring = dec(em1_7421,skSess_7405) in
                                                {9412}if (verify(m1_7423,sigM1_7422,pkCli_7408) <> true) then
                                                    0
                                                else
                                                    {9413}let (SPc_7424: bitstring,PartC_7425: bitstring) = m1_7423 in
                                                    {9414}event endSrv(Cli_5510,Sess_5512,PartC_7425);
                                                    {9415}new Ns_7426: bitstring;
                                                    {9416}let gNs_7427: bitstring = exp(g,Ns_7426) in
                                                    {9417}let m2_7428: bitstring = gNs_7427 in
                                                    {9418}out(c, (enc(m2_7428,pkCli_7408),sign(m2_7428,skSess_7405)));
                                                    {9419}event beginSrv(Sess_5512,Cli_5510,gNs_7427)
                                            )
                                            else
                                                {9420}let v_7429: bool = (Disco_5511 = C) in
                                                (
                                                    {9421}if v_7429 then
                                                    (
                                                        {9422}let pkDisco_7430: bitstring = pub(skC) in
                                                        {9423}in(c, (=pkCli_7408,em1_7431: bitstring,sigM1_7432: bitstring));
                                                        {9424}let m1_7433: bitstring = dec(em1_7431,skSess_7405) in
                                                        {9425}if (verify(m1_7433,sigM1_7432,pkCli_7408) <> true) then
                                                            0
                                                        else
                                                            {9426}let (SPc_7434: bitstring,PartC_7435: bitstring) = m1_7433 in
                                                            {9427}event endSrv(Cli_5510,Sess_5512,PartC_7435);
                                                            {9428}new Ns_7436: bitstring;
                                                            {9429}let gNs_7437: bitstring = exp(g,Ns_7436) in
                                                            {9430}let m2_7438: bitstring = gNs_7437 in
                                                            {9431}out(c, (enc(m2_7438,pkCli_7408),sign(m2_7438,skSess_7405)));
                                                            {9432}event beginSrv(Sess_5512,Cli_5510,gNs_7437)
                                                    )
                                                    else
                                                        {9433}let pkDisco_7439: bitstring = pub(skI) in
                                                        {9434}in(c, (=pkCli_7408,em1_7440: bitstring,sigM1_7441: bitstring));
                                                        {9435}let m1_7442: bitstring = dec(em1_7440,skSess_7405) in
                                                        {9436}if (verify(m1_7442,sigM1_7441,pkCli_7408) <> true) then
                                                            0
                                                        else
                                                            {9437}let (SPc_7443: bitstring,PartC_7444: bitstring) = m1_7442 in
                                                            {9438}event endSrv(Cli_5510,Sess_5512,PartC_7444);
                                                            {9439}new Ns_7445: bitstring;
                                                            {9440}let gNs_7446: bitstring = exp(g,Ns_7445) in
                                                            {9441}let m2_7447: bitstring = gNs_7446 in
                                                            {9442}out(c, (enc(m2_7447,pkCli_7408),sign(m2_7447,skSess_7405)));
                                                            {9443}event beginSrv(Sess_5512,Cli_5510,gNs_7446)
                                                )
                                                else
                                                    {9444}let pkDisco_7448: bitstring = fail-any in
                                                    {9445}in(c, (=pkCli_7408,em1_7449: bitstring,sigM1_7450: bitstring));
                                                    {9446}let m1_7451: bitstring = dec(em1_7449,skSess_7405) in
                                                    {9447}if (verify(m1_7451,sigM1_7450,pkCli_7408) <> true) then
                                                        0
                                                    else
                                                        {9448}let (SPc_7452: bitstring,PartC_7453: bitstring) = m1_7451 in
                                                        {9449}event endSrv(Cli_5510,Sess_5512,PartC_7453);
                                                        {9450}new Ns_7454: bitstring;
                                                        {9451}let gNs_7455: bitstring = exp(g,Ns_7454) in
                                                        {9452}let m2_7456: bitstring = gNs_7455 in
                                                        {9453}out(c, (enc(m2_7456,pkCli_7408),sign(m2_7456,skSess_7405)));
                                                        {9454}event beginSrv(Sess_5512,Cli_5510,gNs_7455)
                                        )
                                        else
                                            {9455}let pkDisco_7457: bitstring = fail-any in
                                            {9456}in(c, (=pkCli_7408,em1_7458: bitstring,sigM1_7459: bitstring));
                                            {9457}let m1_7460: bitstring = dec(em1_7458,skSess_7405) in
                                            {9458}if (verify(m1_7460,sigM1_7459,pkCli_7408) <> true) then
                                                0
                                            else
                                                {9459}let (SPc_7461: bitstring,PartC_7462: bitstring) = m1_7460 in
                                                {9460}event endSrv(Cli_5510,Sess_5512,PartC_7462);
                                                {9461}new Ns_7463: bitstring;
                                                {9462}let gNs_7464: bitstring = exp(g,Ns_7463) in
                                                {9463}let m2_7465: bitstring = gNs_7464 in
                                                {9464}out(c, (enc(m2_7465,pkCli_7408),sign(m2_7465,skSess_7405)));
                                                {9465}event beginSrv(Sess_5512,Cli_5510,gNs_7464)
                                )
                                else
                                    {9466}let pkDisco_7466: bitstring = fail-any in
                                    {9467}in(c, (=pkCli_7408,em1_7467: bitstring,sigM1_7468: bitstring));
                                    {9468}let m1_7469: bitstring = dec(em1_7467,skSess_7405) in
                                    {9469}if (verify(m1_7469,sigM1_7468,pkCli_7408) <> true) then
                                        0
                                    else
                                        {9470}let (SPc_7470: bitstring,PartC_7471: bitstring) = m1_7469 in
                                        {9471}event endSrv(Cli_5510,Sess_5512,PartC_7471);
                                        {9472}new Ns_7472: bitstring;
                                        {9473}let gNs_7473: bitstring = exp(g,Ns_7472) in
                                        {9474}let m2_7474: bitstring = gNs_7473 in
                                        {9475}out(c, (enc(m2_7474,pkCli_7408),sign(m2_7474,skSess_7405)));
                                        {9476}event beginSrv(Sess_5512,Cli_5510,gNs_7473)
                            )
                            else
                                {9477}let v_7475: bool = (Cli_5510 = B) in
                                (
                                    {9478}if v_7475 then
                                    (
                                        {9479}let pkCli_7476: bitstring = pub(skB) in
                                        {9480}let v_7477: bool = (Disco_5511 = A) in
                                        (
                                            {9481}if v_7477 then
                                            (
                                                {9482}let pkDisco_7478: bitstring = pub(skA) in
                                                {9483}in(c, (=pkCli_7476,em1_7479: bitstring,sigM1_7480: bitstring));
                                                {9484}let m1_7481: bitstring = dec(em1_7479,skSess_7405) in
                                                {9485}if (verify(m1_7481,sigM1_7480,pkCli_7476) <> true) then
                                                    0
                                                else
                                                    {9486}let (SPc_7482: bitstring,PartC_7483: bitstring) = m1_7481 in
                                                    {9487}event endSrv(Cli_5510,Sess_5512,PartC_7483);
                                                    {9488}new Ns_7484: bitstring;
                                                    {9489}let gNs_7485: bitstring = exp(g,Ns_7484) in
                                                    {9490}let m2_7486: bitstring = gNs_7485 in
                                                    {9491}out(c, (enc(m2_7486,pkCli_7476),sign(m2_7486,skSess_7405)));
                                                    {9492}event beginSrv(Sess_5512,Cli_5510,gNs_7485)
                                            )
                                            else
                                                {9493}let v_7487: bool = (Disco_5511 = B) in
                                                (
                                                    {9494}if v_7487 then
                                                    (
                                                        {9495}let pkDisco_7488: bitstring = pub(skB) in
                                                        {9496}in(c, (=pkCli_7476,em1_7489: bitstring,sigM1_7490: bitstring));
                                                        {9497}let m1_7491: bitstring = dec(em1_7489,skSess_7405) in
                                                        {9498}if (verify(m1_7491,sigM1_7490,pkCli_7476) <> true) then
                                                            0
                                                        else
                                                            {9499}let (SPc_7492: bitstring,PartC_7493: bitstring) = m1_7491 in
                                                            {9500}event endSrv(Cli_5510,Sess_5512,PartC_7493);
                                                            {9501}new Ns_7494: bitstring;
                                                            {9502}let gNs_7495: bitstring = exp(g,Ns_7494) in
                                                            {9503}let m2_7496: bitstring = gNs_7495 in
                                                            {9504}out(c, (enc(m2_7496,pkCli_7476),sign(m2_7496,skSess_7405)));
                                                            {9505}event beginSrv(Sess_5512,Cli_5510,gNs_7495)
                                                    )
                                                    else
                                                        {9506}let v_7497: bool = (Disco_5511 = C) in
                                                        (
                                                            {9507}if v_7497 then
                                                            (
                                                                {9508}let pkDisco_7498: bitstring = pub(skC) in
                                                                {9509}in(c, (=pkCli_7476,em1_7499: bitstring,sigM1_7500: bitstring));
                                                                {9510}let m1_7501: bitstring = dec(em1_7499,skSess_7405) in
                                                                {9511}if (verify(m1_7501,sigM1_7500,pkCli_7476) <> true) then
                                                                    0
                                                                else
                                                                    {9512}let (SPc_7502: bitstring,PartC_7503: bitstring) = m1_7501 in
                                                                    {9513}event endSrv(Cli_5510,Sess_5512,PartC_7503);
                                                                    {9514}new Ns_7504: bitstring;
                                                                    {9515}let gNs_7505: bitstring = exp(g,Ns_7504) in
                                                                    {9516}let m2_7506: bitstring = gNs_7505 in
                                                                    {9517}out(c, (enc(m2_7506,pkCli_7476),sign(m2_7506,skSess_7405)));
                                                                    {9518}event beginSrv(Sess_5512,Cli_5510,gNs_7505)
                                                            )
                                                            else
                                                                {9519}let pkDisco_7507: bitstring = pub(skI) in
                                                                {9520}in(c, (=pkCli_7476,em1_7508: bitstring,sigM1_7509: bitstring));
                                                                {9521}let m1_7510: bitstring = dec(em1_7508,skSess_7405) in
                                                                {9522}if (verify(m1_7510,sigM1_7509,pkCli_7476) <> true) then
                                                                    0
                                                                else
                                                                    {9523}let (SPc_7511: bitstring,PartC_7512: bitstring) = m1_7510 in
                                                                    {9524}event endSrv(Cli_5510,Sess_5512,PartC_7512);
                                                                    {9525}new Ns_7513: bitstring;
                                                                    {9526}let gNs_7514: bitstring = exp(g,Ns_7513) in
                                                                    {9527}let m2_7515: bitstring = gNs_7514 in
                                                                    {9528}out(c, (enc(m2_7515,pkCli_7476),sign(m2_7515,skSess_7405)));
                                                                    {9529}event beginSrv(Sess_5512,Cli_5510,gNs_7514)
                                                        )
                                                        else
                                                            {9530}let pkDisco_7516: bitstring = fail-any in
                                                            {9531}in(c, (=pkCli_7476,em1_7517: bitstring,sigM1_7518: bitstring));
                                                            {9532}let m1_7519: bitstring = dec(em1_7517,skSess_7405) in
                                                            {9533}if (verify(m1_7519,sigM1_7518,pkCli_7476) <> true) then
                                                                0
                                                            else
                                                                {9534}let (SPc_7520: bitstring,PartC_7521: bitstring) = m1_7519 in
                                                                {9535}event endSrv(Cli_5510,Sess_5512,PartC_7521);
                                                                {9536}new Ns_7522: bitstring;
                                                                {9537}let gNs_7523: bitstring = exp(g,Ns_7522) in
                                                                {9538}let m2_7524: bitstring = gNs_7523 in
                                                                {9539}out(c, (enc(m2_7524,pkCli_7476),sign(m2_7524,skSess_7405)));
                                                                {9540}event beginSrv(Sess_5512,Cli_5510,gNs_7523)
                                                )
                                                else
                                                    {9541}let pkDisco_7525: bitstring = fail-any in
                                                    {9542}in(c, (=pkCli_7476,em1_7526: bitstring,sigM1_7527: bitstring));
                                                    {9543}let m1_7528: bitstring = dec(em1_7526,skSess_7405) in
                                                    {9544}if (verify(m1_7528,sigM1_7527,pkCli_7476) <> true) then
                                                        0
                                                    else
                                                        {9545}let (SPc_7529: bitstring,PartC_7530: bitstring) = m1_7528 in
                                                        {9546}event endSrv(Cli_5510,Sess_5512,PartC_7530);
                                                        {9547}new Ns_7531: bitstring;
                                                        {9548}let gNs_7532: bitstring = exp(g,Ns_7531) in
                                                        {9549}let m2_7533: bitstring = gNs_7532 in
                                                        {9550}out(c, (enc(m2_7533,pkCli_7476),sign(m2_7533,skSess_7405)));
                                                        {9551}event beginSrv(Sess_5512,Cli_5510,gNs_7532)
                                        )
                                        else
                                            {9552}let pkDisco_7534: bitstring = fail-any in
                                            {9553}in(c, (=pkCli_7476,em1_7535: bitstring,sigM1_7536: bitstring));
                                            {9554}let m1_7537: bitstring = dec(em1_7535,skSess_7405) in
                                            {9555}if (verify(m1_7537,sigM1_7536,pkCli_7476) <> true) then
                                                0
                                            else
                                                {9556}let (SPc_7538: bitstring,PartC_7539: bitstring) = m1_7537 in
                                                {9557}event endSrv(Cli_5510,Sess_5512,PartC_7539);
                                                {9558}new Ns_7540: bitstring;
                                                {9559}let gNs_7541: bitstring = exp(g,Ns_7540) in
                                                {9560}let m2_7542: bitstring = gNs_7541 in
                                                {9561}out(c, (enc(m2_7542,pkCli_7476),sign(m2_7542,skSess_7405)));
                                                {9562}event beginSrv(Sess_5512,Cli_5510,gNs_7541)
                                    )
                                    else
                                        {9563}let v_7543: bool = (Cli_5510 = C) in
                                        (
                                            {9564}if v_7543 then
                                            (
                                                {9565}let pkCli_7544: bitstring = pub(skC) in
                                                {9566}let v_7545: bool = (Disco_5511 = A) in
                                                (
                                                    {9567}if v_7545 then
                                                    (
                                                        {9568}let pkDisco_7546: bitstring = pub(skA) in
                                                        {9569}in(c, (=pkCli_7544,em1_7547: bitstring,sigM1_7548: bitstring));
                                                        {9570}let m1_7549: bitstring = dec(em1_7547,skSess_7405) in
                                                        {9571}if (verify(m1_7549,sigM1_7548,pkCli_7544) <> true) then
                                                            0
                                                        else
                                                            {9572}let (SPc_7550: bitstring,PartC_7551: bitstring) = m1_7549 in
                                                            {9573}event endSrv(Cli_5510,Sess_5512,PartC_7551);
                                                            {9574}new Ns_7552: bitstring;
                                                            {9575}let gNs_7553: bitstring = exp(g,Ns_7552) in
                                                            {9576}let m2_7554: bitstring = gNs_7553 in
                                                            {9577}out(c, (enc(m2_7554,pkCli_7544),sign(m2_7554,skSess_7405)));
                                                            {9578}event beginSrv(Sess_5512,Cli_5510,gNs_7553)
                                                    )
                                                    else
                                                        {9579}let v_7555: bool = (Disco_5511 = B) in
                                                        (
                                                            {9580}if v_7555 then
                                                            (
                                                                {9581}let pkDisco_7556: bitstring = pub(skB) in
                                                                {9582}in(c, (=pkCli_7544,em1_7557: bitstring,sigM1_7558: bitstring));
                                                                {9583}let m1_7559: bitstring = dec(em1_7557,skSess_7405) in
                                                                {9584}if (verify(m1_7559,sigM1_7558,pkCli_7544) <> true) then
                                                                    0
                                                                else
                                                                    {9585}let (SPc_7560: bitstring,PartC_7561: bitstring) = m1_7559 in
                                                                    {9586}event endSrv(Cli_5510,Sess_5512,PartC_7561);
                                                                    {9587}new Ns_7562: bitstring;
                                                                    {9588}let gNs_7563: bitstring = exp(g,Ns_7562) in
                                                                    {9589}let m2_7564: bitstring = gNs_7563 in
                                                                    {9590}out(c, (enc(m2_7564,pkCli_7544),sign(m2_7564,skSess_7405)));
                                                                    {9591}event beginSrv(Sess_5512,Cli_5510,gNs_7563)
                                                            )
                                                            else
                                                                {9592}let v_7565: bool = (Disco_5511 = C) in
                                                                (
                                                                    {9593}if v_7565 then
                                                                    (
                                                                        {9594}let pkDisco_7566: bitstring = pub(skC) in
                                                                        {9595}in(c, (=pkCli_7544,em1_7567: bitstring,sigM1_7568: bitstring));
                                                                        {9596}let m1_7569: bitstring = dec(em1_7567,skSess_7405) in
                                                                        {9597}if (verify(m1_7569,sigM1_7568,pkCli_7544) <> true) then
                                                                            0
                                                                        else
                                                                            {9598}let (SPc_7570: bitstring,PartC_7571: bitstring) = m1_7569 in
                                                                            {9599}event endSrv(Cli_5510,Sess_5512,PartC_7571);
                                                                            {9600}new Ns_7572: bitstring;
                                                                            {9601}let gNs_7573: bitstring = exp(g,Ns_7572) in
                                                                            {9602}let m2_7574: bitstring = gNs_7573 in
                                                                            {9603}out(c, (enc(m2_7574,pkCli_7544),sign(m2_7574,skSess_7405)));
                                                                            {9604}event beginSrv(Sess_5512,Cli_5510,gNs_7573)
                                                                    )
                                                                    else
                                                                        {9605}let pkDisco_7575: bitstring = pub(skI) in
                                                                        {9606}in(c, (=pkCli_7544,em1_7576: bitstring,sigM1_7577: bitstring));
                                                                        {9607}let m1_7578: bitstring = dec(em1_7576,skSess_7405) in
                                                                        {9608}if (verify(m1_7578,sigM1_7577,pkCli_7544) <> true) then
                                                                            0
                                                                        else
                                                                            {9609}let (SPc_7579: bitstring,PartC_7580: bitstring) = m1_7578 in
                                                                            {9610}event endSrv(Cli_5510,Sess_5512,PartC_7580);
                                                                            {9611}new Ns_7581: bitstring;
                                                                            {9612}let gNs_7582: bitstring = exp(g,Ns_7581) in
                                                                            {9613}let m2_7583: bitstring = gNs_7582 in
                                                                            {9614}out(c, (enc(m2_7583,pkCli_7544),sign(m2_7583,skSess_7405)));
                                                                            {9615}event beginSrv(Sess_5512,Cli_5510,gNs_7582)
                                                                )
                                                                else
                                                                    {9616}let pkDisco_7584: bitstring = fail-any in
                                                                    {9617}in(c, (=pkCli_7544,em1_7585: bitstring,sigM1_7586: bitstring));
                                                                    {9618}let m1_7587: bitstring = dec(em1_7585,skSess_7405) in
                                                                    {9619}if (verify(m1_7587,sigM1_7586,pkCli_7544) <> true) then
                                                                        0
                                                                    else
                                                                        {9620}let (SPc_7588: bitstring,PartC_7589: bitstring) = m1_7587 in
                                                                        {9621}event endSrv(Cli_5510,Sess_5512,PartC_7589);
                                                                        {9622}new Ns_7590: bitstring;
                                                                        {9623}let gNs_7591: bitstring = exp(g,Ns_7590) in
                                                                        {9624}let m2_7592: bitstring = gNs_7591 in
                                                                        {9625}out(c, (enc(m2_7592,pkCli_7544),sign(m2_7592,skSess_7405)));
                                                                        {9626}event beginSrv(Sess_5512,Cli_5510,gNs_7591)
                                                        )
                                                        else
                                                            {9627}let pkDisco_7593: bitstring = fail-any in
                                                            {9628}in(c, (=pkCli_7544,em1_7594: bitstring,sigM1_7595: bitstring));
                                                            {9629}let m1_7596: bitstring = dec(em1_7594,skSess_7405) in
                                                            {9630}if (verify(m1_7596,sigM1_7595,pkCli_7544) <> true) then
                                                                0
                                                            else
                                                                {9631}let (SPc_7597: bitstring,PartC_7598: bitstring) = m1_7596 in
                                                                {9632}event endSrv(Cli_5510,Sess_5512,PartC_7598);
                                                                {9633}new Ns_7599: bitstring;
                                                                {9634}let gNs_7600: bitstring = exp(g,Ns_7599) in
                                                                {9635}let m2_7601: bitstring = gNs_7600 in
                                                                {9636}out(c, (enc(m2_7601,pkCli_7544),sign(m2_7601,skSess_7405)));
                                                                {9637}event beginSrv(Sess_5512,Cli_5510,gNs_7600)
                                                )
                                                else
                                                    {9638}let pkDisco_7602: bitstring = fail-any in
                                                    {9639}in(c, (=pkCli_7544,em1_7603: bitstring,sigM1_7604: bitstring));
                                                    {9640}let m1_7605: bitstring = dec(em1_7603,skSess_7405) in
                                                    {9641}if (verify(m1_7605,sigM1_7604,pkCli_7544) <> true) then
                                                        0
                                                    else
                                                        {9642}let (SPc_7606: bitstring,PartC_7607: bitstring) = m1_7605 in
                                                        {9643}event endSrv(Cli_5510,Sess_5512,PartC_7607);
                                                        {9644}new Ns_7608: bitstring;
                                                        {9645}let gNs_7609: bitstring = exp(g,Ns_7608) in
                                                        {9646}let m2_7610: bitstring = gNs_7609 in
                                                        {9647}out(c, (enc(m2_7610,pkCli_7544),sign(m2_7610,skSess_7405)));
                                                        {9648}event beginSrv(Sess_5512,Cli_5510,gNs_7609)
                                            )
                                            else
                                                {9649}let pkCli_7611: bitstring = pub(skI) in
                                                {9650}let v_7612: bool = (Disco_5511 = A) in
                                                (
                                                    {9651}if v_7612 then
                                                    (
                                                        {9652}let pkDisco_7613: bitstring = pub(skA) in
                                                        {9653}in(c, (=pkCli_7611,em1_7614: bitstring,sigM1_7615: bitstring));
                                                        {9654}let m1_7616: bitstring = dec(em1_7614,skSess_7405) in
                                                        {9655}if (verify(m1_7616,sigM1_7615,pkCli_7611) <> true) then
                                                            0
                                                        else
                                                            {9656}let (SPc_7617: bitstring,PartC_7618: bitstring) = m1_7616 in
                                                            {9657}event endSrv(Cli_5510,Sess_5512,PartC_7618);
                                                            {9658}new Ns_7619: bitstring;
                                                            {9659}let gNs_7620: bitstring = exp(g,Ns_7619) in
                                                            {9660}let m2_7621: bitstring = gNs_7620 in
                                                            {9661}out(c, (enc(m2_7621,pkCli_7611),sign(m2_7621,skSess_7405)));
                                                            {9662}event beginSrv(Sess_5512,Cli_5510,gNs_7620)
                                                    )
                                                    else
                                                        {9663}let v_7622: bool = (Disco_5511 = B) in
                                                        (
                                                            {9664}if v_7622 then
                                                            (
                                                                {9665}let pkDisco_7623: bitstring = pub(skB) in
                                                                {9666}in(c, (=pkCli_7611,em1_7624: bitstring,sigM1_7625: bitstring));
                                                                {9667}let m1_7626: bitstring = dec(em1_7624,skSess_7405) in
                                                                {9668}if (verify(m1_7626,sigM1_7625,pkCli_7611) <> true) then
                                                                    0
                                                                else
                                                                    {9669}let (SPc_7627: bitstring,PartC_7628: bitstring) = m1_7626 in
                                                                    {9670}event endSrv(Cli_5510,Sess_5512,PartC_7628);
                                                                    {9671}new Ns_7629: bitstring;
                                                                    {9672}let gNs_7630: bitstring = exp(g,Ns_7629) in
                                                                    {9673}let m2_7631: bitstring = gNs_7630 in
                                                                    {9674}out(c, (enc(m2_7631,pkCli_7611),sign(m2_7631,skSess_7405)));
                                                                    {9675}event beginSrv(Sess_5512,Cli_5510,gNs_7630)
                                                            )
                                                            else
                                                                {9676}let v_7632: bool = (Disco_5511 = C) in
                                                                (
                                                                    {9677}if v_7632 then
                                                                    (
                                                                        {9678}let pkDisco_7633: bitstring = pub(skC) in
                                                                        {9679}in(c, (=pkCli_7611,em1_7634: bitstring,sigM1_7635: bitstring));
                                                                        {9680}let m1_7636: bitstring = dec(em1_7634,skSess_7405) in
                                                                        {9681}if (verify(m1_7636,sigM1_7635,pkCli_7611) <> true) then
                                                                            0
                                                                        else
                                                                            {9682}let (SPc_7637: bitstring,PartC_7638: bitstring) = m1_7636 in
                                                                            {9683}event endSrv(Cli_5510,Sess_5512,PartC_7638);
                                                                            {9684}new Ns_7639: bitstring;
                                                                            {9685}let gNs_7640: bitstring = exp(g,Ns_7639) in
                                                                            {9686}let m2_7641: bitstring = gNs_7640 in
                                                                            {9687}out(c, (enc(m2_7641,pkCli_7611),sign(m2_7641,skSess_7405)));
                                                                            {9688}event beginSrv(Sess_5512,Cli_5510,gNs_7640)
                                                                    )
                                                                    else
                                                                        {9689}let pkDisco_7642: bitstring = pub(skI) in
                                                                        {9690}in(c, (=pkCli_7611,em1_7643: bitstring,sigM1_7644: bitstring));
                                                                        {9691}let m1_7645: bitstring = dec(em1_7643,skSess_7405) in
                                                                        {9692}if (verify(m1_7645,sigM1_7644,pkCli_7611) <> true) then
                                                                            0
                                                                        else
                                                                            {9693}let (SPc_7646: bitstring,PartC_7647: bitstring) = m1_7645 in
                                                                            {9694}event endSrv(Cli_5510,Sess_5512,PartC_7647);
                                                                            {9695}new Ns_7648: bitstring;
                                                                            {9696}let gNs_7649: bitstring = exp(g,Ns_7648) in
                                                                            {9697}let m2_7650: bitstring = gNs_7649 in
                                                                            {9698}out(c, (enc(m2_7650,pkCli_7611),sign(m2_7650,skSess_7405)));
                                                                            {9699}event beginSrv(Sess_5512,Cli_5510,gNs_7649)
                                                                )
                                                                else
                                                                    {9700}let pkDisco_7651: bitstring = fail-any in
                                                                    {9701}in(c, (=pkCli_7611,em1_7652: bitstring,sigM1_7653: bitstring));
                                                                    {9702}let m1_7654: bitstring = dec(em1_7652,skSess_7405) in
                                                                    {9703}if (verify(m1_7654,sigM1_7653,pkCli_7611) <> true) then
                                                                        0
                                                                    else
                                                                        {9704}let (SPc_7655: bitstring,PartC_7656: bitstring) = m1_7654 in
                                                                        {9705}event endSrv(Cli_5510,Sess_5512,PartC_7656);
                                                                        {9706}new Ns_7657: bitstring;
                                                                        {9707}let gNs_7658: bitstring = exp(g,Ns_7657) in
                                                                        {9708}let m2_7659: bitstring = gNs_7658 in
                                                                        {9709}out(c, (enc(m2_7659,pkCli_7611),sign(m2_7659,skSess_7405)));
                                                                        {9710}event beginSrv(Sess_5512,Cli_5510,gNs_7658)
                                                        )
                                                        else
                                                            {9711}let pkDisco_7660: bitstring = fail-any in
                                                            {9712}in(c, (=pkCli_7611,em1_7661: bitstring,sigM1_7662: bitstring));
                                                            {9713}let m1_7663: bitstring = dec(em1_7661,skSess_7405) in
                                                            {9714}if (verify(m1_7663,sigM1_7662,pkCli_7611) <> true) then
                                                                0
                                                            else
                                                                {9715}let (SPc_7664: bitstring,PartC_7665: bitstring) = m1_7663 in
                                                                {9716}event endSrv(Cli_5510,Sess_5512,PartC_7665);
                                                                {9717}new Ns_7666: bitstring;
                                                                {9718}let gNs_7667: bitstring = exp(g,Ns_7666) in
                                                                {9719}let m2_7668: bitstring = gNs_7667 in
                                                                {9720}out(c, (enc(m2_7668,pkCli_7611),sign(m2_7668,skSess_7405)));
                                                                {9721}event beginSrv(Sess_5512,Cli_5510,gNs_7667)
                                                )
                                                else
                                                    {9722}let pkDisco_7669: bitstring = fail-any in
                                                    {9723}in(c, (=pkCli_7611,em1_7670: bitstring,sigM1_7671: bitstring));
                                                    {9724}let m1_7672: bitstring = dec(em1_7670,skSess_7405) in
                                                    {9725}if (verify(m1_7672,sigM1_7671,pkCli_7611) <> true) then
                                                        0
                                                    else
                                                        {9726}let (SPc_7673: bitstring,PartC_7674: bitstring) = m1_7672 in
                                                        {9727}event endSrv(Cli_5510,Sess_5512,PartC_7674);
                                                        {9728}new Ns_7675: bitstring;
                                                        {9729}let gNs_7676: bitstring = exp(g,Ns_7675) in
                                                        {9730}let m2_7677: bitstring = gNs_7676 in
                                                        {9731}out(c, (enc(m2_7677,pkCli_7611),sign(m2_7677,skSess_7405)));
                                                        {9732}event beginSrv(Sess_5512,Cli_5510,gNs_7676)
                                        )
                                        else
                                            {9733}let pkCli_7678: bitstring = fail-any in
                                            {9734}let v_7679: bool = (Disco_5511 = A) in
                                            (
                                                {9735}if v_7679 then
                                                (
                                                    {9736}let pkDisco_7680: bitstring = pub(skA) in
                                                    {9737}in(c, (=pkCli_7678,em1_7681: bitstring,sigM1_7682: bitstring));
                                                    {9738}let m1_7683: bitstring = dec(em1_7681,skSess_7405) in
                                                    {9739}if (verify(m1_7683,sigM1_7682,pkCli_7678) <> true) then
                                                        0
                                                    else
                                                        {9740}let (SPc_7684: bitstring,PartC_7685: bitstring) = m1_7683 in
                                                        {9741}event endSrv(Cli_5510,Sess_5512,PartC_7685);
                                                        {9742}new Ns_7686: bitstring;
                                                        {9743}let gNs_7687: bitstring = exp(g,Ns_7686) in
                                                        {9744}let m2_7688: bitstring = gNs_7687 in
                                                        {9745}out(c, (enc(m2_7688,pkCli_7678),sign(m2_7688,skSess_7405)));
                                                        {9746}event beginSrv(Sess_5512,Cli_5510,gNs_7687)
                                                )
                                                else
                                                    {9747}let v_7689: bool = (Disco_5511 = B) in
                                                    (
                                                        {9748}if v_7689 then
                                                        (
                                                            {9749}let pkDisco_7690: bitstring = pub(skB) in
                                                            {9750}in(c, (=pkCli_7678,em1_7691: bitstring,sigM1_7692: bitstring));
                                                            {9751}let m1_7693: bitstring = dec(em1_7691,skSess_7405) in
                                                            {9752}if (verify(m1_7693,sigM1_7692,pkCli_7678) <> true) then
                                                                0
                                                            else
                                                                {9753}let (SPc_7694: bitstring,PartC_7695: bitstring) = m1_7693 in
                                                                {9754}event endSrv(Cli_5510,Sess_5512,PartC_7695);
                                                                {9755}new Ns_7696: bitstring;
                                                                {9756}let gNs_7697: bitstring = exp(g,Ns_7696) in
                                                                {9757}let m2_7698: bitstring = gNs_7697 in
                                                                {9758}out(c, (enc(m2_7698,pkCli_7678),sign(m2_7698,skSess_7405)));
                                                                {9759}event beginSrv(Sess_5512,Cli_5510,gNs_7697)
                                                        )
                                                        else
                                                            {9760}let v_7699: bool = (Disco_5511 = C) in
                                                            (
                                                                {9761}if v_7699 then
                                                                (
                                                                    {9762}let pkDisco_7700: bitstring = pub(skC) in
                                                                    {9763}in(c, (=pkCli_7678,em1_7701: bitstring,sigM1_7702: bitstring));
                                                                    {9764}let m1_7703: bitstring = dec(em1_7701,skSess_7405) in
                                                                    {9765}if (verify(m1_7703,sigM1_7702,pkCli_7678) <> true) then
                                                                        0
                                                                    else
                                                                        {9766}let (SPc_7704: bitstring,PartC_7705: bitstring) = m1_7703 in
                                                                        {9767}event endSrv(Cli_5510,Sess_5512,PartC_7705);
                                                                        {9768}new Ns_7706: bitstring;
                                                                        {9769}let gNs_7707: bitstring = exp(g,Ns_7706) in
                                                                        {9770}let m2_7708: bitstring = gNs_7707 in
                                                                        {9771}out(c, (enc(m2_7708,pkCli_7678),sign(m2_7708,skSess_7405)));
                                                                        {9772}event beginSrv(Sess_5512,Cli_5510,gNs_7707)
                                                                )
                                                                else
                                                                    {9773}let pkDisco_7709: bitstring = pub(skI) in
                                                                    {9774}in(c, (=pkCli_7678,em1_7710: bitstring,sigM1_7711: bitstring));
                                                                    {9775}let m1_7712: bitstring = dec(em1_7710,skSess_7405) in
                                                                    {9776}if (verify(m1_7712,sigM1_7711,pkCli_7678) <> true) then
                                                                        0
                                                                    else
                                                                        {9777}let (SPc_7713: bitstring,PartC_7714: bitstring) = m1_7712 in
                                                                        {9778}event endSrv(Cli_5510,Sess_5512,PartC_7714);
                                                                        {9779}new Ns_7715: bitstring;
                                                                        {9780}let gNs_7716: bitstring = exp(g,Ns_7715) in
                                                                        {9781}let m2_7717: bitstring = gNs_7716 in
                                                                        {9782}out(c, (enc(m2_7717,pkCli_7678),sign(m2_7717,skSess_7405)));
                                                                        {9783}event beginSrv(Sess_5512,Cli_5510,gNs_7716)
                                                            )
                                                            else
                                                                {9784}let pkDisco_7718: bitstring = fail-any in
                                                                {9785}in(c, (=pkCli_7678,em1_7719: bitstring,sigM1_7720: bitstring));
                                                                {9786}let m1_7721: bitstring = dec(em1_7719,skSess_7405) in
                                                                {9787}if (verify(m1_7721,sigM1_7720,pkCli_7678) <> true) then
                                                                    0
                                                                else
                                                                    {9788}let (SPc_7722: bitstring,PartC_7723: bitstring) = m1_7721 in
                                                                    {9789}event endSrv(Cli_5510,Sess_5512,PartC_7723);
                                                                    {9790}new Ns_7724: bitstring;
                                                                    {9791}let gNs_7725: bitstring = exp(g,Ns_7724) in
                                                                    {9792}let m2_7726: bitstring = gNs_7725 in
                                                                    {9793}out(c, (enc(m2_7726,pkCli_7678),sign(m2_7726,skSess_7405)));
                                                                    {9794}event beginSrv(Sess_5512,Cli_5510,gNs_7725)
                                                    )
                                                    else
                                                        {9795}let pkDisco_7727: bitstring = fail-any in
                                                        {9796}in(c, (=pkCli_7678,em1_7728: bitstring,sigM1_7729: bitstring));
                                                        {9797}let m1_7730: bitstring = dec(em1_7728,skSess_7405) in
                                                        {9798}if (verify(m1_7730,sigM1_7729,pkCli_7678) <> true) then
                                                            0
                                                        else
                                                            {9799}let (SPc_7731: bitstring,PartC_7732: bitstring) = m1_7730 in
                                                            {9800}event endSrv(Cli_5510,Sess_5512,PartC_7732);
                                                            {9801}new Ns_7733: bitstring;
                                                            {9802}let gNs_7734: bitstring = exp(g,Ns_7733) in
                                                            {9803}let m2_7735: bitstring = gNs_7734 in
                                                            {9804}out(c, (enc(m2_7735,pkCli_7678),sign(m2_7735,skSess_7405)));
                                                            {9805}event beginSrv(Sess_5512,Cli_5510,gNs_7734)
                                            )
                                            else
                                                {9806}let pkDisco_7736: bitstring = fail-any in
                                                {9807}in(c, (=pkCli_7678,em1_7737: bitstring,sigM1_7738: bitstring));
                                                {9808}let m1_7739: bitstring = dec(em1_7737,skSess_7405) in
                                                {9809}if (verify(m1_7739,sigM1_7738,pkCli_7678) <> true) then
                                                    0
                                                else
                                                    {9810}let (SPc_7740: bitstring,PartC_7741: bitstring) = m1_7739 in
                                                    {9811}event endSrv(Cli_5510,Sess_5512,PartC_7741);
                                                    {9812}new Ns_7742: bitstring;
                                                    {9813}let gNs_7743: bitstring = exp(g,Ns_7742) in
                                                    {9814}let m2_7744: bitstring = gNs_7743 in
                                                    {9815}out(c, (enc(m2_7744,pkCli_7678),sign(m2_7744,skSess_7405)));
                                                    {9816}event beginSrv(Sess_5512,Cli_5510,gNs_7743)
                                )
                                else
                                    {9817}let pkCli_7745: bitstring = fail-any in
                                    {9818}let v_7746: bool = (Disco_5511 = A) in
                                    (
                                        {9819}if v_7746 then
                                        (
                                            {9820}let pkDisco_7747: bitstring = pub(skA) in
                                            {9821}in(c, (=pkCli_7745,em1_7748: bitstring,sigM1_7749: bitstring));
                                            {9822}let m1_7750: bitstring = dec(em1_7748,skSess_7405) in
                                            {9823}if (verify(m1_7750,sigM1_7749,pkCli_7745) <> true) then
                                                0
                                            else
                                                {9824}let (SPc_7751: bitstring,PartC_7752: bitstring) = m1_7750 in
                                                {9825}event endSrv(Cli_5510,Sess_5512,PartC_7752);
                                                {9826}new Ns_7753: bitstring;
                                                {9827}let gNs_7754: bitstring = exp(g,Ns_7753) in
                                                {9828}let m2_7755: bitstring = gNs_7754 in
                                                {9829}out(c, (enc(m2_7755,pkCli_7745),sign(m2_7755,skSess_7405)));
                                                {9830}event beginSrv(Sess_5512,Cli_5510,gNs_7754)
                                        )
                                        else
                                            {9831}let v_7756: bool = (Disco_5511 = B) in
                                            (
                                                {9832}if v_7756 then
                                                (
                                                    {9833}let pkDisco_7757: bitstring = pub(skB) in
                                                    {9834}in(c, (=pkCli_7745,em1_7758: bitstring,sigM1_7759: bitstring));
                                                    {9835}let m1_7760: bitstring = dec(em1_7758,skSess_7405) in
                                                    {9836}if (verify(m1_7760,sigM1_7759,pkCli_7745) <> true) then
                                                        0
                                                    else
                                                        {9837}let (SPc_7761: bitstring,PartC_7762: bitstring) = m1_7760 in
                                                        {9838}event endSrv(Cli_5510,Sess_5512,PartC_7762);
                                                        {9839}new Ns_7763: bitstring;
                                                        {9840}let gNs_7764: bitstring = exp(g,Ns_7763) in
                                                        {9841}let m2_7765: bitstring = gNs_7764 in
                                                        {9842}out(c, (enc(m2_7765,pkCli_7745),sign(m2_7765,skSess_7405)));
                                                        {9843}event beginSrv(Sess_5512,Cli_5510,gNs_7764)
                                                )
                                                else
                                                    {9844}let v_7766: bool = (Disco_5511 = C) in
                                                    (
                                                        {9845}if v_7766 then
                                                        (
                                                            {9846}let pkDisco_7767: bitstring = pub(skC) in
                                                            {9847}in(c, (=pkCli_7745,em1_7768: bitstring,sigM1_7769: bitstring));
                                                            {9848}let m1_7770: bitstring = dec(em1_7768,skSess_7405) in
                                                            {9849}if (verify(m1_7770,sigM1_7769,pkCli_7745) <> true) then
                                                                0
                                                            else
                                                                {9850}let (SPc_7771: bitstring,PartC_7772: bitstring) = m1_7770 in
                                                                {9851}event endSrv(Cli_5510,Sess_5512,PartC_7772);
                                                                {9852}new Ns_7773: bitstring;
                                                                {9853}let gNs_7774: bitstring = exp(g,Ns_7773) in
                                                                {9854}let m2_7775: bitstring = gNs_7774 in
                                                                {9855}out(c, (enc(m2_7775,pkCli_7745),sign(m2_7775,skSess_7405)));
                                                                {9856}event beginSrv(Sess_5512,Cli_5510,gNs_7774)
                                                        )
                                                        else
                                                            {9857}let pkDisco_7776: bitstring = pub(skI) in
                                                            {9858}in(c, (=pkCli_7745,em1_7777: bitstring,sigM1_7778: bitstring));
                                                            {9859}let m1_7779: bitstring = dec(em1_7777,skSess_7405) in
                                                            {9860}if (verify(m1_7779,sigM1_7778,pkCli_7745) <> true) then
                                                                0
                                                            else
                                                                {9861}let (SPc_7780: bitstring,PartC_7781: bitstring) = m1_7779 in
                                                                {9862}event endSrv(Cli_5510,Sess_5512,PartC_7781);
                                                                {9863}new Ns_7782: bitstring;
                                                                {9864}let gNs_7783: bitstring = exp(g,Ns_7782) in
                                                                {9865}let m2_7784: bitstring = gNs_7783 in
                                                                {9866}out(c, (enc(m2_7784,pkCli_7745),sign(m2_7784,skSess_7405)));
                                                                {9867}event beginSrv(Sess_5512,Cli_5510,gNs_7783)
                                                    )
                                                    else
                                                        {9868}let pkDisco_7785: bitstring = fail-any in
                                                        {9869}in(c, (=pkCli_7745,em1_7786: bitstring,sigM1_7787: bitstring));
                                                        {9870}let m1_7788: bitstring = dec(em1_7786,skSess_7405) in
                                                        {9871}if (verify(m1_7788,sigM1_7787,pkCli_7745) <> true) then
                                                            0
                                                        else
                                                            {9872}let (SPc_7789: bitstring,PartC_7790: bitstring) = m1_7788 in
                                                            {9873}event endSrv(Cli_5510,Sess_5512,PartC_7790);
                                                            {9874}new Ns_7791: bitstring;
                                                            {9875}let gNs_7792: bitstring = exp(g,Ns_7791) in
                                                            {9876}let m2_7793: bitstring = gNs_7792 in
                                                            {9877}out(c, (enc(m2_7793,pkCli_7745),sign(m2_7793,skSess_7405)));
                                                            {9878}event beginSrv(Sess_5512,Cli_5510,gNs_7792)
                                            )
                                            else
                                                {9879}let pkDisco_7794: bitstring = fail-any in
                                                {9880}in(c, (=pkCli_7745,em1_7795: bitstring,sigM1_7796: bitstring));
                                                {9881}let m1_7797: bitstring = dec(em1_7795,skSess_7405) in
                                                {9882}if (verify(m1_7797,sigM1_7796,pkCli_7745) <> true) then
                                                    0
                                                else
                                                    {9883}let (SPc_7798: bitstring,PartC_7799: bitstring) = m1_7797 in
                                                    {9884}event endSrv(Cli_5510,Sess_5512,PartC_7799);
                                                    {9885}new Ns_7800: bitstring;
                                                    {9886}let gNs_7801: bitstring = exp(g,Ns_7800) in
                                                    {9887}let m2_7802: bitstring = gNs_7801 in
                                                    {9888}out(c, (enc(m2_7802,pkCli_7745),sign(m2_7802,skSess_7405)));
                                                    {9889}event beginSrv(Sess_5512,Cli_5510,gNs_7801)
                                    )
                                    else
                                        {9890}let pkDisco_7803: bitstring = fail-any in
                                        {9891}in(c, (=pkCli_7745,em1_7804: bitstring,sigM1_7805: bitstring));
                                        {9892}let m1_7806: bitstring = dec(em1_7804,skSess_7405) in
                                        {9893}if (verify(m1_7806,sigM1_7805,pkCli_7745) <> true) then
                                            0
                                        else
                                            {9894}let (SPc_7807: bitstring,PartC_7808: bitstring) = m1_7806 in
                                            {9895}event endSrv(Cli_5510,Sess_5512,PartC_7808);
                                            {9896}new Ns_7809: bitstring;
                                            {9897}let gNs_7810: bitstring = exp(g,Ns_7809) in
                                            {9898}let m2_7811: bitstring = gNs_7810 in
                                            {9899}out(c, (enc(m2_7811,pkCli_7745),sign(m2_7811,skSess_7405)));
                                            {9900}event beginSrv(Sess_5512,Cli_5510,gNs_7810)
                        )
                        else
                            {9901}let pkCli_7812: bitstring = fail-any in
                            {9902}let v_7813: bool = (Disco_5511 = A) in
                            (
                                {9903}if v_7813 then
                                (
                                    {9904}let pkDisco_7814: bitstring = pub(skA) in
                                    {9905}in(c, (=pkCli_7812,em1_7815: bitstring,sigM1_7816: bitstring));
                                    {9906}let m1_7817: bitstring = dec(em1_7815,skSess_7405) in
                                    {9907}if (verify(m1_7817,sigM1_7816,pkCli_7812) <> true) then
                                        0
                                    else
                                        {9908}let (SPc_7818: bitstring,PartC_7819: bitstring) = m1_7817 in
                                        {9909}event endSrv(Cli_5510,Sess_5512,PartC_7819);
                                        {9910}new Ns_7820: bitstring;
                                        {9911}let gNs_7821: bitstring = exp(g,Ns_7820) in
                                        {9912}let m2_7822: bitstring = gNs_7821 in
                                        {9913}out(c, (enc(m2_7822,pkCli_7812),sign(m2_7822,skSess_7405)));
                                        {9914}event beginSrv(Sess_5512,Cli_5510,gNs_7821)
                                )
                                else
                                    {9915}let v_7823: bool = (Disco_5511 = B) in
                                    (
                                        {9916}if v_7823 then
                                        (
                                            {9917}let pkDisco_7824: bitstring = pub(skB) in
                                            {9918}in(c, (=pkCli_7812,em1_7825: bitstring,sigM1_7826: bitstring));
                                            {9919}let m1_7827: bitstring = dec(em1_7825,skSess_7405) in
                                            {9920}if (verify(m1_7827,sigM1_7826,pkCli_7812) <> true) then
                                                0
                                            else
                                                {9921}let (SPc_7828: bitstring,PartC_7829: bitstring) = m1_7827 in
                                                {9922}event endSrv(Cli_5510,Sess_5512,PartC_7829);
                                                {9923}new Ns_7830: bitstring;
                                                {9924}let gNs_7831: bitstring = exp(g,Ns_7830) in
                                                {9925}let m2_7832: bitstring = gNs_7831 in
                                                {9926}out(c, (enc(m2_7832,pkCli_7812),sign(m2_7832,skSess_7405)));
                                                {9927}event beginSrv(Sess_5512,Cli_5510,gNs_7831)
                                        )
                                        else
                                            {9928}let v_7833: bool = (Disco_5511 = C) in
                                            (
                                                {9929}if v_7833 then
                                                (
                                                    {9930}let pkDisco_7834: bitstring = pub(skC) in
                                                    {9931}in(c, (=pkCli_7812,em1_7835: bitstring,sigM1_7836: bitstring));
                                                    {9932}let m1_7837: bitstring = dec(em1_7835,skSess_7405) in
                                                    {9933}if (verify(m1_7837,sigM1_7836,pkCli_7812) <> true) then
                                                        0
                                                    else
                                                        {9934}let (SPc_7838: bitstring,PartC_7839: bitstring) = m1_7837 in
                                                        {9935}event endSrv(Cli_5510,Sess_5512,PartC_7839);
                                                        {9936}new Ns_7840: bitstring;
                                                        {9937}let gNs_7841: bitstring = exp(g,Ns_7840) in
                                                        {9938}let m2_7842: bitstring = gNs_7841 in
                                                        {9939}out(c, (enc(m2_7842,pkCli_7812),sign(m2_7842,skSess_7405)));
                                                        {9940}event beginSrv(Sess_5512,Cli_5510,gNs_7841)
                                                )
                                                else
                                                    {9941}let pkDisco_7843: bitstring = pub(skI) in
                                                    {9942}in(c, (=pkCli_7812,em1_7844: bitstring,sigM1_7845: bitstring));
                                                    {9943}let m1_7846: bitstring = dec(em1_7844,skSess_7405) in
                                                    {9944}if (verify(m1_7846,sigM1_7845,pkCli_7812) <> true) then
                                                        0
                                                    else
                                                        {9945}let (SPc_7847: bitstring,PartC_7848: bitstring) = m1_7846 in
                                                        {9946}event endSrv(Cli_5510,Sess_5512,PartC_7848);
                                                        {9947}new Ns_7849: bitstring;
                                                        {9948}let gNs_7850: bitstring = exp(g,Ns_7849) in
                                                        {9949}let m2_7851: bitstring = gNs_7850 in
                                                        {9950}out(c, (enc(m2_7851,pkCli_7812),sign(m2_7851,skSess_7405)));
                                                        {9951}event beginSrv(Sess_5512,Cli_5510,gNs_7850)
                                            )
                                            else
                                                {9952}let pkDisco_7852: bitstring = fail-any in
                                                {9953}in(c, (=pkCli_7812,em1_7853: bitstring,sigM1_7854: bitstring));
                                                {9954}let m1_7855: bitstring = dec(em1_7853,skSess_7405) in
                                                {9955}if (verify(m1_7855,sigM1_7854,pkCli_7812) <> true) then
                                                    0
                                                else
                                                    {9956}let (SPc_7856: bitstring,PartC_7857: bitstring) = m1_7855 in
                                                    {9957}event endSrv(Cli_5510,Sess_5512,PartC_7857);
                                                    {9958}new Ns_7858: bitstring;
                                                    {9959}let gNs_7859: bitstring = exp(g,Ns_7858) in
                                                    {9960}let m2_7860: bitstring = gNs_7859 in
                                                    {9961}out(c, (enc(m2_7860,pkCli_7812),sign(m2_7860,skSess_7405)));
                                                    {9962}event beginSrv(Sess_5512,Cli_5510,gNs_7859)
                                    )
                                    else
                                        {9963}let pkDisco_7861: bitstring = fail-any in
                                        {9964}in(c, (=pkCli_7812,em1_7862: bitstring,sigM1_7863: bitstring));
                                        {9965}let m1_7864: bitstring = dec(em1_7862,skSess_7405) in
                                        {9966}if (verify(m1_7864,sigM1_7863,pkCli_7812) <> true) then
                                            0
                                        else
                                            {9967}let (SPc_7865: bitstring,PartC_7866: bitstring) = m1_7864 in
                                            {9968}event endSrv(Cli_5510,Sess_5512,PartC_7866);
                                            {9969}new Ns_7867: bitstring;
                                            {9970}let gNs_7868: bitstring = exp(g,Ns_7867) in
                                            {9971}let m2_7869: bitstring = gNs_7868 in
                                            {9972}out(c, (enc(m2_7869,pkCli_7812),sign(m2_7869,skSess_7405)));
                                            {9973}event beginSrv(Sess_5512,Cli_5510,gNs_7868)
                            )
                            else
                                {9974}let pkDisco_7870: bitstring = fail-any in
                                {9975}in(c, (=pkCli_7812,em1_7871: bitstring,sigM1_7872: bitstring));
                                {9976}let m1_7873: bitstring = dec(em1_7871,skSess_7405) in
                                {9977}if (verify(m1_7873,sigM1_7872,pkCli_7812) <> true) then
                                    0
                                else
                                    {9978}let (SPc_7874: bitstring,PartC_7875: bitstring) = m1_7873 in
                                    {9979}event endSrv(Cli_5510,Sess_5512,PartC_7875);
                                    {9980}new Ns_7876: bitstring;
                                    {9981}let gNs_7877: bitstring = exp(g,Ns_7876) in
                                    {9982}let m2_7878: bitstring = gNs_7877 in
                                    {9983}out(c, (enc(m2_7878,pkCli_7812),sign(m2_7878,skSess_7405)));
                                    {9984}event beginSrv(Sess_5512,Cli_5510,gNs_7877)
            )
            else
                {9985}let skSess_7879: bitstring = fail-any in
                {9986}let pkSess_7880: bitstring = pub(skSess_7879) in
                {9987}let v_7881: bool = (Cli_5510 = A) in
                (
                    {9988}if v_7881 then
                    (
                        {9989}let pkCli_7882: bitstring = pub(skA) in
                        {9990}let v_7883: bool = (Disco_5511 = A) in
                        (
                            {9991}if v_7883 then
                            (
                                {9992}let pkDisco_7884: bitstring = pub(skA) in
                                {9993}in(c, (=pkCli_7882,em1_7885: bitstring,sigM1_7886: bitstring));
                                {9994}let m1_7887: bitstring = dec(em1_7885,skSess_7879) in
                                {9995}if (verify(m1_7887,sigM1_7886,pkCli_7882) <> true) then
                                    0
                                else
                                    {9996}let (SPc_7888: bitstring,PartC_7889: bitstring) = m1_7887 in
                                    {9997}event endSrv(Cli_5510,Sess_5512,PartC_7889);
                                    {9998}new Ns_7890: bitstring;
                                    {9999}let gNs_7891: bitstring = exp(g,Ns_7890) in
                                    {10000}let m2_7892: bitstring = gNs_7891 in
                                    {10001}out(c, (enc(m2_7892,pkCli_7882),sign(m2_7892,skSess_7879)));
                                    {10002}event beginSrv(Sess_5512,Cli_5510,gNs_7891)
                            )
                            else
                                {10003}let v_7893: bool = (Disco_5511 = B) in
                                (
                                    {10004}if v_7893 then
                                    (
                                        {10005}let pkDisco_7894: bitstring = pub(skB) in
                                        {10006}in(c, (=pkCli_7882,em1_7895: bitstring,sigM1_7896: bitstring));
                                        {10007}let m1_7897: bitstring = dec(em1_7895,skSess_7879) in
                                        {10008}if (verify(m1_7897,sigM1_7896,pkCli_7882) <> true) then
                                            0
                                        else
                                            {10009}let (SPc_7898: bitstring,PartC_7899: bitstring) = m1_7897 in
                                            {10010}event endSrv(Cli_5510,Sess_5512,PartC_7899);
                                            {10011}new Ns_7900: bitstring;
                                            {10012}let gNs_7901: bitstring = exp(g,Ns_7900) in
                                            {10013}let m2_7902: bitstring = gNs_7901 in
                                            {10014}out(c, (enc(m2_7902,pkCli_7882),sign(m2_7902,skSess_7879)));
                                            {10015}event beginSrv(Sess_5512,Cli_5510,gNs_7901)
                                    )
                                    else
                                        {10016}let v_7903: bool = (Disco_5511 = C) in
                                        (
                                            {10017}if v_7903 then
                                            (
                                                {10018}let pkDisco_7904: bitstring = pub(skC) in
                                                {10019}in(c, (=pkCli_7882,em1_7905: bitstring,sigM1_7906: bitstring));
                                                {10020}let m1_7907: bitstring = dec(em1_7905,skSess_7879) in
                                                {10021}if (verify(m1_7907,sigM1_7906,pkCli_7882) <> true) then
                                                    0
                                                else
                                                    {10022}let (SPc_7908: bitstring,PartC_7909: bitstring) = m1_7907 in
                                                    {10023}event endSrv(Cli_5510,Sess_5512,PartC_7909);
                                                    {10024}new Ns_7910: bitstring;
                                                    {10025}let gNs_7911: bitstring = exp(g,Ns_7910) in
                                                    {10026}let m2_7912: bitstring = gNs_7911 in
                                                    {10027}out(c, (enc(m2_7912,pkCli_7882),sign(m2_7912,skSess_7879)));
                                                    {10028}event beginSrv(Sess_5512,Cli_5510,gNs_7911)
                                            )
                                            else
                                                {10029}let pkDisco_7913: bitstring = pub(skI) in
                                                {10030}in(c, (=pkCli_7882,em1_7914: bitstring,sigM1_7915: bitstring));
                                                {10031}let m1_7916: bitstring = dec(em1_7914,skSess_7879) in
                                                {10032}if (verify(m1_7916,sigM1_7915,pkCli_7882) <> true) then
                                                    0
                                                else
                                                    {10033}let (SPc_7917: bitstring,PartC_7918: bitstring) = m1_7916 in
                                                    {10034}event endSrv(Cli_5510,Sess_5512,PartC_7918);
                                                    {10035}new Ns_7919: bitstring;
                                                    {10036}let gNs_7920: bitstring = exp(g,Ns_7919) in
                                                    {10037}let m2_7921: bitstring = gNs_7920 in
                                                    {10038}out(c, (enc(m2_7921,pkCli_7882),sign(m2_7921,skSess_7879)));
                                                    {10039}event beginSrv(Sess_5512,Cli_5510,gNs_7920)
                                        )
                                        else
                                            {10040}let pkDisco_7922: bitstring = fail-any in
                                            {10041}in(c, (=pkCli_7882,em1_7923: bitstring,sigM1_7924: bitstring));
                                            {10042}let m1_7925: bitstring = dec(em1_7923,skSess_7879) in
                                            {10043}if (verify(m1_7925,sigM1_7924,pkCli_7882) <> true) then
                                                0
                                            else
                                                {10044}let (SPc_7926: bitstring,PartC_7927: bitstring) = m1_7925 in
                                                {10045}event endSrv(Cli_5510,Sess_5512,PartC_7927);
                                                {10046}new Ns_7928: bitstring;
                                                {10047}let gNs_7929: bitstring = exp(g,Ns_7928) in
                                                {10048}let m2_7930: bitstring = gNs_7929 in
                                                {10049}out(c, (enc(m2_7930,pkCli_7882),sign(m2_7930,skSess_7879)));
                                                {10050}event beginSrv(Sess_5512,Cli_5510,gNs_7929)
                                )
                                else
                                    {10051}let pkDisco_7931: bitstring = fail-any in
                                    {10052}in(c, (=pkCli_7882,em1_7932: bitstring,sigM1_7933: bitstring));
                                    {10053}let m1_7934: bitstring = dec(em1_7932,skSess_7879) in
                                    {10054}if (verify(m1_7934,sigM1_7933,pkCli_7882) <> true) then
                                        0
                                    else
                                        {10055}let (SPc_7935: bitstring,PartC_7936: bitstring) = m1_7934 in
                                        {10056}event endSrv(Cli_5510,Sess_5512,PartC_7936);
                                        {10057}new Ns_7937: bitstring;
                                        {10058}let gNs_7938: bitstring = exp(g,Ns_7937) in
                                        {10059}let m2_7939: bitstring = gNs_7938 in
                                        {10060}out(c, (enc(m2_7939,pkCli_7882),sign(m2_7939,skSess_7879)));
                                        {10061}event beginSrv(Sess_5512,Cli_5510,gNs_7938)
                        )
                        else
                            {10062}let pkDisco_7940: bitstring = fail-any in
                            {10063}in(c, (=pkCli_7882,em1_7941: bitstring,sigM1_7942: bitstring));
                            {10064}let m1_7943: bitstring = dec(em1_7941,skSess_7879) in
                            {10065}if (verify(m1_7943,sigM1_7942,pkCli_7882) <> true) then
                                0
                            else
                                {10066}let (SPc_7944: bitstring,PartC_7945: bitstring) = m1_7943 in
                                {10067}event endSrv(Cli_5510,Sess_5512,PartC_7945);
                                {10068}new Ns_7946: bitstring;
                                {10069}let gNs_7947: bitstring = exp(g,Ns_7946) in
                                {10070}let m2_7948: bitstring = gNs_7947 in
                                {10071}out(c, (enc(m2_7948,pkCli_7882),sign(m2_7948,skSess_7879)));
                                {10072}event beginSrv(Sess_5512,Cli_5510,gNs_7947)
                    )
                    else
                        {10073}let v_7949: bool = (Cli_5510 = B) in
                        (
                            {10074}if v_7949 then
                            (
                                {10075}let pkCli_7950: bitstring = pub(skB) in
                                {10076}let v_7951: bool = (Disco_5511 = A) in
                                (
                                    {10077}if v_7951 then
                                    (
                                        {10078}let pkDisco_7952: bitstring = pub(skA) in
                                        {10079}in(c, (=pkCli_7950,em1_7953: bitstring,sigM1_7954: bitstring));
                                        {10080}let m1_7955: bitstring = dec(em1_7953,skSess_7879) in
                                        {10081}if (verify(m1_7955,sigM1_7954,pkCli_7950) <> true) then
                                            0
                                        else
                                            {10082}let (SPc_7956: bitstring,PartC_7957: bitstring) = m1_7955 in
                                            {10083}event endSrv(Cli_5510,Sess_5512,PartC_7957);
                                            {10084}new Ns_7958: bitstring;
                                            {10085}let gNs_7959: bitstring = exp(g,Ns_7958) in
                                            {10086}let m2_7960: bitstring = gNs_7959 in
                                            {10087}out(c, (enc(m2_7960,pkCli_7950),sign(m2_7960,skSess_7879)));
                                            {10088}event beginSrv(Sess_5512,Cli_5510,gNs_7959)
                                    )
                                    else
                                        {10089}let v_7961: bool = (Disco_5511 = B) in
                                        (
                                            {10090}if v_7961 then
                                            (
                                                {10091}let pkDisco_7962: bitstring = pub(skB) in
                                                {10092}in(c, (=pkCli_7950,em1_7963: bitstring,sigM1_7964: bitstring));
                                                {10093}let m1_7965: bitstring = dec(em1_7963,skSess_7879) in
                                                {10094}if (verify(m1_7965,sigM1_7964,pkCli_7950) <> true) then
                                                    0
                                                else
                                                    {10095}let (SPc_7966: bitstring,PartC_7967: bitstring) = m1_7965 in
                                                    {10096}event endSrv(Cli_5510,Sess_5512,PartC_7967);
                                                    {10097}new Ns_7968: bitstring;
                                                    {10098}let gNs_7969: bitstring = exp(g,Ns_7968) in
                                                    {10099}let m2_7970: bitstring = gNs_7969 in
                                                    {10100}out(c, (enc(m2_7970,pkCli_7950),sign(m2_7970,skSess_7879)));
                                                    {10101}event beginSrv(Sess_5512,Cli_5510,gNs_7969)
                                            )
                                            else
                                                {10102}let v_7971: bool = (Disco_5511 = C) in
                                                (
                                                    {10103}if v_7971 then
                                                    (
                                                        {10104}let pkDisco_7972: bitstring = pub(skC) in
                                                        {10105}in(c, (=pkCli_7950,em1_7973: bitstring,sigM1_7974: bitstring));
                                                        {10106}let m1_7975: bitstring = dec(em1_7973,skSess_7879) in
                                                        {10107}if (verify(m1_7975,sigM1_7974,pkCli_7950) <> true) then
                                                            0
                                                        else
                                                            {10108}let (SPc_7976: bitstring,PartC_7977: bitstring) = m1_7975 in
                                                            {10109}event endSrv(Cli_5510,Sess_5512,PartC_7977);
                                                            {10110}new Ns_7978: bitstring;
                                                            {10111}let gNs_7979: bitstring = exp(g,Ns_7978) in
                                                            {10112}let m2_7980: bitstring = gNs_7979 in
                                                            {10113}out(c, (enc(m2_7980,pkCli_7950),sign(m2_7980,skSess_7879)));
                                                            {10114}event beginSrv(Sess_5512,Cli_5510,gNs_7979)
                                                    )
                                                    else
                                                        {10115}let pkDisco_7981: bitstring = pub(skI) in
                                                        {10116}in(c, (=pkCli_7950,em1_7982: bitstring,sigM1_7983: bitstring));
                                                        {10117}let m1_7984: bitstring = dec(em1_7982,skSess_7879) in
                                                        {10118}if (verify(m1_7984,sigM1_7983,pkCli_7950) <> true) then
                                                            0
                                                        else
                                                            {10119}let (SPc_7985: bitstring,PartC_7986: bitstring) = m1_7984 in
                                                            {10120}event endSrv(Cli_5510,Sess_5512,PartC_7986);
                                                            {10121}new Ns_7987: bitstring;
                                                            {10122}let gNs_7988: bitstring = exp(g,Ns_7987) in
                                                            {10123}let m2_7989: bitstring = gNs_7988 in
                                                            {10124}out(c, (enc(m2_7989,pkCli_7950),sign(m2_7989,skSess_7879)));
                                                            {10125}event beginSrv(Sess_5512,Cli_5510,gNs_7988)
                                                )
                                                else
                                                    {10126}let pkDisco_7990: bitstring = fail-any in
                                                    {10127}in(c, (=pkCli_7950,em1_7991: bitstring,sigM1_7992: bitstring));
                                                    {10128}let m1_7993: bitstring = dec(em1_7991,skSess_7879) in
                                                    {10129}if (verify(m1_7993,sigM1_7992,pkCli_7950) <> true) then
                                                        0
                                                    else
                                                        {10130}let (SPc_7994: bitstring,PartC_7995: bitstring) = m1_7993 in
                                                        {10131}event endSrv(Cli_5510,Sess_5512,PartC_7995);
                                                        {10132}new Ns_7996: bitstring;
                                                        {10133}let gNs_7997: bitstring = exp(g,Ns_7996) in
                                                        {10134}let m2_7998: bitstring = gNs_7997 in
                                                        {10135}out(c, (enc(m2_7998,pkCli_7950),sign(m2_7998,skSess_7879)));
                                                        {10136}event beginSrv(Sess_5512,Cli_5510,gNs_7997)
                                        )
                                        else
                                            {10137}let pkDisco_7999: bitstring = fail-any in
                                            {10138}in(c, (=pkCli_7950,em1_8000: bitstring,sigM1_8001: bitstring));
                                            {10139}let m1_8002: bitstring = dec(em1_8000,skSess_7879) in
                                            {10140}if (verify(m1_8002,sigM1_8001,pkCli_7950) <> true) then
                                                0
                                            else
                                                {10141}let (SPc_8003: bitstring,PartC_8004: bitstring) = m1_8002 in
                                                {10142}event endSrv(Cli_5510,Sess_5512,PartC_8004);
                                                {10143}new Ns_8005: bitstring;
                                                {10144}let gNs_8006: bitstring = exp(g,Ns_8005) in
                                                {10145}let m2_8007: bitstring = gNs_8006 in
                                                {10146}out(c, (enc(m2_8007,pkCli_7950),sign(m2_8007,skSess_7879)));
                                                {10147}event beginSrv(Sess_5512,Cli_5510,gNs_8006)
                                )
                                else
                                    {10148}let pkDisco_8008: bitstring = fail-any in
                                    {10149}in(c, (=pkCli_7950,em1_8009: bitstring,sigM1_8010: bitstring));
                                    {10150}let m1_8011: bitstring = dec(em1_8009,skSess_7879) in
                                    {10151}if (verify(m1_8011,sigM1_8010,pkCli_7950) <> true) then
                                        0
                                    else
                                        {10152}let (SPc_8012: bitstring,PartC_8013: bitstring) = m1_8011 in
                                        {10153}event endSrv(Cli_5510,Sess_5512,PartC_8013);
                                        {10154}new Ns_8014: bitstring;
                                        {10155}let gNs_8015: bitstring = exp(g,Ns_8014) in
                                        {10156}let m2_8016: bitstring = gNs_8015 in
                                        {10157}out(c, (enc(m2_8016,pkCli_7950),sign(m2_8016,skSess_7879)));
                                        {10158}event beginSrv(Sess_5512,Cli_5510,gNs_8015)
                            )
                            else
                                {10159}let v_8017: bool = (Cli_5510 = C) in
                                (
                                    {10160}if v_8017 then
                                    (
                                        {10161}let pkCli_8018: bitstring = pub(skC) in
                                        {10162}let v_8019: bool = (Disco_5511 = A) in
                                        (
                                            {10163}if v_8019 then
                                            (
                                                {10164}let pkDisco_8020: bitstring = pub(skA) in
                                                {10165}in(c, (=pkCli_8018,em1_8021: bitstring,sigM1_8022: bitstring));
                                                {10166}let m1_8023: bitstring = dec(em1_8021,skSess_7879) in
                                                {10167}if (verify(m1_8023,sigM1_8022,pkCli_8018) <> true) then
                                                    0
                                                else
                                                    {10168}let (SPc_8024: bitstring,PartC_8025: bitstring) = m1_8023 in
                                                    {10169}event endSrv(Cli_5510,Sess_5512,PartC_8025);
                                                    {10170}new Ns_8026: bitstring;
                                                    {10171}let gNs_8027: bitstring = exp(g,Ns_8026) in
                                                    {10172}let m2_8028: bitstring = gNs_8027 in
                                                    {10173}out(c, (enc(m2_8028,pkCli_8018),sign(m2_8028,skSess_7879)));
                                                    {10174}event beginSrv(Sess_5512,Cli_5510,gNs_8027)
                                            )
                                            else
                                                {10175}let v_8029: bool = (Disco_5511 = B) in
                                                (
                                                    {10176}if v_8029 then
                                                    (
                                                        {10177}let pkDisco_8030: bitstring = pub(skB) in
                                                        {10178}in(c, (=pkCli_8018,em1_8031: bitstring,sigM1_8032: bitstring));
                                                        {10179}let m1_8033: bitstring = dec(em1_8031,skSess_7879) in
                                                        {10180}if (verify(m1_8033,sigM1_8032,pkCli_8018) <> true) then
                                                            0
                                                        else
                                                            {10181}let (SPc_8034: bitstring,PartC_8035: bitstring) = m1_8033 in
                                                            {10182}event endSrv(Cli_5510,Sess_5512,PartC_8035);
                                                            {10183}new Ns_8036: bitstring;
                                                            {10184}let gNs_8037: bitstring = exp(g,Ns_8036) in
                                                            {10185}let m2_8038: bitstring = gNs_8037 in
                                                            {10186}out(c, (enc(m2_8038,pkCli_8018),sign(m2_8038,skSess_7879)));
                                                            {10187}event beginSrv(Sess_5512,Cli_5510,gNs_8037)
                                                    )
                                                    else
                                                        {10188}let v_8039: bool = (Disco_5511 = C) in
                                                        (
                                                            {10189}if v_8039 then
                                                            (
                                                                {10190}let pkDisco_8040: bitstring = pub(skC) in
                                                                {10191}in(c, (=pkCli_8018,em1_8041: bitstring,sigM1_8042: bitstring));
                                                                {10192}let m1_8043: bitstring = dec(em1_8041,skSess_7879) in
                                                                {10193}if (verify(m1_8043,sigM1_8042,pkCli_8018) <> true) then
                                                                    0
                                                                else
                                                                    {10194}let (SPc_8044: bitstring,PartC_8045: bitstring) = m1_8043 in
                                                                    {10195}event endSrv(Cli_5510,Sess_5512,PartC_8045);
                                                                    {10196}new Ns_8046: bitstring;
                                                                    {10197}let gNs_8047: bitstring = exp(g,Ns_8046) in
                                                                    {10198}let m2_8048: bitstring = gNs_8047 in
                                                                    {10199}out(c, (enc(m2_8048,pkCli_8018),sign(m2_8048,skSess_7879)));
                                                                    {10200}event beginSrv(Sess_5512,Cli_5510,gNs_8047)
                                                            )
                                                            else
                                                                {10201}let pkDisco_8049: bitstring = pub(skI) in
                                                                {10202}in(c, (=pkCli_8018,em1_8050: bitstring,sigM1_8051: bitstring));
                                                                {10203}let m1_8052: bitstring = dec(em1_8050,skSess_7879) in
                                                                {10204}if (verify(m1_8052,sigM1_8051,pkCli_8018) <> true) then
                                                                    0
                                                                else
                                                                    {10205}let (SPc_8053: bitstring,PartC_8054: bitstring) = m1_8052 in
                                                                    {10206}event endSrv(Cli_5510,Sess_5512,PartC_8054);
                                                                    {10207}new Ns_8055: bitstring;
                                                                    {10208}let gNs_8056: bitstring = exp(g,Ns_8055) in
                                                                    {10209}let m2_8057: bitstring = gNs_8056 in
                                                                    {10210}out(c, (enc(m2_8057,pkCli_8018),sign(m2_8057,skSess_7879)));
                                                                    {10211}event beginSrv(Sess_5512,Cli_5510,gNs_8056)
                                                        )
                                                        else
                                                            {10212}let pkDisco_8058: bitstring = fail-any in
                                                            {10213}in(c, (=pkCli_8018,em1_8059: bitstring,sigM1_8060: bitstring));
                                                            {10214}let m1_8061: bitstring = dec(em1_8059,skSess_7879) in
                                                            {10215}if (verify(m1_8061,sigM1_8060,pkCli_8018) <> true) then
                                                                0
                                                            else
                                                                {10216}let (SPc_8062: bitstring,PartC_8063: bitstring) = m1_8061 in
                                                                {10217}event endSrv(Cli_5510,Sess_5512,PartC_8063);
                                                                {10218}new Ns_8064: bitstring;
                                                                {10219}let gNs_8065: bitstring = exp(g,Ns_8064) in
                                                                {10220}let m2_8066: bitstring = gNs_8065 in
                                                                {10221}out(c, (enc(m2_8066,pkCli_8018),sign(m2_8066,skSess_7879)));
                                                                {10222}event beginSrv(Sess_5512,Cli_5510,gNs_8065)
                                                )
                                                else
                                                    {10223}let pkDisco_8067: bitstring = fail-any in
                                                    {10224}in(c, (=pkCli_8018,em1_8068: bitstring,sigM1_8069: bitstring));
                                                    {10225}let m1_8070: bitstring = dec(em1_8068,skSess_7879) in
                                                    {10226}if (verify(m1_8070,sigM1_8069,pkCli_8018) <> true) then
                                                        0
                                                    else
                                                        {10227}let (SPc_8071: bitstring,PartC_8072: bitstring) = m1_8070 in
                                                        {10228}event endSrv(Cli_5510,Sess_5512,PartC_8072);
                                                        {10229}new Ns_8073: bitstring;
                                                        {10230}let gNs_8074: bitstring = exp(g,Ns_8073) in
                                                        {10231}let m2_8075: bitstring = gNs_8074 in
                                                        {10232}out(c, (enc(m2_8075,pkCli_8018),sign(m2_8075,skSess_7879)));
                                                        {10233}event beginSrv(Sess_5512,Cli_5510,gNs_8074)
                                        )
                                        else
                                            {10234}let pkDisco_8076: bitstring = fail-any in
                                            {10235}in(c, (=pkCli_8018,em1_8077: bitstring,sigM1_8078: bitstring));
                                            {10236}let m1_8079: bitstring = dec(em1_8077,skSess_7879) in
                                            {10237}if (verify(m1_8079,sigM1_8078,pkCli_8018) <> true) then
                                                0
                                            else
                                                {10238}let (SPc_8080: bitstring,PartC_8081: bitstring) = m1_8079 in
                                                {10239}event endSrv(Cli_5510,Sess_5512,PartC_8081);
                                                {10240}new Ns_8082: bitstring;
                                                {10241}let gNs_8083: bitstring = exp(g,Ns_8082) in
                                                {10242}let m2_8084: bitstring = gNs_8083 in
                                                {10243}out(c, (enc(m2_8084,pkCli_8018),sign(m2_8084,skSess_7879)));
                                                {10244}event beginSrv(Sess_5512,Cli_5510,gNs_8083)
                                    )
                                    else
                                        {10245}let pkCli_8085: bitstring = pub(skI) in
                                        {10246}let v_8086: bool = (Disco_5511 = A) in
                                        (
                                            {10247}if v_8086 then
                                            (
                                                {10248}let pkDisco_8087: bitstring = pub(skA) in
                                                {10249}in(c, (=pkCli_8085,em1_8088: bitstring,sigM1_8089: bitstring));
                                                {10250}let m1_8090: bitstring = dec(em1_8088,skSess_7879) in
                                                {10251}if (verify(m1_8090,sigM1_8089,pkCli_8085) <> true) then
                                                    0
                                                else
                                                    {10252}let (SPc_8091: bitstring,PartC_8092: bitstring) = m1_8090 in
                                                    {10253}event endSrv(Cli_5510,Sess_5512,PartC_8092);
                                                    {10254}new Ns_8093: bitstring;
                                                    {10255}let gNs_8094: bitstring = exp(g,Ns_8093) in
                                                    {10256}let m2_8095: bitstring = gNs_8094 in
                                                    {10257}out(c, (enc(m2_8095,pkCli_8085),sign(m2_8095,skSess_7879)));
                                                    {10258}event beginSrv(Sess_5512,Cli_5510,gNs_8094)
                                            )
                                            else
                                                {10259}let v_8096: bool = (Disco_5511 = B) in
                                                (
                                                    {10260}if v_8096 then
                                                    (
                                                        {10261}let pkDisco_8097: bitstring = pub(skB) in
                                                        {10262}in(c, (=pkCli_8085,em1_8098: bitstring,sigM1_8099: bitstring));
                                                        {10263}let m1_8100: bitstring = dec(em1_8098,skSess_7879) in
                                                        {10264}if (verify(m1_8100,sigM1_8099,pkCli_8085) <> true) then
                                                            0
                                                        else
                                                            {10265}let (SPc_8101: bitstring,PartC_8102: bitstring) = m1_8100 in
                                                            {10266}event endSrv(Cli_5510,Sess_5512,PartC_8102);
                                                            {10267}new Ns_8103: bitstring;
                                                            {10268}let gNs_8104: bitstring = exp(g,Ns_8103) in
                                                            {10269}let m2_8105: bitstring = gNs_8104 in
                                                            {10270}out(c, (enc(m2_8105,pkCli_8085),sign(m2_8105,skSess_7879)));
                                                            {10271}event beginSrv(Sess_5512,Cli_5510,gNs_8104)
                                                    )
                                                    else
                                                        {10272}let v_8106: bool = (Disco_5511 = C) in
                                                        (
                                                            {10273}if v_8106 then
                                                            (
                                                                {10274}let pkDisco_8107: bitstring = pub(skC) in
                                                                {10275}in(c, (=pkCli_8085,em1_8108: bitstring,sigM1_8109: bitstring));
                                                                {10276}let m1_8110: bitstring = dec(em1_8108,skSess_7879) in
                                                                {10277}if (verify(m1_8110,sigM1_8109,pkCli_8085) <> true) then
                                                                    0
                                                                else
                                                                    {10278}let (SPc_8111: bitstring,PartC_8112: bitstring) = m1_8110 in
                                                                    {10279}event endSrv(Cli_5510,Sess_5512,PartC_8112);
                                                                    {10280}new Ns_8113: bitstring;
                                                                    {10281}let gNs_8114: bitstring = exp(g,Ns_8113) in
                                                                    {10282}let m2_8115: bitstring = gNs_8114 in
                                                                    {10283}out(c, (enc(m2_8115,pkCli_8085),sign(m2_8115,skSess_7879)));
                                                                    {10284}event beginSrv(Sess_5512,Cli_5510,gNs_8114)
                                                            )
                                                            else
                                                                {10285}let pkDisco_8116: bitstring = pub(skI) in
                                                                {10286}in(c, (=pkCli_8085,em1_8117: bitstring,sigM1_8118: bitstring));
                                                                {10287}let m1_8119: bitstring = dec(em1_8117,skSess_7879) in
                                                                {10288}if (verify(m1_8119,sigM1_8118,pkCli_8085) <> true) then
                                                                    0
                                                                else
                                                                    {10289}let (SPc_8120: bitstring,PartC_8121: bitstring) = m1_8119 in
                                                                    {10290}event endSrv(Cli_5510,Sess_5512,PartC_8121);
                                                                    {10291}new Ns_8122: bitstring;
                                                                    {10292}let gNs_8123: bitstring = exp(g,Ns_8122) in
                                                                    {10293}let m2_8124: bitstring = gNs_8123 in
                                                                    {10294}out(c, (enc(m2_8124,pkCli_8085),sign(m2_8124,skSess_7879)));
                                                                    {10295}event beginSrv(Sess_5512,Cli_5510,gNs_8123)
                                                        )
                                                        else
                                                            {10296}let pkDisco_8125: bitstring = fail-any in
                                                            {10297}in(c, (=pkCli_8085,em1_8126: bitstring,sigM1_8127: bitstring));
                                                            {10298}let m1_8128: bitstring = dec(em1_8126,skSess_7879) in
                                                            {10299}if (verify(m1_8128,sigM1_8127,pkCli_8085) <> true) then
                                                                0
                                                            else
                                                                {10300}let (SPc_8129: bitstring,PartC_8130: bitstring) = m1_8128 in
                                                                {10301}event endSrv(Cli_5510,Sess_5512,PartC_8130);
                                                                {10302}new Ns_8131: bitstring;
                                                                {10303}let gNs_8132: bitstring = exp(g,Ns_8131) in
                                                                {10304}let m2_8133: bitstring = gNs_8132 in
                                                                {10305}out(c, (enc(m2_8133,pkCli_8085),sign(m2_8133,skSess_7879)));
                                                                {10306}event beginSrv(Sess_5512,Cli_5510,gNs_8132)
                                                )
                                                else
                                                    {10307}let pkDisco_8134: bitstring = fail-any in
                                                    {10308}in(c, (=pkCli_8085,em1_8135: bitstring,sigM1_8136: bitstring));
                                                    {10309}let m1_8137: bitstring = dec(em1_8135,skSess_7879) in
                                                    {10310}if (verify(m1_8137,sigM1_8136,pkCli_8085) <> true) then
                                                        0
                                                    else
                                                        {10311}let (SPc_8138: bitstring,PartC_8139: bitstring) = m1_8137 in
                                                        {10312}event endSrv(Cli_5510,Sess_5512,PartC_8139);
                                                        {10313}new Ns_8140: bitstring;
                                                        {10314}let gNs_8141: bitstring = exp(g,Ns_8140) in
                                                        {10315}let m2_8142: bitstring = gNs_8141 in
                                                        {10316}out(c, (enc(m2_8142,pkCli_8085),sign(m2_8142,skSess_7879)));
                                                        {10317}event beginSrv(Sess_5512,Cli_5510,gNs_8141)
                                        )
                                        else
                                            {10318}let pkDisco_8143: bitstring = fail-any in
                                            {10319}in(c, (=pkCli_8085,em1_8144: bitstring,sigM1_8145: bitstring));
                                            {10320}let m1_8146: bitstring = dec(em1_8144,skSess_7879) in
                                            {10321}if (verify(m1_8146,sigM1_8145,pkCli_8085) <> true) then
                                                0
                                            else
                                                {10322}let (SPc_8147: bitstring,PartC_8148: bitstring) = m1_8146 in
                                                {10323}event endSrv(Cli_5510,Sess_5512,PartC_8148);
                                                {10324}new Ns_8149: bitstring;
                                                {10325}let gNs_8150: bitstring = exp(g,Ns_8149) in
                                                {10326}let m2_8151: bitstring = gNs_8150 in
                                                {10327}out(c, (enc(m2_8151,pkCli_8085),sign(m2_8151,skSess_7879)));
                                                {10328}event beginSrv(Sess_5512,Cli_5510,gNs_8150)
                                )
                                else
                                    {10329}let pkCli_8152: bitstring = fail-any in
                                    {10330}let v_8153: bool = (Disco_5511 = A) in
                                    (
                                        {10331}if v_8153 then
                                        (
                                            {10332}let pkDisco_8154: bitstring = pub(skA) in
                                            {10333}in(c, (=pkCli_8152,em1_8155: bitstring,sigM1_8156: bitstring));
                                            {10334}let m1_8157: bitstring = dec(em1_8155,skSess_7879) in
                                            {10335}if (verify(m1_8157,sigM1_8156,pkCli_8152) <> true) then
                                                0
                                            else
                                                {10336}let (SPc_8158: bitstring,PartC_8159: bitstring) = m1_8157 in
                                                {10337}event endSrv(Cli_5510,Sess_5512,PartC_8159);
                                                {10338}new Ns_8160: bitstring;
                                                {10339}let gNs_8161: bitstring = exp(g,Ns_8160) in
                                                {10340}let m2_8162: bitstring = gNs_8161 in
                                                {10341}out(c, (enc(m2_8162,pkCli_8152),sign(m2_8162,skSess_7879)));
                                                {10342}event beginSrv(Sess_5512,Cli_5510,gNs_8161)
                                        )
                                        else
                                            {10343}let v_8163: bool = (Disco_5511 = B) in
                                            (
                                                {10344}if v_8163 then
                                                (
                                                    {10345}let pkDisco_8164: bitstring = pub(skB) in
                                                    {10346}in(c, (=pkCli_8152,em1_8165: bitstring,sigM1_8166: bitstring));
                                                    {10347}let m1_8167: bitstring = dec(em1_8165,skSess_7879) in
                                                    {10348}if (verify(m1_8167,sigM1_8166,pkCli_8152) <> true) then
                                                        0
                                                    else
                                                        {10349}let (SPc_8168: bitstring,PartC_8169: bitstring) = m1_8167 in
                                                        {10350}event endSrv(Cli_5510,Sess_5512,PartC_8169);
                                                        {10351}new Ns_8170: bitstring;
                                                        {10352}let gNs_8171: bitstring = exp(g,Ns_8170) in
                                                        {10353}let m2_8172: bitstring = gNs_8171 in
                                                        {10354}out(c, (enc(m2_8172,pkCli_8152),sign(m2_8172,skSess_7879)));
                                                        {10355}event beginSrv(Sess_5512,Cli_5510,gNs_8171)
                                                )
                                                else
                                                    {10356}let v_8173: bool = (Disco_5511 = C) in
                                                    (
                                                        {10357}if v_8173 then
                                                        (
                                                            {10358}let pkDisco_8174: bitstring = pub(skC) in
                                                            {10359}in(c, (=pkCli_8152,em1_8175: bitstring,sigM1_8176: bitstring));
                                                            {10360}let m1_8177: bitstring = dec(em1_8175,skSess_7879) in
                                                            {10361}if (verify(m1_8177,sigM1_8176,pkCli_8152) <> true) then
                                                                0
                                                            else
                                                                {10362}let (SPc_8178: bitstring,PartC_8179: bitstring) = m1_8177 in
                                                                {10363}event endSrv(Cli_5510,Sess_5512,PartC_8179);
                                                                {10364}new Ns_8180: bitstring;
                                                                {10365}let gNs_8181: bitstring = exp(g,Ns_8180) in
                                                                {10366}let m2_8182: bitstring = gNs_8181 in
                                                                {10367}out(c, (enc(m2_8182,pkCli_8152),sign(m2_8182,skSess_7879)));
                                                                {10368}event beginSrv(Sess_5512,Cli_5510,gNs_8181)
                                                        )
                                                        else
                                                            {10369}let pkDisco_8183: bitstring = pub(skI) in
                                                            {10370}in(c, (=pkCli_8152,em1_8184: bitstring,sigM1_8185: bitstring));
                                                            {10371}let m1_8186: bitstring = dec(em1_8184,skSess_7879) in
                                                            {10372}if (verify(m1_8186,sigM1_8185,pkCli_8152) <> true) then
                                                                0
                                                            else
                                                                {10373}let (SPc_8187: bitstring,PartC_8188: bitstring) = m1_8186 in
                                                                {10374}event endSrv(Cli_5510,Sess_5512,PartC_8188);
                                                                {10375}new Ns_8189: bitstring;
                                                                {10376}let gNs_8190: bitstring = exp(g,Ns_8189) in
                                                                {10377}let m2_8191: bitstring = gNs_8190 in
                                                                {10378}out(c, (enc(m2_8191,pkCli_8152),sign(m2_8191,skSess_7879)));
                                                                {10379}event beginSrv(Sess_5512,Cli_5510,gNs_8190)
                                                    )
                                                    else
                                                        {10380}let pkDisco_8192: bitstring = fail-any in
                                                        {10381}in(c, (=pkCli_8152,em1_8193: bitstring,sigM1_8194: bitstring));
                                                        {10382}let m1_8195: bitstring = dec(em1_8193,skSess_7879) in
                                                        {10383}if (verify(m1_8195,sigM1_8194,pkCli_8152) <> true) then
                                                            0
                                                        else
                                                            {10384}let (SPc_8196: bitstring,PartC_8197: bitstring) = m1_8195 in
                                                            {10385}event endSrv(Cli_5510,Sess_5512,PartC_8197);
                                                            {10386}new Ns_8198: bitstring;
                                                            {10387}let gNs_8199: bitstring = exp(g,Ns_8198) in
                                                            {10388}let m2_8200: bitstring = gNs_8199 in
                                                            {10389}out(c, (enc(m2_8200,pkCli_8152),sign(m2_8200,skSess_7879)));
                                                            {10390}event beginSrv(Sess_5512,Cli_5510,gNs_8199)
                                            )
                                            else
                                                {10391}let pkDisco_8201: bitstring = fail-any in
                                                {10392}in(c, (=pkCli_8152,em1_8202: bitstring,sigM1_8203: bitstring));
                                                {10393}let m1_8204: bitstring = dec(em1_8202,skSess_7879) in
                                                {10394}if (verify(m1_8204,sigM1_8203,pkCli_8152) <> true) then
                                                    0
                                                else
                                                    {10395}let (SPc_8205: bitstring,PartC_8206: bitstring) = m1_8204 in
                                                    {10396}event endSrv(Cli_5510,Sess_5512,PartC_8206);
                                                    {10397}new Ns_8207: bitstring;
                                                    {10398}let gNs_8208: bitstring = exp(g,Ns_8207) in
                                                    {10399}let m2_8209: bitstring = gNs_8208 in
                                                    {10400}out(c, (enc(m2_8209,pkCli_8152),sign(m2_8209,skSess_7879)));
                                                    {10401}event beginSrv(Sess_5512,Cli_5510,gNs_8208)
                                    )
                                    else
                                        {10402}let pkDisco_8210: bitstring = fail-any in
                                        {10403}in(c, (=pkCli_8152,em1_8211: bitstring,sigM1_8212: bitstring));
                                        {10404}let m1_8213: bitstring = dec(em1_8211,skSess_7879) in
                                        {10405}if (verify(m1_8213,sigM1_8212,pkCli_8152) <> true) then
                                            0
                                        else
                                            {10406}let (SPc_8214: bitstring,PartC_8215: bitstring) = m1_8213 in
                                            {10407}event endSrv(Cli_5510,Sess_5512,PartC_8215);
                                            {10408}new Ns_8216: bitstring;
                                            {10409}let gNs_8217: bitstring = exp(g,Ns_8216) in
                                            {10410}let m2_8218: bitstring = gNs_8217 in
                                            {10411}out(c, (enc(m2_8218,pkCli_8152),sign(m2_8218,skSess_7879)));
                                            {10412}event beginSrv(Sess_5512,Cli_5510,gNs_8217)
                        )
                        else
                            {10413}let pkCli_8219: bitstring = fail-any in
                            {10414}let v_8220: bool = (Disco_5511 = A) in
                            (
                                {10415}if v_8220 then
                                (
                                    {10416}let pkDisco_8221: bitstring = pub(skA) in
                                    {10417}in(c, (=pkCli_8219,em1_8222: bitstring,sigM1_8223: bitstring));
                                    {10418}let m1_8224: bitstring = dec(em1_8222,skSess_7879) in
                                    {10419}if (verify(m1_8224,sigM1_8223,pkCli_8219) <> true) then
                                        0
                                    else
                                        {10420}let (SPc_8225: bitstring,PartC_8226: bitstring) = m1_8224 in
                                        {10421}event endSrv(Cli_5510,Sess_5512,PartC_8226);
                                        {10422}new Ns_8227: bitstring;
                                        {10423}let gNs_8228: bitstring = exp(g,Ns_8227) in
                                        {10424}let m2_8229: bitstring = gNs_8228 in
                                        {10425}out(c, (enc(m2_8229,pkCli_8219),sign(m2_8229,skSess_7879)));
                                        {10426}event beginSrv(Sess_5512,Cli_5510,gNs_8228)
                                )
                                else
                                    {10427}let v_8230: bool = (Disco_5511 = B) in
                                    (
                                        {10428}if v_8230 then
                                        (
                                            {10429}let pkDisco_8231: bitstring = pub(skB) in
                                            {10430}in(c, (=pkCli_8219,em1_8232: bitstring,sigM1_8233: bitstring));
                                            {10431}let m1_8234: bitstring = dec(em1_8232,skSess_7879) in
                                            {10432}if (verify(m1_8234,sigM1_8233,pkCli_8219) <> true) then
                                                0
                                            else
                                                {10433}let (SPc_8235: bitstring,PartC_8236: bitstring) = m1_8234 in
                                                {10434}event endSrv(Cli_5510,Sess_5512,PartC_8236);
                                                {10435}new Ns_8237: bitstring;
                                                {10436}let gNs_8238: bitstring = exp(g,Ns_8237) in
                                                {10437}let m2_8239: bitstring = gNs_8238 in
                                                {10438}out(c, (enc(m2_8239,pkCli_8219),sign(m2_8239,skSess_7879)));
                                                {10439}event beginSrv(Sess_5512,Cli_5510,gNs_8238)
                                        )
                                        else
                                            {10440}let v_8240: bool = (Disco_5511 = C) in
                                            (
                                                {10441}if v_8240 then
                                                (
                                                    {10442}let pkDisco_8241: bitstring = pub(skC) in
                                                    {10443}in(c, (=pkCli_8219,em1_8242: bitstring,sigM1_8243: bitstring));
                                                    {10444}let m1_8244: bitstring = dec(em1_8242,skSess_7879) in
                                                    {10445}if (verify(m1_8244,sigM1_8243,pkCli_8219) <> true) then
                                                        0
                                                    else
                                                        {10446}let (SPc_8245: bitstring,PartC_8246: bitstring) = m1_8244 in
                                                        {10447}event endSrv(Cli_5510,Sess_5512,PartC_8246);
                                                        {10448}new Ns_8247: bitstring;
                                                        {10449}let gNs_8248: bitstring = exp(g,Ns_8247) in
                                                        {10450}let m2_8249: bitstring = gNs_8248 in
                                                        {10451}out(c, (enc(m2_8249,pkCli_8219),sign(m2_8249,skSess_7879)));
                                                        {10452}event beginSrv(Sess_5512,Cli_5510,gNs_8248)
                                                )
                                                else
                                                    {10453}let pkDisco_8250: bitstring = pub(skI) in
                                                    {10454}in(c, (=pkCli_8219,em1_8251: bitstring,sigM1_8252: bitstring));
                                                    {10455}let m1_8253: bitstring = dec(em1_8251,skSess_7879) in
                                                    {10456}if (verify(m1_8253,sigM1_8252,pkCli_8219) <> true) then
                                                        0
                                                    else
                                                        {10457}let (SPc_8254: bitstring,PartC_8255: bitstring) = m1_8253 in
                                                        {10458}event endSrv(Cli_5510,Sess_5512,PartC_8255);
                                                        {10459}new Ns_8256: bitstring;
                                                        {10460}let gNs_8257: bitstring = exp(g,Ns_8256) in
                                                        {10461}let m2_8258: bitstring = gNs_8257 in
                                                        {10462}out(c, (enc(m2_8258,pkCli_8219),sign(m2_8258,skSess_7879)));
                                                        {10463}event beginSrv(Sess_5512,Cli_5510,gNs_8257)
                                            )
                                            else
                                                {10464}let pkDisco_8259: bitstring = fail-any in
                                                {10465}in(c, (=pkCli_8219,em1_8260: bitstring,sigM1_8261: bitstring));
                                                {10466}let m1_8262: bitstring = dec(em1_8260,skSess_7879) in
                                                {10467}if (verify(m1_8262,sigM1_8261,pkCli_8219) <> true) then
                                                    0
                                                else
                                                    {10468}let (SPc_8263: bitstring,PartC_8264: bitstring) = m1_8262 in
                                                    {10469}event endSrv(Cli_5510,Sess_5512,PartC_8264);
                                                    {10470}new Ns_8265: bitstring;
                                                    {10471}let gNs_8266: bitstring = exp(g,Ns_8265) in
                                                    {10472}let m2_8267: bitstring = gNs_8266 in
                                                    {10473}out(c, (enc(m2_8267,pkCli_8219),sign(m2_8267,skSess_7879)));
                                                    {10474}event beginSrv(Sess_5512,Cli_5510,gNs_8266)
                                    )
                                    else
                                        {10475}let pkDisco_8268: bitstring = fail-any in
                                        {10476}in(c, (=pkCli_8219,em1_8269: bitstring,sigM1_8270: bitstring));
                                        {10477}let m1_8271: bitstring = dec(em1_8269,skSess_7879) in
                                        {10478}if (verify(m1_8271,sigM1_8270,pkCli_8219) <> true) then
                                            0
                                        else
                                            {10479}let (SPc_8272: bitstring,PartC_8273: bitstring) = m1_8271 in
                                            {10480}event endSrv(Cli_5510,Sess_5512,PartC_8273);
                                            {10481}new Ns_8274: bitstring;
                                            {10482}let gNs_8275: bitstring = exp(g,Ns_8274) in
                                            {10483}let m2_8276: bitstring = gNs_8275 in
                                            {10484}out(c, (enc(m2_8276,pkCli_8219),sign(m2_8276,skSess_7879)));
                                            {10485}event beginSrv(Sess_5512,Cli_5510,gNs_8275)
                            )
                            else
                                {10486}let pkDisco_8277: bitstring = fail-any in
                                {10487}in(c, (=pkCli_8219,em1_8278: bitstring,sigM1_8279: bitstring));
                                {10488}let m1_8280: bitstring = dec(em1_8278,skSess_7879) in
                                {10489}if (verify(m1_8280,sigM1_8279,pkCli_8219) <> true) then
                                    0
                                else
                                    {10490}let (SPc_8281: bitstring,PartC_8282: bitstring) = m1_8280 in
                                    {10491}event endSrv(Cli_5510,Sess_5512,PartC_8282);
                                    {10492}new Ns_8283: bitstring;
                                    {10493}let gNs_8284: bitstring = exp(g,Ns_8283) in
                                    {10494}let m2_8285: bitstring = gNs_8284 in
                                    {10495}out(c, (enc(m2_8285,pkCli_8219),sign(m2_8285,skSess_7879)));
                                    {10496}event beginSrv(Sess_5512,Cli_5510,gNs_8284)
                )
                else
                    {10497}let pkCli_8286: bitstring = fail-any in
                    {10498}let v_8287: bool = (Disco_5511 = A) in
                    (
                        {10499}if v_8287 then
                        (
                            {10500}let pkDisco_8288: bitstring = pub(skA) in
                            {10501}in(c, (=pkCli_8286,em1_8289: bitstring,sigM1_8290: bitstring));
                            {10502}let m1_8291: bitstring = dec(em1_8289,skSess_7879) in
                            {10503}if (verify(m1_8291,sigM1_8290,pkCli_8286) <> true) then
                                0
                            else
                                {10504}let (SPc_8292: bitstring,PartC_8293: bitstring) = m1_8291 in
                                {10505}event endSrv(Cli_5510,Sess_5512,PartC_8293);
                                {10506}new Ns_8294: bitstring;
                                {10507}let gNs_8295: bitstring = exp(g,Ns_8294) in
                                {10508}let m2_8296: bitstring = gNs_8295 in
                                {10509}out(c, (enc(m2_8296,pkCli_8286),sign(m2_8296,skSess_7879)));
                                {10510}event beginSrv(Sess_5512,Cli_5510,gNs_8295)
                        )
                        else
                            {10511}let v_8297: bool = (Disco_5511 = B) in
                            (
                                {10512}if v_8297 then
                                (
                                    {10513}let pkDisco_8298: bitstring = pub(skB) in
                                    {10514}in(c, (=pkCli_8286,em1_8299: bitstring,sigM1_8300: bitstring));
                                    {10515}let m1_8301: bitstring = dec(em1_8299,skSess_7879) in
                                    {10516}if (verify(m1_8301,sigM1_8300,pkCli_8286) <> true) then
                                        0
                                    else
                                        {10517}let (SPc_8302: bitstring,PartC_8303: bitstring) = m1_8301 in
                                        {10518}event endSrv(Cli_5510,Sess_5512,PartC_8303);
                                        {10519}new Ns_8304: bitstring;
                                        {10520}let gNs_8305: bitstring = exp(g,Ns_8304) in
                                        {10521}let m2_8306: bitstring = gNs_8305 in
                                        {10522}out(c, (enc(m2_8306,pkCli_8286),sign(m2_8306,skSess_7879)));
                                        {10523}event beginSrv(Sess_5512,Cli_5510,gNs_8305)
                                )
                                else
                                    {10524}let v_8307: bool = (Disco_5511 = C) in
                                    (
                                        {10525}if v_8307 then
                                        (
                                            {10526}let pkDisco_8308: bitstring = pub(skC) in
                                            {10527}in(c, (=pkCli_8286,em1_8309: bitstring,sigM1_8310: bitstring));
                                            {10528}let m1_8311: bitstring = dec(em1_8309,skSess_7879) in
                                            {10529}if (verify(m1_8311,sigM1_8310,pkCli_8286) <> true) then
                                                0
                                            else
                                                {10530}let (SPc_8312: bitstring,PartC_8313: bitstring) = m1_8311 in
                                                {10531}event endSrv(Cli_5510,Sess_5512,PartC_8313);
                                                {10532}new Ns_8314: bitstring;
                                                {10533}let gNs_8315: bitstring = exp(g,Ns_8314) in
                                                {10534}let m2_8316: bitstring = gNs_8315 in
                                                {10535}out(c, (enc(m2_8316,pkCli_8286),sign(m2_8316,skSess_7879)));
                                                {10536}event beginSrv(Sess_5512,Cli_5510,gNs_8315)
                                        )
                                        else
                                            {10537}let pkDisco_8317: bitstring = pub(skI) in
                                            {10538}in(c, (=pkCli_8286,em1_8318: bitstring,sigM1_8319: bitstring));
                                            {10539}let m1_8320: bitstring = dec(em1_8318,skSess_7879) in
                                            {10540}if (verify(m1_8320,sigM1_8319,pkCli_8286) <> true) then
                                                0
                                            else
                                                {10541}let (SPc_8321: bitstring,PartC_8322: bitstring) = m1_8320 in
                                                {10542}event endSrv(Cli_5510,Sess_5512,PartC_8322);
                                                {10543}new Ns_8323: bitstring;
                                                {10544}let gNs_8324: bitstring = exp(g,Ns_8323) in
                                                {10545}let m2_8325: bitstring = gNs_8324 in
                                                {10546}out(c, (enc(m2_8325,pkCli_8286),sign(m2_8325,skSess_7879)));
                                                {10547}event beginSrv(Sess_5512,Cli_5510,gNs_8324)
                                    )
                                    else
                                        {10548}let pkDisco_8326: bitstring = fail-any in
                                        {10549}in(c, (=pkCli_8286,em1_8327: bitstring,sigM1_8328: bitstring));
                                        {10550}let m1_8329: bitstring = dec(em1_8327,skSess_7879) in
                                        {10551}if (verify(m1_8329,sigM1_8328,pkCli_8286) <> true) then
                                            0
                                        else
                                            {10552}let (SPc_8330: bitstring,PartC_8331: bitstring) = m1_8329 in
                                            {10553}event endSrv(Cli_5510,Sess_5512,PartC_8331);
                                            {10554}new Ns_8332: bitstring;
                                            {10555}let gNs_8333: bitstring = exp(g,Ns_8332) in
                                            {10556}let m2_8334: bitstring = gNs_8333 in
                                            {10557}out(c, (enc(m2_8334,pkCli_8286),sign(m2_8334,skSess_7879)));
                                            {10558}event beginSrv(Sess_5512,Cli_5510,gNs_8333)
                            )
                            else
                                {10559}let pkDisco_8335: bitstring = fail-any in
                                {10560}in(c, (=pkCli_8286,em1_8336: bitstring,sigM1_8337: bitstring));
                                {10561}let m1_8338: bitstring = dec(em1_8336,skSess_7879) in
                                {10562}if (verify(m1_8338,sigM1_8337,pkCli_8286) <> true) then
                                    0
                                else
                                    {10563}let (SPc_8339: bitstring,PartC_8340: bitstring) = m1_8338 in
                                    {10564}event endSrv(Cli_5510,Sess_5512,PartC_8340);
                                    {10565}new Ns_8341: bitstring;
                                    {10566}let gNs_8342: bitstring = exp(g,Ns_8341) in
                                    {10567}let m2_8343: bitstring = gNs_8342 in
                                    {10568}out(c, (enc(m2_8343,pkCli_8286),sign(m2_8343,skSess_7879)));
                                    {10569}event beginSrv(Sess_5512,Cli_5510,gNs_8342)
                    )
                    else
                        {10570}let pkDisco_8344: bitstring = fail-any in
                        {10571}in(c, (=pkCli_8286,em1_8345: bitstring,sigM1_8346: bitstring));
                        {10572}let m1_8347: bitstring = dec(em1_8345,skSess_7879) in
                        {10573}if (verify(m1_8347,sigM1_8346,pkCli_8286) <> true) then
                            0
                        else
                            {10574}let (SPc_8348: bitstring,PartC_8349: bitstring) = m1_8347 in
                            {10575}event endSrv(Cli_5510,Sess_5512,PartC_8349);
                            {10576}new Ns_8350: bitstring;
                            {10577}let gNs_8351: bitstring = exp(g,Ns_8350) in
                            {10578}let m2_8352: bitstring = gNs_8351 in
                            {10579}out(c, (enc(m2_8352,pkCli_8286),sign(m2_8352,skSess_7879)));
                            {10580}event beginSrv(Sess_5512,Cli_5510,gNs_8351)
    )
    else
        {10581}let skSess_8353: bitstring = fail-any in
        {10582}let pkSess_8354: bitstring = pub(skSess_8353) in
        {10583}let v_8355: bool = (Cli_5510 = A) in
        (
            {10584}if v_8355 then
            (
                {10585}let pkCli_8356: bitstring = pub(skA) in
                {10586}let v_8357: bool = (Disco_5511 = A) in
                (
                    {10587}if v_8357 then
                    (
                        {10588}let pkDisco_8358: bitstring = pub(skA) in
                        {10589}in(c, (=pkCli_8356,em1_8359: bitstring,sigM1_8360: bitstring));
                        {10590}let m1_8361: bitstring = dec(em1_8359,skSess_8353) in
                        {10591}if (verify(m1_8361,sigM1_8360,pkCli_8356) <> true) then
                            0
                        else
                            {10592}let (SPc_8362: bitstring,PartC_8363: bitstring) = m1_8361 in
                            {10593}event endSrv(Cli_5510,Sess_5512,PartC_8363);
                            {10594}new Ns_8364: bitstring;
                            {10595}let gNs_8365: bitstring = exp(g,Ns_8364) in
                            {10596}let m2_8366: bitstring = gNs_8365 in
                            {10597}out(c, (enc(m2_8366,pkCli_8356),sign(m2_8366,skSess_8353)));
                            {10598}event beginSrv(Sess_5512,Cli_5510,gNs_8365)
                    )
                    else
                        {10599}let v_8367: bool = (Disco_5511 = B) in
                        (
                            {10600}if v_8367 then
                            (
                                {10601}let pkDisco_8368: bitstring = pub(skB) in
                                {10602}in(c, (=pkCli_8356,em1_8369: bitstring,sigM1_8370: bitstring));
                                {10603}let m1_8371: bitstring = dec(em1_8369,skSess_8353) in
                                {10604}if (verify(m1_8371,sigM1_8370,pkCli_8356) <> true) then
                                    0
                                else
                                    {10605}let (SPc_8372: bitstring,PartC_8373: bitstring) = m1_8371 in
                                    {10606}event endSrv(Cli_5510,Sess_5512,PartC_8373);
                                    {10607}new Ns_8374: bitstring;
                                    {10608}let gNs_8375: bitstring = exp(g,Ns_8374) in
                                    {10609}let m2_8376: bitstring = gNs_8375 in
                                    {10610}out(c, (enc(m2_8376,pkCli_8356),sign(m2_8376,skSess_8353)));
                                    {10611}event beginSrv(Sess_5512,Cli_5510,gNs_8375)
                            )
                            else
                                {10612}let v_8377: bool = (Disco_5511 = C) in
                                (
                                    {10613}if v_8377 then
                                    (
                                        {10614}let pkDisco_8378: bitstring = pub(skC) in
                                        {10615}in(c, (=pkCli_8356,em1_8379: bitstring,sigM1_8380: bitstring));
                                        {10616}let m1_8381: bitstring = dec(em1_8379,skSess_8353) in
                                        {10617}if (verify(m1_8381,sigM1_8380,pkCli_8356) <> true) then
                                            0
                                        else
                                            {10618}let (SPc_8382: bitstring,PartC_8383: bitstring) = m1_8381 in
                                            {10619}event endSrv(Cli_5510,Sess_5512,PartC_8383);
                                            {10620}new Ns_8384: bitstring;
                                            {10621}let gNs_8385: bitstring = exp(g,Ns_8384) in
                                            {10622}let m2_8386: bitstring = gNs_8385 in
                                            {10623}out(c, (enc(m2_8386,pkCli_8356),sign(m2_8386,skSess_8353)));
                                            {10624}event beginSrv(Sess_5512,Cli_5510,gNs_8385)
                                    )
                                    else
                                        {10625}let pkDisco_8387: bitstring = pub(skI) in
                                        {10626}in(c, (=pkCli_8356,em1_8388: bitstring,sigM1_8389: bitstring));
                                        {10627}let m1_8390: bitstring = dec(em1_8388,skSess_8353) in
                                        {10628}if (verify(m1_8390,sigM1_8389,pkCli_8356) <> true) then
                                            0
                                        else
                                            {10629}let (SPc_8391: bitstring,PartC_8392: bitstring) = m1_8390 in
                                            {10630}event endSrv(Cli_5510,Sess_5512,PartC_8392);
                                            {10631}new Ns_8393: bitstring;
                                            {10632}let gNs_8394: bitstring = exp(g,Ns_8393) in
                                            {10633}let m2_8395: bitstring = gNs_8394 in
                                            {10634}out(c, (enc(m2_8395,pkCli_8356),sign(m2_8395,skSess_8353)));
                                            {10635}event beginSrv(Sess_5512,Cli_5510,gNs_8394)
                                )
                                else
                                    {10636}let pkDisco_8396: bitstring = fail-any in
                                    {10637}in(c, (=pkCli_8356,em1_8397: bitstring,sigM1_8398: bitstring));
                                    {10638}let m1_8399: bitstring = dec(em1_8397,skSess_8353) in
                                    {10639}if (verify(m1_8399,sigM1_8398,pkCli_8356) <> true) then
                                        0
                                    else
                                        {10640}let (SPc_8400: bitstring,PartC_8401: bitstring) = m1_8399 in
                                        {10641}event endSrv(Cli_5510,Sess_5512,PartC_8401);
                                        {10642}new Ns_8402: bitstring;
                                        {10643}let gNs_8403: bitstring = exp(g,Ns_8402) in
                                        {10644}let m2_8404: bitstring = gNs_8403 in
                                        {10645}out(c, (enc(m2_8404,pkCli_8356),sign(m2_8404,skSess_8353)));
                                        {10646}event beginSrv(Sess_5512,Cli_5510,gNs_8403)
                        )
                        else
                            {10647}let pkDisco_8405: bitstring = fail-any in
                            {10648}in(c, (=pkCli_8356,em1_8406: bitstring,sigM1_8407: bitstring));
                            {10649}let m1_8408: bitstring = dec(em1_8406,skSess_8353) in
                            {10650}if (verify(m1_8408,sigM1_8407,pkCli_8356) <> true) then
                                0
                            else
                                {10651}let (SPc_8409: bitstring,PartC_8410: bitstring) = m1_8408 in
                                {10652}event endSrv(Cli_5510,Sess_5512,PartC_8410);
                                {10653}new Ns_8411: bitstring;
                                {10654}let gNs_8412: bitstring = exp(g,Ns_8411) in
                                {10655}let m2_8413: bitstring = gNs_8412 in
                                {10656}out(c, (enc(m2_8413,pkCli_8356),sign(m2_8413,skSess_8353)));
                                {10657}event beginSrv(Sess_5512,Cli_5510,gNs_8412)
                )
                else
                    {10658}let pkDisco_8414: bitstring = fail-any in
                    {10659}in(c, (=pkCli_8356,em1_8415: bitstring,sigM1_8416: bitstring));
                    {10660}let m1_8417: bitstring = dec(em1_8415,skSess_8353) in
                    {10661}if (verify(m1_8417,sigM1_8416,pkCli_8356) <> true) then
                        0
                    else
                        {10662}let (SPc_8418: bitstring,PartC_8419: bitstring) = m1_8417 in
                        {10663}event endSrv(Cli_5510,Sess_5512,PartC_8419);
                        {10664}new Ns_8420: bitstring;
                        {10665}let gNs_8421: bitstring = exp(g,Ns_8420) in
                        {10666}let m2_8422: bitstring = gNs_8421 in
                        {10667}out(c, (enc(m2_8422,pkCli_8356),sign(m2_8422,skSess_8353)));
                        {10668}event beginSrv(Sess_5512,Cli_5510,gNs_8421)
            )
            else
                {10669}let v_8423: bool = (Cli_5510 = B) in
                (
                    {10670}if v_8423 then
                    (
                        {10671}let pkCli_8424: bitstring = pub(skB) in
                        {10672}let v_8425: bool = (Disco_5511 = A) in
                        (
                            {10673}if v_8425 then
                            (
                                {10674}let pkDisco_8426: bitstring = pub(skA) in
                                {10675}in(c, (=pkCli_8424,em1_8427: bitstring,sigM1_8428: bitstring));
                                {10676}let m1_8429: bitstring = dec(em1_8427,skSess_8353) in
                                {10677}if (verify(m1_8429,sigM1_8428,pkCli_8424) <> true) then
                                    0
                                else
                                    {10678}let (SPc_8430: bitstring,PartC_8431: bitstring) = m1_8429 in
                                    {10679}event endSrv(Cli_5510,Sess_5512,PartC_8431);
                                    {10680}new Ns_8432: bitstring;
                                    {10681}let gNs_8433: bitstring = exp(g,Ns_8432) in
                                    {10682}let m2_8434: bitstring = gNs_8433 in
                                    {10683}out(c, (enc(m2_8434,pkCli_8424),sign(m2_8434,skSess_8353)));
                                    {10684}event beginSrv(Sess_5512,Cli_5510,gNs_8433)
                            )
                            else
                                {10685}let v_8435: bool = (Disco_5511 = B) in
                                (
                                    {10686}if v_8435 then
                                    (
                                        {10687}let pkDisco_8436: bitstring = pub(skB) in
                                        {10688}in(c, (=pkCli_8424,em1_8437: bitstring,sigM1_8438: bitstring));
                                        {10689}let m1_8439: bitstring = dec(em1_8437,skSess_8353) in
                                        {10690}if (verify(m1_8439,sigM1_8438,pkCli_8424) <> true) then
                                            0
                                        else
                                            {10691}let (SPc_8440: bitstring,PartC_8441: bitstring) = m1_8439 in
                                            {10692}event endSrv(Cli_5510,Sess_5512,PartC_8441);
                                            {10693}new Ns_8442: bitstring;
                                            {10694}let gNs_8443: bitstring = exp(g,Ns_8442) in
                                            {10695}let m2_8444: bitstring = gNs_8443 in
                                            {10696}out(c, (enc(m2_8444,pkCli_8424),sign(m2_8444,skSess_8353)));
                                            {10697}event beginSrv(Sess_5512,Cli_5510,gNs_8443)
                                    )
                                    else
                                        {10698}let v_8445: bool = (Disco_5511 = C) in
                                        (
                                            {10699}if v_8445 then
                                            (
                                                {10700}let pkDisco_8446: bitstring = pub(skC) in
                                                {10701}in(c, (=pkCli_8424,em1_8447: bitstring,sigM1_8448: bitstring));
                                                {10702}let m1_8449: bitstring = dec(em1_8447,skSess_8353) in
                                                {10703}if (verify(m1_8449,sigM1_8448,pkCli_8424) <> true) then
                                                    0
                                                else
                                                    {10704}let (SPc_8450: bitstring,PartC_8451: bitstring) = m1_8449 in
                                                    {10705}event endSrv(Cli_5510,Sess_5512,PartC_8451);
                                                    {10706}new Ns_8452: bitstring;
                                                    {10707}let gNs_8453: bitstring = exp(g,Ns_8452) in
                                                    {10708}let m2_8454: bitstring = gNs_8453 in
                                                    {10709}out(c, (enc(m2_8454,pkCli_8424),sign(m2_8454,skSess_8353)));
                                                    {10710}event beginSrv(Sess_5512,Cli_5510,gNs_8453)
                                            )
                                            else
                                                {10711}let pkDisco_8455: bitstring = pub(skI) in
                                                {10712}in(c, (=pkCli_8424,em1_8456: bitstring,sigM1_8457: bitstring));
                                                {10713}let m1_8458: bitstring = dec(em1_8456,skSess_8353) in
                                                {10714}if (verify(m1_8458,sigM1_8457,pkCli_8424) <> true) then
                                                    0
                                                else
                                                    {10715}let (SPc_8459: bitstring,PartC_8460: bitstring) = m1_8458 in
                                                    {10716}event endSrv(Cli_5510,Sess_5512,PartC_8460);
                                                    {10717}new Ns_8461: bitstring;
                                                    {10718}let gNs_8462: bitstring = exp(g,Ns_8461) in
                                                    {10719}let m2_8463: bitstring = gNs_8462 in
                                                    {10720}out(c, (enc(m2_8463,pkCli_8424),sign(m2_8463,skSess_8353)));
                                                    {10721}event beginSrv(Sess_5512,Cli_5510,gNs_8462)
                                        )
                                        else
                                            {10722}let pkDisco_8464: bitstring = fail-any in
                                            {10723}in(c, (=pkCli_8424,em1_8465: bitstring,sigM1_8466: bitstring));
                                            {10724}let m1_8467: bitstring = dec(em1_8465,skSess_8353) in
                                            {10725}if (verify(m1_8467,sigM1_8466,pkCli_8424) <> true) then
                                                0
                                            else
                                                {10726}let (SPc_8468: bitstring,PartC_8469: bitstring) = m1_8467 in
                                                {10727}event endSrv(Cli_5510,Sess_5512,PartC_8469);
                                                {10728}new Ns_8470: bitstring;
                                                {10729}let gNs_8471: bitstring = exp(g,Ns_8470) in
                                                {10730}let m2_8472: bitstring = gNs_8471 in
                                                {10731}out(c, (enc(m2_8472,pkCli_8424),sign(m2_8472,skSess_8353)));
                                                {10732}event beginSrv(Sess_5512,Cli_5510,gNs_8471)
                                )
                                else
                                    {10733}let pkDisco_8473: bitstring = fail-any in
                                    {10734}in(c, (=pkCli_8424,em1_8474: bitstring,sigM1_8475: bitstring));
                                    {10735}let m1_8476: bitstring = dec(em1_8474,skSess_8353) in
                                    {10736}if (verify(m1_8476,sigM1_8475,pkCli_8424) <> true) then
                                        0
                                    else
                                        {10737}let (SPc_8477: bitstring,PartC_8478: bitstring) = m1_8476 in
                                        {10738}event endSrv(Cli_5510,Sess_5512,PartC_8478);
                                        {10739}new Ns_8479: bitstring;
                                        {10740}let gNs_8480: bitstring = exp(g,Ns_8479) in
                                        {10741}let m2_8481: bitstring = gNs_8480 in
                                        {10742}out(c, (enc(m2_8481,pkCli_8424),sign(m2_8481,skSess_8353)));
                                        {10743}event beginSrv(Sess_5512,Cli_5510,gNs_8480)
                        )
                        else
                            {10744}let pkDisco_8482: bitstring = fail-any in
                            {10745}in(c, (=pkCli_8424,em1_8483: bitstring,sigM1_8484: bitstring));
                            {10746}let m1_8485: bitstring = dec(em1_8483,skSess_8353) in
                            {10747}if (verify(m1_8485,sigM1_8484,pkCli_8424) <> true) then
                                0
                            else
                                {10748}let (SPc_8486: bitstring,PartC_8487: bitstring) = m1_8485 in
                                {10749}event endSrv(Cli_5510,Sess_5512,PartC_8487);
                                {10750}new Ns_8488: bitstring;
                                {10751}let gNs_8489: bitstring = exp(g,Ns_8488) in
                                {10752}let m2_8490: bitstring = gNs_8489 in
                                {10753}out(c, (enc(m2_8490,pkCli_8424),sign(m2_8490,skSess_8353)));
                                {10754}event beginSrv(Sess_5512,Cli_5510,gNs_8489)
                    )
                    else
                        {10755}let v_8491: bool = (Cli_5510 = C) in
                        (
                            {10756}if v_8491 then
                            (
                                {10757}let pkCli_8492: bitstring = pub(skC) in
                                {10758}let v_8493: bool = (Disco_5511 = A) in
                                (
                                    {10759}if v_8493 then
                                    (
                                        {10760}let pkDisco_8494: bitstring = pub(skA) in
                                        {10761}in(c, (=pkCli_8492,em1_8495: bitstring,sigM1_8496: bitstring));
                                        {10762}let m1_8497: bitstring = dec(em1_8495,skSess_8353) in
                                        {10763}if (verify(m1_8497,sigM1_8496,pkCli_8492) <> true) then
                                            0
                                        else
                                            {10764}let (SPc_8498: bitstring,PartC_8499: bitstring) = m1_8497 in
                                            {10765}event endSrv(Cli_5510,Sess_5512,PartC_8499);
                                            {10766}new Ns_8500: bitstring;
                                            {10767}let gNs_8501: bitstring = exp(g,Ns_8500) in
                                            {10768}let m2_8502: bitstring = gNs_8501 in
                                            {10769}out(c, (enc(m2_8502,pkCli_8492),sign(m2_8502,skSess_8353)));
                                            {10770}event beginSrv(Sess_5512,Cli_5510,gNs_8501)
                                    )
                                    else
                                        {10771}let v_8503: bool = (Disco_5511 = B) in
                                        (
                                            {10772}if v_8503 then
                                            (
                                                {10773}let pkDisco_8504: bitstring = pub(skB) in
                                                {10774}in(c, (=pkCli_8492,em1_8505: bitstring,sigM1_8506: bitstring));
                                                {10775}let m1_8507: bitstring = dec(em1_8505,skSess_8353) in
                                                {10776}if (verify(m1_8507,sigM1_8506,pkCli_8492) <> true) then
                                                    0
                                                else
                                                    {10777}let (SPc_8508: bitstring,PartC_8509: bitstring) = m1_8507 in
                                                    {10778}event endSrv(Cli_5510,Sess_5512,PartC_8509);
                                                    {10779}new Ns_8510: bitstring;
                                                    {10780}let gNs_8511: bitstring = exp(g,Ns_8510) in
                                                    {10781}let m2_8512: bitstring = gNs_8511 in
                                                    {10782}out(c, (enc(m2_8512,pkCli_8492),sign(m2_8512,skSess_8353)));
                                                    {10783}event beginSrv(Sess_5512,Cli_5510,gNs_8511)
                                            )
                                            else
                                                {10784}let v_8513: bool = (Disco_5511 = C) in
                                                (
                                                    {10785}if v_8513 then
                                                    (
                                                        {10786}let pkDisco_8514: bitstring = pub(skC) in
                                                        {10787}in(c, (=pkCli_8492,em1_8515: bitstring,sigM1_8516: bitstring));
                                                        {10788}let m1_8517: bitstring = dec(em1_8515,skSess_8353) in
                                                        {10789}if (verify(m1_8517,sigM1_8516,pkCli_8492) <> true) then
                                                            0
                                                        else
                                                            {10790}let (SPc_8518: bitstring,PartC_8519: bitstring) = m1_8517 in
                                                            {10791}event endSrv(Cli_5510,Sess_5512,PartC_8519);
                                                            {10792}new Ns_8520: bitstring;
                                                            {10793}let gNs_8521: bitstring = exp(g,Ns_8520) in
                                                            {10794}let m2_8522: bitstring = gNs_8521 in
                                                            {10795}out(c, (enc(m2_8522,pkCli_8492),sign(m2_8522,skSess_8353)));
                                                            {10796}event beginSrv(Sess_5512,Cli_5510,gNs_8521)
                                                    )
                                                    else
                                                        {10797}let pkDisco_8523: bitstring = pub(skI) in
                                                        {10798}in(c, (=pkCli_8492,em1_8524: bitstring,sigM1_8525: bitstring));
                                                        {10799}let m1_8526: bitstring = dec(em1_8524,skSess_8353) in
                                                        {10800}if (verify(m1_8526,sigM1_8525,pkCli_8492) <> true) then
                                                            0
                                                        else
                                                            {10801}let (SPc_8527: bitstring,PartC_8528: bitstring) = m1_8526 in
                                                            {10802}event endSrv(Cli_5510,Sess_5512,PartC_8528);
                                                            {10803}new Ns_8529: bitstring;
                                                            {10804}let gNs_8530: bitstring = exp(g,Ns_8529) in
                                                            {10805}let m2_8531: bitstring = gNs_8530 in
                                                            {10806}out(c, (enc(m2_8531,pkCli_8492),sign(m2_8531,skSess_8353)));
                                                            {10807}event beginSrv(Sess_5512,Cli_5510,gNs_8530)
                                                )
                                                else
                                                    {10808}let pkDisco_8532: bitstring = fail-any in
                                                    {10809}in(c, (=pkCli_8492,em1_8533: bitstring,sigM1_8534: bitstring));
                                                    {10810}let m1_8535: bitstring = dec(em1_8533,skSess_8353) in
                                                    {10811}if (verify(m1_8535,sigM1_8534,pkCli_8492) <> true) then
                                                        0
                                                    else
                                                        {10812}let (SPc_8536: bitstring,PartC_8537: bitstring) = m1_8535 in
                                                        {10813}event endSrv(Cli_5510,Sess_5512,PartC_8537);
                                                        {10814}new Ns_8538: bitstring;
                                                        {10815}let gNs_8539: bitstring = exp(g,Ns_8538) in
                                                        {10816}let m2_8540: bitstring = gNs_8539 in
                                                        {10817}out(c, (enc(m2_8540,pkCli_8492),sign(m2_8540,skSess_8353)));
                                                        {10818}event beginSrv(Sess_5512,Cli_5510,gNs_8539)
                                        )
                                        else
                                            {10819}let pkDisco_8541: bitstring = fail-any in
                                            {10820}in(c, (=pkCli_8492,em1_8542: bitstring,sigM1_8543: bitstring));
                                            {10821}let m1_8544: bitstring = dec(em1_8542,skSess_8353) in
                                            {10822}if (verify(m1_8544,sigM1_8543,pkCli_8492) <> true) then
                                                0
                                            else
                                                {10823}let (SPc_8545: bitstring,PartC_8546: bitstring) = m1_8544 in
                                                {10824}event endSrv(Cli_5510,Sess_5512,PartC_8546);
                                                {10825}new Ns_8547: bitstring;
                                                {10826}let gNs_8548: bitstring = exp(g,Ns_8547) in
                                                {10827}let m2_8549: bitstring = gNs_8548 in
                                                {10828}out(c, (enc(m2_8549,pkCli_8492),sign(m2_8549,skSess_8353)));
                                                {10829}event beginSrv(Sess_5512,Cli_5510,gNs_8548)
                                )
                                else
                                    {10830}let pkDisco_8550: bitstring = fail-any in
                                    {10831}in(c, (=pkCli_8492,em1_8551: bitstring,sigM1_8552: bitstring));
                                    {10832}let m1_8553: bitstring = dec(em1_8551,skSess_8353) in
                                    {10833}if (verify(m1_8553,sigM1_8552,pkCli_8492) <> true) then
                                        0
                                    else
                                        {10834}let (SPc_8554: bitstring,PartC_8555: bitstring) = m1_8553 in
                                        {10835}event endSrv(Cli_5510,Sess_5512,PartC_8555);
                                        {10836}new Ns_8556: bitstring;
                                        {10837}let gNs_8557: bitstring = exp(g,Ns_8556) in
                                        {10838}let m2_8558: bitstring = gNs_8557 in
                                        {10839}out(c, (enc(m2_8558,pkCli_8492),sign(m2_8558,skSess_8353)));
                                        {10840}event beginSrv(Sess_5512,Cli_5510,gNs_8557)
                            )
                            else
                                {10841}let pkCli_8559: bitstring = pub(skI) in
                                {10842}let v_8560: bool = (Disco_5511 = A) in
                                (
                                    {10843}if v_8560 then
                                    (
                                        {10844}let pkDisco_8561: bitstring = pub(skA) in
                                        {10845}in(c, (=pkCli_8559,em1_8562: bitstring,sigM1_8563: bitstring));
                                        {10846}let m1_8564: bitstring = dec(em1_8562,skSess_8353) in
                                        {10847}if (verify(m1_8564,sigM1_8563,pkCli_8559) <> true) then
                                            0
                                        else
                                            {10848}let (SPc_8565: bitstring,PartC_8566: bitstring) = m1_8564 in
                                            {10849}event endSrv(Cli_5510,Sess_5512,PartC_8566);
                                            {10850}new Ns_8567: bitstring;
                                            {10851}let gNs_8568: bitstring = exp(g,Ns_8567) in
                                            {10852}let m2_8569: bitstring = gNs_8568 in
                                            {10853}out(c, (enc(m2_8569,pkCli_8559),sign(m2_8569,skSess_8353)));
                                            {10854}event beginSrv(Sess_5512,Cli_5510,gNs_8568)
                                    )
                                    else
                                        {10855}let v_8570: bool = (Disco_5511 = B) in
                                        (
                                            {10856}if v_8570 then
                                            (
                                                {10857}let pkDisco_8571: bitstring = pub(skB) in
                                                {10858}in(c, (=pkCli_8559,em1_8572: bitstring,sigM1_8573: bitstring));
                                                {10859}let m1_8574: bitstring = dec(em1_8572,skSess_8353) in
                                                {10860}if (verify(m1_8574,sigM1_8573,pkCli_8559) <> true) then
                                                    0
                                                else
                                                    {10861}let (SPc_8575: bitstring,PartC_8576: bitstring) = m1_8574 in
                                                    {10862}event endSrv(Cli_5510,Sess_5512,PartC_8576);
                                                    {10863}new Ns_8577: bitstring;
                                                    {10864}let gNs_8578: bitstring = exp(g,Ns_8577) in
                                                    {10865}let m2_8579: bitstring = gNs_8578 in
                                                    {10866}out(c, (enc(m2_8579,pkCli_8559),sign(m2_8579,skSess_8353)));
                                                    {10867}event beginSrv(Sess_5512,Cli_5510,gNs_8578)
                                            )
                                            else
                                                {10868}let v_8580: bool = (Disco_5511 = C) in
                                                (
                                                    {10869}if v_8580 then
                                                    (
                                                        {10870}let pkDisco_8581: bitstring = pub(skC) in
                                                        {10871}in(c, (=pkCli_8559,em1_8582: bitstring,sigM1_8583: bitstring));
                                                        {10872}let m1_8584: bitstring = dec(em1_8582,skSess_8353) in
                                                        {10873}if (verify(m1_8584,sigM1_8583,pkCli_8559) <> true) then
                                                            0
                                                        else
                                                            {10874}let (SPc_8585: bitstring,PartC_8586: bitstring) = m1_8584 in
                                                            {10875}event endSrv(Cli_5510,Sess_5512,PartC_8586);
                                                            {10876}new Ns_8587: bitstring;
                                                            {10877}let gNs_8588: bitstring = exp(g,Ns_8587) in
                                                            {10878}let m2_8589: bitstring = gNs_8588 in
                                                            {10879}out(c, (enc(m2_8589,pkCli_8559),sign(m2_8589,skSess_8353)));
                                                            {10880}event beginSrv(Sess_5512,Cli_5510,gNs_8588)
                                                    )
                                                    else
                                                        {10881}let pkDisco_8590: bitstring = pub(skI) in
                                                        {10882}in(c, (=pkCli_8559,em1_8591: bitstring,sigM1_8592: bitstring));
                                                        {10883}let m1_8593: bitstring = dec(em1_8591,skSess_8353) in
                                                        {10884}if (verify(m1_8593,sigM1_8592,pkCli_8559) <> true) then
                                                            0
                                                        else
                                                            {10885}let (SPc_8594: bitstring,PartC_8595: bitstring) = m1_8593 in
                                                            {10886}event endSrv(Cli_5510,Sess_5512,PartC_8595);
                                                            {10887}new Ns_8596: bitstring;
                                                            {10888}let gNs_8597: bitstring = exp(g,Ns_8596) in
                                                            {10889}let m2_8598: bitstring = gNs_8597 in
                                                            {10890}out(c, (enc(m2_8598,pkCli_8559),sign(m2_8598,skSess_8353)));
                                                            {10891}event beginSrv(Sess_5512,Cli_5510,gNs_8597)
                                                )
                                                else
                                                    {10892}let pkDisco_8599: bitstring = fail-any in
                                                    {10893}in(c, (=pkCli_8559,em1_8600: bitstring,sigM1_8601: bitstring));
                                                    {10894}let m1_8602: bitstring = dec(em1_8600,skSess_8353) in
                                                    {10895}if (verify(m1_8602,sigM1_8601,pkCli_8559) <> true) then
                                                        0
                                                    else
                                                        {10896}let (SPc_8603: bitstring,PartC_8604: bitstring) = m1_8602 in
                                                        {10897}event endSrv(Cli_5510,Sess_5512,PartC_8604);
                                                        {10898}new Ns_8605: bitstring;
                                                        {10899}let gNs_8606: bitstring = exp(g,Ns_8605) in
                                                        {10900}let m2_8607: bitstring = gNs_8606 in
                                                        {10901}out(c, (enc(m2_8607,pkCli_8559),sign(m2_8607,skSess_8353)));
                                                        {10902}event beginSrv(Sess_5512,Cli_5510,gNs_8606)
                                        )
                                        else
                                            {10903}let pkDisco_8608: bitstring = fail-any in
                                            {10904}in(c, (=pkCli_8559,em1_8609: bitstring,sigM1_8610: bitstring));
                                            {10905}let m1_8611: bitstring = dec(em1_8609,skSess_8353) in
                                            {10906}if (verify(m1_8611,sigM1_8610,pkCli_8559) <> true) then
                                                0
                                            else
                                                {10907}let (SPc_8612: bitstring,PartC_8613: bitstring) = m1_8611 in
                                                {10908}event endSrv(Cli_5510,Sess_5512,PartC_8613);
                                                {10909}new Ns_8614: bitstring;
                                                {10910}let gNs_8615: bitstring = exp(g,Ns_8614) in
                                                {10911}let m2_8616: bitstring = gNs_8615 in
                                                {10912}out(c, (enc(m2_8616,pkCli_8559),sign(m2_8616,skSess_8353)));
                                                {10913}event beginSrv(Sess_5512,Cli_5510,gNs_8615)
                                )
                                else
                                    {10914}let pkDisco_8617: bitstring = fail-any in
                                    {10915}in(c, (=pkCli_8559,em1_8618: bitstring,sigM1_8619: bitstring));
                                    {10916}let m1_8620: bitstring = dec(em1_8618,skSess_8353) in
                                    {10917}if (verify(m1_8620,sigM1_8619,pkCli_8559) <> true) then
                                        0
                                    else
                                        {10918}let (SPc_8621: bitstring,PartC_8622: bitstring) = m1_8620 in
                                        {10919}event endSrv(Cli_5510,Sess_5512,PartC_8622);
                                        {10920}new Ns_8623: bitstring;
                                        {10921}let gNs_8624: bitstring = exp(g,Ns_8623) in
                                        {10922}let m2_8625: bitstring = gNs_8624 in
                                        {10923}out(c, (enc(m2_8625,pkCli_8559),sign(m2_8625,skSess_8353)));
                                        {10924}event beginSrv(Sess_5512,Cli_5510,gNs_8624)
                        )
                        else
                            {10925}let pkCli_8626: bitstring = fail-any in
                            {10926}let v_8627: bool = (Disco_5511 = A) in
                            (
                                {10927}if v_8627 then
                                (
                                    {10928}let pkDisco_8628: bitstring = pub(skA) in
                                    {10929}in(c, (=pkCli_8626,em1_8629: bitstring,sigM1_8630: bitstring));
                                    {10930}let m1_8631: bitstring = dec(em1_8629,skSess_8353) in
                                    {10931}if (verify(m1_8631,sigM1_8630,pkCli_8626) <> true) then
                                        0
                                    else
                                        {10932}let (SPc_8632: bitstring,PartC_8633: bitstring) = m1_8631 in
                                        {10933}event endSrv(Cli_5510,Sess_5512,PartC_8633);
                                        {10934}new Ns_8634: bitstring;
                                        {10935}let gNs_8635: bitstring = exp(g,Ns_8634) in
                                        {10936}let m2_8636: bitstring = gNs_8635 in
                                        {10937}out(c, (enc(m2_8636,pkCli_8626),sign(m2_8636,skSess_8353)));
                                        {10938}event beginSrv(Sess_5512,Cli_5510,gNs_8635)
                                )
                                else
                                    {10939}let v_8637: bool = (Disco_5511 = B) in
                                    (
                                        {10940}if v_8637 then
                                        (
                                            {10941}let pkDisco_8638: bitstring = pub(skB) in
                                            {10942}in(c, (=pkCli_8626,em1_8639: bitstring,sigM1_8640: bitstring));
                                            {10943}let m1_8641: bitstring = dec(em1_8639,skSess_8353) in
                                            {10944}if (verify(m1_8641,sigM1_8640,pkCli_8626) <> true) then
                                                0
                                            else
                                                {10945}let (SPc_8642: bitstring,PartC_8643: bitstring) = m1_8641 in
                                                {10946}event endSrv(Cli_5510,Sess_5512,PartC_8643);
                                                {10947}new Ns_8644: bitstring;
                                                {10948}let gNs_8645: bitstring = exp(g,Ns_8644) in
                                                {10949}let m2_8646: bitstring = gNs_8645 in
                                                {10950}out(c, (enc(m2_8646,pkCli_8626),sign(m2_8646,skSess_8353)));
                                                {10951}event beginSrv(Sess_5512,Cli_5510,gNs_8645)
                                        )
                                        else
                                            {10952}let v_8647: bool = (Disco_5511 = C) in
                                            (
                                                {10953}if v_8647 then
                                                (
                                                    {10954}let pkDisco_8648: bitstring = pub(skC) in
                                                    {10955}in(c, (=pkCli_8626,em1_8649: bitstring,sigM1_8650: bitstring));
                                                    {10956}let m1_8651: bitstring = dec(em1_8649,skSess_8353) in
                                                    {10957}if (verify(m1_8651,sigM1_8650,pkCli_8626) <> true) then
                                                        0
                                                    else
                                                        {10958}let (SPc_8652: bitstring,PartC_8653: bitstring) = m1_8651 in
                                                        {10959}event endSrv(Cli_5510,Sess_5512,PartC_8653);
                                                        {10960}new Ns_8654: bitstring;
                                                        {10961}let gNs_8655: bitstring = exp(g,Ns_8654) in
                                                        {10962}let m2_8656: bitstring = gNs_8655 in
                                                        {10963}out(c, (enc(m2_8656,pkCli_8626),sign(m2_8656,skSess_8353)));
                                                        {10964}event beginSrv(Sess_5512,Cli_5510,gNs_8655)
                                                )
                                                else
                                                    {10965}let pkDisco_8657: bitstring = pub(skI) in
                                                    {10966}in(c, (=pkCli_8626,em1_8658: bitstring,sigM1_8659: bitstring));
                                                    {10967}let m1_8660: bitstring = dec(em1_8658,skSess_8353) in
                                                    {10968}if (verify(m1_8660,sigM1_8659,pkCli_8626) <> true) then
                                                        0
                                                    else
                                                        {10969}let (SPc_8661: bitstring,PartC_8662: bitstring) = m1_8660 in
                                                        {10970}event endSrv(Cli_5510,Sess_5512,PartC_8662);
                                                        {10971}new Ns_8663: bitstring;
                                                        {10972}let gNs_8664: bitstring = exp(g,Ns_8663) in
                                                        {10973}let m2_8665: bitstring = gNs_8664 in
                                                        {10974}out(c, (enc(m2_8665,pkCli_8626),sign(m2_8665,skSess_8353)));
                                                        {10975}event beginSrv(Sess_5512,Cli_5510,gNs_8664)
                                            )
                                            else
                                                {10976}let pkDisco_8666: bitstring = fail-any in
                                                {10977}in(c, (=pkCli_8626,em1_8667: bitstring,sigM1_8668: bitstring));
                                                {10978}let m1_8669: bitstring = dec(em1_8667,skSess_8353) in
                                                {10979}if (verify(m1_8669,sigM1_8668,pkCli_8626) <> true) then
                                                    0
                                                else
                                                    {10980}let (SPc_8670: bitstring,PartC_8671: bitstring) = m1_8669 in
                                                    {10981}event endSrv(Cli_5510,Sess_5512,PartC_8671);
                                                    {10982}new Ns_8672: bitstring;
                                                    {10983}let gNs_8673: bitstring = exp(g,Ns_8672) in
                                                    {10984}let m2_8674: bitstring = gNs_8673 in
                                                    {10985}out(c, (enc(m2_8674,pkCli_8626),sign(m2_8674,skSess_8353)));
                                                    {10986}event beginSrv(Sess_5512,Cli_5510,gNs_8673)
                                    )
                                    else
                                        {10987}let pkDisco_8675: bitstring = fail-any in
                                        {10988}in(c, (=pkCli_8626,em1_8676: bitstring,sigM1_8677: bitstring));
                                        {10989}let m1_8678: bitstring = dec(em1_8676,skSess_8353) in
                                        {10990}if (verify(m1_8678,sigM1_8677,pkCli_8626) <> true) then
                                            0
                                        else
                                            {10991}let (SPc_8679: bitstring,PartC_8680: bitstring) = m1_8678 in
                                            {10992}event endSrv(Cli_5510,Sess_5512,PartC_8680);
                                            {10993}new Ns_8681: bitstring;
                                            {10994}let gNs_8682: bitstring = exp(g,Ns_8681) in
                                            {10995}let m2_8683: bitstring = gNs_8682 in
                                            {10996}out(c, (enc(m2_8683,pkCli_8626),sign(m2_8683,skSess_8353)));
                                            {10997}event beginSrv(Sess_5512,Cli_5510,gNs_8682)
                            )
                            else
                                {10998}let pkDisco_8684: bitstring = fail-any in
                                {10999}in(c, (=pkCli_8626,em1_8685: bitstring,sigM1_8686: bitstring));
                                {11000}let m1_8687: bitstring = dec(em1_8685,skSess_8353) in
                                {11001}if (verify(m1_8687,sigM1_8686,pkCli_8626) <> true) then
                                    0
                                else
                                    {11002}let (SPc_8688: bitstring,PartC_8689: bitstring) = m1_8687 in
                                    {11003}event endSrv(Cli_5510,Sess_5512,PartC_8689);
                                    {11004}new Ns_8690: bitstring;
                                    {11005}let gNs_8691: bitstring = exp(g,Ns_8690) in
                                    {11006}let m2_8692: bitstring = gNs_8691 in
                                    {11007}out(c, (enc(m2_8692,pkCli_8626),sign(m2_8692,skSess_8353)));
                                    {11008}event beginSrv(Sess_5512,Cli_5510,gNs_8691)
                )
                else
                    {11009}let pkCli_8693: bitstring = fail-any in
                    {11010}let v_8694: bool = (Disco_5511 = A) in
                    (
                        {11011}if v_8694 then
                        (
                            {11012}let pkDisco_8695: bitstring = pub(skA) in
                            {11013}in(c, (=pkCli_8693,em1_8696: bitstring,sigM1_8697: bitstring));
                            {11014}let m1_8698: bitstring = dec(em1_8696,skSess_8353) in
                            {11015}if (verify(m1_8698,sigM1_8697,pkCli_8693) <> true) then
                                0
                            else
                                {11016}let (SPc_8699: bitstring,PartC_8700: bitstring) = m1_8698 in
                                {11017}event endSrv(Cli_5510,Sess_5512,PartC_8700);
                                {11018}new Ns_8701: bitstring;
                                {11019}let gNs_8702: bitstring = exp(g,Ns_8701) in
                                {11020}let m2_8703: bitstring = gNs_8702 in
                                {11021}out(c, (enc(m2_8703,pkCli_8693),sign(m2_8703,skSess_8353)));
                                {11022}event beginSrv(Sess_5512,Cli_5510,gNs_8702)
                        )
                        else
                            {11023}let v_8704: bool = (Disco_5511 = B) in
                            (
                                {11024}if v_8704 then
                                (
                                    {11025}let pkDisco_8705: bitstring = pub(skB) in
                                    {11026}in(c, (=pkCli_8693,em1_8706: bitstring,sigM1_8707: bitstring));
                                    {11027}let m1_8708: bitstring = dec(em1_8706,skSess_8353) in
                                    {11028}if (verify(m1_8708,sigM1_8707,pkCli_8693) <> true) then
                                        0
                                    else
                                        {11029}let (SPc_8709: bitstring,PartC_8710: bitstring) = m1_8708 in
                                        {11030}event endSrv(Cli_5510,Sess_5512,PartC_8710);
                                        {11031}new Ns_8711: bitstring;
                                        {11032}let gNs_8712: bitstring = exp(g,Ns_8711) in
                                        {11033}let m2_8713: bitstring = gNs_8712 in
                                        {11034}out(c, (enc(m2_8713,pkCli_8693),sign(m2_8713,skSess_8353)));
                                        {11035}event beginSrv(Sess_5512,Cli_5510,gNs_8712)
                                )
                                else
                                    {11036}let v_8714: bool = (Disco_5511 = C) in
                                    (
                                        {11037}if v_8714 then
                                        (
                                            {11038}let pkDisco_8715: bitstring = pub(skC) in
                                            {11039}in(c, (=pkCli_8693,em1_8716: bitstring,sigM1_8717: bitstring));
                                            {11040}let m1_8718: bitstring = dec(em1_8716,skSess_8353) in
                                            {11041}if (verify(m1_8718,sigM1_8717,pkCli_8693) <> true) then
                                                0
                                            else
                                                {11042}let (SPc_8719: bitstring,PartC_8720: bitstring) = m1_8718 in
                                                {11043}event endSrv(Cli_5510,Sess_5512,PartC_8720);
                                                {11044}new Ns_8721: bitstring;
                                                {11045}let gNs_8722: bitstring = exp(g,Ns_8721) in
                                                {11046}let m2_8723: bitstring = gNs_8722 in
                                                {11047}out(c, (enc(m2_8723,pkCli_8693),sign(m2_8723,skSess_8353)));
                                                {11048}event beginSrv(Sess_5512,Cli_5510,gNs_8722)
                                        )
                                        else
                                            {11049}let pkDisco_8724: bitstring = pub(skI) in
                                            {11050}in(c, (=pkCli_8693,em1_8725: bitstring,sigM1_8726: bitstring));
                                            {11051}let m1_8727: bitstring = dec(em1_8725,skSess_8353) in
                                            {11052}if (verify(m1_8727,sigM1_8726,pkCli_8693) <> true) then
                                                0
                                            else
                                                {11053}let (SPc_8728: bitstring,PartC_8729: bitstring) = m1_8727 in
                                                {11054}event endSrv(Cli_5510,Sess_5512,PartC_8729);
                                                {11055}new Ns_8730: bitstring;
                                                {11056}let gNs_8731: bitstring = exp(g,Ns_8730) in
                                                {11057}let m2_8732: bitstring = gNs_8731 in
                                                {11058}out(c, (enc(m2_8732,pkCli_8693),sign(m2_8732,skSess_8353)));
                                                {11059}event beginSrv(Sess_5512,Cli_5510,gNs_8731)
                                    )
                                    else
                                        {11060}let pkDisco_8733: bitstring = fail-any in
                                        {11061}in(c, (=pkCli_8693,em1_8734: bitstring,sigM1_8735: bitstring));
                                        {11062}let m1_8736: bitstring = dec(em1_8734,skSess_8353) in
                                        {11063}if (verify(m1_8736,sigM1_8735,pkCli_8693) <> true) then
                                            0
                                        else
                                            {11064}let (SPc_8737: bitstring,PartC_8738: bitstring) = m1_8736 in
                                            {11065}event endSrv(Cli_5510,Sess_5512,PartC_8738);
                                            {11066}new Ns_8739: bitstring;
                                            {11067}let gNs_8740: bitstring = exp(g,Ns_8739) in
                                            {11068}let m2_8741: bitstring = gNs_8740 in
                                            {11069}out(c, (enc(m2_8741,pkCli_8693),sign(m2_8741,skSess_8353)));
                                            {11070}event beginSrv(Sess_5512,Cli_5510,gNs_8740)
                            )
                            else
                                {11071}let pkDisco_8742: bitstring = fail-any in
                                {11072}in(c, (=pkCli_8693,em1_8743: bitstring,sigM1_8744: bitstring));
                                {11073}let m1_8745: bitstring = dec(em1_8743,skSess_8353) in
                                {11074}if (verify(m1_8745,sigM1_8744,pkCli_8693) <> true) then
                                    0
                                else
                                    {11075}let (SPc_8746: bitstring,PartC_8747: bitstring) = m1_8745 in
                                    {11076}event endSrv(Cli_5510,Sess_5512,PartC_8747);
                                    {11077}new Ns_8748: bitstring;
                                    {11078}let gNs_8749: bitstring = exp(g,Ns_8748) in
                                    {11079}let m2_8750: bitstring = gNs_8749 in
                                    {11080}out(c, (enc(m2_8750,pkCli_8693),sign(m2_8750,skSess_8353)));
                                    {11081}event beginSrv(Sess_5512,Cli_5510,gNs_8749)
                    )
                    else
                        {11082}let pkDisco_8751: bitstring = fail-any in
                        {11083}in(c, (=pkCli_8693,em1_8752: bitstring,sigM1_8753: bitstring));
                        {11084}let m1_8754: bitstring = dec(em1_8752,skSess_8353) in
                        {11085}if (verify(m1_8754,sigM1_8753,pkCli_8693) <> true) then
                            0
                        else
                            {11086}let (SPc_8755: bitstring,PartC_8756: bitstring) = m1_8754 in
                            {11087}event endSrv(Cli_5510,Sess_5512,PartC_8756);
                            {11088}new Ns_8757: bitstring;
                            {11089}let gNs_8758: bitstring = exp(g,Ns_8757) in
                            {11090}let m2_8759: bitstring = gNs_8758 in
                            {11091}out(c, (enc(m2_8759,pkCli_8693),sign(m2_8759,skSess_8353)));
                            {11092}event beginSrv(Sess_5512,Cli_5510,gNs_8758)
        )
        else
            {11093}let pkCli_8760: bitstring = fail-any in
            {11094}let v_8761: bool = (Disco_5511 = A) in
            (
                {11095}if v_8761 then
                (
                    {11096}let pkDisco_8762: bitstring = pub(skA) in
                    {11097}in(c, (=pkCli_8760,em1_8763: bitstring,sigM1_8764: bitstring));
                    {11098}let m1_8765: bitstring = dec(em1_8763,skSess_8353) in
                    {11099}if (verify(m1_8765,sigM1_8764,pkCli_8760) <> true) then
                        0
                    else
                        {11100}let (SPc_8766: bitstring,PartC_8767: bitstring) = m1_8765 in
                        {11101}event endSrv(Cli_5510,Sess_5512,PartC_8767);
                        {11102}new Ns_8768: bitstring;
                        {11103}let gNs_8769: bitstring = exp(g,Ns_8768) in
                        {11104}let m2_8770: bitstring = gNs_8769 in
                        {11105}out(c, (enc(m2_8770,pkCli_8760),sign(m2_8770,skSess_8353)));
                        {11106}event beginSrv(Sess_5512,Cli_5510,gNs_8769)
                )
                else
                    {11107}let v_8771: bool = (Disco_5511 = B) in
                    (
                        {11108}if v_8771 then
                        (
                            {11109}let pkDisco_8772: bitstring = pub(skB) in
                            {11110}in(c, (=pkCli_8760,em1_8773: bitstring,sigM1_8774: bitstring));
                            {11111}let m1_8775: bitstring = dec(em1_8773,skSess_8353) in
                            {11112}if (verify(m1_8775,sigM1_8774,pkCli_8760) <> true) then
                                0
                            else
                                {11113}let (SPc_8776: bitstring,PartC_8777: bitstring) = m1_8775 in
                                {11114}event endSrv(Cli_5510,Sess_5512,PartC_8777);
                                {11115}new Ns_8778: bitstring;
                                {11116}let gNs_8779: bitstring = exp(g,Ns_8778) in
                                {11117}let m2_8780: bitstring = gNs_8779 in
                                {11118}out(c, (enc(m2_8780,pkCli_8760),sign(m2_8780,skSess_8353)));
                                {11119}event beginSrv(Sess_5512,Cli_5510,gNs_8779)
                        )
                        else
                            {11120}let v_8781: bool = (Disco_5511 = C) in
                            (
                                {11121}if v_8781 then
                                (
                                    {11122}let pkDisco_8782: bitstring = pub(skC) in
                                    {11123}in(c, (=pkCli_8760,em1_8783: bitstring,sigM1_8784: bitstring));
                                    {11124}let m1_8785: bitstring = dec(em1_8783,skSess_8353) in
                                    {11125}if (verify(m1_8785,sigM1_8784,pkCli_8760) <> true) then
                                        0
                                    else
                                        {11126}let (SPc_8786: bitstring,PartC_8787: bitstring) = m1_8785 in
                                        {11127}event endSrv(Cli_5510,Sess_5512,PartC_8787);
                                        {11128}new Ns_8788: bitstring;
                                        {11129}let gNs_8789: bitstring = exp(g,Ns_8788) in
                                        {11130}let m2_8790: bitstring = gNs_8789 in
                                        {11131}out(c, (enc(m2_8790,pkCli_8760),sign(m2_8790,skSess_8353)));
                                        {11132}event beginSrv(Sess_5512,Cli_5510,gNs_8789)
                                )
                                else
                                    {11133}let pkDisco_8791: bitstring = pub(skI) in
                                    {11134}in(c, (=pkCli_8760,em1_8792: bitstring,sigM1_8793: bitstring));
                                    {11135}let m1_8794: bitstring = dec(em1_8792,skSess_8353) in
                                    {11136}if (verify(m1_8794,sigM1_8793,pkCli_8760) <> true) then
                                        0
                                    else
                                        {11137}let (SPc_8795: bitstring,PartC_8796: bitstring) = m1_8794 in
                                        {11138}event endSrv(Cli_5510,Sess_5512,PartC_8796);
                                        {11139}new Ns_8797: bitstring;
                                        {11140}let gNs_8798: bitstring = exp(g,Ns_8797) in
                                        {11141}let m2_8799: bitstring = gNs_8798 in
                                        {11142}out(c, (enc(m2_8799,pkCli_8760),sign(m2_8799,skSess_8353)));
                                        {11143}event beginSrv(Sess_5512,Cli_5510,gNs_8798)
                            )
                            else
                                {11144}let pkDisco_8800: bitstring = fail-any in
                                {11145}in(c, (=pkCli_8760,em1_8801: bitstring,sigM1_8802: bitstring));
                                {11146}let m1_8803: bitstring = dec(em1_8801,skSess_8353) in
                                {11147}if (verify(m1_8803,sigM1_8802,pkCli_8760) <> true) then
                                    0
                                else
                                    {11148}let (SPc_8804: bitstring,PartC_8805: bitstring) = m1_8803 in
                                    {11149}event endSrv(Cli_5510,Sess_5512,PartC_8805);
                                    {11150}new Ns_8806: bitstring;
                                    {11151}let gNs_8807: bitstring = exp(g,Ns_8806) in
                                    {11152}let m2_8808: bitstring = gNs_8807 in
                                    {11153}out(c, (enc(m2_8808,pkCli_8760),sign(m2_8808,skSess_8353)));
                                    {11154}event beginSrv(Sess_5512,Cli_5510,gNs_8807)
                    )
                    else
                        {11155}let pkDisco_8809: bitstring = fail-any in
                        {11156}in(c, (=pkCli_8760,em1_8810: bitstring,sigM1_8811: bitstring));
                        {11157}let m1_8812: bitstring = dec(em1_8810,skSess_8353) in
                        {11158}if (verify(m1_8812,sigM1_8811,pkCli_8760) <> true) then
                            0
                        else
                            {11159}let (SPc_8813: bitstring,PartC_8814: bitstring) = m1_8812 in
                            {11160}event endSrv(Cli_5510,Sess_5512,PartC_8814);
                            {11161}new Ns_8815: bitstring;
                            {11162}let gNs_8816: bitstring = exp(g,Ns_8815) in
                            {11163}let m2_8817: bitstring = gNs_8816 in
                            {11164}out(c, (enc(m2_8817,pkCli_8760),sign(m2_8817,skSess_8353)));
                            {11165}event beginSrv(Sess_5512,Cli_5510,gNs_8816)
            )
            else
                {11166}let pkDisco_8818: bitstring = fail-any in
                {11167}in(c, (=pkCli_8760,em1_8819: bitstring,sigM1_8820: bitstring));
                {11168}let m1_8821: bitstring = dec(em1_8819,skSess_8353) in
                {11169}if (verify(m1_8821,sigM1_8820,pkCli_8760) <> true) then
                    0
                else
                    {11170}let (SPc_8822: bitstring,PartC_8823: bitstring) = m1_8821 in
                    {11171}event endSrv(Cli_5510,Sess_5512,PartC_8823);
                    {11172}new Ns_8824: bitstring;
                    {11173}let gNs_8825: bitstring = exp(g,Ns_8824) in
                    {11174}let m2_8826: bitstring = gNs_8825 in
                    {11175}out(c, (enc(m2_8826,pkCli_8760),sign(m2_8826,skSess_8353)));
                    {11176}event beginSrv(Sess_5512,Cli_5510,gNs_8825)
)

-- Query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
Completing...
200 rules inserted. The rule base contains 89 rules. 405 rules in the queue.
400 rules inserted. The rule base contains 172 rules. 402 rules in the queue.
600 rules inserted. The rule base contains 224 rules. 402 rules in the queue.
800 rules inserted. The rule base contains 307 rules. 399 rules in the queue.
1000 rules inserted. The rule base contains 338 rules. 394 rules in the queue.
1200 rules inserted. The rule base contains 376 rules. 356 rules in the queue.
1400 rules inserted. The rule base contains 413 rules. 1281 rules in the queue.
1600 rules inserted. The rule base contains 519 rules. 1151 rules in the queue.
1800 rules inserted. The rule base contains 666 rules. 2000 rules in the queue.
2000 rules inserted. The rule base contains 817 rules. 2863 rules in the queue.
2200 rules inserted. The rule base contains 962 rules. 3048 rules in the queue.
2400 rules inserted. The rule base contains 1107 rules. 3538 rules in the queue.
2600 rules inserted. The rule base contains 1261 rules. 3447 rules in the queue.
2800 rules inserted. The rule base contains 1224 rules. 3125 rules in the queue.
3000 rules inserted. The rule base contains 1368 rules. 3022 rules in the queue.
3200 rules inserted. The rule base contains 1530 rules. 3084 rules in the queue.
3400 rules inserted. The rule base contains 1685 rules. 3122 rules in the queue.
3600 rules inserted. The rule base contains 1829 rules. 3039 rules in the queue.
3800 rules inserted. The rule base contains 1975 rules. 3070 rules in the queue.
4000 rules inserted. The rule base contains 2126 rules. 3054 rules in the queue.
4200 rules inserted. The rule base contains 2274 rules. 3024 rules in the queue.
4400 rules inserted. The rule base contains 2425 rules. 2926 rules in the queue.
4600 rules inserted. The rule base contains 2573 rules. 3055 rules in the queue.
4800 rules inserted. The rule base contains 2735 rules. 3039 rules in the queue.
5000 rules inserted. The rule base contains 2886 rules. 2938 rules in the queue.
5200 rules inserted. The rule base contains 3025 rules. 2828 rules in the queue.
5400 rules inserted. The rule base contains 3181 rules. 2704 rules in the queue.
5600 rules inserted. The rule base contains 3339 rules. 2578 rules in the queue.
5800 rules inserted. The rule base contains 3525 rules. 2507 rules in the queue.
6000 rules inserted. The rule base contains 3663 rules. 2411 rules in the queue.
6200 rules inserted. The rule base contains 3760 rules. 2343 rules in the queue.
6400 rules inserted. The rule base contains 3904 rules. 2221 rules in the queue.
6600 rules inserted. The rule base contains 4033 rules. 2120 rules in the queue.
6800 rules inserted. The rule base contains 4155 rules. 2048 rules in the queue.
7000 rules inserted. The rule base contains 4241 rules. 1963 rules in the queue.
7200 rules inserted. The rule base contains 4385 rules. 1831 rules in the queue.
7400 rules inserted. The rule base contains 4483 rules. 1768 rules in the queue.
7600 rules inserted. The rule base contains 4620 rules. 1660 rules in the queue.
7800 rules inserted. The rule base contains 4777 rules. 1531 rules in the queue.
8000 rules inserted. The rule base contains 4859 rules. 1435 rules in the queue.
8200 rules inserted. The rule base contains 4924 rules. 1426 rules in the queue.
8400 rules inserted. The rule base contains 4984 rules. 1414 rules in the queue.
8600 rules inserted. The rule base contains 5030 rules. 1345 rules in the queue.
8800 rules inserted. The rule base contains 5055 rules. 1315 rules in the queue.
9000 rules inserted. The rule base contains 5091 rules. 1277 rules in the queue.
9200 rules inserted. The rule base contains 5120 rules. 1243 rules in the queue.
9400 rules inserted. The rule base contains 5099 rules. 1233 rules in the queue.
9600 rules inserted. The rule base contains 5070 rules. 1222 rules in the queue.
9800 rules inserted. The rule base contains 5102 rules. 1233 rules in the queue.
10000 rules inserted. The rule base contains 5125 rules. 1257 rules in the queue.
10200 rules inserted. The rule base contains 5174 rules. 1264 rules in the queue.
10400 rules inserted. The rule base contains 5212 rules. 1273 rules in the queue.
10600 rules inserted. The rule base contains 5248 rules. 1302 rules in the queue.
10800 rules inserted. The rule base contains 5278 rules. 1319 rules in the queue.
11000 rules inserted. The rule base contains 5325 rules. 1335 rules in the queue.
11200 rules inserted. The rule base contains 5424 rules. 1408 rules in the queue.
11400 rules inserted. The rule base contains 5505 rules. 1468 rules in the queue.
11600 rules inserted. The rule base contains 5603 rules. 1525 rules in the queue.
11800 rules inserted. The rule base contains 5686 rules. 1600 rules in the queue.
12000 rules inserted. The rule base contains 5790 rules. 1652 rules in the queue.
12200 rules inserted. The rule base contains 5908 rules. 1713 rules in the queue.
12400 rules inserted. The rule base contains 5970 rules. 1701 rules in the queue.
12600 rules inserted. The rule base contains 6100 rules. 1683 rules in the queue.
12800 rules inserted. The rule base contains 6232 rules. 1656 rules in the queue.
13000 rules inserted. The rule base contains 6362 rules. 1631 rules in the queue.
13200 rules inserted. The rule base contains 6485 rules. 1603 rules in the queue.
13400 rules inserted. The rule base contains 6609 rules. 1575 rules in the queue.
13600 rules inserted. The rule base contains 6725 rules. 1550 rules in the queue.
13800 rules inserted. The rule base contains 6831 rules. 1542 rules in the queue.
14000 rules inserted. The rule base contains 6932 rules. 1466 rules in the queue.
14200 rules inserted. The rule base contains 7053 rules. 1420 rules in the queue.
14400 rules inserted. The rule base contains 7175 rules. 1360 rules in the queue.
14600 rules inserted. The rule base contains 7296 rules. 1306 rules in the queue.
14800 rules inserted. The rule base contains 7425 rules. 1254 rules in the queue.
15000 rules inserted. The rule base contains 7529 rules. 1219 rules in the queue.
15200 rules inserted. The rule base contains 7578 rules. 1156 rules in the queue.
15400 rules inserted. The rule base contains 7660 rules. 1146 rules in the queue.
15600 rules inserted. The rule base contains 7762 rules. 1126 rules in the queue.
15800 rules inserted. The rule base contains 7867 rules. 1124 rules in the queue.
16000 rules inserted. The rule base contains 7979 rules. 1118 rules in the queue.
16200 rules inserted. The rule base contains 8056 rules. 1138 rules in the queue.
16400 rules inserted. The rule base contains 8078 rules. 1096 rules in the queue.
16600 rules inserted. The rule base contains 8198 rules. 1116 rules in the queue.
16800 rules inserted. The rule base contains 8330 rules. 1098 rules in the queue.
17000 rules inserted. The rule base contains 8448 rules. 1118 rules in the queue.
17200 rules inserted. The rule base contains 8570 rules. 1093 rules in the queue.
17400 rules inserted. The rule base contains 8624 rules. 1056 rules in the queue.
17600 rules inserted. The rule base contains 8716 rules. 983 rules in the queue.
17800 rules inserted. The rule base contains 8840 rules. 919 rules in the queue.
18000 rules inserted. The rule base contains 8963 rules. 841 rules in the queue.
18200 rules inserted. The rule base contains 9093 rules. 771 rules in the queue.
18400 rules inserted. The rule base contains 9179 rules. 693 rules in the queue.
18600 rules inserted. The rule base contains 9265 rules. 611 rules in the queue.
18800 rules inserted. The rule base contains 9388 rules. 498 rules in the queue.
19000 rules inserted. The rule base contains 9512 rules. 384 rules in the queue.
19200 rules inserted. The rule base contains 9603 rules. 293 rules in the queue.
19400 rules inserted. The rule base contains 9702 rules. 194 rules in the queue.
19600 rules inserted. The rule base contains 9782 rules. 114 rules in the queue.
Starting query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
goal reachable: Sess_215988 <> C[] && Sess_215988 <> B[] && Sess_215988 <> A[] && attacker(SPs_215986) && attacker(UP_215987) && attacker(Sess_215988) -> end(endCli(C[],B[],exp(g,Ns_6536[sigM1_6532 = sign((SPc_1296[UP_1295 = UP_215987,SPs_1294 = SPs_215986,Sess = Sess_215988,Disco = C[],Cli = B[],!1 = @sid_215989],exp(g,Nc_1297[UP_1295 = UP_215987,SPs_1294 = SPs_215986,Sess = Sess_215988,Disco = C[],Cli = B[],!1 = @sid_215989])),skB[]),em1_6531 = enc((SPc_1296[UP_1295 = UP_215987,SPs_1294 = SPs_215986,Sess = Sess_215988,Disco = C[],Cli = B[],!1 = @sid_215989],exp(g,Nc_1297[UP_1295 = UP_215987,SPs_1294 = SPs_215986,Sess = Sess_215988,Disco = C[],Cli = B[],!1 = @sid_215989])),pub(skC[])),Sess_5512 = C[],Disco_5511 = A[],Cli_5510 = B[],!1 = @sid_215990])))
Abbreviations:
SPc_220974 = SPc_1296[UP_1295 = UP_220938,SPs_1294 = SPs_220937,Sess = Sess_220939,Disco = C[],Cli = B[],!1 = @sid_220940]
Nc_220975 = Nc_1297[UP_1295 = UP_220938,SPs_1294 = SPs_220937,Sess = Sess_220939,Disco = C[],Cli = B[],!1 = @sid_220940]
Ns_220976 = Ns_6536[sigM1_6532 = sign((SPc_220974,exp(g,Nc_220975)),skB[]),em1_6531 = enc((SPc_220974,exp(g,Nc_220975)),pub(skC[])),Sess_5512 = C[],Disco_5511 = A[],Cli_5510 = B[],!1 = @sid_220956]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (B[],B[],C[]).
attacker((B[],B[],C[])).

4. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

5. The attacker has some term UP_220970.
attacker(UP_220970).

6. Using the function SignAndEncrypt the attacker may obtain SignAndEncrypt.
attacker(SignAndEncrypt).

7. The attacker has some term SPs_220969.
attacker(SPs_220969).

8. By 7, the attacker may know SPs_220969.
By 6, the attacker may know SignAndEncrypt.
By 5, the attacker may know UP_220970.
By 4, the attacker may know pub(skC[]).
Using the function 4-tuple the attacker may obtain (SPs_220969,SignAndEncrypt,UP_220970,pub(skC[])).
attacker((SPs_220969,SignAndEncrypt,UP_220970,pub(skC[]))).

9. The attacker initially knows A[].
attacker(A[]).

10. By 2, the attacker may know B[].
By 9, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (B[],A[],C[]).
attacker((B[],A[],C[])).

11. We assume as hypothesis that
attacker(Sess_220939).

12. By 2, the attacker may know B[].
By 1, the attacker may know C[].
By 11, the attacker may know Sess_220939.
Using the function 3-tuple the attacker may obtain (B[],C[],Sess_220939).
attacker((B[],C[],Sess_220939)).

13. The message skI[] may be sent to the attacker at output {8}.
attacker(skI[]).

14. By 13, the attacker may know skI[].
Using the function pub the attacker may obtain pub(skI[]).
attacker(pub(skI[])).

15. We assume as hypothesis that
attacker(UP_220938).

16. We assume as hypothesis that
attacker(SPs_220937).

17. By 16, the attacker may know SPs_220937.
By 6, the attacker may know SignAndEncrypt.
By 15, the attacker may know UP_220938.
By 14, the attacker may know pub(skI[]).
Using the function 4-tuple the attacker may obtain (SPs_220937,SignAndEncrypt,UP_220938,pub(skI[])).
attacker((SPs_220937,SignAndEncrypt,UP_220938,pub(skI[]))).

18. The message (B[],C[],Sess_220939) that the attacker may have by 12 may be received at input {10}.
The message (SPs_220937,SignAndEncrypt,UP_220938,pub(skI[])) that the attacker may have by 17 may be received at input {961}.
We have Sess_220939 <> C[] & Sess_220939 <> B[] & Sess_220939 <> A[].
So the message (pub(skB[]),enc((SPc_220974,exp(g,Nc_220975)),pub(skI[])),sign((SPc_220974,exp(g,Nc_220975)),skB[])) may be sent to the attacker at output {966}.
attacker((pub(skB[]),enc((SPc_220974,exp(g,Nc_220975)),pub(skI[])),sign((SPc_220974,exp(g,Nc_220975)),skB[]))).

19. By 18, the attacker may know (pub(skB[]),enc((SPc_220974,exp(g,Nc_220975)),pub(skI[])),sign((SPc_220974,exp(g,Nc_220975)),skB[])).
Using the function 3-proj-3-tuple the attacker may obtain sign((SPc_220974,exp(g,Nc_220975)),skB[]).
attacker(sign((SPc_220974,exp(g,Nc_220975)),skB[])).

20. By 18, the attacker may know (pub(skB[]),enc((SPc_220974,exp(g,Nc_220975)),pub(skI[])),sign((SPc_220974,exp(g,Nc_220975)),skB[])).
Using the function 2-proj-3-tuple the attacker may obtain enc((SPc_220974,exp(g,Nc_220975)),pub(skI[])).
attacker(enc((SPc_220974,exp(g,Nc_220975)),pub(skI[]))).

21. By 20, the attacker may know enc((SPc_220974,exp(g,Nc_220975)),pub(skI[])).
By 13, the attacker may know skI[].
Using the function dec the attacker may obtain (SPc_220974,exp(g,Nc_220975)).
attacker((SPc_220974,exp(g,Nc_220975))).

22. By 21, the attacker may know (SPc_220974,exp(g,Nc_220975)).
Using the function 2-proj-2-tuple the attacker may obtain exp(g,Nc_220975).
attacker(exp(g,Nc_220975)).

23. By 21, the attacker may know (SPc_220974,exp(g,Nc_220975)).
Using the function 1-proj-2-tuple the attacker may obtain SPc_220974.
attacker(SPc_220974).

24. By 23, the attacker may know SPc_220974.
By 22, the attacker may know exp(g,Nc_220975).
Using the function 2-tuple the attacker may obtain (SPc_220974,exp(g,Nc_220975)).
attacker((SPc_220974,exp(g,Nc_220975))).

25. By 24, the attacker may know (SPc_220974,exp(g,Nc_220975)).
By 4, the attacker may know pub(skC[]).
Using the function enc the attacker may obtain enc((SPc_220974,exp(g,Nc_220975)),pub(skC[])).
attacker(enc((SPc_220974,exp(g,Nc_220975)),pub(skC[]))).

26. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

27. By 26, the attacker may know pub(skB[]).
By 25, the attacker may know enc((SPc_220974,exp(g,Nc_220975)),pub(skC[])).
By 19, the attacker may know sign((SPc_220974,exp(g,Nc_220975)),skB[]).
Using the function 3-tuple the attacker may obtain (pub(skB[]),enc((SPc_220974,exp(g,Nc_220975)),pub(skC[])),sign((SPc_220974,exp(g,Nc_220975)),skB[])).
attacker((pub(skB[]),enc((SPc_220974,exp(g,Nc_220975)),pub(skC[])),sign((SPc_220974,exp(g,Nc_220975)),skB[]))).

28. The message (B[],A[],C[]) that the attacker may have by 10 may be received at input {6998}.
The message (pub(skB[]),enc((SPc_220974,exp(g,Nc_220975)),pub(skC[])),sign((SPc_220974,exp(g,Nc_220975)),skB[])) that the attacker may have by 27 may be received at input {8291}.
So the message (enc(exp(g,Ns_220976),pub(skB[])),sign(exp(g,Ns_220976),skC[])) may be sent to the attacker at output {8299}.
attacker((enc(exp(g,Ns_220976),pub(skB[])),sign(exp(g,Ns_220976),skC[]))).

29. By 28, the attacker may know (enc(exp(g,Ns_220976),pub(skB[])),sign(exp(g,Ns_220976),skC[])).
Using the function 2-proj-2-tuple the attacker may obtain sign(exp(g,Ns_220976),skC[]).
attacker(sign(exp(g,Ns_220976),skC[])).

30. By 28, the attacker may know (enc(exp(g,Ns_220976),pub(skB[])),sign(exp(g,Ns_220976),skC[])).
Using the function 1-proj-2-tuple the attacker may obtain enc(exp(g,Ns_220976),pub(skB[])).
attacker(enc(exp(g,Ns_220976),pub(skB[]))).

31. By 30, the attacker may know enc(exp(g,Ns_220976),pub(skB[])).
By 29, the attacker may know sign(exp(g,Ns_220976),skC[]).
Using the function 2-tuple the attacker may obtain (enc(exp(g,Ns_220976),pub(skB[])),sign(exp(g,Ns_220976),skC[])).
attacker((enc(exp(g,Ns_220976),pub(skB[])),sign(exp(g,Ns_220976),skC[]))).

32. The message (B[],B[],C[]) that the attacker may have by 3 may be received at input {10}.
The message (SPs_220969,SignAndEncrypt,UP_220970,pub(skC[])) that the attacker may have by 8 may be received at input {848}.
The message (enc(exp(g,Ns_220976),pub(skB[])),sign(exp(g,Ns_220976),skC[])) that the attacker may have by 31 may be received at input {855}.
So event endCli(C[],B[],exp(g,Ns_220976)) may be executed at {858}.
end(endCli(C[],B[],exp(g,Ns_220976))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

new skI creating skI_220987 at {7}

out(c, skI_220987) at {8}

in(c, (B,C,a_220978)) at {10} in copy a_220979

out(c, GetEndpointRequest) at {960} in copy a_220979

in(c, (a_220977,SignAndEncrypt,a,pub(skI_220987))) at {961} in copy a_220979

new SPc_1296 creating SPc_220984 at {962} in copy a_220979

new Nc_1297 creating Nc_220985 at {963} in copy a_220979

out(c, (pub(skB),enc((SPc_220984,exp(g,Nc_220985)),pub(skI_220987)),sign((SPc_220984,exp(g,Nc_220985)),skB))) at {966} in copy a_220979

event(beginCli(B,a_220978,exp(g,Nc_220985))) at {967} in copy a_220979

in(c, (B,B,C)) at {10} in copy a_220983

out(c, GetEndpointRequest) at {847} in copy a_220983

in(c, (a_220981,SignAndEncrypt,a_220982,pub(skC))) at {848} in copy a_220983

new SPc_1211 creating SPc_267445 at {849} in copy a_220983

new Nc_1212 creating Nc_267446 at {850} in copy a_220983

out(c, (pub(skB),enc((SPc_267445,exp(g,Nc_267446)),pub(skC)),sign((SPc_267445,exp(g,Nc_267446)),skB))) at {853} in copy a_220983

event(beginCli(B,C,exp(g,Nc_267446))) at {854} in copy a_220983

in(c, (B,A,C)) at {6998} in copy a_220980

in(c, (pub(skB),enc((SPc_220984,exp(g,Nc_220985)),pub(skC)),sign((SPc_220984,exp(g,Nc_220985)),skB))) at {8291} in copy a_220980

event(endSrv(B,C,exp(g,Nc_220985))) at {8295} in copy a_220980

new Ns_6536 creating Ns_220986 at {8296} in copy a_220980

out(c, (enc(exp(g,Ns_220986),pub(skB)),sign(exp(g,Ns_220986),skC))) at {8299} in copy a_220980

in(c, (enc(exp(g,Ns_220986),pub(skB)),sign(exp(g,Ns_220986),skC))) at {855} in copy a_220983

event(endCli(C,B,exp(g,Ns_220986))) at {858} in copy a_220983

The event endCli(C,B,exp(g,Ns_220986)) is executed.
A trace has been found.
RESULT event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N)) is false.
-- Query event(endSrv(A[],X_277149,N_277150)) ==> event(beginCli(A[],X_277149,N_277150))
Completing...
200 rules inserted. The rule base contains 73 rules. 405 rules in the queue.
400 rules inserted. The rule base contains 172 rules. 402 rules in the queue.
600 rules inserted. The rule base contains 217 rules. 402 rules in the queue.
800 rules inserted. The rule base contains 316 rules. 399 rules in the queue.
1000 rules inserted. The rule base contains 335 rules. 394 rules in the queue.
1200 rules inserted. The rule base contains 373 rules. 356 rules in the queue.
1400 rules inserted. The rule base contains 421 rules. 1270 rules in the queue.
1600 rules inserted. The rule base contains 518 rules. 1144 rules in the queue.
1800 rules inserted. The rule base contains 666 rules. 1990 rules in the queue.
2000 rules inserted. The rule base contains 818 rules. 2850 rules in the queue.
2200 rules inserted. The rule base contains 964 rules. 3176 rules in the queue.
2400 rules inserted. The rule base contains 1110 rules. 3485 rules in the queue.
2600 rules inserted. The rule base contains 1265 rules. 3401 rules in the queue.
2800 rules inserted. The rule base contains 1205 rules. 3036 rules in the queue.
3000 rules inserted. The rule base contains 1349 rules. 2924 rules in the queue.
3200 rules inserted. The rule base contains 1513 rules. 2970 rules in the queue.
3400 rules inserted. The rule base contains 1654 rules. 2999 rules in the queue.
3600 rules inserted. The rule base contains 1812 rules. 2909 rules in the queue.
3800 rules inserted. The rule base contains 1958 rules. 2929 rules in the queue.
4000 rules inserted. The rule base contains 2111 rules. 2922 rules in the queue.
4200 rules inserted. The rule base contains 2257 rules. 2868 rules in the queue.
4400 rules inserted. The rule base contains 2410 rules. 2779 rules in the queue.
4600 rules inserted. The rule base contains 2556 rules. 2881 rules in the queue.
4800 rules inserted. The rule base contains 2710 rules. 2863 rules in the queue.
5000 rules inserted. The rule base contains 2855 rules. 2746 rules in the queue.
5200 rules inserted. The rule base contains 3008 rules. 2629 rules in the queue.
5400 rules inserted. The rule base contains 3168 rules. 2487 rules in the queue.
5600 rules inserted. The rule base contains 3323 rules. 2341 rules in the queue.
5800 rules inserted. The rule base contains 3488 rules. 2297 rules in the queue.
6000 rules inserted. The rule base contains 3585 rules. 2188 rules in the queue.
6200 rules inserted. The rule base contains 3738 rules. 2087 rules in the queue.
6400 rules inserted. The rule base contains 3873 rules. 1958 rules in the queue.
6600 rules inserted. The rule base contains 3981 rules. 1876 rules in the queue.
6800 rules inserted. The rule base contains 4118 rules. 1741 rules in the queue.
7000 rules inserted. The rule base contains 4219 rules. 1668 rules in the queue.
7200 rules inserted. The rule base contains 4300 rules. 1574 rules in the queue.
7400 rules inserted. The rule base contains 4453 rules. 1473 rules in the queue.
7600 rules inserted. The rule base contains 4597 rules. 1336 rules in the queue.
7800 rules inserted. The rule base contains 4680 rules. 1227 rules in the queue.
8000 rules inserted. The rule base contains 4727 rules. 1211 rules in the queue.
8200 rules inserted. The rule base contains 4773 rules. 1156 rules in the queue.
8400 rules inserted. The rule base contains 4756 rules. 1123 rules in the queue.
8600 rules inserted. The rule base contains 4787 rules. 1068 rules in the queue.
8800 rules inserted. The rule base contains 4800 rules. 1031 rules in the queue.
9000 rules inserted. The rule base contains 4783 rules. 998 rules in the queue.
9200 rules inserted. The rule base contains 4711 rules. 991 rules in the queue.
9400 rules inserted. The rule base contains 4716 rules. 971 rules in the queue.
9600 rules inserted. The rule base contains 4739 rules. 938 rules in the queue.
9800 rules inserted. The rule base contains 4777 rules. 901 rules in the queue.
10000 rules inserted. The rule base contains 4791 rules. 886 rules in the queue.
10200 rules inserted. The rule base contains 4827 rules. 837 rules in the queue.
10400 rules inserted. The rule base contains 4896 rules. 791 rules in the queue.
10600 rules inserted. The rule base contains 4961 rules. 750 rules in the queue.
10800 rules inserted. The rule base contains 5037 rules. 703 rules in the queue.
11000 rules inserted. The rule base contains 5111 rules. 646 rules in the queue.
11200 rules inserted. The rule base contains 5204 rules. 580 rules in the queue.
11400 rules inserted. The rule base contains 5281 rules. 524 rules in the queue.
11600 rules inserted. The rule base contains 5364 rules. 462 rules in the queue.
11800 rules inserted. The rule base contains 5472 rules. 388 rules in the queue.
12000 rules inserted. The rule base contains 5543 rules. 333 rules in the queue.
12200 rules inserted. The rule base contains 5639 rules. 280 rules in the queue.
12400 rules inserted. The rule base contains 5749 rules. 209 rules in the queue.
12600 rules inserted. The rule base contains 5925 rules. 88 rules in the queue.
Starting query event(endSrv(A[],X_277149,N_277150)) ==> event(beginCli(A[],X_277149,N_277150))
goal reachable: Sess_415156 <> C[] && Sess_415156 <> B[] && Sess_415156 <> A[] && attacker(SPs_415154) && attacker(UP_415155) && attacker(Sess_415156) -> end(endSrv(A[],C[],exp(g,Nc_773[UP_771 = UP_415155,SPs_770 = SPs_415154,Sess = Sess_415156,Disco = C[],Cli = A[],!1 = @sid_415157])))
Abbreviations:
Nc_415493 = Nc_773[UP_771 = UP_415472,SPs_770 = SPs_415471,Sess = Sess_415473,Disco = C[],Cli = A[],!1 = @sid_415474]
SPc_415494 = SPc_772[UP_771 = UP_415472,SPs_770 = SPs_415471,Sess = Sess_415473,Disco = C[],Cli = A[],!1 = @sid_415474]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. We assume as hypothesis that
attacker(Sess_415473).

5. By 2, the attacker may know A[].
By 1, the attacker may know C[].
By 4, the attacker may know Sess_415473.
Using the function 3-tuple the attacker may obtain (A[],C[],Sess_415473).
attacker((A[],C[],Sess_415473)).

6. The message skI[] may be sent to the attacker at output {8}.
attacker(skI[]).

7. By 6, the attacker may know skI[].
Using the function pub the attacker may obtain pub(skI[]).
attacker(pub(skI[])).

8. We assume as hypothesis that
attacker(UP_415472).

9. Using the function SignAndEncrypt the attacker may obtain SignAndEncrypt.
attacker(SignAndEncrypt).

10. We assume as hypothesis that
attacker(SPs_415471).

11. By 10, the attacker may know SPs_415471.
By 9, the attacker may know SignAndEncrypt.
By 8, the attacker may know UP_415472.
By 7, the attacker may know pub(skI[]).
Using the function 4-tuple the attacker may obtain (SPs_415471,SignAndEncrypt,UP_415472,pub(skI[])).
attacker((SPs_415471,SignAndEncrypt,UP_415472,pub(skI[]))).

12. The message (A[],C[],Sess_415473) that the attacker may have by 5 may be received at input {10}.
The message (SPs_415471,SignAndEncrypt,UP_415472,pub(skI[])) that the attacker may have by 11 may be received at input {265}.
We have Sess_415473 <> C[] & Sess_415473 <> B[] & Sess_415473 <> A[].
So the message (pub(skA[]),enc((SPc_415494,exp(g,Nc_415493)),pub(skI[])),sign((SPc_415494,exp(g,Nc_415493)),skA[])) may be sent to the attacker at output {270}.
attacker((pub(skA[]),enc((SPc_415494,exp(g,Nc_415493)),pub(skI[])),sign((SPc_415494,exp(g,Nc_415493)),skA[]))).

13. By 12, the attacker may know (pub(skA[]),enc((SPc_415494,exp(g,Nc_415493)),pub(skI[])),sign((SPc_415494,exp(g,Nc_415493)),skA[])).
Using the function 3-proj-3-tuple the attacker may obtain sign((SPc_415494,exp(g,Nc_415493)),skA[]).
attacker(sign((SPc_415494,exp(g,Nc_415493)),skA[])).

14. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

15. By 12, the attacker may know (pub(skA[]),enc((SPc_415494,exp(g,Nc_415493)),pub(skI[])),sign((SPc_415494,exp(g,Nc_415493)),skA[])).
Using the function 2-proj-3-tuple the attacker may obtain enc((SPc_415494,exp(g,Nc_415493)),pub(skI[])).
attacker(enc((SPc_415494,exp(g,Nc_415493)),pub(skI[]))).

16. By 15, the attacker may know enc((SPc_415494,exp(g,Nc_415493)),pub(skI[])).
By 6, the attacker may know skI[].
Using the function dec the attacker may obtain (SPc_415494,exp(g,Nc_415493)).
attacker((SPc_415494,exp(g,Nc_415493))).

17. By 16, the attacker may know (SPc_415494,exp(g,Nc_415493)).
Using the function 2-proj-2-tuple the attacker may obtain exp(g,Nc_415493).
attacker(exp(g,Nc_415493)).

18. By 16, the attacker may know (SPc_415494,exp(g,Nc_415493)).
Using the function 1-proj-2-tuple the attacker may obtain SPc_415494.
attacker(SPc_415494).

19. By 18, the attacker may know SPc_415494.
By 17, the attacker may know exp(g,Nc_415493).
Using the function 2-tuple the attacker may obtain (SPc_415494,exp(g,Nc_415493)).
attacker((SPc_415494,exp(g,Nc_415493))).

20. By 19, the attacker may know (SPc_415494,exp(g,Nc_415493)).
By 14, the attacker may know pub(skC[]).
Using the function enc the attacker may obtain enc((SPc_415494,exp(g,Nc_415493)),pub(skC[])).
attacker(enc((SPc_415494,exp(g,Nc_415493)),pub(skC[]))).

21. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

22. By 21, the attacker may know pub(skA[]).
By 20, the attacker may know enc((SPc_415494,exp(g,Nc_415493)),pub(skC[])).
By 13, the attacker may know sign((SPc_415494,exp(g,Nc_415493)),skA[]).
Using the function 3-tuple the attacker may obtain (pub(skA[]),enc((SPc_415494,exp(g,Nc_415493)),pub(skC[])),sign((SPc_415494,exp(g,Nc_415493)),skA[])).
attacker((pub(skA[]),enc((SPc_415494,exp(g,Nc_415493)),pub(skC[])),sign((SPc_415494,exp(g,Nc_415493)),skA[]))).

23. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {6998}.
The message (pub(skA[]),enc((SPc_415494,exp(g,Nc_415493)),pub(skC[])),sign((SPc_415494,exp(g,Nc_415493)),skA[])) that the attacker may have by 22 may be received at input {8205}.
So event endSrv(A[],C[],exp(g,Nc_415493)) may be executed at {8209}.
end(endSrv(A[],C[],exp(g,Nc_415493))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

new skI creating skI_415502 at {7}

out(c, skI_415502) at {8}

in(c, (A,C,a_415497)) at {10} in copy a_415498

out(c, GetEndpointRequest) at {264} in copy a_415498

in(c, (a_415496,SignAndEncrypt,a_415495,pub(skI_415502))) at {265} in copy a_415498

new SPc_772 creating SPc_415501 at {266} in copy a_415498

new Nc_773 creating Nc_415500 at {267} in copy a_415498

out(c, (pub(skA),enc((SPc_415501,exp(g,Nc_415500)),pub(skI_415502)),sign((SPc_415501,exp(g,Nc_415500)),skA))) at {270} in copy a_415498

in(c, (A,A,C)) at {6998} in copy a_415499

in(c, (pub(skA),enc((SPc_415501,exp(g,Nc_415500)),pub(skC)),sign((SPc_415501,exp(g,Nc_415500)),skA))) at {8205} in copy a_415499

event(endSrv(A,C,exp(g,Nc_415500))) at {8209} in copy a_415499

The event endSrv(A,C,exp(g,Nc_415500)) is executed.
A trace has been found.
RESULT event(endSrv(A[],X_277149,N_277150)) ==> event(beginCli(A[],X_277149,N_277150)) is false.
