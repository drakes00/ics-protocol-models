Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
{7}new skI: bitstring;
{8}out(c, skI);
(
    {9}!
    {10}in(c, (Cli: host,Disco: host,Sess: host));
    {11}let v_594: bool = (Cli = A) in
    (
        {12}if v_594 then
        (
            {13}let skCli: bitstring = skA in
            {14}let pkCli: bitstring = pub(skCli) in
            {15}let v_595: bool = (Disco = A) in
            (
                {16}if v_595 then
                (
                    {17}let pkDisco: bitstring = pub(skA) in
                    {18}let v_596: bool = (Sess = A) in
                    (
                        {19}if v_596 then
                        (
                            {20}let pkSess: bitstring = pub(skA) in
                            {21}out(c, GetEndpointRequest);
                            {22}in(c, (SPs: bitstring,=Sign,UP: bitstring,=pkSess));
                            {23}new SPc: bitstring;
                            {24}new Nc: bitstring;
                            {25}let gNc: bitstring = exp(g,Nc) in
                            {26}let m1: bitstring = (SPc,gNc) in
                            {27}out(c, (pkCli,m1,sign(m1,skCli)));
                            {28}event beginCli(Cli,Sess,gNc);
                            {29}in(c, (PartS: bitstring,sigPartS: bitstring));
                            {30}if (verify(PartS,sigPartS,pkSess) <> true) then
                                0
                            else
                                {31}event endCli(Sess,Cli,PartS)
                        )
                        else
                            {32}let v_597: bool = (Sess = B) in
                            (
                                {33}if v_597 then
                                (
                                    {34}let pkSess_598: bitstring = pub(skB) in
                                    {35}out(c, GetEndpointRequest);
                                    {36}in(c, (SPs_599: bitstring,=Sign,UP_600: bitstring,=pkSess_598));
                                    {37}new SPc_601: bitstring;
                                    {38}new Nc_602: bitstring;
                                    {39}let gNc_603: bitstring = exp(g,Nc_602) in
                                    {40}let m1_604: bitstring = (SPc_601,gNc_603) in
                                    {41}out(c, (pkCli,m1_604,sign(m1_604,skCli)));
                                    {42}event beginCli(Cli,Sess,gNc_603);
                                    {43}in(c, (PartS_605: bitstring,sigPartS_606: bitstring));
                                    {44}if (verify(PartS_605,sigPartS_606,pkSess_598) <> true) then
                                        0
                                    else
                                        {45}event endCli(Sess,Cli,PartS_605)
                                )
                                else
                                    {46}let v_607: bool = (Sess = C) in
                                    (
                                        {47}if v_607 then
                                        (
                                            {48}let pkSess_608: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (SPs_609: bitstring,=Sign,UP_610: bitstring,=pkSess_608));
                                            {51}new SPc_611: bitstring;
                                            {52}new Nc_612: bitstring;
                                            {53}let gNc_613: bitstring = exp(g,Nc_612) in
                                            {54}let m1_614: bitstring = (SPc_611,gNc_613) in
                                            {55}out(c, (pkCli,m1_614,sign(m1_614,skCli)));
                                            {56}event beginCli(Cli,Sess,gNc_613);
                                            {57}in(c, (PartS_615: bitstring,sigPartS_616: bitstring));
                                            {58}if (verify(PartS_615,sigPartS_616,pkSess_608) <> true) then
                                                0
                                            else
                                                {59}event endCli(Sess,Cli,PartS_615)
                                        )
                                        else
                                            {60}let pkSess_617: bitstring = pub(skI) in
                                            {61}out(c, GetEndpointRequest);
                                            {62}in(c, (SPs_618: bitstring,=Sign,UP_619: bitstring,=pkSess_617));
                                            {63}new SPc_620: bitstring;
                                            {64}new Nc_621: bitstring;
                                            {65}let gNc_622: bitstring = exp(g,Nc_621) in
                                            {66}let m1_623: bitstring = (SPc_620,gNc_622) in
                                            {67}out(c, (pkCli,m1_623,sign(m1_623,skCli)));
                                            {68}event beginCli(Cli,Sess,gNc_622);
                                            {69}in(c, (PartS_624: bitstring,sigPartS_625: bitstring));
                                            {70}if (verify(PartS_624,sigPartS_625,pkSess_617) <> true) then
                                                0
                                            else
                                                {71}event endCli(Sess,Cli,PartS_624)
                                    )
                                    else
                                        {72}let pkSess_626: bitstring = fail-any in
                                        {73}out(c, GetEndpointRequest);
                                        {74}in(c, (SPs_627: bitstring,=Sign,UP_628: bitstring,=pkSess_626));
                                        {75}new SPc_629: bitstring;
                                        {76}new Nc_630: bitstring;
                                        {77}let gNc_631: bitstring = exp(g,Nc_630) in
                                        {78}let m1_632: bitstring = (SPc_629,gNc_631) in
                                        {79}out(c, (pkCli,m1_632,sign(m1_632,skCli)));
                                        {80}event beginCli(Cli,Sess,gNc_631);
                                        {81}in(c, (PartS_633: bitstring,sigPartS_634: bitstring));
                                        {82}if (verify(PartS_633,sigPartS_634,pkSess_626) <> true) then
                                            0
                                        else
                                            {83}event endCli(Sess,Cli,PartS_633)
                            )
                            else
                                {84}let pkSess_635: bitstring = fail-any in
                                {85}out(c, GetEndpointRequest);
                                {86}in(c, (SPs_636: bitstring,=Sign,UP_637: bitstring,=pkSess_635));
                                {87}new SPc_638: bitstring;
                                {88}new Nc_639: bitstring;
                                {89}let gNc_640: bitstring = exp(g,Nc_639) in
                                {90}let m1_641: bitstring = (SPc_638,gNc_640) in
                                {91}out(c, (pkCli,m1_641,sign(m1_641,skCli)));
                                {92}event beginCli(Cli,Sess,gNc_640);
                                {93}in(c, (PartS_642: bitstring,sigPartS_643: bitstring));
                                {94}if (verify(PartS_642,sigPartS_643,pkSess_635) <> true) then
                                    0
                                else
                                    {95}event endCli(Sess,Cli,PartS_642)
                    )
                    else
                        {96}let pkSess_644: bitstring = fail-any in
                        {97}out(c, GetEndpointRequest);
                        {98}in(c, (SPs_645: bitstring,=Sign,UP_646: bitstring,=pkSess_644));
                        {99}new SPc_647: bitstring;
                        {100}new Nc_648: bitstring;
                        {101}let gNc_649: bitstring = exp(g,Nc_648) in
                        {102}let m1_650: bitstring = (SPc_647,gNc_649) in
                        {103}out(c, (pkCli,m1_650,sign(m1_650,skCli)));
                        {104}event beginCli(Cli,Sess,gNc_649);
                        {105}in(c, (PartS_651: bitstring,sigPartS_652: bitstring));
                        {106}if (verify(PartS_651,sigPartS_652,pkSess_644) <> true) then
                            0
                        else
                            {107}event endCli(Sess,Cli,PartS_651)
                )
                else
                    {108}let v_653: bool = (Disco = B) in
                    (
                        {109}if v_653 then
                        (
                            {110}let pkDisco_654: bitstring = pub(skB) in
                            {111}let v_655: bool = (Sess = A) in
                            (
                                {112}if v_655 then
                                (
                                    {113}let pkSess_656: bitstring = pub(skA) in
                                    {114}out(c, GetEndpointRequest);
                                    {115}in(c, (SPs_657: bitstring,=Sign,UP_658: bitstring,=pkSess_656));
                                    {116}new SPc_659: bitstring;
                                    {117}new Nc_660: bitstring;
                                    {118}let gNc_661: bitstring = exp(g,Nc_660) in
                                    {119}let m1_662: bitstring = (SPc_659,gNc_661) in
                                    {120}out(c, (pkCli,m1_662,sign(m1_662,skCli)));
                                    {121}event beginCli(Cli,Sess,gNc_661);
                                    {122}in(c, (PartS_663: bitstring,sigPartS_664: bitstring));
                                    {123}if (verify(PartS_663,sigPartS_664,pkSess_656) <> true) then
                                        0
                                    else
                                        {124}event endCli(Sess,Cli,PartS_663)
                                )
                                else
                                    {125}let v_665: bool = (Sess = B) in
                                    (
                                        {126}if v_665 then
                                        (
                                            {127}let pkSess_666: bitstring = pub(skB) in
                                            {128}out(c, GetEndpointRequest);
                                            {129}in(c, (SPs_667: bitstring,=Sign,UP_668: bitstring,=pkSess_666));
                                            {130}new SPc_669: bitstring;
                                            {131}new Nc_670: bitstring;
                                            {132}let gNc_671: bitstring = exp(g,Nc_670) in
                                            {133}let m1_672: bitstring = (SPc_669,gNc_671) in
                                            {134}out(c, (pkCli,m1_672,sign(m1_672,skCli)));
                                            {135}event beginCli(Cli,Sess,gNc_671);
                                            {136}in(c, (PartS_673: bitstring,sigPartS_674: bitstring));
                                            {137}if (verify(PartS_673,sigPartS_674,pkSess_666) <> true) then
                                                0
                                            else
                                                {138}event endCli(Sess,Cli,PartS_673)
                                        )
                                        else
                                            {139}let v_675: bool = (Sess = C) in
                                            (
                                                {140}if v_675 then
                                                (
                                                    {141}let pkSess_676: bitstring = pub(skC) in
                                                    {142}out(c, GetEndpointRequest);
                                                    {143}in(c, (SPs_677: bitstring,=Sign,UP_678: bitstring,=pkSess_676));
                                                    {144}new SPc_679: bitstring;
                                                    {145}new Nc_680: bitstring;
                                                    {146}let gNc_681: bitstring = exp(g,Nc_680) in
                                                    {147}let m1_682: bitstring = (SPc_679,gNc_681) in
                                                    {148}out(c, (pkCli,m1_682,sign(m1_682,skCli)));
                                                    {149}event beginCli(Cli,Sess,gNc_681);
                                                    {150}in(c, (PartS_683: bitstring,sigPartS_684: bitstring));
                                                    {151}if (verify(PartS_683,sigPartS_684,pkSess_676) <> true) then
                                                        0
                                                    else
                                                        {152}event endCli(Sess,Cli,PartS_683)
                                                )
                                                else
                                                    {153}let pkSess_685: bitstring = pub(skI) in
                                                    {154}out(c, GetEndpointRequest);
                                                    {155}in(c, (SPs_686: bitstring,=Sign,UP_687: bitstring,=pkSess_685));
                                                    {156}new SPc_688: bitstring;
                                                    {157}new Nc_689: bitstring;
                                                    {158}let gNc_690: bitstring = exp(g,Nc_689) in
                                                    {159}let m1_691: bitstring = (SPc_688,gNc_690) in
                                                    {160}out(c, (pkCli,m1_691,sign(m1_691,skCli)));
                                                    {161}event beginCli(Cli,Sess,gNc_690);
                                                    {162}in(c, (PartS_692: bitstring,sigPartS_693: bitstring));
                                                    {163}if (verify(PartS_692,sigPartS_693,pkSess_685) <> true) then
                                                        0
                                                    else
                                                        {164}event endCli(Sess,Cli,PartS_692)
                                            )
                                            else
                                                {165}let pkSess_694: bitstring = fail-any in
                                                {166}out(c, GetEndpointRequest);
                                                {167}in(c, (SPs_695: bitstring,=Sign,UP_696: bitstring,=pkSess_694));
                                                {168}new SPc_697: bitstring;
                                                {169}new Nc_698: bitstring;
                                                {170}let gNc_699: bitstring = exp(g,Nc_698) in
                                                {171}let m1_700: bitstring = (SPc_697,gNc_699) in
                                                {172}out(c, (pkCli,m1_700,sign(m1_700,skCli)));
                                                {173}event beginCli(Cli,Sess,gNc_699);
                                                {174}in(c, (PartS_701: bitstring,sigPartS_702: bitstring));
                                                {175}if (verify(PartS_701,sigPartS_702,pkSess_694) <> true) then
                                                    0
                                                else
                                                    {176}event endCli(Sess,Cli,PartS_701)
                                    )
                                    else
                                        {177}let pkSess_703: bitstring = fail-any in
                                        {178}out(c, GetEndpointRequest);
                                        {179}in(c, (SPs_704: bitstring,=Sign,UP_705: bitstring,=pkSess_703));
                                        {180}new SPc_706: bitstring;
                                        {181}new Nc_707: bitstring;
                                        {182}let gNc_708: bitstring = exp(g,Nc_707) in
                                        {183}let m1_709: bitstring = (SPc_706,gNc_708) in
                                        {184}out(c, (pkCli,m1_709,sign(m1_709,skCli)));
                                        {185}event beginCli(Cli,Sess,gNc_708);
                                        {186}in(c, (PartS_710: bitstring,sigPartS_711: bitstring));
                                        {187}if (verify(PartS_710,sigPartS_711,pkSess_703) <> true) then
                                            0
                                        else
                                            {188}event endCli(Sess,Cli,PartS_710)
                            )
                            else
                                {189}let pkSess_712: bitstring = fail-any in
                                {190}out(c, GetEndpointRequest);
                                {191}in(c, (SPs_713: bitstring,=Sign,UP_714: bitstring,=pkSess_712));
                                {192}new SPc_715: bitstring;
                                {193}new Nc_716: bitstring;
                                {194}let gNc_717: bitstring = exp(g,Nc_716) in
                                {195}let m1_718: bitstring = (SPc_715,gNc_717) in
                                {196}out(c, (pkCli,m1_718,sign(m1_718,skCli)));
                                {197}event beginCli(Cli,Sess,gNc_717);
                                {198}in(c, (PartS_719: bitstring,sigPartS_720: bitstring));
                                {199}if (verify(PartS_719,sigPartS_720,pkSess_712) <> true) then
                                    0
                                else
                                    {200}event endCli(Sess,Cli,PartS_719)
                        )
                        else
                            {201}let v_721: bool = (Disco = C) in
                            (
                                {202}if v_721 then
                                (
                                    {203}let pkDisco_722: bitstring = pub(skC) in
                                    {204}let v_723: bool = (Sess = A) in
                                    (
                                        {205}if v_723 then
                                        (
                                            {206}let pkSess_724: bitstring = pub(skA) in
                                            {207}out(c, GetEndpointRequest);
                                            {208}in(c, (SPs_725: bitstring,=Sign,UP_726: bitstring,=pkSess_724));
                                            {209}new SPc_727: bitstring;
                                            {210}new Nc_728: bitstring;
                                            {211}let gNc_729: bitstring = exp(g,Nc_728) in
                                            {212}let m1_730: bitstring = (SPc_727,gNc_729) in
                                            {213}out(c, (pkCli,m1_730,sign(m1_730,skCli)));
                                            {214}event beginCli(Cli,Sess,gNc_729);
                                            {215}in(c, (PartS_731: bitstring,sigPartS_732: bitstring));
                                            {216}if (verify(PartS_731,sigPartS_732,pkSess_724) <> true) then
                                                0
                                            else
                                                {217}event endCli(Sess,Cli,PartS_731)
                                        )
                                        else
                                            {218}let v_733: bool = (Sess = B) in
                                            (
                                                {219}if v_733 then
                                                (
                                                    {220}let pkSess_734: bitstring = pub(skB) in
                                                    {221}out(c, GetEndpointRequest);
                                                    {222}in(c, (SPs_735: bitstring,=Sign,UP_736: bitstring,=pkSess_734));
                                                    {223}new SPc_737: bitstring;
                                                    {224}new Nc_738: bitstring;
                                                    {225}let gNc_739: bitstring = exp(g,Nc_738) in
                                                    {226}let m1_740: bitstring = (SPc_737,gNc_739) in
                                                    {227}out(c, (pkCli,m1_740,sign(m1_740,skCli)));
                                                    {228}event beginCli(Cli,Sess,gNc_739);
                                                    {229}in(c, (PartS_741: bitstring,sigPartS_742: bitstring));
                                                    {230}if (verify(PartS_741,sigPartS_742,pkSess_734) <> true) then
                                                        0
                                                    else
                                                        {231}event endCli(Sess,Cli,PartS_741)
                                                )
                                                else
                                                    {232}let v_743: bool = (Sess = C) in
                                                    (
                                                        {233}if v_743 then
                                                        (
                                                            {234}let pkSess_744: bitstring = pub(skC) in
                                                            {235}out(c, GetEndpointRequest);
                                                            {236}in(c, (SPs_745: bitstring,=Sign,UP_746: bitstring,=pkSess_744));
                                                            {237}new SPc_747: bitstring;
                                                            {238}new Nc_748: bitstring;
                                                            {239}let gNc_749: bitstring = exp(g,Nc_748) in
                                                            {240}let m1_750: bitstring = (SPc_747,gNc_749) in
                                                            {241}out(c, (pkCli,m1_750,sign(m1_750,skCli)));
                                                            {242}event beginCli(Cli,Sess,gNc_749);
                                                            {243}in(c, (PartS_751: bitstring,sigPartS_752: bitstring));
                                                            {244}if (verify(PartS_751,sigPartS_752,pkSess_744) <> true) then
                                                                0
                                                            else
                                                                {245}event endCli(Sess,Cli,PartS_751)
                                                        )
                                                        else
                                                            {246}let pkSess_753: bitstring = pub(skI) in
                                                            {247}out(c, GetEndpointRequest);
                                                            {248}in(c, (SPs_754: bitstring,=Sign,UP_755: bitstring,=pkSess_753));
                                                            {249}new SPc_756: bitstring;
                                                            {250}new Nc_757: bitstring;
                                                            {251}let gNc_758: bitstring = exp(g,Nc_757) in
                                                            {252}let m1_759: bitstring = (SPc_756,gNc_758) in
                                                            {253}out(c, (pkCli,m1_759,sign(m1_759,skCli)));
                                                            {254}event beginCli(Cli,Sess,gNc_758);
                                                            {255}in(c, (PartS_760: bitstring,sigPartS_761: bitstring));
                                                            {256}if (verify(PartS_760,sigPartS_761,pkSess_753) <> true) then
                                                                0
                                                            else
                                                                {257}event endCli(Sess,Cli,PartS_760)
                                                    )
                                                    else
                                                        {258}let pkSess_762: bitstring = fail-any in
                                                        {259}out(c, GetEndpointRequest);
                                                        {260}in(c, (SPs_763: bitstring,=Sign,UP_764: bitstring,=pkSess_762));
                                                        {261}new SPc_765: bitstring;
                                                        {262}new Nc_766: bitstring;
                                                        {263}let gNc_767: bitstring = exp(g,Nc_766) in
                                                        {264}let m1_768: bitstring = (SPc_765,gNc_767) in
                                                        {265}out(c, (pkCli,m1_768,sign(m1_768,skCli)));
                                                        {266}event beginCli(Cli,Sess,gNc_767);
                                                        {267}in(c, (PartS_769: bitstring,sigPartS_770: bitstring));
                                                        {268}if (verify(PartS_769,sigPartS_770,pkSess_762) <> true) then
                                                            0
                                                        else
                                                            {269}event endCli(Sess,Cli,PartS_769)
                                            )
                                            else
                                                {270}let pkSess_771: bitstring = fail-any in
                                                {271}out(c, GetEndpointRequest);
                                                {272}in(c, (SPs_772: bitstring,=Sign,UP_773: bitstring,=pkSess_771));
                                                {273}new SPc_774: bitstring;
                                                {274}new Nc_775: bitstring;
                                                {275}let gNc_776: bitstring = exp(g,Nc_775) in
                                                {276}let m1_777: bitstring = (SPc_774,gNc_776) in
                                                {277}out(c, (pkCli,m1_777,sign(m1_777,skCli)));
                                                {278}event beginCli(Cli,Sess,gNc_776);
                                                {279}in(c, (PartS_778: bitstring,sigPartS_779: bitstring));
                                                {280}if (verify(PartS_778,sigPartS_779,pkSess_771) <> true) then
                                                    0
                                                else
                                                    {281}event endCli(Sess,Cli,PartS_778)
                                    )
                                    else
                                        {282}let pkSess_780: bitstring = fail-any in
                                        {283}out(c, GetEndpointRequest);
                                        {284}in(c, (SPs_781: bitstring,=Sign,UP_782: bitstring,=pkSess_780));
                                        {285}new SPc_783: bitstring;
                                        {286}new Nc_784: bitstring;
                                        {287}let gNc_785: bitstring = exp(g,Nc_784) in
                                        {288}let m1_786: bitstring = (SPc_783,gNc_785) in
                                        {289}out(c, (pkCli,m1_786,sign(m1_786,skCli)));
                                        {290}event beginCli(Cli,Sess,gNc_785);
                                        {291}in(c, (PartS_787: bitstring,sigPartS_788: bitstring));
                                        {292}if (verify(PartS_787,sigPartS_788,pkSess_780) <> true) then
                                            0
                                        else
                                            {293}event endCli(Sess,Cli,PartS_787)
                                )
                                else
                                    {294}let pkDisco_789: bitstring = pub(skI) in
                                    {295}let v_790: bool = (Sess = A) in
                                    (
                                        {296}if v_790 then
                                        (
                                            {297}let pkSess_791: bitstring = pub(skA) in
                                            {298}out(c, GetEndpointRequest);
                                            {299}in(c, (SPs_792: bitstring,=Sign,UP_793: bitstring,=pkSess_791));
                                            {300}new SPc_794: bitstring;
                                            {301}new Nc_795: bitstring;
                                            {302}let gNc_796: bitstring = exp(g,Nc_795) in
                                            {303}let m1_797: bitstring = (SPc_794,gNc_796) in
                                            {304}out(c, (pkCli,m1_797,sign(m1_797,skCli)));
                                            {305}event beginCli(Cli,Sess,gNc_796);
                                            {306}in(c, (PartS_798: bitstring,sigPartS_799: bitstring));
                                            {307}if (verify(PartS_798,sigPartS_799,pkSess_791) <> true) then
                                                0
                                            else
                                                {308}event endCli(Sess,Cli,PartS_798)
                                        )
                                        else
                                            {309}let v_800: bool = (Sess = B) in
                                            (
                                                {310}if v_800 then
                                                (
                                                    {311}let pkSess_801: bitstring = pub(skB) in
                                                    {312}out(c, GetEndpointRequest);
                                                    {313}in(c, (SPs_802: bitstring,=Sign,UP_803: bitstring,=pkSess_801));
                                                    {314}new SPc_804: bitstring;
                                                    {315}new Nc_805: bitstring;
                                                    {316}let gNc_806: bitstring = exp(g,Nc_805) in
                                                    {317}let m1_807: bitstring = (SPc_804,gNc_806) in
                                                    {318}out(c, (pkCli,m1_807,sign(m1_807,skCli)));
                                                    {319}event beginCli(Cli,Sess,gNc_806);
                                                    {320}in(c, (PartS_808: bitstring,sigPartS_809: bitstring));
                                                    {321}if (verify(PartS_808,sigPartS_809,pkSess_801) <> true) then
                                                        0
                                                    else
                                                        {322}event endCli(Sess,Cli,PartS_808)
                                                )
                                                else
                                                    {323}let v_810: bool = (Sess = C) in
                                                    (
                                                        {324}if v_810 then
                                                        (
                                                            {325}let pkSess_811: bitstring = pub(skC) in
                                                            {326}out(c, GetEndpointRequest);
                                                            {327}in(c, (SPs_812: bitstring,=Sign,UP_813: bitstring,=pkSess_811));
                                                            {328}new SPc_814: bitstring;
                                                            {329}new Nc_815: bitstring;
                                                            {330}let gNc_816: bitstring = exp(g,Nc_815) in
                                                            {331}let m1_817: bitstring = (SPc_814,gNc_816) in
                                                            {332}out(c, (pkCli,m1_817,sign(m1_817,skCli)));
                                                            {333}event beginCli(Cli,Sess,gNc_816);
                                                            {334}in(c, (PartS_818: bitstring,sigPartS_819: bitstring));
                                                            {335}if (verify(PartS_818,sigPartS_819,pkSess_811) <> true) then
                                                                0
                                                            else
                                                                {336}event endCli(Sess,Cli,PartS_818)
                                                        )
                                                        else
                                                            {337}let pkSess_820: bitstring = pub(skI) in
                                                            {338}out(c, GetEndpointRequest);
                                                            {339}in(c, (SPs_821: bitstring,=Sign,UP_822: bitstring,=pkSess_820));
                                                            {340}new SPc_823: bitstring;
                                                            {341}new Nc_824: bitstring;
                                                            {342}let gNc_825: bitstring = exp(g,Nc_824) in
                                                            {343}let m1_826: bitstring = (SPc_823,gNc_825) in
                                                            {344}out(c, (pkCli,m1_826,sign(m1_826,skCli)));
                                                            {345}event beginCli(Cli,Sess,gNc_825);
                                                            {346}in(c, (PartS_827: bitstring,sigPartS_828: bitstring));
                                                            {347}if (verify(PartS_827,sigPartS_828,pkSess_820) <> true) then
                                                                0
                                                            else
                                                                {348}event endCli(Sess,Cli,PartS_827)
                                                    )
                                                    else
                                                        {349}let pkSess_829: bitstring = fail-any in
                                                        {350}out(c, GetEndpointRequest);
                                                        {351}in(c, (SPs_830: bitstring,=Sign,UP_831: bitstring,=pkSess_829));
                                                        {352}new SPc_832: bitstring;
                                                        {353}new Nc_833: bitstring;
                                                        {354}let gNc_834: bitstring = exp(g,Nc_833) in
                                                        {355}let m1_835: bitstring = (SPc_832,gNc_834) in
                                                        {356}out(c, (pkCli,m1_835,sign(m1_835,skCli)));
                                                        {357}event beginCli(Cli,Sess,gNc_834);
                                                        {358}in(c, (PartS_836: bitstring,sigPartS_837: bitstring));
                                                        {359}if (verify(PartS_836,sigPartS_837,pkSess_829) <> true) then
                                                            0
                                                        else
                                                            {360}event endCli(Sess,Cli,PartS_836)
                                            )
                                            else
                                                {361}let pkSess_838: bitstring = fail-any in
                                                {362}out(c, GetEndpointRequest);
                                                {363}in(c, (SPs_839: bitstring,=Sign,UP_840: bitstring,=pkSess_838));
                                                {364}new SPc_841: bitstring;
                                                {365}new Nc_842: bitstring;
                                                {366}let gNc_843: bitstring = exp(g,Nc_842) in
                                                {367}let m1_844: bitstring = (SPc_841,gNc_843) in
                                                {368}out(c, (pkCli,m1_844,sign(m1_844,skCli)));
                                                {369}event beginCli(Cli,Sess,gNc_843);
                                                {370}in(c, (PartS_845: bitstring,sigPartS_846: bitstring));
                                                {371}if (verify(PartS_845,sigPartS_846,pkSess_838) <> true) then
                                                    0
                                                else
                                                    {372}event endCli(Sess,Cli,PartS_845)
                                    )
                                    else
                                        {373}let pkSess_847: bitstring = fail-any in
                                        {374}out(c, GetEndpointRequest);
                                        {375}in(c, (SPs_848: bitstring,=Sign,UP_849: bitstring,=pkSess_847));
                                        {376}new SPc_850: bitstring;
                                        {377}new Nc_851: bitstring;
                                        {378}let gNc_852: bitstring = exp(g,Nc_851) in
                                        {379}let m1_853: bitstring = (SPc_850,gNc_852) in
                                        {380}out(c, (pkCli,m1_853,sign(m1_853,skCli)));
                                        {381}event beginCli(Cli,Sess,gNc_852);
                                        {382}in(c, (PartS_854: bitstring,sigPartS_855: bitstring));
                                        {383}if (verify(PartS_854,sigPartS_855,pkSess_847) <> true) then
                                            0
                                        else
                                            {384}event endCli(Sess,Cli,PartS_854)
                            )
                            else
                                {385}let pkDisco_856: bitstring = fail-any in
                                {386}let v_857: bool = (Sess = A) in
                                (
                                    {387}if v_857 then
                                    (
                                        {388}let pkSess_858: bitstring = pub(skA) in
                                        {389}out(c, GetEndpointRequest);
                                        {390}in(c, (SPs_859: bitstring,=Sign,UP_860: bitstring,=pkSess_858));
                                        {391}new SPc_861: bitstring;
                                        {392}new Nc_862: bitstring;
                                        {393}let gNc_863: bitstring = exp(g,Nc_862) in
                                        {394}let m1_864: bitstring = (SPc_861,gNc_863) in
                                        {395}out(c, (pkCli,m1_864,sign(m1_864,skCli)));
                                        {396}event beginCli(Cli,Sess,gNc_863);
                                        {397}in(c, (PartS_865: bitstring,sigPartS_866: bitstring));
                                        {398}if (verify(PartS_865,sigPartS_866,pkSess_858) <> true) then
                                            0
                                        else
                                            {399}event endCli(Sess,Cli,PartS_865)
                                    )
                                    else
                                        {400}let v_867: bool = (Sess = B) in
                                        (
                                            {401}if v_867 then
                                            (
                                                {402}let pkSess_868: bitstring = pub(skB) in
                                                {403}out(c, GetEndpointRequest);
                                                {404}in(c, (SPs_869: bitstring,=Sign,UP_870: bitstring,=pkSess_868));
                                                {405}new SPc_871: bitstring;
                                                {406}new Nc_872: bitstring;
                                                {407}let gNc_873: bitstring = exp(g,Nc_872) in
                                                {408}let m1_874: bitstring = (SPc_871,gNc_873) in
                                                {409}out(c, (pkCli,m1_874,sign(m1_874,skCli)));
                                                {410}event beginCli(Cli,Sess,gNc_873);
                                                {411}in(c, (PartS_875: bitstring,sigPartS_876: bitstring));
                                                {412}if (verify(PartS_875,sigPartS_876,pkSess_868) <> true) then
                                                    0
                                                else
                                                    {413}event endCli(Sess,Cli,PartS_875)
                                            )
                                            else
                                                {414}let v_877: bool = (Sess = C) in
                                                (
                                                    {415}if v_877 then
                                                    (
                                                        {416}let pkSess_878: bitstring = pub(skC) in
                                                        {417}out(c, GetEndpointRequest);
                                                        {418}in(c, (SPs_879: bitstring,=Sign,UP_880: bitstring,=pkSess_878));
                                                        {419}new SPc_881: bitstring;
                                                        {420}new Nc_882: bitstring;
                                                        {421}let gNc_883: bitstring = exp(g,Nc_882) in
                                                        {422}let m1_884: bitstring = (SPc_881,gNc_883) in
                                                        {423}out(c, (pkCli,m1_884,sign(m1_884,skCli)));
                                                        {424}event beginCli(Cli,Sess,gNc_883);
                                                        {425}in(c, (PartS_885: bitstring,sigPartS_886: bitstring));
                                                        {426}if (verify(PartS_885,sigPartS_886,pkSess_878) <> true) then
                                                            0
                                                        else
                                                            {427}event endCli(Sess,Cli,PartS_885)
                                                    )
                                                    else
                                                        {428}let pkSess_887: bitstring = pub(skI) in
                                                        {429}out(c, GetEndpointRequest);
                                                        {430}in(c, (SPs_888: bitstring,=Sign,UP_889: bitstring,=pkSess_887));
                                                        {431}new SPc_890: bitstring;
                                                        {432}new Nc_891: bitstring;
                                                        {433}let gNc_892: bitstring = exp(g,Nc_891) in
                                                        {434}let m1_893: bitstring = (SPc_890,gNc_892) in
                                                        {435}out(c, (pkCli,m1_893,sign(m1_893,skCli)));
                                                        {436}event beginCli(Cli,Sess,gNc_892);
                                                        {437}in(c, (PartS_894: bitstring,sigPartS_895: bitstring));
                                                        {438}if (verify(PartS_894,sigPartS_895,pkSess_887) <> true) then
                                                            0
                                                        else
                                                            {439}event endCli(Sess,Cli,PartS_894)
                                                )
                                                else
                                                    {440}let pkSess_896: bitstring = fail-any in
                                                    {441}out(c, GetEndpointRequest);
                                                    {442}in(c, (SPs_897: bitstring,=Sign,UP_898: bitstring,=pkSess_896));
                                                    {443}new SPc_899: bitstring;
                                                    {444}new Nc_900: bitstring;
                                                    {445}let gNc_901: bitstring = exp(g,Nc_900) in
                                                    {446}let m1_902: bitstring = (SPc_899,gNc_901) in
                                                    {447}out(c, (pkCli,m1_902,sign(m1_902,skCli)));
                                                    {448}event beginCli(Cli,Sess,gNc_901);
                                                    {449}in(c, (PartS_903: bitstring,sigPartS_904: bitstring));
                                                    {450}if (verify(PartS_903,sigPartS_904,pkSess_896) <> true) then
                                                        0
                                                    else
                                                        {451}event endCli(Sess,Cli,PartS_903)
                                        )
                                        else
                                            {452}let pkSess_905: bitstring = fail-any in
                                            {453}out(c, GetEndpointRequest);
                                            {454}in(c, (SPs_906: bitstring,=Sign,UP_907: bitstring,=pkSess_905));
                                            {455}new SPc_908: bitstring;
                                            {456}new Nc_909: bitstring;
                                            {457}let gNc_910: bitstring = exp(g,Nc_909) in
                                            {458}let m1_911: bitstring = (SPc_908,gNc_910) in
                                            {459}out(c, (pkCli,m1_911,sign(m1_911,skCli)));
                                            {460}event beginCli(Cli,Sess,gNc_910);
                                            {461}in(c, (PartS_912: bitstring,sigPartS_913: bitstring));
                                            {462}if (verify(PartS_912,sigPartS_913,pkSess_905) <> true) then
                                                0
                                            else
                                                {463}event endCli(Sess,Cli,PartS_912)
                                )
                                else
                                    {464}let pkSess_914: bitstring = fail-any in
                                    {465}out(c, GetEndpointRequest);
                                    {466}in(c, (SPs_915: bitstring,=Sign,UP_916: bitstring,=pkSess_914));
                                    {467}new SPc_917: bitstring;
                                    {468}new Nc_918: bitstring;
                                    {469}let gNc_919: bitstring = exp(g,Nc_918) in
                                    {470}let m1_920: bitstring = (SPc_917,gNc_919) in
                                    {471}out(c, (pkCli,m1_920,sign(m1_920,skCli)));
                                    {472}event beginCli(Cli,Sess,gNc_919);
                                    {473}in(c, (PartS_921: bitstring,sigPartS_922: bitstring));
                                    {474}if (verify(PartS_921,sigPartS_922,pkSess_914) <> true) then
                                        0
                                    else
                                        {475}event endCli(Sess,Cli,PartS_921)
                    )
                    else
                        {476}let pkDisco_923: bitstring = fail-any in
                        {477}let v_924: bool = (Sess = A) in
                        (
                            {478}if v_924 then
                            (
                                {479}let pkSess_925: bitstring = pub(skA) in
                                {480}out(c, GetEndpointRequest);
                                {481}in(c, (SPs_926: bitstring,=Sign,UP_927: bitstring,=pkSess_925));
                                {482}new SPc_928: bitstring;
                                {483}new Nc_929: bitstring;
                                {484}let gNc_930: bitstring = exp(g,Nc_929) in
                                {485}let m1_931: bitstring = (SPc_928,gNc_930) in
                                {486}out(c, (pkCli,m1_931,sign(m1_931,skCli)));
                                {487}event beginCli(Cli,Sess,gNc_930);
                                {488}in(c, (PartS_932: bitstring,sigPartS_933: bitstring));
                                {489}if (verify(PartS_932,sigPartS_933,pkSess_925) <> true) then
                                    0
                                else
                                    {490}event endCli(Sess,Cli,PartS_932)
                            )
                            else
                                {491}let v_934: bool = (Sess = B) in
                                (
                                    {492}if v_934 then
                                    (
                                        {493}let pkSess_935: bitstring = pub(skB) in
                                        {494}out(c, GetEndpointRequest);
                                        {495}in(c, (SPs_936: bitstring,=Sign,UP_937: bitstring,=pkSess_935));
                                        {496}new SPc_938: bitstring;
                                        {497}new Nc_939: bitstring;
                                        {498}let gNc_940: bitstring = exp(g,Nc_939) in
                                        {499}let m1_941: bitstring = (SPc_938,gNc_940) in
                                        {500}out(c, (pkCli,m1_941,sign(m1_941,skCli)));
                                        {501}event beginCli(Cli,Sess,gNc_940);
                                        {502}in(c, (PartS_942: bitstring,sigPartS_943: bitstring));
                                        {503}if (verify(PartS_942,sigPartS_943,pkSess_935) <> true) then
                                            0
                                        else
                                            {504}event endCli(Sess,Cli,PartS_942)
                                    )
                                    else
                                        {505}let v_944: bool = (Sess = C) in
                                        (
                                            {506}if v_944 then
                                            (
                                                {507}let pkSess_945: bitstring = pub(skC) in
                                                {508}out(c, GetEndpointRequest);
                                                {509}in(c, (SPs_946: bitstring,=Sign,UP_947: bitstring,=pkSess_945));
                                                {510}new SPc_948: bitstring;
                                                {511}new Nc_949: bitstring;
                                                {512}let gNc_950: bitstring = exp(g,Nc_949) in
                                                {513}let m1_951: bitstring = (SPc_948,gNc_950) in
                                                {514}out(c, (pkCli,m1_951,sign(m1_951,skCli)));
                                                {515}event beginCli(Cli,Sess,gNc_950);
                                                {516}in(c, (PartS_952: bitstring,sigPartS_953: bitstring));
                                                {517}if (verify(PartS_952,sigPartS_953,pkSess_945) <> true) then
                                                    0
                                                else
                                                    {518}event endCli(Sess,Cli,PartS_952)
                                            )
                                            else
                                                {519}let pkSess_954: bitstring = pub(skI) in
                                                {520}out(c, GetEndpointRequest);
                                                {521}in(c, (SPs_955: bitstring,=Sign,UP_956: bitstring,=pkSess_954));
                                                {522}new SPc_957: bitstring;
                                                {523}new Nc_958: bitstring;
                                                {524}let gNc_959: bitstring = exp(g,Nc_958) in
                                                {525}let m1_960: bitstring = (SPc_957,gNc_959) in
                                                {526}out(c, (pkCli,m1_960,sign(m1_960,skCli)));
                                                {527}event beginCli(Cli,Sess,gNc_959);
                                                {528}in(c, (PartS_961: bitstring,sigPartS_962: bitstring));
                                                {529}if (verify(PartS_961,sigPartS_962,pkSess_954) <> true) then
                                                    0
                                                else
                                                    {530}event endCli(Sess,Cli,PartS_961)
                                        )
                                        else
                                            {531}let pkSess_963: bitstring = fail-any in
                                            {532}out(c, GetEndpointRequest);
                                            {533}in(c, (SPs_964: bitstring,=Sign,UP_965: bitstring,=pkSess_963));
                                            {534}new SPc_966: bitstring;
                                            {535}new Nc_967: bitstring;
                                            {536}let gNc_968: bitstring = exp(g,Nc_967) in
                                            {537}let m1_969: bitstring = (SPc_966,gNc_968) in
                                            {538}out(c, (pkCli,m1_969,sign(m1_969,skCli)));
                                            {539}event beginCli(Cli,Sess,gNc_968);
                                            {540}in(c, (PartS_970: bitstring,sigPartS_971: bitstring));
                                            {541}if (verify(PartS_970,sigPartS_971,pkSess_963) <> true) then
                                                0
                                            else
                                                {542}event endCli(Sess,Cli,PartS_970)
                                )
                                else
                                    {543}let pkSess_972: bitstring = fail-any in
                                    {544}out(c, GetEndpointRequest);
                                    {545}in(c, (SPs_973: bitstring,=Sign,UP_974: bitstring,=pkSess_972));
                                    {546}new SPc_975: bitstring;
                                    {547}new Nc_976: bitstring;
                                    {548}let gNc_977: bitstring = exp(g,Nc_976) in
                                    {549}let m1_978: bitstring = (SPc_975,gNc_977) in
                                    {550}out(c, (pkCli,m1_978,sign(m1_978,skCli)));
                                    {551}event beginCli(Cli,Sess,gNc_977);
                                    {552}in(c, (PartS_979: bitstring,sigPartS_980: bitstring));
                                    {553}if (verify(PartS_979,sigPartS_980,pkSess_972) <> true) then
                                        0
                                    else
                                        {554}event endCli(Sess,Cli,PartS_979)
                        )
                        else
                            {555}let pkSess_981: bitstring = fail-any in
                            {556}out(c, GetEndpointRequest);
                            {557}in(c, (SPs_982: bitstring,=Sign,UP_983: bitstring,=pkSess_981));
                            {558}new SPc_984: bitstring;
                            {559}new Nc_985: bitstring;
                            {560}let gNc_986: bitstring = exp(g,Nc_985) in
                            {561}let m1_987: bitstring = (SPc_984,gNc_986) in
                            {562}out(c, (pkCli,m1_987,sign(m1_987,skCli)));
                            {563}event beginCli(Cli,Sess,gNc_986);
                            {564}in(c, (PartS_988: bitstring,sigPartS_989: bitstring));
                            {565}if (verify(PartS_988,sigPartS_989,pkSess_981) <> true) then
                                0
                            else
                                {566}event endCli(Sess,Cli,PartS_988)
            )
            else
                {567}let pkDisco_990: bitstring = fail-any in
                {568}let v_991: bool = (Sess = A) in
                (
                    {569}if v_991 then
                    (
                        {570}let pkSess_992: bitstring = pub(skA) in
                        {571}out(c, GetEndpointRequest);
                        {572}in(c, (SPs_993: bitstring,=Sign,UP_994: bitstring,=pkSess_992));
                        {573}new SPc_995: bitstring;
                        {574}new Nc_996: bitstring;
                        {575}let gNc_997: bitstring = exp(g,Nc_996) in
                        {576}let m1_998: bitstring = (SPc_995,gNc_997) in
                        {577}out(c, (pkCli,m1_998,sign(m1_998,skCli)));
                        {578}event beginCli(Cli,Sess,gNc_997);
                        {579}in(c, (PartS_999: bitstring,sigPartS_1000: bitstring));
                        {580}if (verify(PartS_999,sigPartS_1000,pkSess_992) <> true) then
                            0
                        else
                            {581}event endCli(Sess,Cli,PartS_999)
                    )
                    else
                        {582}let v_1001: bool = (Sess = B) in
                        (
                            {583}if v_1001 then
                            (
                                {584}let pkSess_1002: bitstring = pub(skB) in
                                {585}out(c, GetEndpointRequest);
                                {586}in(c, (SPs_1003: bitstring,=Sign,UP_1004: bitstring,=pkSess_1002));
                                {587}new SPc_1005: bitstring;
                                {588}new Nc_1006: bitstring;
                                {589}let gNc_1007: bitstring = exp(g,Nc_1006) in
                                {590}let m1_1008: bitstring = (SPc_1005,gNc_1007) in
                                {591}out(c, (pkCli,m1_1008,sign(m1_1008,skCli)));
                                {592}event beginCli(Cli,Sess,gNc_1007);
                                {593}in(c, (PartS_1009: bitstring,sigPartS_1010: bitstring));
                                {594}if (verify(PartS_1009,sigPartS_1010,pkSess_1002) <> true) then
                                    0
                                else
                                    {595}event endCli(Sess,Cli,PartS_1009)
                            )
                            else
                                {596}let v_1011: bool = (Sess = C) in
                                (
                                    {597}if v_1011 then
                                    (
                                        {598}let pkSess_1012: bitstring = pub(skC) in
                                        {599}out(c, GetEndpointRequest);
                                        {600}in(c, (SPs_1013: bitstring,=Sign,UP_1014: bitstring,=pkSess_1012));
                                        {601}new SPc_1015: bitstring;
                                        {602}new Nc_1016: bitstring;
                                        {603}let gNc_1017: bitstring = exp(g,Nc_1016) in
                                        {604}let m1_1018: bitstring = (SPc_1015,gNc_1017) in
                                        {605}out(c, (pkCli,m1_1018,sign(m1_1018,skCli)));
                                        {606}event beginCli(Cli,Sess,gNc_1017);
                                        {607}in(c, (PartS_1019: bitstring,sigPartS_1020: bitstring));
                                        {608}if (verify(PartS_1019,sigPartS_1020,pkSess_1012) <> true) then
                                            0
                                        else
                                            {609}event endCli(Sess,Cli,PartS_1019)
                                    )
                                    else
                                        {610}let pkSess_1021: bitstring = pub(skI) in
                                        {611}out(c, GetEndpointRequest);
                                        {612}in(c, (SPs_1022: bitstring,=Sign,UP_1023: bitstring,=pkSess_1021));
                                        {613}new SPc_1024: bitstring;
                                        {614}new Nc_1025: bitstring;
                                        {615}let gNc_1026: bitstring = exp(g,Nc_1025) in
                                        {616}let m1_1027: bitstring = (SPc_1024,gNc_1026) in
                                        {617}out(c, (pkCli,m1_1027,sign(m1_1027,skCli)));
                                        {618}event beginCli(Cli,Sess,gNc_1026);
                                        {619}in(c, (PartS_1028: bitstring,sigPartS_1029: bitstring));
                                        {620}if (verify(PartS_1028,sigPartS_1029,pkSess_1021) <> true) then
                                            0
                                        else
                                            {621}event endCli(Sess,Cli,PartS_1028)
                                )
                                else
                                    {622}let pkSess_1030: bitstring = fail-any in
                                    {623}out(c, GetEndpointRequest);
                                    {624}in(c, (SPs_1031: bitstring,=Sign,UP_1032: bitstring,=pkSess_1030));
                                    {625}new SPc_1033: bitstring;
                                    {626}new Nc_1034: bitstring;
                                    {627}let gNc_1035: bitstring = exp(g,Nc_1034) in
                                    {628}let m1_1036: bitstring = (SPc_1033,gNc_1035) in
                                    {629}out(c, (pkCli,m1_1036,sign(m1_1036,skCli)));
                                    {630}event beginCli(Cli,Sess,gNc_1035);
                                    {631}in(c, (PartS_1037: bitstring,sigPartS_1038: bitstring));
                                    {632}if (verify(PartS_1037,sigPartS_1038,pkSess_1030) <> true) then
                                        0
                                    else
                                        {633}event endCli(Sess,Cli,PartS_1037)
                        )
                        else
                            {634}let pkSess_1039: bitstring = fail-any in
                            {635}out(c, GetEndpointRequest);
                            {636}in(c, (SPs_1040: bitstring,=Sign,UP_1041: bitstring,=pkSess_1039));
                            {637}new SPc_1042: bitstring;
                            {638}new Nc_1043: bitstring;
                            {639}let gNc_1044: bitstring = exp(g,Nc_1043) in
                            {640}let m1_1045: bitstring = (SPc_1042,gNc_1044) in
                            {641}out(c, (pkCli,m1_1045,sign(m1_1045,skCli)));
                            {642}event beginCli(Cli,Sess,gNc_1044);
                            {643}in(c, (PartS_1046: bitstring,sigPartS_1047: bitstring));
                            {644}if (verify(PartS_1046,sigPartS_1047,pkSess_1039) <> true) then
                                0
                            else
                                {645}event endCli(Sess,Cli,PartS_1046)
                )
                else
                    {646}let pkSess_1048: bitstring = fail-any in
                    {647}out(c, GetEndpointRequest);
                    {648}in(c, (SPs_1049: bitstring,=Sign,UP_1050: bitstring,=pkSess_1048));
                    {649}new SPc_1051: bitstring;
                    {650}new Nc_1052: bitstring;
                    {651}let gNc_1053: bitstring = exp(g,Nc_1052) in
                    {652}let m1_1054: bitstring = (SPc_1051,gNc_1053) in
                    {653}out(c, (pkCli,m1_1054,sign(m1_1054,skCli)));
                    {654}event beginCli(Cli,Sess,gNc_1053);
                    {655}in(c, (PartS_1055: bitstring,sigPartS_1056: bitstring));
                    {656}if (verify(PartS_1055,sigPartS_1056,pkSess_1048) <> true) then
                        0
                    else
                        {657}event endCli(Sess,Cli,PartS_1055)
        )
        else
            {658}let v_1057: bool = (Cli = B) in
            (
                {659}if v_1057 then
                (
                    {660}let skCli_1058: bitstring = skB in
                    {661}let pkCli_1059: bitstring = pub(skCli_1058) in
                    {662}let v_1060: bool = (Disco = A) in
                    (
                        {663}if v_1060 then
                        (
                            {664}let pkDisco_1061: bitstring = pub(skA) in
                            {665}let v_1062: bool = (Sess = A) in
                            (
                                {666}if v_1062 then
                                (
                                    {667}let pkSess_1063: bitstring = pub(skA) in
                                    {668}out(c, GetEndpointRequest);
                                    {669}in(c, (SPs_1064: bitstring,=Sign,UP_1065: bitstring,=pkSess_1063));
                                    {670}new SPc_1066: bitstring;
                                    {671}new Nc_1067: bitstring;
                                    {672}let gNc_1068: bitstring = exp(g,Nc_1067) in
                                    {673}let m1_1069: bitstring = (SPc_1066,gNc_1068) in
                                    {674}out(c, (pkCli_1059,m1_1069,sign(m1_1069,skCli_1058)));
                                    {675}event beginCli(Cli,Sess,gNc_1068);
                                    {676}in(c, (PartS_1070: bitstring,sigPartS_1071: bitstring));
                                    {677}if (verify(PartS_1070,sigPartS_1071,pkSess_1063) <> true) then
                                        0
                                    else
                                        {678}event endCli(Sess,Cli,PartS_1070)
                                )
                                else
                                    {679}let v_1072: bool = (Sess = B) in
                                    (
                                        {680}if v_1072 then
                                        (
                                            {681}let pkSess_1073: bitstring = pub(skB) in
                                            {682}out(c, GetEndpointRequest);
                                            {683}in(c, (SPs_1074: bitstring,=Sign,UP_1075: bitstring,=pkSess_1073));
                                            {684}new SPc_1076: bitstring;
                                            {685}new Nc_1077: bitstring;
                                            {686}let gNc_1078: bitstring = exp(g,Nc_1077) in
                                            {687}let m1_1079: bitstring = (SPc_1076,gNc_1078) in
                                            {688}out(c, (pkCli_1059,m1_1079,sign(m1_1079,skCli_1058)));
                                            {689}event beginCli(Cli,Sess,gNc_1078);
                                            {690}in(c, (PartS_1080: bitstring,sigPartS_1081: bitstring));
                                            {691}if (verify(PartS_1080,sigPartS_1081,pkSess_1073) <> true) then
                                                0
                                            else
                                                {692}event endCli(Sess,Cli,PartS_1080)
                                        )
                                        else
                                            {693}let v_1082: bool = (Sess = C) in
                                            (
                                                {694}if v_1082 then
                                                (
                                                    {695}let pkSess_1083: bitstring = pub(skC) in
                                                    {696}out(c, GetEndpointRequest);
                                                    {697}in(c, (SPs_1084: bitstring,=Sign,UP_1085: bitstring,=pkSess_1083));
                                                    {698}new SPc_1086: bitstring;
                                                    {699}new Nc_1087: bitstring;
                                                    {700}let gNc_1088: bitstring = exp(g,Nc_1087) in
                                                    {701}let m1_1089: bitstring = (SPc_1086,gNc_1088) in
                                                    {702}out(c, (pkCli_1059,m1_1089,sign(m1_1089,skCli_1058)));
                                                    {703}event beginCli(Cli,Sess,gNc_1088);
                                                    {704}in(c, (PartS_1090: bitstring,sigPartS_1091: bitstring));
                                                    {705}if (verify(PartS_1090,sigPartS_1091,pkSess_1083) <> true) then
                                                        0
                                                    else
                                                        {706}event endCli(Sess,Cli,PartS_1090)
                                                )
                                                else
                                                    {707}let pkSess_1092: bitstring = pub(skI) in
                                                    {708}out(c, GetEndpointRequest);
                                                    {709}in(c, (SPs_1093: bitstring,=Sign,UP_1094: bitstring,=pkSess_1092));
                                                    {710}new SPc_1095: bitstring;
                                                    {711}new Nc_1096: bitstring;
                                                    {712}let gNc_1097: bitstring = exp(g,Nc_1096) in
                                                    {713}let m1_1098: bitstring = (SPc_1095,gNc_1097) in
                                                    {714}out(c, (pkCli_1059,m1_1098,sign(m1_1098,skCli_1058)));
                                                    {715}event beginCli(Cli,Sess,gNc_1097);
                                                    {716}in(c, (PartS_1099: bitstring,sigPartS_1100: bitstring));
                                                    {717}if (verify(PartS_1099,sigPartS_1100,pkSess_1092) <> true) then
                                                        0
                                                    else
                                                        {718}event endCli(Sess,Cli,PartS_1099)
                                            )
                                            else
                                                {719}let pkSess_1101: bitstring = fail-any in
                                                {720}out(c, GetEndpointRequest);
                                                {721}in(c, (SPs_1102: bitstring,=Sign,UP_1103: bitstring,=pkSess_1101));
                                                {722}new SPc_1104: bitstring;
                                                {723}new Nc_1105: bitstring;
                                                {724}let gNc_1106: bitstring = exp(g,Nc_1105) in
                                                {725}let m1_1107: bitstring = (SPc_1104,gNc_1106) in
                                                {726}out(c, (pkCli_1059,m1_1107,sign(m1_1107,skCli_1058)));
                                                {727}event beginCli(Cli,Sess,gNc_1106);
                                                {728}in(c, (PartS_1108: bitstring,sigPartS_1109: bitstring));
                                                {729}if (verify(PartS_1108,sigPartS_1109,pkSess_1101) <> true) then
                                                    0
                                                else
                                                    {730}event endCli(Sess,Cli,PartS_1108)
                                    )
                                    else
                                        {731}let pkSess_1110: bitstring = fail-any in
                                        {732}out(c, GetEndpointRequest);
                                        {733}in(c, (SPs_1111: bitstring,=Sign,UP_1112: bitstring,=pkSess_1110));
                                        {734}new SPc_1113: bitstring;
                                        {735}new Nc_1114: bitstring;
                                        {736}let gNc_1115: bitstring = exp(g,Nc_1114) in
                                        {737}let m1_1116: bitstring = (SPc_1113,gNc_1115) in
                                        {738}out(c, (pkCli_1059,m1_1116,sign(m1_1116,skCli_1058)));
                                        {739}event beginCli(Cli,Sess,gNc_1115);
                                        {740}in(c, (PartS_1117: bitstring,sigPartS_1118: bitstring));
                                        {741}if (verify(PartS_1117,sigPartS_1118,pkSess_1110) <> true) then
                                            0
                                        else
                                            {742}event endCli(Sess,Cli,PartS_1117)
                            )
                            else
                                {743}let pkSess_1119: bitstring = fail-any in
                                {744}out(c, GetEndpointRequest);
                                {745}in(c, (SPs_1120: bitstring,=Sign,UP_1121: bitstring,=pkSess_1119));
                                {746}new SPc_1122: bitstring;
                                {747}new Nc_1123: bitstring;
                                {748}let gNc_1124: bitstring = exp(g,Nc_1123) in
                                {749}let m1_1125: bitstring = (SPc_1122,gNc_1124) in
                                {750}out(c, (pkCli_1059,m1_1125,sign(m1_1125,skCli_1058)));
                                {751}event beginCli(Cli,Sess,gNc_1124);
                                {752}in(c, (PartS_1126: bitstring,sigPartS_1127: bitstring));
                                {753}if (verify(PartS_1126,sigPartS_1127,pkSess_1119) <> true) then
                                    0
                                else
                                    {754}event endCli(Sess,Cli,PartS_1126)
                        )
                        else
                            {755}let v_1128: bool = (Disco = B) in
                            (
                                {756}if v_1128 then
                                (
                                    {757}let pkDisco_1129: bitstring = pub(skB) in
                                    {758}let v_1130: bool = (Sess = A) in
                                    (
                                        {759}if v_1130 then
                                        (
                                            {760}let pkSess_1131: bitstring = pub(skA) in
                                            {761}out(c, GetEndpointRequest);
                                            {762}in(c, (SPs_1132: bitstring,=Sign,UP_1133: bitstring,=pkSess_1131));
                                            {763}new SPc_1134: bitstring;
                                            {764}new Nc_1135: bitstring;
                                            {765}let gNc_1136: bitstring = exp(g,Nc_1135) in
                                            {766}let m1_1137: bitstring = (SPc_1134,gNc_1136) in
                                            {767}out(c, (pkCli_1059,m1_1137,sign(m1_1137,skCli_1058)));
                                            {768}event beginCli(Cli,Sess,gNc_1136);
                                            {769}in(c, (PartS_1138: bitstring,sigPartS_1139: bitstring));
                                            {770}if (verify(PartS_1138,sigPartS_1139,pkSess_1131) <> true) then
                                                0
                                            else
                                                {771}event endCli(Sess,Cli,PartS_1138)
                                        )
                                        else
                                            {772}let v_1140: bool = (Sess = B) in
                                            (
                                                {773}if v_1140 then
                                                (
                                                    {774}let pkSess_1141: bitstring = pub(skB) in
                                                    {775}out(c, GetEndpointRequest);
                                                    {776}in(c, (SPs_1142: bitstring,=Sign,UP_1143: bitstring,=pkSess_1141));
                                                    {777}new SPc_1144: bitstring;
                                                    {778}new Nc_1145: bitstring;
                                                    {779}let gNc_1146: bitstring = exp(g,Nc_1145) in
                                                    {780}let m1_1147: bitstring = (SPc_1144,gNc_1146) in
                                                    {781}out(c, (pkCli_1059,m1_1147,sign(m1_1147,skCli_1058)));
                                                    {782}event beginCli(Cli,Sess,gNc_1146);
                                                    {783}in(c, (PartS_1148: bitstring,sigPartS_1149: bitstring));
                                                    {784}if (verify(PartS_1148,sigPartS_1149,pkSess_1141) <> true) then
                                                        0
                                                    else
                                                        {785}event endCli(Sess,Cli,PartS_1148)
                                                )
                                                else
                                                    {786}let v_1150: bool = (Sess = C) in
                                                    (
                                                        {787}if v_1150 then
                                                        (
                                                            {788}let pkSess_1151: bitstring = pub(skC) in
                                                            {789}out(c, GetEndpointRequest);
                                                            {790}in(c, (SPs_1152: bitstring,=Sign,UP_1153: bitstring,=pkSess_1151));
                                                            {791}new SPc_1154: bitstring;
                                                            {792}new Nc_1155: bitstring;
                                                            {793}let gNc_1156: bitstring = exp(g,Nc_1155) in
                                                            {794}let m1_1157: bitstring = (SPc_1154,gNc_1156) in
                                                            {795}out(c, (pkCli_1059,m1_1157,sign(m1_1157,skCli_1058)));
                                                            {796}event beginCli(Cli,Sess,gNc_1156);
                                                            {797}in(c, (PartS_1158: bitstring,sigPartS_1159: bitstring));
                                                            {798}if (verify(PartS_1158,sigPartS_1159,pkSess_1151) <> true) then
                                                                0
                                                            else
                                                                {799}event endCli(Sess,Cli,PartS_1158)
                                                        )
                                                        else
                                                            {800}let pkSess_1160: bitstring = pub(skI) in
                                                            {801}out(c, GetEndpointRequest);
                                                            {802}in(c, (SPs_1161: bitstring,=Sign,UP_1162: bitstring,=pkSess_1160));
                                                            {803}new SPc_1163: bitstring;
                                                            {804}new Nc_1164: bitstring;
                                                            {805}let gNc_1165: bitstring = exp(g,Nc_1164) in
                                                            {806}let m1_1166: bitstring = (SPc_1163,gNc_1165) in
                                                            {807}out(c, (pkCli_1059,m1_1166,sign(m1_1166,skCli_1058)));
                                                            {808}event beginCli(Cli,Sess,gNc_1165);
                                                            {809}in(c, (PartS_1167: bitstring,sigPartS_1168: bitstring));
                                                            {810}if (verify(PartS_1167,sigPartS_1168,pkSess_1160) <> true) then
                                                                0
                                                            else
                                                                {811}event endCli(Sess,Cli,PartS_1167)
                                                    )
                                                    else
                                                        {812}let pkSess_1169: bitstring = fail-any in
                                                        {813}out(c, GetEndpointRequest);
                                                        {814}in(c, (SPs_1170: bitstring,=Sign,UP_1171: bitstring,=pkSess_1169));
                                                        {815}new SPc_1172: bitstring;
                                                        {816}new Nc_1173: bitstring;
                                                        {817}let gNc_1174: bitstring = exp(g,Nc_1173) in
                                                        {818}let m1_1175: bitstring = (SPc_1172,gNc_1174) in
                                                        {819}out(c, (pkCli_1059,m1_1175,sign(m1_1175,skCli_1058)));
                                                        {820}event beginCli(Cli,Sess,gNc_1174);
                                                        {821}in(c, (PartS_1176: bitstring,sigPartS_1177: bitstring));
                                                        {822}if (verify(PartS_1176,sigPartS_1177,pkSess_1169) <> true) then
                                                            0
                                                        else
                                                            {823}event endCli(Sess,Cli,PartS_1176)
                                            )
                                            else
                                                {824}let pkSess_1178: bitstring = fail-any in
                                                {825}out(c, GetEndpointRequest);
                                                {826}in(c, (SPs_1179: bitstring,=Sign,UP_1180: bitstring,=pkSess_1178));
                                                {827}new SPc_1181: bitstring;
                                                {828}new Nc_1182: bitstring;
                                                {829}let gNc_1183: bitstring = exp(g,Nc_1182) in
                                                {830}let m1_1184: bitstring = (SPc_1181,gNc_1183) in
                                                {831}out(c, (pkCli_1059,m1_1184,sign(m1_1184,skCli_1058)));
                                                {832}event beginCli(Cli,Sess,gNc_1183);
                                                {833}in(c, (PartS_1185: bitstring,sigPartS_1186: bitstring));
                                                {834}if (verify(PartS_1185,sigPartS_1186,pkSess_1178) <> true) then
                                                    0
                                                else
                                                    {835}event endCli(Sess,Cli,PartS_1185)
                                    )
                                    else
                                        {836}let pkSess_1187: bitstring = fail-any in
                                        {837}out(c, GetEndpointRequest);
                                        {838}in(c, (SPs_1188: bitstring,=Sign,UP_1189: bitstring,=pkSess_1187));
                                        {839}new SPc_1190: bitstring;
                                        {840}new Nc_1191: bitstring;
                                        {841}let gNc_1192: bitstring = exp(g,Nc_1191) in
                                        {842}let m1_1193: bitstring = (SPc_1190,gNc_1192) in
                                        {843}out(c, (pkCli_1059,m1_1193,sign(m1_1193,skCli_1058)));
                                        {844}event beginCli(Cli,Sess,gNc_1192);
                                        {845}in(c, (PartS_1194: bitstring,sigPartS_1195: bitstring));
                                        {846}if (verify(PartS_1194,sigPartS_1195,pkSess_1187) <> true) then
                                            0
                                        else
                                            {847}event endCli(Sess,Cli,PartS_1194)
                                )
                                else
                                    {848}let v_1196: bool = (Disco = C) in
                                    (
                                        {849}if v_1196 then
                                        (
                                            {850}let pkDisco_1197: bitstring = pub(skC) in
                                            {851}let v_1198: bool = (Sess = A) in
                                            (
                                                {852}if v_1198 then
                                                (
                                                    {853}let pkSess_1199: bitstring = pub(skA) in
                                                    {854}out(c, GetEndpointRequest);
                                                    {855}in(c, (SPs_1200: bitstring,=Sign,UP_1201: bitstring,=pkSess_1199));
                                                    {856}new SPc_1202: bitstring;
                                                    {857}new Nc_1203: bitstring;
                                                    {858}let gNc_1204: bitstring = exp(g,Nc_1203) in
                                                    {859}let m1_1205: bitstring = (SPc_1202,gNc_1204) in
                                                    {860}out(c, (pkCli_1059,m1_1205,sign(m1_1205,skCli_1058)));
                                                    {861}event beginCli(Cli,Sess,gNc_1204);
                                                    {862}in(c, (PartS_1206: bitstring,sigPartS_1207: bitstring));
                                                    {863}if (verify(PartS_1206,sigPartS_1207,pkSess_1199) <> true) then
                                                        0
                                                    else
                                                        {864}event endCli(Sess,Cli,PartS_1206)
                                                )
                                                else
                                                    {865}let v_1208: bool = (Sess = B) in
                                                    (
                                                        {866}if v_1208 then
                                                        (
                                                            {867}let pkSess_1209: bitstring = pub(skB) in
                                                            {868}out(c, GetEndpointRequest);
                                                            {869}in(c, (SPs_1210: bitstring,=Sign,UP_1211: bitstring,=pkSess_1209));
                                                            {870}new SPc_1212: bitstring;
                                                            {871}new Nc_1213: bitstring;
                                                            {872}let gNc_1214: bitstring = exp(g,Nc_1213) in
                                                            {873}let m1_1215: bitstring = (SPc_1212,gNc_1214) in
                                                            {874}out(c, (pkCli_1059,m1_1215,sign(m1_1215,skCli_1058)));
                                                            {875}event beginCli(Cli,Sess,gNc_1214);
                                                            {876}in(c, (PartS_1216: bitstring,sigPartS_1217: bitstring));
                                                            {877}if (verify(PartS_1216,sigPartS_1217,pkSess_1209) <> true) then
                                                                0
                                                            else
                                                                {878}event endCli(Sess,Cli,PartS_1216)
                                                        )
                                                        else
                                                            {879}let v_1218: bool = (Sess = C) in
                                                            (
                                                                {880}if v_1218 then
                                                                (
                                                                    {881}let pkSess_1219: bitstring = pub(skC) in
                                                                    {882}out(c, GetEndpointRequest);
                                                                    {883}in(c, (SPs_1220: bitstring,=Sign,UP_1221: bitstring,=pkSess_1219));
                                                                    {884}new SPc_1222: bitstring;
                                                                    {885}new Nc_1223: bitstring;
                                                                    {886}let gNc_1224: bitstring = exp(g,Nc_1223) in
                                                                    {887}let m1_1225: bitstring = (SPc_1222,gNc_1224) in
                                                                    {888}out(c, (pkCli_1059,m1_1225,sign(m1_1225,skCli_1058)));
                                                                    {889}event beginCli(Cli,Sess,gNc_1224);
                                                                    {890}in(c, (PartS_1226: bitstring,sigPartS_1227: bitstring));
                                                                    {891}if (verify(PartS_1226,sigPartS_1227,pkSess_1219) <> true) then
                                                                        0
                                                                    else
                                                                        {892}event endCli(Sess,Cli,PartS_1226)
                                                                )
                                                                else
                                                                    {893}let pkSess_1228: bitstring = pub(skI) in
                                                                    {894}out(c, GetEndpointRequest);
                                                                    {895}in(c, (SPs_1229: bitstring,=Sign,UP_1230: bitstring,=pkSess_1228));
                                                                    {896}new SPc_1231: bitstring;
                                                                    {897}new Nc_1232: bitstring;
                                                                    {898}let gNc_1233: bitstring = exp(g,Nc_1232) in
                                                                    {899}let m1_1234: bitstring = (SPc_1231,gNc_1233) in
                                                                    {900}out(c, (pkCli_1059,m1_1234,sign(m1_1234,skCli_1058)));
                                                                    {901}event beginCli(Cli,Sess,gNc_1233);
                                                                    {902}in(c, (PartS_1235: bitstring,sigPartS_1236: bitstring));
                                                                    {903}if (verify(PartS_1235,sigPartS_1236,pkSess_1228) <> true) then
                                                                        0
                                                                    else
                                                                        {904}event endCli(Sess,Cli,PartS_1235)
                                                            )
                                                            else
                                                                {905}let pkSess_1237: bitstring = fail-any in
                                                                {906}out(c, GetEndpointRequest);
                                                                {907}in(c, (SPs_1238: bitstring,=Sign,UP_1239: bitstring,=pkSess_1237));
                                                                {908}new SPc_1240: bitstring;
                                                                {909}new Nc_1241: bitstring;
                                                                {910}let gNc_1242: bitstring = exp(g,Nc_1241) in
                                                                {911}let m1_1243: bitstring = (SPc_1240,gNc_1242) in
                                                                {912}out(c, (pkCli_1059,m1_1243,sign(m1_1243,skCli_1058)));
                                                                {913}event beginCli(Cli,Sess,gNc_1242);
                                                                {914}in(c, (PartS_1244: bitstring,sigPartS_1245: bitstring));
                                                                {915}if (verify(PartS_1244,sigPartS_1245,pkSess_1237) <> true) then
                                                                    0
                                                                else
                                                                    {916}event endCli(Sess,Cli,PartS_1244)
                                                    )
                                                    else
                                                        {917}let pkSess_1246: bitstring = fail-any in
                                                        {918}out(c, GetEndpointRequest);
                                                        {919}in(c, (SPs_1247: bitstring,=Sign,UP_1248: bitstring,=pkSess_1246));
                                                        {920}new SPc_1249: bitstring;
                                                        {921}new Nc_1250: bitstring;
                                                        {922}let gNc_1251: bitstring = exp(g,Nc_1250) in
                                                        {923}let m1_1252: bitstring = (SPc_1249,gNc_1251) in
                                                        {924}out(c, (pkCli_1059,m1_1252,sign(m1_1252,skCli_1058)));
                                                        {925}event beginCli(Cli,Sess,gNc_1251);
                                                        {926}in(c, (PartS_1253: bitstring,sigPartS_1254: bitstring));
                                                        {927}if (verify(PartS_1253,sigPartS_1254,pkSess_1246) <> true) then
                                                            0
                                                        else
                                                            {928}event endCli(Sess,Cli,PartS_1253)
                                            )
                                            else
                                                {929}let pkSess_1255: bitstring = fail-any in
                                                {930}out(c, GetEndpointRequest);
                                                {931}in(c, (SPs_1256: bitstring,=Sign,UP_1257: bitstring,=pkSess_1255));
                                                {932}new SPc_1258: bitstring;
                                                {933}new Nc_1259: bitstring;
                                                {934}let gNc_1260: bitstring = exp(g,Nc_1259) in
                                                {935}let m1_1261: bitstring = (SPc_1258,gNc_1260) in
                                                {936}out(c, (pkCli_1059,m1_1261,sign(m1_1261,skCli_1058)));
                                                {937}event beginCli(Cli,Sess,gNc_1260);
                                                {938}in(c, (PartS_1262: bitstring,sigPartS_1263: bitstring));
                                                {939}if (verify(PartS_1262,sigPartS_1263,pkSess_1255) <> true) then
                                                    0
                                                else
                                                    {940}event endCli(Sess,Cli,PartS_1262)
                                        )
                                        else
                                            {941}let pkDisco_1264: bitstring = pub(skI) in
                                            {942}let v_1265: bool = (Sess = A) in
                                            (
                                                {943}if v_1265 then
                                                (
                                                    {944}let pkSess_1266: bitstring = pub(skA) in
                                                    {945}out(c, GetEndpointRequest);
                                                    {946}in(c, (SPs_1267: bitstring,=Sign,UP_1268: bitstring,=pkSess_1266));
                                                    {947}new SPc_1269: bitstring;
                                                    {948}new Nc_1270: bitstring;
                                                    {949}let gNc_1271: bitstring = exp(g,Nc_1270) in
                                                    {950}let m1_1272: bitstring = (SPc_1269,gNc_1271) in
                                                    {951}out(c, (pkCli_1059,m1_1272,sign(m1_1272,skCli_1058)));
                                                    {952}event beginCli(Cli,Sess,gNc_1271);
                                                    {953}in(c, (PartS_1273: bitstring,sigPartS_1274: bitstring));
                                                    {954}if (verify(PartS_1273,sigPartS_1274,pkSess_1266) <> true) then
                                                        0
                                                    else
                                                        {955}event endCli(Sess,Cli,PartS_1273)
                                                )
                                                else
                                                    {956}let v_1275: bool = (Sess = B) in
                                                    (
                                                        {957}if v_1275 then
                                                        (
                                                            {958}let pkSess_1276: bitstring = pub(skB) in
                                                            {959}out(c, GetEndpointRequest);
                                                            {960}in(c, (SPs_1277: bitstring,=Sign,UP_1278: bitstring,=pkSess_1276));
                                                            {961}new SPc_1279: bitstring;
                                                            {962}new Nc_1280: bitstring;
                                                            {963}let gNc_1281: bitstring = exp(g,Nc_1280) in
                                                            {964}let m1_1282: bitstring = (SPc_1279,gNc_1281) in
                                                            {965}out(c, (pkCli_1059,m1_1282,sign(m1_1282,skCli_1058)));
                                                            {966}event beginCli(Cli,Sess,gNc_1281);
                                                            {967}in(c, (PartS_1283: bitstring,sigPartS_1284: bitstring));
                                                            {968}if (verify(PartS_1283,sigPartS_1284,pkSess_1276) <> true) then
                                                                0
                                                            else
                                                                {969}event endCli(Sess,Cli,PartS_1283)
                                                        )
                                                        else
                                                            {970}let v_1285: bool = (Sess = C) in
                                                            (
                                                                {971}if v_1285 then
                                                                (
                                                                    {972}let pkSess_1286: bitstring = pub(skC) in
                                                                    {973}out(c, GetEndpointRequest);
                                                                    {974}in(c, (SPs_1287: bitstring,=Sign,UP_1288: bitstring,=pkSess_1286));
                                                                    {975}new SPc_1289: bitstring;
                                                                    {976}new Nc_1290: bitstring;
                                                                    {977}let gNc_1291: bitstring = exp(g,Nc_1290) in
                                                                    {978}let m1_1292: bitstring = (SPc_1289,gNc_1291) in
                                                                    {979}out(c, (pkCli_1059,m1_1292,sign(m1_1292,skCli_1058)));
                                                                    {980}event beginCli(Cli,Sess,gNc_1291);
                                                                    {981}in(c, (PartS_1293: bitstring,sigPartS_1294: bitstring));
                                                                    {982}if (verify(PartS_1293,sigPartS_1294,pkSess_1286) <> true) then
                                                                        0
                                                                    else
                                                                        {983}event endCli(Sess,Cli,PartS_1293)
                                                                )
                                                                else
                                                                    {984}let pkSess_1295: bitstring = pub(skI) in
                                                                    {985}out(c, GetEndpointRequest);
                                                                    {986}in(c, (SPs_1296: bitstring,=Sign,UP_1297: bitstring,=pkSess_1295));
                                                                    {987}new SPc_1298: bitstring;
                                                                    {988}new Nc_1299: bitstring;
                                                                    {989}let gNc_1300: bitstring = exp(g,Nc_1299) in
                                                                    {990}let m1_1301: bitstring = (SPc_1298,gNc_1300) in
                                                                    {991}out(c, (pkCli_1059,m1_1301,sign(m1_1301,skCli_1058)));
                                                                    {992}event beginCli(Cli,Sess,gNc_1300);
                                                                    {993}in(c, (PartS_1302: bitstring,sigPartS_1303: bitstring));
                                                                    {994}if (verify(PartS_1302,sigPartS_1303,pkSess_1295) <> true) then
                                                                        0
                                                                    else
                                                                        {995}event endCli(Sess,Cli,PartS_1302)
                                                            )
                                                            else
                                                                {996}let pkSess_1304: bitstring = fail-any in
                                                                {997}out(c, GetEndpointRequest);
                                                                {998}in(c, (SPs_1305: bitstring,=Sign,UP_1306: bitstring,=pkSess_1304));
                                                                {999}new SPc_1307: bitstring;
                                                                {1000}new Nc_1308: bitstring;
                                                                {1001}let gNc_1309: bitstring = exp(g,Nc_1308) in
                                                                {1002}let m1_1310: bitstring = (SPc_1307,gNc_1309) in
                                                                {1003}out(c, (pkCli_1059,m1_1310,sign(m1_1310,skCli_1058)));
                                                                {1004}event beginCli(Cli,Sess,gNc_1309);
                                                                {1005}in(c, (PartS_1311: bitstring,sigPartS_1312: bitstring));
                                                                {1006}if (verify(PartS_1311,sigPartS_1312,pkSess_1304) <> true) then
                                                                    0
                                                                else
                                                                    {1007}event endCli(Sess,Cli,PartS_1311)
                                                    )
                                                    else
                                                        {1008}let pkSess_1313: bitstring = fail-any in
                                                        {1009}out(c, GetEndpointRequest);
                                                        {1010}in(c, (SPs_1314: bitstring,=Sign,UP_1315: bitstring,=pkSess_1313));
                                                        {1011}new SPc_1316: bitstring;
                                                        {1012}new Nc_1317: bitstring;
                                                        {1013}let gNc_1318: bitstring = exp(g,Nc_1317) in
                                                        {1014}let m1_1319: bitstring = (SPc_1316,gNc_1318) in
                                                        {1015}out(c, (pkCli_1059,m1_1319,sign(m1_1319,skCli_1058)));
                                                        {1016}event beginCli(Cli,Sess,gNc_1318);
                                                        {1017}in(c, (PartS_1320: bitstring,sigPartS_1321: bitstring));
                                                        {1018}if (verify(PartS_1320,sigPartS_1321,pkSess_1313) <> true) then
                                                            0
                                                        else
                                                            {1019}event endCli(Sess,Cli,PartS_1320)
                                            )
                                            else
                                                {1020}let pkSess_1322: bitstring = fail-any in
                                                {1021}out(c, GetEndpointRequest);
                                                {1022}in(c, (SPs_1323: bitstring,=Sign,UP_1324: bitstring,=pkSess_1322));
                                                {1023}new SPc_1325: bitstring;
                                                {1024}new Nc_1326: bitstring;
                                                {1025}let gNc_1327: bitstring = exp(g,Nc_1326) in
                                                {1026}let m1_1328: bitstring = (SPc_1325,gNc_1327) in
                                                {1027}out(c, (pkCli_1059,m1_1328,sign(m1_1328,skCli_1058)));
                                                {1028}event beginCli(Cli,Sess,gNc_1327);
                                                {1029}in(c, (PartS_1329: bitstring,sigPartS_1330: bitstring));
                                                {1030}if (verify(PartS_1329,sigPartS_1330,pkSess_1322) <> true) then
                                                    0
                                                else
                                                    {1031}event endCli(Sess,Cli,PartS_1329)
                                    )
                                    else
                                        {1032}let pkDisco_1331: bitstring = fail-any in
                                        {1033}let v_1332: bool = (Sess = A) in
                                        (
                                            {1034}if v_1332 then
                                            (
                                                {1035}let pkSess_1333: bitstring = pub(skA) in
                                                {1036}out(c, GetEndpointRequest);
                                                {1037}in(c, (SPs_1334: bitstring,=Sign,UP_1335: bitstring,=pkSess_1333));
                                                {1038}new SPc_1336: bitstring;
                                                {1039}new Nc_1337: bitstring;
                                                {1040}let gNc_1338: bitstring = exp(g,Nc_1337) in
                                                {1041}let m1_1339: bitstring = (SPc_1336,gNc_1338) in
                                                {1042}out(c, (pkCli_1059,m1_1339,sign(m1_1339,skCli_1058)));
                                                {1043}event beginCli(Cli,Sess,gNc_1338);
                                                {1044}in(c, (PartS_1340: bitstring,sigPartS_1341: bitstring));
                                                {1045}if (verify(PartS_1340,sigPartS_1341,pkSess_1333) <> true) then
                                                    0
                                                else
                                                    {1046}event endCli(Sess,Cli,PartS_1340)
                                            )
                                            else
                                                {1047}let v_1342: bool = (Sess = B) in
                                                (
                                                    {1048}if v_1342 then
                                                    (
                                                        {1049}let pkSess_1343: bitstring = pub(skB) in
                                                        {1050}out(c, GetEndpointRequest);
                                                        {1051}in(c, (SPs_1344: bitstring,=Sign,UP_1345: bitstring,=pkSess_1343));
                                                        {1052}new SPc_1346: bitstring;
                                                        {1053}new Nc_1347: bitstring;
                                                        {1054}let gNc_1348: bitstring = exp(g,Nc_1347) in
                                                        {1055}let m1_1349: bitstring = (SPc_1346,gNc_1348) in
                                                        {1056}out(c, (pkCli_1059,m1_1349,sign(m1_1349,skCli_1058)));
                                                        {1057}event beginCli(Cli,Sess,gNc_1348);
                                                        {1058}in(c, (PartS_1350: bitstring,sigPartS_1351: bitstring));
                                                        {1059}if (verify(PartS_1350,sigPartS_1351,pkSess_1343) <> true) then
                                                            0
                                                        else
                                                            {1060}event endCli(Sess,Cli,PartS_1350)
                                                    )
                                                    else
                                                        {1061}let v_1352: bool = (Sess = C) in
                                                        (
                                                            {1062}if v_1352 then
                                                            (
                                                                {1063}let pkSess_1353: bitstring = pub(skC) in
                                                                {1064}out(c, GetEndpointRequest);
                                                                {1065}in(c, (SPs_1354: bitstring,=Sign,UP_1355: bitstring,=pkSess_1353));
                                                                {1066}new SPc_1356: bitstring;
                                                                {1067}new Nc_1357: bitstring;
                                                                {1068}let gNc_1358: bitstring = exp(g,Nc_1357) in
                                                                {1069}let m1_1359: bitstring = (SPc_1356,gNc_1358) in
                                                                {1070}out(c, (pkCli_1059,m1_1359,sign(m1_1359,skCli_1058)));
                                                                {1071}event beginCli(Cli,Sess,gNc_1358);
                                                                {1072}in(c, (PartS_1360: bitstring,sigPartS_1361: bitstring));
                                                                {1073}if (verify(PartS_1360,sigPartS_1361,pkSess_1353) <> true) then
                                                                    0
                                                                else
                                                                    {1074}event endCli(Sess,Cli,PartS_1360)
                                                            )
                                                            else
                                                                {1075}let pkSess_1362: bitstring = pub(skI) in
                                                                {1076}out(c, GetEndpointRequest);
                                                                {1077}in(c, (SPs_1363: bitstring,=Sign,UP_1364: bitstring,=pkSess_1362));
                                                                {1078}new SPc_1365: bitstring;
                                                                {1079}new Nc_1366: bitstring;
                                                                {1080}let gNc_1367: bitstring = exp(g,Nc_1366) in
                                                                {1081}let m1_1368: bitstring = (SPc_1365,gNc_1367) in
                                                                {1082}out(c, (pkCli_1059,m1_1368,sign(m1_1368,skCli_1058)));
                                                                {1083}event beginCli(Cli,Sess,gNc_1367);
                                                                {1084}in(c, (PartS_1369: bitstring,sigPartS_1370: bitstring));
                                                                {1085}if (verify(PartS_1369,sigPartS_1370,pkSess_1362) <> true) then
                                                                    0
                                                                else
                                                                    {1086}event endCli(Sess,Cli,PartS_1369)
                                                        )
                                                        else
                                                            {1087}let pkSess_1371: bitstring = fail-any in
                                                            {1088}out(c, GetEndpointRequest);
                                                            {1089}in(c, (SPs_1372: bitstring,=Sign,UP_1373: bitstring,=pkSess_1371));
                                                            {1090}new SPc_1374: bitstring;
                                                            {1091}new Nc_1375: bitstring;
                                                            {1092}let gNc_1376: bitstring = exp(g,Nc_1375) in
                                                            {1093}let m1_1377: bitstring = (SPc_1374,gNc_1376) in
                                                            {1094}out(c, (pkCli_1059,m1_1377,sign(m1_1377,skCli_1058)));
                                                            {1095}event beginCli(Cli,Sess,gNc_1376);
                                                            {1096}in(c, (PartS_1378: bitstring,sigPartS_1379: bitstring));
                                                            {1097}if (verify(PartS_1378,sigPartS_1379,pkSess_1371) <> true) then
                                                                0
                                                            else
                                                                {1098}event endCli(Sess,Cli,PartS_1378)
                                                )
                                                else
                                                    {1099}let pkSess_1380: bitstring = fail-any in
                                                    {1100}out(c, GetEndpointRequest);
                                                    {1101}in(c, (SPs_1381: bitstring,=Sign,UP_1382: bitstring,=pkSess_1380));
                                                    {1102}new SPc_1383: bitstring;
                                                    {1103}new Nc_1384: bitstring;
                                                    {1104}let gNc_1385: bitstring = exp(g,Nc_1384) in
                                                    {1105}let m1_1386: bitstring = (SPc_1383,gNc_1385) in
                                                    {1106}out(c, (pkCli_1059,m1_1386,sign(m1_1386,skCli_1058)));
                                                    {1107}event beginCli(Cli,Sess,gNc_1385);
                                                    {1108}in(c, (PartS_1387: bitstring,sigPartS_1388: bitstring));
                                                    {1109}if (verify(PartS_1387,sigPartS_1388,pkSess_1380) <> true) then
                                                        0
                                                    else
                                                        {1110}event endCli(Sess,Cli,PartS_1387)
                                        )
                                        else
                                            {1111}let pkSess_1389: bitstring = fail-any in
                                            {1112}out(c, GetEndpointRequest);
                                            {1113}in(c, (SPs_1390: bitstring,=Sign,UP_1391: bitstring,=pkSess_1389));
                                            {1114}new SPc_1392: bitstring;
                                            {1115}new Nc_1393: bitstring;
                                            {1116}let gNc_1394: bitstring = exp(g,Nc_1393) in
                                            {1117}let m1_1395: bitstring = (SPc_1392,gNc_1394) in
                                            {1118}out(c, (pkCli_1059,m1_1395,sign(m1_1395,skCli_1058)));
                                            {1119}event beginCli(Cli,Sess,gNc_1394);
                                            {1120}in(c, (PartS_1396: bitstring,sigPartS_1397: bitstring));
                                            {1121}if (verify(PartS_1396,sigPartS_1397,pkSess_1389) <> true) then
                                                0
                                            else
                                                {1122}event endCli(Sess,Cli,PartS_1396)
                            )
                            else
                                {1123}let pkDisco_1398: bitstring = fail-any in
                                {1124}let v_1399: bool = (Sess = A) in
                                (
                                    {1125}if v_1399 then
                                    (
                                        {1126}let pkSess_1400: bitstring = pub(skA) in
                                        {1127}out(c, GetEndpointRequest);
                                        {1128}in(c, (SPs_1401: bitstring,=Sign,UP_1402: bitstring,=pkSess_1400));
                                        {1129}new SPc_1403: bitstring;
                                        {1130}new Nc_1404: bitstring;
                                        {1131}let gNc_1405: bitstring = exp(g,Nc_1404) in
                                        {1132}let m1_1406: bitstring = (SPc_1403,gNc_1405) in
                                        {1133}out(c, (pkCli_1059,m1_1406,sign(m1_1406,skCli_1058)));
                                        {1134}event beginCli(Cli,Sess,gNc_1405);
                                        {1135}in(c, (PartS_1407: bitstring,sigPartS_1408: bitstring));
                                        {1136}if (verify(PartS_1407,sigPartS_1408,pkSess_1400) <> true) then
                                            0
                                        else
                                            {1137}event endCli(Sess,Cli,PartS_1407)
                                    )
                                    else
                                        {1138}let v_1409: bool = (Sess = B) in
                                        (
                                            {1139}if v_1409 then
                                            (
                                                {1140}let pkSess_1410: bitstring = pub(skB) in
                                                {1141}out(c, GetEndpointRequest);
                                                {1142}in(c, (SPs_1411: bitstring,=Sign,UP_1412: bitstring,=pkSess_1410));
                                                {1143}new SPc_1413: bitstring;
                                                {1144}new Nc_1414: bitstring;
                                                {1145}let gNc_1415: bitstring = exp(g,Nc_1414) in
                                                {1146}let m1_1416: bitstring = (SPc_1413,gNc_1415) in
                                                {1147}out(c, (pkCli_1059,m1_1416,sign(m1_1416,skCli_1058)));
                                                {1148}event beginCli(Cli,Sess,gNc_1415);
                                                {1149}in(c, (PartS_1417: bitstring,sigPartS_1418: bitstring));
                                                {1150}if (verify(PartS_1417,sigPartS_1418,pkSess_1410) <> true) then
                                                    0
                                                else
                                                    {1151}event endCli(Sess,Cli,PartS_1417)
                                            )
                                            else
                                                {1152}let v_1419: bool = (Sess = C) in
                                                (
                                                    {1153}if v_1419 then
                                                    (
                                                        {1154}let pkSess_1420: bitstring = pub(skC) in
                                                        {1155}out(c, GetEndpointRequest);
                                                        {1156}in(c, (SPs_1421: bitstring,=Sign,UP_1422: bitstring,=pkSess_1420));
                                                        {1157}new SPc_1423: bitstring;
                                                        {1158}new Nc_1424: bitstring;
                                                        {1159}let gNc_1425: bitstring = exp(g,Nc_1424) in
                                                        {1160}let m1_1426: bitstring = (SPc_1423,gNc_1425) in
                                                        {1161}out(c, (pkCli_1059,m1_1426,sign(m1_1426,skCli_1058)));
                                                        {1162}event beginCli(Cli,Sess,gNc_1425);
                                                        {1163}in(c, (PartS_1427: bitstring,sigPartS_1428: bitstring));
                                                        {1164}if (verify(PartS_1427,sigPartS_1428,pkSess_1420) <> true) then
                                                            0
                                                        else
                                                            {1165}event endCli(Sess,Cli,PartS_1427)
                                                    )
                                                    else
                                                        {1166}let pkSess_1429: bitstring = pub(skI) in
                                                        {1167}out(c, GetEndpointRequest);
                                                        {1168}in(c, (SPs_1430: bitstring,=Sign,UP_1431: bitstring,=pkSess_1429));
                                                        {1169}new SPc_1432: bitstring;
                                                        {1170}new Nc_1433: bitstring;
                                                        {1171}let gNc_1434: bitstring = exp(g,Nc_1433) in
                                                        {1172}let m1_1435: bitstring = (SPc_1432,gNc_1434) in
                                                        {1173}out(c, (pkCli_1059,m1_1435,sign(m1_1435,skCli_1058)));
                                                        {1174}event beginCli(Cli,Sess,gNc_1434);
                                                        {1175}in(c, (PartS_1436: bitstring,sigPartS_1437: bitstring));
                                                        {1176}if (verify(PartS_1436,sigPartS_1437,pkSess_1429) <> true) then
                                                            0
                                                        else
                                                            {1177}event endCli(Sess,Cli,PartS_1436)
                                                )
                                                else
                                                    {1178}let pkSess_1438: bitstring = fail-any in
                                                    {1179}out(c, GetEndpointRequest);
                                                    {1180}in(c, (SPs_1439: bitstring,=Sign,UP_1440: bitstring,=pkSess_1438));
                                                    {1181}new SPc_1441: bitstring;
                                                    {1182}new Nc_1442: bitstring;
                                                    {1183}let gNc_1443: bitstring = exp(g,Nc_1442) in
                                                    {1184}let m1_1444: bitstring = (SPc_1441,gNc_1443) in
                                                    {1185}out(c, (pkCli_1059,m1_1444,sign(m1_1444,skCli_1058)));
                                                    {1186}event beginCli(Cli,Sess,gNc_1443);
                                                    {1187}in(c, (PartS_1445: bitstring,sigPartS_1446: bitstring));
                                                    {1188}if (verify(PartS_1445,sigPartS_1446,pkSess_1438) <> true) then
                                                        0
                                                    else
                                                        {1189}event endCli(Sess,Cli,PartS_1445)
                                        )
                                        else
                                            {1190}let pkSess_1447: bitstring = fail-any in
                                            {1191}out(c, GetEndpointRequest);
                                            {1192}in(c, (SPs_1448: bitstring,=Sign,UP_1449: bitstring,=pkSess_1447));
                                            {1193}new SPc_1450: bitstring;
                                            {1194}new Nc_1451: bitstring;
                                            {1195}let gNc_1452: bitstring = exp(g,Nc_1451) in
                                            {1196}let m1_1453: bitstring = (SPc_1450,gNc_1452) in
                                            {1197}out(c, (pkCli_1059,m1_1453,sign(m1_1453,skCli_1058)));
                                            {1198}event beginCli(Cli,Sess,gNc_1452);
                                            {1199}in(c, (PartS_1454: bitstring,sigPartS_1455: bitstring));
                                            {1200}if (verify(PartS_1454,sigPartS_1455,pkSess_1447) <> true) then
                                                0
                                            else
                                                {1201}event endCli(Sess,Cli,PartS_1454)
                                )
                                else
                                    {1202}let pkSess_1456: bitstring = fail-any in
                                    {1203}out(c, GetEndpointRequest);
                                    {1204}in(c, (SPs_1457: bitstring,=Sign,UP_1458: bitstring,=pkSess_1456));
                                    {1205}new SPc_1459: bitstring;
                                    {1206}new Nc_1460: bitstring;
                                    {1207}let gNc_1461: bitstring = exp(g,Nc_1460) in
                                    {1208}let m1_1462: bitstring = (SPc_1459,gNc_1461) in
                                    {1209}out(c, (pkCli_1059,m1_1462,sign(m1_1462,skCli_1058)));
                                    {1210}event beginCli(Cli,Sess,gNc_1461);
                                    {1211}in(c, (PartS_1463: bitstring,sigPartS_1464: bitstring));
                                    {1212}if (verify(PartS_1463,sigPartS_1464,pkSess_1456) <> true) then
                                        0
                                    else
                                        {1213}event endCli(Sess,Cli,PartS_1463)
                    )
                    else
                        {1214}let pkDisco_1465: bitstring = fail-any in
                        {1215}let v_1466: bool = (Sess = A) in
                        (
                            {1216}if v_1466 then
                            (
                                {1217}let pkSess_1467: bitstring = pub(skA) in
                                {1218}out(c, GetEndpointRequest);
                                {1219}in(c, (SPs_1468: bitstring,=Sign,UP_1469: bitstring,=pkSess_1467));
                                {1220}new SPc_1470: bitstring;
                                {1221}new Nc_1471: bitstring;
                                {1222}let gNc_1472: bitstring = exp(g,Nc_1471) in
                                {1223}let m1_1473: bitstring = (SPc_1470,gNc_1472) in
                                {1224}out(c, (pkCli_1059,m1_1473,sign(m1_1473,skCli_1058)));
                                {1225}event beginCli(Cli,Sess,gNc_1472);
                                {1226}in(c, (PartS_1474: bitstring,sigPartS_1475: bitstring));
                                {1227}if (verify(PartS_1474,sigPartS_1475,pkSess_1467) <> true) then
                                    0
                                else
                                    {1228}event endCli(Sess,Cli,PartS_1474)
                            )
                            else
                                {1229}let v_1476: bool = (Sess = B) in
                                (
                                    {1230}if v_1476 then
                                    (
                                        {1231}let pkSess_1477: bitstring = pub(skB) in
                                        {1232}out(c, GetEndpointRequest);
                                        {1233}in(c, (SPs_1478: bitstring,=Sign,UP_1479: bitstring,=pkSess_1477));
                                        {1234}new SPc_1480: bitstring;
                                        {1235}new Nc_1481: bitstring;
                                        {1236}let gNc_1482: bitstring = exp(g,Nc_1481) in
                                        {1237}let m1_1483: bitstring = (SPc_1480,gNc_1482) in
                                        {1238}out(c, (pkCli_1059,m1_1483,sign(m1_1483,skCli_1058)));
                                        {1239}event beginCli(Cli,Sess,gNc_1482);
                                        {1240}in(c, (PartS_1484: bitstring,sigPartS_1485: bitstring));
                                        {1241}if (verify(PartS_1484,sigPartS_1485,pkSess_1477) <> true) then
                                            0
                                        else
                                            {1242}event endCli(Sess,Cli,PartS_1484)
                                    )
                                    else
                                        {1243}let v_1486: bool = (Sess = C) in
                                        (
                                            {1244}if v_1486 then
                                            (
                                                {1245}let pkSess_1487: bitstring = pub(skC) in
                                                {1246}out(c, GetEndpointRequest);
                                                {1247}in(c, (SPs_1488: bitstring,=Sign,UP_1489: bitstring,=pkSess_1487));
                                                {1248}new SPc_1490: bitstring;
                                                {1249}new Nc_1491: bitstring;
                                                {1250}let gNc_1492: bitstring = exp(g,Nc_1491) in
                                                {1251}let m1_1493: bitstring = (SPc_1490,gNc_1492) in
                                                {1252}out(c, (pkCli_1059,m1_1493,sign(m1_1493,skCli_1058)));
                                                {1253}event beginCli(Cli,Sess,gNc_1492);
                                                {1254}in(c, (PartS_1494: bitstring,sigPartS_1495: bitstring));
                                                {1255}if (verify(PartS_1494,sigPartS_1495,pkSess_1487) <> true) then
                                                    0
                                                else
                                                    {1256}event endCli(Sess,Cli,PartS_1494)
                                            )
                                            else
                                                {1257}let pkSess_1496: bitstring = pub(skI) in
                                                {1258}out(c, GetEndpointRequest);
                                                {1259}in(c, (SPs_1497: bitstring,=Sign,UP_1498: bitstring,=pkSess_1496));
                                                {1260}new SPc_1499: bitstring;
                                                {1261}new Nc_1500: bitstring;
                                                {1262}let gNc_1501: bitstring = exp(g,Nc_1500) in
                                                {1263}let m1_1502: bitstring = (SPc_1499,gNc_1501) in
                                                {1264}out(c, (pkCli_1059,m1_1502,sign(m1_1502,skCli_1058)));
                                                {1265}event beginCli(Cli,Sess,gNc_1501);
                                                {1266}in(c, (PartS_1503: bitstring,sigPartS_1504: bitstring));
                                                {1267}if (verify(PartS_1503,sigPartS_1504,pkSess_1496) <> true) then
                                                    0
                                                else
                                                    {1268}event endCli(Sess,Cli,PartS_1503)
                                        )
                                        else
                                            {1269}let pkSess_1505: bitstring = fail-any in
                                            {1270}out(c, GetEndpointRequest);
                                            {1271}in(c, (SPs_1506: bitstring,=Sign,UP_1507: bitstring,=pkSess_1505));
                                            {1272}new SPc_1508: bitstring;
                                            {1273}new Nc_1509: bitstring;
                                            {1274}let gNc_1510: bitstring = exp(g,Nc_1509) in
                                            {1275}let m1_1511: bitstring = (SPc_1508,gNc_1510) in
                                            {1276}out(c, (pkCli_1059,m1_1511,sign(m1_1511,skCli_1058)));
                                            {1277}event beginCli(Cli,Sess,gNc_1510);
                                            {1278}in(c, (PartS_1512: bitstring,sigPartS_1513: bitstring));
                                            {1279}if (verify(PartS_1512,sigPartS_1513,pkSess_1505) <> true) then
                                                0
                                            else
                                                {1280}event endCli(Sess,Cli,PartS_1512)
                                )
                                else
                                    {1281}let pkSess_1514: bitstring = fail-any in
                                    {1282}out(c, GetEndpointRequest);
                                    {1283}in(c, (SPs_1515: bitstring,=Sign,UP_1516: bitstring,=pkSess_1514));
                                    {1284}new SPc_1517: bitstring;
                                    {1285}new Nc_1518: bitstring;
                                    {1286}let gNc_1519: bitstring = exp(g,Nc_1518) in
                                    {1287}let m1_1520: bitstring = (SPc_1517,gNc_1519) in
                                    {1288}out(c, (pkCli_1059,m1_1520,sign(m1_1520,skCli_1058)));
                                    {1289}event beginCli(Cli,Sess,gNc_1519);
                                    {1290}in(c, (PartS_1521: bitstring,sigPartS_1522: bitstring));
                                    {1291}if (verify(PartS_1521,sigPartS_1522,pkSess_1514) <> true) then
                                        0
                                    else
                                        {1292}event endCli(Sess,Cli,PartS_1521)
                        )
                        else
                            {1293}let pkSess_1523: bitstring = fail-any in
                            {1294}out(c, GetEndpointRequest);
                            {1295}in(c, (SPs_1524: bitstring,=Sign,UP_1525: bitstring,=pkSess_1523));
                            {1296}new SPc_1526: bitstring;
                            {1297}new Nc_1527: bitstring;
                            {1298}let gNc_1528: bitstring = exp(g,Nc_1527) in
                            {1299}let m1_1529: bitstring = (SPc_1526,gNc_1528) in
                            {1300}out(c, (pkCli_1059,m1_1529,sign(m1_1529,skCli_1058)));
                            {1301}event beginCli(Cli,Sess,gNc_1528);
                            {1302}in(c, (PartS_1530: bitstring,sigPartS_1531: bitstring));
                            {1303}if (verify(PartS_1530,sigPartS_1531,pkSess_1523) <> true) then
                                0
                            else
                                {1304}event endCli(Sess,Cli,PartS_1530)
                )
                else
                    {1305}let v_1532: bool = (Cli = C) in
                    (
                        {1306}if v_1532 then
                        (
                            {1307}let skCli_1533: bitstring = skC in
                            {1308}let pkCli_1534: bitstring = pub(skCli_1533) in
                            {1309}let v_1535: bool = (Disco = A) in
                            (
                                {1310}if v_1535 then
                                (
                                    {1311}let pkDisco_1536: bitstring = pub(skA) in
                                    {1312}let v_1537: bool = (Sess = A) in
                                    (
                                        {1313}if v_1537 then
                                        (
                                            {1314}let pkSess_1538: bitstring = pub(skA) in
                                            {1315}out(c, GetEndpointRequest);
                                            {1316}in(c, (SPs_1539: bitstring,=Sign,UP_1540: bitstring,=pkSess_1538));
                                            {1317}new SPc_1541: bitstring;
                                            {1318}new Nc_1542: bitstring;
                                            {1319}let gNc_1543: bitstring = exp(g,Nc_1542) in
                                            {1320}let m1_1544: bitstring = (SPc_1541,gNc_1543) in
                                            {1321}out(c, (pkCli_1534,m1_1544,sign(m1_1544,skCli_1533)));
                                            {1322}event beginCli(Cli,Sess,gNc_1543);
                                            {1323}in(c, (PartS_1545: bitstring,sigPartS_1546: bitstring));
                                            {1324}if (verify(PartS_1545,sigPartS_1546,pkSess_1538) <> true) then
                                                0
                                            else
                                                {1325}event endCli(Sess,Cli,PartS_1545)
                                        )
                                        else
                                            {1326}let v_1547: bool = (Sess = B) in
                                            (
                                                {1327}if v_1547 then
                                                (
                                                    {1328}let pkSess_1548: bitstring = pub(skB) in
                                                    {1329}out(c, GetEndpointRequest);
                                                    {1330}in(c, (SPs_1549: bitstring,=Sign,UP_1550: bitstring,=pkSess_1548));
                                                    {1331}new SPc_1551: bitstring;
                                                    {1332}new Nc_1552: bitstring;
                                                    {1333}let gNc_1553: bitstring = exp(g,Nc_1552) in
                                                    {1334}let m1_1554: bitstring = (SPc_1551,gNc_1553) in
                                                    {1335}out(c, (pkCli_1534,m1_1554,sign(m1_1554,skCli_1533)));
                                                    {1336}event beginCli(Cli,Sess,gNc_1553);
                                                    {1337}in(c, (PartS_1555: bitstring,sigPartS_1556: bitstring));
                                                    {1338}if (verify(PartS_1555,sigPartS_1556,pkSess_1548) <> true) then
                                                        0
                                                    else
                                                        {1339}event endCli(Sess,Cli,PartS_1555)
                                                )
                                                else
                                                    {1340}let v_1557: bool = (Sess = C) in
                                                    (
                                                        {1341}if v_1557 then
                                                        (
                                                            {1342}let pkSess_1558: bitstring = pub(skC) in
                                                            {1343}out(c, GetEndpointRequest);
                                                            {1344}in(c, (SPs_1559: bitstring,=Sign,UP_1560: bitstring,=pkSess_1558));
                                                            {1345}new SPc_1561: bitstring;
                                                            {1346}new Nc_1562: bitstring;
                                                            {1347}let gNc_1563: bitstring = exp(g,Nc_1562) in
                                                            {1348}let m1_1564: bitstring = (SPc_1561,gNc_1563) in
                                                            {1349}out(c, (pkCli_1534,m1_1564,sign(m1_1564,skCli_1533)));
                                                            {1350}event beginCli(Cli,Sess,gNc_1563);
                                                            {1351}in(c, (PartS_1565: bitstring,sigPartS_1566: bitstring));
                                                            {1352}if (verify(PartS_1565,sigPartS_1566,pkSess_1558) <> true) then
                                                                0
                                                            else
                                                                {1353}event endCli(Sess,Cli,PartS_1565)
                                                        )
                                                        else
                                                            {1354}let pkSess_1567: bitstring = pub(skI) in
                                                            {1355}out(c, GetEndpointRequest);
                                                            {1356}in(c, (SPs_1568: bitstring,=Sign,UP_1569: bitstring,=pkSess_1567));
                                                            {1357}new SPc_1570: bitstring;
                                                            {1358}new Nc_1571: bitstring;
                                                            {1359}let gNc_1572: bitstring = exp(g,Nc_1571) in
                                                            {1360}let m1_1573: bitstring = (SPc_1570,gNc_1572) in
                                                            {1361}out(c, (pkCli_1534,m1_1573,sign(m1_1573,skCli_1533)));
                                                            {1362}event beginCli(Cli,Sess,gNc_1572);
                                                            {1363}in(c, (PartS_1574: bitstring,sigPartS_1575: bitstring));
                                                            {1364}if (verify(PartS_1574,sigPartS_1575,pkSess_1567) <> true) then
                                                                0
                                                            else
                                                                {1365}event endCli(Sess,Cli,PartS_1574)
                                                    )
                                                    else
                                                        {1366}let pkSess_1576: bitstring = fail-any in
                                                        {1367}out(c, GetEndpointRequest);
                                                        {1368}in(c, (SPs_1577: bitstring,=Sign,UP_1578: bitstring,=pkSess_1576));
                                                        {1369}new SPc_1579: bitstring;
                                                        {1370}new Nc_1580: bitstring;
                                                        {1371}let gNc_1581: bitstring = exp(g,Nc_1580) in
                                                        {1372}let m1_1582: bitstring = (SPc_1579,gNc_1581) in
                                                        {1373}out(c, (pkCli_1534,m1_1582,sign(m1_1582,skCli_1533)));
                                                        {1374}event beginCli(Cli,Sess,gNc_1581);
                                                        {1375}in(c, (PartS_1583: bitstring,sigPartS_1584: bitstring));
                                                        {1376}if (verify(PartS_1583,sigPartS_1584,pkSess_1576) <> true) then
                                                            0
                                                        else
                                                            {1377}event endCli(Sess,Cli,PartS_1583)
                                            )
                                            else
                                                {1378}let pkSess_1585: bitstring = fail-any in
                                                {1379}out(c, GetEndpointRequest);
                                                {1380}in(c, (SPs_1586: bitstring,=Sign,UP_1587: bitstring,=pkSess_1585));
                                                {1381}new SPc_1588: bitstring;
                                                {1382}new Nc_1589: bitstring;
                                                {1383}let gNc_1590: bitstring = exp(g,Nc_1589) in
                                                {1384}let m1_1591: bitstring = (SPc_1588,gNc_1590) in
                                                {1385}out(c, (pkCli_1534,m1_1591,sign(m1_1591,skCli_1533)));
                                                {1386}event beginCli(Cli,Sess,gNc_1590);
                                                {1387}in(c, (PartS_1592: bitstring,sigPartS_1593: bitstring));
                                                {1388}if (verify(PartS_1592,sigPartS_1593,pkSess_1585) <> true) then
                                                    0
                                                else
                                                    {1389}event endCli(Sess,Cli,PartS_1592)
                                    )
                                    else
                                        {1390}let pkSess_1594: bitstring = fail-any in
                                        {1391}out(c, GetEndpointRequest);
                                        {1392}in(c, (SPs_1595: bitstring,=Sign,UP_1596: bitstring,=pkSess_1594));
                                        {1393}new SPc_1597: bitstring;
                                        {1394}new Nc_1598: bitstring;
                                        {1395}let gNc_1599: bitstring = exp(g,Nc_1598) in
                                        {1396}let m1_1600: bitstring = (SPc_1597,gNc_1599) in
                                        {1397}out(c, (pkCli_1534,m1_1600,sign(m1_1600,skCli_1533)));
                                        {1398}event beginCli(Cli,Sess,gNc_1599);
                                        {1399}in(c, (PartS_1601: bitstring,sigPartS_1602: bitstring));
                                        {1400}if (verify(PartS_1601,sigPartS_1602,pkSess_1594) <> true) then
                                            0
                                        else
                                            {1401}event endCli(Sess,Cli,PartS_1601)
                                )
                                else
                                    {1402}let v_1603: bool = (Disco = B) in
                                    (
                                        {1403}if v_1603 then
                                        (
                                            {1404}let pkDisco_1604: bitstring = pub(skB) in
                                            {1405}let v_1605: bool = (Sess = A) in
                                            (
                                                {1406}if v_1605 then
                                                (
                                                    {1407}let pkSess_1606: bitstring = pub(skA) in
                                                    {1408}out(c, GetEndpointRequest);
                                                    {1409}in(c, (SPs_1607: bitstring,=Sign,UP_1608: bitstring,=pkSess_1606));
                                                    {1410}new SPc_1609: bitstring;
                                                    {1411}new Nc_1610: bitstring;
                                                    {1412}let gNc_1611: bitstring = exp(g,Nc_1610) in
                                                    {1413}let m1_1612: bitstring = (SPc_1609,gNc_1611) in
                                                    {1414}out(c, (pkCli_1534,m1_1612,sign(m1_1612,skCli_1533)));
                                                    {1415}event beginCli(Cli,Sess,gNc_1611);
                                                    {1416}in(c, (PartS_1613: bitstring,sigPartS_1614: bitstring));
                                                    {1417}if (verify(PartS_1613,sigPartS_1614,pkSess_1606) <> true) then
                                                        0
                                                    else
                                                        {1418}event endCli(Sess,Cli,PartS_1613)
                                                )
                                                else
                                                    {1419}let v_1615: bool = (Sess = B) in
                                                    (
                                                        {1420}if v_1615 then
                                                        (
                                                            {1421}let pkSess_1616: bitstring = pub(skB) in
                                                            {1422}out(c, GetEndpointRequest);
                                                            {1423}in(c, (SPs_1617: bitstring,=Sign,UP_1618: bitstring,=pkSess_1616));
                                                            {1424}new SPc_1619: bitstring;
                                                            {1425}new Nc_1620: bitstring;
                                                            {1426}let gNc_1621: bitstring = exp(g,Nc_1620) in
                                                            {1427}let m1_1622: bitstring = (SPc_1619,gNc_1621) in
                                                            {1428}out(c, (pkCli_1534,m1_1622,sign(m1_1622,skCli_1533)));
                                                            {1429}event beginCli(Cli,Sess,gNc_1621);
                                                            {1430}in(c, (PartS_1623: bitstring,sigPartS_1624: bitstring));
                                                            {1431}if (verify(PartS_1623,sigPartS_1624,pkSess_1616) <> true) then
                                                                0
                                                            else
                                                                {1432}event endCli(Sess,Cli,PartS_1623)
                                                        )
                                                        else
                                                            {1433}let v_1625: bool = (Sess = C) in
                                                            (
                                                                {1434}if v_1625 then
                                                                (
                                                                    {1435}let pkSess_1626: bitstring = pub(skC) in
                                                                    {1436}out(c, GetEndpointRequest);
                                                                    {1437}in(c, (SPs_1627: bitstring,=Sign,UP_1628: bitstring,=pkSess_1626));
                                                                    {1438}new SPc_1629: bitstring;
                                                                    {1439}new Nc_1630: bitstring;
                                                                    {1440}let gNc_1631: bitstring = exp(g,Nc_1630) in
                                                                    {1441}let m1_1632: bitstring = (SPc_1629,gNc_1631) in
                                                                    {1442}out(c, (pkCli_1534,m1_1632,sign(m1_1632,skCli_1533)));
                                                                    {1443}event beginCli(Cli,Sess,gNc_1631);
                                                                    {1444}in(c, (PartS_1633: bitstring,sigPartS_1634: bitstring));
                                                                    {1445}if (verify(PartS_1633,sigPartS_1634,pkSess_1626) <> true) then
                                                                        0
                                                                    else
                                                                        {1446}event endCli(Sess,Cli,PartS_1633)
                                                                )
                                                                else
                                                                    {1447}let pkSess_1635: bitstring = pub(skI) in
                                                                    {1448}out(c, GetEndpointRequest);
                                                                    {1449}in(c, (SPs_1636: bitstring,=Sign,UP_1637: bitstring,=pkSess_1635));
                                                                    {1450}new SPc_1638: bitstring;
                                                                    {1451}new Nc_1639: bitstring;
                                                                    {1452}let gNc_1640: bitstring = exp(g,Nc_1639) in
                                                                    {1453}let m1_1641: bitstring = (SPc_1638,gNc_1640) in
                                                                    {1454}out(c, (pkCli_1534,m1_1641,sign(m1_1641,skCli_1533)));
                                                                    {1455}event beginCli(Cli,Sess,gNc_1640);
                                                                    {1456}in(c, (PartS_1642: bitstring,sigPartS_1643: bitstring));
                                                                    {1457}if (verify(PartS_1642,sigPartS_1643,pkSess_1635) <> true) then
                                                                        0
                                                                    else
                                                                        {1458}event endCli(Sess,Cli,PartS_1642)
                                                            )
                                                            else
                                                                {1459}let pkSess_1644: bitstring = fail-any in
                                                                {1460}out(c, GetEndpointRequest);
                                                                {1461}in(c, (SPs_1645: bitstring,=Sign,UP_1646: bitstring,=pkSess_1644));
                                                                {1462}new SPc_1647: bitstring;
                                                                {1463}new Nc_1648: bitstring;
                                                                {1464}let gNc_1649: bitstring = exp(g,Nc_1648) in
                                                                {1465}let m1_1650: bitstring = (SPc_1647,gNc_1649) in
                                                                {1466}out(c, (pkCli_1534,m1_1650,sign(m1_1650,skCli_1533)));
                                                                {1467}event beginCli(Cli,Sess,gNc_1649);
                                                                {1468}in(c, (PartS_1651: bitstring,sigPartS_1652: bitstring));
                                                                {1469}if (verify(PartS_1651,sigPartS_1652,pkSess_1644) <> true) then
                                                                    0
                                                                else
                                                                    {1470}event endCli(Sess,Cli,PartS_1651)
                                                    )
                                                    else
                                                        {1471}let pkSess_1653: bitstring = fail-any in
                                                        {1472}out(c, GetEndpointRequest);
                                                        {1473}in(c, (SPs_1654: bitstring,=Sign,UP_1655: bitstring,=pkSess_1653));
                                                        {1474}new SPc_1656: bitstring;
                                                        {1475}new Nc_1657: bitstring;
                                                        {1476}let gNc_1658: bitstring = exp(g,Nc_1657) in
                                                        {1477}let m1_1659: bitstring = (SPc_1656,gNc_1658) in
                                                        {1478}out(c, (pkCli_1534,m1_1659,sign(m1_1659,skCli_1533)));
                                                        {1479}event beginCli(Cli,Sess,gNc_1658);
                                                        {1480}in(c, (PartS_1660: bitstring,sigPartS_1661: bitstring));
                                                        {1481}if (verify(PartS_1660,sigPartS_1661,pkSess_1653) <> true) then
                                                            0
                                                        else
                                                            {1482}event endCli(Sess,Cli,PartS_1660)
                                            )
                                            else
                                                {1483}let pkSess_1662: bitstring = fail-any in
                                                {1484}out(c, GetEndpointRequest);
                                                {1485}in(c, (SPs_1663: bitstring,=Sign,UP_1664: bitstring,=pkSess_1662));
                                                {1486}new SPc_1665: bitstring;
                                                {1487}new Nc_1666: bitstring;
                                                {1488}let gNc_1667: bitstring = exp(g,Nc_1666) in
                                                {1489}let m1_1668: bitstring = (SPc_1665,gNc_1667) in
                                                {1490}out(c, (pkCli_1534,m1_1668,sign(m1_1668,skCli_1533)));
                                                {1491}event beginCli(Cli,Sess,gNc_1667);
                                                {1492}in(c, (PartS_1669: bitstring,sigPartS_1670: bitstring));
                                                {1493}if (verify(PartS_1669,sigPartS_1670,pkSess_1662) <> true) then
                                                    0
                                                else
                                                    {1494}event endCli(Sess,Cli,PartS_1669)
                                        )
                                        else
                                            {1495}let v_1671: bool = (Disco = C) in
                                            (
                                                {1496}if v_1671 then
                                                (
                                                    {1497}let pkDisco_1672: bitstring = pub(skC) in
                                                    {1498}let v_1673: bool = (Sess = A) in
                                                    (
                                                        {1499}if v_1673 then
                                                        (
                                                            {1500}let pkSess_1674: bitstring = pub(skA) in
                                                            {1501}out(c, GetEndpointRequest);
                                                            {1502}in(c, (SPs_1675: bitstring,=Sign,UP_1676: bitstring,=pkSess_1674));
                                                            {1503}new SPc_1677: bitstring;
                                                            {1504}new Nc_1678: bitstring;
                                                            {1505}let gNc_1679: bitstring = exp(g,Nc_1678) in
                                                            {1506}let m1_1680: bitstring = (SPc_1677,gNc_1679) in
                                                            {1507}out(c, (pkCli_1534,m1_1680,sign(m1_1680,skCli_1533)));
                                                            {1508}event beginCli(Cli,Sess,gNc_1679);
                                                            {1509}in(c, (PartS_1681: bitstring,sigPartS_1682: bitstring));
                                                            {1510}if (verify(PartS_1681,sigPartS_1682,pkSess_1674) <> true) then
                                                                0
                                                            else
                                                                {1511}event endCli(Sess,Cli,PartS_1681)
                                                        )
                                                        else
                                                            {1512}let v_1683: bool = (Sess = B) in
                                                            (
                                                                {1513}if v_1683 then
                                                                (
                                                                    {1514}let pkSess_1684: bitstring = pub(skB) in
                                                                    {1515}out(c, GetEndpointRequest);
                                                                    {1516}in(c, (SPs_1685: bitstring,=Sign,UP_1686: bitstring,=pkSess_1684));
                                                                    {1517}new SPc_1687: bitstring;
                                                                    {1518}new Nc_1688: bitstring;
                                                                    {1519}let gNc_1689: bitstring = exp(g,Nc_1688) in
                                                                    {1520}let m1_1690: bitstring = (SPc_1687,gNc_1689) in
                                                                    {1521}out(c, (pkCli_1534,m1_1690,sign(m1_1690,skCli_1533)));
                                                                    {1522}event beginCli(Cli,Sess,gNc_1689);
                                                                    {1523}in(c, (PartS_1691: bitstring,sigPartS_1692: bitstring));
                                                                    {1524}if (verify(PartS_1691,sigPartS_1692,pkSess_1684) <> true) then
                                                                        0
                                                                    else
                                                                        {1525}event endCli(Sess,Cli,PartS_1691)
                                                                )
                                                                else
                                                                    {1526}let v_1693: bool = (Sess = C) in
                                                                    (
                                                                        {1527}if v_1693 then
                                                                        (
                                                                            {1528}let pkSess_1694: bitstring = pub(skC) in
                                                                            {1529}out(c, GetEndpointRequest);
                                                                            {1530}in(c, (SPs_1695: bitstring,=Sign,UP_1696: bitstring,=pkSess_1694));
                                                                            {1531}new SPc_1697: bitstring;
                                                                            {1532}new Nc_1698: bitstring;
                                                                            {1533}let gNc_1699: bitstring = exp(g,Nc_1698) in
                                                                            {1534}let m1_1700: bitstring = (SPc_1697,gNc_1699) in
                                                                            {1535}out(c, (pkCli_1534,m1_1700,sign(m1_1700,skCli_1533)));
                                                                            {1536}event beginCli(Cli,Sess,gNc_1699);
                                                                            {1537}in(c, (PartS_1701: bitstring,sigPartS_1702: bitstring));
                                                                            {1538}if (verify(PartS_1701,sigPartS_1702,pkSess_1694) <> true) then
                                                                                0
                                                                            else
                                                                                {1539}event endCli(Sess,Cli,PartS_1701)
                                                                        )
                                                                        else
                                                                            {1540}let pkSess_1703: bitstring = pub(skI) in
                                                                            {1541}out(c, GetEndpointRequest);
                                                                            {1542}in(c, (SPs_1704: bitstring,=Sign,UP_1705: bitstring,=pkSess_1703));
                                                                            {1543}new SPc_1706: bitstring;
                                                                            {1544}new Nc_1707: bitstring;
                                                                            {1545}let gNc_1708: bitstring = exp(g,Nc_1707) in
                                                                            {1546}let m1_1709: bitstring = (SPc_1706,gNc_1708) in
                                                                            {1547}out(c, (pkCli_1534,m1_1709,sign(m1_1709,skCli_1533)));
                                                                            {1548}event beginCli(Cli,Sess,gNc_1708);
                                                                            {1549}in(c, (PartS_1710: bitstring,sigPartS_1711: bitstring));
                                                                            {1550}if (verify(PartS_1710,sigPartS_1711,pkSess_1703) <> true) then
                                                                                0
                                                                            else
                                                                                {1551}event endCli(Sess,Cli,PartS_1710)
                                                                    )
                                                                    else
                                                                        {1552}let pkSess_1712: bitstring = fail-any in
                                                                        {1553}out(c, GetEndpointRequest);
                                                                        {1554}in(c, (SPs_1713: bitstring,=Sign,UP_1714: bitstring,=pkSess_1712));
                                                                        {1555}new SPc_1715: bitstring;
                                                                        {1556}new Nc_1716: bitstring;
                                                                        {1557}let gNc_1717: bitstring = exp(g,Nc_1716) in
                                                                        {1558}let m1_1718: bitstring = (SPc_1715,gNc_1717) in
                                                                        {1559}out(c, (pkCli_1534,m1_1718,sign(m1_1718,skCli_1533)));
                                                                        {1560}event beginCli(Cli,Sess,gNc_1717);
                                                                        {1561}in(c, (PartS_1719: bitstring,sigPartS_1720: bitstring));
                                                                        {1562}if (verify(PartS_1719,sigPartS_1720,pkSess_1712) <> true) then
                                                                            0
                                                                        else
                                                                            {1563}event endCli(Sess,Cli,PartS_1719)
                                                            )
                                                            else
                                                                {1564}let pkSess_1721: bitstring = fail-any in
                                                                {1565}out(c, GetEndpointRequest);
                                                                {1566}in(c, (SPs_1722: bitstring,=Sign,UP_1723: bitstring,=pkSess_1721));
                                                                {1567}new SPc_1724: bitstring;
                                                                {1568}new Nc_1725: bitstring;
                                                                {1569}let gNc_1726: bitstring = exp(g,Nc_1725) in
                                                                {1570}let m1_1727: bitstring = (SPc_1724,gNc_1726) in
                                                                {1571}out(c, (pkCli_1534,m1_1727,sign(m1_1727,skCli_1533)));
                                                                {1572}event beginCli(Cli,Sess,gNc_1726);
                                                                {1573}in(c, (PartS_1728: bitstring,sigPartS_1729: bitstring));
                                                                {1574}if (verify(PartS_1728,sigPartS_1729,pkSess_1721) <> true) then
                                                                    0
                                                                else
                                                                    {1575}event endCli(Sess,Cli,PartS_1728)
                                                    )
                                                    else
                                                        {1576}let pkSess_1730: bitstring = fail-any in
                                                        {1577}out(c, GetEndpointRequest);
                                                        {1578}in(c, (SPs_1731: bitstring,=Sign,UP_1732: bitstring,=pkSess_1730));
                                                        {1579}new SPc_1733: bitstring;
                                                        {1580}new Nc_1734: bitstring;
                                                        {1581}let gNc_1735: bitstring = exp(g,Nc_1734) in
                                                        {1582}let m1_1736: bitstring = (SPc_1733,gNc_1735) in
                                                        {1583}out(c, (pkCli_1534,m1_1736,sign(m1_1736,skCli_1533)));
                                                        {1584}event beginCli(Cli,Sess,gNc_1735);
                                                        {1585}in(c, (PartS_1737: bitstring,sigPartS_1738: bitstring));
                                                        {1586}if (verify(PartS_1737,sigPartS_1738,pkSess_1730) <> true) then
                                                            0
                                                        else
                                                            {1587}event endCli(Sess,Cli,PartS_1737)
                                                )
                                                else
                                                    {1588}let pkDisco_1739: bitstring = pub(skI) in
                                                    {1589}let v_1740: bool = (Sess = A) in
                                                    (
                                                        {1590}if v_1740 then
                                                        (
                                                            {1591}let pkSess_1741: bitstring = pub(skA) in
                                                            {1592}out(c, GetEndpointRequest);
                                                            {1593}in(c, (SPs_1742: bitstring,=Sign,UP_1743: bitstring,=pkSess_1741));
                                                            {1594}new SPc_1744: bitstring;
                                                            {1595}new Nc_1745: bitstring;
                                                            {1596}let gNc_1746: bitstring = exp(g,Nc_1745) in
                                                            {1597}let m1_1747: bitstring = (SPc_1744,gNc_1746) in
                                                            {1598}out(c, (pkCli_1534,m1_1747,sign(m1_1747,skCli_1533)));
                                                            {1599}event beginCli(Cli,Sess,gNc_1746);
                                                            {1600}in(c, (PartS_1748: bitstring,sigPartS_1749: bitstring));
                                                            {1601}if (verify(PartS_1748,sigPartS_1749,pkSess_1741) <> true) then
                                                                0
                                                            else
                                                                {1602}event endCli(Sess,Cli,PartS_1748)
                                                        )
                                                        else
                                                            {1603}let v_1750: bool = (Sess = B) in
                                                            (
                                                                {1604}if v_1750 then
                                                                (
                                                                    {1605}let pkSess_1751: bitstring = pub(skB) in
                                                                    {1606}out(c, GetEndpointRequest);
                                                                    {1607}in(c, (SPs_1752: bitstring,=Sign,UP_1753: bitstring,=pkSess_1751));
                                                                    {1608}new SPc_1754: bitstring;
                                                                    {1609}new Nc_1755: bitstring;
                                                                    {1610}let gNc_1756: bitstring = exp(g,Nc_1755) in
                                                                    {1611}let m1_1757: bitstring = (SPc_1754,gNc_1756) in
                                                                    {1612}out(c, (pkCli_1534,m1_1757,sign(m1_1757,skCli_1533)));
                                                                    {1613}event beginCli(Cli,Sess,gNc_1756);
                                                                    {1614}in(c, (PartS_1758: bitstring,sigPartS_1759: bitstring));
                                                                    {1615}if (verify(PartS_1758,sigPartS_1759,pkSess_1751) <> true) then
                                                                        0
                                                                    else
                                                                        {1616}event endCli(Sess,Cli,PartS_1758)
                                                                )
                                                                else
                                                                    {1617}let v_1760: bool = (Sess = C) in
                                                                    (
                                                                        {1618}if v_1760 then
                                                                        (
                                                                            {1619}let pkSess_1761: bitstring = pub(skC) in
                                                                            {1620}out(c, GetEndpointRequest);
                                                                            {1621}in(c, (SPs_1762: bitstring,=Sign,UP_1763: bitstring,=pkSess_1761));
                                                                            {1622}new SPc_1764: bitstring;
                                                                            {1623}new Nc_1765: bitstring;
                                                                            {1624}let gNc_1766: bitstring = exp(g,Nc_1765) in
                                                                            {1625}let m1_1767: bitstring = (SPc_1764,gNc_1766) in
                                                                            {1626}out(c, (pkCli_1534,m1_1767,sign(m1_1767,skCli_1533)));
                                                                            {1627}event beginCli(Cli,Sess,gNc_1766);
                                                                            {1628}in(c, (PartS_1768: bitstring,sigPartS_1769: bitstring));
                                                                            {1629}if (verify(PartS_1768,sigPartS_1769,pkSess_1761) <> true) then
                                                                                0
                                                                            else
                                                                                {1630}event endCli(Sess,Cli,PartS_1768)
                                                                        )
                                                                        else
                                                                            {1631}let pkSess_1770: bitstring = pub(skI) in
                                                                            {1632}out(c, GetEndpointRequest);
                                                                            {1633}in(c, (SPs_1771: bitstring,=Sign,UP_1772: bitstring,=pkSess_1770));
                                                                            {1634}new SPc_1773: bitstring;
                                                                            {1635}new Nc_1774: bitstring;
                                                                            {1636}let gNc_1775: bitstring = exp(g,Nc_1774) in
                                                                            {1637}let m1_1776: bitstring = (SPc_1773,gNc_1775) in
                                                                            {1638}out(c, (pkCli_1534,m1_1776,sign(m1_1776,skCli_1533)));
                                                                            {1639}event beginCli(Cli,Sess,gNc_1775);
                                                                            {1640}in(c, (PartS_1777: bitstring,sigPartS_1778: bitstring));
                                                                            {1641}if (verify(PartS_1777,sigPartS_1778,pkSess_1770) <> true) then
                                                                                0
                                                                            else
                                                                                {1642}event endCli(Sess,Cli,PartS_1777)
                                                                    )
                                                                    else
                                                                        {1643}let pkSess_1779: bitstring = fail-any in
                                                                        {1644}out(c, GetEndpointRequest);
                                                                        {1645}in(c, (SPs_1780: bitstring,=Sign,UP_1781: bitstring,=pkSess_1779));
                                                                        {1646}new SPc_1782: bitstring;
                                                                        {1647}new Nc_1783: bitstring;
                                                                        {1648}let gNc_1784: bitstring = exp(g,Nc_1783) in
                                                                        {1649}let m1_1785: bitstring = (SPc_1782,gNc_1784) in
                                                                        {1650}out(c, (pkCli_1534,m1_1785,sign(m1_1785,skCli_1533)));
                                                                        {1651}event beginCli(Cli,Sess,gNc_1784);
                                                                        {1652}in(c, (PartS_1786: bitstring,sigPartS_1787: bitstring));
                                                                        {1653}if (verify(PartS_1786,sigPartS_1787,pkSess_1779) <> true) then
                                                                            0
                                                                        else
                                                                            {1654}event endCli(Sess,Cli,PartS_1786)
                                                            )
                                                            else
                                                                {1655}let pkSess_1788: bitstring = fail-any in
                                                                {1656}out(c, GetEndpointRequest);
                                                                {1657}in(c, (SPs_1789: bitstring,=Sign,UP_1790: bitstring,=pkSess_1788));
                                                                {1658}new SPc_1791: bitstring;
                                                                {1659}new Nc_1792: bitstring;
                                                                {1660}let gNc_1793: bitstring = exp(g,Nc_1792) in
                                                                {1661}let m1_1794: bitstring = (SPc_1791,gNc_1793) in
                                                                {1662}out(c, (pkCli_1534,m1_1794,sign(m1_1794,skCli_1533)));
                                                                {1663}event beginCli(Cli,Sess,gNc_1793);
                                                                {1664}in(c, (PartS_1795: bitstring,sigPartS_1796: bitstring));
                                                                {1665}if (verify(PartS_1795,sigPartS_1796,pkSess_1788) <> true) then
                                                                    0
                                                                else
                                                                    {1666}event endCli(Sess,Cli,PartS_1795)
                                                    )
                                                    else
                                                        {1667}let pkSess_1797: bitstring = fail-any in
                                                        {1668}out(c, GetEndpointRequest);
                                                        {1669}in(c, (SPs_1798: bitstring,=Sign,UP_1799: bitstring,=pkSess_1797));
                                                        {1670}new SPc_1800: bitstring;
                                                        {1671}new Nc_1801: bitstring;
                                                        {1672}let gNc_1802: bitstring = exp(g,Nc_1801) in
                                                        {1673}let m1_1803: bitstring = (SPc_1800,gNc_1802) in
                                                        {1674}out(c, (pkCli_1534,m1_1803,sign(m1_1803,skCli_1533)));
                                                        {1675}event beginCli(Cli,Sess,gNc_1802);
                                                        {1676}in(c, (PartS_1804: bitstring,sigPartS_1805: bitstring));
                                                        {1677}if (verify(PartS_1804,sigPartS_1805,pkSess_1797) <> true) then
                                                            0
                                                        else
                                                            {1678}event endCli(Sess,Cli,PartS_1804)
                                            )
                                            else
                                                {1679}let pkDisco_1806: bitstring = fail-any in
                                                {1680}let v_1807: bool = (Sess = A) in
                                                (
                                                    {1681}if v_1807 then
                                                    (
                                                        {1682}let pkSess_1808: bitstring = pub(skA) in
                                                        {1683}out(c, GetEndpointRequest);
                                                        {1684}in(c, (SPs_1809: bitstring,=Sign,UP_1810: bitstring,=pkSess_1808));
                                                        {1685}new SPc_1811: bitstring;
                                                        {1686}new Nc_1812: bitstring;
                                                        {1687}let gNc_1813: bitstring = exp(g,Nc_1812) in
                                                        {1688}let m1_1814: bitstring = (SPc_1811,gNc_1813) in
                                                        {1689}out(c, (pkCli_1534,m1_1814,sign(m1_1814,skCli_1533)));
                                                        {1690}event beginCli(Cli,Sess,gNc_1813);
                                                        {1691}in(c, (PartS_1815: bitstring,sigPartS_1816: bitstring));
                                                        {1692}if (verify(PartS_1815,sigPartS_1816,pkSess_1808) <> true) then
                                                            0
                                                        else
                                                            {1693}event endCli(Sess,Cli,PartS_1815)
                                                    )
                                                    else
                                                        {1694}let v_1817: bool = (Sess = B) in
                                                        (
                                                            {1695}if v_1817 then
                                                            (
                                                                {1696}let pkSess_1818: bitstring = pub(skB) in
                                                                {1697}out(c, GetEndpointRequest);
                                                                {1698}in(c, (SPs_1819: bitstring,=Sign,UP_1820: bitstring,=pkSess_1818));
                                                                {1699}new SPc_1821: bitstring;
                                                                {1700}new Nc_1822: bitstring;
                                                                {1701}let gNc_1823: bitstring = exp(g,Nc_1822) in
                                                                {1702}let m1_1824: bitstring = (SPc_1821,gNc_1823) in
                                                                {1703}out(c, (pkCli_1534,m1_1824,sign(m1_1824,skCli_1533)));
                                                                {1704}event beginCli(Cli,Sess,gNc_1823);
                                                                {1705}in(c, (PartS_1825: bitstring,sigPartS_1826: bitstring));
                                                                {1706}if (verify(PartS_1825,sigPartS_1826,pkSess_1818) <> true) then
                                                                    0
                                                                else
                                                                    {1707}event endCli(Sess,Cli,PartS_1825)
                                                            )
                                                            else
                                                                {1708}let v_1827: bool = (Sess = C) in
                                                                (
                                                                    {1709}if v_1827 then
                                                                    (
                                                                        {1710}let pkSess_1828: bitstring = pub(skC) in
                                                                        {1711}out(c, GetEndpointRequest);
                                                                        {1712}in(c, (SPs_1829: bitstring,=Sign,UP_1830: bitstring,=pkSess_1828));
                                                                        {1713}new SPc_1831: bitstring;
                                                                        {1714}new Nc_1832: bitstring;
                                                                        {1715}let gNc_1833: bitstring = exp(g,Nc_1832) in
                                                                        {1716}let m1_1834: bitstring = (SPc_1831,gNc_1833) in
                                                                        {1717}out(c, (pkCli_1534,m1_1834,sign(m1_1834,skCli_1533)));
                                                                        {1718}event beginCli(Cli,Sess,gNc_1833);
                                                                        {1719}in(c, (PartS_1835: bitstring,sigPartS_1836: bitstring));
                                                                        {1720}if (verify(PartS_1835,sigPartS_1836,pkSess_1828) <> true) then
                                                                            0
                                                                        else
                                                                            {1721}event endCli(Sess,Cli,PartS_1835)
                                                                    )
                                                                    else
                                                                        {1722}let pkSess_1837: bitstring = pub(skI) in
                                                                        {1723}out(c, GetEndpointRequest);
                                                                        {1724}in(c, (SPs_1838: bitstring,=Sign,UP_1839: bitstring,=pkSess_1837));
                                                                        {1725}new SPc_1840: bitstring;
                                                                        {1726}new Nc_1841: bitstring;
                                                                        {1727}let gNc_1842: bitstring = exp(g,Nc_1841) in
                                                                        {1728}let m1_1843: bitstring = (SPc_1840,gNc_1842) in
                                                                        {1729}out(c, (pkCli_1534,m1_1843,sign(m1_1843,skCli_1533)));
                                                                        {1730}event beginCli(Cli,Sess,gNc_1842);
                                                                        {1731}in(c, (PartS_1844: bitstring,sigPartS_1845: bitstring));
                                                                        {1732}if (verify(PartS_1844,sigPartS_1845,pkSess_1837) <> true) then
                                                                            0
                                                                        else
                                                                            {1733}event endCli(Sess,Cli,PartS_1844)
                                                                )
                                                                else
                                                                    {1734}let pkSess_1846: bitstring = fail-any in
                                                                    {1735}out(c, GetEndpointRequest);
                                                                    {1736}in(c, (SPs_1847: bitstring,=Sign,UP_1848: bitstring,=pkSess_1846));
                                                                    {1737}new SPc_1849: bitstring;
                                                                    {1738}new Nc_1850: bitstring;
                                                                    {1739}let gNc_1851: bitstring = exp(g,Nc_1850) in
                                                                    {1740}let m1_1852: bitstring = (SPc_1849,gNc_1851) in
                                                                    {1741}out(c, (pkCli_1534,m1_1852,sign(m1_1852,skCli_1533)));
                                                                    {1742}event beginCli(Cli,Sess,gNc_1851);
                                                                    {1743}in(c, (PartS_1853: bitstring,sigPartS_1854: bitstring));
                                                                    {1744}if (verify(PartS_1853,sigPartS_1854,pkSess_1846) <> true) then
                                                                        0
                                                                    else
                                                                        {1745}event endCli(Sess,Cli,PartS_1853)
                                                        )
                                                        else
                                                            {1746}let pkSess_1855: bitstring = fail-any in
                                                            {1747}out(c, GetEndpointRequest);
                                                            {1748}in(c, (SPs_1856: bitstring,=Sign,UP_1857: bitstring,=pkSess_1855));
                                                            {1749}new SPc_1858: bitstring;
                                                            {1750}new Nc_1859: bitstring;
                                                            {1751}let gNc_1860: bitstring = exp(g,Nc_1859) in
                                                            {1752}let m1_1861: bitstring = (SPc_1858,gNc_1860) in
                                                            {1753}out(c, (pkCli_1534,m1_1861,sign(m1_1861,skCli_1533)));
                                                            {1754}event beginCli(Cli,Sess,gNc_1860);
                                                            {1755}in(c, (PartS_1862: bitstring,sigPartS_1863: bitstring));
                                                            {1756}if (verify(PartS_1862,sigPartS_1863,pkSess_1855) <> true) then
                                                                0
                                                            else
                                                                {1757}event endCli(Sess,Cli,PartS_1862)
                                                )
                                                else
                                                    {1758}let pkSess_1864: bitstring = fail-any in
                                                    {1759}out(c, GetEndpointRequest);
                                                    {1760}in(c, (SPs_1865: bitstring,=Sign,UP_1866: bitstring,=pkSess_1864));
                                                    {1761}new SPc_1867: bitstring;
                                                    {1762}new Nc_1868: bitstring;
                                                    {1763}let gNc_1869: bitstring = exp(g,Nc_1868) in
                                                    {1764}let m1_1870: bitstring = (SPc_1867,gNc_1869) in
                                                    {1765}out(c, (pkCli_1534,m1_1870,sign(m1_1870,skCli_1533)));
                                                    {1766}event beginCli(Cli,Sess,gNc_1869);
                                                    {1767}in(c, (PartS_1871: bitstring,sigPartS_1872: bitstring));
                                                    {1768}if (verify(PartS_1871,sigPartS_1872,pkSess_1864) <> true) then
                                                        0
                                                    else
                                                        {1769}event endCli(Sess,Cli,PartS_1871)
                                    )
                                    else
                                        {1770}let pkDisco_1873: bitstring = fail-any in
                                        {1771}let v_1874: bool = (Sess = A) in
                                        (
                                            {1772}if v_1874 then
                                            (
                                                {1773}let pkSess_1875: bitstring = pub(skA) in
                                                {1774}out(c, GetEndpointRequest);
                                                {1775}in(c, (SPs_1876: bitstring,=Sign,UP_1877: bitstring,=pkSess_1875));
                                                {1776}new SPc_1878: bitstring;
                                                {1777}new Nc_1879: bitstring;
                                                {1778}let gNc_1880: bitstring = exp(g,Nc_1879) in
                                                {1779}let m1_1881: bitstring = (SPc_1878,gNc_1880) in
                                                {1780}out(c, (pkCli_1534,m1_1881,sign(m1_1881,skCli_1533)));
                                                {1781}event beginCli(Cli,Sess,gNc_1880);
                                                {1782}in(c, (PartS_1882: bitstring,sigPartS_1883: bitstring));
                                                {1783}if (verify(PartS_1882,sigPartS_1883,pkSess_1875) <> true) then
                                                    0
                                                else
                                                    {1784}event endCli(Sess,Cli,PartS_1882)
                                            )
                                            else
                                                {1785}let v_1884: bool = (Sess = B) in
                                                (
                                                    {1786}if v_1884 then
                                                    (
                                                        {1787}let pkSess_1885: bitstring = pub(skB) in
                                                        {1788}out(c, GetEndpointRequest);
                                                        {1789}in(c, (SPs_1886: bitstring,=Sign,UP_1887: bitstring,=pkSess_1885));
                                                        {1790}new SPc_1888: bitstring;
                                                        {1791}new Nc_1889: bitstring;
                                                        {1792}let gNc_1890: bitstring = exp(g,Nc_1889) in
                                                        {1793}let m1_1891: bitstring = (SPc_1888,gNc_1890) in
                                                        {1794}out(c, (pkCli_1534,m1_1891,sign(m1_1891,skCli_1533)));
                                                        {1795}event beginCli(Cli,Sess,gNc_1890);
                                                        {1796}in(c, (PartS_1892: bitstring,sigPartS_1893: bitstring));
                                                        {1797}if (verify(PartS_1892,sigPartS_1893,pkSess_1885) <> true) then
                                                            0
                                                        else
                                                            {1798}event endCli(Sess,Cli,PartS_1892)
                                                    )
                                                    else
                                                        {1799}let v_1894: bool = (Sess = C) in
                                                        (
                                                            {1800}if v_1894 then
                                                            (
                                                                {1801}let pkSess_1895: bitstring = pub(skC) in
                                                                {1802}out(c, GetEndpointRequest);
                                                                {1803}in(c, (SPs_1896: bitstring,=Sign,UP_1897: bitstring,=pkSess_1895));
                                                                {1804}new SPc_1898: bitstring;
                                                                {1805}new Nc_1899: bitstring;
                                                                {1806}let gNc_1900: bitstring = exp(g,Nc_1899) in
                                                                {1807}let m1_1901: bitstring = (SPc_1898,gNc_1900) in
                                                                {1808}out(c, (pkCli_1534,m1_1901,sign(m1_1901,skCli_1533)));
                                                                {1809}event beginCli(Cli,Sess,gNc_1900);
                                                                {1810}in(c, (PartS_1902: bitstring,sigPartS_1903: bitstring));
                                                                {1811}if (verify(PartS_1902,sigPartS_1903,pkSess_1895) <> true) then
                                                                    0
                                                                else
                                                                    {1812}event endCli(Sess,Cli,PartS_1902)
                                                            )
                                                            else
                                                                {1813}let pkSess_1904: bitstring = pub(skI) in
                                                                {1814}out(c, GetEndpointRequest);
                                                                {1815}in(c, (SPs_1905: bitstring,=Sign,UP_1906: bitstring,=pkSess_1904));
                                                                {1816}new SPc_1907: bitstring;
                                                                {1817}new Nc_1908: bitstring;
                                                                {1818}let gNc_1909: bitstring = exp(g,Nc_1908) in
                                                                {1819}let m1_1910: bitstring = (SPc_1907,gNc_1909) in
                                                                {1820}out(c, (pkCli_1534,m1_1910,sign(m1_1910,skCli_1533)));
                                                                {1821}event beginCli(Cli,Sess,gNc_1909);
                                                                {1822}in(c, (PartS_1911: bitstring,sigPartS_1912: bitstring));
                                                                {1823}if (verify(PartS_1911,sigPartS_1912,pkSess_1904) <> true) then
                                                                    0
                                                                else
                                                                    {1824}event endCli(Sess,Cli,PartS_1911)
                                                        )
                                                        else
                                                            {1825}let pkSess_1913: bitstring = fail-any in
                                                            {1826}out(c, GetEndpointRequest);
                                                            {1827}in(c, (SPs_1914: bitstring,=Sign,UP_1915: bitstring,=pkSess_1913));
                                                            {1828}new SPc_1916: bitstring;
                                                            {1829}new Nc_1917: bitstring;
                                                            {1830}let gNc_1918: bitstring = exp(g,Nc_1917) in
                                                            {1831}let m1_1919: bitstring = (SPc_1916,gNc_1918) in
                                                            {1832}out(c, (pkCli_1534,m1_1919,sign(m1_1919,skCli_1533)));
                                                            {1833}event beginCli(Cli,Sess,gNc_1918);
                                                            {1834}in(c, (PartS_1920: bitstring,sigPartS_1921: bitstring));
                                                            {1835}if (verify(PartS_1920,sigPartS_1921,pkSess_1913) <> true) then
                                                                0
                                                            else
                                                                {1836}event endCli(Sess,Cli,PartS_1920)
                                                )
                                                else
                                                    {1837}let pkSess_1922: bitstring = fail-any in
                                                    {1838}out(c, GetEndpointRequest);
                                                    {1839}in(c, (SPs_1923: bitstring,=Sign,UP_1924: bitstring,=pkSess_1922));
                                                    {1840}new SPc_1925: bitstring;
                                                    {1841}new Nc_1926: bitstring;
                                                    {1842}let gNc_1927: bitstring = exp(g,Nc_1926) in
                                                    {1843}let m1_1928: bitstring = (SPc_1925,gNc_1927) in
                                                    {1844}out(c, (pkCli_1534,m1_1928,sign(m1_1928,skCli_1533)));
                                                    {1845}event beginCli(Cli,Sess,gNc_1927);
                                                    {1846}in(c, (PartS_1929: bitstring,sigPartS_1930: bitstring));
                                                    {1847}if (verify(PartS_1929,sigPartS_1930,pkSess_1922) <> true) then
                                                        0
                                                    else
                                                        {1848}event endCli(Sess,Cli,PartS_1929)
                                        )
                                        else
                                            {1849}let pkSess_1931: bitstring = fail-any in
                                            {1850}out(c, GetEndpointRequest);
                                            {1851}in(c, (SPs_1932: bitstring,=Sign,UP_1933: bitstring,=pkSess_1931));
                                            {1852}new SPc_1934: bitstring;
                                            {1853}new Nc_1935: bitstring;
                                            {1854}let gNc_1936: bitstring = exp(g,Nc_1935) in
                                            {1855}let m1_1937: bitstring = (SPc_1934,gNc_1936) in
                                            {1856}out(c, (pkCli_1534,m1_1937,sign(m1_1937,skCli_1533)));
                                            {1857}event beginCli(Cli,Sess,gNc_1936);
                                            {1858}in(c, (PartS_1938: bitstring,sigPartS_1939: bitstring));
                                            {1859}if (verify(PartS_1938,sigPartS_1939,pkSess_1931) <> true) then
                                                0
                                            else
                                                {1860}event endCli(Sess,Cli,PartS_1938)
                            )
                            else
                                {1861}let pkDisco_1940: bitstring = fail-any in
                                {1862}let v_1941: bool = (Sess = A) in
                                (
                                    {1863}if v_1941 then
                                    (
                                        {1864}let pkSess_1942: bitstring = pub(skA) in
                                        {1865}out(c, GetEndpointRequest);
                                        {1866}in(c, (SPs_1943: bitstring,=Sign,UP_1944: bitstring,=pkSess_1942));
                                        {1867}new SPc_1945: bitstring;
                                        {1868}new Nc_1946: bitstring;
                                        {1869}let gNc_1947: bitstring = exp(g,Nc_1946) in
                                        {1870}let m1_1948: bitstring = (SPc_1945,gNc_1947) in
                                        {1871}out(c, (pkCli_1534,m1_1948,sign(m1_1948,skCli_1533)));
                                        {1872}event beginCli(Cli,Sess,gNc_1947);
                                        {1873}in(c, (PartS_1949: bitstring,sigPartS_1950: bitstring));
                                        {1874}if (verify(PartS_1949,sigPartS_1950,pkSess_1942) <> true) then
                                            0
                                        else
                                            {1875}event endCli(Sess,Cli,PartS_1949)
                                    )
                                    else
                                        {1876}let v_1951: bool = (Sess = B) in
                                        (
                                            {1877}if v_1951 then
                                            (
                                                {1878}let pkSess_1952: bitstring = pub(skB) in
                                                {1879}out(c, GetEndpointRequest);
                                                {1880}in(c, (SPs_1953: bitstring,=Sign,UP_1954: bitstring,=pkSess_1952));
                                                {1881}new SPc_1955: bitstring;
                                                {1882}new Nc_1956: bitstring;
                                                {1883}let gNc_1957: bitstring = exp(g,Nc_1956) in
                                                {1884}let m1_1958: bitstring = (SPc_1955,gNc_1957) in
                                                {1885}out(c, (pkCli_1534,m1_1958,sign(m1_1958,skCli_1533)));
                                                {1886}event beginCli(Cli,Sess,gNc_1957);
                                                {1887}in(c, (PartS_1959: bitstring,sigPartS_1960: bitstring));
                                                {1888}if (verify(PartS_1959,sigPartS_1960,pkSess_1952) <> true) then
                                                    0
                                                else
                                                    {1889}event endCli(Sess,Cli,PartS_1959)
                                            )
                                            else
                                                {1890}let v_1961: bool = (Sess = C) in
                                                (
                                                    {1891}if v_1961 then
                                                    (
                                                        {1892}let pkSess_1962: bitstring = pub(skC) in
                                                        {1893}out(c, GetEndpointRequest);
                                                        {1894}in(c, (SPs_1963: bitstring,=Sign,UP_1964: bitstring,=pkSess_1962));
                                                        {1895}new SPc_1965: bitstring;
                                                        {1896}new Nc_1966: bitstring;
                                                        {1897}let gNc_1967: bitstring = exp(g,Nc_1966) in
                                                        {1898}let m1_1968: bitstring = (SPc_1965,gNc_1967) in
                                                        {1899}out(c, (pkCli_1534,m1_1968,sign(m1_1968,skCli_1533)));
                                                        {1900}event beginCli(Cli,Sess,gNc_1967);
                                                        {1901}in(c, (PartS_1969: bitstring,sigPartS_1970: bitstring));
                                                        {1902}if (verify(PartS_1969,sigPartS_1970,pkSess_1962) <> true) then
                                                            0
                                                        else
                                                            {1903}event endCli(Sess,Cli,PartS_1969)
                                                    )
                                                    else
                                                        {1904}let pkSess_1971: bitstring = pub(skI) in
                                                        {1905}out(c, GetEndpointRequest);
                                                        {1906}in(c, (SPs_1972: bitstring,=Sign,UP_1973: bitstring,=pkSess_1971));
                                                        {1907}new SPc_1974: bitstring;
                                                        {1908}new Nc_1975: bitstring;
                                                        {1909}let gNc_1976: bitstring = exp(g,Nc_1975) in
                                                        {1910}let m1_1977: bitstring = (SPc_1974,gNc_1976) in
                                                        {1911}out(c, (pkCli_1534,m1_1977,sign(m1_1977,skCli_1533)));
                                                        {1912}event beginCli(Cli,Sess,gNc_1976);
                                                        {1913}in(c, (PartS_1978: bitstring,sigPartS_1979: bitstring));
                                                        {1914}if (verify(PartS_1978,sigPartS_1979,pkSess_1971) <> true) then
                                                            0
                                                        else
                                                            {1915}event endCli(Sess,Cli,PartS_1978)
                                                )
                                                else
                                                    {1916}let pkSess_1980: bitstring = fail-any in
                                                    {1917}out(c, GetEndpointRequest);
                                                    {1918}in(c, (SPs_1981: bitstring,=Sign,UP_1982: bitstring,=pkSess_1980));
                                                    {1919}new SPc_1983: bitstring;
                                                    {1920}new Nc_1984: bitstring;
                                                    {1921}let gNc_1985: bitstring = exp(g,Nc_1984) in
                                                    {1922}let m1_1986: bitstring = (SPc_1983,gNc_1985) in
                                                    {1923}out(c, (pkCli_1534,m1_1986,sign(m1_1986,skCli_1533)));
                                                    {1924}event beginCli(Cli,Sess,gNc_1985);
                                                    {1925}in(c, (PartS_1987: bitstring,sigPartS_1988: bitstring));
                                                    {1926}if (verify(PartS_1987,sigPartS_1988,pkSess_1980) <> true) then
                                                        0
                                                    else
                                                        {1927}event endCli(Sess,Cli,PartS_1987)
                                        )
                                        else
                                            {1928}let pkSess_1989: bitstring = fail-any in
                                            {1929}out(c, GetEndpointRequest);
                                            {1930}in(c, (SPs_1990: bitstring,=Sign,UP_1991: bitstring,=pkSess_1989));
                                            {1931}new SPc_1992: bitstring;
                                            {1932}new Nc_1993: bitstring;
                                            {1933}let gNc_1994: bitstring = exp(g,Nc_1993) in
                                            {1934}let m1_1995: bitstring = (SPc_1992,gNc_1994) in
                                            {1935}out(c, (pkCli_1534,m1_1995,sign(m1_1995,skCli_1533)));
                                            {1936}event beginCli(Cli,Sess,gNc_1994);
                                            {1937}in(c, (PartS_1996: bitstring,sigPartS_1997: bitstring));
                                            {1938}if (verify(PartS_1996,sigPartS_1997,pkSess_1989) <> true) then
                                                0
                                            else
                                                {1939}event endCli(Sess,Cli,PartS_1996)
                                )
                                else
                                    {1940}let pkSess_1998: bitstring = fail-any in
                                    {1941}out(c, GetEndpointRequest);
                                    {1942}in(c, (SPs_1999: bitstring,=Sign,UP_2000: bitstring,=pkSess_1998));
                                    {1943}new SPc_2001: bitstring;
                                    {1944}new Nc_2002: bitstring;
                                    {1945}let gNc_2003: bitstring = exp(g,Nc_2002) in
                                    {1946}let m1_2004: bitstring = (SPc_2001,gNc_2003) in
                                    {1947}out(c, (pkCli_1534,m1_2004,sign(m1_2004,skCli_1533)));
                                    {1948}event beginCli(Cli,Sess,gNc_2003);
                                    {1949}in(c, (PartS_2005: bitstring,sigPartS_2006: bitstring));
                                    {1950}if (verify(PartS_2005,sigPartS_2006,pkSess_1998) <> true) then
                                        0
                                    else
                                        {1951}event endCli(Sess,Cli,PartS_2005)
                        )
                        else
                            {1952}let skCli_2007: bitstring = skI in
                            {1953}let pkCli_2008: bitstring = pub(skCli_2007) in
                            {1954}let v_2009: bool = (Disco = A) in
                            (
                                {1955}if v_2009 then
                                (
                                    {1956}let pkDisco_2010: bitstring = pub(skA) in
                                    {1957}let v_2011: bool = (Sess = A) in
                                    (
                                        {1958}if v_2011 then
                                        (
                                            {1959}let pkSess_2012: bitstring = pub(skA) in
                                            {1960}out(c, GetEndpointRequest);
                                            {1961}in(c, (SPs_2013: bitstring,=Sign,UP_2014: bitstring,=pkSess_2012));
                                            {1962}new SPc_2015: bitstring;
                                            {1963}new Nc_2016: bitstring;
                                            {1964}let gNc_2017: bitstring = exp(g,Nc_2016) in
                                            {1965}let m1_2018: bitstring = (SPc_2015,gNc_2017) in
                                            {1966}out(c, (pkCli_2008,m1_2018,sign(m1_2018,skCli_2007)));
                                            {1967}event beginCli(Cli,Sess,gNc_2017);
                                            {1968}in(c, (PartS_2019: bitstring,sigPartS_2020: bitstring));
                                            {1969}if (verify(PartS_2019,sigPartS_2020,pkSess_2012) <> true) then
                                                0
                                            else
                                                {1970}event endCli(Sess,Cli,PartS_2019)
                                        )
                                        else
                                            {1971}let v_2021: bool = (Sess = B) in
                                            (
                                                {1972}if v_2021 then
                                                (
                                                    {1973}let pkSess_2022: bitstring = pub(skB) in
                                                    {1974}out(c, GetEndpointRequest);
                                                    {1975}in(c, (SPs_2023: bitstring,=Sign,UP_2024: bitstring,=pkSess_2022));
                                                    {1976}new SPc_2025: bitstring;
                                                    {1977}new Nc_2026: bitstring;
                                                    {1978}let gNc_2027: bitstring = exp(g,Nc_2026) in
                                                    {1979}let m1_2028: bitstring = (SPc_2025,gNc_2027) in
                                                    {1980}out(c, (pkCli_2008,m1_2028,sign(m1_2028,skCli_2007)));
                                                    {1981}event beginCli(Cli,Sess,gNc_2027);
                                                    {1982}in(c, (PartS_2029: bitstring,sigPartS_2030: bitstring));
                                                    {1983}if (verify(PartS_2029,sigPartS_2030,pkSess_2022) <> true) then
                                                        0
                                                    else
                                                        {1984}event endCli(Sess,Cli,PartS_2029)
                                                )
                                                else
                                                    {1985}let v_2031: bool = (Sess = C) in
                                                    (
                                                        {1986}if v_2031 then
                                                        (
                                                            {1987}let pkSess_2032: bitstring = pub(skC) in
                                                            {1988}out(c, GetEndpointRequest);
                                                            {1989}in(c, (SPs_2033: bitstring,=Sign,UP_2034: bitstring,=pkSess_2032));
                                                            {1990}new SPc_2035: bitstring;
                                                            {1991}new Nc_2036: bitstring;
                                                            {1992}let gNc_2037: bitstring = exp(g,Nc_2036) in
                                                            {1993}let m1_2038: bitstring = (SPc_2035,gNc_2037) in
                                                            {1994}out(c, (pkCli_2008,m1_2038,sign(m1_2038,skCli_2007)));
                                                            {1995}event beginCli(Cli,Sess,gNc_2037);
                                                            {1996}in(c, (PartS_2039: bitstring,sigPartS_2040: bitstring));
                                                            {1997}if (verify(PartS_2039,sigPartS_2040,pkSess_2032) <> true) then
                                                                0
                                                            else
                                                                {1998}event endCli(Sess,Cli,PartS_2039)
                                                        )
                                                        else
                                                            {1999}let pkSess_2041: bitstring = pub(skI) in
                                                            {2000}out(c, GetEndpointRequest);
                                                            {2001}in(c, (SPs_2042: bitstring,=Sign,UP_2043: bitstring,=pkSess_2041));
                                                            {2002}new SPc_2044: bitstring;
                                                            {2003}new Nc_2045: bitstring;
                                                            {2004}let gNc_2046: bitstring = exp(g,Nc_2045) in
                                                            {2005}let m1_2047: bitstring = (SPc_2044,gNc_2046) in
                                                            {2006}out(c, (pkCli_2008,m1_2047,sign(m1_2047,skCli_2007)));
                                                            {2007}event beginCli(Cli,Sess,gNc_2046);
                                                            {2008}in(c, (PartS_2048: bitstring,sigPartS_2049: bitstring));
                                                            {2009}if (verify(PartS_2048,sigPartS_2049,pkSess_2041) <> true) then
                                                                0
                                                            else
                                                                {2010}event endCli(Sess,Cli,PartS_2048)
                                                    )
                                                    else
                                                        {2011}let pkSess_2050: bitstring = fail-any in
                                                        {2012}out(c, GetEndpointRequest);
                                                        {2013}in(c, (SPs_2051: bitstring,=Sign,UP_2052: bitstring,=pkSess_2050));
                                                        {2014}new SPc_2053: bitstring;
                                                        {2015}new Nc_2054: bitstring;
                                                        {2016}let gNc_2055: bitstring = exp(g,Nc_2054) in
                                                        {2017}let m1_2056: bitstring = (SPc_2053,gNc_2055) in
                                                        {2018}out(c, (pkCli_2008,m1_2056,sign(m1_2056,skCli_2007)));
                                                        {2019}event beginCli(Cli,Sess,gNc_2055);
                                                        {2020}in(c, (PartS_2057: bitstring,sigPartS_2058: bitstring));
                                                        {2021}if (verify(PartS_2057,sigPartS_2058,pkSess_2050) <> true) then
                                                            0
                                                        else
                                                            {2022}event endCli(Sess,Cli,PartS_2057)
                                            )
                                            else
                                                {2023}let pkSess_2059: bitstring = fail-any in
                                                {2024}out(c, GetEndpointRequest);
                                                {2025}in(c, (SPs_2060: bitstring,=Sign,UP_2061: bitstring,=pkSess_2059));
                                                {2026}new SPc_2062: bitstring;
                                                {2027}new Nc_2063: bitstring;
                                                {2028}let gNc_2064: bitstring = exp(g,Nc_2063) in
                                                {2029}let m1_2065: bitstring = (SPc_2062,gNc_2064) in
                                                {2030}out(c, (pkCli_2008,m1_2065,sign(m1_2065,skCli_2007)));
                                                {2031}event beginCli(Cli,Sess,gNc_2064);
                                                {2032}in(c, (PartS_2066: bitstring,sigPartS_2067: bitstring));
                                                {2033}if (verify(PartS_2066,sigPartS_2067,pkSess_2059) <> true) then
                                                    0
                                                else
                                                    {2034}event endCli(Sess,Cli,PartS_2066)
                                    )
                                    else
                                        {2035}let pkSess_2068: bitstring = fail-any in
                                        {2036}out(c, GetEndpointRequest);
                                        {2037}in(c, (SPs_2069: bitstring,=Sign,UP_2070: bitstring,=pkSess_2068));
                                        {2038}new SPc_2071: bitstring;
                                        {2039}new Nc_2072: bitstring;
                                        {2040}let gNc_2073: bitstring = exp(g,Nc_2072) in
                                        {2041}let m1_2074: bitstring = (SPc_2071,gNc_2073) in
                                        {2042}out(c, (pkCli_2008,m1_2074,sign(m1_2074,skCli_2007)));
                                        {2043}event beginCli(Cli,Sess,gNc_2073);
                                        {2044}in(c, (PartS_2075: bitstring,sigPartS_2076: bitstring));
                                        {2045}if (verify(PartS_2075,sigPartS_2076,pkSess_2068) <> true) then
                                            0
                                        else
                                            {2046}event endCli(Sess,Cli,PartS_2075)
                                )
                                else
                                    {2047}let v_2077: bool = (Disco = B) in
                                    (
                                        {2048}if v_2077 then
                                        (
                                            {2049}let pkDisco_2078: bitstring = pub(skB) in
                                            {2050}let v_2079: bool = (Sess = A) in
                                            (
                                                {2051}if v_2079 then
                                                (
                                                    {2052}let pkSess_2080: bitstring = pub(skA) in
                                                    {2053}out(c, GetEndpointRequest);
                                                    {2054}in(c, (SPs_2081: bitstring,=Sign,UP_2082: bitstring,=pkSess_2080));
                                                    {2055}new SPc_2083: bitstring;
                                                    {2056}new Nc_2084: bitstring;
                                                    {2057}let gNc_2085: bitstring = exp(g,Nc_2084) in
                                                    {2058}let m1_2086: bitstring = (SPc_2083,gNc_2085) in
                                                    {2059}out(c, (pkCli_2008,m1_2086,sign(m1_2086,skCli_2007)));
                                                    {2060}event beginCli(Cli,Sess,gNc_2085);
                                                    {2061}in(c, (PartS_2087: bitstring,sigPartS_2088: bitstring));
                                                    {2062}if (verify(PartS_2087,sigPartS_2088,pkSess_2080) <> true) then
                                                        0
                                                    else
                                                        {2063}event endCli(Sess,Cli,PartS_2087)
                                                )
                                                else
                                                    {2064}let v_2089: bool = (Sess = B) in
                                                    (
                                                        {2065}if v_2089 then
                                                        (
                                                            {2066}let pkSess_2090: bitstring = pub(skB) in
                                                            {2067}out(c, GetEndpointRequest);
                                                            {2068}in(c, (SPs_2091: bitstring,=Sign,UP_2092: bitstring,=pkSess_2090));
                                                            {2069}new SPc_2093: bitstring;
                                                            {2070}new Nc_2094: bitstring;
                                                            {2071}let gNc_2095: bitstring = exp(g,Nc_2094) in
                                                            {2072}let m1_2096: bitstring = (SPc_2093,gNc_2095) in
                                                            {2073}out(c, (pkCli_2008,m1_2096,sign(m1_2096,skCli_2007)));
                                                            {2074}event beginCli(Cli,Sess,gNc_2095);
                                                            {2075}in(c, (PartS_2097: bitstring,sigPartS_2098: bitstring));
                                                            {2076}if (verify(PartS_2097,sigPartS_2098,pkSess_2090) <> true) then
                                                                0
                                                            else
                                                                {2077}event endCli(Sess,Cli,PartS_2097)
                                                        )
                                                        else
                                                            {2078}let v_2099: bool = (Sess = C) in
                                                            (
                                                                {2079}if v_2099 then
                                                                (
                                                                    {2080}let pkSess_2100: bitstring = pub(skC) in
                                                                    {2081}out(c, GetEndpointRequest);
                                                                    {2082}in(c, (SPs_2101: bitstring,=Sign,UP_2102: bitstring,=pkSess_2100));
                                                                    {2083}new SPc_2103: bitstring;
                                                                    {2084}new Nc_2104: bitstring;
                                                                    {2085}let gNc_2105: bitstring = exp(g,Nc_2104) in
                                                                    {2086}let m1_2106: bitstring = (SPc_2103,gNc_2105) in
                                                                    {2087}out(c, (pkCli_2008,m1_2106,sign(m1_2106,skCli_2007)));
                                                                    {2088}event beginCli(Cli,Sess,gNc_2105);
                                                                    {2089}in(c, (PartS_2107: bitstring,sigPartS_2108: bitstring));
                                                                    {2090}if (verify(PartS_2107,sigPartS_2108,pkSess_2100) <> true) then
                                                                        0
                                                                    else
                                                                        {2091}event endCli(Sess,Cli,PartS_2107)
                                                                )
                                                                else
                                                                    {2092}let pkSess_2109: bitstring = pub(skI) in
                                                                    {2093}out(c, GetEndpointRequest);
                                                                    {2094}in(c, (SPs_2110: bitstring,=Sign,UP_2111: bitstring,=pkSess_2109));
                                                                    {2095}new SPc_2112: bitstring;
                                                                    {2096}new Nc_2113: bitstring;
                                                                    {2097}let gNc_2114: bitstring = exp(g,Nc_2113) in
                                                                    {2098}let m1_2115: bitstring = (SPc_2112,gNc_2114) in
                                                                    {2099}out(c, (pkCli_2008,m1_2115,sign(m1_2115,skCli_2007)));
                                                                    {2100}event beginCli(Cli,Sess,gNc_2114);
                                                                    {2101}in(c, (PartS_2116: bitstring,sigPartS_2117: bitstring));
                                                                    {2102}if (verify(PartS_2116,sigPartS_2117,pkSess_2109) <> true) then
                                                                        0
                                                                    else
                                                                        {2103}event endCli(Sess,Cli,PartS_2116)
                                                            )
                                                            else
                                                                {2104}let pkSess_2118: bitstring = fail-any in
                                                                {2105}out(c, GetEndpointRequest);
                                                                {2106}in(c, (SPs_2119: bitstring,=Sign,UP_2120: bitstring,=pkSess_2118));
                                                                {2107}new SPc_2121: bitstring;
                                                                {2108}new Nc_2122: bitstring;
                                                                {2109}let gNc_2123: bitstring = exp(g,Nc_2122) in
                                                                {2110}let m1_2124: bitstring = (SPc_2121,gNc_2123) in
                                                                {2111}out(c, (pkCli_2008,m1_2124,sign(m1_2124,skCli_2007)));
                                                                {2112}event beginCli(Cli,Sess,gNc_2123);
                                                                {2113}in(c, (PartS_2125: bitstring,sigPartS_2126: bitstring));
                                                                {2114}if (verify(PartS_2125,sigPartS_2126,pkSess_2118) <> true) then
                                                                    0
                                                                else
                                                                    {2115}event endCli(Sess,Cli,PartS_2125)
                                                    )
                                                    else
                                                        {2116}let pkSess_2127: bitstring = fail-any in
                                                        {2117}out(c, GetEndpointRequest);
                                                        {2118}in(c, (SPs_2128: bitstring,=Sign,UP_2129: bitstring,=pkSess_2127));
                                                        {2119}new SPc_2130: bitstring;
                                                        {2120}new Nc_2131: bitstring;
                                                        {2121}let gNc_2132: bitstring = exp(g,Nc_2131) in
                                                        {2122}let m1_2133: bitstring = (SPc_2130,gNc_2132) in
                                                        {2123}out(c, (pkCli_2008,m1_2133,sign(m1_2133,skCli_2007)));
                                                        {2124}event beginCli(Cli,Sess,gNc_2132);
                                                        {2125}in(c, (PartS_2134: bitstring,sigPartS_2135: bitstring));
                                                        {2126}if (verify(PartS_2134,sigPartS_2135,pkSess_2127) <> true) then
                                                            0
                                                        else
                                                            {2127}event endCli(Sess,Cli,PartS_2134)
                                            )
                                            else
                                                {2128}let pkSess_2136: bitstring = fail-any in
                                                {2129}out(c, GetEndpointRequest);
                                                {2130}in(c, (SPs_2137: bitstring,=Sign,UP_2138: bitstring,=pkSess_2136));
                                                {2131}new SPc_2139: bitstring;
                                                {2132}new Nc_2140: bitstring;
                                                {2133}let gNc_2141: bitstring = exp(g,Nc_2140) in
                                                {2134}let m1_2142: bitstring = (SPc_2139,gNc_2141) in
                                                {2135}out(c, (pkCli_2008,m1_2142,sign(m1_2142,skCli_2007)));
                                                {2136}event beginCli(Cli,Sess,gNc_2141);
                                                {2137}in(c, (PartS_2143: bitstring,sigPartS_2144: bitstring));
                                                {2138}if (verify(PartS_2143,sigPartS_2144,pkSess_2136) <> true) then
                                                    0
                                                else
                                                    {2139}event endCli(Sess,Cli,PartS_2143)
                                        )
                                        else
                                            {2140}let v_2145: bool = (Disco = C) in
                                            (
                                                {2141}if v_2145 then
                                                (
                                                    {2142}let pkDisco_2146: bitstring = pub(skC) in
                                                    {2143}let v_2147: bool = (Sess = A) in
                                                    (
                                                        {2144}if v_2147 then
                                                        (
                                                            {2145}let pkSess_2148: bitstring = pub(skA) in
                                                            {2146}out(c, GetEndpointRequest);
                                                            {2147}in(c, (SPs_2149: bitstring,=Sign,UP_2150: bitstring,=pkSess_2148));
                                                            {2148}new SPc_2151: bitstring;
                                                            {2149}new Nc_2152: bitstring;
                                                            {2150}let gNc_2153: bitstring = exp(g,Nc_2152) in
                                                            {2151}let m1_2154: bitstring = (SPc_2151,gNc_2153) in
                                                            {2152}out(c, (pkCli_2008,m1_2154,sign(m1_2154,skCli_2007)));
                                                            {2153}event beginCli(Cli,Sess,gNc_2153);
                                                            {2154}in(c, (PartS_2155: bitstring,sigPartS_2156: bitstring));
                                                            {2155}if (verify(PartS_2155,sigPartS_2156,pkSess_2148) <> true) then
                                                                0
                                                            else
                                                                {2156}event endCli(Sess,Cli,PartS_2155)
                                                        )
                                                        else
                                                            {2157}let v_2157: bool = (Sess = B) in
                                                            (
                                                                {2158}if v_2157 then
                                                                (
                                                                    {2159}let pkSess_2158: bitstring = pub(skB) in
                                                                    {2160}out(c, GetEndpointRequest);
                                                                    {2161}in(c, (SPs_2159: bitstring,=Sign,UP_2160: bitstring,=pkSess_2158));
                                                                    {2162}new SPc_2161: bitstring;
                                                                    {2163}new Nc_2162: bitstring;
                                                                    {2164}let gNc_2163: bitstring = exp(g,Nc_2162) in
                                                                    {2165}let m1_2164: bitstring = (SPc_2161,gNc_2163) in
                                                                    {2166}out(c, (pkCli_2008,m1_2164,sign(m1_2164,skCli_2007)));
                                                                    {2167}event beginCli(Cli,Sess,gNc_2163);
                                                                    {2168}in(c, (PartS_2165: bitstring,sigPartS_2166: bitstring));
                                                                    {2169}if (verify(PartS_2165,sigPartS_2166,pkSess_2158) <> true) then
                                                                        0
                                                                    else
                                                                        {2170}event endCli(Sess,Cli,PartS_2165)
                                                                )
                                                                else
                                                                    {2171}let v_2167: bool = (Sess = C) in
                                                                    (
                                                                        {2172}if v_2167 then
                                                                        (
                                                                            {2173}let pkSess_2168: bitstring = pub(skC) in
                                                                            {2174}out(c, GetEndpointRequest);
                                                                            {2175}in(c, (SPs_2169: bitstring,=Sign,UP_2170: bitstring,=pkSess_2168));
                                                                            {2176}new SPc_2171: bitstring;
                                                                            {2177}new Nc_2172: bitstring;
                                                                            {2178}let gNc_2173: bitstring = exp(g,Nc_2172) in
                                                                            {2179}let m1_2174: bitstring = (SPc_2171,gNc_2173) in
                                                                            {2180}out(c, (pkCli_2008,m1_2174,sign(m1_2174,skCli_2007)));
                                                                            {2181}event beginCli(Cli,Sess,gNc_2173);
                                                                            {2182}in(c, (PartS_2175: bitstring,sigPartS_2176: bitstring));
                                                                            {2183}if (verify(PartS_2175,sigPartS_2176,pkSess_2168) <> true) then
                                                                                0
                                                                            else
                                                                                {2184}event endCli(Sess,Cli,PartS_2175)
                                                                        )
                                                                        else
                                                                            {2185}let pkSess_2177: bitstring = pub(skI) in
                                                                            {2186}out(c, GetEndpointRequest);
                                                                            {2187}in(c, (SPs_2178: bitstring,=Sign,UP_2179: bitstring,=pkSess_2177));
                                                                            {2188}new SPc_2180: bitstring;
                                                                            {2189}new Nc_2181: bitstring;
                                                                            {2190}let gNc_2182: bitstring = exp(g,Nc_2181) in
                                                                            {2191}let m1_2183: bitstring = (SPc_2180,gNc_2182) in
                                                                            {2192}out(c, (pkCli_2008,m1_2183,sign(m1_2183,skCli_2007)));
                                                                            {2193}event beginCli(Cli,Sess,gNc_2182);
                                                                            {2194}in(c, (PartS_2184: bitstring,sigPartS_2185: bitstring));
                                                                            {2195}if (verify(PartS_2184,sigPartS_2185,pkSess_2177) <> true) then
                                                                                0
                                                                            else
                                                                                {2196}event endCli(Sess,Cli,PartS_2184)
                                                                    )
                                                                    else
                                                                        {2197}let pkSess_2186: bitstring = fail-any in
                                                                        {2198}out(c, GetEndpointRequest);
                                                                        {2199}in(c, (SPs_2187: bitstring,=Sign,UP_2188: bitstring,=pkSess_2186));
                                                                        {2200}new SPc_2189: bitstring;
                                                                        {2201}new Nc_2190: bitstring;
                                                                        {2202}let gNc_2191: bitstring = exp(g,Nc_2190) in
                                                                        {2203}let m1_2192: bitstring = (SPc_2189,gNc_2191) in
                                                                        {2204}out(c, (pkCli_2008,m1_2192,sign(m1_2192,skCli_2007)));
                                                                        {2205}event beginCli(Cli,Sess,gNc_2191);
                                                                        {2206}in(c, (PartS_2193: bitstring,sigPartS_2194: bitstring));
                                                                        {2207}if (verify(PartS_2193,sigPartS_2194,pkSess_2186) <> true) then
                                                                            0
                                                                        else
                                                                            {2208}event endCli(Sess,Cli,PartS_2193)
                                                            )
                                                            else
                                                                {2209}let pkSess_2195: bitstring = fail-any in
                                                                {2210}out(c, GetEndpointRequest);
                                                                {2211}in(c, (SPs_2196: bitstring,=Sign,UP_2197: bitstring,=pkSess_2195));
                                                                {2212}new SPc_2198: bitstring;
                                                                {2213}new Nc_2199: bitstring;
                                                                {2214}let gNc_2200: bitstring = exp(g,Nc_2199) in
                                                                {2215}let m1_2201: bitstring = (SPc_2198,gNc_2200) in
                                                                {2216}out(c, (pkCli_2008,m1_2201,sign(m1_2201,skCli_2007)));
                                                                {2217}event beginCli(Cli,Sess,gNc_2200);
                                                                {2218}in(c, (PartS_2202: bitstring,sigPartS_2203: bitstring));
                                                                {2219}if (verify(PartS_2202,sigPartS_2203,pkSess_2195) <> true) then
                                                                    0
                                                                else
                                                                    {2220}event endCli(Sess,Cli,PartS_2202)
                                                    )
                                                    else
                                                        {2221}let pkSess_2204: bitstring = fail-any in
                                                        {2222}out(c, GetEndpointRequest);
                                                        {2223}in(c, (SPs_2205: bitstring,=Sign,UP_2206: bitstring,=pkSess_2204));
                                                        {2224}new SPc_2207: bitstring;
                                                        {2225}new Nc_2208: bitstring;
                                                        {2226}let gNc_2209: bitstring = exp(g,Nc_2208) in
                                                        {2227}let m1_2210: bitstring = (SPc_2207,gNc_2209) in
                                                        {2228}out(c, (pkCli_2008,m1_2210,sign(m1_2210,skCli_2007)));
                                                        {2229}event beginCli(Cli,Sess,gNc_2209);
                                                        {2230}in(c, (PartS_2211: bitstring,sigPartS_2212: bitstring));
                                                        {2231}if (verify(PartS_2211,sigPartS_2212,pkSess_2204) <> true) then
                                                            0
                                                        else
                                                            {2232}event endCli(Sess,Cli,PartS_2211)
                                                )
                                                else
                                                    {2233}let pkDisco_2213: bitstring = pub(skI) in
                                                    {2234}let v_2214: bool = (Sess = A) in
                                                    (
                                                        {2235}if v_2214 then
                                                        (
                                                            {2236}let pkSess_2215: bitstring = pub(skA) in
                                                            {2237}out(c, GetEndpointRequest);
                                                            {2238}in(c, (SPs_2216: bitstring,=Sign,UP_2217: bitstring,=pkSess_2215));
                                                            {2239}new SPc_2218: bitstring;
                                                            {2240}new Nc_2219: bitstring;
                                                            {2241}let gNc_2220: bitstring = exp(g,Nc_2219) in
                                                            {2242}let m1_2221: bitstring = (SPc_2218,gNc_2220) in
                                                            {2243}out(c, (pkCli_2008,m1_2221,sign(m1_2221,skCli_2007)));
                                                            {2244}event beginCli(Cli,Sess,gNc_2220);
                                                            {2245}in(c, (PartS_2222: bitstring,sigPartS_2223: bitstring));
                                                            {2246}if (verify(PartS_2222,sigPartS_2223,pkSess_2215) <> true) then
                                                                0
                                                            else
                                                                {2247}event endCli(Sess,Cli,PartS_2222)
                                                        )
                                                        else
                                                            {2248}let v_2224: bool = (Sess = B) in
                                                            (
                                                                {2249}if v_2224 then
                                                                (
                                                                    {2250}let pkSess_2225: bitstring = pub(skB) in
                                                                    {2251}out(c, GetEndpointRequest);
                                                                    {2252}in(c, (SPs_2226: bitstring,=Sign,UP_2227: bitstring,=pkSess_2225));
                                                                    {2253}new SPc_2228: bitstring;
                                                                    {2254}new Nc_2229: bitstring;
                                                                    {2255}let gNc_2230: bitstring = exp(g,Nc_2229) in
                                                                    {2256}let m1_2231: bitstring = (SPc_2228,gNc_2230) in
                                                                    {2257}out(c, (pkCli_2008,m1_2231,sign(m1_2231,skCli_2007)));
                                                                    {2258}event beginCli(Cli,Sess,gNc_2230);
                                                                    {2259}in(c, (PartS_2232: bitstring,sigPartS_2233: bitstring));
                                                                    {2260}if (verify(PartS_2232,sigPartS_2233,pkSess_2225) <> true) then
                                                                        0
                                                                    else
                                                                        {2261}event endCli(Sess,Cli,PartS_2232)
                                                                )
                                                                else
                                                                    {2262}let v_2234: bool = (Sess = C) in
                                                                    (
                                                                        {2263}if v_2234 then
                                                                        (
                                                                            {2264}let pkSess_2235: bitstring = pub(skC) in
                                                                            {2265}out(c, GetEndpointRequest);
                                                                            {2266}in(c, (SPs_2236: bitstring,=Sign,UP_2237: bitstring,=pkSess_2235));
                                                                            {2267}new SPc_2238: bitstring;
                                                                            {2268}new Nc_2239: bitstring;
                                                                            {2269}let gNc_2240: bitstring = exp(g,Nc_2239) in
                                                                            {2270}let m1_2241: bitstring = (SPc_2238,gNc_2240) in
                                                                            {2271}out(c, (pkCli_2008,m1_2241,sign(m1_2241,skCli_2007)));
                                                                            {2272}event beginCli(Cli,Sess,gNc_2240);
                                                                            {2273}in(c, (PartS_2242: bitstring,sigPartS_2243: bitstring));
                                                                            {2274}if (verify(PartS_2242,sigPartS_2243,pkSess_2235) <> true) then
                                                                                0
                                                                            else
                                                                                {2275}event endCli(Sess,Cli,PartS_2242)
                                                                        )
                                                                        else
                                                                            {2276}let pkSess_2244: bitstring = pub(skI) in
                                                                            {2277}out(c, GetEndpointRequest);
                                                                            {2278}in(c, (SPs_2245: bitstring,=Sign,UP_2246: bitstring,=pkSess_2244));
                                                                            {2279}new SPc_2247: bitstring;
                                                                            {2280}new Nc_2248: bitstring;
                                                                            {2281}let gNc_2249: bitstring = exp(g,Nc_2248) in
                                                                            {2282}let m1_2250: bitstring = (SPc_2247,gNc_2249) in
                                                                            {2283}out(c, (pkCli_2008,m1_2250,sign(m1_2250,skCli_2007)));
                                                                            {2284}event beginCli(Cli,Sess,gNc_2249);
                                                                            {2285}in(c, (PartS_2251: bitstring,sigPartS_2252: bitstring));
                                                                            {2286}if (verify(PartS_2251,sigPartS_2252,pkSess_2244) <> true) then
                                                                                0
                                                                            else
                                                                                {2287}event endCli(Sess,Cli,PartS_2251)
                                                                    )
                                                                    else
                                                                        {2288}let pkSess_2253: bitstring = fail-any in
                                                                        {2289}out(c, GetEndpointRequest);
                                                                        {2290}in(c, (SPs_2254: bitstring,=Sign,UP_2255: bitstring,=pkSess_2253));
                                                                        {2291}new SPc_2256: bitstring;
                                                                        {2292}new Nc_2257: bitstring;
                                                                        {2293}let gNc_2258: bitstring = exp(g,Nc_2257) in
                                                                        {2294}let m1_2259: bitstring = (SPc_2256,gNc_2258) in
                                                                        {2295}out(c, (pkCli_2008,m1_2259,sign(m1_2259,skCli_2007)));
                                                                        {2296}event beginCli(Cli,Sess,gNc_2258);
                                                                        {2297}in(c, (PartS_2260: bitstring,sigPartS_2261: bitstring));
                                                                        {2298}if (verify(PartS_2260,sigPartS_2261,pkSess_2253) <> true) then
                                                                            0
                                                                        else
                                                                            {2299}event endCli(Sess,Cli,PartS_2260)
                                                            )
                                                            else
                                                                {2300}let pkSess_2262: bitstring = fail-any in
                                                                {2301}out(c, GetEndpointRequest);
                                                                {2302}in(c, (SPs_2263: bitstring,=Sign,UP_2264: bitstring,=pkSess_2262));
                                                                {2303}new SPc_2265: bitstring;
                                                                {2304}new Nc_2266: bitstring;
                                                                {2305}let gNc_2267: bitstring = exp(g,Nc_2266) in
                                                                {2306}let m1_2268: bitstring = (SPc_2265,gNc_2267) in
                                                                {2307}out(c, (pkCli_2008,m1_2268,sign(m1_2268,skCli_2007)));
                                                                {2308}event beginCli(Cli,Sess,gNc_2267);
                                                                {2309}in(c, (PartS_2269: bitstring,sigPartS_2270: bitstring));
                                                                {2310}if (verify(PartS_2269,sigPartS_2270,pkSess_2262) <> true) then
                                                                    0
                                                                else
                                                                    {2311}event endCli(Sess,Cli,PartS_2269)
                                                    )
                                                    else
                                                        {2312}let pkSess_2271: bitstring = fail-any in
                                                        {2313}out(c, GetEndpointRequest);
                                                        {2314}in(c, (SPs_2272: bitstring,=Sign,UP_2273: bitstring,=pkSess_2271));
                                                        {2315}new SPc_2274: bitstring;
                                                        {2316}new Nc_2275: bitstring;
                                                        {2317}let gNc_2276: bitstring = exp(g,Nc_2275) in
                                                        {2318}let m1_2277: bitstring = (SPc_2274,gNc_2276) in
                                                        {2319}out(c, (pkCli_2008,m1_2277,sign(m1_2277,skCli_2007)));
                                                        {2320}event beginCli(Cli,Sess,gNc_2276);
                                                        {2321}in(c, (PartS_2278: bitstring,sigPartS_2279: bitstring));
                                                        {2322}if (verify(PartS_2278,sigPartS_2279,pkSess_2271) <> true) then
                                                            0
                                                        else
                                                            {2323}event endCli(Sess,Cli,PartS_2278)
                                            )
                                            else
                                                {2324}let pkDisco_2280: bitstring = fail-any in
                                                {2325}let v_2281: bool = (Sess = A) in
                                                (
                                                    {2326}if v_2281 then
                                                    (
                                                        {2327}let pkSess_2282: bitstring = pub(skA) in
                                                        {2328}out(c, GetEndpointRequest);
                                                        {2329}in(c, (SPs_2283: bitstring,=Sign,UP_2284: bitstring,=pkSess_2282));
                                                        {2330}new SPc_2285: bitstring;
                                                        {2331}new Nc_2286: bitstring;
                                                        {2332}let gNc_2287: bitstring = exp(g,Nc_2286) in
                                                        {2333}let m1_2288: bitstring = (SPc_2285,gNc_2287) in
                                                        {2334}out(c, (pkCli_2008,m1_2288,sign(m1_2288,skCli_2007)));
                                                        {2335}event beginCli(Cli,Sess,gNc_2287);
                                                        {2336}in(c, (PartS_2289: bitstring,sigPartS_2290: bitstring));
                                                        {2337}if (verify(PartS_2289,sigPartS_2290,pkSess_2282) <> true) then
                                                            0
                                                        else
                                                            {2338}event endCli(Sess,Cli,PartS_2289)
                                                    )
                                                    else
                                                        {2339}let v_2291: bool = (Sess = B) in
                                                        (
                                                            {2340}if v_2291 then
                                                            (
                                                                {2341}let pkSess_2292: bitstring = pub(skB) in
                                                                {2342}out(c, GetEndpointRequest);
                                                                {2343}in(c, (SPs_2293: bitstring,=Sign,UP_2294: bitstring,=pkSess_2292));
                                                                {2344}new SPc_2295: bitstring;
                                                                {2345}new Nc_2296: bitstring;
                                                                {2346}let gNc_2297: bitstring = exp(g,Nc_2296) in
                                                                {2347}let m1_2298: bitstring = (SPc_2295,gNc_2297) in
                                                                {2348}out(c, (pkCli_2008,m1_2298,sign(m1_2298,skCli_2007)));
                                                                {2349}event beginCli(Cli,Sess,gNc_2297);
                                                                {2350}in(c, (PartS_2299: bitstring,sigPartS_2300: bitstring));
                                                                {2351}if (verify(PartS_2299,sigPartS_2300,pkSess_2292) <> true) then
                                                                    0
                                                                else
                                                                    {2352}event endCli(Sess,Cli,PartS_2299)
                                                            )
                                                            else
                                                                {2353}let v_2301: bool = (Sess = C) in
                                                                (
                                                                    {2354}if v_2301 then
                                                                    (
                                                                        {2355}let pkSess_2302: bitstring = pub(skC) in
                                                                        {2356}out(c, GetEndpointRequest);
                                                                        {2357}in(c, (SPs_2303: bitstring,=Sign,UP_2304: bitstring,=pkSess_2302));
                                                                        {2358}new SPc_2305: bitstring;
                                                                        {2359}new Nc_2306: bitstring;
                                                                        {2360}let gNc_2307: bitstring = exp(g,Nc_2306) in
                                                                        {2361}let m1_2308: bitstring = (SPc_2305,gNc_2307) in
                                                                        {2362}out(c, (pkCli_2008,m1_2308,sign(m1_2308,skCli_2007)));
                                                                        {2363}event beginCli(Cli,Sess,gNc_2307);
                                                                        {2364}in(c, (PartS_2309: bitstring,sigPartS_2310: bitstring));
                                                                        {2365}if (verify(PartS_2309,sigPartS_2310,pkSess_2302) <> true) then
                                                                            0
                                                                        else
                                                                            {2366}event endCli(Sess,Cli,PartS_2309)
                                                                    )
                                                                    else
                                                                        {2367}let pkSess_2311: bitstring = pub(skI) in
                                                                        {2368}out(c, GetEndpointRequest);
                                                                        {2369}in(c, (SPs_2312: bitstring,=Sign,UP_2313: bitstring,=pkSess_2311));
                                                                        {2370}new SPc_2314: bitstring;
                                                                        {2371}new Nc_2315: bitstring;
                                                                        {2372}let gNc_2316: bitstring = exp(g,Nc_2315) in
                                                                        {2373}let m1_2317: bitstring = (SPc_2314,gNc_2316) in
                                                                        {2374}out(c, (pkCli_2008,m1_2317,sign(m1_2317,skCli_2007)));
                                                                        {2375}event beginCli(Cli,Sess,gNc_2316);
                                                                        {2376}in(c, (PartS_2318: bitstring,sigPartS_2319: bitstring));
                                                                        {2377}if (verify(PartS_2318,sigPartS_2319,pkSess_2311) <> true) then
                                                                            0
                                                                        else
                                                                            {2378}event endCli(Sess,Cli,PartS_2318)
                                                                )
                                                                else
                                                                    {2379}let pkSess_2320: bitstring = fail-any in
                                                                    {2380}out(c, GetEndpointRequest);
                                                                    {2381}in(c, (SPs_2321: bitstring,=Sign,UP_2322: bitstring,=pkSess_2320));
                                                                    {2382}new SPc_2323: bitstring;
                                                                    {2383}new Nc_2324: bitstring;
                                                                    {2384}let gNc_2325: bitstring = exp(g,Nc_2324) in
                                                                    {2385}let m1_2326: bitstring = (SPc_2323,gNc_2325) in
                                                                    {2386}out(c, (pkCli_2008,m1_2326,sign(m1_2326,skCli_2007)));
                                                                    {2387}event beginCli(Cli,Sess,gNc_2325);
                                                                    {2388}in(c, (PartS_2327: bitstring,sigPartS_2328: bitstring));
                                                                    {2389}if (verify(PartS_2327,sigPartS_2328,pkSess_2320) <> true) then
                                                                        0
                                                                    else
                                                                        {2390}event endCli(Sess,Cli,PartS_2327)
                                                        )
                                                        else
                                                            {2391}let pkSess_2329: bitstring = fail-any in
                                                            {2392}out(c, GetEndpointRequest);
                                                            {2393}in(c, (SPs_2330: bitstring,=Sign,UP_2331: bitstring,=pkSess_2329));
                                                            {2394}new SPc_2332: bitstring;
                                                            {2395}new Nc_2333: bitstring;
                                                            {2396}let gNc_2334: bitstring = exp(g,Nc_2333) in
                                                            {2397}let m1_2335: bitstring = (SPc_2332,gNc_2334) in
                                                            {2398}out(c, (pkCli_2008,m1_2335,sign(m1_2335,skCli_2007)));
                                                            {2399}event beginCli(Cli,Sess,gNc_2334);
                                                            {2400}in(c, (PartS_2336: bitstring,sigPartS_2337: bitstring));
                                                            {2401}if (verify(PartS_2336,sigPartS_2337,pkSess_2329) <> true) then
                                                                0
                                                            else
                                                                {2402}event endCli(Sess,Cli,PartS_2336)
                                                )
                                                else
                                                    {2403}let pkSess_2338: bitstring = fail-any in
                                                    {2404}out(c, GetEndpointRequest);
                                                    {2405}in(c, (SPs_2339: bitstring,=Sign,UP_2340: bitstring,=pkSess_2338));
                                                    {2406}new SPc_2341: bitstring;
                                                    {2407}new Nc_2342: bitstring;
                                                    {2408}let gNc_2343: bitstring = exp(g,Nc_2342) in
                                                    {2409}let m1_2344: bitstring = (SPc_2341,gNc_2343) in
                                                    {2410}out(c, (pkCli_2008,m1_2344,sign(m1_2344,skCli_2007)));
                                                    {2411}event beginCli(Cli,Sess,gNc_2343);
                                                    {2412}in(c, (PartS_2345: bitstring,sigPartS_2346: bitstring));
                                                    {2413}if (verify(PartS_2345,sigPartS_2346,pkSess_2338) <> true) then
                                                        0
                                                    else
                                                        {2414}event endCli(Sess,Cli,PartS_2345)
                                    )
                                    else
                                        {2415}let pkDisco_2347: bitstring = fail-any in
                                        {2416}let v_2348: bool = (Sess = A) in
                                        (
                                            {2417}if v_2348 then
                                            (
                                                {2418}let pkSess_2349: bitstring = pub(skA) in
                                                {2419}out(c, GetEndpointRequest);
                                                {2420}in(c, (SPs_2350: bitstring,=Sign,UP_2351: bitstring,=pkSess_2349));
                                                {2421}new SPc_2352: bitstring;
                                                {2422}new Nc_2353: bitstring;
                                                {2423}let gNc_2354: bitstring = exp(g,Nc_2353) in
                                                {2424}let m1_2355: bitstring = (SPc_2352,gNc_2354) in
                                                {2425}out(c, (pkCli_2008,m1_2355,sign(m1_2355,skCli_2007)));
                                                {2426}event beginCli(Cli,Sess,gNc_2354);
                                                {2427}in(c, (PartS_2356: bitstring,sigPartS_2357: bitstring));
                                                {2428}if (verify(PartS_2356,sigPartS_2357,pkSess_2349) <> true) then
                                                    0
                                                else
                                                    {2429}event endCli(Sess,Cli,PartS_2356)
                                            )
                                            else
                                                {2430}let v_2358: bool = (Sess = B) in
                                                (
                                                    {2431}if v_2358 then
                                                    (
                                                        {2432}let pkSess_2359: bitstring = pub(skB) in
                                                        {2433}out(c, GetEndpointRequest);
                                                        {2434}in(c, (SPs_2360: bitstring,=Sign,UP_2361: bitstring,=pkSess_2359));
                                                        {2435}new SPc_2362: bitstring;
                                                        {2436}new Nc_2363: bitstring;
                                                        {2437}let gNc_2364: bitstring = exp(g,Nc_2363) in
                                                        {2438}let m1_2365: bitstring = (SPc_2362,gNc_2364) in
                                                        {2439}out(c, (pkCli_2008,m1_2365,sign(m1_2365,skCli_2007)));
                                                        {2440}event beginCli(Cli,Sess,gNc_2364);
                                                        {2441}in(c, (PartS_2366: bitstring,sigPartS_2367: bitstring));
                                                        {2442}if (verify(PartS_2366,sigPartS_2367,pkSess_2359) <> true) then
                                                            0
                                                        else
                                                            {2443}event endCli(Sess,Cli,PartS_2366)
                                                    )
                                                    else
                                                        {2444}let v_2368: bool = (Sess = C) in
                                                        (
                                                            {2445}if v_2368 then
                                                            (
                                                                {2446}let pkSess_2369: bitstring = pub(skC) in
                                                                {2447}out(c, GetEndpointRequest);
                                                                {2448}in(c, (SPs_2370: bitstring,=Sign,UP_2371: bitstring,=pkSess_2369));
                                                                {2449}new SPc_2372: bitstring;
                                                                {2450}new Nc_2373: bitstring;
                                                                {2451}let gNc_2374: bitstring = exp(g,Nc_2373) in
                                                                {2452}let m1_2375: bitstring = (SPc_2372,gNc_2374) in
                                                                {2453}out(c, (pkCli_2008,m1_2375,sign(m1_2375,skCli_2007)));
                                                                {2454}event beginCli(Cli,Sess,gNc_2374);
                                                                {2455}in(c, (PartS_2376: bitstring,sigPartS_2377: bitstring));
                                                                {2456}if (verify(PartS_2376,sigPartS_2377,pkSess_2369) <> true) then
                                                                    0
                                                                else
                                                                    {2457}event endCli(Sess,Cli,PartS_2376)
                                                            )
                                                            else
                                                                {2458}let pkSess_2378: bitstring = pub(skI) in
                                                                {2459}out(c, GetEndpointRequest);
                                                                {2460}in(c, (SPs_2379: bitstring,=Sign,UP_2380: bitstring,=pkSess_2378));
                                                                {2461}new SPc_2381: bitstring;
                                                                {2462}new Nc_2382: bitstring;
                                                                {2463}let gNc_2383: bitstring = exp(g,Nc_2382) in
                                                                {2464}let m1_2384: bitstring = (SPc_2381,gNc_2383) in
                                                                {2465}out(c, (pkCli_2008,m1_2384,sign(m1_2384,skCli_2007)));
                                                                {2466}event beginCli(Cli,Sess,gNc_2383);
                                                                {2467}in(c, (PartS_2385: bitstring,sigPartS_2386: bitstring));
                                                                {2468}if (verify(PartS_2385,sigPartS_2386,pkSess_2378) <> true) then
                                                                    0
                                                                else
                                                                    {2469}event endCli(Sess,Cli,PartS_2385)
                                                        )
                                                        else
                                                            {2470}let pkSess_2387: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (SPs_2388: bitstring,=Sign,UP_2389: bitstring,=pkSess_2387));
                                                            {2473}new SPc_2390: bitstring;
                                                            {2474}new Nc_2391: bitstring;
                                                            {2475}let gNc_2392: bitstring = exp(g,Nc_2391) in
                                                            {2476}let m1_2393: bitstring = (SPc_2390,gNc_2392) in
                                                            {2477}out(c, (pkCli_2008,m1_2393,sign(m1_2393,skCli_2007)));
                                                            {2478}event beginCli(Cli,Sess,gNc_2392);
                                                            {2479}in(c, (PartS_2394: bitstring,sigPartS_2395: bitstring));
                                                            {2480}if (verify(PartS_2394,sigPartS_2395,pkSess_2387) <> true) then
                                                                0
                                                            else
                                                                {2481}event endCli(Sess,Cli,PartS_2394)
                                                )
                                                else
                                                    {2482}let pkSess_2396: bitstring = fail-any in
                                                    {2483}out(c, GetEndpointRequest);
                                                    {2484}in(c, (SPs_2397: bitstring,=Sign,UP_2398: bitstring,=pkSess_2396));
                                                    {2485}new SPc_2399: bitstring;
                                                    {2486}new Nc_2400: bitstring;
                                                    {2487}let gNc_2401: bitstring = exp(g,Nc_2400) in
                                                    {2488}let m1_2402: bitstring = (SPc_2399,gNc_2401) in
                                                    {2489}out(c, (pkCli_2008,m1_2402,sign(m1_2402,skCli_2007)));
                                                    {2490}event beginCli(Cli,Sess,gNc_2401);
                                                    {2491}in(c, (PartS_2403: bitstring,sigPartS_2404: bitstring));
                                                    {2492}if (verify(PartS_2403,sigPartS_2404,pkSess_2396) <> true) then
                                                        0
                                                    else
                                                        {2493}event endCli(Sess,Cli,PartS_2403)
                                        )
                                        else
                                            {2494}let pkSess_2405: bitstring = fail-any in
                                            {2495}out(c, GetEndpointRequest);
                                            {2496}in(c, (SPs_2406: bitstring,=Sign,UP_2407: bitstring,=pkSess_2405));
                                            {2497}new SPc_2408: bitstring;
                                            {2498}new Nc_2409: bitstring;
                                            {2499}let gNc_2410: bitstring = exp(g,Nc_2409) in
                                            {2500}let m1_2411: bitstring = (SPc_2408,gNc_2410) in
                                            {2501}out(c, (pkCli_2008,m1_2411,sign(m1_2411,skCli_2007)));
                                            {2502}event beginCli(Cli,Sess,gNc_2410);
                                            {2503}in(c, (PartS_2412: bitstring,sigPartS_2413: bitstring));
                                            {2504}if (verify(PartS_2412,sigPartS_2413,pkSess_2405) <> true) then
                                                0
                                            else
                                                {2505}event endCli(Sess,Cli,PartS_2412)
                            )
                            else
                                {2506}let pkDisco_2414: bitstring = fail-any in
                                {2507}let v_2415: bool = (Sess = A) in
                                (
                                    {2508}if v_2415 then
                                    (
                                        {2509}let pkSess_2416: bitstring = pub(skA) in
                                        {2510}out(c, GetEndpointRequest);
                                        {2511}in(c, (SPs_2417: bitstring,=Sign,UP_2418: bitstring,=pkSess_2416));
                                        {2512}new SPc_2419: bitstring;
                                        {2513}new Nc_2420: bitstring;
                                        {2514}let gNc_2421: bitstring = exp(g,Nc_2420) in
                                        {2515}let m1_2422: bitstring = (SPc_2419,gNc_2421) in
                                        {2516}out(c, (pkCli_2008,m1_2422,sign(m1_2422,skCli_2007)));
                                        {2517}event beginCli(Cli,Sess,gNc_2421);
                                        {2518}in(c, (PartS_2423: bitstring,sigPartS_2424: bitstring));
                                        {2519}if (verify(PartS_2423,sigPartS_2424,pkSess_2416) <> true) then
                                            0
                                        else
                                            {2520}event endCli(Sess,Cli,PartS_2423)
                                    )
                                    else
                                        {2521}let v_2425: bool = (Sess = B) in
                                        (
                                            {2522}if v_2425 then
                                            (
                                                {2523}let pkSess_2426: bitstring = pub(skB) in
                                                {2524}out(c, GetEndpointRequest);
                                                {2525}in(c, (SPs_2427: bitstring,=Sign,UP_2428: bitstring,=pkSess_2426));
                                                {2526}new SPc_2429: bitstring;
                                                {2527}new Nc_2430: bitstring;
                                                {2528}let gNc_2431: bitstring = exp(g,Nc_2430) in
                                                {2529}let m1_2432: bitstring = (SPc_2429,gNc_2431) in
                                                {2530}out(c, (pkCli_2008,m1_2432,sign(m1_2432,skCli_2007)));
                                                {2531}event beginCli(Cli,Sess,gNc_2431);
                                                {2532}in(c, (PartS_2433: bitstring,sigPartS_2434: bitstring));
                                                {2533}if (verify(PartS_2433,sigPartS_2434,pkSess_2426) <> true) then
                                                    0
                                                else
                                                    {2534}event endCli(Sess,Cli,PartS_2433)
                                            )
                                            else
                                                {2535}let v_2435: bool = (Sess = C) in
                                                (
                                                    {2536}if v_2435 then
                                                    (
                                                        {2537}let pkSess_2436: bitstring = pub(skC) in
                                                        {2538}out(c, GetEndpointRequest);
                                                        {2539}in(c, (SPs_2437: bitstring,=Sign,UP_2438: bitstring,=pkSess_2436));
                                                        {2540}new SPc_2439: bitstring;
                                                        {2541}new Nc_2440: bitstring;
                                                        {2542}let gNc_2441: bitstring = exp(g,Nc_2440) in
                                                        {2543}let m1_2442: bitstring = (SPc_2439,gNc_2441) in
                                                        {2544}out(c, (pkCli_2008,m1_2442,sign(m1_2442,skCli_2007)));
                                                        {2545}event beginCli(Cli,Sess,gNc_2441);
                                                        {2546}in(c, (PartS_2443: bitstring,sigPartS_2444: bitstring));
                                                        {2547}if (verify(PartS_2443,sigPartS_2444,pkSess_2436) <> true) then
                                                            0
                                                        else
                                                            {2548}event endCli(Sess,Cli,PartS_2443)
                                                    )
                                                    else
                                                        {2549}let pkSess_2445: bitstring = pub(skI) in
                                                        {2550}out(c, GetEndpointRequest);
                                                        {2551}in(c, (SPs_2446: bitstring,=Sign,UP_2447: bitstring,=pkSess_2445));
                                                        {2552}new SPc_2448: bitstring;
                                                        {2553}new Nc_2449: bitstring;
                                                        {2554}let gNc_2450: bitstring = exp(g,Nc_2449) in
                                                        {2555}let m1_2451: bitstring = (SPc_2448,gNc_2450) in
                                                        {2556}out(c, (pkCli_2008,m1_2451,sign(m1_2451,skCli_2007)));
                                                        {2557}event beginCli(Cli,Sess,gNc_2450);
                                                        {2558}in(c, (PartS_2452: bitstring,sigPartS_2453: bitstring));
                                                        {2559}if (verify(PartS_2452,sigPartS_2453,pkSess_2445) <> true) then
                                                            0
                                                        else
                                                            {2560}event endCli(Sess,Cli,PartS_2452)
                                                )
                                                else
                                                    {2561}let pkSess_2454: bitstring = fail-any in
                                                    {2562}out(c, GetEndpointRequest);
                                                    {2563}in(c, (SPs_2455: bitstring,=Sign,UP_2456: bitstring,=pkSess_2454));
                                                    {2564}new SPc_2457: bitstring;
                                                    {2565}new Nc_2458: bitstring;
                                                    {2566}let gNc_2459: bitstring = exp(g,Nc_2458) in
                                                    {2567}let m1_2460: bitstring = (SPc_2457,gNc_2459) in
                                                    {2568}out(c, (pkCli_2008,m1_2460,sign(m1_2460,skCli_2007)));
                                                    {2569}event beginCli(Cli,Sess,gNc_2459);
                                                    {2570}in(c, (PartS_2461: bitstring,sigPartS_2462: bitstring));
                                                    {2571}if (verify(PartS_2461,sigPartS_2462,pkSess_2454) <> true) then
                                                        0
                                                    else
                                                        {2572}event endCli(Sess,Cli,PartS_2461)
                                        )
                                        else
                                            {2573}let pkSess_2463: bitstring = fail-any in
                                            {2574}out(c, GetEndpointRequest);
                                            {2575}in(c, (SPs_2464: bitstring,=Sign,UP_2465: bitstring,=pkSess_2463));
                                            {2576}new SPc_2466: bitstring;
                                            {2577}new Nc_2467: bitstring;
                                            {2578}let gNc_2468: bitstring = exp(g,Nc_2467) in
                                            {2579}let m1_2469: bitstring = (SPc_2466,gNc_2468) in
                                            {2580}out(c, (pkCli_2008,m1_2469,sign(m1_2469,skCli_2007)));
                                            {2581}event beginCli(Cli,Sess,gNc_2468);
                                            {2582}in(c, (PartS_2470: bitstring,sigPartS_2471: bitstring));
                                            {2583}if (verify(PartS_2470,sigPartS_2471,pkSess_2463) <> true) then
                                                0
                                            else
                                                {2584}event endCli(Sess,Cli,PartS_2470)
                                )
                                else
                                    {2585}let pkSess_2472: bitstring = fail-any in
                                    {2586}out(c, GetEndpointRequest);
                                    {2587}in(c, (SPs_2473: bitstring,=Sign,UP_2474: bitstring,=pkSess_2472));
                                    {2588}new SPc_2475: bitstring;
                                    {2589}new Nc_2476: bitstring;
                                    {2590}let gNc_2477: bitstring = exp(g,Nc_2476) in
                                    {2591}let m1_2478: bitstring = (SPc_2475,gNc_2477) in
                                    {2592}out(c, (pkCli_2008,m1_2478,sign(m1_2478,skCli_2007)));
                                    {2593}event beginCli(Cli,Sess,gNc_2477);
                                    {2594}in(c, (PartS_2479: bitstring,sigPartS_2480: bitstring));
                                    {2595}if (verify(PartS_2479,sigPartS_2480,pkSess_2472) <> true) then
                                        0
                                    else
                                        {2596}event endCli(Sess,Cli,PartS_2479)
                    )
                    else
                        {2597}let skCli_2481: bitstring = fail-any in
                        {2598}let pkCli_2482: bitstring = pub(skCli_2481) in
                        {2599}let v_2483: bool = (Disco = A) in
                        (
                            {2600}if v_2483 then
                            (
                                {2601}let pkDisco_2484: bitstring = pub(skA) in
                                {2602}let v_2485: bool = (Sess = A) in
                                (
                                    {2603}if v_2485 then
                                    (
                                        {2604}let pkSess_2486: bitstring = pub(skA) in
                                        {2605}out(c, GetEndpointRequest);
                                        {2606}in(c, (SPs_2487: bitstring,=Sign,UP_2488: bitstring,=pkSess_2486));
                                        {2607}new SPc_2489: bitstring;
                                        {2608}new Nc_2490: bitstring;
                                        {2609}let gNc_2491: bitstring = exp(g,Nc_2490) in
                                        {2610}let m1_2492: bitstring = (SPc_2489,gNc_2491) in
                                        {2611}out(c, (pkCli_2482,m1_2492,sign(m1_2492,skCli_2481)));
                                        {2612}event beginCli(Cli,Sess,gNc_2491);
                                        {2613}in(c, (PartS_2493: bitstring,sigPartS_2494: bitstring));
                                        {2614}if (verify(PartS_2493,sigPartS_2494,pkSess_2486) <> true) then
                                            0
                                        else
                                            {2615}event endCli(Sess,Cli,PartS_2493)
                                    )
                                    else
                                        {2616}let v_2495: bool = (Sess = B) in
                                        (
                                            {2617}if v_2495 then
                                            (
                                                {2618}let pkSess_2496: bitstring = pub(skB) in
                                                {2619}out(c, GetEndpointRequest);
                                                {2620}in(c, (SPs_2497: bitstring,=Sign,UP_2498: bitstring,=pkSess_2496));
                                                {2621}new SPc_2499: bitstring;
                                                {2622}new Nc_2500: bitstring;
                                                {2623}let gNc_2501: bitstring = exp(g,Nc_2500) in
                                                {2624}let m1_2502: bitstring = (SPc_2499,gNc_2501) in
                                                {2625}out(c, (pkCli_2482,m1_2502,sign(m1_2502,skCli_2481)));
                                                {2626}event beginCli(Cli,Sess,gNc_2501);
                                                {2627}in(c, (PartS_2503: bitstring,sigPartS_2504: bitstring));
                                                {2628}if (verify(PartS_2503,sigPartS_2504,pkSess_2496) <> true) then
                                                    0
                                                else
                                                    {2629}event endCli(Sess,Cli,PartS_2503)
                                            )
                                            else
                                                {2630}let v_2505: bool = (Sess = C) in
                                                (
                                                    {2631}if v_2505 then
                                                    (
                                                        {2632}let pkSess_2506: bitstring = pub(skC) in
                                                        {2633}out(c, GetEndpointRequest);
                                                        {2634}in(c, (SPs_2507: bitstring,=Sign,UP_2508: bitstring,=pkSess_2506));
                                                        {2635}new SPc_2509: bitstring;
                                                        {2636}new Nc_2510: bitstring;
                                                        {2637}let gNc_2511: bitstring = exp(g,Nc_2510) in
                                                        {2638}let m1_2512: bitstring = (SPc_2509,gNc_2511) in
                                                        {2639}out(c, (pkCli_2482,m1_2512,sign(m1_2512,skCli_2481)));
                                                        {2640}event beginCli(Cli,Sess,gNc_2511);
                                                        {2641}in(c, (PartS_2513: bitstring,sigPartS_2514: bitstring));
                                                        {2642}if (verify(PartS_2513,sigPartS_2514,pkSess_2506) <> true) then
                                                            0
                                                        else
                                                            {2643}event endCli(Sess,Cli,PartS_2513)
                                                    )
                                                    else
                                                        {2644}let pkSess_2515: bitstring = pub(skI) in
                                                        {2645}out(c, GetEndpointRequest);
                                                        {2646}in(c, (SPs_2516: bitstring,=Sign,UP_2517: bitstring,=pkSess_2515));
                                                        {2647}new SPc_2518: bitstring;
                                                        {2648}new Nc_2519: bitstring;
                                                        {2649}let gNc_2520: bitstring = exp(g,Nc_2519) in
                                                        {2650}let m1_2521: bitstring = (SPc_2518,gNc_2520) in
                                                        {2651}out(c, (pkCli_2482,m1_2521,sign(m1_2521,skCli_2481)));
                                                        {2652}event beginCli(Cli,Sess,gNc_2520);
                                                        {2653}in(c, (PartS_2522: bitstring,sigPartS_2523: bitstring));
                                                        {2654}if (verify(PartS_2522,sigPartS_2523,pkSess_2515) <> true) then
                                                            0
                                                        else
                                                            {2655}event endCli(Sess,Cli,PartS_2522)
                                                )
                                                else
                                                    {2656}let pkSess_2524: bitstring = fail-any in
                                                    {2657}out(c, GetEndpointRequest);
                                                    {2658}in(c, (SPs_2525: bitstring,=Sign,UP_2526: bitstring,=pkSess_2524));
                                                    {2659}new SPc_2527: bitstring;
                                                    {2660}new Nc_2528: bitstring;
                                                    {2661}let gNc_2529: bitstring = exp(g,Nc_2528) in
                                                    {2662}let m1_2530: bitstring = (SPc_2527,gNc_2529) in
                                                    {2663}out(c, (pkCli_2482,m1_2530,sign(m1_2530,skCli_2481)));
                                                    {2664}event beginCli(Cli,Sess,gNc_2529);
                                                    {2665}in(c, (PartS_2531: bitstring,sigPartS_2532: bitstring));
                                                    {2666}if (verify(PartS_2531,sigPartS_2532,pkSess_2524) <> true) then
                                                        0
                                                    else
                                                        {2667}event endCli(Sess,Cli,PartS_2531)
                                        )
                                        else
                                            {2668}let pkSess_2533: bitstring = fail-any in
                                            {2669}out(c, GetEndpointRequest);
                                            {2670}in(c, (SPs_2534: bitstring,=Sign,UP_2535: bitstring,=pkSess_2533));
                                            {2671}new SPc_2536: bitstring;
                                            {2672}new Nc_2537: bitstring;
                                            {2673}let gNc_2538: bitstring = exp(g,Nc_2537) in
                                            {2674}let m1_2539: bitstring = (SPc_2536,gNc_2538) in
                                            {2675}out(c, (pkCli_2482,m1_2539,sign(m1_2539,skCli_2481)));
                                            {2676}event beginCli(Cli,Sess,gNc_2538);
                                            {2677}in(c, (PartS_2540: bitstring,sigPartS_2541: bitstring));
                                            {2678}if (verify(PartS_2540,sigPartS_2541,pkSess_2533) <> true) then
                                                0
                                            else
                                                {2679}event endCli(Sess,Cli,PartS_2540)
                                )
                                else
                                    {2680}let pkSess_2542: bitstring = fail-any in
                                    {2681}out(c, GetEndpointRequest);
                                    {2682}in(c, (SPs_2543: bitstring,=Sign,UP_2544: bitstring,=pkSess_2542));
                                    {2683}new SPc_2545: bitstring;
                                    {2684}new Nc_2546: bitstring;
                                    {2685}let gNc_2547: bitstring = exp(g,Nc_2546) in
                                    {2686}let m1_2548: bitstring = (SPc_2545,gNc_2547) in
                                    {2687}out(c, (pkCli_2482,m1_2548,sign(m1_2548,skCli_2481)));
                                    {2688}event beginCli(Cli,Sess,gNc_2547);
                                    {2689}in(c, (PartS_2549: bitstring,sigPartS_2550: bitstring));
                                    {2690}if (verify(PartS_2549,sigPartS_2550,pkSess_2542) <> true) then
                                        0
                                    else
                                        {2691}event endCli(Sess,Cli,PartS_2549)
                            )
                            else
                                {2692}let v_2551: bool = (Disco = B) in
                                (
                                    {2693}if v_2551 then
                                    (
                                        {2694}let pkDisco_2552: bitstring = pub(skB) in
                                        {2695}let v_2553: bool = (Sess = A) in
                                        (
                                            {2696}if v_2553 then
                                            (
                                                {2697}let pkSess_2554: bitstring = pub(skA) in
                                                {2698}out(c, GetEndpointRequest);
                                                {2699}in(c, (SPs_2555: bitstring,=Sign,UP_2556: bitstring,=pkSess_2554));
                                                {2700}new SPc_2557: bitstring;
                                                {2701}new Nc_2558: bitstring;
                                                {2702}let gNc_2559: bitstring = exp(g,Nc_2558) in
                                                {2703}let m1_2560: bitstring = (SPc_2557,gNc_2559) in
                                                {2704}out(c, (pkCli_2482,m1_2560,sign(m1_2560,skCli_2481)));
                                                {2705}event beginCli(Cli,Sess,gNc_2559);
                                                {2706}in(c, (PartS_2561: bitstring,sigPartS_2562: bitstring));
                                                {2707}if (verify(PartS_2561,sigPartS_2562,pkSess_2554) <> true) then
                                                    0
                                                else
                                                    {2708}event endCli(Sess,Cli,PartS_2561)
                                            )
                                            else
                                                {2709}let v_2563: bool = (Sess = B) in
                                                (
                                                    {2710}if v_2563 then
                                                    (
                                                        {2711}let pkSess_2564: bitstring = pub(skB) in
                                                        {2712}out(c, GetEndpointRequest);
                                                        {2713}in(c, (SPs_2565: bitstring,=Sign,UP_2566: bitstring,=pkSess_2564));
                                                        {2714}new SPc_2567: bitstring;
                                                        {2715}new Nc_2568: bitstring;
                                                        {2716}let gNc_2569: bitstring = exp(g,Nc_2568) in
                                                        {2717}let m1_2570: bitstring = (SPc_2567,gNc_2569) in
                                                        {2718}out(c, (pkCli_2482,m1_2570,sign(m1_2570,skCli_2481)));
                                                        {2719}event beginCli(Cli,Sess,gNc_2569);
                                                        {2720}in(c, (PartS_2571: bitstring,sigPartS_2572: bitstring));
                                                        {2721}if (verify(PartS_2571,sigPartS_2572,pkSess_2564) <> true) then
                                                            0
                                                        else
                                                            {2722}event endCli(Sess,Cli,PartS_2571)
                                                    )
                                                    else
                                                        {2723}let v_2573: bool = (Sess = C) in
                                                        (
                                                            {2724}if v_2573 then
                                                            (
                                                                {2725}let pkSess_2574: bitstring = pub(skC) in
                                                                {2726}out(c, GetEndpointRequest);
                                                                {2727}in(c, (SPs_2575: bitstring,=Sign,UP_2576: bitstring,=pkSess_2574));
                                                                {2728}new SPc_2577: bitstring;
                                                                {2729}new Nc_2578: bitstring;
                                                                {2730}let gNc_2579: bitstring = exp(g,Nc_2578) in
                                                                {2731}let m1_2580: bitstring = (SPc_2577,gNc_2579) in
                                                                {2732}out(c, (pkCli_2482,m1_2580,sign(m1_2580,skCli_2481)));
                                                                {2733}event beginCli(Cli,Sess,gNc_2579);
                                                                {2734}in(c, (PartS_2581: bitstring,sigPartS_2582: bitstring));
                                                                {2735}if (verify(PartS_2581,sigPartS_2582,pkSess_2574) <> true) then
                                                                    0
                                                                else
                                                                    {2736}event endCli(Sess,Cli,PartS_2581)
                                                            )
                                                            else
                                                                {2737}let pkSess_2583: bitstring = pub(skI) in
                                                                {2738}out(c, GetEndpointRequest);
                                                                {2739}in(c, (SPs_2584: bitstring,=Sign,UP_2585: bitstring,=pkSess_2583));
                                                                {2740}new SPc_2586: bitstring;
                                                                {2741}new Nc_2587: bitstring;
                                                                {2742}let gNc_2588: bitstring = exp(g,Nc_2587) in
                                                                {2743}let m1_2589: bitstring = (SPc_2586,gNc_2588) in
                                                                {2744}out(c, (pkCli_2482,m1_2589,sign(m1_2589,skCli_2481)));
                                                                {2745}event beginCli(Cli,Sess,gNc_2588);
                                                                {2746}in(c, (PartS_2590: bitstring,sigPartS_2591: bitstring));
                                                                {2747}if (verify(PartS_2590,sigPartS_2591,pkSess_2583) <> true) then
                                                                    0
                                                                else
                                                                    {2748}event endCli(Sess,Cli,PartS_2590)
                                                        )
                                                        else
                                                            {2749}let pkSess_2592: bitstring = fail-any in
                                                            {2750}out(c, GetEndpointRequest);
                                                            {2751}in(c, (SPs_2593: bitstring,=Sign,UP_2594: bitstring,=pkSess_2592));
                                                            {2752}new SPc_2595: bitstring;
                                                            {2753}new Nc_2596: bitstring;
                                                            {2754}let gNc_2597: bitstring = exp(g,Nc_2596) in
                                                            {2755}let m1_2598: bitstring = (SPc_2595,gNc_2597) in
                                                            {2756}out(c, (pkCli_2482,m1_2598,sign(m1_2598,skCli_2481)));
                                                            {2757}event beginCli(Cli,Sess,gNc_2597);
                                                            {2758}in(c, (PartS_2599: bitstring,sigPartS_2600: bitstring));
                                                            {2759}if (verify(PartS_2599,sigPartS_2600,pkSess_2592) <> true) then
                                                                0
                                                            else
                                                                {2760}event endCli(Sess,Cli,PartS_2599)
                                                )
                                                else
                                                    {2761}let pkSess_2601: bitstring = fail-any in
                                                    {2762}out(c, GetEndpointRequest);
                                                    {2763}in(c, (SPs_2602: bitstring,=Sign,UP_2603: bitstring,=pkSess_2601));
                                                    {2764}new SPc_2604: bitstring;
                                                    {2765}new Nc_2605: bitstring;
                                                    {2766}let gNc_2606: bitstring = exp(g,Nc_2605) in
                                                    {2767}let m1_2607: bitstring = (SPc_2604,gNc_2606) in
                                                    {2768}out(c, (pkCli_2482,m1_2607,sign(m1_2607,skCli_2481)));
                                                    {2769}event beginCli(Cli,Sess,gNc_2606);
                                                    {2770}in(c, (PartS_2608: bitstring,sigPartS_2609: bitstring));
                                                    {2771}if (verify(PartS_2608,sigPartS_2609,pkSess_2601) <> true) then
                                                        0
                                                    else
                                                        {2772}event endCli(Sess,Cli,PartS_2608)
                                        )
                                        else
                                            {2773}let pkSess_2610: bitstring = fail-any in
                                            {2774}out(c, GetEndpointRequest);
                                            {2775}in(c, (SPs_2611: bitstring,=Sign,UP_2612: bitstring,=pkSess_2610));
                                            {2776}new SPc_2613: bitstring;
                                            {2777}new Nc_2614: bitstring;
                                            {2778}let gNc_2615: bitstring = exp(g,Nc_2614) in
                                            {2779}let m1_2616: bitstring = (SPc_2613,gNc_2615) in
                                            {2780}out(c, (pkCli_2482,m1_2616,sign(m1_2616,skCli_2481)));
                                            {2781}event beginCli(Cli,Sess,gNc_2615);
                                            {2782}in(c, (PartS_2617: bitstring,sigPartS_2618: bitstring));
                                            {2783}if (verify(PartS_2617,sigPartS_2618,pkSess_2610) <> true) then
                                                0
                                            else
                                                {2784}event endCli(Sess,Cli,PartS_2617)
                                    )
                                    else
                                        {2785}let v_2619: bool = (Disco = C) in
                                        (
                                            {2786}if v_2619 then
                                            (
                                                {2787}let pkDisco_2620: bitstring = pub(skC) in
                                                {2788}let v_2621: bool = (Sess = A) in
                                                (
                                                    {2789}if v_2621 then
                                                    (
                                                        {2790}let pkSess_2622: bitstring = pub(skA) in
                                                        {2791}out(c, GetEndpointRequest);
                                                        {2792}in(c, (SPs_2623: bitstring,=Sign,UP_2624: bitstring,=pkSess_2622));
                                                        {2793}new SPc_2625: bitstring;
                                                        {2794}new Nc_2626: bitstring;
                                                        {2795}let gNc_2627: bitstring = exp(g,Nc_2626) in
                                                        {2796}let m1_2628: bitstring = (SPc_2625,gNc_2627) in
                                                        {2797}out(c, (pkCli_2482,m1_2628,sign(m1_2628,skCli_2481)));
                                                        {2798}event beginCli(Cli,Sess,gNc_2627);
                                                        {2799}in(c, (PartS_2629: bitstring,sigPartS_2630: bitstring));
                                                        {2800}if (verify(PartS_2629,sigPartS_2630,pkSess_2622) <> true) then
                                                            0
                                                        else
                                                            {2801}event endCli(Sess,Cli,PartS_2629)
                                                    )
                                                    else
                                                        {2802}let v_2631: bool = (Sess = B) in
                                                        (
                                                            {2803}if v_2631 then
                                                            (
                                                                {2804}let pkSess_2632: bitstring = pub(skB) in
                                                                {2805}out(c, GetEndpointRequest);
                                                                {2806}in(c, (SPs_2633: bitstring,=Sign,UP_2634: bitstring,=pkSess_2632));
                                                                {2807}new SPc_2635: bitstring;
                                                                {2808}new Nc_2636: bitstring;
                                                                {2809}let gNc_2637: bitstring = exp(g,Nc_2636) in
                                                                {2810}let m1_2638: bitstring = (SPc_2635,gNc_2637) in
                                                                {2811}out(c, (pkCli_2482,m1_2638,sign(m1_2638,skCli_2481)));
                                                                {2812}event beginCli(Cli,Sess,gNc_2637);
                                                                {2813}in(c, (PartS_2639: bitstring,sigPartS_2640: bitstring));
                                                                {2814}if (verify(PartS_2639,sigPartS_2640,pkSess_2632) <> true) then
                                                                    0
                                                                else
                                                                    {2815}event endCli(Sess,Cli,PartS_2639)
                                                            )
                                                            else
                                                                {2816}let v_2641: bool = (Sess = C) in
                                                                (
                                                                    {2817}if v_2641 then
                                                                    (
                                                                        {2818}let pkSess_2642: bitstring = pub(skC) in
                                                                        {2819}out(c, GetEndpointRequest);
                                                                        {2820}in(c, (SPs_2643: bitstring,=Sign,UP_2644: bitstring,=pkSess_2642));
                                                                        {2821}new SPc_2645: bitstring;
                                                                        {2822}new Nc_2646: bitstring;
                                                                        {2823}let gNc_2647: bitstring = exp(g,Nc_2646) in
                                                                        {2824}let m1_2648: bitstring = (SPc_2645,gNc_2647) in
                                                                        {2825}out(c, (pkCli_2482,m1_2648,sign(m1_2648,skCli_2481)));
                                                                        {2826}event beginCli(Cli,Sess,gNc_2647);
                                                                        {2827}in(c, (PartS_2649: bitstring,sigPartS_2650: bitstring));
                                                                        {2828}if (verify(PartS_2649,sigPartS_2650,pkSess_2642) <> true) then
                                                                            0
                                                                        else
                                                                            {2829}event endCli(Sess,Cli,PartS_2649)
                                                                    )
                                                                    else
                                                                        {2830}let pkSess_2651: bitstring = pub(skI) in
                                                                        {2831}out(c, GetEndpointRequest);
                                                                        {2832}in(c, (SPs_2652: bitstring,=Sign,UP_2653: bitstring,=pkSess_2651));
                                                                        {2833}new SPc_2654: bitstring;
                                                                        {2834}new Nc_2655: bitstring;
                                                                        {2835}let gNc_2656: bitstring = exp(g,Nc_2655) in
                                                                        {2836}let m1_2657: bitstring = (SPc_2654,gNc_2656) in
                                                                        {2837}out(c, (pkCli_2482,m1_2657,sign(m1_2657,skCli_2481)));
                                                                        {2838}event beginCli(Cli,Sess,gNc_2656);
                                                                        {2839}in(c, (PartS_2658: bitstring,sigPartS_2659: bitstring));
                                                                        {2840}if (verify(PartS_2658,sigPartS_2659,pkSess_2651) <> true) then
                                                                            0
                                                                        else
                                                                            {2841}event endCli(Sess,Cli,PartS_2658)
                                                                )
                                                                else
                                                                    {2842}let pkSess_2660: bitstring = fail-any in
                                                                    {2843}out(c, GetEndpointRequest);
                                                                    {2844}in(c, (SPs_2661: bitstring,=Sign,UP_2662: bitstring,=pkSess_2660));
                                                                    {2845}new SPc_2663: bitstring;
                                                                    {2846}new Nc_2664: bitstring;
                                                                    {2847}let gNc_2665: bitstring = exp(g,Nc_2664) in
                                                                    {2848}let m1_2666: bitstring = (SPc_2663,gNc_2665) in
                                                                    {2849}out(c, (pkCli_2482,m1_2666,sign(m1_2666,skCli_2481)));
                                                                    {2850}event beginCli(Cli,Sess,gNc_2665);
                                                                    {2851}in(c, (PartS_2667: bitstring,sigPartS_2668: bitstring));
                                                                    {2852}if (verify(PartS_2667,sigPartS_2668,pkSess_2660) <> true) then
                                                                        0
                                                                    else
                                                                        {2853}event endCli(Sess,Cli,PartS_2667)
                                                        )
                                                        else
                                                            {2854}let pkSess_2669: bitstring = fail-any in
                                                            {2855}out(c, GetEndpointRequest);
                                                            {2856}in(c, (SPs_2670: bitstring,=Sign,UP_2671: bitstring,=pkSess_2669));
                                                            {2857}new SPc_2672: bitstring;
                                                            {2858}new Nc_2673: bitstring;
                                                            {2859}let gNc_2674: bitstring = exp(g,Nc_2673) in
                                                            {2860}let m1_2675: bitstring = (SPc_2672,gNc_2674) in
                                                            {2861}out(c, (pkCli_2482,m1_2675,sign(m1_2675,skCli_2481)));
                                                            {2862}event beginCli(Cli,Sess,gNc_2674);
                                                            {2863}in(c, (PartS_2676: bitstring,sigPartS_2677: bitstring));
                                                            {2864}if (verify(PartS_2676,sigPartS_2677,pkSess_2669) <> true) then
                                                                0
                                                            else
                                                                {2865}event endCli(Sess,Cli,PartS_2676)
                                                )
                                                else
                                                    {2866}let pkSess_2678: bitstring = fail-any in
                                                    {2867}out(c, GetEndpointRequest);
                                                    {2868}in(c, (SPs_2679: bitstring,=Sign,UP_2680: bitstring,=pkSess_2678));
                                                    {2869}new SPc_2681: bitstring;
                                                    {2870}new Nc_2682: bitstring;
                                                    {2871}let gNc_2683: bitstring = exp(g,Nc_2682) in
                                                    {2872}let m1_2684: bitstring = (SPc_2681,gNc_2683) in
                                                    {2873}out(c, (pkCli_2482,m1_2684,sign(m1_2684,skCli_2481)));
                                                    {2874}event beginCli(Cli,Sess,gNc_2683);
                                                    {2875}in(c, (PartS_2685: bitstring,sigPartS_2686: bitstring));
                                                    {2876}if (verify(PartS_2685,sigPartS_2686,pkSess_2678) <> true) then
                                                        0
                                                    else
                                                        {2877}event endCli(Sess,Cli,PartS_2685)
                                            )
                                            else
                                                {2878}let pkDisco_2687: bitstring = pub(skI) in
                                                {2879}let v_2688: bool = (Sess = A) in
                                                (
                                                    {2880}if v_2688 then
                                                    (
                                                        {2881}let pkSess_2689: bitstring = pub(skA) in
                                                        {2882}out(c, GetEndpointRequest);
                                                        {2883}in(c, (SPs_2690: bitstring,=Sign,UP_2691: bitstring,=pkSess_2689));
                                                        {2884}new SPc_2692: bitstring;
                                                        {2885}new Nc_2693: bitstring;
                                                        {2886}let gNc_2694: bitstring = exp(g,Nc_2693) in
                                                        {2887}let m1_2695: bitstring = (SPc_2692,gNc_2694) in
                                                        {2888}out(c, (pkCli_2482,m1_2695,sign(m1_2695,skCli_2481)));
                                                        {2889}event beginCli(Cli,Sess,gNc_2694);
                                                        {2890}in(c, (PartS_2696: bitstring,sigPartS_2697: bitstring));
                                                        {2891}if (verify(PartS_2696,sigPartS_2697,pkSess_2689) <> true) then
                                                            0
                                                        else
                                                            {2892}event endCli(Sess,Cli,PartS_2696)
                                                    )
                                                    else
                                                        {2893}let v_2698: bool = (Sess = B) in
                                                        (
                                                            {2894}if v_2698 then
                                                            (
                                                                {2895}let pkSess_2699: bitstring = pub(skB) in
                                                                {2896}out(c, GetEndpointRequest);
                                                                {2897}in(c, (SPs_2700: bitstring,=Sign,UP_2701: bitstring,=pkSess_2699));
                                                                {2898}new SPc_2702: bitstring;
                                                                {2899}new Nc_2703: bitstring;
                                                                {2900}let gNc_2704: bitstring = exp(g,Nc_2703) in
                                                                {2901}let m1_2705: bitstring = (SPc_2702,gNc_2704) in
                                                                {2902}out(c, (pkCli_2482,m1_2705,sign(m1_2705,skCli_2481)));
                                                                {2903}event beginCli(Cli,Sess,gNc_2704);
                                                                {2904}in(c, (PartS_2706: bitstring,sigPartS_2707: bitstring));
                                                                {2905}if (verify(PartS_2706,sigPartS_2707,pkSess_2699) <> true) then
                                                                    0
                                                                else
                                                                    {2906}event endCli(Sess,Cli,PartS_2706)
                                                            )
                                                            else
                                                                {2907}let v_2708: bool = (Sess = C) in
                                                                (
                                                                    {2908}if v_2708 then
                                                                    (
                                                                        {2909}let pkSess_2709: bitstring = pub(skC) in
                                                                        {2910}out(c, GetEndpointRequest);
                                                                        {2911}in(c, (SPs_2710: bitstring,=Sign,UP_2711: bitstring,=pkSess_2709));
                                                                        {2912}new SPc_2712: bitstring;
                                                                        {2913}new Nc_2713: bitstring;
                                                                        {2914}let gNc_2714: bitstring = exp(g,Nc_2713) in
                                                                        {2915}let m1_2715: bitstring = (SPc_2712,gNc_2714) in
                                                                        {2916}out(c, (pkCli_2482,m1_2715,sign(m1_2715,skCli_2481)));
                                                                        {2917}event beginCli(Cli,Sess,gNc_2714);
                                                                        {2918}in(c, (PartS_2716: bitstring,sigPartS_2717: bitstring));
                                                                        {2919}if (verify(PartS_2716,sigPartS_2717,pkSess_2709) <> true) then
                                                                            0
                                                                        else
                                                                            {2920}event endCli(Sess,Cli,PartS_2716)
                                                                    )
                                                                    else
                                                                        {2921}let pkSess_2718: bitstring = pub(skI) in
                                                                        {2922}out(c, GetEndpointRequest);
                                                                        {2923}in(c, (SPs_2719: bitstring,=Sign,UP_2720: bitstring,=pkSess_2718));
                                                                        {2924}new SPc_2721: bitstring;
                                                                        {2925}new Nc_2722: bitstring;
                                                                        {2926}let gNc_2723: bitstring = exp(g,Nc_2722) in
                                                                        {2927}let m1_2724: bitstring = (SPc_2721,gNc_2723) in
                                                                        {2928}out(c, (pkCli_2482,m1_2724,sign(m1_2724,skCli_2481)));
                                                                        {2929}event beginCli(Cli,Sess,gNc_2723);
                                                                        {2930}in(c, (PartS_2725: bitstring,sigPartS_2726: bitstring));
                                                                        {2931}if (verify(PartS_2725,sigPartS_2726,pkSess_2718) <> true) then
                                                                            0
                                                                        else
                                                                            {2932}event endCli(Sess,Cli,PartS_2725)
                                                                )
                                                                else
                                                                    {2933}let pkSess_2727: bitstring = fail-any in
                                                                    {2934}out(c, GetEndpointRequest);
                                                                    {2935}in(c, (SPs_2728: bitstring,=Sign,UP_2729: bitstring,=pkSess_2727));
                                                                    {2936}new SPc_2730: bitstring;
                                                                    {2937}new Nc_2731: bitstring;
                                                                    {2938}let gNc_2732: bitstring = exp(g,Nc_2731) in
                                                                    {2939}let m1_2733: bitstring = (SPc_2730,gNc_2732) in
                                                                    {2940}out(c, (pkCli_2482,m1_2733,sign(m1_2733,skCli_2481)));
                                                                    {2941}event beginCli(Cli,Sess,gNc_2732);
                                                                    {2942}in(c, (PartS_2734: bitstring,sigPartS_2735: bitstring));
                                                                    {2943}if (verify(PartS_2734,sigPartS_2735,pkSess_2727) <> true) then
                                                                        0
                                                                    else
                                                                        {2944}event endCli(Sess,Cli,PartS_2734)
                                                        )
                                                        else
                                                            {2945}let pkSess_2736: bitstring = fail-any in
                                                            {2946}out(c, GetEndpointRequest);
                                                            {2947}in(c, (SPs_2737: bitstring,=Sign,UP_2738: bitstring,=pkSess_2736));
                                                            {2948}new SPc_2739: bitstring;
                                                            {2949}new Nc_2740: bitstring;
                                                            {2950}let gNc_2741: bitstring = exp(g,Nc_2740) in
                                                            {2951}let m1_2742: bitstring = (SPc_2739,gNc_2741) in
                                                            {2952}out(c, (pkCli_2482,m1_2742,sign(m1_2742,skCli_2481)));
                                                            {2953}event beginCli(Cli,Sess,gNc_2741);
                                                            {2954}in(c, (PartS_2743: bitstring,sigPartS_2744: bitstring));
                                                            {2955}if (verify(PartS_2743,sigPartS_2744,pkSess_2736) <> true) then
                                                                0
                                                            else
                                                                {2956}event endCli(Sess,Cli,PartS_2743)
                                                )
                                                else
                                                    {2957}let pkSess_2745: bitstring = fail-any in
                                                    {2958}out(c, GetEndpointRequest);
                                                    {2959}in(c, (SPs_2746: bitstring,=Sign,UP_2747: bitstring,=pkSess_2745));
                                                    {2960}new SPc_2748: bitstring;
                                                    {2961}new Nc_2749: bitstring;
                                                    {2962}let gNc_2750: bitstring = exp(g,Nc_2749) in
                                                    {2963}let m1_2751: bitstring = (SPc_2748,gNc_2750) in
                                                    {2964}out(c, (pkCli_2482,m1_2751,sign(m1_2751,skCli_2481)));
                                                    {2965}event beginCli(Cli,Sess,gNc_2750);
                                                    {2966}in(c, (PartS_2752: bitstring,sigPartS_2753: bitstring));
                                                    {2967}if (verify(PartS_2752,sigPartS_2753,pkSess_2745) <> true) then
                                                        0
                                                    else
                                                        {2968}event endCli(Sess,Cli,PartS_2752)
                                        )
                                        else
                                            {2969}let pkDisco_2754: bitstring = fail-any in
                                            {2970}let v_2755: bool = (Sess = A) in
                                            (
                                                {2971}if v_2755 then
                                                (
                                                    {2972}let pkSess_2756: bitstring = pub(skA) in
                                                    {2973}out(c, GetEndpointRequest);
                                                    {2974}in(c, (SPs_2757: bitstring,=Sign,UP_2758: bitstring,=pkSess_2756));
                                                    {2975}new SPc_2759: bitstring;
                                                    {2976}new Nc_2760: bitstring;
                                                    {2977}let gNc_2761: bitstring = exp(g,Nc_2760) in
                                                    {2978}let m1_2762: bitstring = (SPc_2759,gNc_2761) in
                                                    {2979}out(c, (pkCli_2482,m1_2762,sign(m1_2762,skCli_2481)));
                                                    {2980}event beginCli(Cli,Sess,gNc_2761);
                                                    {2981}in(c, (PartS_2763: bitstring,sigPartS_2764: bitstring));
                                                    {2982}if (verify(PartS_2763,sigPartS_2764,pkSess_2756) <> true) then
                                                        0
                                                    else
                                                        {2983}event endCli(Sess,Cli,PartS_2763)
                                                )
                                                else
                                                    {2984}let v_2765: bool = (Sess = B) in
                                                    (
                                                        {2985}if v_2765 then
                                                        (
                                                            {2986}let pkSess_2766: bitstring = pub(skB) in
                                                            {2987}out(c, GetEndpointRequest);
                                                            {2988}in(c, (SPs_2767: bitstring,=Sign,UP_2768: bitstring,=pkSess_2766));
                                                            {2989}new SPc_2769: bitstring;
                                                            {2990}new Nc_2770: bitstring;
                                                            {2991}let gNc_2771: bitstring = exp(g,Nc_2770) in
                                                            {2992}let m1_2772: bitstring = (SPc_2769,gNc_2771) in
                                                            {2993}out(c, (pkCli_2482,m1_2772,sign(m1_2772,skCli_2481)));
                                                            {2994}event beginCli(Cli,Sess,gNc_2771);
                                                            {2995}in(c, (PartS_2773: bitstring,sigPartS_2774: bitstring));
                                                            {2996}if (verify(PartS_2773,sigPartS_2774,pkSess_2766) <> true) then
                                                                0
                                                            else
                                                                {2997}event endCli(Sess,Cli,PartS_2773)
                                                        )
                                                        else
                                                            {2998}let v_2775: bool = (Sess = C) in
                                                            (
                                                                {2999}if v_2775 then
                                                                (
                                                                    {3000}let pkSess_2776: bitstring = pub(skC) in
                                                                    {3001}out(c, GetEndpointRequest);
                                                                    {3002}in(c, (SPs_2777: bitstring,=Sign,UP_2778: bitstring,=pkSess_2776));
                                                                    {3003}new SPc_2779: bitstring;
                                                                    {3004}new Nc_2780: bitstring;
                                                                    {3005}let gNc_2781: bitstring = exp(g,Nc_2780) in
                                                                    {3006}let m1_2782: bitstring = (SPc_2779,gNc_2781) in
                                                                    {3007}out(c, (pkCli_2482,m1_2782,sign(m1_2782,skCli_2481)));
                                                                    {3008}event beginCli(Cli,Sess,gNc_2781);
                                                                    {3009}in(c, (PartS_2783: bitstring,sigPartS_2784: bitstring));
                                                                    {3010}if (verify(PartS_2783,sigPartS_2784,pkSess_2776) <> true) then
                                                                        0
                                                                    else
                                                                        {3011}event endCli(Sess,Cli,PartS_2783)
                                                                )
                                                                else
                                                                    {3012}let pkSess_2785: bitstring = pub(skI) in
                                                                    {3013}out(c, GetEndpointRequest);
                                                                    {3014}in(c, (SPs_2786: bitstring,=Sign,UP_2787: bitstring,=pkSess_2785));
                                                                    {3015}new SPc_2788: bitstring;
                                                                    {3016}new Nc_2789: bitstring;
                                                                    {3017}let gNc_2790: bitstring = exp(g,Nc_2789) in
                                                                    {3018}let m1_2791: bitstring = (SPc_2788,gNc_2790) in
                                                                    {3019}out(c, (pkCli_2482,m1_2791,sign(m1_2791,skCli_2481)));
                                                                    {3020}event beginCli(Cli,Sess,gNc_2790);
                                                                    {3021}in(c, (PartS_2792: bitstring,sigPartS_2793: bitstring));
                                                                    {3022}if (verify(PartS_2792,sigPartS_2793,pkSess_2785) <> true) then
                                                                        0
                                                                    else
                                                                        {3023}event endCli(Sess,Cli,PartS_2792)
                                                            )
                                                            else
                                                                {3024}let pkSess_2794: bitstring = fail-any in
                                                                {3025}out(c, GetEndpointRequest);
                                                                {3026}in(c, (SPs_2795: bitstring,=Sign,UP_2796: bitstring,=pkSess_2794));
                                                                {3027}new SPc_2797: bitstring;
                                                                {3028}new Nc_2798: bitstring;
                                                                {3029}let gNc_2799: bitstring = exp(g,Nc_2798) in
                                                                {3030}let m1_2800: bitstring = (SPc_2797,gNc_2799) in
                                                                {3031}out(c, (pkCli_2482,m1_2800,sign(m1_2800,skCli_2481)));
                                                                {3032}event beginCli(Cli,Sess,gNc_2799);
                                                                {3033}in(c, (PartS_2801: bitstring,sigPartS_2802: bitstring));
                                                                {3034}if (verify(PartS_2801,sigPartS_2802,pkSess_2794) <> true) then
                                                                    0
                                                                else
                                                                    {3035}event endCli(Sess,Cli,PartS_2801)
                                                    )
                                                    else
                                                        {3036}let pkSess_2803: bitstring = fail-any in
                                                        {3037}out(c, GetEndpointRequest);
                                                        {3038}in(c, (SPs_2804: bitstring,=Sign,UP_2805: bitstring,=pkSess_2803));
                                                        {3039}new SPc_2806: bitstring;
                                                        {3040}new Nc_2807: bitstring;
                                                        {3041}let gNc_2808: bitstring = exp(g,Nc_2807) in
                                                        {3042}let m1_2809: bitstring = (SPc_2806,gNc_2808) in
                                                        {3043}out(c, (pkCli_2482,m1_2809,sign(m1_2809,skCli_2481)));
                                                        {3044}event beginCli(Cli,Sess,gNc_2808);
                                                        {3045}in(c, (PartS_2810: bitstring,sigPartS_2811: bitstring));
                                                        {3046}if (verify(PartS_2810,sigPartS_2811,pkSess_2803) <> true) then
                                                            0
                                                        else
                                                            {3047}event endCli(Sess,Cli,PartS_2810)
                                            )
                                            else
                                                {3048}let pkSess_2812: bitstring = fail-any in
                                                {3049}out(c, GetEndpointRequest);
                                                {3050}in(c, (SPs_2813: bitstring,=Sign,UP_2814: bitstring,=pkSess_2812));
                                                {3051}new SPc_2815: bitstring;
                                                {3052}new Nc_2816: bitstring;
                                                {3053}let gNc_2817: bitstring = exp(g,Nc_2816) in
                                                {3054}let m1_2818: bitstring = (SPc_2815,gNc_2817) in
                                                {3055}out(c, (pkCli_2482,m1_2818,sign(m1_2818,skCli_2481)));
                                                {3056}event beginCli(Cli,Sess,gNc_2817);
                                                {3057}in(c, (PartS_2819: bitstring,sigPartS_2820: bitstring));
                                                {3058}if (verify(PartS_2819,sigPartS_2820,pkSess_2812) <> true) then
                                                    0
                                                else
                                                    {3059}event endCli(Sess,Cli,PartS_2819)
                                )
                                else
                                    {3060}let pkDisco_2821: bitstring = fail-any in
                                    {3061}let v_2822: bool = (Sess = A) in
                                    (
                                        {3062}if v_2822 then
                                        (
                                            {3063}let pkSess_2823: bitstring = pub(skA) in
                                            {3064}out(c, GetEndpointRequest);
                                            {3065}in(c, (SPs_2824: bitstring,=Sign,UP_2825: bitstring,=pkSess_2823));
                                            {3066}new SPc_2826: bitstring;
                                            {3067}new Nc_2827: bitstring;
                                            {3068}let gNc_2828: bitstring = exp(g,Nc_2827) in
                                            {3069}let m1_2829: bitstring = (SPc_2826,gNc_2828) in
                                            {3070}out(c, (pkCli_2482,m1_2829,sign(m1_2829,skCli_2481)));
                                            {3071}event beginCli(Cli,Sess,gNc_2828);
                                            {3072}in(c, (PartS_2830: bitstring,sigPartS_2831: bitstring));
                                            {3073}if (verify(PartS_2830,sigPartS_2831,pkSess_2823) <> true) then
                                                0
                                            else
                                                {3074}event endCli(Sess,Cli,PartS_2830)
                                        )
                                        else
                                            {3075}let v_2832: bool = (Sess = B) in
                                            (
                                                {3076}if v_2832 then
                                                (
                                                    {3077}let pkSess_2833: bitstring = pub(skB) in
                                                    {3078}out(c, GetEndpointRequest);
                                                    {3079}in(c, (SPs_2834: bitstring,=Sign,UP_2835: bitstring,=pkSess_2833));
                                                    {3080}new SPc_2836: bitstring;
                                                    {3081}new Nc_2837: bitstring;
                                                    {3082}let gNc_2838: bitstring = exp(g,Nc_2837) in
                                                    {3083}let m1_2839: bitstring = (SPc_2836,gNc_2838) in
                                                    {3084}out(c, (pkCli_2482,m1_2839,sign(m1_2839,skCli_2481)));
                                                    {3085}event beginCli(Cli,Sess,gNc_2838);
                                                    {3086}in(c, (PartS_2840: bitstring,sigPartS_2841: bitstring));
                                                    {3087}if (verify(PartS_2840,sigPartS_2841,pkSess_2833) <> true) then
                                                        0
                                                    else
                                                        {3088}event endCli(Sess,Cli,PartS_2840)
                                                )
                                                else
                                                    {3089}let v_2842: bool = (Sess = C) in
                                                    (
                                                        {3090}if v_2842 then
                                                        (
                                                            {3091}let pkSess_2843: bitstring = pub(skC) in
                                                            {3092}out(c, GetEndpointRequest);
                                                            {3093}in(c, (SPs_2844: bitstring,=Sign,UP_2845: bitstring,=pkSess_2843));
                                                            {3094}new SPc_2846: bitstring;
                                                            {3095}new Nc_2847: bitstring;
                                                            {3096}let gNc_2848: bitstring = exp(g,Nc_2847) in
                                                            {3097}let m1_2849: bitstring = (SPc_2846,gNc_2848) in
                                                            {3098}out(c, (pkCli_2482,m1_2849,sign(m1_2849,skCli_2481)));
                                                            {3099}event beginCli(Cli,Sess,gNc_2848);
                                                            {3100}in(c, (PartS_2850: bitstring,sigPartS_2851: bitstring));
                                                            {3101}if (verify(PartS_2850,sigPartS_2851,pkSess_2843) <> true) then
                                                                0
                                                            else
                                                                {3102}event endCli(Sess,Cli,PartS_2850)
                                                        )
                                                        else
                                                            {3103}let pkSess_2852: bitstring = pub(skI) in
                                                            {3104}out(c, GetEndpointRequest);
                                                            {3105}in(c, (SPs_2853: bitstring,=Sign,UP_2854: bitstring,=pkSess_2852));
                                                            {3106}new SPc_2855: bitstring;
                                                            {3107}new Nc_2856: bitstring;
                                                            {3108}let gNc_2857: bitstring = exp(g,Nc_2856) in
                                                            {3109}let m1_2858: bitstring = (SPc_2855,gNc_2857) in
                                                            {3110}out(c, (pkCli_2482,m1_2858,sign(m1_2858,skCli_2481)));
                                                            {3111}event beginCli(Cli,Sess,gNc_2857);
                                                            {3112}in(c, (PartS_2859: bitstring,sigPartS_2860: bitstring));
                                                            {3113}if (verify(PartS_2859,sigPartS_2860,pkSess_2852) <> true) then
                                                                0
                                                            else
                                                                {3114}event endCli(Sess,Cli,PartS_2859)
                                                    )
                                                    else
                                                        {3115}let pkSess_2861: bitstring = fail-any in
                                                        {3116}out(c, GetEndpointRequest);
                                                        {3117}in(c, (SPs_2862: bitstring,=Sign,UP_2863: bitstring,=pkSess_2861));
                                                        {3118}new SPc_2864: bitstring;
                                                        {3119}new Nc_2865: bitstring;
                                                        {3120}let gNc_2866: bitstring = exp(g,Nc_2865) in
                                                        {3121}let m1_2867: bitstring = (SPc_2864,gNc_2866) in
                                                        {3122}out(c, (pkCli_2482,m1_2867,sign(m1_2867,skCli_2481)));
                                                        {3123}event beginCli(Cli,Sess,gNc_2866);
                                                        {3124}in(c, (PartS_2868: bitstring,sigPartS_2869: bitstring));
                                                        {3125}if (verify(PartS_2868,sigPartS_2869,pkSess_2861) <> true) then
                                                            0
                                                        else
                                                            {3126}event endCli(Sess,Cli,PartS_2868)
                                            )
                                            else
                                                {3127}let pkSess_2870: bitstring = fail-any in
                                                {3128}out(c, GetEndpointRequest);
                                                {3129}in(c, (SPs_2871: bitstring,=Sign,UP_2872: bitstring,=pkSess_2870));
                                                {3130}new SPc_2873: bitstring;
                                                {3131}new Nc_2874: bitstring;
                                                {3132}let gNc_2875: bitstring = exp(g,Nc_2874) in
                                                {3133}let m1_2876: bitstring = (SPc_2873,gNc_2875) in
                                                {3134}out(c, (pkCli_2482,m1_2876,sign(m1_2876,skCli_2481)));
                                                {3135}event beginCli(Cli,Sess,gNc_2875);
                                                {3136}in(c, (PartS_2877: bitstring,sigPartS_2878: bitstring));
                                                {3137}if (verify(PartS_2877,sigPartS_2878,pkSess_2870) <> true) then
                                                    0
                                                else
                                                    {3138}event endCli(Sess,Cli,PartS_2877)
                                    )
                                    else
                                        {3139}let pkSess_2879: bitstring = fail-any in
                                        {3140}out(c, GetEndpointRequest);
                                        {3141}in(c, (SPs_2880: bitstring,=Sign,UP_2881: bitstring,=pkSess_2879));
                                        {3142}new SPc_2882: bitstring;
                                        {3143}new Nc_2883: bitstring;
                                        {3144}let gNc_2884: bitstring = exp(g,Nc_2883) in
                                        {3145}let m1_2885: bitstring = (SPc_2882,gNc_2884) in
                                        {3146}out(c, (pkCli_2482,m1_2885,sign(m1_2885,skCli_2481)));
                                        {3147}event beginCli(Cli,Sess,gNc_2884);
                                        {3148}in(c, (PartS_2886: bitstring,sigPartS_2887: bitstring));
                                        {3149}if (verify(PartS_2886,sigPartS_2887,pkSess_2879) <> true) then
                                            0
                                        else
                                            {3150}event endCli(Sess,Cli,PartS_2886)
                        )
                        else
                            {3151}let pkDisco_2888: bitstring = fail-any in
                            {3152}let v_2889: bool = (Sess = A) in
                            (
                                {3153}if v_2889 then
                                (
                                    {3154}let pkSess_2890: bitstring = pub(skA) in
                                    {3155}out(c, GetEndpointRequest);
                                    {3156}in(c, (SPs_2891: bitstring,=Sign,UP_2892: bitstring,=pkSess_2890));
                                    {3157}new SPc_2893: bitstring;
                                    {3158}new Nc_2894: bitstring;
                                    {3159}let gNc_2895: bitstring = exp(g,Nc_2894) in
                                    {3160}let m1_2896: bitstring = (SPc_2893,gNc_2895) in
                                    {3161}out(c, (pkCli_2482,m1_2896,sign(m1_2896,skCli_2481)));
                                    {3162}event beginCli(Cli,Sess,gNc_2895);
                                    {3163}in(c, (PartS_2897: bitstring,sigPartS_2898: bitstring));
                                    {3164}if (verify(PartS_2897,sigPartS_2898,pkSess_2890) <> true) then
                                        0
                                    else
                                        {3165}event endCli(Sess,Cli,PartS_2897)
                                )
                                else
                                    {3166}let v_2899: bool = (Sess = B) in
                                    (
                                        {3167}if v_2899 then
                                        (
                                            {3168}let pkSess_2900: bitstring = pub(skB) in
                                            {3169}out(c, GetEndpointRequest);
                                            {3170}in(c, (SPs_2901: bitstring,=Sign,UP_2902: bitstring,=pkSess_2900));
                                            {3171}new SPc_2903: bitstring;
                                            {3172}new Nc_2904: bitstring;
                                            {3173}let gNc_2905: bitstring = exp(g,Nc_2904) in
                                            {3174}let m1_2906: bitstring = (SPc_2903,gNc_2905) in
                                            {3175}out(c, (pkCli_2482,m1_2906,sign(m1_2906,skCli_2481)));
                                            {3176}event beginCli(Cli,Sess,gNc_2905);
                                            {3177}in(c, (PartS_2907: bitstring,sigPartS_2908: bitstring));
                                            {3178}if (verify(PartS_2907,sigPartS_2908,pkSess_2900) <> true) then
                                                0
                                            else
                                                {3179}event endCli(Sess,Cli,PartS_2907)
                                        )
                                        else
                                            {3180}let v_2909: bool = (Sess = C) in
                                            (
                                                {3181}if v_2909 then
                                                (
                                                    {3182}let pkSess_2910: bitstring = pub(skC) in
                                                    {3183}out(c, GetEndpointRequest);
                                                    {3184}in(c, (SPs_2911: bitstring,=Sign,UP_2912: bitstring,=pkSess_2910));
                                                    {3185}new SPc_2913: bitstring;
                                                    {3186}new Nc_2914: bitstring;
                                                    {3187}let gNc_2915: bitstring = exp(g,Nc_2914) in
                                                    {3188}let m1_2916: bitstring = (SPc_2913,gNc_2915) in
                                                    {3189}out(c, (pkCli_2482,m1_2916,sign(m1_2916,skCli_2481)));
                                                    {3190}event beginCli(Cli,Sess,gNc_2915);
                                                    {3191}in(c, (PartS_2917: bitstring,sigPartS_2918: bitstring));
                                                    {3192}if (verify(PartS_2917,sigPartS_2918,pkSess_2910) <> true) then
                                                        0
                                                    else
                                                        {3193}event endCli(Sess,Cli,PartS_2917)
                                                )
                                                else
                                                    {3194}let pkSess_2919: bitstring = pub(skI) in
                                                    {3195}out(c, GetEndpointRequest);
                                                    {3196}in(c, (SPs_2920: bitstring,=Sign,UP_2921: bitstring,=pkSess_2919));
                                                    {3197}new SPc_2922: bitstring;
                                                    {3198}new Nc_2923: bitstring;
                                                    {3199}let gNc_2924: bitstring = exp(g,Nc_2923) in
                                                    {3200}let m1_2925: bitstring = (SPc_2922,gNc_2924) in
                                                    {3201}out(c, (pkCli_2482,m1_2925,sign(m1_2925,skCli_2481)));
                                                    {3202}event beginCli(Cli,Sess,gNc_2924);
                                                    {3203}in(c, (PartS_2926: bitstring,sigPartS_2927: bitstring));
                                                    {3204}if (verify(PartS_2926,sigPartS_2927,pkSess_2919) <> true) then
                                                        0
                                                    else
                                                        {3205}event endCli(Sess,Cli,PartS_2926)
                                            )
                                            else
                                                {3206}let pkSess_2928: bitstring = fail-any in
                                                {3207}out(c, GetEndpointRequest);
                                                {3208}in(c, (SPs_2929: bitstring,=Sign,UP_2930: bitstring,=pkSess_2928));
                                                {3209}new SPc_2931: bitstring;
                                                {3210}new Nc_2932: bitstring;
                                                {3211}let gNc_2933: bitstring = exp(g,Nc_2932) in
                                                {3212}let m1_2934: bitstring = (SPc_2931,gNc_2933) in
                                                {3213}out(c, (pkCli_2482,m1_2934,sign(m1_2934,skCli_2481)));
                                                {3214}event beginCli(Cli,Sess,gNc_2933);
                                                {3215}in(c, (PartS_2935: bitstring,sigPartS_2936: bitstring));
                                                {3216}if (verify(PartS_2935,sigPartS_2936,pkSess_2928) <> true) then
                                                    0
                                                else
                                                    {3217}event endCli(Sess,Cli,PartS_2935)
                                    )
                                    else
                                        {3218}let pkSess_2937: bitstring = fail-any in
                                        {3219}out(c, GetEndpointRequest);
                                        {3220}in(c, (SPs_2938: bitstring,=Sign,UP_2939: bitstring,=pkSess_2937));
                                        {3221}new SPc_2940: bitstring;
                                        {3222}new Nc_2941: bitstring;
                                        {3223}let gNc_2942: bitstring = exp(g,Nc_2941) in
                                        {3224}let m1_2943: bitstring = (SPc_2940,gNc_2942) in
                                        {3225}out(c, (pkCli_2482,m1_2943,sign(m1_2943,skCli_2481)));
                                        {3226}event beginCli(Cli,Sess,gNc_2942);
                                        {3227}in(c, (PartS_2944: bitstring,sigPartS_2945: bitstring));
                                        {3228}if (verify(PartS_2944,sigPartS_2945,pkSess_2937) <> true) then
                                            0
                                        else
                                            {3229}event endCli(Sess,Cli,PartS_2944)
                            )
                            else
                                {3230}let pkSess_2946: bitstring = fail-any in
                                {3231}out(c, GetEndpointRequest);
                                {3232}in(c, (SPs_2947: bitstring,=Sign,UP_2948: bitstring,=pkSess_2946));
                                {3233}new SPc_2949: bitstring;
                                {3234}new Nc_2950: bitstring;
                                {3235}let gNc_2951: bitstring = exp(g,Nc_2950) in
                                {3236}let m1_2952: bitstring = (SPc_2949,gNc_2951) in
                                {3237}out(c, (pkCli_2482,m1_2952,sign(m1_2952,skCli_2481)));
                                {3238}event beginCli(Cli,Sess,gNc_2951);
                                {3239}in(c, (PartS_2953: bitstring,sigPartS_2954: bitstring));
                                {3240}if (verify(PartS_2953,sigPartS_2954,pkSess_2946) <> true) then
                                    0
                                else
                                    {3241}event endCli(Sess,Cli,PartS_2953)
            )
            else
                {3242}let skCli_2955: bitstring = fail-any in
                {3243}let pkCli_2956: bitstring = pub(skCli_2955) in
                {3244}let v_2957: bool = (Disco = A) in
                (
                    {3245}if v_2957 then
                    (
                        {3246}let pkDisco_2958: bitstring = pub(skA) in
                        {3247}let v_2959: bool = (Sess = A) in
                        (
                            {3248}if v_2959 then
                            (
                                {3249}let pkSess_2960: bitstring = pub(skA) in
                                {3250}out(c, GetEndpointRequest);
                                {3251}in(c, (SPs_2961: bitstring,=Sign,UP_2962: bitstring,=pkSess_2960));
                                {3252}new SPc_2963: bitstring;
                                {3253}new Nc_2964: bitstring;
                                {3254}let gNc_2965: bitstring = exp(g,Nc_2964) in
                                {3255}let m1_2966: bitstring = (SPc_2963,gNc_2965) in
                                {3256}out(c, (pkCli_2956,m1_2966,sign(m1_2966,skCli_2955)));
                                {3257}event beginCli(Cli,Sess,gNc_2965);
                                {3258}in(c, (PartS_2967: bitstring,sigPartS_2968: bitstring));
                                {3259}if (verify(PartS_2967,sigPartS_2968,pkSess_2960) <> true) then
                                    0
                                else
                                    {3260}event endCli(Sess,Cli,PartS_2967)
                            )
                            else
                                {3261}let v_2969: bool = (Sess = B) in
                                (
                                    {3262}if v_2969 then
                                    (
                                        {3263}let pkSess_2970: bitstring = pub(skB) in
                                        {3264}out(c, GetEndpointRequest);
                                        {3265}in(c, (SPs_2971: bitstring,=Sign,UP_2972: bitstring,=pkSess_2970));
                                        {3266}new SPc_2973: bitstring;
                                        {3267}new Nc_2974: bitstring;
                                        {3268}let gNc_2975: bitstring = exp(g,Nc_2974) in
                                        {3269}let m1_2976: bitstring = (SPc_2973,gNc_2975) in
                                        {3270}out(c, (pkCli_2956,m1_2976,sign(m1_2976,skCli_2955)));
                                        {3271}event beginCli(Cli,Sess,gNc_2975);
                                        {3272}in(c, (PartS_2977: bitstring,sigPartS_2978: bitstring));
                                        {3273}if (verify(PartS_2977,sigPartS_2978,pkSess_2970) <> true) then
                                            0
                                        else
                                            {3274}event endCli(Sess,Cli,PartS_2977)
                                    )
                                    else
                                        {3275}let v_2979: bool = (Sess = C) in
                                        (
                                            {3276}if v_2979 then
                                            (
                                                {3277}let pkSess_2980: bitstring = pub(skC) in
                                                {3278}out(c, GetEndpointRequest);
                                                {3279}in(c, (SPs_2981: bitstring,=Sign,UP_2982: bitstring,=pkSess_2980));
                                                {3280}new SPc_2983: bitstring;
                                                {3281}new Nc_2984: bitstring;
                                                {3282}let gNc_2985: bitstring = exp(g,Nc_2984) in
                                                {3283}let m1_2986: bitstring = (SPc_2983,gNc_2985) in
                                                {3284}out(c, (pkCli_2956,m1_2986,sign(m1_2986,skCli_2955)));
                                                {3285}event beginCli(Cli,Sess,gNc_2985);
                                                {3286}in(c, (PartS_2987: bitstring,sigPartS_2988: bitstring));
                                                {3287}if (verify(PartS_2987,sigPartS_2988,pkSess_2980) <> true) then
                                                    0
                                                else
                                                    {3288}event endCli(Sess,Cli,PartS_2987)
                                            )
                                            else
                                                {3289}let pkSess_2989: bitstring = pub(skI) in
                                                {3290}out(c, GetEndpointRequest);
                                                {3291}in(c, (SPs_2990: bitstring,=Sign,UP_2991: bitstring,=pkSess_2989));
                                                {3292}new SPc_2992: bitstring;
                                                {3293}new Nc_2993: bitstring;
                                                {3294}let gNc_2994: bitstring = exp(g,Nc_2993) in
                                                {3295}let m1_2995: bitstring = (SPc_2992,gNc_2994) in
                                                {3296}out(c, (pkCli_2956,m1_2995,sign(m1_2995,skCli_2955)));
                                                {3297}event beginCli(Cli,Sess,gNc_2994);
                                                {3298}in(c, (PartS_2996: bitstring,sigPartS_2997: bitstring));
                                                {3299}if (verify(PartS_2996,sigPartS_2997,pkSess_2989) <> true) then
                                                    0
                                                else
                                                    {3300}event endCli(Sess,Cli,PartS_2996)
                                        )
                                        else
                                            {3301}let pkSess_2998: bitstring = fail-any in
                                            {3302}out(c, GetEndpointRequest);
                                            {3303}in(c, (SPs_2999: bitstring,=Sign,UP_3000: bitstring,=pkSess_2998));
                                            {3304}new SPc_3001: bitstring;
                                            {3305}new Nc_3002: bitstring;
                                            {3306}let gNc_3003: bitstring = exp(g,Nc_3002) in
                                            {3307}let m1_3004: bitstring = (SPc_3001,gNc_3003) in
                                            {3308}out(c, (pkCli_2956,m1_3004,sign(m1_3004,skCli_2955)));
                                            {3309}event beginCli(Cli,Sess,gNc_3003);
                                            {3310}in(c, (PartS_3005: bitstring,sigPartS_3006: bitstring));
                                            {3311}if (verify(PartS_3005,sigPartS_3006,pkSess_2998) <> true) then
                                                0
                                            else
                                                {3312}event endCli(Sess,Cli,PartS_3005)
                                )
                                else
                                    {3313}let pkSess_3007: bitstring = fail-any in
                                    {3314}out(c, GetEndpointRequest);
                                    {3315}in(c, (SPs_3008: bitstring,=Sign,UP_3009: bitstring,=pkSess_3007));
                                    {3316}new SPc_3010: bitstring;
                                    {3317}new Nc_3011: bitstring;
                                    {3318}let gNc_3012: bitstring = exp(g,Nc_3011) in
                                    {3319}let m1_3013: bitstring = (SPc_3010,gNc_3012) in
                                    {3320}out(c, (pkCli_2956,m1_3013,sign(m1_3013,skCli_2955)));
                                    {3321}event beginCli(Cli,Sess,gNc_3012);
                                    {3322}in(c, (PartS_3014: bitstring,sigPartS_3015: bitstring));
                                    {3323}if (verify(PartS_3014,sigPartS_3015,pkSess_3007) <> true) then
                                        0
                                    else
                                        {3324}event endCli(Sess,Cli,PartS_3014)
                        )
                        else
                            {3325}let pkSess_3016: bitstring = fail-any in
                            {3326}out(c, GetEndpointRequest);
                            {3327}in(c, (SPs_3017: bitstring,=Sign,UP_3018: bitstring,=pkSess_3016));
                            {3328}new SPc_3019: bitstring;
                            {3329}new Nc_3020: bitstring;
                            {3330}let gNc_3021: bitstring = exp(g,Nc_3020) in
                            {3331}let m1_3022: bitstring = (SPc_3019,gNc_3021) in
                            {3332}out(c, (pkCli_2956,m1_3022,sign(m1_3022,skCli_2955)));
                            {3333}event beginCli(Cli,Sess,gNc_3021);
                            {3334}in(c, (PartS_3023: bitstring,sigPartS_3024: bitstring));
                            {3335}if (verify(PartS_3023,sigPartS_3024,pkSess_3016) <> true) then
                                0
                            else
                                {3336}event endCli(Sess,Cli,PartS_3023)
                    )
                    else
                        {3337}let v_3025: bool = (Disco = B) in
                        (
                            {3338}if v_3025 then
                            (
                                {3339}let pkDisco_3026: bitstring = pub(skB) in
                                {3340}let v_3027: bool = (Sess = A) in
                                (
                                    {3341}if v_3027 then
                                    (
                                        {3342}let pkSess_3028: bitstring = pub(skA) in
                                        {3343}out(c, GetEndpointRequest);
                                        {3344}in(c, (SPs_3029: bitstring,=Sign,UP_3030: bitstring,=pkSess_3028));
                                        {3345}new SPc_3031: bitstring;
                                        {3346}new Nc_3032: bitstring;
                                        {3347}let gNc_3033: bitstring = exp(g,Nc_3032) in
                                        {3348}let m1_3034: bitstring = (SPc_3031,gNc_3033) in
                                        {3349}out(c, (pkCli_2956,m1_3034,sign(m1_3034,skCli_2955)));
                                        {3350}event beginCli(Cli,Sess,gNc_3033);
                                        {3351}in(c, (PartS_3035: bitstring,sigPartS_3036: bitstring));
                                        {3352}if (verify(PartS_3035,sigPartS_3036,pkSess_3028) <> true) then
                                            0
                                        else
                                            {3353}event endCli(Sess,Cli,PartS_3035)
                                    )
                                    else
                                        {3354}let v_3037: bool = (Sess = B) in
                                        (
                                            {3355}if v_3037 then
                                            (
                                                {3356}let pkSess_3038: bitstring = pub(skB) in
                                                {3357}out(c, GetEndpointRequest);
                                                {3358}in(c, (SPs_3039: bitstring,=Sign,UP_3040: bitstring,=pkSess_3038));
                                                {3359}new SPc_3041: bitstring;
                                                {3360}new Nc_3042: bitstring;
                                                {3361}let gNc_3043: bitstring = exp(g,Nc_3042) in
                                                {3362}let m1_3044: bitstring = (SPc_3041,gNc_3043) in
                                                {3363}out(c, (pkCli_2956,m1_3044,sign(m1_3044,skCli_2955)));
                                                {3364}event beginCli(Cli,Sess,gNc_3043);
                                                {3365}in(c, (PartS_3045: bitstring,sigPartS_3046: bitstring));
                                                {3366}if (verify(PartS_3045,sigPartS_3046,pkSess_3038) <> true) then
                                                    0
                                                else
                                                    {3367}event endCli(Sess,Cli,PartS_3045)
                                            )
                                            else
                                                {3368}let v_3047: bool = (Sess = C) in
                                                (
                                                    {3369}if v_3047 then
                                                    (
                                                        {3370}let pkSess_3048: bitstring = pub(skC) in
                                                        {3371}out(c, GetEndpointRequest);
                                                        {3372}in(c, (SPs_3049: bitstring,=Sign,UP_3050: bitstring,=pkSess_3048));
                                                        {3373}new SPc_3051: bitstring;
                                                        {3374}new Nc_3052: bitstring;
                                                        {3375}let gNc_3053: bitstring = exp(g,Nc_3052) in
                                                        {3376}let m1_3054: bitstring = (SPc_3051,gNc_3053) in
                                                        {3377}out(c, (pkCli_2956,m1_3054,sign(m1_3054,skCli_2955)));
                                                        {3378}event beginCli(Cli,Sess,gNc_3053);
                                                        {3379}in(c, (PartS_3055: bitstring,sigPartS_3056: bitstring));
                                                        {3380}if (verify(PartS_3055,sigPartS_3056,pkSess_3048) <> true) then
                                                            0
                                                        else
                                                            {3381}event endCli(Sess,Cli,PartS_3055)
                                                    )
                                                    else
                                                        {3382}let pkSess_3057: bitstring = pub(skI) in
                                                        {3383}out(c, GetEndpointRequest);
                                                        {3384}in(c, (SPs_3058: bitstring,=Sign,UP_3059: bitstring,=pkSess_3057));
                                                        {3385}new SPc_3060: bitstring;
                                                        {3386}new Nc_3061: bitstring;
                                                        {3387}let gNc_3062: bitstring = exp(g,Nc_3061) in
                                                        {3388}let m1_3063: bitstring = (SPc_3060,gNc_3062) in
                                                        {3389}out(c, (pkCli_2956,m1_3063,sign(m1_3063,skCli_2955)));
                                                        {3390}event beginCli(Cli,Sess,gNc_3062);
                                                        {3391}in(c, (PartS_3064: bitstring,sigPartS_3065: bitstring));
                                                        {3392}if (verify(PartS_3064,sigPartS_3065,pkSess_3057) <> true) then
                                                            0
                                                        else
                                                            {3393}event endCli(Sess,Cli,PartS_3064)
                                                )
                                                else
                                                    {3394}let pkSess_3066: bitstring = fail-any in
                                                    {3395}out(c, GetEndpointRequest);
                                                    {3396}in(c, (SPs_3067: bitstring,=Sign,UP_3068: bitstring,=pkSess_3066));
                                                    {3397}new SPc_3069: bitstring;
                                                    {3398}new Nc_3070: bitstring;
                                                    {3399}let gNc_3071: bitstring = exp(g,Nc_3070) in
                                                    {3400}let m1_3072: bitstring = (SPc_3069,gNc_3071) in
                                                    {3401}out(c, (pkCli_2956,m1_3072,sign(m1_3072,skCli_2955)));
                                                    {3402}event beginCli(Cli,Sess,gNc_3071);
                                                    {3403}in(c, (PartS_3073: bitstring,sigPartS_3074: bitstring));
                                                    {3404}if (verify(PartS_3073,sigPartS_3074,pkSess_3066) <> true) then
                                                        0
                                                    else
                                                        {3405}event endCli(Sess,Cli,PartS_3073)
                                        )
                                        else
                                            {3406}let pkSess_3075: bitstring = fail-any in
                                            {3407}out(c, GetEndpointRequest);
                                            {3408}in(c, (SPs_3076: bitstring,=Sign,UP_3077: bitstring,=pkSess_3075));
                                            {3409}new SPc_3078: bitstring;
                                            {3410}new Nc_3079: bitstring;
                                            {3411}let gNc_3080: bitstring = exp(g,Nc_3079) in
                                            {3412}let m1_3081: bitstring = (SPc_3078,gNc_3080) in
                                            {3413}out(c, (pkCli_2956,m1_3081,sign(m1_3081,skCli_2955)));
                                            {3414}event beginCli(Cli,Sess,gNc_3080);
                                            {3415}in(c, (PartS_3082: bitstring,sigPartS_3083: bitstring));
                                            {3416}if (verify(PartS_3082,sigPartS_3083,pkSess_3075) <> true) then
                                                0
                                            else
                                                {3417}event endCli(Sess,Cli,PartS_3082)
                                )
                                else
                                    {3418}let pkSess_3084: bitstring = fail-any in
                                    {3419}out(c, GetEndpointRequest);
                                    {3420}in(c, (SPs_3085: bitstring,=Sign,UP_3086: bitstring,=pkSess_3084));
                                    {3421}new SPc_3087: bitstring;
                                    {3422}new Nc_3088: bitstring;
                                    {3423}let gNc_3089: bitstring = exp(g,Nc_3088) in
                                    {3424}let m1_3090: bitstring = (SPc_3087,gNc_3089) in
                                    {3425}out(c, (pkCli_2956,m1_3090,sign(m1_3090,skCli_2955)));
                                    {3426}event beginCli(Cli,Sess,gNc_3089);
                                    {3427}in(c, (PartS_3091: bitstring,sigPartS_3092: bitstring));
                                    {3428}if (verify(PartS_3091,sigPartS_3092,pkSess_3084) <> true) then
                                        0
                                    else
                                        {3429}event endCli(Sess,Cli,PartS_3091)
                            )
                            else
                                {3430}let v_3093: bool = (Disco = C) in
                                (
                                    {3431}if v_3093 then
                                    (
                                        {3432}let pkDisco_3094: bitstring = pub(skC) in
                                        {3433}let v_3095: bool = (Sess = A) in
                                        (
                                            {3434}if v_3095 then
                                            (
                                                {3435}let pkSess_3096: bitstring = pub(skA) in
                                                {3436}out(c, GetEndpointRequest);
                                                {3437}in(c, (SPs_3097: bitstring,=Sign,UP_3098: bitstring,=pkSess_3096));
                                                {3438}new SPc_3099: bitstring;
                                                {3439}new Nc_3100: bitstring;
                                                {3440}let gNc_3101: bitstring = exp(g,Nc_3100) in
                                                {3441}let m1_3102: bitstring = (SPc_3099,gNc_3101) in
                                                {3442}out(c, (pkCli_2956,m1_3102,sign(m1_3102,skCli_2955)));
                                                {3443}event beginCli(Cli,Sess,gNc_3101);
                                                {3444}in(c, (PartS_3103: bitstring,sigPartS_3104: bitstring));
                                                {3445}if (verify(PartS_3103,sigPartS_3104,pkSess_3096) <> true) then
                                                    0
                                                else
                                                    {3446}event endCli(Sess,Cli,PartS_3103)
                                            )
                                            else
                                                {3447}let v_3105: bool = (Sess = B) in
                                                (
                                                    {3448}if v_3105 then
                                                    (
                                                        {3449}let pkSess_3106: bitstring = pub(skB) in
                                                        {3450}out(c, GetEndpointRequest);
                                                        {3451}in(c, (SPs_3107: bitstring,=Sign,UP_3108: bitstring,=pkSess_3106));
                                                        {3452}new SPc_3109: bitstring;
                                                        {3453}new Nc_3110: bitstring;
                                                        {3454}let gNc_3111: bitstring = exp(g,Nc_3110) in
                                                        {3455}let m1_3112: bitstring = (SPc_3109,gNc_3111) in
                                                        {3456}out(c, (pkCli_2956,m1_3112,sign(m1_3112,skCli_2955)));
                                                        {3457}event beginCli(Cli,Sess,gNc_3111);
                                                        {3458}in(c, (PartS_3113: bitstring,sigPartS_3114: bitstring));
                                                        {3459}if (verify(PartS_3113,sigPartS_3114,pkSess_3106) <> true) then
                                                            0
                                                        else
                                                            {3460}event endCli(Sess,Cli,PartS_3113)
                                                    )
                                                    else
                                                        {3461}let v_3115: bool = (Sess = C) in
                                                        (
                                                            {3462}if v_3115 then
                                                            (
                                                                {3463}let pkSess_3116: bitstring = pub(skC) in
                                                                {3464}out(c, GetEndpointRequest);
                                                                {3465}in(c, (SPs_3117: bitstring,=Sign,UP_3118: bitstring,=pkSess_3116));
                                                                {3466}new SPc_3119: bitstring;
                                                                {3467}new Nc_3120: bitstring;
                                                                {3468}let gNc_3121: bitstring = exp(g,Nc_3120) in
                                                                {3469}let m1_3122: bitstring = (SPc_3119,gNc_3121) in
                                                                {3470}out(c, (pkCli_2956,m1_3122,sign(m1_3122,skCli_2955)));
                                                                {3471}event beginCli(Cli,Sess,gNc_3121);
                                                                {3472}in(c, (PartS_3123: bitstring,sigPartS_3124: bitstring));
                                                                {3473}if (verify(PartS_3123,sigPartS_3124,pkSess_3116) <> true) then
                                                                    0
                                                                else
                                                                    {3474}event endCli(Sess,Cli,PartS_3123)
                                                            )
                                                            else
                                                                {3475}let pkSess_3125: bitstring = pub(skI) in
                                                                {3476}out(c, GetEndpointRequest);
                                                                {3477}in(c, (SPs_3126: bitstring,=Sign,UP_3127: bitstring,=pkSess_3125));
                                                                {3478}new SPc_3128: bitstring;
                                                                {3479}new Nc_3129: bitstring;
                                                                {3480}let gNc_3130: bitstring = exp(g,Nc_3129) in
                                                                {3481}let m1_3131: bitstring = (SPc_3128,gNc_3130) in
                                                                {3482}out(c, (pkCli_2956,m1_3131,sign(m1_3131,skCli_2955)));
                                                                {3483}event beginCli(Cli,Sess,gNc_3130);
                                                                {3484}in(c, (PartS_3132: bitstring,sigPartS_3133: bitstring));
                                                                {3485}if (verify(PartS_3132,sigPartS_3133,pkSess_3125) <> true) then
                                                                    0
                                                                else
                                                                    {3486}event endCli(Sess,Cli,PartS_3132)
                                                        )
                                                        else
                                                            {3487}let pkSess_3134: bitstring = fail-any in
                                                            {3488}out(c, GetEndpointRequest);
                                                            {3489}in(c, (SPs_3135: bitstring,=Sign,UP_3136: bitstring,=pkSess_3134));
                                                            {3490}new SPc_3137: bitstring;
                                                            {3491}new Nc_3138: bitstring;
                                                            {3492}let gNc_3139: bitstring = exp(g,Nc_3138) in
                                                            {3493}let m1_3140: bitstring = (SPc_3137,gNc_3139) in
                                                            {3494}out(c, (pkCli_2956,m1_3140,sign(m1_3140,skCli_2955)));
                                                            {3495}event beginCli(Cli,Sess,gNc_3139);
                                                            {3496}in(c, (PartS_3141: bitstring,sigPartS_3142: bitstring));
                                                            {3497}if (verify(PartS_3141,sigPartS_3142,pkSess_3134) <> true) then
                                                                0
                                                            else
                                                                {3498}event endCli(Sess,Cli,PartS_3141)
                                                )
                                                else
                                                    {3499}let pkSess_3143: bitstring = fail-any in
                                                    {3500}out(c, GetEndpointRequest);
                                                    {3501}in(c, (SPs_3144: bitstring,=Sign,UP_3145: bitstring,=pkSess_3143));
                                                    {3502}new SPc_3146: bitstring;
                                                    {3503}new Nc_3147: bitstring;
                                                    {3504}let gNc_3148: bitstring = exp(g,Nc_3147) in
                                                    {3505}let m1_3149: bitstring = (SPc_3146,gNc_3148) in
                                                    {3506}out(c, (pkCli_2956,m1_3149,sign(m1_3149,skCli_2955)));
                                                    {3507}event beginCli(Cli,Sess,gNc_3148);
                                                    {3508}in(c, (PartS_3150: bitstring,sigPartS_3151: bitstring));
                                                    {3509}if (verify(PartS_3150,sigPartS_3151,pkSess_3143) <> true) then
                                                        0
                                                    else
                                                        {3510}event endCli(Sess,Cli,PartS_3150)
                                        )
                                        else
                                            {3511}let pkSess_3152: bitstring = fail-any in
                                            {3512}out(c, GetEndpointRequest);
                                            {3513}in(c, (SPs_3153: bitstring,=Sign,UP_3154: bitstring,=pkSess_3152));
                                            {3514}new SPc_3155: bitstring;
                                            {3515}new Nc_3156: bitstring;
                                            {3516}let gNc_3157: bitstring = exp(g,Nc_3156) in
                                            {3517}let m1_3158: bitstring = (SPc_3155,gNc_3157) in
                                            {3518}out(c, (pkCli_2956,m1_3158,sign(m1_3158,skCli_2955)));
                                            {3519}event beginCli(Cli,Sess,gNc_3157);
                                            {3520}in(c, (PartS_3159: bitstring,sigPartS_3160: bitstring));
                                            {3521}if (verify(PartS_3159,sigPartS_3160,pkSess_3152) <> true) then
                                                0
                                            else
                                                {3522}event endCli(Sess,Cli,PartS_3159)
                                    )
                                    else
                                        {3523}let pkDisco_3161: bitstring = pub(skI) in
                                        {3524}let v_3162: bool = (Sess = A) in
                                        (
                                            {3525}if v_3162 then
                                            (
                                                {3526}let pkSess_3163: bitstring = pub(skA) in
                                                {3527}out(c, GetEndpointRequest);
                                                {3528}in(c, (SPs_3164: bitstring,=Sign,UP_3165: bitstring,=pkSess_3163));
                                                {3529}new SPc_3166: bitstring;
                                                {3530}new Nc_3167: bitstring;
                                                {3531}let gNc_3168: bitstring = exp(g,Nc_3167) in
                                                {3532}let m1_3169: bitstring = (SPc_3166,gNc_3168) in
                                                {3533}out(c, (pkCli_2956,m1_3169,sign(m1_3169,skCli_2955)));
                                                {3534}event beginCli(Cli,Sess,gNc_3168);
                                                {3535}in(c, (PartS_3170: bitstring,sigPartS_3171: bitstring));
                                                {3536}if (verify(PartS_3170,sigPartS_3171,pkSess_3163) <> true) then
                                                    0
                                                else
                                                    {3537}event endCli(Sess,Cli,PartS_3170)
                                            )
                                            else
                                                {3538}let v_3172: bool = (Sess = B) in
                                                (
                                                    {3539}if v_3172 then
                                                    (
                                                        {3540}let pkSess_3173: bitstring = pub(skB) in
                                                        {3541}out(c, GetEndpointRequest);
                                                        {3542}in(c, (SPs_3174: bitstring,=Sign,UP_3175: bitstring,=pkSess_3173));
                                                        {3543}new SPc_3176: bitstring;
                                                        {3544}new Nc_3177: bitstring;
                                                        {3545}let gNc_3178: bitstring = exp(g,Nc_3177) in
                                                        {3546}let m1_3179: bitstring = (SPc_3176,gNc_3178) in
                                                        {3547}out(c, (pkCli_2956,m1_3179,sign(m1_3179,skCli_2955)));
                                                        {3548}event beginCli(Cli,Sess,gNc_3178);
                                                        {3549}in(c, (PartS_3180: bitstring,sigPartS_3181: bitstring));
                                                        {3550}if (verify(PartS_3180,sigPartS_3181,pkSess_3173) <> true) then
                                                            0
                                                        else
                                                            {3551}event endCli(Sess,Cli,PartS_3180)
                                                    )
                                                    else
                                                        {3552}let v_3182: bool = (Sess = C) in
                                                        (
                                                            {3553}if v_3182 then
                                                            (
                                                                {3554}let pkSess_3183: bitstring = pub(skC) in
                                                                {3555}out(c, GetEndpointRequest);
                                                                {3556}in(c, (SPs_3184: bitstring,=Sign,UP_3185: bitstring,=pkSess_3183));
                                                                {3557}new SPc_3186: bitstring;
                                                                {3558}new Nc_3187: bitstring;
                                                                {3559}let gNc_3188: bitstring = exp(g,Nc_3187) in
                                                                {3560}let m1_3189: bitstring = (SPc_3186,gNc_3188) in
                                                                {3561}out(c, (pkCli_2956,m1_3189,sign(m1_3189,skCli_2955)));
                                                                {3562}event beginCli(Cli,Sess,gNc_3188);
                                                                {3563}in(c, (PartS_3190: bitstring,sigPartS_3191: bitstring));
                                                                {3564}if (verify(PartS_3190,sigPartS_3191,pkSess_3183) <> true) then
                                                                    0
                                                                else
                                                                    {3565}event endCli(Sess,Cli,PartS_3190)
                                                            )
                                                            else
                                                                {3566}let pkSess_3192: bitstring = pub(skI) in
                                                                {3567}out(c, GetEndpointRequest);
                                                                {3568}in(c, (SPs_3193: bitstring,=Sign,UP_3194: bitstring,=pkSess_3192));
                                                                {3569}new SPc_3195: bitstring;
                                                                {3570}new Nc_3196: bitstring;
                                                                {3571}let gNc_3197: bitstring = exp(g,Nc_3196) in
                                                                {3572}let m1_3198: bitstring = (SPc_3195,gNc_3197) in
                                                                {3573}out(c, (pkCli_2956,m1_3198,sign(m1_3198,skCli_2955)));
                                                                {3574}event beginCli(Cli,Sess,gNc_3197);
                                                                {3575}in(c, (PartS_3199: bitstring,sigPartS_3200: bitstring));
                                                                {3576}if (verify(PartS_3199,sigPartS_3200,pkSess_3192) <> true) then
                                                                    0
                                                                else
                                                                    {3577}event endCli(Sess,Cli,PartS_3199)
                                                        )
                                                        else
                                                            {3578}let pkSess_3201: bitstring = fail-any in
                                                            {3579}out(c, GetEndpointRequest);
                                                            {3580}in(c, (SPs_3202: bitstring,=Sign,UP_3203: bitstring,=pkSess_3201));
                                                            {3581}new SPc_3204: bitstring;
                                                            {3582}new Nc_3205: bitstring;
                                                            {3583}let gNc_3206: bitstring = exp(g,Nc_3205) in
                                                            {3584}let m1_3207: bitstring = (SPc_3204,gNc_3206) in
                                                            {3585}out(c, (pkCli_2956,m1_3207,sign(m1_3207,skCli_2955)));
                                                            {3586}event beginCli(Cli,Sess,gNc_3206);
                                                            {3587}in(c, (PartS_3208: bitstring,sigPartS_3209: bitstring));
                                                            {3588}if (verify(PartS_3208,sigPartS_3209,pkSess_3201) <> true) then
                                                                0
                                                            else
                                                                {3589}event endCli(Sess,Cli,PartS_3208)
                                                )
                                                else
                                                    {3590}let pkSess_3210: bitstring = fail-any in
                                                    {3591}out(c, GetEndpointRequest);
                                                    {3592}in(c, (SPs_3211: bitstring,=Sign,UP_3212: bitstring,=pkSess_3210));
                                                    {3593}new SPc_3213: bitstring;
                                                    {3594}new Nc_3214: bitstring;
                                                    {3595}let gNc_3215: bitstring = exp(g,Nc_3214) in
                                                    {3596}let m1_3216: bitstring = (SPc_3213,gNc_3215) in
                                                    {3597}out(c, (pkCli_2956,m1_3216,sign(m1_3216,skCli_2955)));
                                                    {3598}event beginCli(Cli,Sess,gNc_3215);
                                                    {3599}in(c, (PartS_3217: bitstring,sigPartS_3218: bitstring));
                                                    {3600}if (verify(PartS_3217,sigPartS_3218,pkSess_3210) <> true) then
                                                        0
                                                    else
                                                        {3601}event endCli(Sess,Cli,PartS_3217)
                                        )
                                        else
                                            {3602}let pkSess_3219: bitstring = fail-any in
                                            {3603}out(c, GetEndpointRequest);
                                            {3604}in(c, (SPs_3220: bitstring,=Sign,UP_3221: bitstring,=pkSess_3219));
                                            {3605}new SPc_3222: bitstring;
                                            {3606}new Nc_3223: bitstring;
                                            {3607}let gNc_3224: bitstring = exp(g,Nc_3223) in
                                            {3608}let m1_3225: bitstring = (SPc_3222,gNc_3224) in
                                            {3609}out(c, (pkCli_2956,m1_3225,sign(m1_3225,skCli_2955)));
                                            {3610}event beginCli(Cli,Sess,gNc_3224);
                                            {3611}in(c, (PartS_3226: bitstring,sigPartS_3227: bitstring));
                                            {3612}if (verify(PartS_3226,sigPartS_3227,pkSess_3219) <> true) then
                                                0
                                            else
                                                {3613}event endCli(Sess,Cli,PartS_3226)
                                )
                                else
                                    {3614}let pkDisco_3228: bitstring = fail-any in
                                    {3615}let v_3229: bool = (Sess = A) in
                                    (
                                        {3616}if v_3229 then
                                        (
                                            {3617}let pkSess_3230: bitstring = pub(skA) in
                                            {3618}out(c, GetEndpointRequest);
                                            {3619}in(c, (SPs_3231: bitstring,=Sign,UP_3232: bitstring,=pkSess_3230));
                                            {3620}new SPc_3233: bitstring;
                                            {3621}new Nc_3234: bitstring;
                                            {3622}let gNc_3235: bitstring = exp(g,Nc_3234) in
                                            {3623}let m1_3236: bitstring = (SPc_3233,gNc_3235) in
                                            {3624}out(c, (pkCli_2956,m1_3236,sign(m1_3236,skCli_2955)));
                                            {3625}event beginCli(Cli,Sess,gNc_3235);
                                            {3626}in(c, (PartS_3237: bitstring,sigPartS_3238: bitstring));
                                            {3627}if (verify(PartS_3237,sigPartS_3238,pkSess_3230) <> true) then
                                                0
                                            else
                                                {3628}event endCli(Sess,Cli,PartS_3237)
                                        )
                                        else
                                            {3629}let v_3239: bool = (Sess = B) in
                                            (
                                                {3630}if v_3239 then
                                                (
                                                    {3631}let pkSess_3240: bitstring = pub(skB) in
                                                    {3632}out(c, GetEndpointRequest);
                                                    {3633}in(c, (SPs_3241: bitstring,=Sign,UP_3242: bitstring,=pkSess_3240));
                                                    {3634}new SPc_3243: bitstring;
                                                    {3635}new Nc_3244: bitstring;
                                                    {3636}let gNc_3245: bitstring = exp(g,Nc_3244) in
                                                    {3637}let m1_3246: bitstring = (SPc_3243,gNc_3245) in
                                                    {3638}out(c, (pkCli_2956,m1_3246,sign(m1_3246,skCli_2955)));
                                                    {3639}event beginCli(Cli,Sess,gNc_3245);
                                                    {3640}in(c, (PartS_3247: bitstring,sigPartS_3248: bitstring));
                                                    {3641}if (verify(PartS_3247,sigPartS_3248,pkSess_3240) <> true) then
                                                        0
                                                    else
                                                        {3642}event endCli(Sess,Cli,PartS_3247)
                                                )
                                                else
                                                    {3643}let v_3249: bool = (Sess = C) in
                                                    (
                                                        {3644}if v_3249 then
                                                        (
                                                            {3645}let pkSess_3250: bitstring = pub(skC) in
                                                            {3646}out(c, GetEndpointRequest);
                                                            {3647}in(c, (SPs_3251: bitstring,=Sign,UP_3252: bitstring,=pkSess_3250));
                                                            {3648}new SPc_3253: bitstring;
                                                            {3649}new Nc_3254: bitstring;
                                                            {3650}let gNc_3255: bitstring = exp(g,Nc_3254) in
                                                            {3651}let m1_3256: bitstring = (SPc_3253,gNc_3255) in
                                                            {3652}out(c, (pkCli_2956,m1_3256,sign(m1_3256,skCli_2955)));
                                                            {3653}event beginCli(Cli,Sess,gNc_3255);
                                                            {3654}in(c, (PartS_3257: bitstring,sigPartS_3258: bitstring));
                                                            {3655}if (verify(PartS_3257,sigPartS_3258,pkSess_3250) <> true) then
                                                                0
                                                            else
                                                                {3656}event endCli(Sess,Cli,PartS_3257)
                                                        )
                                                        else
                                                            {3657}let pkSess_3259: bitstring = pub(skI) in
                                                            {3658}out(c, GetEndpointRequest);
                                                            {3659}in(c, (SPs_3260: bitstring,=Sign,UP_3261: bitstring,=pkSess_3259));
                                                            {3660}new SPc_3262: bitstring;
                                                            {3661}new Nc_3263: bitstring;
                                                            {3662}let gNc_3264: bitstring = exp(g,Nc_3263) in
                                                            {3663}let m1_3265: bitstring = (SPc_3262,gNc_3264) in
                                                            {3664}out(c, (pkCli_2956,m1_3265,sign(m1_3265,skCli_2955)));
                                                            {3665}event beginCli(Cli,Sess,gNc_3264);
                                                            {3666}in(c, (PartS_3266: bitstring,sigPartS_3267: bitstring));
                                                            {3667}if (verify(PartS_3266,sigPartS_3267,pkSess_3259) <> true) then
                                                                0
                                                            else
                                                                {3668}event endCli(Sess,Cli,PartS_3266)
                                                    )
                                                    else
                                                        {3669}let pkSess_3268: bitstring = fail-any in
                                                        {3670}out(c, GetEndpointRequest);
                                                        {3671}in(c, (SPs_3269: bitstring,=Sign,UP_3270: bitstring,=pkSess_3268));
                                                        {3672}new SPc_3271: bitstring;
                                                        {3673}new Nc_3272: bitstring;
                                                        {3674}let gNc_3273: bitstring = exp(g,Nc_3272) in
                                                        {3675}let m1_3274: bitstring = (SPc_3271,gNc_3273) in
                                                        {3676}out(c, (pkCli_2956,m1_3274,sign(m1_3274,skCli_2955)));
                                                        {3677}event beginCli(Cli,Sess,gNc_3273);
                                                        {3678}in(c, (PartS_3275: bitstring,sigPartS_3276: bitstring));
                                                        {3679}if (verify(PartS_3275,sigPartS_3276,pkSess_3268) <> true) then
                                                            0
                                                        else
                                                            {3680}event endCli(Sess,Cli,PartS_3275)
                                            )
                                            else
                                                {3681}let pkSess_3277: bitstring = fail-any in
                                                {3682}out(c, GetEndpointRequest);
                                                {3683}in(c, (SPs_3278: bitstring,=Sign,UP_3279: bitstring,=pkSess_3277));
                                                {3684}new SPc_3280: bitstring;
                                                {3685}new Nc_3281: bitstring;
                                                {3686}let gNc_3282: bitstring = exp(g,Nc_3281) in
                                                {3687}let m1_3283: bitstring = (SPc_3280,gNc_3282) in
                                                {3688}out(c, (pkCli_2956,m1_3283,sign(m1_3283,skCli_2955)));
                                                {3689}event beginCli(Cli,Sess,gNc_3282);
                                                {3690}in(c, (PartS_3284: bitstring,sigPartS_3285: bitstring));
                                                {3691}if (verify(PartS_3284,sigPartS_3285,pkSess_3277) <> true) then
                                                    0
                                                else
                                                    {3692}event endCli(Sess,Cli,PartS_3284)
                                    )
                                    else
                                        {3693}let pkSess_3286: bitstring = fail-any in
                                        {3694}out(c, GetEndpointRequest);
                                        {3695}in(c, (SPs_3287: bitstring,=Sign,UP_3288: bitstring,=pkSess_3286));
                                        {3696}new SPc_3289: bitstring;
                                        {3697}new Nc_3290: bitstring;
                                        {3698}let gNc_3291: bitstring = exp(g,Nc_3290) in
                                        {3699}let m1_3292: bitstring = (SPc_3289,gNc_3291) in
                                        {3700}out(c, (pkCli_2956,m1_3292,sign(m1_3292,skCli_2955)));
                                        {3701}event beginCli(Cli,Sess,gNc_3291);
                                        {3702}in(c, (PartS_3293: bitstring,sigPartS_3294: bitstring));
                                        {3703}if (verify(PartS_3293,sigPartS_3294,pkSess_3286) <> true) then
                                            0
                                        else
                                            {3704}event endCli(Sess,Cli,PartS_3293)
                        )
                        else
                            {3705}let pkDisco_3295: bitstring = fail-any in
                            {3706}let v_3296: bool = (Sess = A) in
                            (
                                {3707}if v_3296 then
                                (
                                    {3708}let pkSess_3297: bitstring = pub(skA) in
                                    {3709}out(c, GetEndpointRequest);
                                    {3710}in(c, (SPs_3298: bitstring,=Sign,UP_3299: bitstring,=pkSess_3297));
                                    {3711}new SPc_3300: bitstring;
                                    {3712}new Nc_3301: bitstring;
                                    {3713}let gNc_3302: bitstring = exp(g,Nc_3301) in
                                    {3714}let m1_3303: bitstring = (SPc_3300,gNc_3302) in
                                    {3715}out(c, (pkCli_2956,m1_3303,sign(m1_3303,skCli_2955)));
                                    {3716}event beginCli(Cli,Sess,gNc_3302);
                                    {3717}in(c, (PartS_3304: bitstring,sigPartS_3305: bitstring));
                                    {3718}if (verify(PartS_3304,sigPartS_3305,pkSess_3297) <> true) then
                                        0
                                    else
                                        {3719}event endCli(Sess,Cli,PartS_3304)
                                )
                                else
                                    {3720}let v_3306: bool = (Sess = B) in
                                    (
                                        {3721}if v_3306 then
                                        (
                                            {3722}let pkSess_3307: bitstring = pub(skB) in
                                            {3723}out(c, GetEndpointRequest);
                                            {3724}in(c, (SPs_3308: bitstring,=Sign,UP_3309: bitstring,=pkSess_3307));
                                            {3725}new SPc_3310: bitstring;
                                            {3726}new Nc_3311: bitstring;
                                            {3727}let gNc_3312: bitstring = exp(g,Nc_3311) in
                                            {3728}let m1_3313: bitstring = (SPc_3310,gNc_3312) in
                                            {3729}out(c, (pkCli_2956,m1_3313,sign(m1_3313,skCli_2955)));
                                            {3730}event beginCli(Cli,Sess,gNc_3312);
                                            {3731}in(c, (PartS_3314: bitstring,sigPartS_3315: bitstring));
                                            {3732}if (verify(PartS_3314,sigPartS_3315,pkSess_3307) <> true) then
                                                0
                                            else
                                                {3733}event endCli(Sess,Cli,PartS_3314)
                                        )
                                        else
                                            {3734}let v_3316: bool = (Sess = C) in
                                            (
                                                {3735}if v_3316 then
                                                (
                                                    {3736}let pkSess_3317: bitstring = pub(skC) in
                                                    {3737}out(c, GetEndpointRequest);
                                                    {3738}in(c, (SPs_3318: bitstring,=Sign,UP_3319: bitstring,=pkSess_3317));
                                                    {3739}new SPc_3320: bitstring;
                                                    {3740}new Nc_3321: bitstring;
                                                    {3741}let gNc_3322: bitstring = exp(g,Nc_3321) in
                                                    {3742}let m1_3323: bitstring = (SPc_3320,gNc_3322) in
                                                    {3743}out(c, (pkCli_2956,m1_3323,sign(m1_3323,skCli_2955)));
                                                    {3744}event beginCli(Cli,Sess,gNc_3322);
                                                    {3745}in(c, (PartS_3324: bitstring,sigPartS_3325: bitstring));
                                                    {3746}if (verify(PartS_3324,sigPartS_3325,pkSess_3317) <> true) then
                                                        0
                                                    else
                                                        {3747}event endCli(Sess,Cli,PartS_3324)
                                                )
                                                else
                                                    {3748}let pkSess_3326: bitstring = pub(skI) in
                                                    {3749}out(c, GetEndpointRequest);
                                                    {3750}in(c, (SPs_3327: bitstring,=Sign,UP_3328: bitstring,=pkSess_3326));
                                                    {3751}new SPc_3329: bitstring;
                                                    {3752}new Nc_3330: bitstring;
                                                    {3753}let gNc_3331: bitstring = exp(g,Nc_3330) in
                                                    {3754}let m1_3332: bitstring = (SPc_3329,gNc_3331) in
                                                    {3755}out(c, (pkCli_2956,m1_3332,sign(m1_3332,skCli_2955)));
                                                    {3756}event beginCli(Cli,Sess,gNc_3331);
                                                    {3757}in(c, (PartS_3333: bitstring,sigPartS_3334: bitstring));
                                                    {3758}if (verify(PartS_3333,sigPartS_3334,pkSess_3326) <> true) then
                                                        0
                                                    else
                                                        {3759}event endCli(Sess,Cli,PartS_3333)
                                            )
                                            else
                                                {3760}let pkSess_3335: bitstring = fail-any in
                                                {3761}out(c, GetEndpointRequest);
                                                {3762}in(c, (SPs_3336: bitstring,=Sign,UP_3337: bitstring,=pkSess_3335));
                                                {3763}new SPc_3338: bitstring;
                                                {3764}new Nc_3339: bitstring;
                                                {3765}let gNc_3340: bitstring = exp(g,Nc_3339) in
                                                {3766}let m1_3341: bitstring = (SPc_3338,gNc_3340) in
                                                {3767}out(c, (pkCli_2956,m1_3341,sign(m1_3341,skCli_2955)));
                                                {3768}event beginCli(Cli,Sess,gNc_3340);
                                                {3769}in(c, (PartS_3342: bitstring,sigPartS_3343: bitstring));
                                                {3770}if (verify(PartS_3342,sigPartS_3343,pkSess_3335) <> true) then
                                                    0
                                                else
                                                    {3771}event endCli(Sess,Cli,PartS_3342)
                                    )
                                    else
                                        {3772}let pkSess_3344: bitstring = fail-any in
                                        {3773}out(c, GetEndpointRequest);
                                        {3774}in(c, (SPs_3345: bitstring,=Sign,UP_3346: bitstring,=pkSess_3344));
                                        {3775}new SPc_3347: bitstring;
                                        {3776}new Nc_3348: bitstring;
                                        {3777}let gNc_3349: bitstring = exp(g,Nc_3348) in
                                        {3778}let m1_3350: bitstring = (SPc_3347,gNc_3349) in
                                        {3779}out(c, (pkCli_2956,m1_3350,sign(m1_3350,skCli_2955)));
                                        {3780}event beginCli(Cli,Sess,gNc_3349);
                                        {3781}in(c, (PartS_3351: bitstring,sigPartS_3352: bitstring));
                                        {3782}if (verify(PartS_3351,sigPartS_3352,pkSess_3344) <> true) then
                                            0
                                        else
                                            {3783}event endCli(Sess,Cli,PartS_3351)
                            )
                            else
                                {3784}let pkSess_3353: bitstring = fail-any in
                                {3785}out(c, GetEndpointRequest);
                                {3786}in(c, (SPs_3354: bitstring,=Sign,UP_3355: bitstring,=pkSess_3353));
                                {3787}new SPc_3356: bitstring;
                                {3788}new Nc_3357: bitstring;
                                {3789}let gNc_3358: bitstring = exp(g,Nc_3357) in
                                {3790}let m1_3359: bitstring = (SPc_3356,gNc_3358) in
                                {3791}out(c, (pkCli_2956,m1_3359,sign(m1_3359,skCli_2955)));
                                {3792}event beginCli(Cli,Sess,gNc_3358);
                                {3793}in(c, (PartS_3360: bitstring,sigPartS_3361: bitstring));
                                {3794}if (verify(PartS_3360,sigPartS_3361,pkSess_3353) <> true) then
                                    0
                                else
                                    {3795}event endCli(Sess,Cli,PartS_3360)
                )
                else
                    {3796}let pkDisco_3362: bitstring = fail-any in
                    {3797}let v_3363: bool = (Sess = A) in
                    (
                        {3798}if v_3363 then
                        (
                            {3799}let pkSess_3364: bitstring = pub(skA) in
                            {3800}out(c, GetEndpointRequest);
                            {3801}in(c, (SPs_3365: bitstring,=Sign,UP_3366: bitstring,=pkSess_3364));
                            {3802}new SPc_3367: bitstring;
                            {3803}new Nc_3368: bitstring;
                            {3804}let gNc_3369: bitstring = exp(g,Nc_3368) in
                            {3805}let m1_3370: bitstring = (SPc_3367,gNc_3369) in
                            {3806}out(c, (pkCli_2956,m1_3370,sign(m1_3370,skCli_2955)));
                            {3807}event beginCli(Cli,Sess,gNc_3369);
                            {3808}in(c, (PartS_3371: bitstring,sigPartS_3372: bitstring));
                            {3809}if (verify(PartS_3371,sigPartS_3372,pkSess_3364) <> true) then
                                0
                            else
                                {3810}event endCli(Sess,Cli,PartS_3371)
                        )
                        else
                            {3811}let v_3373: bool = (Sess = B) in
                            (
                                {3812}if v_3373 then
                                (
                                    {3813}let pkSess_3374: bitstring = pub(skB) in
                                    {3814}out(c, GetEndpointRequest);
                                    {3815}in(c, (SPs_3375: bitstring,=Sign,UP_3376: bitstring,=pkSess_3374));
                                    {3816}new SPc_3377: bitstring;
                                    {3817}new Nc_3378: bitstring;
                                    {3818}let gNc_3379: bitstring = exp(g,Nc_3378) in
                                    {3819}let m1_3380: bitstring = (SPc_3377,gNc_3379) in
                                    {3820}out(c, (pkCli_2956,m1_3380,sign(m1_3380,skCli_2955)));
                                    {3821}event beginCli(Cli,Sess,gNc_3379);
                                    {3822}in(c, (PartS_3381: bitstring,sigPartS_3382: bitstring));
                                    {3823}if (verify(PartS_3381,sigPartS_3382,pkSess_3374) <> true) then
                                        0
                                    else
                                        {3824}event endCli(Sess,Cli,PartS_3381)
                                )
                                else
                                    {3825}let v_3383: bool = (Sess = C) in
                                    (
                                        {3826}if v_3383 then
                                        (
                                            {3827}let pkSess_3384: bitstring = pub(skC) in
                                            {3828}out(c, GetEndpointRequest);
                                            {3829}in(c, (SPs_3385: bitstring,=Sign,UP_3386: bitstring,=pkSess_3384));
                                            {3830}new SPc_3387: bitstring;
                                            {3831}new Nc_3388: bitstring;
                                            {3832}let gNc_3389: bitstring = exp(g,Nc_3388) in
                                            {3833}let m1_3390: bitstring = (SPc_3387,gNc_3389) in
                                            {3834}out(c, (pkCli_2956,m1_3390,sign(m1_3390,skCli_2955)));
                                            {3835}event beginCli(Cli,Sess,gNc_3389);
                                            {3836}in(c, (PartS_3391: bitstring,sigPartS_3392: bitstring));
                                            {3837}if (verify(PartS_3391,sigPartS_3392,pkSess_3384) <> true) then
                                                0
                                            else
                                                {3838}event endCli(Sess,Cli,PartS_3391)
                                        )
                                        else
                                            {3839}let pkSess_3393: bitstring = pub(skI) in
                                            {3840}out(c, GetEndpointRequest);
                                            {3841}in(c, (SPs_3394: bitstring,=Sign,UP_3395: bitstring,=pkSess_3393));
                                            {3842}new SPc_3396: bitstring;
                                            {3843}new Nc_3397: bitstring;
                                            {3844}let gNc_3398: bitstring = exp(g,Nc_3397) in
                                            {3845}let m1_3399: bitstring = (SPc_3396,gNc_3398) in
                                            {3846}out(c, (pkCli_2956,m1_3399,sign(m1_3399,skCli_2955)));
                                            {3847}event beginCli(Cli,Sess,gNc_3398);
                                            {3848}in(c, (PartS_3400: bitstring,sigPartS_3401: bitstring));
                                            {3849}if (verify(PartS_3400,sigPartS_3401,pkSess_3393) <> true) then
                                                0
                                            else
                                                {3850}event endCli(Sess,Cli,PartS_3400)
                                    )
                                    else
                                        {3851}let pkSess_3402: bitstring = fail-any in
                                        {3852}out(c, GetEndpointRequest);
                                        {3853}in(c, (SPs_3403: bitstring,=Sign,UP_3404: bitstring,=pkSess_3402));
                                        {3854}new SPc_3405: bitstring;
                                        {3855}new Nc_3406: bitstring;
                                        {3856}let gNc_3407: bitstring = exp(g,Nc_3406) in
                                        {3857}let m1_3408: bitstring = (SPc_3405,gNc_3407) in
                                        {3858}out(c, (pkCli_2956,m1_3408,sign(m1_3408,skCli_2955)));
                                        {3859}event beginCli(Cli,Sess,gNc_3407);
                                        {3860}in(c, (PartS_3409: bitstring,sigPartS_3410: bitstring));
                                        {3861}if (verify(PartS_3409,sigPartS_3410,pkSess_3402) <> true) then
                                            0
                                        else
                                            {3862}event endCli(Sess,Cli,PartS_3409)
                            )
                            else
                                {3863}let pkSess_3411: bitstring = fail-any in
                                {3864}out(c, GetEndpointRequest);
                                {3865}in(c, (SPs_3412: bitstring,=Sign,UP_3413: bitstring,=pkSess_3411));
                                {3866}new SPc_3414: bitstring;
                                {3867}new Nc_3415: bitstring;
                                {3868}let gNc_3416: bitstring = exp(g,Nc_3415) in
                                {3869}let m1_3417: bitstring = (SPc_3414,gNc_3416) in
                                {3870}out(c, (pkCli_2956,m1_3417,sign(m1_3417,skCli_2955)));
                                {3871}event beginCli(Cli,Sess,gNc_3416);
                                {3872}in(c, (PartS_3418: bitstring,sigPartS_3419: bitstring));
                                {3873}if (verify(PartS_3418,sigPartS_3419,pkSess_3411) <> true) then
                                    0
                                else
                                    {3874}event endCli(Sess,Cli,PartS_3418)
                    )
                    else
                        {3875}let pkSess_3420: bitstring = fail-any in
                        {3876}out(c, GetEndpointRequest);
                        {3877}in(c, (SPs_3421: bitstring,=Sign,UP_3422: bitstring,=pkSess_3420));
                        {3878}new SPc_3423: bitstring;
                        {3879}new Nc_3424: bitstring;
                        {3880}let gNc_3425: bitstring = exp(g,Nc_3424) in
                        {3881}let m1_3426: bitstring = (SPc_3423,gNc_3425) in
                        {3882}out(c, (pkCli_2956,m1_3426,sign(m1_3426,skCli_2955)));
                        {3883}event beginCli(Cli,Sess,gNc_3425);
                        {3884}in(c, (PartS_3427: bitstring,sigPartS_3428: bitstring));
                        {3885}if (verify(PartS_3427,sigPartS_3428,pkSess_3420) <> true) then
                            0
                        else
                            {3886}event endCli(Sess,Cli,PartS_3427)
    )
    else
        {3887}let skCli_3429: bitstring = fail-any in
        {3888}let pkCli_3430: bitstring = pub(skCli_3429) in
        {3889}let v_3431: bool = (Disco = A) in
        (
            {3890}if v_3431 then
            (
                {3891}let pkDisco_3432: bitstring = pub(skA) in
                {3892}let v_3433: bool = (Sess = A) in
                (
                    {3893}if v_3433 then
                    (
                        {3894}let pkSess_3434: bitstring = pub(skA) in
                        {3895}out(c, GetEndpointRequest);
                        {3896}in(c, (SPs_3435: bitstring,=Sign,UP_3436: bitstring,=pkSess_3434));
                        {3897}new SPc_3437: bitstring;
                        {3898}new Nc_3438: bitstring;
                        {3899}let gNc_3439: bitstring = exp(g,Nc_3438) in
                        {3900}let m1_3440: bitstring = (SPc_3437,gNc_3439) in
                        {3901}out(c, (pkCli_3430,m1_3440,sign(m1_3440,skCli_3429)));
                        {3902}event beginCli(Cli,Sess,gNc_3439);
                        {3903}in(c, (PartS_3441: bitstring,sigPartS_3442: bitstring));
                        {3904}if (verify(PartS_3441,sigPartS_3442,pkSess_3434) <> true) then
                            0
                        else
                            {3905}event endCli(Sess,Cli,PartS_3441)
                    )
                    else
                        {3906}let v_3443: bool = (Sess = B) in
                        (
                            {3907}if v_3443 then
                            (
                                {3908}let pkSess_3444: bitstring = pub(skB) in
                                {3909}out(c, GetEndpointRequest);
                                {3910}in(c, (SPs_3445: bitstring,=Sign,UP_3446: bitstring,=pkSess_3444));
                                {3911}new SPc_3447: bitstring;
                                {3912}new Nc_3448: bitstring;
                                {3913}let gNc_3449: bitstring = exp(g,Nc_3448) in
                                {3914}let m1_3450: bitstring = (SPc_3447,gNc_3449) in
                                {3915}out(c, (pkCli_3430,m1_3450,sign(m1_3450,skCli_3429)));
                                {3916}event beginCli(Cli,Sess,gNc_3449);
                                {3917}in(c, (PartS_3451: bitstring,sigPartS_3452: bitstring));
                                {3918}if (verify(PartS_3451,sigPartS_3452,pkSess_3444) <> true) then
                                    0
                                else
                                    {3919}event endCli(Sess,Cli,PartS_3451)
                            )
                            else
                                {3920}let v_3453: bool = (Sess = C) in
                                (
                                    {3921}if v_3453 then
                                    (
                                        {3922}let pkSess_3454: bitstring = pub(skC) in
                                        {3923}out(c, GetEndpointRequest);
                                        {3924}in(c, (SPs_3455: bitstring,=Sign,UP_3456: bitstring,=pkSess_3454));
                                        {3925}new SPc_3457: bitstring;
                                        {3926}new Nc_3458: bitstring;
                                        {3927}let gNc_3459: bitstring = exp(g,Nc_3458) in
                                        {3928}let m1_3460: bitstring = (SPc_3457,gNc_3459) in
                                        {3929}out(c, (pkCli_3430,m1_3460,sign(m1_3460,skCli_3429)));
                                        {3930}event beginCli(Cli,Sess,gNc_3459);
                                        {3931}in(c, (PartS_3461: bitstring,sigPartS_3462: bitstring));
                                        {3932}if (verify(PartS_3461,sigPartS_3462,pkSess_3454) <> true) then
                                            0
                                        else
                                            {3933}event endCli(Sess,Cli,PartS_3461)
                                    )
                                    else
                                        {3934}let pkSess_3463: bitstring = pub(skI) in
                                        {3935}out(c, GetEndpointRequest);
                                        {3936}in(c, (SPs_3464: bitstring,=Sign,UP_3465: bitstring,=pkSess_3463));
                                        {3937}new SPc_3466: bitstring;
                                        {3938}new Nc_3467: bitstring;
                                        {3939}let gNc_3468: bitstring = exp(g,Nc_3467) in
                                        {3940}let m1_3469: bitstring = (SPc_3466,gNc_3468) in
                                        {3941}out(c, (pkCli_3430,m1_3469,sign(m1_3469,skCli_3429)));
                                        {3942}event beginCli(Cli,Sess,gNc_3468);
                                        {3943}in(c, (PartS_3470: bitstring,sigPartS_3471: bitstring));
                                        {3944}if (verify(PartS_3470,sigPartS_3471,pkSess_3463) <> true) then
                                            0
                                        else
                                            {3945}event endCli(Sess,Cli,PartS_3470)
                                )
                                else
                                    {3946}let pkSess_3472: bitstring = fail-any in
                                    {3947}out(c, GetEndpointRequest);
                                    {3948}in(c, (SPs_3473: bitstring,=Sign,UP_3474: bitstring,=pkSess_3472));
                                    {3949}new SPc_3475: bitstring;
                                    {3950}new Nc_3476: bitstring;
                                    {3951}let gNc_3477: bitstring = exp(g,Nc_3476) in
                                    {3952}let m1_3478: bitstring = (SPc_3475,gNc_3477) in
                                    {3953}out(c, (pkCli_3430,m1_3478,sign(m1_3478,skCli_3429)));
                                    {3954}event beginCli(Cli,Sess,gNc_3477);
                                    {3955}in(c, (PartS_3479: bitstring,sigPartS_3480: bitstring));
                                    {3956}if (verify(PartS_3479,sigPartS_3480,pkSess_3472) <> true) then
                                        0
                                    else
                                        {3957}event endCli(Sess,Cli,PartS_3479)
                        )
                        else
                            {3958}let pkSess_3481: bitstring = fail-any in
                            {3959}out(c, GetEndpointRequest);
                            {3960}in(c, (SPs_3482: bitstring,=Sign,UP_3483: bitstring,=pkSess_3481));
                            {3961}new SPc_3484: bitstring;
                            {3962}new Nc_3485: bitstring;
                            {3963}let gNc_3486: bitstring = exp(g,Nc_3485) in
                            {3964}let m1_3487: bitstring = (SPc_3484,gNc_3486) in
                            {3965}out(c, (pkCli_3430,m1_3487,sign(m1_3487,skCli_3429)));
                            {3966}event beginCli(Cli,Sess,gNc_3486);
                            {3967}in(c, (PartS_3488: bitstring,sigPartS_3489: bitstring));
                            {3968}if (verify(PartS_3488,sigPartS_3489,pkSess_3481) <> true) then
                                0
                            else
                                {3969}event endCli(Sess,Cli,PartS_3488)
                )
                else
                    {3970}let pkSess_3490: bitstring = fail-any in
                    {3971}out(c, GetEndpointRequest);
                    {3972}in(c, (SPs_3491: bitstring,=Sign,UP_3492: bitstring,=pkSess_3490));
                    {3973}new SPc_3493: bitstring;
                    {3974}new Nc_3494: bitstring;
                    {3975}let gNc_3495: bitstring = exp(g,Nc_3494) in
                    {3976}let m1_3496: bitstring = (SPc_3493,gNc_3495) in
                    {3977}out(c, (pkCli_3430,m1_3496,sign(m1_3496,skCli_3429)));
                    {3978}event beginCli(Cli,Sess,gNc_3495);
                    {3979}in(c, (PartS_3497: bitstring,sigPartS_3498: bitstring));
                    {3980}if (verify(PartS_3497,sigPartS_3498,pkSess_3490) <> true) then
                        0
                    else
                        {3981}event endCli(Sess,Cli,PartS_3497)
            )
            else
                {3982}let v_3499: bool = (Disco = B) in
                (
                    {3983}if v_3499 then
                    (
                        {3984}let pkDisco_3500: bitstring = pub(skB) in
                        {3985}let v_3501: bool = (Sess = A) in
                        (
                            {3986}if v_3501 then
                            (
                                {3987}let pkSess_3502: bitstring = pub(skA) in
                                {3988}out(c, GetEndpointRequest);
                                {3989}in(c, (SPs_3503: bitstring,=Sign,UP_3504: bitstring,=pkSess_3502));
                                {3990}new SPc_3505: bitstring;
                                {3991}new Nc_3506: bitstring;
                                {3992}let gNc_3507: bitstring = exp(g,Nc_3506) in
                                {3993}let m1_3508: bitstring = (SPc_3505,gNc_3507) in
                                {3994}out(c, (pkCli_3430,m1_3508,sign(m1_3508,skCli_3429)));
                                {3995}event beginCli(Cli,Sess,gNc_3507);
                                {3996}in(c, (PartS_3509: bitstring,sigPartS_3510: bitstring));
                                {3997}if (verify(PartS_3509,sigPartS_3510,pkSess_3502) <> true) then
                                    0
                                else
                                    {3998}event endCli(Sess,Cli,PartS_3509)
                            )
                            else
                                {3999}let v_3511: bool = (Sess = B) in
                                (
                                    {4000}if v_3511 then
                                    (
                                        {4001}let pkSess_3512: bitstring = pub(skB) in
                                        {4002}out(c, GetEndpointRequest);
                                        {4003}in(c, (SPs_3513: bitstring,=Sign,UP_3514: bitstring,=pkSess_3512));
                                        {4004}new SPc_3515: bitstring;
                                        {4005}new Nc_3516: bitstring;
                                        {4006}let gNc_3517: bitstring = exp(g,Nc_3516) in
                                        {4007}let m1_3518: bitstring = (SPc_3515,gNc_3517) in
                                        {4008}out(c, (pkCli_3430,m1_3518,sign(m1_3518,skCli_3429)));
                                        {4009}event beginCli(Cli,Sess,gNc_3517);
                                        {4010}in(c, (PartS_3519: bitstring,sigPartS_3520: bitstring));
                                        {4011}if (verify(PartS_3519,sigPartS_3520,pkSess_3512) <> true) then
                                            0
                                        else
                                            {4012}event endCli(Sess,Cli,PartS_3519)
                                    )
                                    else
                                        {4013}let v_3521: bool = (Sess = C) in
                                        (
                                            {4014}if v_3521 then
                                            (
                                                {4015}let pkSess_3522: bitstring = pub(skC) in
                                                {4016}out(c, GetEndpointRequest);
                                                {4017}in(c, (SPs_3523: bitstring,=Sign,UP_3524: bitstring,=pkSess_3522));
                                                {4018}new SPc_3525: bitstring;
                                                {4019}new Nc_3526: bitstring;
                                                {4020}let gNc_3527: bitstring = exp(g,Nc_3526) in
                                                {4021}let m1_3528: bitstring = (SPc_3525,gNc_3527) in
                                                {4022}out(c, (pkCli_3430,m1_3528,sign(m1_3528,skCli_3429)));
                                                {4023}event beginCli(Cli,Sess,gNc_3527);
                                                {4024}in(c, (PartS_3529: bitstring,sigPartS_3530: bitstring));
                                                {4025}if (verify(PartS_3529,sigPartS_3530,pkSess_3522) <> true) then
                                                    0
                                                else
                                                    {4026}event endCli(Sess,Cli,PartS_3529)
                                            )
                                            else
                                                {4027}let pkSess_3531: bitstring = pub(skI) in
                                                {4028}out(c, GetEndpointRequest);
                                                {4029}in(c, (SPs_3532: bitstring,=Sign,UP_3533: bitstring,=pkSess_3531));
                                                {4030}new SPc_3534: bitstring;
                                                {4031}new Nc_3535: bitstring;
                                                {4032}let gNc_3536: bitstring = exp(g,Nc_3535) in
                                                {4033}let m1_3537: bitstring = (SPc_3534,gNc_3536) in
                                                {4034}out(c, (pkCli_3430,m1_3537,sign(m1_3537,skCli_3429)));
                                                {4035}event beginCli(Cli,Sess,gNc_3536);
                                                {4036}in(c, (PartS_3538: bitstring,sigPartS_3539: bitstring));
                                                {4037}if (verify(PartS_3538,sigPartS_3539,pkSess_3531) <> true) then
                                                    0
                                                else
                                                    {4038}event endCli(Sess,Cli,PartS_3538)
                                        )
                                        else
                                            {4039}let pkSess_3540: bitstring = fail-any in
                                            {4040}out(c, GetEndpointRequest);
                                            {4041}in(c, (SPs_3541: bitstring,=Sign,UP_3542: bitstring,=pkSess_3540));
                                            {4042}new SPc_3543: bitstring;
                                            {4043}new Nc_3544: bitstring;
                                            {4044}let gNc_3545: bitstring = exp(g,Nc_3544) in
                                            {4045}let m1_3546: bitstring = (SPc_3543,gNc_3545) in
                                            {4046}out(c, (pkCli_3430,m1_3546,sign(m1_3546,skCli_3429)));
                                            {4047}event beginCli(Cli,Sess,gNc_3545);
                                            {4048}in(c, (PartS_3547: bitstring,sigPartS_3548: bitstring));
                                            {4049}if (verify(PartS_3547,sigPartS_3548,pkSess_3540) <> true) then
                                                0
                                            else
                                                {4050}event endCli(Sess,Cli,PartS_3547)
                                )
                                else
                                    {4051}let pkSess_3549: bitstring = fail-any in
                                    {4052}out(c, GetEndpointRequest);
                                    {4053}in(c, (SPs_3550: bitstring,=Sign,UP_3551: bitstring,=pkSess_3549));
                                    {4054}new SPc_3552: bitstring;
                                    {4055}new Nc_3553: bitstring;
                                    {4056}let gNc_3554: bitstring = exp(g,Nc_3553) in
                                    {4057}let m1_3555: bitstring = (SPc_3552,gNc_3554) in
                                    {4058}out(c, (pkCli_3430,m1_3555,sign(m1_3555,skCli_3429)));
                                    {4059}event beginCli(Cli,Sess,gNc_3554);
                                    {4060}in(c, (PartS_3556: bitstring,sigPartS_3557: bitstring));
                                    {4061}if (verify(PartS_3556,sigPartS_3557,pkSess_3549) <> true) then
                                        0
                                    else
                                        {4062}event endCli(Sess,Cli,PartS_3556)
                        )
                        else
                            {4063}let pkSess_3558: bitstring = fail-any in
                            {4064}out(c, GetEndpointRequest);
                            {4065}in(c, (SPs_3559: bitstring,=Sign,UP_3560: bitstring,=pkSess_3558));
                            {4066}new SPc_3561: bitstring;
                            {4067}new Nc_3562: bitstring;
                            {4068}let gNc_3563: bitstring = exp(g,Nc_3562) in
                            {4069}let m1_3564: bitstring = (SPc_3561,gNc_3563) in
                            {4070}out(c, (pkCli_3430,m1_3564,sign(m1_3564,skCli_3429)));
                            {4071}event beginCli(Cli,Sess,gNc_3563);
                            {4072}in(c, (PartS_3565: bitstring,sigPartS_3566: bitstring));
                            {4073}if (verify(PartS_3565,sigPartS_3566,pkSess_3558) <> true) then
                                0
                            else
                                {4074}event endCli(Sess,Cli,PartS_3565)
                    )
                    else
                        {4075}let v_3567: bool = (Disco = C) in
                        (
                            {4076}if v_3567 then
                            (
                                {4077}let pkDisco_3568: bitstring = pub(skC) in
                                {4078}let v_3569: bool = (Sess = A) in
                                (
                                    {4079}if v_3569 then
                                    (
                                        {4080}let pkSess_3570: bitstring = pub(skA) in
                                        {4081}out(c, GetEndpointRequest);
                                        {4082}in(c, (SPs_3571: bitstring,=Sign,UP_3572: bitstring,=pkSess_3570));
                                        {4083}new SPc_3573: bitstring;
                                        {4084}new Nc_3574: bitstring;
                                        {4085}let gNc_3575: bitstring = exp(g,Nc_3574) in
                                        {4086}let m1_3576: bitstring = (SPc_3573,gNc_3575) in
                                        {4087}out(c, (pkCli_3430,m1_3576,sign(m1_3576,skCli_3429)));
                                        {4088}event beginCli(Cli,Sess,gNc_3575);
                                        {4089}in(c, (PartS_3577: bitstring,sigPartS_3578: bitstring));
                                        {4090}if (verify(PartS_3577,sigPartS_3578,pkSess_3570) <> true) then
                                            0
                                        else
                                            {4091}event endCli(Sess,Cli,PartS_3577)
                                    )
                                    else
                                        {4092}let v_3579: bool = (Sess = B) in
                                        (
                                            {4093}if v_3579 then
                                            (
                                                {4094}let pkSess_3580: bitstring = pub(skB) in
                                                {4095}out(c, GetEndpointRequest);
                                                {4096}in(c, (SPs_3581: bitstring,=Sign,UP_3582: bitstring,=pkSess_3580));
                                                {4097}new SPc_3583: bitstring;
                                                {4098}new Nc_3584: bitstring;
                                                {4099}let gNc_3585: bitstring = exp(g,Nc_3584) in
                                                {4100}let m1_3586: bitstring = (SPc_3583,gNc_3585) in
                                                {4101}out(c, (pkCli_3430,m1_3586,sign(m1_3586,skCli_3429)));
                                                {4102}event beginCli(Cli,Sess,gNc_3585);
                                                {4103}in(c, (PartS_3587: bitstring,sigPartS_3588: bitstring));
                                                {4104}if (verify(PartS_3587,sigPartS_3588,pkSess_3580) <> true) then
                                                    0
                                                else
                                                    {4105}event endCli(Sess,Cli,PartS_3587)
                                            )
                                            else
                                                {4106}let v_3589: bool = (Sess = C) in
                                                (
                                                    {4107}if v_3589 then
                                                    (
                                                        {4108}let pkSess_3590: bitstring = pub(skC) in
                                                        {4109}out(c, GetEndpointRequest);
                                                        {4110}in(c, (SPs_3591: bitstring,=Sign,UP_3592: bitstring,=pkSess_3590));
                                                        {4111}new SPc_3593: bitstring;
                                                        {4112}new Nc_3594: bitstring;
                                                        {4113}let gNc_3595: bitstring = exp(g,Nc_3594) in
                                                        {4114}let m1_3596: bitstring = (SPc_3593,gNc_3595) in
                                                        {4115}out(c, (pkCli_3430,m1_3596,sign(m1_3596,skCli_3429)));
                                                        {4116}event beginCli(Cli,Sess,gNc_3595);
                                                        {4117}in(c, (PartS_3597: bitstring,sigPartS_3598: bitstring));
                                                        {4118}if (verify(PartS_3597,sigPartS_3598,pkSess_3590) <> true) then
                                                            0
                                                        else
                                                            {4119}event endCli(Sess,Cli,PartS_3597)
                                                    )
                                                    else
                                                        {4120}let pkSess_3599: bitstring = pub(skI) in
                                                        {4121}out(c, GetEndpointRequest);
                                                        {4122}in(c, (SPs_3600: bitstring,=Sign,UP_3601: bitstring,=pkSess_3599));
                                                        {4123}new SPc_3602: bitstring;
                                                        {4124}new Nc_3603: bitstring;
                                                        {4125}let gNc_3604: bitstring = exp(g,Nc_3603) in
                                                        {4126}let m1_3605: bitstring = (SPc_3602,gNc_3604) in
                                                        {4127}out(c, (pkCli_3430,m1_3605,sign(m1_3605,skCli_3429)));
                                                        {4128}event beginCli(Cli,Sess,gNc_3604);
                                                        {4129}in(c, (PartS_3606: bitstring,sigPartS_3607: bitstring));
                                                        {4130}if (verify(PartS_3606,sigPartS_3607,pkSess_3599) <> true) then
                                                            0
                                                        else
                                                            {4131}event endCli(Sess,Cli,PartS_3606)
                                                )
                                                else
                                                    {4132}let pkSess_3608: bitstring = fail-any in
                                                    {4133}out(c, GetEndpointRequest);
                                                    {4134}in(c, (SPs_3609: bitstring,=Sign,UP_3610: bitstring,=pkSess_3608));
                                                    {4135}new SPc_3611: bitstring;
                                                    {4136}new Nc_3612: bitstring;
                                                    {4137}let gNc_3613: bitstring = exp(g,Nc_3612) in
                                                    {4138}let m1_3614: bitstring = (SPc_3611,gNc_3613) in
                                                    {4139}out(c, (pkCli_3430,m1_3614,sign(m1_3614,skCli_3429)));
                                                    {4140}event beginCli(Cli,Sess,gNc_3613);
                                                    {4141}in(c, (PartS_3615: bitstring,sigPartS_3616: bitstring));
                                                    {4142}if (verify(PartS_3615,sigPartS_3616,pkSess_3608) <> true) then
                                                        0
                                                    else
                                                        {4143}event endCli(Sess,Cli,PartS_3615)
                                        )
                                        else
                                            {4144}let pkSess_3617: bitstring = fail-any in
                                            {4145}out(c, GetEndpointRequest);
                                            {4146}in(c, (SPs_3618: bitstring,=Sign,UP_3619: bitstring,=pkSess_3617));
                                            {4147}new SPc_3620: bitstring;
                                            {4148}new Nc_3621: bitstring;
                                            {4149}let gNc_3622: bitstring = exp(g,Nc_3621) in
                                            {4150}let m1_3623: bitstring = (SPc_3620,gNc_3622) in
                                            {4151}out(c, (pkCli_3430,m1_3623,sign(m1_3623,skCli_3429)));
                                            {4152}event beginCli(Cli,Sess,gNc_3622);
                                            {4153}in(c, (PartS_3624: bitstring,sigPartS_3625: bitstring));
                                            {4154}if (verify(PartS_3624,sigPartS_3625,pkSess_3617) <> true) then
                                                0
                                            else
                                                {4155}event endCli(Sess,Cli,PartS_3624)
                                )
                                else
                                    {4156}let pkSess_3626: bitstring = fail-any in
                                    {4157}out(c, GetEndpointRequest);
                                    {4158}in(c, (SPs_3627: bitstring,=Sign,UP_3628: bitstring,=pkSess_3626));
                                    {4159}new SPc_3629: bitstring;
                                    {4160}new Nc_3630: bitstring;
                                    {4161}let gNc_3631: bitstring = exp(g,Nc_3630) in
                                    {4162}let m1_3632: bitstring = (SPc_3629,gNc_3631) in
                                    {4163}out(c, (pkCli_3430,m1_3632,sign(m1_3632,skCli_3429)));
                                    {4164}event beginCli(Cli,Sess,gNc_3631);
                                    {4165}in(c, (PartS_3633: bitstring,sigPartS_3634: bitstring));
                                    {4166}if (verify(PartS_3633,sigPartS_3634,pkSess_3626) <> true) then
                                        0
                                    else
                                        {4167}event endCli(Sess,Cli,PartS_3633)
                            )
                            else
                                {4168}let pkDisco_3635: bitstring = pub(skI) in
                                {4169}let v_3636: bool = (Sess = A) in
                                (
                                    {4170}if v_3636 then
                                    (
                                        {4171}let pkSess_3637: bitstring = pub(skA) in
                                        {4172}out(c, GetEndpointRequest);
                                        {4173}in(c, (SPs_3638: bitstring,=Sign,UP_3639: bitstring,=pkSess_3637));
                                        {4174}new SPc_3640: bitstring;
                                        {4175}new Nc_3641: bitstring;
                                        {4176}let gNc_3642: bitstring = exp(g,Nc_3641) in
                                        {4177}let m1_3643: bitstring = (SPc_3640,gNc_3642) in
                                        {4178}out(c, (pkCli_3430,m1_3643,sign(m1_3643,skCli_3429)));
                                        {4179}event beginCli(Cli,Sess,gNc_3642);
                                        {4180}in(c, (PartS_3644: bitstring,sigPartS_3645: bitstring));
                                        {4181}if (verify(PartS_3644,sigPartS_3645,pkSess_3637) <> true) then
                                            0
                                        else
                                            {4182}event endCli(Sess,Cli,PartS_3644)
                                    )
                                    else
                                        {4183}let v_3646: bool = (Sess = B) in
                                        (
                                            {4184}if v_3646 then
                                            (
                                                {4185}let pkSess_3647: bitstring = pub(skB) in
                                                {4186}out(c, GetEndpointRequest);
                                                {4187}in(c, (SPs_3648: bitstring,=Sign,UP_3649: bitstring,=pkSess_3647));
                                                {4188}new SPc_3650: bitstring;
                                                {4189}new Nc_3651: bitstring;
                                                {4190}let gNc_3652: bitstring = exp(g,Nc_3651) in
                                                {4191}let m1_3653: bitstring = (SPc_3650,gNc_3652) in
                                                {4192}out(c, (pkCli_3430,m1_3653,sign(m1_3653,skCli_3429)));
                                                {4193}event beginCli(Cli,Sess,gNc_3652);
                                                {4194}in(c, (PartS_3654: bitstring,sigPartS_3655: bitstring));
                                                {4195}if (verify(PartS_3654,sigPartS_3655,pkSess_3647) <> true) then
                                                    0
                                                else
                                                    {4196}event endCli(Sess,Cli,PartS_3654)
                                            )
                                            else
                                                {4197}let v_3656: bool = (Sess = C) in
                                                (
                                                    {4198}if v_3656 then
                                                    (
                                                        {4199}let pkSess_3657: bitstring = pub(skC) in
                                                        {4200}out(c, GetEndpointRequest);
                                                        {4201}in(c, (SPs_3658: bitstring,=Sign,UP_3659: bitstring,=pkSess_3657));
                                                        {4202}new SPc_3660: bitstring;
                                                        {4203}new Nc_3661: bitstring;
                                                        {4204}let gNc_3662: bitstring = exp(g,Nc_3661) in
                                                        {4205}let m1_3663: bitstring = (SPc_3660,gNc_3662) in
                                                        {4206}out(c, (pkCli_3430,m1_3663,sign(m1_3663,skCli_3429)));
                                                        {4207}event beginCli(Cli,Sess,gNc_3662);
                                                        {4208}in(c, (PartS_3664: bitstring,sigPartS_3665: bitstring));
                                                        {4209}if (verify(PartS_3664,sigPartS_3665,pkSess_3657) <> true) then
                                                            0
                                                        else
                                                            {4210}event endCli(Sess,Cli,PartS_3664)
                                                    )
                                                    else
                                                        {4211}let pkSess_3666: bitstring = pub(skI) in
                                                        {4212}out(c, GetEndpointRequest);
                                                        {4213}in(c, (SPs_3667: bitstring,=Sign,UP_3668: bitstring,=pkSess_3666));
                                                        {4214}new SPc_3669: bitstring;
                                                        {4215}new Nc_3670: bitstring;
                                                        {4216}let gNc_3671: bitstring = exp(g,Nc_3670) in
                                                        {4217}let m1_3672: bitstring = (SPc_3669,gNc_3671) in
                                                        {4218}out(c, (pkCli_3430,m1_3672,sign(m1_3672,skCli_3429)));
                                                        {4219}event beginCli(Cli,Sess,gNc_3671);
                                                        {4220}in(c, (PartS_3673: bitstring,sigPartS_3674: bitstring));
                                                        {4221}if (verify(PartS_3673,sigPartS_3674,pkSess_3666) <> true) then
                                                            0
                                                        else
                                                            {4222}event endCli(Sess,Cli,PartS_3673)
                                                )
                                                else
                                                    {4223}let pkSess_3675: bitstring = fail-any in
                                                    {4224}out(c, GetEndpointRequest);
                                                    {4225}in(c, (SPs_3676: bitstring,=Sign,UP_3677: bitstring,=pkSess_3675));
                                                    {4226}new SPc_3678: bitstring;
                                                    {4227}new Nc_3679: bitstring;
                                                    {4228}let gNc_3680: bitstring = exp(g,Nc_3679) in
                                                    {4229}let m1_3681: bitstring = (SPc_3678,gNc_3680) in
                                                    {4230}out(c, (pkCli_3430,m1_3681,sign(m1_3681,skCli_3429)));
                                                    {4231}event beginCli(Cli,Sess,gNc_3680);
                                                    {4232}in(c, (PartS_3682: bitstring,sigPartS_3683: bitstring));
                                                    {4233}if (verify(PartS_3682,sigPartS_3683,pkSess_3675) <> true) then
                                                        0
                                                    else
                                                        {4234}event endCli(Sess,Cli,PartS_3682)
                                        )
                                        else
                                            {4235}let pkSess_3684: bitstring = fail-any in
                                            {4236}out(c, GetEndpointRequest);
                                            {4237}in(c, (SPs_3685: bitstring,=Sign,UP_3686: bitstring,=pkSess_3684));
                                            {4238}new SPc_3687: bitstring;
                                            {4239}new Nc_3688: bitstring;
                                            {4240}let gNc_3689: bitstring = exp(g,Nc_3688) in
                                            {4241}let m1_3690: bitstring = (SPc_3687,gNc_3689) in
                                            {4242}out(c, (pkCli_3430,m1_3690,sign(m1_3690,skCli_3429)));
                                            {4243}event beginCli(Cli,Sess,gNc_3689);
                                            {4244}in(c, (PartS_3691: bitstring,sigPartS_3692: bitstring));
                                            {4245}if (verify(PartS_3691,sigPartS_3692,pkSess_3684) <> true) then
                                                0
                                            else
                                                {4246}event endCli(Sess,Cli,PartS_3691)
                                )
                                else
                                    {4247}let pkSess_3693: bitstring = fail-any in
                                    {4248}out(c, GetEndpointRequest);
                                    {4249}in(c, (SPs_3694: bitstring,=Sign,UP_3695: bitstring,=pkSess_3693));
                                    {4250}new SPc_3696: bitstring;
                                    {4251}new Nc_3697: bitstring;
                                    {4252}let gNc_3698: bitstring = exp(g,Nc_3697) in
                                    {4253}let m1_3699: bitstring = (SPc_3696,gNc_3698) in
                                    {4254}out(c, (pkCli_3430,m1_3699,sign(m1_3699,skCli_3429)));
                                    {4255}event beginCli(Cli,Sess,gNc_3698);
                                    {4256}in(c, (PartS_3700: bitstring,sigPartS_3701: bitstring));
                                    {4257}if (verify(PartS_3700,sigPartS_3701,pkSess_3693) <> true) then
                                        0
                                    else
                                        {4258}event endCli(Sess,Cli,PartS_3700)
                        )
                        else
                            {4259}let pkDisco_3702: bitstring = fail-any in
                            {4260}let v_3703: bool = (Sess = A) in
                            (
                                {4261}if v_3703 then
                                (
                                    {4262}let pkSess_3704: bitstring = pub(skA) in
                                    {4263}out(c, GetEndpointRequest);
                                    {4264}in(c, (SPs_3705: bitstring,=Sign,UP_3706: bitstring,=pkSess_3704));
                                    {4265}new SPc_3707: bitstring;
                                    {4266}new Nc_3708: bitstring;
                                    {4267}let gNc_3709: bitstring = exp(g,Nc_3708) in
                                    {4268}let m1_3710: bitstring = (SPc_3707,gNc_3709) in
                                    {4269}out(c, (pkCli_3430,m1_3710,sign(m1_3710,skCli_3429)));
                                    {4270}event beginCli(Cli,Sess,gNc_3709);
                                    {4271}in(c, (PartS_3711: bitstring,sigPartS_3712: bitstring));
                                    {4272}if (verify(PartS_3711,sigPartS_3712,pkSess_3704) <> true) then
                                        0
                                    else
                                        {4273}event endCli(Sess,Cli,PartS_3711)
                                )
                                else
                                    {4274}let v_3713: bool = (Sess = B) in
                                    (
                                        {4275}if v_3713 then
                                        (
                                            {4276}let pkSess_3714: bitstring = pub(skB) in
                                            {4277}out(c, GetEndpointRequest);
                                            {4278}in(c, (SPs_3715: bitstring,=Sign,UP_3716: bitstring,=pkSess_3714));
                                            {4279}new SPc_3717: bitstring;
                                            {4280}new Nc_3718: bitstring;
                                            {4281}let gNc_3719: bitstring = exp(g,Nc_3718) in
                                            {4282}let m1_3720: bitstring = (SPc_3717,gNc_3719) in
                                            {4283}out(c, (pkCli_3430,m1_3720,sign(m1_3720,skCli_3429)));
                                            {4284}event beginCli(Cli,Sess,gNc_3719);
                                            {4285}in(c, (PartS_3721: bitstring,sigPartS_3722: bitstring));
                                            {4286}if (verify(PartS_3721,sigPartS_3722,pkSess_3714) <> true) then
                                                0
                                            else
                                                {4287}event endCli(Sess,Cli,PartS_3721)
                                        )
                                        else
                                            {4288}let v_3723: bool = (Sess = C) in
                                            (
                                                {4289}if v_3723 then
                                                (
                                                    {4290}let pkSess_3724: bitstring = pub(skC) in
                                                    {4291}out(c, GetEndpointRequest);
                                                    {4292}in(c, (SPs_3725: bitstring,=Sign,UP_3726: bitstring,=pkSess_3724));
                                                    {4293}new SPc_3727: bitstring;
                                                    {4294}new Nc_3728: bitstring;
                                                    {4295}let gNc_3729: bitstring = exp(g,Nc_3728) in
                                                    {4296}let m1_3730: bitstring = (SPc_3727,gNc_3729) in
                                                    {4297}out(c, (pkCli_3430,m1_3730,sign(m1_3730,skCli_3429)));
                                                    {4298}event beginCli(Cli,Sess,gNc_3729);
                                                    {4299}in(c, (PartS_3731: bitstring,sigPartS_3732: bitstring));
                                                    {4300}if (verify(PartS_3731,sigPartS_3732,pkSess_3724) <> true) then
                                                        0
                                                    else
                                                        {4301}event endCli(Sess,Cli,PartS_3731)
                                                )
                                                else
                                                    {4302}let pkSess_3733: bitstring = pub(skI) in
                                                    {4303}out(c, GetEndpointRequest);
                                                    {4304}in(c, (SPs_3734: bitstring,=Sign,UP_3735: bitstring,=pkSess_3733));
                                                    {4305}new SPc_3736: bitstring;
                                                    {4306}new Nc_3737: bitstring;
                                                    {4307}let gNc_3738: bitstring = exp(g,Nc_3737) in
                                                    {4308}let m1_3739: bitstring = (SPc_3736,gNc_3738) in
                                                    {4309}out(c, (pkCli_3430,m1_3739,sign(m1_3739,skCli_3429)));
                                                    {4310}event beginCli(Cli,Sess,gNc_3738);
                                                    {4311}in(c, (PartS_3740: bitstring,sigPartS_3741: bitstring));
                                                    {4312}if (verify(PartS_3740,sigPartS_3741,pkSess_3733) <> true) then
                                                        0
                                                    else
                                                        {4313}event endCli(Sess,Cli,PartS_3740)
                                            )
                                            else
                                                {4314}let pkSess_3742: bitstring = fail-any in
                                                {4315}out(c, GetEndpointRequest);
                                                {4316}in(c, (SPs_3743: bitstring,=Sign,UP_3744: bitstring,=pkSess_3742));
                                                {4317}new SPc_3745: bitstring;
                                                {4318}new Nc_3746: bitstring;
                                                {4319}let gNc_3747: bitstring = exp(g,Nc_3746) in
                                                {4320}let m1_3748: bitstring = (SPc_3745,gNc_3747) in
                                                {4321}out(c, (pkCli_3430,m1_3748,sign(m1_3748,skCli_3429)));
                                                {4322}event beginCli(Cli,Sess,gNc_3747);
                                                {4323}in(c, (PartS_3749: bitstring,sigPartS_3750: bitstring));
                                                {4324}if (verify(PartS_3749,sigPartS_3750,pkSess_3742) <> true) then
                                                    0
                                                else
                                                    {4325}event endCli(Sess,Cli,PartS_3749)
                                    )
                                    else
                                        {4326}let pkSess_3751: bitstring = fail-any in
                                        {4327}out(c, GetEndpointRequest);
                                        {4328}in(c, (SPs_3752: bitstring,=Sign,UP_3753: bitstring,=pkSess_3751));
                                        {4329}new SPc_3754: bitstring;
                                        {4330}new Nc_3755: bitstring;
                                        {4331}let gNc_3756: bitstring = exp(g,Nc_3755) in
                                        {4332}let m1_3757: bitstring = (SPc_3754,gNc_3756) in
                                        {4333}out(c, (pkCli_3430,m1_3757,sign(m1_3757,skCli_3429)));
                                        {4334}event beginCli(Cli,Sess,gNc_3756);
                                        {4335}in(c, (PartS_3758: bitstring,sigPartS_3759: bitstring));
                                        {4336}if (verify(PartS_3758,sigPartS_3759,pkSess_3751) <> true) then
                                            0
                                        else
                                            {4337}event endCli(Sess,Cli,PartS_3758)
                            )
                            else
                                {4338}let pkSess_3760: bitstring = fail-any in
                                {4339}out(c, GetEndpointRequest);
                                {4340}in(c, (SPs_3761: bitstring,=Sign,UP_3762: bitstring,=pkSess_3760));
                                {4341}new SPc_3763: bitstring;
                                {4342}new Nc_3764: bitstring;
                                {4343}let gNc_3765: bitstring = exp(g,Nc_3764) in
                                {4344}let m1_3766: bitstring = (SPc_3763,gNc_3765) in
                                {4345}out(c, (pkCli_3430,m1_3766,sign(m1_3766,skCli_3429)));
                                {4346}event beginCli(Cli,Sess,gNc_3765);
                                {4347}in(c, (PartS_3767: bitstring,sigPartS_3768: bitstring));
                                {4348}if (verify(PartS_3767,sigPartS_3768,pkSess_3760) <> true) then
                                    0
                                else
                                    {4349}event endCli(Sess,Cli,PartS_3767)
                )
                else
                    {4350}let pkDisco_3769: bitstring = fail-any in
                    {4351}let v_3770: bool = (Sess = A) in
                    (
                        {4352}if v_3770 then
                        (
                            {4353}let pkSess_3771: bitstring = pub(skA) in
                            {4354}out(c, GetEndpointRequest);
                            {4355}in(c, (SPs_3772: bitstring,=Sign,UP_3773: bitstring,=pkSess_3771));
                            {4356}new SPc_3774: bitstring;
                            {4357}new Nc_3775: bitstring;
                            {4358}let gNc_3776: bitstring = exp(g,Nc_3775) in
                            {4359}let m1_3777: bitstring = (SPc_3774,gNc_3776) in
                            {4360}out(c, (pkCli_3430,m1_3777,sign(m1_3777,skCli_3429)));
                            {4361}event beginCli(Cli,Sess,gNc_3776);
                            {4362}in(c, (PartS_3778: bitstring,sigPartS_3779: bitstring));
                            {4363}if (verify(PartS_3778,sigPartS_3779,pkSess_3771) <> true) then
                                0
                            else
                                {4364}event endCli(Sess,Cli,PartS_3778)
                        )
                        else
                            {4365}let v_3780: bool = (Sess = B) in
                            (
                                {4366}if v_3780 then
                                (
                                    {4367}let pkSess_3781: bitstring = pub(skB) in
                                    {4368}out(c, GetEndpointRequest);
                                    {4369}in(c, (SPs_3782: bitstring,=Sign,UP_3783: bitstring,=pkSess_3781));
                                    {4370}new SPc_3784: bitstring;
                                    {4371}new Nc_3785: bitstring;
                                    {4372}let gNc_3786: bitstring = exp(g,Nc_3785) in
                                    {4373}let m1_3787: bitstring = (SPc_3784,gNc_3786) in
                                    {4374}out(c, (pkCli_3430,m1_3787,sign(m1_3787,skCli_3429)));
                                    {4375}event beginCli(Cli,Sess,gNc_3786);
                                    {4376}in(c, (PartS_3788: bitstring,sigPartS_3789: bitstring));
                                    {4377}if (verify(PartS_3788,sigPartS_3789,pkSess_3781) <> true) then
                                        0
                                    else
                                        {4378}event endCli(Sess,Cli,PartS_3788)
                                )
                                else
                                    {4379}let v_3790: bool = (Sess = C) in
                                    (
                                        {4380}if v_3790 then
                                        (
                                            {4381}let pkSess_3791: bitstring = pub(skC) in
                                            {4382}out(c, GetEndpointRequest);
                                            {4383}in(c, (SPs_3792: bitstring,=Sign,UP_3793: bitstring,=pkSess_3791));
                                            {4384}new SPc_3794: bitstring;
                                            {4385}new Nc_3795: bitstring;
                                            {4386}let gNc_3796: bitstring = exp(g,Nc_3795) in
                                            {4387}let m1_3797: bitstring = (SPc_3794,gNc_3796) in
                                            {4388}out(c, (pkCli_3430,m1_3797,sign(m1_3797,skCli_3429)));
                                            {4389}event beginCli(Cli,Sess,gNc_3796);
                                            {4390}in(c, (PartS_3798: bitstring,sigPartS_3799: bitstring));
                                            {4391}if (verify(PartS_3798,sigPartS_3799,pkSess_3791) <> true) then
                                                0
                                            else
                                                {4392}event endCli(Sess,Cli,PartS_3798)
                                        )
                                        else
                                            {4393}let pkSess_3800: bitstring = pub(skI) in
                                            {4394}out(c, GetEndpointRequest);
                                            {4395}in(c, (SPs_3801: bitstring,=Sign,UP_3802: bitstring,=pkSess_3800));
                                            {4396}new SPc_3803: bitstring;
                                            {4397}new Nc_3804: bitstring;
                                            {4398}let gNc_3805: bitstring = exp(g,Nc_3804) in
                                            {4399}let m1_3806: bitstring = (SPc_3803,gNc_3805) in
                                            {4400}out(c, (pkCli_3430,m1_3806,sign(m1_3806,skCli_3429)));
                                            {4401}event beginCli(Cli,Sess,gNc_3805);
                                            {4402}in(c, (PartS_3807: bitstring,sigPartS_3808: bitstring));
                                            {4403}if (verify(PartS_3807,sigPartS_3808,pkSess_3800) <> true) then
                                                0
                                            else
                                                {4404}event endCli(Sess,Cli,PartS_3807)
                                    )
                                    else
                                        {4405}let pkSess_3809: bitstring = fail-any in
                                        {4406}out(c, GetEndpointRequest);
                                        {4407}in(c, (SPs_3810: bitstring,=Sign,UP_3811: bitstring,=pkSess_3809));
                                        {4408}new SPc_3812: bitstring;
                                        {4409}new Nc_3813: bitstring;
                                        {4410}let gNc_3814: bitstring = exp(g,Nc_3813) in
                                        {4411}let m1_3815: bitstring = (SPc_3812,gNc_3814) in
                                        {4412}out(c, (pkCli_3430,m1_3815,sign(m1_3815,skCli_3429)));
                                        {4413}event beginCli(Cli,Sess,gNc_3814);
                                        {4414}in(c, (PartS_3816: bitstring,sigPartS_3817: bitstring));
                                        {4415}if (verify(PartS_3816,sigPartS_3817,pkSess_3809) <> true) then
                                            0
                                        else
                                            {4416}event endCli(Sess,Cli,PartS_3816)
                            )
                            else
                                {4417}let pkSess_3818: bitstring = fail-any in
                                {4418}out(c, GetEndpointRequest);
                                {4419}in(c, (SPs_3819: bitstring,=Sign,UP_3820: bitstring,=pkSess_3818));
                                {4420}new SPc_3821: bitstring;
                                {4421}new Nc_3822: bitstring;
                                {4422}let gNc_3823: bitstring = exp(g,Nc_3822) in
                                {4423}let m1_3824: bitstring = (SPc_3821,gNc_3823) in
                                {4424}out(c, (pkCli_3430,m1_3824,sign(m1_3824,skCli_3429)));
                                {4425}event beginCli(Cli,Sess,gNc_3823);
                                {4426}in(c, (PartS_3825: bitstring,sigPartS_3826: bitstring));
                                {4427}if (verify(PartS_3825,sigPartS_3826,pkSess_3818) <> true) then
                                    0
                                else
                                    {4428}event endCli(Sess,Cli,PartS_3825)
                    )
                    else
                        {4429}let pkSess_3827: bitstring = fail-any in
                        {4430}out(c, GetEndpointRequest);
                        {4431}in(c, (SPs_3828: bitstring,=Sign,UP_3829: bitstring,=pkSess_3827));
                        {4432}new SPc_3830: bitstring;
                        {4433}new Nc_3831: bitstring;
                        {4434}let gNc_3832: bitstring = exp(g,Nc_3831) in
                        {4435}let m1_3833: bitstring = (SPc_3830,gNc_3832) in
                        {4436}out(c, (pkCli_3430,m1_3833,sign(m1_3833,skCli_3429)));
                        {4437}event beginCli(Cli,Sess,gNc_3832);
                        {4438}in(c, (PartS_3834: bitstring,sigPartS_3835: bitstring));
                        {4439}if (verify(PartS_3834,sigPartS_3835,pkSess_3827) <> true) then
                            0
                        else
                            {4440}event endCli(Sess,Cli,PartS_3834)
        )
        else
            {4441}let pkDisco_3836: bitstring = fail-any in
            {4442}let v_3837: bool = (Sess = A) in
            (
                {4443}if v_3837 then
                (
                    {4444}let pkSess_3838: bitstring = pub(skA) in
                    {4445}out(c, GetEndpointRequest);
                    {4446}in(c, (SPs_3839: bitstring,=Sign,UP_3840: bitstring,=pkSess_3838));
                    {4447}new SPc_3841: bitstring;
                    {4448}new Nc_3842: bitstring;
                    {4449}let gNc_3843: bitstring = exp(g,Nc_3842) in
                    {4450}let m1_3844: bitstring = (SPc_3841,gNc_3843) in
                    {4451}out(c, (pkCli_3430,m1_3844,sign(m1_3844,skCli_3429)));
                    {4452}event beginCli(Cli,Sess,gNc_3843);
                    {4453}in(c, (PartS_3845: bitstring,sigPartS_3846: bitstring));
                    {4454}if (verify(PartS_3845,sigPartS_3846,pkSess_3838) <> true) then
                        0
                    else
                        {4455}event endCli(Sess,Cli,PartS_3845)
                )
                else
                    {4456}let v_3847: bool = (Sess = B) in
                    (
                        {4457}if v_3847 then
                        (
                            {4458}let pkSess_3848: bitstring = pub(skB) in
                            {4459}out(c, GetEndpointRequest);
                            {4460}in(c, (SPs_3849: bitstring,=Sign,UP_3850: bitstring,=pkSess_3848));
                            {4461}new SPc_3851: bitstring;
                            {4462}new Nc_3852: bitstring;
                            {4463}let gNc_3853: bitstring = exp(g,Nc_3852) in
                            {4464}let m1_3854: bitstring = (SPc_3851,gNc_3853) in
                            {4465}out(c, (pkCli_3430,m1_3854,sign(m1_3854,skCli_3429)));
                            {4466}event beginCli(Cli,Sess,gNc_3853);
                            {4467}in(c, (PartS_3855: bitstring,sigPartS_3856: bitstring));
                            {4468}if (verify(PartS_3855,sigPartS_3856,pkSess_3848) <> true) then
                                0
                            else
                                {4469}event endCli(Sess,Cli,PartS_3855)
                        )
                        else
                            {4470}let v_3857: bool = (Sess = C) in
                            (
                                {4471}if v_3857 then
                                (
                                    {4472}let pkSess_3858: bitstring = pub(skC) in
                                    {4473}out(c, GetEndpointRequest);
                                    {4474}in(c, (SPs_3859: bitstring,=Sign,UP_3860: bitstring,=pkSess_3858));
                                    {4475}new SPc_3861: bitstring;
                                    {4476}new Nc_3862: bitstring;
                                    {4477}let gNc_3863: bitstring = exp(g,Nc_3862) in
                                    {4478}let m1_3864: bitstring = (SPc_3861,gNc_3863) in
                                    {4479}out(c, (pkCli_3430,m1_3864,sign(m1_3864,skCli_3429)));
                                    {4480}event beginCli(Cli,Sess,gNc_3863);
                                    {4481}in(c, (PartS_3865: bitstring,sigPartS_3866: bitstring));
                                    {4482}if (verify(PartS_3865,sigPartS_3866,pkSess_3858) <> true) then
                                        0
                                    else
                                        {4483}event endCli(Sess,Cli,PartS_3865)
                                )
                                else
                                    {4484}let pkSess_3867: bitstring = pub(skI) in
                                    {4485}out(c, GetEndpointRequest);
                                    {4486}in(c, (SPs_3868: bitstring,=Sign,UP_3869: bitstring,=pkSess_3867));
                                    {4487}new SPc_3870: bitstring;
                                    {4488}new Nc_3871: bitstring;
                                    {4489}let gNc_3872: bitstring = exp(g,Nc_3871) in
                                    {4490}let m1_3873: bitstring = (SPc_3870,gNc_3872) in
                                    {4491}out(c, (pkCli_3430,m1_3873,sign(m1_3873,skCli_3429)));
                                    {4492}event beginCli(Cli,Sess,gNc_3872);
                                    {4493}in(c, (PartS_3874: bitstring,sigPartS_3875: bitstring));
                                    {4494}if (verify(PartS_3874,sigPartS_3875,pkSess_3867) <> true) then
                                        0
                                    else
                                        {4495}event endCli(Sess,Cli,PartS_3874)
                            )
                            else
                                {4496}let pkSess_3876: bitstring = fail-any in
                                {4497}out(c, GetEndpointRequest);
                                {4498}in(c, (SPs_3877: bitstring,=Sign,UP_3878: bitstring,=pkSess_3876));
                                {4499}new SPc_3879: bitstring;
                                {4500}new Nc_3880: bitstring;
                                {4501}let gNc_3881: bitstring = exp(g,Nc_3880) in
                                {4502}let m1_3882: bitstring = (SPc_3879,gNc_3881) in
                                {4503}out(c, (pkCli_3430,m1_3882,sign(m1_3882,skCli_3429)));
                                {4504}event beginCli(Cli,Sess,gNc_3881);
                                {4505}in(c, (PartS_3883: bitstring,sigPartS_3884: bitstring));
                                {4506}if (verify(PartS_3883,sigPartS_3884,pkSess_3876) <> true) then
                                    0
                                else
                                    {4507}event endCli(Sess,Cli,PartS_3883)
                    )
                    else
                        {4508}let pkSess_3885: bitstring = fail-any in
                        {4509}out(c, GetEndpointRequest);
                        {4510}in(c, (SPs_3886: bitstring,=Sign,UP_3887: bitstring,=pkSess_3885));
                        {4511}new SPc_3888: bitstring;
                        {4512}new Nc_3889: bitstring;
                        {4513}let gNc_3890: bitstring = exp(g,Nc_3889) in
                        {4514}let m1_3891: bitstring = (SPc_3888,gNc_3890) in
                        {4515}out(c, (pkCli_3430,m1_3891,sign(m1_3891,skCli_3429)));
                        {4516}event beginCli(Cli,Sess,gNc_3890);
                        {4517}in(c, (PartS_3892: bitstring,sigPartS_3893: bitstring));
                        {4518}if (verify(PartS_3892,sigPartS_3893,pkSess_3885) <> true) then
                            0
                        else
                            {4519}event endCli(Sess,Cli,PartS_3892)
            )
            else
                {4520}let pkSess_3894: bitstring = fail-any in
                {4521}out(c, GetEndpointRequest);
                {4522}in(c, (SPs_3895: bitstring,=Sign,UP_3896: bitstring,=pkSess_3894));
                {4523}new SPc_3897: bitstring;
                {4524}new Nc_3898: bitstring;
                {4525}let gNc_3899: bitstring = exp(g,Nc_3898) in
                {4526}let m1_3900: bitstring = (SPc_3897,gNc_3899) in
                {4527}out(c, (pkCli_3430,m1_3900,sign(m1_3900,skCli_3429)));
                {4528}event beginCli(Cli,Sess,gNc_3899);
                {4529}in(c, (PartS_3901: bitstring,sigPartS_3902: bitstring));
                {4530}if (verify(PartS_3901,sigPartS_3902,pkSess_3894) <> true) then
                    0
                else
                    {4531}event endCli(Sess,Cli,PartS_3901)
) | (
    {4532}!
    {4533}in(c, (Cli_3903: host,Disco_3904: host,Sess_3905: host));
    {4534}let v_3906: bool = (Disco_3904 = A) in
    (
        {4535}if v_3906 then
        (
            {4536}let skDisco: bitstring = skA in
            {4537}let pkDisco_3907: bitstring = pub(skDisco) in
            {4538}let v_3908: bool = (Cli_3903 = A) in
            (
                {4539}if v_3908 then
                (
                    {4540}let pkCli_3909: bitstring = pub(skA) in
                    {4541}let v_3910: bool = (Sess_3905 = A) in
                    (
                        {4542}if v_3910 then
                        (
                            {4543}let pkSess_3911: bitstring = pub(skA) in
                            {4544}in(c, =GetEndpointRequest);
                            {4545}new SPs_3912: bitstring;
                            {4546}new UP_3913: bitstring;
                            {4547}out(c, (SPs_3912,SignAndEncrypt,UP_3913,pkSess_3911))
                        )
                        else
                            {4548}let v_3914: bool = (Sess_3905 = B) in
                            (
                                {4549}if v_3914 then
                                (
                                    {4550}let pkSess_3915: bitstring = pub(skB) in
                                    {4551}in(c, =GetEndpointRequest);
                                    {4552}new SPs_3916: bitstring;
                                    {4553}new UP_3917: bitstring;
                                    {4554}out(c, (SPs_3916,SignAndEncrypt,UP_3917,pkSess_3915))
                                )
                                else
                                    {4555}let v_3918: bool = (Sess_3905 = C) in
                                    (
                                        {4556}if v_3918 then
                                        (
                                            {4557}let pkSess_3919: bitstring = pub(skC) in
                                            {4558}in(c, =GetEndpointRequest);
                                            {4559}new SPs_3920: bitstring;
                                            {4560}new UP_3921: bitstring;
                                            {4561}out(c, (SPs_3920,SignAndEncrypt,UP_3921,pkSess_3919))
                                        )
                                        else
                                            {4562}let pkSess_3922: bitstring = pub(skI) in
                                            {4563}in(c, =GetEndpointRequest);
                                            {4564}new SPs_3923: bitstring;
                                            {4565}new UP_3924: bitstring;
                                            {4566}out(c, (SPs_3923,SignAndEncrypt,UP_3924,pkSess_3922))
                                    )
                                    else
                                        {4567}let pkSess_3925: bitstring = fail-any in
                                        {4568}in(c, =GetEndpointRequest);
                                        {4569}new SPs_3926: bitstring;
                                        {4570}new UP_3927: bitstring;
                                        {4571}out(c, (SPs_3926,SignAndEncrypt,UP_3927,pkSess_3925))
                            )
                            else
                                {4572}let pkSess_3928: bitstring = fail-any in
                                {4573}in(c, =GetEndpointRequest);
                                {4574}new SPs_3929: bitstring;
                                {4575}new UP_3930: bitstring;
                                {4576}out(c, (SPs_3929,SignAndEncrypt,UP_3930,pkSess_3928))
                    )
                    else
                        {4577}let pkSess_3931: bitstring = fail-any in
                        {4578}in(c, =GetEndpointRequest);
                        {4579}new SPs_3932: bitstring;
                        {4580}new UP_3933: bitstring;
                        {4581}out(c, (SPs_3932,SignAndEncrypt,UP_3933,pkSess_3931))
                )
                else
                    {4582}let v_3934: bool = (Cli_3903 = B) in
                    (
                        {4583}if v_3934 then
                        (
                            {4584}let pkCli_3935: bitstring = pub(skB) in
                            {4585}let v_3936: bool = (Sess_3905 = A) in
                            (
                                {4586}if v_3936 then
                                (
                                    {4587}let pkSess_3937: bitstring = pub(skA) in
                                    {4588}in(c, =GetEndpointRequest);
                                    {4589}new SPs_3938: bitstring;
                                    {4590}new UP_3939: bitstring;
                                    {4591}out(c, (SPs_3938,SignAndEncrypt,UP_3939,pkSess_3937))
                                )
                                else
                                    {4592}let v_3940: bool = (Sess_3905 = B) in
                                    (
                                        {4593}if v_3940 then
                                        (
                                            {4594}let pkSess_3941: bitstring = pub(skB) in
                                            {4595}in(c, =GetEndpointRequest);
                                            {4596}new SPs_3942: bitstring;
                                            {4597}new UP_3943: bitstring;
                                            {4598}out(c, (SPs_3942,SignAndEncrypt,UP_3943,pkSess_3941))
                                        )
                                        else
                                            {4599}let v_3944: bool = (Sess_3905 = C) in
                                            (
                                                {4600}if v_3944 then
                                                (
                                                    {4601}let pkSess_3945: bitstring = pub(skC) in
                                                    {4602}in(c, =GetEndpointRequest);
                                                    {4603}new SPs_3946: bitstring;
                                                    {4604}new UP_3947: bitstring;
                                                    {4605}out(c, (SPs_3946,SignAndEncrypt,UP_3947,pkSess_3945))
                                                )
                                                else
                                                    {4606}let pkSess_3948: bitstring = pub(skI) in
                                                    {4607}in(c, =GetEndpointRequest);
                                                    {4608}new SPs_3949: bitstring;
                                                    {4609}new UP_3950: bitstring;
                                                    {4610}out(c, (SPs_3949,SignAndEncrypt,UP_3950,pkSess_3948))
                                            )
                                            else
                                                {4611}let pkSess_3951: bitstring = fail-any in
                                                {4612}in(c, =GetEndpointRequest);
                                                {4613}new SPs_3952: bitstring;
                                                {4614}new UP_3953: bitstring;
                                                {4615}out(c, (SPs_3952,SignAndEncrypt,UP_3953,pkSess_3951))
                                    )
                                    else
                                        {4616}let pkSess_3954: bitstring = fail-any in
                                        {4617}in(c, =GetEndpointRequest);
                                        {4618}new SPs_3955: bitstring;
                                        {4619}new UP_3956: bitstring;
                                        {4620}out(c, (SPs_3955,SignAndEncrypt,UP_3956,pkSess_3954))
                            )
                            else
                                {4621}let pkSess_3957: bitstring = fail-any in
                                {4622}in(c, =GetEndpointRequest);
                                {4623}new SPs_3958: bitstring;
                                {4624}new UP_3959: bitstring;
                                {4625}out(c, (SPs_3958,SignAndEncrypt,UP_3959,pkSess_3957))
                        )
                        else
                            {4626}let v_3960: bool = (Cli_3903 = C) in
                            (
                                {4627}if v_3960 then
                                (
                                    {4628}let pkCli_3961: bitstring = pub(skC) in
                                    {4629}let v_3962: bool = (Sess_3905 = A) in
                                    (
                                        {4630}if v_3962 then
                                        (
                                            {4631}let pkSess_3963: bitstring = pub(skA) in
                                            {4632}in(c, =GetEndpointRequest);
                                            {4633}new SPs_3964: bitstring;
                                            {4634}new UP_3965: bitstring;
                                            {4635}out(c, (SPs_3964,SignAndEncrypt,UP_3965,pkSess_3963))
                                        )
                                        else
                                            {4636}let v_3966: bool = (Sess_3905 = B) in
                                            (
                                                {4637}if v_3966 then
                                                (
                                                    {4638}let pkSess_3967: bitstring = pub(skB) in
                                                    {4639}in(c, =GetEndpointRequest);
                                                    {4640}new SPs_3968: bitstring;
                                                    {4641}new UP_3969: bitstring;
                                                    {4642}out(c, (SPs_3968,SignAndEncrypt,UP_3969,pkSess_3967))
                                                )
                                                else
                                                    {4643}let v_3970: bool = (Sess_3905 = C) in
                                                    (
                                                        {4644}if v_3970 then
                                                        (
                                                            {4645}let pkSess_3971: bitstring = pub(skC) in
                                                            {4646}in(c, =GetEndpointRequest);
                                                            {4647}new SPs_3972: bitstring;
                                                            {4648}new UP_3973: bitstring;
                                                            {4649}out(c, (SPs_3972,SignAndEncrypt,UP_3973,pkSess_3971))
                                                        )
                                                        else
                                                            {4650}let pkSess_3974: bitstring = pub(skI) in
                                                            {4651}in(c, =GetEndpointRequest);
                                                            {4652}new SPs_3975: bitstring;
                                                            {4653}new UP_3976: bitstring;
                                                            {4654}out(c, (SPs_3975,SignAndEncrypt,UP_3976,pkSess_3974))
                                                    )
                                                    else
                                                        {4655}let pkSess_3977: bitstring = fail-any in
                                                        {4656}in(c, =GetEndpointRequest);
                                                        {4657}new SPs_3978: bitstring;
                                                        {4658}new UP_3979: bitstring;
                                                        {4659}out(c, (SPs_3978,SignAndEncrypt,UP_3979,pkSess_3977))
                                            )
                                            else
                                                {4660}let pkSess_3980: bitstring = fail-any in
                                                {4661}in(c, =GetEndpointRequest);
                                                {4662}new SPs_3981: bitstring;
                                                {4663}new UP_3982: bitstring;
                                                {4664}out(c, (SPs_3981,SignAndEncrypt,UP_3982,pkSess_3980))
                                    )
                                    else
                                        {4665}let pkSess_3983: bitstring = fail-any in
                                        {4666}in(c, =GetEndpointRequest);
                                        {4667}new SPs_3984: bitstring;
                                        {4668}new UP_3985: bitstring;
                                        {4669}out(c, (SPs_3984,SignAndEncrypt,UP_3985,pkSess_3983))
                                )
                                else
                                    {4670}let pkCli_3986: bitstring = pub(skI) in
                                    {4671}let v_3987: bool = (Sess_3905 = A) in
                                    (
                                        {4672}if v_3987 then
                                        (
                                            {4673}let pkSess_3988: bitstring = pub(skA) in
                                            {4674}in(c, =GetEndpointRequest);
                                            {4675}new SPs_3989: bitstring;
                                            {4676}new UP_3990: bitstring;
                                            {4677}out(c, (SPs_3989,SignAndEncrypt,UP_3990,pkSess_3988))
                                        )
                                        else
                                            {4678}let v_3991: bool = (Sess_3905 = B) in
                                            (
                                                {4679}if v_3991 then
                                                (
                                                    {4680}let pkSess_3992: bitstring = pub(skB) in
                                                    {4681}in(c, =GetEndpointRequest);
                                                    {4682}new SPs_3993: bitstring;
                                                    {4683}new UP_3994: bitstring;
                                                    {4684}out(c, (SPs_3993,SignAndEncrypt,UP_3994,pkSess_3992))
                                                )
                                                else
                                                    {4685}let v_3995: bool = (Sess_3905 = C) in
                                                    (
                                                        {4686}if v_3995 then
                                                        (
                                                            {4687}let pkSess_3996: bitstring = pub(skC) in
                                                            {4688}in(c, =GetEndpointRequest);
                                                            {4689}new SPs_3997: bitstring;
                                                            {4690}new UP_3998: bitstring;
                                                            {4691}out(c, (SPs_3997,SignAndEncrypt,UP_3998,pkSess_3996))
                                                        )
                                                        else
                                                            {4692}let pkSess_3999: bitstring = pub(skI) in
                                                            {4693}in(c, =GetEndpointRequest);
                                                            {4694}new SPs_4000: bitstring;
                                                            {4695}new UP_4001: bitstring;
                                                            {4696}out(c, (SPs_4000,SignAndEncrypt,UP_4001,pkSess_3999))
                                                    )
                                                    else
                                                        {4697}let pkSess_4002: bitstring = fail-any in
                                                        {4698}in(c, =GetEndpointRequest);
                                                        {4699}new SPs_4003: bitstring;
                                                        {4700}new UP_4004: bitstring;
                                                        {4701}out(c, (SPs_4003,SignAndEncrypt,UP_4004,pkSess_4002))
                                            )
                                            else
                                                {4702}let pkSess_4005: bitstring = fail-any in
                                                {4703}in(c, =GetEndpointRequest);
                                                {4704}new SPs_4006: bitstring;
                                                {4705}new UP_4007: bitstring;
                                                {4706}out(c, (SPs_4006,SignAndEncrypt,UP_4007,pkSess_4005))
                                    )
                                    else
                                        {4707}let pkSess_4008: bitstring = fail-any in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SPs_4009: bitstring;
                                        {4710}new UP_4010: bitstring;
                                        {4711}out(c, (SPs_4009,SignAndEncrypt,UP_4010,pkSess_4008))
                            )
                            else
                                {4712}let pkCli_4011: bitstring = fail-any in
                                {4713}let v_4012: bool = (Sess_3905 = A) in
                                (
                                    {4714}if v_4012 then
                                    (
                                        {4715}let pkSess_4013: bitstring = pub(skA) in
                                        {4716}in(c, =GetEndpointRequest);
                                        {4717}new SPs_4014: bitstring;
                                        {4718}new UP_4015: bitstring;
                                        {4719}out(c, (SPs_4014,SignAndEncrypt,UP_4015,pkSess_4013))
                                    )
                                    else
                                        {4720}let v_4016: bool = (Sess_3905 = B) in
                                        (
                                            {4721}if v_4016 then
                                            (
                                                {4722}let pkSess_4017: bitstring = pub(skB) in
                                                {4723}in(c, =GetEndpointRequest);
                                                {4724}new SPs_4018: bitstring;
                                                {4725}new UP_4019: bitstring;
                                                {4726}out(c, (SPs_4018,SignAndEncrypt,UP_4019,pkSess_4017))
                                            )
                                            else
                                                {4727}let v_4020: bool = (Sess_3905 = C) in
                                                (
                                                    {4728}if v_4020 then
                                                    (
                                                        {4729}let pkSess_4021: bitstring = pub(skC) in
                                                        {4730}in(c, =GetEndpointRequest);
                                                        {4731}new SPs_4022: bitstring;
                                                        {4732}new UP_4023: bitstring;
                                                        {4733}out(c, (SPs_4022,SignAndEncrypt,UP_4023,pkSess_4021))
                                                    )
                                                    else
                                                        {4734}let pkSess_4024: bitstring = pub(skI) in
                                                        {4735}in(c, =GetEndpointRequest);
                                                        {4736}new SPs_4025: bitstring;
                                                        {4737}new UP_4026: bitstring;
                                                        {4738}out(c, (SPs_4025,SignAndEncrypt,UP_4026,pkSess_4024))
                                                )
                                                else
                                                    {4739}let pkSess_4027: bitstring = fail-any in
                                                    {4740}in(c, =GetEndpointRequest);
                                                    {4741}new SPs_4028: bitstring;
                                                    {4742}new UP_4029: bitstring;
                                                    {4743}out(c, (SPs_4028,SignAndEncrypt,UP_4029,pkSess_4027))
                                        )
                                        else
                                            {4744}let pkSess_4030: bitstring = fail-any in
                                            {4745}in(c, =GetEndpointRequest);
                                            {4746}new SPs_4031: bitstring;
                                            {4747}new UP_4032: bitstring;
                                            {4748}out(c, (SPs_4031,SignAndEncrypt,UP_4032,pkSess_4030))
                                )
                                else
                                    {4749}let pkSess_4033: bitstring = fail-any in
                                    {4750}in(c, =GetEndpointRequest);
                                    {4751}new SPs_4034: bitstring;
                                    {4752}new UP_4035: bitstring;
                                    {4753}out(c, (SPs_4034,SignAndEncrypt,UP_4035,pkSess_4033))
                    )
                    else
                        {4754}let pkCli_4036: bitstring = fail-any in
                        {4755}let v_4037: bool = (Sess_3905 = A) in
                        (
                            {4756}if v_4037 then
                            (
                                {4757}let pkSess_4038: bitstring = pub(skA) in
                                {4758}in(c, =GetEndpointRequest);
                                {4759}new SPs_4039: bitstring;
                                {4760}new UP_4040: bitstring;
                                {4761}out(c, (SPs_4039,SignAndEncrypt,UP_4040,pkSess_4038))
                            )
                            else
                                {4762}let v_4041: bool = (Sess_3905 = B) in
                                (
                                    {4763}if v_4041 then
                                    (
                                        {4764}let pkSess_4042: bitstring = pub(skB) in
                                        {4765}in(c, =GetEndpointRequest);
                                        {4766}new SPs_4043: bitstring;
                                        {4767}new UP_4044: bitstring;
                                        {4768}out(c, (SPs_4043,SignAndEncrypt,UP_4044,pkSess_4042))
                                    )
                                    else
                                        {4769}let v_4045: bool = (Sess_3905 = C) in
                                        (
                                            {4770}if v_4045 then
                                            (
                                                {4771}let pkSess_4046: bitstring = pub(skC) in
                                                {4772}in(c, =GetEndpointRequest);
                                                {4773}new SPs_4047: bitstring;
                                                {4774}new UP_4048: bitstring;
                                                {4775}out(c, (SPs_4047,SignAndEncrypt,UP_4048,pkSess_4046))
                                            )
                                            else
                                                {4776}let pkSess_4049: bitstring = pub(skI) in
                                                {4777}in(c, =GetEndpointRequest);
                                                {4778}new SPs_4050: bitstring;
                                                {4779}new UP_4051: bitstring;
                                                {4780}out(c, (SPs_4050,SignAndEncrypt,UP_4051,pkSess_4049))
                                        )
                                        else
                                            {4781}let pkSess_4052: bitstring = fail-any in
                                            {4782}in(c, =GetEndpointRequest);
                                            {4783}new SPs_4053: bitstring;
                                            {4784}new UP_4054: bitstring;
                                            {4785}out(c, (SPs_4053,SignAndEncrypt,UP_4054,pkSess_4052))
                                )
                                else
                                    {4786}let pkSess_4055: bitstring = fail-any in
                                    {4787}in(c, =GetEndpointRequest);
                                    {4788}new SPs_4056: bitstring;
                                    {4789}new UP_4057: bitstring;
                                    {4790}out(c, (SPs_4056,SignAndEncrypt,UP_4057,pkSess_4055))
                        )
                        else
                            {4791}let pkSess_4058: bitstring = fail-any in
                            {4792}in(c, =GetEndpointRequest);
                            {4793}new SPs_4059: bitstring;
                            {4794}new UP_4060: bitstring;
                            {4795}out(c, (SPs_4059,SignAndEncrypt,UP_4060,pkSess_4058))
            )
            else
                {4796}let pkCli_4061: bitstring = fail-any in
                {4797}let v_4062: bool = (Sess_3905 = A) in
                (
                    {4798}if v_4062 then
                    (
                        {4799}let pkSess_4063: bitstring = pub(skA) in
                        {4800}in(c, =GetEndpointRequest);
                        {4801}new SPs_4064: bitstring;
                        {4802}new UP_4065: bitstring;
                        {4803}out(c, (SPs_4064,SignAndEncrypt,UP_4065,pkSess_4063))
                    )
                    else
                        {4804}let v_4066: bool = (Sess_3905 = B) in
                        (
                            {4805}if v_4066 then
                            (
                                {4806}let pkSess_4067: bitstring = pub(skB) in
                                {4807}in(c, =GetEndpointRequest);
                                {4808}new SPs_4068: bitstring;
                                {4809}new UP_4069: bitstring;
                                {4810}out(c, (SPs_4068,SignAndEncrypt,UP_4069,pkSess_4067))
                            )
                            else
                                {4811}let v_4070: bool = (Sess_3905 = C) in
                                (
                                    {4812}if v_4070 then
                                    (
                                        {4813}let pkSess_4071: bitstring = pub(skC) in
                                        {4814}in(c, =GetEndpointRequest);
                                        {4815}new SPs_4072: bitstring;
                                        {4816}new UP_4073: bitstring;
                                        {4817}out(c, (SPs_4072,SignAndEncrypt,UP_4073,pkSess_4071))
                                    )
                                    else
                                        {4818}let pkSess_4074: bitstring = pub(skI) in
                                        {4819}in(c, =GetEndpointRequest);
                                        {4820}new SPs_4075: bitstring;
                                        {4821}new UP_4076: bitstring;
                                        {4822}out(c, (SPs_4075,SignAndEncrypt,UP_4076,pkSess_4074))
                                )
                                else
                                    {4823}let pkSess_4077: bitstring = fail-any in
                                    {4824}in(c, =GetEndpointRequest);
                                    {4825}new SPs_4078: bitstring;
                                    {4826}new UP_4079: bitstring;
                                    {4827}out(c, (SPs_4078,SignAndEncrypt,UP_4079,pkSess_4077))
                        )
                        else
                            {4828}let pkSess_4080: bitstring = fail-any in
                            {4829}in(c, =GetEndpointRequest);
                            {4830}new SPs_4081: bitstring;
                            {4831}new UP_4082: bitstring;
                            {4832}out(c, (SPs_4081,SignAndEncrypt,UP_4082,pkSess_4080))
                )
                else
                    {4833}let pkSess_4083: bitstring = fail-any in
                    {4834}in(c, =GetEndpointRequest);
                    {4835}new SPs_4084: bitstring;
                    {4836}new UP_4085: bitstring;
                    {4837}out(c, (SPs_4084,SignAndEncrypt,UP_4085,pkSess_4083))
        )
        else
            {4838}let v_4086: bool = (Disco_3904 = B) in
            (
                {4839}if v_4086 then
                (
                    {4840}let skDisco_4087: bitstring = skB in
                    {4841}let pkDisco_4088: bitstring = pub(skDisco_4087) in
                    {4842}let v_4089: bool = (Cli_3903 = A) in
                    (
                        {4843}if v_4089 then
                        (
                            {4844}let pkCli_4090: bitstring = pub(skA) in
                            {4845}let v_4091: bool = (Sess_3905 = A) in
                            (
                                {4846}if v_4091 then
                                (
                                    {4847}let pkSess_4092: bitstring = pub(skA) in
                                    {4848}in(c, =GetEndpointRequest);
                                    {4849}new SPs_4093: bitstring;
                                    {4850}new UP_4094: bitstring;
                                    {4851}out(c, (SPs_4093,SignAndEncrypt,UP_4094,pkSess_4092))
                                )
                                else
                                    {4852}let v_4095: bool = (Sess_3905 = B) in
                                    (
                                        {4853}if v_4095 then
                                        (
                                            {4854}let pkSess_4096: bitstring = pub(skB) in
                                            {4855}in(c, =GetEndpointRequest);
                                            {4856}new SPs_4097: bitstring;
                                            {4857}new UP_4098: bitstring;
                                            {4858}out(c, (SPs_4097,SignAndEncrypt,UP_4098,pkSess_4096))
                                        )
                                        else
                                            {4859}let v_4099: bool = (Sess_3905 = C) in
                                            (
                                                {4860}if v_4099 then
                                                (
                                                    {4861}let pkSess_4100: bitstring = pub(skC) in
                                                    {4862}in(c, =GetEndpointRequest);
                                                    {4863}new SPs_4101: bitstring;
                                                    {4864}new UP_4102: bitstring;
                                                    {4865}out(c, (SPs_4101,SignAndEncrypt,UP_4102,pkSess_4100))
                                                )
                                                else
                                                    {4866}let pkSess_4103: bitstring = pub(skI) in
                                                    {4867}in(c, =GetEndpointRequest);
                                                    {4868}new SPs_4104: bitstring;
                                                    {4869}new UP_4105: bitstring;
                                                    {4870}out(c, (SPs_4104,SignAndEncrypt,UP_4105,pkSess_4103))
                                            )
                                            else
                                                {4871}let pkSess_4106: bitstring = fail-any in
                                                {4872}in(c, =GetEndpointRequest);
                                                {4873}new SPs_4107: bitstring;
                                                {4874}new UP_4108: bitstring;
                                                {4875}out(c, (SPs_4107,SignAndEncrypt,UP_4108,pkSess_4106))
                                    )
                                    else
                                        {4876}let pkSess_4109: bitstring = fail-any in
                                        {4877}in(c, =GetEndpointRequest);
                                        {4878}new SPs_4110: bitstring;
                                        {4879}new UP_4111: bitstring;
                                        {4880}out(c, (SPs_4110,SignAndEncrypt,UP_4111,pkSess_4109))
                            )
                            else
                                {4881}let pkSess_4112: bitstring = fail-any in
                                {4882}in(c, =GetEndpointRequest);
                                {4883}new SPs_4113: bitstring;
                                {4884}new UP_4114: bitstring;
                                {4885}out(c, (SPs_4113,SignAndEncrypt,UP_4114,pkSess_4112))
                        )
                        else
                            {4886}let v_4115: bool = (Cli_3903 = B) in
                            (
                                {4887}if v_4115 then
                                (
                                    {4888}let pkCli_4116: bitstring = pub(skB) in
                                    {4889}let v_4117: bool = (Sess_3905 = A) in
                                    (
                                        {4890}if v_4117 then
                                        (
                                            {4891}let pkSess_4118: bitstring = pub(skA) in
                                            {4892}in(c, =GetEndpointRequest);
                                            {4893}new SPs_4119: bitstring;
                                            {4894}new UP_4120: bitstring;
                                            {4895}out(c, (SPs_4119,SignAndEncrypt,UP_4120,pkSess_4118))
                                        )
                                        else
                                            {4896}let v_4121: bool = (Sess_3905 = B) in
                                            (
                                                {4897}if v_4121 then
                                                (
                                                    {4898}let pkSess_4122: bitstring = pub(skB) in
                                                    {4899}in(c, =GetEndpointRequest);
                                                    {4900}new SPs_4123: bitstring;
                                                    {4901}new UP_4124: bitstring;
                                                    {4902}out(c, (SPs_4123,SignAndEncrypt,UP_4124,pkSess_4122))
                                                )
                                                else
                                                    {4903}let v_4125: bool = (Sess_3905 = C) in
                                                    (
                                                        {4904}if v_4125 then
                                                        (
                                                            {4905}let pkSess_4126: bitstring = pub(skC) in
                                                            {4906}in(c, =GetEndpointRequest);
                                                            {4907}new SPs_4127: bitstring;
                                                            {4908}new UP_4128: bitstring;
                                                            {4909}out(c, (SPs_4127,SignAndEncrypt,UP_4128,pkSess_4126))
                                                        )
                                                        else
                                                            {4910}let pkSess_4129: bitstring = pub(skI) in
                                                            {4911}in(c, =GetEndpointRequest);
                                                            {4912}new SPs_4130: bitstring;
                                                            {4913}new UP_4131: bitstring;
                                                            {4914}out(c, (SPs_4130,SignAndEncrypt,UP_4131,pkSess_4129))
                                                    )
                                                    else
                                                        {4915}let pkSess_4132: bitstring = fail-any in
                                                        {4916}in(c, =GetEndpointRequest);
                                                        {4917}new SPs_4133: bitstring;
                                                        {4918}new UP_4134: bitstring;
                                                        {4919}out(c, (SPs_4133,SignAndEncrypt,UP_4134,pkSess_4132))
                                            )
                                            else
                                                {4920}let pkSess_4135: bitstring = fail-any in
                                                {4921}in(c, =GetEndpointRequest);
                                                {4922}new SPs_4136: bitstring;
                                                {4923}new UP_4137: bitstring;
                                                {4924}out(c, (SPs_4136,SignAndEncrypt,UP_4137,pkSess_4135))
                                    )
                                    else
                                        {4925}let pkSess_4138: bitstring = fail-any in
                                        {4926}in(c, =GetEndpointRequest);
                                        {4927}new SPs_4139: bitstring;
                                        {4928}new UP_4140: bitstring;
                                        {4929}out(c, (SPs_4139,SignAndEncrypt,UP_4140,pkSess_4138))
                                )
                                else
                                    {4930}let v_4141: bool = (Cli_3903 = C) in
                                    (
                                        {4931}if v_4141 then
                                        (
                                            {4932}let pkCli_4142: bitstring = pub(skC) in
                                            {4933}let v_4143: bool = (Sess_3905 = A) in
                                            (
                                                {4934}if v_4143 then
                                                (
                                                    {4935}let pkSess_4144: bitstring = pub(skA) in
                                                    {4936}in(c, =GetEndpointRequest);
                                                    {4937}new SPs_4145: bitstring;
                                                    {4938}new UP_4146: bitstring;
                                                    {4939}out(c, (SPs_4145,SignAndEncrypt,UP_4146,pkSess_4144))
                                                )
                                                else
                                                    {4940}let v_4147: bool = (Sess_3905 = B) in
                                                    (
                                                        {4941}if v_4147 then
                                                        (
                                                            {4942}let pkSess_4148: bitstring = pub(skB) in
                                                            {4943}in(c, =GetEndpointRequest);
                                                            {4944}new SPs_4149: bitstring;
                                                            {4945}new UP_4150: bitstring;
                                                            {4946}out(c, (SPs_4149,SignAndEncrypt,UP_4150,pkSess_4148))
                                                        )
                                                        else
                                                            {4947}let v_4151: bool = (Sess_3905 = C) in
                                                            (
                                                                {4948}if v_4151 then
                                                                (
                                                                    {4949}let pkSess_4152: bitstring = pub(skC) in
                                                                    {4950}in(c, =GetEndpointRequest);
                                                                    {4951}new SPs_4153: bitstring;
                                                                    {4952}new UP_4154: bitstring;
                                                                    {4953}out(c, (SPs_4153,SignAndEncrypt,UP_4154,pkSess_4152))
                                                                )
                                                                else
                                                                    {4954}let pkSess_4155: bitstring = pub(skI) in
                                                                    {4955}in(c, =GetEndpointRequest);
                                                                    {4956}new SPs_4156: bitstring;
                                                                    {4957}new UP_4157: bitstring;
                                                                    {4958}out(c, (SPs_4156,SignAndEncrypt,UP_4157,pkSess_4155))
                                                            )
                                                            else
                                                                {4959}let pkSess_4158: bitstring = fail-any in
                                                                {4960}in(c, =GetEndpointRequest);
                                                                {4961}new SPs_4159: bitstring;
                                                                {4962}new UP_4160: bitstring;
                                                                {4963}out(c, (SPs_4159,SignAndEncrypt,UP_4160,pkSess_4158))
                                                    )
                                                    else
                                                        {4964}let pkSess_4161: bitstring = fail-any in
                                                        {4965}in(c, =GetEndpointRequest);
                                                        {4966}new SPs_4162: bitstring;
                                                        {4967}new UP_4163: bitstring;
                                                        {4968}out(c, (SPs_4162,SignAndEncrypt,UP_4163,pkSess_4161))
                                            )
                                            else
                                                {4969}let pkSess_4164: bitstring = fail-any in
                                                {4970}in(c, =GetEndpointRequest);
                                                {4971}new SPs_4165: bitstring;
                                                {4972}new UP_4166: bitstring;
                                                {4973}out(c, (SPs_4165,SignAndEncrypt,UP_4166,pkSess_4164))
                                        )
                                        else
                                            {4974}let pkCli_4167: bitstring = pub(skI) in
                                            {4975}let v_4168: bool = (Sess_3905 = A) in
                                            (
                                                {4976}if v_4168 then
                                                (
                                                    {4977}let pkSess_4169: bitstring = pub(skA) in
                                                    {4978}in(c, =GetEndpointRequest);
                                                    {4979}new SPs_4170: bitstring;
                                                    {4980}new UP_4171: bitstring;
                                                    {4981}out(c, (SPs_4170,SignAndEncrypt,UP_4171,pkSess_4169))
                                                )
                                                else
                                                    {4982}let v_4172: bool = (Sess_3905 = B) in
                                                    (
                                                        {4983}if v_4172 then
                                                        (
                                                            {4984}let pkSess_4173: bitstring = pub(skB) in
                                                            {4985}in(c, =GetEndpointRequest);
                                                            {4986}new SPs_4174: bitstring;
                                                            {4987}new UP_4175: bitstring;
                                                            {4988}out(c, (SPs_4174,SignAndEncrypt,UP_4175,pkSess_4173))
                                                        )
                                                        else
                                                            {4989}let v_4176: bool = (Sess_3905 = C) in
                                                            (
                                                                {4990}if v_4176 then
                                                                (
                                                                    {4991}let pkSess_4177: bitstring = pub(skC) in
                                                                    {4992}in(c, =GetEndpointRequest);
                                                                    {4993}new SPs_4178: bitstring;
                                                                    {4994}new UP_4179: bitstring;
                                                                    {4995}out(c, (SPs_4178,SignAndEncrypt,UP_4179,pkSess_4177))
                                                                )
                                                                else
                                                                    {4996}let pkSess_4180: bitstring = pub(skI) in
                                                                    {4997}in(c, =GetEndpointRequest);
                                                                    {4998}new SPs_4181: bitstring;
                                                                    {4999}new UP_4182: bitstring;
                                                                    {5000}out(c, (SPs_4181,SignAndEncrypt,UP_4182,pkSess_4180))
                                                            )
                                                            else
                                                                {5001}let pkSess_4183: bitstring = fail-any in
                                                                {5002}in(c, =GetEndpointRequest);
                                                                {5003}new SPs_4184: bitstring;
                                                                {5004}new UP_4185: bitstring;
                                                                {5005}out(c, (SPs_4184,SignAndEncrypt,UP_4185,pkSess_4183))
                                                    )
                                                    else
                                                        {5006}let pkSess_4186: bitstring = fail-any in
                                                        {5007}in(c, =GetEndpointRequest);
                                                        {5008}new SPs_4187: bitstring;
                                                        {5009}new UP_4188: bitstring;
                                                        {5010}out(c, (SPs_4187,SignAndEncrypt,UP_4188,pkSess_4186))
                                            )
                                            else
                                                {5011}let pkSess_4189: bitstring = fail-any in
                                                {5012}in(c, =GetEndpointRequest);
                                                {5013}new SPs_4190: bitstring;
                                                {5014}new UP_4191: bitstring;
                                                {5015}out(c, (SPs_4190,SignAndEncrypt,UP_4191,pkSess_4189))
                                    )
                                    else
                                        {5016}let pkCli_4192: bitstring = fail-any in
                                        {5017}let v_4193: bool = (Sess_3905 = A) in
                                        (
                                            {5018}if v_4193 then
                                            (
                                                {5019}let pkSess_4194: bitstring = pub(skA) in
                                                {5020}in(c, =GetEndpointRequest);
                                                {5021}new SPs_4195: bitstring;
                                                {5022}new UP_4196: bitstring;
                                                {5023}out(c, (SPs_4195,SignAndEncrypt,UP_4196,pkSess_4194))
                                            )
                                            else
                                                {5024}let v_4197: bool = (Sess_3905 = B) in
                                                (
                                                    {5025}if v_4197 then
                                                    (
                                                        {5026}let pkSess_4198: bitstring = pub(skB) in
                                                        {5027}in(c, =GetEndpointRequest);
                                                        {5028}new SPs_4199: bitstring;
                                                        {5029}new UP_4200: bitstring;
                                                        {5030}out(c, (SPs_4199,SignAndEncrypt,UP_4200,pkSess_4198))
                                                    )
                                                    else
                                                        {5031}let v_4201: bool = (Sess_3905 = C) in
                                                        (
                                                            {5032}if v_4201 then
                                                            (
                                                                {5033}let pkSess_4202: bitstring = pub(skC) in
                                                                {5034}in(c, =GetEndpointRequest);
                                                                {5035}new SPs_4203: bitstring;
                                                                {5036}new UP_4204: bitstring;
                                                                {5037}out(c, (SPs_4203,SignAndEncrypt,UP_4204,pkSess_4202))
                                                            )
                                                            else
                                                                {5038}let pkSess_4205: bitstring = pub(skI) in
                                                                {5039}in(c, =GetEndpointRequest);
                                                                {5040}new SPs_4206: bitstring;
                                                                {5041}new UP_4207: bitstring;
                                                                {5042}out(c, (SPs_4206,SignAndEncrypt,UP_4207,pkSess_4205))
                                                        )
                                                        else
                                                            {5043}let pkSess_4208: bitstring = fail-any in
                                                            {5044}in(c, =GetEndpointRequest);
                                                            {5045}new SPs_4209: bitstring;
                                                            {5046}new UP_4210: bitstring;
                                                            {5047}out(c, (SPs_4209,SignAndEncrypt,UP_4210,pkSess_4208))
                                                )
                                                else
                                                    {5048}let pkSess_4211: bitstring = fail-any in
                                                    {5049}in(c, =GetEndpointRequest);
                                                    {5050}new SPs_4212: bitstring;
                                                    {5051}new UP_4213: bitstring;
                                                    {5052}out(c, (SPs_4212,SignAndEncrypt,UP_4213,pkSess_4211))
                                        )
                                        else
                                            {5053}let pkSess_4214: bitstring = fail-any in
                                            {5054}in(c, =GetEndpointRequest);
                                            {5055}new SPs_4215: bitstring;
                                            {5056}new UP_4216: bitstring;
                                            {5057}out(c, (SPs_4215,SignAndEncrypt,UP_4216,pkSess_4214))
                            )
                            else
                                {5058}let pkCli_4217: bitstring = fail-any in
                                {5059}let v_4218: bool = (Sess_3905 = A) in
                                (
                                    {5060}if v_4218 then
                                    (
                                        {5061}let pkSess_4219: bitstring = pub(skA) in
                                        {5062}in(c, =GetEndpointRequest);
                                        {5063}new SPs_4220: bitstring;
                                        {5064}new UP_4221: bitstring;
                                        {5065}out(c, (SPs_4220,SignAndEncrypt,UP_4221,pkSess_4219))
                                    )
                                    else
                                        {5066}let v_4222: bool = (Sess_3905 = B) in
                                        (
                                            {5067}if v_4222 then
                                            (
                                                {5068}let pkSess_4223: bitstring = pub(skB) in
                                                {5069}in(c, =GetEndpointRequest);
                                                {5070}new SPs_4224: bitstring;
                                                {5071}new UP_4225: bitstring;
                                                {5072}out(c, (SPs_4224,SignAndEncrypt,UP_4225,pkSess_4223))
                                            )
                                            else
                                                {5073}let v_4226: bool = (Sess_3905 = C) in
                                                (
                                                    {5074}if v_4226 then
                                                    (
                                                        {5075}let pkSess_4227: bitstring = pub(skC) in
                                                        {5076}in(c, =GetEndpointRequest);
                                                        {5077}new SPs_4228: bitstring;
                                                        {5078}new UP_4229: bitstring;
                                                        {5079}out(c, (SPs_4228,SignAndEncrypt,UP_4229,pkSess_4227))
                                                    )
                                                    else
                                                        {5080}let pkSess_4230: bitstring = pub(skI) in
                                                        {5081}in(c, =GetEndpointRequest);
                                                        {5082}new SPs_4231: bitstring;
                                                        {5083}new UP_4232: bitstring;
                                                        {5084}out(c, (SPs_4231,SignAndEncrypt,UP_4232,pkSess_4230))
                                                )
                                                else
                                                    {5085}let pkSess_4233: bitstring = fail-any in
                                                    {5086}in(c, =GetEndpointRequest);
                                                    {5087}new SPs_4234: bitstring;
                                                    {5088}new UP_4235: bitstring;
                                                    {5089}out(c, (SPs_4234,SignAndEncrypt,UP_4235,pkSess_4233))
                                        )
                                        else
                                            {5090}let pkSess_4236: bitstring = fail-any in
                                            {5091}in(c, =GetEndpointRequest);
                                            {5092}new SPs_4237: bitstring;
                                            {5093}new UP_4238: bitstring;
                                            {5094}out(c, (SPs_4237,SignAndEncrypt,UP_4238,pkSess_4236))
                                )
                                else
                                    {5095}let pkSess_4239: bitstring = fail-any in
                                    {5096}in(c, =GetEndpointRequest);
                                    {5097}new SPs_4240: bitstring;
                                    {5098}new UP_4241: bitstring;
                                    {5099}out(c, (SPs_4240,SignAndEncrypt,UP_4241,pkSess_4239))
                    )
                    else
                        {5100}let pkCli_4242: bitstring = fail-any in
                        {5101}let v_4243: bool = (Sess_3905 = A) in
                        (
                            {5102}if v_4243 then
                            (
                                {5103}let pkSess_4244: bitstring = pub(skA) in
                                {5104}in(c, =GetEndpointRequest);
                                {5105}new SPs_4245: bitstring;
                                {5106}new UP_4246: bitstring;
                                {5107}out(c, (SPs_4245,SignAndEncrypt,UP_4246,pkSess_4244))
                            )
                            else
                                {5108}let v_4247: bool = (Sess_3905 = B) in
                                (
                                    {5109}if v_4247 then
                                    (
                                        {5110}let pkSess_4248: bitstring = pub(skB) in
                                        {5111}in(c, =GetEndpointRequest);
                                        {5112}new SPs_4249: bitstring;
                                        {5113}new UP_4250: bitstring;
                                        {5114}out(c, (SPs_4249,SignAndEncrypt,UP_4250,pkSess_4248))
                                    )
                                    else
                                        {5115}let v_4251: bool = (Sess_3905 = C) in
                                        (
                                            {5116}if v_4251 then
                                            (
                                                {5117}let pkSess_4252: bitstring = pub(skC) in
                                                {5118}in(c, =GetEndpointRequest);
                                                {5119}new SPs_4253: bitstring;
                                                {5120}new UP_4254: bitstring;
                                                {5121}out(c, (SPs_4253,SignAndEncrypt,UP_4254,pkSess_4252))
                                            )
                                            else
                                                {5122}let pkSess_4255: bitstring = pub(skI) in
                                                {5123}in(c, =GetEndpointRequest);
                                                {5124}new SPs_4256: bitstring;
                                                {5125}new UP_4257: bitstring;
                                                {5126}out(c, (SPs_4256,SignAndEncrypt,UP_4257,pkSess_4255))
                                        )
                                        else
                                            {5127}let pkSess_4258: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SPs_4259: bitstring;
                                            {5130}new UP_4260: bitstring;
                                            {5131}out(c, (SPs_4259,SignAndEncrypt,UP_4260,pkSess_4258))
                                )
                                else
                                    {5132}let pkSess_4261: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SPs_4262: bitstring;
                                    {5135}new UP_4263: bitstring;
                                    {5136}out(c, (SPs_4262,SignAndEncrypt,UP_4263,pkSess_4261))
                        )
                        else
                            {5137}let pkSess_4264: bitstring = fail-any in
                            {5138}in(c, =GetEndpointRequest);
                            {5139}new SPs_4265: bitstring;
                            {5140}new UP_4266: bitstring;
                            {5141}out(c, (SPs_4265,SignAndEncrypt,UP_4266,pkSess_4264))
                )
                else
                    {5142}let v_4267: bool = (Disco_3904 = C) in
                    (
                        {5143}if v_4267 then
                        (
                            {5144}let skDisco_4268: bitstring = skC in
                            {5145}let pkDisco_4269: bitstring = pub(skDisco_4268) in
                            {5146}let v_4270: bool = (Cli_3903 = A) in
                            (
                                {5147}if v_4270 then
                                (
                                    {5148}let pkCli_4271: bitstring = pub(skA) in
                                    {5149}let v_4272: bool = (Sess_3905 = A) in
                                    (
                                        {5150}if v_4272 then
                                        (
                                            {5151}let pkSess_4273: bitstring = pub(skA) in
                                            {5152}in(c, =GetEndpointRequest);
                                            {5153}new SPs_4274: bitstring;
                                            {5154}new UP_4275: bitstring;
                                            {5155}out(c, (SPs_4274,SignAndEncrypt,UP_4275,pkSess_4273))
                                        )
                                        else
                                            {5156}let v_4276: bool = (Sess_3905 = B) in
                                            (
                                                {5157}if v_4276 then
                                                (
                                                    {5158}let pkSess_4277: bitstring = pub(skB) in
                                                    {5159}in(c, =GetEndpointRequest);
                                                    {5160}new SPs_4278: bitstring;
                                                    {5161}new UP_4279: bitstring;
                                                    {5162}out(c, (SPs_4278,SignAndEncrypt,UP_4279,pkSess_4277))
                                                )
                                                else
                                                    {5163}let v_4280: bool = (Sess_3905 = C) in
                                                    (
                                                        {5164}if v_4280 then
                                                        (
                                                            {5165}let pkSess_4281: bitstring = pub(skC) in
                                                            {5166}in(c, =GetEndpointRequest);
                                                            {5167}new SPs_4282: bitstring;
                                                            {5168}new UP_4283: bitstring;
                                                            {5169}out(c, (SPs_4282,SignAndEncrypt,UP_4283,pkSess_4281))
                                                        )
                                                        else
                                                            {5170}let pkSess_4284: bitstring = pub(skI) in
                                                            {5171}in(c, =GetEndpointRequest);
                                                            {5172}new SPs_4285: bitstring;
                                                            {5173}new UP_4286: bitstring;
                                                            {5174}out(c, (SPs_4285,SignAndEncrypt,UP_4286,pkSess_4284))
                                                    )
                                                    else
                                                        {5175}let pkSess_4287: bitstring = fail-any in
                                                        {5176}in(c, =GetEndpointRequest);
                                                        {5177}new SPs_4288: bitstring;
                                                        {5178}new UP_4289: bitstring;
                                                        {5179}out(c, (SPs_4288,SignAndEncrypt,UP_4289,pkSess_4287))
                                            )
                                            else
                                                {5180}let pkSess_4290: bitstring = fail-any in
                                                {5181}in(c, =GetEndpointRequest);
                                                {5182}new SPs_4291: bitstring;
                                                {5183}new UP_4292: bitstring;
                                                {5184}out(c, (SPs_4291,SignAndEncrypt,UP_4292,pkSess_4290))
                                    )
                                    else
                                        {5185}let pkSess_4293: bitstring = fail-any in
                                        {5186}in(c, =GetEndpointRequest);
                                        {5187}new SPs_4294: bitstring;
                                        {5188}new UP_4295: bitstring;
                                        {5189}out(c, (SPs_4294,SignAndEncrypt,UP_4295,pkSess_4293))
                                )
                                else
                                    {5190}let v_4296: bool = (Cli_3903 = B) in
                                    (
                                        {5191}if v_4296 then
                                        (
                                            {5192}let pkCli_4297: bitstring = pub(skB) in
                                            {5193}let v_4298: bool = (Sess_3905 = A) in
                                            (
                                                {5194}if v_4298 then
                                                (
                                                    {5195}let pkSess_4299: bitstring = pub(skA) in
                                                    {5196}in(c, =GetEndpointRequest);
                                                    {5197}new SPs_4300: bitstring;
                                                    {5198}new UP_4301: bitstring;
                                                    {5199}out(c, (SPs_4300,SignAndEncrypt,UP_4301,pkSess_4299))
                                                )
                                                else
                                                    {5200}let v_4302: bool = (Sess_3905 = B) in
                                                    (
                                                        {5201}if v_4302 then
                                                        (
                                                            {5202}let pkSess_4303: bitstring = pub(skB) in
                                                            {5203}in(c, =GetEndpointRequest);
                                                            {5204}new SPs_4304: bitstring;
                                                            {5205}new UP_4305: bitstring;
                                                            {5206}out(c, (SPs_4304,SignAndEncrypt,UP_4305,pkSess_4303))
                                                        )
                                                        else
                                                            {5207}let v_4306: bool = (Sess_3905 = C) in
                                                            (
                                                                {5208}if v_4306 then
                                                                (
                                                                    {5209}let pkSess_4307: bitstring = pub(skC) in
                                                                    {5210}in(c, =GetEndpointRequest);
                                                                    {5211}new SPs_4308: bitstring;
                                                                    {5212}new UP_4309: bitstring;
                                                                    {5213}out(c, (SPs_4308,SignAndEncrypt,UP_4309,pkSess_4307))
                                                                )
                                                                else
                                                                    {5214}let pkSess_4310: bitstring = pub(skI) in
                                                                    {5215}in(c, =GetEndpointRequest);
                                                                    {5216}new SPs_4311: bitstring;
                                                                    {5217}new UP_4312: bitstring;
                                                                    {5218}out(c, (SPs_4311,SignAndEncrypt,UP_4312,pkSess_4310))
                                                            )
                                                            else
                                                                {5219}let pkSess_4313: bitstring = fail-any in
                                                                {5220}in(c, =GetEndpointRequest);
                                                                {5221}new SPs_4314: bitstring;
                                                                {5222}new UP_4315: bitstring;
                                                                {5223}out(c, (SPs_4314,SignAndEncrypt,UP_4315,pkSess_4313))
                                                    )
                                                    else
                                                        {5224}let pkSess_4316: bitstring = fail-any in
                                                        {5225}in(c, =GetEndpointRequest);
                                                        {5226}new SPs_4317: bitstring;
                                                        {5227}new UP_4318: bitstring;
                                                        {5228}out(c, (SPs_4317,SignAndEncrypt,UP_4318,pkSess_4316))
                                            )
                                            else
                                                {5229}let pkSess_4319: bitstring = fail-any in
                                                {5230}in(c, =GetEndpointRequest);
                                                {5231}new SPs_4320: bitstring;
                                                {5232}new UP_4321: bitstring;
                                                {5233}out(c, (SPs_4320,SignAndEncrypt,UP_4321,pkSess_4319))
                                        )
                                        else
                                            {5234}let v_4322: bool = (Cli_3903 = C) in
                                            (
                                                {5235}if v_4322 then
                                                (
                                                    {5236}let pkCli_4323: bitstring = pub(skC) in
                                                    {5237}let v_4324: bool = (Sess_3905 = A) in
                                                    (
                                                        {5238}if v_4324 then
                                                        (
                                                            {5239}let pkSess_4325: bitstring = pub(skA) in
                                                            {5240}in(c, =GetEndpointRequest);
                                                            {5241}new SPs_4326: bitstring;
                                                            {5242}new UP_4327: bitstring;
                                                            {5243}out(c, (SPs_4326,SignAndEncrypt,UP_4327,pkSess_4325))
                                                        )
                                                        else
                                                            {5244}let v_4328: bool = (Sess_3905 = B) in
                                                            (
                                                                {5245}if v_4328 then
                                                                (
                                                                    {5246}let pkSess_4329: bitstring = pub(skB) in
                                                                    {5247}in(c, =GetEndpointRequest);
                                                                    {5248}new SPs_4330: bitstring;
                                                                    {5249}new UP_4331: bitstring;
                                                                    {5250}out(c, (SPs_4330,SignAndEncrypt,UP_4331,pkSess_4329))
                                                                )
                                                                else
                                                                    {5251}let v_4332: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5252}if v_4332 then
                                                                        (
                                                                            {5253}let pkSess_4333: bitstring = pub(skC) in
                                                                            {5254}in(c, =GetEndpointRequest);
                                                                            {5255}new SPs_4334: bitstring;
                                                                            {5256}new UP_4335: bitstring;
                                                                            {5257}out(c, (SPs_4334,SignAndEncrypt,UP_4335,pkSess_4333))
                                                                        )
                                                                        else
                                                                            {5258}let pkSess_4336: bitstring = pub(skI) in
                                                                            {5259}in(c, =GetEndpointRequest);
                                                                            {5260}new SPs_4337: bitstring;
                                                                            {5261}new UP_4338: bitstring;
                                                                            {5262}out(c, (SPs_4337,SignAndEncrypt,UP_4338,pkSess_4336))
                                                                    )
                                                                    else
                                                                        {5263}let pkSess_4339: bitstring = fail-any in
                                                                        {5264}in(c, =GetEndpointRequest);
                                                                        {5265}new SPs_4340: bitstring;
                                                                        {5266}new UP_4341: bitstring;
                                                                        {5267}out(c, (SPs_4340,SignAndEncrypt,UP_4341,pkSess_4339))
                                                            )
                                                            else
                                                                {5268}let pkSess_4342: bitstring = fail-any in
                                                                {5269}in(c, =GetEndpointRequest);
                                                                {5270}new SPs_4343: bitstring;
                                                                {5271}new UP_4344: bitstring;
                                                                {5272}out(c, (SPs_4343,SignAndEncrypt,UP_4344,pkSess_4342))
                                                    )
                                                    else
                                                        {5273}let pkSess_4345: bitstring = fail-any in
                                                        {5274}in(c, =GetEndpointRequest);
                                                        {5275}new SPs_4346: bitstring;
                                                        {5276}new UP_4347: bitstring;
                                                        {5277}out(c, (SPs_4346,SignAndEncrypt,UP_4347,pkSess_4345))
                                                )
                                                else
                                                    {5278}let pkCli_4348: bitstring = pub(skI) in
                                                    {5279}let v_4349: bool = (Sess_3905 = A) in
                                                    (
                                                        {5280}if v_4349 then
                                                        (
                                                            {5281}let pkSess_4350: bitstring = pub(skA) in
                                                            {5282}in(c, =GetEndpointRequest);
                                                            {5283}new SPs_4351: bitstring;
                                                            {5284}new UP_4352: bitstring;
                                                            {5285}out(c, (SPs_4351,SignAndEncrypt,UP_4352,pkSess_4350))
                                                        )
                                                        else
                                                            {5286}let v_4353: bool = (Sess_3905 = B) in
                                                            (
                                                                {5287}if v_4353 then
                                                                (
                                                                    {5288}let pkSess_4354: bitstring = pub(skB) in
                                                                    {5289}in(c, =GetEndpointRequest);
                                                                    {5290}new SPs_4355: bitstring;
                                                                    {5291}new UP_4356: bitstring;
                                                                    {5292}out(c, (SPs_4355,SignAndEncrypt,UP_4356,pkSess_4354))
                                                                )
                                                                else
                                                                    {5293}let v_4357: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5294}if v_4357 then
                                                                        (
                                                                            {5295}let pkSess_4358: bitstring = pub(skC) in
                                                                            {5296}in(c, =GetEndpointRequest);
                                                                            {5297}new SPs_4359: bitstring;
                                                                            {5298}new UP_4360: bitstring;
                                                                            {5299}out(c, (SPs_4359,SignAndEncrypt,UP_4360,pkSess_4358))
                                                                        )
                                                                        else
                                                                            {5300}let pkSess_4361: bitstring = pub(skI) in
                                                                            {5301}in(c, =GetEndpointRequest);
                                                                            {5302}new SPs_4362: bitstring;
                                                                            {5303}new UP_4363: bitstring;
                                                                            {5304}out(c, (SPs_4362,SignAndEncrypt,UP_4363,pkSess_4361))
                                                                    )
                                                                    else
                                                                        {5305}let pkSess_4364: bitstring = fail-any in
                                                                        {5306}in(c, =GetEndpointRequest);
                                                                        {5307}new SPs_4365: bitstring;
                                                                        {5308}new UP_4366: bitstring;
                                                                        {5309}out(c, (SPs_4365,SignAndEncrypt,UP_4366,pkSess_4364))
                                                            )
                                                            else
                                                                {5310}let pkSess_4367: bitstring = fail-any in
                                                                {5311}in(c, =GetEndpointRequest);
                                                                {5312}new SPs_4368: bitstring;
                                                                {5313}new UP_4369: bitstring;
                                                                {5314}out(c, (SPs_4368,SignAndEncrypt,UP_4369,pkSess_4367))
                                                    )
                                                    else
                                                        {5315}let pkSess_4370: bitstring = fail-any in
                                                        {5316}in(c, =GetEndpointRequest);
                                                        {5317}new SPs_4371: bitstring;
                                                        {5318}new UP_4372: bitstring;
                                                        {5319}out(c, (SPs_4371,SignAndEncrypt,UP_4372,pkSess_4370))
                                            )
                                            else
                                                {5320}let pkCli_4373: bitstring = fail-any in
                                                {5321}let v_4374: bool = (Sess_3905 = A) in
                                                (
                                                    {5322}if v_4374 then
                                                    (
                                                        {5323}let pkSess_4375: bitstring = pub(skA) in
                                                        {5324}in(c, =GetEndpointRequest);
                                                        {5325}new SPs_4376: bitstring;
                                                        {5326}new UP_4377: bitstring;
                                                        {5327}out(c, (SPs_4376,SignAndEncrypt,UP_4377,pkSess_4375))
                                                    )
                                                    else
                                                        {5328}let v_4378: bool = (Sess_3905 = B) in
                                                        (
                                                            {5329}if v_4378 then
                                                            (
                                                                {5330}let pkSess_4379: bitstring = pub(skB) in
                                                                {5331}in(c, =GetEndpointRequest);
                                                                {5332}new SPs_4380: bitstring;
                                                                {5333}new UP_4381: bitstring;
                                                                {5334}out(c, (SPs_4380,SignAndEncrypt,UP_4381,pkSess_4379))
                                                            )
                                                            else
                                                                {5335}let v_4382: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5336}if v_4382 then
                                                                    (
                                                                        {5337}let pkSess_4383: bitstring = pub(skC) in
                                                                        {5338}in(c, =GetEndpointRequest);
                                                                        {5339}new SPs_4384: bitstring;
                                                                        {5340}new UP_4385: bitstring;
                                                                        {5341}out(c, (SPs_4384,SignAndEncrypt,UP_4385,pkSess_4383))
                                                                    )
                                                                    else
                                                                        {5342}let pkSess_4386: bitstring = pub(skI) in
                                                                        {5343}in(c, =GetEndpointRequest);
                                                                        {5344}new SPs_4387: bitstring;
                                                                        {5345}new UP_4388: bitstring;
                                                                        {5346}out(c, (SPs_4387,SignAndEncrypt,UP_4388,pkSess_4386))
                                                                )
                                                                else
                                                                    {5347}let pkSess_4389: bitstring = fail-any in
                                                                    {5348}in(c, =GetEndpointRequest);
                                                                    {5349}new SPs_4390: bitstring;
                                                                    {5350}new UP_4391: bitstring;
                                                                    {5351}out(c, (SPs_4390,SignAndEncrypt,UP_4391,pkSess_4389))
                                                        )
                                                        else
                                                            {5352}let pkSess_4392: bitstring = fail-any in
                                                            {5353}in(c, =GetEndpointRequest);
                                                            {5354}new SPs_4393: bitstring;
                                                            {5355}new UP_4394: bitstring;
                                                            {5356}out(c, (SPs_4393,SignAndEncrypt,UP_4394,pkSess_4392))
                                                )
                                                else
                                                    {5357}let pkSess_4395: bitstring = fail-any in
                                                    {5358}in(c, =GetEndpointRequest);
                                                    {5359}new SPs_4396: bitstring;
                                                    {5360}new UP_4397: bitstring;
                                                    {5361}out(c, (SPs_4396,SignAndEncrypt,UP_4397,pkSess_4395))
                                    )
                                    else
                                        {5362}let pkCli_4398: bitstring = fail-any in
                                        {5363}let v_4399: bool = (Sess_3905 = A) in
                                        (
                                            {5364}if v_4399 then
                                            (
                                                {5365}let pkSess_4400: bitstring = pub(skA) in
                                                {5366}in(c, =GetEndpointRequest);
                                                {5367}new SPs_4401: bitstring;
                                                {5368}new UP_4402: bitstring;
                                                {5369}out(c, (SPs_4401,SignAndEncrypt,UP_4402,pkSess_4400))
                                            )
                                            else
                                                {5370}let v_4403: bool = (Sess_3905 = B) in
                                                (
                                                    {5371}if v_4403 then
                                                    (
                                                        {5372}let pkSess_4404: bitstring = pub(skB) in
                                                        {5373}in(c, =GetEndpointRequest);
                                                        {5374}new SPs_4405: bitstring;
                                                        {5375}new UP_4406: bitstring;
                                                        {5376}out(c, (SPs_4405,SignAndEncrypt,UP_4406,pkSess_4404))
                                                    )
                                                    else
                                                        {5377}let v_4407: bool = (Sess_3905 = C) in
                                                        (
                                                            {5378}if v_4407 then
                                                            (
                                                                {5379}let pkSess_4408: bitstring = pub(skC) in
                                                                {5380}in(c, =GetEndpointRequest);
                                                                {5381}new SPs_4409: bitstring;
                                                                {5382}new UP_4410: bitstring;
                                                                {5383}out(c, (SPs_4409,SignAndEncrypt,UP_4410,pkSess_4408))
                                                            )
                                                            else
                                                                {5384}let pkSess_4411: bitstring = pub(skI) in
                                                                {5385}in(c, =GetEndpointRequest);
                                                                {5386}new SPs_4412: bitstring;
                                                                {5387}new UP_4413: bitstring;
                                                                {5388}out(c, (SPs_4412,SignAndEncrypt,UP_4413,pkSess_4411))
                                                        )
                                                        else
                                                            {5389}let pkSess_4414: bitstring = fail-any in
                                                            {5390}in(c, =GetEndpointRequest);
                                                            {5391}new SPs_4415: bitstring;
                                                            {5392}new UP_4416: bitstring;
                                                            {5393}out(c, (SPs_4415,SignAndEncrypt,UP_4416,pkSess_4414))
                                                )
                                                else
                                                    {5394}let pkSess_4417: bitstring = fail-any in
                                                    {5395}in(c, =GetEndpointRequest);
                                                    {5396}new SPs_4418: bitstring;
                                                    {5397}new UP_4419: bitstring;
                                                    {5398}out(c, (SPs_4418,SignAndEncrypt,UP_4419,pkSess_4417))
                                        )
                                        else
                                            {5399}let pkSess_4420: bitstring = fail-any in
                                            {5400}in(c, =GetEndpointRequest);
                                            {5401}new SPs_4421: bitstring;
                                            {5402}new UP_4422: bitstring;
                                            {5403}out(c, (SPs_4421,SignAndEncrypt,UP_4422,pkSess_4420))
                            )
                            else
                                {5404}let pkCli_4423: bitstring = fail-any in
                                {5405}let v_4424: bool = (Sess_3905 = A) in
                                (
                                    {5406}if v_4424 then
                                    (
                                        {5407}let pkSess_4425: bitstring = pub(skA) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SPs_4426: bitstring;
                                        {5410}new UP_4427: bitstring;
                                        {5411}out(c, (SPs_4426,SignAndEncrypt,UP_4427,pkSess_4425))
                                    )
                                    else
                                        {5412}let v_4428: bool = (Sess_3905 = B) in
                                        (
                                            {5413}if v_4428 then
                                            (
                                                {5414}let pkSess_4429: bitstring = pub(skB) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SPs_4430: bitstring;
                                                {5417}new UP_4431: bitstring;
                                                {5418}out(c, (SPs_4430,SignAndEncrypt,UP_4431,pkSess_4429))
                                            )
                                            else
                                                {5419}let v_4432: bool = (Sess_3905 = C) in
                                                (
                                                    {5420}if v_4432 then
                                                    (
                                                        {5421}let pkSess_4433: bitstring = pub(skC) in
                                                        {5422}in(c, =GetEndpointRequest);
                                                        {5423}new SPs_4434: bitstring;
                                                        {5424}new UP_4435: bitstring;
                                                        {5425}out(c, (SPs_4434,SignAndEncrypt,UP_4435,pkSess_4433))
                                                    )
                                                    else
                                                        {5426}let pkSess_4436: bitstring = pub(skI) in
                                                        {5427}in(c, =GetEndpointRequest);
                                                        {5428}new SPs_4437: bitstring;
                                                        {5429}new UP_4438: bitstring;
                                                        {5430}out(c, (SPs_4437,SignAndEncrypt,UP_4438,pkSess_4436))
                                                )
                                                else
                                                    {5431}let pkSess_4439: bitstring = fail-any in
                                                    {5432}in(c, =GetEndpointRequest);
                                                    {5433}new SPs_4440: bitstring;
                                                    {5434}new UP_4441: bitstring;
                                                    {5435}out(c, (SPs_4440,SignAndEncrypt,UP_4441,pkSess_4439))
                                        )
                                        else
                                            {5436}let pkSess_4442: bitstring = fail-any in
                                            {5437}in(c, =GetEndpointRequest);
                                            {5438}new SPs_4443: bitstring;
                                            {5439}new UP_4444: bitstring;
                                            {5440}out(c, (SPs_4443,SignAndEncrypt,UP_4444,pkSess_4442))
                                )
                                else
                                    {5441}let pkSess_4445: bitstring = fail-any in
                                    {5442}in(c, =GetEndpointRequest);
                                    {5443}new SPs_4446: bitstring;
                                    {5444}new UP_4447: bitstring;
                                    {5445}out(c, (SPs_4446,SignAndEncrypt,UP_4447,pkSess_4445))
                        )
                        else
                            {5446}let skDisco_4448: bitstring = skI in
                            {5447}let pkDisco_4449: bitstring = pub(skDisco_4448) in
                            {5448}let v_4450: bool = (Cli_3903 = A) in
                            (
                                {5449}if v_4450 then
                                (
                                    {5450}let pkCli_4451: bitstring = pub(skA) in
                                    {5451}let v_4452: bool = (Sess_3905 = A) in
                                    (
                                        {5452}if v_4452 then
                                        (
                                            {5453}let pkSess_4453: bitstring = pub(skA) in
                                            {5454}in(c, =GetEndpointRequest);
                                            {5455}new SPs_4454: bitstring;
                                            {5456}new UP_4455: bitstring;
                                            {5457}out(c, (SPs_4454,SignAndEncrypt,UP_4455,pkSess_4453))
                                        )
                                        else
                                            {5458}let v_4456: bool = (Sess_3905 = B) in
                                            (
                                                {5459}if v_4456 then
                                                (
                                                    {5460}let pkSess_4457: bitstring = pub(skB) in
                                                    {5461}in(c, =GetEndpointRequest);
                                                    {5462}new SPs_4458: bitstring;
                                                    {5463}new UP_4459: bitstring;
                                                    {5464}out(c, (SPs_4458,SignAndEncrypt,UP_4459,pkSess_4457))
                                                )
                                                else
                                                    {5465}let v_4460: bool = (Sess_3905 = C) in
                                                    (
                                                        {5466}if v_4460 then
                                                        (
                                                            {5467}let pkSess_4461: bitstring = pub(skC) in
                                                            {5468}in(c, =GetEndpointRequest);
                                                            {5469}new SPs_4462: bitstring;
                                                            {5470}new UP_4463: bitstring;
                                                            {5471}out(c, (SPs_4462,SignAndEncrypt,UP_4463,pkSess_4461))
                                                        )
                                                        else
                                                            {5472}let pkSess_4464: bitstring = pub(skI) in
                                                            {5473}in(c, =GetEndpointRequest);
                                                            {5474}new SPs_4465: bitstring;
                                                            {5475}new UP_4466: bitstring;
                                                            {5476}out(c, (SPs_4465,SignAndEncrypt,UP_4466,pkSess_4464))
                                                    )
                                                    else
                                                        {5477}let pkSess_4467: bitstring = fail-any in
                                                        {5478}in(c, =GetEndpointRequest);
                                                        {5479}new SPs_4468: bitstring;
                                                        {5480}new UP_4469: bitstring;
                                                        {5481}out(c, (SPs_4468,SignAndEncrypt,UP_4469,pkSess_4467))
                                            )
                                            else
                                                {5482}let pkSess_4470: bitstring = fail-any in
                                                {5483}in(c, =GetEndpointRequest);
                                                {5484}new SPs_4471: bitstring;
                                                {5485}new UP_4472: bitstring;
                                                {5486}out(c, (SPs_4471,SignAndEncrypt,UP_4472,pkSess_4470))
                                    )
                                    else
                                        {5487}let pkSess_4473: bitstring = fail-any in
                                        {5488}in(c, =GetEndpointRequest);
                                        {5489}new SPs_4474: bitstring;
                                        {5490}new UP_4475: bitstring;
                                        {5491}out(c, (SPs_4474,SignAndEncrypt,UP_4475,pkSess_4473))
                                )
                                else
                                    {5492}let v_4476: bool = (Cli_3903 = B) in
                                    (
                                        {5493}if v_4476 then
                                        (
                                            {5494}let pkCli_4477: bitstring = pub(skB) in
                                            {5495}let v_4478: bool = (Sess_3905 = A) in
                                            (
                                                {5496}if v_4478 then
                                                (
                                                    {5497}let pkSess_4479: bitstring = pub(skA) in
                                                    {5498}in(c, =GetEndpointRequest);
                                                    {5499}new SPs_4480: bitstring;
                                                    {5500}new UP_4481: bitstring;
                                                    {5501}out(c, (SPs_4480,SignAndEncrypt,UP_4481,pkSess_4479))
                                                )
                                                else
                                                    {5502}let v_4482: bool = (Sess_3905 = B) in
                                                    (
                                                        {5503}if v_4482 then
                                                        (
                                                            {5504}let pkSess_4483: bitstring = pub(skB) in
                                                            {5505}in(c, =GetEndpointRequest);
                                                            {5506}new SPs_4484: bitstring;
                                                            {5507}new UP_4485: bitstring;
                                                            {5508}out(c, (SPs_4484,SignAndEncrypt,UP_4485,pkSess_4483))
                                                        )
                                                        else
                                                            {5509}let v_4486: bool = (Sess_3905 = C) in
                                                            (
                                                                {5510}if v_4486 then
                                                                (
                                                                    {5511}let pkSess_4487: bitstring = pub(skC) in
                                                                    {5512}in(c, =GetEndpointRequest);
                                                                    {5513}new SPs_4488: bitstring;
                                                                    {5514}new UP_4489: bitstring;
                                                                    {5515}out(c, (SPs_4488,SignAndEncrypt,UP_4489,pkSess_4487))
                                                                )
                                                                else
                                                                    {5516}let pkSess_4490: bitstring = pub(skI) in
                                                                    {5517}in(c, =GetEndpointRequest);
                                                                    {5518}new SPs_4491: bitstring;
                                                                    {5519}new UP_4492: bitstring;
                                                                    {5520}out(c, (SPs_4491,SignAndEncrypt,UP_4492,pkSess_4490))
                                                            )
                                                            else
                                                                {5521}let pkSess_4493: bitstring = fail-any in
                                                                {5522}in(c, =GetEndpointRequest);
                                                                {5523}new SPs_4494: bitstring;
                                                                {5524}new UP_4495: bitstring;
                                                                {5525}out(c, (SPs_4494,SignAndEncrypt,UP_4495,pkSess_4493))
                                                    )
                                                    else
                                                        {5526}let pkSess_4496: bitstring = fail-any in
                                                        {5527}in(c, =GetEndpointRequest);
                                                        {5528}new SPs_4497: bitstring;
                                                        {5529}new UP_4498: bitstring;
                                                        {5530}out(c, (SPs_4497,SignAndEncrypt,UP_4498,pkSess_4496))
                                            )
                                            else
                                                {5531}let pkSess_4499: bitstring = fail-any in
                                                {5532}in(c, =GetEndpointRequest);
                                                {5533}new SPs_4500: bitstring;
                                                {5534}new UP_4501: bitstring;
                                                {5535}out(c, (SPs_4500,SignAndEncrypt,UP_4501,pkSess_4499))
                                        )
                                        else
                                            {5536}let v_4502: bool = (Cli_3903 = C) in
                                            (
                                                {5537}if v_4502 then
                                                (
                                                    {5538}let pkCli_4503: bitstring = pub(skC) in
                                                    {5539}let v_4504: bool = (Sess_3905 = A) in
                                                    (
                                                        {5540}if v_4504 then
                                                        (
                                                            {5541}let pkSess_4505: bitstring = pub(skA) in
                                                            {5542}in(c, =GetEndpointRequest);
                                                            {5543}new SPs_4506: bitstring;
                                                            {5544}new UP_4507: bitstring;
                                                            {5545}out(c, (SPs_4506,SignAndEncrypt,UP_4507,pkSess_4505))
                                                        )
                                                        else
                                                            {5546}let v_4508: bool = (Sess_3905 = B) in
                                                            (
                                                                {5547}if v_4508 then
                                                                (
                                                                    {5548}let pkSess_4509: bitstring = pub(skB) in
                                                                    {5549}in(c, =GetEndpointRequest);
                                                                    {5550}new SPs_4510: bitstring;
                                                                    {5551}new UP_4511: bitstring;
                                                                    {5552}out(c, (SPs_4510,SignAndEncrypt,UP_4511,pkSess_4509))
                                                                )
                                                                else
                                                                    {5553}let v_4512: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5554}if v_4512 then
                                                                        (
                                                                            {5555}let pkSess_4513: bitstring = pub(skC) in
                                                                            {5556}in(c, =GetEndpointRequest);
                                                                            {5557}new SPs_4514: bitstring;
                                                                            {5558}new UP_4515: bitstring;
                                                                            {5559}out(c, (SPs_4514,SignAndEncrypt,UP_4515,pkSess_4513))
                                                                        )
                                                                        else
                                                                            {5560}let pkSess_4516: bitstring = pub(skI) in
                                                                            {5561}in(c, =GetEndpointRequest);
                                                                            {5562}new SPs_4517: bitstring;
                                                                            {5563}new UP_4518: bitstring;
                                                                            {5564}out(c, (SPs_4517,SignAndEncrypt,UP_4518,pkSess_4516))
                                                                    )
                                                                    else
                                                                        {5565}let pkSess_4519: bitstring = fail-any in
                                                                        {5566}in(c, =GetEndpointRequest);
                                                                        {5567}new SPs_4520: bitstring;
                                                                        {5568}new UP_4521: bitstring;
                                                                        {5569}out(c, (SPs_4520,SignAndEncrypt,UP_4521,pkSess_4519))
                                                            )
                                                            else
                                                                {5570}let pkSess_4522: bitstring = fail-any in
                                                                {5571}in(c, =GetEndpointRequest);
                                                                {5572}new SPs_4523: bitstring;
                                                                {5573}new UP_4524: bitstring;
                                                                {5574}out(c, (SPs_4523,SignAndEncrypt,UP_4524,pkSess_4522))
                                                    )
                                                    else
                                                        {5575}let pkSess_4525: bitstring = fail-any in
                                                        {5576}in(c, =GetEndpointRequest);
                                                        {5577}new SPs_4526: bitstring;
                                                        {5578}new UP_4527: bitstring;
                                                        {5579}out(c, (SPs_4526,SignAndEncrypt,UP_4527,pkSess_4525))
                                                )
                                                else
                                                    {5580}let pkCli_4528: bitstring = pub(skI) in
                                                    {5581}let v_4529: bool = (Sess_3905 = A) in
                                                    (
                                                        {5582}if v_4529 then
                                                        (
                                                            {5583}let pkSess_4530: bitstring = pub(skA) in
                                                            {5584}in(c, =GetEndpointRequest);
                                                            {5585}new SPs_4531: bitstring;
                                                            {5586}new UP_4532: bitstring;
                                                            {5587}out(c, (SPs_4531,SignAndEncrypt,UP_4532,pkSess_4530))
                                                        )
                                                        else
                                                            {5588}let v_4533: bool = (Sess_3905 = B) in
                                                            (
                                                                {5589}if v_4533 then
                                                                (
                                                                    {5590}let pkSess_4534: bitstring = pub(skB) in
                                                                    {5591}in(c, =GetEndpointRequest);
                                                                    {5592}new SPs_4535: bitstring;
                                                                    {5593}new UP_4536: bitstring;
                                                                    {5594}out(c, (SPs_4535,SignAndEncrypt,UP_4536,pkSess_4534))
                                                                )
                                                                else
                                                                    {5595}let v_4537: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5596}if v_4537 then
                                                                        (
                                                                            {5597}let pkSess_4538: bitstring = pub(skC) in
                                                                            {5598}in(c, =GetEndpointRequest);
                                                                            {5599}new SPs_4539: bitstring;
                                                                            {5600}new UP_4540: bitstring;
                                                                            {5601}out(c, (SPs_4539,SignAndEncrypt,UP_4540,pkSess_4538))
                                                                        )
                                                                        else
                                                                            {5602}let pkSess_4541: bitstring = pub(skI) in
                                                                            {5603}in(c, =GetEndpointRequest);
                                                                            {5604}new SPs_4542: bitstring;
                                                                            {5605}new UP_4543: bitstring;
                                                                            {5606}out(c, (SPs_4542,SignAndEncrypt,UP_4543,pkSess_4541))
                                                                    )
                                                                    else
                                                                        {5607}let pkSess_4544: bitstring = fail-any in
                                                                        {5608}in(c, =GetEndpointRequest);
                                                                        {5609}new SPs_4545: bitstring;
                                                                        {5610}new UP_4546: bitstring;
                                                                        {5611}out(c, (SPs_4545,SignAndEncrypt,UP_4546,pkSess_4544))
                                                            )
                                                            else
                                                                {5612}let pkSess_4547: bitstring = fail-any in
                                                                {5613}in(c, =GetEndpointRequest);
                                                                {5614}new SPs_4548: bitstring;
                                                                {5615}new UP_4549: bitstring;
                                                                {5616}out(c, (SPs_4548,SignAndEncrypt,UP_4549,pkSess_4547))
                                                    )
                                                    else
                                                        {5617}let pkSess_4550: bitstring = fail-any in
                                                        {5618}in(c, =GetEndpointRequest);
                                                        {5619}new SPs_4551: bitstring;
                                                        {5620}new UP_4552: bitstring;
                                                        {5621}out(c, (SPs_4551,SignAndEncrypt,UP_4552,pkSess_4550))
                                            )
                                            else
                                                {5622}let pkCli_4553: bitstring = fail-any in
                                                {5623}let v_4554: bool = (Sess_3905 = A) in
                                                (
                                                    {5624}if v_4554 then
                                                    (
                                                        {5625}let pkSess_4555: bitstring = pub(skA) in
                                                        {5626}in(c, =GetEndpointRequest);
                                                        {5627}new SPs_4556: bitstring;
                                                        {5628}new UP_4557: bitstring;
                                                        {5629}out(c, (SPs_4556,SignAndEncrypt,UP_4557,pkSess_4555))
                                                    )
                                                    else
                                                        {5630}let v_4558: bool = (Sess_3905 = B) in
                                                        (
                                                            {5631}if v_4558 then
                                                            (
                                                                {5632}let pkSess_4559: bitstring = pub(skB) in
                                                                {5633}in(c, =GetEndpointRequest);
                                                                {5634}new SPs_4560: bitstring;
                                                                {5635}new UP_4561: bitstring;
                                                                {5636}out(c, (SPs_4560,SignAndEncrypt,UP_4561,pkSess_4559))
                                                            )
                                                            else
                                                                {5637}let v_4562: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5638}if v_4562 then
                                                                    (
                                                                        {5639}let pkSess_4563: bitstring = pub(skC) in
                                                                        {5640}in(c, =GetEndpointRequest);
                                                                        {5641}new SPs_4564: bitstring;
                                                                        {5642}new UP_4565: bitstring;
                                                                        {5643}out(c, (SPs_4564,SignAndEncrypt,UP_4565,pkSess_4563))
                                                                    )
                                                                    else
                                                                        {5644}let pkSess_4566: bitstring = pub(skI) in
                                                                        {5645}in(c, =GetEndpointRequest);
                                                                        {5646}new SPs_4567: bitstring;
                                                                        {5647}new UP_4568: bitstring;
                                                                        {5648}out(c, (SPs_4567,SignAndEncrypt,UP_4568,pkSess_4566))
                                                                )
                                                                else
                                                                    {5649}let pkSess_4569: bitstring = fail-any in
                                                                    {5650}in(c, =GetEndpointRequest);
                                                                    {5651}new SPs_4570: bitstring;
                                                                    {5652}new UP_4571: bitstring;
                                                                    {5653}out(c, (SPs_4570,SignAndEncrypt,UP_4571,pkSess_4569))
                                                        )
                                                        else
                                                            {5654}let pkSess_4572: bitstring = fail-any in
                                                            {5655}in(c, =GetEndpointRequest);
                                                            {5656}new SPs_4573: bitstring;
                                                            {5657}new UP_4574: bitstring;
                                                            {5658}out(c, (SPs_4573,SignAndEncrypt,UP_4574,pkSess_4572))
                                                )
                                                else
                                                    {5659}let pkSess_4575: bitstring = fail-any in
                                                    {5660}in(c, =GetEndpointRequest);
                                                    {5661}new SPs_4576: bitstring;
                                                    {5662}new UP_4577: bitstring;
                                                    {5663}out(c, (SPs_4576,SignAndEncrypt,UP_4577,pkSess_4575))
                                    )
                                    else
                                        {5664}let pkCli_4578: bitstring = fail-any in
                                        {5665}let v_4579: bool = (Sess_3905 = A) in
                                        (
                                            {5666}if v_4579 then
                                            (
                                                {5667}let pkSess_4580: bitstring = pub(skA) in
                                                {5668}in(c, =GetEndpointRequest);
                                                {5669}new SPs_4581: bitstring;
                                                {5670}new UP_4582: bitstring;
                                                {5671}out(c, (SPs_4581,SignAndEncrypt,UP_4582,pkSess_4580))
                                            )
                                            else
                                                {5672}let v_4583: bool = (Sess_3905 = B) in
                                                (
                                                    {5673}if v_4583 then
                                                    (
                                                        {5674}let pkSess_4584: bitstring = pub(skB) in
                                                        {5675}in(c, =GetEndpointRequest);
                                                        {5676}new SPs_4585: bitstring;
                                                        {5677}new UP_4586: bitstring;
                                                        {5678}out(c, (SPs_4585,SignAndEncrypt,UP_4586,pkSess_4584))
                                                    )
                                                    else
                                                        {5679}let v_4587: bool = (Sess_3905 = C) in
                                                        (
                                                            {5680}if v_4587 then
                                                            (
                                                                {5681}let pkSess_4588: bitstring = pub(skC) in
                                                                {5682}in(c, =GetEndpointRequest);
                                                                {5683}new SPs_4589: bitstring;
                                                                {5684}new UP_4590: bitstring;
                                                                {5685}out(c, (SPs_4589,SignAndEncrypt,UP_4590,pkSess_4588))
                                                            )
                                                            else
                                                                {5686}let pkSess_4591: bitstring = pub(skI) in
                                                                {5687}in(c, =GetEndpointRequest);
                                                                {5688}new SPs_4592: bitstring;
                                                                {5689}new UP_4593: bitstring;
                                                                {5690}out(c, (SPs_4592,SignAndEncrypt,UP_4593,pkSess_4591))
                                                        )
                                                        else
                                                            {5691}let pkSess_4594: bitstring = fail-any in
                                                            {5692}in(c, =GetEndpointRequest);
                                                            {5693}new SPs_4595: bitstring;
                                                            {5694}new UP_4596: bitstring;
                                                            {5695}out(c, (SPs_4595,SignAndEncrypt,UP_4596,pkSess_4594))
                                                )
                                                else
                                                    {5696}let pkSess_4597: bitstring = fail-any in
                                                    {5697}in(c, =GetEndpointRequest);
                                                    {5698}new SPs_4598: bitstring;
                                                    {5699}new UP_4599: bitstring;
                                                    {5700}out(c, (SPs_4598,SignAndEncrypt,UP_4599,pkSess_4597))
                                        )
                                        else
                                            {5701}let pkSess_4600: bitstring = fail-any in
                                            {5702}in(c, =GetEndpointRequest);
                                            {5703}new SPs_4601: bitstring;
                                            {5704}new UP_4602: bitstring;
                                            {5705}out(c, (SPs_4601,SignAndEncrypt,UP_4602,pkSess_4600))
                            )
                            else
                                {5706}let pkCli_4603: bitstring = fail-any in
                                {5707}let v_4604: bool = (Sess_3905 = A) in
                                (
                                    {5708}if v_4604 then
                                    (
                                        {5709}let pkSess_4605: bitstring = pub(skA) in
                                        {5710}in(c, =GetEndpointRequest);
                                        {5711}new SPs_4606: bitstring;
                                        {5712}new UP_4607: bitstring;
                                        {5713}out(c, (SPs_4606,SignAndEncrypt,UP_4607,pkSess_4605))
                                    )
                                    else
                                        {5714}let v_4608: bool = (Sess_3905 = B) in
                                        (
                                            {5715}if v_4608 then
                                            (
                                                {5716}let pkSess_4609: bitstring = pub(skB) in
                                                {5717}in(c, =GetEndpointRequest);
                                                {5718}new SPs_4610: bitstring;
                                                {5719}new UP_4611: bitstring;
                                                {5720}out(c, (SPs_4610,SignAndEncrypt,UP_4611,pkSess_4609))
                                            )
                                            else
                                                {5721}let v_4612: bool = (Sess_3905 = C) in
                                                (
                                                    {5722}if v_4612 then
                                                    (
                                                        {5723}let pkSess_4613: bitstring = pub(skC) in
                                                        {5724}in(c, =GetEndpointRequest);
                                                        {5725}new SPs_4614: bitstring;
                                                        {5726}new UP_4615: bitstring;
                                                        {5727}out(c, (SPs_4614,SignAndEncrypt,UP_4615,pkSess_4613))
                                                    )
                                                    else
                                                        {5728}let pkSess_4616: bitstring = pub(skI) in
                                                        {5729}in(c, =GetEndpointRequest);
                                                        {5730}new SPs_4617: bitstring;
                                                        {5731}new UP_4618: bitstring;
                                                        {5732}out(c, (SPs_4617,SignAndEncrypt,UP_4618,pkSess_4616))
                                                )
                                                else
                                                    {5733}let pkSess_4619: bitstring = fail-any in
                                                    {5734}in(c, =GetEndpointRequest);
                                                    {5735}new SPs_4620: bitstring;
                                                    {5736}new UP_4621: bitstring;
                                                    {5737}out(c, (SPs_4620,SignAndEncrypt,UP_4621,pkSess_4619))
                                        )
                                        else
                                            {5738}let pkSess_4622: bitstring = fail-any in
                                            {5739}in(c, =GetEndpointRequest);
                                            {5740}new SPs_4623: bitstring;
                                            {5741}new UP_4624: bitstring;
                                            {5742}out(c, (SPs_4623,SignAndEncrypt,UP_4624,pkSess_4622))
                                )
                                else
                                    {5743}let pkSess_4625: bitstring = fail-any in
                                    {5744}in(c, =GetEndpointRequest);
                                    {5745}new SPs_4626: bitstring;
                                    {5746}new UP_4627: bitstring;
                                    {5747}out(c, (SPs_4626,SignAndEncrypt,UP_4627,pkSess_4625))
                    )
                    else
                        {5748}let skDisco_4628: bitstring = fail-any in
                        {5749}let pkDisco_4629: bitstring = pub(skDisco_4628) in
                        {5750}let v_4630: bool = (Cli_3903 = A) in
                        (
                            {5751}if v_4630 then
                            (
                                {5752}let pkCli_4631: bitstring = pub(skA) in
                                {5753}let v_4632: bool = (Sess_3905 = A) in
                                (
                                    {5754}if v_4632 then
                                    (
                                        {5755}let pkSess_4633: bitstring = pub(skA) in
                                        {5756}in(c, =GetEndpointRequest);
                                        {5757}new SPs_4634: bitstring;
                                        {5758}new UP_4635: bitstring;
                                        {5759}out(c, (SPs_4634,SignAndEncrypt,UP_4635,pkSess_4633))
                                    )
                                    else
                                        {5760}let v_4636: bool = (Sess_3905 = B) in
                                        (
                                            {5761}if v_4636 then
                                            (
                                                {5762}let pkSess_4637: bitstring = pub(skB) in
                                                {5763}in(c, =GetEndpointRequest);
                                                {5764}new SPs_4638: bitstring;
                                                {5765}new UP_4639: bitstring;
                                                {5766}out(c, (SPs_4638,SignAndEncrypt,UP_4639,pkSess_4637))
                                            )
                                            else
                                                {5767}let v_4640: bool = (Sess_3905 = C) in
                                                (
                                                    {5768}if v_4640 then
                                                    (
                                                        {5769}let pkSess_4641: bitstring = pub(skC) in
                                                        {5770}in(c, =GetEndpointRequest);
                                                        {5771}new SPs_4642: bitstring;
                                                        {5772}new UP_4643: bitstring;
                                                        {5773}out(c, (SPs_4642,SignAndEncrypt,UP_4643,pkSess_4641))
                                                    )
                                                    else
                                                        {5774}let pkSess_4644: bitstring = pub(skI) in
                                                        {5775}in(c, =GetEndpointRequest);
                                                        {5776}new SPs_4645: bitstring;
                                                        {5777}new UP_4646: bitstring;
                                                        {5778}out(c, (SPs_4645,SignAndEncrypt,UP_4646,pkSess_4644))
                                                )
                                                else
                                                    {5779}let pkSess_4647: bitstring = fail-any in
                                                    {5780}in(c, =GetEndpointRequest);
                                                    {5781}new SPs_4648: bitstring;
                                                    {5782}new UP_4649: bitstring;
                                                    {5783}out(c, (SPs_4648,SignAndEncrypt,UP_4649,pkSess_4647))
                                        )
                                        else
                                            {5784}let pkSess_4650: bitstring = fail-any in
                                            {5785}in(c, =GetEndpointRequest);
                                            {5786}new SPs_4651: bitstring;
                                            {5787}new UP_4652: bitstring;
                                            {5788}out(c, (SPs_4651,SignAndEncrypt,UP_4652,pkSess_4650))
                                )
                                else
                                    {5789}let pkSess_4653: bitstring = fail-any in
                                    {5790}in(c, =GetEndpointRequest);
                                    {5791}new SPs_4654: bitstring;
                                    {5792}new UP_4655: bitstring;
                                    {5793}out(c, (SPs_4654,SignAndEncrypt,UP_4655,pkSess_4653))
                            )
                            else
                                {5794}let v_4656: bool = (Cli_3903 = B) in
                                (
                                    {5795}if v_4656 then
                                    (
                                        {5796}let pkCli_4657: bitstring = pub(skB) in
                                        {5797}let v_4658: bool = (Sess_3905 = A) in
                                        (
                                            {5798}if v_4658 then
                                            (
                                                {5799}let pkSess_4659: bitstring = pub(skA) in
                                                {5800}in(c, =GetEndpointRequest);
                                                {5801}new SPs_4660: bitstring;
                                                {5802}new UP_4661: bitstring;
                                                {5803}out(c, (SPs_4660,SignAndEncrypt,UP_4661,pkSess_4659))
                                            )
                                            else
                                                {5804}let v_4662: bool = (Sess_3905 = B) in
                                                (
                                                    {5805}if v_4662 then
                                                    (
                                                        {5806}let pkSess_4663: bitstring = pub(skB) in
                                                        {5807}in(c, =GetEndpointRequest);
                                                        {5808}new SPs_4664: bitstring;
                                                        {5809}new UP_4665: bitstring;
                                                        {5810}out(c, (SPs_4664,SignAndEncrypt,UP_4665,pkSess_4663))
                                                    )
                                                    else
                                                        {5811}let v_4666: bool = (Sess_3905 = C) in
                                                        (
                                                            {5812}if v_4666 then
                                                            (
                                                                {5813}let pkSess_4667: bitstring = pub(skC) in
                                                                {5814}in(c, =GetEndpointRequest);
                                                                {5815}new SPs_4668: bitstring;
                                                                {5816}new UP_4669: bitstring;
                                                                {5817}out(c, (SPs_4668,SignAndEncrypt,UP_4669,pkSess_4667))
                                                            )
                                                            else
                                                                {5818}let pkSess_4670: bitstring = pub(skI) in
                                                                {5819}in(c, =GetEndpointRequest);
                                                                {5820}new SPs_4671: bitstring;
                                                                {5821}new UP_4672: bitstring;
                                                                {5822}out(c, (SPs_4671,SignAndEncrypt,UP_4672,pkSess_4670))
                                                        )
                                                        else
                                                            {5823}let pkSess_4673: bitstring = fail-any in
                                                            {5824}in(c, =GetEndpointRequest);
                                                            {5825}new SPs_4674: bitstring;
                                                            {5826}new UP_4675: bitstring;
                                                            {5827}out(c, (SPs_4674,SignAndEncrypt,UP_4675,pkSess_4673))
                                                )
                                                else
                                                    {5828}let pkSess_4676: bitstring = fail-any in
                                                    {5829}in(c, =GetEndpointRequest);
                                                    {5830}new SPs_4677: bitstring;
                                                    {5831}new UP_4678: bitstring;
                                                    {5832}out(c, (SPs_4677,SignAndEncrypt,UP_4678,pkSess_4676))
                                        )
                                        else
                                            {5833}let pkSess_4679: bitstring = fail-any in
                                            {5834}in(c, =GetEndpointRequest);
                                            {5835}new SPs_4680: bitstring;
                                            {5836}new UP_4681: bitstring;
                                            {5837}out(c, (SPs_4680,SignAndEncrypt,UP_4681,pkSess_4679))
                                    )
                                    else
                                        {5838}let v_4682: bool = (Cli_3903 = C) in
                                        (
                                            {5839}if v_4682 then
                                            (
                                                {5840}let pkCli_4683: bitstring = pub(skC) in
                                                {5841}let v_4684: bool = (Sess_3905 = A) in
                                                (
                                                    {5842}if v_4684 then
                                                    (
                                                        {5843}let pkSess_4685: bitstring = pub(skA) in
                                                        {5844}in(c, =GetEndpointRequest);
                                                        {5845}new SPs_4686: bitstring;
                                                        {5846}new UP_4687: bitstring;
                                                        {5847}out(c, (SPs_4686,SignAndEncrypt,UP_4687,pkSess_4685))
                                                    )
                                                    else
                                                        {5848}let v_4688: bool = (Sess_3905 = B) in
                                                        (
                                                            {5849}if v_4688 then
                                                            (
                                                                {5850}let pkSess_4689: bitstring = pub(skB) in
                                                                {5851}in(c, =GetEndpointRequest);
                                                                {5852}new SPs_4690: bitstring;
                                                                {5853}new UP_4691: bitstring;
                                                                {5854}out(c, (SPs_4690,SignAndEncrypt,UP_4691,pkSess_4689))
                                                            )
                                                            else
                                                                {5855}let v_4692: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5856}if v_4692 then
                                                                    (
                                                                        {5857}let pkSess_4693: bitstring = pub(skC) in
                                                                        {5858}in(c, =GetEndpointRequest);
                                                                        {5859}new SPs_4694: bitstring;
                                                                        {5860}new UP_4695: bitstring;
                                                                        {5861}out(c, (SPs_4694,SignAndEncrypt,UP_4695,pkSess_4693))
                                                                    )
                                                                    else
                                                                        {5862}let pkSess_4696: bitstring = pub(skI) in
                                                                        {5863}in(c, =GetEndpointRequest);
                                                                        {5864}new SPs_4697: bitstring;
                                                                        {5865}new UP_4698: bitstring;
                                                                        {5866}out(c, (SPs_4697,SignAndEncrypt,UP_4698,pkSess_4696))
                                                                )
                                                                else
                                                                    {5867}let pkSess_4699: bitstring = fail-any in
                                                                    {5868}in(c, =GetEndpointRequest);
                                                                    {5869}new SPs_4700: bitstring;
                                                                    {5870}new UP_4701: bitstring;
                                                                    {5871}out(c, (SPs_4700,SignAndEncrypt,UP_4701,pkSess_4699))
                                                        )
                                                        else
                                                            {5872}let pkSess_4702: bitstring = fail-any in
                                                            {5873}in(c, =GetEndpointRequest);
                                                            {5874}new SPs_4703: bitstring;
                                                            {5875}new UP_4704: bitstring;
                                                            {5876}out(c, (SPs_4703,SignAndEncrypt,UP_4704,pkSess_4702))
                                                )
                                                else
                                                    {5877}let pkSess_4705: bitstring = fail-any in
                                                    {5878}in(c, =GetEndpointRequest);
                                                    {5879}new SPs_4706: bitstring;
                                                    {5880}new UP_4707: bitstring;
                                                    {5881}out(c, (SPs_4706,SignAndEncrypt,UP_4707,pkSess_4705))
                                            )
                                            else
                                                {5882}let pkCli_4708: bitstring = pub(skI) in
                                                {5883}let v_4709: bool = (Sess_3905 = A) in
                                                (
                                                    {5884}if v_4709 then
                                                    (
                                                        {5885}let pkSess_4710: bitstring = pub(skA) in
                                                        {5886}in(c, =GetEndpointRequest);
                                                        {5887}new SPs_4711: bitstring;
                                                        {5888}new UP_4712: bitstring;
                                                        {5889}out(c, (SPs_4711,SignAndEncrypt,UP_4712,pkSess_4710))
                                                    )
                                                    else
                                                        {5890}let v_4713: bool = (Sess_3905 = B) in
                                                        (
                                                            {5891}if v_4713 then
                                                            (
                                                                {5892}let pkSess_4714: bitstring = pub(skB) in
                                                                {5893}in(c, =GetEndpointRequest);
                                                                {5894}new SPs_4715: bitstring;
                                                                {5895}new UP_4716: bitstring;
                                                                {5896}out(c, (SPs_4715,SignAndEncrypt,UP_4716,pkSess_4714))
                                                            )
                                                            else
                                                                {5897}let v_4717: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5898}if v_4717 then
                                                                    (
                                                                        {5899}let pkSess_4718: bitstring = pub(skC) in
                                                                        {5900}in(c, =GetEndpointRequest);
                                                                        {5901}new SPs_4719: bitstring;
                                                                        {5902}new UP_4720: bitstring;
                                                                        {5903}out(c, (SPs_4719,SignAndEncrypt,UP_4720,pkSess_4718))
                                                                    )
                                                                    else
                                                                        {5904}let pkSess_4721: bitstring = pub(skI) in
                                                                        {5905}in(c, =GetEndpointRequest);
                                                                        {5906}new SPs_4722: bitstring;
                                                                        {5907}new UP_4723: bitstring;
                                                                        {5908}out(c, (SPs_4722,SignAndEncrypt,UP_4723,pkSess_4721))
                                                                )
                                                                else
                                                                    {5909}let pkSess_4724: bitstring = fail-any in
                                                                    {5910}in(c, =GetEndpointRequest);
                                                                    {5911}new SPs_4725: bitstring;
                                                                    {5912}new UP_4726: bitstring;
                                                                    {5913}out(c, (SPs_4725,SignAndEncrypt,UP_4726,pkSess_4724))
                                                        )
                                                        else
                                                            {5914}let pkSess_4727: bitstring = fail-any in
                                                            {5915}in(c, =GetEndpointRequest);
                                                            {5916}new SPs_4728: bitstring;
                                                            {5917}new UP_4729: bitstring;
                                                            {5918}out(c, (SPs_4728,SignAndEncrypt,UP_4729,pkSess_4727))
                                                )
                                                else
                                                    {5919}let pkSess_4730: bitstring = fail-any in
                                                    {5920}in(c, =GetEndpointRequest);
                                                    {5921}new SPs_4731: bitstring;
                                                    {5922}new UP_4732: bitstring;
                                                    {5923}out(c, (SPs_4731,SignAndEncrypt,UP_4732,pkSess_4730))
                                        )
                                        else
                                            {5924}let pkCli_4733: bitstring = fail-any in
                                            {5925}let v_4734: bool = (Sess_3905 = A) in
                                            (
                                                {5926}if v_4734 then
                                                (
                                                    {5927}let pkSess_4735: bitstring = pub(skA) in
                                                    {5928}in(c, =GetEndpointRequest);
                                                    {5929}new SPs_4736: bitstring;
                                                    {5930}new UP_4737: bitstring;
                                                    {5931}out(c, (SPs_4736,SignAndEncrypt,UP_4737,pkSess_4735))
                                                )
                                                else
                                                    {5932}let v_4738: bool = (Sess_3905 = B) in
                                                    (
                                                        {5933}if v_4738 then
                                                        (
                                                            {5934}let pkSess_4739: bitstring = pub(skB) in
                                                            {5935}in(c, =GetEndpointRequest);
                                                            {5936}new SPs_4740: bitstring;
                                                            {5937}new UP_4741: bitstring;
                                                            {5938}out(c, (SPs_4740,SignAndEncrypt,UP_4741,pkSess_4739))
                                                        )
                                                        else
                                                            {5939}let v_4742: bool = (Sess_3905 = C) in
                                                            (
                                                                {5940}if v_4742 then
                                                                (
                                                                    {5941}let pkSess_4743: bitstring = pub(skC) in
                                                                    {5942}in(c, =GetEndpointRequest);
                                                                    {5943}new SPs_4744: bitstring;
                                                                    {5944}new UP_4745: bitstring;
                                                                    {5945}out(c, (SPs_4744,SignAndEncrypt,UP_4745,pkSess_4743))
                                                                )
                                                                else
                                                                    {5946}let pkSess_4746: bitstring = pub(skI) in
                                                                    {5947}in(c, =GetEndpointRequest);
                                                                    {5948}new SPs_4747: bitstring;
                                                                    {5949}new UP_4748: bitstring;
                                                                    {5950}out(c, (SPs_4747,SignAndEncrypt,UP_4748,pkSess_4746))
                                                            )
                                                            else
                                                                {5951}let pkSess_4749: bitstring = fail-any in
                                                                {5952}in(c, =GetEndpointRequest);
                                                                {5953}new SPs_4750: bitstring;
                                                                {5954}new UP_4751: bitstring;
                                                                {5955}out(c, (SPs_4750,SignAndEncrypt,UP_4751,pkSess_4749))
                                                    )
                                                    else
                                                        {5956}let pkSess_4752: bitstring = fail-any in
                                                        {5957}in(c, =GetEndpointRequest);
                                                        {5958}new SPs_4753: bitstring;
                                                        {5959}new UP_4754: bitstring;
                                                        {5960}out(c, (SPs_4753,SignAndEncrypt,UP_4754,pkSess_4752))
                                            )
                                            else
                                                {5961}let pkSess_4755: bitstring = fail-any in
                                                {5962}in(c, =GetEndpointRequest);
                                                {5963}new SPs_4756: bitstring;
                                                {5964}new UP_4757: bitstring;
                                                {5965}out(c, (SPs_4756,SignAndEncrypt,UP_4757,pkSess_4755))
                                )
                                else
                                    {5966}let pkCli_4758: bitstring = fail-any in
                                    {5967}let v_4759: bool = (Sess_3905 = A) in
                                    (
                                        {5968}if v_4759 then
                                        (
                                            {5969}let pkSess_4760: bitstring = pub(skA) in
                                            {5970}in(c, =GetEndpointRequest);
                                            {5971}new SPs_4761: bitstring;
                                            {5972}new UP_4762: bitstring;
                                            {5973}out(c, (SPs_4761,SignAndEncrypt,UP_4762,pkSess_4760))
                                        )
                                        else
                                            {5974}let v_4763: bool = (Sess_3905 = B) in
                                            (
                                                {5975}if v_4763 then
                                                (
                                                    {5976}let pkSess_4764: bitstring = pub(skB) in
                                                    {5977}in(c, =GetEndpointRequest);
                                                    {5978}new SPs_4765: bitstring;
                                                    {5979}new UP_4766: bitstring;
                                                    {5980}out(c, (SPs_4765,SignAndEncrypt,UP_4766,pkSess_4764))
                                                )
                                                else
                                                    {5981}let v_4767: bool = (Sess_3905 = C) in
                                                    (
                                                        {5982}if v_4767 then
                                                        (
                                                            {5983}let pkSess_4768: bitstring = pub(skC) in
                                                            {5984}in(c, =GetEndpointRequest);
                                                            {5985}new SPs_4769: bitstring;
                                                            {5986}new UP_4770: bitstring;
                                                            {5987}out(c, (SPs_4769,SignAndEncrypt,UP_4770,pkSess_4768))
                                                        )
                                                        else
                                                            {5988}let pkSess_4771: bitstring = pub(skI) in
                                                            {5989}in(c, =GetEndpointRequest);
                                                            {5990}new SPs_4772: bitstring;
                                                            {5991}new UP_4773: bitstring;
                                                            {5992}out(c, (SPs_4772,SignAndEncrypt,UP_4773,pkSess_4771))
                                                    )
                                                    else
                                                        {5993}let pkSess_4774: bitstring = fail-any in
                                                        {5994}in(c, =GetEndpointRequest);
                                                        {5995}new SPs_4775: bitstring;
                                                        {5996}new UP_4776: bitstring;
                                                        {5997}out(c, (SPs_4775,SignAndEncrypt,UP_4776,pkSess_4774))
                                            )
                                            else
                                                {5998}let pkSess_4777: bitstring = fail-any in
                                                {5999}in(c, =GetEndpointRequest);
                                                {6000}new SPs_4778: bitstring;
                                                {6001}new UP_4779: bitstring;
                                                {6002}out(c, (SPs_4778,SignAndEncrypt,UP_4779,pkSess_4777))
                                    )
                                    else
                                        {6003}let pkSess_4780: bitstring = fail-any in
                                        {6004}in(c, =GetEndpointRequest);
                                        {6005}new SPs_4781: bitstring;
                                        {6006}new UP_4782: bitstring;
                                        {6007}out(c, (SPs_4781,SignAndEncrypt,UP_4782,pkSess_4780))
                        )
                        else
                            {6008}let pkCli_4783: bitstring = fail-any in
                            {6009}let v_4784: bool = (Sess_3905 = A) in
                            (
                                {6010}if v_4784 then
                                (
                                    {6011}let pkSess_4785: bitstring = pub(skA) in
                                    {6012}in(c, =GetEndpointRequest);
                                    {6013}new SPs_4786: bitstring;
                                    {6014}new UP_4787: bitstring;
                                    {6015}out(c, (SPs_4786,SignAndEncrypt,UP_4787,pkSess_4785))
                                )
                                else
                                    {6016}let v_4788: bool = (Sess_3905 = B) in
                                    (
                                        {6017}if v_4788 then
                                        (
                                            {6018}let pkSess_4789: bitstring = pub(skB) in
                                            {6019}in(c, =GetEndpointRequest);
                                            {6020}new SPs_4790: bitstring;
                                            {6021}new UP_4791: bitstring;
                                            {6022}out(c, (SPs_4790,SignAndEncrypt,UP_4791,pkSess_4789))
                                        )
                                        else
                                            {6023}let v_4792: bool = (Sess_3905 = C) in
                                            (
                                                {6024}if v_4792 then
                                                (
                                                    {6025}let pkSess_4793: bitstring = pub(skC) in
                                                    {6026}in(c, =GetEndpointRequest);
                                                    {6027}new SPs_4794: bitstring;
                                                    {6028}new UP_4795: bitstring;
                                                    {6029}out(c, (SPs_4794,SignAndEncrypt,UP_4795,pkSess_4793))
                                                )
                                                else
                                                    {6030}let pkSess_4796: bitstring = pub(skI) in
                                                    {6031}in(c, =GetEndpointRequest);
                                                    {6032}new SPs_4797: bitstring;
                                                    {6033}new UP_4798: bitstring;
                                                    {6034}out(c, (SPs_4797,SignAndEncrypt,UP_4798,pkSess_4796))
                                            )
                                            else
                                                {6035}let pkSess_4799: bitstring = fail-any in
                                                {6036}in(c, =GetEndpointRequest);
                                                {6037}new SPs_4800: bitstring;
                                                {6038}new UP_4801: bitstring;
                                                {6039}out(c, (SPs_4800,SignAndEncrypt,UP_4801,pkSess_4799))
                                    )
                                    else
                                        {6040}let pkSess_4802: bitstring = fail-any in
                                        {6041}in(c, =GetEndpointRequest);
                                        {6042}new SPs_4803: bitstring;
                                        {6043}new UP_4804: bitstring;
                                        {6044}out(c, (SPs_4803,SignAndEncrypt,UP_4804,pkSess_4802))
                            )
                            else
                                {6045}let pkSess_4805: bitstring = fail-any in
                                {6046}in(c, =GetEndpointRequest);
                                {6047}new SPs_4806: bitstring;
                                {6048}new UP_4807: bitstring;
                                {6049}out(c, (SPs_4806,SignAndEncrypt,UP_4807,pkSess_4805))
            )
            else
                {6050}let skDisco_4808: bitstring = fail-any in
                {6051}let pkDisco_4809: bitstring = pub(skDisco_4808) in
                {6052}let v_4810: bool = (Cli_3903 = A) in
                (
                    {6053}if v_4810 then
                    (
                        {6054}let pkCli_4811: bitstring = pub(skA) in
                        {6055}let v_4812: bool = (Sess_3905 = A) in
                        (
                            {6056}if v_4812 then
                            (
                                {6057}let pkSess_4813: bitstring = pub(skA) in
                                {6058}in(c, =GetEndpointRequest);
                                {6059}new SPs_4814: bitstring;
                                {6060}new UP_4815: bitstring;
                                {6061}out(c, (SPs_4814,SignAndEncrypt,UP_4815,pkSess_4813))
                            )
                            else
                                {6062}let v_4816: bool = (Sess_3905 = B) in
                                (
                                    {6063}if v_4816 then
                                    (
                                        {6064}let pkSess_4817: bitstring = pub(skB) in
                                        {6065}in(c, =GetEndpointRequest);
                                        {6066}new SPs_4818: bitstring;
                                        {6067}new UP_4819: bitstring;
                                        {6068}out(c, (SPs_4818,SignAndEncrypt,UP_4819,pkSess_4817))
                                    )
                                    else
                                        {6069}let v_4820: bool = (Sess_3905 = C) in
                                        (
                                            {6070}if v_4820 then
                                            (
                                                {6071}let pkSess_4821: bitstring = pub(skC) in
                                                {6072}in(c, =GetEndpointRequest);
                                                {6073}new SPs_4822: bitstring;
                                                {6074}new UP_4823: bitstring;
                                                {6075}out(c, (SPs_4822,SignAndEncrypt,UP_4823,pkSess_4821))
                                            )
                                            else
                                                {6076}let pkSess_4824: bitstring = pub(skI) in
                                                {6077}in(c, =GetEndpointRequest);
                                                {6078}new SPs_4825: bitstring;
                                                {6079}new UP_4826: bitstring;
                                                {6080}out(c, (SPs_4825,SignAndEncrypt,UP_4826,pkSess_4824))
                                        )
                                        else
                                            {6081}let pkSess_4827: bitstring = fail-any in
                                            {6082}in(c, =GetEndpointRequest);
                                            {6083}new SPs_4828: bitstring;
                                            {6084}new UP_4829: bitstring;
                                            {6085}out(c, (SPs_4828,SignAndEncrypt,UP_4829,pkSess_4827))
                                )
                                else
                                    {6086}let pkSess_4830: bitstring = fail-any in
                                    {6087}in(c, =GetEndpointRequest);
                                    {6088}new SPs_4831: bitstring;
                                    {6089}new UP_4832: bitstring;
                                    {6090}out(c, (SPs_4831,SignAndEncrypt,UP_4832,pkSess_4830))
                        )
                        else
                            {6091}let pkSess_4833: bitstring = fail-any in
                            {6092}in(c, =GetEndpointRequest);
                            {6093}new SPs_4834: bitstring;
                            {6094}new UP_4835: bitstring;
                            {6095}out(c, (SPs_4834,SignAndEncrypt,UP_4835,pkSess_4833))
                    )
                    else
                        {6096}let v_4836: bool = (Cli_3903 = B) in
                        (
                            {6097}if v_4836 then
                            (
                                {6098}let pkCli_4837: bitstring = pub(skB) in
                                {6099}let v_4838: bool = (Sess_3905 = A) in
                                (
                                    {6100}if v_4838 then
                                    (
                                        {6101}let pkSess_4839: bitstring = pub(skA) in
                                        {6102}in(c, =GetEndpointRequest);
                                        {6103}new SPs_4840: bitstring;
                                        {6104}new UP_4841: bitstring;
                                        {6105}out(c, (SPs_4840,SignAndEncrypt,UP_4841,pkSess_4839))
                                    )
                                    else
                                        {6106}let v_4842: bool = (Sess_3905 = B) in
                                        (
                                            {6107}if v_4842 then
                                            (
                                                {6108}let pkSess_4843: bitstring = pub(skB) in
                                                {6109}in(c, =GetEndpointRequest);
                                                {6110}new SPs_4844: bitstring;
                                                {6111}new UP_4845: bitstring;
                                                {6112}out(c, (SPs_4844,SignAndEncrypt,UP_4845,pkSess_4843))
                                            )
                                            else
                                                {6113}let v_4846: bool = (Sess_3905 = C) in
                                                (
                                                    {6114}if v_4846 then
                                                    (
                                                        {6115}let pkSess_4847: bitstring = pub(skC) in
                                                        {6116}in(c, =GetEndpointRequest);
                                                        {6117}new SPs_4848: bitstring;
                                                        {6118}new UP_4849: bitstring;
                                                        {6119}out(c, (SPs_4848,SignAndEncrypt,UP_4849,pkSess_4847))
                                                    )
                                                    else
                                                        {6120}let pkSess_4850: bitstring = pub(skI) in
                                                        {6121}in(c, =GetEndpointRequest);
                                                        {6122}new SPs_4851: bitstring;
                                                        {6123}new UP_4852: bitstring;
                                                        {6124}out(c, (SPs_4851,SignAndEncrypt,UP_4852,pkSess_4850))
                                                )
                                                else
                                                    {6125}let pkSess_4853: bitstring = fail-any in
                                                    {6126}in(c, =GetEndpointRequest);
                                                    {6127}new SPs_4854: bitstring;
                                                    {6128}new UP_4855: bitstring;
                                                    {6129}out(c, (SPs_4854,SignAndEncrypt,UP_4855,pkSess_4853))
                                        )
                                        else
                                            {6130}let pkSess_4856: bitstring = fail-any in
                                            {6131}in(c, =GetEndpointRequest);
                                            {6132}new SPs_4857: bitstring;
                                            {6133}new UP_4858: bitstring;
                                            {6134}out(c, (SPs_4857,SignAndEncrypt,UP_4858,pkSess_4856))
                                )
                                else
                                    {6135}let pkSess_4859: bitstring = fail-any in
                                    {6136}in(c, =GetEndpointRequest);
                                    {6137}new SPs_4860: bitstring;
                                    {6138}new UP_4861: bitstring;
                                    {6139}out(c, (SPs_4860,SignAndEncrypt,UP_4861,pkSess_4859))
                            )
                            else
                                {6140}let v_4862: bool = (Cli_3903 = C) in
                                (
                                    {6141}if v_4862 then
                                    (
                                        {6142}let pkCli_4863: bitstring = pub(skC) in
                                        {6143}let v_4864: bool = (Sess_3905 = A) in
                                        (
                                            {6144}if v_4864 then
                                            (
                                                {6145}let pkSess_4865: bitstring = pub(skA) in
                                                {6146}in(c, =GetEndpointRequest);
                                                {6147}new SPs_4866: bitstring;
                                                {6148}new UP_4867: bitstring;
                                                {6149}out(c, (SPs_4866,SignAndEncrypt,UP_4867,pkSess_4865))
                                            )
                                            else
                                                {6150}let v_4868: bool = (Sess_3905 = B) in
                                                (
                                                    {6151}if v_4868 then
                                                    (
                                                        {6152}let pkSess_4869: bitstring = pub(skB) in
                                                        {6153}in(c, =GetEndpointRequest);
                                                        {6154}new SPs_4870: bitstring;
                                                        {6155}new UP_4871: bitstring;
                                                        {6156}out(c, (SPs_4870,SignAndEncrypt,UP_4871,pkSess_4869))
                                                    )
                                                    else
                                                        {6157}let v_4872: bool = (Sess_3905 = C) in
                                                        (
                                                            {6158}if v_4872 then
                                                            (
                                                                {6159}let pkSess_4873: bitstring = pub(skC) in
                                                                {6160}in(c, =GetEndpointRequest);
                                                                {6161}new SPs_4874: bitstring;
                                                                {6162}new UP_4875: bitstring;
                                                                {6163}out(c, (SPs_4874,SignAndEncrypt,UP_4875,pkSess_4873))
                                                            )
                                                            else
                                                                {6164}let pkSess_4876: bitstring = pub(skI) in
                                                                {6165}in(c, =GetEndpointRequest);
                                                                {6166}new SPs_4877: bitstring;
                                                                {6167}new UP_4878: bitstring;
                                                                {6168}out(c, (SPs_4877,SignAndEncrypt,UP_4878,pkSess_4876))
                                                        )
                                                        else
                                                            {6169}let pkSess_4879: bitstring = fail-any in
                                                            {6170}in(c, =GetEndpointRequest);
                                                            {6171}new SPs_4880: bitstring;
                                                            {6172}new UP_4881: bitstring;
                                                            {6173}out(c, (SPs_4880,SignAndEncrypt,UP_4881,pkSess_4879))
                                                )
                                                else
                                                    {6174}let pkSess_4882: bitstring = fail-any in
                                                    {6175}in(c, =GetEndpointRequest);
                                                    {6176}new SPs_4883: bitstring;
                                                    {6177}new UP_4884: bitstring;
                                                    {6178}out(c, (SPs_4883,SignAndEncrypt,UP_4884,pkSess_4882))
                                        )
                                        else
                                            {6179}let pkSess_4885: bitstring = fail-any in
                                            {6180}in(c, =GetEndpointRequest);
                                            {6181}new SPs_4886: bitstring;
                                            {6182}new UP_4887: bitstring;
                                            {6183}out(c, (SPs_4886,SignAndEncrypt,UP_4887,pkSess_4885))
                                    )
                                    else
                                        {6184}let pkCli_4888: bitstring = pub(skI) in
                                        {6185}let v_4889: bool = (Sess_3905 = A) in
                                        (
                                            {6186}if v_4889 then
                                            (
                                                {6187}let pkSess_4890: bitstring = pub(skA) in
                                                {6188}in(c, =GetEndpointRequest);
                                                {6189}new SPs_4891: bitstring;
                                                {6190}new UP_4892: bitstring;
                                                {6191}out(c, (SPs_4891,SignAndEncrypt,UP_4892,pkSess_4890))
                                            )
                                            else
                                                {6192}let v_4893: bool = (Sess_3905 = B) in
                                                (
                                                    {6193}if v_4893 then
                                                    (
                                                        {6194}let pkSess_4894: bitstring = pub(skB) in
                                                        {6195}in(c, =GetEndpointRequest);
                                                        {6196}new SPs_4895: bitstring;
                                                        {6197}new UP_4896: bitstring;
                                                        {6198}out(c, (SPs_4895,SignAndEncrypt,UP_4896,pkSess_4894))
                                                    )
                                                    else
                                                        {6199}let v_4897: bool = (Sess_3905 = C) in
                                                        (
                                                            {6200}if v_4897 then
                                                            (
                                                                {6201}let pkSess_4898: bitstring = pub(skC) in
                                                                {6202}in(c, =GetEndpointRequest);
                                                                {6203}new SPs_4899: bitstring;
                                                                {6204}new UP_4900: bitstring;
                                                                {6205}out(c, (SPs_4899,SignAndEncrypt,UP_4900,pkSess_4898))
                                                            )
                                                            else
                                                                {6206}let pkSess_4901: bitstring = pub(skI) in
                                                                {6207}in(c, =GetEndpointRequest);
                                                                {6208}new SPs_4902: bitstring;
                                                                {6209}new UP_4903: bitstring;
                                                                {6210}out(c, (SPs_4902,SignAndEncrypt,UP_4903,pkSess_4901))
                                                        )
                                                        else
                                                            {6211}let pkSess_4904: bitstring = fail-any in
                                                            {6212}in(c, =GetEndpointRequest);
                                                            {6213}new SPs_4905: bitstring;
                                                            {6214}new UP_4906: bitstring;
                                                            {6215}out(c, (SPs_4905,SignAndEncrypt,UP_4906,pkSess_4904))
                                                )
                                                else
                                                    {6216}let pkSess_4907: bitstring = fail-any in
                                                    {6217}in(c, =GetEndpointRequest);
                                                    {6218}new SPs_4908: bitstring;
                                                    {6219}new UP_4909: bitstring;
                                                    {6220}out(c, (SPs_4908,SignAndEncrypt,UP_4909,pkSess_4907))
                                        )
                                        else
                                            {6221}let pkSess_4910: bitstring = fail-any in
                                            {6222}in(c, =GetEndpointRequest);
                                            {6223}new SPs_4911: bitstring;
                                            {6224}new UP_4912: bitstring;
                                            {6225}out(c, (SPs_4911,SignAndEncrypt,UP_4912,pkSess_4910))
                                )
                                else
                                    {6226}let pkCli_4913: bitstring = fail-any in
                                    {6227}let v_4914: bool = (Sess_3905 = A) in
                                    (
                                        {6228}if v_4914 then
                                        (
                                            {6229}let pkSess_4915: bitstring = pub(skA) in
                                            {6230}in(c, =GetEndpointRequest);
                                            {6231}new SPs_4916: bitstring;
                                            {6232}new UP_4917: bitstring;
                                            {6233}out(c, (SPs_4916,SignAndEncrypt,UP_4917,pkSess_4915))
                                        )
                                        else
                                            {6234}let v_4918: bool = (Sess_3905 = B) in
                                            (
                                                {6235}if v_4918 then
                                                (
                                                    {6236}let pkSess_4919: bitstring = pub(skB) in
                                                    {6237}in(c, =GetEndpointRequest);
                                                    {6238}new SPs_4920: bitstring;
                                                    {6239}new UP_4921: bitstring;
                                                    {6240}out(c, (SPs_4920,SignAndEncrypt,UP_4921,pkSess_4919))
                                                )
                                                else
                                                    {6241}let v_4922: bool = (Sess_3905 = C) in
                                                    (
                                                        {6242}if v_4922 then
                                                        (
                                                            {6243}let pkSess_4923: bitstring = pub(skC) in
                                                            {6244}in(c, =GetEndpointRequest);
                                                            {6245}new SPs_4924: bitstring;
                                                            {6246}new UP_4925: bitstring;
                                                            {6247}out(c, (SPs_4924,SignAndEncrypt,UP_4925,pkSess_4923))
                                                        )
                                                        else
                                                            {6248}let pkSess_4926: bitstring = pub(skI) in
                                                            {6249}in(c, =GetEndpointRequest);
                                                            {6250}new SPs_4927: bitstring;
                                                            {6251}new UP_4928: bitstring;
                                                            {6252}out(c, (SPs_4927,SignAndEncrypt,UP_4928,pkSess_4926))
                                                    )
                                                    else
                                                        {6253}let pkSess_4929: bitstring = fail-any in
                                                        {6254}in(c, =GetEndpointRequest);
                                                        {6255}new SPs_4930: bitstring;
                                                        {6256}new UP_4931: bitstring;
                                                        {6257}out(c, (SPs_4930,SignAndEncrypt,UP_4931,pkSess_4929))
                                            )
                                            else
                                                {6258}let pkSess_4932: bitstring = fail-any in
                                                {6259}in(c, =GetEndpointRequest);
                                                {6260}new SPs_4933: bitstring;
                                                {6261}new UP_4934: bitstring;
                                                {6262}out(c, (SPs_4933,SignAndEncrypt,UP_4934,pkSess_4932))
                                    )
                                    else
                                        {6263}let pkSess_4935: bitstring = fail-any in
                                        {6264}in(c, =GetEndpointRequest);
                                        {6265}new SPs_4936: bitstring;
                                        {6266}new UP_4937: bitstring;
                                        {6267}out(c, (SPs_4936,SignAndEncrypt,UP_4937,pkSess_4935))
                        )
                        else
                            {6268}let pkCli_4938: bitstring = fail-any in
                            {6269}let v_4939: bool = (Sess_3905 = A) in
                            (
                                {6270}if v_4939 then
                                (
                                    {6271}let pkSess_4940: bitstring = pub(skA) in
                                    {6272}in(c, =GetEndpointRequest);
                                    {6273}new SPs_4941: bitstring;
                                    {6274}new UP_4942: bitstring;
                                    {6275}out(c, (SPs_4941,SignAndEncrypt,UP_4942,pkSess_4940))
                                )
                                else
                                    {6276}let v_4943: bool = (Sess_3905 = B) in
                                    (
                                        {6277}if v_4943 then
                                        (
                                            {6278}let pkSess_4944: bitstring = pub(skB) in
                                            {6279}in(c, =GetEndpointRequest);
                                            {6280}new SPs_4945: bitstring;
                                            {6281}new UP_4946: bitstring;
                                            {6282}out(c, (SPs_4945,SignAndEncrypt,UP_4946,pkSess_4944))
                                        )
                                        else
                                            {6283}let v_4947: bool = (Sess_3905 = C) in
                                            (
                                                {6284}if v_4947 then
                                                (
                                                    {6285}let pkSess_4948: bitstring = pub(skC) in
                                                    {6286}in(c, =GetEndpointRequest);
                                                    {6287}new SPs_4949: bitstring;
                                                    {6288}new UP_4950: bitstring;
                                                    {6289}out(c, (SPs_4949,SignAndEncrypt,UP_4950,pkSess_4948))
                                                )
                                                else
                                                    {6290}let pkSess_4951: bitstring = pub(skI) in
                                                    {6291}in(c, =GetEndpointRequest);
                                                    {6292}new SPs_4952: bitstring;
                                                    {6293}new UP_4953: bitstring;
                                                    {6294}out(c, (SPs_4952,SignAndEncrypt,UP_4953,pkSess_4951))
                                            )
                                            else
                                                {6295}let pkSess_4954: bitstring = fail-any in
                                                {6296}in(c, =GetEndpointRequest);
                                                {6297}new SPs_4955: bitstring;
                                                {6298}new UP_4956: bitstring;
                                                {6299}out(c, (SPs_4955,SignAndEncrypt,UP_4956,pkSess_4954))
                                    )
                                    else
                                        {6300}let pkSess_4957: bitstring = fail-any in
                                        {6301}in(c, =GetEndpointRequest);
                                        {6302}new SPs_4958: bitstring;
                                        {6303}new UP_4959: bitstring;
                                        {6304}out(c, (SPs_4958,SignAndEncrypt,UP_4959,pkSess_4957))
                            )
                            else
                                {6305}let pkSess_4960: bitstring = fail-any in
                                {6306}in(c, =GetEndpointRequest);
                                {6307}new SPs_4961: bitstring;
                                {6308}new UP_4962: bitstring;
                                {6309}out(c, (SPs_4961,SignAndEncrypt,UP_4962,pkSess_4960))
                )
                else
                    {6310}let pkCli_4963: bitstring = fail-any in
                    {6311}let v_4964: bool = (Sess_3905 = A) in
                    (
                        {6312}if v_4964 then
                        (
                            {6313}let pkSess_4965: bitstring = pub(skA) in
                            {6314}in(c, =GetEndpointRequest);
                            {6315}new SPs_4966: bitstring;
                            {6316}new UP_4967: bitstring;
                            {6317}out(c, (SPs_4966,SignAndEncrypt,UP_4967,pkSess_4965))
                        )
                        else
                            {6318}let v_4968: bool = (Sess_3905 = B) in
                            (
                                {6319}if v_4968 then
                                (
                                    {6320}let pkSess_4969: bitstring = pub(skB) in
                                    {6321}in(c, =GetEndpointRequest);
                                    {6322}new SPs_4970: bitstring;
                                    {6323}new UP_4971: bitstring;
                                    {6324}out(c, (SPs_4970,SignAndEncrypt,UP_4971,pkSess_4969))
                                )
                                else
                                    {6325}let v_4972: bool = (Sess_3905 = C) in
                                    (
                                        {6326}if v_4972 then
                                        (
                                            {6327}let pkSess_4973: bitstring = pub(skC) in
                                            {6328}in(c, =GetEndpointRequest);
                                            {6329}new SPs_4974: bitstring;
                                            {6330}new UP_4975: bitstring;
                                            {6331}out(c, (SPs_4974,SignAndEncrypt,UP_4975,pkSess_4973))
                                        )
                                        else
                                            {6332}let pkSess_4976: bitstring = pub(skI) in
                                            {6333}in(c, =GetEndpointRequest);
                                            {6334}new SPs_4977: bitstring;
                                            {6335}new UP_4978: bitstring;
                                            {6336}out(c, (SPs_4977,SignAndEncrypt,UP_4978,pkSess_4976))
                                    )
                                    else
                                        {6337}let pkSess_4979: bitstring = fail-any in
                                        {6338}in(c, =GetEndpointRequest);
                                        {6339}new SPs_4980: bitstring;
                                        {6340}new UP_4981: bitstring;
                                        {6341}out(c, (SPs_4980,SignAndEncrypt,UP_4981,pkSess_4979))
                            )
                            else
                                {6342}let pkSess_4982: bitstring = fail-any in
                                {6343}in(c, =GetEndpointRequest);
                                {6344}new SPs_4983: bitstring;
                                {6345}new UP_4984: bitstring;
                                {6346}out(c, (SPs_4983,SignAndEncrypt,UP_4984,pkSess_4982))
                    )
                    else
                        {6347}let pkSess_4985: bitstring = fail-any in
                        {6348}in(c, =GetEndpointRequest);
                        {6349}new SPs_4986: bitstring;
                        {6350}new UP_4987: bitstring;
                        {6351}out(c, (SPs_4986,SignAndEncrypt,UP_4987,pkSess_4985))
    )
    else
        {6352}let skDisco_4988: bitstring = fail-any in
        {6353}let pkDisco_4989: bitstring = pub(skDisco_4988) in
        {6354}let v_4990: bool = (Cli_3903 = A) in
        (
            {6355}if v_4990 then
            (
                {6356}let pkCli_4991: bitstring = pub(skA) in
                {6357}let v_4992: bool = (Sess_3905 = A) in
                (
                    {6358}if v_4992 then
                    (
                        {6359}let pkSess_4993: bitstring = pub(skA) in
                        {6360}in(c, =GetEndpointRequest);
                        {6361}new SPs_4994: bitstring;
                        {6362}new UP_4995: bitstring;
                        {6363}out(c, (SPs_4994,SignAndEncrypt,UP_4995,pkSess_4993))
                    )
                    else
                        {6364}let v_4996: bool = (Sess_3905 = B) in
                        (
                            {6365}if v_4996 then
                            (
                                {6366}let pkSess_4997: bitstring = pub(skB) in
                                {6367}in(c, =GetEndpointRequest);
                                {6368}new SPs_4998: bitstring;
                                {6369}new UP_4999: bitstring;
                                {6370}out(c, (SPs_4998,SignAndEncrypt,UP_4999,pkSess_4997))
                            )
                            else
                                {6371}let v_5000: bool = (Sess_3905 = C) in
                                (
                                    {6372}if v_5000 then
                                    (
                                        {6373}let pkSess_5001: bitstring = pub(skC) in
                                        {6374}in(c, =GetEndpointRequest);
                                        {6375}new SPs_5002: bitstring;
                                        {6376}new UP_5003: bitstring;
                                        {6377}out(c, (SPs_5002,SignAndEncrypt,UP_5003,pkSess_5001))
                                    )
                                    else
                                        {6378}let pkSess_5004: bitstring = pub(skI) in
                                        {6379}in(c, =GetEndpointRequest);
                                        {6380}new SPs_5005: bitstring;
                                        {6381}new UP_5006: bitstring;
                                        {6382}out(c, (SPs_5005,SignAndEncrypt,UP_5006,pkSess_5004))
                                )
                                else
                                    {6383}let pkSess_5007: bitstring = fail-any in
                                    {6384}in(c, =GetEndpointRequest);
                                    {6385}new SPs_5008: bitstring;
                                    {6386}new UP_5009: bitstring;
                                    {6387}out(c, (SPs_5008,SignAndEncrypt,UP_5009,pkSess_5007))
                        )
                        else
                            {6388}let pkSess_5010: bitstring = fail-any in
                            {6389}in(c, =GetEndpointRequest);
                            {6390}new SPs_5011: bitstring;
                            {6391}new UP_5012: bitstring;
                            {6392}out(c, (SPs_5011,SignAndEncrypt,UP_5012,pkSess_5010))
                )
                else
                    {6393}let pkSess_5013: bitstring = fail-any in
                    {6394}in(c, =GetEndpointRequest);
                    {6395}new SPs_5014: bitstring;
                    {6396}new UP_5015: bitstring;
                    {6397}out(c, (SPs_5014,SignAndEncrypt,UP_5015,pkSess_5013))
            )
            else
                {6398}let v_5016: bool = (Cli_3903 = B) in
                (
                    {6399}if v_5016 then
                    (
                        {6400}let pkCli_5017: bitstring = pub(skB) in
                        {6401}let v_5018: bool = (Sess_3905 = A) in
                        (
                            {6402}if v_5018 then
                            (
                                {6403}let pkSess_5019: bitstring = pub(skA) in
                                {6404}in(c, =GetEndpointRequest);
                                {6405}new SPs_5020: bitstring;
                                {6406}new UP_5021: bitstring;
                                {6407}out(c, (SPs_5020,SignAndEncrypt,UP_5021,pkSess_5019))
                            )
                            else
                                {6408}let v_5022: bool = (Sess_3905 = B) in
                                (
                                    {6409}if v_5022 then
                                    (
                                        {6410}let pkSess_5023: bitstring = pub(skB) in
                                        {6411}in(c, =GetEndpointRequest);
                                        {6412}new SPs_5024: bitstring;
                                        {6413}new UP_5025: bitstring;
                                        {6414}out(c, (SPs_5024,SignAndEncrypt,UP_5025,pkSess_5023))
                                    )
                                    else
                                        {6415}let v_5026: bool = (Sess_3905 = C) in
                                        (
                                            {6416}if v_5026 then
                                            (
                                                {6417}let pkSess_5027: bitstring = pub(skC) in
                                                {6418}in(c, =GetEndpointRequest);
                                                {6419}new SPs_5028: bitstring;
                                                {6420}new UP_5029: bitstring;
                                                {6421}out(c, (SPs_5028,SignAndEncrypt,UP_5029,pkSess_5027))
                                            )
                                            else
                                                {6422}let pkSess_5030: bitstring = pub(skI) in
                                                {6423}in(c, =GetEndpointRequest);
                                                {6424}new SPs_5031: bitstring;
                                                {6425}new UP_5032: bitstring;
                                                {6426}out(c, (SPs_5031,SignAndEncrypt,UP_5032,pkSess_5030))
                                        )
                                        else
                                            {6427}let pkSess_5033: bitstring = fail-any in
                                            {6428}in(c, =GetEndpointRequest);
                                            {6429}new SPs_5034: bitstring;
                                            {6430}new UP_5035: bitstring;
                                            {6431}out(c, (SPs_5034,SignAndEncrypt,UP_5035,pkSess_5033))
                                )
                                else
                                    {6432}let pkSess_5036: bitstring = fail-any in
                                    {6433}in(c, =GetEndpointRequest);
                                    {6434}new SPs_5037: bitstring;
                                    {6435}new UP_5038: bitstring;
                                    {6436}out(c, (SPs_5037,SignAndEncrypt,UP_5038,pkSess_5036))
                        )
                        else
                            {6437}let pkSess_5039: bitstring = fail-any in
                            {6438}in(c, =GetEndpointRequest);
                            {6439}new SPs_5040: bitstring;
                            {6440}new UP_5041: bitstring;
                            {6441}out(c, (SPs_5040,SignAndEncrypt,UP_5041,pkSess_5039))
                    )
                    else
                        {6442}let v_5042: bool = (Cli_3903 = C) in
                        (
                            {6443}if v_5042 then
                            (
                                {6444}let pkCli_5043: bitstring = pub(skC) in
                                {6445}let v_5044: bool = (Sess_3905 = A) in
                                (
                                    {6446}if v_5044 then
                                    (
                                        {6447}let pkSess_5045: bitstring = pub(skA) in
                                        {6448}in(c, =GetEndpointRequest);
                                        {6449}new SPs_5046: bitstring;
                                        {6450}new UP_5047: bitstring;
                                        {6451}out(c, (SPs_5046,SignAndEncrypt,UP_5047,pkSess_5045))
                                    )
                                    else
                                        {6452}let v_5048: bool = (Sess_3905 = B) in
                                        (
                                            {6453}if v_5048 then
                                            (
                                                {6454}let pkSess_5049: bitstring = pub(skB) in
                                                {6455}in(c, =GetEndpointRequest);
                                                {6456}new SPs_5050: bitstring;
                                                {6457}new UP_5051: bitstring;
                                                {6458}out(c, (SPs_5050,SignAndEncrypt,UP_5051,pkSess_5049))
                                            )
                                            else
                                                {6459}let v_5052: bool = (Sess_3905 = C) in
                                                (
                                                    {6460}if v_5052 then
                                                    (
                                                        {6461}let pkSess_5053: bitstring = pub(skC) in
                                                        {6462}in(c, =GetEndpointRequest);
                                                        {6463}new SPs_5054: bitstring;
                                                        {6464}new UP_5055: bitstring;
                                                        {6465}out(c, (SPs_5054,SignAndEncrypt,UP_5055,pkSess_5053))
                                                    )
                                                    else
                                                        {6466}let pkSess_5056: bitstring = pub(skI) in
                                                        {6467}in(c, =GetEndpointRequest);
                                                        {6468}new SPs_5057: bitstring;
                                                        {6469}new UP_5058: bitstring;
                                                        {6470}out(c, (SPs_5057,SignAndEncrypt,UP_5058,pkSess_5056))
                                                )
                                                else
                                                    {6471}let pkSess_5059: bitstring = fail-any in
                                                    {6472}in(c, =GetEndpointRequest);
                                                    {6473}new SPs_5060: bitstring;
                                                    {6474}new UP_5061: bitstring;
                                                    {6475}out(c, (SPs_5060,SignAndEncrypt,UP_5061,pkSess_5059))
                                        )
                                        else
                                            {6476}let pkSess_5062: bitstring = fail-any in
                                            {6477}in(c, =GetEndpointRequest);
                                            {6478}new SPs_5063: bitstring;
                                            {6479}new UP_5064: bitstring;
                                            {6480}out(c, (SPs_5063,SignAndEncrypt,UP_5064,pkSess_5062))
                                )
                                else
                                    {6481}let pkSess_5065: bitstring = fail-any in
                                    {6482}in(c, =GetEndpointRequest);
                                    {6483}new SPs_5066: bitstring;
                                    {6484}new UP_5067: bitstring;
                                    {6485}out(c, (SPs_5066,SignAndEncrypt,UP_5067,pkSess_5065))
                            )
                            else
                                {6486}let pkCli_5068: bitstring = pub(skI) in
                                {6487}let v_5069: bool = (Sess_3905 = A) in
                                (
                                    {6488}if v_5069 then
                                    (
                                        {6489}let pkSess_5070: bitstring = pub(skA) in
                                        {6490}in(c, =GetEndpointRequest);
                                        {6491}new SPs_5071: bitstring;
                                        {6492}new UP_5072: bitstring;
                                        {6493}out(c, (SPs_5071,SignAndEncrypt,UP_5072,pkSess_5070))
                                    )
                                    else
                                        {6494}let v_5073: bool = (Sess_3905 = B) in
                                        (
                                            {6495}if v_5073 then
                                            (
                                                {6496}let pkSess_5074: bitstring = pub(skB) in
                                                {6497}in(c, =GetEndpointRequest);
                                                {6498}new SPs_5075: bitstring;
                                                {6499}new UP_5076: bitstring;
                                                {6500}out(c, (SPs_5075,SignAndEncrypt,UP_5076,pkSess_5074))
                                            )
                                            else
                                                {6501}let v_5077: bool = (Sess_3905 = C) in
                                                (
                                                    {6502}if v_5077 then
                                                    (
                                                        {6503}let pkSess_5078: bitstring = pub(skC) in
                                                        {6504}in(c, =GetEndpointRequest);
                                                        {6505}new SPs_5079: bitstring;
                                                        {6506}new UP_5080: bitstring;
                                                        {6507}out(c, (SPs_5079,SignAndEncrypt,UP_5080,pkSess_5078))
                                                    )
                                                    else
                                                        {6508}let pkSess_5081: bitstring = pub(skI) in
                                                        {6509}in(c, =GetEndpointRequest);
                                                        {6510}new SPs_5082: bitstring;
                                                        {6511}new UP_5083: bitstring;
                                                        {6512}out(c, (SPs_5082,SignAndEncrypt,UP_5083,pkSess_5081))
                                                )
                                                else
                                                    {6513}let pkSess_5084: bitstring = fail-any in
                                                    {6514}in(c, =GetEndpointRequest);
                                                    {6515}new SPs_5085: bitstring;
                                                    {6516}new UP_5086: bitstring;
                                                    {6517}out(c, (SPs_5085,SignAndEncrypt,UP_5086,pkSess_5084))
                                        )
                                        else
                                            {6518}let pkSess_5087: bitstring = fail-any in
                                            {6519}in(c, =GetEndpointRequest);
                                            {6520}new SPs_5088: bitstring;
                                            {6521}new UP_5089: bitstring;
                                            {6522}out(c, (SPs_5088,SignAndEncrypt,UP_5089,pkSess_5087))
                                )
                                else
                                    {6523}let pkSess_5090: bitstring = fail-any in
                                    {6524}in(c, =GetEndpointRequest);
                                    {6525}new SPs_5091: bitstring;
                                    {6526}new UP_5092: bitstring;
                                    {6527}out(c, (SPs_5091,SignAndEncrypt,UP_5092,pkSess_5090))
                        )
                        else
                            {6528}let pkCli_5093: bitstring = fail-any in
                            {6529}let v_5094: bool = (Sess_3905 = A) in
                            (
                                {6530}if v_5094 then
                                (
                                    {6531}let pkSess_5095: bitstring = pub(skA) in
                                    {6532}in(c, =GetEndpointRequest);
                                    {6533}new SPs_5096: bitstring;
                                    {6534}new UP_5097: bitstring;
                                    {6535}out(c, (SPs_5096,SignAndEncrypt,UP_5097,pkSess_5095))
                                )
                                else
                                    {6536}let v_5098: bool = (Sess_3905 = B) in
                                    (
                                        {6537}if v_5098 then
                                        (
                                            {6538}let pkSess_5099: bitstring = pub(skB) in
                                            {6539}in(c, =GetEndpointRequest);
                                            {6540}new SPs_5100: bitstring;
                                            {6541}new UP_5101: bitstring;
                                            {6542}out(c, (SPs_5100,SignAndEncrypt,UP_5101,pkSess_5099))
                                        )
                                        else
                                            {6543}let v_5102: bool = (Sess_3905 = C) in
                                            (
                                                {6544}if v_5102 then
                                                (
                                                    {6545}let pkSess_5103: bitstring = pub(skC) in
                                                    {6546}in(c, =GetEndpointRequest);
                                                    {6547}new SPs_5104: bitstring;
                                                    {6548}new UP_5105: bitstring;
                                                    {6549}out(c, (SPs_5104,SignAndEncrypt,UP_5105,pkSess_5103))
                                                )
                                                else
                                                    {6550}let pkSess_5106: bitstring = pub(skI) in
                                                    {6551}in(c, =GetEndpointRequest);
                                                    {6552}new SPs_5107: bitstring;
                                                    {6553}new UP_5108: bitstring;
                                                    {6554}out(c, (SPs_5107,SignAndEncrypt,UP_5108,pkSess_5106))
                                            )
                                            else
                                                {6555}let pkSess_5109: bitstring = fail-any in
                                                {6556}in(c, =GetEndpointRequest);
                                                {6557}new SPs_5110: bitstring;
                                                {6558}new UP_5111: bitstring;
                                                {6559}out(c, (SPs_5110,SignAndEncrypt,UP_5111,pkSess_5109))
                                    )
                                    else
                                        {6560}let pkSess_5112: bitstring = fail-any in
                                        {6561}in(c, =GetEndpointRequest);
                                        {6562}new SPs_5113: bitstring;
                                        {6563}new UP_5114: bitstring;
                                        {6564}out(c, (SPs_5113,SignAndEncrypt,UP_5114,pkSess_5112))
                            )
                            else
                                {6565}let pkSess_5115: bitstring = fail-any in
                                {6566}in(c, =GetEndpointRequest);
                                {6567}new SPs_5116: bitstring;
                                {6568}new UP_5117: bitstring;
                                {6569}out(c, (SPs_5116,SignAndEncrypt,UP_5117,pkSess_5115))
                )
                else
                    {6570}let pkCli_5118: bitstring = fail-any in
                    {6571}let v_5119: bool = (Sess_3905 = A) in
                    (
                        {6572}if v_5119 then
                        (
                            {6573}let pkSess_5120: bitstring = pub(skA) in
                            {6574}in(c, =GetEndpointRequest);
                            {6575}new SPs_5121: bitstring;
                            {6576}new UP_5122: bitstring;
                            {6577}out(c, (SPs_5121,SignAndEncrypt,UP_5122,pkSess_5120))
                        )
                        else
                            {6578}let v_5123: bool = (Sess_3905 = B) in
                            (
                                {6579}if v_5123 then
                                (
                                    {6580}let pkSess_5124: bitstring = pub(skB) in
                                    {6581}in(c, =GetEndpointRequest);
                                    {6582}new SPs_5125: bitstring;
                                    {6583}new UP_5126: bitstring;
                                    {6584}out(c, (SPs_5125,SignAndEncrypt,UP_5126,pkSess_5124))
                                )
                                else
                                    {6585}let v_5127: bool = (Sess_3905 = C) in
                                    (
                                        {6586}if v_5127 then
                                        (
                                            {6587}let pkSess_5128: bitstring = pub(skC) in
                                            {6588}in(c, =GetEndpointRequest);
                                            {6589}new SPs_5129: bitstring;
                                            {6590}new UP_5130: bitstring;
                                            {6591}out(c, (SPs_5129,SignAndEncrypt,UP_5130,pkSess_5128))
                                        )
                                        else
                                            {6592}let pkSess_5131: bitstring = pub(skI) in
                                            {6593}in(c, =GetEndpointRequest);
                                            {6594}new SPs_5132: bitstring;
                                            {6595}new UP_5133: bitstring;
                                            {6596}out(c, (SPs_5132,SignAndEncrypt,UP_5133,pkSess_5131))
                                    )
                                    else
                                        {6597}let pkSess_5134: bitstring = fail-any in
                                        {6598}in(c, =GetEndpointRequest);
                                        {6599}new SPs_5135: bitstring;
                                        {6600}new UP_5136: bitstring;
                                        {6601}out(c, (SPs_5135,SignAndEncrypt,UP_5136,pkSess_5134))
                            )
                            else
                                {6602}let pkSess_5137: bitstring = fail-any in
                                {6603}in(c, =GetEndpointRequest);
                                {6604}new SPs_5138: bitstring;
                                {6605}new UP_5139: bitstring;
                                {6606}out(c, (SPs_5138,SignAndEncrypt,UP_5139,pkSess_5137))
                    )
                    else
                        {6607}let pkSess_5140: bitstring = fail-any in
                        {6608}in(c, =GetEndpointRequest);
                        {6609}new SPs_5141: bitstring;
                        {6610}new UP_5142: bitstring;
                        {6611}out(c, (SPs_5141,SignAndEncrypt,UP_5142,pkSess_5140))
        )
        else
            {6612}let pkCli_5143: bitstring = fail-any in
            {6613}let v_5144: bool = (Sess_3905 = A) in
            (
                {6614}if v_5144 then
                (
                    {6615}let pkSess_5145: bitstring = pub(skA) in
                    {6616}in(c, =GetEndpointRequest);
                    {6617}new SPs_5146: bitstring;
                    {6618}new UP_5147: bitstring;
                    {6619}out(c, (SPs_5146,SignAndEncrypt,UP_5147,pkSess_5145))
                )
                else
                    {6620}let v_5148: bool = (Sess_3905 = B) in
                    (
                        {6621}if v_5148 then
                        (
                            {6622}let pkSess_5149: bitstring = pub(skB) in
                            {6623}in(c, =GetEndpointRequest);
                            {6624}new SPs_5150: bitstring;
                            {6625}new UP_5151: bitstring;
                            {6626}out(c, (SPs_5150,SignAndEncrypt,UP_5151,pkSess_5149))
                        )
                        else
                            {6627}let v_5152: bool = (Sess_3905 = C) in
                            (
                                {6628}if v_5152 then
                                (
                                    {6629}let pkSess_5153: bitstring = pub(skC) in
                                    {6630}in(c, =GetEndpointRequest);
                                    {6631}new SPs_5154: bitstring;
                                    {6632}new UP_5155: bitstring;
                                    {6633}out(c, (SPs_5154,SignAndEncrypt,UP_5155,pkSess_5153))
                                )
                                else
                                    {6634}let pkSess_5156: bitstring = pub(skI) in
                                    {6635}in(c, =GetEndpointRequest);
                                    {6636}new SPs_5157: bitstring;
                                    {6637}new UP_5158: bitstring;
                                    {6638}out(c, (SPs_5157,SignAndEncrypt,UP_5158,pkSess_5156))
                            )
                            else
                                {6639}let pkSess_5159: bitstring = fail-any in
                                {6640}in(c, =GetEndpointRequest);
                                {6641}new SPs_5160: bitstring;
                                {6642}new UP_5161: bitstring;
                                {6643}out(c, (SPs_5160,SignAndEncrypt,UP_5161,pkSess_5159))
                    )
                    else
                        {6644}let pkSess_5162: bitstring = fail-any in
                        {6645}in(c, =GetEndpointRequest);
                        {6646}new SPs_5163: bitstring;
                        {6647}new UP_5164: bitstring;
                        {6648}out(c, (SPs_5163,SignAndEncrypt,UP_5164,pkSess_5162))
            )
            else
                {6649}let pkSess_5165: bitstring = fail-any in
                {6650}in(c, =GetEndpointRequest);
                {6651}new SPs_5166: bitstring;
                {6652}new UP_5167: bitstring;
                {6653}out(c, (SPs_5166,SignAndEncrypt,UP_5167,pkSess_5165))
) | (
    {6654}!
    {6655}in(c, (Cli_5168: host,Disco_5169: host,Sess_5170: host));
    {6656}let v_5171: bool = (Sess_5170 = A) in
    (
        {6657}if v_5171 then
        (
            {6658}let skSess: bitstring = skA in
            {6659}let pkSess_5172: bitstring = pub(skSess) in
            {6660}let v_5173: bool = (Cli_5168 = A) in
            (
                {6661}if v_5173 then
                (
                    {6662}let pkCli_5174: bitstring = pub(skA) in
                    {6663}let v_5175: bool = (Disco_5169 = A) in
                    (
                        {6664}if v_5175 then
                        (
                            {6665}let pkDisco_5176: bitstring = pub(skA) in
                            {6666}in(c, (=pkCli_5174,em1: bitstring,sigM1: bitstring));
                            {6667}let m1_5177: bitstring = dec(em1,skSess) in
                            {6668}if (verify(m1_5177,sigM1,pkCli_5174) <> true) then
                                0
                            else
                                {6669}let (SPc_5178: bitstring,PartC: bitstring) = m1_5177 in
                                {6670}event endSrv(Cli_5168,Sess_5170,PartC);
                                {6671}new Ns: bitstring;
                                {6672}let gNs: bitstring = exp(g,Ns) in
                                {6673}let m2: bitstring = gNs in
                                {6674}out(c, (enc(m2,pkCli_5174),sign(m2,skSess)));
                                {6675}event beginSrv(Sess_5170,Cli_5168,gNs)
                        )
                        else
                            {6676}let v_5179: bool = (Disco_5169 = B) in
                            (
                                {6677}if v_5179 then
                                (
                                    {6678}let pkDisco_5180: bitstring = pub(skB) in
                                    {6679}in(c, (=pkCli_5174,em1_5181: bitstring,sigM1_5182: bitstring));
                                    {6680}let m1_5183: bitstring = dec(em1_5181,skSess) in
                                    {6681}if (verify(m1_5183,sigM1_5182,pkCli_5174) <> true) then
                                        0
                                    else
                                        {6682}let (SPc_5184: bitstring,PartC_5185: bitstring) = m1_5183 in
                                        {6683}event endSrv(Cli_5168,Sess_5170,PartC_5185);
                                        {6684}new Ns_5186: bitstring;
                                        {6685}let gNs_5187: bitstring = exp(g,Ns_5186) in
                                        {6686}let m2_5188: bitstring = gNs_5187 in
                                        {6687}out(c, (enc(m2_5188,pkCli_5174),sign(m2_5188,skSess)));
                                        {6688}event beginSrv(Sess_5170,Cli_5168,gNs_5187)
                                )
                                else
                                    {6689}let v_5189: bool = (Disco_5169 = C) in
                                    (
                                        {6690}if v_5189 then
                                        (
                                            {6691}let pkDisco_5190: bitstring = pub(skC) in
                                            {6692}in(c, (=pkCli_5174,em1_5191: bitstring,sigM1_5192: bitstring));
                                            {6693}let m1_5193: bitstring = dec(em1_5191,skSess) in
                                            {6694}if (verify(m1_5193,sigM1_5192,pkCli_5174) <> true) then
                                                0
                                            else
                                                {6695}let (SPc_5194: bitstring,PartC_5195: bitstring) = m1_5193 in
                                                {6696}event endSrv(Cli_5168,Sess_5170,PartC_5195);
                                                {6697}new Ns_5196: bitstring;
                                                {6698}let gNs_5197: bitstring = exp(g,Ns_5196) in
                                                {6699}let m2_5198: bitstring = gNs_5197 in
                                                {6700}out(c, (enc(m2_5198,pkCli_5174),sign(m2_5198,skSess)));
                                                {6701}event beginSrv(Sess_5170,Cli_5168,gNs_5197)
                                        )
                                        else
                                            {6702}let pkDisco_5199: bitstring = pub(skI) in
                                            {6703}in(c, (=pkCli_5174,em1_5200: bitstring,sigM1_5201: bitstring));
                                            {6704}let m1_5202: bitstring = dec(em1_5200,skSess) in
                                            {6705}if (verify(m1_5202,sigM1_5201,pkCli_5174) <> true) then
                                                0
                                            else
                                                {6706}let (SPc_5203: bitstring,PartC_5204: bitstring) = m1_5202 in
                                                {6707}event endSrv(Cli_5168,Sess_5170,PartC_5204);
                                                {6708}new Ns_5205: bitstring;
                                                {6709}let gNs_5206: bitstring = exp(g,Ns_5205) in
                                                {6710}let m2_5207: bitstring = gNs_5206 in
                                                {6711}out(c, (enc(m2_5207,pkCli_5174),sign(m2_5207,skSess)));
                                                {6712}event beginSrv(Sess_5170,Cli_5168,gNs_5206)
                                    )
                                    else
                                        {6713}let pkDisco_5208: bitstring = fail-any in
                                        {6714}in(c, (=pkCli_5174,em1_5209: bitstring,sigM1_5210: bitstring));
                                        {6715}let m1_5211: bitstring = dec(em1_5209,skSess) in
                                        {6716}if (verify(m1_5211,sigM1_5210,pkCli_5174) <> true) then
                                            0
                                        else
                                            {6717}let (SPc_5212: bitstring,PartC_5213: bitstring) = m1_5211 in
                                            {6718}event endSrv(Cli_5168,Sess_5170,PartC_5213);
                                            {6719}new Ns_5214: bitstring;
                                            {6720}let gNs_5215: bitstring = exp(g,Ns_5214) in
                                            {6721}let m2_5216: bitstring = gNs_5215 in
                                            {6722}out(c, (enc(m2_5216,pkCli_5174),sign(m2_5216,skSess)));
                                            {6723}event beginSrv(Sess_5170,Cli_5168,gNs_5215)
                            )
                            else
                                {6724}let pkDisco_5217: bitstring = fail-any in
                                {6725}in(c, (=pkCli_5174,em1_5218: bitstring,sigM1_5219: bitstring));
                                {6726}let m1_5220: bitstring = dec(em1_5218,skSess) in
                                {6727}if (verify(m1_5220,sigM1_5219,pkCli_5174) <> true) then
                                    0
                                else
                                    {6728}let (SPc_5221: bitstring,PartC_5222: bitstring) = m1_5220 in
                                    {6729}event endSrv(Cli_5168,Sess_5170,PartC_5222);
                                    {6730}new Ns_5223: bitstring;
                                    {6731}let gNs_5224: bitstring = exp(g,Ns_5223) in
                                    {6732}let m2_5225: bitstring = gNs_5224 in
                                    {6733}out(c, (enc(m2_5225,pkCli_5174),sign(m2_5225,skSess)));
                                    {6734}event beginSrv(Sess_5170,Cli_5168,gNs_5224)
                    )
                    else
                        {6735}let pkDisco_5226: bitstring = fail-any in
                        {6736}in(c, (=pkCli_5174,em1_5227: bitstring,sigM1_5228: bitstring));
                        {6737}let m1_5229: bitstring = dec(em1_5227,skSess) in
                        {6738}if (verify(m1_5229,sigM1_5228,pkCli_5174) <> true) then
                            0
                        else
                            {6739}let (SPc_5230: bitstring,PartC_5231: bitstring) = m1_5229 in
                            {6740}event endSrv(Cli_5168,Sess_5170,PartC_5231);
                            {6741}new Ns_5232: bitstring;
                            {6742}let gNs_5233: bitstring = exp(g,Ns_5232) in
                            {6743}let m2_5234: bitstring = gNs_5233 in
                            {6744}out(c, (enc(m2_5234,pkCli_5174),sign(m2_5234,skSess)));
                            {6745}event beginSrv(Sess_5170,Cli_5168,gNs_5233)
                )
                else
                    {6746}let v_5235: bool = (Cli_5168 = B) in
                    (
                        {6747}if v_5235 then
                        (
                            {6748}let pkCli_5236: bitstring = pub(skB) in
                            {6749}let v_5237: bool = (Disco_5169 = A) in
                            (
                                {6750}if v_5237 then
                                (
                                    {6751}let pkDisco_5238: bitstring = pub(skA) in
                                    {6752}in(c, (=pkCli_5236,em1_5239: bitstring,sigM1_5240: bitstring));
                                    {6753}let m1_5241: bitstring = dec(em1_5239,skSess) in
                                    {6754}if (verify(m1_5241,sigM1_5240,pkCli_5236) <> true) then
                                        0
                                    else
                                        {6755}let (SPc_5242: bitstring,PartC_5243: bitstring) = m1_5241 in
                                        {6756}event endSrv(Cli_5168,Sess_5170,PartC_5243);
                                        {6757}new Ns_5244: bitstring;
                                        {6758}let gNs_5245: bitstring = exp(g,Ns_5244) in
                                        {6759}let m2_5246: bitstring = gNs_5245 in
                                        {6760}out(c, (enc(m2_5246,pkCli_5236),sign(m2_5246,skSess)));
                                        {6761}event beginSrv(Sess_5170,Cli_5168,gNs_5245)
                                )
                                else
                                    {6762}let v_5247: bool = (Disco_5169 = B) in
                                    (
                                        {6763}if v_5247 then
                                        (
                                            {6764}let pkDisco_5248: bitstring = pub(skB) in
                                            {6765}in(c, (=pkCli_5236,em1_5249: bitstring,sigM1_5250: bitstring));
                                            {6766}let m1_5251: bitstring = dec(em1_5249,skSess) in
                                            {6767}if (verify(m1_5251,sigM1_5250,pkCli_5236) <> true) then
                                                0
                                            else
                                                {6768}let (SPc_5252: bitstring,PartC_5253: bitstring) = m1_5251 in
                                                {6769}event endSrv(Cli_5168,Sess_5170,PartC_5253);
                                                {6770}new Ns_5254: bitstring;
                                                {6771}let gNs_5255: bitstring = exp(g,Ns_5254) in
                                                {6772}let m2_5256: bitstring = gNs_5255 in
                                                {6773}out(c, (enc(m2_5256,pkCli_5236),sign(m2_5256,skSess)));
                                                {6774}event beginSrv(Sess_5170,Cli_5168,gNs_5255)
                                        )
                                        else
                                            {6775}let v_5257: bool = (Disco_5169 = C) in
                                            (
                                                {6776}if v_5257 then
                                                (
                                                    {6777}let pkDisco_5258: bitstring = pub(skC) in
                                                    {6778}in(c, (=pkCli_5236,em1_5259: bitstring,sigM1_5260: bitstring));
                                                    {6779}let m1_5261: bitstring = dec(em1_5259,skSess) in
                                                    {6780}if (verify(m1_5261,sigM1_5260,pkCli_5236) <> true) then
                                                        0
                                                    else
                                                        {6781}let (SPc_5262: bitstring,PartC_5263: bitstring) = m1_5261 in
                                                        {6782}event endSrv(Cli_5168,Sess_5170,PartC_5263);
                                                        {6783}new Ns_5264: bitstring;
                                                        {6784}let gNs_5265: bitstring = exp(g,Ns_5264) in
                                                        {6785}let m2_5266: bitstring = gNs_5265 in
                                                        {6786}out(c, (enc(m2_5266,pkCli_5236),sign(m2_5266,skSess)));
                                                        {6787}event beginSrv(Sess_5170,Cli_5168,gNs_5265)
                                                )
                                                else
                                                    {6788}let pkDisco_5267: bitstring = pub(skI) in
                                                    {6789}in(c, (=pkCli_5236,em1_5268: bitstring,sigM1_5269: bitstring));
                                                    {6790}let m1_5270: bitstring = dec(em1_5268,skSess) in
                                                    {6791}if (verify(m1_5270,sigM1_5269,pkCli_5236) <> true) then
                                                        0
                                                    else
                                                        {6792}let (SPc_5271: bitstring,PartC_5272: bitstring) = m1_5270 in
                                                        {6793}event endSrv(Cli_5168,Sess_5170,PartC_5272);
                                                        {6794}new Ns_5273: bitstring;
                                                        {6795}let gNs_5274: bitstring = exp(g,Ns_5273) in
                                                        {6796}let m2_5275: bitstring = gNs_5274 in
                                                        {6797}out(c, (enc(m2_5275,pkCli_5236),sign(m2_5275,skSess)));
                                                        {6798}event beginSrv(Sess_5170,Cli_5168,gNs_5274)
                                            )
                                            else
                                                {6799}let pkDisco_5276: bitstring = fail-any in
                                                {6800}in(c, (=pkCli_5236,em1_5277: bitstring,sigM1_5278: bitstring));
                                                {6801}let m1_5279: bitstring = dec(em1_5277,skSess) in
                                                {6802}if (verify(m1_5279,sigM1_5278,pkCli_5236) <> true) then
                                                    0
                                                else
                                                    {6803}let (SPc_5280: bitstring,PartC_5281: bitstring) = m1_5279 in
                                                    {6804}event endSrv(Cli_5168,Sess_5170,PartC_5281);
                                                    {6805}new Ns_5282: bitstring;
                                                    {6806}let gNs_5283: bitstring = exp(g,Ns_5282) in
                                                    {6807}let m2_5284: bitstring = gNs_5283 in
                                                    {6808}out(c, (enc(m2_5284,pkCli_5236),sign(m2_5284,skSess)));
                                                    {6809}event beginSrv(Sess_5170,Cli_5168,gNs_5283)
                                    )
                                    else
                                        {6810}let pkDisco_5285: bitstring = fail-any in
                                        {6811}in(c, (=pkCli_5236,em1_5286: bitstring,sigM1_5287: bitstring));
                                        {6812}let m1_5288: bitstring = dec(em1_5286,skSess) in
                                        {6813}if (verify(m1_5288,sigM1_5287,pkCli_5236) <> true) then
                                            0
                                        else
                                            {6814}let (SPc_5289: bitstring,PartC_5290: bitstring) = m1_5288 in
                                            {6815}event endSrv(Cli_5168,Sess_5170,PartC_5290);
                                            {6816}new Ns_5291: bitstring;
                                            {6817}let gNs_5292: bitstring = exp(g,Ns_5291) in
                                            {6818}let m2_5293: bitstring = gNs_5292 in
                                            {6819}out(c, (enc(m2_5293,pkCli_5236),sign(m2_5293,skSess)));
                                            {6820}event beginSrv(Sess_5170,Cli_5168,gNs_5292)
                            )
                            else
                                {6821}let pkDisco_5294: bitstring = fail-any in
                                {6822}in(c, (=pkCli_5236,em1_5295: bitstring,sigM1_5296: bitstring));
                                {6823}let m1_5297: bitstring = dec(em1_5295,skSess) in
                                {6824}if (verify(m1_5297,sigM1_5296,pkCli_5236) <> true) then
                                    0
                                else
                                    {6825}let (SPc_5298: bitstring,PartC_5299: bitstring) = m1_5297 in
                                    {6826}event endSrv(Cli_5168,Sess_5170,PartC_5299);
                                    {6827}new Ns_5300: bitstring;
                                    {6828}let gNs_5301: bitstring = exp(g,Ns_5300) in
                                    {6829}let m2_5302: bitstring = gNs_5301 in
                                    {6830}out(c, (enc(m2_5302,pkCli_5236),sign(m2_5302,skSess)));
                                    {6831}event beginSrv(Sess_5170,Cli_5168,gNs_5301)
                        )
                        else
                            {6832}let v_5303: bool = (Cli_5168 = C) in
                            (
                                {6833}if v_5303 then
                                (
                                    {6834}let pkCli_5304: bitstring = pub(skC) in
                                    {6835}let v_5305: bool = (Disco_5169 = A) in
                                    (
                                        {6836}if v_5305 then
                                        (
                                            {6837}let pkDisco_5306: bitstring = pub(skA) in
                                            {6838}in(c, (=pkCli_5304,em1_5307: bitstring,sigM1_5308: bitstring));
                                            {6839}let m1_5309: bitstring = dec(em1_5307,skSess) in
                                            {6840}if (verify(m1_5309,sigM1_5308,pkCli_5304) <> true) then
                                                0
                                            else
                                                {6841}let (SPc_5310: bitstring,PartC_5311: bitstring) = m1_5309 in
                                                {6842}event endSrv(Cli_5168,Sess_5170,PartC_5311);
                                                {6843}new Ns_5312: bitstring;
                                                {6844}let gNs_5313: bitstring = exp(g,Ns_5312) in
                                                {6845}let m2_5314: bitstring = gNs_5313 in
                                                {6846}out(c, (enc(m2_5314,pkCli_5304),sign(m2_5314,skSess)));
                                                {6847}event beginSrv(Sess_5170,Cli_5168,gNs_5313)
                                        )
                                        else
                                            {6848}let v_5315: bool = (Disco_5169 = B) in
                                            (
                                                {6849}if v_5315 then
                                                (
                                                    {6850}let pkDisco_5316: bitstring = pub(skB) in
                                                    {6851}in(c, (=pkCli_5304,em1_5317: bitstring,sigM1_5318: bitstring));
                                                    {6852}let m1_5319: bitstring = dec(em1_5317,skSess) in
                                                    {6853}if (verify(m1_5319,sigM1_5318,pkCli_5304) <> true) then
                                                        0
                                                    else
                                                        {6854}let (SPc_5320: bitstring,PartC_5321: bitstring) = m1_5319 in
                                                        {6855}event endSrv(Cli_5168,Sess_5170,PartC_5321);
                                                        {6856}new Ns_5322: bitstring;
                                                        {6857}let gNs_5323: bitstring = exp(g,Ns_5322) in
                                                        {6858}let m2_5324: bitstring = gNs_5323 in
                                                        {6859}out(c, (enc(m2_5324,pkCli_5304),sign(m2_5324,skSess)));
                                                        {6860}event beginSrv(Sess_5170,Cli_5168,gNs_5323)
                                                )
                                                else
                                                    {6861}let v_5325: bool = (Disco_5169 = C) in
                                                    (
                                                        {6862}if v_5325 then
                                                        (
                                                            {6863}let pkDisco_5326: bitstring = pub(skC) in
                                                            {6864}in(c, (=pkCli_5304,em1_5327: bitstring,sigM1_5328: bitstring));
                                                            {6865}let m1_5329: bitstring = dec(em1_5327,skSess) in
                                                            {6866}if (verify(m1_5329,sigM1_5328,pkCli_5304) <> true) then
                                                                0
                                                            else
                                                                {6867}let (SPc_5330: bitstring,PartC_5331: bitstring) = m1_5329 in
                                                                {6868}event endSrv(Cli_5168,Sess_5170,PartC_5331);
                                                                {6869}new Ns_5332: bitstring;
                                                                {6870}let gNs_5333: bitstring = exp(g,Ns_5332) in
                                                                {6871}let m2_5334: bitstring = gNs_5333 in
                                                                {6872}out(c, (enc(m2_5334,pkCli_5304),sign(m2_5334,skSess)));
                                                                {6873}event beginSrv(Sess_5170,Cli_5168,gNs_5333)
                                                        )
                                                        else
                                                            {6874}let pkDisco_5335: bitstring = pub(skI) in
                                                            {6875}in(c, (=pkCli_5304,em1_5336: bitstring,sigM1_5337: bitstring));
                                                            {6876}let m1_5338: bitstring = dec(em1_5336,skSess) in
                                                            {6877}if (verify(m1_5338,sigM1_5337,pkCli_5304) <> true) then
                                                                0
                                                            else
                                                                {6878}let (SPc_5339: bitstring,PartC_5340: bitstring) = m1_5338 in
                                                                {6879}event endSrv(Cli_5168,Sess_5170,PartC_5340);
                                                                {6880}new Ns_5341: bitstring;
                                                                {6881}let gNs_5342: bitstring = exp(g,Ns_5341) in
                                                                {6882}let m2_5343: bitstring = gNs_5342 in
                                                                {6883}out(c, (enc(m2_5343,pkCli_5304),sign(m2_5343,skSess)));
                                                                {6884}event beginSrv(Sess_5170,Cli_5168,gNs_5342)
                                                    )
                                                    else
                                                        {6885}let pkDisco_5344: bitstring = fail-any in
                                                        {6886}in(c, (=pkCli_5304,em1_5345: bitstring,sigM1_5346: bitstring));
                                                        {6887}let m1_5347: bitstring = dec(em1_5345,skSess) in
                                                        {6888}if (verify(m1_5347,sigM1_5346,pkCli_5304) <> true) then
                                                            0
                                                        else
                                                            {6889}let (SPc_5348: bitstring,PartC_5349: bitstring) = m1_5347 in
                                                            {6890}event endSrv(Cli_5168,Sess_5170,PartC_5349);
                                                            {6891}new Ns_5350: bitstring;
                                                            {6892}let gNs_5351: bitstring = exp(g,Ns_5350) in
                                                            {6893}let m2_5352: bitstring = gNs_5351 in
                                                            {6894}out(c, (enc(m2_5352,pkCli_5304),sign(m2_5352,skSess)));
                                                            {6895}event beginSrv(Sess_5170,Cli_5168,gNs_5351)
                                            )
                                            else
                                                {6896}let pkDisco_5353: bitstring = fail-any in
                                                {6897}in(c, (=pkCli_5304,em1_5354: bitstring,sigM1_5355: bitstring));
                                                {6898}let m1_5356: bitstring = dec(em1_5354,skSess) in
                                                {6899}if (verify(m1_5356,sigM1_5355,pkCli_5304) <> true) then
                                                    0
                                                else
                                                    {6900}let (SPc_5357: bitstring,PartC_5358: bitstring) = m1_5356 in
                                                    {6901}event endSrv(Cli_5168,Sess_5170,PartC_5358);
                                                    {6902}new Ns_5359: bitstring;
                                                    {6903}let gNs_5360: bitstring = exp(g,Ns_5359) in
                                                    {6904}let m2_5361: bitstring = gNs_5360 in
                                                    {6905}out(c, (enc(m2_5361,pkCli_5304),sign(m2_5361,skSess)));
                                                    {6906}event beginSrv(Sess_5170,Cli_5168,gNs_5360)
                                    )
                                    else
                                        {6907}let pkDisco_5362: bitstring = fail-any in
                                        {6908}in(c, (=pkCli_5304,em1_5363: bitstring,sigM1_5364: bitstring));
                                        {6909}let m1_5365: bitstring = dec(em1_5363,skSess) in
                                        {6910}if (verify(m1_5365,sigM1_5364,pkCli_5304) <> true) then
                                            0
                                        else
                                            {6911}let (SPc_5366: bitstring,PartC_5367: bitstring) = m1_5365 in
                                            {6912}event endSrv(Cli_5168,Sess_5170,PartC_5367);
                                            {6913}new Ns_5368: bitstring;
                                            {6914}let gNs_5369: bitstring = exp(g,Ns_5368) in
                                            {6915}let m2_5370: bitstring = gNs_5369 in
                                            {6916}out(c, (enc(m2_5370,pkCli_5304),sign(m2_5370,skSess)));
                                            {6917}event beginSrv(Sess_5170,Cli_5168,gNs_5369)
                                )
                                else
                                    {6918}let pkCli_5371: bitstring = pub(skI) in
                                    {6919}let v_5372: bool = (Disco_5169 = A) in
                                    (
                                        {6920}if v_5372 then
                                        (
                                            {6921}let pkDisco_5373: bitstring = pub(skA) in
                                            {6922}in(c, (=pkCli_5371,em1_5374: bitstring,sigM1_5375: bitstring));
                                            {6923}let m1_5376: bitstring = dec(em1_5374,skSess) in
                                            {6924}if (verify(m1_5376,sigM1_5375,pkCli_5371) <> true) then
                                                0
                                            else
                                                {6925}let (SPc_5377: bitstring,PartC_5378: bitstring) = m1_5376 in
                                                {6926}event endSrv(Cli_5168,Sess_5170,PartC_5378);
                                                {6927}new Ns_5379: bitstring;
                                                {6928}let gNs_5380: bitstring = exp(g,Ns_5379) in
                                                {6929}let m2_5381: bitstring = gNs_5380 in
                                                {6930}out(c, (enc(m2_5381,pkCli_5371),sign(m2_5381,skSess)));
                                                {6931}event beginSrv(Sess_5170,Cli_5168,gNs_5380)
                                        )
                                        else
                                            {6932}let v_5382: bool = (Disco_5169 = B) in
                                            (
                                                {6933}if v_5382 then
                                                (
                                                    {6934}let pkDisco_5383: bitstring = pub(skB) in
                                                    {6935}in(c, (=pkCli_5371,em1_5384: bitstring,sigM1_5385: bitstring));
                                                    {6936}let m1_5386: bitstring = dec(em1_5384,skSess) in
                                                    {6937}if (verify(m1_5386,sigM1_5385,pkCli_5371) <> true) then
                                                        0
                                                    else
                                                        {6938}let (SPc_5387: bitstring,PartC_5388: bitstring) = m1_5386 in
                                                        {6939}event endSrv(Cli_5168,Sess_5170,PartC_5388);
                                                        {6940}new Ns_5389: bitstring;
                                                        {6941}let gNs_5390: bitstring = exp(g,Ns_5389) in
                                                        {6942}let m2_5391: bitstring = gNs_5390 in
                                                        {6943}out(c, (enc(m2_5391,pkCli_5371),sign(m2_5391,skSess)));
                                                        {6944}event beginSrv(Sess_5170,Cli_5168,gNs_5390)
                                                )
                                                else
                                                    {6945}let v_5392: bool = (Disco_5169 = C) in
                                                    (
                                                        {6946}if v_5392 then
                                                        (
                                                            {6947}let pkDisco_5393: bitstring = pub(skC) in
                                                            {6948}in(c, (=pkCli_5371,em1_5394: bitstring,sigM1_5395: bitstring));
                                                            {6949}let m1_5396: bitstring = dec(em1_5394,skSess) in
                                                            {6950}if (verify(m1_5396,sigM1_5395,pkCli_5371) <> true) then
                                                                0
                                                            else
                                                                {6951}let (SPc_5397: bitstring,PartC_5398: bitstring) = m1_5396 in
                                                                {6952}event endSrv(Cli_5168,Sess_5170,PartC_5398);
                                                                {6953}new Ns_5399: bitstring;
                                                                {6954}let gNs_5400: bitstring = exp(g,Ns_5399) in
                                                                {6955}let m2_5401: bitstring = gNs_5400 in
                                                                {6956}out(c, (enc(m2_5401,pkCli_5371),sign(m2_5401,skSess)));
                                                                {6957}event beginSrv(Sess_5170,Cli_5168,gNs_5400)
                                                        )
                                                        else
                                                            {6958}let pkDisco_5402: bitstring = pub(skI) in
                                                            {6959}in(c, (=pkCli_5371,em1_5403: bitstring,sigM1_5404: bitstring));
                                                            {6960}let m1_5405: bitstring = dec(em1_5403,skSess) in
                                                            {6961}if (verify(m1_5405,sigM1_5404,pkCli_5371) <> true) then
                                                                0
                                                            else
                                                                {6962}let (SPc_5406: bitstring,PartC_5407: bitstring) = m1_5405 in
                                                                {6963}event endSrv(Cli_5168,Sess_5170,PartC_5407);
                                                                {6964}new Ns_5408: bitstring;
                                                                {6965}let gNs_5409: bitstring = exp(g,Ns_5408) in
                                                                {6966}let m2_5410: bitstring = gNs_5409 in
                                                                {6967}out(c, (enc(m2_5410,pkCli_5371),sign(m2_5410,skSess)));
                                                                {6968}event beginSrv(Sess_5170,Cli_5168,gNs_5409)
                                                    )
                                                    else
                                                        {6969}let pkDisco_5411: bitstring = fail-any in
                                                        {6970}in(c, (=pkCli_5371,em1_5412: bitstring,sigM1_5413: bitstring));
                                                        {6971}let m1_5414: bitstring = dec(em1_5412,skSess) in
                                                        {6972}if (verify(m1_5414,sigM1_5413,pkCli_5371) <> true) then
                                                            0
                                                        else
                                                            {6973}let (SPc_5415: bitstring,PartC_5416: bitstring) = m1_5414 in
                                                            {6974}event endSrv(Cli_5168,Sess_5170,PartC_5416);
                                                            {6975}new Ns_5417: bitstring;
                                                            {6976}let gNs_5418: bitstring = exp(g,Ns_5417) in
                                                            {6977}let m2_5419: bitstring = gNs_5418 in
                                                            {6978}out(c, (enc(m2_5419,pkCli_5371),sign(m2_5419,skSess)));
                                                            {6979}event beginSrv(Sess_5170,Cli_5168,gNs_5418)
                                            )
                                            else
                                                {6980}let pkDisco_5420: bitstring = fail-any in
                                                {6981}in(c, (=pkCli_5371,em1_5421: bitstring,sigM1_5422: bitstring));
                                                {6982}let m1_5423: bitstring = dec(em1_5421,skSess) in
                                                {6983}if (verify(m1_5423,sigM1_5422,pkCli_5371) <> true) then
                                                    0
                                                else
                                                    {6984}let (SPc_5424: bitstring,PartC_5425: bitstring) = m1_5423 in
                                                    {6985}event endSrv(Cli_5168,Sess_5170,PartC_5425);
                                                    {6986}new Ns_5426: bitstring;
                                                    {6987}let gNs_5427: bitstring = exp(g,Ns_5426) in
                                                    {6988}let m2_5428: bitstring = gNs_5427 in
                                                    {6989}out(c, (enc(m2_5428,pkCli_5371),sign(m2_5428,skSess)));
                                                    {6990}event beginSrv(Sess_5170,Cli_5168,gNs_5427)
                                    )
                                    else
                                        {6991}let pkDisco_5429: bitstring = fail-any in
                                        {6992}in(c, (=pkCli_5371,em1_5430: bitstring,sigM1_5431: bitstring));
                                        {6993}let m1_5432: bitstring = dec(em1_5430,skSess) in
                                        {6994}if (verify(m1_5432,sigM1_5431,pkCli_5371) <> true) then
                                            0
                                        else
                                            {6995}let (SPc_5433: bitstring,PartC_5434: bitstring) = m1_5432 in
                                            {6996}event endSrv(Cli_5168,Sess_5170,PartC_5434);
                                            {6997}new Ns_5435: bitstring;
                                            {6998}let gNs_5436: bitstring = exp(g,Ns_5435) in
                                            {6999}let m2_5437: bitstring = gNs_5436 in
                                            {7000}out(c, (enc(m2_5437,pkCli_5371),sign(m2_5437,skSess)));
                                            {7001}event beginSrv(Sess_5170,Cli_5168,gNs_5436)
                            )
                            else
                                {7002}let pkCli_5438: bitstring = fail-any in
                                {7003}let v_5439: bool = (Disco_5169 = A) in
                                (
                                    {7004}if v_5439 then
                                    (
                                        {7005}let pkDisco_5440: bitstring = pub(skA) in
                                        {7006}in(c, (=pkCli_5438,em1_5441: bitstring,sigM1_5442: bitstring));
                                        {7007}let m1_5443: bitstring = dec(em1_5441,skSess) in
                                        {7008}if (verify(m1_5443,sigM1_5442,pkCli_5438) <> true) then
                                            0
                                        else
                                            {7009}let (SPc_5444: bitstring,PartC_5445: bitstring) = m1_5443 in
                                            {7010}event endSrv(Cli_5168,Sess_5170,PartC_5445);
                                            {7011}new Ns_5446: bitstring;
                                            {7012}let gNs_5447: bitstring = exp(g,Ns_5446) in
                                            {7013}let m2_5448: bitstring = gNs_5447 in
                                            {7014}out(c, (enc(m2_5448,pkCli_5438),sign(m2_5448,skSess)));
                                            {7015}event beginSrv(Sess_5170,Cli_5168,gNs_5447)
                                    )
                                    else
                                        {7016}let v_5449: bool = (Disco_5169 = B) in
                                        (
                                            {7017}if v_5449 then
                                            (
                                                {7018}let pkDisco_5450: bitstring = pub(skB) in
                                                {7019}in(c, (=pkCli_5438,em1_5451: bitstring,sigM1_5452: bitstring));
                                                {7020}let m1_5453: bitstring = dec(em1_5451,skSess) in
                                                {7021}if (verify(m1_5453,sigM1_5452,pkCli_5438) <> true) then
                                                    0
                                                else
                                                    {7022}let (SPc_5454: bitstring,PartC_5455: bitstring) = m1_5453 in
                                                    {7023}event endSrv(Cli_5168,Sess_5170,PartC_5455);
                                                    {7024}new Ns_5456: bitstring;
                                                    {7025}let gNs_5457: bitstring = exp(g,Ns_5456) in
                                                    {7026}let m2_5458: bitstring = gNs_5457 in
                                                    {7027}out(c, (enc(m2_5458,pkCli_5438),sign(m2_5458,skSess)));
                                                    {7028}event beginSrv(Sess_5170,Cli_5168,gNs_5457)
                                            )
                                            else
                                                {7029}let v_5459: bool = (Disco_5169 = C) in
                                                (
                                                    {7030}if v_5459 then
                                                    (
                                                        {7031}let pkDisco_5460: bitstring = pub(skC) in
                                                        {7032}in(c, (=pkCli_5438,em1_5461: bitstring,sigM1_5462: bitstring));
                                                        {7033}let m1_5463: bitstring = dec(em1_5461,skSess) in
                                                        {7034}if (verify(m1_5463,sigM1_5462,pkCli_5438) <> true) then
                                                            0
                                                        else
                                                            {7035}let (SPc_5464: bitstring,PartC_5465: bitstring) = m1_5463 in
                                                            {7036}event endSrv(Cli_5168,Sess_5170,PartC_5465);
                                                            {7037}new Ns_5466: bitstring;
                                                            {7038}let gNs_5467: bitstring = exp(g,Ns_5466) in
                                                            {7039}let m2_5468: bitstring = gNs_5467 in
                                                            {7040}out(c, (enc(m2_5468,pkCli_5438),sign(m2_5468,skSess)));
                                                            {7041}event beginSrv(Sess_5170,Cli_5168,gNs_5467)
                                                    )
                                                    else
                                                        {7042}let pkDisco_5469: bitstring = pub(skI) in
                                                        {7043}in(c, (=pkCli_5438,em1_5470: bitstring,sigM1_5471: bitstring));
                                                        {7044}let m1_5472: bitstring = dec(em1_5470,skSess) in
                                                        {7045}if (verify(m1_5472,sigM1_5471,pkCli_5438) <> true) then
                                                            0
                                                        else
                                                            {7046}let (SPc_5473: bitstring,PartC_5474: bitstring) = m1_5472 in
                                                            {7047}event endSrv(Cli_5168,Sess_5170,PartC_5474);
                                                            {7048}new Ns_5475: bitstring;
                                                            {7049}let gNs_5476: bitstring = exp(g,Ns_5475) in
                                                            {7050}let m2_5477: bitstring = gNs_5476 in
                                                            {7051}out(c, (enc(m2_5477,pkCli_5438),sign(m2_5477,skSess)));
                                                            {7052}event beginSrv(Sess_5170,Cli_5168,gNs_5476)
                                                )
                                                else
                                                    {7053}let pkDisco_5478: bitstring = fail-any in
                                                    {7054}in(c, (=pkCli_5438,em1_5479: bitstring,sigM1_5480: bitstring));
                                                    {7055}let m1_5481: bitstring = dec(em1_5479,skSess) in
                                                    {7056}if (verify(m1_5481,sigM1_5480,pkCli_5438) <> true) then
                                                        0
                                                    else
                                                        {7057}let (SPc_5482: bitstring,PartC_5483: bitstring) = m1_5481 in
                                                        {7058}event endSrv(Cli_5168,Sess_5170,PartC_5483);
                                                        {7059}new Ns_5484: bitstring;
                                                        {7060}let gNs_5485: bitstring = exp(g,Ns_5484) in
                                                        {7061}let m2_5486: bitstring = gNs_5485 in
                                                        {7062}out(c, (enc(m2_5486,pkCli_5438),sign(m2_5486,skSess)));
                                                        {7063}event beginSrv(Sess_5170,Cli_5168,gNs_5485)
                                        )
                                        else
                                            {7064}let pkDisco_5487: bitstring = fail-any in
                                            {7065}in(c, (=pkCli_5438,em1_5488: bitstring,sigM1_5489: bitstring));
                                            {7066}let m1_5490: bitstring = dec(em1_5488,skSess) in
                                            {7067}if (verify(m1_5490,sigM1_5489,pkCli_5438) <> true) then
                                                0
                                            else
                                                {7068}let (SPc_5491: bitstring,PartC_5492: bitstring) = m1_5490 in
                                                {7069}event endSrv(Cli_5168,Sess_5170,PartC_5492);
                                                {7070}new Ns_5493: bitstring;
                                                {7071}let gNs_5494: bitstring = exp(g,Ns_5493) in
                                                {7072}let m2_5495: bitstring = gNs_5494 in
                                                {7073}out(c, (enc(m2_5495,pkCli_5438),sign(m2_5495,skSess)));
                                                {7074}event beginSrv(Sess_5170,Cli_5168,gNs_5494)
                                )
                                else
                                    {7075}let pkDisco_5496: bitstring = fail-any in
                                    {7076}in(c, (=pkCli_5438,em1_5497: bitstring,sigM1_5498: bitstring));
                                    {7077}let m1_5499: bitstring = dec(em1_5497,skSess) in
                                    {7078}if (verify(m1_5499,sigM1_5498,pkCli_5438) <> true) then
                                        0
                                    else
                                        {7079}let (SPc_5500: bitstring,PartC_5501: bitstring) = m1_5499 in
                                        {7080}event endSrv(Cli_5168,Sess_5170,PartC_5501);
                                        {7081}new Ns_5502: bitstring;
                                        {7082}let gNs_5503: bitstring = exp(g,Ns_5502) in
                                        {7083}let m2_5504: bitstring = gNs_5503 in
                                        {7084}out(c, (enc(m2_5504,pkCli_5438),sign(m2_5504,skSess)));
                                        {7085}event beginSrv(Sess_5170,Cli_5168,gNs_5503)
                    )
                    else
                        {7086}let pkCli_5505: bitstring = fail-any in
                        {7087}let v_5506: bool = (Disco_5169 = A) in
                        (
                            {7088}if v_5506 then
                            (
                                {7089}let pkDisco_5507: bitstring = pub(skA) in
                                {7090}in(c, (=pkCli_5505,em1_5508: bitstring,sigM1_5509: bitstring));
                                {7091}let m1_5510: bitstring = dec(em1_5508,skSess) in
                                {7092}if (verify(m1_5510,sigM1_5509,pkCli_5505) <> true) then
                                    0
                                else
                                    {7093}let (SPc_5511: bitstring,PartC_5512: bitstring) = m1_5510 in
                                    {7094}event endSrv(Cli_5168,Sess_5170,PartC_5512);
                                    {7095}new Ns_5513: bitstring;
                                    {7096}let gNs_5514: bitstring = exp(g,Ns_5513) in
                                    {7097}let m2_5515: bitstring = gNs_5514 in
                                    {7098}out(c, (enc(m2_5515,pkCli_5505),sign(m2_5515,skSess)));
                                    {7099}event beginSrv(Sess_5170,Cli_5168,gNs_5514)
                            )
                            else
                                {7100}let v_5516: bool = (Disco_5169 = B) in
                                (
                                    {7101}if v_5516 then
                                    (
                                        {7102}let pkDisco_5517: bitstring = pub(skB) in
                                        {7103}in(c, (=pkCli_5505,em1_5518: bitstring,sigM1_5519: bitstring));
                                        {7104}let m1_5520: bitstring = dec(em1_5518,skSess) in
                                        {7105}if (verify(m1_5520,sigM1_5519,pkCli_5505) <> true) then
                                            0
                                        else
                                            {7106}let (SPc_5521: bitstring,PartC_5522: bitstring) = m1_5520 in
                                            {7107}event endSrv(Cli_5168,Sess_5170,PartC_5522);
                                            {7108}new Ns_5523: bitstring;
                                            {7109}let gNs_5524: bitstring = exp(g,Ns_5523) in
                                            {7110}let m2_5525: bitstring = gNs_5524 in
                                            {7111}out(c, (enc(m2_5525,pkCli_5505),sign(m2_5525,skSess)));
                                            {7112}event beginSrv(Sess_5170,Cli_5168,gNs_5524)
                                    )
                                    else
                                        {7113}let v_5526: bool = (Disco_5169 = C) in
                                        (
                                            {7114}if v_5526 then
                                            (
                                                {7115}let pkDisco_5527: bitstring = pub(skC) in
                                                {7116}in(c, (=pkCli_5505,em1_5528: bitstring,sigM1_5529: bitstring));
                                                {7117}let m1_5530: bitstring = dec(em1_5528,skSess) in
                                                {7118}if (verify(m1_5530,sigM1_5529,pkCli_5505) <> true) then
                                                    0
                                                else
                                                    {7119}let (SPc_5531: bitstring,PartC_5532: bitstring) = m1_5530 in
                                                    {7120}event endSrv(Cli_5168,Sess_5170,PartC_5532);
                                                    {7121}new Ns_5533: bitstring;
                                                    {7122}let gNs_5534: bitstring = exp(g,Ns_5533) in
                                                    {7123}let m2_5535: bitstring = gNs_5534 in
                                                    {7124}out(c, (enc(m2_5535,pkCli_5505),sign(m2_5535,skSess)));
                                                    {7125}event beginSrv(Sess_5170,Cli_5168,gNs_5534)
                                            )
                                            else
                                                {7126}let pkDisco_5536: bitstring = pub(skI) in
                                                {7127}in(c, (=pkCli_5505,em1_5537: bitstring,sigM1_5538: bitstring));
                                                {7128}let m1_5539: bitstring = dec(em1_5537,skSess) in
                                                {7129}if (verify(m1_5539,sigM1_5538,pkCli_5505) <> true) then
                                                    0
                                                else
                                                    {7130}let (SPc_5540: bitstring,PartC_5541: bitstring) = m1_5539 in
                                                    {7131}event endSrv(Cli_5168,Sess_5170,PartC_5541);
                                                    {7132}new Ns_5542: bitstring;
                                                    {7133}let gNs_5543: bitstring = exp(g,Ns_5542) in
                                                    {7134}let m2_5544: bitstring = gNs_5543 in
                                                    {7135}out(c, (enc(m2_5544,pkCli_5505),sign(m2_5544,skSess)));
                                                    {7136}event beginSrv(Sess_5170,Cli_5168,gNs_5543)
                                        )
                                        else
                                            {7137}let pkDisco_5545: bitstring = fail-any in
                                            {7138}in(c, (=pkCli_5505,em1_5546: bitstring,sigM1_5547: bitstring));
                                            {7139}let m1_5548: bitstring = dec(em1_5546,skSess) in
                                            {7140}if (verify(m1_5548,sigM1_5547,pkCli_5505) <> true) then
                                                0
                                            else
                                                {7141}let (SPc_5549: bitstring,PartC_5550: bitstring) = m1_5548 in
                                                {7142}event endSrv(Cli_5168,Sess_5170,PartC_5550);
                                                {7143}new Ns_5551: bitstring;
                                                {7144}let gNs_5552: bitstring = exp(g,Ns_5551) in
                                                {7145}let m2_5553: bitstring = gNs_5552 in
                                                {7146}out(c, (enc(m2_5553,pkCli_5505),sign(m2_5553,skSess)));
                                                {7147}event beginSrv(Sess_5170,Cli_5168,gNs_5552)
                                )
                                else
                                    {7148}let pkDisco_5554: bitstring = fail-any in
                                    {7149}in(c, (=pkCli_5505,em1_5555: bitstring,sigM1_5556: bitstring));
                                    {7150}let m1_5557: bitstring = dec(em1_5555,skSess) in
                                    {7151}if (verify(m1_5557,sigM1_5556,pkCli_5505) <> true) then
                                        0
                                    else
                                        {7152}let (SPc_5558: bitstring,PartC_5559: bitstring) = m1_5557 in
                                        {7153}event endSrv(Cli_5168,Sess_5170,PartC_5559);
                                        {7154}new Ns_5560: bitstring;
                                        {7155}let gNs_5561: bitstring = exp(g,Ns_5560) in
                                        {7156}let m2_5562: bitstring = gNs_5561 in
                                        {7157}out(c, (enc(m2_5562,pkCli_5505),sign(m2_5562,skSess)));
                                        {7158}event beginSrv(Sess_5170,Cli_5168,gNs_5561)
                        )
                        else
                            {7159}let pkDisco_5563: bitstring = fail-any in
                            {7160}in(c, (=pkCli_5505,em1_5564: bitstring,sigM1_5565: bitstring));
                            {7161}let m1_5566: bitstring = dec(em1_5564,skSess) in
                            {7162}if (verify(m1_5566,sigM1_5565,pkCli_5505) <> true) then
                                0
                            else
                                {7163}let (SPc_5567: bitstring,PartC_5568: bitstring) = m1_5566 in
                                {7164}event endSrv(Cli_5168,Sess_5170,PartC_5568);
                                {7165}new Ns_5569: bitstring;
                                {7166}let gNs_5570: bitstring = exp(g,Ns_5569) in
                                {7167}let m2_5571: bitstring = gNs_5570 in
                                {7168}out(c, (enc(m2_5571,pkCli_5505),sign(m2_5571,skSess)));
                                {7169}event beginSrv(Sess_5170,Cli_5168,gNs_5570)
            )
            else
                {7170}let pkCli_5572: bitstring = fail-any in
                {7171}let v_5573: bool = (Disco_5169 = A) in
                (
                    {7172}if v_5573 then
                    (
                        {7173}let pkDisco_5574: bitstring = pub(skA) in
                        {7174}in(c, (=pkCli_5572,em1_5575: bitstring,sigM1_5576: bitstring));
                        {7175}let m1_5577: bitstring = dec(em1_5575,skSess) in
                        {7176}if (verify(m1_5577,sigM1_5576,pkCli_5572) <> true) then
                            0
                        else
                            {7177}let (SPc_5578: bitstring,PartC_5579: bitstring) = m1_5577 in
                            {7178}event endSrv(Cli_5168,Sess_5170,PartC_5579);
                            {7179}new Ns_5580: bitstring;
                            {7180}let gNs_5581: bitstring = exp(g,Ns_5580) in
                            {7181}let m2_5582: bitstring = gNs_5581 in
                            {7182}out(c, (enc(m2_5582,pkCli_5572),sign(m2_5582,skSess)));
                            {7183}event beginSrv(Sess_5170,Cli_5168,gNs_5581)
                    )
                    else
                        {7184}let v_5583: bool = (Disco_5169 = B) in
                        (
                            {7185}if v_5583 then
                            (
                                {7186}let pkDisco_5584: bitstring = pub(skB) in
                                {7187}in(c, (=pkCli_5572,em1_5585: bitstring,sigM1_5586: bitstring));
                                {7188}let m1_5587: bitstring = dec(em1_5585,skSess) in
                                {7189}if (verify(m1_5587,sigM1_5586,pkCli_5572) <> true) then
                                    0
                                else
                                    {7190}let (SPc_5588: bitstring,PartC_5589: bitstring) = m1_5587 in
                                    {7191}event endSrv(Cli_5168,Sess_5170,PartC_5589);
                                    {7192}new Ns_5590: bitstring;
                                    {7193}let gNs_5591: bitstring = exp(g,Ns_5590) in
                                    {7194}let m2_5592: bitstring = gNs_5591 in
                                    {7195}out(c, (enc(m2_5592,pkCli_5572),sign(m2_5592,skSess)));
                                    {7196}event beginSrv(Sess_5170,Cli_5168,gNs_5591)
                            )
                            else
                                {7197}let v_5593: bool = (Disco_5169 = C) in
                                (
                                    {7198}if v_5593 then
                                    (
                                        {7199}let pkDisco_5594: bitstring = pub(skC) in
                                        {7200}in(c, (=pkCli_5572,em1_5595: bitstring,sigM1_5596: bitstring));
                                        {7201}let m1_5597: bitstring = dec(em1_5595,skSess) in
                                        {7202}if (verify(m1_5597,sigM1_5596,pkCli_5572) <> true) then
                                            0
                                        else
                                            {7203}let (SPc_5598: bitstring,PartC_5599: bitstring) = m1_5597 in
                                            {7204}event endSrv(Cli_5168,Sess_5170,PartC_5599);
                                            {7205}new Ns_5600: bitstring;
                                            {7206}let gNs_5601: bitstring = exp(g,Ns_5600) in
                                            {7207}let m2_5602: bitstring = gNs_5601 in
                                            {7208}out(c, (enc(m2_5602,pkCli_5572),sign(m2_5602,skSess)));
                                            {7209}event beginSrv(Sess_5170,Cli_5168,gNs_5601)
                                    )
                                    else
                                        {7210}let pkDisco_5603: bitstring = pub(skI) in
                                        {7211}in(c, (=pkCli_5572,em1_5604: bitstring,sigM1_5605: bitstring));
                                        {7212}let m1_5606: bitstring = dec(em1_5604,skSess) in
                                        {7213}if (verify(m1_5606,sigM1_5605,pkCli_5572) <> true) then
                                            0
                                        else
                                            {7214}let (SPc_5607: bitstring,PartC_5608: bitstring) = m1_5606 in
                                            {7215}event endSrv(Cli_5168,Sess_5170,PartC_5608);
                                            {7216}new Ns_5609: bitstring;
                                            {7217}let gNs_5610: bitstring = exp(g,Ns_5609) in
                                            {7218}let m2_5611: bitstring = gNs_5610 in
                                            {7219}out(c, (enc(m2_5611,pkCli_5572),sign(m2_5611,skSess)));
                                            {7220}event beginSrv(Sess_5170,Cli_5168,gNs_5610)
                                )
                                else
                                    {7221}let pkDisco_5612: bitstring = fail-any in
                                    {7222}in(c, (=pkCli_5572,em1_5613: bitstring,sigM1_5614: bitstring));
                                    {7223}let m1_5615: bitstring = dec(em1_5613,skSess) in
                                    {7224}if (verify(m1_5615,sigM1_5614,pkCli_5572) <> true) then
                                        0
                                    else
                                        {7225}let (SPc_5616: bitstring,PartC_5617: bitstring) = m1_5615 in
                                        {7226}event endSrv(Cli_5168,Sess_5170,PartC_5617);
                                        {7227}new Ns_5618: bitstring;
                                        {7228}let gNs_5619: bitstring = exp(g,Ns_5618) in
                                        {7229}let m2_5620: bitstring = gNs_5619 in
                                        {7230}out(c, (enc(m2_5620,pkCli_5572),sign(m2_5620,skSess)));
                                        {7231}event beginSrv(Sess_5170,Cli_5168,gNs_5619)
                        )
                        else
                            {7232}let pkDisco_5621: bitstring = fail-any in
                            {7233}in(c, (=pkCli_5572,em1_5622: bitstring,sigM1_5623: bitstring));
                            {7234}let m1_5624: bitstring = dec(em1_5622,skSess) in
                            {7235}if (verify(m1_5624,sigM1_5623,pkCli_5572) <> true) then
                                0
                            else
                                {7236}let (SPc_5625: bitstring,PartC_5626: bitstring) = m1_5624 in
                                {7237}event endSrv(Cli_5168,Sess_5170,PartC_5626);
                                {7238}new Ns_5627: bitstring;
                                {7239}let gNs_5628: bitstring = exp(g,Ns_5627) in
                                {7240}let m2_5629: bitstring = gNs_5628 in
                                {7241}out(c, (enc(m2_5629,pkCli_5572),sign(m2_5629,skSess)));
                                {7242}event beginSrv(Sess_5170,Cli_5168,gNs_5628)
                )
                else
                    {7243}let pkDisco_5630: bitstring = fail-any in
                    {7244}in(c, (=pkCli_5572,em1_5631: bitstring,sigM1_5632: bitstring));
                    {7245}let m1_5633: bitstring = dec(em1_5631,skSess) in
                    {7246}if (verify(m1_5633,sigM1_5632,pkCli_5572) <> true) then
                        0
                    else
                        {7247}let (SPc_5634: bitstring,PartC_5635: bitstring) = m1_5633 in
                        {7248}event endSrv(Cli_5168,Sess_5170,PartC_5635);
                        {7249}new Ns_5636: bitstring;
                        {7250}let gNs_5637: bitstring = exp(g,Ns_5636) in
                        {7251}let m2_5638: bitstring = gNs_5637 in
                        {7252}out(c, (enc(m2_5638,pkCli_5572),sign(m2_5638,skSess)));
                        {7253}event beginSrv(Sess_5170,Cli_5168,gNs_5637)
        )
        else
            {7254}let v_5639: bool = (Sess_5170 = B) in
            (
                {7255}if v_5639 then
                (
                    {7256}let skSess_5640: bitstring = skB in
                    {7257}let pkSess_5641: bitstring = pub(skSess_5640) in
                    {7258}let v_5642: bool = (Cli_5168 = A) in
                    (
                        {7259}if v_5642 then
                        (
                            {7260}let pkCli_5643: bitstring = pub(skA) in
                            {7261}let v_5644: bool = (Disco_5169 = A) in
                            (
                                {7262}if v_5644 then
                                (
                                    {7263}let pkDisco_5645: bitstring = pub(skA) in
                                    {7264}in(c, (=pkCli_5643,em1_5646: bitstring,sigM1_5647: bitstring));
                                    {7265}let m1_5648: bitstring = dec(em1_5646,skSess_5640) in
                                    {7266}if (verify(m1_5648,sigM1_5647,pkCli_5643) <> true) then
                                        0
                                    else
                                        {7267}let (SPc_5649: bitstring,PartC_5650: bitstring) = m1_5648 in
                                        {7268}event endSrv(Cli_5168,Sess_5170,PartC_5650);
                                        {7269}new Ns_5651: bitstring;
                                        {7270}let gNs_5652: bitstring = exp(g,Ns_5651) in
                                        {7271}let m2_5653: bitstring = gNs_5652 in
                                        {7272}out(c, (enc(m2_5653,pkCli_5643),sign(m2_5653,skSess_5640)));
                                        {7273}event beginSrv(Sess_5170,Cli_5168,gNs_5652)
                                )
                                else
                                    {7274}let v_5654: bool = (Disco_5169 = B) in
                                    (
                                        {7275}if v_5654 then
                                        (
                                            {7276}let pkDisco_5655: bitstring = pub(skB) in
                                            {7277}in(c, (=pkCli_5643,em1_5656: bitstring,sigM1_5657: bitstring));
                                            {7278}let m1_5658: bitstring = dec(em1_5656,skSess_5640) in
                                            {7279}if (verify(m1_5658,sigM1_5657,pkCli_5643) <> true) then
                                                0
                                            else
                                                {7280}let (SPc_5659: bitstring,PartC_5660: bitstring) = m1_5658 in
                                                {7281}event endSrv(Cli_5168,Sess_5170,PartC_5660);
                                                {7282}new Ns_5661: bitstring;
                                                {7283}let gNs_5662: bitstring = exp(g,Ns_5661) in
                                                {7284}let m2_5663: bitstring = gNs_5662 in
                                                {7285}out(c, (enc(m2_5663,pkCli_5643),sign(m2_5663,skSess_5640)));
                                                {7286}event beginSrv(Sess_5170,Cli_5168,gNs_5662)
                                        )
                                        else
                                            {7287}let v_5664: bool = (Disco_5169 = C) in
                                            (
                                                {7288}if v_5664 then
                                                (
                                                    {7289}let pkDisco_5665: bitstring = pub(skC) in
                                                    {7290}in(c, (=pkCli_5643,em1_5666: bitstring,sigM1_5667: bitstring));
                                                    {7291}let m1_5668: bitstring = dec(em1_5666,skSess_5640) in
                                                    {7292}if (verify(m1_5668,sigM1_5667,pkCli_5643) <> true) then
                                                        0
                                                    else
                                                        {7293}let (SPc_5669: bitstring,PartC_5670: bitstring) = m1_5668 in
                                                        {7294}event endSrv(Cli_5168,Sess_5170,PartC_5670);
                                                        {7295}new Ns_5671: bitstring;
                                                        {7296}let gNs_5672: bitstring = exp(g,Ns_5671) in
                                                        {7297}let m2_5673: bitstring = gNs_5672 in
                                                        {7298}out(c, (enc(m2_5673,pkCli_5643),sign(m2_5673,skSess_5640)));
                                                        {7299}event beginSrv(Sess_5170,Cli_5168,gNs_5672)
                                                )
                                                else
                                                    {7300}let pkDisco_5674: bitstring = pub(skI) in
                                                    {7301}in(c, (=pkCli_5643,em1_5675: bitstring,sigM1_5676: bitstring));
                                                    {7302}let m1_5677: bitstring = dec(em1_5675,skSess_5640) in
                                                    {7303}if (verify(m1_5677,sigM1_5676,pkCli_5643) <> true) then
                                                        0
                                                    else
                                                        {7304}let (SPc_5678: bitstring,PartC_5679: bitstring) = m1_5677 in
                                                        {7305}event endSrv(Cli_5168,Sess_5170,PartC_5679);
                                                        {7306}new Ns_5680: bitstring;
                                                        {7307}let gNs_5681: bitstring = exp(g,Ns_5680) in
                                                        {7308}let m2_5682: bitstring = gNs_5681 in
                                                        {7309}out(c, (enc(m2_5682,pkCli_5643),sign(m2_5682,skSess_5640)));
                                                        {7310}event beginSrv(Sess_5170,Cli_5168,gNs_5681)
                                            )
                                            else
                                                {7311}let pkDisco_5683: bitstring = fail-any in
                                                {7312}in(c, (=pkCli_5643,em1_5684: bitstring,sigM1_5685: bitstring));
                                                {7313}let m1_5686: bitstring = dec(em1_5684,skSess_5640) in
                                                {7314}if (verify(m1_5686,sigM1_5685,pkCli_5643) <> true) then
                                                    0
                                                else
                                                    {7315}let (SPc_5687: bitstring,PartC_5688: bitstring) = m1_5686 in
                                                    {7316}event endSrv(Cli_5168,Sess_5170,PartC_5688);
                                                    {7317}new Ns_5689: bitstring;
                                                    {7318}let gNs_5690: bitstring = exp(g,Ns_5689) in
                                                    {7319}let m2_5691: bitstring = gNs_5690 in
                                                    {7320}out(c, (enc(m2_5691,pkCli_5643),sign(m2_5691,skSess_5640)));
                                                    {7321}event beginSrv(Sess_5170,Cli_5168,gNs_5690)
                                    )
                                    else
                                        {7322}let pkDisco_5692: bitstring = fail-any in
                                        {7323}in(c, (=pkCli_5643,em1_5693: bitstring,sigM1_5694: bitstring));
                                        {7324}let m1_5695: bitstring = dec(em1_5693,skSess_5640) in
                                        {7325}if (verify(m1_5695,sigM1_5694,pkCli_5643) <> true) then
                                            0
                                        else
                                            {7326}let (SPc_5696: bitstring,PartC_5697: bitstring) = m1_5695 in
                                            {7327}event endSrv(Cli_5168,Sess_5170,PartC_5697);
                                            {7328}new Ns_5698: bitstring;
                                            {7329}let gNs_5699: bitstring = exp(g,Ns_5698) in
                                            {7330}let m2_5700: bitstring = gNs_5699 in
                                            {7331}out(c, (enc(m2_5700,pkCli_5643),sign(m2_5700,skSess_5640)));
                                            {7332}event beginSrv(Sess_5170,Cli_5168,gNs_5699)
                            )
                            else
                                {7333}let pkDisco_5701: bitstring = fail-any in
                                {7334}in(c, (=pkCli_5643,em1_5702: bitstring,sigM1_5703: bitstring));
                                {7335}let m1_5704: bitstring = dec(em1_5702,skSess_5640) in
                                {7336}if (verify(m1_5704,sigM1_5703,pkCli_5643) <> true) then
                                    0
                                else
                                    {7337}let (SPc_5705: bitstring,PartC_5706: bitstring) = m1_5704 in
                                    {7338}event endSrv(Cli_5168,Sess_5170,PartC_5706);
                                    {7339}new Ns_5707: bitstring;
                                    {7340}let gNs_5708: bitstring = exp(g,Ns_5707) in
                                    {7341}let m2_5709: bitstring = gNs_5708 in
                                    {7342}out(c, (enc(m2_5709,pkCli_5643),sign(m2_5709,skSess_5640)));
                                    {7343}event beginSrv(Sess_5170,Cli_5168,gNs_5708)
                        )
                        else
                            {7344}let v_5710: bool = (Cli_5168 = B) in
                            (
                                {7345}if v_5710 then
                                (
                                    {7346}let pkCli_5711: bitstring = pub(skB) in
                                    {7347}let v_5712: bool = (Disco_5169 = A) in
                                    (
                                        {7348}if v_5712 then
                                        (
                                            {7349}let pkDisco_5713: bitstring = pub(skA) in
                                            {7350}in(c, (=pkCli_5711,em1_5714: bitstring,sigM1_5715: bitstring));
                                            {7351}let m1_5716: bitstring = dec(em1_5714,skSess_5640) in
                                            {7352}if (verify(m1_5716,sigM1_5715,pkCli_5711) <> true) then
                                                0
                                            else
                                                {7353}let (SPc_5717: bitstring,PartC_5718: bitstring) = m1_5716 in
                                                {7354}event endSrv(Cli_5168,Sess_5170,PartC_5718);
                                                {7355}new Ns_5719: bitstring;
                                                {7356}let gNs_5720: bitstring = exp(g,Ns_5719) in
                                                {7357}let m2_5721: bitstring = gNs_5720 in
                                                {7358}out(c, (enc(m2_5721,pkCli_5711),sign(m2_5721,skSess_5640)));
                                                {7359}event beginSrv(Sess_5170,Cli_5168,gNs_5720)
                                        )
                                        else
                                            {7360}let v_5722: bool = (Disco_5169 = B) in
                                            (
                                                {7361}if v_5722 then
                                                (
                                                    {7362}let pkDisco_5723: bitstring = pub(skB) in
                                                    {7363}in(c, (=pkCli_5711,em1_5724: bitstring,sigM1_5725: bitstring));
                                                    {7364}let m1_5726: bitstring = dec(em1_5724,skSess_5640) in
                                                    {7365}if (verify(m1_5726,sigM1_5725,pkCli_5711) <> true) then
                                                        0
                                                    else
                                                        {7366}let (SPc_5727: bitstring,PartC_5728: bitstring) = m1_5726 in
                                                        {7367}event endSrv(Cli_5168,Sess_5170,PartC_5728);
                                                        {7368}new Ns_5729: bitstring;
                                                        {7369}let gNs_5730: bitstring = exp(g,Ns_5729) in
                                                        {7370}let m2_5731: bitstring = gNs_5730 in
                                                        {7371}out(c, (enc(m2_5731,pkCli_5711),sign(m2_5731,skSess_5640)));
                                                        {7372}event beginSrv(Sess_5170,Cli_5168,gNs_5730)
                                                )
                                                else
                                                    {7373}let v_5732: bool = (Disco_5169 = C) in
                                                    (
                                                        {7374}if v_5732 then
                                                        (
                                                            {7375}let pkDisco_5733: bitstring = pub(skC) in
                                                            {7376}in(c, (=pkCli_5711,em1_5734: bitstring,sigM1_5735: bitstring));
                                                            {7377}let m1_5736: bitstring = dec(em1_5734,skSess_5640) in
                                                            {7378}if (verify(m1_5736,sigM1_5735,pkCli_5711) <> true) then
                                                                0
                                                            else
                                                                {7379}let (SPc_5737: bitstring,PartC_5738: bitstring) = m1_5736 in
                                                                {7380}event endSrv(Cli_5168,Sess_5170,PartC_5738);
                                                                {7381}new Ns_5739: bitstring;
                                                                {7382}let gNs_5740: bitstring = exp(g,Ns_5739) in
                                                                {7383}let m2_5741: bitstring = gNs_5740 in
                                                                {7384}out(c, (enc(m2_5741,pkCli_5711),sign(m2_5741,skSess_5640)));
                                                                {7385}event beginSrv(Sess_5170,Cli_5168,gNs_5740)
                                                        )
                                                        else
                                                            {7386}let pkDisco_5742: bitstring = pub(skI) in
                                                            {7387}in(c, (=pkCli_5711,em1_5743: bitstring,sigM1_5744: bitstring));
                                                            {7388}let m1_5745: bitstring = dec(em1_5743,skSess_5640) in
                                                            {7389}if (verify(m1_5745,sigM1_5744,pkCli_5711) <> true) then
                                                                0
                                                            else
                                                                {7390}let (SPc_5746: bitstring,PartC_5747: bitstring) = m1_5745 in
                                                                {7391}event endSrv(Cli_5168,Sess_5170,PartC_5747);
                                                                {7392}new Ns_5748: bitstring;
                                                                {7393}let gNs_5749: bitstring = exp(g,Ns_5748) in
                                                                {7394}let m2_5750: bitstring = gNs_5749 in
                                                                {7395}out(c, (enc(m2_5750,pkCli_5711),sign(m2_5750,skSess_5640)));
                                                                {7396}event beginSrv(Sess_5170,Cli_5168,gNs_5749)
                                                    )
                                                    else
                                                        {7397}let pkDisco_5751: bitstring = fail-any in
                                                        {7398}in(c, (=pkCli_5711,em1_5752: bitstring,sigM1_5753: bitstring));
                                                        {7399}let m1_5754: bitstring = dec(em1_5752,skSess_5640) in
                                                        {7400}if (verify(m1_5754,sigM1_5753,pkCli_5711) <> true) then
                                                            0
                                                        else
                                                            {7401}let (SPc_5755: bitstring,PartC_5756: bitstring) = m1_5754 in
                                                            {7402}event endSrv(Cli_5168,Sess_5170,PartC_5756);
                                                            {7403}new Ns_5757: bitstring;
                                                            {7404}let gNs_5758: bitstring = exp(g,Ns_5757) in
                                                            {7405}let m2_5759: bitstring = gNs_5758 in
                                                            {7406}out(c, (enc(m2_5759,pkCli_5711),sign(m2_5759,skSess_5640)));
                                                            {7407}event beginSrv(Sess_5170,Cli_5168,gNs_5758)
                                            )
                                            else
                                                {7408}let pkDisco_5760: bitstring = fail-any in
                                                {7409}in(c, (=pkCli_5711,em1_5761: bitstring,sigM1_5762: bitstring));
                                                {7410}let m1_5763: bitstring = dec(em1_5761,skSess_5640) in
                                                {7411}if (verify(m1_5763,sigM1_5762,pkCli_5711) <> true) then
                                                    0
                                                else
                                                    {7412}let (SPc_5764: bitstring,PartC_5765: bitstring) = m1_5763 in
                                                    {7413}event endSrv(Cli_5168,Sess_5170,PartC_5765);
                                                    {7414}new Ns_5766: bitstring;
                                                    {7415}let gNs_5767: bitstring = exp(g,Ns_5766) in
                                                    {7416}let m2_5768: bitstring = gNs_5767 in
                                                    {7417}out(c, (enc(m2_5768,pkCli_5711),sign(m2_5768,skSess_5640)));
                                                    {7418}event beginSrv(Sess_5170,Cli_5168,gNs_5767)
                                    )
                                    else
                                        {7419}let pkDisco_5769: bitstring = fail-any in
                                        {7420}in(c, (=pkCli_5711,em1_5770: bitstring,sigM1_5771: bitstring));
                                        {7421}let m1_5772: bitstring = dec(em1_5770,skSess_5640) in
                                        {7422}if (verify(m1_5772,sigM1_5771,pkCli_5711) <> true) then
                                            0
                                        else
                                            {7423}let (SPc_5773: bitstring,PartC_5774: bitstring) = m1_5772 in
                                            {7424}event endSrv(Cli_5168,Sess_5170,PartC_5774);
                                            {7425}new Ns_5775: bitstring;
                                            {7426}let gNs_5776: bitstring = exp(g,Ns_5775) in
                                            {7427}let m2_5777: bitstring = gNs_5776 in
                                            {7428}out(c, (enc(m2_5777,pkCli_5711),sign(m2_5777,skSess_5640)));
                                            {7429}event beginSrv(Sess_5170,Cli_5168,gNs_5776)
                                )
                                else
                                    {7430}let v_5778: bool = (Cli_5168 = C) in
                                    (
                                        {7431}if v_5778 then
                                        (
                                            {7432}let pkCli_5779: bitstring = pub(skC) in
                                            {7433}let v_5780: bool = (Disco_5169 = A) in
                                            (
                                                {7434}if v_5780 then
                                                (
                                                    {7435}let pkDisco_5781: bitstring = pub(skA) in
                                                    {7436}in(c, (=pkCli_5779,em1_5782: bitstring,sigM1_5783: bitstring));
                                                    {7437}let m1_5784: bitstring = dec(em1_5782,skSess_5640) in
                                                    {7438}if (verify(m1_5784,sigM1_5783,pkCli_5779) <> true) then
                                                        0
                                                    else
                                                        {7439}let (SPc_5785: bitstring,PartC_5786: bitstring) = m1_5784 in
                                                        {7440}event endSrv(Cli_5168,Sess_5170,PartC_5786);
                                                        {7441}new Ns_5787: bitstring;
                                                        {7442}let gNs_5788: bitstring = exp(g,Ns_5787) in
                                                        {7443}let m2_5789: bitstring = gNs_5788 in
                                                        {7444}out(c, (enc(m2_5789,pkCli_5779),sign(m2_5789,skSess_5640)));
                                                        {7445}event beginSrv(Sess_5170,Cli_5168,gNs_5788)
                                                )
                                                else
                                                    {7446}let v_5790: bool = (Disco_5169 = B) in
                                                    (
                                                        {7447}if v_5790 then
                                                        (
                                                            {7448}let pkDisco_5791: bitstring = pub(skB) in
                                                            {7449}in(c, (=pkCli_5779,em1_5792: bitstring,sigM1_5793: bitstring));
                                                            {7450}let m1_5794: bitstring = dec(em1_5792,skSess_5640) in
                                                            {7451}if (verify(m1_5794,sigM1_5793,pkCli_5779) <> true) then
                                                                0
                                                            else
                                                                {7452}let (SPc_5795: bitstring,PartC_5796: bitstring) = m1_5794 in
                                                                {7453}event endSrv(Cli_5168,Sess_5170,PartC_5796);
                                                                {7454}new Ns_5797: bitstring;
                                                                {7455}let gNs_5798: bitstring = exp(g,Ns_5797) in
                                                                {7456}let m2_5799: bitstring = gNs_5798 in
                                                                {7457}out(c, (enc(m2_5799,pkCli_5779),sign(m2_5799,skSess_5640)));
                                                                {7458}event beginSrv(Sess_5170,Cli_5168,gNs_5798)
                                                        )
                                                        else
                                                            {7459}let v_5800: bool = (Disco_5169 = C) in
                                                            (
                                                                {7460}if v_5800 then
                                                                (
                                                                    {7461}let pkDisco_5801: bitstring = pub(skC) in
                                                                    {7462}in(c, (=pkCli_5779,em1_5802: bitstring,sigM1_5803: bitstring));
                                                                    {7463}let m1_5804: bitstring = dec(em1_5802,skSess_5640) in
                                                                    {7464}if (verify(m1_5804,sigM1_5803,pkCli_5779) <> true) then
                                                                        0
                                                                    else
                                                                        {7465}let (SPc_5805: bitstring,PartC_5806: bitstring) = m1_5804 in
                                                                        {7466}event endSrv(Cli_5168,Sess_5170,PartC_5806);
                                                                        {7467}new Ns_5807: bitstring;
                                                                        {7468}let gNs_5808: bitstring = exp(g,Ns_5807) in
                                                                        {7469}let m2_5809: bitstring = gNs_5808 in
                                                                        {7470}out(c, (enc(m2_5809,pkCli_5779),sign(m2_5809,skSess_5640)));
                                                                        {7471}event beginSrv(Sess_5170,Cli_5168,gNs_5808)
                                                                )
                                                                else
                                                                    {7472}let pkDisco_5810: bitstring = pub(skI) in
                                                                    {7473}in(c, (=pkCli_5779,em1_5811: bitstring,sigM1_5812: bitstring));
                                                                    {7474}let m1_5813: bitstring = dec(em1_5811,skSess_5640) in
                                                                    {7475}if (verify(m1_5813,sigM1_5812,pkCli_5779) <> true) then
                                                                        0
                                                                    else
                                                                        {7476}let (SPc_5814: bitstring,PartC_5815: bitstring) = m1_5813 in
                                                                        {7477}event endSrv(Cli_5168,Sess_5170,PartC_5815);
                                                                        {7478}new Ns_5816: bitstring;
                                                                        {7479}let gNs_5817: bitstring = exp(g,Ns_5816) in
                                                                        {7480}let m2_5818: bitstring = gNs_5817 in
                                                                        {7481}out(c, (enc(m2_5818,pkCli_5779),sign(m2_5818,skSess_5640)));
                                                                        {7482}event beginSrv(Sess_5170,Cli_5168,gNs_5817)
                                                            )
                                                            else
                                                                {7483}let pkDisco_5819: bitstring = fail-any in
                                                                {7484}in(c, (=pkCli_5779,em1_5820: bitstring,sigM1_5821: bitstring));
                                                                {7485}let m1_5822: bitstring = dec(em1_5820,skSess_5640) in
                                                                {7486}if (verify(m1_5822,sigM1_5821,pkCli_5779) <> true) then
                                                                    0
                                                                else
                                                                    {7487}let (SPc_5823: bitstring,PartC_5824: bitstring) = m1_5822 in
                                                                    {7488}event endSrv(Cli_5168,Sess_5170,PartC_5824);
                                                                    {7489}new Ns_5825: bitstring;
                                                                    {7490}let gNs_5826: bitstring = exp(g,Ns_5825) in
                                                                    {7491}let m2_5827: bitstring = gNs_5826 in
                                                                    {7492}out(c, (enc(m2_5827,pkCli_5779),sign(m2_5827,skSess_5640)));
                                                                    {7493}event beginSrv(Sess_5170,Cli_5168,gNs_5826)
                                                    )
                                                    else
                                                        {7494}let pkDisco_5828: bitstring = fail-any in
                                                        {7495}in(c, (=pkCli_5779,em1_5829: bitstring,sigM1_5830: bitstring));
                                                        {7496}let m1_5831: bitstring = dec(em1_5829,skSess_5640) in
                                                        {7497}if (verify(m1_5831,sigM1_5830,pkCli_5779) <> true) then
                                                            0
                                                        else
                                                            {7498}let (SPc_5832: bitstring,PartC_5833: bitstring) = m1_5831 in
                                                            {7499}event endSrv(Cli_5168,Sess_5170,PartC_5833);
                                                            {7500}new Ns_5834: bitstring;
                                                            {7501}let gNs_5835: bitstring = exp(g,Ns_5834) in
                                                            {7502}let m2_5836: bitstring = gNs_5835 in
                                                            {7503}out(c, (enc(m2_5836,pkCli_5779),sign(m2_5836,skSess_5640)));
                                                            {7504}event beginSrv(Sess_5170,Cli_5168,gNs_5835)
                                            )
                                            else
                                                {7505}let pkDisco_5837: bitstring = fail-any in
                                                {7506}in(c, (=pkCli_5779,em1_5838: bitstring,sigM1_5839: bitstring));
                                                {7507}let m1_5840: bitstring = dec(em1_5838,skSess_5640) in
                                                {7508}if (verify(m1_5840,sigM1_5839,pkCli_5779) <> true) then
                                                    0
                                                else
                                                    {7509}let (SPc_5841: bitstring,PartC_5842: bitstring) = m1_5840 in
                                                    {7510}event endSrv(Cli_5168,Sess_5170,PartC_5842);
                                                    {7511}new Ns_5843: bitstring;
                                                    {7512}let gNs_5844: bitstring = exp(g,Ns_5843) in
                                                    {7513}let m2_5845: bitstring = gNs_5844 in
                                                    {7514}out(c, (enc(m2_5845,pkCli_5779),sign(m2_5845,skSess_5640)));
                                                    {7515}event beginSrv(Sess_5170,Cli_5168,gNs_5844)
                                        )
                                        else
                                            {7516}let pkCli_5846: bitstring = pub(skI) in
                                            {7517}let v_5847: bool = (Disco_5169 = A) in
                                            (
                                                {7518}if v_5847 then
                                                (
                                                    {7519}let pkDisco_5848: bitstring = pub(skA) in
                                                    {7520}in(c, (=pkCli_5846,em1_5849: bitstring,sigM1_5850: bitstring));
                                                    {7521}let m1_5851: bitstring = dec(em1_5849,skSess_5640) in
                                                    {7522}if (verify(m1_5851,sigM1_5850,pkCli_5846) <> true) then
                                                        0
                                                    else
                                                        {7523}let (SPc_5852: bitstring,PartC_5853: bitstring) = m1_5851 in
                                                        {7524}event endSrv(Cli_5168,Sess_5170,PartC_5853);
                                                        {7525}new Ns_5854: bitstring;
                                                        {7526}let gNs_5855: bitstring = exp(g,Ns_5854) in
                                                        {7527}let m2_5856: bitstring = gNs_5855 in
                                                        {7528}out(c, (enc(m2_5856,pkCli_5846),sign(m2_5856,skSess_5640)));
                                                        {7529}event beginSrv(Sess_5170,Cli_5168,gNs_5855)
                                                )
                                                else
                                                    {7530}let v_5857: bool = (Disco_5169 = B) in
                                                    (
                                                        {7531}if v_5857 then
                                                        (
                                                            {7532}let pkDisco_5858: bitstring = pub(skB) in
                                                            {7533}in(c, (=pkCli_5846,em1_5859: bitstring,sigM1_5860: bitstring));
                                                            {7534}let m1_5861: bitstring = dec(em1_5859,skSess_5640) in
                                                            {7535}if (verify(m1_5861,sigM1_5860,pkCli_5846) <> true) then
                                                                0
                                                            else
                                                                {7536}let (SPc_5862: bitstring,PartC_5863: bitstring) = m1_5861 in
                                                                {7537}event endSrv(Cli_5168,Sess_5170,PartC_5863);
                                                                {7538}new Ns_5864: bitstring;
                                                                {7539}let gNs_5865: bitstring = exp(g,Ns_5864) in
                                                                {7540}let m2_5866: bitstring = gNs_5865 in
                                                                {7541}out(c, (enc(m2_5866,pkCli_5846),sign(m2_5866,skSess_5640)));
                                                                {7542}event beginSrv(Sess_5170,Cli_5168,gNs_5865)
                                                        )
                                                        else
                                                            {7543}let v_5867: bool = (Disco_5169 = C) in
                                                            (
                                                                {7544}if v_5867 then
                                                                (
                                                                    {7545}let pkDisco_5868: bitstring = pub(skC) in
                                                                    {7546}in(c, (=pkCli_5846,em1_5869: bitstring,sigM1_5870: bitstring));
                                                                    {7547}let m1_5871: bitstring = dec(em1_5869,skSess_5640) in
                                                                    {7548}if (verify(m1_5871,sigM1_5870,pkCli_5846) <> true) then
                                                                        0
                                                                    else
                                                                        {7549}let (SPc_5872: bitstring,PartC_5873: bitstring) = m1_5871 in
                                                                        {7550}event endSrv(Cli_5168,Sess_5170,PartC_5873);
                                                                        {7551}new Ns_5874: bitstring;
                                                                        {7552}let gNs_5875: bitstring = exp(g,Ns_5874) in
                                                                        {7553}let m2_5876: bitstring = gNs_5875 in
                                                                        {7554}out(c, (enc(m2_5876,pkCli_5846),sign(m2_5876,skSess_5640)));
                                                                        {7555}event beginSrv(Sess_5170,Cli_5168,gNs_5875)
                                                                )
                                                                else
                                                                    {7556}let pkDisco_5877: bitstring = pub(skI) in
                                                                    {7557}in(c, (=pkCli_5846,em1_5878: bitstring,sigM1_5879: bitstring));
                                                                    {7558}let m1_5880: bitstring = dec(em1_5878,skSess_5640) in
                                                                    {7559}if (verify(m1_5880,sigM1_5879,pkCli_5846) <> true) then
                                                                        0
                                                                    else
                                                                        {7560}let (SPc_5881: bitstring,PartC_5882: bitstring) = m1_5880 in
                                                                        {7561}event endSrv(Cli_5168,Sess_5170,PartC_5882);
                                                                        {7562}new Ns_5883: bitstring;
                                                                        {7563}let gNs_5884: bitstring = exp(g,Ns_5883) in
                                                                        {7564}let m2_5885: bitstring = gNs_5884 in
                                                                        {7565}out(c, (enc(m2_5885,pkCli_5846),sign(m2_5885,skSess_5640)));
                                                                        {7566}event beginSrv(Sess_5170,Cli_5168,gNs_5884)
                                                            )
                                                            else
                                                                {7567}let pkDisco_5886: bitstring = fail-any in
                                                                {7568}in(c, (=pkCli_5846,em1_5887: bitstring,sigM1_5888: bitstring));
                                                                {7569}let m1_5889: bitstring = dec(em1_5887,skSess_5640) in
                                                                {7570}if (verify(m1_5889,sigM1_5888,pkCli_5846) <> true) then
                                                                    0
                                                                else
                                                                    {7571}let (SPc_5890: bitstring,PartC_5891: bitstring) = m1_5889 in
                                                                    {7572}event endSrv(Cli_5168,Sess_5170,PartC_5891);
                                                                    {7573}new Ns_5892: bitstring;
                                                                    {7574}let gNs_5893: bitstring = exp(g,Ns_5892) in
                                                                    {7575}let m2_5894: bitstring = gNs_5893 in
                                                                    {7576}out(c, (enc(m2_5894,pkCli_5846),sign(m2_5894,skSess_5640)));
                                                                    {7577}event beginSrv(Sess_5170,Cli_5168,gNs_5893)
                                                    )
                                                    else
                                                        {7578}let pkDisco_5895: bitstring = fail-any in
                                                        {7579}in(c, (=pkCli_5846,em1_5896: bitstring,sigM1_5897: bitstring));
                                                        {7580}let m1_5898: bitstring = dec(em1_5896,skSess_5640) in
                                                        {7581}if (verify(m1_5898,sigM1_5897,pkCli_5846) <> true) then
                                                            0
                                                        else
                                                            {7582}let (SPc_5899: bitstring,PartC_5900: bitstring) = m1_5898 in
                                                            {7583}event endSrv(Cli_5168,Sess_5170,PartC_5900);
                                                            {7584}new Ns_5901: bitstring;
                                                            {7585}let gNs_5902: bitstring = exp(g,Ns_5901) in
                                                            {7586}let m2_5903: bitstring = gNs_5902 in
                                                            {7587}out(c, (enc(m2_5903,pkCli_5846),sign(m2_5903,skSess_5640)));
                                                            {7588}event beginSrv(Sess_5170,Cli_5168,gNs_5902)
                                            )
                                            else
                                                {7589}let pkDisco_5904: bitstring = fail-any in
                                                {7590}in(c, (=pkCli_5846,em1_5905: bitstring,sigM1_5906: bitstring));
                                                {7591}let m1_5907: bitstring = dec(em1_5905,skSess_5640) in
                                                {7592}if (verify(m1_5907,sigM1_5906,pkCli_5846) <> true) then
                                                    0
                                                else
                                                    {7593}let (SPc_5908: bitstring,PartC_5909: bitstring) = m1_5907 in
                                                    {7594}event endSrv(Cli_5168,Sess_5170,PartC_5909);
                                                    {7595}new Ns_5910: bitstring;
                                                    {7596}let gNs_5911: bitstring = exp(g,Ns_5910) in
                                                    {7597}let m2_5912: bitstring = gNs_5911 in
                                                    {7598}out(c, (enc(m2_5912,pkCli_5846),sign(m2_5912,skSess_5640)));
                                                    {7599}event beginSrv(Sess_5170,Cli_5168,gNs_5911)
                                    )
                                    else
                                        {7600}let pkCli_5913: bitstring = fail-any in
                                        {7601}let v_5914: bool = (Disco_5169 = A) in
                                        (
                                            {7602}if v_5914 then
                                            (
                                                {7603}let pkDisco_5915: bitstring = pub(skA) in
                                                {7604}in(c, (=pkCli_5913,em1_5916: bitstring,sigM1_5917: bitstring));
                                                {7605}let m1_5918: bitstring = dec(em1_5916,skSess_5640) in
                                                {7606}if (verify(m1_5918,sigM1_5917,pkCli_5913) <> true) then
                                                    0
                                                else
                                                    {7607}let (SPc_5919: bitstring,PartC_5920: bitstring) = m1_5918 in
                                                    {7608}event endSrv(Cli_5168,Sess_5170,PartC_5920);
                                                    {7609}new Ns_5921: bitstring;
                                                    {7610}let gNs_5922: bitstring = exp(g,Ns_5921) in
                                                    {7611}let m2_5923: bitstring = gNs_5922 in
                                                    {7612}out(c, (enc(m2_5923,pkCli_5913),sign(m2_5923,skSess_5640)));
                                                    {7613}event beginSrv(Sess_5170,Cli_5168,gNs_5922)
                                            )
                                            else
                                                {7614}let v_5924: bool = (Disco_5169 = B) in
                                                (
                                                    {7615}if v_5924 then
                                                    (
                                                        {7616}let pkDisco_5925: bitstring = pub(skB) in
                                                        {7617}in(c, (=pkCli_5913,em1_5926: bitstring,sigM1_5927: bitstring));
                                                        {7618}let m1_5928: bitstring = dec(em1_5926,skSess_5640) in
                                                        {7619}if (verify(m1_5928,sigM1_5927,pkCli_5913) <> true) then
                                                            0
                                                        else
                                                            {7620}let (SPc_5929: bitstring,PartC_5930: bitstring) = m1_5928 in
                                                            {7621}event endSrv(Cli_5168,Sess_5170,PartC_5930);
                                                            {7622}new Ns_5931: bitstring;
                                                            {7623}let gNs_5932: bitstring = exp(g,Ns_5931) in
                                                            {7624}let m2_5933: bitstring = gNs_5932 in
                                                            {7625}out(c, (enc(m2_5933,pkCli_5913),sign(m2_5933,skSess_5640)));
                                                            {7626}event beginSrv(Sess_5170,Cli_5168,gNs_5932)
                                                    )
                                                    else
                                                        {7627}let v_5934: bool = (Disco_5169 = C) in
                                                        (
                                                            {7628}if v_5934 then
                                                            (
                                                                {7629}let pkDisco_5935: bitstring = pub(skC) in
                                                                {7630}in(c, (=pkCli_5913,em1_5936: bitstring,sigM1_5937: bitstring));
                                                                {7631}let m1_5938: bitstring = dec(em1_5936,skSess_5640) in
                                                                {7632}if (verify(m1_5938,sigM1_5937,pkCli_5913) <> true) then
                                                                    0
                                                                else
                                                                    {7633}let (SPc_5939: bitstring,PartC_5940: bitstring) = m1_5938 in
                                                                    {7634}event endSrv(Cli_5168,Sess_5170,PartC_5940);
                                                                    {7635}new Ns_5941: bitstring;
                                                                    {7636}let gNs_5942: bitstring = exp(g,Ns_5941) in
                                                                    {7637}let m2_5943: bitstring = gNs_5942 in
                                                                    {7638}out(c, (enc(m2_5943,pkCli_5913),sign(m2_5943,skSess_5640)));
                                                                    {7639}event beginSrv(Sess_5170,Cli_5168,gNs_5942)
                                                            )
                                                            else
                                                                {7640}let pkDisco_5944: bitstring = pub(skI) in
                                                                {7641}in(c, (=pkCli_5913,em1_5945: bitstring,sigM1_5946: bitstring));
                                                                {7642}let m1_5947: bitstring = dec(em1_5945,skSess_5640) in
                                                                {7643}if (verify(m1_5947,sigM1_5946,pkCli_5913) <> true) then
                                                                    0
                                                                else
                                                                    {7644}let (SPc_5948: bitstring,PartC_5949: bitstring) = m1_5947 in
                                                                    {7645}event endSrv(Cli_5168,Sess_5170,PartC_5949);
                                                                    {7646}new Ns_5950: bitstring;
                                                                    {7647}let gNs_5951: bitstring = exp(g,Ns_5950) in
                                                                    {7648}let m2_5952: bitstring = gNs_5951 in
                                                                    {7649}out(c, (enc(m2_5952,pkCli_5913),sign(m2_5952,skSess_5640)));
                                                                    {7650}event beginSrv(Sess_5170,Cli_5168,gNs_5951)
                                                        )
                                                        else
                                                            {7651}let pkDisco_5953: bitstring = fail-any in
                                                            {7652}in(c, (=pkCli_5913,em1_5954: bitstring,sigM1_5955: bitstring));
                                                            {7653}let m1_5956: bitstring = dec(em1_5954,skSess_5640) in
                                                            {7654}if (verify(m1_5956,sigM1_5955,pkCli_5913) <> true) then
                                                                0
                                                            else
                                                                {7655}let (SPc_5957: bitstring,PartC_5958: bitstring) = m1_5956 in
                                                                {7656}event endSrv(Cli_5168,Sess_5170,PartC_5958);
                                                                {7657}new Ns_5959: bitstring;
                                                                {7658}let gNs_5960: bitstring = exp(g,Ns_5959) in
                                                                {7659}let m2_5961: bitstring = gNs_5960 in
                                                                {7660}out(c, (enc(m2_5961,pkCli_5913),sign(m2_5961,skSess_5640)));
                                                                {7661}event beginSrv(Sess_5170,Cli_5168,gNs_5960)
                                                )
                                                else
                                                    {7662}let pkDisco_5962: bitstring = fail-any in
                                                    {7663}in(c, (=pkCli_5913,em1_5963: bitstring,sigM1_5964: bitstring));
                                                    {7664}let m1_5965: bitstring = dec(em1_5963,skSess_5640) in
                                                    {7665}if (verify(m1_5965,sigM1_5964,pkCli_5913) <> true) then
                                                        0
                                                    else
                                                        {7666}let (SPc_5966: bitstring,PartC_5967: bitstring) = m1_5965 in
                                                        {7667}event endSrv(Cli_5168,Sess_5170,PartC_5967);
                                                        {7668}new Ns_5968: bitstring;
                                                        {7669}let gNs_5969: bitstring = exp(g,Ns_5968) in
                                                        {7670}let m2_5970: bitstring = gNs_5969 in
                                                        {7671}out(c, (enc(m2_5970,pkCli_5913),sign(m2_5970,skSess_5640)));
                                                        {7672}event beginSrv(Sess_5170,Cli_5168,gNs_5969)
                                        )
                                        else
                                            {7673}let pkDisco_5971: bitstring = fail-any in
                                            {7674}in(c, (=pkCli_5913,em1_5972: bitstring,sigM1_5973: bitstring));
                                            {7675}let m1_5974: bitstring = dec(em1_5972,skSess_5640) in
                                            {7676}if (verify(m1_5974,sigM1_5973,pkCli_5913) <> true) then
                                                0
                                            else
                                                {7677}let (SPc_5975: bitstring,PartC_5976: bitstring) = m1_5974 in
                                                {7678}event endSrv(Cli_5168,Sess_5170,PartC_5976);
                                                {7679}new Ns_5977: bitstring;
                                                {7680}let gNs_5978: bitstring = exp(g,Ns_5977) in
                                                {7681}let m2_5979: bitstring = gNs_5978 in
                                                {7682}out(c, (enc(m2_5979,pkCli_5913),sign(m2_5979,skSess_5640)));
                                                {7683}event beginSrv(Sess_5170,Cli_5168,gNs_5978)
                            )
                            else
                                {7684}let pkCli_5980: bitstring = fail-any in
                                {7685}let v_5981: bool = (Disco_5169 = A) in
                                (
                                    {7686}if v_5981 then
                                    (
                                        {7687}let pkDisco_5982: bitstring = pub(skA) in
                                        {7688}in(c, (=pkCli_5980,em1_5983: bitstring,sigM1_5984: bitstring));
                                        {7689}let m1_5985: bitstring = dec(em1_5983,skSess_5640) in
                                        {7690}if (verify(m1_5985,sigM1_5984,pkCli_5980) <> true) then
                                            0
                                        else
                                            {7691}let (SPc_5986: bitstring,PartC_5987: bitstring) = m1_5985 in
                                            {7692}event endSrv(Cli_5168,Sess_5170,PartC_5987);
                                            {7693}new Ns_5988: bitstring;
                                            {7694}let gNs_5989: bitstring = exp(g,Ns_5988) in
                                            {7695}let m2_5990: bitstring = gNs_5989 in
                                            {7696}out(c, (enc(m2_5990,pkCli_5980),sign(m2_5990,skSess_5640)));
                                            {7697}event beginSrv(Sess_5170,Cli_5168,gNs_5989)
                                    )
                                    else
                                        {7698}let v_5991: bool = (Disco_5169 = B) in
                                        (
                                            {7699}if v_5991 then
                                            (
                                                {7700}let pkDisco_5992: bitstring = pub(skB) in
                                                {7701}in(c, (=pkCli_5980,em1_5993: bitstring,sigM1_5994: bitstring));
                                                {7702}let m1_5995: bitstring = dec(em1_5993,skSess_5640) in
                                                {7703}if (verify(m1_5995,sigM1_5994,pkCli_5980) <> true) then
                                                    0
                                                else
                                                    {7704}let (SPc_5996: bitstring,PartC_5997: bitstring) = m1_5995 in
                                                    {7705}event endSrv(Cli_5168,Sess_5170,PartC_5997);
                                                    {7706}new Ns_5998: bitstring;
                                                    {7707}let gNs_5999: bitstring = exp(g,Ns_5998) in
                                                    {7708}let m2_6000: bitstring = gNs_5999 in
                                                    {7709}out(c, (enc(m2_6000,pkCli_5980),sign(m2_6000,skSess_5640)));
                                                    {7710}event beginSrv(Sess_5170,Cli_5168,gNs_5999)
                                            )
                                            else
                                                {7711}let v_6001: bool = (Disco_5169 = C) in
                                                (
                                                    {7712}if v_6001 then
                                                    (
                                                        {7713}let pkDisco_6002: bitstring = pub(skC) in
                                                        {7714}in(c, (=pkCli_5980,em1_6003: bitstring,sigM1_6004: bitstring));
                                                        {7715}let m1_6005: bitstring = dec(em1_6003,skSess_5640) in
                                                        {7716}if (verify(m1_6005,sigM1_6004,pkCli_5980) <> true) then
                                                            0
                                                        else
                                                            {7717}let (SPc_6006: bitstring,PartC_6007: bitstring) = m1_6005 in
                                                            {7718}event endSrv(Cli_5168,Sess_5170,PartC_6007);
                                                            {7719}new Ns_6008: bitstring;
                                                            {7720}let gNs_6009: bitstring = exp(g,Ns_6008) in
                                                            {7721}let m2_6010: bitstring = gNs_6009 in
                                                            {7722}out(c, (enc(m2_6010,pkCli_5980),sign(m2_6010,skSess_5640)));
                                                            {7723}event beginSrv(Sess_5170,Cli_5168,gNs_6009)
                                                    )
                                                    else
                                                        {7724}let pkDisco_6011: bitstring = pub(skI) in
                                                        {7725}in(c, (=pkCli_5980,em1_6012: bitstring,sigM1_6013: bitstring));
                                                        {7726}let m1_6014: bitstring = dec(em1_6012,skSess_5640) in
                                                        {7727}if (verify(m1_6014,sigM1_6013,pkCli_5980) <> true) then
                                                            0
                                                        else
                                                            {7728}let (SPc_6015: bitstring,PartC_6016: bitstring) = m1_6014 in
                                                            {7729}event endSrv(Cli_5168,Sess_5170,PartC_6016);
                                                            {7730}new Ns_6017: bitstring;
                                                            {7731}let gNs_6018: bitstring = exp(g,Ns_6017) in
                                                            {7732}let m2_6019: bitstring = gNs_6018 in
                                                            {7733}out(c, (enc(m2_6019,pkCli_5980),sign(m2_6019,skSess_5640)));
                                                            {7734}event beginSrv(Sess_5170,Cli_5168,gNs_6018)
                                                )
                                                else
                                                    {7735}let pkDisco_6020: bitstring = fail-any in
                                                    {7736}in(c, (=pkCli_5980,em1_6021: bitstring,sigM1_6022: bitstring));
                                                    {7737}let m1_6023: bitstring = dec(em1_6021,skSess_5640) in
                                                    {7738}if (verify(m1_6023,sigM1_6022,pkCli_5980) <> true) then
                                                        0
                                                    else
                                                        {7739}let (SPc_6024: bitstring,PartC_6025: bitstring) = m1_6023 in
                                                        {7740}event endSrv(Cli_5168,Sess_5170,PartC_6025);
                                                        {7741}new Ns_6026: bitstring;
                                                        {7742}let gNs_6027: bitstring = exp(g,Ns_6026) in
                                                        {7743}let m2_6028: bitstring = gNs_6027 in
                                                        {7744}out(c, (enc(m2_6028,pkCli_5980),sign(m2_6028,skSess_5640)));
                                                        {7745}event beginSrv(Sess_5170,Cli_5168,gNs_6027)
                                        )
                                        else
                                            {7746}let pkDisco_6029: bitstring = fail-any in
                                            {7747}in(c, (=pkCli_5980,em1_6030: bitstring,sigM1_6031: bitstring));
                                            {7748}let m1_6032: bitstring = dec(em1_6030,skSess_5640) in
                                            {7749}if (verify(m1_6032,sigM1_6031,pkCli_5980) <> true) then
                                                0
                                            else
                                                {7750}let (SPc_6033: bitstring,PartC_6034: bitstring) = m1_6032 in
                                                {7751}event endSrv(Cli_5168,Sess_5170,PartC_6034);
                                                {7752}new Ns_6035: bitstring;
                                                {7753}let gNs_6036: bitstring = exp(g,Ns_6035) in
                                                {7754}let m2_6037: bitstring = gNs_6036 in
                                                {7755}out(c, (enc(m2_6037,pkCli_5980),sign(m2_6037,skSess_5640)));
                                                {7756}event beginSrv(Sess_5170,Cli_5168,gNs_6036)
                                )
                                else
                                    {7757}let pkDisco_6038: bitstring = fail-any in
                                    {7758}in(c, (=pkCli_5980,em1_6039: bitstring,sigM1_6040: bitstring));
                                    {7759}let m1_6041: bitstring = dec(em1_6039,skSess_5640) in
                                    {7760}if (verify(m1_6041,sigM1_6040,pkCli_5980) <> true) then
                                        0
                                    else
                                        {7761}let (SPc_6042: bitstring,PartC_6043: bitstring) = m1_6041 in
                                        {7762}event endSrv(Cli_5168,Sess_5170,PartC_6043);
                                        {7763}new Ns_6044: bitstring;
                                        {7764}let gNs_6045: bitstring = exp(g,Ns_6044) in
                                        {7765}let m2_6046: bitstring = gNs_6045 in
                                        {7766}out(c, (enc(m2_6046,pkCli_5980),sign(m2_6046,skSess_5640)));
                                        {7767}event beginSrv(Sess_5170,Cli_5168,gNs_6045)
                    )
                    else
                        {7768}let pkCli_6047: bitstring = fail-any in
                        {7769}let v_6048: bool = (Disco_5169 = A) in
                        (
                            {7770}if v_6048 then
                            (
                                {7771}let pkDisco_6049: bitstring = pub(skA) in
                                {7772}in(c, (=pkCli_6047,em1_6050: bitstring,sigM1_6051: bitstring));
                                {7773}let m1_6052: bitstring = dec(em1_6050,skSess_5640) in
                                {7774}if (verify(m1_6052,sigM1_6051,pkCli_6047) <> true) then
                                    0
                                else
                                    {7775}let (SPc_6053: bitstring,PartC_6054: bitstring) = m1_6052 in
                                    {7776}event endSrv(Cli_5168,Sess_5170,PartC_6054);
                                    {7777}new Ns_6055: bitstring;
                                    {7778}let gNs_6056: bitstring = exp(g,Ns_6055) in
                                    {7779}let m2_6057: bitstring = gNs_6056 in
                                    {7780}out(c, (enc(m2_6057,pkCli_6047),sign(m2_6057,skSess_5640)));
                                    {7781}event beginSrv(Sess_5170,Cli_5168,gNs_6056)
                            )
                            else
                                {7782}let v_6058: bool = (Disco_5169 = B) in
                                (
                                    {7783}if v_6058 then
                                    (
                                        {7784}let pkDisco_6059: bitstring = pub(skB) in
                                        {7785}in(c, (=pkCli_6047,em1_6060: bitstring,sigM1_6061: bitstring));
                                        {7786}let m1_6062: bitstring = dec(em1_6060,skSess_5640) in
                                        {7787}if (verify(m1_6062,sigM1_6061,pkCli_6047) <> true) then
                                            0
                                        else
                                            {7788}let (SPc_6063: bitstring,PartC_6064: bitstring) = m1_6062 in
                                            {7789}event endSrv(Cli_5168,Sess_5170,PartC_6064);
                                            {7790}new Ns_6065: bitstring;
                                            {7791}let gNs_6066: bitstring = exp(g,Ns_6065) in
                                            {7792}let m2_6067: bitstring = gNs_6066 in
                                            {7793}out(c, (enc(m2_6067,pkCli_6047),sign(m2_6067,skSess_5640)));
                                            {7794}event beginSrv(Sess_5170,Cli_5168,gNs_6066)
                                    )
                                    else
                                        {7795}let v_6068: bool = (Disco_5169 = C) in
                                        (
                                            {7796}if v_6068 then
                                            (
                                                {7797}let pkDisco_6069: bitstring = pub(skC) in
                                                {7798}in(c, (=pkCli_6047,em1_6070: bitstring,sigM1_6071: bitstring));
                                                {7799}let m1_6072: bitstring = dec(em1_6070,skSess_5640) in
                                                {7800}if (verify(m1_6072,sigM1_6071,pkCli_6047) <> true) then
                                                    0
                                                else
                                                    {7801}let (SPc_6073: bitstring,PartC_6074: bitstring) = m1_6072 in
                                                    {7802}event endSrv(Cli_5168,Sess_5170,PartC_6074);
                                                    {7803}new Ns_6075: bitstring;
                                                    {7804}let gNs_6076: bitstring = exp(g,Ns_6075) in
                                                    {7805}let m2_6077: bitstring = gNs_6076 in
                                                    {7806}out(c, (enc(m2_6077,pkCli_6047),sign(m2_6077,skSess_5640)));
                                                    {7807}event beginSrv(Sess_5170,Cli_5168,gNs_6076)
                                            )
                                            else
                                                {7808}let pkDisco_6078: bitstring = pub(skI) in
                                                {7809}in(c, (=pkCli_6047,em1_6079: bitstring,sigM1_6080: bitstring));
                                                {7810}let m1_6081: bitstring = dec(em1_6079,skSess_5640) in
                                                {7811}if (verify(m1_6081,sigM1_6080,pkCli_6047) <> true) then
                                                    0
                                                else
                                                    {7812}let (SPc_6082: bitstring,PartC_6083: bitstring) = m1_6081 in
                                                    {7813}event endSrv(Cli_5168,Sess_5170,PartC_6083);
                                                    {7814}new Ns_6084: bitstring;
                                                    {7815}let gNs_6085: bitstring = exp(g,Ns_6084) in
                                                    {7816}let m2_6086: bitstring = gNs_6085 in
                                                    {7817}out(c, (enc(m2_6086,pkCli_6047),sign(m2_6086,skSess_5640)));
                                                    {7818}event beginSrv(Sess_5170,Cli_5168,gNs_6085)
                                        )
                                        else
                                            {7819}let pkDisco_6087: bitstring = fail-any in
                                            {7820}in(c, (=pkCli_6047,em1_6088: bitstring,sigM1_6089: bitstring));
                                            {7821}let m1_6090: bitstring = dec(em1_6088,skSess_5640) in
                                            {7822}if (verify(m1_6090,sigM1_6089,pkCli_6047) <> true) then
                                                0
                                            else
                                                {7823}let (SPc_6091: bitstring,PartC_6092: bitstring) = m1_6090 in
                                                {7824}event endSrv(Cli_5168,Sess_5170,PartC_6092);
                                                {7825}new Ns_6093: bitstring;
                                                {7826}let gNs_6094: bitstring = exp(g,Ns_6093) in
                                                {7827}let m2_6095: bitstring = gNs_6094 in
                                                {7828}out(c, (enc(m2_6095,pkCli_6047),sign(m2_6095,skSess_5640)));
                                                {7829}event beginSrv(Sess_5170,Cli_5168,gNs_6094)
                                )
                                else
                                    {7830}let pkDisco_6096: bitstring = fail-any in
                                    {7831}in(c, (=pkCli_6047,em1_6097: bitstring,sigM1_6098: bitstring));
                                    {7832}let m1_6099: bitstring = dec(em1_6097,skSess_5640) in
                                    {7833}if (verify(m1_6099,sigM1_6098,pkCli_6047) <> true) then
                                        0
                                    else
                                        {7834}let (SPc_6100: bitstring,PartC_6101: bitstring) = m1_6099 in
                                        {7835}event endSrv(Cli_5168,Sess_5170,PartC_6101);
                                        {7836}new Ns_6102: bitstring;
                                        {7837}let gNs_6103: bitstring = exp(g,Ns_6102) in
                                        {7838}let m2_6104: bitstring = gNs_6103 in
                                        {7839}out(c, (enc(m2_6104,pkCli_6047),sign(m2_6104,skSess_5640)));
                                        {7840}event beginSrv(Sess_5170,Cli_5168,gNs_6103)
                        )
                        else
                            {7841}let pkDisco_6105: bitstring = fail-any in
                            {7842}in(c, (=pkCli_6047,em1_6106: bitstring,sigM1_6107: bitstring));
                            {7843}let m1_6108: bitstring = dec(em1_6106,skSess_5640) in
                            {7844}if (verify(m1_6108,sigM1_6107,pkCli_6047) <> true) then
                                0
                            else
                                {7845}let (SPc_6109: bitstring,PartC_6110: bitstring) = m1_6108 in
                                {7846}event endSrv(Cli_5168,Sess_5170,PartC_6110);
                                {7847}new Ns_6111: bitstring;
                                {7848}let gNs_6112: bitstring = exp(g,Ns_6111) in
                                {7849}let m2_6113: bitstring = gNs_6112 in
                                {7850}out(c, (enc(m2_6113,pkCli_6047),sign(m2_6113,skSess_5640)));
                                {7851}event beginSrv(Sess_5170,Cli_5168,gNs_6112)
                )
                else
                    {7852}let v_6114: bool = (Sess_5170 = C) in
                    (
                        {7853}if v_6114 then
                        (
                            {7854}let skSess_6115: bitstring = skC in
                            {7855}let pkSess_6116: bitstring = pub(skSess_6115) in
                            {7856}let v_6117: bool = (Cli_5168 = A) in
                            (
                                {7857}if v_6117 then
                                (
                                    {7858}let pkCli_6118: bitstring = pub(skA) in
                                    {7859}let v_6119: bool = (Disco_5169 = A) in
                                    (
                                        {7860}if v_6119 then
                                        (
                                            {7861}let pkDisco_6120: bitstring = pub(skA) in
                                            {7862}in(c, (=pkCli_6118,em1_6121: bitstring,sigM1_6122: bitstring));
                                            {7863}let m1_6123: bitstring = dec(em1_6121,skSess_6115) in
                                            {7864}if (verify(m1_6123,sigM1_6122,pkCli_6118) <> true) then
                                                0
                                            else
                                                {7865}let (SPc_6124: bitstring,PartC_6125: bitstring) = m1_6123 in
                                                {7866}event endSrv(Cli_5168,Sess_5170,PartC_6125);
                                                {7867}new Ns_6126: bitstring;
                                                {7868}let gNs_6127: bitstring = exp(g,Ns_6126) in
                                                {7869}let m2_6128: bitstring = gNs_6127 in
                                                {7870}out(c, (enc(m2_6128,pkCli_6118),sign(m2_6128,skSess_6115)));
                                                {7871}event beginSrv(Sess_5170,Cli_5168,gNs_6127)
                                        )
                                        else
                                            {7872}let v_6129: bool = (Disco_5169 = B) in
                                            (
                                                {7873}if v_6129 then
                                                (
                                                    {7874}let pkDisco_6130: bitstring = pub(skB) in
                                                    {7875}in(c, (=pkCli_6118,em1_6131: bitstring,sigM1_6132: bitstring));
                                                    {7876}let m1_6133: bitstring = dec(em1_6131,skSess_6115) in
                                                    {7877}if (verify(m1_6133,sigM1_6132,pkCli_6118) <> true) then
                                                        0
                                                    else
                                                        {7878}let (SPc_6134: bitstring,PartC_6135: bitstring) = m1_6133 in
                                                        {7879}event endSrv(Cli_5168,Sess_5170,PartC_6135);
                                                        {7880}new Ns_6136: bitstring;
                                                        {7881}let gNs_6137: bitstring = exp(g,Ns_6136) in
                                                        {7882}let m2_6138: bitstring = gNs_6137 in
                                                        {7883}out(c, (enc(m2_6138,pkCli_6118),sign(m2_6138,skSess_6115)));
                                                        {7884}event beginSrv(Sess_5170,Cli_5168,gNs_6137)
                                                )
                                                else
                                                    {7885}let v_6139: bool = (Disco_5169 = C) in
                                                    (
                                                        {7886}if v_6139 then
                                                        (
                                                            {7887}let pkDisco_6140: bitstring = pub(skC) in
                                                            {7888}in(c, (=pkCli_6118,em1_6141: bitstring,sigM1_6142: bitstring));
                                                            {7889}let m1_6143: bitstring = dec(em1_6141,skSess_6115) in
                                                            {7890}if (verify(m1_6143,sigM1_6142,pkCli_6118) <> true) then
                                                                0
                                                            else
                                                                {7891}let (SPc_6144: bitstring,PartC_6145: bitstring) = m1_6143 in
                                                                {7892}event endSrv(Cli_5168,Sess_5170,PartC_6145);
                                                                {7893}new Ns_6146: bitstring;
                                                                {7894}let gNs_6147: bitstring = exp(g,Ns_6146) in
                                                                {7895}let m2_6148: bitstring = gNs_6147 in
                                                                {7896}out(c, (enc(m2_6148,pkCli_6118),sign(m2_6148,skSess_6115)));
                                                                {7897}event beginSrv(Sess_5170,Cli_5168,gNs_6147)
                                                        )
                                                        else
                                                            {7898}let pkDisco_6149: bitstring = pub(skI) in
                                                            {7899}in(c, (=pkCli_6118,em1_6150: bitstring,sigM1_6151: bitstring));
                                                            {7900}let m1_6152: bitstring = dec(em1_6150,skSess_6115) in
                                                            {7901}if (verify(m1_6152,sigM1_6151,pkCli_6118) <> true) then
                                                                0
                                                            else
                                                                {7902}let (SPc_6153: bitstring,PartC_6154: bitstring) = m1_6152 in
                                                                {7903}event endSrv(Cli_5168,Sess_5170,PartC_6154);
                                                                {7904}new Ns_6155: bitstring;
                                                                {7905}let gNs_6156: bitstring = exp(g,Ns_6155) in
                                                                {7906}let m2_6157: bitstring = gNs_6156 in
                                                                {7907}out(c, (enc(m2_6157,pkCli_6118),sign(m2_6157,skSess_6115)));
                                                                {7908}event beginSrv(Sess_5170,Cli_5168,gNs_6156)
                                                    )
                                                    else
                                                        {7909}let pkDisco_6158: bitstring = fail-any in
                                                        {7910}in(c, (=pkCli_6118,em1_6159: bitstring,sigM1_6160: bitstring));
                                                        {7911}let m1_6161: bitstring = dec(em1_6159,skSess_6115) in
                                                        {7912}if (verify(m1_6161,sigM1_6160,pkCli_6118) <> true) then
                                                            0
                                                        else
                                                            {7913}let (SPc_6162: bitstring,PartC_6163: bitstring) = m1_6161 in
                                                            {7914}event endSrv(Cli_5168,Sess_5170,PartC_6163);
                                                            {7915}new Ns_6164: bitstring;
                                                            {7916}let gNs_6165: bitstring = exp(g,Ns_6164) in
                                                            {7917}let m2_6166: bitstring = gNs_6165 in
                                                            {7918}out(c, (enc(m2_6166,pkCli_6118),sign(m2_6166,skSess_6115)));
                                                            {7919}event beginSrv(Sess_5170,Cli_5168,gNs_6165)
                                            )
                                            else
                                                {7920}let pkDisco_6167: bitstring = fail-any in
                                                {7921}in(c, (=pkCli_6118,em1_6168: bitstring,sigM1_6169: bitstring));
                                                {7922}let m1_6170: bitstring = dec(em1_6168,skSess_6115) in
                                                {7923}if (verify(m1_6170,sigM1_6169,pkCli_6118) <> true) then
                                                    0
                                                else
                                                    {7924}let (SPc_6171: bitstring,PartC_6172: bitstring) = m1_6170 in
                                                    {7925}event endSrv(Cli_5168,Sess_5170,PartC_6172);
                                                    {7926}new Ns_6173: bitstring;
                                                    {7927}let gNs_6174: bitstring = exp(g,Ns_6173) in
                                                    {7928}let m2_6175: bitstring = gNs_6174 in
                                                    {7929}out(c, (enc(m2_6175,pkCli_6118),sign(m2_6175,skSess_6115)));
                                                    {7930}event beginSrv(Sess_5170,Cli_5168,gNs_6174)
                                    )
                                    else
                                        {7931}let pkDisco_6176: bitstring = fail-any in
                                        {7932}in(c, (=pkCli_6118,em1_6177: bitstring,sigM1_6178: bitstring));
                                        {7933}let m1_6179: bitstring = dec(em1_6177,skSess_6115) in
                                        {7934}if (verify(m1_6179,sigM1_6178,pkCli_6118) <> true) then
                                            0
                                        else
                                            {7935}let (SPc_6180: bitstring,PartC_6181: bitstring) = m1_6179 in
                                            {7936}event endSrv(Cli_5168,Sess_5170,PartC_6181);
                                            {7937}new Ns_6182: bitstring;
                                            {7938}let gNs_6183: bitstring = exp(g,Ns_6182) in
                                            {7939}let m2_6184: bitstring = gNs_6183 in
                                            {7940}out(c, (enc(m2_6184,pkCli_6118),sign(m2_6184,skSess_6115)));
                                            {7941}event beginSrv(Sess_5170,Cli_5168,gNs_6183)
                                )
                                else
                                    {7942}let v_6185: bool = (Cli_5168 = B) in
                                    (
                                        {7943}if v_6185 then
                                        (
                                            {7944}let pkCli_6186: bitstring = pub(skB) in
                                            {7945}let v_6187: bool = (Disco_5169 = A) in
                                            (
                                                {7946}if v_6187 then
                                                (
                                                    {7947}let pkDisco_6188: bitstring = pub(skA) in
                                                    {7948}in(c, (=pkCli_6186,em1_6189: bitstring,sigM1_6190: bitstring));
                                                    {7949}let m1_6191: bitstring = dec(em1_6189,skSess_6115) in
                                                    {7950}if (verify(m1_6191,sigM1_6190,pkCli_6186) <> true) then
                                                        0
                                                    else
                                                        {7951}let (SPc_6192: bitstring,PartC_6193: bitstring) = m1_6191 in
                                                        {7952}event endSrv(Cli_5168,Sess_5170,PartC_6193);
                                                        {7953}new Ns_6194: bitstring;
                                                        {7954}let gNs_6195: bitstring = exp(g,Ns_6194) in
                                                        {7955}let m2_6196: bitstring = gNs_6195 in
                                                        {7956}out(c, (enc(m2_6196,pkCli_6186),sign(m2_6196,skSess_6115)));
                                                        {7957}event beginSrv(Sess_5170,Cli_5168,gNs_6195)
                                                )
                                                else
                                                    {7958}let v_6197: bool = (Disco_5169 = B) in
                                                    (
                                                        {7959}if v_6197 then
                                                        (
                                                            {7960}let pkDisco_6198: bitstring = pub(skB) in
                                                            {7961}in(c, (=pkCli_6186,em1_6199: bitstring,sigM1_6200: bitstring));
                                                            {7962}let m1_6201: bitstring = dec(em1_6199,skSess_6115) in
                                                            {7963}if (verify(m1_6201,sigM1_6200,pkCli_6186) <> true) then
                                                                0
                                                            else
                                                                {7964}let (SPc_6202: bitstring,PartC_6203: bitstring) = m1_6201 in
                                                                {7965}event endSrv(Cli_5168,Sess_5170,PartC_6203);
                                                                {7966}new Ns_6204: bitstring;
                                                                {7967}let gNs_6205: bitstring = exp(g,Ns_6204) in
                                                                {7968}let m2_6206: bitstring = gNs_6205 in
                                                                {7969}out(c, (enc(m2_6206,pkCli_6186),sign(m2_6206,skSess_6115)));
                                                                {7970}event beginSrv(Sess_5170,Cli_5168,gNs_6205)
                                                        )
                                                        else
                                                            {7971}let v_6207: bool = (Disco_5169 = C) in
                                                            (
                                                                {7972}if v_6207 then
                                                                (
                                                                    {7973}let pkDisco_6208: bitstring = pub(skC) in
                                                                    {7974}in(c, (=pkCli_6186,em1_6209: bitstring,sigM1_6210: bitstring));
                                                                    {7975}let m1_6211: bitstring = dec(em1_6209,skSess_6115) in
                                                                    {7976}if (verify(m1_6211,sigM1_6210,pkCli_6186) <> true) then
                                                                        0
                                                                    else
                                                                        {7977}let (SPc_6212: bitstring,PartC_6213: bitstring) = m1_6211 in
                                                                        {7978}event endSrv(Cli_5168,Sess_5170,PartC_6213);
                                                                        {7979}new Ns_6214: bitstring;
                                                                        {7980}let gNs_6215: bitstring = exp(g,Ns_6214) in
                                                                        {7981}let m2_6216: bitstring = gNs_6215 in
                                                                        {7982}out(c, (enc(m2_6216,pkCli_6186),sign(m2_6216,skSess_6115)));
                                                                        {7983}event beginSrv(Sess_5170,Cli_5168,gNs_6215)
                                                                )
                                                                else
                                                                    {7984}let pkDisco_6217: bitstring = pub(skI) in
                                                                    {7985}in(c, (=pkCli_6186,em1_6218: bitstring,sigM1_6219: bitstring));
                                                                    {7986}let m1_6220: bitstring = dec(em1_6218,skSess_6115) in
                                                                    {7987}if (verify(m1_6220,sigM1_6219,pkCli_6186) <> true) then
                                                                        0
                                                                    else
                                                                        {7988}let (SPc_6221: bitstring,PartC_6222: bitstring) = m1_6220 in
                                                                        {7989}event endSrv(Cli_5168,Sess_5170,PartC_6222);
                                                                        {7990}new Ns_6223: bitstring;
                                                                        {7991}let gNs_6224: bitstring = exp(g,Ns_6223) in
                                                                        {7992}let m2_6225: bitstring = gNs_6224 in
                                                                        {7993}out(c, (enc(m2_6225,pkCli_6186),sign(m2_6225,skSess_6115)));
                                                                        {7994}event beginSrv(Sess_5170,Cli_5168,gNs_6224)
                                                            )
                                                            else
                                                                {7995}let pkDisco_6226: bitstring = fail-any in
                                                                {7996}in(c, (=pkCli_6186,em1_6227: bitstring,sigM1_6228: bitstring));
                                                                {7997}let m1_6229: bitstring = dec(em1_6227,skSess_6115) in
                                                                {7998}if (verify(m1_6229,sigM1_6228,pkCli_6186) <> true) then
                                                                    0
                                                                else
                                                                    {7999}let (SPc_6230: bitstring,PartC_6231: bitstring) = m1_6229 in
                                                                    {8000}event endSrv(Cli_5168,Sess_5170,PartC_6231);
                                                                    {8001}new Ns_6232: bitstring;
                                                                    {8002}let gNs_6233: bitstring = exp(g,Ns_6232) in
                                                                    {8003}let m2_6234: bitstring = gNs_6233 in
                                                                    {8004}out(c, (enc(m2_6234,pkCli_6186),sign(m2_6234,skSess_6115)));
                                                                    {8005}event beginSrv(Sess_5170,Cli_5168,gNs_6233)
                                                    )
                                                    else
                                                        {8006}let pkDisco_6235: bitstring = fail-any in
                                                        {8007}in(c, (=pkCli_6186,em1_6236: bitstring,sigM1_6237: bitstring));
                                                        {8008}let m1_6238: bitstring = dec(em1_6236,skSess_6115) in
                                                        {8009}if (verify(m1_6238,sigM1_6237,pkCli_6186) <> true) then
                                                            0
                                                        else
                                                            {8010}let (SPc_6239: bitstring,PartC_6240: bitstring) = m1_6238 in
                                                            {8011}event endSrv(Cli_5168,Sess_5170,PartC_6240);
                                                            {8012}new Ns_6241: bitstring;
                                                            {8013}let gNs_6242: bitstring = exp(g,Ns_6241) in
                                                            {8014}let m2_6243: bitstring = gNs_6242 in
                                                            {8015}out(c, (enc(m2_6243,pkCli_6186),sign(m2_6243,skSess_6115)));
                                                            {8016}event beginSrv(Sess_5170,Cli_5168,gNs_6242)
                                            )
                                            else
                                                {8017}let pkDisco_6244: bitstring = fail-any in
                                                {8018}in(c, (=pkCli_6186,em1_6245: bitstring,sigM1_6246: bitstring));
                                                {8019}let m1_6247: bitstring = dec(em1_6245,skSess_6115) in
                                                {8020}if (verify(m1_6247,sigM1_6246,pkCli_6186) <> true) then
                                                    0
                                                else
                                                    {8021}let (SPc_6248: bitstring,PartC_6249: bitstring) = m1_6247 in
                                                    {8022}event endSrv(Cli_5168,Sess_5170,PartC_6249);
                                                    {8023}new Ns_6250: bitstring;
                                                    {8024}let gNs_6251: bitstring = exp(g,Ns_6250) in
                                                    {8025}let m2_6252: bitstring = gNs_6251 in
                                                    {8026}out(c, (enc(m2_6252,pkCli_6186),sign(m2_6252,skSess_6115)));
                                                    {8027}event beginSrv(Sess_5170,Cli_5168,gNs_6251)
                                        )
                                        else
                                            {8028}let v_6253: bool = (Cli_5168 = C) in
                                            (
                                                {8029}if v_6253 then
                                                (
                                                    {8030}let pkCli_6254: bitstring = pub(skC) in
                                                    {8031}let v_6255: bool = (Disco_5169 = A) in
                                                    (
                                                        {8032}if v_6255 then
                                                        (
                                                            {8033}let pkDisco_6256: bitstring = pub(skA) in
                                                            {8034}in(c, (=pkCli_6254,em1_6257: bitstring,sigM1_6258: bitstring));
                                                            {8035}let m1_6259: bitstring = dec(em1_6257,skSess_6115) in
                                                            {8036}if (verify(m1_6259,sigM1_6258,pkCli_6254) <> true) then
                                                                0
                                                            else
                                                                {8037}let (SPc_6260: bitstring,PartC_6261: bitstring) = m1_6259 in
                                                                {8038}event endSrv(Cli_5168,Sess_5170,PartC_6261);
                                                                {8039}new Ns_6262: bitstring;
                                                                {8040}let gNs_6263: bitstring = exp(g,Ns_6262) in
                                                                {8041}let m2_6264: bitstring = gNs_6263 in
                                                                {8042}out(c, (enc(m2_6264,pkCli_6254),sign(m2_6264,skSess_6115)));
                                                                {8043}event beginSrv(Sess_5170,Cli_5168,gNs_6263)
                                                        )
                                                        else
                                                            {8044}let v_6265: bool = (Disco_5169 = B) in
                                                            (
                                                                {8045}if v_6265 then
                                                                (
                                                                    {8046}let pkDisco_6266: bitstring = pub(skB) in
                                                                    {8047}in(c, (=pkCli_6254,em1_6267: bitstring,sigM1_6268: bitstring));
                                                                    {8048}let m1_6269: bitstring = dec(em1_6267,skSess_6115) in
                                                                    {8049}if (verify(m1_6269,sigM1_6268,pkCli_6254) <> true) then
                                                                        0
                                                                    else
                                                                        {8050}let (SPc_6270: bitstring,PartC_6271: bitstring) = m1_6269 in
                                                                        {8051}event endSrv(Cli_5168,Sess_5170,PartC_6271);
                                                                        {8052}new Ns_6272: bitstring;
                                                                        {8053}let gNs_6273: bitstring = exp(g,Ns_6272) in
                                                                        {8054}let m2_6274: bitstring = gNs_6273 in
                                                                        {8055}out(c, (enc(m2_6274,pkCli_6254),sign(m2_6274,skSess_6115)));
                                                                        {8056}event beginSrv(Sess_5170,Cli_5168,gNs_6273)
                                                                )
                                                                else
                                                                    {8057}let v_6275: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {8058}if v_6275 then
                                                                        (
                                                                            {8059}let pkDisco_6276: bitstring = pub(skC) in
                                                                            {8060}in(c, (=pkCli_6254,em1_6277: bitstring,sigM1_6278: bitstring));
                                                                            {8061}let m1_6279: bitstring = dec(em1_6277,skSess_6115) in
                                                                            {8062}if (verify(m1_6279,sigM1_6278,pkCli_6254) <> true) then
                                                                                0
                                                                            else
                                                                                {8063}let (SPc_6280: bitstring,PartC_6281: bitstring) = m1_6279 in
                                                                                {8064}event endSrv(Cli_5168,Sess_5170,PartC_6281);
                                                                                {8065}new Ns_6282: bitstring;
                                                                                {8066}let gNs_6283: bitstring = exp(g,Ns_6282) in
                                                                                {8067}let m2_6284: bitstring = gNs_6283 in
                                                                                {8068}out(c, (enc(m2_6284,pkCli_6254),sign(m2_6284,skSess_6115)));
                                                                                {8069}event beginSrv(Sess_5170,Cli_5168,gNs_6283)
                                                                        )
                                                                        else
                                                                            {8070}let pkDisco_6285: bitstring = pub(skI) in
                                                                            {8071}in(c, (=pkCli_6254,em1_6286: bitstring,sigM1_6287: bitstring));
                                                                            {8072}let m1_6288: bitstring = dec(em1_6286,skSess_6115) in
                                                                            {8073}if (verify(m1_6288,sigM1_6287,pkCli_6254) <> true) then
                                                                                0
                                                                            else
                                                                                {8074}let (SPc_6289: bitstring,PartC_6290: bitstring) = m1_6288 in
                                                                                {8075}event endSrv(Cli_5168,Sess_5170,PartC_6290);
                                                                                {8076}new Ns_6291: bitstring;
                                                                                {8077}let gNs_6292: bitstring = exp(g,Ns_6291) in
                                                                                {8078}let m2_6293: bitstring = gNs_6292 in
                                                                                {8079}out(c, (enc(m2_6293,pkCli_6254),sign(m2_6293,skSess_6115)));
                                                                                {8080}event beginSrv(Sess_5170,Cli_5168,gNs_6292)
                                                                    )
                                                                    else
                                                                        {8081}let pkDisco_6294: bitstring = fail-any in
                                                                        {8082}in(c, (=pkCli_6254,em1_6295: bitstring,sigM1_6296: bitstring));
                                                                        {8083}let m1_6297: bitstring = dec(em1_6295,skSess_6115) in
                                                                        {8084}if (verify(m1_6297,sigM1_6296,pkCli_6254) <> true) then
                                                                            0
                                                                        else
                                                                            {8085}let (SPc_6298: bitstring,PartC_6299: bitstring) = m1_6297 in
                                                                            {8086}event endSrv(Cli_5168,Sess_5170,PartC_6299);
                                                                            {8087}new Ns_6300: bitstring;
                                                                            {8088}let gNs_6301: bitstring = exp(g,Ns_6300) in
                                                                            {8089}let m2_6302: bitstring = gNs_6301 in
                                                                            {8090}out(c, (enc(m2_6302,pkCli_6254),sign(m2_6302,skSess_6115)));
                                                                            {8091}event beginSrv(Sess_5170,Cli_5168,gNs_6301)
                                                            )
                                                            else
                                                                {8092}let pkDisco_6303: bitstring = fail-any in
                                                                {8093}in(c, (=pkCli_6254,em1_6304: bitstring,sigM1_6305: bitstring));
                                                                {8094}let m1_6306: bitstring = dec(em1_6304,skSess_6115) in
                                                                {8095}if (verify(m1_6306,sigM1_6305,pkCli_6254) <> true) then
                                                                    0
                                                                else
                                                                    {8096}let (SPc_6307: bitstring,PartC_6308: bitstring) = m1_6306 in
                                                                    {8097}event endSrv(Cli_5168,Sess_5170,PartC_6308);
                                                                    {8098}new Ns_6309: bitstring;
                                                                    {8099}let gNs_6310: bitstring = exp(g,Ns_6309) in
                                                                    {8100}let m2_6311: bitstring = gNs_6310 in
                                                                    {8101}out(c, (enc(m2_6311,pkCli_6254),sign(m2_6311,skSess_6115)));
                                                                    {8102}event beginSrv(Sess_5170,Cli_5168,gNs_6310)
                                                    )
                                                    else
                                                        {8103}let pkDisco_6312: bitstring = fail-any in
                                                        {8104}in(c, (=pkCli_6254,em1_6313: bitstring,sigM1_6314: bitstring));
                                                        {8105}let m1_6315: bitstring = dec(em1_6313,skSess_6115) in
                                                        {8106}if (verify(m1_6315,sigM1_6314,pkCli_6254) <> true) then
                                                            0
                                                        else
                                                            {8107}let (SPc_6316: bitstring,PartC_6317: bitstring) = m1_6315 in
                                                            {8108}event endSrv(Cli_5168,Sess_5170,PartC_6317);
                                                            {8109}new Ns_6318: bitstring;
                                                            {8110}let gNs_6319: bitstring = exp(g,Ns_6318) in
                                                            {8111}let m2_6320: bitstring = gNs_6319 in
                                                            {8112}out(c, (enc(m2_6320,pkCli_6254),sign(m2_6320,skSess_6115)));
                                                            {8113}event beginSrv(Sess_5170,Cli_5168,gNs_6319)
                                                )
                                                else
                                                    {8114}let pkCli_6321: bitstring = pub(skI) in
                                                    {8115}let v_6322: bool = (Disco_5169 = A) in
                                                    (
                                                        {8116}if v_6322 then
                                                        (
                                                            {8117}let pkDisco_6323: bitstring = pub(skA) in
                                                            {8118}in(c, (=pkCli_6321,em1_6324: bitstring,sigM1_6325: bitstring));
                                                            {8119}let m1_6326: bitstring = dec(em1_6324,skSess_6115) in
                                                            {8120}if (verify(m1_6326,sigM1_6325,pkCli_6321) <> true) then
                                                                0
                                                            else
                                                                {8121}let (SPc_6327: bitstring,PartC_6328: bitstring) = m1_6326 in
                                                                {8122}event endSrv(Cli_5168,Sess_5170,PartC_6328);
                                                                {8123}new Ns_6329: bitstring;
                                                                {8124}let gNs_6330: bitstring = exp(g,Ns_6329) in
                                                                {8125}let m2_6331: bitstring = gNs_6330 in
                                                                {8126}out(c, (enc(m2_6331,pkCli_6321),sign(m2_6331,skSess_6115)));
                                                                {8127}event beginSrv(Sess_5170,Cli_5168,gNs_6330)
                                                        )
                                                        else
                                                            {8128}let v_6332: bool = (Disco_5169 = B) in
                                                            (
                                                                {8129}if v_6332 then
                                                                (
                                                                    {8130}let pkDisco_6333: bitstring = pub(skB) in
                                                                    {8131}in(c, (=pkCli_6321,em1_6334: bitstring,sigM1_6335: bitstring));
                                                                    {8132}let m1_6336: bitstring = dec(em1_6334,skSess_6115) in
                                                                    {8133}if (verify(m1_6336,sigM1_6335,pkCli_6321) <> true) then
                                                                        0
                                                                    else
                                                                        {8134}let (SPc_6337: bitstring,PartC_6338: bitstring) = m1_6336 in
                                                                        {8135}event endSrv(Cli_5168,Sess_5170,PartC_6338);
                                                                        {8136}new Ns_6339: bitstring;
                                                                        {8137}let gNs_6340: bitstring = exp(g,Ns_6339) in
                                                                        {8138}let m2_6341: bitstring = gNs_6340 in
                                                                        {8139}out(c, (enc(m2_6341,pkCli_6321),sign(m2_6341,skSess_6115)));
                                                                        {8140}event beginSrv(Sess_5170,Cli_5168,gNs_6340)
                                                                )
                                                                else
                                                                    {8141}let v_6342: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {8142}if v_6342 then
                                                                        (
                                                                            {8143}let pkDisco_6343: bitstring = pub(skC) in
                                                                            {8144}in(c, (=pkCli_6321,em1_6344: bitstring,sigM1_6345: bitstring));
                                                                            {8145}let m1_6346: bitstring = dec(em1_6344,skSess_6115) in
                                                                            {8146}if (verify(m1_6346,sigM1_6345,pkCli_6321) <> true) then
                                                                                0
                                                                            else
                                                                                {8147}let (SPc_6347: bitstring,PartC_6348: bitstring) = m1_6346 in
                                                                                {8148}event endSrv(Cli_5168,Sess_5170,PartC_6348);
                                                                                {8149}new Ns_6349: bitstring;
                                                                                {8150}let gNs_6350: bitstring = exp(g,Ns_6349) in
                                                                                {8151}let m2_6351: bitstring = gNs_6350 in
                                                                                {8152}out(c, (enc(m2_6351,pkCli_6321),sign(m2_6351,skSess_6115)));
                                                                                {8153}event beginSrv(Sess_5170,Cli_5168,gNs_6350)
                                                                        )
                                                                        else
                                                                            {8154}let pkDisco_6352: bitstring = pub(skI) in
                                                                            {8155}in(c, (=pkCli_6321,em1_6353: bitstring,sigM1_6354: bitstring));
                                                                            {8156}let m1_6355: bitstring = dec(em1_6353,skSess_6115) in
                                                                            {8157}if (verify(m1_6355,sigM1_6354,pkCli_6321) <> true) then
                                                                                0
                                                                            else
                                                                                {8158}let (SPc_6356: bitstring,PartC_6357: bitstring) = m1_6355 in
                                                                                {8159}event endSrv(Cli_5168,Sess_5170,PartC_6357);
                                                                                {8160}new Ns_6358: bitstring;
                                                                                {8161}let gNs_6359: bitstring = exp(g,Ns_6358) in
                                                                                {8162}let m2_6360: bitstring = gNs_6359 in
                                                                                {8163}out(c, (enc(m2_6360,pkCli_6321),sign(m2_6360,skSess_6115)));
                                                                                {8164}event beginSrv(Sess_5170,Cli_5168,gNs_6359)
                                                                    )
                                                                    else
                                                                        {8165}let pkDisco_6361: bitstring = fail-any in
                                                                        {8166}in(c, (=pkCli_6321,em1_6362: bitstring,sigM1_6363: bitstring));
                                                                        {8167}let m1_6364: bitstring = dec(em1_6362,skSess_6115) in
                                                                        {8168}if (verify(m1_6364,sigM1_6363,pkCli_6321) <> true) then
                                                                            0
                                                                        else
                                                                            {8169}let (SPc_6365: bitstring,PartC_6366: bitstring) = m1_6364 in
                                                                            {8170}event endSrv(Cli_5168,Sess_5170,PartC_6366);
                                                                            {8171}new Ns_6367: bitstring;
                                                                            {8172}let gNs_6368: bitstring = exp(g,Ns_6367) in
                                                                            {8173}let m2_6369: bitstring = gNs_6368 in
                                                                            {8174}out(c, (enc(m2_6369,pkCli_6321),sign(m2_6369,skSess_6115)));
                                                                            {8175}event beginSrv(Sess_5170,Cli_5168,gNs_6368)
                                                            )
                                                            else
                                                                {8176}let pkDisco_6370: bitstring = fail-any in
                                                                {8177}in(c, (=pkCli_6321,em1_6371: bitstring,sigM1_6372: bitstring));
                                                                {8178}let m1_6373: bitstring = dec(em1_6371,skSess_6115) in
                                                                {8179}if (verify(m1_6373,sigM1_6372,pkCli_6321) <> true) then
                                                                    0
                                                                else
                                                                    {8180}let (SPc_6374: bitstring,PartC_6375: bitstring) = m1_6373 in
                                                                    {8181}event endSrv(Cli_5168,Sess_5170,PartC_6375);
                                                                    {8182}new Ns_6376: bitstring;
                                                                    {8183}let gNs_6377: bitstring = exp(g,Ns_6376) in
                                                                    {8184}let m2_6378: bitstring = gNs_6377 in
                                                                    {8185}out(c, (enc(m2_6378,pkCli_6321),sign(m2_6378,skSess_6115)));
                                                                    {8186}event beginSrv(Sess_5170,Cli_5168,gNs_6377)
                                                    )
                                                    else
                                                        {8187}let pkDisco_6379: bitstring = fail-any in
                                                        {8188}in(c, (=pkCli_6321,em1_6380: bitstring,sigM1_6381: bitstring));
                                                        {8189}let m1_6382: bitstring = dec(em1_6380,skSess_6115) in
                                                        {8190}if (verify(m1_6382,sigM1_6381,pkCli_6321) <> true) then
                                                            0
                                                        else
                                                            {8191}let (SPc_6383: bitstring,PartC_6384: bitstring) = m1_6382 in
                                                            {8192}event endSrv(Cli_5168,Sess_5170,PartC_6384);
                                                            {8193}new Ns_6385: bitstring;
                                                            {8194}let gNs_6386: bitstring = exp(g,Ns_6385) in
                                                            {8195}let m2_6387: bitstring = gNs_6386 in
                                                            {8196}out(c, (enc(m2_6387,pkCli_6321),sign(m2_6387,skSess_6115)));
                                                            {8197}event beginSrv(Sess_5170,Cli_5168,gNs_6386)
                                            )
                                            else
                                                {8198}let pkCli_6388: bitstring = fail-any in
                                                {8199}let v_6389: bool = (Disco_5169 = A) in
                                                (
                                                    {8200}if v_6389 then
                                                    (
                                                        {8201}let pkDisco_6390: bitstring = pub(skA) in
                                                        {8202}in(c, (=pkCli_6388,em1_6391: bitstring,sigM1_6392: bitstring));
                                                        {8203}let m1_6393: bitstring = dec(em1_6391,skSess_6115) in
                                                        {8204}if (verify(m1_6393,sigM1_6392,pkCli_6388) <> true) then
                                                            0
                                                        else
                                                            {8205}let (SPc_6394: bitstring,PartC_6395: bitstring) = m1_6393 in
                                                            {8206}event endSrv(Cli_5168,Sess_5170,PartC_6395);
                                                            {8207}new Ns_6396: bitstring;
                                                            {8208}let gNs_6397: bitstring = exp(g,Ns_6396) in
                                                            {8209}let m2_6398: bitstring = gNs_6397 in
                                                            {8210}out(c, (enc(m2_6398,pkCli_6388),sign(m2_6398,skSess_6115)));
                                                            {8211}event beginSrv(Sess_5170,Cli_5168,gNs_6397)
                                                    )
                                                    else
                                                        {8212}let v_6399: bool = (Disco_5169 = B) in
                                                        (
                                                            {8213}if v_6399 then
                                                            (
                                                                {8214}let pkDisco_6400: bitstring = pub(skB) in
                                                                {8215}in(c, (=pkCli_6388,em1_6401: bitstring,sigM1_6402: bitstring));
                                                                {8216}let m1_6403: bitstring = dec(em1_6401,skSess_6115) in
                                                                {8217}if (verify(m1_6403,sigM1_6402,pkCli_6388) <> true) then
                                                                    0
                                                                else
                                                                    {8218}let (SPc_6404: bitstring,PartC_6405: bitstring) = m1_6403 in
                                                                    {8219}event endSrv(Cli_5168,Sess_5170,PartC_6405);
                                                                    {8220}new Ns_6406: bitstring;
                                                                    {8221}let gNs_6407: bitstring = exp(g,Ns_6406) in
                                                                    {8222}let m2_6408: bitstring = gNs_6407 in
                                                                    {8223}out(c, (enc(m2_6408,pkCli_6388),sign(m2_6408,skSess_6115)));
                                                                    {8224}event beginSrv(Sess_5170,Cli_5168,gNs_6407)
                                                            )
                                                            else
                                                                {8225}let v_6409: bool = (Disco_5169 = C) in
                                                                (
                                                                    {8226}if v_6409 then
                                                                    (
                                                                        {8227}let pkDisco_6410: bitstring = pub(skC) in
                                                                        {8228}in(c, (=pkCli_6388,em1_6411: bitstring,sigM1_6412: bitstring));
                                                                        {8229}let m1_6413: bitstring = dec(em1_6411,skSess_6115) in
                                                                        {8230}if (verify(m1_6413,sigM1_6412,pkCli_6388) <> true) then
                                                                            0
                                                                        else
                                                                            {8231}let (SPc_6414: bitstring,PartC_6415: bitstring) = m1_6413 in
                                                                            {8232}event endSrv(Cli_5168,Sess_5170,PartC_6415);
                                                                            {8233}new Ns_6416: bitstring;
                                                                            {8234}let gNs_6417: bitstring = exp(g,Ns_6416) in
                                                                            {8235}let m2_6418: bitstring = gNs_6417 in
                                                                            {8236}out(c, (enc(m2_6418,pkCli_6388),sign(m2_6418,skSess_6115)));
                                                                            {8237}event beginSrv(Sess_5170,Cli_5168,gNs_6417)
                                                                    )
                                                                    else
                                                                        {8238}let pkDisco_6419: bitstring = pub(skI) in
                                                                        {8239}in(c, (=pkCli_6388,em1_6420: bitstring,sigM1_6421: bitstring));
                                                                        {8240}let m1_6422: bitstring = dec(em1_6420,skSess_6115) in
                                                                        {8241}if (verify(m1_6422,sigM1_6421,pkCli_6388) <> true) then
                                                                            0
                                                                        else
                                                                            {8242}let (SPc_6423: bitstring,PartC_6424: bitstring) = m1_6422 in
                                                                            {8243}event endSrv(Cli_5168,Sess_5170,PartC_6424);
                                                                            {8244}new Ns_6425: bitstring;
                                                                            {8245}let gNs_6426: bitstring = exp(g,Ns_6425) in
                                                                            {8246}let m2_6427: bitstring = gNs_6426 in
                                                                            {8247}out(c, (enc(m2_6427,pkCli_6388),sign(m2_6427,skSess_6115)));
                                                                            {8248}event beginSrv(Sess_5170,Cli_5168,gNs_6426)
                                                                )
                                                                else
                                                                    {8249}let pkDisco_6428: bitstring = fail-any in
                                                                    {8250}in(c, (=pkCli_6388,em1_6429: bitstring,sigM1_6430: bitstring));
                                                                    {8251}let m1_6431: bitstring = dec(em1_6429,skSess_6115) in
                                                                    {8252}if (verify(m1_6431,sigM1_6430,pkCli_6388) <> true) then
                                                                        0
                                                                    else
                                                                        {8253}let (SPc_6432: bitstring,PartC_6433: bitstring) = m1_6431 in
                                                                        {8254}event endSrv(Cli_5168,Sess_5170,PartC_6433);
                                                                        {8255}new Ns_6434: bitstring;
                                                                        {8256}let gNs_6435: bitstring = exp(g,Ns_6434) in
                                                                        {8257}let m2_6436: bitstring = gNs_6435 in
                                                                        {8258}out(c, (enc(m2_6436,pkCli_6388),sign(m2_6436,skSess_6115)));
                                                                        {8259}event beginSrv(Sess_5170,Cli_5168,gNs_6435)
                                                        )
                                                        else
                                                            {8260}let pkDisco_6437: bitstring = fail-any in
                                                            {8261}in(c, (=pkCli_6388,em1_6438: bitstring,sigM1_6439: bitstring));
                                                            {8262}let m1_6440: bitstring = dec(em1_6438,skSess_6115) in
                                                            {8263}if (verify(m1_6440,sigM1_6439,pkCli_6388) <> true) then
                                                                0
                                                            else
                                                                {8264}let (SPc_6441: bitstring,PartC_6442: bitstring) = m1_6440 in
                                                                {8265}event endSrv(Cli_5168,Sess_5170,PartC_6442);
                                                                {8266}new Ns_6443: bitstring;
                                                                {8267}let gNs_6444: bitstring = exp(g,Ns_6443) in
                                                                {8268}let m2_6445: bitstring = gNs_6444 in
                                                                {8269}out(c, (enc(m2_6445,pkCli_6388),sign(m2_6445,skSess_6115)));
                                                                {8270}event beginSrv(Sess_5170,Cli_5168,gNs_6444)
                                                )
                                                else
                                                    {8271}let pkDisco_6446: bitstring = fail-any in
                                                    {8272}in(c, (=pkCli_6388,em1_6447: bitstring,sigM1_6448: bitstring));
                                                    {8273}let m1_6449: bitstring = dec(em1_6447,skSess_6115) in
                                                    {8274}if (verify(m1_6449,sigM1_6448,pkCli_6388) <> true) then
                                                        0
                                                    else
                                                        {8275}let (SPc_6450: bitstring,PartC_6451: bitstring) = m1_6449 in
                                                        {8276}event endSrv(Cli_5168,Sess_5170,PartC_6451);
                                                        {8277}new Ns_6452: bitstring;
                                                        {8278}let gNs_6453: bitstring = exp(g,Ns_6452) in
                                                        {8279}let m2_6454: bitstring = gNs_6453 in
                                                        {8280}out(c, (enc(m2_6454,pkCli_6388),sign(m2_6454,skSess_6115)));
                                                        {8281}event beginSrv(Sess_5170,Cli_5168,gNs_6453)
                                    )
                                    else
                                        {8282}let pkCli_6455: bitstring = fail-any in
                                        {8283}let v_6456: bool = (Disco_5169 = A) in
                                        (
                                            {8284}if v_6456 then
                                            (
                                                {8285}let pkDisco_6457: bitstring = pub(skA) in
                                                {8286}in(c, (=pkCli_6455,em1_6458: bitstring,sigM1_6459: bitstring));
                                                {8287}let m1_6460: bitstring = dec(em1_6458,skSess_6115) in
                                                {8288}if (verify(m1_6460,sigM1_6459,pkCli_6455) <> true) then
                                                    0
                                                else
                                                    {8289}let (SPc_6461: bitstring,PartC_6462: bitstring) = m1_6460 in
                                                    {8290}event endSrv(Cli_5168,Sess_5170,PartC_6462);
                                                    {8291}new Ns_6463: bitstring;
                                                    {8292}let gNs_6464: bitstring = exp(g,Ns_6463) in
                                                    {8293}let m2_6465: bitstring = gNs_6464 in
                                                    {8294}out(c, (enc(m2_6465,pkCli_6455),sign(m2_6465,skSess_6115)));
                                                    {8295}event beginSrv(Sess_5170,Cli_5168,gNs_6464)
                                            )
                                            else
                                                {8296}let v_6466: bool = (Disco_5169 = B) in
                                                (
                                                    {8297}if v_6466 then
                                                    (
                                                        {8298}let pkDisco_6467: bitstring = pub(skB) in
                                                        {8299}in(c, (=pkCli_6455,em1_6468: bitstring,sigM1_6469: bitstring));
                                                        {8300}let m1_6470: bitstring = dec(em1_6468,skSess_6115) in
                                                        {8301}if (verify(m1_6470,sigM1_6469,pkCli_6455) <> true) then
                                                            0
                                                        else
                                                            {8302}let (SPc_6471: bitstring,PartC_6472: bitstring) = m1_6470 in
                                                            {8303}event endSrv(Cli_5168,Sess_5170,PartC_6472);
                                                            {8304}new Ns_6473: bitstring;
                                                            {8305}let gNs_6474: bitstring = exp(g,Ns_6473) in
                                                            {8306}let m2_6475: bitstring = gNs_6474 in
                                                            {8307}out(c, (enc(m2_6475,pkCli_6455),sign(m2_6475,skSess_6115)));
                                                            {8308}event beginSrv(Sess_5170,Cli_5168,gNs_6474)
                                                    )
                                                    else
                                                        {8309}let v_6476: bool = (Disco_5169 = C) in
                                                        (
                                                            {8310}if v_6476 then
                                                            (
                                                                {8311}let pkDisco_6477: bitstring = pub(skC) in
                                                                {8312}in(c, (=pkCli_6455,em1_6478: bitstring,sigM1_6479: bitstring));
                                                                {8313}let m1_6480: bitstring = dec(em1_6478,skSess_6115) in
                                                                {8314}if (verify(m1_6480,sigM1_6479,pkCli_6455) <> true) then
                                                                    0
                                                                else
                                                                    {8315}let (SPc_6481: bitstring,PartC_6482: bitstring) = m1_6480 in
                                                                    {8316}event endSrv(Cli_5168,Sess_5170,PartC_6482);
                                                                    {8317}new Ns_6483: bitstring;
                                                                    {8318}let gNs_6484: bitstring = exp(g,Ns_6483) in
                                                                    {8319}let m2_6485: bitstring = gNs_6484 in
                                                                    {8320}out(c, (enc(m2_6485,pkCli_6455),sign(m2_6485,skSess_6115)));
                                                                    {8321}event beginSrv(Sess_5170,Cli_5168,gNs_6484)
                                                            )
                                                            else
                                                                {8322}let pkDisco_6486: bitstring = pub(skI) in
                                                                {8323}in(c, (=pkCli_6455,em1_6487: bitstring,sigM1_6488: bitstring));
                                                                {8324}let m1_6489: bitstring = dec(em1_6487,skSess_6115) in
                                                                {8325}if (verify(m1_6489,sigM1_6488,pkCli_6455) <> true) then
                                                                    0
                                                                else
                                                                    {8326}let (SPc_6490: bitstring,PartC_6491: bitstring) = m1_6489 in
                                                                    {8327}event endSrv(Cli_5168,Sess_5170,PartC_6491);
                                                                    {8328}new Ns_6492: bitstring;
                                                                    {8329}let gNs_6493: bitstring = exp(g,Ns_6492) in
                                                                    {8330}let m2_6494: bitstring = gNs_6493 in
                                                                    {8331}out(c, (enc(m2_6494,pkCli_6455),sign(m2_6494,skSess_6115)));
                                                                    {8332}event beginSrv(Sess_5170,Cli_5168,gNs_6493)
                                                        )
                                                        else
                                                            {8333}let pkDisco_6495: bitstring = fail-any in
                                                            {8334}in(c, (=pkCli_6455,em1_6496: bitstring,sigM1_6497: bitstring));
                                                            {8335}let m1_6498: bitstring = dec(em1_6496,skSess_6115) in
                                                            {8336}if (verify(m1_6498,sigM1_6497,pkCli_6455) <> true) then
                                                                0
                                                            else
                                                                {8337}let (SPc_6499: bitstring,PartC_6500: bitstring) = m1_6498 in
                                                                {8338}event endSrv(Cli_5168,Sess_5170,PartC_6500);
                                                                {8339}new Ns_6501: bitstring;
                                                                {8340}let gNs_6502: bitstring = exp(g,Ns_6501) in
                                                                {8341}let m2_6503: bitstring = gNs_6502 in
                                                                {8342}out(c, (enc(m2_6503,pkCli_6455),sign(m2_6503,skSess_6115)));
                                                                {8343}event beginSrv(Sess_5170,Cli_5168,gNs_6502)
                                                )
                                                else
                                                    {8344}let pkDisco_6504: bitstring = fail-any in
                                                    {8345}in(c, (=pkCli_6455,em1_6505: bitstring,sigM1_6506: bitstring));
                                                    {8346}let m1_6507: bitstring = dec(em1_6505,skSess_6115) in
                                                    {8347}if (verify(m1_6507,sigM1_6506,pkCli_6455) <> true) then
                                                        0
                                                    else
                                                        {8348}let (SPc_6508: bitstring,PartC_6509: bitstring) = m1_6507 in
                                                        {8349}event endSrv(Cli_5168,Sess_5170,PartC_6509);
                                                        {8350}new Ns_6510: bitstring;
                                                        {8351}let gNs_6511: bitstring = exp(g,Ns_6510) in
                                                        {8352}let m2_6512: bitstring = gNs_6511 in
                                                        {8353}out(c, (enc(m2_6512,pkCli_6455),sign(m2_6512,skSess_6115)));
                                                        {8354}event beginSrv(Sess_5170,Cli_5168,gNs_6511)
                                        )
                                        else
                                            {8355}let pkDisco_6513: bitstring = fail-any in
                                            {8356}in(c, (=pkCli_6455,em1_6514: bitstring,sigM1_6515: bitstring));
                                            {8357}let m1_6516: bitstring = dec(em1_6514,skSess_6115) in
                                            {8358}if (verify(m1_6516,sigM1_6515,pkCli_6455) <> true) then
                                                0
                                            else
                                                {8359}let (SPc_6517: bitstring,PartC_6518: bitstring) = m1_6516 in
                                                {8360}event endSrv(Cli_5168,Sess_5170,PartC_6518);
                                                {8361}new Ns_6519: bitstring;
                                                {8362}let gNs_6520: bitstring = exp(g,Ns_6519) in
                                                {8363}let m2_6521: bitstring = gNs_6520 in
                                                {8364}out(c, (enc(m2_6521,pkCli_6455),sign(m2_6521,skSess_6115)));
                                                {8365}event beginSrv(Sess_5170,Cli_5168,gNs_6520)
                            )
                            else
                                {8366}let pkCli_6522: bitstring = fail-any in
                                {8367}let v_6523: bool = (Disco_5169 = A) in
                                (
                                    {8368}if v_6523 then
                                    (
                                        {8369}let pkDisco_6524: bitstring = pub(skA) in
                                        {8370}in(c, (=pkCli_6522,em1_6525: bitstring,sigM1_6526: bitstring));
                                        {8371}let m1_6527: bitstring = dec(em1_6525,skSess_6115) in
                                        {8372}if (verify(m1_6527,sigM1_6526,pkCli_6522) <> true) then
                                            0
                                        else
                                            {8373}let (SPc_6528: bitstring,PartC_6529: bitstring) = m1_6527 in
                                            {8374}event endSrv(Cli_5168,Sess_5170,PartC_6529);
                                            {8375}new Ns_6530: bitstring;
                                            {8376}let gNs_6531: bitstring = exp(g,Ns_6530) in
                                            {8377}let m2_6532: bitstring = gNs_6531 in
                                            {8378}out(c, (enc(m2_6532,pkCli_6522),sign(m2_6532,skSess_6115)));
                                            {8379}event beginSrv(Sess_5170,Cli_5168,gNs_6531)
                                    )
                                    else
                                        {8380}let v_6533: bool = (Disco_5169 = B) in
                                        (
                                            {8381}if v_6533 then
                                            (
                                                {8382}let pkDisco_6534: bitstring = pub(skB) in
                                                {8383}in(c, (=pkCli_6522,em1_6535: bitstring,sigM1_6536: bitstring));
                                                {8384}let m1_6537: bitstring = dec(em1_6535,skSess_6115) in
                                                {8385}if (verify(m1_6537,sigM1_6536,pkCli_6522) <> true) then
                                                    0
                                                else
                                                    {8386}let (SPc_6538: bitstring,PartC_6539: bitstring) = m1_6537 in
                                                    {8387}event endSrv(Cli_5168,Sess_5170,PartC_6539);
                                                    {8388}new Ns_6540: bitstring;
                                                    {8389}let gNs_6541: bitstring = exp(g,Ns_6540) in
                                                    {8390}let m2_6542: bitstring = gNs_6541 in
                                                    {8391}out(c, (enc(m2_6542,pkCli_6522),sign(m2_6542,skSess_6115)));
                                                    {8392}event beginSrv(Sess_5170,Cli_5168,gNs_6541)
                                            )
                                            else
                                                {8393}let v_6543: bool = (Disco_5169 = C) in
                                                (
                                                    {8394}if v_6543 then
                                                    (
                                                        {8395}let pkDisco_6544: bitstring = pub(skC) in
                                                        {8396}in(c, (=pkCli_6522,em1_6545: bitstring,sigM1_6546: bitstring));
                                                        {8397}let m1_6547: bitstring = dec(em1_6545,skSess_6115) in
                                                        {8398}if (verify(m1_6547,sigM1_6546,pkCli_6522) <> true) then
                                                            0
                                                        else
                                                            {8399}let (SPc_6548: bitstring,PartC_6549: bitstring) = m1_6547 in
                                                            {8400}event endSrv(Cli_5168,Sess_5170,PartC_6549);
                                                            {8401}new Ns_6550: bitstring;
                                                            {8402}let gNs_6551: bitstring = exp(g,Ns_6550) in
                                                            {8403}let m2_6552: bitstring = gNs_6551 in
                                                            {8404}out(c, (enc(m2_6552,pkCli_6522),sign(m2_6552,skSess_6115)));
                                                            {8405}event beginSrv(Sess_5170,Cli_5168,gNs_6551)
                                                    )
                                                    else
                                                        {8406}let pkDisco_6553: bitstring = pub(skI) in
                                                        {8407}in(c, (=pkCli_6522,em1_6554: bitstring,sigM1_6555: bitstring));
                                                        {8408}let m1_6556: bitstring = dec(em1_6554,skSess_6115) in
                                                        {8409}if (verify(m1_6556,sigM1_6555,pkCli_6522) <> true) then
                                                            0
                                                        else
                                                            {8410}let (SPc_6557: bitstring,PartC_6558: bitstring) = m1_6556 in
                                                            {8411}event endSrv(Cli_5168,Sess_5170,PartC_6558);
                                                            {8412}new Ns_6559: bitstring;
                                                            {8413}let gNs_6560: bitstring = exp(g,Ns_6559) in
                                                            {8414}let m2_6561: bitstring = gNs_6560 in
                                                            {8415}out(c, (enc(m2_6561,pkCli_6522),sign(m2_6561,skSess_6115)));
                                                            {8416}event beginSrv(Sess_5170,Cli_5168,gNs_6560)
                                                )
                                                else
                                                    {8417}let pkDisco_6562: bitstring = fail-any in
                                                    {8418}in(c, (=pkCli_6522,em1_6563: bitstring,sigM1_6564: bitstring));
                                                    {8419}let m1_6565: bitstring = dec(em1_6563,skSess_6115) in
                                                    {8420}if (verify(m1_6565,sigM1_6564,pkCli_6522) <> true) then
                                                        0
                                                    else
                                                        {8421}let (SPc_6566: bitstring,PartC_6567: bitstring) = m1_6565 in
                                                        {8422}event endSrv(Cli_5168,Sess_5170,PartC_6567);
                                                        {8423}new Ns_6568: bitstring;
                                                        {8424}let gNs_6569: bitstring = exp(g,Ns_6568) in
                                                        {8425}let m2_6570: bitstring = gNs_6569 in
                                                        {8426}out(c, (enc(m2_6570,pkCli_6522),sign(m2_6570,skSess_6115)));
                                                        {8427}event beginSrv(Sess_5170,Cli_5168,gNs_6569)
                                        )
                                        else
                                            {8428}let pkDisco_6571: bitstring = fail-any in
                                            {8429}in(c, (=pkCli_6522,em1_6572: bitstring,sigM1_6573: bitstring));
                                            {8430}let m1_6574: bitstring = dec(em1_6572,skSess_6115) in
                                            {8431}if (verify(m1_6574,sigM1_6573,pkCli_6522) <> true) then
                                                0
                                            else
                                                {8432}let (SPc_6575: bitstring,PartC_6576: bitstring) = m1_6574 in
                                                {8433}event endSrv(Cli_5168,Sess_5170,PartC_6576);
                                                {8434}new Ns_6577: bitstring;
                                                {8435}let gNs_6578: bitstring = exp(g,Ns_6577) in
                                                {8436}let m2_6579: bitstring = gNs_6578 in
                                                {8437}out(c, (enc(m2_6579,pkCli_6522),sign(m2_6579,skSess_6115)));
                                                {8438}event beginSrv(Sess_5170,Cli_5168,gNs_6578)
                                )
                                else
                                    {8439}let pkDisco_6580: bitstring = fail-any in
                                    {8440}in(c, (=pkCli_6522,em1_6581: bitstring,sigM1_6582: bitstring));
                                    {8441}let m1_6583: bitstring = dec(em1_6581,skSess_6115) in
                                    {8442}if (verify(m1_6583,sigM1_6582,pkCli_6522) <> true) then
                                        0
                                    else
                                        {8443}let (SPc_6584: bitstring,PartC_6585: bitstring) = m1_6583 in
                                        {8444}event endSrv(Cli_5168,Sess_5170,PartC_6585);
                                        {8445}new Ns_6586: bitstring;
                                        {8446}let gNs_6587: bitstring = exp(g,Ns_6586) in
                                        {8447}let m2_6588: bitstring = gNs_6587 in
                                        {8448}out(c, (enc(m2_6588,pkCli_6522),sign(m2_6588,skSess_6115)));
                                        {8449}event beginSrv(Sess_5170,Cli_5168,gNs_6587)
                        )
                        else
                            {8450}let skSess_6589: bitstring = skI in
                            {8451}let pkSess_6590: bitstring = pub(skSess_6589) in
                            {8452}let v_6591: bool = (Cli_5168 = A) in
                            (
                                {8453}if v_6591 then
                                (
                                    {8454}let pkCli_6592: bitstring = pub(skA) in
                                    {8455}let v_6593: bool = (Disco_5169 = A) in
                                    (
                                        {8456}if v_6593 then
                                        (
                                            {8457}let pkDisco_6594: bitstring = pub(skA) in
                                            {8458}in(c, (=pkCli_6592,em1_6595: bitstring,sigM1_6596: bitstring));
                                            {8459}let m1_6597: bitstring = dec(em1_6595,skSess_6589) in
                                            {8460}if (verify(m1_6597,sigM1_6596,pkCli_6592) <> true) then
                                                0
                                            else
                                                {8461}let (SPc_6598: bitstring,PartC_6599: bitstring) = m1_6597 in
                                                {8462}event endSrv(Cli_5168,Sess_5170,PartC_6599);
                                                {8463}new Ns_6600: bitstring;
                                                {8464}let gNs_6601: bitstring = exp(g,Ns_6600) in
                                                {8465}let m2_6602: bitstring = gNs_6601 in
                                                {8466}out(c, (enc(m2_6602,pkCli_6592),sign(m2_6602,skSess_6589)));
                                                {8467}event beginSrv(Sess_5170,Cli_5168,gNs_6601)
                                        )
                                        else
                                            {8468}let v_6603: bool = (Disco_5169 = B) in
                                            (
                                                {8469}if v_6603 then
                                                (
                                                    {8470}let pkDisco_6604: bitstring = pub(skB) in
                                                    {8471}in(c, (=pkCli_6592,em1_6605: bitstring,sigM1_6606: bitstring));
                                                    {8472}let m1_6607: bitstring = dec(em1_6605,skSess_6589) in
                                                    {8473}if (verify(m1_6607,sigM1_6606,pkCli_6592) <> true) then
                                                        0
                                                    else
                                                        {8474}let (SPc_6608: bitstring,PartC_6609: bitstring) = m1_6607 in
                                                        {8475}event endSrv(Cli_5168,Sess_5170,PartC_6609);
                                                        {8476}new Ns_6610: bitstring;
                                                        {8477}let gNs_6611: bitstring = exp(g,Ns_6610) in
                                                        {8478}let m2_6612: bitstring = gNs_6611 in
                                                        {8479}out(c, (enc(m2_6612,pkCli_6592),sign(m2_6612,skSess_6589)));
                                                        {8480}event beginSrv(Sess_5170,Cli_5168,gNs_6611)
                                                )
                                                else
                                                    {8481}let v_6613: bool = (Disco_5169 = C) in
                                                    (
                                                        {8482}if v_6613 then
                                                        (
                                                            {8483}let pkDisco_6614: bitstring = pub(skC) in
                                                            {8484}in(c, (=pkCli_6592,em1_6615: bitstring,sigM1_6616: bitstring));
                                                            {8485}let m1_6617: bitstring = dec(em1_6615,skSess_6589) in
                                                            {8486}if (verify(m1_6617,sigM1_6616,pkCli_6592) <> true) then
                                                                0
                                                            else
                                                                {8487}let (SPc_6618: bitstring,PartC_6619: bitstring) = m1_6617 in
                                                                {8488}event endSrv(Cli_5168,Sess_5170,PartC_6619);
                                                                {8489}new Ns_6620: bitstring;
                                                                {8490}let gNs_6621: bitstring = exp(g,Ns_6620) in
                                                                {8491}let m2_6622: bitstring = gNs_6621 in
                                                                {8492}out(c, (enc(m2_6622,pkCli_6592),sign(m2_6622,skSess_6589)));
                                                                {8493}event beginSrv(Sess_5170,Cli_5168,gNs_6621)
                                                        )
                                                        else
                                                            {8494}let pkDisco_6623: bitstring = pub(skI) in
                                                            {8495}in(c, (=pkCli_6592,em1_6624: bitstring,sigM1_6625: bitstring));
                                                            {8496}let m1_6626: bitstring = dec(em1_6624,skSess_6589) in
                                                            {8497}if (verify(m1_6626,sigM1_6625,pkCli_6592) <> true) then
                                                                0
                                                            else
                                                                {8498}let (SPc_6627: bitstring,PartC_6628: bitstring) = m1_6626 in
                                                                {8499}event endSrv(Cli_5168,Sess_5170,PartC_6628);
                                                                {8500}new Ns_6629: bitstring;
                                                                {8501}let gNs_6630: bitstring = exp(g,Ns_6629) in
                                                                {8502}let m2_6631: bitstring = gNs_6630 in
                                                                {8503}out(c, (enc(m2_6631,pkCli_6592),sign(m2_6631,skSess_6589)));
                                                                {8504}event beginSrv(Sess_5170,Cli_5168,gNs_6630)
                                                    )
                                                    else
                                                        {8505}let pkDisco_6632: bitstring = fail-any in
                                                        {8506}in(c, (=pkCli_6592,em1_6633: bitstring,sigM1_6634: bitstring));
                                                        {8507}let m1_6635: bitstring = dec(em1_6633,skSess_6589) in
                                                        {8508}if (verify(m1_6635,sigM1_6634,pkCli_6592) <> true) then
                                                            0
                                                        else
                                                            {8509}let (SPc_6636: bitstring,PartC_6637: bitstring) = m1_6635 in
                                                            {8510}event endSrv(Cli_5168,Sess_5170,PartC_6637);
                                                            {8511}new Ns_6638: bitstring;
                                                            {8512}let gNs_6639: bitstring = exp(g,Ns_6638) in
                                                            {8513}let m2_6640: bitstring = gNs_6639 in
                                                            {8514}out(c, (enc(m2_6640,pkCli_6592),sign(m2_6640,skSess_6589)));
                                                            {8515}event beginSrv(Sess_5170,Cli_5168,gNs_6639)
                                            )
                                            else
                                                {8516}let pkDisco_6641: bitstring = fail-any in
                                                {8517}in(c, (=pkCli_6592,em1_6642: bitstring,sigM1_6643: bitstring));
                                                {8518}let m1_6644: bitstring = dec(em1_6642,skSess_6589) in
                                                {8519}if (verify(m1_6644,sigM1_6643,pkCli_6592) <> true) then
                                                    0
                                                else
                                                    {8520}let (SPc_6645: bitstring,PartC_6646: bitstring) = m1_6644 in
                                                    {8521}event endSrv(Cli_5168,Sess_5170,PartC_6646);
                                                    {8522}new Ns_6647: bitstring;
                                                    {8523}let gNs_6648: bitstring = exp(g,Ns_6647) in
                                                    {8524}let m2_6649: bitstring = gNs_6648 in
                                                    {8525}out(c, (enc(m2_6649,pkCli_6592),sign(m2_6649,skSess_6589)));
                                                    {8526}event beginSrv(Sess_5170,Cli_5168,gNs_6648)
                                    )
                                    else
                                        {8527}let pkDisco_6650: bitstring = fail-any in
                                        {8528}in(c, (=pkCli_6592,em1_6651: bitstring,sigM1_6652: bitstring));
                                        {8529}let m1_6653: bitstring = dec(em1_6651,skSess_6589) in
                                        {8530}if (verify(m1_6653,sigM1_6652,pkCli_6592) <> true) then
                                            0
                                        else
                                            {8531}let (SPc_6654: bitstring,PartC_6655: bitstring) = m1_6653 in
                                            {8532}event endSrv(Cli_5168,Sess_5170,PartC_6655);
                                            {8533}new Ns_6656: bitstring;
                                            {8534}let gNs_6657: bitstring = exp(g,Ns_6656) in
                                            {8535}let m2_6658: bitstring = gNs_6657 in
                                            {8536}out(c, (enc(m2_6658,pkCli_6592),sign(m2_6658,skSess_6589)));
                                            {8537}event beginSrv(Sess_5170,Cli_5168,gNs_6657)
                                )
                                else
                                    {8538}let v_6659: bool = (Cli_5168 = B) in
                                    (
                                        {8539}if v_6659 then
                                        (
                                            {8540}let pkCli_6660: bitstring = pub(skB) in
                                            {8541}let v_6661: bool = (Disco_5169 = A) in
                                            (
                                                {8542}if v_6661 then
                                                (
                                                    {8543}let pkDisco_6662: bitstring = pub(skA) in
                                                    {8544}in(c, (=pkCli_6660,em1_6663: bitstring,sigM1_6664: bitstring));
                                                    {8545}let m1_6665: bitstring = dec(em1_6663,skSess_6589) in
                                                    {8546}if (verify(m1_6665,sigM1_6664,pkCli_6660) <> true) then
                                                        0
                                                    else
                                                        {8547}let (SPc_6666: bitstring,PartC_6667: bitstring) = m1_6665 in
                                                        {8548}event endSrv(Cli_5168,Sess_5170,PartC_6667);
                                                        {8549}new Ns_6668: bitstring;
                                                        {8550}let gNs_6669: bitstring = exp(g,Ns_6668) in
                                                        {8551}let m2_6670: bitstring = gNs_6669 in
                                                        {8552}out(c, (enc(m2_6670,pkCli_6660),sign(m2_6670,skSess_6589)));
                                                        {8553}event beginSrv(Sess_5170,Cli_5168,gNs_6669)
                                                )
                                                else
                                                    {8554}let v_6671: bool = (Disco_5169 = B) in
                                                    (
                                                        {8555}if v_6671 then
                                                        (
                                                            {8556}let pkDisco_6672: bitstring = pub(skB) in
                                                            {8557}in(c, (=pkCli_6660,em1_6673: bitstring,sigM1_6674: bitstring));
                                                            {8558}let m1_6675: bitstring = dec(em1_6673,skSess_6589) in
                                                            {8559}if (verify(m1_6675,sigM1_6674,pkCli_6660) <> true) then
                                                                0
                                                            else
                                                                {8560}let (SPc_6676: bitstring,PartC_6677: bitstring) = m1_6675 in
                                                                {8561}event endSrv(Cli_5168,Sess_5170,PartC_6677);
                                                                {8562}new Ns_6678: bitstring;
                                                                {8563}let gNs_6679: bitstring = exp(g,Ns_6678) in
                                                                {8564}let m2_6680: bitstring = gNs_6679 in
                                                                {8565}out(c, (enc(m2_6680,pkCli_6660),sign(m2_6680,skSess_6589)));
                                                                {8566}event beginSrv(Sess_5170,Cli_5168,gNs_6679)
                                                        )
                                                        else
                                                            {8567}let v_6681: bool = (Disco_5169 = C) in
                                                            (
                                                                {8568}if v_6681 then
                                                                (
                                                                    {8569}let pkDisco_6682: bitstring = pub(skC) in
                                                                    {8570}in(c, (=pkCli_6660,em1_6683: bitstring,sigM1_6684: bitstring));
                                                                    {8571}let m1_6685: bitstring = dec(em1_6683,skSess_6589) in
                                                                    {8572}if (verify(m1_6685,sigM1_6684,pkCli_6660) <> true) then
                                                                        0
                                                                    else
                                                                        {8573}let (SPc_6686: bitstring,PartC_6687: bitstring) = m1_6685 in
                                                                        {8574}event endSrv(Cli_5168,Sess_5170,PartC_6687);
                                                                        {8575}new Ns_6688: bitstring;
                                                                        {8576}let gNs_6689: bitstring = exp(g,Ns_6688) in
                                                                        {8577}let m2_6690: bitstring = gNs_6689 in
                                                                        {8578}out(c, (enc(m2_6690,pkCli_6660),sign(m2_6690,skSess_6589)));
                                                                        {8579}event beginSrv(Sess_5170,Cli_5168,gNs_6689)
                                                                )
                                                                else
                                                                    {8580}let pkDisco_6691: bitstring = pub(skI) in
                                                                    {8581}in(c, (=pkCli_6660,em1_6692: bitstring,sigM1_6693: bitstring));
                                                                    {8582}let m1_6694: bitstring = dec(em1_6692,skSess_6589) in
                                                                    {8583}if (verify(m1_6694,sigM1_6693,pkCli_6660) <> true) then
                                                                        0
                                                                    else
                                                                        {8584}let (SPc_6695: bitstring,PartC_6696: bitstring) = m1_6694 in
                                                                        {8585}event endSrv(Cli_5168,Sess_5170,PartC_6696);
                                                                        {8586}new Ns_6697: bitstring;
                                                                        {8587}let gNs_6698: bitstring = exp(g,Ns_6697) in
                                                                        {8588}let m2_6699: bitstring = gNs_6698 in
                                                                        {8589}out(c, (enc(m2_6699,pkCli_6660),sign(m2_6699,skSess_6589)));
                                                                        {8590}event beginSrv(Sess_5170,Cli_5168,gNs_6698)
                                                            )
                                                            else
                                                                {8591}let pkDisco_6700: bitstring = fail-any in
                                                                {8592}in(c, (=pkCli_6660,em1_6701: bitstring,sigM1_6702: bitstring));
                                                                {8593}let m1_6703: bitstring = dec(em1_6701,skSess_6589) in
                                                                {8594}if (verify(m1_6703,sigM1_6702,pkCli_6660) <> true) then
                                                                    0
                                                                else
                                                                    {8595}let (SPc_6704: bitstring,PartC_6705: bitstring) = m1_6703 in
                                                                    {8596}event endSrv(Cli_5168,Sess_5170,PartC_6705);
                                                                    {8597}new Ns_6706: bitstring;
                                                                    {8598}let gNs_6707: bitstring = exp(g,Ns_6706) in
                                                                    {8599}let m2_6708: bitstring = gNs_6707 in
                                                                    {8600}out(c, (enc(m2_6708,pkCli_6660),sign(m2_6708,skSess_6589)));
                                                                    {8601}event beginSrv(Sess_5170,Cli_5168,gNs_6707)
                                                    )
                                                    else
                                                        {8602}let pkDisco_6709: bitstring = fail-any in
                                                        {8603}in(c, (=pkCli_6660,em1_6710: bitstring,sigM1_6711: bitstring));
                                                        {8604}let m1_6712: bitstring = dec(em1_6710,skSess_6589) in
                                                        {8605}if (verify(m1_6712,sigM1_6711,pkCli_6660) <> true) then
                                                            0
                                                        else
                                                            {8606}let (SPc_6713: bitstring,PartC_6714: bitstring) = m1_6712 in
                                                            {8607}event endSrv(Cli_5168,Sess_5170,PartC_6714);
                                                            {8608}new Ns_6715: bitstring;
                                                            {8609}let gNs_6716: bitstring = exp(g,Ns_6715) in
                                                            {8610}let m2_6717: bitstring = gNs_6716 in
                                                            {8611}out(c, (enc(m2_6717,pkCli_6660),sign(m2_6717,skSess_6589)));
                                                            {8612}event beginSrv(Sess_5170,Cli_5168,gNs_6716)
                                            )
                                            else
                                                {8613}let pkDisco_6718: bitstring = fail-any in
                                                {8614}in(c, (=pkCli_6660,em1_6719: bitstring,sigM1_6720: bitstring));
                                                {8615}let m1_6721: bitstring = dec(em1_6719,skSess_6589) in
                                                {8616}if (verify(m1_6721,sigM1_6720,pkCli_6660) <> true) then
                                                    0
                                                else
                                                    {8617}let (SPc_6722: bitstring,PartC_6723: bitstring) = m1_6721 in
                                                    {8618}event endSrv(Cli_5168,Sess_5170,PartC_6723);
                                                    {8619}new Ns_6724: bitstring;
                                                    {8620}let gNs_6725: bitstring = exp(g,Ns_6724) in
                                                    {8621}let m2_6726: bitstring = gNs_6725 in
                                                    {8622}out(c, (enc(m2_6726,pkCli_6660),sign(m2_6726,skSess_6589)));
                                                    {8623}event beginSrv(Sess_5170,Cli_5168,gNs_6725)
                                        )
                                        else
                                            {8624}let v_6727: bool = (Cli_5168 = C) in
                                            (
                                                {8625}if v_6727 then
                                                (
                                                    {8626}let pkCli_6728: bitstring = pub(skC) in
                                                    {8627}let v_6729: bool = (Disco_5169 = A) in
                                                    (
                                                        {8628}if v_6729 then
                                                        (
                                                            {8629}let pkDisco_6730: bitstring = pub(skA) in
                                                            {8630}in(c, (=pkCli_6728,em1_6731: bitstring,sigM1_6732: bitstring));
                                                            {8631}let m1_6733: bitstring = dec(em1_6731,skSess_6589) in
                                                            {8632}if (verify(m1_6733,sigM1_6732,pkCli_6728) <> true) then
                                                                0
                                                            else
                                                                {8633}let (SPc_6734: bitstring,PartC_6735: bitstring) = m1_6733 in
                                                                {8634}event endSrv(Cli_5168,Sess_5170,PartC_6735);
                                                                {8635}new Ns_6736: bitstring;
                                                                {8636}let gNs_6737: bitstring = exp(g,Ns_6736) in
                                                                {8637}let m2_6738: bitstring = gNs_6737 in
                                                                {8638}out(c, (enc(m2_6738,pkCli_6728),sign(m2_6738,skSess_6589)));
                                                                {8639}event beginSrv(Sess_5170,Cli_5168,gNs_6737)
                                                        )
                                                        else
                                                            {8640}let v_6739: bool = (Disco_5169 = B) in
                                                            (
                                                                {8641}if v_6739 then
                                                                (
                                                                    {8642}let pkDisco_6740: bitstring = pub(skB) in
                                                                    {8643}in(c, (=pkCli_6728,em1_6741: bitstring,sigM1_6742: bitstring));
                                                                    {8644}let m1_6743: bitstring = dec(em1_6741,skSess_6589) in
                                                                    {8645}if (verify(m1_6743,sigM1_6742,pkCli_6728) <> true) then
                                                                        0
                                                                    else
                                                                        {8646}let (SPc_6744: bitstring,PartC_6745: bitstring) = m1_6743 in
                                                                        {8647}event endSrv(Cli_5168,Sess_5170,PartC_6745);
                                                                        {8648}new Ns_6746: bitstring;
                                                                        {8649}let gNs_6747: bitstring = exp(g,Ns_6746) in
                                                                        {8650}let m2_6748: bitstring = gNs_6747 in
                                                                        {8651}out(c, (enc(m2_6748,pkCli_6728),sign(m2_6748,skSess_6589)));
                                                                        {8652}event beginSrv(Sess_5170,Cli_5168,gNs_6747)
                                                                )
                                                                else
                                                                    {8653}let v_6749: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {8654}if v_6749 then
                                                                        (
                                                                            {8655}let pkDisco_6750: bitstring = pub(skC) in
                                                                            {8656}in(c, (=pkCli_6728,em1_6751: bitstring,sigM1_6752: bitstring));
                                                                            {8657}let m1_6753: bitstring = dec(em1_6751,skSess_6589) in
                                                                            {8658}if (verify(m1_6753,sigM1_6752,pkCli_6728) <> true) then
                                                                                0
                                                                            else
                                                                                {8659}let (SPc_6754: bitstring,PartC_6755: bitstring) = m1_6753 in
                                                                                {8660}event endSrv(Cli_5168,Sess_5170,PartC_6755);
                                                                                {8661}new Ns_6756: bitstring;
                                                                                {8662}let gNs_6757: bitstring = exp(g,Ns_6756) in
                                                                                {8663}let m2_6758: bitstring = gNs_6757 in
                                                                                {8664}out(c, (enc(m2_6758,pkCli_6728),sign(m2_6758,skSess_6589)));
                                                                                {8665}event beginSrv(Sess_5170,Cli_5168,gNs_6757)
                                                                        )
                                                                        else
                                                                            {8666}let pkDisco_6759: bitstring = pub(skI) in
                                                                            {8667}in(c, (=pkCli_6728,em1_6760: bitstring,sigM1_6761: bitstring));
                                                                            {8668}let m1_6762: bitstring = dec(em1_6760,skSess_6589) in
                                                                            {8669}if (verify(m1_6762,sigM1_6761,pkCli_6728) <> true) then
                                                                                0
                                                                            else
                                                                                {8670}let (SPc_6763: bitstring,PartC_6764: bitstring) = m1_6762 in
                                                                                {8671}event endSrv(Cli_5168,Sess_5170,PartC_6764);
                                                                                {8672}new Ns_6765: bitstring;
                                                                                {8673}let gNs_6766: bitstring = exp(g,Ns_6765) in
                                                                                {8674}let m2_6767: bitstring = gNs_6766 in
                                                                                {8675}out(c, (enc(m2_6767,pkCli_6728),sign(m2_6767,skSess_6589)));
                                                                                {8676}event beginSrv(Sess_5170,Cli_5168,gNs_6766)
                                                                    )
                                                                    else
                                                                        {8677}let pkDisco_6768: bitstring = fail-any in
                                                                        {8678}in(c, (=pkCli_6728,em1_6769: bitstring,sigM1_6770: bitstring));
                                                                        {8679}let m1_6771: bitstring = dec(em1_6769,skSess_6589) in
                                                                        {8680}if (verify(m1_6771,sigM1_6770,pkCli_6728) <> true) then
                                                                            0
                                                                        else
                                                                            {8681}let (SPc_6772: bitstring,PartC_6773: bitstring) = m1_6771 in
                                                                            {8682}event endSrv(Cli_5168,Sess_5170,PartC_6773);
                                                                            {8683}new Ns_6774: bitstring;
                                                                            {8684}let gNs_6775: bitstring = exp(g,Ns_6774) in
                                                                            {8685}let m2_6776: bitstring = gNs_6775 in
                                                                            {8686}out(c, (enc(m2_6776,pkCli_6728),sign(m2_6776,skSess_6589)));
                                                                            {8687}event beginSrv(Sess_5170,Cli_5168,gNs_6775)
                                                            )
                                                            else
                                                                {8688}let pkDisco_6777: bitstring = fail-any in
                                                                {8689}in(c, (=pkCli_6728,em1_6778: bitstring,sigM1_6779: bitstring));
                                                                {8690}let m1_6780: bitstring = dec(em1_6778,skSess_6589) in
                                                                {8691}if (verify(m1_6780,sigM1_6779,pkCli_6728) <> true) then
                                                                    0
                                                                else
                                                                    {8692}let (SPc_6781: bitstring,PartC_6782: bitstring) = m1_6780 in
                                                                    {8693}event endSrv(Cli_5168,Sess_5170,PartC_6782);
                                                                    {8694}new Ns_6783: bitstring;
                                                                    {8695}let gNs_6784: bitstring = exp(g,Ns_6783) in
                                                                    {8696}let m2_6785: bitstring = gNs_6784 in
                                                                    {8697}out(c, (enc(m2_6785,pkCli_6728),sign(m2_6785,skSess_6589)));
                                                                    {8698}event beginSrv(Sess_5170,Cli_5168,gNs_6784)
                                                    )
                                                    else
                                                        {8699}let pkDisco_6786: bitstring = fail-any in
                                                        {8700}in(c, (=pkCli_6728,em1_6787: bitstring,sigM1_6788: bitstring));
                                                        {8701}let m1_6789: bitstring = dec(em1_6787,skSess_6589) in
                                                        {8702}if (verify(m1_6789,sigM1_6788,pkCli_6728) <> true) then
                                                            0
                                                        else
                                                            {8703}let (SPc_6790: bitstring,PartC_6791: bitstring) = m1_6789 in
                                                            {8704}event endSrv(Cli_5168,Sess_5170,PartC_6791);
                                                            {8705}new Ns_6792: bitstring;
                                                            {8706}let gNs_6793: bitstring = exp(g,Ns_6792) in
                                                            {8707}let m2_6794: bitstring = gNs_6793 in
                                                            {8708}out(c, (enc(m2_6794,pkCli_6728),sign(m2_6794,skSess_6589)));
                                                            {8709}event beginSrv(Sess_5170,Cli_5168,gNs_6793)
                                                )
                                                else
                                                    {8710}let pkCli_6795: bitstring = pub(skI) in
                                                    {8711}let v_6796: bool = (Disco_5169 = A) in
                                                    (
                                                        {8712}if v_6796 then
                                                        (
                                                            {8713}let pkDisco_6797: bitstring = pub(skA) in
                                                            {8714}in(c, (=pkCli_6795,em1_6798: bitstring,sigM1_6799: bitstring));
                                                            {8715}let m1_6800: bitstring = dec(em1_6798,skSess_6589) in
                                                            {8716}if (verify(m1_6800,sigM1_6799,pkCli_6795) <> true) then
                                                                0
                                                            else
                                                                {8717}let (SPc_6801: bitstring,PartC_6802: bitstring) = m1_6800 in
                                                                {8718}event endSrv(Cli_5168,Sess_5170,PartC_6802);
                                                                {8719}new Ns_6803: bitstring;
                                                                {8720}let gNs_6804: bitstring = exp(g,Ns_6803) in
                                                                {8721}let m2_6805: bitstring = gNs_6804 in
                                                                {8722}out(c, (enc(m2_6805,pkCli_6795),sign(m2_6805,skSess_6589)));
                                                                {8723}event beginSrv(Sess_5170,Cli_5168,gNs_6804)
                                                        )
                                                        else
                                                            {8724}let v_6806: bool = (Disco_5169 = B) in
                                                            (
                                                                {8725}if v_6806 then
                                                                (
                                                                    {8726}let pkDisco_6807: bitstring = pub(skB) in
                                                                    {8727}in(c, (=pkCli_6795,em1_6808: bitstring,sigM1_6809: bitstring));
                                                                    {8728}let m1_6810: bitstring = dec(em1_6808,skSess_6589) in
                                                                    {8729}if (verify(m1_6810,sigM1_6809,pkCli_6795) <> true) then
                                                                        0
                                                                    else
                                                                        {8730}let (SPc_6811: bitstring,PartC_6812: bitstring) = m1_6810 in
                                                                        {8731}event endSrv(Cli_5168,Sess_5170,PartC_6812);
                                                                        {8732}new Ns_6813: bitstring;
                                                                        {8733}let gNs_6814: bitstring = exp(g,Ns_6813) in
                                                                        {8734}let m2_6815: bitstring = gNs_6814 in
                                                                        {8735}out(c, (enc(m2_6815,pkCli_6795),sign(m2_6815,skSess_6589)));
                                                                        {8736}event beginSrv(Sess_5170,Cli_5168,gNs_6814)
                                                                )
                                                                else
                                                                    {8737}let v_6816: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {8738}if v_6816 then
                                                                        (
                                                                            {8739}let pkDisco_6817: bitstring = pub(skC) in
                                                                            {8740}in(c, (=pkCli_6795,em1_6818: bitstring,sigM1_6819: bitstring));
                                                                            {8741}let m1_6820: bitstring = dec(em1_6818,skSess_6589) in
                                                                            {8742}if (verify(m1_6820,sigM1_6819,pkCli_6795) <> true) then
                                                                                0
                                                                            else
                                                                                {8743}let (SPc_6821: bitstring,PartC_6822: bitstring) = m1_6820 in
                                                                                {8744}event endSrv(Cli_5168,Sess_5170,PartC_6822);
                                                                                {8745}new Ns_6823: bitstring;
                                                                                {8746}let gNs_6824: bitstring = exp(g,Ns_6823) in
                                                                                {8747}let m2_6825: bitstring = gNs_6824 in
                                                                                {8748}out(c, (enc(m2_6825,pkCli_6795),sign(m2_6825,skSess_6589)));
                                                                                {8749}event beginSrv(Sess_5170,Cli_5168,gNs_6824)
                                                                        )
                                                                        else
                                                                            {8750}let pkDisco_6826: bitstring = pub(skI) in
                                                                            {8751}in(c, (=pkCli_6795,em1_6827: bitstring,sigM1_6828: bitstring));
                                                                            {8752}let m1_6829: bitstring = dec(em1_6827,skSess_6589) in
                                                                            {8753}if (verify(m1_6829,sigM1_6828,pkCli_6795) <> true) then
                                                                                0
                                                                            else
                                                                                {8754}let (SPc_6830: bitstring,PartC_6831: bitstring) = m1_6829 in
                                                                                {8755}event endSrv(Cli_5168,Sess_5170,PartC_6831);
                                                                                {8756}new Ns_6832: bitstring;
                                                                                {8757}let gNs_6833: bitstring = exp(g,Ns_6832) in
                                                                                {8758}let m2_6834: bitstring = gNs_6833 in
                                                                                {8759}out(c, (enc(m2_6834,pkCli_6795),sign(m2_6834,skSess_6589)));
                                                                                {8760}event beginSrv(Sess_5170,Cli_5168,gNs_6833)
                                                                    )
                                                                    else
                                                                        {8761}let pkDisco_6835: bitstring = fail-any in
                                                                        {8762}in(c, (=pkCli_6795,em1_6836: bitstring,sigM1_6837: bitstring));
                                                                        {8763}let m1_6838: bitstring = dec(em1_6836,skSess_6589) in
                                                                        {8764}if (verify(m1_6838,sigM1_6837,pkCli_6795) <> true) then
                                                                            0
                                                                        else
                                                                            {8765}let (SPc_6839: bitstring,PartC_6840: bitstring) = m1_6838 in
                                                                            {8766}event endSrv(Cli_5168,Sess_5170,PartC_6840);
                                                                            {8767}new Ns_6841: bitstring;
                                                                            {8768}let gNs_6842: bitstring = exp(g,Ns_6841) in
                                                                            {8769}let m2_6843: bitstring = gNs_6842 in
                                                                            {8770}out(c, (enc(m2_6843,pkCli_6795),sign(m2_6843,skSess_6589)));
                                                                            {8771}event beginSrv(Sess_5170,Cli_5168,gNs_6842)
                                                            )
                                                            else
                                                                {8772}let pkDisco_6844: bitstring = fail-any in
                                                                {8773}in(c, (=pkCli_6795,em1_6845: bitstring,sigM1_6846: bitstring));
                                                                {8774}let m1_6847: bitstring = dec(em1_6845,skSess_6589) in
                                                                {8775}if (verify(m1_6847,sigM1_6846,pkCli_6795) <> true) then
                                                                    0
                                                                else
                                                                    {8776}let (SPc_6848: bitstring,PartC_6849: bitstring) = m1_6847 in
                                                                    {8777}event endSrv(Cli_5168,Sess_5170,PartC_6849);
                                                                    {8778}new Ns_6850: bitstring;
                                                                    {8779}let gNs_6851: bitstring = exp(g,Ns_6850) in
                                                                    {8780}let m2_6852: bitstring = gNs_6851 in
                                                                    {8781}out(c, (enc(m2_6852,pkCli_6795),sign(m2_6852,skSess_6589)));
                                                                    {8782}event beginSrv(Sess_5170,Cli_5168,gNs_6851)
                                                    )
                                                    else
                                                        {8783}let pkDisco_6853: bitstring = fail-any in
                                                        {8784}in(c, (=pkCli_6795,em1_6854: bitstring,sigM1_6855: bitstring));
                                                        {8785}let m1_6856: bitstring = dec(em1_6854,skSess_6589) in
                                                        {8786}if (verify(m1_6856,sigM1_6855,pkCli_6795) <> true) then
                                                            0
                                                        else
                                                            {8787}let (SPc_6857: bitstring,PartC_6858: bitstring) = m1_6856 in
                                                            {8788}event endSrv(Cli_5168,Sess_5170,PartC_6858);
                                                            {8789}new Ns_6859: bitstring;
                                                            {8790}let gNs_6860: bitstring = exp(g,Ns_6859) in
                                                            {8791}let m2_6861: bitstring = gNs_6860 in
                                                            {8792}out(c, (enc(m2_6861,pkCli_6795),sign(m2_6861,skSess_6589)));
                                                            {8793}event beginSrv(Sess_5170,Cli_5168,gNs_6860)
                                            )
                                            else
                                                {8794}let pkCli_6862: bitstring = fail-any in
                                                {8795}let v_6863: bool = (Disco_5169 = A) in
                                                (
                                                    {8796}if v_6863 then
                                                    (
                                                        {8797}let pkDisco_6864: bitstring = pub(skA) in
                                                        {8798}in(c, (=pkCli_6862,em1_6865: bitstring,sigM1_6866: bitstring));
                                                        {8799}let m1_6867: bitstring = dec(em1_6865,skSess_6589) in
                                                        {8800}if (verify(m1_6867,sigM1_6866,pkCli_6862) <> true) then
                                                            0
                                                        else
                                                            {8801}let (SPc_6868: bitstring,PartC_6869: bitstring) = m1_6867 in
                                                            {8802}event endSrv(Cli_5168,Sess_5170,PartC_6869);
                                                            {8803}new Ns_6870: bitstring;
                                                            {8804}let gNs_6871: bitstring = exp(g,Ns_6870) in
                                                            {8805}let m2_6872: bitstring = gNs_6871 in
                                                            {8806}out(c, (enc(m2_6872,pkCli_6862),sign(m2_6872,skSess_6589)));
                                                            {8807}event beginSrv(Sess_5170,Cli_5168,gNs_6871)
                                                    )
                                                    else
                                                        {8808}let v_6873: bool = (Disco_5169 = B) in
                                                        (
                                                            {8809}if v_6873 then
                                                            (
                                                                {8810}let pkDisco_6874: bitstring = pub(skB) in
                                                                {8811}in(c, (=pkCli_6862,em1_6875: bitstring,sigM1_6876: bitstring));
                                                                {8812}let m1_6877: bitstring = dec(em1_6875,skSess_6589) in
                                                                {8813}if (verify(m1_6877,sigM1_6876,pkCli_6862) <> true) then
                                                                    0
                                                                else
                                                                    {8814}let (SPc_6878: bitstring,PartC_6879: bitstring) = m1_6877 in
                                                                    {8815}event endSrv(Cli_5168,Sess_5170,PartC_6879);
                                                                    {8816}new Ns_6880: bitstring;
                                                                    {8817}let gNs_6881: bitstring = exp(g,Ns_6880) in
                                                                    {8818}let m2_6882: bitstring = gNs_6881 in
                                                                    {8819}out(c, (enc(m2_6882,pkCli_6862),sign(m2_6882,skSess_6589)));
                                                                    {8820}event beginSrv(Sess_5170,Cli_5168,gNs_6881)
                                                            )
                                                            else
                                                                {8821}let v_6883: bool = (Disco_5169 = C) in
                                                                (
                                                                    {8822}if v_6883 then
                                                                    (
                                                                        {8823}let pkDisco_6884: bitstring = pub(skC) in
                                                                        {8824}in(c, (=pkCli_6862,em1_6885: bitstring,sigM1_6886: bitstring));
                                                                        {8825}let m1_6887: bitstring = dec(em1_6885,skSess_6589) in
                                                                        {8826}if (verify(m1_6887,sigM1_6886,pkCli_6862) <> true) then
                                                                            0
                                                                        else
                                                                            {8827}let (SPc_6888: bitstring,PartC_6889: bitstring) = m1_6887 in
                                                                            {8828}event endSrv(Cli_5168,Sess_5170,PartC_6889);
                                                                            {8829}new Ns_6890: bitstring;
                                                                            {8830}let gNs_6891: bitstring = exp(g,Ns_6890) in
                                                                            {8831}let m2_6892: bitstring = gNs_6891 in
                                                                            {8832}out(c, (enc(m2_6892,pkCli_6862),sign(m2_6892,skSess_6589)));
                                                                            {8833}event beginSrv(Sess_5170,Cli_5168,gNs_6891)
                                                                    )
                                                                    else
                                                                        {8834}let pkDisco_6893: bitstring = pub(skI) in
                                                                        {8835}in(c, (=pkCli_6862,em1_6894: bitstring,sigM1_6895: bitstring));
                                                                        {8836}let m1_6896: bitstring = dec(em1_6894,skSess_6589) in
                                                                        {8837}if (verify(m1_6896,sigM1_6895,pkCli_6862) <> true) then
                                                                            0
                                                                        else
                                                                            {8838}let (SPc_6897: bitstring,PartC_6898: bitstring) = m1_6896 in
                                                                            {8839}event endSrv(Cli_5168,Sess_5170,PartC_6898);
                                                                            {8840}new Ns_6899: bitstring;
                                                                            {8841}let gNs_6900: bitstring = exp(g,Ns_6899) in
                                                                            {8842}let m2_6901: bitstring = gNs_6900 in
                                                                            {8843}out(c, (enc(m2_6901,pkCli_6862),sign(m2_6901,skSess_6589)));
                                                                            {8844}event beginSrv(Sess_5170,Cli_5168,gNs_6900)
                                                                )
                                                                else
                                                                    {8845}let pkDisco_6902: bitstring = fail-any in
                                                                    {8846}in(c, (=pkCli_6862,em1_6903: bitstring,sigM1_6904: bitstring));
                                                                    {8847}let m1_6905: bitstring = dec(em1_6903,skSess_6589) in
                                                                    {8848}if (verify(m1_6905,sigM1_6904,pkCli_6862) <> true) then
                                                                        0
                                                                    else
                                                                        {8849}let (SPc_6906: bitstring,PartC_6907: bitstring) = m1_6905 in
                                                                        {8850}event endSrv(Cli_5168,Sess_5170,PartC_6907);
                                                                        {8851}new Ns_6908: bitstring;
                                                                        {8852}let gNs_6909: bitstring = exp(g,Ns_6908) in
                                                                        {8853}let m2_6910: bitstring = gNs_6909 in
                                                                        {8854}out(c, (enc(m2_6910,pkCli_6862),sign(m2_6910,skSess_6589)));
                                                                        {8855}event beginSrv(Sess_5170,Cli_5168,gNs_6909)
                                                        )
                                                        else
                                                            {8856}let pkDisco_6911: bitstring = fail-any in
                                                            {8857}in(c, (=pkCli_6862,em1_6912: bitstring,sigM1_6913: bitstring));
                                                            {8858}let m1_6914: bitstring = dec(em1_6912,skSess_6589) in
                                                            {8859}if (verify(m1_6914,sigM1_6913,pkCli_6862) <> true) then
                                                                0
                                                            else
                                                                {8860}let (SPc_6915: bitstring,PartC_6916: bitstring) = m1_6914 in
                                                                {8861}event endSrv(Cli_5168,Sess_5170,PartC_6916);
                                                                {8862}new Ns_6917: bitstring;
                                                                {8863}let gNs_6918: bitstring = exp(g,Ns_6917) in
                                                                {8864}let m2_6919: bitstring = gNs_6918 in
                                                                {8865}out(c, (enc(m2_6919,pkCli_6862),sign(m2_6919,skSess_6589)));
                                                                {8866}event beginSrv(Sess_5170,Cli_5168,gNs_6918)
                                                )
                                                else
                                                    {8867}let pkDisco_6920: bitstring = fail-any in
                                                    {8868}in(c, (=pkCli_6862,em1_6921: bitstring,sigM1_6922: bitstring));
                                                    {8869}let m1_6923: bitstring = dec(em1_6921,skSess_6589) in
                                                    {8870}if (verify(m1_6923,sigM1_6922,pkCli_6862) <> true) then
                                                        0
                                                    else
                                                        {8871}let (SPc_6924: bitstring,PartC_6925: bitstring) = m1_6923 in
                                                        {8872}event endSrv(Cli_5168,Sess_5170,PartC_6925);
                                                        {8873}new Ns_6926: bitstring;
                                                        {8874}let gNs_6927: bitstring = exp(g,Ns_6926) in
                                                        {8875}let m2_6928: bitstring = gNs_6927 in
                                                        {8876}out(c, (enc(m2_6928,pkCli_6862),sign(m2_6928,skSess_6589)));
                                                        {8877}event beginSrv(Sess_5170,Cli_5168,gNs_6927)
                                    )
                                    else
                                        {8878}let pkCli_6929: bitstring = fail-any in
                                        {8879}let v_6930: bool = (Disco_5169 = A) in
                                        (
                                            {8880}if v_6930 then
                                            (
                                                {8881}let pkDisco_6931: bitstring = pub(skA) in
                                                {8882}in(c, (=pkCli_6929,em1_6932: bitstring,sigM1_6933: bitstring));
                                                {8883}let m1_6934: bitstring = dec(em1_6932,skSess_6589) in
                                                {8884}if (verify(m1_6934,sigM1_6933,pkCli_6929) <> true) then
                                                    0
                                                else
                                                    {8885}let (SPc_6935: bitstring,PartC_6936: bitstring) = m1_6934 in
                                                    {8886}event endSrv(Cli_5168,Sess_5170,PartC_6936);
                                                    {8887}new Ns_6937: bitstring;
                                                    {8888}let gNs_6938: bitstring = exp(g,Ns_6937) in
                                                    {8889}let m2_6939: bitstring = gNs_6938 in
                                                    {8890}out(c, (enc(m2_6939,pkCli_6929),sign(m2_6939,skSess_6589)));
                                                    {8891}event beginSrv(Sess_5170,Cli_5168,gNs_6938)
                                            )
                                            else
                                                {8892}let v_6940: bool = (Disco_5169 = B) in
                                                (
                                                    {8893}if v_6940 then
                                                    (
                                                        {8894}let pkDisco_6941: bitstring = pub(skB) in
                                                        {8895}in(c, (=pkCli_6929,em1_6942: bitstring,sigM1_6943: bitstring));
                                                        {8896}let m1_6944: bitstring = dec(em1_6942,skSess_6589) in
                                                        {8897}if (verify(m1_6944,sigM1_6943,pkCli_6929) <> true) then
                                                            0
                                                        else
                                                            {8898}let (SPc_6945: bitstring,PartC_6946: bitstring) = m1_6944 in
                                                            {8899}event endSrv(Cli_5168,Sess_5170,PartC_6946);
                                                            {8900}new Ns_6947: bitstring;
                                                            {8901}let gNs_6948: bitstring = exp(g,Ns_6947) in
                                                            {8902}let m2_6949: bitstring = gNs_6948 in
                                                            {8903}out(c, (enc(m2_6949,pkCli_6929),sign(m2_6949,skSess_6589)));
                                                            {8904}event beginSrv(Sess_5170,Cli_5168,gNs_6948)
                                                    )
                                                    else
                                                        {8905}let v_6950: bool = (Disco_5169 = C) in
                                                        (
                                                            {8906}if v_6950 then
                                                            (
                                                                {8907}let pkDisco_6951: bitstring = pub(skC) in
                                                                {8908}in(c, (=pkCli_6929,em1_6952: bitstring,sigM1_6953: bitstring));
                                                                {8909}let m1_6954: bitstring = dec(em1_6952,skSess_6589) in
                                                                {8910}if (verify(m1_6954,sigM1_6953,pkCli_6929) <> true) then
                                                                    0
                                                                else
                                                                    {8911}let (SPc_6955: bitstring,PartC_6956: bitstring) = m1_6954 in
                                                                    {8912}event endSrv(Cli_5168,Sess_5170,PartC_6956);
                                                                    {8913}new Ns_6957: bitstring;
                                                                    {8914}let gNs_6958: bitstring = exp(g,Ns_6957) in
                                                                    {8915}let m2_6959: bitstring = gNs_6958 in
                                                                    {8916}out(c, (enc(m2_6959,pkCli_6929),sign(m2_6959,skSess_6589)));
                                                                    {8917}event beginSrv(Sess_5170,Cli_5168,gNs_6958)
                                                            )
                                                            else
                                                                {8918}let pkDisco_6960: bitstring = pub(skI) in
                                                                {8919}in(c, (=pkCli_6929,em1_6961: bitstring,sigM1_6962: bitstring));
                                                                {8920}let m1_6963: bitstring = dec(em1_6961,skSess_6589) in
                                                                {8921}if (verify(m1_6963,sigM1_6962,pkCli_6929) <> true) then
                                                                    0
                                                                else
                                                                    {8922}let (SPc_6964: bitstring,PartC_6965: bitstring) = m1_6963 in
                                                                    {8923}event endSrv(Cli_5168,Sess_5170,PartC_6965);
                                                                    {8924}new Ns_6966: bitstring;
                                                                    {8925}let gNs_6967: bitstring = exp(g,Ns_6966) in
                                                                    {8926}let m2_6968: bitstring = gNs_6967 in
                                                                    {8927}out(c, (enc(m2_6968,pkCli_6929),sign(m2_6968,skSess_6589)));
                                                                    {8928}event beginSrv(Sess_5170,Cli_5168,gNs_6967)
                                                        )
                                                        else
                                                            {8929}let pkDisco_6969: bitstring = fail-any in
                                                            {8930}in(c, (=pkCli_6929,em1_6970: bitstring,sigM1_6971: bitstring));
                                                            {8931}let m1_6972: bitstring = dec(em1_6970,skSess_6589) in
                                                            {8932}if (verify(m1_6972,sigM1_6971,pkCli_6929) <> true) then
                                                                0
                                                            else
                                                                {8933}let (SPc_6973: bitstring,PartC_6974: bitstring) = m1_6972 in
                                                                {8934}event endSrv(Cli_5168,Sess_5170,PartC_6974);
                                                                {8935}new Ns_6975: bitstring;
                                                                {8936}let gNs_6976: bitstring = exp(g,Ns_6975) in
                                                                {8937}let m2_6977: bitstring = gNs_6976 in
                                                                {8938}out(c, (enc(m2_6977,pkCli_6929),sign(m2_6977,skSess_6589)));
                                                                {8939}event beginSrv(Sess_5170,Cli_5168,gNs_6976)
                                                )
                                                else
                                                    {8940}let pkDisco_6978: bitstring = fail-any in
                                                    {8941}in(c, (=pkCli_6929,em1_6979: bitstring,sigM1_6980: bitstring));
                                                    {8942}let m1_6981: bitstring = dec(em1_6979,skSess_6589) in
                                                    {8943}if (verify(m1_6981,sigM1_6980,pkCli_6929) <> true) then
                                                        0
                                                    else
                                                        {8944}let (SPc_6982: bitstring,PartC_6983: bitstring) = m1_6981 in
                                                        {8945}event endSrv(Cli_5168,Sess_5170,PartC_6983);
                                                        {8946}new Ns_6984: bitstring;
                                                        {8947}let gNs_6985: bitstring = exp(g,Ns_6984) in
                                                        {8948}let m2_6986: bitstring = gNs_6985 in
                                                        {8949}out(c, (enc(m2_6986,pkCli_6929),sign(m2_6986,skSess_6589)));
                                                        {8950}event beginSrv(Sess_5170,Cli_5168,gNs_6985)
                                        )
                                        else
                                            {8951}let pkDisco_6987: bitstring = fail-any in
                                            {8952}in(c, (=pkCli_6929,em1_6988: bitstring,sigM1_6989: bitstring));
                                            {8953}let m1_6990: bitstring = dec(em1_6988,skSess_6589) in
                                            {8954}if (verify(m1_6990,sigM1_6989,pkCli_6929) <> true) then
                                                0
                                            else
                                                {8955}let (SPc_6991: bitstring,PartC_6992: bitstring) = m1_6990 in
                                                {8956}event endSrv(Cli_5168,Sess_5170,PartC_6992);
                                                {8957}new Ns_6993: bitstring;
                                                {8958}let gNs_6994: bitstring = exp(g,Ns_6993) in
                                                {8959}let m2_6995: bitstring = gNs_6994 in
                                                {8960}out(c, (enc(m2_6995,pkCli_6929),sign(m2_6995,skSess_6589)));
                                                {8961}event beginSrv(Sess_5170,Cli_5168,gNs_6994)
                            )
                            else
                                {8962}let pkCli_6996: bitstring = fail-any in
                                {8963}let v_6997: bool = (Disco_5169 = A) in
                                (
                                    {8964}if v_6997 then
                                    (
                                        {8965}let pkDisco_6998: bitstring = pub(skA) in
                                        {8966}in(c, (=pkCli_6996,em1_6999: bitstring,sigM1_7000: bitstring));
                                        {8967}let m1_7001: bitstring = dec(em1_6999,skSess_6589) in
                                        {8968}if (verify(m1_7001,sigM1_7000,pkCli_6996) <> true) then
                                            0
                                        else
                                            {8969}let (SPc_7002: bitstring,PartC_7003: bitstring) = m1_7001 in
                                            {8970}event endSrv(Cli_5168,Sess_5170,PartC_7003);
                                            {8971}new Ns_7004: bitstring;
                                            {8972}let gNs_7005: bitstring = exp(g,Ns_7004) in
                                            {8973}let m2_7006: bitstring = gNs_7005 in
                                            {8974}out(c, (enc(m2_7006,pkCli_6996),sign(m2_7006,skSess_6589)));
                                            {8975}event beginSrv(Sess_5170,Cli_5168,gNs_7005)
                                    )
                                    else
                                        {8976}let v_7007: bool = (Disco_5169 = B) in
                                        (
                                            {8977}if v_7007 then
                                            (
                                                {8978}let pkDisco_7008: bitstring = pub(skB) in
                                                {8979}in(c, (=pkCli_6996,em1_7009: bitstring,sigM1_7010: bitstring));
                                                {8980}let m1_7011: bitstring = dec(em1_7009,skSess_6589) in
                                                {8981}if (verify(m1_7011,sigM1_7010,pkCli_6996) <> true) then
                                                    0
                                                else
                                                    {8982}let (SPc_7012: bitstring,PartC_7013: bitstring) = m1_7011 in
                                                    {8983}event endSrv(Cli_5168,Sess_5170,PartC_7013);
                                                    {8984}new Ns_7014: bitstring;
                                                    {8985}let gNs_7015: bitstring = exp(g,Ns_7014) in
                                                    {8986}let m2_7016: bitstring = gNs_7015 in
                                                    {8987}out(c, (enc(m2_7016,pkCli_6996),sign(m2_7016,skSess_6589)));
                                                    {8988}event beginSrv(Sess_5170,Cli_5168,gNs_7015)
                                            )
                                            else
                                                {8989}let v_7017: bool = (Disco_5169 = C) in
                                                (
                                                    {8990}if v_7017 then
                                                    (
                                                        {8991}let pkDisco_7018: bitstring = pub(skC) in
                                                        {8992}in(c, (=pkCli_6996,em1_7019: bitstring,sigM1_7020: bitstring));
                                                        {8993}let m1_7021: bitstring = dec(em1_7019,skSess_6589) in
                                                        {8994}if (verify(m1_7021,sigM1_7020,pkCli_6996) <> true) then
                                                            0
                                                        else
                                                            {8995}let (SPc_7022: bitstring,PartC_7023: bitstring) = m1_7021 in
                                                            {8996}event endSrv(Cli_5168,Sess_5170,PartC_7023);
                                                            {8997}new Ns_7024: bitstring;
                                                            {8998}let gNs_7025: bitstring = exp(g,Ns_7024) in
                                                            {8999}let m2_7026: bitstring = gNs_7025 in
                                                            {9000}out(c, (enc(m2_7026,pkCli_6996),sign(m2_7026,skSess_6589)));
                                                            {9001}event beginSrv(Sess_5170,Cli_5168,gNs_7025)
                                                    )
                                                    else
                                                        {9002}let pkDisco_7027: bitstring = pub(skI) in
                                                        {9003}in(c, (=pkCli_6996,em1_7028: bitstring,sigM1_7029: bitstring));
                                                        {9004}let m1_7030: bitstring = dec(em1_7028,skSess_6589) in
                                                        {9005}if (verify(m1_7030,sigM1_7029,pkCli_6996) <> true) then
                                                            0
                                                        else
                                                            {9006}let (SPc_7031: bitstring,PartC_7032: bitstring) = m1_7030 in
                                                            {9007}event endSrv(Cli_5168,Sess_5170,PartC_7032);
                                                            {9008}new Ns_7033: bitstring;
                                                            {9009}let gNs_7034: bitstring = exp(g,Ns_7033) in
                                                            {9010}let m2_7035: bitstring = gNs_7034 in
                                                            {9011}out(c, (enc(m2_7035,pkCli_6996),sign(m2_7035,skSess_6589)));
                                                            {9012}event beginSrv(Sess_5170,Cli_5168,gNs_7034)
                                                )
                                                else
                                                    {9013}let pkDisco_7036: bitstring = fail-any in
                                                    {9014}in(c, (=pkCli_6996,em1_7037: bitstring,sigM1_7038: bitstring));
                                                    {9015}let m1_7039: bitstring = dec(em1_7037,skSess_6589) in
                                                    {9016}if (verify(m1_7039,sigM1_7038,pkCli_6996) <> true) then
                                                        0
                                                    else
                                                        {9017}let (SPc_7040: bitstring,PartC_7041: bitstring) = m1_7039 in
                                                        {9018}event endSrv(Cli_5168,Sess_5170,PartC_7041);
                                                        {9019}new Ns_7042: bitstring;
                                                        {9020}let gNs_7043: bitstring = exp(g,Ns_7042) in
                                                        {9021}let m2_7044: bitstring = gNs_7043 in
                                                        {9022}out(c, (enc(m2_7044,pkCli_6996),sign(m2_7044,skSess_6589)));
                                                        {9023}event beginSrv(Sess_5170,Cli_5168,gNs_7043)
                                        )
                                        else
                                            {9024}let pkDisco_7045: bitstring = fail-any in
                                            {9025}in(c, (=pkCli_6996,em1_7046: bitstring,sigM1_7047: bitstring));
                                            {9026}let m1_7048: bitstring = dec(em1_7046,skSess_6589) in
                                            {9027}if (verify(m1_7048,sigM1_7047,pkCli_6996) <> true) then
                                                0
                                            else
                                                {9028}let (SPc_7049: bitstring,PartC_7050: bitstring) = m1_7048 in
                                                {9029}event endSrv(Cli_5168,Sess_5170,PartC_7050);
                                                {9030}new Ns_7051: bitstring;
                                                {9031}let gNs_7052: bitstring = exp(g,Ns_7051) in
                                                {9032}let m2_7053: bitstring = gNs_7052 in
                                                {9033}out(c, (enc(m2_7053,pkCli_6996),sign(m2_7053,skSess_6589)));
                                                {9034}event beginSrv(Sess_5170,Cli_5168,gNs_7052)
                                )
                                else
                                    {9035}let pkDisco_7054: bitstring = fail-any in
                                    {9036}in(c, (=pkCli_6996,em1_7055: bitstring,sigM1_7056: bitstring));
                                    {9037}let m1_7057: bitstring = dec(em1_7055,skSess_6589) in
                                    {9038}if (verify(m1_7057,sigM1_7056,pkCli_6996) <> true) then
                                        0
                                    else
                                        {9039}let (SPc_7058: bitstring,PartC_7059: bitstring) = m1_7057 in
                                        {9040}event endSrv(Cli_5168,Sess_5170,PartC_7059);
                                        {9041}new Ns_7060: bitstring;
                                        {9042}let gNs_7061: bitstring = exp(g,Ns_7060) in
                                        {9043}let m2_7062: bitstring = gNs_7061 in
                                        {9044}out(c, (enc(m2_7062,pkCli_6996),sign(m2_7062,skSess_6589)));
                                        {9045}event beginSrv(Sess_5170,Cli_5168,gNs_7061)
                    )
                    else
                        {9046}let skSess_7063: bitstring = fail-any in
                        {9047}let pkSess_7064: bitstring = pub(skSess_7063) in
                        {9048}let v_7065: bool = (Cli_5168 = A) in
                        (
                            {9049}if v_7065 then
                            (
                                {9050}let pkCli_7066: bitstring = pub(skA) in
                                {9051}let v_7067: bool = (Disco_5169 = A) in
                                (
                                    {9052}if v_7067 then
                                    (
                                        {9053}let pkDisco_7068: bitstring = pub(skA) in
                                        {9054}in(c, (=pkCli_7066,em1_7069: bitstring,sigM1_7070: bitstring));
                                        {9055}let m1_7071: bitstring = dec(em1_7069,skSess_7063) in
                                        {9056}if (verify(m1_7071,sigM1_7070,pkCli_7066) <> true) then
                                            0
                                        else
                                            {9057}let (SPc_7072: bitstring,PartC_7073: bitstring) = m1_7071 in
                                            {9058}event endSrv(Cli_5168,Sess_5170,PartC_7073);
                                            {9059}new Ns_7074: bitstring;
                                            {9060}let gNs_7075: bitstring = exp(g,Ns_7074) in
                                            {9061}let m2_7076: bitstring = gNs_7075 in
                                            {9062}out(c, (enc(m2_7076,pkCli_7066),sign(m2_7076,skSess_7063)));
                                            {9063}event beginSrv(Sess_5170,Cli_5168,gNs_7075)
                                    )
                                    else
                                        {9064}let v_7077: bool = (Disco_5169 = B) in
                                        (
                                            {9065}if v_7077 then
                                            (
                                                {9066}let pkDisco_7078: bitstring = pub(skB) in
                                                {9067}in(c, (=pkCli_7066,em1_7079: bitstring,sigM1_7080: bitstring));
                                                {9068}let m1_7081: bitstring = dec(em1_7079,skSess_7063) in
                                                {9069}if (verify(m1_7081,sigM1_7080,pkCli_7066) <> true) then
                                                    0
                                                else
                                                    {9070}let (SPc_7082: bitstring,PartC_7083: bitstring) = m1_7081 in
                                                    {9071}event endSrv(Cli_5168,Sess_5170,PartC_7083);
                                                    {9072}new Ns_7084: bitstring;
                                                    {9073}let gNs_7085: bitstring = exp(g,Ns_7084) in
                                                    {9074}let m2_7086: bitstring = gNs_7085 in
                                                    {9075}out(c, (enc(m2_7086,pkCli_7066),sign(m2_7086,skSess_7063)));
                                                    {9076}event beginSrv(Sess_5170,Cli_5168,gNs_7085)
                                            )
                                            else
                                                {9077}let v_7087: bool = (Disco_5169 = C) in
                                                (
                                                    {9078}if v_7087 then
                                                    (
                                                        {9079}let pkDisco_7088: bitstring = pub(skC) in
                                                        {9080}in(c, (=pkCli_7066,em1_7089: bitstring,sigM1_7090: bitstring));
                                                        {9081}let m1_7091: bitstring = dec(em1_7089,skSess_7063) in
                                                        {9082}if (verify(m1_7091,sigM1_7090,pkCli_7066) <> true) then
                                                            0
                                                        else
                                                            {9083}let (SPc_7092: bitstring,PartC_7093: bitstring) = m1_7091 in
                                                            {9084}event endSrv(Cli_5168,Sess_5170,PartC_7093);
                                                            {9085}new Ns_7094: bitstring;
                                                            {9086}let gNs_7095: bitstring = exp(g,Ns_7094) in
                                                            {9087}let m2_7096: bitstring = gNs_7095 in
                                                            {9088}out(c, (enc(m2_7096,pkCli_7066),sign(m2_7096,skSess_7063)));
                                                            {9089}event beginSrv(Sess_5170,Cli_5168,gNs_7095)
                                                    )
                                                    else
                                                        {9090}let pkDisco_7097: bitstring = pub(skI) in
                                                        {9091}in(c, (=pkCli_7066,em1_7098: bitstring,sigM1_7099: bitstring));
                                                        {9092}let m1_7100: bitstring = dec(em1_7098,skSess_7063) in
                                                        {9093}if (verify(m1_7100,sigM1_7099,pkCli_7066) <> true) then
                                                            0
                                                        else
                                                            {9094}let (SPc_7101: bitstring,PartC_7102: bitstring) = m1_7100 in
                                                            {9095}event endSrv(Cli_5168,Sess_5170,PartC_7102);
                                                            {9096}new Ns_7103: bitstring;
                                                            {9097}let gNs_7104: bitstring = exp(g,Ns_7103) in
                                                            {9098}let m2_7105: bitstring = gNs_7104 in
                                                            {9099}out(c, (enc(m2_7105,pkCli_7066),sign(m2_7105,skSess_7063)));
                                                            {9100}event beginSrv(Sess_5170,Cli_5168,gNs_7104)
                                                )
                                                else
                                                    {9101}let pkDisco_7106: bitstring = fail-any in
                                                    {9102}in(c, (=pkCli_7066,em1_7107: bitstring,sigM1_7108: bitstring));
                                                    {9103}let m1_7109: bitstring = dec(em1_7107,skSess_7063) in
                                                    {9104}if (verify(m1_7109,sigM1_7108,pkCli_7066) <> true) then
                                                        0
                                                    else
                                                        {9105}let (SPc_7110: bitstring,PartC_7111: bitstring) = m1_7109 in
                                                        {9106}event endSrv(Cli_5168,Sess_5170,PartC_7111);
                                                        {9107}new Ns_7112: bitstring;
                                                        {9108}let gNs_7113: bitstring = exp(g,Ns_7112) in
                                                        {9109}let m2_7114: bitstring = gNs_7113 in
                                                        {9110}out(c, (enc(m2_7114,pkCli_7066),sign(m2_7114,skSess_7063)));
                                                        {9111}event beginSrv(Sess_5170,Cli_5168,gNs_7113)
                                        )
                                        else
                                            {9112}let pkDisco_7115: bitstring = fail-any in
                                            {9113}in(c, (=pkCli_7066,em1_7116: bitstring,sigM1_7117: bitstring));
                                            {9114}let m1_7118: bitstring = dec(em1_7116,skSess_7063) in
                                            {9115}if (verify(m1_7118,sigM1_7117,pkCli_7066) <> true) then
                                                0
                                            else
                                                {9116}let (SPc_7119: bitstring,PartC_7120: bitstring) = m1_7118 in
                                                {9117}event endSrv(Cli_5168,Sess_5170,PartC_7120);
                                                {9118}new Ns_7121: bitstring;
                                                {9119}let gNs_7122: bitstring = exp(g,Ns_7121) in
                                                {9120}let m2_7123: bitstring = gNs_7122 in
                                                {9121}out(c, (enc(m2_7123,pkCli_7066),sign(m2_7123,skSess_7063)));
                                                {9122}event beginSrv(Sess_5170,Cli_5168,gNs_7122)
                                )
                                else
                                    {9123}let pkDisco_7124: bitstring = fail-any in
                                    {9124}in(c, (=pkCli_7066,em1_7125: bitstring,sigM1_7126: bitstring));
                                    {9125}let m1_7127: bitstring = dec(em1_7125,skSess_7063) in
                                    {9126}if (verify(m1_7127,sigM1_7126,pkCli_7066) <> true) then
                                        0
                                    else
                                        {9127}let (SPc_7128: bitstring,PartC_7129: bitstring) = m1_7127 in
                                        {9128}event endSrv(Cli_5168,Sess_5170,PartC_7129);
                                        {9129}new Ns_7130: bitstring;
                                        {9130}let gNs_7131: bitstring = exp(g,Ns_7130) in
                                        {9131}let m2_7132: bitstring = gNs_7131 in
                                        {9132}out(c, (enc(m2_7132,pkCli_7066),sign(m2_7132,skSess_7063)));
                                        {9133}event beginSrv(Sess_5170,Cli_5168,gNs_7131)
                            )
                            else
                                {9134}let v_7133: bool = (Cli_5168 = B) in
                                (
                                    {9135}if v_7133 then
                                    (
                                        {9136}let pkCli_7134: bitstring = pub(skB) in
                                        {9137}let v_7135: bool = (Disco_5169 = A) in
                                        (
                                            {9138}if v_7135 then
                                            (
                                                {9139}let pkDisco_7136: bitstring = pub(skA) in
                                                {9140}in(c, (=pkCli_7134,em1_7137: bitstring,sigM1_7138: bitstring));
                                                {9141}let m1_7139: bitstring = dec(em1_7137,skSess_7063) in
                                                {9142}if (verify(m1_7139,sigM1_7138,pkCli_7134) <> true) then
                                                    0
                                                else
                                                    {9143}let (SPc_7140: bitstring,PartC_7141: bitstring) = m1_7139 in
                                                    {9144}event endSrv(Cli_5168,Sess_5170,PartC_7141);
                                                    {9145}new Ns_7142: bitstring;
                                                    {9146}let gNs_7143: bitstring = exp(g,Ns_7142) in
                                                    {9147}let m2_7144: bitstring = gNs_7143 in
                                                    {9148}out(c, (enc(m2_7144,pkCli_7134),sign(m2_7144,skSess_7063)));
                                                    {9149}event beginSrv(Sess_5170,Cli_5168,gNs_7143)
                                            )
                                            else
                                                {9150}let v_7145: bool = (Disco_5169 = B) in
                                                (
                                                    {9151}if v_7145 then
                                                    (
                                                        {9152}let pkDisco_7146: bitstring = pub(skB) in
                                                        {9153}in(c, (=pkCli_7134,em1_7147: bitstring,sigM1_7148: bitstring));
                                                        {9154}let m1_7149: bitstring = dec(em1_7147,skSess_7063) in
                                                        {9155}if (verify(m1_7149,sigM1_7148,pkCli_7134) <> true) then
                                                            0
                                                        else
                                                            {9156}let (SPc_7150: bitstring,PartC_7151: bitstring) = m1_7149 in
                                                            {9157}event endSrv(Cli_5168,Sess_5170,PartC_7151);
                                                            {9158}new Ns_7152: bitstring;
                                                            {9159}let gNs_7153: bitstring = exp(g,Ns_7152) in
                                                            {9160}let m2_7154: bitstring = gNs_7153 in
                                                            {9161}out(c, (enc(m2_7154,pkCli_7134),sign(m2_7154,skSess_7063)));
                                                            {9162}event beginSrv(Sess_5170,Cli_5168,gNs_7153)
                                                    )
                                                    else
                                                        {9163}let v_7155: bool = (Disco_5169 = C) in
                                                        (
                                                            {9164}if v_7155 then
                                                            (
                                                                {9165}let pkDisco_7156: bitstring = pub(skC) in
                                                                {9166}in(c, (=pkCli_7134,em1_7157: bitstring,sigM1_7158: bitstring));
                                                                {9167}let m1_7159: bitstring = dec(em1_7157,skSess_7063) in
                                                                {9168}if (verify(m1_7159,sigM1_7158,pkCli_7134) <> true) then
                                                                    0
                                                                else
                                                                    {9169}let (SPc_7160: bitstring,PartC_7161: bitstring) = m1_7159 in
                                                                    {9170}event endSrv(Cli_5168,Sess_5170,PartC_7161);
                                                                    {9171}new Ns_7162: bitstring;
                                                                    {9172}let gNs_7163: bitstring = exp(g,Ns_7162) in
                                                                    {9173}let m2_7164: bitstring = gNs_7163 in
                                                                    {9174}out(c, (enc(m2_7164,pkCli_7134),sign(m2_7164,skSess_7063)));
                                                                    {9175}event beginSrv(Sess_5170,Cli_5168,gNs_7163)
                                                            )
                                                            else
                                                                {9176}let pkDisco_7165: bitstring = pub(skI) in
                                                                {9177}in(c, (=pkCli_7134,em1_7166: bitstring,sigM1_7167: bitstring));
                                                                {9178}let m1_7168: bitstring = dec(em1_7166,skSess_7063) in
                                                                {9179}if (verify(m1_7168,sigM1_7167,pkCli_7134) <> true) then
                                                                    0
                                                                else
                                                                    {9180}let (SPc_7169: bitstring,PartC_7170: bitstring) = m1_7168 in
                                                                    {9181}event endSrv(Cli_5168,Sess_5170,PartC_7170);
                                                                    {9182}new Ns_7171: bitstring;
                                                                    {9183}let gNs_7172: bitstring = exp(g,Ns_7171) in
                                                                    {9184}let m2_7173: bitstring = gNs_7172 in
                                                                    {9185}out(c, (enc(m2_7173,pkCli_7134),sign(m2_7173,skSess_7063)));
                                                                    {9186}event beginSrv(Sess_5170,Cli_5168,gNs_7172)
                                                        )
                                                        else
                                                            {9187}let pkDisco_7174: bitstring = fail-any in
                                                            {9188}in(c, (=pkCli_7134,em1_7175: bitstring,sigM1_7176: bitstring));
                                                            {9189}let m1_7177: bitstring = dec(em1_7175,skSess_7063) in
                                                            {9190}if (verify(m1_7177,sigM1_7176,pkCli_7134) <> true) then
                                                                0
                                                            else
                                                                {9191}let (SPc_7178: bitstring,PartC_7179: bitstring) = m1_7177 in
                                                                {9192}event endSrv(Cli_5168,Sess_5170,PartC_7179);
                                                                {9193}new Ns_7180: bitstring;
                                                                {9194}let gNs_7181: bitstring = exp(g,Ns_7180) in
                                                                {9195}let m2_7182: bitstring = gNs_7181 in
                                                                {9196}out(c, (enc(m2_7182,pkCli_7134),sign(m2_7182,skSess_7063)));
                                                                {9197}event beginSrv(Sess_5170,Cli_5168,gNs_7181)
                                                )
                                                else
                                                    {9198}let pkDisco_7183: bitstring = fail-any in
                                                    {9199}in(c, (=pkCli_7134,em1_7184: bitstring,sigM1_7185: bitstring));
                                                    {9200}let m1_7186: bitstring = dec(em1_7184,skSess_7063) in
                                                    {9201}if (verify(m1_7186,sigM1_7185,pkCli_7134) <> true) then
                                                        0
                                                    else
                                                        {9202}let (SPc_7187: bitstring,PartC_7188: bitstring) = m1_7186 in
                                                        {9203}event endSrv(Cli_5168,Sess_5170,PartC_7188);
                                                        {9204}new Ns_7189: bitstring;
                                                        {9205}let gNs_7190: bitstring = exp(g,Ns_7189) in
                                                        {9206}let m2_7191: bitstring = gNs_7190 in
                                                        {9207}out(c, (enc(m2_7191,pkCli_7134),sign(m2_7191,skSess_7063)));
                                                        {9208}event beginSrv(Sess_5170,Cli_5168,gNs_7190)
                                        )
                                        else
                                            {9209}let pkDisco_7192: bitstring = fail-any in
                                            {9210}in(c, (=pkCli_7134,em1_7193: bitstring,sigM1_7194: bitstring));
                                            {9211}let m1_7195: bitstring = dec(em1_7193,skSess_7063) in
                                            {9212}if (verify(m1_7195,sigM1_7194,pkCli_7134) <> true) then
                                                0
                                            else
                                                {9213}let (SPc_7196: bitstring,PartC_7197: bitstring) = m1_7195 in
                                                {9214}event endSrv(Cli_5168,Sess_5170,PartC_7197);
                                                {9215}new Ns_7198: bitstring;
                                                {9216}let gNs_7199: bitstring = exp(g,Ns_7198) in
                                                {9217}let m2_7200: bitstring = gNs_7199 in
                                                {9218}out(c, (enc(m2_7200,pkCli_7134),sign(m2_7200,skSess_7063)));
                                                {9219}event beginSrv(Sess_5170,Cli_5168,gNs_7199)
                                    )
                                    else
                                        {9220}let v_7201: bool = (Cli_5168 = C) in
                                        (
                                            {9221}if v_7201 then
                                            (
                                                {9222}let pkCli_7202: bitstring = pub(skC) in
                                                {9223}let v_7203: bool = (Disco_5169 = A) in
                                                (
                                                    {9224}if v_7203 then
                                                    (
                                                        {9225}let pkDisco_7204: bitstring = pub(skA) in
                                                        {9226}in(c, (=pkCli_7202,em1_7205: bitstring,sigM1_7206: bitstring));
                                                        {9227}let m1_7207: bitstring = dec(em1_7205,skSess_7063) in
                                                        {9228}if (verify(m1_7207,sigM1_7206,pkCli_7202) <> true) then
                                                            0
                                                        else
                                                            {9229}let (SPc_7208: bitstring,PartC_7209: bitstring) = m1_7207 in
                                                            {9230}event endSrv(Cli_5168,Sess_5170,PartC_7209);
                                                            {9231}new Ns_7210: bitstring;
                                                            {9232}let gNs_7211: bitstring = exp(g,Ns_7210) in
                                                            {9233}let m2_7212: bitstring = gNs_7211 in
                                                            {9234}out(c, (enc(m2_7212,pkCli_7202),sign(m2_7212,skSess_7063)));
                                                            {9235}event beginSrv(Sess_5170,Cli_5168,gNs_7211)
                                                    )
                                                    else
                                                        {9236}let v_7213: bool = (Disco_5169 = B) in
                                                        (
                                                            {9237}if v_7213 then
                                                            (
                                                                {9238}let pkDisco_7214: bitstring = pub(skB) in
                                                                {9239}in(c, (=pkCli_7202,em1_7215: bitstring,sigM1_7216: bitstring));
                                                                {9240}let m1_7217: bitstring = dec(em1_7215,skSess_7063) in
                                                                {9241}if (verify(m1_7217,sigM1_7216,pkCli_7202) <> true) then
                                                                    0
                                                                else
                                                                    {9242}let (SPc_7218: bitstring,PartC_7219: bitstring) = m1_7217 in
                                                                    {9243}event endSrv(Cli_5168,Sess_5170,PartC_7219);
                                                                    {9244}new Ns_7220: bitstring;
                                                                    {9245}let gNs_7221: bitstring = exp(g,Ns_7220) in
                                                                    {9246}let m2_7222: bitstring = gNs_7221 in
                                                                    {9247}out(c, (enc(m2_7222,pkCli_7202),sign(m2_7222,skSess_7063)));
                                                                    {9248}event beginSrv(Sess_5170,Cli_5168,gNs_7221)
                                                            )
                                                            else
                                                                {9249}let v_7223: bool = (Disco_5169 = C) in
                                                                (
                                                                    {9250}if v_7223 then
                                                                    (
                                                                        {9251}let pkDisco_7224: bitstring = pub(skC) in
                                                                        {9252}in(c, (=pkCli_7202,em1_7225: bitstring,sigM1_7226: bitstring));
                                                                        {9253}let m1_7227: bitstring = dec(em1_7225,skSess_7063) in
                                                                        {9254}if (verify(m1_7227,sigM1_7226,pkCli_7202) <> true) then
                                                                            0
                                                                        else
                                                                            {9255}let (SPc_7228: bitstring,PartC_7229: bitstring) = m1_7227 in
                                                                            {9256}event endSrv(Cli_5168,Sess_5170,PartC_7229);
                                                                            {9257}new Ns_7230: bitstring;
                                                                            {9258}let gNs_7231: bitstring = exp(g,Ns_7230) in
                                                                            {9259}let m2_7232: bitstring = gNs_7231 in
                                                                            {9260}out(c, (enc(m2_7232,pkCli_7202),sign(m2_7232,skSess_7063)));
                                                                            {9261}event beginSrv(Sess_5170,Cli_5168,gNs_7231)
                                                                    )
                                                                    else
                                                                        {9262}let pkDisco_7233: bitstring = pub(skI) in
                                                                        {9263}in(c, (=pkCli_7202,em1_7234: bitstring,sigM1_7235: bitstring));
                                                                        {9264}let m1_7236: bitstring = dec(em1_7234,skSess_7063) in
                                                                        {9265}if (verify(m1_7236,sigM1_7235,pkCli_7202) <> true) then
                                                                            0
                                                                        else
                                                                            {9266}let (SPc_7237: bitstring,PartC_7238: bitstring) = m1_7236 in
                                                                            {9267}event endSrv(Cli_5168,Sess_5170,PartC_7238);
                                                                            {9268}new Ns_7239: bitstring;
                                                                            {9269}let gNs_7240: bitstring = exp(g,Ns_7239) in
                                                                            {9270}let m2_7241: bitstring = gNs_7240 in
                                                                            {9271}out(c, (enc(m2_7241,pkCli_7202),sign(m2_7241,skSess_7063)));
                                                                            {9272}event beginSrv(Sess_5170,Cli_5168,gNs_7240)
                                                                )
                                                                else
                                                                    {9273}let pkDisco_7242: bitstring = fail-any in
                                                                    {9274}in(c, (=pkCli_7202,em1_7243: bitstring,sigM1_7244: bitstring));
                                                                    {9275}let m1_7245: bitstring = dec(em1_7243,skSess_7063) in
                                                                    {9276}if (verify(m1_7245,sigM1_7244,pkCli_7202) <> true) then
                                                                        0
                                                                    else
                                                                        {9277}let (SPc_7246: bitstring,PartC_7247: bitstring) = m1_7245 in
                                                                        {9278}event endSrv(Cli_5168,Sess_5170,PartC_7247);
                                                                        {9279}new Ns_7248: bitstring;
                                                                        {9280}let gNs_7249: bitstring = exp(g,Ns_7248) in
                                                                        {9281}let m2_7250: bitstring = gNs_7249 in
                                                                        {9282}out(c, (enc(m2_7250,pkCli_7202),sign(m2_7250,skSess_7063)));
                                                                        {9283}event beginSrv(Sess_5170,Cli_5168,gNs_7249)
                                                        )
                                                        else
                                                            {9284}let pkDisco_7251: bitstring = fail-any in
                                                            {9285}in(c, (=pkCli_7202,em1_7252: bitstring,sigM1_7253: bitstring));
                                                            {9286}let m1_7254: bitstring = dec(em1_7252,skSess_7063) in
                                                            {9287}if (verify(m1_7254,sigM1_7253,pkCli_7202) <> true) then
                                                                0
                                                            else
                                                                {9288}let (SPc_7255: bitstring,PartC_7256: bitstring) = m1_7254 in
                                                                {9289}event endSrv(Cli_5168,Sess_5170,PartC_7256);
                                                                {9290}new Ns_7257: bitstring;
                                                                {9291}let gNs_7258: bitstring = exp(g,Ns_7257) in
                                                                {9292}let m2_7259: bitstring = gNs_7258 in
                                                                {9293}out(c, (enc(m2_7259,pkCli_7202),sign(m2_7259,skSess_7063)));
                                                                {9294}event beginSrv(Sess_5170,Cli_5168,gNs_7258)
                                                )
                                                else
                                                    {9295}let pkDisco_7260: bitstring = fail-any in
                                                    {9296}in(c, (=pkCli_7202,em1_7261: bitstring,sigM1_7262: bitstring));
                                                    {9297}let m1_7263: bitstring = dec(em1_7261,skSess_7063) in
                                                    {9298}if (verify(m1_7263,sigM1_7262,pkCli_7202) <> true) then
                                                        0
                                                    else
                                                        {9299}let (SPc_7264: bitstring,PartC_7265: bitstring) = m1_7263 in
                                                        {9300}event endSrv(Cli_5168,Sess_5170,PartC_7265);
                                                        {9301}new Ns_7266: bitstring;
                                                        {9302}let gNs_7267: bitstring = exp(g,Ns_7266) in
                                                        {9303}let m2_7268: bitstring = gNs_7267 in
                                                        {9304}out(c, (enc(m2_7268,pkCli_7202),sign(m2_7268,skSess_7063)));
                                                        {9305}event beginSrv(Sess_5170,Cli_5168,gNs_7267)
                                            )
                                            else
                                                {9306}let pkCli_7269: bitstring = pub(skI) in
                                                {9307}let v_7270: bool = (Disco_5169 = A) in
                                                (
                                                    {9308}if v_7270 then
                                                    (
                                                        {9309}let pkDisco_7271: bitstring = pub(skA) in
                                                        {9310}in(c, (=pkCli_7269,em1_7272: bitstring,sigM1_7273: bitstring));
                                                        {9311}let m1_7274: bitstring = dec(em1_7272,skSess_7063) in
                                                        {9312}if (verify(m1_7274,sigM1_7273,pkCli_7269) <> true) then
                                                            0
                                                        else
                                                            {9313}let (SPc_7275: bitstring,PartC_7276: bitstring) = m1_7274 in
                                                            {9314}event endSrv(Cli_5168,Sess_5170,PartC_7276);
                                                            {9315}new Ns_7277: bitstring;
                                                            {9316}let gNs_7278: bitstring = exp(g,Ns_7277) in
                                                            {9317}let m2_7279: bitstring = gNs_7278 in
                                                            {9318}out(c, (enc(m2_7279,pkCli_7269),sign(m2_7279,skSess_7063)));
                                                            {9319}event beginSrv(Sess_5170,Cli_5168,gNs_7278)
                                                    )
                                                    else
                                                        {9320}let v_7280: bool = (Disco_5169 = B) in
                                                        (
                                                            {9321}if v_7280 then
                                                            (
                                                                {9322}let pkDisco_7281: bitstring = pub(skB) in
                                                                {9323}in(c, (=pkCli_7269,em1_7282: bitstring,sigM1_7283: bitstring));
                                                                {9324}let m1_7284: bitstring = dec(em1_7282,skSess_7063) in
                                                                {9325}if (verify(m1_7284,sigM1_7283,pkCli_7269) <> true) then
                                                                    0
                                                                else
                                                                    {9326}let (SPc_7285: bitstring,PartC_7286: bitstring) = m1_7284 in
                                                                    {9327}event endSrv(Cli_5168,Sess_5170,PartC_7286);
                                                                    {9328}new Ns_7287: bitstring;
                                                                    {9329}let gNs_7288: bitstring = exp(g,Ns_7287) in
                                                                    {9330}let m2_7289: bitstring = gNs_7288 in
                                                                    {9331}out(c, (enc(m2_7289,pkCli_7269),sign(m2_7289,skSess_7063)));
                                                                    {9332}event beginSrv(Sess_5170,Cli_5168,gNs_7288)
                                                            )
                                                            else
                                                                {9333}let v_7290: bool = (Disco_5169 = C) in
                                                                (
                                                                    {9334}if v_7290 then
                                                                    (
                                                                        {9335}let pkDisco_7291: bitstring = pub(skC) in
                                                                        {9336}in(c, (=pkCli_7269,em1_7292: bitstring,sigM1_7293: bitstring));
                                                                        {9337}let m1_7294: bitstring = dec(em1_7292,skSess_7063) in
                                                                        {9338}if (verify(m1_7294,sigM1_7293,pkCli_7269) <> true) then
                                                                            0
                                                                        else
                                                                            {9339}let (SPc_7295: bitstring,PartC_7296: bitstring) = m1_7294 in
                                                                            {9340}event endSrv(Cli_5168,Sess_5170,PartC_7296);
                                                                            {9341}new Ns_7297: bitstring;
                                                                            {9342}let gNs_7298: bitstring = exp(g,Ns_7297) in
                                                                            {9343}let m2_7299: bitstring = gNs_7298 in
                                                                            {9344}out(c, (enc(m2_7299,pkCli_7269),sign(m2_7299,skSess_7063)));
                                                                            {9345}event beginSrv(Sess_5170,Cli_5168,gNs_7298)
                                                                    )
                                                                    else
                                                                        {9346}let pkDisco_7300: bitstring = pub(skI) in
                                                                        {9347}in(c, (=pkCli_7269,em1_7301: bitstring,sigM1_7302: bitstring));
                                                                        {9348}let m1_7303: bitstring = dec(em1_7301,skSess_7063) in
                                                                        {9349}if (verify(m1_7303,sigM1_7302,pkCli_7269) <> true) then
                                                                            0
                                                                        else
                                                                            {9350}let (SPc_7304: bitstring,PartC_7305: bitstring) = m1_7303 in
                                                                            {9351}event endSrv(Cli_5168,Sess_5170,PartC_7305);
                                                                            {9352}new Ns_7306: bitstring;
                                                                            {9353}let gNs_7307: bitstring = exp(g,Ns_7306) in
                                                                            {9354}let m2_7308: bitstring = gNs_7307 in
                                                                            {9355}out(c, (enc(m2_7308,pkCli_7269),sign(m2_7308,skSess_7063)));
                                                                            {9356}event beginSrv(Sess_5170,Cli_5168,gNs_7307)
                                                                )
                                                                else
                                                                    {9357}let pkDisco_7309: bitstring = fail-any in
                                                                    {9358}in(c, (=pkCli_7269,em1_7310: bitstring,sigM1_7311: bitstring));
                                                                    {9359}let m1_7312: bitstring = dec(em1_7310,skSess_7063) in
                                                                    {9360}if (verify(m1_7312,sigM1_7311,pkCli_7269) <> true) then
                                                                        0
                                                                    else
                                                                        {9361}let (SPc_7313: bitstring,PartC_7314: bitstring) = m1_7312 in
                                                                        {9362}event endSrv(Cli_5168,Sess_5170,PartC_7314);
                                                                        {9363}new Ns_7315: bitstring;
                                                                        {9364}let gNs_7316: bitstring = exp(g,Ns_7315) in
                                                                        {9365}let m2_7317: bitstring = gNs_7316 in
                                                                        {9366}out(c, (enc(m2_7317,pkCli_7269),sign(m2_7317,skSess_7063)));
                                                                        {9367}event beginSrv(Sess_5170,Cli_5168,gNs_7316)
                                                        )
                                                        else
                                                            {9368}let pkDisco_7318: bitstring = fail-any in
                                                            {9369}in(c, (=pkCli_7269,em1_7319: bitstring,sigM1_7320: bitstring));
                                                            {9370}let m1_7321: bitstring = dec(em1_7319,skSess_7063) in
                                                            {9371}if (verify(m1_7321,sigM1_7320,pkCli_7269) <> true) then
                                                                0
                                                            else
                                                                {9372}let (SPc_7322: bitstring,PartC_7323: bitstring) = m1_7321 in
                                                                {9373}event endSrv(Cli_5168,Sess_5170,PartC_7323);
                                                                {9374}new Ns_7324: bitstring;
                                                                {9375}let gNs_7325: bitstring = exp(g,Ns_7324) in
                                                                {9376}let m2_7326: bitstring = gNs_7325 in
                                                                {9377}out(c, (enc(m2_7326,pkCli_7269),sign(m2_7326,skSess_7063)));
                                                                {9378}event beginSrv(Sess_5170,Cli_5168,gNs_7325)
                                                )
                                                else
                                                    {9379}let pkDisco_7327: bitstring = fail-any in
                                                    {9380}in(c, (=pkCli_7269,em1_7328: bitstring,sigM1_7329: bitstring));
                                                    {9381}let m1_7330: bitstring = dec(em1_7328,skSess_7063) in
                                                    {9382}if (verify(m1_7330,sigM1_7329,pkCli_7269) <> true) then
                                                        0
                                                    else
                                                        {9383}let (SPc_7331: bitstring,PartC_7332: bitstring) = m1_7330 in
                                                        {9384}event endSrv(Cli_5168,Sess_5170,PartC_7332);
                                                        {9385}new Ns_7333: bitstring;
                                                        {9386}let gNs_7334: bitstring = exp(g,Ns_7333) in
                                                        {9387}let m2_7335: bitstring = gNs_7334 in
                                                        {9388}out(c, (enc(m2_7335,pkCli_7269),sign(m2_7335,skSess_7063)));
                                                        {9389}event beginSrv(Sess_5170,Cli_5168,gNs_7334)
                                        )
                                        else
                                            {9390}let pkCli_7336: bitstring = fail-any in
                                            {9391}let v_7337: bool = (Disco_5169 = A) in
                                            (
                                                {9392}if v_7337 then
                                                (
                                                    {9393}let pkDisco_7338: bitstring = pub(skA) in
                                                    {9394}in(c, (=pkCli_7336,em1_7339: bitstring,sigM1_7340: bitstring));
                                                    {9395}let m1_7341: bitstring = dec(em1_7339,skSess_7063) in
                                                    {9396}if (verify(m1_7341,sigM1_7340,pkCli_7336) <> true) then
                                                        0
                                                    else
                                                        {9397}let (SPc_7342: bitstring,PartC_7343: bitstring) = m1_7341 in
                                                        {9398}event endSrv(Cli_5168,Sess_5170,PartC_7343);
                                                        {9399}new Ns_7344: bitstring;
                                                        {9400}let gNs_7345: bitstring = exp(g,Ns_7344) in
                                                        {9401}let m2_7346: bitstring = gNs_7345 in
                                                        {9402}out(c, (enc(m2_7346,pkCli_7336),sign(m2_7346,skSess_7063)));
                                                        {9403}event beginSrv(Sess_5170,Cli_5168,gNs_7345)
                                                )
                                                else
                                                    {9404}let v_7347: bool = (Disco_5169 = B) in
                                                    (
                                                        {9405}if v_7347 then
                                                        (
                                                            {9406}let pkDisco_7348: bitstring = pub(skB) in
                                                            {9407}in(c, (=pkCli_7336,em1_7349: bitstring,sigM1_7350: bitstring));
                                                            {9408}let m1_7351: bitstring = dec(em1_7349,skSess_7063) in
                                                            {9409}if (verify(m1_7351,sigM1_7350,pkCli_7336) <> true) then
                                                                0
                                                            else
                                                                {9410}let (SPc_7352: bitstring,PartC_7353: bitstring) = m1_7351 in
                                                                {9411}event endSrv(Cli_5168,Sess_5170,PartC_7353);
                                                                {9412}new Ns_7354: bitstring;
                                                                {9413}let gNs_7355: bitstring = exp(g,Ns_7354) in
                                                                {9414}let m2_7356: bitstring = gNs_7355 in
                                                                {9415}out(c, (enc(m2_7356,pkCli_7336),sign(m2_7356,skSess_7063)));
                                                                {9416}event beginSrv(Sess_5170,Cli_5168,gNs_7355)
                                                        )
                                                        else
                                                            {9417}let v_7357: bool = (Disco_5169 = C) in
                                                            (
                                                                {9418}if v_7357 then
                                                                (
                                                                    {9419}let pkDisco_7358: bitstring = pub(skC) in
                                                                    {9420}in(c, (=pkCli_7336,em1_7359: bitstring,sigM1_7360: bitstring));
                                                                    {9421}let m1_7361: bitstring = dec(em1_7359,skSess_7063) in
                                                                    {9422}if (verify(m1_7361,sigM1_7360,pkCli_7336) <> true) then
                                                                        0
                                                                    else
                                                                        {9423}let (SPc_7362: bitstring,PartC_7363: bitstring) = m1_7361 in
                                                                        {9424}event endSrv(Cli_5168,Sess_5170,PartC_7363);
                                                                        {9425}new Ns_7364: bitstring;
                                                                        {9426}let gNs_7365: bitstring = exp(g,Ns_7364) in
                                                                        {9427}let m2_7366: bitstring = gNs_7365 in
                                                                        {9428}out(c, (enc(m2_7366,pkCli_7336),sign(m2_7366,skSess_7063)));
                                                                        {9429}event beginSrv(Sess_5170,Cli_5168,gNs_7365)
                                                                )
                                                                else
                                                                    {9430}let pkDisco_7367: bitstring = pub(skI) in
                                                                    {9431}in(c, (=pkCli_7336,em1_7368: bitstring,sigM1_7369: bitstring));
                                                                    {9432}let m1_7370: bitstring = dec(em1_7368,skSess_7063) in
                                                                    {9433}if (verify(m1_7370,sigM1_7369,pkCli_7336) <> true) then
                                                                        0
                                                                    else
                                                                        {9434}let (SPc_7371: bitstring,PartC_7372: bitstring) = m1_7370 in
                                                                        {9435}event endSrv(Cli_5168,Sess_5170,PartC_7372);
                                                                        {9436}new Ns_7373: bitstring;
                                                                        {9437}let gNs_7374: bitstring = exp(g,Ns_7373) in
                                                                        {9438}let m2_7375: bitstring = gNs_7374 in
                                                                        {9439}out(c, (enc(m2_7375,pkCli_7336),sign(m2_7375,skSess_7063)));
                                                                        {9440}event beginSrv(Sess_5170,Cli_5168,gNs_7374)
                                                            )
                                                            else
                                                                {9441}let pkDisco_7376: bitstring = fail-any in
                                                                {9442}in(c, (=pkCli_7336,em1_7377: bitstring,sigM1_7378: bitstring));
                                                                {9443}let m1_7379: bitstring = dec(em1_7377,skSess_7063) in
                                                                {9444}if (verify(m1_7379,sigM1_7378,pkCli_7336) <> true) then
                                                                    0
                                                                else
                                                                    {9445}let (SPc_7380: bitstring,PartC_7381: bitstring) = m1_7379 in
                                                                    {9446}event endSrv(Cli_5168,Sess_5170,PartC_7381);
                                                                    {9447}new Ns_7382: bitstring;
                                                                    {9448}let gNs_7383: bitstring = exp(g,Ns_7382) in
                                                                    {9449}let m2_7384: bitstring = gNs_7383 in
                                                                    {9450}out(c, (enc(m2_7384,pkCli_7336),sign(m2_7384,skSess_7063)));
                                                                    {9451}event beginSrv(Sess_5170,Cli_5168,gNs_7383)
                                                    )
                                                    else
                                                        {9452}let pkDisco_7385: bitstring = fail-any in
                                                        {9453}in(c, (=pkCli_7336,em1_7386: bitstring,sigM1_7387: bitstring));
                                                        {9454}let m1_7388: bitstring = dec(em1_7386,skSess_7063) in
                                                        {9455}if (verify(m1_7388,sigM1_7387,pkCli_7336) <> true) then
                                                            0
                                                        else
                                                            {9456}let (SPc_7389: bitstring,PartC_7390: bitstring) = m1_7388 in
                                                            {9457}event endSrv(Cli_5168,Sess_5170,PartC_7390);
                                                            {9458}new Ns_7391: bitstring;
                                                            {9459}let gNs_7392: bitstring = exp(g,Ns_7391) in
                                                            {9460}let m2_7393: bitstring = gNs_7392 in
                                                            {9461}out(c, (enc(m2_7393,pkCli_7336),sign(m2_7393,skSess_7063)));
                                                            {9462}event beginSrv(Sess_5170,Cli_5168,gNs_7392)
                                            )
                                            else
                                                {9463}let pkDisco_7394: bitstring = fail-any in
                                                {9464}in(c, (=pkCli_7336,em1_7395: bitstring,sigM1_7396: bitstring));
                                                {9465}let m1_7397: bitstring = dec(em1_7395,skSess_7063) in
                                                {9466}if (verify(m1_7397,sigM1_7396,pkCli_7336) <> true) then
                                                    0
                                                else
                                                    {9467}let (SPc_7398: bitstring,PartC_7399: bitstring) = m1_7397 in
                                                    {9468}event endSrv(Cli_5168,Sess_5170,PartC_7399);
                                                    {9469}new Ns_7400: bitstring;
                                                    {9470}let gNs_7401: bitstring = exp(g,Ns_7400) in
                                                    {9471}let m2_7402: bitstring = gNs_7401 in
                                                    {9472}out(c, (enc(m2_7402,pkCli_7336),sign(m2_7402,skSess_7063)));
                                                    {9473}event beginSrv(Sess_5170,Cli_5168,gNs_7401)
                                )
                                else
                                    {9474}let pkCli_7403: bitstring = fail-any in
                                    {9475}let v_7404: bool = (Disco_5169 = A) in
                                    (
                                        {9476}if v_7404 then
                                        (
                                            {9477}let pkDisco_7405: bitstring = pub(skA) in
                                            {9478}in(c, (=pkCli_7403,em1_7406: bitstring,sigM1_7407: bitstring));
                                            {9479}let m1_7408: bitstring = dec(em1_7406,skSess_7063) in
                                            {9480}if (verify(m1_7408,sigM1_7407,pkCli_7403) <> true) then
                                                0
                                            else
                                                {9481}let (SPc_7409: bitstring,PartC_7410: bitstring) = m1_7408 in
                                                {9482}event endSrv(Cli_5168,Sess_5170,PartC_7410);
                                                {9483}new Ns_7411: bitstring;
                                                {9484}let gNs_7412: bitstring = exp(g,Ns_7411) in
                                                {9485}let m2_7413: bitstring = gNs_7412 in
                                                {9486}out(c, (enc(m2_7413,pkCli_7403),sign(m2_7413,skSess_7063)));
                                                {9487}event beginSrv(Sess_5170,Cli_5168,gNs_7412)
                                        )
                                        else
                                            {9488}let v_7414: bool = (Disco_5169 = B) in
                                            (
                                                {9489}if v_7414 then
                                                (
                                                    {9490}let pkDisco_7415: bitstring = pub(skB) in
                                                    {9491}in(c, (=pkCli_7403,em1_7416: bitstring,sigM1_7417: bitstring));
                                                    {9492}let m1_7418: bitstring = dec(em1_7416,skSess_7063) in
                                                    {9493}if (verify(m1_7418,sigM1_7417,pkCli_7403) <> true) then
                                                        0
                                                    else
                                                        {9494}let (SPc_7419: bitstring,PartC_7420: bitstring) = m1_7418 in
                                                        {9495}event endSrv(Cli_5168,Sess_5170,PartC_7420);
                                                        {9496}new Ns_7421: bitstring;
                                                        {9497}let gNs_7422: bitstring = exp(g,Ns_7421) in
                                                        {9498}let m2_7423: bitstring = gNs_7422 in
                                                        {9499}out(c, (enc(m2_7423,pkCli_7403),sign(m2_7423,skSess_7063)));
                                                        {9500}event beginSrv(Sess_5170,Cli_5168,gNs_7422)
                                                )
                                                else
                                                    {9501}let v_7424: bool = (Disco_5169 = C) in
                                                    (
                                                        {9502}if v_7424 then
                                                        (
                                                            {9503}let pkDisco_7425: bitstring = pub(skC) in
                                                            {9504}in(c, (=pkCli_7403,em1_7426: bitstring,sigM1_7427: bitstring));
                                                            {9505}let m1_7428: bitstring = dec(em1_7426,skSess_7063) in
                                                            {9506}if (verify(m1_7428,sigM1_7427,pkCli_7403) <> true) then
                                                                0
                                                            else
                                                                {9507}let (SPc_7429: bitstring,PartC_7430: bitstring) = m1_7428 in
                                                                {9508}event endSrv(Cli_5168,Sess_5170,PartC_7430);
                                                                {9509}new Ns_7431: bitstring;
                                                                {9510}let gNs_7432: bitstring = exp(g,Ns_7431) in
                                                                {9511}let m2_7433: bitstring = gNs_7432 in
                                                                {9512}out(c, (enc(m2_7433,pkCli_7403),sign(m2_7433,skSess_7063)));
                                                                {9513}event beginSrv(Sess_5170,Cli_5168,gNs_7432)
                                                        )
                                                        else
                                                            {9514}let pkDisco_7434: bitstring = pub(skI) in
                                                            {9515}in(c, (=pkCli_7403,em1_7435: bitstring,sigM1_7436: bitstring));
                                                            {9516}let m1_7437: bitstring = dec(em1_7435,skSess_7063) in
                                                            {9517}if (verify(m1_7437,sigM1_7436,pkCli_7403) <> true) then
                                                                0
                                                            else
                                                                {9518}let (SPc_7438: bitstring,PartC_7439: bitstring) = m1_7437 in
                                                                {9519}event endSrv(Cli_5168,Sess_5170,PartC_7439);
                                                                {9520}new Ns_7440: bitstring;
                                                                {9521}let gNs_7441: bitstring = exp(g,Ns_7440) in
                                                                {9522}let m2_7442: bitstring = gNs_7441 in
                                                                {9523}out(c, (enc(m2_7442,pkCli_7403),sign(m2_7442,skSess_7063)));
                                                                {9524}event beginSrv(Sess_5170,Cli_5168,gNs_7441)
                                                    )
                                                    else
                                                        {9525}let pkDisco_7443: bitstring = fail-any in
                                                        {9526}in(c, (=pkCli_7403,em1_7444: bitstring,sigM1_7445: bitstring));
                                                        {9527}let m1_7446: bitstring = dec(em1_7444,skSess_7063) in
                                                        {9528}if (verify(m1_7446,sigM1_7445,pkCli_7403) <> true) then
                                                            0
                                                        else
                                                            {9529}let (SPc_7447: bitstring,PartC_7448: bitstring) = m1_7446 in
                                                            {9530}event endSrv(Cli_5168,Sess_5170,PartC_7448);
                                                            {9531}new Ns_7449: bitstring;
                                                            {9532}let gNs_7450: bitstring = exp(g,Ns_7449) in
                                                            {9533}let m2_7451: bitstring = gNs_7450 in
                                                            {9534}out(c, (enc(m2_7451,pkCli_7403),sign(m2_7451,skSess_7063)));
                                                            {9535}event beginSrv(Sess_5170,Cli_5168,gNs_7450)
                                            )
                                            else
                                                {9536}let pkDisco_7452: bitstring = fail-any in
                                                {9537}in(c, (=pkCli_7403,em1_7453: bitstring,sigM1_7454: bitstring));
                                                {9538}let m1_7455: bitstring = dec(em1_7453,skSess_7063) in
                                                {9539}if (verify(m1_7455,sigM1_7454,pkCli_7403) <> true) then
                                                    0
                                                else
                                                    {9540}let (SPc_7456: bitstring,PartC_7457: bitstring) = m1_7455 in
                                                    {9541}event endSrv(Cli_5168,Sess_5170,PartC_7457);
                                                    {9542}new Ns_7458: bitstring;
                                                    {9543}let gNs_7459: bitstring = exp(g,Ns_7458) in
                                                    {9544}let m2_7460: bitstring = gNs_7459 in
                                                    {9545}out(c, (enc(m2_7460,pkCli_7403),sign(m2_7460,skSess_7063)));
                                                    {9546}event beginSrv(Sess_5170,Cli_5168,gNs_7459)
                                    )
                                    else
                                        {9547}let pkDisco_7461: bitstring = fail-any in
                                        {9548}in(c, (=pkCli_7403,em1_7462: bitstring,sigM1_7463: bitstring));
                                        {9549}let m1_7464: bitstring = dec(em1_7462,skSess_7063) in
                                        {9550}if (verify(m1_7464,sigM1_7463,pkCli_7403) <> true) then
                                            0
                                        else
                                            {9551}let (SPc_7465: bitstring,PartC_7466: bitstring) = m1_7464 in
                                            {9552}event endSrv(Cli_5168,Sess_5170,PartC_7466);
                                            {9553}new Ns_7467: bitstring;
                                            {9554}let gNs_7468: bitstring = exp(g,Ns_7467) in
                                            {9555}let m2_7469: bitstring = gNs_7468 in
                                            {9556}out(c, (enc(m2_7469,pkCli_7403),sign(m2_7469,skSess_7063)));
                                            {9557}event beginSrv(Sess_5170,Cli_5168,gNs_7468)
                        )
                        else
                            {9558}let pkCli_7470: bitstring = fail-any in
                            {9559}let v_7471: bool = (Disco_5169 = A) in
                            (
                                {9560}if v_7471 then
                                (
                                    {9561}let pkDisco_7472: bitstring = pub(skA) in
                                    {9562}in(c, (=pkCli_7470,em1_7473: bitstring,sigM1_7474: bitstring));
                                    {9563}let m1_7475: bitstring = dec(em1_7473,skSess_7063) in
                                    {9564}if (verify(m1_7475,sigM1_7474,pkCli_7470) <> true) then
                                        0
                                    else
                                        {9565}let (SPc_7476: bitstring,PartC_7477: bitstring) = m1_7475 in
                                        {9566}event endSrv(Cli_5168,Sess_5170,PartC_7477);
                                        {9567}new Ns_7478: bitstring;
                                        {9568}let gNs_7479: bitstring = exp(g,Ns_7478) in
                                        {9569}let m2_7480: bitstring = gNs_7479 in
                                        {9570}out(c, (enc(m2_7480,pkCli_7470),sign(m2_7480,skSess_7063)));
                                        {9571}event beginSrv(Sess_5170,Cli_5168,gNs_7479)
                                )
                                else
                                    {9572}let v_7481: bool = (Disco_5169 = B) in
                                    (
                                        {9573}if v_7481 then
                                        (
                                            {9574}let pkDisco_7482: bitstring = pub(skB) in
                                            {9575}in(c, (=pkCli_7470,em1_7483: bitstring,sigM1_7484: bitstring));
                                            {9576}let m1_7485: bitstring = dec(em1_7483,skSess_7063) in
                                            {9577}if (verify(m1_7485,sigM1_7484,pkCli_7470) <> true) then
                                                0
                                            else
                                                {9578}let (SPc_7486: bitstring,PartC_7487: bitstring) = m1_7485 in
                                                {9579}event endSrv(Cli_5168,Sess_5170,PartC_7487);
                                                {9580}new Ns_7488: bitstring;
                                                {9581}let gNs_7489: bitstring = exp(g,Ns_7488) in
                                                {9582}let m2_7490: bitstring = gNs_7489 in
                                                {9583}out(c, (enc(m2_7490,pkCli_7470),sign(m2_7490,skSess_7063)));
                                                {9584}event beginSrv(Sess_5170,Cli_5168,gNs_7489)
                                        )
                                        else
                                            {9585}let v_7491: bool = (Disco_5169 = C) in
                                            (
                                                {9586}if v_7491 then
                                                (
                                                    {9587}let pkDisco_7492: bitstring = pub(skC) in
                                                    {9588}in(c, (=pkCli_7470,em1_7493: bitstring,sigM1_7494: bitstring));
                                                    {9589}let m1_7495: bitstring = dec(em1_7493,skSess_7063) in
                                                    {9590}if (verify(m1_7495,sigM1_7494,pkCli_7470) <> true) then
                                                        0
                                                    else
                                                        {9591}let (SPc_7496: bitstring,PartC_7497: bitstring) = m1_7495 in
                                                        {9592}event endSrv(Cli_5168,Sess_5170,PartC_7497);
                                                        {9593}new Ns_7498: bitstring;
                                                        {9594}let gNs_7499: bitstring = exp(g,Ns_7498) in
                                                        {9595}let m2_7500: bitstring = gNs_7499 in
                                                        {9596}out(c, (enc(m2_7500,pkCli_7470),sign(m2_7500,skSess_7063)));
                                                        {9597}event beginSrv(Sess_5170,Cli_5168,gNs_7499)
                                                )
                                                else
                                                    {9598}let pkDisco_7501: bitstring = pub(skI) in
                                                    {9599}in(c, (=pkCli_7470,em1_7502: bitstring,sigM1_7503: bitstring));
                                                    {9600}let m1_7504: bitstring = dec(em1_7502,skSess_7063) in
                                                    {9601}if (verify(m1_7504,sigM1_7503,pkCli_7470) <> true) then
                                                        0
                                                    else
                                                        {9602}let (SPc_7505: bitstring,PartC_7506: bitstring) = m1_7504 in
                                                        {9603}event endSrv(Cli_5168,Sess_5170,PartC_7506);
                                                        {9604}new Ns_7507: bitstring;
                                                        {9605}let gNs_7508: bitstring = exp(g,Ns_7507) in
                                                        {9606}let m2_7509: bitstring = gNs_7508 in
                                                        {9607}out(c, (enc(m2_7509,pkCli_7470),sign(m2_7509,skSess_7063)));
                                                        {9608}event beginSrv(Sess_5170,Cli_5168,gNs_7508)
                                            )
                                            else
                                                {9609}let pkDisco_7510: bitstring = fail-any in
                                                {9610}in(c, (=pkCli_7470,em1_7511: bitstring,sigM1_7512: bitstring));
                                                {9611}let m1_7513: bitstring = dec(em1_7511,skSess_7063) in
                                                {9612}if (verify(m1_7513,sigM1_7512,pkCli_7470) <> true) then
                                                    0
                                                else
                                                    {9613}let (SPc_7514: bitstring,PartC_7515: bitstring) = m1_7513 in
                                                    {9614}event endSrv(Cli_5168,Sess_5170,PartC_7515);
                                                    {9615}new Ns_7516: bitstring;
                                                    {9616}let gNs_7517: bitstring = exp(g,Ns_7516) in
                                                    {9617}let m2_7518: bitstring = gNs_7517 in
                                                    {9618}out(c, (enc(m2_7518,pkCli_7470),sign(m2_7518,skSess_7063)));
                                                    {9619}event beginSrv(Sess_5170,Cli_5168,gNs_7517)
                                    )
                                    else
                                        {9620}let pkDisco_7519: bitstring = fail-any in
                                        {9621}in(c, (=pkCli_7470,em1_7520: bitstring,sigM1_7521: bitstring));
                                        {9622}let m1_7522: bitstring = dec(em1_7520,skSess_7063) in
                                        {9623}if (verify(m1_7522,sigM1_7521,pkCli_7470) <> true) then
                                            0
                                        else
                                            {9624}let (SPc_7523: bitstring,PartC_7524: bitstring) = m1_7522 in
                                            {9625}event endSrv(Cli_5168,Sess_5170,PartC_7524);
                                            {9626}new Ns_7525: bitstring;
                                            {9627}let gNs_7526: bitstring = exp(g,Ns_7525) in
                                            {9628}let m2_7527: bitstring = gNs_7526 in
                                            {9629}out(c, (enc(m2_7527,pkCli_7470),sign(m2_7527,skSess_7063)));
                                            {9630}event beginSrv(Sess_5170,Cli_5168,gNs_7526)
                            )
                            else
                                {9631}let pkDisco_7528: bitstring = fail-any in
                                {9632}in(c, (=pkCli_7470,em1_7529: bitstring,sigM1_7530: bitstring));
                                {9633}let m1_7531: bitstring = dec(em1_7529,skSess_7063) in
                                {9634}if (verify(m1_7531,sigM1_7530,pkCli_7470) <> true) then
                                    0
                                else
                                    {9635}let (SPc_7532: bitstring,PartC_7533: bitstring) = m1_7531 in
                                    {9636}event endSrv(Cli_5168,Sess_5170,PartC_7533);
                                    {9637}new Ns_7534: bitstring;
                                    {9638}let gNs_7535: bitstring = exp(g,Ns_7534) in
                                    {9639}let m2_7536: bitstring = gNs_7535 in
                                    {9640}out(c, (enc(m2_7536,pkCli_7470),sign(m2_7536,skSess_7063)));
                                    {9641}event beginSrv(Sess_5170,Cli_5168,gNs_7535)
            )
            else
                {9642}let skSess_7537: bitstring = fail-any in
                {9643}let pkSess_7538: bitstring = pub(skSess_7537) in
                {9644}let v_7539: bool = (Cli_5168 = A) in
                (
                    {9645}if v_7539 then
                    (
                        {9646}let pkCli_7540: bitstring = pub(skA) in
                        {9647}let v_7541: bool = (Disco_5169 = A) in
                        (
                            {9648}if v_7541 then
                            (
                                {9649}let pkDisco_7542: bitstring = pub(skA) in
                                {9650}in(c, (=pkCli_7540,em1_7543: bitstring,sigM1_7544: bitstring));
                                {9651}let m1_7545: bitstring = dec(em1_7543,skSess_7537) in
                                {9652}if (verify(m1_7545,sigM1_7544,pkCli_7540) <> true) then
                                    0
                                else
                                    {9653}let (SPc_7546: bitstring,PartC_7547: bitstring) = m1_7545 in
                                    {9654}event endSrv(Cli_5168,Sess_5170,PartC_7547);
                                    {9655}new Ns_7548: bitstring;
                                    {9656}let gNs_7549: bitstring = exp(g,Ns_7548) in
                                    {9657}let m2_7550: bitstring = gNs_7549 in
                                    {9658}out(c, (enc(m2_7550,pkCli_7540),sign(m2_7550,skSess_7537)));
                                    {9659}event beginSrv(Sess_5170,Cli_5168,gNs_7549)
                            )
                            else
                                {9660}let v_7551: bool = (Disco_5169 = B) in
                                (
                                    {9661}if v_7551 then
                                    (
                                        {9662}let pkDisco_7552: bitstring = pub(skB) in
                                        {9663}in(c, (=pkCli_7540,em1_7553: bitstring,sigM1_7554: bitstring));
                                        {9664}let m1_7555: bitstring = dec(em1_7553,skSess_7537) in
                                        {9665}if (verify(m1_7555,sigM1_7554,pkCli_7540) <> true) then
                                            0
                                        else
                                            {9666}let (SPc_7556: bitstring,PartC_7557: bitstring) = m1_7555 in
                                            {9667}event endSrv(Cli_5168,Sess_5170,PartC_7557);
                                            {9668}new Ns_7558: bitstring;
                                            {9669}let gNs_7559: bitstring = exp(g,Ns_7558) in
                                            {9670}let m2_7560: bitstring = gNs_7559 in
                                            {9671}out(c, (enc(m2_7560,pkCli_7540),sign(m2_7560,skSess_7537)));
                                            {9672}event beginSrv(Sess_5170,Cli_5168,gNs_7559)
                                    )
                                    else
                                        {9673}let v_7561: bool = (Disco_5169 = C) in
                                        (
                                            {9674}if v_7561 then
                                            (
                                                {9675}let pkDisco_7562: bitstring = pub(skC) in
                                                {9676}in(c, (=pkCli_7540,em1_7563: bitstring,sigM1_7564: bitstring));
                                                {9677}let m1_7565: bitstring = dec(em1_7563,skSess_7537) in
                                                {9678}if (verify(m1_7565,sigM1_7564,pkCli_7540) <> true) then
                                                    0
                                                else
                                                    {9679}let (SPc_7566: bitstring,PartC_7567: bitstring) = m1_7565 in
                                                    {9680}event endSrv(Cli_5168,Sess_5170,PartC_7567);
                                                    {9681}new Ns_7568: bitstring;
                                                    {9682}let gNs_7569: bitstring = exp(g,Ns_7568) in
                                                    {9683}let m2_7570: bitstring = gNs_7569 in
                                                    {9684}out(c, (enc(m2_7570,pkCli_7540),sign(m2_7570,skSess_7537)));
                                                    {9685}event beginSrv(Sess_5170,Cli_5168,gNs_7569)
                                            )
                                            else
                                                {9686}let pkDisco_7571: bitstring = pub(skI) in
                                                {9687}in(c, (=pkCli_7540,em1_7572: bitstring,sigM1_7573: bitstring));
                                                {9688}let m1_7574: bitstring = dec(em1_7572,skSess_7537) in
                                                {9689}if (verify(m1_7574,sigM1_7573,pkCli_7540) <> true) then
                                                    0
                                                else
                                                    {9690}let (SPc_7575: bitstring,PartC_7576: bitstring) = m1_7574 in
                                                    {9691}event endSrv(Cli_5168,Sess_5170,PartC_7576);
                                                    {9692}new Ns_7577: bitstring;
                                                    {9693}let gNs_7578: bitstring = exp(g,Ns_7577) in
                                                    {9694}let m2_7579: bitstring = gNs_7578 in
                                                    {9695}out(c, (enc(m2_7579,pkCli_7540),sign(m2_7579,skSess_7537)));
                                                    {9696}event beginSrv(Sess_5170,Cli_5168,gNs_7578)
                                        )
                                        else
                                            {9697}let pkDisco_7580: bitstring = fail-any in
                                            {9698}in(c, (=pkCli_7540,em1_7581: bitstring,sigM1_7582: bitstring));
                                            {9699}let m1_7583: bitstring = dec(em1_7581,skSess_7537) in
                                            {9700}if (verify(m1_7583,sigM1_7582,pkCli_7540) <> true) then
                                                0
                                            else
                                                {9701}let (SPc_7584: bitstring,PartC_7585: bitstring) = m1_7583 in
                                                {9702}event endSrv(Cli_5168,Sess_5170,PartC_7585);
                                                {9703}new Ns_7586: bitstring;
                                                {9704}let gNs_7587: bitstring = exp(g,Ns_7586) in
                                                {9705}let m2_7588: bitstring = gNs_7587 in
                                                {9706}out(c, (enc(m2_7588,pkCli_7540),sign(m2_7588,skSess_7537)));
                                                {9707}event beginSrv(Sess_5170,Cli_5168,gNs_7587)
                                )
                                else
                                    {9708}let pkDisco_7589: bitstring = fail-any in
                                    {9709}in(c, (=pkCli_7540,em1_7590: bitstring,sigM1_7591: bitstring));
                                    {9710}let m1_7592: bitstring = dec(em1_7590,skSess_7537) in
                                    {9711}if (verify(m1_7592,sigM1_7591,pkCli_7540) <> true) then
                                        0
                                    else
                                        {9712}let (SPc_7593: bitstring,PartC_7594: bitstring) = m1_7592 in
                                        {9713}event endSrv(Cli_5168,Sess_5170,PartC_7594);
                                        {9714}new Ns_7595: bitstring;
                                        {9715}let gNs_7596: bitstring = exp(g,Ns_7595) in
                                        {9716}let m2_7597: bitstring = gNs_7596 in
                                        {9717}out(c, (enc(m2_7597,pkCli_7540),sign(m2_7597,skSess_7537)));
                                        {9718}event beginSrv(Sess_5170,Cli_5168,gNs_7596)
                        )
                        else
                            {9719}let pkDisco_7598: bitstring = fail-any in
                            {9720}in(c, (=pkCli_7540,em1_7599: bitstring,sigM1_7600: bitstring));
                            {9721}let m1_7601: bitstring = dec(em1_7599,skSess_7537) in
                            {9722}if (verify(m1_7601,sigM1_7600,pkCli_7540) <> true) then
                                0
                            else
                                {9723}let (SPc_7602: bitstring,PartC_7603: bitstring) = m1_7601 in
                                {9724}event endSrv(Cli_5168,Sess_5170,PartC_7603);
                                {9725}new Ns_7604: bitstring;
                                {9726}let gNs_7605: bitstring = exp(g,Ns_7604) in
                                {9727}let m2_7606: bitstring = gNs_7605 in
                                {9728}out(c, (enc(m2_7606,pkCli_7540),sign(m2_7606,skSess_7537)));
                                {9729}event beginSrv(Sess_5170,Cli_5168,gNs_7605)
                    )
                    else
                        {9730}let v_7607: bool = (Cli_5168 = B) in
                        (
                            {9731}if v_7607 then
                            (
                                {9732}let pkCli_7608: bitstring = pub(skB) in
                                {9733}let v_7609: bool = (Disco_5169 = A) in
                                (
                                    {9734}if v_7609 then
                                    (
                                        {9735}let pkDisco_7610: bitstring = pub(skA) in
                                        {9736}in(c, (=pkCli_7608,em1_7611: bitstring,sigM1_7612: bitstring));
                                        {9737}let m1_7613: bitstring = dec(em1_7611,skSess_7537) in
                                        {9738}if (verify(m1_7613,sigM1_7612,pkCli_7608) <> true) then
                                            0
                                        else
                                            {9739}let (SPc_7614: bitstring,PartC_7615: bitstring) = m1_7613 in
                                            {9740}event endSrv(Cli_5168,Sess_5170,PartC_7615);
                                            {9741}new Ns_7616: bitstring;
                                            {9742}let gNs_7617: bitstring = exp(g,Ns_7616) in
                                            {9743}let m2_7618: bitstring = gNs_7617 in
                                            {9744}out(c, (enc(m2_7618,pkCli_7608),sign(m2_7618,skSess_7537)));
                                            {9745}event beginSrv(Sess_5170,Cli_5168,gNs_7617)
                                    )
                                    else
                                        {9746}let v_7619: bool = (Disco_5169 = B) in
                                        (
                                            {9747}if v_7619 then
                                            (
                                                {9748}let pkDisco_7620: bitstring = pub(skB) in
                                                {9749}in(c, (=pkCli_7608,em1_7621: bitstring,sigM1_7622: bitstring));
                                                {9750}let m1_7623: bitstring = dec(em1_7621,skSess_7537) in
                                                {9751}if (verify(m1_7623,sigM1_7622,pkCli_7608) <> true) then
                                                    0
                                                else
                                                    {9752}let (SPc_7624: bitstring,PartC_7625: bitstring) = m1_7623 in
                                                    {9753}event endSrv(Cli_5168,Sess_5170,PartC_7625);
                                                    {9754}new Ns_7626: bitstring;
                                                    {9755}let gNs_7627: bitstring = exp(g,Ns_7626) in
                                                    {9756}let m2_7628: bitstring = gNs_7627 in
                                                    {9757}out(c, (enc(m2_7628,pkCli_7608),sign(m2_7628,skSess_7537)));
                                                    {9758}event beginSrv(Sess_5170,Cli_5168,gNs_7627)
                                            )
                                            else
                                                {9759}let v_7629: bool = (Disco_5169 = C) in
                                                (
                                                    {9760}if v_7629 then
                                                    (
                                                        {9761}let pkDisco_7630: bitstring = pub(skC) in
                                                        {9762}in(c, (=pkCli_7608,em1_7631: bitstring,sigM1_7632: bitstring));
                                                        {9763}let m1_7633: bitstring = dec(em1_7631,skSess_7537) in
                                                        {9764}if (verify(m1_7633,sigM1_7632,pkCli_7608) <> true) then
                                                            0
                                                        else
                                                            {9765}let (SPc_7634: bitstring,PartC_7635: bitstring) = m1_7633 in
                                                            {9766}event endSrv(Cli_5168,Sess_5170,PartC_7635);
                                                            {9767}new Ns_7636: bitstring;
                                                            {9768}let gNs_7637: bitstring = exp(g,Ns_7636) in
                                                            {9769}let m2_7638: bitstring = gNs_7637 in
                                                            {9770}out(c, (enc(m2_7638,pkCli_7608),sign(m2_7638,skSess_7537)));
                                                            {9771}event beginSrv(Sess_5170,Cli_5168,gNs_7637)
                                                    )
                                                    else
                                                        {9772}let pkDisco_7639: bitstring = pub(skI) in
                                                        {9773}in(c, (=pkCli_7608,em1_7640: bitstring,sigM1_7641: bitstring));
                                                        {9774}let m1_7642: bitstring = dec(em1_7640,skSess_7537) in
                                                        {9775}if (verify(m1_7642,sigM1_7641,pkCli_7608) <> true) then
                                                            0
                                                        else
                                                            {9776}let (SPc_7643: bitstring,PartC_7644: bitstring) = m1_7642 in
                                                            {9777}event endSrv(Cli_5168,Sess_5170,PartC_7644);
                                                            {9778}new Ns_7645: bitstring;
                                                            {9779}let gNs_7646: bitstring = exp(g,Ns_7645) in
                                                            {9780}let m2_7647: bitstring = gNs_7646 in
                                                            {9781}out(c, (enc(m2_7647,pkCli_7608),sign(m2_7647,skSess_7537)));
                                                            {9782}event beginSrv(Sess_5170,Cli_5168,gNs_7646)
                                                )
                                                else
                                                    {9783}let pkDisco_7648: bitstring = fail-any in
                                                    {9784}in(c, (=pkCli_7608,em1_7649: bitstring,sigM1_7650: bitstring));
                                                    {9785}let m1_7651: bitstring = dec(em1_7649,skSess_7537) in
                                                    {9786}if (verify(m1_7651,sigM1_7650,pkCli_7608) <> true) then
                                                        0
                                                    else
                                                        {9787}let (SPc_7652: bitstring,PartC_7653: bitstring) = m1_7651 in
                                                        {9788}event endSrv(Cli_5168,Sess_5170,PartC_7653);
                                                        {9789}new Ns_7654: bitstring;
                                                        {9790}let gNs_7655: bitstring = exp(g,Ns_7654) in
                                                        {9791}let m2_7656: bitstring = gNs_7655 in
                                                        {9792}out(c, (enc(m2_7656,pkCli_7608),sign(m2_7656,skSess_7537)));
                                                        {9793}event beginSrv(Sess_5170,Cli_5168,gNs_7655)
                                        )
                                        else
                                            {9794}let pkDisco_7657: bitstring = fail-any in
                                            {9795}in(c, (=pkCli_7608,em1_7658: bitstring,sigM1_7659: bitstring));
                                            {9796}let m1_7660: bitstring = dec(em1_7658,skSess_7537) in
                                            {9797}if (verify(m1_7660,sigM1_7659,pkCli_7608) <> true) then
                                                0
                                            else
                                                {9798}let (SPc_7661: bitstring,PartC_7662: bitstring) = m1_7660 in
                                                {9799}event endSrv(Cli_5168,Sess_5170,PartC_7662);
                                                {9800}new Ns_7663: bitstring;
                                                {9801}let gNs_7664: bitstring = exp(g,Ns_7663) in
                                                {9802}let m2_7665: bitstring = gNs_7664 in
                                                {9803}out(c, (enc(m2_7665,pkCli_7608),sign(m2_7665,skSess_7537)));
                                                {9804}event beginSrv(Sess_5170,Cli_5168,gNs_7664)
                                )
                                else
                                    {9805}let pkDisco_7666: bitstring = fail-any in
                                    {9806}in(c, (=pkCli_7608,em1_7667: bitstring,sigM1_7668: bitstring));
                                    {9807}let m1_7669: bitstring = dec(em1_7667,skSess_7537) in
                                    {9808}if (verify(m1_7669,sigM1_7668,pkCli_7608) <> true) then
                                        0
                                    else
                                        {9809}let (SPc_7670: bitstring,PartC_7671: bitstring) = m1_7669 in
                                        {9810}event endSrv(Cli_5168,Sess_5170,PartC_7671);
                                        {9811}new Ns_7672: bitstring;
                                        {9812}let gNs_7673: bitstring = exp(g,Ns_7672) in
                                        {9813}let m2_7674: bitstring = gNs_7673 in
                                        {9814}out(c, (enc(m2_7674,pkCli_7608),sign(m2_7674,skSess_7537)));
                                        {9815}event beginSrv(Sess_5170,Cli_5168,gNs_7673)
                            )
                            else
                                {9816}let v_7675: bool = (Cli_5168 = C) in
                                (
                                    {9817}if v_7675 then
                                    (
                                        {9818}let pkCli_7676: bitstring = pub(skC) in
                                        {9819}let v_7677: bool = (Disco_5169 = A) in
                                        (
                                            {9820}if v_7677 then
                                            (
                                                {9821}let pkDisco_7678: bitstring = pub(skA) in
                                                {9822}in(c, (=pkCli_7676,em1_7679: bitstring,sigM1_7680: bitstring));
                                                {9823}let m1_7681: bitstring = dec(em1_7679,skSess_7537) in
                                                {9824}if (verify(m1_7681,sigM1_7680,pkCli_7676) <> true) then
                                                    0
                                                else
                                                    {9825}let (SPc_7682: bitstring,PartC_7683: bitstring) = m1_7681 in
                                                    {9826}event endSrv(Cli_5168,Sess_5170,PartC_7683);
                                                    {9827}new Ns_7684: bitstring;
                                                    {9828}let gNs_7685: bitstring = exp(g,Ns_7684) in
                                                    {9829}let m2_7686: bitstring = gNs_7685 in
                                                    {9830}out(c, (enc(m2_7686,pkCli_7676),sign(m2_7686,skSess_7537)));
                                                    {9831}event beginSrv(Sess_5170,Cli_5168,gNs_7685)
                                            )
                                            else
                                                {9832}let v_7687: bool = (Disco_5169 = B) in
                                                (
                                                    {9833}if v_7687 then
                                                    (
                                                        {9834}let pkDisco_7688: bitstring = pub(skB) in
                                                        {9835}in(c, (=pkCli_7676,em1_7689: bitstring,sigM1_7690: bitstring));
                                                        {9836}let m1_7691: bitstring = dec(em1_7689,skSess_7537) in
                                                        {9837}if (verify(m1_7691,sigM1_7690,pkCli_7676) <> true) then
                                                            0
                                                        else
                                                            {9838}let (SPc_7692: bitstring,PartC_7693: bitstring) = m1_7691 in
                                                            {9839}event endSrv(Cli_5168,Sess_5170,PartC_7693);
                                                            {9840}new Ns_7694: bitstring;
                                                            {9841}let gNs_7695: bitstring = exp(g,Ns_7694) in
                                                            {9842}let m2_7696: bitstring = gNs_7695 in
                                                            {9843}out(c, (enc(m2_7696,pkCli_7676),sign(m2_7696,skSess_7537)));
                                                            {9844}event beginSrv(Sess_5170,Cli_5168,gNs_7695)
                                                    )
                                                    else
                                                        {9845}let v_7697: bool = (Disco_5169 = C) in
                                                        (
                                                            {9846}if v_7697 then
                                                            (
                                                                {9847}let pkDisco_7698: bitstring = pub(skC) in
                                                                {9848}in(c, (=pkCli_7676,em1_7699: bitstring,sigM1_7700: bitstring));
                                                                {9849}let m1_7701: bitstring = dec(em1_7699,skSess_7537) in
                                                                {9850}if (verify(m1_7701,sigM1_7700,pkCli_7676) <> true) then
                                                                    0
                                                                else
                                                                    {9851}let (SPc_7702: bitstring,PartC_7703: bitstring) = m1_7701 in
                                                                    {9852}event endSrv(Cli_5168,Sess_5170,PartC_7703);
                                                                    {9853}new Ns_7704: bitstring;
                                                                    {9854}let gNs_7705: bitstring = exp(g,Ns_7704) in
                                                                    {9855}let m2_7706: bitstring = gNs_7705 in
                                                                    {9856}out(c, (enc(m2_7706,pkCli_7676),sign(m2_7706,skSess_7537)));
                                                                    {9857}event beginSrv(Sess_5170,Cli_5168,gNs_7705)
                                                            )
                                                            else
                                                                {9858}let pkDisco_7707: bitstring = pub(skI) in
                                                                {9859}in(c, (=pkCli_7676,em1_7708: bitstring,sigM1_7709: bitstring));
                                                                {9860}let m1_7710: bitstring = dec(em1_7708,skSess_7537) in
                                                                {9861}if (verify(m1_7710,sigM1_7709,pkCli_7676) <> true) then
                                                                    0
                                                                else
                                                                    {9862}let (SPc_7711: bitstring,PartC_7712: bitstring) = m1_7710 in
                                                                    {9863}event endSrv(Cli_5168,Sess_5170,PartC_7712);
                                                                    {9864}new Ns_7713: bitstring;
                                                                    {9865}let gNs_7714: bitstring = exp(g,Ns_7713) in
                                                                    {9866}let m2_7715: bitstring = gNs_7714 in
                                                                    {9867}out(c, (enc(m2_7715,pkCli_7676),sign(m2_7715,skSess_7537)));
                                                                    {9868}event beginSrv(Sess_5170,Cli_5168,gNs_7714)
                                                        )
                                                        else
                                                            {9869}let pkDisco_7716: bitstring = fail-any in
                                                            {9870}in(c, (=pkCli_7676,em1_7717: bitstring,sigM1_7718: bitstring));
                                                            {9871}let m1_7719: bitstring = dec(em1_7717,skSess_7537) in
                                                            {9872}if (verify(m1_7719,sigM1_7718,pkCli_7676) <> true) then
                                                                0
                                                            else
                                                                {9873}let (SPc_7720: bitstring,PartC_7721: bitstring) = m1_7719 in
                                                                {9874}event endSrv(Cli_5168,Sess_5170,PartC_7721);
                                                                {9875}new Ns_7722: bitstring;
                                                                {9876}let gNs_7723: bitstring = exp(g,Ns_7722) in
                                                                {9877}let m2_7724: bitstring = gNs_7723 in
                                                                {9878}out(c, (enc(m2_7724,pkCli_7676),sign(m2_7724,skSess_7537)));
                                                                {9879}event beginSrv(Sess_5170,Cli_5168,gNs_7723)
                                                )
                                                else
                                                    {9880}let pkDisco_7725: bitstring = fail-any in
                                                    {9881}in(c, (=pkCli_7676,em1_7726: bitstring,sigM1_7727: bitstring));
                                                    {9882}let m1_7728: bitstring = dec(em1_7726,skSess_7537) in
                                                    {9883}if (verify(m1_7728,sigM1_7727,pkCli_7676) <> true) then
                                                        0
                                                    else
                                                        {9884}let (SPc_7729: bitstring,PartC_7730: bitstring) = m1_7728 in
                                                        {9885}event endSrv(Cli_5168,Sess_5170,PartC_7730);
                                                        {9886}new Ns_7731: bitstring;
                                                        {9887}let gNs_7732: bitstring = exp(g,Ns_7731) in
                                                        {9888}let m2_7733: bitstring = gNs_7732 in
                                                        {9889}out(c, (enc(m2_7733,pkCli_7676),sign(m2_7733,skSess_7537)));
                                                        {9890}event beginSrv(Sess_5170,Cli_5168,gNs_7732)
                                        )
                                        else
                                            {9891}let pkDisco_7734: bitstring = fail-any in
                                            {9892}in(c, (=pkCli_7676,em1_7735: bitstring,sigM1_7736: bitstring));
                                            {9893}let m1_7737: bitstring = dec(em1_7735,skSess_7537) in
                                            {9894}if (verify(m1_7737,sigM1_7736,pkCli_7676) <> true) then
                                                0
                                            else
                                                {9895}let (SPc_7738: bitstring,PartC_7739: bitstring) = m1_7737 in
                                                {9896}event endSrv(Cli_5168,Sess_5170,PartC_7739);
                                                {9897}new Ns_7740: bitstring;
                                                {9898}let gNs_7741: bitstring = exp(g,Ns_7740) in
                                                {9899}let m2_7742: bitstring = gNs_7741 in
                                                {9900}out(c, (enc(m2_7742,pkCli_7676),sign(m2_7742,skSess_7537)));
                                                {9901}event beginSrv(Sess_5170,Cli_5168,gNs_7741)
                                    )
                                    else
                                        {9902}let pkCli_7743: bitstring = pub(skI) in
                                        {9903}let v_7744: bool = (Disco_5169 = A) in
                                        (
                                            {9904}if v_7744 then
                                            (
                                                {9905}let pkDisco_7745: bitstring = pub(skA) in
                                                {9906}in(c, (=pkCli_7743,em1_7746: bitstring,sigM1_7747: bitstring));
                                                {9907}let m1_7748: bitstring = dec(em1_7746,skSess_7537) in
                                                {9908}if (verify(m1_7748,sigM1_7747,pkCli_7743) <> true) then
                                                    0
                                                else
                                                    {9909}let (SPc_7749: bitstring,PartC_7750: bitstring) = m1_7748 in
                                                    {9910}event endSrv(Cli_5168,Sess_5170,PartC_7750);
                                                    {9911}new Ns_7751: bitstring;
                                                    {9912}let gNs_7752: bitstring = exp(g,Ns_7751) in
                                                    {9913}let m2_7753: bitstring = gNs_7752 in
                                                    {9914}out(c, (enc(m2_7753,pkCli_7743),sign(m2_7753,skSess_7537)));
                                                    {9915}event beginSrv(Sess_5170,Cli_5168,gNs_7752)
                                            )
                                            else
                                                {9916}let v_7754: bool = (Disco_5169 = B) in
                                                (
                                                    {9917}if v_7754 then
                                                    (
                                                        {9918}let pkDisco_7755: bitstring = pub(skB) in
                                                        {9919}in(c, (=pkCli_7743,em1_7756: bitstring,sigM1_7757: bitstring));
                                                        {9920}let m1_7758: bitstring = dec(em1_7756,skSess_7537) in
                                                        {9921}if (verify(m1_7758,sigM1_7757,pkCli_7743) <> true) then
                                                            0
                                                        else
                                                            {9922}let (SPc_7759: bitstring,PartC_7760: bitstring) = m1_7758 in
                                                            {9923}event endSrv(Cli_5168,Sess_5170,PartC_7760);
                                                            {9924}new Ns_7761: bitstring;
                                                            {9925}let gNs_7762: bitstring = exp(g,Ns_7761) in
                                                            {9926}let m2_7763: bitstring = gNs_7762 in
                                                            {9927}out(c, (enc(m2_7763,pkCli_7743),sign(m2_7763,skSess_7537)));
                                                            {9928}event beginSrv(Sess_5170,Cli_5168,gNs_7762)
                                                    )
                                                    else
                                                        {9929}let v_7764: bool = (Disco_5169 = C) in
                                                        (
                                                            {9930}if v_7764 then
                                                            (
                                                                {9931}let pkDisco_7765: bitstring = pub(skC) in
                                                                {9932}in(c, (=pkCli_7743,em1_7766: bitstring,sigM1_7767: bitstring));
                                                                {9933}let m1_7768: bitstring = dec(em1_7766,skSess_7537) in
                                                                {9934}if (verify(m1_7768,sigM1_7767,pkCli_7743) <> true) then
                                                                    0
                                                                else
                                                                    {9935}let (SPc_7769: bitstring,PartC_7770: bitstring) = m1_7768 in
                                                                    {9936}event endSrv(Cli_5168,Sess_5170,PartC_7770);
                                                                    {9937}new Ns_7771: bitstring;
                                                                    {9938}let gNs_7772: bitstring = exp(g,Ns_7771) in
                                                                    {9939}let m2_7773: bitstring = gNs_7772 in
                                                                    {9940}out(c, (enc(m2_7773,pkCli_7743),sign(m2_7773,skSess_7537)));
                                                                    {9941}event beginSrv(Sess_5170,Cli_5168,gNs_7772)
                                                            )
                                                            else
                                                                {9942}let pkDisco_7774: bitstring = pub(skI) in
                                                                {9943}in(c, (=pkCli_7743,em1_7775: bitstring,sigM1_7776: bitstring));
                                                                {9944}let m1_7777: bitstring = dec(em1_7775,skSess_7537) in
                                                                {9945}if (verify(m1_7777,sigM1_7776,pkCli_7743) <> true) then
                                                                    0
                                                                else
                                                                    {9946}let (SPc_7778: bitstring,PartC_7779: bitstring) = m1_7777 in
                                                                    {9947}event endSrv(Cli_5168,Sess_5170,PartC_7779);
                                                                    {9948}new Ns_7780: bitstring;
                                                                    {9949}let gNs_7781: bitstring = exp(g,Ns_7780) in
                                                                    {9950}let m2_7782: bitstring = gNs_7781 in
                                                                    {9951}out(c, (enc(m2_7782,pkCli_7743),sign(m2_7782,skSess_7537)));
                                                                    {9952}event beginSrv(Sess_5170,Cli_5168,gNs_7781)
                                                        )
                                                        else
                                                            {9953}let pkDisco_7783: bitstring = fail-any in
                                                            {9954}in(c, (=pkCli_7743,em1_7784: bitstring,sigM1_7785: bitstring));
                                                            {9955}let m1_7786: bitstring = dec(em1_7784,skSess_7537) in
                                                            {9956}if (verify(m1_7786,sigM1_7785,pkCli_7743) <> true) then
                                                                0
                                                            else
                                                                {9957}let (SPc_7787: bitstring,PartC_7788: bitstring) = m1_7786 in
                                                                {9958}event endSrv(Cli_5168,Sess_5170,PartC_7788);
                                                                {9959}new Ns_7789: bitstring;
                                                                {9960}let gNs_7790: bitstring = exp(g,Ns_7789) in
                                                                {9961}let m2_7791: bitstring = gNs_7790 in
                                                                {9962}out(c, (enc(m2_7791,pkCli_7743),sign(m2_7791,skSess_7537)));
                                                                {9963}event beginSrv(Sess_5170,Cli_5168,gNs_7790)
                                                )
                                                else
                                                    {9964}let pkDisco_7792: bitstring = fail-any in
                                                    {9965}in(c, (=pkCli_7743,em1_7793: bitstring,sigM1_7794: bitstring));
                                                    {9966}let m1_7795: bitstring = dec(em1_7793,skSess_7537) in
                                                    {9967}if (verify(m1_7795,sigM1_7794,pkCli_7743) <> true) then
                                                        0
                                                    else
                                                        {9968}let (SPc_7796: bitstring,PartC_7797: bitstring) = m1_7795 in
                                                        {9969}event endSrv(Cli_5168,Sess_5170,PartC_7797);
                                                        {9970}new Ns_7798: bitstring;
                                                        {9971}let gNs_7799: bitstring = exp(g,Ns_7798) in
                                                        {9972}let m2_7800: bitstring = gNs_7799 in
                                                        {9973}out(c, (enc(m2_7800,pkCli_7743),sign(m2_7800,skSess_7537)));
                                                        {9974}event beginSrv(Sess_5170,Cli_5168,gNs_7799)
                                        )
                                        else
                                            {9975}let pkDisco_7801: bitstring = fail-any in
                                            {9976}in(c, (=pkCli_7743,em1_7802: bitstring,sigM1_7803: bitstring));
                                            {9977}let m1_7804: bitstring = dec(em1_7802,skSess_7537) in
                                            {9978}if (verify(m1_7804,sigM1_7803,pkCli_7743) <> true) then
                                                0
                                            else
                                                {9979}let (SPc_7805: bitstring,PartC_7806: bitstring) = m1_7804 in
                                                {9980}event endSrv(Cli_5168,Sess_5170,PartC_7806);
                                                {9981}new Ns_7807: bitstring;
                                                {9982}let gNs_7808: bitstring = exp(g,Ns_7807) in
                                                {9983}let m2_7809: bitstring = gNs_7808 in
                                                {9984}out(c, (enc(m2_7809,pkCli_7743),sign(m2_7809,skSess_7537)));
                                                {9985}event beginSrv(Sess_5170,Cli_5168,gNs_7808)
                                )
                                else
                                    {9986}let pkCli_7810: bitstring = fail-any in
                                    {9987}let v_7811: bool = (Disco_5169 = A) in
                                    (
                                        {9988}if v_7811 then
                                        (
                                            {9989}let pkDisco_7812: bitstring = pub(skA) in
                                            {9990}in(c, (=pkCli_7810,em1_7813: bitstring,sigM1_7814: bitstring));
                                            {9991}let m1_7815: bitstring = dec(em1_7813,skSess_7537) in
                                            {9992}if (verify(m1_7815,sigM1_7814,pkCli_7810) <> true) then
                                                0
                                            else
                                                {9993}let (SPc_7816: bitstring,PartC_7817: bitstring) = m1_7815 in
                                                {9994}event endSrv(Cli_5168,Sess_5170,PartC_7817);
                                                {9995}new Ns_7818: bitstring;
                                                {9996}let gNs_7819: bitstring = exp(g,Ns_7818) in
                                                {9997}let m2_7820: bitstring = gNs_7819 in
                                                {9998}out(c, (enc(m2_7820,pkCli_7810),sign(m2_7820,skSess_7537)));
                                                {9999}event beginSrv(Sess_5170,Cli_5168,gNs_7819)
                                        )
                                        else
                                            {10000}let v_7821: bool = (Disco_5169 = B) in
                                            (
                                                {10001}if v_7821 then
                                                (
                                                    {10002}let pkDisco_7822: bitstring = pub(skB) in
                                                    {10003}in(c, (=pkCli_7810,em1_7823: bitstring,sigM1_7824: bitstring));
                                                    {10004}let m1_7825: bitstring = dec(em1_7823,skSess_7537) in
                                                    {10005}if (verify(m1_7825,sigM1_7824,pkCli_7810) <> true) then
                                                        0
                                                    else
                                                        {10006}let (SPc_7826: bitstring,PartC_7827: bitstring) = m1_7825 in
                                                        {10007}event endSrv(Cli_5168,Sess_5170,PartC_7827);
                                                        {10008}new Ns_7828: bitstring;
                                                        {10009}let gNs_7829: bitstring = exp(g,Ns_7828) in
                                                        {10010}let m2_7830: bitstring = gNs_7829 in
                                                        {10011}out(c, (enc(m2_7830,pkCli_7810),sign(m2_7830,skSess_7537)));
                                                        {10012}event beginSrv(Sess_5170,Cli_5168,gNs_7829)
                                                )
                                                else
                                                    {10013}let v_7831: bool = (Disco_5169 = C) in
                                                    (
                                                        {10014}if v_7831 then
                                                        (
                                                            {10015}let pkDisco_7832: bitstring = pub(skC) in
                                                            {10016}in(c, (=pkCli_7810,em1_7833: bitstring,sigM1_7834: bitstring));
                                                            {10017}let m1_7835: bitstring = dec(em1_7833,skSess_7537) in
                                                            {10018}if (verify(m1_7835,sigM1_7834,pkCli_7810) <> true) then
                                                                0
                                                            else
                                                                {10019}let (SPc_7836: bitstring,PartC_7837: bitstring) = m1_7835 in
                                                                {10020}event endSrv(Cli_5168,Sess_5170,PartC_7837);
                                                                {10021}new Ns_7838: bitstring;
                                                                {10022}let gNs_7839: bitstring = exp(g,Ns_7838) in
                                                                {10023}let m2_7840: bitstring = gNs_7839 in
                                                                {10024}out(c, (enc(m2_7840,pkCli_7810),sign(m2_7840,skSess_7537)));
                                                                {10025}event beginSrv(Sess_5170,Cli_5168,gNs_7839)
                                                        )
                                                        else
                                                            {10026}let pkDisco_7841: bitstring = pub(skI) in
                                                            {10027}in(c, (=pkCli_7810,em1_7842: bitstring,sigM1_7843: bitstring));
                                                            {10028}let m1_7844: bitstring = dec(em1_7842,skSess_7537) in
                                                            {10029}if (verify(m1_7844,sigM1_7843,pkCli_7810) <> true) then
                                                                0
                                                            else
                                                                {10030}let (SPc_7845: bitstring,PartC_7846: bitstring) = m1_7844 in
                                                                {10031}event endSrv(Cli_5168,Sess_5170,PartC_7846);
                                                                {10032}new Ns_7847: bitstring;
                                                                {10033}let gNs_7848: bitstring = exp(g,Ns_7847) in
                                                                {10034}let m2_7849: bitstring = gNs_7848 in
                                                                {10035}out(c, (enc(m2_7849,pkCli_7810),sign(m2_7849,skSess_7537)));
                                                                {10036}event beginSrv(Sess_5170,Cli_5168,gNs_7848)
                                                    )
                                                    else
                                                        {10037}let pkDisco_7850: bitstring = fail-any in
                                                        {10038}in(c, (=pkCli_7810,em1_7851: bitstring,sigM1_7852: bitstring));
                                                        {10039}let m1_7853: bitstring = dec(em1_7851,skSess_7537) in
                                                        {10040}if (verify(m1_7853,sigM1_7852,pkCli_7810) <> true) then
                                                            0
                                                        else
                                                            {10041}let (SPc_7854: bitstring,PartC_7855: bitstring) = m1_7853 in
                                                            {10042}event endSrv(Cli_5168,Sess_5170,PartC_7855);
                                                            {10043}new Ns_7856: bitstring;
                                                            {10044}let gNs_7857: bitstring = exp(g,Ns_7856) in
                                                            {10045}let m2_7858: bitstring = gNs_7857 in
                                                            {10046}out(c, (enc(m2_7858,pkCli_7810),sign(m2_7858,skSess_7537)));
                                                            {10047}event beginSrv(Sess_5170,Cli_5168,gNs_7857)
                                            )
                                            else
                                                {10048}let pkDisco_7859: bitstring = fail-any in
                                                {10049}in(c, (=pkCli_7810,em1_7860: bitstring,sigM1_7861: bitstring));
                                                {10050}let m1_7862: bitstring = dec(em1_7860,skSess_7537) in
                                                {10051}if (verify(m1_7862,sigM1_7861,pkCli_7810) <> true) then
                                                    0
                                                else
                                                    {10052}let (SPc_7863: bitstring,PartC_7864: bitstring) = m1_7862 in
                                                    {10053}event endSrv(Cli_5168,Sess_5170,PartC_7864);
                                                    {10054}new Ns_7865: bitstring;
                                                    {10055}let gNs_7866: bitstring = exp(g,Ns_7865) in
                                                    {10056}let m2_7867: bitstring = gNs_7866 in
                                                    {10057}out(c, (enc(m2_7867,pkCli_7810),sign(m2_7867,skSess_7537)));
                                                    {10058}event beginSrv(Sess_5170,Cli_5168,gNs_7866)
                                    )
                                    else
                                        {10059}let pkDisco_7868: bitstring = fail-any in
                                        {10060}in(c, (=pkCli_7810,em1_7869: bitstring,sigM1_7870: bitstring));
                                        {10061}let m1_7871: bitstring = dec(em1_7869,skSess_7537) in
                                        {10062}if (verify(m1_7871,sigM1_7870,pkCli_7810) <> true) then
                                            0
                                        else
                                            {10063}let (SPc_7872: bitstring,PartC_7873: bitstring) = m1_7871 in
                                            {10064}event endSrv(Cli_5168,Sess_5170,PartC_7873);
                                            {10065}new Ns_7874: bitstring;
                                            {10066}let gNs_7875: bitstring = exp(g,Ns_7874) in
                                            {10067}let m2_7876: bitstring = gNs_7875 in
                                            {10068}out(c, (enc(m2_7876,pkCli_7810),sign(m2_7876,skSess_7537)));
                                            {10069}event beginSrv(Sess_5170,Cli_5168,gNs_7875)
                        )
                        else
                            {10070}let pkCli_7877: bitstring = fail-any in
                            {10071}let v_7878: bool = (Disco_5169 = A) in
                            (
                                {10072}if v_7878 then
                                (
                                    {10073}let pkDisco_7879: bitstring = pub(skA) in
                                    {10074}in(c, (=pkCli_7877,em1_7880: bitstring,sigM1_7881: bitstring));
                                    {10075}let m1_7882: bitstring = dec(em1_7880,skSess_7537) in
                                    {10076}if (verify(m1_7882,sigM1_7881,pkCli_7877) <> true) then
                                        0
                                    else
                                        {10077}let (SPc_7883: bitstring,PartC_7884: bitstring) = m1_7882 in
                                        {10078}event endSrv(Cli_5168,Sess_5170,PartC_7884);
                                        {10079}new Ns_7885: bitstring;
                                        {10080}let gNs_7886: bitstring = exp(g,Ns_7885) in
                                        {10081}let m2_7887: bitstring = gNs_7886 in
                                        {10082}out(c, (enc(m2_7887,pkCli_7877),sign(m2_7887,skSess_7537)));
                                        {10083}event beginSrv(Sess_5170,Cli_5168,gNs_7886)
                                )
                                else
                                    {10084}let v_7888: bool = (Disco_5169 = B) in
                                    (
                                        {10085}if v_7888 then
                                        (
                                            {10086}let pkDisco_7889: bitstring = pub(skB) in
                                            {10087}in(c, (=pkCli_7877,em1_7890: bitstring,sigM1_7891: bitstring));
                                            {10088}let m1_7892: bitstring = dec(em1_7890,skSess_7537) in
                                            {10089}if (verify(m1_7892,sigM1_7891,pkCli_7877) <> true) then
                                                0
                                            else
                                                {10090}let (SPc_7893: bitstring,PartC_7894: bitstring) = m1_7892 in
                                                {10091}event endSrv(Cli_5168,Sess_5170,PartC_7894);
                                                {10092}new Ns_7895: bitstring;
                                                {10093}let gNs_7896: bitstring = exp(g,Ns_7895) in
                                                {10094}let m2_7897: bitstring = gNs_7896 in
                                                {10095}out(c, (enc(m2_7897,pkCli_7877),sign(m2_7897,skSess_7537)));
                                                {10096}event beginSrv(Sess_5170,Cli_5168,gNs_7896)
                                        )
                                        else
                                            {10097}let v_7898: bool = (Disco_5169 = C) in
                                            (
                                                {10098}if v_7898 then
                                                (
                                                    {10099}let pkDisco_7899: bitstring = pub(skC) in
                                                    {10100}in(c, (=pkCli_7877,em1_7900: bitstring,sigM1_7901: bitstring));
                                                    {10101}let m1_7902: bitstring = dec(em1_7900,skSess_7537) in
                                                    {10102}if (verify(m1_7902,sigM1_7901,pkCli_7877) <> true) then
                                                        0
                                                    else
                                                        {10103}let (SPc_7903: bitstring,PartC_7904: bitstring) = m1_7902 in
                                                        {10104}event endSrv(Cli_5168,Sess_5170,PartC_7904);
                                                        {10105}new Ns_7905: bitstring;
                                                        {10106}let gNs_7906: bitstring = exp(g,Ns_7905) in
                                                        {10107}let m2_7907: bitstring = gNs_7906 in
                                                        {10108}out(c, (enc(m2_7907,pkCli_7877),sign(m2_7907,skSess_7537)));
                                                        {10109}event beginSrv(Sess_5170,Cli_5168,gNs_7906)
                                                )
                                                else
                                                    {10110}let pkDisco_7908: bitstring = pub(skI) in
                                                    {10111}in(c, (=pkCli_7877,em1_7909: bitstring,sigM1_7910: bitstring));
                                                    {10112}let m1_7911: bitstring = dec(em1_7909,skSess_7537) in
                                                    {10113}if (verify(m1_7911,sigM1_7910,pkCli_7877) <> true) then
                                                        0
                                                    else
                                                        {10114}let (SPc_7912: bitstring,PartC_7913: bitstring) = m1_7911 in
                                                        {10115}event endSrv(Cli_5168,Sess_5170,PartC_7913);
                                                        {10116}new Ns_7914: bitstring;
                                                        {10117}let gNs_7915: bitstring = exp(g,Ns_7914) in
                                                        {10118}let m2_7916: bitstring = gNs_7915 in
                                                        {10119}out(c, (enc(m2_7916,pkCli_7877),sign(m2_7916,skSess_7537)));
                                                        {10120}event beginSrv(Sess_5170,Cli_5168,gNs_7915)
                                            )
                                            else
                                                {10121}let pkDisco_7917: bitstring = fail-any in
                                                {10122}in(c, (=pkCli_7877,em1_7918: bitstring,sigM1_7919: bitstring));
                                                {10123}let m1_7920: bitstring = dec(em1_7918,skSess_7537) in
                                                {10124}if (verify(m1_7920,sigM1_7919,pkCli_7877) <> true) then
                                                    0
                                                else
                                                    {10125}let (SPc_7921: bitstring,PartC_7922: bitstring) = m1_7920 in
                                                    {10126}event endSrv(Cli_5168,Sess_5170,PartC_7922);
                                                    {10127}new Ns_7923: bitstring;
                                                    {10128}let gNs_7924: bitstring = exp(g,Ns_7923) in
                                                    {10129}let m2_7925: bitstring = gNs_7924 in
                                                    {10130}out(c, (enc(m2_7925,pkCli_7877),sign(m2_7925,skSess_7537)));
                                                    {10131}event beginSrv(Sess_5170,Cli_5168,gNs_7924)
                                    )
                                    else
                                        {10132}let pkDisco_7926: bitstring = fail-any in
                                        {10133}in(c, (=pkCli_7877,em1_7927: bitstring,sigM1_7928: bitstring));
                                        {10134}let m1_7929: bitstring = dec(em1_7927,skSess_7537) in
                                        {10135}if (verify(m1_7929,sigM1_7928,pkCli_7877) <> true) then
                                            0
                                        else
                                            {10136}let (SPc_7930: bitstring,PartC_7931: bitstring) = m1_7929 in
                                            {10137}event endSrv(Cli_5168,Sess_5170,PartC_7931);
                                            {10138}new Ns_7932: bitstring;
                                            {10139}let gNs_7933: bitstring = exp(g,Ns_7932) in
                                            {10140}let m2_7934: bitstring = gNs_7933 in
                                            {10141}out(c, (enc(m2_7934,pkCli_7877),sign(m2_7934,skSess_7537)));
                                            {10142}event beginSrv(Sess_5170,Cli_5168,gNs_7933)
                            )
                            else
                                {10143}let pkDisco_7935: bitstring = fail-any in
                                {10144}in(c, (=pkCli_7877,em1_7936: bitstring,sigM1_7937: bitstring));
                                {10145}let m1_7938: bitstring = dec(em1_7936,skSess_7537) in
                                {10146}if (verify(m1_7938,sigM1_7937,pkCli_7877) <> true) then
                                    0
                                else
                                    {10147}let (SPc_7939: bitstring,PartC_7940: bitstring) = m1_7938 in
                                    {10148}event endSrv(Cli_5168,Sess_5170,PartC_7940);
                                    {10149}new Ns_7941: bitstring;
                                    {10150}let gNs_7942: bitstring = exp(g,Ns_7941) in
                                    {10151}let m2_7943: bitstring = gNs_7942 in
                                    {10152}out(c, (enc(m2_7943,pkCli_7877),sign(m2_7943,skSess_7537)));
                                    {10153}event beginSrv(Sess_5170,Cli_5168,gNs_7942)
                )
                else
                    {10154}let pkCli_7944: bitstring = fail-any in
                    {10155}let v_7945: bool = (Disco_5169 = A) in
                    (
                        {10156}if v_7945 then
                        (
                            {10157}let pkDisco_7946: bitstring = pub(skA) in
                            {10158}in(c, (=pkCli_7944,em1_7947: bitstring,sigM1_7948: bitstring));
                            {10159}let m1_7949: bitstring = dec(em1_7947,skSess_7537) in
                            {10160}if (verify(m1_7949,sigM1_7948,pkCli_7944) <> true) then
                                0
                            else
                                {10161}let (SPc_7950: bitstring,PartC_7951: bitstring) = m1_7949 in
                                {10162}event endSrv(Cli_5168,Sess_5170,PartC_7951);
                                {10163}new Ns_7952: bitstring;
                                {10164}let gNs_7953: bitstring = exp(g,Ns_7952) in
                                {10165}let m2_7954: bitstring = gNs_7953 in
                                {10166}out(c, (enc(m2_7954,pkCli_7944),sign(m2_7954,skSess_7537)));
                                {10167}event beginSrv(Sess_5170,Cli_5168,gNs_7953)
                        )
                        else
                            {10168}let v_7955: bool = (Disco_5169 = B) in
                            (
                                {10169}if v_7955 then
                                (
                                    {10170}let pkDisco_7956: bitstring = pub(skB) in
                                    {10171}in(c, (=pkCli_7944,em1_7957: bitstring,sigM1_7958: bitstring));
                                    {10172}let m1_7959: bitstring = dec(em1_7957,skSess_7537) in
                                    {10173}if (verify(m1_7959,sigM1_7958,pkCli_7944) <> true) then
                                        0
                                    else
                                        {10174}let (SPc_7960: bitstring,PartC_7961: bitstring) = m1_7959 in
                                        {10175}event endSrv(Cli_5168,Sess_5170,PartC_7961);
                                        {10176}new Ns_7962: bitstring;
                                        {10177}let gNs_7963: bitstring = exp(g,Ns_7962) in
                                        {10178}let m2_7964: bitstring = gNs_7963 in
                                        {10179}out(c, (enc(m2_7964,pkCli_7944),sign(m2_7964,skSess_7537)));
                                        {10180}event beginSrv(Sess_5170,Cli_5168,gNs_7963)
                                )
                                else
                                    {10181}let v_7965: bool = (Disco_5169 = C) in
                                    (
                                        {10182}if v_7965 then
                                        (
                                            {10183}let pkDisco_7966: bitstring = pub(skC) in
                                            {10184}in(c, (=pkCli_7944,em1_7967: bitstring,sigM1_7968: bitstring));
                                            {10185}let m1_7969: bitstring = dec(em1_7967,skSess_7537) in
                                            {10186}if (verify(m1_7969,sigM1_7968,pkCli_7944) <> true) then
                                                0
                                            else
                                                {10187}let (SPc_7970: bitstring,PartC_7971: bitstring) = m1_7969 in
                                                {10188}event endSrv(Cli_5168,Sess_5170,PartC_7971);
                                                {10189}new Ns_7972: bitstring;
                                                {10190}let gNs_7973: bitstring = exp(g,Ns_7972) in
                                                {10191}let m2_7974: bitstring = gNs_7973 in
                                                {10192}out(c, (enc(m2_7974,pkCli_7944),sign(m2_7974,skSess_7537)));
                                                {10193}event beginSrv(Sess_5170,Cli_5168,gNs_7973)
                                        )
                                        else
                                            {10194}let pkDisco_7975: bitstring = pub(skI) in
                                            {10195}in(c, (=pkCli_7944,em1_7976: bitstring,sigM1_7977: bitstring));
                                            {10196}let m1_7978: bitstring = dec(em1_7976,skSess_7537) in
                                            {10197}if (verify(m1_7978,sigM1_7977,pkCli_7944) <> true) then
                                                0
                                            else
                                                {10198}let (SPc_7979: bitstring,PartC_7980: bitstring) = m1_7978 in
                                                {10199}event endSrv(Cli_5168,Sess_5170,PartC_7980);
                                                {10200}new Ns_7981: bitstring;
                                                {10201}let gNs_7982: bitstring = exp(g,Ns_7981) in
                                                {10202}let m2_7983: bitstring = gNs_7982 in
                                                {10203}out(c, (enc(m2_7983,pkCli_7944),sign(m2_7983,skSess_7537)));
                                                {10204}event beginSrv(Sess_5170,Cli_5168,gNs_7982)
                                    )
                                    else
                                        {10205}let pkDisco_7984: bitstring = fail-any in
                                        {10206}in(c, (=pkCli_7944,em1_7985: bitstring,sigM1_7986: bitstring));
                                        {10207}let m1_7987: bitstring = dec(em1_7985,skSess_7537) in
                                        {10208}if (verify(m1_7987,sigM1_7986,pkCli_7944) <> true) then
                                            0
                                        else
                                            {10209}let (SPc_7988: bitstring,PartC_7989: bitstring) = m1_7987 in
                                            {10210}event endSrv(Cli_5168,Sess_5170,PartC_7989);
                                            {10211}new Ns_7990: bitstring;
                                            {10212}let gNs_7991: bitstring = exp(g,Ns_7990) in
                                            {10213}let m2_7992: bitstring = gNs_7991 in
                                            {10214}out(c, (enc(m2_7992,pkCli_7944),sign(m2_7992,skSess_7537)));
                                            {10215}event beginSrv(Sess_5170,Cli_5168,gNs_7991)
                            )
                            else
                                {10216}let pkDisco_7993: bitstring = fail-any in
                                {10217}in(c, (=pkCli_7944,em1_7994: bitstring,sigM1_7995: bitstring));
                                {10218}let m1_7996: bitstring = dec(em1_7994,skSess_7537) in
                                {10219}if (verify(m1_7996,sigM1_7995,pkCli_7944) <> true) then
                                    0
                                else
                                    {10220}let (SPc_7997: bitstring,PartC_7998: bitstring) = m1_7996 in
                                    {10221}event endSrv(Cli_5168,Sess_5170,PartC_7998);
                                    {10222}new Ns_7999: bitstring;
                                    {10223}let gNs_8000: bitstring = exp(g,Ns_7999) in
                                    {10224}let m2_8001: bitstring = gNs_8000 in
                                    {10225}out(c, (enc(m2_8001,pkCli_7944),sign(m2_8001,skSess_7537)));
                                    {10226}event beginSrv(Sess_5170,Cli_5168,gNs_8000)
                    )
                    else
                        {10227}let pkDisco_8002: bitstring = fail-any in
                        {10228}in(c, (=pkCli_7944,em1_8003: bitstring,sigM1_8004: bitstring));
                        {10229}let m1_8005: bitstring = dec(em1_8003,skSess_7537) in
                        {10230}if (verify(m1_8005,sigM1_8004,pkCli_7944) <> true) then
                            0
                        else
                            {10231}let (SPc_8006: bitstring,PartC_8007: bitstring) = m1_8005 in
                            {10232}event endSrv(Cli_5168,Sess_5170,PartC_8007);
                            {10233}new Ns_8008: bitstring;
                            {10234}let gNs_8009: bitstring = exp(g,Ns_8008) in
                            {10235}let m2_8010: bitstring = gNs_8009 in
                            {10236}out(c, (enc(m2_8010,pkCli_7944),sign(m2_8010,skSess_7537)));
                            {10237}event beginSrv(Sess_5170,Cli_5168,gNs_8009)
    )
    else
        {10238}let skSess_8011: bitstring = fail-any in
        {10239}let pkSess_8012: bitstring = pub(skSess_8011) in
        {10240}let v_8013: bool = (Cli_5168 = A) in
        (
            {10241}if v_8013 then
            (
                {10242}let pkCli_8014: bitstring = pub(skA) in
                {10243}let v_8015: bool = (Disco_5169 = A) in
                (
                    {10244}if v_8015 then
                    (
                        {10245}let pkDisco_8016: bitstring = pub(skA) in
                        {10246}in(c, (=pkCli_8014,em1_8017: bitstring,sigM1_8018: bitstring));
                        {10247}let m1_8019: bitstring = dec(em1_8017,skSess_8011) in
                        {10248}if (verify(m1_8019,sigM1_8018,pkCli_8014) <> true) then
                            0
                        else
                            {10249}let (SPc_8020: bitstring,PartC_8021: bitstring) = m1_8019 in
                            {10250}event endSrv(Cli_5168,Sess_5170,PartC_8021);
                            {10251}new Ns_8022: bitstring;
                            {10252}let gNs_8023: bitstring = exp(g,Ns_8022) in
                            {10253}let m2_8024: bitstring = gNs_8023 in
                            {10254}out(c, (enc(m2_8024,pkCli_8014),sign(m2_8024,skSess_8011)));
                            {10255}event beginSrv(Sess_5170,Cli_5168,gNs_8023)
                    )
                    else
                        {10256}let v_8025: bool = (Disco_5169 = B) in
                        (
                            {10257}if v_8025 then
                            (
                                {10258}let pkDisco_8026: bitstring = pub(skB) in
                                {10259}in(c, (=pkCli_8014,em1_8027: bitstring,sigM1_8028: bitstring));
                                {10260}let m1_8029: bitstring = dec(em1_8027,skSess_8011) in
                                {10261}if (verify(m1_8029,sigM1_8028,pkCli_8014) <> true) then
                                    0
                                else
                                    {10262}let (SPc_8030: bitstring,PartC_8031: bitstring) = m1_8029 in
                                    {10263}event endSrv(Cli_5168,Sess_5170,PartC_8031);
                                    {10264}new Ns_8032: bitstring;
                                    {10265}let gNs_8033: bitstring = exp(g,Ns_8032) in
                                    {10266}let m2_8034: bitstring = gNs_8033 in
                                    {10267}out(c, (enc(m2_8034,pkCli_8014),sign(m2_8034,skSess_8011)));
                                    {10268}event beginSrv(Sess_5170,Cli_5168,gNs_8033)
                            )
                            else
                                {10269}let v_8035: bool = (Disco_5169 = C) in
                                (
                                    {10270}if v_8035 then
                                    (
                                        {10271}let pkDisco_8036: bitstring = pub(skC) in
                                        {10272}in(c, (=pkCli_8014,em1_8037: bitstring,sigM1_8038: bitstring));
                                        {10273}let m1_8039: bitstring = dec(em1_8037,skSess_8011) in
                                        {10274}if (verify(m1_8039,sigM1_8038,pkCli_8014) <> true) then
                                            0
                                        else
                                            {10275}let (SPc_8040: bitstring,PartC_8041: bitstring) = m1_8039 in
                                            {10276}event endSrv(Cli_5168,Sess_5170,PartC_8041);
                                            {10277}new Ns_8042: bitstring;
                                            {10278}let gNs_8043: bitstring = exp(g,Ns_8042) in
                                            {10279}let m2_8044: bitstring = gNs_8043 in
                                            {10280}out(c, (enc(m2_8044,pkCli_8014),sign(m2_8044,skSess_8011)));
                                            {10281}event beginSrv(Sess_5170,Cli_5168,gNs_8043)
                                    )
                                    else
                                        {10282}let pkDisco_8045: bitstring = pub(skI) in
                                        {10283}in(c, (=pkCli_8014,em1_8046: bitstring,sigM1_8047: bitstring));
                                        {10284}let m1_8048: bitstring = dec(em1_8046,skSess_8011) in
                                        {10285}if (verify(m1_8048,sigM1_8047,pkCli_8014) <> true) then
                                            0
                                        else
                                            {10286}let (SPc_8049: bitstring,PartC_8050: bitstring) = m1_8048 in
                                            {10287}event endSrv(Cli_5168,Sess_5170,PartC_8050);
                                            {10288}new Ns_8051: bitstring;
                                            {10289}let gNs_8052: bitstring = exp(g,Ns_8051) in
                                            {10290}let m2_8053: bitstring = gNs_8052 in
                                            {10291}out(c, (enc(m2_8053,pkCli_8014),sign(m2_8053,skSess_8011)));
                                            {10292}event beginSrv(Sess_5170,Cli_5168,gNs_8052)
                                )
                                else
                                    {10293}let pkDisco_8054: bitstring = fail-any in
                                    {10294}in(c, (=pkCli_8014,em1_8055: bitstring,sigM1_8056: bitstring));
                                    {10295}let m1_8057: bitstring = dec(em1_8055,skSess_8011) in
                                    {10296}if (verify(m1_8057,sigM1_8056,pkCli_8014) <> true) then
                                        0
                                    else
                                        {10297}let (SPc_8058: bitstring,PartC_8059: bitstring) = m1_8057 in
                                        {10298}event endSrv(Cli_5168,Sess_5170,PartC_8059);
                                        {10299}new Ns_8060: bitstring;
                                        {10300}let gNs_8061: bitstring = exp(g,Ns_8060) in
                                        {10301}let m2_8062: bitstring = gNs_8061 in
                                        {10302}out(c, (enc(m2_8062,pkCli_8014),sign(m2_8062,skSess_8011)));
                                        {10303}event beginSrv(Sess_5170,Cli_5168,gNs_8061)
                        )
                        else
                            {10304}let pkDisco_8063: bitstring = fail-any in
                            {10305}in(c, (=pkCli_8014,em1_8064: bitstring,sigM1_8065: bitstring));
                            {10306}let m1_8066: bitstring = dec(em1_8064,skSess_8011) in
                            {10307}if (verify(m1_8066,sigM1_8065,pkCli_8014) <> true) then
                                0
                            else
                                {10308}let (SPc_8067: bitstring,PartC_8068: bitstring) = m1_8066 in
                                {10309}event endSrv(Cli_5168,Sess_5170,PartC_8068);
                                {10310}new Ns_8069: bitstring;
                                {10311}let gNs_8070: bitstring = exp(g,Ns_8069) in
                                {10312}let m2_8071: bitstring = gNs_8070 in
                                {10313}out(c, (enc(m2_8071,pkCli_8014),sign(m2_8071,skSess_8011)));
                                {10314}event beginSrv(Sess_5170,Cli_5168,gNs_8070)
                )
                else
                    {10315}let pkDisco_8072: bitstring = fail-any in
                    {10316}in(c, (=pkCli_8014,em1_8073: bitstring,sigM1_8074: bitstring));
                    {10317}let m1_8075: bitstring = dec(em1_8073,skSess_8011) in
                    {10318}if (verify(m1_8075,sigM1_8074,pkCli_8014) <> true) then
                        0
                    else
                        {10319}let (SPc_8076: bitstring,PartC_8077: bitstring) = m1_8075 in
                        {10320}event endSrv(Cli_5168,Sess_5170,PartC_8077);
                        {10321}new Ns_8078: bitstring;
                        {10322}let gNs_8079: bitstring = exp(g,Ns_8078) in
                        {10323}let m2_8080: bitstring = gNs_8079 in
                        {10324}out(c, (enc(m2_8080,pkCli_8014),sign(m2_8080,skSess_8011)));
                        {10325}event beginSrv(Sess_5170,Cli_5168,gNs_8079)
            )
            else
                {10326}let v_8081: bool = (Cli_5168 = B) in
                (
                    {10327}if v_8081 then
                    (
                        {10328}let pkCli_8082: bitstring = pub(skB) in
                        {10329}let v_8083: bool = (Disco_5169 = A) in
                        (
                            {10330}if v_8083 then
                            (
                                {10331}let pkDisco_8084: bitstring = pub(skA) in
                                {10332}in(c, (=pkCli_8082,em1_8085: bitstring,sigM1_8086: bitstring));
                                {10333}let m1_8087: bitstring = dec(em1_8085,skSess_8011) in
                                {10334}if (verify(m1_8087,sigM1_8086,pkCli_8082) <> true) then
                                    0
                                else
                                    {10335}let (SPc_8088: bitstring,PartC_8089: bitstring) = m1_8087 in
                                    {10336}event endSrv(Cli_5168,Sess_5170,PartC_8089);
                                    {10337}new Ns_8090: bitstring;
                                    {10338}let gNs_8091: bitstring = exp(g,Ns_8090) in
                                    {10339}let m2_8092: bitstring = gNs_8091 in
                                    {10340}out(c, (enc(m2_8092,pkCli_8082),sign(m2_8092,skSess_8011)));
                                    {10341}event beginSrv(Sess_5170,Cli_5168,gNs_8091)
                            )
                            else
                                {10342}let v_8093: bool = (Disco_5169 = B) in
                                (
                                    {10343}if v_8093 then
                                    (
                                        {10344}let pkDisco_8094: bitstring = pub(skB) in
                                        {10345}in(c, (=pkCli_8082,em1_8095: bitstring,sigM1_8096: bitstring));
                                        {10346}let m1_8097: bitstring = dec(em1_8095,skSess_8011) in
                                        {10347}if (verify(m1_8097,sigM1_8096,pkCli_8082) <> true) then
                                            0
                                        else
                                            {10348}let (SPc_8098: bitstring,PartC_8099: bitstring) = m1_8097 in
                                            {10349}event endSrv(Cli_5168,Sess_5170,PartC_8099);
                                            {10350}new Ns_8100: bitstring;
                                            {10351}let gNs_8101: bitstring = exp(g,Ns_8100) in
                                            {10352}let m2_8102: bitstring = gNs_8101 in
                                            {10353}out(c, (enc(m2_8102,pkCli_8082),sign(m2_8102,skSess_8011)));
                                            {10354}event beginSrv(Sess_5170,Cli_5168,gNs_8101)
                                    )
                                    else
                                        {10355}let v_8103: bool = (Disco_5169 = C) in
                                        (
                                            {10356}if v_8103 then
                                            (
                                                {10357}let pkDisco_8104: bitstring = pub(skC) in
                                                {10358}in(c, (=pkCli_8082,em1_8105: bitstring,sigM1_8106: bitstring));
                                                {10359}let m1_8107: bitstring = dec(em1_8105,skSess_8011) in
                                                {10360}if (verify(m1_8107,sigM1_8106,pkCli_8082) <> true) then
                                                    0
                                                else
                                                    {10361}let (SPc_8108: bitstring,PartC_8109: bitstring) = m1_8107 in
                                                    {10362}event endSrv(Cli_5168,Sess_5170,PartC_8109);
                                                    {10363}new Ns_8110: bitstring;
                                                    {10364}let gNs_8111: bitstring = exp(g,Ns_8110) in
                                                    {10365}let m2_8112: bitstring = gNs_8111 in
                                                    {10366}out(c, (enc(m2_8112,pkCli_8082),sign(m2_8112,skSess_8011)));
                                                    {10367}event beginSrv(Sess_5170,Cli_5168,gNs_8111)
                                            )
                                            else
                                                {10368}let pkDisco_8113: bitstring = pub(skI) in
                                                {10369}in(c, (=pkCli_8082,em1_8114: bitstring,sigM1_8115: bitstring));
                                                {10370}let m1_8116: bitstring = dec(em1_8114,skSess_8011) in
                                                {10371}if (verify(m1_8116,sigM1_8115,pkCli_8082) <> true) then
                                                    0
                                                else
                                                    {10372}let (SPc_8117: bitstring,PartC_8118: bitstring) = m1_8116 in
                                                    {10373}event endSrv(Cli_5168,Sess_5170,PartC_8118);
                                                    {10374}new Ns_8119: bitstring;
                                                    {10375}let gNs_8120: bitstring = exp(g,Ns_8119) in
                                                    {10376}let m2_8121: bitstring = gNs_8120 in
                                                    {10377}out(c, (enc(m2_8121,pkCli_8082),sign(m2_8121,skSess_8011)));
                                                    {10378}event beginSrv(Sess_5170,Cli_5168,gNs_8120)
                                        )
                                        else
                                            {10379}let pkDisco_8122: bitstring = fail-any in
                                            {10380}in(c, (=pkCli_8082,em1_8123: bitstring,sigM1_8124: bitstring));
                                            {10381}let m1_8125: bitstring = dec(em1_8123,skSess_8011) in
                                            {10382}if (verify(m1_8125,sigM1_8124,pkCli_8082) <> true) then
                                                0
                                            else
                                                {10383}let (SPc_8126: bitstring,PartC_8127: bitstring) = m1_8125 in
                                                {10384}event endSrv(Cli_5168,Sess_5170,PartC_8127);
                                                {10385}new Ns_8128: bitstring;
                                                {10386}let gNs_8129: bitstring = exp(g,Ns_8128) in
                                                {10387}let m2_8130: bitstring = gNs_8129 in
                                                {10388}out(c, (enc(m2_8130,pkCli_8082),sign(m2_8130,skSess_8011)));
                                                {10389}event beginSrv(Sess_5170,Cli_5168,gNs_8129)
                                )
                                else
                                    {10390}let pkDisco_8131: bitstring = fail-any in
                                    {10391}in(c, (=pkCli_8082,em1_8132: bitstring,sigM1_8133: bitstring));
                                    {10392}let m1_8134: bitstring = dec(em1_8132,skSess_8011) in
                                    {10393}if (verify(m1_8134,sigM1_8133,pkCli_8082) <> true) then
                                        0
                                    else
                                        {10394}let (SPc_8135: bitstring,PartC_8136: bitstring) = m1_8134 in
                                        {10395}event endSrv(Cli_5168,Sess_5170,PartC_8136);
                                        {10396}new Ns_8137: bitstring;
                                        {10397}let gNs_8138: bitstring = exp(g,Ns_8137) in
                                        {10398}let m2_8139: bitstring = gNs_8138 in
                                        {10399}out(c, (enc(m2_8139,pkCli_8082),sign(m2_8139,skSess_8011)));
                                        {10400}event beginSrv(Sess_5170,Cli_5168,gNs_8138)
                        )
                        else
                            {10401}let pkDisco_8140: bitstring = fail-any in
                            {10402}in(c, (=pkCli_8082,em1_8141: bitstring,sigM1_8142: bitstring));
                            {10403}let m1_8143: bitstring = dec(em1_8141,skSess_8011) in
                            {10404}if (verify(m1_8143,sigM1_8142,pkCli_8082) <> true) then
                                0
                            else
                                {10405}let (SPc_8144: bitstring,PartC_8145: bitstring) = m1_8143 in
                                {10406}event endSrv(Cli_5168,Sess_5170,PartC_8145);
                                {10407}new Ns_8146: bitstring;
                                {10408}let gNs_8147: bitstring = exp(g,Ns_8146) in
                                {10409}let m2_8148: bitstring = gNs_8147 in
                                {10410}out(c, (enc(m2_8148,pkCli_8082),sign(m2_8148,skSess_8011)));
                                {10411}event beginSrv(Sess_5170,Cli_5168,gNs_8147)
                    )
                    else
                        {10412}let v_8149: bool = (Cli_5168 = C) in
                        (
                            {10413}if v_8149 then
                            (
                                {10414}let pkCli_8150: bitstring = pub(skC) in
                                {10415}let v_8151: bool = (Disco_5169 = A) in
                                (
                                    {10416}if v_8151 then
                                    (
                                        {10417}let pkDisco_8152: bitstring = pub(skA) in
                                        {10418}in(c, (=pkCli_8150,em1_8153: bitstring,sigM1_8154: bitstring));
                                        {10419}let m1_8155: bitstring = dec(em1_8153,skSess_8011) in
                                        {10420}if (verify(m1_8155,sigM1_8154,pkCli_8150) <> true) then
                                            0
                                        else
                                            {10421}let (SPc_8156: bitstring,PartC_8157: bitstring) = m1_8155 in
                                            {10422}event endSrv(Cli_5168,Sess_5170,PartC_8157);
                                            {10423}new Ns_8158: bitstring;
                                            {10424}let gNs_8159: bitstring = exp(g,Ns_8158) in
                                            {10425}let m2_8160: bitstring = gNs_8159 in
                                            {10426}out(c, (enc(m2_8160,pkCli_8150),sign(m2_8160,skSess_8011)));
                                            {10427}event beginSrv(Sess_5170,Cli_5168,gNs_8159)
                                    )
                                    else
                                        {10428}let v_8161: bool = (Disco_5169 = B) in
                                        (
                                            {10429}if v_8161 then
                                            (
                                                {10430}let pkDisco_8162: bitstring = pub(skB) in
                                                {10431}in(c, (=pkCli_8150,em1_8163: bitstring,sigM1_8164: bitstring));
                                                {10432}let m1_8165: bitstring = dec(em1_8163,skSess_8011) in
                                                {10433}if (verify(m1_8165,sigM1_8164,pkCli_8150) <> true) then
                                                    0
                                                else
                                                    {10434}let (SPc_8166: bitstring,PartC_8167: bitstring) = m1_8165 in
                                                    {10435}event endSrv(Cli_5168,Sess_5170,PartC_8167);
                                                    {10436}new Ns_8168: bitstring;
                                                    {10437}let gNs_8169: bitstring = exp(g,Ns_8168) in
                                                    {10438}let m2_8170: bitstring = gNs_8169 in
                                                    {10439}out(c, (enc(m2_8170,pkCli_8150),sign(m2_8170,skSess_8011)));
                                                    {10440}event beginSrv(Sess_5170,Cli_5168,gNs_8169)
                                            )
                                            else
                                                {10441}let v_8171: bool = (Disco_5169 = C) in
                                                (
                                                    {10442}if v_8171 then
                                                    (
                                                        {10443}let pkDisco_8172: bitstring = pub(skC) in
                                                        {10444}in(c, (=pkCli_8150,em1_8173: bitstring,sigM1_8174: bitstring));
                                                        {10445}let m1_8175: bitstring = dec(em1_8173,skSess_8011) in
                                                        {10446}if (verify(m1_8175,sigM1_8174,pkCli_8150) <> true) then
                                                            0
                                                        else
                                                            {10447}let (SPc_8176: bitstring,PartC_8177: bitstring) = m1_8175 in
                                                            {10448}event endSrv(Cli_5168,Sess_5170,PartC_8177);
                                                            {10449}new Ns_8178: bitstring;
                                                            {10450}let gNs_8179: bitstring = exp(g,Ns_8178) in
                                                            {10451}let m2_8180: bitstring = gNs_8179 in
                                                            {10452}out(c, (enc(m2_8180,pkCli_8150),sign(m2_8180,skSess_8011)));
                                                            {10453}event beginSrv(Sess_5170,Cli_5168,gNs_8179)
                                                    )
                                                    else
                                                        {10454}let pkDisco_8181: bitstring = pub(skI) in
                                                        {10455}in(c, (=pkCli_8150,em1_8182: bitstring,sigM1_8183: bitstring));
                                                        {10456}let m1_8184: bitstring = dec(em1_8182,skSess_8011) in
                                                        {10457}if (verify(m1_8184,sigM1_8183,pkCli_8150) <> true) then
                                                            0
                                                        else
                                                            {10458}let (SPc_8185: bitstring,PartC_8186: bitstring) = m1_8184 in
                                                            {10459}event endSrv(Cli_5168,Sess_5170,PartC_8186);
                                                            {10460}new Ns_8187: bitstring;
                                                            {10461}let gNs_8188: bitstring = exp(g,Ns_8187) in
                                                            {10462}let m2_8189: bitstring = gNs_8188 in
                                                            {10463}out(c, (enc(m2_8189,pkCli_8150),sign(m2_8189,skSess_8011)));
                                                            {10464}event beginSrv(Sess_5170,Cli_5168,gNs_8188)
                                                )
                                                else
                                                    {10465}let pkDisco_8190: bitstring = fail-any in
                                                    {10466}in(c, (=pkCli_8150,em1_8191: bitstring,sigM1_8192: bitstring));
                                                    {10467}let m1_8193: bitstring = dec(em1_8191,skSess_8011) in
                                                    {10468}if (verify(m1_8193,sigM1_8192,pkCli_8150) <> true) then
                                                        0
                                                    else
                                                        {10469}let (SPc_8194: bitstring,PartC_8195: bitstring) = m1_8193 in
                                                        {10470}event endSrv(Cli_5168,Sess_5170,PartC_8195);
                                                        {10471}new Ns_8196: bitstring;
                                                        {10472}let gNs_8197: bitstring = exp(g,Ns_8196) in
                                                        {10473}let m2_8198: bitstring = gNs_8197 in
                                                        {10474}out(c, (enc(m2_8198,pkCli_8150),sign(m2_8198,skSess_8011)));
                                                        {10475}event beginSrv(Sess_5170,Cli_5168,gNs_8197)
                                        )
                                        else
                                            {10476}let pkDisco_8199: bitstring = fail-any in
                                            {10477}in(c, (=pkCli_8150,em1_8200: bitstring,sigM1_8201: bitstring));
                                            {10478}let m1_8202: bitstring = dec(em1_8200,skSess_8011) in
                                            {10479}if (verify(m1_8202,sigM1_8201,pkCli_8150) <> true) then
                                                0
                                            else
                                                {10480}let (SPc_8203: bitstring,PartC_8204: bitstring) = m1_8202 in
                                                {10481}event endSrv(Cli_5168,Sess_5170,PartC_8204);
                                                {10482}new Ns_8205: bitstring;
                                                {10483}let gNs_8206: bitstring = exp(g,Ns_8205) in
                                                {10484}let m2_8207: bitstring = gNs_8206 in
                                                {10485}out(c, (enc(m2_8207,pkCli_8150),sign(m2_8207,skSess_8011)));
                                                {10486}event beginSrv(Sess_5170,Cli_5168,gNs_8206)
                                )
                                else
                                    {10487}let pkDisco_8208: bitstring = fail-any in
                                    {10488}in(c, (=pkCli_8150,em1_8209: bitstring,sigM1_8210: bitstring));
                                    {10489}let m1_8211: bitstring = dec(em1_8209,skSess_8011) in
                                    {10490}if (verify(m1_8211,sigM1_8210,pkCli_8150) <> true) then
                                        0
                                    else
                                        {10491}let (SPc_8212: bitstring,PartC_8213: bitstring) = m1_8211 in
                                        {10492}event endSrv(Cli_5168,Sess_5170,PartC_8213);
                                        {10493}new Ns_8214: bitstring;
                                        {10494}let gNs_8215: bitstring = exp(g,Ns_8214) in
                                        {10495}let m2_8216: bitstring = gNs_8215 in
                                        {10496}out(c, (enc(m2_8216,pkCli_8150),sign(m2_8216,skSess_8011)));
                                        {10497}event beginSrv(Sess_5170,Cli_5168,gNs_8215)
                            )
                            else
                                {10498}let pkCli_8217: bitstring = pub(skI) in
                                {10499}let v_8218: bool = (Disco_5169 = A) in
                                (
                                    {10500}if v_8218 then
                                    (
                                        {10501}let pkDisco_8219: bitstring = pub(skA) in
                                        {10502}in(c, (=pkCli_8217,em1_8220: bitstring,sigM1_8221: bitstring));
                                        {10503}let m1_8222: bitstring = dec(em1_8220,skSess_8011) in
                                        {10504}if (verify(m1_8222,sigM1_8221,pkCli_8217) <> true) then
                                            0
                                        else
                                            {10505}let (SPc_8223: bitstring,PartC_8224: bitstring) = m1_8222 in
                                            {10506}event endSrv(Cli_5168,Sess_5170,PartC_8224);
                                            {10507}new Ns_8225: bitstring;
                                            {10508}let gNs_8226: bitstring = exp(g,Ns_8225) in
                                            {10509}let m2_8227: bitstring = gNs_8226 in
                                            {10510}out(c, (enc(m2_8227,pkCli_8217),sign(m2_8227,skSess_8011)));
                                            {10511}event beginSrv(Sess_5170,Cli_5168,gNs_8226)
                                    )
                                    else
                                        {10512}let v_8228: bool = (Disco_5169 = B) in
                                        (
                                            {10513}if v_8228 then
                                            (
                                                {10514}let pkDisco_8229: bitstring = pub(skB) in
                                                {10515}in(c, (=pkCli_8217,em1_8230: bitstring,sigM1_8231: bitstring));
                                                {10516}let m1_8232: bitstring = dec(em1_8230,skSess_8011) in
                                                {10517}if (verify(m1_8232,sigM1_8231,pkCli_8217) <> true) then
                                                    0
                                                else
                                                    {10518}let (SPc_8233: bitstring,PartC_8234: bitstring) = m1_8232 in
                                                    {10519}event endSrv(Cli_5168,Sess_5170,PartC_8234);
                                                    {10520}new Ns_8235: bitstring;
                                                    {10521}let gNs_8236: bitstring = exp(g,Ns_8235) in
                                                    {10522}let m2_8237: bitstring = gNs_8236 in
                                                    {10523}out(c, (enc(m2_8237,pkCli_8217),sign(m2_8237,skSess_8011)));
                                                    {10524}event beginSrv(Sess_5170,Cli_5168,gNs_8236)
                                            )
                                            else
                                                {10525}let v_8238: bool = (Disco_5169 = C) in
                                                (
                                                    {10526}if v_8238 then
                                                    (
                                                        {10527}let pkDisco_8239: bitstring = pub(skC) in
                                                        {10528}in(c, (=pkCli_8217,em1_8240: bitstring,sigM1_8241: bitstring));
                                                        {10529}let m1_8242: bitstring = dec(em1_8240,skSess_8011) in
                                                        {10530}if (verify(m1_8242,sigM1_8241,pkCli_8217) <> true) then
                                                            0
                                                        else
                                                            {10531}let (SPc_8243: bitstring,PartC_8244: bitstring) = m1_8242 in
                                                            {10532}event endSrv(Cli_5168,Sess_5170,PartC_8244);
                                                            {10533}new Ns_8245: bitstring;
                                                            {10534}let gNs_8246: bitstring = exp(g,Ns_8245) in
                                                            {10535}let m2_8247: bitstring = gNs_8246 in
                                                            {10536}out(c, (enc(m2_8247,pkCli_8217),sign(m2_8247,skSess_8011)));
                                                            {10537}event beginSrv(Sess_5170,Cli_5168,gNs_8246)
                                                    )
                                                    else
                                                        {10538}let pkDisco_8248: bitstring = pub(skI) in
                                                        {10539}in(c, (=pkCli_8217,em1_8249: bitstring,sigM1_8250: bitstring));
                                                        {10540}let m1_8251: bitstring = dec(em1_8249,skSess_8011) in
                                                        {10541}if (verify(m1_8251,sigM1_8250,pkCli_8217) <> true) then
                                                            0
                                                        else
                                                            {10542}let (SPc_8252: bitstring,PartC_8253: bitstring) = m1_8251 in
                                                            {10543}event endSrv(Cli_5168,Sess_5170,PartC_8253);
                                                            {10544}new Ns_8254: bitstring;
                                                            {10545}let gNs_8255: bitstring = exp(g,Ns_8254) in
                                                            {10546}let m2_8256: bitstring = gNs_8255 in
                                                            {10547}out(c, (enc(m2_8256,pkCli_8217),sign(m2_8256,skSess_8011)));
                                                            {10548}event beginSrv(Sess_5170,Cli_5168,gNs_8255)
                                                )
                                                else
                                                    {10549}let pkDisco_8257: bitstring = fail-any in
                                                    {10550}in(c, (=pkCli_8217,em1_8258: bitstring,sigM1_8259: bitstring));
                                                    {10551}let m1_8260: bitstring = dec(em1_8258,skSess_8011) in
                                                    {10552}if (verify(m1_8260,sigM1_8259,pkCli_8217) <> true) then
                                                        0
                                                    else
                                                        {10553}let (SPc_8261: bitstring,PartC_8262: bitstring) = m1_8260 in
                                                        {10554}event endSrv(Cli_5168,Sess_5170,PartC_8262);
                                                        {10555}new Ns_8263: bitstring;
                                                        {10556}let gNs_8264: bitstring = exp(g,Ns_8263) in
                                                        {10557}let m2_8265: bitstring = gNs_8264 in
                                                        {10558}out(c, (enc(m2_8265,pkCli_8217),sign(m2_8265,skSess_8011)));
                                                        {10559}event beginSrv(Sess_5170,Cli_5168,gNs_8264)
                                        )
                                        else
                                            {10560}let pkDisco_8266: bitstring = fail-any in
                                            {10561}in(c, (=pkCli_8217,em1_8267: bitstring,sigM1_8268: bitstring));
                                            {10562}let m1_8269: bitstring = dec(em1_8267,skSess_8011) in
                                            {10563}if (verify(m1_8269,sigM1_8268,pkCli_8217) <> true) then
                                                0
                                            else
                                                {10564}let (SPc_8270: bitstring,PartC_8271: bitstring) = m1_8269 in
                                                {10565}event endSrv(Cli_5168,Sess_5170,PartC_8271);
                                                {10566}new Ns_8272: bitstring;
                                                {10567}let gNs_8273: bitstring = exp(g,Ns_8272) in
                                                {10568}let m2_8274: bitstring = gNs_8273 in
                                                {10569}out(c, (enc(m2_8274,pkCli_8217),sign(m2_8274,skSess_8011)));
                                                {10570}event beginSrv(Sess_5170,Cli_5168,gNs_8273)
                                )
                                else
                                    {10571}let pkDisco_8275: bitstring = fail-any in
                                    {10572}in(c, (=pkCli_8217,em1_8276: bitstring,sigM1_8277: bitstring));
                                    {10573}let m1_8278: bitstring = dec(em1_8276,skSess_8011) in
                                    {10574}if (verify(m1_8278,sigM1_8277,pkCli_8217) <> true) then
                                        0
                                    else
                                        {10575}let (SPc_8279: bitstring,PartC_8280: bitstring) = m1_8278 in
                                        {10576}event endSrv(Cli_5168,Sess_5170,PartC_8280);
                                        {10577}new Ns_8281: bitstring;
                                        {10578}let gNs_8282: bitstring = exp(g,Ns_8281) in
                                        {10579}let m2_8283: bitstring = gNs_8282 in
                                        {10580}out(c, (enc(m2_8283,pkCli_8217),sign(m2_8283,skSess_8011)));
                                        {10581}event beginSrv(Sess_5170,Cli_5168,gNs_8282)
                        )
                        else
                            {10582}let pkCli_8284: bitstring = fail-any in
                            {10583}let v_8285: bool = (Disco_5169 = A) in
                            (
                                {10584}if v_8285 then
                                (
                                    {10585}let pkDisco_8286: bitstring = pub(skA) in
                                    {10586}in(c, (=pkCli_8284,em1_8287: bitstring,sigM1_8288: bitstring));
                                    {10587}let m1_8289: bitstring = dec(em1_8287,skSess_8011) in
                                    {10588}if (verify(m1_8289,sigM1_8288,pkCli_8284) <> true) then
                                        0
                                    else
                                        {10589}let (SPc_8290: bitstring,PartC_8291: bitstring) = m1_8289 in
                                        {10590}event endSrv(Cli_5168,Sess_5170,PartC_8291);
                                        {10591}new Ns_8292: bitstring;
                                        {10592}let gNs_8293: bitstring = exp(g,Ns_8292) in
                                        {10593}let m2_8294: bitstring = gNs_8293 in
                                        {10594}out(c, (enc(m2_8294,pkCli_8284),sign(m2_8294,skSess_8011)));
                                        {10595}event beginSrv(Sess_5170,Cli_5168,gNs_8293)
                                )
                                else
                                    {10596}let v_8295: bool = (Disco_5169 = B) in
                                    (
                                        {10597}if v_8295 then
                                        (
                                            {10598}let pkDisco_8296: bitstring = pub(skB) in
                                            {10599}in(c, (=pkCli_8284,em1_8297: bitstring,sigM1_8298: bitstring));
                                            {10600}let m1_8299: bitstring = dec(em1_8297,skSess_8011) in
                                            {10601}if (verify(m1_8299,sigM1_8298,pkCli_8284) <> true) then
                                                0
                                            else
                                                {10602}let (SPc_8300: bitstring,PartC_8301: bitstring) = m1_8299 in
                                                {10603}event endSrv(Cli_5168,Sess_5170,PartC_8301);
                                                {10604}new Ns_8302: bitstring;
                                                {10605}let gNs_8303: bitstring = exp(g,Ns_8302) in
                                                {10606}let m2_8304: bitstring = gNs_8303 in
                                                {10607}out(c, (enc(m2_8304,pkCli_8284),sign(m2_8304,skSess_8011)));
                                                {10608}event beginSrv(Sess_5170,Cli_5168,gNs_8303)
                                        )
                                        else
                                            {10609}let v_8305: bool = (Disco_5169 = C) in
                                            (
                                                {10610}if v_8305 then
                                                (
                                                    {10611}let pkDisco_8306: bitstring = pub(skC) in
                                                    {10612}in(c, (=pkCli_8284,em1_8307: bitstring,sigM1_8308: bitstring));
                                                    {10613}let m1_8309: bitstring = dec(em1_8307,skSess_8011) in
                                                    {10614}if (verify(m1_8309,sigM1_8308,pkCli_8284) <> true) then
                                                        0
                                                    else
                                                        {10615}let (SPc_8310: bitstring,PartC_8311: bitstring) = m1_8309 in
                                                        {10616}event endSrv(Cli_5168,Sess_5170,PartC_8311);
                                                        {10617}new Ns_8312: bitstring;
                                                        {10618}let gNs_8313: bitstring = exp(g,Ns_8312) in
                                                        {10619}let m2_8314: bitstring = gNs_8313 in
                                                        {10620}out(c, (enc(m2_8314,pkCli_8284),sign(m2_8314,skSess_8011)));
                                                        {10621}event beginSrv(Sess_5170,Cli_5168,gNs_8313)
                                                )
                                                else
                                                    {10622}let pkDisco_8315: bitstring = pub(skI) in
                                                    {10623}in(c, (=pkCli_8284,em1_8316: bitstring,sigM1_8317: bitstring));
                                                    {10624}let m1_8318: bitstring = dec(em1_8316,skSess_8011) in
                                                    {10625}if (verify(m1_8318,sigM1_8317,pkCli_8284) <> true) then
                                                        0
                                                    else
                                                        {10626}let (SPc_8319: bitstring,PartC_8320: bitstring) = m1_8318 in
                                                        {10627}event endSrv(Cli_5168,Sess_5170,PartC_8320);
                                                        {10628}new Ns_8321: bitstring;
                                                        {10629}let gNs_8322: bitstring = exp(g,Ns_8321) in
                                                        {10630}let m2_8323: bitstring = gNs_8322 in
                                                        {10631}out(c, (enc(m2_8323,pkCli_8284),sign(m2_8323,skSess_8011)));
                                                        {10632}event beginSrv(Sess_5170,Cli_5168,gNs_8322)
                                            )
                                            else
                                                {10633}let pkDisco_8324: bitstring = fail-any in
                                                {10634}in(c, (=pkCli_8284,em1_8325: bitstring,sigM1_8326: bitstring));
                                                {10635}let m1_8327: bitstring = dec(em1_8325,skSess_8011) in
                                                {10636}if (verify(m1_8327,sigM1_8326,pkCli_8284) <> true) then
                                                    0
                                                else
                                                    {10637}let (SPc_8328: bitstring,PartC_8329: bitstring) = m1_8327 in
                                                    {10638}event endSrv(Cli_5168,Sess_5170,PartC_8329);
                                                    {10639}new Ns_8330: bitstring;
                                                    {10640}let gNs_8331: bitstring = exp(g,Ns_8330) in
                                                    {10641}let m2_8332: bitstring = gNs_8331 in
                                                    {10642}out(c, (enc(m2_8332,pkCli_8284),sign(m2_8332,skSess_8011)));
                                                    {10643}event beginSrv(Sess_5170,Cli_5168,gNs_8331)
                                    )
                                    else
                                        {10644}let pkDisco_8333: bitstring = fail-any in
                                        {10645}in(c, (=pkCli_8284,em1_8334: bitstring,sigM1_8335: bitstring));
                                        {10646}let m1_8336: bitstring = dec(em1_8334,skSess_8011) in
                                        {10647}if (verify(m1_8336,sigM1_8335,pkCli_8284) <> true) then
                                            0
                                        else
                                            {10648}let (SPc_8337: bitstring,PartC_8338: bitstring) = m1_8336 in
                                            {10649}event endSrv(Cli_5168,Sess_5170,PartC_8338);
                                            {10650}new Ns_8339: bitstring;
                                            {10651}let gNs_8340: bitstring = exp(g,Ns_8339) in
                                            {10652}let m2_8341: bitstring = gNs_8340 in
                                            {10653}out(c, (enc(m2_8341,pkCli_8284),sign(m2_8341,skSess_8011)));
                                            {10654}event beginSrv(Sess_5170,Cli_5168,gNs_8340)
                            )
                            else
                                {10655}let pkDisco_8342: bitstring = fail-any in
                                {10656}in(c, (=pkCli_8284,em1_8343: bitstring,sigM1_8344: bitstring));
                                {10657}let m1_8345: bitstring = dec(em1_8343,skSess_8011) in
                                {10658}if (verify(m1_8345,sigM1_8344,pkCli_8284) <> true) then
                                    0
                                else
                                    {10659}let (SPc_8346: bitstring,PartC_8347: bitstring) = m1_8345 in
                                    {10660}event endSrv(Cli_5168,Sess_5170,PartC_8347);
                                    {10661}new Ns_8348: bitstring;
                                    {10662}let gNs_8349: bitstring = exp(g,Ns_8348) in
                                    {10663}let m2_8350: bitstring = gNs_8349 in
                                    {10664}out(c, (enc(m2_8350,pkCli_8284),sign(m2_8350,skSess_8011)));
                                    {10665}event beginSrv(Sess_5170,Cli_5168,gNs_8349)
                )
                else
                    {10666}let pkCli_8351: bitstring = fail-any in
                    {10667}let v_8352: bool = (Disco_5169 = A) in
                    (
                        {10668}if v_8352 then
                        (
                            {10669}let pkDisco_8353: bitstring = pub(skA) in
                            {10670}in(c, (=pkCli_8351,em1_8354: bitstring,sigM1_8355: bitstring));
                            {10671}let m1_8356: bitstring = dec(em1_8354,skSess_8011) in
                            {10672}if (verify(m1_8356,sigM1_8355,pkCli_8351) <> true) then
                                0
                            else
                                {10673}let (SPc_8357: bitstring,PartC_8358: bitstring) = m1_8356 in
                                {10674}event endSrv(Cli_5168,Sess_5170,PartC_8358);
                                {10675}new Ns_8359: bitstring;
                                {10676}let gNs_8360: bitstring = exp(g,Ns_8359) in
                                {10677}let m2_8361: bitstring = gNs_8360 in
                                {10678}out(c, (enc(m2_8361,pkCli_8351),sign(m2_8361,skSess_8011)));
                                {10679}event beginSrv(Sess_5170,Cli_5168,gNs_8360)
                        )
                        else
                            {10680}let v_8362: bool = (Disco_5169 = B) in
                            (
                                {10681}if v_8362 then
                                (
                                    {10682}let pkDisco_8363: bitstring = pub(skB) in
                                    {10683}in(c, (=pkCli_8351,em1_8364: bitstring,sigM1_8365: bitstring));
                                    {10684}let m1_8366: bitstring = dec(em1_8364,skSess_8011) in
                                    {10685}if (verify(m1_8366,sigM1_8365,pkCli_8351) <> true) then
                                        0
                                    else
                                        {10686}let (SPc_8367: bitstring,PartC_8368: bitstring) = m1_8366 in
                                        {10687}event endSrv(Cli_5168,Sess_5170,PartC_8368);
                                        {10688}new Ns_8369: bitstring;
                                        {10689}let gNs_8370: bitstring = exp(g,Ns_8369) in
                                        {10690}let m2_8371: bitstring = gNs_8370 in
                                        {10691}out(c, (enc(m2_8371,pkCli_8351),sign(m2_8371,skSess_8011)));
                                        {10692}event beginSrv(Sess_5170,Cli_5168,gNs_8370)
                                )
                                else
                                    {10693}let v_8372: bool = (Disco_5169 = C) in
                                    (
                                        {10694}if v_8372 then
                                        (
                                            {10695}let pkDisco_8373: bitstring = pub(skC) in
                                            {10696}in(c, (=pkCli_8351,em1_8374: bitstring,sigM1_8375: bitstring));
                                            {10697}let m1_8376: bitstring = dec(em1_8374,skSess_8011) in
                                            {10698}if (verify(m1_8376,sigM1_8375,pkCli_8351) <> true) then
                                                0
                                            else
                                                {10699}let (SPc_8377: bitstring,PartC_8378: bitstring) = m1_8376 in
                                                {10700}event endSrv(Cli_5168,Sess_5170,PartC_8378);
                                                {10701}new Ns_8379: bitstring;
                                                {10702}let gNs_8380: bitstring = exp(g,Ns_8379) in
                                                {10703}let m2_8381: bitstring = gNs_8380 in
                                                {10704}out(c, (enc(m2_8381,pkCli_8351),sign(m2_8381,skSess_8011)));
                                                {10705}event beginSrv(Sess_5170,Cli_5168,gNs_8380)
                                        )
                                        else
                                            {10706}let pkDisco_8382: bitstring = pub(skI) in
                                            {10707}in(c, (=pkCli_8351,em1_8383: bitstring,sigM1_8384: bitstring));
                                            {10708}let m1_8385: bitstring = dec(em1_8383,skSess_8011) in
                                            {10709}if (verify(m1_8385,sigM1_8384,pkCli_8351) <> true) then
                                                0
                                            else
                                                {10710}let (SPc_8386: bitstring,PartC_8387: bitstring) = m1_8385 in
                                                {10711}event endSrv(Cli_5168,Sess_5170,PartC_8387);
                                                {10712}new Ns_8388: bitstring;
                                                {10713}let gNs_8389: bitstring = exp(g,Ns_8388) in
                                                {10714}let m2_8390: bitstring = gNs_8389 in
                                                {10715}out(c, (enc(m2_8390,pkCli_8351),sign(m2_8390,skSess_8011)));
                                                {10716}event beginSrv(Sess_5170,Cli_5168,gNs_8389)
                                    )
                                    else
                                        {10717}let pkDisco_8391: bitstring = fail-any in
                                        {10718}in(c, (=pkCli_8351,em1_8392: bitstring,sigM1_8393: bitstring));
                                        {10719}let m1_8394: bitstring = dec(em1_8392,skSess_8011) in
                                        {10720}if (verify(m1_8394,sigM1_8393,pkCli_8351) <> true) then
                                            0
                                        else
                                            {10721}let (SPc_8395: bitstring,PartC_8396: bitstring) = m1_8394 in
                                            {10722}event endSrv(Cli_5168,Sess_5170,PartC_8396);
                                            {10723}new Ns_8397: bitstring;
                                            {10724}let gNs_8398: bitstring = exp(g,Ns_8397) in
                                            {10725}let m2_8399: bitstring = gNs_8398 in
                                            {10726}out(c, (enc(m2_8399,pkCli_8351),sign(m2_8399,skSess_8011)));
                                            {10727}event beginSrv(Sess_5170,Cli_5168,gNs_8398)
                            )
                            else
                                {10728}let pkDisco_8400: bitstring = fail-any in
                                {10729}in(c, (=pkCli_8351,em1_8401: bitstring,sigM1_8402: bitstring));
                                {10730}let m1_8403: bitstring = dec(em1_8401,skSess_8011) in
                                {10731}if (verify(m1_8403,sigM1_8402,pkCli_8351) <> true) then
                                    0
                                else
                                    {10732}let (SPc_8404: bitstring,PartC_8405: bitstring) = m1_8403 in
                                    {10733}event endSrv(Cli_5168,Sess_5170,PartC_8405);
                                    {10734}new Ns_8406: bitstring;
                                    {10735}let gNs_8407: bitstring = exp(g,Ns_8406) in
                                    {10736}let m2_8408: bitstring = gNs_8407 in
                                    {10737}out(c, (enc(m2_8408,pkCli_8351),sign(m2_8408,skSess_8011)));
                                    {10738}event beginSrv(Sess_5170,Cli_5168,gNs_8407)
                    )
                    else
                        {10739}let pkDisco_8409: bitstring = fail-any in
                        {10740}in(c, (=pkCli_8351,em1_8410: bitstring,sigM1_8411: bitstring));
                        {10741}let m1_8412: bitstring = dec(em1_8410,skSess_8011) in
                        {10742}if (verify(m1_8412,sigM1_8411,pkCli_8351) <> true) then
                            0
                        else
                            {10743}let (SPc_8413: bitstring,PartC_8414: bitstring) = m1_8412 in
                            {10744}event endSrv(Cli_5168,Sess_5170,PartC_8414);
                            {10745}new Ns_8415: bitstring;
                            {10746}let gNs_8416: bitstring = exp(g,Ns_8415) in
                            {10747}let m2_8417: bitstring = gNs_8416 in
                            {10748}out(c, (enc(m2_8417,pkCli_8351),sign(m2_8417,skSess_8011)));
                            {10749}event beginSrv(Sess_5170,Cli_5168,gNs_8416)
        )
        else
            {10750}let pkCli_8418: bitstring = fail-any in
            {10751}let v_8419: bool = (Disco_5169 = A) in
            (
                {10752}if v_8419 then
                (
                    {10753}let pkDisco_8420: bitstring = pub(skA) in
                    {10754}in(c, (=pkCli_8418,em1_8421: bitstring,sigM1_8422: bitstring));
                    {10755}let m1_8423: bitstring = dec(em1_8421,skSess_8011) in
                    {10756}if (verify(m1_8423,sigM1_8422,pkCli_8418) <> true) then
                        0
                    else
                        {10757}let (SPc_8424: bitstring,PartC_8425: bitstring) = m1_8423 in
                        {10758}event endSrv(Cli_5168,Sess_5170,PartC_8425);
                        {10759}new Ns_8426: bitstring;
                        {10760}let gNs_8427: bitstring = exp(g,Ns_8426) in
                        {10761}let m2_8428: bitstring = gNs_8427 in
                        {10762}out(c, (enc(m2_8428,pkCli_8418),sign(m2_8428,skSess_8011)));
                        {10763}event beginSrv(Sess_5170,Cli_5168,gNs_8427)
                )
                else
                    {10764}let v_8429: bool = (Disco_5169 = B) in
                    (
                        {10765}if v_8429 then
                        (
                            {10766}let pkDisco_8430: bitstring = pub(skB) in
                            {10767}in(c, (=pkCli_8418,em1_8431: bitstring,sigM1_8432: bitstring));
                            {10768}let m1_8433: bitstring = dec(em1_8431,skSess_8011) in
                            {10769}if (verify(m1_8433,sigM1_8432,pkCli_8418) <> true) then
                                0
                            else
                                {10770}let (SPc_8434: bitstring,PartC_8435: bitstring) = m1_8433 in
                                {10771}event endSrv(Cli_5168,Sess_5170,PartC_8435);
                                {10772}new Ns_8436: bitstring;
                                {10773}let gNs_8437: bitstring = exp(g,Ns_8436) in
                                {10774}let m2_8438: bitstring = gNs_8437 in
                                {10775}out(c, (enc(m2_8438,pkCli_8418),sign(m2_8438,skSess_8011)));
                                {10776}event beginSrv(Sess_5170,Cli_5168,gNs_8437)
                        )
                        else
                            {10777}let v_8439: bool = (Disco_5169 = C) in
                            (
                                {10778}if v_8439 then
                                (
                                    {10779}let pkDisco_8440: bitstring = pub(skC) in
                                    {10780}in(c, (=pkCli_8418,em1_8441: bitstring,sigM1_8442: bitstring));
                                    {10781}let m1_8443: bitstring = dec(em1_8441,skSess_8011) in
                                    {10782}if (verify(m1_8443,sigM1_8442,pkCli_8418) <> true) then
                                        0
                                    else
                                        {10783}let (SPc_8444: bitstring,PartC_8445: bitstring) = m1_8443 in
                                        {10784}event endSrv(Cli_5168,Sess_5170,PartC_8445);
                                        {10785}new Ns_8446: bitstring;
                                        {10786}let gNs_8447: bitstring = exp(g,Ns_8446) in
                                        {10787}let m2_8448: bitstring = gNs_8447 in
                                        {10788}out(c, (enc(m2_8448,pkCli_8418),sign(m2_8448,skSess_8011)));
                                        {10789}event beginSrv(Sess_5170,Cli_5168,gNs_8447)
                                )
                                else
                                    {10790}let pkDisco_8449: bitstring = pub(skI) in
                                    {10791}in(c, (=pkCli_8418,em1_8450: bitstring,sigM1_8451: bitstring));
                                    {10792}let m1_8452: bitstring = dec(em1_8450,skSess_8011) in
                                    {10793}if (verify(m1_8452,sigM1_8451,pkCli_8418) <> true) then
                                        0
                                    else
                                        {10794}let (SPc_8453: bitstring,PartC_8454: bitstring) = m1_8452 in
                                        {10795}event endSrv(Cli_5168,Sess_5170,PartC_8454);
                                        {10796}new Ns_8455: bitstring;
                                        {10797}let gNs_8456: bitstring = exp(g,Ns_8455) in
                                        {10798}let m2_8457: bitstring = gNs_8456 in
                                        {10799}out(c, (enc(m2_8457,pkCli_8418),sign(m2_8457,skSess_8011)));
                                        {10800}event beginSrv(Sess_5170,Cli_5168,gNs_8456)
                            )
                            else
                                {10801}let pkDisco_8458: bitstring = fail-any in
                                {10802}in(c, (=pkCli_8418,em1_8459: bitstring,sigM1_8460: bitstring));
                                {10803}let m1_8461: bitstring = dec(em1_8459,skSess_8011) in
                                {10804}if (verify(m1_8461,sigM1_8460,pkCli_8418) <> true) then
                                    0
                                else
                                    {10805}let (SPc_8462: bitstring,PartC_8463: bitstring) = m1_8461 in
                                    {10806}event endSrv(Cli_5168,Sess_5170,PartC_8463);
                                    {10807}new Ns_8464: bitstring;
                                    {10808}let gNs_8465: bitstring = exp(g,Ns_8464) in
                                    {10809}let m2_8466: bitstring = gNs_8465 in
                                    {10810}out(c, (enc(m2_8466,pkCli_8418),sign(m2_8466,skSess_8011)));
                                    {10811}event beginSrv(Sess_5170,Cli_5168,gNs_8465)
                    )
                    else
                        {10812}let pkDisco_8467: bitstring = fail-any in
                        {10813}in(c, (=pkCli_8418,em1_8468: bitstring,sigM1_8469: bitstring));
                        {10814}let m1_8470: bitstring = dec(em1_8468,skSess_8011) in
                        {10815}if (verify(m1_8470,sigM1_8469,pkCli_8418) <> true) then
                            0
                        else
                            {10816}let (SPc_8471: bitstring,PartC_8472: bitstring) = m1_8470 in
                            {10817}event endSrv(Cli_5168,Sess_5170,PartC_8472);
                            {10818}new Ns_8473: bitstring;
                            {10819}let gNs_8474: bitstring = exp(g,Ns_8473) in
                            {10820}let m2_8475: bitstring = gNs_8474 in
                            {10821}out(c, (enc(m2_8475,pkCli_8418),sign(m2_8475,skSess_8011)));
                            {10822}event beginSrv(Sess_5170,Cli_5168,gNs_8474)
            )
            else
                {10823}let pkDisco_8476: bitstring = fail-any in
                {10824}in(c, (=pkCli_8418,em1_8477: bitstring,sigM1_8478: bitstring));
                {10825}let m1_8479: bitstring = dec(em1_8477,skSess_8011) in
                {10826}if (verify(m1_8479,sigM1_8478,pkCli_8418) <> true) then
                    0
                else
                    {10827}let (SPc_8480: bitstring,PartC_8481: bitstring) = m1_8479 in
                    {10828}event endSrv(Cli_5168,Sess_5170,PartC_8481);
                    {10829}new Ns_8482: bitstring;
                    {10830}let gNs_8483: bitstring = exp(g,Ns_8482) in
                    {10831}let m2_8484: bitstring = gNs_8483 in
                    {10832}out(c, (enc(m2_8484,pkCli_8418),sign(m2_8484,skSess_8011)));
                    {10833}event beginSrv(Sess_5170,Cli_5168,gNs_8483)
)

-- Query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
Completing...
200 rules inserted. The rule base contains 89 rules. 469 rules in the queue.
400 rules inserted. The rule base contains 124 rules. 466 rules in the queue.
600 rules inserted. The rule base contains 233 rules. 466 rules in the queue.
800 rules inserted. The rule base contains 233 rules. 466 rules in the queue.
1000 rules inserted. The rule base contains 363 rules. 459 rules in the queue.
1200 rules inserted. The rule base contains 331 rules. 446 rules in the queue.
1400 rules inserted. The rule base contains 369 rules. 408 rules in the queue.
1600 rules inserted. The rule base contains 387 rules. 643 rules in the queue.
1800 rules inserted. The rule base contains 494 rules. 739 rules in the queue.
2000 rules inserted. The rule base contains 557 rules. 1117 rules in the queue.
2200 rules inserted. The rule base contains 612 rules. 1691 rules in the queue.
2400 rules inserted. The rule base contains 645 rules. 1883 rules in the queue.
2600 rules inserted. The rule base contains 662 rules. 1603 rules in the queue.
2800 rules inserted. The rule base contains 677 rules. 1699 rules in the queue.
3000 rules inserted. The rule base contains 684 rules. 1729 rules in the queue.
3200 rules inserted. The rule base contains 694 rules. 1793 rules in the queue.
3400 rules inserted. The rule base contains 706 rules. 1855 rules in the queue.
3600 rules inserted. The rule base contains 723 rules. 1986 rules in the queue.
3800 rules inserted. The rule base contains 728 rules. 1981 rules in the queue.
4000 rules inserted. The rule base contains 766 rules. 1970 rules in the queue.
4200 rules inserted. The rule base contains 866 rules. 1943 rules in the queue.
4400 rules inserted. The rule base contains 867 rules. 1942 rules in the queue.
4600 rules inserted. The rule base contains 870 rules. 1939 rules in the queue.
4800 rules inserted. The rule base contains 870 rules. 1939 rules in the queue.
5000 rules inserted. The rule base contains 872 rules. 1937 rules in the queue.
5200 rules inserted. The rule base contains 874 rules. 1935 rules in the queue.
5400 rules inserted. The rule base contains 875 rules. 1934 rules in the queue.
5600 rules inserted. The rule base contains 878 rules. 1931 rules in the queue.
5800 rules inserted. The rule base contains 878 rules. 1931 rules in the queue.
6000 rules inserted. The rule base contains 955 rules. 1931 rules in the queue.
6200 rules inserted. The rule base contains 977 rules. 1949 rules in the queue.
6400 rules inserted. The rule base contains 977 rules. 1949 rules in the queue.
6600 rules inserted. The rule base contains 985 rules. 1949 rules in the queue.
6800 rules inserted. The rule base contains 985 rules. 1949 rules in the queue.
7000 rules inserted. The rule base contains 993 rules. 1949 rules in the queue.
7200 rules inserted. The rule base contains 1001 rules. 1949 rules in the queue.
7400 rules inserted. The rule base contains 1001 rules. 1949 rules in the queue.
7600 rules inserted. The rule base contains 1009 rules. 1949 rules in the queue.
7800 rules inserted. The rule base contains 1017 rules. 1949 rules in the queue.
8000 rules inserted. The rule base contains 1017 rules. 1961 rules in the queue.
8200 rules inserted. The rule base contains 1062 rules. 1972 rules in the queue.
8400 rules inserted. The rule base contains 1085 rules. 1972 rules in the queue.
8600 rules inserted. The rule base contains 1110 rules. 1978 rules in the queue.
8800 rules inserted. The rule base contains 1125 rules. 1984 rules in the queue.
9000 rules inserted. The rule base contains 1157 rules. 1984 rules in the queue.
9200 rules inserted. The rule base contains 1185 rules. 1990 rules in the queue.
9400 rules inserted. The rule base contains 1209 rules. 1990 rules in the queue.
9600 rules inserted. The rule base contains 1229 rules. 1996 rules in the queue.
9800 rules inserted. The rule base contains 1196 rules. 2002 rules in the queue.
10000 rules inserted. The rule base contains 1107 rules. 1999 rules in the queue.
10200 rules inserted. The rule base contains 1101 rules. 2028 rules in the queue.
10400 rules inserted. The rule base contains 1127 rules. 2043 rules in the queue.
10600 rules inserted. The rule base contains 1127 rules. 2069 rules in the queue.
10800 rules inserted. The rule base contains 1146 rules. 2083 rules in the queue.
11000 rules inserted. The rule base contains 1151 rules. 2107 rules in the queue.
11200 rules inserted. The rule base contains 1154 rules. 2133 rules in the queue.
11400 rules inserted. The rule base contains 1163 rules. 2151 rules in the queue.
11600 rules inserted. The rule base contains 1174 rules. 2171 rules in the queue.
11800 rules inserted. The rule base contains 1179 rules. 2189 rules in the queue.
12000 rules inserted. The rule base contains 1177 rules. 2185 rules in the queue.
12200 rules inserted. The rule base contains 1267 rules. 2190 rules in the queue.
12400 rules inserted. The rule base contains 1287 rules. 2212 rules in the queue.
12600 rules inserted. The rule base contains 1367 rules. 2228 rules in the queue.
12800 rules inserted. The rule base contains 1407 rules. 2246 rules in the queue.
13000 rules inserted. The rule base contains 1487 rules. 2262 rules in the queue.
13200 rules inserted. The rule base contains 1563 rules. 2277 rules in the queue.
13400 rules inserted. The rule base contains 1625 rules. 2294 rules in the queue.
13600 rules inserted. The rule base contains 1647 rules. 2314 rules in the queue.
13800 rules inserted. The rule base contains 1745 rules. 2328 rules in the queue.
14000 rules inserted. The rule base contains 1815 rules. 2304 rules in the queue.
14200 rules inserted. The rule base contains 1859 rules. 2240 rules in the queue.
14400 rules inserted. The rule base contains 2021 rules. 2252 rules in the queue.
14600 rules inserted. The rule base contains 2133 rules. 2262 rules in the queue.
14800 rules inserted. The rule base contains 2283 rules. 2273 rules in the queue.
15000 rules inserted. The rule base contains 2429 rules. 2278 rules in the queue.
15200 rules inserted. The rule base contains 2585 rules. 2277 rules in the queue.
15400 rules inserted. The rule base contains 2711 rules. 2293 rules in the queue.
15600 rules inserted. The rule base contains 2887 rules. 2286 rules in the queue.
15800 rules inserted. The rule base contains 2993 rules. 2296 rules in the queue.
16000 rules inserted. The rule base contains 3139 rules. 2326 rules in the queue.
16200 rules inserted. The rule base contains 3315 rules. 2311 rules in the queue.
16400 rules inserted. The rule base contains 3381 rules. 2232 rules in the queue.
16600 rules inserted. The rule base contains 3575 rules. 2162 rules in the queue.
16800 rules inserted. The rule base contains 3759 rules. 2150 rules in the queue.
17000 rules inserted. The rule base contains 3943 rules. 2103 rules in the queue.
17200 rules inserted. The rule base contains 4143 rules. 2053 rules in the queue.
17400 rules inserted. The rule base contains 4327 rules. 2018 rules in the queue.
17600 rules inserted. The rule base contains 4519 rules. 1979 rules in the queue.
17800 rules inserted. The rule base contains 4711 rules. 1923 rules in the queue.
18000 rules inserted. The rule base contains 4903 rules. 1892 rules in the queue.
18200 rules inserted. The rule base contains 5083 rules. 1868 rules in the queue.
18400 rules inserted. The rule base contains 5279 rules. 1814 rules in the queue.
18600 rules inserted. The rule base contains 5471 rules. 1750 rules in the queue.
18800 rules inserted. The rule base contains 5643 rules. 1610 rules in the queue.
19000 rules inserted. The rule base contains 5843 rules. 1534 rules in the queue.
19200 rules inserted. The rule base contains 6043 rules. 1402 rules in the queue.
19400 rules inserted. The rule base contains 6243 rules. 1296 rules in the queue.
19600 rules inserted. The rule base contains 6443 rules. 1164 rules in the queue.
19800 rules inserted. The rule base contains 6643 rules. 1030 rules in the queue.
20000 rules inserted. The rule base contains 6843 rules. 950 rules in the queue.
20200 rules inserted. The rule base contains 7043 rules. 818 rules in the queue.
20400 rules inserted. The rule base contains 7231 rules. 662 rules in the queue.
20600 rules inserted. The rule base contains 7431 rules. 494 rules in the queue.
20800 rules inserted. The rule base contains 7631 rules. 326 rules in the queue.
21000 rules inserted. The rule base contains 7831 rules. 158 rules in the queue.
Starting query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
goal reachable: Cli_198859 <> C[] && Cli_198859 <> B[] && Cli_198859 <> A[] && attacker(SPc_198857) && attacker(PartC_198858) && attacker(Cli_198859) -> end(endCli(C[],B[],exp(g,Ns_6339[sigM1_6335 = sign((SPc_198857,PartC_198858),skI[]),em1_6334 = enc((SPc_198857,PartC_198858),pub(skC[])),Sess_5170 = C[],Disco_5169 = B[],Cli_5168 = Cli_198859,!1 = @sid_198860])))
Abbreviations:
Ns_199673 = Ns_6339[sigM1_6335 = sign((SPc_199652,PartC_199653),skI[]),em1_6334 = enc((SPc_199652,PartC_199653),pub(skC[])),Sess_5170 = C[],Disco_5169 = B[],Cli_5168 = Cli_199654,!1 = @sid_199655]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (B[],B[],C[]).
attacker((B[],B[],C[])).

4. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

5. The attacker has some term UP_199669.
attacker(UP_199669).

6. Using the function Sign the attacker may obtain Sign.
attacker(Sign).

7. The attacker has some term SPs_199668.
attacker(SPs_199668).

8. By 7, the attacker may know SPs_199668.
By 6, the attacker may know Sign.
By 5, the attacker may know UP_199669.
By 4, the attacker may know pub(skC[]).
Using the function 4-tuple the attacker may obtain (SPs_199668,Sign,UP_199669,pub(skC[])).
attacker((SPs_199668,Sign,UP_199669,pub(skC[]))).

9. We assume as hypothesis that
attacker(Cli_199654).

10. By 9, the attacker may know Cli_199654.
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (Cli_199654,B[],C[]).
attacker((Cli_199654,B[],C[])).

11. The message skI[] may be sent to the attacker at output {8}.
attacker(skI[]).

12. We assume as hypothesis that
attacker(PartC_199653).

13. We assume as hypothesis that
attacker(SPc_199652).

14. By 13, the attacker may know SPc_199652.
By 12, the attacker may know PartC_199653.
Using the function 2-tuple the attacker may obtain (SPc_199652,PartC_199653).
attacker((SPc_199652,PartC_199653)).

15. By 14, the attacker may know (SPc_199652,PartC_199653).
By 11, the attacker may know skI[].
Using the function sign the attacker may obtain sign((SPc_199652,PartC_199653),skI[]).
attacker(sign((SPc_199652,PartC_199653),skI[])).

16. By 14, the attacker may know (SPc_199652,PartC_199653).
By 4, the attacker may know pub(skC[]).
Using the function enc the attacker may obtain enc((SPc_199652,PartC_199653),pub(skC[])).
attacker(enc((SPc_199652,PartC_199653),pub(skC[]))).

17. By 11, the attacker may know skI[].
Using the function pub the attacker may obtain pub(skI[]).
attacker(pub(skI[])).

18. By 17, the attacker may know pub(skI[]).
By 16, the attacker may know enc((SPc_199652,PartC_199653),pub(skC[])).
By 15, the attacker may know sign((SPc_199652,PartC_199653),skI[]).
Using the function 3-tuple the attacker may obtain (pub(skI[]),enc((SPc_199652,PartC_199653),pub(skC[])),sign((SPc_199652,PartC_199653),skI[])).
attacker((pub(skI[]),enc((SPc_199652,PartC_199653),pub(skC[])),sign((SPc_199652,PartC_199653),skI[]))).

19. The message (Cli_199654,B[],C[]) that the attacker may have by 10 may be received at input {6655}.
The message (pub(skI[]),enc((SPc_199652,PartC_199653),pub(skC[])),sign((SPc_199652,PartC_199653),skI[])) that the attacker may have by 18 may be received at input {8131}.
We have Cli_199654 <> C[] & Cli_199654 <> B[] & Cli_199654 <> A[].
So the message (enc(exp(g,Ns_199673),pub(skI[])),sign(exp(g,Ns_199673),skC[])) may be sent to the attacker at output {8139}.
attacker((enc(exp(g,Ns_199673),pub(skI[])),sign(exp(g,Ns_199673),skC[]))).

20. By 19, the attacker may know (enc(exp(g,Ns_199673),pub(skI[])),sign(exp(g,Ns_199673),skC[])).
Using the function 2-proj-2-tuple the attacker may obtain sign(exp(g,Ns_199673),skC[]).
attacker(sign(exp(g,Ns_199673),skC[])).

21. By 19, the attacker may know (enc(exp(g,Ns_199673),pub(skI[])),sign(exp(g,Ns_199673),skC[])).
Using the function 1-proj-2-tuple the attacker may obtain enc(exp(g,Ns_199673),pub(skI[])).
attacker(enc(exp(g,Ns_199673),pub(skI[]))).

22. By 21, the attacker may know enc(exp(g,Ns_199673),pub(skI[])).
By 11, the attacker may know skI[].
Using the function dec the attacker may obtain exp(g,Ns_199673).
attacker(exp(g,Ns_199673)).

23. By 22, the attacker may know exp(g,Ns_199673).
By 20, the attacker may know sign(exp(g,Ns_199673),skC[]).
Using the function 2-tuple the attacker may obtain (exp(g,Ns_199673),sign(exp(g,Ns_199673),skC[])).
attacker((exp(g,Ns_199673),sign(exp(g,Ns_199673),skC[]))).

24. The message (B[],B[],C[]) that the attacker may have by 3 may be received at input {10}.
The message (SPs_199668,Sign,UP_199669,pub(skC[])) that the attacker may have by 8 may be received at input {790}.
The message (exp(g,Ns_199673),sign(exp(g,Ns_199673),skC[])) that the attacker may have by 23 may be received at input {797}.
So event endCli(C[],B[],exp(g,Ns_199673)) may be executed at {799}.
end(endCli(C[],B[],exp(g,Ns_199673))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

new skI creating skI_199680 at {7}

out(c, skI_199680) at {8}

in(c, (B,B,C)) at {10} in copy a_199679

out(c, GetEndpointRequest) at {789} in copy a_199679

in(c, (a_199677,Sign,a_199678,pub(skC))) at {790} in copy a_199679

new SPc_1154 creating SPc_231756 at {791} in copy a_199679

new Nc_1155 creating Nc_231757 at {792} in copy a_199679

out(c, (pub(skB),(SPc_231756,exp(g,Nc_231757)),sign((SPc_231756,exp(g,Nc_231757)),skB))) at {795} in copy a_199679

event(beginCli(B,C,exp(g,Nc_231757))) at {796} in copy a_199679

in(c, (a_199675,B,C)) at {6655} in copy a_199676

in(c, (pub(skI_199680),enc((a,a_199674),pub(skC)),sign((a,a_199674),skI_199680))) at {8131} in copy a_199676

event(endSrv(a_199675,C,a_199674)) at {8135} in copy a_199676

new Ns_6339 creating Ns_199681 at {8136} in copy a_199676

out(c, (enc(exp(g,Ns_199681),pub(skI_199680)),sign(exp(g,Ns_199681),skC))) at {8139} in copy a_199676

in(c, (exp(g,Ns_199681),sign(exp(g,Ns_199681),skC))) at {797} in copy a_199679

event(endCli(C,B,exp(g,Ns_199681))) at {799} in copy a_199679

The event endCli(C,B,exp(g,Ns_199681)) is executed.
A trace has been found.
RESULT event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N)) is false.
-- Query event(endSrv(A[],X_241616,N_241617)) ==> event(beginCli(A[],X_241616,N_241617))
Completing...
200 rules inserted. The rule base contains 80 rules. 469 rules in the queue.
400 rules inserted. The rule base contains 124 rules. 466 rules in the queue.
600 rules inserted. The rule base contains 233 rules. 466 rules in the queue.
800 rules inserted. The rule base contains 233 rules. 466 rules in the queue.
1000 rules inserted. The rule base contains 373 rules. 462 rules in the queue.
1200 rules inserted. The rule base contains 339 rules. 454 rules in the queue.
1400 rules inserted. The rule base contains 373 rules. 420 rules in the queue.
1600 rules inserted. The rule base contains 397 rules. 692 rules in the queue.
1800 rules inserted. The rule base contains 502 rules. 772 rules in the queue.
2000 rules inserted. The rule base contains 570 rules. 1140 rules in the queue.
2200 rules inserted. The rule base contains 621 rules. 1681 rules in the queue.
2400 rules inserted. The rule base contains 657 rules. 1934 rules in the queue.
2600 rules inserted. The rule base contains 674 rules. 1621 rules in the queue.
2800 rules inserted. The rule base contains 685 rules. 1684 rules in the queue.
3000 rules inserted. The rule base contains 695 rules. 1748 rules in the queue.
3200 rules inserted. The rule base contains 705 rules. 1812 rules in the queue.
3400 rules inserted. The rule base contains 716 rules. 1875 rules in the queue.
3600 rules inserted. The rule base contains 730 rules. 1972 rules in the queue.
3800 rules inserted. The rule base contains 737 rules. 2002 rules in the queue.
4000 rules inserted. The rule base contains 748 rules. 1991 rules in the queue.
4200 rules inserted. The rule base contains 890 rules. 1960 rules in the queue.
4400 rules inserted. The rule base contains 890 rules. 1960 rules in the queue.
4600 rules inserted. The rule base contains 893 rules. 1957 rules in the queue.
4800 rules inserted. The rule base contains 894 rules. 1956 rules in the queue.
5000 rules inserted. The rule base contains 896 rules. 1954 rules in the queue.
5200 rules inserted. The rule base contains 898 rules. 1952 rules in the queue.
5400 rules inserted. The rule base contains 898 rules. 1952 rules in the queue.
5600 rules inserted. The rule base contains 901 rules. 1949 rules in the queue.
5800 rules inserted. The rule base contains 902 rules. 1948 rules in the queue.
6000 rules inserted. The rule base contains 983 rules. 1948 rules in the queue.
6200 rules inserted. The rule base contains 1008 rules. 1939 rules in the queue.
6400 rules inserted. The rule base contains 1008 rules. 1939 rules in the queue.
6600 rules inserted. The rule base contains 1017 rules. 1939 rules in the queue.
6800 rules inserted. The rule base contains 1017 rules. 1939 rules in the queue.
7000 rules inserted. The rule base contains 1026 rules. 1939 rules in the queue.
7200 rules inserted. The rule base contains 1035 rules. 1939 rules in the queue.
7400 rules inserted. The rule base contains 1035 rules. 1939 rules in the queue.
7600 rules inserted. The rule base contains 1035 rules. 1939 rules in the queue.
7800 rules inserted. The rule base contains 1049 rules. 1939 rules in the queue.
8000 rules inserted. The rule base contains 1053 rules. 1939 rules in the queue.
8200 rules inserted. The rule base contains 1065 rules. 1929 rules in the queue.
8400 rules inserted. The rule base contains 1092 rules. 1929 rules in the queue.
8600 rules inserted. The rule base contains 1115 rules. 1926 rules in the queue.
8800 rules inserted. The rule base contains 1144 rules. 1926 rules in the queue.
9000 rules inserted. The rule base contains 1174 rules. 1923 rules in the queue.
9200 rules inserted. The rule base contains 1203 rules. 1920 rules in the queue.
9400 rules inserted. The rule base contains 1224 rules. 1920 rules in the queue.
9600 rules inserted. The rule base contains 1252 rules. 1920 rules in the queue.
9800 rules inserted. The rule base contains 1288 rules. 1914 rules in the queue.
10000 rules inserted. The rule base contains 1128 rules. 1914 rules in the queue.
10200 rules inserted. The rule base contains 1116 rules. 1895 rules in the queue.
10400 rules inserted. The rule base contains 1137 rules. 1888 rules in the queue.
10600 rules inserted. The rule base contains 1136 rules. 1872 rules in the queue.
10800 rules inserted. The rule base contains 1148 rules. 1860 rules in the queue.
11000 rules inserted. The rule base contains 1157 rules. 1848 rules in the queue.
11200 rules inserted. The rule base contains 1156 rules. 1832 rules in the queue.
11400 rules inserted. The rule base contains 1162 rules. 1823 rules in the queue.
11600 rules inserted. The rule base contains 1161 rules. 1807 rules in the queue.
11800 rules inserted. The rule base contains 1159 rules. 1797 rules in the queue.
12000 rules inserted. The rule base contains 1198 rules. 1774 rules in the queue.
12200 rules inserted. The rule base contains 1214 rules. 1752 rules in the queue.
12400 rules inserted. The rule base contains 1245 rules. 1721 rules in the queue.
12600 rules inserted. The rule base contains 1261 rules. 1699 rules in the queue.
12800 rules inserted. The rule base contains 1302 rules. 1667 rules in the queue.
13000 rules inserted. The rule base contains 1349 rules. 1631 rules in the queue.
13200 rules inserted. The rule base contains 1349 rules. 1614 rules in the queue.
13400 rules inserted. The rule base contains 1392 rules. 1580 rules in the queue.
13600 rules inserted. The rule base contains 1429 rules. 1510 rules in the queue.
13800 rules inserted. The rule base contains 1502 rules. 1403 rules in the queue.
14000 rules inserted. The rule base contains 1594 rules. 1345 rules in the queue.
14200 rules inserted. The rule base contains 1725 rules. 1262 rules in the queue.
14400 rules inserted. The rule base contains 1834 rules. 1191 rules in the queue.
14600 rules inserted. The rule base contains 1951 rules. 1116 rules in the queue.
14800 rules inserted. The rule base contains 2044 rules. 1058 rules in the queue.
15000 rules inserted. The rule base contains 2175 rules. 974 rules in the queue.
15200 rules inserted. The rule base contains 2275 rules. 820 rules in the queue.
15400 rules inserted. The rule base contains 2443 rules. 704 rules in the queue.
15600 rules inserted. The rule base contains 2623 rules. 575 rules in the queue.
15800 rules inserted. The rule base contains 2799 rules. 449 rules in the queue.
16000 rules inserted. The rule base contains 2979 rules. 320 rules in the queue.
16200 rules inserted. The rule base contains 3179 rules. 153 rules in the queue.
Starting query event(endSrv(A[],X_241616,N_241617)) ==> event(beginCli(A[],X_241616,N_241617))
goal reachable: Sess_407912 <> C[] && Sess_407912 <> B[] && Sess_407912 <> A[] && attacker(SPs_407910) && attacker(UP_407911) && attacker(Sess_407912) -> end(endSrv(A[],B[],exp(g,Nc_757[UP_755 = UP_407911,SPs_754 = SPs_407910,Sess = Sess_407912,Disco = C[],Cli = A[],!1 = @sid_407913])))
Abbreviations:
Nc_408557 = Nc_757[UP_755 = UP_408536,SPs_754 = SPs_408535,Sess = Sess_408537,Disco = C[],Cli = A[],!1 = @sid_408538]
SPc_408558 = SPc_756[UP_755 = UP_408536,SPs_754 = SPs_408535,Sess = Sess_408537,Disco = C[],Cli = A[],!1 = @sid_408538]

1. The attacker initially knows B[].
attacker(B[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know B[].
Using the function 3-tuple the attacker may obtain (A[],A[],B[]).
attacker((A[],A[],B[])).

4. We assume as hypothesis that
attacker(Sess_408537).

5. The attacker initially knows C[].
attacker(C[]).

6. By 2, the attacker may know A[].
By 5, the attacker may know C[].
By 4, the attacker may know Sess_408537.
Using the function 3-tuple the attacker may obtain (A[],C[],Sess_408537).
attacker((A[],C[],Sess_408537)).

7. The message skI[] may be sent to the attacker at output {8}.
attacker(skI[]).

8. By 7, the attacker may know skI[].
Using the function pub the attacker may obtain pub(skI[]).
attacker(pub(skI[])).

9. We assume as hypothesis that
attacker(UP_408536).

10. Using the function Sign the attacker may obtain Sign.
attacker(Sign).

11. We assume as hypothesis that
attacker(SPs_408535).

12. By 11, the attacker may know SPs_408535.
By 10, the attacker may know Sign.
By 9, the attacker may know UP_408536.
By 8, the attacker may know pub(skI[]).
Using the function 4-tuple the attacker may obtain (SPs_408535,Sign,UP_408536,pub(skI[])).
attacker((SPs_408535,Sign,UP_408536,pub(skI[]))).

13. The message (A[],C[],Sess_408537) that the attacker may have by 6 may be received at input {10}.
The message (SPs_408535,Sign,UP_408536,pub(skI[])) that the attacker may have by 12 may be received at input {248}.
We have Sess_408537 <> C[] & Sess_408537 <> B[] & Sess_408537 <> A[].
So the message (pub(skA[]),(SPc_408558,exp(g,Nc_408557)),sign((SPc_408558,exp(g,Nc_408557)),skA[])) may be sent to the attacker at output {253}.
attacker((pub(skA[]),(SPc_408558,exp(g,Nc_408557)),sign((SPc_408558,exp(g,Nc_408557)),skA[]))).

14. By 13, the attacker may know (pub(skA[]),(SPc_408558,exp(g,Nc_408557)),sign((SPc_408558,exp(g,Nc_408557)),skA[])).
Using the function 3-proj-3-tuple the attacker may obtain sign((SPc_408558,exp(g,Nc_408557)),skA[]).
attacker(sign((SPc_408558,exp(g,Nc_408557)),skA[])).

15. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

16. By 13, the attacker may know (pub(skA[]),(SPc_408558,exp(g,Nc_408557)),sign((SPc_408558,exp(g,Nc_408557)),skA[])).
Using the function 2-proj-3-tuple the attacker may obtain (SPc_408558,exp(g,Nc_408557)).
attacker((SPc_408558,exp(g,Nc_408557))).

17. By 16, the attacker may know (SPc_408558,exp(g,Nc_408557)).
Using the function 2-proj-2-tuple the attacker may obtain exp(g,Nc_408557).
attacker(exp(g,Nc_408557)).

18. By 16, the attacker may know (SPc_408558,exp(g,Nc_408557)).
Using the function 1-proj-2-tuple the attacker may obtain SPc_408558.
attacker(SPc_408558).

19. By 18, the attacker may know SPc_408558.
By 17, the attacker may know exp(g,Nc_408557).
Using the function 2-tuple the attacker may obtain (SPc_408558,exp(g,Nc_408557)).
attacker((SPc_408558,exp(g,Nc_408557))).

20. By 19, the attacker may know (SPc_408558,exp(g,Nc_408557)).
By 15, the attacker may know pub(skB[]).
Using the function enc the attacker may obtain enc((SPc_408558,exp(g,Nc_408557)),pub(skB[])).
attacker(enc((SPc_408558,exp(g,Nc_408557)),pub(skB[]))).

21. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

22. By 21, the attacker may know pub(skA[]).
By 20, the attacker may know enc((SPc_408558,exp(g,Nc_408557)),pub(skB[])).
By 14, the attacker may know sign((SPc_408558,exp(g,Nc_408557)),skA[]).
Using the function 3-tuple the attacker may obtain (pub(skA[]),enc((SPc_408558,exp(g,Nc_408557)),pub(skB[])),sign((SPc_408558,exp(g,Nc_408557)),skA[])).
attacker((pub(skA[]),enc((SPc_408558,exp(g,Nc_408557)),pub(skB[])),sign((SPc_408558,exp(g,Nc_408557)),skA[]))).

23. The message (A[],A[],B[]) that the attacker may have by 3 may be received at input {6655}.
The message (pub(skA[]),enc((SPc_408558,exp(g,Nc_408557)),pub(skB[])),sign((SPc_408558,exp(g,Nc_408557)),skA[])) that the attacker may have by 22 may be received at input {7264}.
So event endSrv(A[],B[],exp(g,Nc_408557)) may be executed at {7268}.
end(endSrv(A[],B[],exp(g,Nc_408557))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

new skI creating skI_408566 at {7}

out(c, skI_408566) at {8}

in(c, (A,C,a_408561)) at {10} in copy a_408562

out(c, GetEndpointRequest) at {247} in copy a_408562

in(c, (a_408560,Sign,a_408559,pub(skI_408566))) at {248} in copy a_408562

new SPc_756 creating SPc_408565 at {249} in copy a_408562

new Nc_757 creating Nc_408564 at {250} in copy a_408562

out(c, (pub(skA),(SPc_408565,exp(g,Nc_408564)),sign((SPc_408565,exp(g,Nc_408564)),skA))) at {253} in copy a_408562

in(c, (A,A,B)) at {6655} in copy a_408563

in(c, (pub(skA),enc((SPc_408565,exp(g,Nc_408564)),pub(skB)),sign((SPc_408565,exp(g,Nc_408564)),skA))) at {7264} in copy a_408563

event(endSrv(A,B,exp(g,Nc_408564))) at {7268} in copy a_408563

The event endSrv(A,B,exp(g,Nc_408564)) is executed.
A trace has been found.
RESULT event(endSrv(A[],X_241616,N_241617)) ==> event(beginCli(A[],X_241616,N_241617)) is false.
