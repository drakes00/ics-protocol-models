Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_519: bool = (Cli = A) in
    (
        {10}if v_519 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_520: bool = (Disco = A) in
            (
                {14}if v_520 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_521: bool = (Sess = A) in
                    (
                        {17}if v_521 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=SignAndEncrypt,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let gNc: bitstring = exp(g,Nc) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,pkCli,gNc) in
                            {24}event beginCli(Cli,Sess,gNc);
                            {25}out(c, (pkCli,enc(m1,pkSess),sign(h(m1),skCli)));
                            {26}in(c, (em2: bitstring,sigM2: bitstring));
                            {27}let m2: bitstring = dec(em2,skCli) in
                            {28}if (verify(h(m2),sigM2,pkSess) <> true) then
                                0
                            else
                                {29}let (=OpenSecureChannelResponse,PartS: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                                {30}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {31}event endCli(Sess,Cli,PartS)
                        )
                        else
                            {32}let v_522: bool = (Sess = B) in
                            (
                                {33}if v_522 then
                                (
                                    {34}let pkSess_523: bitstring = pub(skB) in
                                    {35}out(c, GetEndpointRequest);
                                    {36}in(c, (=GetEndpointResponse,=pkSess_523,=SignAndEncrypt,SP_524: bitstring,UP_525: bitstring));
                                    {37}new Nc_526: bitstring;
                                    {38}let gNc_527: bitstring = exp(g,Nc_526) in
                                    {39}let m1_528: bitstring = (OpenSecureChannelRequest,pkCli,gNc_527) in
                                    {40}event beginCli(Cli,Sess,gNc_527);
                                    {41}out(c, (pkCli,enc(m1_528,pkSess_523),sign(h(m1_528),skCli)));
                                    {42}in(c, (em2_529: bitstring,sigM2_530: bitstring));
                                    {43}let m2_531: bitstring = dec(em2_529,skCli) in
                                    {44}if (verify(h(m2_531),sigM2_530,pkSess_523) <> true) then
                                        0
                                    else
                                        {45}let (=OpenSecureChannelResponse,PartS_532: bitstring,ST_533: bitstring,TTL_534: bitstring) = m2_531 in
                                        {46}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {47}event endCli(Sess,Cli,PartS_532)
                                )
                                else
                                    {48}let v_535: bool = (Sess = C) in
                                    (
                                        {49}if v_535 then
                                        (
                                            {50}let pkSess_536: bitstring = pub(skC) in
                                            {51}out(c, GetEndpointRequest);
                                            {52}in(c, (=GetEndpointResponse,=pkSess_536,=SignAndEncrypt,SP_537: bitstring,UP_538: bitstring));
                                            {53}new Nc_539: bitstring;
                                            {54}let gNc_540: bitstring = exp(g,Nc_539) in
                                            {55}let m1_541: bitstring = (OpenSecureChannelRequest,pkCli,gNc_540) in
                                            {56}event beginCli(Cli,Sess,gNc_540);
                                            {57}out(c, (pkCli,enc(m1_541,pkSess_536),sign(h(m1_541),skCli)));
                                            {58}in(c, (em2_542: bitstring,sigM2_543: bitstring));
                                            {59}let m2_544: bitstring = dec(em2_542,skCli) in
                                            {60}if (verify(h(m2_544),sigM2_543,pkSess_536) <> true) then
                                                0
                                            else
                                                {61}let (=OpenSecureChannelResponse,PartS_545: bitstring,ST_546: bitstring,TTL_547: bitstring) = m2_544 in
                                                {62}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {63}event endCli(Sess,Cli,PartS_545)
                                        )
                                        else
                                            {64}let pkSess_548: bitstring = pub(sk(Sess)) in
                                            {65}out(c, GetEndpointRequest);
                                            {66}in(c, (=GetEndpointResponse,=pkSess_548,=SignAndEncrypt,SP_549: bitstring,UP_550: bitstring));
                                            {67}new Nc_551: bitstring;
                                            {68}let gNc_552: bitstring = exp(g,Nc_551) in
                                            {69}let m1_553: bitstring = (OpenSecureChannelRequest,pkCli,gNc_552) in
                                            {70}event beginCli(Cli,Sess,gNc_552);
                                            {71}out(c, (pkCli,enc(m1_553,pkSess_548),sign(h(m1_553),skCli)));
                                            {72}in(c, (em2_554: bitstring,sigM2_555: bitstring));
                                            {73}let m2_556: bitstring = dec(em2_554,skCli) in
                                            {74}if (verify(h(m2_556),sigM2_555,pkSess_548) <> true) then
                                                0
                                            else
                                                {75}let (=OpenSecureChannelResponse,PartS_557: bitstring,ST_558: bitstring,TTL_559: bitstring) = m2_556 in
                                                {76}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {77}event endCli(Sess,Cli,PartS_557)
                                    )
                                    else
                                        {78}let pkSess_560: bitstring = fail-any in
                                        {79}out(c, GetEndpointRequest);
                                        {80}in(c, (=GetEndpointResponse,=pkSess_560,=SignAndEncrypt,SP_561: bitstring,UP_562: bitstring));
                                        {81}new Nc_563: bitstring;
                                        {82}let gNc_564: bitstring = exp(g,Nc_563) in
                                        {83}let m1_565: bitstring = (OpenSecureChannelRequest,pkCli,gNc_564) in
                                        {84}event beginCli(Cli,Sess,gNc_564);
                                        {85}out(c, (pkCli,enc(m1_565,pkSess_560),sign(h(m1_565),skCli)));
                                        {86}in(c, (em2_566: bitstring,sigM2_567: bitstring));
                                        {87}let m2_568: bitstring = dec(em2_566,skCli) in
                                        {88}if (verify(h(m2_568),sigM2_567,pkSess_560) <> true) then
                                            0
                                        else
                                            {89}let (=OpenSecureChannelResponse,PartS_569: bitstring,ST_570: bitstring,TTL_571: bitstring) = m2_568 in
                                            {90}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {91}event endCli(Sess,Cli,PartS_569)
                            )
                            else
                                {92}let pkSess_572: bitstring = fail-any in
                                {93}out(c, GetEndpointRequest);
                                {94}in(c, (=GetEndpointResponse,=pkSess_572,=SignAndEncrypt,SP_573: bitstring,UP_574: bitstring));
                                {95}new Nc_575: bitstring;
                                {96}let gNc_576: bitstring = exp(g,Nc_575) in
                                {97}let m1_577: bitstring = (OpenSecureChannelRequest,pkCli,gNc_576) in
                                {98}event beginCli(Cli,Sess,gNc_576);
                                {99}out(c, (pkCli,enc(m1_577,pkSess_572),sign(h(m1_577),skCli)));
                                {100}in(c, (em2_578: bitstring,sigM2_579: bitstring));
                                {101}let m2_580: bitstring = dec(em2_578,skCli) in
                                {102}if (verify(h(m2_580),sigM2_579,pkSess_572) <> true) then
                                    0
                                else
                                    {103}let (=OpenSecureChannelResponse,PartS_581: bitstring,ST_582: bitstring,TTL_583: bitstring) = m2_580 in
                                    {104}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {105}event endCli(Sess,Cli,PartS_581)
                    )
                    else
                        {106}let pkSess_584: bitstring = fail-any in
                        {107}out(c, GetEndpointRequest);
                        {108}in(c, (=GetEndpointResponse,=pkSess_584,=SignAndEncrypt,SP_585: bitstring,UP_586: bitstring));
                        {109}new Nc_587: bitstring;
                        {110}let gNc_588: bitstring = exp(g,Nc_587) in
                        {111}let m1_589: bitstring = (OpenSecureChannelRequest,pkCli,gNc_588) in
                        {112}event beginCli(Cli,Sess,gNc_588);
                        {113}out(c, (pkCli,enc(m1_589,pkSess_584),sign(h(m1_589),skCli)));
                        {114}in(c, (em2_590: bitstring,sigM2_591: bitstring));
                        {115}let m2_592: bitstring = dec(em2_590,skCli) in
                        {116}if (verify(h(m2_592),sigM2_591,pkSess_584) <> true) then
                            0
                        else
                            {117}let (=OpenSecureChannelResponse,PartS_593: bitstring,ST_594: bitstring,TTL_595: bitstring) = m2_592 in
                            {118}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {119}event endCli(Sess,Cli,PartS_593)
                )
                else
                    {120}let v_596: bool = (Disco = B) in
                    (
                        {121}if v_596 then
                        (
                            {122}let pkDisco_597: bitstring = pub(skB) in
                            {123}let v_598: bool = (Sess = A) in
                            (
                                {124}if v_598 then
                                (
                                    {125}let pkSess_599: bitstring = pub(skA) in
                                    {126}out(c, GetEndpointRequest);
                                    {127}in(c, (=GetEndpointResponse,=pkSess_599,=SignAndEncrypt,SP_600: bitstring,UP_601: bitstring));
                                    {128}new Nc_602: bitstring;
                                    {129}let gNc_603: bitstring = exp(g,Nc_602) in
                                    {130}let m1_604: bitstring = (OpenSecureChannelRequest,pkCli,gNc_603) in
                                    {131}event beginCli(Cli,Sess,gNc_603);
                                    {132}out(c, (pkCli,enc(m1_604,pkSess_599),sign(h(m1_604),skCli)));
                                    {133}in(c, (em2_605: bitstring,sigM2_606: bitstring));
                                    {134}let m2_607: bitstring = dec(em2_605,skCli) in
                                    {135}if (verify(h(m2_607),sigM2_606,pkSess_599) <> true) then
                                        0
                                    else
                                        {136}let (=OpenSecureChannelResponse,PartS_608: bitstring,ST_609: bitstring,TTL_610: bitstring) = m2_607 in
                                        {137}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {138}event endCli(Sess,Cli,PartS_608)
                                )
                                else
                                    {139}let v_611: bool = (Sess = B) in
                                    (
                                        {140}if v_611 then
                                        (
                                            {141}let pkSess_612: bitstring = pub(skB) in
                                            {142}out(c, GetEndpointRequest);
                                            {143}in(c, (=GetEndpointResponse,=pkSess_612,=SignAndEncrypt,SP_613: bitstring,UP_614: bitstring));
                                            {144}new Nc_615: bitstring;
                                            {145}let gNc_616: bitstring = exp(g,Nc_615) in
                                            {146}let m1_617: bitstring = (OpenSecureChannelRequest,pkCli,gNc_616) in
                                            {147}event beginCli(Cli,Sess,gNc_616);
                                            {148}out(c, (pkCli,enc(m1_617,pkSess_612),sign(h(m1_617),skCli)));
                                            {149}in(c, (em2_618: bitstring,sigM2_619: bitstring));
                                            {150}let m2_620: bitstring = dec(em2_618,skCli) in
                                            {151}if (verify(h(m2_620),sigM2_619,pkSess_612) <> true) then
                                                0
                                            else
                                                {152}let (=OpenSecureChannelResponse,PartS_621: bitstring,ST_622: bitstring,TTL_623: bitstring) = m2_620 in
                                                {153}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {154}event endCli(Sess,Cli,PartS_621)
                                        )
                                        else
                                            {155}let v_624: bool = (Sess = C) in
                                            (
                                                {156}if v_624 then
                                                (
                                                    {157}let pkSess_625: bitstring = pub(skC) in
                                                    {158}out(c, GetEndpointRequest);
                                                    {159}in(c, (=GetEndpointResponse,=pkSess_625,=SignAndEncrypt,SP_626: bitstring,UP_627: bitstring));
                                                    {160}new Nc_628: bitstring;
                                                    {161}let gNc_629: bitstring = exp(g,Nc_628) in
                                                    {162}let m1_630: bitstring = (OpenSecureChannelRequest,pkCli,gNc_629) in
                                                    {163}event beginCli(Cli,Sess,gNc_629);
                                                    {164}out(c, (pkCli,enc(m1_630,pkSess_625),sign(h(m1_630),skCli)));
                                                    {165}in(c, (em2_631: bitstring,sigM2_632: bitstring));
                                                    {166}let m2_633: bitstring = dec(em2_631,skCli) in
                                                    {167}if (verify(h(m2_633),sigM2_632,pkSess_625) <> true) then
                                                        0
                                                    else
                                                        {168}let (=OpenSecureChannelResponse,PartS_634: bitstring,ST_635: bitstring,TTL_636: bitstring) = m2_633 in
                                                        {169}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {170}event endCli(Sess,Cli,PartS_634)
                                                )
                                                else
                                                    {171}let pkSess_637: bitstring = pub(sk(Sess)) in
                                                    {172}out(c, GetEndpointRequest);
                                                    {173}in(c, (=GetEndpointResponse,=pkSess_637,=SignAndEncrypt,SP_638: bitstring,UP_639: bitstring));
                                                    {174}new Nc_640: bitstring;
                                                    {175}let gNc_641: bitstring = exp(g,Nc_640) in
                                                    {176}let m1_642: bitstring = (OpenSecureChannelRequest,pkCli,gNc_641) in
                                                    {177}event beginCli(Cli,Sess,gNc_641);
                                                    {178}out(c, (pkCli,enc(m1_642,pkSess_637),sign(h(m1_642),skCli)));
                                                    {179}in(c, (em2_643: bitstring,sigM2_644: bitstring));
                                                    {180}let m2_645: bitstring = dec(em2_643,skCli) in
                                                    {181}if (verify(h(m2_645),sigM2_644,pkSess_637) <> true) then
                                                        0
                                                    else
                                                        {182}let (=OpenSecureChannelResponse,PartS_646: bitstring,ST_647: bitstring,TTL_648: bitstring) = m2_645 in
                                                        {183}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {184}event endCli(Sess,Cli,PartS_646)
                                            )
                                            else
                                                {185}let pkSess_649: bitstring = fail-any in
                                                {186}out(c, GetEndpointRequest);
                                                {187}in(c, (=GetEndpointResponse,=pkSess_649,=SignAndEncrypt,SP_650: bitstring,UP_651: bitstring));
                                                {188}new Nc_652: bitstring;
                                                {189}let gNc_653: bitstring = exp(g,Nc_652) in
                                                {190}let m1_654: bitstring = (OpenSecureChannelRequest,pkCli,gNc_653) in
                                                {191}event beginCli(Cli,Sess,gNc_653);
                                                {192}out(c, (pkCli,enc(m1_654,pkSess_649),sign(h(m1_654),skCli)));
                                                {193}in(c, (em2_655: bitstring,sigM2_656: bitstring));
                                                {194}let m2_657: bitstring = dec(em2_655,skCli) in
                                                {195}if (verify(h(m2_657),sigM2_656,pkSess_649) <> true) then
                                                    0
                                                else
                                                    {196}let (=OpenSecureChannelResponse,PartS_658: bitstring,ST_659: bitstring,TTL_660: bitstring) = m2_657 in
                                                    {197}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {198}event endCli(Sess,Cli,PartS_658)
                                    )
                                    else
                                        {199}let pkSess_661: bitstring = fail-any in
                                        {200}out(c, GetEndpointRequest);
                                        {201}in(c, (=GetEndpointResponse,=pkSess_661,=SignAndEncrypt,SP_662: bitstring,UP_663: bitstring));
                                        {202}new Nc_664: bitstring;
                                        {203}let gNc_665: bitstring = exp(g,Nc_664) in
                                        {204}let m1_666: bitstring = (OpenSecureChannelRequest,pkCli,gNc_665) in
                                        {205}event beginCli(Cli,Sess,gNc_665);
                                        {206}out(c, (pkCli,enc(m1_666,pkSess_661),sign(h(m1_666),skCli)));
                                        {207}in(c, (em2_667: bitstring,sigM2_668: bitstring));
                                        {208}let m2_669: bitstring = dec(em2_667,skCli) in
                                        {209}if (verify(h(m2_669),sigM2_668,pkSess_661) <> true) then
                                            0
                                        else
                                            {210}let (=OpenSecureChannelResponse,PartS_670: bitstring,ST_671: bitstring,TTL_672: bitstring) = m2_669 in
                                            {211}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {212}event endCli(Sess,Cli,PartS_670)
                            )
                            else
                                {213}let pkSess_673: bitstring = fail-any in
                                {214}out(c, GetEndpointRequest);
                                {215}in(c, (=GetEndpointResponse,=pkSess_673,=SignAndEncrypt,SP_674: bitstring,UP_675: bitstring));
                                {216}new Nc_676: bitstring;
                                {217}let gNc_677: bitstring = exp(g,Nc_676) in
                                {218}let m1_678: bitstring = (OpenSecureChannelRequest,pkCli,gNc_677) in
                                {219}event beginCli(Cli,Sess,gNc_677);
                                {220}out(c, (pkCli,enc(m1_678,pkSess_673),sign(h(m1_678),skCli)));
                                {221}in(c, (em2_679: bitstring,sigM2_680: bitstring));
                                {222}let m2_681: bitstring = dec(em2_679,skCli) in
                                {223}if (verify(h(m2_681),sigM2_680,pkSess_673) <> true) then
                                    0
                                else
                                    {224}let (=OpenSecureChannelResponse,PartS_682: bitstring,ST_683: bitstring,TTL_684: bitstring) = m2_681 in
                                    {225}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {226}event endCli(Sess,Cli,PartS_682)
                        )
                        else
                            {227}let v_685: bool = (Disco = C) in
                            (
                                {228}if v_685 then
                                (
                                    {229}let pkDisco_686: bitstring = pub(skC) in
                                    {230}let v_687: bool = (Sess = A) in
                                    (
                                        {231}if v_687 then
                                        (
                                            {232}let pkSess_688: bitstring = pub(skA) in
                                            {233}out(c, GetEndpointRequest);
                                            {234}in(c, (=GetEndpointResponse,=pkSess_688,=SignAndEncrypt,SP_689: bitstring,UP_690: bitstring));
                                            {235}new Nc_691: bitstring;
                                            {236}let gNc_692: bitstring = exp(g,Nc_691) in
                                            {237}let m1_693: bitstring = (OpenSecureChannelRequest,pkCli,gNc_692) in
                                            {238}event beginCli(Cli,Sess,gNc_692);
                                            {239}out(c, (pkCli,enc(m1_693,pkSess_688),sign(h(m1_693),skCli)));
                                            {240}in(c, (em2_694: bitstring,sigM2_695: bitstring));
                                            {241}let m2_696: bitstring = dec(em2_694,skCli) in
                                            {242}if (verify(h(m2_696),sigM2_695,pkSess_688) <> true) then
                                                0
                                            else
                                                {243}let (=OpenSecureChannelResponse,PartS_697: bitstring,ST_698: bitstring,TTL_699: bitstring) = m2_696 in
                                                {244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {245}event endCli(Sess,Cli,PartS_697)
                                        )
                                        else
                                            {246}let v_700: bool = (Sess = B) in
                                            (
                                                {247}if v_700 then
                                                (
                                                    {248}let pkSess_701: bitstring = pub(skB) in
                                                    {249}out(c, GetEndpointRequest);
                                                    {250}in(c, (=GetEndpointResponse,=pkSess_701,=SignAndEncrypt,SP_702: bitstring,UP_703: bitstring));
                                                    {251}new Nc_704: bitstring;
                                                    {252}let gNc_705: bitstring = exp(g,Nc_704) in
                                                    {253}let m1_706: bitstring = (OpenSecureChannelRequest,pkCli,gNc_705) in
                                                    {254}event beginCli(Cli,Sess,gNc_705);
                                                    {255}out(c, (pkCli,enc(m1_706,pkSess_701),sign(h(m1_706),skCli)));
                                                    {256}in(c, (em2_707: bitstring,sigM2_708: bitstring));
                                                    {257}let m2_709: bitstring = dec(em2_707,skCli) in
                                                    {258}if (verify(h(m2_709),sigM2_708,pkSess_701) <> true) then
                                                        0
                                                    else
                                                        {259}let (=OpenSecureChannelResponse,PartS_710: bitstring,ST_711: bitstring,TTL_712: bitstring) = m2_709 in
                                                        {260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {261}event endCli(Sess,Cli,PartS_710)
                                                )
                                                else
                                                    {262}let v_713: bool = (Sess = C) in
                                                    (
                                                        {263}if v_713 then
                                                        (
                                                            {264}let pkSess_714: bitstring = pub(skC) in
                                                            {265}out(c, GetEndpointRequest);
                                                            {266}in(c, (=GetEndpointResponse,=pkSess_714,=SignAndEncrypt,SP_715: bitstring,UP_716: bitstring));
                                                            {267}new Nc_717: bitstring;
                                                            {268}let gNc_718: bitstring = exp(g,Nc_717) in
                                                            {269}let m1_719: bitstring = (OpenSecureChannelRequest,pkCli,gNc_718) in
                                                            {270}event beginCli(Cli,Sess,gNc_718);
                                                            {271}out(c, (pkCli,enc(m1_719,pkSess_714),sign(h(m1_719),skCli)));
                                                            {272}in(c, (em2_720: bitstring,sigM2_721: bitstring));
                                                            {273}let m2_722: bitstring = dec(em2_720,skCli) in
                                                            {274}if (verify(h(m2_722),sigM2_721,pkSess_714) <> true) then
                                                                0
                                                            else
                                                                {275}let (=OpenSecureChannelResponse,PartS_723: bitstring,ST_724: bitstring,TTL_725: bitstring) = m2_722 in
                                                                {276}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {277}event endCli(Sess,Cli,PartS_723)
                                                        )
                                                        else
                                                            {278}let pkSess_726: bitstring = pub(sk(Sess)) in
                                                            {279}out(c, GetEndpointRequest);
                                                            {280}in(c, (=GetEndpointResponse,=pkSess_726,=SignAndEncrypt,SP_727: bitstring,UP_728: bitstring));
                                                            {281}new Nc_729: bitstring;
                                                            {282}let gNc_730: bitstring = exp(g,Nc_729) in
                                                            {283}let m1_731: bitstring = (OpenSecureChannelRequest,pkCli,gNc_730) in
                                                            {284}event beginCli(Cli,Sess,gNc_730);
                                                            {285}out(c, (pkCli,enc(m1_731,pkSess_726),sign(h(m1_731),skCli)));
                                                            {286}in(c, (em2_732: bitstring,sigM2_733: bitstring));
                                                            {287}let m2_734: bitstring = dec(em2_732,skCli) in
                                                            {288}if (verify(h(m2_734),sigM2_733,pkSess_726) <> true) then
                                                                0
                                                            else
                                                                {289}let (=OpenSecureChannelResponse,PartS_735: bitstring,ST_736: bitstring,TTL_737: bitstring) = m2_734 in
                                                                {290}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {291}event endCli(Sess,Cli,PartS_735)
                                                    )
                                                    else
                                                        {292}let pkSess_738: bitstring = fail-any in
                                                        {293}out(c, GetEndpointRequest);
                                                        {294}in(c, (=GetEndpointResponse,=pkSess_738,=SignAndEncrypt,SP_739: bitstring,UP_740: bitstring));
                                                        {295}new Nc_741: bitstring;
                                                        {296}let gNc_742: bitstring = exp(g,Nc_741) in
                                                        {297}let m1_743: bitstring = (OpenSecureChannelRequest,pkCli,gNc_742) in
                                                        {298}event beginCli(Cli,Sess,gNc_742);
                                                        {299}out(c, (pkCli,enc(m1_743,pkSess_738),sign(h(m1_743),skCli)));
                                                        {300}in(c, (em2_744: bitstring,sigM2_745: bitstring));
                                                        {301}let m2_746: bitstring = dec(em2_744,skCli) in
                                                        {302}if (verify(h(m2_746),sigM2_745,pkSess_738) <> true) then
                                                            0
                                                        else
                                                            {303}let (=OpenSecureChannelResponse,PartS_747: bitstring,ST_748: bitstring,TTL_749: bitstring) = m2_746 in
                                                            {304}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {305}event endCli(Sess,Cli,PartS_747)
                                            )
                                            else
                                                {306}let pkSess_750: bitstring = fail-any in
                                                {307}out(c, GetEndpointRequest);
                                                {308}in(c, (=GetEndpointResponse,=pkSess_750,=SignAndEncrypt,SP_751: bitstring,UP_752: bitstring));
                                                {309}new Nc_753: bitstring;
                                                {310}let gNc_754: bitstring = exp(g,Nc_753) in
                                                {311}let m1_755: bitstring = (OpenSecureChannelRequest,pkCli,gNc_754) in
                                                {312}event beginCli(Cli,Sess,gNc_754);
                                                {313}out(c, (pkCli,enc(m1_755,pkSess_750),sign(h(m1_755),skCli)));
                                                {314}in(c, (em2_756: bitstring,sigM2_757: bitstring));
                                                {315}let m2_758: bitstring = dec(em2_756,skCli) in
                                                {316}if (verify(h(m2_758),sigM2_757,pkSess_750) <> true) then
                                                    0
                                                else
                                                    {317}let (=OpenSecureChannelResponse,PartS_759: bitstring,ST_760: bitstring,TTL_761: bitstring) = m2_758 in
                                                    {318}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {319}event endCli(Sess,Cli,PartS_759)
                                    )
                                    else
                                        {320}let pkSess_762: bitstring = fail-any in
                                        {321}out(c, GetEndpointRequest);
                                        {322}in(c, (=GetEndpointResponse,=pkSess_762,=SignAndEncrypt,SP_763: bitstring,UP_764: bitstring));
                                        {323}new Nc_765: bitstring;
                                        {324}let gNc_766: bitstring = exp(g,Nc_765) in
                                        {325}let m1_767: bitstring = (OpenSecureChannelRequest,pkCli,gNc_766) in
                                        {326}event beginCli(Cli,Sess,gNc_766);
                                        {327}out(c, (pkCli,enc(m1_767,pkSess_762),sign(h(m1_767),skCli)));
                                        {328}in(c, (em2_768: bitstring,sigM2_769: bitstring));
                                        {329}let m2_770: bitstring = dec(em2_768,skCli) in
                                        {330}if (verify(h(m2_770),sigM2_769,pkSess_762) <> true) then
                                            0
                                        else
                                            {331}let (=OpenSecureChannelResponse,PartS_771: bitstring,ST_772: bitstring,TTL_773: bitstring) = m2_770 in
                                            {332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {333}event endCli(Sess,Cli,PartS_771)
                                )
                                else
                                    {334}let pkDisco_774: bitstring = pub(sk(Disco)) in
                                    {335}let v_775: bool = (Sess = A) in
                                    (
                                        {336}if v_775 then
                                        (
                                            {337}let pkSess_776: bitstring = pub(skA) in
                                            {338}out(c, GetEndpointRequest);
                                            {339}in(c, (=GetEndpointResponse,=pkSess_776,=SignAndEncrypt,SP_777: bitstring,UP_778: bitstring));
                                            {340}new Nc_779: bitstring;
                                            {341}let gNc_780: bitstring = exp(g,Nc_779) in
                                            {342}let m1_781: bitstring = (OpenSecureChannelRequest,pkCli,gNc_780) in
                                            {343}event beginCli(Cli,Sess,gNc_780);
                                            {344}out(c, (pkCli,enc(m1_781,pkSess_776),sign(h(m1_781),skCli)));
                                            {345}in(c, (em2_782: bitstring,sigM2_783: bitstring));
                                            {346}let m2_784: bitstring = dec(em2_782,skCli) in
                                            {347}if (verify(h(m2_784),sigM2_783,pkSess_776) <> true) then
                                                0
                                            else
                                                {348}let (=OpenSecureChannelResponse,PartS_785: bitstring,ST_786: bitstring,TTL_787: bitstring) = m2_784 in
                                                {349}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {350}event endCli(Sess,Cli,PartS_785)
                                        )
                                        else
                                            {351}let v_788: bool = (Sess = B) in
                                            (
                                                {352}if v_788 then
                                                (
                                                    {353}let pkSess_789: bitstring = pub(skB) in
                                                    {354}out(c, GetEndpointRequest);
                                                    {355}in(c, (=GetEndpointResponse,=pkSess_789,=SignAndEncrypt,SP_790: bitstring,UP_791: bitstring));
                                                    {356}new Nc_792: bitstring;
                                                    {357}let gNc_793: bitstring = exp(g,Nc_792) in
                                                    {358}let m1_794: bitstring = (OpenSecureChannelRequest,pkCli,gNc_793) in
                                                    {359}event beginCli(Cli,Sess,gNc_793);
                                                    {360}out(c, (pkCli,enc(m1_794,pkSess_789),sign(h(m1_794),skCli)));
                                                    {361}in(c, (em2_795: bitstring,sigM2_796: bitstring));
                                                    {362}let m2_797: bitstring = dec(em2_795,skCli) in
                                                    {363}if (verify(h(m2_797),sigM2_796,pkSess_789) <> true) then
                                                        0
                                                    else
                                                        {364}let (=OpenSecureChannelResponse,PartS_798: bitstring,ST_799: bitstring,TTL_800: bitstring) = m2_797 in
                                                        {365}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {366}event endCli(Sess,Cli,PartS_798)
                                                )
                                                else
                                                    {367}let v_801: bool = (Sess = C) in
                                                    (
                                                        {368}if v_801 then
                                                        (
                                                            {369}let pkSess_802: bitstring = pub(skC) in
                                                            {370}out(c, GetEndpointRequest);
                                                            {371}in(c, (=GetEndpointResponse,=pkSess_802,=SignAndEncrypt,SP_803: bitstring,UP_804: bitstring));
                                                            {372}new Nc_805: bitstring;
                                                            {373}let gNc_806: bitstring = exp(g,Nc_805) in
                                                            {374}let m1_807: bitstring = (OpenSecureChannelRequest,pkCli,gNc_806) in
                                                            {375}event beginCli(Cli,Sess,gNc_806);
                                                            {376}out(c, (pkCli,enc(m1_807,pkSess_802),sign(h(m1_807),skCli)));
                                                            {377}in(c, (em2_808: bitstring,sigM2_809: bitstring));
                                                            {378}let m2_810: bitstring = dec(em2_808,skCli) in
                                                            {379}if (verify(h(m2_810),sigM2_809,pkSess_802) <> true) then
                                                                0
                                                            else
                                                                {380}let (=OpenSecureChannelResponse,PartS_811: bitstring,ST_812: bitstring,TTL_813: bitstring) = m2_810 in
                                                                {381}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {382}event endCli(Sess,Cli,PartS_811)
                                                        )
                                                        else
                                                            {383}let pkSess_814: bitstring = pub(sk(Sess)) in
                                                            {384}out(c, GetEndpointRequest);
                                                            {385}in(c, (=GetEndpointResponse,=pkSess_814,=SignAndEncrypt,SP_815: bitstring,UP_816: bitstring));
                                                            {386}new Nc_817: bitstring;
                                                            {387}let gNc_818: bitstring = exp(g,Nc_817) in
                                                            {388}let m1_819: bitstring = (OpenSecureChannelRequest,pkCli,gNc_818) in
                                                            {389}event beginCli(Cli,Sess,gNc_818);
                                                            {390}out(c, (pkCli,enc(m1_819,pkSess_814),sign(h(m1_819),skCli)));
                                                            {391}in(c, (em2_820: bitstring,sigM2_821: bitstring));
                                                            {392}let m2_822: bitstring = dec(em2_820,skCli) in
                                                            {393}if (verify(h(m2_822),sigM2_821,pkSess_814) <> true) then
                                                                0
                                                            else
                                                                {394}let (=OpenSecureChannelResponse,PartS_823: bitstring,ST_824: bitstring,TTL_825: bitstring) = m2_822 in
                                                                {395}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {396}event endCli(Sess,Cli,PartS_823)
                                                    )
                                                    else
                                                        {397}let pkSess_826: bitstring = fail-any in
                                                        {398}out(c, GetEndpointRequest);
                                                        {399}in(c, (=GetEndpointResponse,=pkSess_826,=SignAndEncrypt,SP_827: bitstring,UP_828: bitstring));
                                                        {400}new Nc_829: bitstring;
                                                        {401}let gNc_830: bitstring = exp(g,Nc_829) in
                                                        {402}let m1_831: bitstring = (OpenSecureChannelRequest,pkCli,gNc_830) in
                                                        {403}event beginCli(Cli,Sess,gNc_830);
                                                        {404}out(c, (pkCli,enc(m1_831,pkSess_826),sign(h(m1_831),skCli)));
                                                        {405}in(c, (em2_832: bitstring,sigM2_833: bitstring));
                                                        {406}let m2_834: bitstring = dec(em2_832,skCli) in
                                                        {407}if (verify(h(m2_834),sigM2_833,pkSess_826) <> true) then
                                                            0
                                                        else
                                                            {408}let (=OpenSecureChannelResponse,PartS_835: bitstring,ST_836: bitstring,TTL_837: bitstring) = m2_834 in
                                                            {409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {410}event endCli(Sess,Cli,PartS_835)
                                            )
                                            else
                                                {411}let pkSess_838: bitstring = fail-any in
                                                {412}out(c, GetEndpointRequest);
                                                {413}in(c, (=GetEndpointResponse,=pkSess_838,=SignAndEncrypt,SP_839: bitstring,UP_840: bitstring));
                                                {414}new Nc_841: bitstring;
                                                {415}let gNc_842: bitstring = exp(g,Nc_841) in
                                                {416}let m1_843: bitstring = (OpenSecureChannelRequest,pkCli,gNc_842) in
                                                {417}event beginCli(Cli,Sess,gNc_842);
                                                {418}out(c, (pkCli,enc(m1_843,pkSess_838),sign(h(m1_843),skCli)));
                                                {419}in(c, (em2_844: bitstring,sigM2_845: bitstring));
                                                {420}let m2_846: bitstring = dec(em2_844,skCli) in
                                                {421}if (verify(h(m2_846),sigM2_845,pkSess_838) <> true) then
                                                    0
                                                else
                                                    {422}let (=OpenSecureChannelResponse,PartS_847: bitstring,ST_848: bitstring,TTL_849: bitstring) = m2_846 in
                                                    {423}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {424}event endCli(Sess,Cli,PartS_847)
                                    )
                                    else
                                        {425}let pkSess_850: bitstring = fail-any in
                                        {426}out(c, GetEndpointRequest);
                                        {427}in(c, (=GetEndpointResponse,=pkSess_850,=SignAndEncrypt,SP_851: bitstring,UP_852: bitstring));
                                        {428}new Nc_853: bitstring;
                                        {429}let gNc_854: bitstring = exp(g,Nc_853) in
                                        {430}let m1_855: bitstring = (OpenSecureChannelRequest,pkCli,gNc_854) in
                                        {431}event beginCli(Cli,Sess,gNc_854);
                                        {432}out(c, (pkCli,enc(m1_855,pkSess_850),sign(h(m1_855),skCli)));
                                        {433}in(c, (em2_856: bitstring,sigM2_857: bitstring));
                                        {434}let m2_858: bitstring = dec(em2_856,skCli) in
                                        {435}if (verify(h(m2_858),sigM2_857,pkSess_850) <> true) then
                                            0
                                        else
                                            {436}let (=OpenSecureChannelResponse,PartS_859: bitstring,ST_860: bitstring,TTL_861: bitstring) = m2_858 in
                                            {437}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {438}event endCli(Sess,Cli,PartS_859)
                            )
                            else
                                {439}let pkDisco_862: bitstring = fail-any in
                                {440}let v_863: bool = (Sess = A) in
                                (
                                    {441}if v_863 then
                                    (
                                        {442}let pkSess_864: bitstring = pub(skA) in
                                        {443}out(c, GetEndpointRequest);
                                        {444}in(c, (=GetEndpointResponse,=pkSess_864,=SignAndEncrypt,SP_865: bitstring,UP_866: bitstring));
                                        {445}new Nc_867: bitstring;
                                        {446}let gNc_868: bitstring = exp(g,Nc_867) in
                                        {447}let m1_869: bitstring = (OpenSecureChannelRequest,pkCli,gNc_868) in
                                        {448}event beginCli(Cli,Sess,gNc_868);
                                        {449}out(c, (pkCli,enc(m1_869,pkSess_864),sign(h(m1_869),skCli)));
                                        {450}in(c, (em2_870: bitstring,sigM2_871: bitstring));
                                        {451}let m2_872: bitstring = dec(em2_870,skCli) in
                                        {452}if (verify(h(m2_872),sigM2_871,pkSess_864) <> true) then
                                            0
                                        else
                                            {453}let (=OpenSecureChannelResponse,PartS_873: bitstring,ST_874: bitstring,TTL_875: bitstring) = m2_872 in
                                            {454}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {455}event endCli(Sess,Cli,PartS_873)
                                    )
                                    else
                                        {456}let v_876: bool = (Sess = B) in
                                        (
                                            {457}if v_876 then
                                            (
                                                {458}let pkSess_877: bitstring = pub(skB) in
                                                {459}out(c, GetEndpointRequest);
                                                {460}in(c, (=GetEndpointResponse,=pkSess_877,=SignAndEncrypt,SP_878: bitstring,UP_879: bitstring));
                                                {461}new Nc_880: bitstring;
                                                {462}let gNc_881: bitstring = exp(g,Nc_880) in
                                                {463}let m1_882: bitstring = (OpenSecureChannelRequest,pkCli,gNc_881) in
                                                {464}event beginCli(Cli,Sess,gNc_881);
                                                {465}out(c, (pkCli,enc(m1_882,pkSess_877),sign(h(m1_882),skCli)));
                                                {466}in(c, (em2_883: bitstring,sigM2_884: bitstring));
                                                {467}let m2_885: bitstring = dec(em2_883,skCli) in
                                                {468}if (verify(h(m2_885),sigM2_884,pkSess_877) <> true) then
                                                    0
                                                else
                                                    {469}let (=OpenSecureChannelResponse,PartS_886: bitstring,ST_887: bitstring,TTL_888: bitstring) = m2_885 in
                                                    {470}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {471}event endCli(Sess,Cli,PartS_886)
                                            )
                                            else
                                                {472}let v_889: bool = (Sess = C) in
                                                (
                                                    {473}if v_889 then
                                                    (
                                                        {474}let pkSess_890: bitstring = pub(skC) in
                                                        {475}out(c, GetEndpointRequest);
                                                        {476}in(c, (=GetEndpointResponse,=pkSess_890,=SignAndEncrypt,SP_891: bitstring,UP_892: bitstring));
                                                        {477}new Nc_893: bitstring;
                                                        {478}let gNc_894: bitstring = exp(g,Nc_893) in
                                                        {479}let m1_895: bitstring = (OpenSecureChannelRequest,pkCli,gNc_894) in
                                                        {480}event beginCli(Cli,Sess,gNc_894);
                                                        {481}out(c, (pkCli,enc(m1_895,pkSess_890),sign(h(m1_895),skCli)));
                                                        {482}in(c, (em2_896: bitstring,sigM2_897: bitstring));
                                                        {483}let m2_898: bitstring = dec(em2_896,skCli) in
                                                        {484}if (verify(h(m2_898),sigM2_897,pkSess_890) <> true) then
                                                            0
                                                        else
                                                            {485}let (=OpenSecureChannelResponse,PartS_899: bitstring,ST_900: bitstring,TTL_901: bitstring) = m2_898 in
                                                            {486}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {487}event endCli(Sess,Cli,PartS_899)
                                                    )
                                                    else
                                                        {488}let pkSess_902: bitstring = pub(sk(Sess)) in
                                                        {489}out(c, GetEndpointRequest);
                                                        {490}in(c, (=GetEndpointResponse,=pkSess_902,=SignAndEncrypt,SP_903: bitstring,UP_904: bitstring));
                                                        {491}new Nc_905: bitstring;
                                                        {492}let gNc_906: bitstring = exp(g,Nc_905) in
                                                        {493}let m1_907: bitstring = (OpenSecureChannelRequest,pkCli,gNc_906) in
                                                        {494}event beginCli(Cli,Sess,gNc_906);
                                                        {495}out(c, (pkCli,enc(m1_907,pkSess_902),sign(h(m1_907),skCli)));
                                                        {496}in(c, (em2_908: bitstring,sigM2_909: bitstring));
                                                        {497}let m2_910: bitstring = dec(em2_908,skCli) in
                                                        {498}if (verify(h(m2_910),sigM2_909,pkSess_902) <> true) then
                                                            0
                                                        else
                                                            {499}let (=OpenSecureChannelResponse,PartS_911: bitstring,ST_912: bitstring,TTL_913: bitstring) = m2_910 in
                                                            {500}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {501}event endCli(Sess,Cli,PartS_911)
                                                )
                                                else
                                                    {502}let pkSess_914: bitstring = fail-any in
                                                    {503}out(c, GetEndpointRequest);
                                                    {504}in(c, (=GetEndpointResponse,=pkSess_914,=SignAndEncrypt,SP_915: bitstring,UP_916: bitstring));
                                                    {505}new Nc_917: bitstring;
                                                    {506}let gNc_918: bitstring = exp(g,Nc_917) in
                                                    {507}let m1_919: bitstring = (OpenSecureChannelRequest,pkCli,gNc_918) in
                                                    {508}event beginCli(Cli,Sess,gNc_918);
                                                    {509}out(c, (pkCli,enc(m1_919,pkSess_914),sign(h(m1_919),skCli)));
                                                    {510}in(c, (em2_920: bitstring,sigM2_921: bitstring));
                                                    {511}let m2_922: bitstring = dec(em2_920,skCli) in
                                                    {512}if (verify(h(m2_922),sigM2_921,pkSess_914) <> true) then
                                                        0
                                                    else
                                                        {513}let (=OpenSecureChannelResponse,PartS_923: bitstring,ST_924: bitstring,TTL_925: bitstring) = m2_922 in
                                                        {514}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {515}event endCli(Sess,Cli,PartS_923)
                                        )
                                        else
                                            {516}let pkSess_926: bitstring = fail-any in
                                            {517}out(c, GetEndpointRequest);
                                            {518}in(c, (=GetEndpointResponse,=pkSess_926,=SignAndEncrypt,SP_927: bitstring,UP_928: bitstring));
                                            {519}new Nc_929: bitstring;
                                            {520}let gNc_930: bitstring = exp(g,Nc_929) in
                                            {521}let m1_931: bitstring = (OpenSecureChannelRequest,pkCli,gNc_930) in
                                            {522}event beginCli(Cli,Sess,gNc_930);
                                            {523}out(c, (pkCli,enc(m1_931,pkSess_926),sign(h(m1_931),skCli)));
                                            {524}in(c, (em2_932: bitstring,sigM2_933: bitstring));
                                            {525}let m2_934: bitstring = dec(em2_932,skCli) in
                                            {526}if (verify(h(m2_934),sigM2_933,pkSess_926) <> true) then
                                                0
                                            else
                                                {527}let (=OpenSecureChannelResponse,PartS_935: bitstring,ST_936: bitstring,TTL_937: bitstring) = m2_934 in
                                                {528}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {529}event endCli(Sess,Cli,PartS_935)
                                )
                                else
                                    {530}let pkSess_938: bitstring = fail-any in
                                    {531}out(c, GetEndpointRequest);
                                    {532}in(c, (=GetEndpointResponse,=pkSess_938,=SignAndEncrypt,SP_939: bitstring,UP_940: bitstring));
                                    {533}new Nc_941: bitstring;
                                    {534}let gNc_942: bitstring = exp(g,Nc_941) in
                                    {535}let m1_943: bitstring = (OpenSecureChannelRequest,pkCli,gNc_942) in
                                    {536}event beginCli(Cli,Sess,gNc_942);
                                    {537}out(c, (pkCli,enc(m1_943,pkSess_938),sign(h(m1_943),skCli)));
                                    {538}in(c, (em2_944: bitstring,sigM2_945: bitstring));
                                    {539}let m2_946: bitstring = dec(em2_944,skCli) in
                                    {540}if (verify(h(m2_946),sigM2_945,pkSess_938) <> true) then
                                        0
                                    else
                                        {541}let (=OpenSecureChannelResponse,PartS_947: bitstring,ST_948: bitstring,TTL_949: bitstring) = m2_946 in
                                        {542}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {543}event endCli(Sess,Cli,PartS_947)
                    )
                    else
                        {544}let pkDisco_950: bitstring = fail-any in
                        {545}let v_951: bool = (Sess = A) in
                        (
                            {546}if v_951 then
                            (
                                {547}let pkSess_952: bitstring = pub(skA) in
                                {548}out(c, GetEndpointRequest);
                                {549}in(c, (=GetEndpointResponse,=pkSess_952,=SignAndEncrypt,SP_953: bitstring,UP_954: bitstring));
                                {550}new Nc_955: bitstring;
                                {551}let gNc_956: bitstring = exp(g,Nc_955) in
                                {552}let m1_957: bitstring = (OpenSecureChannelRequest,pkCli,gNc_956) in
                                {553}event beginCli(Cli,Sess,gNc_956);
                                {554}out(c, (pkCli,enc(m1_957,pkSess_952),sign(h(m1_957),skCli)));
                                {555}in(c, (em2_958: bitstring,sigM2_959: bitstring));
                                {556}let m2_960: bitstring = dec(em2_958,skCli) in
                                {557}if (verify(h(m2_960),sigM2_959,pkSess_952) <> true) then
                                    0
                                else
                                    {558}let (=OpenSecureChannelResponse,PartS_961: bitstring,ST_962: bitstring,TTL_963: bitstring) = m2_960 in
                                    {559}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {560}event endCli(Sess,Cli,PartS_961)
                            )
                            else
                                {561}let v_964: bool = (Sess = B) in
                                (
                                    {562}if v_964 then
                                    (
                                        {563}let pkSess_965: bitstring = pub(skB) in
                                        {564}out(c, GetEndpointRequest);
                                        {565}in(c, (=GetEndpointResponse,=pkSess_965,=SignAndEncrypt,SP_966: bitstring,UP_967: bitstring));
                                        {566}new Nc_968: bitstring;
                                        {567}let gNc_969: bitstring = exp(g,Nc_968) in
                                        {568}let m1_970: bitstring = (OpenSecureChannelRequest,pkCli,gNc_969) in
                                        {569}event beginCli(Cli,Sess,gNc_969);
                                        {570}out(c, (pkCli,enc(m1_970,pkSess_965),sign(h(m1_970),skCli)));
                                        {571}in(c, (em2_971: bitstring,sigM2_972: bitstring));
                                        {572}let m2_973: bitstring = dec(em2_971,skCli) in
                                        {573}if (verify(h(m2_973),sigM2_972,pkSess_965) <> true) then
                                            0
                                        else
                                            {574}let (=OpenSecureChannelResponse,PartS_974: bitstring,ST_975: bitstring,TTL_976: bitstring) = m2_973 in
                                            {575}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {576}event endCli(Sess,Cli,PartS_974)
                                    )
                                    else
                                        {577}let v_977: bool = (Sess = C) in
                                        (
                                            {578}if v_977 then
                                            (
                                                {579}let pkSess_978: bitstring = pub(skC) in
                                                {580}out(c, GetEndpointRequest);
                                                {581}in(c, (=GetEndpointResponse,=pkSess_978,=SignAndEncrypt,SP_979: bitstring,UP_980: bitstring));
                                                {582}new Nc_981: bitstring;
                                                {583}let gNc_982: bitstring = exp(g,Nc_981) in
                                                {584}let m1_983: bitstring = (OpenSecureChannelRequest,pkCli,gNc_982) in
                                                {585}event beginCli(Cli,Sess,gNc_982);
                                                {586}out(c, (pkCli,enc(m1_983,pkSess_978),sign(h(m1_983),skCli)));
                                                {587}in(c, (em2_984: bitstring,sigM2_985: bitstring));
                                                {588}let m2_986: bitstring = dec(em2_984,skCli) in
                                                {589}if (verify(h(m2_986),sigM2_985,pkSess_978) <> true) then
                                                    0
                                                else
                                                    {590}let (=OpenSecureChannelResponse,PartS_987: bitstring,ST_988: bitstring,TTL_989: bitstring) = m2_986 in
                                                    {591}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {592}event endCli(Sess,Cli,PartS_987)
                                            )
                                            else
                                                {593}let pkSess_990: bitstring = pub(sk(Sess)) in
                                                {594}out(c, GetEndpointRequest);
                                                {595}in(c, (=GetEndpointResponse,=pkSess_990,=SignAndEncrypt,SP_991: bitstring,UP_992: bitstring));
                                                {596}new Nc_993: bitstring;
                                                {597}let gNc_994: bitstring = exp(g,Nc_993) in
                                                {598}let m1_995: bitstring = (OpenSecureChannelRequest,pkCli,gNc_994) in
                                                {599}event beginCli(Cli,Sess,gNc_994);
                                                {600}out(c, (pkCli,enc(m1_995,pkSess_990),sign(h(m1_995),skCli)));
                                                {601}in(c, (em2_996: bitstring,sigM2_997: bitstring));
                                                {602}let m2_998: bitstring = dec(em2_996,skCli) in
                                                {603}if (verify(h(m2_998),sigM2_997,pkSess_990) <> true) then
                                                    0
                                                else
                                                    {604}let (=OpenSecureChannelResponse,PartS_999: bitstring,ST_1000: bitstring,TTL_1001: bitstring) = m2_998 in
                                                    {605}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {606}event endCli(Sess,Cli,PartS_999)
                                        )
                                        else
                                            {607}let pkSess_1002: bitstring = fail-any in
                                            {608}out(c, GetEndpointRequest);
                                            {609}in(c, (=GetEndpointResponse,=pkSess_1002,=SignAndEncrypt,SP_1003: bitstring,UP_1004: bitstring));
                                            {610}new Nc_1005: bitstring;
                                            {611}let gNc_1006: bitstring = exp(g,Nc_1005) in
                                            {612}let m1_1007: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1006) in
                                            {613}event beginCli(Cli,Sess,gNc_1006);
                                            {614}out(c, (pkCli,enc(m1_1007,pkSess_1002),sign(h(m1_1007),skCli)));
                                            {615}in(c, (em2_1008: bitstring,sigM2_1009: bitstring));
                                            {616}let m2_1010: bitstring = dec(em2_1008,skCli) in
                                            {617}if (verify(h(m2_1010),sigM2_1009,pkSess_1002) <> true) then
                                                0
                                            else
                                                {618}let (=OpenSecureChannelResponse,PartS_1011: bitstring,ST_1012: bitstring,TTL_1013: bitstring) = m2_1010 in
                                                {619}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {620}event endCli(Sess,Cli,PartS_1011)
                                )
                                else
                                    {621}let pkSess_1014: bitstring = fail-any in
                                    {622}out(c, GetEndpointRequest);
                                    {623}in(c, (=GetEndpointResponse,=pkSess_1014,=SignAndEncrypt,SP_1015: bitstring,UP_1016: bitstring));
                                    {624}new Nc_1017: bitstring;
                                    {625}let gNc_1018: bitstring = exp(g,Nc_1017) in
                                    {626}let m1_1019: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1018) in
                                    {627}event beginCli(Cli,Sess,gNc_1018);
                                    {628}out(c, (pkCli,enc(m1_1019,pkSess_1014),sign(h(m1_1019),skCli)));
                                    {629}in(c, (em2_1020: bitstring,sigM2_1021: bitstring));
                                    {630}let m2_1022: bitstring = dec(em2_1020,skCli) in
                                    {631}if (verify(h(m2_1022),sigM2_1021,pkSess_1014) <> true) then
                                        0
                                    else
                                        {632}let (=OpenSecureChannelResponse,PartS_1023: bitstring,ST_1024: bitstring,TTL_1025: bitstring) = m2_1022 in
                                        {633}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {634}event endCli(Sess,Cli,PartS_1023)
                        )
                        else
                            {635}let pkSess_1026: bitstring = fail-any in
                            {636}out(c, GetEndpointRequest);
                            {637}in(c, (=GetEndpointResponse,=pkSess_1026,=SignAndEncrypt,SP_1027: bitstring,UP_1028: bitstring));
                            {638}new Nc_1029: bitstring;
                            {639}let gNc_1030: bitstring = exp(g,Nc_1029) in
                            {640}let m1_1031: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1030) in
                            {641}event beginCli(Cli,Sess,gNc_1030);
                            {642}out(c, (pkCli,enc(m1_1031,pkSess_1026),sign(h(m1_1031),skCli)));
                            {643}in(c, (em2_1032: bitstring,sigM2_1033: bitstring));
                            {644}let m2_1034: bitstring = dec(em2_1032,skCli) in
                            {645}if (verify(h(m2_1034),sigM2_1033,pkSess_1026) <> true) then
                                0
                            else
                                {646}let (=OpenSecureChannelResponse,PartS_1035: bitstring,ST_1036: bitstring,TTL_1037: bitstring) = m2_1034 in
                                {647}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {648}event endCli(Sess,Cli,PartS_1035)
            )
            else
                {649}let pkDisco_1038: bitstring = fail-any in
                {650}let v_1039: bool = (Sess = A) in
                (
                    {651}if v_1039 then
                    (
                        {652}let pkSess_1040: bitstring = pub(skA) in
                        {653}out(c, GetEndpointRequest);
                        {654}in(c, (=GetEndpointResponse,=pkSess_1040,=SignAndEncrypt,SP_1041: bitstring,UP_1042: bitstring));
                        {655}new Nc_1043: bitstring;
                        {656}let gNc_1044: bitstring = exp(g,Nc_1043) in
                        {657}let m1_1045: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1044) in
                        {658}event beginCli(Cli,Sess,gNc_1044);
                        {659}out(c, (pkCli,enc(m1_1045,pkSess_1040),sign(h(m1_1045),skCli)));
                        {660}in(c, (em2_1046: bitstring,sigM2_1047: bitstring));
                        {661}let m2_1048: bitstring = dec(em2_1046,skCli) in
                        {662}if (verify(h(m2_1048),sigM2_1047,pkSess_1040) <> true) then
                            0
                        else
                            {663}let (=OpenSecureChannelResponse,PartS_1049: bitstring,ST_1050: bitstring,TTL_1051: bitstring) = m2_1048 in
                            {664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {665}event endCli(Sess,Cli,PartS_1049)
                    )
                    else
                        {666}let v_1052: bool = (Sess = B) in
                        (
                            {667}if v_1052 then
                            (
                                {668}let pkSess_1053: bitstring = pub(skB) in
                                {669}out(c, GetEndpointRequest);
                                {670}in(c, (=GetEndpointResponse,=pkSess_1053,=SignAndEncrypt,SP_1054: bitstring,UP_1055: bitstring));
                                {671}new Nc_1056: bitstring;
                                {672}let gNc_1057: bitstring = exp(g,Nc_1056) in
                                {673}let m1_1058: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1057) in
                                {674}event beginCli(Cli,Sess,gNc_1057);
                                {675}out(c, (pkCli,enc(m1_1058,pkSess_1053),sign(h(m1_1058),skCli)));
                                {676}in(c, (em2_1059: bitstring,sigM2_1060: bitstring));
                                {677}let m2_1061: bitstring = dec(em2_1059,skCli) in
                                {678}if (verify(h(m2_1061),sigM2_1060,pkSess_1053) <> true) then
                                    0
                                else
                                    {679}let (=OpenSecureChannelResponse,PartS_1062: bitstring,ST_1063: bitstring,TTL_1064: bitstring) = m2_1061 in
                                    {680}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {681}event endCli(Sess,Cli,PartS_1062)
                            )
                            else
                                {682}let v_1065: bool = (Sess = C) in
                                (
                                    {683}if v_1065 then
                                    (
                                        {684}let pkSess_1066: bitstring = pub(skC) in
                                        {685}out(c, GetEndpointRequest);
                                        {686}in(c, (=GetEndpointResponse,=pkSess_1066,=SignAndEncrypt,SP_1067: bitstring,UP_1068: bitstring));
                                        {687}new Nc_1069: bitstring;
                                        {688}let gNc_1070: bitstring = exp(g,Nc_1069) in
                                        {689}let m1_1071: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1070) in
                                        {690}event beginCli(Cli,Sess,gNc_1070);
                                        {691}out(c, (pkCli,enc(m1_1071,pkSess_1066),sign(h(m1_1071),skCli)));
                                        {692}in(c, (em2_1072: bitstring,sigM2_1073: bitstring));
                                        {693}let m2_1074: bitstring = dec(em2_1072,skCli) in
                                        {694}if (verify(h(m2_1074),sigM2_1073,pkSess_1066) <> true) then
                                            0
                                        else
                                            {695}let (=OpenSecureChannelResponse,PartS_1075: bitstring,ST_1076: bitstring,TTL_1077: bitstring) = m2_1074 in
                                            {696}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {697}event endCli(Sess,Cli,PartS_1075)
                                    )
                                    else
                                        {698}let pkSess_1078: bitstring = pub(sk(Sess)) in
                                        {699}out(c, GetEndpointRequest);
                                        {700}in(c, (=GetEndpointResponse,=pkSess_1078,=SignAndEncrypt,SP_1079: bitstring,UP_1080: bitstring));
                                        {701}new Nc_1081: bitstring;
                                        {702}let gNc_1082: bitstring = exp(g,Nc_1081) in
                                        {703}let m1_1083: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1082) in
                                        {704}event beginCli(Cli,Sess,gNc_1082);
                                        {705}out(c, (pkCli,enc(m1_1083,pkSess_1078),sign(h(m1_1083),skCli)));
                                        {706}in(c, (em2_1084: bitstring,sigM2_1085: bitstring));
                                        {707}let m2_1086: bitstring = dec(em2_1084,skCli) in
                                        {708}if (verify(h(m2_1086),sigM2_1085,pkSess_1078) <> true) then
                                            0
                                        else
                                            {709}let (=OpenSecureChannelResponse,PartS_1087: bitstring,ST_1088: bitstring,TTL_1089: bitstring) = m2_1086 in
                                            {710}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {711}event endCli(Sess,Cli,PartS_1087)
                                )
                                else
                                    {712}let pkSess_1090: bitstring = fail-any in
                                    {713}out(c, GetEndpointRequest);
                                    {714}in(c, (=GetEndpointResponse,=pkSess_1090,=SignAndEncrypt,SP_1091: bitstring,UP_1092: bitstring));
                                    {715}new Nc_1093: bitstring;
                                    {716}let gNc_1094: bitstring = exp(g,Nc_1093) in
                                    {717}let m1_1095: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1094) in
                                    {718}event beginCli(Cli,Sess,gNc_1094);
                                    {719}out(c, (pkCli,enc(m1_1095,pkSess_1090),sign(h(m1_1095),skCli)));
                                    {720}in(c, (em2_1096: bitstring,sigM2_1097: bitstring));
                                    {721}let m2_1098: bitstring = dec(em2_1096,skCli) in
                                    {722}if (verify(h(m2_1098),sigM2_1097,pkSess_1090) <> true) then
                                        0
                                    else
                                        {723}let (=OpenSecureChannelResponse,PartS_1099: bitstring,ST_1100: bitstring,TTL_1101: bitstring) = m2_1098 in
                                        {724}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {725}event endCli(Sess,Cli,PartS_1099)
                        )
                        else
                            {726}let pkSess_1102: bitstring = fail-any in
                            {727}out(c, GetEndpointRequest);
                            {728}in(c, (=GetEndpointResponse,=pkSess_1102,=SignAndEncrypt,SP_1103: bitstring,UP_1104: bitstring));
                            {729}new Nc_1105: bitstring;
                            {730}let gNc_1106: bitstring = exp(g,Nc_1105) in
                            {731}let m1_1107: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1106) in
                            {732}event beginCli(Cli,Sess,gNc_1106);
                            {733}out(c, (pkCli,enc(m1_1107,pkSess_1102),sign(h(m1_1107),skCli)));
                            {734}in(c, (em2_1108: bitstring,sigM2_1109: bitstring));
                            {735}let m2_1110: bitstring = dec(em2_1108,skCli) in
                            {736}if (verify(h(m2_1110),sigM2_1109,pkSess_1102) <> true) then
                                0
                            else
                                {737}let (=OpenSecureChannelResponse,PartS_1111: bitstring,ST_1112: bitstring,TTL_1113: bitstring) = m2_1110 in
                                {738}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {739}event endCli(Sess,Cli,PartS_1111)
                )
                else
                    {740}let pkSess_1114: bitstring = fail-any in
                    {741}out(c, GetEndpointRequest);
                    {742}in(c, (=GetEndpointResponse,=pkSess_1114,=SignAndEncrypt,SP_1115: bitstring,UP_1116: bitstring));
                    {743}new Nc_1117: bitstring;
                    {744}let gNc_1118: bitstring = exp(g,Nc_1117) in
                    {745}let m1_1119: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1118) in
                    {746}event beginCli(Cli,Sess,gNc_1118);
                    {747}out(c, (pkCli,enc(m1_1119,pkSess_1114),sign(h(m1_1119),skCli)));
                    {748}in(c, (em2_1120: bitstring,sigM2_1121: bitstring));
                    {749}let m2_1122: bitstring = dec(em2_1120,skCli) in
                    {750}if (verify(h(m2_1122),sigM2_1121,pkSess_1114) <> true) then
                        0
                    else
                        {751}let (=OpenSecureChannelResponse,PartS_1123: bitstring,ST_1124: bitstring,TTL_1125: bitstring) = m2_1122 in
                        {752}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {753}event endCli(Sess,Cli,PartS_1123)
        )
        else
            {754}let v_1126: bool = (Cli = B) in
            (
                {755}if v_1126 then
                (
                    {756}let skCli_1127: bitstring = skB in
                    {757}let pkCli_1128: bitstring = pub(skCli_1127) in
                    {758}let v_1129: bool = (Disco = A) in
                    (
                        {759}if v_1129 then
                        (
                            {760}let pkDisco_1130: bitstring = pub(skA) in
                            {761}let v_1131: bool = (Sess = A) in
                            (
                                {762}if v_1131 then
                                (
                                    {763}let pkSess_1132: bitstring = pub(skA) in
                                    {764}out(c, GetEndpointRequest);
                                    {765}in(c, (=GetEndpointResponse,=pkSess_1132,=SignAndEncrypt,SP_1133: bitstring,UP_1134: bitstring));
                                    {766}new Nc_1135: bitstring;
                                    {767}let gNc_1136: bitstring = exp(g,Nc_1135) in
                                    {768}let m1_1137: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1136) in
                                    {769}event beginCli(Cli,Sess,gNc_1136);
                                    {770}out(c, (pkCli_1128,enc(m1_1137,pkSess_1132),sign(h(m1_1137),skCli_1127)));
                                    {771}in(c, (em2_1138: bitstring,sigM2_1139: bitstring));
                                    {772}let m2_1140: bitstring = dec(em2_1138,skCli_1127) in
                                    {773}if (verify(h(m2_1140),sigM2_1139,pkSess_1132) <> true) then
                                        0
                                    else
                                        {774}let (=OpenSecureChannelResponse,PartS_1141: bitstring,ST_1142: bitstring,TTL_1143: bitstring) = m2_1140 in
                                        {775}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {776}event endCli(Sess,Cli,PartS_1141)
                                )
                                else
                                    {777}let v_1144: bool = (Sess = B) in
                                    (
                                        {778}if v_1144 then
                                        (
                                            {779}let pkSess_1145: bitstring = pub(skB) in
                                            {780}out(c, GetEndpointRequest);
                                            {781}in(c, (=GetEndpointResponse,=pkSess_1145,=SignAndEncrypt,SP_1146: bitstring,UP_1147: bitstring));
                                            {782}new Nc_1148: bitstring;
                                            {783}let gNc_1149: bitstring = exp(g,Nc_1148) in
                                            {784}let m1_1150: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1149) in
                                            {785}event beginCli(Cli,Sess,gNc_1149);
                                            {786}out(c, (pkCli_1128,enc(m1_1150,pkSess_1145),sign(h(m1_1150),skCli_1127)));
                                            {787}in(c, (em2_1151: bitstring,sigM2_1152: bitstring));
                                            {788}let m2_1153: bitstring = dec(em2_1151,skCli_1127) in
                                            {789}if (verify(h(m2_1153),sigM2_1152,pkSess_1145) <> true) then
                                                0
                                            else
                                                {790}let (=OpenSecureChannelResponse,PartS_1154: bitstring,ST_1155: bitstring,TTL_1156: bitstring) = m2_1153 in
                                                {791}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {792}event endCli(Sess,Cli,PartS_1154)
                                        )
                                        else
                                            {793}let v_1157: bool = (Sess = C) in
                                            (
                                                {794}if v_1157 then
                                                (
                                                    {795}let pkSess_1158: bitstring = pub(skC) in
                                                    {796}out(c, GetEndpointRequest);
                                                    {797}in(c, (=GetEndpointResponse,=pkSess_1158,=SignAndEncrypt,SP_1159: bitstring,UP_1160: bitstring));
                                                    {798}new Nc_1161: bitstring;
                                                    {799}let gNc_1162: bitstring = exp(g,Nc_1161) in
                                                    {800}let m1_1163: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1162) in
                                                    {801}event beginCli(Cli,Sess,gNc_1162);
                                                    {802}out(c, (pkCli_1128,enc(m1_1163,pkSess_1158),sign(h(m1_1163),skCli_1127)));
                                                    {803}in(c, (em2_1164: bitstring,sigM2_1165: bitstring));
                                                    {804}let m2_1166: bitstring = dec(em2_1164,skCli_1127) in
                                                    {805}if (verify(h(m2_1166),sigM2_1165,pkSess_1158) <> true) then
                                                        0
                                                    else
                                                        {806}let (=OpenSecureChannelResponse,PartS_1167: bitstring,ST_1168: bitstring,TTL_1169: bitstring) = m2_1166 in
                                                        {807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {808}event endCli(Sess,Cli,PartS_1167)
                                                )
                                                else
                                                    {809}let pkSess_1170: bitstring = pub(sk(Sess)) in
                                                    {810}out(c, GetEndpointRequest);
                                                    {811}in(c, (=GetEndpointResponse,=pkSess_1170,=SignAndEncrypt,SP_1171: bitstring,UP_1172: bitstring));
                                                    {812}new Nc_1173: bitstring;
                                                    {813}let gNc_1174: bitstring = exp(g,Nc_1173) in
                                                    {814}let m1_1175: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1174) in
                                                    {815}event beginCli(Cli,Sess,gNc_1174);
                                                    {816}out(c, (pkCli_1128,enc(m1_1175,pkSess_1170),sign(h(m1_1175),skCli_1127)));
                                                    {817}in(c, (em2_1176: bitstring,sigM2_1177: bitstring));
                                                    {818}let m2_1178: bitstring = dec(em2_1176,skCli_1127) in
                                                    {819}if (verify(h(m2_1178),sigM2_1177,pkSess_1170) <> true) then
                                                        0
                                                    else
                                                        {820}let (=OpenSecureChannelResponse,PartS_1179: bitstring,ST_1180: bitstring,TTL_1181: bitstring) = m2_1178 in
                                                        {821}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {822}event endCli(Sess,Cli,PartS_1179)
                                            )
                                            else
                                                {823}let pkSess_1182: bitstring = fail-any in
                                                {824}out(c, GetEndpointRequest);
                                                {825}in(c, (=GetEndpointResponse,=pkSess_1182,=SignAndEncrypt,SP_1183: bitstring,UP_1184: bitstring));
                                                {826}new Nc_1185: bitstring;
                                                {827}let gNc_1186: bitstring = exp(g,Nc_1185) in
                                                {828}let m1_1187: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1186) in
                                                {829}event beginCli(Cli,Sess,gNc_1186);
                                                {830}out(c, (pkCli_1128,enc(m1_1187,pkSess_1182),sign(h(m1_1187),skCli_1127)));
                                                {831}in(c, (em2_1188: bitstring,sigM2_1189: bitstring));
                                                {832}let m2_1190: bitstring = dec(em2_1188,skCli_1127) in
                                                {833}if (verify(h(m2_1190),sigM2_1189,pkSess_1182) <> true) then
                                                    0
                                                else
                                                    {834}let (=OpenSecureChannelResponse,PartS_1191: bitstring,ST_1192: bitstring,TTL_1193: bitstring) = m2_1190 in
                                                    {835}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {836}event endCli(Sess,Cli,PartS_1191)
                                    )
                                    else
                                        {837}let pkSess_1194: bitstring = fail-any in
                                        {838}out(c, GetEndpointRequest);
                                        {839}in(c, (=GetEndpointResponse,=pkSess_1194,=SignAndEncrypt,SP_1195: bitstring,UP_1196: bitstring));
                                        {840}new Nc_1197: bitstring;
                                        {841}let gNc_1198: bitstring = exp(g,Nc_1197) in
                                        {842}let m1_1199: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1198) in
                                        {843}event beginCli(Cli,Sess,gNc_1198);
                                        {844}out(c, (pkCli_1128,enc(m1_1199,pkSess_1194),sign(h(m1_1199),skCli_1127)));
                                        {845}in(c, (em2_1200: bitstring,sigM2_1201: bitstring));
                                        {846}let m2_1202: bitstring = dec(em2_1200,skCli_1127) in
                                        {847}if (verify(h(m2_1202),sigM2_1201,pkSess_1194) <> true) then
                                            0
                                        else
                                            {848}let (=OpenSecureChannelResponse,PartS_1203: bitstring,ST_1204: bitstring,TTL_1205: bitstring) = m2_1202 in
                                            {849}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {850}event endCli(Sess,Cli,PartS_1203)
                            )
                            else
                                {851}let pkSess_1206: bitstring = fail-any in
                                {852}out(c, GetEndpointRequest);
                                {853}in(c, (=GetEndpointResponse,=pkSess_1206,=SignAndEncrypt,SP_1207: bitstring,UP_1208: bitstring));
                                {854}new Nc_1209: bitstring;
                                {855}let gNc_1210: bitstring = exp(g,Nc_1209) in
                                {856}let m1_1211: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1210) in
                                {857}event beginCli(Cli,Sess,gNc_1210);
                                {858}out(c, (pkCli_1128,enc(m1_1211,pkSess_1206),sign(h(m1_1211),skCli_1127)));
                                {859}in(c, (em2_1212: bitstring,sigM2_1213: bitstring));
                                {860}let m2_1214: bitstring = dec(em2_1212,skCli_1127) in
                                {861}if (verify(h(m2_1214),sigM2_1213,pkSess_1206) <> true) then
                                    0
                                else
                                    {862}let (=OpenSecureChannelResponse,PartS_1215: bitstring,ST_1216: bitstring,TTL_1217: bitstring) = m2_1214 in
                                    {863}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {864}event endCli(Sess,Cli,PartS_1215)
                        )
                        else
                            {865}let v_1218: bool = (Disco = B) in
                            (
                                {866}if v_1218 then
                                (
                                    {867}let pkDisco_1219: bitstring = pub(skB) in
                                    {868}let v_1220: bool = (Sess = A) in
                                    (
                                        {869}if v_1220 then
                                        (
                                            {870}let pkSess_1221: bitstring = pub(skA) in
                                            {871}out(c, GetEndpointRequest);
                                            {872}in(c, (=GetEndpointResponse,=pkSess_1221,=SignAndEncrypt,SP_1222: bitstring,UP_1223: bitstring));
                                            {873}new Nc_1224: bitstring;
                                            {874}let gNc_1225: bitstring = exp(g,Nc_1224) in
                                            {875}let m1_1226: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1225) in
                                            {876}event beginCli(Cli,Sess,gNc_1225);
                                            {877}out(c, (pkCli_1128,enc(m1_1226,pkSess_1221),sign(h(m1_1226),skCli_1127)));
                                            {878}in(c, (em2_1227: bitstring,sigM2_1228: bitstring));
                                            {879}let m2_1229: bitstring = dec(em2_1227,skCli_1127) in
                                            {880}if (verify(h(m2_1229),sigM2_1228,pkSess_1221) <> true) then
                                                0
                                            else
                                                {881}let (=OpenSecureChannelResponse,PartS_1230: bitstring,ST_1231: bitstring,TTL_1232: bitstring) = m2_1229 in
                                                {882}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {883}event endCli(Sess,Cli,PartS_1230)
                                        )
                                        else
                                            {884}let v_1233: bool = (Sess = B) in
                                            (
                                                {885}if v_1233 then
                                                (
                                                    {886}let pkSess_1234: bitstring = pub(skB) in
                                                    {887}out(c, GetEndpointRequest);
                                                    {888}in(c, (=GetEndpointResponse,=pkSess_1234,=SignAndEncrypt,SP_1235: bitstring,UP_1236: bitstring));
                                                    {889}new Nc_1237: bitstring;
                                                    {890}let gNc_1238: bitstring = exp(g,Nc_1237) in
                                                    {891}let m1_1239: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1238) in
                                                    {892}event beginCli(Cli,Sess,gNc_1238);
                                                    {893}out(c, (pkCli_1128,enc(m1_1239,pkSess_1234),sign(h(m1_1239),skCli_1127)));
                                                    {894}in(c, (em2_1240: bitstring,sigM2_1241: bitstring));
                                                    {895}let m2_1242: bitstring = dec(em2_1240,skCli_1127) in
                                                    {896}if (verify(h(m2_1242),sigM2_1241,pkSess_1234) <> true) then
                                                        0
                                                    else
                                                        {897}let (=OpenSecureChannelResponse,PartS_1243: bitstring,ST_1244: bitstring,TTL_1245: bitstring) = m2_1242 in
                                                        {898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {899}event endCli(Sess,Cli,PartS_1243)
                                                )
                                                else
                                                    {900}let v_1246: bool = (Sess = C) in
                                                    (
                                                        {901}if v_1246 then
                                                        (
                                                            {902}let pkSess_1247: bitstring = pub(skC) in
                                                            {903}out(c, GetEndpointRequest);
                                                            {904}in(c, (=GetEndpointResponse,=pkSess_1247,=SignAndEncrypt,SP_1248: bitstring,UP_1249: bitstring));
                                                            {905}new Nc_1250: bitstring;
                                                            {906}let gNc_1251: bitstring = exp(g,Nc_1250) in
                                                            {907}let m1_1252: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1251) in
                                                            {908}event beginCli(Cli,Sess,gNc_1251);
                                                            {909}out(c, (pkCli_1128,enc(m1_1252,pkSess_1247),sign(h(m1_1252),skCli_1127)));
                                                            {910}in(c, (em2_1253: bitstring,sigM2_1254: bitstring));
                                                            {911}let m2_1255: bitstring = dec(em2_1253,skCli_1127) in
                                                            {912}if (verify(h(m2_1255),sigM2_1254,pkSess_1247) <> true) then
                                                                0
                                                            else
                                                                {913}let (=OpenSecureChannelResponse,PartS_1256: bitstring,ST_1257: bitstring,TTL_1258: bitstring) = m2_1255 in
                                                                {914}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {915}event endCli(Sess,Cli,PartS_1256)
                                                        )
                                                        else
                                                            {916}let pkSess_1259: bitstring = pub(sk(Sess)) in
                                                            {917}out(c, GetEndpointRequest);
                                                            {918}in(c, (=GetEndpointResponse,=pkSess_1259,=SignAndEncrypt,SP_1260: bitstring,UP_1261: bitstring));
                                                            {919}new Nc_1262: bitstring;
                                                            {920}let gNc_1263: bitstring = exp(g,Nc_1262) in
                                                            {921}let m1_1264: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1263) in
                                                            {922}event beginCli(Cli,Sess,gNc_1263);
                                                            {923}out(c, (pkCli_1128,enc(m1_1264,pkSess_1259),sign(h(m1_1264),skCli_1127)));
                                                            {924}in(c, (em2_1265: bitstring,sigM2_1266: bitstring));
                                                            {925}let m2_1267: bitstring = dec(em2_1265,skCli_1127) in
                                                            {926}if (verify(h(m2_1267),sigM2_1266,pkSess_1259) <> true) then
                                                                0
                                                            else
                                                                {927}let (=OpenSecureChannelResponse,PartS_1268: bitstring,ST_1269: bitstring,TTL_1270: bitstring) = m2_1267 in
                                                                {928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {929}event endCli(Sess,Cli,PartS_1268)
                                                    )
                                                    else
                                                        {930}let pkSess_1271: bitstring = fail-any in
                                                        {931}out(c, GetEndpointRequest);
                                                        {932}in(c, (=GetEndpointResponse,=pkSess_1271,=SignAndEncrypt,SP_1272: bitstring,UP_1273: bitstring));
                                                        {933}new Nc_1274: bitstring;
                                                        {934}let gNc_1275: bitstring = exp(g,Nc_1274) in
                                                        {935}let m1_1276: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1275) in
                                                        {936}event beginCli(Cli,Sess,gNc_1275);
                                                        {937}out(c, (pkCli_1128,enc(m1_1276,pkSess_1271),sign(h(m1_1276),skCli_1127)));
                                                        {938}in(c, (em2_1277: bitstring,sigM2_1278: bitstring));
                                                        {939}let m2_1279: bitstring = dec(em2_1277,skCli_1127) in
                                                        {940}if (verify(h(m2_1279),sigM2_1278,pkSess_1271) <> true) then
                                                            0
                                                        else
                                                            {941}let (=OpenSecureChannelResponse,PartS_1280: bitstring,ST_1281: bitstring,TTL_1282: bitstring) = m2_1279 in
                                                            {942}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {943}event endCli(Sess,Cli,PartS_1280)
                                            )
                                            else
                                                {944}let pkSess_1283: bitstring = fail-any in
                                                {945}out(c, GetEndpointRequest);
                                                {946}in(c, (=GetEndpointResponse,=pkSess_1283,=SignAndEncrypt,SP_1284: bitstring,UP_1285: bitstring));
                                                {947}new Nc_1286: bitstring;
                                                {948}let gNc_1287: bitstring = exp(g,Nc_1286) in
                                                {949}let m1_1288: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1287) in
                                                {950}event beginCli(Cli,Sess,gNc_1287);
                                                {951}out(c, (pkCli_1128,enc(m1_1288,pkSess_1283),sign(h(m1_1288),skCli_1127)));
                                                {952}in(c, (em2_1289: bitstring,sigM2_1290: bitstring));
                                                {953}let m2_1291: bitstring = dec(em2_1289,skCli_1127) in
                                                {954}if (verify(h(m2_1291),sigM2_1290,pkSess_1283) <> true) then
                                                    0
                                                else
                                                    {955}let (=OpenSecureChannelResponse,PartS_1292: bitstring,ST_1293: bitstring,TTL_1294: bitstring) = m2_1291 in
                                                    {956}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {957}event endCli(Sess,Cli,PartS_1292)
                                    )
                                    else
                                        {958}let pkSess_1295: bitstring = fail-any in
                                        {959}out(c, GetEndpointRequest);
                                        {960}in(c, (=GetEndpointResponse,=pkSess_1295,=SignAndEncrypt,SP_1296: bitstring,UP_1297: bitstring));
                                        {961}new Nc_1298: bitstring;
                                        {962}let gNc_1299: bitstring = exp(g,Nc_1298) in
                                        {963}let m1_1300: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1299) in
                                        {964}event beginCli(Cli,Sess,gNc_1299);
                                        {965}out(c, (pkCli_1128,enc(m1_1300,pkSess_1295),sign(h(m1_1300),skCli_1127)));
                                        {966}in(c, (em2_1301: bitstring,sigM2_1302: bitstring));
                                        {967}let m2_1303: bitstring = dec(em2_1301,skCli_1127) in
                                        {968}if (verify(h(m2_1303),sigM2_1302,pkSess_1295) <> true) then
                                            0
                                        else
                                            {969}let (=OpenSecureChannelResponse,PartS_1304: bitstring,ST_1305: bitstring,TTL_1306: bitstring) = m2_1303 in
                                            {970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {971}event endCli(Sess,Cli,PartS_1304)
                                )
                                else
                                    {972}let v_1307: bool = (Disco = C) in
                                    (
                                        {973}if v_1307 then
                                        (
                                            {974}let pkDisco_1308: bitstring = pub(skC) in
                                            {975}let v_1309: bool = (Sess = A) in
                                            (
                                                {976}if v_1309 then
                                                (
                                                    {977}let pkSess_1310: bitstring = pub(skA) in
                                                    {978}out(c, GetEndpointRequest);
                                                    {979}in(c, (=GetEndpointResponse,=pkSess_1310,=SignAndEncrypt,SP_1311: bitstring,UP_1312: bitstring));
                                                    {980}new Nc_1313: bitstring;
                                                    {981}let gNc_1314: bitstring = exp(g,Nc_1313) in
                                                    {982}let m1_1315: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1314) in
                                                    {983}event beginCli(Cli,Sess,gNc_1314);
                                                    {984}out(c, (pkCli_1128,enc(m1_1315,pkSess_1310),sign(h(m1_1315),skCli_1127)));
                                                    {985}in(c, (em2_1316: bitstring,sigM2_1317: bitstring));
                                                    {986}let m2_1318: bitstring = dec(em2_1316,skCli_1127) in
                                                    {987}if (verify(h(m2_1318),sigM2_1317,pkSess_1310) <> true) then
                                                        0
                                                    else
                                                        {988}let (=OpenSecureChannelResponse,PartS_1319: bitstring,ST_1320: bitstring,TTL_1321: bitstring) = m2_1318 in
                                                        {989}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {990}event endCli(Sess,Cli,PartS_1319)
                                                )
                                                else
                                                    {991}let v_1322: bool = (Sess = B) in
                                                    (
                                                        {992}if v_1322 then
                                                        (
                                                            {993}let pkSess_1323: bitstring = pub(skB) in
                                                            {994}out(c, GetEndpointRequest);
                                                            {995}in(c, (=GetEndpointResponse,=pkSess_1323,=SignAndEncrypt,SP_1324: bitstring,UP_1325: bitstring));
                                                            {996}new Nc_1326: bitstring;
                                                            {997}let gNc_1327: bitstring = exp(g,Nc_1326) in
                                                            {998}let m1_1328: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1327) in
                                                            {999}event beginCli(Cli,Sess,gNc_1327);
                                                            {1000}out(c, (pkCli_1128,enc(m1_1328,pkSess_1323),sign(h(m1_1328),skCli_1127)));
                                                            {1001}in(c, (em2_1329: bitstring,sigM2_1330: bitstring));
                                                            {1002}let m2_1331: bitstring = dec(em2_1329,skCli_1127) in
                                                            {1003}if (verify(h(m2_1331),sigM2_1330,pkSess_1323) <> true) then
                                                                0
                                                            else
                                                                {1004}let (=OpenSecureChannelResponse,PartS_1332: bitstring,ST_1333: bitstring,TTL_1334: bitstring) = m2_1331 in
                                                                {1005}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1006}event endCli(Sess,Cli,PartS_1332)
                                                        )
                                                        else
                                                            {1007}let v_1335: bool = (Sess = C) in
                                                            (
                                                                {1008}if v_1335 then
                                                                (
                                                                    {1009}let pkSess_1336: bitstring = pub(skC) in
                                                                    {1010}out(c, GetEndpointRequest);
                                                                    {1011}in(c, (=GetEndpointResponse,=pkSess_1336,=SignAndEncrypt,SP_1337: bitstring,UP_1338: bitstring));
                                                                    {1012}new Nc_1339: bitstring;
                                                                    {1013}let gNc_1340: bitstring = exp(g,Nc_1339) in
                                                                    {1014}let m1_1341: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1340) in
                                                                    {1015}event beginCli(Cli,Sess,gNc_1340);
                                                                    {1016}out(c, (pkCli_1128,enc(m1_1341,pkSess_1336),sign(h(m1_1341),skCli_1127)));
                                                                    {1017}in(c, (em2_1342: bitstring,sigM2_1343: bitstring));
                                                                    {1018}let m2_1344: bitstring = dec(em2_1342,skCli_1127) in
                                                                    {1019}if (verify(h(m2_1344),sigM2_1343,pkSess_1336) <> true) then
                                                                        0
                                                                    else
                                                                        {1020}let (=OpenSecureChannelResponse,PartS_1345: bitstring,ST_1346: bitstring,TTL_1347: bitstring) = m2_1344 in
                                                                        {1021}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1022}event endCli(Sess,Cli,PartS_1345)
                                                                )
                                                                else
                                                                    {1023}let pkSess_1348: bitstring = pub(sk(Sess)) in
                                                                    {1024}out(c, GetEndpointRequest);
                                                                    {1025}in(c, (=GetEndpointResponse,=pkSess_1348,=SignAndEncrypt,SP_1349: bitstring,UP_1350: bitstring));
                                                                    {1026}new Nc_1351: bitstring;
                                                                    {1027}let gNc_1352: bitstring = exp(g,Nc_1351) in
                                                                    {1028}let m1_1353: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1352) in
                                                                    {1029}event beginCli(Cli,Sess,gNc_1352);
                                                                    {1030}out(c, (pkCli_1128,enc(m1_1353,pkSess_1348),sign(h(m1_1353),skCli_1127)));
                                                                    {1031}in(c, (em2_1354: bitstring,sigM2_1355: bitstring));
                                                                    {1032}let m2_1356: bitstring = dec(em2_1354,skCli_1127) in
                                                                    {1033}if (verify(h(m2_1356),sigM2_1355,pkSess_1348) <> true) then
                                                                        0
                                                                    else
                                                                        {1034}let (=OpenSecureChannelResponse,PartS_1357: bitstring,ST_1358: bitstring,TTL_1359: bitstring) = m2_1356 in
                                                                        {1035}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1036}event endCli(Sess,Cli,PartS_1357)
                                                            )
                                                            else
                                                                {1037}let pkSess_1360: bitstring = fail-any in
                                                                {1038}out(c, GetEndpointRequest);
                                                                {1039}in(c, (=GetEndpointResponse,=pkSess_1360,=SignAndEncrypt,SP_1361: bitstring,UP_1362: bitstring));
                                                                {1040}new Nc_1363: bitstring;
                                                                {1041}let gNc_1364: bitstring = exp(g,Nc_1363) in
                                                                {1042}let m1_1365: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1364) in
                                                                {1043}event beginCli(Cli,Sess,gNc_1364);
                                                                {1044}out(c, (pkCli_1128,enc(m1_1365,pkSess_1360),sign(h(m1_1365),skCli_1127)));
                                                                {1045}in(c, (em2_1366: bitstring,sigM2_1367: bitstring));
                                                                {1046}let m2_1368: bitstring = dec(em2_1366,skCli_1127) in
                                                                {1047}if (verify(h(m2_1368),sigM2_1367,pkSess_1360) <> true) then
                                                                    0
                                                                else
                                                                    {1048}let (=OpenSecureChannelResponse,PartS_1369: bitstring,ST_1370: bitstring,TTL_1371: bitstring) = m2_1368 in
                                                                    {1049}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1050}event endCli(Sess,Cli,PartS_1369)
                                                    )
                                                    else
                                                        {1051}let pkSess_1372: bitstring = fail-any in
                                                        {1052}out(c, GetEndpointRequest);
                                                        {1053}in(c, (=GetEndpointResponse,=pkSess_1372,=SignAndEncrypt,SP_1373: bitstring,UP_1374: bitstring));
                                                        {1054}new Nc_1375: bitstring;
                                                        {1055}let gNc_1376: bitstring = exp(g,Nc_1375) in
                                                        {1056}let m1_1377: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1376) in
                                                        {1057}event beginCli(Cli,Sess,gNc_1376);
                                                        {1058}out(c, (pkCli_1128,enc(m1_1377,pkSess_1372),sign(h(m1_1377),skCli_1127)));
                                                        {1059}in(c, (em2_1378: bitstring,sigM2_1379: bitstring));
                                                        {1060}let m2_1380: bitstring = dec(em2_1378,skCli_1127) in
                                                        {1061}if (verify(h(m2_1380),sigM2_1379,pkSess_1372) <> true) then
                                                            0
                                                        else
                                                            {1062}let (=OpenSecureChannelResponse,PartS_1381: bitstring,ST_1382: bitstring,TTL_1383: bitstring) = m2_1380 in
                                                            {1063}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1064}event endCli(Sess,Cli,PartS_1381)
                                            )
                                            else
                                                {1065}let pkSess_1384: bitstring = fail-any in
                                                {1066}out(c, GetEndpointRequest);
                                                {1067}in(c, (=GetEndpointResponse,=pkSess_1384,=SignAndEncrypt,SP_1385: bitstring,UP_1386: bitstring));
                                                {1068}new Nc_1387: bitstring;
                                                {1069}let gNc_1388: bitstring = exp(g,Nc_1387) in
                                                {1070}let m1_1389: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1388) in
                                                {1071}event beginCli(Cli,Sess,gNc_1388);
                                                {1072}out(c, (pkCli_1128,enc(m1_1389,pkSess_1384),sign(h(m1_1389),skCli_1127)));
                                                {1073}in(c, (em2_1390: bitstring,sigM2_1391: bitstring));
                                                {1074}let m2_1392: bitstring = dec(em2_1390,skCli_1127) in
                                                {1075}if (verify(h(m2_1392),sigM2_1391,pkSess_1384) <> true) then
                                                    0
                                                else
                                                    {1076}let (=OpenSecureChannelResponse,PartS_1393: bitstring,ST_1394: bitstring,TTL_1395: bitstring) = m2_1392 in
                                                    {1077}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1078}event endCli(Sess,Cli,PartS_1393)
                                        )
                                        else
                                            {1079}let pkDisco_1396: bitstring = pub(sk(Disco)) in
                                            {1080}let v_1397: bool = (Sess = A) in
                                            (
                                                {1081}if v_1397 then
                                                (
                                                    {1082}let pkSess_1398: bitstring = pub(skA) in
                                                    {1083}out(c, GetEndpointRequest);
                                                    {1084}in(c, (=GetEndpointResponse,=pkSess_1398,=SignAndEncrypt,SP_1399: bitstring,UP_1400: bitstring));
                                                    {1085}new Nc_1401: bitstring;
                                                    {1086}let gNc_1402: bitstring = exp(g,Nc_1401) in
                                                    {1087}let m1_1403: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1402) in
                                                    {1088}event beginCli(Cli,Sess,gNc_1402);
                                                    {1089}out(c, (pkCli_1128,enc(m1_1403,pkSess_1398),sign(h(m1_1403),skCli_1127)));
                                                    {1090}in(c, (em2_1404: bitstring,sigM2_1405: bitstring));
                                                    {1091}let m2_1406: bitstring = dec(em2_1404,skCli_1127) in
                                                    {1092}if (verify(h(m2_1406),sigM2_1405,pkSess_1398) <> true) then
                                                        0
                                                    else
                                                        {1093}let (=OpenSecureChannelResponse,PartS_1407: bitstring,ST_1408: bitstring,TTL_1409: bitstring) = m2_1406 in
                                                        {1094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1095}event endCli(Sess,Cli,PartS_1407)
                                                )
                                                else
                                                    {1096}let v_1410: bool = (Sess = B) in
                                                    (
                                                        {1097}if v_1410 then
                                                        (
                                                            {1098}let pkSess_1411: bitstring = pub(skB) in
                                                            {1099}out(c, GetEndpointRequest);
                                                            {1100}in(c, (=GetEndpointResponse,=pkSess_1411,=SignAndEncrypt,SP_1412: bitstring,UP_1413: bitstring));
                                                            {1101}new Nc_1414: bitstring;
                                                            {1102}let gNc_1415: bitstring = exp(g,Nc_1414) in
                                                            {1103}let m1_1416: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1415) in
                                                            {1104}event beginCli(Cli,Sess,gNc_1415);
                                                            {1105}out(c, (pkCli_1128,enc(m1_1416,pkSess_1411),sign(h(m1_1416),skCli_1127)));
                                                            {1106}in(c, (em2_1417: bitstring,sigM2_1418: bitstring));
                                                            {1107}let m2_1419: bitstring = dec(em2_1417,skCli_1127) in
                                                            {1108}if (verify(h(m2_1419),sigM2_1418,pkSess_1411) <> true) then
                                                                0
                                                            else
                                                                {1109}let (=OpenSecureChannelResponse,PartS_1420: bitstring,ST_1421: bitstring,TTL_1422: bitstring) = m2_1419 in
                                                                {1110}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1111}event endCli(Sess,Cli,PartS_1420)
                                                        )
                                                        else
                                                            {1112}let v_1423: bool = (Sess = C) in
                                                            (
                                                                {1113}if v_1423 then
                                                                (
                                                                    {1114}let pkSess_1424: bitstring = pub(skC) in
                                                                    {1115}out(c, GetEndpointRequest);
                                                                    {1116}in(c, (=GetEndpointResponse,=pkSess_1424,=SignAndEncrypt,SP_1425: bitstring,UP_1426: bitstring));
                                                                    {1117}new Nc_1427: bitstring;
                                                                    {1118}let gNc_1428: bitstring = exp(g,Nc_1427) in
                                                                    {1119}let m1_1429: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1428) in
                                                                    {1120}event beginCli(Cli,Sess,gNc_1428);
                                                                    {1121}out(c, (pkCli_1128,enc(m1_1429,pkSess_1424),sign(h(m1_1429),skCli_1127)));
                                                                    {1122}in(c, (em2_1430: bitstring,sigM2_1431: bitstring));
                                                                    {1123}let m2_1432: bitstring = dec(em2_1430,skCli_1127) in
                                                                    {1124}if (verify(h(m2_1432),sigM2_1431,pkSess_1424) <> true) then
                                                                        0
                                                                    else
                                                                        {1125}let (=OpenSecureChannelResponse,PartS_1433: bitstring,ST_1434: bitstring,TTL_1435: bitstring) = m2_1432 in
                                                                        {1126}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1127}event endCli(Sess,Cli,PartS_1433)
                                                                )
                                                                else
                                                                    {1128}let pkSess_1436: bitstring = pub(sk(Sess)) in
                                                                    {1129}out(c, GetEndpointRequest);
                                                                    {1130}in(c, (=GetEndpointResponse,=pkSess_1436,=SignAndEncrypt,SP_1437: bitstring,UP_1438: bitstring));
                                                                    {1131}new Nc_1439: bitstring;
                                                                    {1132}let gNc_1440: bitstring = exp(g,Nc_1439) in
                                                                    {1133}let m1_1441: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1440) in
                                                                    {1134}event beginCli(Cli,Sess,gNc_1440);
                                                                    {1135}out(c, (pkCli_1128,enc(m1_1441,pkSess_1436),sign(h(m1_1441),skCli_1127)));
                                                                    {1136}in(c, (em2_1442: bitstring,sigM2_1443: bitstring));
                                                                    {1137}let m2_1444: bitstring = dec(em2_1442,skCli_1127) in
                                                                    {1138}if (verify(h(m2_1444),sigM2_1443,pkSess_1436) <> true) then
                                                                        0
                                                                    else
                                                                        {1139}let (=OpenSecureChannelResponse,PartS_1445: bitstring,ST_1446: bitstring,TTL_1447: bitstring) = m2_1444 in
                                                                        {1140}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1141}event endCli(Sess,Cli,PartS_1445)
                                                            )
                                                            else
                                                                {1142}let pkSess_1448: bitstring = fail-any in
                                                                {1143}out(c, GetEndpointRequest);
                                                                {1144}in(c, (=GetEndpointResponse,=pkSess_1448,=SignAndEncrypt,SP_1449: bitstring,UP_1450: bitstring));
                                                                {1145}new Nc_1451: bitstring;
                                                                {1146}let gNc_1452: bitstring = exp(g,Nc_1451) in
                                                                {1147}let m1_1453: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1452) in
                                                                {1148}event beginCli(Cli,Sess,gNc_1452);
                                                                {1149}out(c, (pkCli_1128,enc(m1_1453,pkSess_1448),sign(h(m1_1453),skCli_1127)));
                                                                {1150}in(c, (em2_1454: bitstring,sigM2_1455: bitstring));
                                                                {1151}let m2_1456: bitstring = dec(em2_1454,skCli_1127) in
                                                                {1152}if (verify(h(m2_1456),sigM2_1455,pkSess_1448) <> true) then
                                                                    0
                                                                else
                                                                    {1153}let (=OpenSecureChannelResponse,PartS_1457: bitstring,ST_1458: bitstring,TTL_1459: bitstring) = m2_1456 in
                                                                    {1154}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1155}event endCli(Sess,Cli,PartS_1457)
                                                    )
                                                    else
                                                        {1156}let pkSess_1460: bitstring = fail-any in
                                                        {1157}out(c, GetEndpointRequest);
                                                        {1158}in(c, (=GetEndpointResponse,=pkSess_1460,=SignAndEncrypt,SP_1461: bitstring,UP_1462: bitstring));
                                                        {1159}new Nc_1463: bitstring;
                                                        {1160}let gNc_1464: bitstring = exp(g,Nc_1463) in
                                                        {1161}let m1_1465: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1464) in
                                                        {1162}event beginCli(Cli,Sess,gNc_1464);
                                                        {1163}out(c, (pkCli_1128,enc(m1_1465,pkSess_1460),sign(h(m1_1465),skCli_1127)));
                                                        {1164}in(c, (em2_1466: bitstring,sigM2_1467: bitstring));
                                                        {1165}let m2_1468: bitstring = dec(em2_1466,skCli_1127) in
                                                        {1166}if (verify(h(m2_1468),sigM2_1467,pkSess_1460) <> true) then
                                                            0
                                                        else
                                                            {1167}let (=OpenSecureChannelResponse,PartS_1469: bitstring,ST_1470: bitstring,TTL_1471: bitstring) = m2_1468 in
                                                            {1168}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1169}event endCli(Sess,Cli,PartS_1469)
                                            )
                                            else
                                                {1170}let pkSess_1472: bitstring = fail-any in
                                                {1171}out(c, GetEndpointRequest);
                                                {1172}in(c, (=GetEndpointResponse,=pkSess_1472,=SignAndEncrypt,SP_1473: bitstring,UP_1474: bitstring));
                                                {1173}new Nc_1475: bitstring;
                                                {1174}let gNc_1476: bitstring = exp(g,Nc_1475) in
                                                {1175}let m1_1477: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1476) in
                                                {1176}event beginCli(Cli,Sess,gNc_1476);
                                                {1177}out(c, (pkCli_1128,enc(m1_1477,pkSess_1472),sign(h(m1_1477),skCli_1127)));
                                                {1178}in(c, (em2_1478: bitstring,sigM2_1479: bitstring));
                                                {1179}let m2_1480: bitstring = dec(em2_1478,skCli_1127) in
                                                {1180}if (verify(h(m2_1480),sigM2_1479,pkSess_1472) <> true) then
                                                    0
                                                else
                                                    {1181}let (=OpenSecureChannelResponse,PartS_1481: bitstring,ST_1482: bitstring,TTL_1483: bitstring) = m2_1480 in
                                                    {1182}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1183}event endCli(Sess,Cli,PartS_1481)
                                    )
                                    else
                                        {1184}let pkDisco_1484: bitstring = fail-any in
                                        {1185}let v_1485: bool = (Sess = A) in
                                        (
                                            {1186}if v_1485 then
                                            (
                                                {1187}let pkSess_1486: bitstring = pub(skA) in
                                                {1188}out(c, GetEndpointRequest);
                                                {1189}in(c, (=GetEndpointResponse,=pkSess_1486,=SignAndEncrypt,SP_1487: bitstring,UP_1488: bitstring));
                                                {1190}new Nc_1489: bitstring;
                                                {1191}let gNc_1490: bitstring = exp(g,Nc_1489) in
                                                {1192}let m1_1491: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1490) in
                                                {1193}event beginCli(Cli,Sess,gNc_1490);
                                                {1194}out(c, (pkCli_1128,enc(m1_1491,pkSess_1486),sign(h(m1_1491),skCli_1127)));
                                                {1195}in(c, (em2_1492: bitstring,sigM2_1493: bitstring));
                                                {1196}let m2_1494: bitstring = dec(em2_1492,skCli_1127) in
                                                {1197}if (verify(h(m2_1494),sigM2_1493,pkSess_1486) <> true) then
                                                    0
                                                else
                                                    {1198}let (=OpenSecureChannelResponse,PartS_1495: bitstring,ST_1496: bitstring,TTL_1497: bitstring) = m2_1494 in
                                                    {1199}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1200}event endCli(Sess,Cli,PartS_1495)
                                            )
                                            else
                                                {1201}let v_1498: bool = (Sess = B) in
                                                (
                                                    {1202}if v_1498 then
                                                    (
                                                        {1203}let pkSess_1499: bitstring = pub(skB) in
                                                        {1204}out(c, GetEndpointRequest);
                                                        {1205}in(c, (=GetEndpointResponse,=pkSess_1499,=SignAndEncrypt,SP_1500: bitstring,UP_1501: bitstring));
                                                        {1206}new Nc_1502: bitstring;
                                                        {1207}let gNc_1503: bitstring = exp(g,Nc_1502) in
                                                        {1208}let m1_1504: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1503) in
                                                        {1209}event beginCli(Cli,Sess,gNc_1503);
                                                        {1210}out(c, (pkCli_1128,enc(m1_1504,pkSess_1499),sign(h(m1_1504),skCli_1127)));
                                                        {1211}in(c, (em2_1505: bitstring,sigM2_1506: bitstring));
                                                        {1212}let m2_1507: bitstring = dec(em2_1505,skCli_1127) in
                                                        {1213}if (verify(h(m2_1507),sigM2_1506,pkSess_1499) <> true) then
                                                            0
                                                        else
                                                            {1214}let (=OpenSecureChannelResponse,PartS_1508: bitstring,ST_1509: bitstring,TTL_1510: bitstring) = m2_1507 in
                                                            {1215}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1216}event endCli(Sess,Cli,PartS_1508)
                                                    )
                                                    else
                                                        {1217}let v_1511: bool = (Sess = C) in
                                                        (
                                                            {1218}if v_1511 then
                                                            (
                                                                {1219}let pkSess_1512: bitstring = pub(skC) in
                                                                {1220}out(c, GetEndpointRequest);
                                                                {1221}in(c, (=GetEndpointResponse,=pkSess_1512,=SignAndEncrypt,SP_1513: bitstring,UP_1514: bitstring));
                                                                {1222}new Nc_1515: bitstring;
                                                                {1223}let gNc_1516: bitstring = exp(g,Nc_1515) in
                                                                {1224}let m1_1517: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1516) in
                                                                {1225}event beginCli(Cli,Sess,gNc_1516);
                                                                {1226}out(c, (pkCli_1128,enc(m1_1517,pkSess_1512),sign(h(m1_1517),skCli_1127)));
                                                                {1227}in(c, (em2_1518: bitstring,sigM2_1519: bitstring));
                                                                {1228}let m2_1520: bitstring = dec(em2_1518,skCli_1127) in
                                                                {1229}if (verify(h(m2_1520),sigM2_1519,pkSess_1512) <> true) then
                                                                    0
                                                                else
                                                                    {1230}let (=OpenSecureChannelResponse,PartS_1521: bitstring,ST_1522: bitstring,TTL_1523: bitstring) = m2_1520 in
                                                                    {1231}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1232}event endCli(Sess,Cli,PartS_1521)
                                                            )
                                                            else
                                                                {1233}let pkSess_1524: bitstring = pub(sk(Sess)) in
                                                                {1234}out(c, GetEndpointRequest);
                                                                {1235}in(c, (=GetEndpointResponse,=pkSess_1524,=SignAndEncrypt,SP_1525: bitstring,UP_1526: bitstring));
                                                                {1236}new Nc_1527: bitstring;
                                                                {1237}let gNc_1528: bitstring = exp(g,Nc_1527) in
                                                                {1238}let m1_1529: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1528) in
                                                                {1239}event beginCli(Cli,Sess,gNc_1528);
                                                                {1240}out(c, (pkCli_1128,enc(m1_1529,pkSess_1524),sign(h(m1_1529),skCli_1127)));
                                                                {1241}in(c, (em2_1530: bitstring,sigM2_1531: bitstring));
                                                                {1242}let m2_1532: bitstring = dec(em2_1530,skCli_1127) in
                                                                {1243}if (verify(h(m2_1532),sigM2_1531,pkSess_1524) <> true) then
                                                                    0
                                                                else
                                                                    {1244}let (=OpenSecureChannelResponse,PartS_1533: bitstring,ST_1534: bitstring,TTL_1535: bitstring) = m2_1532 in
                                                                    {1245}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1246}event endCli(Sess,Cli,PartS_1533)
                                                        )
                                                        else
                                                            {1247}let pkSess_1536: bitstring = fail-any in
                                                            {1248}out(c, GetEndpointRequest);
                                                            {1249}in(c, (=GetEndpointResponse,=pkSess_1536,=SignAndEncrypt,SP_1537: bitstring,UP_1538: bitstring));
                                                            {1250}new Nc_1539: bitstring;
                                                            {1251}let gNc_1540: bitstring = exp(g,Nc_1539) in
                                                            {1252}let m1_1541: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1540) in
                                                            {1253}event beginCli(Cli,Sess,gNc_1540);
                                                            {1254}out(c, (pkCli_1128,enc(m1_1541,pkSess_1536),sign(h(m1_1541),skCli_1127)));
                                                            {1255}in(c, (em2_1542: bitstring,sigM2_1543: bitstring));
                                                            {1256}let m2_1544: bitstring = dec(em2_1542,skCli_1127) in
                                                            {1257}if (verify(h(m2_1544),sigM2_1543,pkSess_1536) <> true) then
                                                                0
                                                            else
                                                                {1258}let (=OpenSecureChannelResponse,PartS_1545: bitstring,ST_1546: bitstring,TTL_1547: bitstring) = m2_1544 in
                                                                {1259}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1260}event endCli(Sess,Cli,PartS_1545)
                                                )
                                                else
                                                    {1261}let pkSess_1548: bitstring = fail-any in
                                                    {1262}out(c, GetEndpointRequest);
                                                    {1263}in(c, (=GetEndpointResponse,=pkSess_1548,=SignAndEncrypt,SP_1549: bitstring,UP_1550: bitstring));
                                                    {1264}new Nc_1551: bitstring;
                                                    {1265}let gNc_1552: bitstring = exp(g,Nc_1551) in
                                                    {1266}let m1_1553: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1552) in
                                                    {1267}event beginCli(Cli,Sess,gNc_1552);
                                                    {1268}out(c, (pkCli_1128,enc(m1_1553,pkSess_1548),sign(h(m1_1553),skCli_1127)));
                                                    {1269}in(c, (em2_1554: bitstring,sigM2_1555: bitstring));
                                                    {1270}let m2_1556: bitstring = dec(em2_1554,skCli_1127) in
                                                    {1271}if (verify(h(m2_1556),sigM2_1555,pkSess_1548) <> true) then
                                                        0
                                                    else
                                                        {1272}let (=OpenSecureChannelResponse,PartS_1557: bitstring,ST_1558: bitstring,TTL_1559: bitstring) = m2_1556 in
                                                        {1273}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1274}event endCli(Sess,Cli,PartS_1557)
                                        )
                                        else
                                            {1275}let pkSess_1560: bitstring = fail-any in
                                            {1276}out(c, GetEndpointRequest);
                                            {1277}in(c, (=GetEndpointResponse,=pkSess_1560,=SignAndEncrypt,SP_1561: bitstring,UP_1562: bitstring));
                                            {1278}new Nc_1563: bitstring;
                                            {1279}let gNc_1564: bitstring = exp(g,Nc_1563) in
                                            {1280}let m1_1565: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1564) in
                                            {1281}event beginCli(Cli,Sess,gNc_1564);
                                            {1282}out(c, (pkCli_1128,enc(m1_1565,pkSess_1560),sign(h(m1_1565),skCli_1127)));
                                            {1283}in(c, (em2_1566: bitstring,sigM2_1567: bitstring));
                                            {1284}let m2_1568: bitstring = dec(em2_1566,skCli_1127) in
                                            {1285}if (verify(h(m2_1568),sigM2_1567,pkSess_1560) <> true) then
                                                0
                                            else
                                                {1286}let (=OpenSecureChannelResponse,PartS_1569: bitstring,ST_1570: bitstring,TTL_1571: bitstring) = m2_1568 in
                                                {1287}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1288}event endCli(Sess,Cli,PartS_1569)
                            )
                            else
                                {1289}let pkDisco_1572: bitstring = fail-any in
                                {1290}let v_1573: bool = (Sess = A) in
                                (
                                    {1291}if v_1573 then
                                    (
                                        {1292}let pkSess_1574: bitstring = pub(skA) in
                                        {1293}out(c, GetEndpointRequest);
                                        {1294}in(c, (=GetEndpointResponse,=pkSess_1574,=SignAndEncrypt,SP_1575: bitstring,UP_1576: bitstring));
                                        {1295}new Nc_1577: bitstring;
                                        {1296}let gNc_1578: bitstring = exp(g,Nc_1577) in
                                        {1297}let m1_1579: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1578) in
                                        {1298}event beginCli(Cli,Sess,gNc_1578);
                                        {1299}out(c, (pkCli_1128,enc(m1_1579,pkSess_1574),sign(h(m1_1579),skCli_1127)));
                                        {1300}in(c, (em2_1580: bitstring,sigM2_1581: bitstring));
                                        {1301}let m2_1582: bitstring = dec(em2_1580,skCli_1127) in
                                        {1302}if (verify(h(m2_1582),sigM2_1581,pkSess_1574) <> true) then
                                            0
                                        else
                                            {1303}let (=OpenSecureChannelResponse,PartS_1583: bitstring,ST_1584: bitstring,TTL_1585: bitstring) = m2_1582 in
                                            {1304}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1305}event endCli(Sess,Cli,PartS_1583)
                                    )
                                    else
                                        {1306}let v_1586: bool = (Sess = B) in
                                        (
                                            {1307}if v_1586 then
                                            (
                                                {1308}let pkSess_1587: bitstring = pub(skB) in
                                                {1309}out(c, GetEndpointRequest);
                                                {1310}in(c, (=GetEndpointResponse,=pkSess_1587,=SignAndEncrypt,SP_1588: bitstring,UP_1589: bitstring));
                                                {1311}new Nc_1590: bitstring;
                                                {1312}let gNc_1591: bitstring = exp(g,Nc_1590) in
                                                {1313}let m1_1592: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1591) in
                                                {1314}event beginCli(Cli,Sess,gNc_1591);
                                                {1315}out(c, (pkCli_1128,enc(m1_1592,pkSess_1587),sign(h(m1_1592),skCli_1127)));
                                                {1316}in(c, (em2_1593: bitstring,sigM2_1594: bitstring));
                                                {1317}let m2_1595: bitstring = dec(em2_1593,skCli_1127) in
                                                {1318}if (verify(h(m2_1595),sigM2_1594,pkSess_1587) <> true) then
                                                    0
                                                else
                                                    {1319}let (=OpenSecureChannelResponse,PartS_1596: bitstring,ST_1597: bitstring,TTL_1598: bitstring) = m2_1595 in
                                                    {1320}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1321}event endCli(Sess,Cli,PartS_1596)
                                            )
                                            else
                                                {1322}let v_1599: bool = (Sess = C) in
                                                (
                                                    {1323}if v_1599 then
                                                    (
                                                        {1324}let pkSess_1600: bitstring = pub(skC) in
                                                        {1325}out(c, GetEndpointRequest);
                                                        {1326}in(c, (=GetEndpointResponse,=pkSess_1600,=SignAndEncrypt,SP_1601: bitstring,UP_1602: bitstring));
                                                        {1327}new Nc_1603: bitstring;
                                                        {1328}let gNc_1604: bitstring = exp(g,Nc_1603) in
                                                        {1329}let m1_1605: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1604) in
                                                        {1330}event beginCli(Cli,Sess,gNc_1604);
                                                        {1331}out(c, (pkCli_1128,enc(m1_1605,pkSess_1600),sign(h(m1_1605),skCli_1127)));
                                                        {1332}in(c, (em2_1606: bitstring,sigM2_1607: bitstring));
                                                        {1333}let m2_1608: bitstring = dec(em2_1606,skCli_1127) in
                                                        {1334}if (verify(h(m2_1608),sigM2_1607,pkSess_1600) <> true) then
                                                            0
                                                        else
                                                            {1335}let (=OpenSecureChannelResponse,PartS_1609: bitstring,ST_1610: bitstring,TTL_1611: bitstring) = m2_1608 in
                                                            {1336}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1337}event endCli(Sess,Cli,PartS_1609)
                                                    )
                                                    else
                                                        {1338}let pkSess_1612: bitstring = pub(sk(Sess)) in
                                                        {1339}out(c, GetEndpointRequest);
                                                        {1340}in(c, (=GetEndpointResponse,=pkSess_1612,=SignAndEncrypt,SP_1613: bitstring,UP_1614: bitstring));
                                                        {1341}new Nc_1615: bitstring;
                                                        {1342}let gNc_1616: bitstring = exp(g,Nc_1615) in
                                                        {1343}let m1_1617: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1616) in
                                                        {1344}event beginCli(Cli,Sess,gNc_1616);
                                                        {1345}out(c, (pkCli_1128,enc(m1_1617,pkSess_1612),sign(h(m1_1617),skCli_1127)));
                                                        {1346}in(c, (em2_1618: bitstring,sigM2_1619: bitstring));
                                                        {1347}let m2_1620: bitstring = dec(em2_1618,skCli_1127) in
                                                        {1348}if (verify(h(m2_1620),sigM2_1619,pkSess_1612) <> true) then
                                                            0
                                                        else
                                                            {1349}let (=OpenSecureChannelResponse,PartS_1621: bitstring,ST_1622: bitstring,TTL_1623: bitstring) = m2_1620 in
                                                            {1350}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1351}event endCli(Sess,Cli,PartS_1621)
                                                )
                                                else
                                                    {1352}let pkSess_1624: bitstring = fail-any in
                                                    {1353}out(c, GetEndpointRequest);
                                                    {1354}in(c, (=GetEndpointResponse,=pkSess_1624,=SignAndEncrypt,SP_1625: bitstring,UP_1626: bitstring));
                                                    {1355}new Nc_1627: bitstring;
                                                    {1356}let gNc_1628: bitstring = exp(g,Nc_1627) in
                                                    {1357}let m1_1629: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1628) in
                                                    {1358}event beginCli(Cli,Sess,gNc_1628);
                                                    {1359}out(c, (pkCli_1128,enc(m1_1629,pkSess_1624),sign(h(m1_1629),skCli_1127)));
                                                    {1360}in(c, (em2_1630: bitstring,sigM2_1631: bitstring));
                                                    {1361}let m2_1632: bitstring = dec(em2_1630,skCli_1127) in
                                                    {1362}if (verify(h(m2_1632),sigM2_1631,pkSess_1624) <> true) then
                                                        0
                                                    else
                                                        {1363}let (=OpenSecureChannelResponse,PartS_1633: bitstring,ST_1634: bitstring,TTL_1635: bitstring) = m2_1632 in
                                                        {1364}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1365}event endCli(Sess,Cli,PartS_1633)
                                        )
                                        else
                                            {1366}let pkSess_1636: bitstring = fail-any in
                                            {1367}out(c, GetEndpointRequest);
                                            {1368}in(c, (=GetEndpointResponse,=pkSess_1636,=SignAndEncrypt,SP_1637: bitstring,UP_1638: bitstring));
                                            {1369}new Nc_1639: bitstring;
                                            {1370}let gNc_1640: bitstring = exp(g,Nc_1639) in
                                            {1371}let m1_1641: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1640) in
                                            {1372}event beginCli(Cli,Sess,gNc_1640);
                                            {1373}out(c, (pkCli_1128,enc(m1_1641,pkSess_1636),sign(h(m1_1641),skCli_1127)));
                                            {1374}in(c, (em2_1642: bitstring,sigM2_1643: bitstring));
                                            {1375}let m2_1644: bitstring = dec(em2_1642,skCli_1127) in
                                            {1376}if (verify(h(m2_1644),sigM2_1643,pkSess_1636) <> true) then
                                                0
                                            else
                                                {1377}let (=OpenSecureChannelResponse,PartS_1645: bitstring,ST_1646: bitstring,TTL_1647: bitstring) = m2_1644 in
                                                {1378}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1379}event endCli(Sess,Cli,PartS_1645)
                                )
                                else
                                    {1380}let pkSess_1648: bitstring = fail-any in
                                    {1381}out(c, GetEndpointRequest);
                                    {1382}in(c, (=GetEndpointResponse,=pkSess_1648,=SignAndEncrypt,SP_1649: bitstring,UP_1650: bitstring));
                                    {1383}new Nc_1651: bitstring;
                                    {1384}let gNc_1652: bitstring = exp(g,Nc_1651) in
                                    {1385}let m1_1653: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1652) in
                                    {1386}event beginCli(Cli,Sess,gNc_1652);
                                    {1387}out(c, (pkCli_1128,enc(m1_1653,pkSess_1648),sign(h(m1_1653),skCli_1127)));
                                    {1388}in(c, (em2_1654: bitstring,sigM2_1655: bitstring));
                                    {1389}let m2_1656: bitstring = dec(em2_1654,skCli_1127) in
                                    {1390}if (verify(h(m2_1656),sigM2_1655,pkSess_1648) <> true) then
                                        0
                                    else
                                        {1391}let (=OpenSecureChannelResponse,PartS_1657: bitstring,ST_1658: bitstring,TTL_1659: bitstring) = m2_1656 in
                                        {1392}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1393}event endCli(Sess,Cli,PartS_1657)
                    )
                    else
                        {1394}let pkDisco_1660: bitstring = fail-any in
                        {1395}let v_1661: bool = (Sess = A) in
                        (
                            {1396}if v_1661 then
                            (
                                {1397}let pkSess_1662: bitstring = pub(skA) in
                                {1398}out(c, GetEndpointRequest);
                                {1399}in(c, (=GetEndpointResponse,=pkSess_1662,=SignAndEncrypt,SP_1663: bitstring,UP_1664: bitstring));
                                {1400}new Nc_1665: bitstring;
                                {1401}let gNc_1666: bitstring = exp(g,Nc_1665) in
                                {1402}let m1_1667: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1666) in
                                {1403}event beginCli(Cli,Sess,gNc_1666);
                                {1404}out(c, (pkCli_1128,enc(m1_1667,pkSess_1662),sign(h(m1_1667),skCli_1127)));
                                {1405}in(c, (em2_1668: bitstring,sigM2_1669: bitstring));
                                {1406}let m2_1670: bitstring = dec(em2_1668,skCli_1127) in
                                {1407}if (verify(h(m2_1670),sigM2_1669,pkSess_1662) <> true) then
                                    0
                                else
                                    {1408}let (=OpenSecureChannelResponse,PartS_1671: bitstring,ST_1672: bitstring,TTL_1673: bitstring) = m2_1670 in
                                    {1409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1410}event endCli(Sess,Cli,PartS_1671)
                            )
                            else
                                {1411}let v_1674: bool = (Sess = B) in
                                (
                                    {1412}if v_1674 then
                                    (
                                        {1413}let pkSess_1675: bitstring = pub(skB) in
                                        {1414}out(c, GetEndpointRequest);
                                        {1415}in(c, (=GetEndpointResponse,=pkSess_1675,=SignAndEncrypt,SP_1676: bitstring,UP_1677: bitstring));
                                        {1416}new Nc_1678: bitstring;
                                        {1417}let gNc_1679: bitstring = exp(g,Nc_1678) in
                                        {1418}let m1_1680: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1679) in
                                        {1419}event beginCli(Cli,Sess,gNc_1679);
                                        {1420}out(c, (pkCli_1128,enc(m1_1680,pkSess_1675),sign(h(m1_1680),skCli_1127)));
                                        {1421}in(c, (em2_1681: bitstring,sigM2_1682: bitstring));
                                        {1422}let m2_1683: bitstring = dec(em2_1681,skCli_1127) in
                                        {1423}if (verify(h(m2_1683),sigM2_1682,pkSess_1675) <> true) then
                                            0
                                        else
                                            {1424}let (=OpenSecureChannelResponse,PartS_1684: bitstring,ST_1685: bitstring,TTL_1686: bitstring) = m2_1683 in
                                            {1425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1426}event endCli(Sess,Cli,PartS_1684)
                                    )
                                    else
                                        {1427}let v_1687: bool = (Sess = C) in
                                        (
                                            {1428}if v_1687 then
                                            (
                                                {1429}let pkSess_1688: bitstring = pub(skC) in
                                                {1430}out(c, GetEndpointRequest);
                                                {1431}in(c, (=GetEndpointResponse,=pkSess_1688,=SignAndEncrypt,SP_1689: bitstring,UP_1690: bitstring));
                                                {1432}new Nc_1691: bitstring;
                                                {1433}let gNc_1692: bitstring = exp(g,Nc_1691) in
                                                {1434}let m1_1693: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1692) in
                                                {1435}event beginCli(Cli,Sess,gNc_1692);
                                                {1436}out(c, (pkCli_1128,enc(m1_1693,pkSess_1688),sign(h(m1_1693),skCli_1127)));
                                                {1437}in(c, (em2_1694: bitstring,sigM2_1695: bitstring));
                                                {1438}let m2_1696: bitstring = dec(em2_1694,skCli_1127) in
                                                {1439}if (verify(h(m2_1696),sigM2_1695,pkSess_1688) <> true) then
                                                    0
                                                else
                                                    {1440}let (=OpenSecureChannelResponse,PartS_1697: bitstring,ST_1698: bitstring,TTL_1699: bitstring) = m2_1696 in
                                                    {1441}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1442}event endCli(Sess,Cli,PartS_1697)
                                            )
                                            else
                                                {1443}let pkSess_1700: bitstring = pub(sk(Sess)) in
                                                {1444}out(c, GetEndpointRequest);
                                                {1445}in(c, (=GetEndpointResponse,=pkSess_1700,=SignAndEncrypt,SP_1701: bitstring,UP_1702: bitstring));
                                                {1446}new Nc_1703: bitstring;
                                                {1447}let gNc_1704: bitstring = exp(g,Nc_1703) in
                                                {1448}let m1_1705: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1704) in
                                                {1449}event beginCli(Cli,Sess,gNc_1704);
                                                {1450}out(c, (pkCli_1128,enc(m1_1705,pkSess_1700),sign(h(m1_1705),skCli_1127)));
                                                {1451}in(c, (em2_1706: bitstring,sigM2_1707: bitstring));
                                                {1452}let m2_1708: bitstring = dec(em2_1706,skCli_1127) in
                                                {1453}if (verify(h(m2_1708),sigM2_1707,pkSess_1700) <> true) then
                                                    0
                                                else
                                                    {1454}let (=OpenSecureChannelResponse,PartS_1709: bitstring,ST_1710: bitstring,TTL_1711: bitstring) = m2_1708 in
                                                    {1455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1456}event endCli(Sess,Cli,PartS_1709)
                                        )
                                        else
                                            {1457}let pkSess_1712: bitstring = fail-any in
                                            {1458}out(c, GetEndpointRequest);
                                            {1459}in(c, (=GetEndpointResponse,=pkSess_1712,=SignAndEncrypt,SP_1713: bitstring,UP_1714: bitstring));
                                            {1460}new Nc_1715: bitstring;
                                            {1461}let gNc_1716: bitstring = exp(g,Nc_1715) in
                                            {1462}let m1_1717: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1716) in
                                            {1463}event beginCli(Cli,Sess,gNc_1716);
                                            {1464}out(c, (pkCli_1128,enc(m1_1717,pkSess_1712),sign(h(m1_1717),skCli_1127)));
                                            {1465}in(c, (em2_1718: bitstring,sigM2_1719: bitstring));
                                            {1466}let m2_1720: bitstring = dec(em2_1718,skCli_1127) in
                                            {1467}if (verify(h(m2_1720),sigM2_1719,pkSess_1712) <> true) then
                                                0
                                            else
                                                {1468}let (=OpenSecureChannelResponse,PartS_1721: bitstring,ST_1722: bitstring,TTL_1723: bitstring) = m2_1720 in
                                                {1469}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1470}event endCli(Sess,Cli,PartS_1721)
                                )
                                else
                                    {1471}let pkSess_1724: bitstring = fail-any in
                                    {1472}out(c, GetEndpointRequest);
                                    {1473}in(c, (=GetEndpointResponse,=pkSess_1724,=SignAndEncrypt,SP_1725: bitstring,UP_1726: bitstring));
                                    {1474}new Nc_1727: bitstring;
                                    {1475}let gNc_1728: bitstring = exp(g,Nc_1727) in
                                    {1476}let m1_1729: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1728) in
                                    {1477}event beginCli(Cli,Sess,gNc_1728);
                                    {1478}out(c, (pkCli_1128,enc(m1_1729,pkSess_1724),sign(h(m1_1729),skCli_1127)));
                                    {1479}in(c, (em2_1730: bitstring,sigM2_1731: bitstring));
                                    {1480}let m2_1732: bitstring = dec(em2_1730,skCli_1127) in
                                    {1481}if (verify(h(m2_1732),sigM2_1731,pkSess_1724) <> true) then
                                        0
                                    else
                                        {1482}let (=OpenSecureChannelResponse,PartS_1733: bitstring,ST_1734: bitstring,TTL_1735: bitstring) = m2_1732 in
                                        {1483}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1484}event endCli(Sess,Cli,PartS_1733)
                        )
                        else
                            {1485}let pkSess_1736: bitstring = fail-any in
                            {1486}out(c, GetEndpointRequest);
                            {1487}in(c, (=GetEndpointResponse,=pkSess_1736,=SignAndEncrypt,SP_1737: bitstring,UP_1738: bitstring));
                            {1488}new Nc_1739: bitstring;
                            {1489}let gNc_1740: bitstring = exp(g,Nc_1739) in
                            {1490}let m1_1741: bitstring = (OpenSecureChannelRequest,pkCli_1128,gNc_1740) in
                            {1491}event beginCli(Cli,Sess,gNc_1740);
                            {1492}out(c, (pkCli_1128,enc(m1_1741,pkSess_1736),sign(h(m1_1741),skCli_1127)));
                            {1493}in(c, (em2_1742: bitstring,sigM2_1743: bitstring));
                            {1494}let m2_1744: bitstring = dec(em2_1742,skCli_1127) in
                            {1495}if (verify(h(m2_1744),sigM2_1743,pkSess_1736) <> true) then
                                0
                            else
                                {1496}let (=OpenSecureChannelResponse,PartS_1745: bitstring,ST_1746: bitstring,TTL_1747: bitstring) = m2_1744 in
                                {1497}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1498}event endCli(Sess,Cli,PartS_1745)
                )
                else
                    {1499}let =true = (Cli = C) in
                    (
                        {1500}let skCli_1748: bitstring = skC in
                        {1501}let pkCli_1749: bitstring = pub(skCli_1748) in
                        {1502}let v_1750: bool = (Disco = A) in
                        (
                            {1503}if v_1750 then
                            (
                                {1504}let pkDisco_1751: bitstring = pub(skA) in
                                {1505}let v_1752: bool = (Sess = A) in
                                (
                                    {1506}if v_1752 then
                                    (
                                        {1507}let pkSess_1753: bitstring = pub(skA) in
                                        {1508}out(c, GetEndpointRequest);
                                        {1509}in(c, (=GetEndpointResponse,=pkSess_1753,=SignAndEncrypt,SP_1754: bitstring,UP_1755: bitstring));
                                        {1510}new Nc_1756: bitstring;
                                        {1511}let gNc_1757: bitstring = exp(g,Nc_1756) in
                                        {1512}let m1_1758: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1757) in
                                        {1513}event beginCli(Cli,Sess,gNc_1757);
                                        {1514}out(c, (pkCli_1749,enc(m1_1758,pkSess_1753),sign(h(m1_1758),skCli_1748)));
                                        {1515}in(c, (em2_1759: bitstring,sigM2_1760: bitstring));
                                        {1516}let m2_1761: bitstring = dec(em2_1759,skCli_1748) in
                                        {1517}if (verify(h(m2_1761),sigM2_1760,pkSess_1753) <> true) then
                                            0
                                        else
                                            {1518}let (=OpenSecureChannelResponse,PartS_1762: bitstring,ST_1763: bitstring,TTL_1764: bitstring) = m2_1761 in
                                            {1519}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1520}event endCli(Sess,Cli,PartS_1762)
                                    )
                                    else
                                        {1521}let v_1765: bool = (Sess = B) in
                                        (
                                            {1522}if v_1765 then
                                            (
                                                {1523}let pkSess_1766: bitstring = pub(skB) in
                                                {1524}out(c, GetEndpointRequest);
                                                {1525}in(c, (=GetEndpointResponse,=pkSess_1766,=SignAndEncrypt,SP_1767: bitstring,UP_1768: bitstring));
                                                {1526}new Nc_1769: bitstring;
                                                {1527}let gNc_1770: bitstring = exp(g,Nc_1769) in
                                                {1528}let m1_1771: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1770) in
                                                {1529}event beginCli(Cli,Sess,gNc_1770);
                                                {1530}out(c, (pkCli_1749,enc(m1_1771,pkSess_1766),sign(h(m1_1771),skCli_1748)));
                                                {1531}in(c, (em2_1772: bitstring,sigM2_1773: bitstring));
                                                {1532}let m2_1774: bitstring = dec(em2_1772,skCli_1748) in
                                                {1533}if (verify(h(m2_1774),sigM2_1773,pkSess_1766) <> true) then
                                                    0
                                                else
                                                    {1534}let (=OpenSecureChannelResponse,PartS_1775: bitstring,ST_1776: bitstring,TTL_1777: bitstring) = m2_1774 in
                                                    {1535}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1536}event endCli(Sess,Cli,PartS_1775)
                                            )
                                            else
                                                {1537}let v_1778: bool = (Sess = C) in
                                                (
                                                    {1538}if v_1778 then
                                                    (
                                                        {1539}let pkSess_1779: bitstring = pub(skC) in
                                                        {1540}out(c, GetEndpointRequest);
                                                        {1541}in(c, (=GetEndpointResponse,=pkSess_1779,=SignAndEncrypt,SP_1780: bitstring,UP_1781: bitstring));
                                                        {1542}new Nc_1782: bitstring;
                                                        {1543}let gNc_1783: bitstring = exp(g,Nc_1782) in
                                                        {1544}let m1_1784: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1783) in
                                                        {1545}event beginCli(Cli,Sess,gNc_1783);
                                                        {1546}out(c, (pkCli_1749,enc(m1_1784,pkSess_1779),sign(h(m1_1784),skCli_1748)));
                                                        {1547}in(c, (em2_1785: bitstring,sigM2_1786: bitstring));
                                                        {1548}let m2_1787: bitstring = dec(em2_1785,skCli_1748) in
                                                        {1549}if (verify(h(m2_1787),sigM2_1786,pkSess_1779) <> true) then
                                                            0
                                                        else
                                                            {1550}let (=OpenSecureChannelResponse,PartS_1788: bitstring,ST_1789: bitstring,TTL_1790: bitstring) = m2_1787 in
                                                            {1551}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1552}event endCli(Sess,Cli,PartS_1788)
                                                    )
                                                    else
                                                        {1553}let pkSess_1791: bitstring = pub(sk(Sess)) in
                                                        {1554}out(c, GetEndpointRequest);
                                                        {1555}in(c, (=GetEndpointResponse,=pkSess_1791,=SignAndEncrypt,SP_1792: bitstring,UP_1793: bitstring));
                                                        {1556}new Nc_1794: bitstring;
                                                        {1557}let gNc_1795: bitstring = exp(g,Nc_1794) in
                                                        {1558}let m1_1796: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1795) in
                                                        {1559}event beginCli(Cli,Sess,gNc_1795);
                                                        {1560}out(c, (pkCli_1749,enc(m1_1796,pkSess_1791),sign(h(m1_1796),skCli_1748)));
                                                        {1561}in(c, (em2_1797: bitstring,sigM2_1798: bitstring));
                                                        {1562}let m2_1799: bitstring = dec(em2_1797,skCli_1748) in
                                                        {1563}if (verify(h(m2_1799),sigM2_1798,pkSess_1791) <> true) then
                                                            0
                                                        else
                                                            {1564}let (=OpenSecureChannelResponse,PartS_1800: bitstring,ST_1801: bitstring,TTL_1802: bitstring) = m2_1799 in
                                                            {1565}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1566}event endCli(Sess,Cli,PartS_1800)
                                                )
                                                else
                                                    {1567}let pkSess_1803: bitstring = fail-any in
                                                    {1568}out(c, GetEndpointRequest);
                                                    {1569}in(c, (=GetEndpointResponse,=pkSess_1803,=SignAndEncrypt,SP_1804: bitstring,UP_1805: bitstring));
                                                    {1570}new Nc_1806: bitstring;
                                                    {1571}let gNc_1807: bitstring = exp(g,Nc_1806) in
                                                    {1572}let m1_1808: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1807) in
                                                    {1573}event beginCli(Cli,Sess,gNc_1807);
                                                    {1574}out(c, (pkCli_1749,enc(m1_1808,pkSess_1803),sign(h(m1_1808),skCli_1748)));
                                                    {1575}in(c, (em2_1809: bitstring,sigM2_1810: bitstring));
                                                    {1576}let m2_1811: bitstring = dec(em2_1809,skCli_1748) in
                                                    {1577}if (verify(h(m2_1811),sigM2_1810,pkSess_1803) <> true) then
                                                        0
                                                    else
                                                        {1578}let (=OpenSecureChannelResponse,PartS_1812: bitstring,ST_1813: bitstring,TTL_1814: bitstring) = m2_1811 in
                                                        {1579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1580}event endCli(Sess,Cli,PartS_1812)
                                        )
                                        else
                                            {1581}let pkSess_1815: bitstring = fail-any in
                                            {1582}out(c, GetEndpointRequest);
                                            {1583}in(c, (=GetEndpointResponse,=pkSess_1815,=SignAndEncrypt,SP_1816: bitstring,UP_1817: bitstring));
                                            {1584}new Nc_1818: bitstring;
                                            {1585}let gNc_1819: bitstring = exp(g,Nc_1818) in
                                            {1586}let m1_1820: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1819) in
                                            {1587}event beginCli(Cli,Sess,gNc_1819);
                                            {1588}out(c, (pkCli_1749,enc(m1_1820,pkSess_1815),sign(h(m1_1820),skCli_1748)));
                                            {1589}in(c, (em2_1821: bitstring,sigM2_1822: bitstring));
                                            {1590}let m2_1823: bitstring = dec(em2_1821,skCli_1748) in
                                            {1591}if (verify(h(m2_1823),sigM2_1822,pkSess_1815) <> true) then
                                                0
                                            else
                                                {1592}let (=OpenSecureChannelResponse,PartS_1824: bitstring,ST_1825: bitstring,TTL_1826: bitstring) = m2_1823 in
                                                {1593}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1594}event endCli(Sess,Cli,PartS_1824)
                                )
                                else
                                    {1595}let pkSess_1827: bitstring = fail-any in
                                    {1596}out(c, GetEndpointRequest);
                                    {1597}in(c, (=GetEndpointResponse,=pkSess_1827,=SignAndEncrypt,SP_1828: bitstring,UP_1829: bitstring));
                                    {1598}new Nc_1830: bitstring;
                                    {1599}let gNc_1831: bitstring = exp(g,Nc_1830) in
                                    {1600}let m1_1832: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1831) in
                                    {1601}event beginCli(Cli,Sess,gNc_1831);
                                    {1602}out(c, (pkCli_1749,enc(m1_1832,pkSess_1827),sign(h(m1_1832),skCli_1748)));
                                    {1603}in(c, (em2_1833: bitstring,sigM2_1834: bitstring));
                                    {1604}let m2_1835: bitstring = dec(em2_1833,skCli_1748) in
                                    {1605}if (verify(h(m2_1835),sigM2_1834,pkSess_1827) <> true) then
                                        0
                                    else
                                        {1606}let (=OpenSecureChannelResponse,PartS_1836: bitstring,ST_1837: bitstring,TTL_1838: bitstring) = m2_1835 in
                                        {1607}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1608}event endCli(Sess,Cli,PartS_1836)
                            )
                            else
                                {1609}let v_1839: bool = (Disco = B) in
                                (
                                    {1610}if v_1839 then
                                    (
                                        {1611}let pkDisco_1840: bitstring = pub(skB) in
                                        {1612}let v_1841: bool = (Sess = A) in
                                        (
                                            {1613}if v_1841 then
                                            (
                                                {1614}let pkSess_1842: bitstring = pub(skA) in
                                                {1615}out(c, GetEndpointRequest);
                                                {1616}in(c, (=GetEndpointResponse,=pkSess_1842,=SignAndEncrypt,SP_1843: bitstring,UP_1844: bitstring));
                                                {1617}new Nc_1845: bitstring;
                                                {1618}let gNc_1846: bitstring = exp(g,Nc_1845) in
                                                {1619}let m1_1847: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1846) in
                                                {1620}event beginCli(Cli,Sess,gNc_1846);
                                                {1621}out(c, (pkCli_1749,enc(m1_1847,pkSess_1842),sign(h(m1_1847),skCli_1748)));
                                                {1622}in(c, (em2_1848: bitstring,sigM2_1849: bitstring));
                                                {1623}let m2_1850: bitstring = dec(em2_1848,skCli_1748) in
                                                {1624}if (verify(h(m2_1850),sigM2_1849,pkSess_1842) <> true) then
                                                    0
                                                else
                                                    {1625}let (=OpenSecureChannelResponse,PartS_1851: bitstring,ST_1852: bitstring,TTL_1853: bitstring) = m2_1850 in
                                                    {1626}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1627}event endCli(Sess,Cli,PartS_1851)
                                            )
                                            else
                                                {1628}let v_1854: bool = (Sess = B) in
                                                (
                                                    {1629}if v_1854 then
                                                    (
                                                        {1630}let pkSess_1855: bitstring = pub(skB) in
                                                        {1631}out(c, GetEndpointRequest);
                                                        {1632}in(c, (=GetEndpointResponse,=pkSess_1855,=SignAndEncrypt,SP_1856: bitstring,UP_1857: bitstring));
                                                        {1633}new Nc_1858: bitstring;
                                                        {1634}let gNc_1859: bitstring = exp(g,Nc_1858) in
                                                        {1635}let m1_1860: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1859) in
                                                        {1636}event beginCli(Cli,Sess,gNc_1859);
                                                        {1637}out(c, (pkCli_1749,enc(m1_1860,pkSess_1855),sign(h(m1_1860),skCli_1748)));
                                                        {1638}in(c, (em2_1861: bitstring,sigM2_1862: bitstring));
                                                        {1639}let m2_1863: bitstring = dec(em2_1861,skCli_1748) in
                                                        {1640}if (verify(h(m2_1863),sigM2_1862,pkSess_1855) <> true) then
                                                            0
                                                        else
                                                            {1641}let (=OpenSecureChannelResponse,PartS_1864: bitstring,ST_1865: bitstring,TTL_1866: bitstring) = m2_1863 in
                                                            {1642}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1643}event endCli(Sess,Cli,PartS_1864)
                                                    )
                                                    else
                                                        {1644}let v_1867: bool = (Sess = C) in
                                                        (
                                                            {1645}if v_1867 then
                                                            (
                                                                {1646}let pkSess_1868: bitstring = pub(skC) in
                                                                {1647}out(c, GetEndpointRequest);
                                                                {1648}in(c, (=GetEndpointResponse,=pkSess_1868,=SignAndEncrypt,SP_1869: bitstring,UP_1870: bitstring));
                                                                {1649}new Nc_1871: bitstring;
                                                                {1650}let gNc_1872: bitstring = exp(g,Nc_1871) in
                                                                {1651}let m1_1873: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1872) in
                                                                {1652}event beginCli(Cli,Sess,gNc_1872);
                                                                {1653}out(c, (pkCli_1749,enc(m1_1873,pkSess_1868),sign(h(m1_1873),skCli_1748)));
                                                                {1654}in(c, (em2_1874: bitstring,sigM2_1875: bitstring));
                                                                {1655}let m2_1876: bitstring = dec(em2_1874,skCli_1748) in
                                                                {1656}if (verify(h(m2_1876),sigM2_1875,pkSess_1868) <> true) then
                                                                    0
                                                                else
                                                                    {1657}let (=OpenSecureChannelResponse,PartS_1877: bitstring,ST_1878: bitstring,TTL_1879: bitstring) = m2_1876 in
                                                                    {1658}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1659}event endCli(Sess,Cli,PartS_1877)
                                                            )
                                                            else
                                                                {1660}let pkSess_1880: bitstring = pub(sk(Sess)) in
                                                                {1661}out(c, GetEndpointRequest);
                                                                {1662}in(c, (=GetEndpointResponse,=pkSess_1880,=SignAndEncrypt,SP_1881: bitstring,UP_1882: bitstring));
                                                                {1663}new Nc_1883: bitstring;
                                                                {1664}let gNc_1884: bitstring = exp(g,Nc_1883) in
                                                                {1665}let m1_1885: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1884) in
                                                                {1666}event beginCli(Cli,Sess,gNc_1884);
                                                                {1667}out(c, (pkCli_1749,enc(m1_1885,pkSess_1880),sign(h(m1_1885),skCli_1748)));
                                                                {1668}in(c, (em2_1886: bitstring,sigM2_1887: bitstring));
                                                                {1669}let m2_1888: bitstring = dec(em2_1886,skCli_1748) in
                                                                {1670}if (verify(h(m2_1888),sigM2_1887,pkSess_1880) <> true) then
                                                                    0
                                                                else
                                                                    {1671}let (=OpenSecureChannelResponse,PartS_1889: bitstring,ST_1890: bitstring,TTL_1891: bitstring) = m2_1888 in
                                                                    {1672}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1673}event endCli(Sess,Cli,PartS_1889)
                                                        )
                                                        else
                                                            {1674}let pkSess_1892: bitstring = fail-any in
                                                            {1675}out(c, GetEndpointRequest);
                                                            {1676}in(c, (=GetEndpointResponse,=pkSess_1892,=SignAndEncrypt,SP_1893: bitstring,UP_1894: bitstring));
                                                            {1677}new Nc_1895: bitstring;
                                                            {1678}let gNc_1896: bitstring = exp(g,Nc_1895) in
                                                            {1679}let m1_1897: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1896) in
                                                            {1680}event beginCli(Cli,Sess,gNc_1896);
                                                            {1681}out(c, (pkCli_1749,enc(m1_1897,pkSess_1892),sign(h(m1_1897),skCli_1748)));
                                                            {1682}in(c, (em2_1898: bitstring,sigM2_1899: bitstring));
                                                            {1683}let m2_1900: bitstring = dec(em2_1898,skCli_1748) in
                                                            {1684}if (verify(h(m2_1900),sigM2_1899,pkSess_1892) <> true) then
                                                                0
                                                            else
                                                                {1685}let (=OpenSecureChannelResponse,PartS_1901: bitstring,ST_1902: bitstring,TTL_1903: bitstring) = m2_1900 in
                                                                {1686}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1687}event endCli(Sess,Cli,PartS_1901)
                                                )
                                                else
                                                    {1688}let pkSess_1904: bitstring = fail-any in
                                                    {1689}out(c, GetEndpointRequest);
                                                    {1690}in(c, (=GetEndpointResponse,=pkSess_1904,=SignAndEncrypt,SP_1905: bitstring,UP_1906: bitstring));
                                                    {1691}new Nc_1907: bitstring;
                                                    {1692}let gNc_1908: bitstring = exp(g,Nc_1907) in
                                                    {1693}let m1_1909: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1908) in
                                                    {1694}event beginCli(Cli,Sess,gNc_1908);
                                                    {1695}out(c, (pkCli_1749,enc(m1_1909,pkSess_1904),sign(h(m1_1909),skCli_1748)));
                                                    {1696}in(c, (em2_1910: bitstring,sigM2_1911: bitstring));
                                                    {1697}let m2_1912: bitstring = dec(em2_1910,skCli_1748) in
                                                    {1698}if (verify(h(m2_1912),sigM2_1911,pkSess_1904) <> true) then
                                                        0
                                                    else
                                                        {1699}let (=OpenSecureChannelResponse,PartS_1913: bitstring,ST_1914: bitstring,TTL_1915: bitstring) = m2_1912 in
                                                        {1700}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1701}event endCli(Sess,Cli,PartS_1913)
                                        )
                                        else
                                            {1702}let pkSess_1916: bitstring = fail-any in
                                            {1703}out(c, GetEndpointRequest);
                                            {1704}in(c, (=GetEndpointResponse,=pkSess_1916,=SignAndEncrypt,SP_1917: bitstring,UP_1918: bitstring));
                                            {1705}new Nc_1919: bitstring;
                                            {1706}let gNc_1920: bitstring = exp(g,Nc_1919) in
                                            {1707}let m1_1921: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1920) in
                                            {1708}event beginCli(Cli,Sess,gNc_1920);
                                            {1709}out(c, (pkCli_1749,enc(m1_1921,pkSess_1916),sign(h(m1_1921),skCli_1748)));
                                            {1710}in(c, (em2_1922: bitstring,sigM2_1923: bitstring));
                                            {1711}let m2_1924: bitstring = dec(em2_1922,skCli_1748) in
                                            {1712}if (verify(h(m2_1924),sigM2_1923,pkSess_1916) <> true) then
                                                0
                                            else
                                                {1713}let (=OpenSecureChannelResponse,PartS_1925: bitstring,ST_1926: bitstring,TTL_1927: bitstring) = m2_1924 in
                                                {1714}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1715}event endCli(Sess,Cli,PartS_1925)
                                    )
                                    else
                                        {1716}let v_1928: bool = (Disco = C) in
                                        (
                                            {1717}if v_1928 then
                                            (
                                                {1718}let pkDisco_1929: bitstring = pub(skC) in
                                                {1719}let v_1930: bool = (Sess = A) in
                                                (
                                                    {1720}if v_1930 then
                                                    (
                                                        {1721}let pkSess_1931: bitstring = pub(skA) in
                                                        {1722}out(c, GetEndpointRequest);
                                                        {1723}in(c, (=GetEndpointResponse,=pkSess_1931,=SignAndEncrypt,SP_1932: bitstring,UP_1933: bitstring));
                                                        {1724}new Nc_1934: bitstring;
                                                        {1725}let gNc_1935: bitstring = exp(g,Nc_1934) in
                                                        {1726}let m1_1936: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1935) in
                                                        {1727}event beginCli(Cli,Sess,gNc_1935);
                                                        {1728}out(c, (pkCli_1749,enc(m1_1936,pkSess_1931),sign(h(m1_1936),skCli_1748)));
                                                        {1729}in(c, (em2_1937: bitstring,sigM2_1938: bitstring));
                                                        {1730}let m2_1939: bitstring = dec(em2_1937,skCli_1748) in
                                                        {1731}if (verify(h(m2_1939),sigM2_1938,pkSess_1931) <> true) then
                                                            0
                                                        else
                                                            {1732}let (=OpenSecureChannelResponse,PartS_1940: bitstring,ST_1941: bitstring,TTL_1942: bitstring) = m2_1939 in
                                                            {1733}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1734}event endCli(Sess,Cli,PartS_1940)
                                                    )
                                                    else
                                                        {1735}let v_1943: bool = (Sess = B) in
                                                        (
                                                            {1736}if v_1943 then
                                                            (
                                                                {1737}let pkSess_1944: bitstring = pub(skB) in
                                                                {1738}out(c, GetEndpointRequest);
                                                                {1739}in(c, (=GetEndpointResponse,=pkSess_1944,=SignAndEncrypt,SP_1945: bitstring,UP_1946: bitstring));
                                                                {1740}new Nc_1947: bitstring;
                                                                {1741}let gNc_1948: bitstring = exp(g,Nc_1947) in
                                                                {1742}let m1_1949: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1948) in
                                                                {1743}event beginCli(Cli,Sess,gNc_1948);
                                                                {1744}out(c, (pkCli_1749,enc(m1_1949,pkSess_1944),sign(h(m1_1949),skCli_1748)));
                                                                {1745}in(c, (em2_1950: bitstring,sigM2_1951: bitstring));
                                                                {1746}let m2_1952: bitstring = dec(em2_1950,skCli_1748) in
                                                                {1747}if (verify(h(m2_1952),sigM2_1951,pkSess_1944) <> true) then
                                                                    0
                                                                else
                                                                    {1748}let (=OpenSecureChannelResponse,PartS_1953: bitstring,ST_1954: bitstring,TTL_1955: bitstring) = m2_1952 in
                                                                    {1749}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1750}event endCli(Sess,Cli,PartS_1953)
                                                            )
                                                            else
                                                                {1751}let v_1956: bool = (Sess = C) in
                                                                (
                                                                    {1752}if v_1956 then
                                                                    (
                                                                        {1753}let pkSess_1957: bitstring = pub(skC) in
                                                                        {1754}out(c, GetEndpointRequest);
                                                                        {1755}in(c, (=GetEndpointResponse,=pkSess_1957,=SignAndEncrypt,SP_1958: bitstring,UP_1959: bitstring));
                                                                        {1756}new Nc_1960: bitstring;
                                                                        {1757}let gNc_1961: bitstring = exp(g,Nc_1960) in
                                                                        {1758}let m1_1962: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1961) in
                                                                        {1759}event beginCli(Cli,Sess,gNc_1961);
                                                                        {1760}out(c, (pkCli_1749,enc(m1_1962,pkSess_1957),sign(h(m1_1962),skCli_1748)));
                                                                        {1761}in(c, (em2_1963: bitstring,sigM2_1964: bitstring));
                                                                        {1762}let m2_1965: bitstring = dec(em2_1963,skCli_1748) in
                                                                        {1763}if (verify(h(m2_1965),sigM2_1964,pkSess_1957) <> true) then
                                                                            0
                                                                        else
                                                                            {1764}let (=OpenSecureChannelResponse,PartS_1966: bitstring,ST_1967: bitstring,TTL_1968: bitstring) = m2_1965 in
                                                                            {1765}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1766}event endCli(Sess,Cli,PartS_1966)
                                                                    )
                                                                    else
                                                                        {1767}let pkSess_1969: bitstring = pub(sk(Sess)) in
                                                                        {1768}out(c, GetEndpointRequest);
                                                                        {1769}in(c, (=GetEndpointResponse,=pkSess_1969,=SignAndEncrypt,SP_1970: bitstring,UP_1971: bitstring));
                                                                        {1770}new Nc_1972: bitstring;
                                                                        {1771}let gNc_1973: bitstring = exp(g,Nc_1972) in
                                                                        {1772}let m1_1974: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1973) in
                                                                        {1773}event beginCli(Cli,Sess,gNc_1973);
                                                                        {1774}out(c, (pkCli_1749,enc(m1_1974,pkSess_1969),sign(h(m1_1974),skCli_1748)));
                                                                        {1775}in(c, (em2_1975: bitstring,sigM2_1976: bitstring));
                                                                        {1776}let m2_1977: bitstring = dec(em2_1975,skCli_1748) in
                                                                        {1777}if (verify(h(m2_1977),sigM2_1976,pkSess_1969) <> true) then
                                                                            0
                                                                        else
                                                                            {1778}let (=OpenSecureChannelResponse,PartS_1978: bitstring,ST_1979: bitstring,TTL_1980: bitstring) = m2_1977 in
                                                                            {1779}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1780}event endCli(Sess,Cli,PartS_1978)
                                                                )
                                                                else
                                                                    {1781}let pkSess_1981: bitstring = fail-any in
                                                                    {1782}out(c, GetEndpointRequest);
                                                                    {1783}in(c, (=GetEndpointResponse,=pkSess_1981,=SignAndEncrypt,SP_1982: bitstring,UP_1983: bitstring));
                                                                    {1784}new Nc_1984: bitstring;
                                                                    {1785}let gNc_1985: bitstring = exp(g,Nc_1984) in
                                                                    {1786}let m1_1986: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1985) in
                                                                    {1787}event beginCli(Cli,Sess,gNc_1985);
                                                                    {1788}out(c, (pkCli_1749,enc(m1_1986,pkSess_1981),sign(h(m1_1986),skCli_1748)));
                                                                    {1789}in(c, (em2_1987: bitstring,sigM2_1988: bitstring));
                                                                    {1790}let m2_1989: bitstring = dec(em2_1987,skCli_1748) in
                                                                    {1791}if (verify(h(m2_1989),sigM2_1988,pkSess_1981) <> true) then
                                                                        0
                                                                    else
                                                                        {1792}let (=OpenSecureChannelResponse,PartS_1990: bitstring,ST_1991: bitstring,TTL_1992: bitstring) = m2_1989 in
                                                                        {1793}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1794}event endCli(Sess,Cli,PartS_1990)
                                                        )
                                                        else
                                                            {1795}let pkSess_1993: bitstring = fail-any in
                                                            {1796}out(c, GetEndpointRequest);
                                                            {1797}in(c, (=GetEndpointResponse,=pkSess_1993,=SignAndEncrypt,SP_1994: bitstring,UP_1995: bitstring));
                                                            {1798}new Nc_1996: bitstring;
                                                            {1799}let gNc_1997: bitstring = exp(g,Nc_1996) in
                                                            {1800}let m1_1998: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_1997) in
                                                            {1801}event beginCli(Cli,Sess,gNc_1997);
                                                            {1802}out(c, (pkCli_1749,enc(m1_1998,pkSess_1993),sign(h(m1_1998),skCli_1748)));
                                                            {1803}in(c, (em2_1999: bitstring,sigM2_2000: bitstring));
                                                            {1804}let m2_2001: bitstring = dec(em2_1999,skCli_1748) in
                                                            {1805}if (verify(h(m2_2001),sigM2_2000,pkSess_1993) <> true) then
                                                                0
                                                            else
                                                                {1806}let (=OpenSecureChannelResponse,PartS_2002: bitstring,ST_2003: bitstring,TTL_2004: bitstring) = m2_2001 in
                                                                {1807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1808}event endCli(Sess,Cli,PartS_2002)
                                                )
                                                else
                                                    {1809}let pkSess_2005: bitstring = fail-any in
                                                    {1810}out(c, GetEndpointRequest);
                                                    {1811}in(c, (=GetEndpointResponse,=pkSess_2005,=SignAndEncrypt,SP_2006: bitstring,UP_2007: bitstring));
                                                    {1812}new Nc_2008: bitstring;
                                                    {1813}let gNc_2009: bitstring = exp(g,Nc_2008) in
                                                    {1814}let m1_2010: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2009) in
                                                    {1815}event beginCli(Cli,Sess,gNc_2009);
                                                    {1816}out(c, (pkCli_1749,enc(m1_2010,pkSess_2005),sign(h(m1_2010),skCli_1748)));
                                                    {1817}in(c, (em2_2011: bitstring,sigM2_2012: bitstring));
                                                    {1818}let m2_2013: bitstring = dec(em2_2011,skCli_1748) in
                                                    {1819}if (verify(h(m2_2013),sigM2_2012,pkSess_2005) <> true) then
                                                        0
                                                    else
                                                        {1820}let (=OpenSecureChannelResponse,PartS_2014: bitstring,ST_2015: bitstring,TTL_2016: bitstring) = m2_2013 in
                                                        {1821}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1822}event endCli(Sess,Cli,PartS_2014)
                                            )
                                            else
                                                {1823}let pkDisco_2017: bitstring = pub(sk(Disco)) in
                                                {1824}let v_2018: bool = (Sess = A) in
                                                (
                                                    {1825}if v_2018 then
                                                    (
                                                        {1826}let pkSess_2019: bitstring = pub(skA) in
                                                        {1827}out(c, GetEndpointRequest);
                                                        {1828}in(c, (=GetEndpointResponse,=pkSess_2019,=SignAndEncrypt,SP_2020: bitstring,UP_2021: bitstring));
                                                        {1829}new Nc_2022: bitstring;
                                                        {1830}let gNc_2023: bitstring = exp(g,Nc_2022) in
                                                        {1831}let m1_2024: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2023) in
                                                        {1832}event beginCli(Cli,Sess,gNc_2023);
                                                        {1833}out(c, (pkCli_1749,enc(m1_2024,pkSess_2019),sign(h(m1_2024),skCli_1748)));
                                                        {1834}in(c, (em2_2025: bitstring,sigM2_2026: bitstring));
                                                        {1835}let m2_2027: bitstring = dec(em2_2025,skCli_1748) in
                                                        {1836}if (verify(h(m2_2027),sigM2_2026,pkSess_2019) <> true) then
                                                            0
                                                        else
                                                            {1837}let (=OpenSecureChannelResponse,PartS_2028: bitstring,ST_2029: bitstring,TTL_2030: bitstring) = m2_2027 in
                                                            {1838}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1839}event endCli(Sess,Cli,PartS_2028)
                                                    )
                                                    else
                                                        {1840}let v_2031: bool = (Sess = B) in
                                                        (
                                                            {1841}if v_2031 then
                                                            (
                                                                {1842}let pkSess_2032: bitstring = pub(skB) in
                                                                {1843}out(c, GetEndpointRequest);
                                                                {1844}in(c, (=GetEndpointResponse,=pkSess_2032,=SignAndEncrypt,SP_2033: bitstring,UP_2034: bitstring));
                                                                {1845}new Nc_2035: bitstring;
                                                                {1846}let gNc_2036: bitstring = exp(g,Nc_2035) in
                                                                {1847}let m1_2037: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2036) in
                                                                {1848}event beginCli(Cli,Sess,gNc_2036);
                                                                {1849}out(c, (pkCli_1749,enc(m1_2037,pkSess_2032),sign(h(m1_2037),skCli_1748)));
                                                                {1850}in(c, (em2_2038: bitstring,sigM2_2039: bitstring));
                                                                {1851}let m2_2040: bitstring = dec(em2_2038,skCli_1748) in
                                                                {1852}if (verify(h(m2_2040),sigM2_2039,pkSess_2032) <> true) then
                                                                    0
                                                                else
                                                                    {1853}let (=OpenSecureChannelResponse,PartS_2041: bitstring,ST_2042: bitstring,TTL_2043: bitstring) = m2_2040 in
                                                                    {1854}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1855}event endCli(Sess,Cli,PartS_2041)
                                                            )
                                                            else
                                                                {1856}let v_2044: bool = (Sess = C) in
                                                                (
                                                                    {1857}if v_2044 then
                                                                    (
                                                                        {1858}let pkSess_2045: bitstring = pub(skC) in
                                                                        {1859}out(c, GetEndpointRequest);
                                                                        {1860}in(c, (=GetEndpointResponse,=pkSess_2045,=SignAndEncrypt,SP_2046: bitstring,UP_2047: bitstring));
                                                                        {1861}new Nc_2048: bitstring;
                                                                        {1862}let gNc_2049: bitstring = exp(g,Nc_2048) in
                                                                        {1863}let m1_2050: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2049) in
                                                                        {1864}event beginCli(Cli,Sess,gNc_2049);
                                                                        {1865}out(c, (pkCli_1749,enc(m1_2050,pkSess_2045),sign(h(m1_2050),skCli_1748)));
                                                                        {1866}in(c, (em2_2051: bitstring,sigM2_2052: bitstring));
                                                                        {1867}let m2_2053: bitstring = dec(em2_2051,skCli_1748) in
                                                                        {1868}if (verify(h(m2_2053),sigM2_2052,pkSess_2045) <> true) then
                                                                            0
                                                                        else
                                                                            {1869}let (=OpenSecureChannelResponse,PartS_2054: bitstring,ST_2055: bitstring,TTL_2056: bitstring) = m2_2053 in
                                                                            {1870}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1871}event endCli(Sess,Cli,PartS_2054)
                                                                    )
                                                                    else
                                                                        {1872}let pkSess_2057: bitstring = pub(sk(Sess)) in
                                                                        {1873}out(c, GetEndpointRequest);
                                                                        {1874}in(c, (=GetEndpointResponse,=pkSess_2057,=SignAndEncrypt,SP_2058: bitstring,UP_2059: bitstring));
                                                                        {1875}new Nc_2060: bitstring;
                                                                        {1876}let gNc_2061: bitstring = exp(g,Nc_2060) in
                                                                        {1877}let m1_2062: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2061) in
                                                                        {1878}event beginCli(Cli,Sess,gNc_2061);
                                                                        {1879}out(c, (pkCli_1749,enc(m1_2062,pkSess_2057),sign(h(m1_2062),skCli_1748)));
                                                                        {1880}in(c, (em2_2063: bitstring,sigM2_2064: bitstring));
                                                                        {1881}let m2_2065: bitstring = dec(em2_2063,skCli_1748) in
                                                                        {1882}if (verify(h(m2_2065),sigM2_2064,pkSess_2057) <> true) then
                                                                            0
                                                                        else
                                                                            {1883}let (=OpenSecureChannelResponse,PartS_2066: bitstring,ST_2067: bitstring,TTL_2068: bitstring) = m2_2065 in
                                                                            {1884}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {1885}event endCli(Sess,Cli,PartS_2066)
                                                                )
                                                                else
                                                                    {1886}let pkSess_2069: bitstring = fail-any in
                                                                    {1887}out(c, GetEndpointRequest);
                                                                    {1888}in(c, (=GetEndpointResponse,=pkSess_2069,=SignAndEncrypt,SP_2070: bitstring,UP_2071: bitstring));
                                                                    {1889}new Nc_2072: bitstring;
                                                                    {1890}let gNc_2073: bitstring = exp(g,Nc_2072) in
                                                                    {1891}let m1_2074: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2073) in
                                                                    {1892}event beginCli(Cli,Sess,gNc_2073);
                                                                    {1893}out(c, (pkCli_1749,enc(m1_2074,pkSess_2069),sign(h(m1_2074),skCli_1748)));
                                                                    {1894}in(c, (em2_2075: bitstring,sigM2_2076: bitstring));
                                                                    {1895}let m2_2077: bitstring = dec(em2_2075,skCli_1748) in
                                                                    {1896}if (verify(h(m2_2077),sigM2_2076,pkSess_2069) <> true) then
                                                                        0
                                                                    else
                                                                        {1897}let (=OpenSecureChannelResponse,PartS_2078: bitstring,ST_2079: bitstring,TTL_2080: bitstring) = m2_2077 in
                                                                        {1898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1899}event endCli(Sess,Cli,PartS_2078)
                                                        )
                                                        else
                                                            {1900}let pkSess_2081: bitstring = fail-any in
                                                            {1901}out(c, GetEndpointRequest);
                                                            {1902}in(c, (=GetEndpointResponse,=pkSess_2081,=SignAndEncrypt,SP_2082: bitstring,UP_2083: bitstring));
                                                            {1903}new Nc_2084: bitstring;
                                                            {1904}let gNc_2085: bitstring = exp(g,Nc_2084) in
                                                            {1905}let m1_2086: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2085) in
                                                            {1906}event beginCli(Cli,Sess,gNc_2085);
                                                            {1907}out(c, (pkCli_1749,enc(m1_2086,pkSess_2081),sign(h(m1_2086),skCli_1748)));
                                                            {1908}in(c, (em2_2087: bitstring,sigM2_2088: bitstring));
                                                            {1909}let m2_2089: bitstring = dec(em2_2087,skCli_1748) in
                                                            {1910}if (verify(h(m2_2089),sigM2_2088,pkSess_2081) <> true) then
                                                                0
                                                            else
                                                                {1911}let (=OpenSecureChannelResponse,PartS_2090: bitstring,ST_2091: bitstring,TTL_2092: bitstring) = m2_2089 in
                                                                {1912}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1913}event endCli(Sess,Cli,PartS_2090)
                                                )
                                                else
                                                    {1914}let pkSess_2093: bitstring = fail-any in
                                                    {1915}out(c, GetEndpointRequest);
                                                    {1916}in(c, (=GetEndpointResponse,=pkSess_2093,=SignAndEncrypt,SP_2094: bitstring,UP_2095: bitstring));
                                                    {1917}new Nc_2096: bitstring;
                                                    {1918}let gNc_2097: bitstring = exp(g,Nc_2096) in
                                                    {1919}let m1_2098: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2097) in
                                                    {1920}event beginCli(Cli,Sess,gNc_2097);
                                                    {1921}out(c, (pkCli_1749,enc(m1_2098,pkSess_2093),sign(h(m1_2098),skCli_1748)));
                                                    {1922}in(c, (em2_2099: bitstring,sigM2_2100: bitstring));
                                                    {1923}let m2_2101: bitstring = dec(em2_2099,skCli_1748) in
                                                    {1924}if (verify(h(m2_2101),sigM2_2100,pkSess_2093) <> true) then
                                                        0
                                                    else
                                                        {1925}let (=OpenSecureChannelResponse,PartS_2102: bitstring,ST_2103: bitstring,TTL_2104: bitstring) = m2_2101 in
                                                        {1926}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1927}event endCli(Sess,Cli,PartS_2102)
                                        )
                                        else
                                            {1928}let pkDisco_2105: bitstring = fail-any in
                                            {1929}let v_2106: bool = (Sess = A) in
                                            (
                                                {1930}if v_2106 then
                                                (
                                                    {1931}let pkSess_2107: bitstring = pub(skA) in
                                                    {1932}out(c, GetEndpointRequest);
                                                    {1933}in(c, (=GetEndpointResponse,=pkSess_2107,=SignAndEncrypt,SP_2108: bitstring,UP_2109: bitstring));
                                                    {1934}new Nc_2110: bitstring;
                                                    {1935}let gNc_2111: bitstring = exp(g,Nc_2110) in
                                                    {1936}let m1_2112: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2111) in
                                                    {1937}event beginCli(Cli,Sess,gNc_2111);
                                                    {1938}out(c, (pkCli_1749,enc(m1_2112,pkSess_2107),sign(h(m1_2112),skCli_1748)));
                                                    {1939}in(c, (em2_2113: bitstring,sigM2_2114: bitstring));
                                                    {1940}let m2_2115: bitstring = dec(em2_2113,skCli_1748) in
                                                    {1941}if (verify(h(m2_2115),sigM2_2114,pkSess_2107) <> true) then
                                                        0
                                                    else
                                                        {1942}let (=OpenSecureChannelResponse,PartS_2116: bitstring,ST_2117: bitstring,TTL_2118: bitstring) = m2_2115 in
                                                        {1943}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1944}event endCli(Sess,Cli,PartS_2116)
                                                )
                                                else
                                                    {1945}let v_2119: bool = (Sess = B) in
                                                    (
                                                        {1946}if v_2119 then
                                                        (
                                                            {1947}let pkSess_2120: bitstring = pub(skB) in
                                                            {1948}out(c, GetEndpointRequest);
                                                            {1949}in(c, (=GetEndpointResponse,=pkSess_2120,=SignAndEncrypt,SP_2121: bitstring,UP_2122: bitstring));
                                                            {1950}new Nc_2123: bitstring;
                                                            {1951}let gNc_2124: bitstring = exp(g,Nc_2123) in
                                                            {1952}let m1_2125: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2124) in
                                                            {1953}event beginCli(Cli,Sess,gNc_2124);
                                                            {1954}out(c, (pkCli_1749,enc(m1_2125,pkSess_2120),sign(h(m1_2125),skCli_1748)));
                                                            {1955}in(c, (em2_2126: bitstring,sigM2_2127: bitstring));
                                                            {1956}let m2_2128: bitstring = dec(em2_2126,skCli_1748) in
                                                            {1957}if (verify(h(m2_2128),sigM2_2127,pkSess_2120) <> true) then
                                                                0
                                                            else
                                                                {1958}let (=OpenSecureChannelResponse,PartS_2129: bitstring,ST_2130: bitstring,TTL_2131: bitstring) = m2_2128 in
                                                                {1959}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1960}event endCli(Sess,Cli,PartS_2129)
                                                        )
                                                        else
                                                            {1961}let v_2132: bool = (Sess = C) in
                                                            (
                                                                {1962}if v_2132 then
                                                                (
                                                                    {1963}let pkSess_2133: bitstring = pub(skC) in
                                                                    {1964}out(c, GetEndpointRequest);
                                                                    {1965}in(c, (=GetEndpointResponse,=pkSess_2133,=SignAndEncrypt,SP_2134: bitstring,UP_2135: bitstring));
                                                                    {1966}new Nc_2136: bitstring;
                                                                    {1967}let gNc_2137: bitstring = exp(g,Nc_2136) in
                                                                    {1968}let m1_2138: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2137) in
                                                                    {1969}event beginCli(Cli,Sess,gNc_2137);
                                                                    {1970}out(c, (pkCli_1749,enc(m1_2138,pkSess_2133),sign(h(m1_2138),skCli_1748)));
                                                                    {1971}in(c, (em2_2139: bitstring,sigM2_2140: bitstring));
                                                                    {1972}let m2_2141: bitstring = dec(em2_2139,skCli_1748) in
                                                                    {1973}if (verify(h(m2_2141),sigM2_2140,pkSess_2133) <> true) then
                                                                        0
                                                                    else
                                                                        {1974}let (=OpenSecureChannelResponse,PartS_2142: bitstring,ST_2143: bitstring,TTL_2144: bitstring) = m2_2141 in
                                                                        {1975}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1976}event endCli(Sess,Cli,PartS_2142)
                                                                )
                                                                else
                                                                    {1977}let pkSess_2145: bitstring = pub(sk(Sess)) in
                                                                    {1978}out(c, GetEndpointRequest);
                                                                    {1979}in(c, (=GetEndpointResponse,=pkSess_2145,=SignAndEncrypt,SP_2146: bitstring,UP_2147: bitstring));
                                                                    {1980}new Nc_2148: bitstring;
                                                                    {1981}let gNc_2149: bitstring = exp(g,Nc_2148) in
                                                                    {1982}let m1_2150: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2149) in
                                                                    {1983}event beginCli(Cli,Sess,gNc_2149);
                                                                    {1984}out(c, (pkCli_1749,enc(m1_2150,pkSess_2145),sign(h(m1_2150),skCli_1748)));
                                                                    {1985}in(c, (em2_2151: bitstring,sigM2_2152: bitstring));
                                                                    {1986}let m2_2153: bitstring = dec(em2_2151,skCli_1748) in
                                                                    {1987}if (verify(h(m2_2153),sigM2_2152,pkSess_2145) <> true) then
                                                                        0
                                                                    else
                                                                        {1988}let (=OpenSecureChannelResponse,PartS_2154: bitstring,ST_2155: bitstring,TTL_2156: bitstring) = m2_2153 in
                                                                        {1989}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1990}event endCli(Sess,Cli,PartS_2154)
                                                            )
                                                            else
                                                                {1991}let pkSess_2157: bitstring = fail-any in
                                                                {1992}out(c, GetEndpointRequest);
                                                                {1993}in(c, (=GetEndpointResponse,=pkSess_2157,=SignAndEncrypt,SP_2158: bitstring,UP_2159: bitstring));
                                                                {1994}new Nc_2160: bitstring;
                                                                {1995}let gNc_2161: bitstring = exp(g,Nc_2160) in
                                                                {1996}let m1_2162: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2161) in
                                                                {1997}event beginCli(Cli,Sess,gNc_2161);
                                                                {1998}out(c, (pkCli_1749,enc(m1_2162,pkSess_2157),sign(h(m1_2162),skCli_1748)));
                                                                {1999}in(c, (em2_2163: bitstring,sigM2_2164: bitstring));
                                                                {2000}let m2_2165: bitstring = dec(em2_2163,skCli_1748) in
                                                                {2001}if (verify(h(m2_2165),sigM2_2164,pkSess_2157) <> true) then
                                                                    0
                                                                else
                                                                    {2002}let (=OpenSecureChannelResponse,PartS_2166: bitstring,ST_2167: bitstring,TTL_2168: bitstring) = m2_2165 in
                                                                    {2003}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2004}event endCli(Sess,Cli,PartS_2166)
                                                    )
                                                    else
                                                        {2005}let pkSess_2169: bitstring = fail-any in
                                                        {2006}out(c, GetEndpointRequest);
                                                        {2007}in(c, (=GetEndpointResponse,=pkSess_2169,=SignAndEncrypt,SP_2170: bitstring,UP_2171: bitstring));
                                                        {2008}new Nc_2172: bitstring;
                                                        {2009}let gNc_2173: bitstring = exp(g,Nc_2172) in
                                                        {2010}let m1_2174: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2173) in
                                                        {2011}event beginCli(Cli,Sess,gNc_2173);
                                                        {2012}out(c, (pkCli_1749,enc(m1_2174,pkSess_2169),sign(h(m1_2174),skCli_1748)));
                                                        {2013}in(c, (em2_2175: bitstring,sigM2_2176: bitstring));
                                                        {2014}let m2_2177: bitstring = dec(em2_2175,skCli_1748) in
                                                        {2015}if (verify(h(m2_2177),sigM2_2176,pkSess_2169) <> true) then
                                                            0
                                                        else
                                                            {2016}let (=OpenSecureChannelResponse,PartS_2178: bitstring,ST_2179: bitstring,TTL_2180: bitstring) = m2_2177 in
                                                            {2017}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2018}event endCli(Sess,Cli,PartS_2178)
                                            )
                                            else
                                                {2019}let pkSess_2181: bitstring = fail-any in
                                                {2020}out(c, GetEndpointRequest);
                                                {2021}in(c, (=GetEndpointResponse,=pkSess_2181,=SignAndEncrypt,SP_2182: bitstring,UP_2183: bitstring));
                                                {2022}new Nc_2184: bitstring;
                                                {2023}let gNc_2185: bitstring = exp(g,Nc_2184) in
                                                {2024}let m1_2186: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2185) in
                                                {2025}event beginCli(Cli,Sess,gNc_2185);
                                                {2026}out(c, (pkCli_1749,enc(m1_2186,pkSess_2181),sign(h(m1_2186),skCli_1748)));
                                                {2027}in(c, (em2_2187: bitstring,sigM2_2188: bitstring));
                                                {2028}let m2_2189: bitstring = dec(em2_2187,skCli_1748) in
                                                {2029}if (verify(h(m2_2189),sigM2_2188,pkSess_2181) <> true) then
                                                    0
                                                else
                                                    {2030}let (=OpenSecureChannelResponse,PartS_2190: bitstring,ST_2191: bitstring,TTL_2192: bitstring) = m2_2189 in
                                                    {2031}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2032}event endCli(Sess,Cli,PartS_2190)
                                )
                                else
                                    {2033}let pkDisco_2193: bitstring = fail-any in
                                    {2034}let v_2194: bool = (Sess = A) in
                                    (
                                        {2035}if v_2194 then
                                        (
                                            {2036}let pkSess_2195: bitstring = pub(skA) in
                                            {2037}out(c, GetEndpointRequest);
                                            {2038}in(c, (=GetEndpointResponse,=pkSess_2195,=SignAndEncrypt,SP_2196: bitstring,UP_2197: bitstring));
                                            {2039}new Nc_2198: bitstring;
                                            {2040}let gNc_2199: bitstring = exp(g,Nc_2198) in
                                            {2041}let m1_2200: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2199) in
                                            {2042}event beginCli(Cli,Sess,gNc_2199);
                                            {2043}out(c, (pkCli_1749,enc(m1_2200,pkSess_2195),sign(h(m1_2200),skCli_1748)));
                                            {2044}in(c, (em2_2201: bitstring,sigM2_2202: bitstring));
                                            {2045}let m2_2203: bitstring = dec(em2_2201,skCli_1748) in
                                            {2046}if (verify(h(m2_2203),sigM2_2202,pkSess_2195) <> true) then
                                                0
                                            else
                                                {2047}let (=OpenSecureChannelResponse,PartS_2204: bitstring,ST_2205: bitstring,TTL_2206: bitstring) = m2_2203 in
                                                {2048}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2049}event endCli(Sess,Cli,PartS_2204)
                                        )
                                        else
                                            {2050}let v_2207: bool = (Sess = B) in
                                            (
                                                {2051}if v_2207 then
                                                (
                                                    {2052}let pkSess_2208: bitstring = pub(skB) in
                                                    {2053}out(c, GetEndpointRequest);
                                                    {2054}in(c, (=GetEndpointResponse,=pkSess_2208,=SignAndEncrypt,SP_2209: bitstring,UP_2210: bitstring));
                                                    {2055}new Nc_2211: bitstring;
                                                    {2056}let gNc_2212: bitstring = exp(g,Nc_2211) in
                                                    {2057}let m1_2213: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2212) in
                                                    {2058}event beginCli(Cli,Sess,gNc_2212);
                                                    {2059}out(c, (pkCli_1749,enc(m1_2213,pkSess_2208),sign(h(m1_2213),skCli_1748)));
                                                    {2060}in(c, (em2_2214: bitstring,sigM2_2215: bitstring));
                                                    {2061}let m2_2216: bitstring = dec(em2_2214,skCli_1748) in
                                                    {2062}if (verify(h(m2_2216),sigM2_2215,pkSess_2208) <> true) then
                                                        0
                                                    else
                                                        {2063}let (=OpenSecureChannelResponse,PartS_2217: bitstring,ST_2218: bitstring,TTL_2219: bitstring) = m2_2216 in
                                                        {2064}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2065}event endCli(Sess,Cli,PartS_2217)
                                                )
                                                else
                                                    {2066}let v_2220: bool = (Sess = C) in
                                                    (
                                                        {2067}if v_2220 then
                                                        (
                                                            {2068}let pkSess_2221: bitstring = pub(skC) in
                                                            {2069}out(c, GetEndpointRequest);
                                                            {2070}in(c, (=GetEndpointResponse,=pkSess_2221,=SignAndEncrypt,SP_2222: bitstring,UP_2223: bitstring));
                                                            {2071}new Nc_2224: bitstring;
                                                            {2072}let gNc_2225: bitstring = exp(g,Nc_2224) in
                                                            {2073}let m1_2226: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2225) in
                                                            {2074}event beginCli(Cli,Sess,gNc_2225);
                                                            {2075}out(c, (pkCli_1749,enc(m1_2226,pkSess_2221),sign(h(m1_2226),skCli_1748)));
                                                            {2076}in(c, (em2_2227: bitstring,sigM2_2228: bitstring));
                                                            {2077}let m2_2229: bitstring = dec(em2_2227,skCli_1748) in
                                                            {2078}if (verify(h(m2_2229),sigM2_2228,pkSess_2221) <> true) then
                                                                0
                                                            else
                                                                {2079}let (=OpenSecureChannelResponse,PartS_2230: bitstring,ST_2231: bitstring,TTL_2232: bitstring) = m2_2229 in
                                                                {2080}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2081}event endCli(Sess,Cli,PartS_2230)
                                                        )
                                                        else
                                                            {2082}let pkSess_2233: bitstring = pub(sk(Sess)) in
                                                            {2083}out(c, GetEndpointRequest);
                                                            {2084}in(c, (=GetEndpointResponse,=pkSess_2233,=SignAndEncrypt,SP_2234: bitstring,UP_2235: bitstring));
                                                            {2085}new Nc_2236: bitstring;
                                                            {2086}let gNc_2237: bitstring = exp(g,Nc_2236) in
                                                            {2087}let m1_2238: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2237) in
                                                            {2088}event beginCli(Cli,Sess,gNc_2237);
                                                            {2089}out(c, (pkCli_1749,enc(m1_2238,pkSess_2233),sign(h(m1_2238),skCli_1748)));
                                                            {2090}in(c, (em2_2239: bitstring,sigM2_2240: bitstring));
                                                            {2091}let m2_2241: bitstring = dec(em2_2239,skCli_1748) in
                                                            {2092}if (verify(h(m2_2241),sigM2_2240,pkSess_2233) <> true) then
                                                                0
                                                            else
                                                                {2093}let (=OpenSecureChannelResponse,PartS_2242: bitstring,ST_2243: bitstring,TTL_2244: bitstring) = m2_2241 in
                                                                {2094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2095}event endCli(Sess,Cli,PartS_2242)
                                                    )
                                                    else
                                                        {2096}let pkSess_2245: bitstring = fail-any in
                                                        {2097}out(c, GetEndpointRequest);
                                                        {2098}in(c, (=GetEndpointResponse,=pkSess_2245,=SignAndEncrypt,SP_2246: bitstring,UP_2247: bitstring));
                                                        {2099}new Nc_2248: bitstring;
                                                        {2100}let gNc_2249: bitstring = exp(g,Nc_2248) in
                                                        {2101}let m1_2250: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2249) in
                                                        {2102}event beginCli(Cli,Sess,gNc_2249);
                                                        {2103}out(c, (pkCli_1749,enc(m1_2250,pkSess_2245),sign(h(m1_2250),skCli_1748)));
                                                        {2104}in(c, (em2_2251: bitstring,sigM2_2252: bitstring));
                                                        {2105}let m2_2253: bitstring = dec(em2_2251,skCli_1748) in
                                                        {2106}if (verify(h(m2_2253),sigM2_2252,pkSess_2245) <> true) then
                                                            0
                                                        else
                                                            {2107}let (=OpenSecureChannelResponse,PartS_2254: bitstring,ST_2255: bitstring,TTL_2256: bitstring) = m2_2253 in
                                                            {2108}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2109}event endCli(Sess,Cli,PartS_2254)
                                            )
                                            else
                                                {2110}let pkSess_2257: bitstring = fail-any in
                                                {2111}out(c, GetEndpointRequest);
                                                {2112}in(c, (=GetEndpointResponse,=pkSess_2257,=SignAndEncrypt,SP_2258: bitstring,UP_2259: bitstring));
                                                {2113}new Nc_2260: bitstring;
                                                {2114}let gNc_2261: bitstring = exp(g,Nc_2260) in
                                                {2115}let m1_2262: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2261) in
                                                {2116}event beginCli(Cli,Sess,gNc_2261);
                                                {2117}out(c, (pkCli_1749,enc(m1_2262,pkSess_2257),sign(h(m1_2262),skCli_1748)));
                                                {2118}in(c, (em2_2263: bitstring,sigM2_2264: bitstring));
                                                {2119}let m2_2265: bitstring = dec(em2_2263,skCli_1748) in
                                                {2120}if (verify(h(m2_2265),sigM2_2264,pkSess_2257) <> true) then
                                                    0
                                                else
                                                    {2121}let (=OpenSecureChannelResponse,PartS_2266: bitstring,ST_2267: bitstring,TTL_2268: bitstring) = m2_2265 in
                                                    {2122}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2123}event endCli(Sess,Cli,PartS_2266)
                                    )
                                    else
                                        {2124}let pkSess_2269: bitstring = fail-any in
                                        {2125}out(c, GetEndpointRequest);
                                        {2126}in(c, (=GetEndpointResponse,=pkSess_2269,=SignAndEncrypt,SP_2270: bitstring,UP_2271: bitstring));
                                        {2127}new Nc_2272: bitstring;
                                        {2128}let gNc_2273: bitstring = exp(g,Nc_2272) in
                                        {2129}let m1_2274: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2273) in
                                        {2130}event beginCli(Cli,Sess,gNc_2273);
                                        {2131}out(c, (pkCli_1749,enc(m1_2274,pkSess_2269),sign(h(m1_2274),skCli_1748)));
                                        {2132}in(c, (em2_2275: bitstring,sigM2_2276: bitstring));
                                        {2133}let m2_2277: bitstring = dec(em2_2275,skCli_1748) in
                                        {2134}if (verify(h(m2_2277),sigM2_2276,pkSess_2269) <> true) then
                                            0
                                        else
                                            {2135}let (=OpenSecureChannelResponse,PartS_2278: bitstring,ST_2279: bitstring,TTL_2280: bitstring) = m2_2277 in
                                            {2136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2137}event endCli(Sess,Cli,PartS_2278)
                        )
                        else
                            {2138}let pkDisco_2281: bitstring = fail-any in
                            {2139}let v_2282: bool = (Sess = A) in
                            (
                                {2140}if v_2282 then
                                (
                                    {2141}let pkSess_2283: bitstring = pub(skA) in
                                    {2142}out(c, GetEndpointRequest);
                                    {2143}in(c, (=GetEndpointResponse,=pkSess_2283,=SignAndEncrypt,SP_2284: bitstring,UP_2285: bitstring));
                                    {2144}new Nc_2286: bitstring;
                                    {2145}let gNc_2287: bitstring = exp(g,Nc_2286) in
                                    {2146}let m1_2288: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2287) in
                                    {2147}event beginCli(Cli,Sess,gNc_2287);
                                    {2148}out(c, (pkCli_1749,enc(m1_2288,pkSess_2283),sign(h(m1_2288),skCli_1748)));
                                    {2149}in(c, (em2_2289: bitstring,sigM2_2290: bitstring));
                                    {2150}let m2_2291: bitstring = dec(em2_2289,skCli_1748) in
                                    {2151}if (verify(h(m2_2291),sigM2_2290,pkSess_2283) <> true) then
                                        0
                                    else
                                        {2152}let (=OpenSecureChannelResponse,PartS_2292: bitstring,ST_2293: bitstring,TTL_2294: bitstring) = m2_2291 in
                                        {2153}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2154}event endCli(Sess,Cli,PartS_2292)
                                )
                                else
                                    {2155}let v_2295: bool = (Sess = B) in
                                    (
                                        {2156}if v_2295 then
                                        (
                                            {2157}let pkSess_2296: bitstring = pub(skB) in
                                            {2158}out(c, GetEndpointRequest);
                                            {2159}in(c, (=GetEndpointResponse,=pkSess_2296,=SignAndEncrypt,SP_2297: bitstring,UP_2298: bitstring));
                                            {2160}new Nc_2299: bitstring;
                                            {2161}let gNc_2300: bitstring = exp(g,Nc_2299) in
                                            {2162}let m1_2301: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2300) in
                                            {2163}event beginCli(Cli,Sess,gNc_2300);
                                            {2164}out(c, (pkCli_1749,enc(m1_2301,pkSess_2296),sign(h(m1_2301),skCli_1748)));
                                            {2165}in(c, (em2_2302: bitstring,sigM2_2303: bitstring));
                                            {2166}let m2_2304: bitstring = dec(em2_2302,skCli_1748) in
                                            {2167}if (verify(h(m2_2304),sigM2_2303,pkSess_2296) <> true) then
                                                0
                                            else
                                                {2168}let (=OpenSecureChannelResponse,PartS_2305: bitstring,ST_2306: bitstring,TTL_2307: bitstring) = m2_2304 in
                                                {2169}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2170}event endCli(Sess,Cli,PartS_2305)
                                        )
                                        else
                                            {2171}let v_2308: bool = (Sess = C) in
                                            (
                                                {2172}if v_2308 then
                                                (
                                                    {2173}let pkSess_2309: bitstring = pub(skC) in
                                                    {2174}out(c, GetEndpointRequest);
                                                    {2175}in(c, (=GetEndpointResponse,=pkSess_2309,=SignAndEncrypt,SP_2310: bitstring,UP_2311: bitstring));
                                                    {2176}new Nc_2312: bitstring;
                                                    {2177}let gNc_2313: bitstring = exp(g,Nc_2312) in
                                                    {2178}let m1_2314: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2313) in
                                                    {2179}event beginCli(Cli,Sess,gNc_2313);
                                                    {2180}out(c, (pkCli_1749,enc(m1_2314,pkSess_2309),sign(h(m1_2314),skCli_1748)));
                                                    {2181}in(c, (em2_2315: bitstring,sigM2_2316: bitstring));
                                                    {2182}let m2_2317: bitstring = dec(em2_2315,skCli_1748) in
                                                    {2183}if (verify(h(m2_2317),sigM2_2316,pkSess_2309) <> true) then
                                                        0
                                                    else
                                                        {2184}let (=OpenSecureChannelResponse,PartS_2318: bitstring,ST_2319: bitstring,TTL_2320: bitstring) = m2_2317 in
                                                        {2185}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2186}event endCli(Sess,Cli,PartS_2318)
                                                )
                                                else
                                                    {2187}let pkSess_2321: bitstring = pub(sk(Sess)) in
                                                    {2188}out(c, GetEndpointRequest);
                                                    {2189}in(c, (=GetEndpointResponse,=pkSess_2321,=SignAndEncrypt,SP_2322: bitstring,UP_2323: bitstring));
                                                    {2190}new Nc_2324: bitstring;
                                                    {2191}let gNc_2325: bitstring = exp(g,Nc_2324) in
                                                    {2192}let m1_2326: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2325) in
                                                    {2193}event beginCli(Cli,Sess,gNc_2325);
                                                    {2194}out(c, (pkCli_1749,enc(m1_2326,pkSess_2321),sign(h(m1_2326),skCli_1748)));
                                                    {2195}in(c, (em2_2327: bitstring,sigM2_2328: bitstring));
                                                    {2196}let m2_2329: bitstring = dec(em2_2327,skCli_1748) in
                                                    {2197}if (verify(h(m2_2329),sigM2_2328,pkSess_2321) <> true) then
                                                        0
                                                    else
                                                        {2198}let (=OpenSecureChannelResponse,PartS_2330: bitstring,ST_2331: bitstring,TTL_2332: bitstring) = m2_2329 in
                                                        {2199}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2200}event endCli(Sess,Cli,PartS_2330)
                                            )
                                            else
                                                {2201}let pkSess_2333: bitstring = fail-any in
                                                {2202}out(c, GetEndpointRequest);
                                                {2203}in(c, (=GetEndpointResponse,=pkSess_2333,=SignAndEncrypt,SP_2334: bitstring,UP_2335: bitstring));
                                                {2204}new Nc_2336: bitstring;
                                                {2205}let gNc_2337: bitstring = exp(g,Nc_2336) in
                                                {2206}let m1_2338: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2337) in
                                                {2207}event beginCli(Cli,Sess,gNc_2337);
                                                {2208}out(c, (pkCli_1749,enc(m1_2338,pkSess_2333),sign(h(m1_2338),skCli_1748)));
                                                {2209}in(c, (em2_2339: bitstring,sigM2_2340: bitstring));
                                                {2210}let m2_2341: bitstring = dec(em2_2339,skCli_1748) in
                                                {2211}if (verify(h(m2_2341),sigM2_2340,pkSess_2333) <> true) then
                                                    0
                                                else
                                                    {2212}let (=OpenSecureChannelResponse,PartS_2342: bitstring,ST_2343: bitstring,TTL_2344: bitstring) = m2_2341 in
                                                    {2213}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2214}event endCli(Sess,Cli,PartS_2342)
                                    )
                                    else
                                        {2215}let pkSess_2345: bitstring = fail-any in
                                        {2216}out(c, GetEndpointRequest);
                                        {2217}in(c, (=GetEndpointResponse,=pkSess_2345,=SignAndEncrypt,SP_2346: bitstring,UP_2347: bitstring));
                                        {2218}new Nc_2348: bitstring;
                                        {2219}let gNc_2349: bitstring = exp(g,Nc_2348) in
                                        {2220}let m1_2350: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2349) in
                                        {2221}event beginCli(Cli,Sess,gNc_2349);
                                        {2222}out(c, (pkCli_1749,enc(m1_2350,pkSess_2345),sign(h(m1_2350),skCli_1748)));
                                        {2223}in(c, (em2_2351: bitstring,sigM2_2352: bitstring));
                                        {2224}let m2_2353: bitstring = dec(em2_2351,skCli_1748) in
                                        {2225}if (verify(h(m2_2353),sigM2_2352,pkSess_2345) <> true) then
                                            0
                                        else
                                            {2226}let (=OpenSecureChannelResponse,PartS_2354: bitstring,ST_2355: bitstring,TTL_2356: bitstring) = m2_2353 in
                                            {2227}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2228}event endCli(Sess,Cli,PartS_2354)
                            )
                            else
                                {2229}let pkSess_2357: bitstring = fail-any in
                                {2230}out(c, GetEndpointRequest);
                                {2231}in(c, (=GetEndpointResponse,=pkSess_2357,=SignAndEncrypt,SP_2358: bitstring,UP_2359: bitstring));
                                {2232}new Nc_2360: bitstring;
                                {2233}let gNc_2361: bitstring = exp(g,Nc_2360) in
                                {2234}let m1_2362: bitstring = (OpenSecureChannelRequest,pkCli_1749,gNc_2361) in
                                {2235}event beginCli(Cli,Sess,gNc_2361);
                                {2236}out(c, (pkCli_1749,enc(m1_2362,pkSess_2357),sign(h(m1_2362),skCli_1748)));
                                {2237}in(c, (em2_2363: bitstring,sigM2_2364: bitstring));
                                {2238}let m2_2365: bitstring = dec(em2_2363,skCli_1748) in
                                {2239}if (verify(h(m2_2365),sigM2_2364,pkSess_2357) <> true) then
                                    0
                                else
                                    {2240}let (=OpenSecureChannelResponse,PartS_2366: bitstring,ST_2367: bitstring,TTL_2368: bitstring) = m2_2365 in
                                    {2241}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2242}event endCli(Sess,Cli,PartS_2366)
                    )
                    else
                        {2243}let skCli_2369: bitstring = fail-any in
                        {2244}let pkCli_2370: bitstring = pub(skCli_2369) in
                        {2245}let v_2371: bool = (Disco = A) in
                        (
                            {2246}if v_2371 then
                            (
                                {2247}let pkDisco_2372: bitstring = pub(skA) in
                                {2248}let v_2373: bool = (Sess = A) in
                                (
                                    {2249}if v_2373 then
                                    (
                                        {2250}let pkSess_2374: bitstring = pub(skA) in
                                        {2251}out(c, GetEndpointRequest);
                                        {2252}in(c, (=GetEndpointResponse,=pkSess_2374,=SignAndEncrypt,SP_2375: bitstring,UP_2376: bitstring));
                                        {2253}new Nc_2377: bitstring;
                                        {2254}let gNc_2378: bitstring = exp(g,Nc_2377) in
                                        {2255}let m1_2379: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2378) in
                                        {2256}event beginCli(Cli,Sess,gNc_2378);
                                        {2257}out(c, (pkCli_2370,enc(m1_2379,pkSess_2374),sign(h(m1_2379),skCli_2369)));
                                        {2258}in(c, (em2_2380: bitstring,sigM2_2381: bitstring));
                                        {2259}let m2_2382: bitstring = dec(em2_2380,skCli_2369) in
                                        {2260}if (verify(h(m2_2382),sigM2_2381,pkSess_2374) <> true) then
                                            0
                                        else
                                            {2261}let (=OpenSecureChannelResponse,PartS_2383: bitstring,ST_2384: bitstring,TTL_2385: bitstring) = m2_2382 in
                                            {2262}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2263}event endCli(Sess,Cli,PartS_2383)
                                    )
                                    else
                                        {2264}let v_2386: bool = (Sess = B) in
                                        (
                                            {2265}if v_2386 then
                                            (
                                                {2266}let pkSess_2387: bitstring = pub(skB) in
                                                {2267}out(c, GetEndpointRequest);
                                                {2268}in(c, (=GetEndpointResponse,=pkSess_2387,=SignAndEncrypt,SP_2388: bitstring,UP_2389: bitstring));
                                                {2269}new Nc_2390: bitstring;
                                                {2270}let gNc_2391: bitstring = exp(g,Nc_2390) in
                                                {2271}let m1_2392: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2391) in
                                                {2272}event beginCli(Cli,Sess,gNc_2391);
                                                {2273}out(c, (pkCli_2370,enc(m1_2392,pkSess_2387),sign(h(m1_2392),skCli_2369)));
                                                {2274}in(c, (em2_2393: bitstring,sigM2_2394: bitstring));
                                                {2275}let m2_2395: bitstring = dec(em2_2393,skCli_2369) in
                                                {2276}if (verify(h(m2_2395),sigM2_2394,pkSess_2387) <> true) then
                                                    0
                                                else
                                                    {2277}let (=OpenSecureChannelResponse,PartS_2396: bitstring,ST_2397: bitstring,TTL_2398: bitstring) = m2_2395 in
                                                    {2278}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2279}event endCli(Sess,Cli,PartS_2396)
                                            )
                                            else
                                                {2280}let v_2399: bool = (Sess = C) in
                                                (
                                                    {2281}if v_2399 then
                                                    (
                                                        {2282}let pkSess_2400: bitstring = pub(skC) in
                                                        {2283}out(c, GetEndpointRequest);
                                                        {2284}in(c, (=GetEndpointResponse,=pkSess_2400,=SignAndEncrypt,SP_2401: bitstring,UP_2402: bitstring));
                                                        {2285}new Nc_2403: bitstring;
                                                        {2286}let gNc_2404: bitstring = exp(g,Nc_2403) in
                                                        {2287}let m1_2405: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2404) in
                                                        {2288}event beginCli(Cli,Sess,gNc_2404);
                                                        {2289}out(c, (pkCli_2370,enc(m1_2405,pkSess_2400),sign(h(m1_2405),skCli_2369)));
                                                        {2290}in(c, (em2_2406: bitstring,sigM2_2407: bitstring));
                                                        {2291}let m2_2408: bitstring = dec(em2_2406,skCli_2369) in
                                                        {2292}if (verify(h(m2_2408),sigM2_2407,pkSess_2400) <> true) then
                                                            0
                                                        else
                                                            {2293}let (=OpenSecureChannelResponse,PartS_2409: bitstring,ST_2410: bitstring,TTL_2411: bitstring) = m2_2408 in
                                                            {2294}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2295}event endCli(Sess,Cli,PartS_2409)
                                                    )
                                                    else
                                                        {2296}let pkSess_2412: bitstring = pub(sk(Sess)) in
                                                        {2297}out(c, GetEndpointRequest);
                                                        {2298}in(c, (=GetEndpointResponse,=pkSess_2412,=SignAndEncrypt,SP_2413: bitstring,UP_2414: bitstring));
                                                        {2299}new Nc_2415: bitstring;
                                                        {2300}let gNc_2416: bitstring = exp(g,Nc_2415) in
                                                        {2301}let m1_2417: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2416) in
                                                        {2302}event beginCli(Cli,Sess,gNc_2416);
                                                        {2303}out(c, (pkCli_2370,enc(m1_2417,pkSess_2412),sign(h(m1_2417),skCli_2369)));
                                                        {2304}in(c, (em2_2418: bitstring,sigM2_2419: bitstring));
                                                        {2305}let m2_2420: bitstring = dec(em2_2418,skCli_2369) in
                                                        {2306}if (verify(h(m2_2420),sigM2_2419,pkSess_2412) <> true) then
                                                            0
                                                        else
                                                            {2307}let (=OpenSecureChannelResponse,PartS_2421: bitstring,ST_2422: bitstring,TTL_2423: bitstring) = m2_2420 in
                                                            {2308}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2309}event endCli(Sess,Cli,PartS_2421)
                                                )
                                                else
                                                    {2310}let pkSess_2424: bitstring = fail-any in
                                                    {2311}out(c, GetEndpointRequest);
                                                    {2312}in(c, (=GetEndpointResponse,=pkSess_2424,=SignAndEncrypt,SP_2425: bitstring,UP_2426: bitstring));
                                                    {2313}new Nc_2427: bitstring;
                                                    {2314}let gNc_2428: bitstring = exp(g,Nc_2427) in
                                                    {2315}let m1_2429: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2428) in
                                                    {2316}event beginCli(Cli,Sess,gNc_2428);
                                                    {2317}out(c, (pkCli_2370,enc(m1_2429,pkSess_2424),sign(h(m1_2429),skCli_2369)));
                                                    {2318}in(c, (em2_2430: bitstring,sigM2_2431: bitstring));
                                                    {2319}let m2_2432: bitstring = dec(em2_2430,skCli_2369) in
                                                    {2320}if (verify(h(m2_2432),sigM2_2431,pkSess_2424) <> true) then
                                                        0
                                                    else
                                                        {2321}let (=OpenSecureChannelResponse,PartS_2433: bitstring,ST_2434: bitstring,TTL_2435: bitstring) = m2_2432 in
                                                        {2322}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2323}event endCli(Sess,Cli,PartS_2433)
                                        )
                                        else
                                            {2324}let pkSess_2436: bitstring = fail-any in
                                            {2325}out(c, GetEndpointRequest);
                                            {2326}in(c, (=GetEndpointResponse,=pkSess_2436,=SignAndEncrypt,SP_2437: bitstring,UP_2438: bitstring));
                                            {2327}new Nc_2439: bitstring;
                                            {2328}let gNc_2440: bitstring = exp(g,Nc_2439) in
                                            {2329}let m1_2441: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2440) in
                                            {2330}event beginCli(Cli,Sess,gNc_2440);
                                            {2331}out(c, (pkCli_2370,enc(m1_2441,pkSess_2436),sign(h(m1_2441),skCli_2369)));
                                            {2332}in(c, (em2_2442: bitstring,sigM2_2443: bitstring));
                                            {2333}let m2_2444: bitstring = dec(em2_2442,skCli_2369) in
                                            {2334}if (verify(h(m2_2444),sigM2_2443,pkSess_2436) <> true) then
                                                0
                                            else
                                                {2335}let (=OpenSecureChannelResponse,PartS_2445: bitstring,ST_2446: bitstring,TTL_2447: bitstring) = m2_2444 in
                                                {2336}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2337}event endCli(Sess,Cli,PartS_2445)
                                )
                                else
                                    {2338}let pkSess_2448: bitstring = fail-any in
                                    {2339}out(c, GetEndpointRequest);
                                    {2340}in(c, (=GetEndpointResponse,=pkSess_2448,=SignAndEncrypt,SP_2449: bitstring,UP_2450: bitstring));
                                    {2341}new Nc_2451: bitstring;
                                    {2342}let gNc_2452: bitstring = exp(g,Nc_2451) in
                                    {2343}let m1_2453: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2452) in
                                    {2344}event beginCli(Cli,Sess,gNc_2452);
                                    {2345}out(c, (pkCli_2370,enc(m1_2453,pkSess_2448),sign(h(m1_2453),skCli_2369)));
                                    {2346}in(c, (em2_2454: bitstring,sigM2_2455: bitstring));
                                    {2347}let m2_2456: bitstring = dec(em2_2454,skCli_2369) in
                                    {2348}if (verify(h(m2_2456),sigM2_2455,pkSess_2448) <> true) then
                                        0
                                    else
                                        {2349}let (=OpenSecureChannelResponse,PartS_2457: bitstring,ST_2458: bitstring,TTL_2459: bitstring) = m2_2456 in
                                        {2350}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2351}event endCli(Sess,Cli,PartS_2457)
                            )
                            else
                                {2352}let v_2460: bool = (Disco = B) in
                                (
                                    {2353}if v_2460 then
                                    (
                                        {2354}let pkDisco_2461: bitstring = pub(skB) in
                                        {2355}let v_2462: bool = (Sess = A) in
                                        (
                                            {2356}if v_2462 then
                                            (
                                                {2357}let pkSess_2463: bitstring = pub(skA) in
                                                {2358}out(c, GetEndpointRequest);
                                                {2359}in(c, (=GetEndpointResponse,=pkSess_2463,=SignAndEncrypt,SP_2464: bitstring,UP_2465: bitstring));
                                                {2360}new Nc_2466: bitstring;
                                                {2361}let gNc_2467: bitstring = exp(g,Nc_2466) in
                                                {2362}let m1_2468: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2467) in
                                                {2363}event beginCli(Cli,Sess,gNc_2467);
                                                {2364}out(c, (pkCli_2370,enc(m1_2468,pkSess_2463),sign(h(m1_2468),skCli_2369)));
                                                {2365}in(c, (em2_2469: bitstring,sigM2_2470: bitstring));
                                                {2366}let m2_2471: bitstring = dec(em2_2469,skCli_2369) in
                                                {2367}if (verify(h(m2_2471),sigM2_2470,pkSess_2463) <> true) then
                                                    0
                                                else
                                                    {2368}let (=OpenSecureChannelResponse,PartS_2472: bitstring,ST_2473: bitstring,TTL_2474: bitstring) = m2_2471 in
                                                    {2369}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2370}event endCli(Sess,Cli,PartS_2472)
                                            )
                                            else
                                                {2371}let v_2475: bool = (Sess = B) in
                                                (
                                                    {2372}if v_2475 then
                                                    (
                                                        {2373}let pkSess_2476: bitstring = pub(skB) in
                                                        {2374}out(c, GetEndpointRequest);
                                                        {2375}in(c, (=GetEndpointResponse,=pkSess_2476,=SignAndEncrypt,SP_2477: bitstring,UP_2478: bitstring));
                                                        {2376}new Nc_2479: bitstring;
                                                        {2377}let gNc_2480: bitstring = exp(g,Nc_2479) in
                                                        {2378}let m1_2481: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2480) in
                                                        {2379}event beginCli(Cli,Sess,gNc_2480);
                                                        {2380}out(c, (pkCli_2370,enc(m1_2481,pkSess_2476),sign(h(m1_2481),skCli_2369)));
                                                        {2381}in(c, (em2_2482: bitstring,sigM2_2483: bitstring));
                                                        {2382}let m2_2484: bitstring = dec(em2_2482,skCli_2369) in
                                                        {2383}if (verify(h(m2_2484),sigM2_2483,pkSess_2476) <> true) then
                                                            0
                                                        else
                                                            {2384}let (=OpenSecureChannelResponse,PartS_2485: bitstring,ST_2486: bitstring,TTL_2487: bitstring) = m2_2484 in
                                                            {2385}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2386}event endCli(Sess,Cli,PartS_2485)
                                                    )
                                                    else
                                                        {2387}let v_2488: bool = (Sess = C) in
                                                        (
                                                            {2388}if v_2488 then
                                                            (
                                                                {2389}let pkSess_2489: bitstring = pub(skC) in
                                                                {2390}out(c, GetEndpointRequest);
                                                                {2391}in(c, (=GetEndpointResponse,=pkSess_2489,=SignAndEncrypt,SP_2490: bitstring,UP_2491: bitstring));
                                                                {2392}new Nc_2492: bitstring;
                                                                {2393}let gNc_2493: bitstring = exp(g,Nc_2492) in
                                                                {2394}let m1_2494: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2493) in
                                                                {2395}event beginCli(Cli,Sess,gNc_2493);
                                                                {2396}out(c, (pkCli_2370,enc(m1_2494,pkSess_2489),sign(h(m1_2494),skCli_2369)));
                                                                {2397}in(c, (em2_2495: bitstring,sigM2_2496: bitstring));
                                                                {2398}let m2_2497: bitstring = dec(em2_2495,skCli_2369) in
                                                                {2399}if (verify(h(m2_2497),sigM2_2496,pkSess_2489) <> true) then
                                                                    0
                                                                else
                                                                    {2400}let (=OpenSecureChannelResponse,PartS_2498: bitstring,ST_2499: bitstring,TTL_2500: bitstring) = m2_2497 in
                                                                    {2401}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2402}event endCli(Sess,Cli,PartS_2498)
                                                            )
                                                            else
                                                                {2403}let pkSess_2501: bitstring = pub(sk(Sess)) in
                                                                {2404}out(c, GetEndpointRequest);
                                                                {2405}in(c, (=GetEndpointResponse,=pkSess_2501,=SignAndEncrypt,SP_2502: bitstring,UP_2503: bitstring));
                                                                {2406}new Nc_2504: bitstring;
                                                                {2407}let gNc_2505: bitstring = exp(g,Nc_2504) in
                                                                {2408}let m1_2506: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2505) in
                                                                {2409}event beginCli(Cli,Sess,gNc_2505);
                                                                {2410}out(c, (pkCli_2370,enc(m1_2506,pkSess_2501),sign(h(m1_2506),skCli_2369)));
                                                                {2411}in(c, (em2_2507: bitstring,sigM2_2508: bitstring));
                                                                {2412}let m2_2509: bitstring = dec(em2_2507,skCli_2369) in
                                                                {2413}if (verify(h(m2_2509),sigM2_2508,pkSess_2501) <> true) then
                                                                    0
                                                                else
                                                                    {2414}let (=OpenSecureChannelResponse,PartS_2510: bitstring,ST_2511: bitstring,TTL_2512: bitstring) = m2_2509 in
                                                                    {2415}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2416}event endCli(Sess,Cli,PartS_2510)
                                                        )
                                                        else
                                                            {2417}let pkSess_2513: bitstring = fail-any in
                                                            {2418}out(c, GetEndpointRequest);
                                                            {2419}in(c, (=GetEndpointResponse,=pkSess_2513,=SignAndEncrypt,SP_2514: bitstring,UP_2515: bitstring));
                                                            {2420}new Nc_2516: bitstring;
                                                            {2421}let gNc_2517: bitstring = exp(g,Nc_2516) in
                                                            {2422}let m1_2518: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2517) in
                                                            {2423}event beginCli(Cli,Sess,gNc_2517);
                                                            {2424}out(c, (pkCli_2370,enc(m1_2518,pkSess_2513),sign(h(m1_2518),skCli_2369)));
                                                            {2425}in(c, (em2_2519: bitstring,sigM2_2520: bitstring));
                                                            {2426}let m2_2521: bitstring = dec(em2_2519,skCli_2369) in
                                                            {2427}if (verify(h(m2_2521),sigM2_2520,pkSess_2513) <> true) then
                                                                0
                                                            else
                                                                {2428}let (=OpenSecureChannelResponse,PartS_2522: bitstring,ST_2523: bitstring,TTL_2524: bitstring) = m2_2521 in
                                                                {2429}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2430}event endCli(Sess,Cli,PartS_2522)
                                                )
                                                else
                                                    {2431}let pkSess_2525: bitstring = fail-any in
                                                    {2432}out(c, GetEndpointRequest);
                                                    {2433}in(c, (=GetEndpointResponse,=pkSess_2525,=SignAndEncrypt,SP_2526: bitstring,UP_2527: bitstring));
                                                    {2434}new Nc_2528: bitstring;
                                                    {2435}let gNc_2529: bitstring = exp(g,Nc_2528) in
                                                    {2436}let m1_2530: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2529) in
                                                    {2437}event beginCli(Cli,Sess,gNc_2529);
                                                    {2438}out(c, (pkCli_2370,enc(m1_2530,pkSess_2525),sign(h(m1_2530),skCli_2369)));
                                                    {2439}in(c, (em2_2531: bitstring,sigM2_2532: bitstring));
                                                    {2440}let m2_2533: bitstring = dec(em2_2531,skCli_2369) in
                                                    {2441}if (verify(h(m2_2533),sigM2_2532,pkSess_2525) <> true) then
                                                        0
                                                    else
                                                        {2442}let (=OpenSecureChannelResponse,PartS_2534: bitstring,ST_2535: bitstring,TTL_2536: bitstring) = m2_2533 in
                                                        {2443}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2444}event endCli(Sess,Cli,PartS_2534)
                                        )
                                        else
                                            {2445}let pkSess_2537: bitstring = fail-any in
                                            {2446}out(c, GetEndpointRequest);
                                            {2447}in(c, (=GetEndpointResponse,=pkSess_2537,=SignAndEncrypt,SP_2538: bitstring,UP_2539: bitstring));
                                            {2448}new Nc_2540: bitstring;
                                            {2449}let gNc_2541: bitstring = exp(g,Nc_2540) in
                                            {2450}let m1_2542: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2541) in
                                            {2451}event beginCli(Cli,Sess,gNc_2541);
                                            {2452}out(c, (pkCli_2370,enc(m1_2542,pkSess_2537),sign(h(m1_2542),skCli_2369)));
                                            {2453}in(c, (em2_2543: bitstring,sigM2_2544: bitstring));
                                            {2454}let m2_2545: bitstring = dec(em2_2543,skCli_2369) in
                                            {2455}if (verify(h(m2_2545),sigM2_2544,pkSess_2537) <> true) then
                                                0
                                            else
                                                {2456}let (=OpenSecureChannelResponse,PartS_2546: bitstring,ST_2547: bitstring,TTL_2548: bitstring) = m2_2545 in
                                                {2457}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2458}event endCli(Sess,Cli,PartS_2546)
                                    )
                                    else
                                        {2459}let v_2549: bool = (Disco = C) in
                                        (
                                            {2460}if v_2549 then
                                            (
                                                {2461}let pkDisco_2550: bitstring = pub(skC) in
                                                {2462}let v_2551: bool = (Sess = A) in
                                                (
                                                    {2463}if v_2551 then
                                                    (
                                                        {2464}let pkSess_2552: bitstring = pub(skA) in
                                                        {2465}out(c, GetEndpointRequest);
                                                        {2466}in(c, (=GetEndpointResponse,=pkSess_2552,=SignAndEncrypt,SP_2553: bitstring,UP_2554: bitstring));
                                                        {2467}new Nc_2555: bitstring;
                                                        {2468}let gNc_2556: bitstring = exp(g,Nc_2555) in
                                                        {2469}let m1_2557: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2556) in
                                                        {2470}event beginCli(Cli,Sess,gNc_2556);
                                                        {2471}out(c, (pkCli_2370,enc(m1_2557,pkSess_2552),sign(h(m1_2557),skCli_2369)));
                                                        {2472}in(c, (em2_2558: bitstring,sigM2_2559: bitstring));
                                                        {2473}let m2_2560: bitstring = dec(em2_2558,skCli_2369) in
                                                        {2474}if (verify(h(m2_2560),sigM2_2559,pkSess_2552) <> true) then
                                                            0
                                                        else
                                                            {2475}let (=OpenSecureChannelResponse,PartS_2561: bitstring,ST_2562: bitstring,TTL_2563: bitstring) = m2_2560 in
                                                            {2476}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2477}event endCli(Sess,Cli,PartS_2561)
                                                    )
                                                    else
                                                        {2478}let v_2564: bool = (Sess = B) in
                                                        (
                                                            {2479}if v_2564 then
                                                            (
                                                                {2480}let pkSess_2565: bitstring = pub(skB) in
                                                                {2481}out(c, GetEndpointRequest);
                                                                {2482}in(c, (=GetEndpointResponse,=pkSess_2565,=SignAndEncrypt,SP_2566: bitstring,UP_2567: bitstring));
                                                                {2483}new Nc_2568: bitstring;
                                                                {2484}let gNc_2569: bitstring = exp(g,Nc_2568) in
                                                                {2485}let m1_2570: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2569) in
                                                                {2486}event beginCli(Cli,Sess,gNc_2569);
                                                                {2487}out(c, (pkCli_2370,enc(m1_2570,pkSess_2565),sign(h(m1_2570),skCli_2369)));
                                                                {2488}in(c, (em2_2571: bitstring,sigM2_2572: bitstring));
                                                                {2489}let m2_2573: bitstring = dec(em2_2571,skCli_2369) in
                                                                {2490}if (verify(h(m2_2573),sigM2_2572,pkSess_2565) <> true) then
                                                                    0
                                                                else
                                                                    {2491}let (=OpenSecureChannelResponse,PartS_2574: bitstring,ST_2575: bitstring,TTL_2576: bitstring) = m2_2573 in
                                                                    {2492}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2493}event endCli(Sess,Cli,PartS_2574)
                                                            )
                                                            else
                                                                {2494}let v_2577: bool = (Sess = C) in
                                                                (
                                                                    {2495}if v_2577 then
                                                                    (
                                                                        {2496}let pkSess_2578: bitstring = pub(skC) in
                                                                        {2497}out(c, GetEndpointRequest);
                                                                        {2498}in(c, (=GetEndpointResponse,=pkSess_2578,=SignAndEncrypt,SP_2579: bitstring,UP_2580: bitstring));
                                                                        {2499}new Nc_2581: bitstring;
                                                                        {2500}let gNc_2582: bitstring = exp(g,Nc_2581) in
                                                                        {2501}let m1_2583: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2582) in
                                                                        {2502}event beginCli(Cli,Sess,gNc_2582);
                                                                        {2503}out(c, (pkCli_2370,enc(m1_2583,pkSess_2578),sign(h(m1_2583),skCli_2369)));
                                                                        {2504}in(c, (em2_2584: bitstring,sigM2_2585: bitstring));
                                                                        {2505}let m2_2586: bitstring = dec(em2_2584,skCli_2369) in
                                                                        {2506}if (verify(h(m2_2586),sigM2_2585,pkSess_2578) <> true) then
                                                                            0
                                                                        else
                                                                            {2507}let (=OpenSecureChannelResponse,PartS_2587: bitstring,ST_2588: bitstring,TTL_2589: bitstring) = m2_2586 in
                                                                            {2508}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2509}event endCli(Sess,Cli,PartS_2587)
                                                                    )
                                                                    else
                                                                        {2510}let pkSess_2590: bitstring = pub(sk(Sess)) in
                                                                        {2511}out(c, GetEndpointRequest);
                                                                        {2512}in(c, (=GetEndpointResponse,=pkSess_2590,=SignAndEncrypt,SP_2591: bitstring,UP_2592: bitstring));
                                                                        {2513}new Nc_2593: bitstring;
                                                                        {2514}let gNc_2594: bitstring = exp(g,Nc_2593) in
                                                                        {2515}let m1_2595: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2594) in
                                                                        {2516}event beginCli(Cli,Sess,gNc_2594);
                                                                        {2517}out(c, (pkCli_2370,enc(m1_2595,pkSess_2590),sign(h(m1_2595),skCli_2369)));
                                                                        {2518}in(c, (em2_2596: bitstring,sigM2_2597: bitstring));
                                                                        {2519}let m2_2598: bitstring = dec(em2_2596,skCli_2369) in
                                                                        {2520}if (verify(h(m2_2598),sigM2_2597,pkSess_2590) <> true) then
                                                                            0
                                                                        else
                                                                            {2521}let (=OpenSecureChannelResponse,PartS_2599: bitstring,ST_2600: bitstring,TTL_2601: bitstring) = m2_2598 in
                                                                            {2522}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2523}event endCli(Sess,Cli,PartS_2599)
                                                                )
                                                                else
                                                                    {2524}let pkSess_2602: bitstring = fail-any in
                                                                    {2525}out(c, GetEndpointRequest);
                                                                    {2526}in(c, (=GetEndpointResponse,=pkSess_2602,=SignAndEncrypt,SP_2603: bitstring,UP_2604: bitstring));
                                                                    {2527}new Nc_2605: bitstring;
                                                                    {2528}let gNc_2606: bitstring = exp(g,Nc_2605) in
                                                                    {2529}let m1_2607: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2606) in
                                                                    {2530}event beginCli(Cli,Sess,gNc_2606);
                                                                    {2531}out(c, (pkCli_2370,enc(m1_2607,pkSess_2602),sign(h(m1_2607),skCli_2369)));
                                                                    {2532}in(c, (em2_2608: bitstring,sigM2_2609: bitstring));
                                                                    {2533}let m2_2610: bitstring = dec(em2_2608,skCli_2369) in
                                                                    {2534}if (verify(h(m2_2610),sigM2_2609,pkSess_2602) <> true) then
                                                                        0
                                                                    else
                                                                        {2535}let (=OpenSecureChannelResponse,PartS_2611: bitstring,ST_2612: bitstring,TTL_2613: bitstring) = m2_2610 in
                                                                        {2536}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2537}event endCli(Sess,Cli,PartS_2611)
                                                        )
                                                        else
                                                            {2538}let pkSess_2614: bitstring = fail-any in
                                                            {2539}out(c, GetEndpointRequest);
                                                            {2540}in(c, (=GetEndpointResponse,=pkSess_2614,=SignAndEncrypt,SP_2615: bitstring,UP_2616: bitstring));
                                                            {2541}new Nc_2617: bitstring;
                                                            {2542}let gNc_2618: bitstring = exp(g,Nc_2617) in
                                                            {2543}let m1_2619: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2618) in
                                                            {2544}event beginCli(Cli,Sess,gNc_2618);
                                                            {2545}out(c, (pkCli_2370,enc(m1_2619,pkSess_2614),sign(h(m1_2619),skCli_2369)));
                                                            {2546}in(c, (em2_2620: bitstring,sigM2_2621: bitstring));
                                                            {2547}let m2_2622: bitstring = dec(em2_2620,skCli_2369) in
                                                            {2548}if (verify(h(m2_2622),sigM2_2621,pkSess_2614) <> true) then
                                                                0
                                                            else
                                                                {2549}let (=OpenSecureChannelResponse,PartS_2623: bitstring,ST_2624: bitstring,TTL_2625: bitstring) = m2_2622 in
                                                                {2550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2551}event endCli(Sess,Cli,PartS_2623)
                                                )
                                                else
                                                    {2552}let pkSess_2626: bitstring = fail-any in
                                                    {2553}out(c, GetEndpointRequest);
                                                    {2554}in(c, (=GetEndpointResponse,=pkSess_2626,=SignAndEncrypt,SP_2627: bitstring,UP_2628: bitstring));
                                                    {2555}new Nc_2629: bitstring;
                                                    {2556}let gNc_2630: bitstring = exp(g,Nc_2629) in
                                                    {2557}let m1_2631: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2630) in
                                                    {2558}event beginCli(Cli,Sess,gNc_2630);
                                                    {2559}out(c, (pkCli_2370,enc(m1_2631,pkSess_2626),sign(h(m1_2631),skCli_2369)));
                                                    {2560}in(c, (em2_2632: bitstring,sigM2_2633: bitstring));
                                                    {2561}let m2_2634: bitstring = dec(em2_2632,skCli_2369) in
                                                    {2562}if (verify(h(m2_2634),sigM2_2633,pkSess_2626) <> true) then
                                                        0
                                                    else
                                                        {2563}let (=OpenSecureChannelResponse,PartS_2635: bitstring,ST_2636: bitstring,TTL_2637: bitstring) = m2_2634 in
                                                        {2564}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2565}event endCli(Sess,Cli,PartS_2635)
                                            )
                                            else
                                                {2566}let pkDisco_2638: bitstring = pub(sk(Disco)) in
                                                {2567}let v_2639: bool = (Sess = A) in
                                                (
                                                    {2568}if v_2639 then
                                                    (
                                                        {2569}let pkSess_2640: bitstring = pub(skA) in
                                                        {2570}out(c, GetEndpointRequest);
                                                        {2571}in(c, (=GetEndpointResponse,=pkSess_2640,=SignAndEncrypt,SP_2641: bitstring,UP_2642: bitstring));
                                                        {2572}new Nc_2643: bitstring;
                                                        {2573}let gNc_2644: bitstring = exp(g,Nc_2643) in
                                                        {2574}let m1_2645: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2644) in
                                                        {2575}event beginCli(Cli,Sess,gNc_2644);
                                                        {2576}out(c, (pkCli_2370,enc(m1_2645,pkSess_2640),sign(h(m1_2645),skCli_2369)));
                                                        {2577}in(c, (em2_2646: bitstring,sigM2_2647: bitstring));
                                                        {2578}let m2_2648: bitstring = dec(em2_2646,skCli_2369) in
                                                        {2579}if (verify(h(m2_2648),sigM2_2647,pkSess_2640) <> true) then
                                                            0
                                                        else
                                                            {2580}let (=OpenSecureChannelResponse,PartS_2649: bitstring,ST_2650: bitstring,TTL_2651: bitstring) = m2_2648 in
                                                            {2581}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2582}event endCli(Sess,Cli,PartS_2649)
                                                    )
                                                    else
                                                        {2583}let v_2652: bool = (Sess = B) in
                                                        (
                                                            {2584}if v_2652 then
                                                            (
                                                                {2585}let pkSess_2653: bitstring = pub(skB) in
                                                                {2586}out(c, GetEndpointRequest);
                                                                {2587}in(c, (=GetEndpointResponse,=pkSess_2653,=SignAndEncrypt,SP_2654: bitstring,UP_2655: bitstring));
                                                                {2588}new Nc_2656: bitstring;
                                                                {2589}let gNc_2657: bitstring = exp(g,Nc_2656) in
                                                                {2590}let m1_2658: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2657) in
                                                                {2591}event beginCli(Cli,Sess,gNc_2657);
                                                                {2592}out(c, (pkCli_2370,enc(m1_2658,pkSess_2653),sign(h(m1_2658),skCli_2369)));
                                                                {2593}in(c, (em2_2659: bitstring,sigM2_2660: bitstring));
                                                                {2594}let m2_2661: bitstring = dec(em2_2659,skCli_2369) in
                                                                {2595}if (verify(h(m2_2661),sigM2_2660,pkSess_2653) <> true) then
                                                                    0
                                                                else
                                                                    {2596}let (=OpenSecureChannelResponse,PartS_2662: bitstring,ST_2663: bitstring,TTL_2664: bitstring) = m2_2661 in
                                                                    {2597}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2598}event endCli(Sess,Cli,PartS_2662)
                                                            )
                                                            else
                                                                {2599}let v_2665: bool = (Sess = C) in
                                                                (
                                                                    {2600}if v_2665 then
                                                                    (
                                                                        {2601}let pkSess_2666: bitstring = pub(skC) in
                                                                        {2602}out(c, GetEndpointRequest);
                                                                        {2603}in(c, (=GetEndpointResponse,=pkSess_2666,=SignAndEncrypt,SP_2667: bitstring,UP_2668: bitstring));
                                                                        {2604}new Nc_2669: bitstring;
                                                                        {2605}let gNc_2670: bitstring = exp(g,Nc_2669) in
                                                                        {2606}let m1_2671: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2670) in
                                                                        {2607}event beginCli(Cli,Sess,gNc_2670);
                                                                        {2608}out(c, (pkCli_2370,enc(m1_2671,pkSess_2666),sign(h(m1_2671),skCli_2369)));
                                                                        {2609}in(c, (em2_2672: bitstring,sigM2_2673: bitstring));
                                                                        {2610}let m2_2674: bitstring = dec(em2_2672,skCli_2369) in
                                                                        {2611}if (verify(h(m2_2674),sigM2_2673,pkSess_2666) <> true) then
                                                                            0
                                                                        else
                                                                            {2612}let (=OpenSecureChannelResponse,PartS_2675: bitstring,ST_2676: bitstring,TTL_2677: bitstring) = m2_2674 in
                                                                            {2613}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2614}event endCli(Sess,Cli,PartS_2675)
                                                                    )
                                                                    else
                                                                        {2615}let pkSess_2678: bitstring = pub(sk(Sess)) in
                                                                        {2616}out(c, GetEndpointRequest);
                                                                        {2617}in(c, (=GetEndpointResponse,=pkSess_2678,=SignAndEncrypt,SP_2679: bitstring,UP_2680: bitstring));
                                                                        {2618}new Nc_2681: bitstring;
                                                                        {2619}let gNc_2682: bitstring = exp(g,Nc_2681) in
                                                                        {2620}let m1_2683: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2682) in
                                                                        {2621}event beginCli(Cli,Sess,gNc_2682);
                                                                        {2622}out(c, (pkCli_2370,enc(m1_2683,pkSess_2678),sign(h(m1_2683),skCli_2369)));
                                                                        {2623}in(c, (em2_2684: bitstring,sigM2_2685: bitstring));
                                                                        {2624}let m2_2686: bitstring = dec(em2_2684,skCli_2369) in
                                                                        {2625}if (verify(h(m2_2686),sigM2_2685,pkSess_2678) <> true) then
                                                                            0
                                                                        else
                                                                            {2626}let (=OpenSecureChannelResponse,PartS_2687: bitstring,ST_2688: bitstring,TTL_2689: bitstring) = m2_2686 in
                                                                            {2627}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                            {2628}event endCli(Sess,Cli,PartS_2687)
                                                                )
                                                                else
                                                                    {2629}let pkSess_2690: bitstring = fail-any in
                                                                    {2630}out(c, GetEndpointRequest);
                                                                    {2631}in(c, (=GetEndpointResponse,=pkSess_2690,=SignAndEncrypt,SP_2691: bitstring,UP_2692: bitstring));
                                                                    {2632}new Nc_2693: bitstring;
                                                                    {2633}let gNc_2694: bitstring = exp(g,Nc_2693) in
                                                                    {2634}let m1_2695: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2694) in
                                                                    {2635}event beginCli(Cli,Sess,gNc_2694);
                                                                    {2636}out(c, (pkCli_2370,enc(m1_2695,pkSess_2690),sign(h(m1_2695),skCli_2369)));
                                                                    {2637}in(c, (em2_2696: bitstring,sigM2_2697: bitstring));
                                                                    {2638}let m2_2698: bitstring = dec(em2_2696,skCli_2369) in
                                                                    {2639}if (verify(h(m2_2698),sigM2_2697,pkSess_2690) <> true) then
                                                                        0
                                                                    else
                                                                        {2640}let (=OpenSecureChannelResponse,PartS_2699: bitstring,ST_2700: bitstring,TTL_2701: bitstring) = m2_2698 in
                                                                        {2641}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2642}event endCli(Sess,Cli,PartS_2699)
                                                        )
                                                        else
                                                            {2643}let pkSess_2702: bitstring = fail-any in
                                                            {2644}out(c, GetEndpointRequest);
                                                            {2645}in(c, (=GetEndpointResponse,=pkSess_2702,=SignAndEncrypt,SP_2703: bitstring,UP_2704: bitstring));
                                                            {2646}new Nc_2705: bitstring;
                                                            {2647}let gNc_2706: bitstring = exp(g,Nc_2705) in
                                                            {2648}let m1_2707: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2706) in
                                                            {2649}event beginCli(Cli,Sess,gNc_2706);
                                                            {2650}out(c, (pkCli_2370,enc(m1_2707,pkSess_2702),sign(h(m1_2707),skCli_2369)));
                                                            {2651}in(c, (em2_2708: bitstring,sigM2_2709: bitstring));
                                                            {2652}let m2_2710: bitstring = dec(em2_2708,skCli_2369) in
                                                            {2653}if (verify(h(m2_2710),sigM2_2709,pkSess_2702) <> true) then
                                                                0
                                                            else
                                                                {2654}let (=OpenSecureChannelResponse,PartS_2711: bitstring,ST_2712: bitstring,TTL_2713: bitstring) = m2_2710 in
                                                                {2655}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2656}event endCli(Sess,Cli,PartS_2711)
                                                )
                                                else
                                                    {2657}let pkSess_2714: bitstring = fail-any in
                                                    {2658}out(c, GetEndpointRequest);
                                                    {2659}in(c, (=GetEndpointResponse,=pkSess_2714,=SignAndEncrypt,SP_2715: bitstring,UP_2716: bitstring));
                                                    {2660}new Nc_2717: bitstring;
                                                    {2661}let gNc_2718: bitstring = exp(g,Nc_2717) in
                                                    {2662}let m1_2719: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2718) in
                                                    {2663}event beginCli(Cli,Sess,gNc_2718);
                                                    {2664}out(c, (pkCli_2370,enc(m1_2719,pkSess_2714),sign(h(m1_2719),skCli_2369)));
                                                    {2665}in(c, (em2_2720: bitstring,sigM2_2721: bitstring));
                                                    {2666}let m2_2722: bitstring = dec(em2_2720,skCli_2369) in
                                                    {2667}if (verify(h(m2_2722),sigM2_2721,pkSess_2714) <> true) then
                                                        0
                                                    else
                                                        {2668}let (=OpenSecureChannelResponse,PartS_2723: bitstring,ST_2724: bitstring,TTL_2725: bitstring) = m2_2722 in
                                                        {2669}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2670}event endCli(Sess,Cli,PartS_2723)
                                        )
                                        else
                                            {2671}let pkDisco_2726: bitstring = fail-any in
                                            {2672}let v_2727: bool = (Sess = A) in
                                            (
                                                {2673}if v_2727 then
                                                (
                                                    {2674}let pkSess_2728: bitstring = pub(skA) in
                                                    {2675}out(c, GetEndpointRequest);
                                                    {2676}in(c, (=GetEndpointResponse,=pkSess_2728,=SignAndEncrypt,SP_2729: bitstring,UP_2730: bitstring));
                                                    {2677}new Nc_2731: bitstring;
                                                    {2678}let gNc_2732: bitstring = exp(g,Nc_2731) in
                                                    {2679}let m1_2733: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2732) in
                                                    {2680}event beginCli(Cli,Sess,gNc_2732);
                                                    {2681}out(c, (pkCli_2370,enc(m1_2733,pkSess_2728),sign(h(m1_2733),skCli_2369)));
                                                    {2682}in(c, (em2_2734: bitstring,sigM2_2735: bitstring));
                                                    {2683}let m2_2736: bitstring = dec(em2_2734,skCli_2369) in
                                                    {2684}if (verify(h(m2_2736),sigM2_2735,pkSess_2728) <> true) then
                                                        0
                                                    else
                                                        {2685}let (=OpenSecureChannelResponse,PartS_2737: bitstring,ST_2738: bitstring,TTL_2739: bitstring) = m2_2736 in
                                                        {2686}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2687}event endCli(Sess,Cli,PartS_2737)
                                                )
                                                else
                                                    {2688}let v_2740: bool = (Sess = B) in
                                                    (
                                                        {2689}if v_2740 then
                                                        (
                                                            {2690}let pkSess_2741: bitstring = pub(skB) in
                                                            {2691}out(c, GetEndpointRequest);
                                                            {2692}in(c, (=GetEndpointResponse,=pkSess_2741,=SignAndEncrypt,SP_2742: bitstring,UP_2743: bitstring));
                                                            {2693}new Nc_2744: bitstring;
                                                            {2694}let gNc_2745: bitstring = exp(g,Nc_2744) in
                                                            {2695}let m1_2746: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2745) in
                                                            {2696}event beginCli(Cli,Sess,gNc_2745);
                                                            {2697}out(c, (pkCli_2370,enc(m1_2746,pkSess_2741),sign(h(m1_2746),skCli_2369)));
                                                            {2698}in(c, (em2_2747: bitstring,sigM2_2748: bitstring));
                                                            {2699}let m2_2749: bitstring = dec(em2_2747,skCli_2369) in
                                                            {2700}if (verify(h(m2_2749),sigM2_2748,pkSess_2741) <> true) then
                                                                0
                                                            else
                                                                {2701}let (=OpenSecureChannelResponse,PartS_2750: bitstring,ST_2751: bitstring,TTL_2752: bitstring) = m2_2749 in
                                                                {2702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2703}event endCli(Sess,Cli,PartS_2750)
                                                        )
                                                        else
                                                            {2704}let v_2753: bool = (Sess = C) in
                                                            (
                                                                {2705}if v_2753 then
                                                                (
                                                                    {2706}let pkSess_2754: bitstring = pub(skC) in
                                                                    {2707}out(c, GetEndpointRequest);
                                                                    {2708}in(c, (=GetEndpointResponse,=pkSess_2754,=SignAndEncrypt,SP_2755: bitstring,UP_2756: bitstring));
                                                                    {2709}new Nc_2757: bitstring;
                                                                    {2710}let gNc_2758: bitstring = exp(g,Nc_2757) in
                                                                    {2711}let m1_2759: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2758) in
                                                                    {2712}event beginCli(Cli,Sess,gNc_2758);
                                                                    {2713}out(c, (pkCli_2370,enc(m1_2759,pkSess_2754),sign(h(m1_2759),skCli_2369)));
                                                                    {2714}in(c, (em2_2760: bitstring,sigM2_2761: bitstring));
                                                                    {2715}let m2_2762: bitstring = dec(em2_2760,skCli_2369) in
                                                                    {2716}if (verify(h(m2_2762),sigM2_2761,pkSess_2754) <> true) then
                                                                        0
                                                                    else
                                                                        {2717}let (=OpenSecureChannelResponse,PartS_2763: bitstring,ST_2764: bitstring,TTL_2765: bitstring) = m2_2762 in
                                                                        {2718}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2719}event endCli(Sess,Cli,PartS_2763)
                                                                )
                                                                else
                                                                    {2720}let pkSess_2766: bitstring = pub(sk(Sess)) in
                                                                    {2721}out(c, GetEndpointRequest);
                                                                    {2722}in(c, (=GetEndpointResponse,=pkSess_2766,=SignAndEncrypt,SP_2767: bitstring,UP_2768: bitstring));
                                                                    {2723}new Nc_2769: bitstring;
                                                                    {2724}let gNc_2770: bitstring = exp(g,Nc_2769) in
                                                                    {2725}let m1_2771: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2770) in
                                                                    {2726}event beginCli(Cli,Sess,gNc_2770);
                                                                    {2727}out(c, (pkCli_2370,enc(m1_2771,pkSess_2766),sign(h(m1_2771),skCli_2369)));
                                                                    {2728}in(c, (em2_2772: bitstring,sigM2_2773: bitstring));
                                                                    {2729}let m2_2774: bitstring = dec(em2_2772,skCli_2369) in
                                                                    {2730}if (verify(h(m2_2774),sigM2_2773,pkSess_2766) <> true) then
                                                                        0
                                                                    else
                                                                        {2731}let (=OpenSecureChannelResponse,PartS_2775: bitstring,ST_2776: bitstring,TTL_2777: bitstring) = m2_2774 in
                                                                        {2732}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2733}event endCli(Sess,Cli,PartS_2775)
                                                            )
                                                            else
                                                                {2734}let pkSess_2778: bitstring = fail-any in
                                                                {2735}out(c, GetEndpointRequest);
                                                                {2736}in(c, (=GetEndpointResponse,=pkSess_2778,=SignAndEncrypt,SP_2779: bitstring,UP_2780: bitstring));
                                                                {2737}new Nc_2781: bitstring;
                                                                {2738}let gNc_2782: bitstring = exp(g,Nc_2781) in
                                                                {2739}let m1_2783: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2782) in
                                                                {2740}event beginCli(Cli,Sess,gNc_2782);
                                                                {2741}out(c, (pkCli_2370,enc(m1_2783,pkSess_2778),sign(h(m1_2783),skCli_2369)));
                                                                {2742}in(c, (em2_2784: bitstring,sigM2_2785: bitstring));
                                                                {2743}let m2_2786: bitstring = dec(em2_2784,skCli_2369) in
                                                                {2744}if (verify(h(m2_2786),sigM2_2785,pkSess_2778) <> true) then
                                                                    0
                                                                else
                                                                    {2745}let (=OpenSecureChannelResponse,PartS_2787: bitstring,ST_2788: bitstring,TTL_2789: bitstring) = m2_2786 in
                                                                    {2746}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2747}event endCli(Sess,Cli,PartS_2787)
                                                    )
                                                    else
                                                        {2748}let pkSess_2790: bitstring = fail-any in
                                                        {2749}out(c, GetEndpointRequest);
                                                        {2750}in(c, (=GetEndpointResponse,=pkSess_2790,=SignAndEncrypt,SP_2791: bitstring,UP_2792: bitstring));
                                                        {2751}new Nc_2793: bitstring;
                                                        {2752}let gNc_2794: bitstring = exp(g,Nc_2793) in
                                                        {2753}let m1_2795: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2794) in
                                                        {2754}event beginCli(Cli,Sess,gNc_2794);
                                                        {2755}out(c, (pkCli_2370,enc(m1_2795,pkSess_2790),sign(h(m1_2795),skCli_2369)));
                                                        {2756}in(c, (em2_2796: bitstring,sigM2_2797: bitstring));
                                                        {2757}let m2_2798: bitstring = dec(em2_2796,skCli_2369) in
                                                        {2758}if (verify(h(m2_2798),sigM2_2797,pkSess_2790) <> true) then
                                                            0
                                                        else
                                                            {2759}let (=OpenSecureChannelResponse,PartS_2799: bitstring,ST_2800: bitstring,TTL_2801: bitstring) = m2_2798 in
                                                            {2760}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2761}event endCli(Sess,Cli,PartS_2799)
                                            )
                                            else
                                                {2762}let pkSess_2802: bitstring = fail-any in
                                                {2763}out(c, GetEndpointRequest);
                                                {2764}in(c, (=GetEndpointResponse,=pkSess_2802,=SignAndEncrypt,SP_2803: bitstring,UP_2804: bitstring));
                                                {2765}new Nc_2805: bitstring;
                                                {2766}let gNc_2806: bitstring = exp(g,Nc_2805) in
                                                {2767}let m1_2807: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2806) in
                                                {2768}event beginCli(Cli,Sess,gNc_2806);
                                                {2769}out(c, (pkCli_2370,enc(m1_2807,pkSess_2802),sign(h(m1_2807),skCli_2369)));
                                                {2770}in(c, (em2_2808: bitstring,sigM2_2809: bitstring));
                                                {2771}let m2_2810: bitstring = dec(em2_2808,skCli_2369) in
                                                {2772}if (verify(h(m2_2810),sigM2_2809,pkSess_2802) <> true) then
                                                    0
                                                else
                                                    {2773}let (=OpenSecureChannelResponse,PartS_2811: bitstring,ST_2812: bitstring,TTL_2813: bitstring) = m2_2810 in
                                                    {2774}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2775}event endCli(Sess,Cli,PartS_2811)
                                )
                                else
                                    {2776}let pkDisco_2814: bitstring = fail-any in
                                    {2777}let v_2815: bool = (Sess = A) in
                                    (
                                        {2778}if v_2815 then
                                        (
                                            {2779}let pkSess_2816: bitstring = pub(skA) in
                                            {2780}out(c, GetEndpointRequest);
                                            {2781}in(c, (=GetEndpointResponse,=pkSess_2816,=SignAndEncrypt,SP_2817: bitstring,UP_2818: bitstring));
                                            {2782}new Nc_2819: bitstring;
                                            {2783}let gNc_2820: bitstring = exp(g,Nc_2819) in
                                            {2784}let m1_2821: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2820) in
                                            {2785}event beginCli(Cli,Sess,gNc_2820);
                                            {2786}out(c, (pkCli_2370,enc(m1_2821,pkSess_2816),sign(h(m1_2821),skCli_2369)));
                                            {2787}in(c, (em2_2822: bitstring,sigM2_2823: bitstring));
                                            {2788}let m2_2824: bitstring = dec(em2_2822,skCli_2369) in
                                            {2789}if (verify(h(m2_2824),sigM2_2823,pkSess_2816) <> true) then
                                                0
                                            else
                                                {2790}let (=OpenSecureChannelResponse,PartS_2825: bitstring,ST_2826: bitstring,TTL_2827: bitstring) = m2_2824 in
                                                {2791}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2792}event endCli(Sess,Cli,PartS_2825)
                                        )
                                        else
                                            {2793}let v_2828: bool = (Sess = B) in
                                            (
                                                {2794}if v_2828 then
                                                (
                                                    {2795}let pkSess_2829: bitstring = pub(skB) in
                                                    {2796}out(c, GetEndpointRequest);
                                                    {2797}in(c, (=GetEndpointResponse,=pkSess_2829,=SignAndEncrypt,SP_2830: bitstring,UP_2831: bitstring));
                                                    {2798}new Nc_2832: bitstring;
                                                    {2799}let gNc_2833: bitstring = exp(g,Nc_2832) in
                                                    {2800}let m1_2834: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2833) in
                                                    {2801}event beginCli(Cli,Sess,gNc_2833);
                                                    {2802}out(c, (pkCli_2370,enc(m1_2834,pkSess_2829),sign(h(m1_2834),skCli_2369)));
                                                    {2803}in(c, (em2_2835: bitstring,sigM2_2836: bitstring));
                                                    {2804}let m2_2837: bitstring = dec(em2_2835,skCli_2369) in
                                                    {2805}if (verify(h(m2_2837),sigM2_2836,pkSess_2829) <> true) then
                                                        0
                                                    else
                                                        {2806}let (=OpenSecureChannelResponse,PartS_2838: bitstring,ST_2839: bitstring,TTL_2840: bitstring) = m2_2837 in
                                                        {2807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2808}event endCli(Sess,Cli,PartS_2838)
                                                )
                                                else
                                                    {2809}let v_2841: bool = (Sess = C) in
                                                    (
                                                        {2810}if v_2841 then
                                                        (
                                                            {2811}let pkSess_2842: bitstring = pub(skC) in
                                                            {2812}out(c, GetEndpointRequest);
                                                            {2813}in(c, (=GetEndpointResponse,=pkSess_2842,=SignAndEncrypt,SP_2843: bitstring,UP_2844: bitstring));
                                                            {2814}new Nc_2845: bitstring;
                                                            {2815}let gNc_2846: bitstring = exp(g,Nc_2845) in
                                                            {2816}let m1_2847: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2846) in
                                                            {2817}event beginCli(Cli,Sess,gNc_2846);
                                                            {2818}out(c, (pkCli_2370,enc(m1_2847,pkSess_2842),sign(h(m1_2847),skCli_2369)));
                                                            {2819}in(c, (em2_2848: bitstring,sigM2_2849: bitstring));
                                                            {2820}let m2_2850: bitstring = dec(em2_2848,skCli_2369) in
                                                            {2821}if (verify(h(m2_2850),sigM2_2849,pkSess_2842) <> true) then
                                                                0
                                                            else
                                                                {2822}let (=OpenSecureChannelResponse,PartS_2851: bitstring,ST_2852: bitstring,TTL_2853: bitstring) = m2_2850 in
                                                                {2823}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2824}event endCli(Sess,Cli,PartS_2851)
                                                        )
                                                        else
                                                            {2825}let pkSess_2854: bitstring = pub(sk(Sess)) in
                                                            {2826}out(c, GetEndpointRequest);
                                                            {2827}in(c, (=GetEndpointResponse,=pkSess_2854,=SignAndEncrypt,SP_2855: bitstring,UP_2856: bitstring));
                                                            {2828}new Nc_2857: bitstring;
                                                            {2829}let gNc_2858: bitstring = exp(g,Nc_2857) in
                                                            {2830}let m1_2859: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2858) in
                                                            {2831}event beginCli(Cli,Sess,gNc_2858);
                                                            {2832}out(c, (pkCli_2370,enc(m1_2859,pkSess_2854),sign(h(m1_2859),skCli_2369)));
                                                            {2833}in(c, (em2_2860: bitstring,sigM2_2861: bitstring));
                                                            {2834}let m2_2862: bitstring = dec(em2_2860,skCli_2369) in
                                                            {2835}if (verify(h(m2_2862),sigM2_2861,pkSess_2854) <> true) then
                                                                0
                                                            else
                                                                {2836}let (=OpenSecureChannelResponse,PartS_2863: bitstring,ST_2864: bitstring,TTL_2865: bitstring) = m2_2862 in
                                                                {2837}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2838}event endCli(Sess,Cli,PartS_2863)
                                                    )
                                                    else
                                                        {2839}let pkSess_2866: bitstring = fail-any in
                                                        {2840}out(c, GetEndpointRequest);
                                                        {2841}in(c, (=GetEndpointResponse,=pkSess_2866,=SignAndEncrypt,SP_2867: bitstring,UP_2868: bitstring));
                                                        {2842}new Nc_2869: bitstring;
                                                        {2843}let gNc_2870: bitstring = exp(g,Nc_2869) in
                                                        {2844}let m1_2871: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2870) in
                                                        {2845}event beginCli(Cli,Sess,gNc_2870);
                                                        {2846}out(c, (pkCli_2370,enc(m1_2871,pkSess_2866),sign(h(m1_2871),skCli_2369)));
                                                        {2847}in(c, (em2_2872: bitstring,sigM2_2873: bitstring));
                                                        {2848}let m2_2874: bitstring = dec(em2_2872,skCli_2369) in
                                                        {2849}if (verify(h(m2_2874),sigM2_2873,pkSess_2866) <> true) then
                                                            0
                                                        else
                                                            {2850}let (=OpenSecureChannelResponse,PartS_2875: bitstring,ST_2876: bitstring,TTL_2877: bitstring) = m2_2874 in
                                                            {2851}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2852}event endCli(Sess,Cli,PartS_2875)
                                            )
                                            else
                                                {2853}let pkSess_2878: bitstring = fail-any in
                                                {2854}out(c, GetEndpointRequest);
                                                {2855}in(c, (=GetEndpointResponse,=pkSess_2878,=SignAndEncrypt,SP_2879: bitstring,UP_2880: bitstring));
                                                {2856}new Nc_2881: bitstring;
                                                {2857}let gNc_2882: bitstring = exp(g,Nc_2881) in
                                                {2858}let m1_2883: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2882) in
                                                {2859}event beginCli(Cli,Sess,gNc_2882);
                                                {2860}out(c, (pkCli_2370,enc(m1_2883,pkSess_2878),sign(h(m1_2883),skCli_2369)));
                                                {2861}in(c, (em2_2884: bitstring,sigM2_2885: bitstring));
                                                {2862}let m2_2886: bitstring = dec(em2_2884,skCli_2369) in
                                                {2863}if (verify(h(m2_2886),sigM2_2885,pkSess_2878) <> true) then
                                                    0
                                                else
                                                    {2864}let (=OpenSecureChannelResponse,PartS_2887: bitstring,ST_2888: bitstring,TTL_2889: bitstring) = m2_2886 in
                                                    {2865}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2866}event endCli(Sess,Cli,PartS_2887)
                                    )
                                    else
                                        {2867}let pkSess_2890: bitstring = fail-any in
                                        {2868}out(c, GetEndpointRequest);
                                        {2869}in(c, (=GetEndpointResponse,=pkSess_2890,=SignAndEncrypt,SP_2891: bitstring,UP_2892: bitstring));
                                        {2870}new Nc_2893: bitstring;
                                        {2871}let gNc_2894: bitstring = exp(g,Nc_2893) in
                                        {2872}let m1_2895: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2894) in
                                        {2873}event beginCli(Cli,Sess,gNc_2894);
                                        {2874}out(c, (pkCli_2370,enc(m1_2895,pkSess_2890),sign(h(m1_2895),skCli_2369)));
                                        {2875}in(c, (em2_2896: bitstring,sigM2_2897: bitstring));
                                        {2876}let m2_2898: bitstring = dec(em2_2896,skCli_2369) in
                                        {2877}if (verify(h(m2_2898),sigM2_2897,pkSess_2890) <> true) then
                                            0
                                        else
                                            {2878}let (=OpenSecureChannelResponse,PartS_2899: bitstring,ST_2900: bitstring,TTL_2901: bitstring) = m2_2898 in
                                            {2879}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2880}event endCli(Sess,Cli,PartS_2899)
                        )
                        else
                            {2881}let pkDisco_2902: bitstring = fail-any in
                            {2882}let v_2903: bool = (Sess = A) in
                            (
                                {2883}if v_2903 then
                                (
                                    {2884}let pkSess_2904: bitstring = pub(skA) in
                                    {2885}out(c, GetEndpointRequest);
                                    {2886}in(c, (=GetEndpointResponse,=pkSess_2904,=SignAndEncrypt,SP_2905: bitstring,UP_2906: bitstring));
                                    {2887}new Nc_2907: bitstring;
                                    {2888}let gNc_2908: bitstring = exp(g,Nc_2907) in
                                    {2889}let m1_2909: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2908) in
                                    {2890}event beginCli(Cli,Sess,gNc_2908);
                                    {2891}out(c, (pkCli_2370,enc(m1_2909,pkSess_2904),sign(h(m1_2909),skCli_2369)));
                                    {2892}in(c, (em2_2910: bitstring,sigM2_2911: bitstring));
                                    {2893}let m2_2912: bitstring = dec(em2_2910,skCli_2369) in
                                    {2894}if (verify(h(m2_2912),sigM2_2911,pkSess_2904) <> true) then
                                        0
                                    else
                                        {2895}let (=OpenSecureChannelResponse,PartS_2913: bitstring,ST_2914: bitstring,TTL_2915: bitstring) = m2_2912 in
                                        {2896}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2897}event endCli(Sess,Cli,PartS_2913)
                                )
                                else
                                    {2898}let v_2916: bool = (Sess = B) in
                                    (
                                        {2899}if v_2916 then
                                        (
                                            {2900}let pkSess_2917: bitstring = pub(skB) in
                                            {2901}out(c, GetEndpointRequest);
                                            {2902}in(c, (=GetEndpointResponse,=pkSess_2917,=SignAndEncrypt,SP_2918: bitstring,UP_2919: bitstring));
                                            {2903}new Nc_2920: bitstring;
                                            {2904}let gNc_2921: bitstring = exp(g,Nc_2920) in
                                            {2905}let m1_2922: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2921) in
                                            {2906}event beginCli(Cli,Sess,gNc_2921);
                                            {2907}out(c, (pkCli_2370,enc(m1_2922,pkSess_2917),sign(h(m1_2922),skCli_2369)));
                                            {2908}in(c, (em2_2923: bitstring,sigM2_2924: bitstring));
                                            {2909}let m2_2925: bitstring = dec(em2_2923,skCli_2369) in
                                            {2910}if (verify(h(m2_2925),sigM2_2924,pkSess_2917) <> true) then
                                                0
                                            else
                                                {2911}let (=OpenSecureChannelResponse,PartS_2926: bitstring,ST_2927: bitstring,TTL_2928: bitstring) = m2_2925 in
                                                {2912}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2913}event endCli(Sess,Cli,PartS_2926)
                                        )
                                        else
                                            {2914}let v_2929: bool = (Sess = C) in
                                            (
                                                {2915}if v_2929 then
                                                (
                                                    {2916}let pkSess_2930: bitstring = pub(skC) in
                                                    {2917}out(c, GetEndpointRequest);
                                                    {2918}in(c, (=GetEndpointResponse,=pkSess_2930,=SignAndEncrypt,SP_2931: bitstring,UP_2932: bitstring));
                                                    {2919}new Nc_2933: bitstring;
                                                    {2920}let gNc_2934: bitstring = exp(g,Nc_2933) in
                                                    {2921}let m1_2935: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2934) in
                                                    {2922}event beginCli(Cli,Sess,gNc_2934);
                                                    {2923}out(c, (pkCli_2370,enc(m1_2935,pkSess_2930),sign(h(m1_2935),skCli_2369)));
                                                    {2924}in(c, (em2_2936: bitstring,sigM2_2937: bitstring));
                                                    {2925}let m2_2938: bitstring = dec(em2_2936,skCli_2369) in
                                                    {2926}if (verify(h(m2_2938),sigM2_2937,pkSess_2930) <> true) then
                                                        0
                                                    else
                                                        {2927}let (=OpenSecureChannelResponse,PartS_2939: bitstring,ST_2940: bitstring,TTL_2941: bitstring) = m2_2938 in
                                                        {2928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2929}event endCli(Sess,Cli,PartS_2939)
                                                )
                                                else
                                                    {2930}let pkSess_2942: bitstring = pub(sk(Sess)) in
                                                    {2931}out(c, GetEndpointRequest);
                                                    {2932}in(c, (=GetEndpointResponse,=pkSess_2942,=SignAndEncrypt,SP_2943: bitstring,UP_2944: bitstring));
                                                    {2933}new Nc_2945: bitstring;
                                                    {2934}let gNc_2946: bitstring = exp(g,Nc_2945) in
                                                    {2935}let m1_2947: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2946) in
                                                    {2936}event beginCli(Cli,Sess,gNc_2946);
                                                    {2937}out(c, (pkCli_2370,enc(m1_2947,pkSess_2942),sign(h(m1_2947),skCli_2369)));
                                                    {2938}in(c, (em2_2948: bitstring,sigM2_2949: bitstring));
                                                    {2939}let m2_2950: bitstring = dec(em2_2948,skCli_2369) in
                                                    {2940}if (verify(h(m2_2950),sigM2_2949,pkSess_2942) <> true) then
                                                        0
                                                    else
                                                        {2941}let (=OpenSecureChannelResponse,PartS_2951: bitstring,ST_2952: bitstring,TTL_2953: bitstring) = m2_2950 in
                                                        {2942}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2943}event endCli(Sess,Cli,PartS_2951)
                                            )
                                            else
                                                {2944}let pkSess_2954: bitstring = fail-any in
                                                {2945}out(c, GetEndpointRequest);
                                                {2946}in(c, (=GetEndpointResponse,=pkSess_2954,=SignAndEncrypt,SP_2955: bitstring,UP_2956: bitstring));
                                                {2947}new Nc_2957: bitstring;
                                                {2948}let gNc_2958: bitstring = exp(g,Nc_2957) in
                                                {2949}let m1_2959: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2958) in
                                                {2950}event beginCli(Cli,Sess,gNc_2958);
                                                {2951}out(c, (pkCli_2370,enc(m1_2959,pkSess_2954),sign(h(m1_2959),skCli_2369)));
                                                {2952}in(c, (em2_2960: bitstring,sigM2_2961: bitstring));
                                                {2953}let m2_2962: bitstring = dec(em2_2960,skCli_2369) in
                                                {2954}if (verify(h(m2_2962),sigM2_2961,pkSess_2954) <> true) then
                                                    0
                                                else
                                                    {2955}let (=OpenSecureChannelResponse,PartS_2963: bitstring,ST_2964: bitstring,TTL_2965: bitstring) = m2_2962 in
                                                    {2956}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2957}event endCli(Sess,Cli,PartS_2963)
                                    )
                                    else
                                        {2958}let pkSess_2966: bitstring = fail-any in
                                        {2959}out(c, GetEndpointRequest);
                                        {2960}in(c, (=GetEndpointResponse,=pkSess_2966,=SignAndEncrypt,SP_2967: bitstring,UP_2968: bitstring));
                                        {2961}new Nc_2969: bitstring;
                                        {2962}let gNc_2970: bitstring = exp(g,Nc_2969) in
                                        {2963}let m1_2971: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2970) in
                                        {2964}event beginCli(Cli,Sess,gNc_2970);
                                        {2965}out(c, (pkCli_2370,enc(m1_2971,pkSess_2966),sign(h(m1_2971),skCli_2369)));
                                        {2966}in(c, (em2_2972: bitstring,sigM2_2973: bitstring));
                                        {2967}let m2_2974: bitstring = dec(em2_2972,skCli_2369) in
                                        {2968}if (verify(h(m2_2974),sigM2_2973,pkSess_2966) <> true) then
                                            0
                                        else
                                            {2969}let (=OpenSecureChannelResponse,PartS_2975: bitstring,ST_2976: bitstring,TTL_2977: bitstring) = m2_2974 in
                                            {2970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2971}event endCli(Sess,Cli,PartS_2975)
                            )
                            else
                                {2972}let pkSess_2978: bitstring = fail-any in
                                {2973}out(c, GetEndpointRequest);
                                {2974}in(c, (=GetEndpointResponse,=pkSess_2978,=SignAndEncrypt,SP_2979: bitstring,UP_2980: bitstring));
                                {2975}new Nc_2981: bitstring;
                                {2976}let gNc_2982: bitstring = exp(g,Nc_2981) in
                                {2977}let m1_2983: bitstring = (OpenSecureChannelRequest,pkCli_2370,gNc_2982) in
                                {2978}event beginCli(Cli,Sess,gNc_2982);
                                {2979}out(c, (pkCli_2370,enc(m1_2983,pkSess_2978),sign(h(m1_2983),skCli_2369)));
                                {2980}in(c, (em2_2984: bitstring,sigM2_2985: bitstring));
                                {2981}let m2_2986: bitstring = dec(em2_2984,skCli_2369) in
                                {2982}if (verify(h(m2_2986),sigM2_2985,pkSess_2978) <> true) then
                                    0
                                else
                                    {2983}let (=OpenSecureChannelResponse,PartS_2987: bitstring,ST_2988: bitstring,TTL_2989: bitstring) = m2_2986 in
                                    {2984}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2985}event endCli(Sess,Cli,PartS_2987)
            )
            else
                {2986}let skCli_2990: bitstring = fail-any in
                {2987}let pkCli_2991: bitstring = pub(skCli_2990) in
                {2988}let v_2992: bool = (Disco = A) in
                (
                    {2989}if v_2992 then
                    (
                        {2990}let pkDisco_2993: bitstring = pub(skA) in
                        {2991}let v_2994: bool = (Sess = A) in
                        (
                            {2992}if v_2994 then
                            (
                                {2993}let pkSess_2995: bitstring = pub(skA) in
                                {2994}out(c, GetEndpointRequest);
                                {2995}in(c, (=GetEndpointResponse,=pkSess_2995,=SignAndEncrypt,SP_2996: bitstring,UP_2997: bitstring));
                                {2996}new Nc_2998: bitstring;
                                {2997}let gNc_2999: bitstring = exp(g,Nc_2998) in
                                {2998}let m1_3000: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_2999) in
                                {2999}event beginCli(Cli,Sess,gNc_2999);
                                {3000}out(c, (pkCli_2991,enc(m1_3000,pkSess_2995),sign(h(m1_3000),skCli_2990)));
                                {3001}in(c, (em2_3001: bitstring,sigM2_3002: bitstring));
                                {3002}let m2_3003: bitstring = dec(em2_3001,skCli_2990) in
                                {3003}if (verify(h(m2_3003),sigM2_3002,pkSess_2995) <> true) then
                                    0
                                else
                                    {3004}let (=OpenSecureChannelResponse,PartS_3004: bitstring,ST_3005: bitstring,TTL_3006: bitstring) = m2_3003 in
                                    {3005}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3006}event endCli(Sess,Cli,PartS_3004)
                            )
                            else
                                {3007}let v_3007: bool = (Sess = B) in
                                (
                                    {3008}if v_3007 then
                                    (
                                        {3009}let pkSess_3008: bitstring = pub(skB) in
                                        {3010}out(c, GetEndpointRequest);
                                        {3011}in(c, (=GetEndpointResponse,=pkSess_3008,=SignAndEncrypt,SP_3009: bitstring,UP_3010: bitstring));
                                        {3012}new Nc_3011: bitstring;
                                        {3013}let gNc_3012: bitstring = exp(g,Nc_3011) in
                                        {3014}let m1_3013: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3012) in
                                        {3015}event beginCli(Cli,Sess,gNc_3012);
                                        {3016}out(c, (pkCli_2991,enc(m1_3013,pkSess_3008),sign(h(m1_3013),skCli_2990)));
                                        {3017}in(c, (em2_3014: bitstring,sigM2_3015: bitstring));
                                        {3018}let m2_3016: bitstring = dec(em2_3014,skCli_2990) in
                                        {3019}if (verify(h(m2_3016),sigM2_3015,pkSess_3008) <> true) then
                                            0
                                        else
                                            {3020}let (=OpenSecureChannelResponse,PartS_3017: bitstring,ST_3018: bitstring,TTL_3019: bitstring) = m2_3016 in
                                            {3021}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3022}event endCli(Sess,Cli,PartS_3017)
                                    )
                                    else
                                        {3023}let v_3020: bool = (Sess = C) in
                                        (
                                            {3024}if v_3020 then
                                            (
                                                {3025}let pkSess_3021: bitstring = pub(skC) in
                                                {3026}out(c, GetEndpointRequest);
                                                {3027}in(c, (=GetEndpointResponse,=pkSess_3021,=SignAndEncrypt,SP_3022: bitstring,UP_3023: bitstring));
                                                {3028}new Nc_3024: bitstring;
                                                {3029}let gNc_3025: bitstring = exp(g,Nc_3024) in
                                                {3030}let m1_3026: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3025) in
                                                {3031}event beginCli(Cli,Sess,gNc_3025);
                                                {3032}out(c, (pkCli_2991,enc(m1_3026,pkSess_3021),sign(h(m1_3026),skCli_2990)));
                                                {3033}in(c, (em2_3027: bitstring,sigM2_3028: bitstring));
                                                {3034}let m2_3029: bitstring = dec(em2_3027,skCli_2990) in
                                                {3035}if (verify(h(m2_3029),sigM2_3028,pkSess_3021) <> true) then
                                                    0
                                                else
                                                    {3036}let (=OpenSecureChannelResponse,PartS_3030: bitstring,ST_3031: bitstring,TTL_3032: bitstring) = m2_3029 in
                                                    {3037}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3038}event endCli(Sess,Cli,PartS_3030)
                                            )
                                            else
                                                {3039}let pkSess_3033: bitstring = pub(sk(Sess)) in
                                                {3040}out(c, GetEndpointRequest);
                                                {3041}in(c, (=GetEndpointResponse,=pkSess_3033,=SignAndEncrypt,SP_3034: bitstring,UP_3035: bitstring));
                                                {3042}new Nc_3036: bitstring;
                                                {3043}let gNc_3037: bitstring = exp(g,Nc_3036) in
                                                {3044}let m1_3038: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3037) in
                                                {3045}event beginCli(Cli,Sess,gNc_3037);
                                                {3046}out(c, (pkCli_2991,enc(m1_3038,pkSess_3033),sign(h(m1_3038),skCli_2990)));
                                                {3047}in(c, (em2_3039: bitstring,sigM2_3040: bitstring));
                                                {3048}let m2_3041: bitstring = dec(em2_3039,skCli_2990) in
                                                {3049}if (verify(h(m2_3041),sigM2_3040,pkSess_3033) <> true) then
                                                    0
                                                else
                                                    {3050}let (=OpenSecureChannelResponse,PartS_3042: bitstring,ST_3043: bitstring,TTL_3044: bitstring) = m2_3041 in
                                                    {3051}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3052}event endCli(Sess,Cli,PartS_3042)
                                        )
                                        else
                                            {3053}let pkSess_3045: bitstring = fail-any in
                                            {3054}out(c, GetEndpointRequest);
                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3045,=SignAndEncrypt,SP_3046: bitstring,UP_3047: bitstring));
                                            {3056}new Nc_3048: bitstring;
                                            {3057}let gNc_3049: bitstring = exp(g,Nc_3048) in
                                            {3058}let m1_3050: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3049) in
                                            {3059}event beginCli(Cli,Sess,gNc_3049);
                                            {3060}out(c, (pkCli_2991,enc(m1_3050,pkSess_3045),sign(h(m1_3050),skCli_2990)));
                                            {3061}in(c, (em2_3051: bitstring,sigM2_3052: bitstring));
                                            {3062}let m2_3053: bitstring = dec(em2_3051,skCli_2990) in
                                            {3063}if (verify(h(m2_3053),sigM2_3052,pkSess_3045) <> true) then
                                                0
                                            else
                                                {3064}let (=OpenSecureChannelResponse,PartS_3054: bitstring,ST_3055: bitstring,TTL_3056: bitstring) = m2_3053 in
                                                {3065}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3066}event endCli(Sess,Cli,PartS_3054)
                                )
                                else
                                    {3067}let pkSess_3057: bitstring = fail-any in
                                    {3068}out(c, GetEndpointRequest);
                                    {3069}in(c, (=GetEndpointResponse,=pkSess_3057,=SignAndEncrypt,SP_3058: bitstring,UP_3059: bitstring));
                                    {3070}new Nc_3060: bitstring;
                                    {3071}let gNc_3061: bitstring = exp(g,Nc_3060) in
                                    {3072}let m1_3062: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3061) in
                                    {3073}event beginCli(Cli,Sess,gNc_3061);
                                    {3074}out(c, (pkCli_2991,enc(m1_3062,pkSess_3057),sign(h(m1_3062),skCli_2990)));
                                    {3075}in(c, (em2_3063: bitstring,sigM2_3064: bitstring));
                                    {3076}let m2_3065: bitstring = dec(em2_3063,skCli_2990) in
                                    {3077}if (verify(h(m2_3065),sigM2_3064,pkSess_3057) <> true) then
                                        0
                                    else
                                        {3078}let (=OpenSecureChannelResponse,PartS_3066: bitstring,ST_3067: bitstring,TTL_3068: bitstring) = m2_3065 in
                                        {3079}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3080}event endCli(Sess,Cli,PartS_3066)
                        )
                        else
                            {3081}let pkSess_3069: bitstring = fail-any in
                            {3082}out(c, GetEndpointRequest);
                            {3083}in(c, (=GetEndpointResponse,=pkSess_3069,=SignAndEncrypt,SP_3070: bitstring,UP_3071: bitstring));
                            {3084}new Nc_3072: bitstring;
                            {3085}let gNc_3073: bitstring = exp(g,Nc_3072) in
                            {3086}let m1_3074: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3073) in
                            {3087}event beginCli(Cli,Sess,gNc_3073);
                            {3088}out(c, (pkCli_2991,enc(m1_3074,pkSess_3069),sign(h(m1_3074),skCli_2990)));
                            {3089}in(c, (em2_3075: bitstring,sigM2_3076: bitstring));
                            {3090}let m2_3077: bitstring = dec(em2_3075,skCli_2990) in
                            {3091}if (verify(h(m2_3077),sigM2_3076,pkSess_3069) <> true) then
                                0
                            else
                                {3092}let (=OpenSecureChannelResponse,PartS_3078: bitstring,ST_3079: bitstring,TTL_3080: bitstring) = m2_3077 in
                                {3093}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3094}event endCli(Sess,Cli,PartS_3078)
                    )
                    else
                        {3095}let v_3081: bool = (Disco = B) in
                        (
                            {3096}if v_3081 then
                            (
                                {3097}let pkDisco_3082: bitstring = pub(skB) in
                                {3098}let v_3083: bool = (Sess = A) in
                                (
                                    {3099}if v_3083 then
                                    (
                                        {3100}let pkSess_3084: bitstring = pub(skA) in
                                        {3101}out(c, GetEndpointRequest);
                                        {3102}in(c, (=GetEndpointResponse,=pkSess_3084,=SignAndEncrypt,SP_3085: bitstring,UP_3086: bitstring));
                                        {3103}new Nc_3087: bitstring;
                                        {3104}let gNc_3088: bitstring = exp(g,Nc_3087) in
                                        {3105}let m1_3089: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3088) in
                                        {3106}event beginCli(Cli,Sess,gNc_3088);
                                        {3107}out(c, (pkCli_2991,enc(m1_3089,pkSess_3084),sign(h(m1_3089),skCli_2990)));
                                        {3108}in(c, (em2_3090: bitstring,sigM2_3091: bitstring));
                                        {3109}let m2_3092: bitstring = dec(em2_3090,skCli_2990) in
                                        {3110}if (verify(h(m2_3092),sigM2_3091,pkSess_3084) <> true) then
                                            0
                                        else
                                            {3111}let (=OpenSecureChannelResponse,PartS_3093: bitstring,ST_3094: bitstring,TTL_3095: bitstring) = m2_3092 in
                                            {3112}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3113}event endCli(Sess,Cli,PartS_3093)
                                    )
                                    else
                                        {3114}let v_3096: bool = (Sess = B) in
                                        (
                                            {3115}if v_3096 then
                                            (
                                                {3116}let pkSess_3097: bitstring = pub(skB) in
                                                {3117}out(c, GetEndpointRequest);
                                                {3118}in(c, (=GetEndpointResponse,=pkSess_3097,=SignAndEncrypt,SP_3098: bitstring,UP_3099: bitstring));
                                                {3119}new Nc_3100: bitstring;
                                                {3120}let gNc_3101: bitstring = exp(g,Nc_3100) in
                                                {3121}let m1_3102: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3101) in
                                                {3122}event beginCli(Cli,Sess,gNc_3101);
                                                {3123}out(c, (pkCli_2991,enc(m1_3102,pkSess_3097),sign(h(m1_3102),skCli_2990)));
                                                {3124}in(c, (em2_3103: bitstring,sigM2_3104: bitstring));
                                                {3125}let m2_3105: bitstring = dec(em2_3103,skCli_2990) in
                                                {3126}if (verify(h(m2_3105),sigM2_3104,pkSess_3097) <> true) then
                                                    0
                                                else
                                                    {3127}let (=OpenSecureChannelResponse,PartS_3106: bitstring,ST_3107: bitstring,TTL_3108: bitstring) = m2_3105 in
                                                    {3128}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3129}event endCli(Sess,Cli,PartS_3106)
                                            )
                                            else
                                                {3130}let v_3109: bool = (Sess = C) in
                                                (
                                                    {3131}if v_3109 then
                                                    (
                                                        {3132}let pkSess_3110: bitstring = pub(skC) in
                                                        {3133}out(c, GetEndpointRequest);
                                                        {3134}in(c, (=GetEndpointResponse,=pkSess_3110,=SignAndEncrypt,SP_3111: bitstring,UP_3112: bitstring));
                                                        {3135}new Nc_3113: bitstring;
                                                        {3136}let gNc_3114: bitstring = exp(g,Nc_3113) in
                                                        {3137}let m1_3115: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3114) in
                                                        {3138}event beginCli(Cli,Sess,gNc_3114);
                                                        {3139}out(c, (pkCli_2991,enc(m1_3115,pkSess_3110),sign(h(m1_3115),skCli_2990)));
                                                        {3140}in(c, (em2_3116: bitstring,sigM2_3117: bitstring));
                                                        {3141}let m2_3118: bitstring = dec(em2_3116,skCli_2990) in
                                                        {3142}if (verify(h(m2_3118),sigM2_3117,pkSess_3110) <> true) then
                                                            0
                                                        else
                                                            {3143}let (=OpenSecureChannelResponse,PartS_3119: bitstring,ST_3120: bitstring,TTL_3121: bitstring) = m2_3118 in
                                                            {3144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3145}event endCli(Sess,Cli,PartS_3119)
                                                    )
                                                    else
                                                        {3146}let pkSess_3122: bitstring = pub(sk(Sess)) in
                                                        {3147}out(c, GetEndpointRequest);
                                                        {3148}in(c, (=GetEndpointResponse,=pkSess_3122,=SignAndEncrypt,SP_3123: bitstring,UP_3124: bitstring));
                                                        {3149}new Nc_3125: bitstring;
                                                        {3150}let gNc_3126: bitstring = exp(g,Nc_3125) in
                                                        {3151}let m1_3127: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3126) in
                                                        {3152}event beginCli(Cli,Sess,gNc_3126);
                                                        {3153}out(c, (pkCli_2991,enc(m1_3127,pkSess_3122),sign(h(m1_3127),skCli_2990)));
                                                        {3154}in(c, (em2_3128: bitstring,sigM2_3129: bitstring));
                                                        {3155}let m2_3130: bitstring = dec(em2_3128,skCli_2990) in
                                                        {3156}if (verify(h(m2_3130),sigM2_3129,pkSess_3122) <> true) then
                                                            0
                                                        else
                                                            {3157}let (=OpenSecureChannelResponse,PartS_3131: bitstring,ST_3132: bitstring,TTL_3133: bitstring) = m2_3130 in
                                                            {3158}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3159}event endCli(Sess,Cli,PartS_3131)
                                                )
                                                else
                                                    {3160}let pkSess_3134: bitstring = fail-any in
                                                    {3161}out(c, GetEndpointRequest);
                                                    {3162}in(c, (=GetEndpointResponse,=pkSess_3134,=SignAndEncrypt,SP_3135: bitstring,UP_3136: bitstring));
                                                    {3163}new Nc_3137: bitstring;
                                                    {3164}let gNc_3138: bitstring = exp(g,Nc_3137) in
                                                    {3165}let m1_3139: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3138) in
                                                    {3166}event beginCli(Cli,Sess,gNc_3138);
                                                    {3167}out(c, (pkCli_2991,enc(m1_3139,pkSess_3134),sign(h(m1_3139),skCli_2990)));
                                                    {3168}in(c, (em2_3140: bitstring,sigM2_3141: bitstring));
                                                    {3169}let m2_3142: bitstring = dec(em2_3140,skCli_2990) in
                                                    {3170}if (verify(h(m2_3142),sigM2_3141,pkSess_3134) <> true) then
                                                        0
                                                    else
                                                        {3171}let (=OpenSecureChannelResponse,PartS_3143: bitstring,ST_3144: bitstring,TTL_3145: bitstring) = m2_3142 in
                                                        {3172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3173}event endCli(Sess,Cli,PartS_3143)
                                        )
                                        else
                                            {3174}let pkSess_3146: bitstring = fail-any in
                                            {3175}out(c, GetEndpointRequest);
                                            {3176}in(c, (=GetEndpointResponse,=pkSess_3146,=SignAndEncrypt,SP_3147: bitstring,UP_3148: bitstring));
                                            {3177}new Nc_3149: bitstring;
                                            {3178}let gNc_3150: bitstring = exp(g,Nc_3149) in
                                            {3179}let m1_3151: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3150) in
                                            {3180}event beginCli(Cli,Sess,gNc_3150);
                                            {3181}out(c, (pkCli_2991,enc(m1_3151,pkSess_3146),sign(h(m1_3151),skCli_2990)));
                                            {3182}in(c, (em2_3152: bitstring,sigM2_3153: bitstring));
                                            {3183}let m2_3154: bitstring = dec(em2_3152,skCli_2990) in
                                            {3184}if (verify(h(m2_3154),sigM2_3153,pkSess_3146) <> true) then
                                                0
                                            else
                                                {3185}let (=OpenSecureChannelResponse,PartS_3155: bitstring,ST_3156: bitstring,TTL_3157: bitstring) = m2_3154 in
                                                {3186}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3187}event endCli(Sess,Cli,PartS_3155)
                                )
                                else
                                    {3188}let pkSess_3158: bitstring = fail-any in
                                    {3189}out(c, GetEndpointRequest);
                                    {3190}in(c, (=GetEndpointResponse,=pkSess_3158,=SignAndEncrypt,SP_3159: bitstring,UP_3160: bitstring));
                                    {3191}new Nc_3161: bitstring;
                                    {3192}let gNc_3162: bitstring = exp(g,Nc_3161) in
                                    {3193}let m1_3163: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3162) in
                                    {3194}event beginCli(Cli,Sess,gNc_3162);
                                    {3195}out(c, (pkCli_2991,enc(m1_3163,pkSess_3158),sign(h(m1_3163),skCli_2990)));
                                    {3196}in(c, (em2_3164: bitstring,sigM2_3165: bitstring));
                                    {3197}let m2_3166: bitstring = dec(em2_3164,skCli_2990) in
                                    {3198}if (verify(h(m2_3166),sigM2_3165,pkSess_3158) <> true) then
                                        0
                                    else
                                        {3199}let (=OpenSecureChannelResponse,PartS_3167: bitstring,ST_3168: bitstring,TTL_3169: bitstring) = m2_3166 in
                                        {3200}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3201}event endCli(Sess,Cli,PartS_3167)
                            )
                            else
                                {3202}let v_3170: bool = (Disco = C) in
                                (
                                    {3203}if v_3170 then
                                    (
                                        {3204}let pkDisco_3171: bitstring = pub(skC) in
                                        {3205}let v_3172: bool = (Sess = A) in
                                        (
                                            {3206}if v_3172 then
                                            (
                                                {3207}let pkSess_3173: bitstring = pub(skA) in
                                                {3208}out(c, GetEndpointRequest);
                                                {3209}in(c, (=GetEndpointResponse,=pkSess_3173,=SignAndEncrypt,SP_3174: bitstring,UP_3175: bitstring));
                                                {3210}new Nc_3176: bitstring;
                                                {3211}let gNc_3177: bitstring = exp(g,Nc_3176) in
                                                {3212}let m1_3178: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3177) in
                                                {3213}event beginCli(Cli,Sess,gNc_3177);
                                                {3214}out(c, (pkCli_2991,enc(m1_3178,pkSess_3173),sign(h(m1_3178),skCli_2990)));
                                                {3215}in(c, (em2_3179: bitstring,sigM2_3180: bitstring));
                                                {3216}let m2_3181: bitstring = dec(em2_3179,skCli_2990) in
                                                {3217}if (verify(h(m2_3181),sigM2_3180,pkSess_3173) <> true) then
                                                    0
                                                else
                                                    {3218}let (=OpenSecureChannelResponse,PartS_3182: bitstring,ST_3183: bitstring,TTL_3184: bitstring) = m2_3181 in
                                                    {3219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3220}event endCli(Sess,Cli,PartS_3182)
                                            )
                                            else
                                                {3221}let v_3185: bool = (Sess = B) in
                                                (
                                                    {3222}if v_3185 then
                                                    (
                                                        {3223}let pkSess_3186: bitstring = pub(skB) in
                                                        {3224}out(c, GetEndpointRequest);
                                                        {3225}in(c, (=GetEndpointResponse,=pkSess_3186,=SignAndEncrypt,SP_3187: bitstring,UP_3188: bitstring));
                                                        {3226}new Nc_3189: bitstring;
                                                        {3227}let gNc_3190: bitstring = exp(g,Nc_3189) in
                                                        {3228}let m1_3191: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3190) in
                                                        {3229}event beginCli(Cli,Sess,gNc_3190);
                                                        {3230}out(c, (pkCli_2991,enc(m1_3191,pkSess_3186),sign(h(m1_3191),skCli_2990)));
                                                        {3231}in(c, (em2_3192: bitstring,sigM2_3193: bitstring));
                                                        {3232}let m2_3194: bitstring = dec(em2_3192,skCli_2990) in
                                                        {3233}if (verify(h(m2_3194),sigM2_3193,pkSess_3186) <> true) then
                                                            0
                                                        else
                                                            {3234}let (=OpenSecureChannelResponse,PartS_3195: bitstring,ST_3196: bitstring,TTL_3197: bitstring) = m2_3194 in
                                                            {3235}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3236}event endCli(Sess,Cli,PartS_3195)
                                                    )
                                                    else
                                                        {3237}let v_3198: bool = (Sess = C) in
                                                        (
                                                            {3238}if v_3198 then
                                                            (
                                                                {3239}let pkSess_3199: bitstring = pub(skC) in
                                                                {3240}out(c, GetEndpointRequest);
                                                                {3241}in(c, (=GetEndpointResponse,=pkSess_3199,=SignAndEncrypt,SP_3200: bitstring,UP_3201: bitstring));
                                                                {3242}new Nc_3202: bitstring;
                                                                {3243}let gNc_3203: bitstring = exp(g,Nc_3202) in
                                                                {3244}let m1_3204: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3203) in
                                                                {3245}event beginCli(Cli,Sess,gNc_3203);
                                                                {3246}out(c, (pkCli_2991,enc(m1_3204,pkSess_3199),sign(h(m1_3204),skCli_2990)));
                                                                {3247}in(c, (em2_3205: bitstring,sigM2_3206: bitstring));
                                                                {3248}let m2_3207: bitstring = dec(em2_3205,skCli_2990) in
                                                                {3249}if (verify(h(m2_3207),sigM2_3206,pkSess_3199) <> true) then
                                                                    0
                                                                else
                                                                    {3250}let (=OpenSecureChannelResponse,PartS_3208: bitstring,ST_3209: bitstring,TTL_3210: bitstring) = m2_3207 in
                                                                    {3251}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3252}event endCli(Sess,Cli,PartS_3208)
                                                            )
                                                            else
                                                                {3253}let pkSess_3211: bitstring = pub(sk(Sess)) in
                                                                {3254}out(c, GetEndpointRequest);
                                                                {3255}in(c, (=GetEndpointResponse,=pkSess_3211,=SignAndEncrypt,SP_3212: bitstring,UP_3213: bitstring));
                                                                {3256}new Nc_3214: bitstring;
                                                                {3257}let gNc_3215: bitstring = exp(g,Nc_3214) in
                                                                {3258}let m1_3216: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3215) in
                                                                {3259}event beginCli(Cli,Sess,gNc_3215);
                                                                {3260}out(c, (pkCli_2991,enc(m1_3216,pkSess_3211),sign(h(m1_3216),skCli_2990)));
                                                                {3261}in(c, (em2_3217: bitstring,sigM2_3218: bitstring));
                                                                {3262}let m2_3219: bitstring = dec(em2_3217,skCli_2990) in
                                                                {3263}if (verify(h(m2_3219),sigM2_3218,pkSess_3211) <> true) then
                                                                    0
                                                                else
                                                                    {3264}let (=OpenSecureChannelResponse,PartS_3220: bitstring,ST_3221: bitstring,TTL_3222: bitstring) = m2_3219 in
                                                                    {3265}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3266}event endCli(Sess,Cli,PartS_3220)
                                                        )
                                                        else
                                                            {3267}let pkSess_3223: bitstring = fail-any in
                                                            {3268}out(c, GetEndpointRequest);
                                                            {3269}in(c, (=GetEndpointResponse,=pkSess_3223,=SignAndEncrypt,SP_3224: bitstring,UP_3225: bitstring));
                                                            {3270}new Nc_3226: bitstring;
                                                            {3271}let gNc_3227: bitstring = exp(g,Nc_3226) in
                                                            {3272}let m1_3228: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3227) in
                                                            {3273}event beginCli(Cli,Sess,gNc_3227);
                                                            {3274}out(c, (pkCli_2991,enc(m1_3228,pkSess_3223),sign(h(m1_3228),skCli_2990)));
                                                            {3275}in(c, (em2_3229: bitstring,sigM2_3230: bitstring));
                                                            {3276}let m2_3231: bitstring = dec(em2_3229,skCli_2990) in
                                                            {3277}if (verify(h(m2_3231),sigM2_3230,pkSess_3223) <> true) then
                                                                0
                                                            else
                                                                {3278}let (=OpenSecureChannelResponse,PartS_3232: bitstring,ST_3233: bitstring,TTL_3234: bitstring) = m2_3231 in
                                                                {3279}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3280}event endCli(Sess,Cli,PartS_3232)
                                                )
                                                else
                                                    {3281}let pkSess_3235: bitstring = fail-any in
                                                    {3282}out(c, GetEndpointRequest);
                                                    {3283}in(c, (=GetEndpointResponse,=pkSess_3235,=SignAndEncrypt,SP_3236: bitstring,UP_3237: bitstring));
                                                    {3284}new Nc_3238: bitstring;
                                                    {3285}let gNc_3239: bitstring = exp(g,Nc_3238) in
                                                    {3286}let m1_3240: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3239) in
                                                    {3287}event beginCli(Cli,Sess,gNc_3239);
                                                    {3288}out(c, (pkCli_2991,enc(m1_3240,pkSess_3235),sign(h(m1_3240),skCli_2990)));
                                                    {3289}in(c, (em2_3241: bitstring,sigM2_3242: bitstring));
                                                    {3290}let m2_3243: bitstring = dec(em2_3241,skCli_2990) in
                                                    {3291}if (verify(h(m2_3243),sigM2_3242,pkSess_3235) <> true) then
                                                        0
                                                    else
                                                        {3292}let (=OpenSecureChannelResponse,PartS_3244: bitstring,ST_3245: bitstring,TTL_3246: bitstring) = m2_3243 in
                                                        {3293}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3294}event endCli(Sess,Cli,PartS_3244)
                                        )
                                        else
                                            {3295}let pkSess_3247: bitstring = fail-any in
                                            {3296}out(c, GetEndpointRequest);
                                            {3297}in(c, (=GetEndpointResponse,=pkSess_3247,=SignAndEncrypt,SP_3248: bitstring,UP_3249: bitstring));
                                            {3298}new Nc_3250: bitstring;
                                            {3299}let gNc_3251: bitstring = exp(g,Nc_3250) in
                                            {3300}let m1_3252: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3251) in
                                            {3301}event beginCli(Cli,Sess,gNc_3251);
                                            {3302}out(c, (pkCli_2991,enc(m1_3252,pkSess_3247),sign(h(m1_3252),skCli_2990)));
                                            {3303}in(c, (em2_3253: bitstring,sigM2_3254: bitstring));
                                            {3304}let m2_3255: bitstring = dec(em2_3253,skCli_2990) in
                                            {3305}if (verify(h(m2_3255),sigM2_3254,pkSess_3247) <> true) then
                                                0
                                            else
                                                {3306}let (=OpenSecureChannelResponse,PartS_3256: bitstring,ST_3257: bitstring,TTL_3258: bitstring) = m2_3255 in
                                                {3307}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3308}event endCli(Sess,Cli,PartS_3256)
                                    )
                                    else
                                        {3309}let pkDisco_3259: bitstring = pub(sk(Disco)) in
                                        {3310}let v_3260: bool = (Sess = A) in
                                        (
                                            {3311}if v_3260 then
                                            (
                                                {3312}let pkSess_3261: bitstring = pub(skA) in
                                                {3313}out(c, GetEndpointRequest);
                                                {3314}in(c, (=GetEndpointResponse,=pkSess_3261,=SignAndEncrypt,SP_3262: bitstring,UP_3263: bitstring));
                                                {3315}new Nc_3264: bitstring;
                                                {3316}let gNc_3265: bitstring = exp(g,Nc_3264) in
                                                {3317}let m1_3266: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3265) in
                                                {3318}event beginCli(Cli,Sess,gNc_3265);
                                                {3319}out(c, (pkCli_2991,enc(m1_3266,pkSess_3261),sign(h(m1_3266),skCli_2990)));
                                                {3320}in(c, (em2_3267: bitstring,sigM2_3268: bitstring));
                                                {3321}let m2_3269: bitstring = dec(em2_3267,skCli_2990) in
                                                {3322}if (verify(h(m2_3269),sigM2_3268,pkSess_3261) <> true) then
                                                    0
                                                else
                                                    {3323}let (=OpenSecureChannelResponse,PartS_3270: bitstring,ST_3271: bitstring,TTL_3272: bitstring) = m2_3269 in
                                                    {3324}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3325}event endCli(Sess,Cli,PartS_3270)
                                            )
                                            else
                                                {3326}let v_3273: bool = (Sess = B) in
                                                (
                                                    {3327}if v_3273 then
                                                    (
                                                        {3328}let pkSess_3274: bitstring = pub(skB) in
                                                        {3329}out(c, GetEndpointRequest);
                                                        {3330}in(c, (=GetEndpointResponse,=pkSess_3274,=SignAndEncrypt,SP_3275: bitstring,UP_3276: bitstring));
                                                        {3331}new Nc_3277: bitstring;
                                                        {3332}let gNc_3278: bitstring = exp(g,Nc_3277) in
                                                        {3333}let m1_3279: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3278) in
                                                        {3334}event beginCli(Cli,Sess,gNc_3278);
                                                        {3335}out(c, (pkCli_2991,enc(m1_3279,pkSess_3274),sign(h(m1_3279),skCli_2990)));
                                                        {3336}in(c, (em2_3280: bitstring,sigM2_3281: bitstring));
                                                        {3337}let m2_3282: bitstring = dec(em2_3280,skCli_2990) in
                                                        {3338}if (verify(h(m2_3282),sigM2_3281,pkSess_3274) <> true) then
                                                            0
                                                        else
                                                            {3339}let (=OpenSecureChannelResponse,PartS_3283: bitstring,ST_3284: bitstring,TTL_3285: bitstring) = m2_3282 in
                                                            {3340}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3341}event endCli(Sess,Cli,PartS_3283)
                                                    )
                                                    else
                                                        {3342}let v_3286: bool = (Sess = C) in
                                                        (
                                                            {3343}if v_3286 then
                                                            (
                                                                {3344}let pkSess_3287: bitstring = pub(skC) in
                                                                {3345}out(c, GetEndpointRequest);
                                                                {3346}in(c, (=GetEndpointResponse,=pkSess_3287,=SignAndEncrypt,SP_3288: bitstring,UP_3289: bitstring));
                                                                {3347}new Nc_3290: bitstring;
                                                                {3348}let gNc_3291: bitstring = exp(g,Nc_3290) in
                                                                {3349}let m1_3292: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3291) in
                                                                {3350}event beginCli(Cli,Sess,gNc_3291);
                                                                {3351}out(c, (pkCli_2991,enc(m1_3292,pkSess_3287),sign(h(m1_3292),skCli_2990)));
                                                                {3352}in(c, (em2_3293: bitstring,sigM2_3294: bitstring));
                                                                {3353}let m2_3295: bitstring = dec(em2_3293,skCli_2990) in
                                                                {3354}if (verify(h(m2_3295),sigM2_3294,pkSess_3287) <> true) then
                                                                    0
                                                                else
                                                                    {3355}let (=OpenSecureChannelResponse,PartS_3296: bitstring,ST_3297: bitstring,TTL_3298: bitstring) = m2_3295 in
                                                                    {3356}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3357}event endCli(Sess,Cli,PartS_3296)
                                                            )
                                                            else
                                                                {3358}let pkSess_3299: bitstring = pub(sk(Sess)) in
                                                                {3359}out(c, GetEndpointRequest);
                                                                {3360}in(c, (=GetEndpointResponse,=pkSess_3299,=SignAndEncrypt,SP_3300: bitstring,UP_3301: bitstring));
                                                                {3361}new Nc_3302: bitstring;
                                                                {3362}let gNc_3303: bitstring = exp(g,Nc_3302) in
                                                                {3363}let m1_3304: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3303) in
                                                                {3364}event beginCli(Cli,Sess,gNc_3303);
                                                                {3365}out(c, (pkCli_2991,enc(m1_3304,pkSess_3299),sign(h(m1_3304),skCli_2990)));
                                                                {3366}in(c, (em2_3305: bitstring,sigM2_3306: bitstring));
                                                                {3367}let m2_3307: bitstring = dec(em2_3305,skCli_2990) in
                                                                {3368}if (verify(h(m2_3307),sigM2_3306,pkSess_3299) <> true) then
                                                                    0
                                                                else
                                                                    {3369}let (=OpenSecureChannelResponse,PartS_3308: bitstring,ST_3309: bitstring,TTL_3310: bitstring) = m2_3307 in
                                                                    {3370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {3371}event endCli(Sess,Cli,PartS_3308)
                                                        )
                                                        else
                                                            {3372}let pkSess_3311: bitstring = fail-any in
                                                            {3373}out(c, GetEndpointRequest);
                                                            {3374}in(c, (=GetEndpointResponse,=pkSess_3311,=SignAndEncrypt,SP_3312: bitstring,UP_3313: bitstring));
                                                            {3375}new Nc_3314: bitstring;
                                                            {3376}let gNc_3315: bitstring = exp(g,Nc_3314) in
                                                            {3377}let m1_3316: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3315) in
                                                            {3378}event beginCli(Cli,Sess,gNc_3315);
                                                            {3379}out(c, (pkCli_2991,enc(m1_3316,pkSess_3311),sign(h(m1_3316),skCli_2990)));
                                                            {3380}in(c, (em2_3317: bitstring,sigM2_3318: bitstring));
                                                            {3381}let m2_3319: bitstring = dec(em2_3317,skCli_2990) in
                                                            {3382}if (verify(h(m2_3319),sigM2_3318,pkSess_3311) <> true) then
                                                                0
                                                            else
                                                                {3383}let (=OpenSecureChannelResponse,PartS_3320: bitstring,ST_3321: bitstring,TTL_3322: bitstring) = m2_3319 in
                                                                {3384}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3385}event endCli(Sess,Cli,PartS_3320)
                                                )
                                                else
                                                    {3386}let pkSess_3323: bitstring = fail-any in
                                                    {3387}out(c, GetEndpointRequest);
                                                    {3388}in(c, (=GetEndpointResponse,=pkSess_3323,=SignAndEncrypt,SP_3324: bitstring,UP_3325: bitstring));
                                                    {3389}new Nc_3326: bitstring;
                                                    {3390}let gNc_3327: bitstring = exp(g,Nc_3326) in
                                                    {3391}let m1_3328: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3327) in
                                                    {3392}event beginCli(Cli,Sess,gNc_3327);
                                                    {3393}out(c, (pkCli_2991,enc(m1_3328,pkSess_3323),sign(h(m1_3328),skCli_2990)));
                                                    {3394}in(c, (em2_3329: bitstring,sigM2_3330: bitstring));
                                                    {3395}let m2_3331: bitstring = dec(em2_3329,skCli_2990) in
                                                    {3396}if (verify(h(m2_3331),sigM2_3330,pkSess_3323) <> true) then
                                                        0
                                                    else
                                                        {3397}let (=OpenSecureChannelResponse,PartS_3332: bitstring,ST_3333: bitstring,TTL_3334: bitstring) = m2_3331 in
                                                        {3398}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3399}event endCli(Sess,Cli,PartS_3332)
                                        )
                                        else
                                            {3400}let pkSess_3335: bitstring = fail-any in
                                            {3401}out(c, GetEndpointRequest);
                                            {3402}in(c, (=GetEndpointResponse,=pkSess_3335,=SignAndEncrypt,SP_3336: bitstring,UP_3337: bitstring));
                                            {3403}new Nc_3338: bitstring;
                                            {3404}let gNc_3339: bitstring = exp(g,Nc_3338) in
                                            {3405}let m1_3340: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3339) in
                                            {3406}event beginCli(Cli,Sess,gNc_3339);
                                            {3407}out(c, (pkCli_2991,enc(m1_3340,pkSess_3335),sign(h(m1_3340),skCli_2990)));
                                            {3408}in(c, (em2_3341: bitstring,sigM2_3342: bitstring));
                                            {3409}let m2_3343: bitstring = dec(em2_3341,skCli_2990) in
                                            {3410}if (verify(h(m2_3343),sigM2_3342,pkSess_3335) <> true) then
                                                0
                                            else
                                                {3411}let (=OpenSecureChannelResponse,PartS_3344: bitstring,ST_3345: bitstring,TTL_3346: bitstring) = m2_3343 in
                                                {3412}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3413}event endCli(Sess,Cli,PartS_3344)
                                )
                                else
                                    {3414}let pkDisco_3347: bitstring = fail-any in
                                    {3415}let v_3348: bool = (Sess = A) in
                                    (
                                        {3416}if v_3348 then
                                        (
                                            {3417}let pkSess_3349: bitstring = pub(skA) in
                                            {3418}out(c, GetEndpointRequest);
                                            {3419}in(c, (=GetEndpointResponse,=pkSess_3349,=SignAndEncrypt,SP_3350: bitstring,UP_3351: bitstring));
                                            {3420}new Nc_3352: bitstring;
                                            {3421}let gNc_3353: bitstring = exp(g,Nc_3352) in
                                            {3422}let m1_3354: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3353) in
                                            {3423}event beginCli(Cli,Sess,gNc_3353);
                                            {3424}out(c, (pkCli_2991,enc(m1_3354,pkSess_3349),sign(h(m1_3354),skCli_2990)));
                                            {3425}in(c, (em2_3355: bitstring,sigM2_3356: bitstring));
                                            {3426}let m2_3357: bitstring = dec(em2_3355,skCli_2990) in
                                            {3427}if (verify(h(m2_3357),sigM2_3356,pkSess_3349) <> true) then
                                                0
                                            else
                                                {3428}let (=OpenSecureChannelResponse,PartS_3358: bitstring,ST_3359: bitstring,TTL_3360: bitstring) = m2_3357 in
                                                {3429}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3430}event endCli(Sess,Cli,PartS_3358)
                                        )
                                        else
                                            {3431}let v_3361: bool = (Sess = B) in
                                            (
                                                {3432}if v_3361 then
                                                (
                                                    {3433}let pkSess_3362: bitstring = pub(skB) in
                                                    {3434}out(c, GetEndpointRequest);
                                                    {3435}in(c, (=GetEndpointResponse,=pkSess_3362,=SignAndEncrypt,SP_3363: bitstring,UP_3364: bitstring));
                                                    {3436}new Nc_3365: bitstring;
                                                    {3437}let gNc_3366: bitstring = exp(g,Nc_3365) in
                                                    {3438}let m1_3367: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3366) in
                                                    {3439}event beginCli(Cli,Sess,gNc_3366);
                                                    {3440}out(c, (pkCli_2991,enc(m1_3367,pkSess_3362),sign(h(m1_3367),skCli_2990)));
                                                    {3441}in(c, (em2_3368: bitstring,sigM2_3369: bitstring));
                                                    {3442}let m2_3370: bitstring = dec(em2_3368,skCli_2990) in
                                                    {3443}if (verify(h(m2_3370),sigM2_3369,pkSess_3362) <> true) then
                                                        0
                                                    else
                                                        {3444}let (=OpenSecureChannelResponse,PartS_3371: bitstring,ST_3372: bitstring,TTL_3373: bitstring) = m2_3370 in
                                                        {3445}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3446}event endCli(Sess,Cli,PartS_3371)
                                                )
                                                else
                                                    {3447}let v_3374: bool = (Sess = C) in
                                                    (
                                                        {3448}if v_3374 then
                                                        (
                                                            {3449}let pkSess_3375: bitstring = pub(skC) in
                                                            {3450}out(c, GetEndpointRequest);
                                                            {3451}in(c, (=GetEndpointResponse,=pkSess_3375,=SignAndEncrypt,SP_3376: bitstring,UP_3377: bitstring));
                                                            {3452}new Nc_3378: bitstring;
                                                            {3453}let gNc_3379: bitstring = exp(g,Nc_3378) in
                                                            {3454}let m1_3380: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3379) in
                                                            {3455}event beginCli(Cli,Sess,gNc_3379);
                                                            {3456}out(c, (pkCli_2991,enc(m1_3380,pkSess_3375),sign(h(m1_3380),skCli_2990)));
                                                            {3457}in(c, (em2_3381: bitstring,sigM2_3382: bitstring));
                                                            {3458}let m2_3383: bitstring = dec(em2_3381,skCli_2990) in
                                                            {3459}if (verify(h(m2_3383),sigM2_3382,pkSess_3375) <> true) then
                                                                0
                                                            else
                                                                {3460}let (=OpenSecureChannelResponse,PartS_3384: bitstring,ST_3385: bitstring,TTL_3386: bitstring) = m2_3383 in
                                                                {3461}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3462}event endCli(Sess,Cli,PartS_3384)
                                                        )
                                                        else
                                                            {3463}let pkSess_3387: bitstring = pub(sk(Sess)) in
                                                            {3464}out(c, GetEndpointRequest);
                                                            {3465}in(c, (=GetEndpointResponse,=pkSess_3387,=SignAndEncrypt,SP_3388: bitstring,UP_3389: bitstring));
                                                            {3466}new Nc_3390: bitstring;
                                                            {3467}let gNc_3391: bitstring = exp(g,Nc_3390) in
                                                            {3468}let m1_3392: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3391) in
                                                            {3469}event beginCli(Cli,Sess,gNc_3391);
                                                            {3470}out(c, (pkCli_2991,enc(m1_3392,pkSess_3387),sign(h(m1_3392),skCli_2990)));
                                                            {3471}in(c, (em2_3393: bitstring,sigM2_3394: bitstring));
                                                            {3472}let m2_3395: bitstring = dec(em2_3393,skCli_2990) in
                                                            {3473}if (verify(h(m2_3395),sigM2_3394,pkSess_3387) <> true) then
                                                                0
                                                            else
                                                                {3474}let (=OpenSecureChannelResponse,PartS_3396: bitstring,ST_3397: bitstring,TTL_3398: bitstring) = m2_3395 in
                                                                {3475}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3476}event endCli(Sess,Cli,PartS_3396)
                                                    )
                                                    else
                                                        {3477}let pkSess_3399: bitstring = fail-any in
                                                        {3478}out(c, GetEndpointRequest);
                                                        {3479}in(c, (=GetEndpointResponse,=pkSess_3399,=SignAndEncrypt,SP_3400: bitstring,UP_3401: bitstring));
                                                        {3480}new Nc_3402: bitstring;
                                                        {3481}let gNc_3403: bitstring = exp(g,Nc_3402) in
                                                        {3482}let m1_3404: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3403) in
                                                        {3483}event beginCli(Cli,Sess,gNc_3403);
                                                        {3484}out(c, (pkCli_2991,enc(m1_3404,pkSess_3399),sign(h(m1_3404),skCli_2990)));
                                                        {3485}in(c, (em2_3405: bitstring,sigM2_3406: bitstring));
                                                        {3486}let m2_3407: bitstring = dec(em2_3405,skCli_2990) in
                                                        {3487}if (verify(h(m2_3407),sigM2_3406,pkSess_3399) <> true) then
                                                            0
                                                        else
                                                            {3488}let (=OpenSecureChannelResponse,PartS_3408: bitstring,ST_3409: bitstring,TTL_3410: bitstring) = m2_3407 in
                                                            {3489}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3490}event endCli(Sess,Cli,PartS_3408)
                                            )
                                            else
                                                {3491}let pkSess_3411: bitstring = fail-any in
                                                {3492}out(c, GetEndpointRequest);
                                                {3493}in(c, (=GetEndpointResponse,=pkSess_3411,=SignAndEncrypt,SP_3412: bitstring,UP_3413: bitstring));
                                                {3494}new Nc_3414: bitstring;
                                                {3495}let gNc_3415: bitstring = exp(g,Nc_3414) in
                                                {3496}let m1_3416: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3415) in
                                                {3497}event beginCli(Cli,Sess,gNc_3415);
                                                {3498}out(c, (pkCli_2991,enc(m1_3416,pkSess_3411),sign(h(m1_3416),skCli_2990)));
                                                {3499}in(c, (em2_3417: bitstring,sigM2_3418: bitstring));
                                                {3500}let m2_3419: bitstring = dec(em2_3417,skCli_2990) in
                                                {3501}if (verify(h(m2_3419),sigM2_3418,pkSess_3411) <> true) then
                                                    0
                                                else
                                                    {3502}let (=OpenSecureChannelResponse,PartS_3420: bitstring,ST_3421: bitstring,TTL_3422: bitstring) = m2_3419 in
                                                    {3503}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3504}event endCli(Sess,Cli,PartS_3420)
                                    )
                                    else
                                        {3505}let pkSess_3423: bitstring = fail-any in
                                        {3506}out(c, GetEndpointRequest);
                                        {3507}in(c, (=GetEndpointResponse,=pkSess_3423,=SignAndEncrypt,SP_3424: bitstring,UP_3425: bitstring));
                                        {3508}new Nc_3426: bitstring;
                                        {3509}let gNc_3427: bitstring = exp(g,Nc_3426) in
                                        {3510}let m1_3428: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3427) in
                                        {3511}event beginCli(Cli,Sess,gNc_3427);
                                        {3512}out(c, (pkCli_2991,enc(m1_3428,pkSess_3423),sign(h(m1_3428),skCli_2990)));
                                        {3513}in(c, (em2_3429: bitstring,sigM2_3430: bitstring));
                                        {3514}let m2_3431: bitstring = dec(em2_3429,skCli_2990) in
                                        {3515}if (verify(h(m2_3431),sigM2_3430,pkSess_3423) <> true) then
                                            0
                                        else
                                            {3516}let (=OpenSecureChannelResponse,PartS_3432: bitstring,ST_3433: bitstring,TTL_3434: bitstring) = m2_3431 in
                                            {3517}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3518}event endCli(Sess,Cli,PartS_3432)
                        )
                        else
                            {3519}let pkDisco_3435: bitstring = fail-any in
                            {3520}let v_3436: bool = (Sess = A) in
                            (
                                {3521}if v_3436 then
                                (
                                    {3522}let pkSess_3437: bitstring = pub(skA) in
                                    {3523}out(c, GetEndpointRequest);
                                    {3524}in(c, (=GetEndpointResponse,=pkSess_3437,=SignAndEncrypt,SP_3438: bitstring,UP_3439: bitstring));
                                    {3525}new Nc_3440: bitstring;
                                    {3526}let gNc_3441: bitstring = exp(g,Nc_3440) in
                                    {3527}let m1_3442: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3441) in
                                    {3528}event beginCli(Cli,Sess,gNc_3441);
                                    {3529}out(c, (pkCli_2991,enc(m1_3442,pkSess_3437),sign(h(m1_3442),skCli_2990)));
                                    {3530}in(c, (em2_3443: bitstring,sigM2_3444: bitstring));
                                    {3531}let m2_3445: bitstring = dec(em2_3443,skCli_2990) in
                                    {3532}if (verify(h(m2_3445),sigM2_3444,pkSess_3437) <> true) then
                                        0
                                    else
                                        {3533}let (=OpenSecureChannelResponse,PartS_3446: bitstring,ST_3447: bitstring,TTL_3448: bitstring) = m2_3445 in
                                        {3534}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3535}event endCli(Sess,Cli,PartS_3446)
                                )
                                else
                                    {3536}let v_3449: bool = (Sess = B) in
                                    (
                                        {3537}if v_3449 then
                                        (
                                            {3538}let pkSess_3450: bitstring = pub(skB) in
                                            {3539}out(c, GetEndpointRequest);
                                            {3540}in(c, (=GetEndpointResponse,=pkSess_3450,=SignAndEncrypt,SP_3451: bitstring,UP_3452: bitstring));
                                            {3541}new Nc_3453: bitstring;
                                            {3542}let gNc_3454: bitstring = exp(g,Nc_3453) in
                                            {3543}let m1_3455: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3454) in
                                            {3544}event beginCli(Cli,Sess,gNc_3454);
                                            {3545}out(c, (pkCli_2991,enc(m1_3455,pkSess_3450),sign(h(m1_3455),skCli_2990)));
                                            {3546}in(c, (em2_3456: bitstring,sigM2_3457: bitstring));
                                            {3547}let m2_3458: bitstring = dec(em2_3456,skCli_2990) in
                                            {3548}if (verify(h(m2_3458),sigM2_3457,pkSess_3450) <> true) then
                                                0
                                            else
                                                {3549}let (=OpenSecureChannelResponse,PartS_3459: bitstring,ST_3460: bitstring,TTL_3461: bitstring) = m2_3458 in
                                                {3550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3551}event endCli(Sess,Cli,PartS_3459)
                                        )
                                        else
                                            {3552}let v_3462: bool = (Sess = C) in
                                            (
                                                {3553}if v_3462 then
                                                (
                                                    {3554}let pkSess_3463: bitstring = pub(skC) in
                                                    {3555}out(c, GetEndpointRequest);
                                                    {3556}in(c, (=GetEndpointResponse,=pkSess_3463,=SignAndEncrypt,SP_3464: bitstring,UP_3465: bitstring));
                                                    {3557}new Nc_3466: bitstring;
                                                    {3558}let gNc_3467: bitstring = exp(g,Nc_3466) in
                                                    {3559}let m1_3468: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3467) in
                                                    {3560}event beginCli(Cli,Sess,gNc_3467);
                                                    {3561}out(c, (pkCli_2991,enc(m1_3468,pkSess_3463),sign(h(m1_3468),skCli_2990)));
                                                    {3562}in(c, (em2_3469: bitstring,sigM2_3470: bitstring));
                                                    {3563}let m2_3471: bitstring = dec(em2_3469,skCli_2990) in
                                                    {3564}if (verify(h(m2_3471),sigM2_3470,pkSess_3463) <> true) then
                                                        0
                                                    else
                                                        {3565}let (=OpenSecureChannelResponse,PartS_3472: bitstring,ST_3473: bitstring,TTL_3474: bitstring) = m2_3471 in
                                                        {3566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3567}event endCli(Sess,Cli,PartS_3472)
                                                )
                                                else
                                                    {3568}let pkSess_3475: bitstring = pub(sk(Sess)) in
                                                    {3569}out(c, GetEndpointRequest);
                                                    {3570}in(c, (=GetEndpointResponse,=pkSess_3475,=SignAndEncrypt,SP_3476: bitstring,UP_3477: bitstring));
                                                    {3571}new Nc_3478: bitstring;
                                                    {3572}let gNc_3479: bitstring = exp(g,Nc_3478) in
                                                    {3573}let m1_3480: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3479) in
                                                    {3574}event beginCli(Cli,Sess,gNc_3479);
                                                    {3575}out(c, (pkCli_2991,enc(m1_3480,pkSess_3475),sign(h(m1_3480),skCli_2990)));
                                                    {3576}in(c, (em2_3481: bitstring,sigM2_3482: bitstring));
                                                    {3577}let m2_3483: bitstring = dec(em2_3481,skCli_2990) in
                                                    {3578}if (verify(h(m2_3483),sigM2_3482,pkSess_3475) <> true) then
                                                        0
                                                    else
                                                        {3579}let (=OpenSecureChannelResponse,PartS_3484: bitstring,ST_3485: bitstring,TTL_3486: bitstring) = m2_3483 in
                                                        {3580}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3581}event endCli(Sess,Cli,PartS_3484)
                                            )
                                            else
                                                {3582}let pkSess_3487: bitstring = fail-any in
                                                {3583}out(c, GetEndpointRequest);
                                                {3584}in(c, (=GetEndpointResponse,=pkSess_3487,=SignAndEncrypt,SP_3488: bitstring,UP_3489: bitstring));
                                                {3585}new Nc_3490: bitstring;
                                                {3586}let gNc_3491: bitstring = exp(g,Nc_3490) in
                                                {3587}let m1_3492: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3491) in
                                                {3588}event beginCli(Cli,Sess,gNc_3491);
                                                {3589}out(c, (pkCli_2991,enc(m1_3492,pkSess_3487),sign(h(m1_3492),skCli_2990)));
                                                {3590}in(c, (em2_3493: bitstring,sigM2_3494: bitstring));
                                                {3591}let m2_3495: bitstring = dec(em2_3493,skCli_2990) in
                                                {3592}if (verify(h(m2_3495),sigM2_3494,pkSess_3487) <> true) then
                                                    0
                                                else
                                                    {3593}let (=OpenSecureChannelResponse,PartS_3496: bitstring,ST_3497: bitstring,TTL_3498: bitstring) = m2_3495 in
                                                    {3594}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3595}event endCli(Sess,Cli,PartS_3496)
                                    )
                                    else
                                        {3596}let pkSess_3499: bitstring = fail-any in
                                        {3597}out(c, GetEndpointRequest);
                                        {3598}in(c, (=GetEndpointResponse,=pkSess_3499,=SignAndEncrypt,SP_3500: bitstring,UP_3501: bitstring));
                                        {3599}new Nc_3502: bitstring;
                                        {3600}let gNc_3503: bitstring = exp(g,Nc_3502) in
                                        {3601}let m1_3504: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3503) in
                                        {3602}event beginCli(Cli,Sess,gNc_3503);
                                        {3603}out(c, (pkCli_2991,enc(m1_3504,pkSess_3499),sign(h(m1_3504),skCli_2990)));
                                        {3604}in(c, (em2_3505: bitstring,sigM2_3506: bitstring));
                                        {3605}let m2_3507: bitstring = dec(em2_3505,skCli_2990) in
                                        {3606}if (verify(h(m2_3507),sigM2_3506,pkSess_3499) <> true) then
                                            0
                                        else
                                            {3607}let (=OpenSecureChannelResponse,PartS_3508: bitstring,ST_3509: bitstring,TTL_3510: bitstring) = m2_3507 in
                                            {3608}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3609}event endCli(Sess,Cli,PartS_3508)
                            )
                            else
                                {3610}let pkSess_3511: bitstring = fail-any in
                                {3611}out(c, GetEndpointRequest);
                                {3612}in(c, (=GetEndpointResponse,=pkSess_3511,=SignAndEncrypt,SP_3512: bitstring,UP_3513: bitstring));
                                {3613}new Nc_3514: bitstring;
                                {3614}let gNc_3515: bitstring = exp(g,Nc_3514) in
                                {3615}let m1_3516: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3515) in
                                {3616}event beginCli(Cli,Sess,gNc_3515);
                                {3617}out(c, (pkCli_2991,enc(m1_3516,pkSess_3511),sign(h(m1_3516),skCli_2990)));
                                {3618}in(c, (em2_3517: bitstring,sigM2_3518: bitstring));
                                {3619}let m2_3519: bitstring = dec(em2_3517,skCli_2990) in
                                {3620}if (verify(h(m2_3519),sigM2_3518,pkSess_3511) <> true) then
                                    0
                                else
                                    {3621}let (=OpenSecureChannelResponse,PartS_3520: bitstring,ST_3521: bitstring,TTL_3522: bitstring) = m2_3519 in
                                    {3622}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3623}event endCli(Sess,Cli,PartS_3520)
                )
                else
                    {3624}let pkDisco_3523: bitstring = fail-any in
                    {3625}let v_3524: bool = (Sess = A) in
                    (
                        {3626}if v_3524 then
                        (
                            {3627}let pkSess_3525: bitstring = pub(skA) in
                            {3628}out(c, GetEndpointRequest);
                            {3629}in(c, (=GetEndpointResponse,=pkSess_3525,=SignAndEncrypt,SP_3526: bitstring,UP_3527: bitstring));
                            {3630}new Nc_3528: bitstring;
                            {3631}let gNc_3529: bitstring = exp(g,Nc_3528) in
                            {3632}let m1_3530: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3529) in
                            {3633}event beginCli(Cli,Sess,gNc_3529);
                            {3634}out(c, (pkCli_2991,enc(m1_3530,pkSess_3525),sign(h(m1_3530),skCli_2990)));
                            {3635}in(c, (em2_3531: bitstring,sigM2_3532: bitstring));
                            {3636}let m2_3533: bitstring = dec(em2_3531,skCli_2990) in
                            {3637}if (verify(h(m2_3533),sigM2_3532,pkSess_3525) <> true) then
                                0
                            else
                                {3638}let (=OpenSecureChannelResponse,PartS_3534: bitstring,ST_3535: bitstring,TTL_3536: bitstring) = m2_3533 in
                                {3639}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3640}event endCli(Sess,Cli,PartS_3534)
                        )
                        else
                            {3641}let v_3537: bool = (Sess = B) in
                            (
                                {3642}if v_3537 then
                                (
                                    {3643}let pkSess_3538: bitstring = pub(skB) in
                                    {3644}out(c, GetEndpointRequest);
                                    {3645}in(c, (=GetEndpointResponse,=pkSess_3538,=SignAndEncrypt,SP_3539: bitstring,UP_3540: bitstring));
                                    {3646}new Nc_3541: bitstring;
                                    {3647}let gNc_3542: bitstring = exp(g,Nc_3541) in
                                    {3648}let m1_3543: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3542) in
                                    {3649}event beginCli(Cli,Sess,gNc_3542);
                                    {3650}out(c, (pkCli_2991,enc(m1_3543,pkSess_3538),sign(h(m1_3543),skCli_2990)));
                                    {3651}in(c, (em2_3544: bitstring,sigM2_3545: bitstring));
                                    {3652}let m2_3546: bitstring = dec(em2_3544,skCli_2990) in
                                    {3653}if (verify(h(m2_3546),sigM2_3545,pkSess_3538) <> true) then
                                        0
                                    else
                                        {3654}let (=OpenSecureChannelResponse,PartS_3547: bitstring,ST_3548: bitstring,TTL_3549: bitstring) = m2_3546 in
                                        {3655}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3656}event endCli(Sess,Cli,PartS_3547)
                                )
                                else
                                    {3657}let v_3550: bool = (Sess = C) in
                                    (
                                        {3658}if v_3550 then
                                        (
                                            {3659}let pkSess_3551: bitstring = pub(skC) in
                                            {3660}out(c, GetEndpointRequest);
                                            {3661}in(c, (=GetEndpointResponse,=pkSess_3551,=SignAndEncrypt,SP_3552: bitstring,UP_3553: bitstring));
                                            {3662}new Nc_3554: bitstring;
                                            {3663}let gNc_3555: bitstring = exp(g,Nc_3554) in
                                            {3664}let m1_3556: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3555) in
                                            {3665}event beginCli(Cli,Sess,gNc_3555);
                                            {3666}out(c, (pkCli_2991,enc(m1_3556,pkSess_3551),sign(h(m1_3556),skCli_2990)));
                                            {3667}in(c, (em2_3557: bitstring,sigM2_3558: bitstring));
                                            {3668}let m2_3559: bitstring = dec(em2_3557,skCli_2990) in
                                            {3669}if (verify(h(m2_3559),sigM2_3558,pkSess_3551) <> true) then
                                                0
                                            else
                                                {3670}let (=OpenSecureChannelResponse,PartS_3560: bitstring,ST_3561: bitstring,TTL_3562: bitstring) = m2_3559 in
                                                {3671}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3672}event endCli(Sess,Cli,PartS_3560)
                                        )
                                        else
                                            {3673}let pkSess_3563: bitstring = pub(sk(Sess)) in
                                            {3674}out(c, GetEndpointRequest);
                                            {3675}in(c, (=GetEndpointResponse,=pkSess_3563,=SignAndEncrypt,SP_3564: bitstring,UP_3565: bitstring));
                                            {3676}new Nc_3566: bitstring;
                                            {3677}let gNc_3567: bitstring = exp(g,Nc_3566) in
                                            {3678}let m1_3568: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3567) in
                                            {3679}event beginCli(Cli,Sess,gNc_3567);
                                            {3680}out(c, (pkCli_2991,enc(m1_3568,pkSess_3563),sign(h(m1_3568),skCli_2990)));
                                            {3681}in(c, (em2_3569: bitstring,sigM2_3570: bitstring));
                                            {3682}let m2_3571: bitstring = dec(em2_3569,skCli_2990) in
                                            {3683}if (verify(h(m2_3571),sigM2_3570,pkSess_3563) <> true) then
                                                0
                                            else
                                                {3684}let (=OpenSecureChannelResponse,PartS_3572: bitstring,ST_3573: bitstring,TTL_3574: bitstring) = m2_3571 in
                                                {3685}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3686}event endCli(Sess,Cli,PartS_3572)
                                    )
                                    else
                                        {3687}let pkSess_3575: bitstring = fail-any in
                                        {3688}out(c, GetEndpointRequest);
                                        {3689}in(c, (=GetEndpointResponse,=pkSess_3575,=SignAndEncrypt,SP_3576: bitstring,UP_3577: bitstring));
                                        {3690}new Nc_3578: bitstring;
                                        {3691}let gNc_3579: bitstring = exp(g,Nc_3578) in
                                        {3692}let m1_3580: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3579) in
                                        {3693}event beginCli(Cli,Sess,gNc_3579);
                                        {3694}out(c, (pkCli_2991,enc(m1_3580,pkSess_3575),sign(h(m1_3580),skCli_2990)));
                                        {3695}in(c, (em2_3581: bitstring,sigM2_3582: bitstring));
                                        {3696}let m2_3583: bitstring = dec(em2_3581,skCli_2990) in
                                        {3697}if (verify(h(m2_3583),sigM2_3582,pkSess_3575) <> true) then
                                            0
                                        else
                                            {3698}let (=OpenSecureChannelResponse,PartS_3584: bitstring,ST_3585: bitstring,TTL_3586: bitstring) = m2_3583 in
                                            {3699}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3700}event endCli(Sess,Cli,PartS_3584)
                            )
                            else
                                {3701}let pkSess_3587: bitstring = fail-any in
                                {3702}out(c, GetEndpointRequest);
                                {3703}in(c, (=GetEndpointResponse,=pkSess_3587,=SignAndEncrypt,SP_3588: bitstring,UP_3589: bitstring));
                                {3704}new Nc_3590: bitstring;
                                {3705}let gNc_3591: bitstring = exp(g,Nc_3590) in
                                {3706}let m1_3592: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3591) in
                                {3707}event beginCli(Cli,Sess,gNc_3591);
                                {3708}out(c, (pkCli_2991,enc(m1_3592,pkSess_3587),sign(h(m1_3592),skCli_2990)));
                                {3709}in(c, (em2_3593: bitstring,sigM2_3594: bitstring));
                                {3710}let m2_3595: bitstring = dec(em2_3593,skCli_2990) in
                                {3711}if (verify(h(m2_3595),sigM2_3594,pkSess_3587) <> true) then
                                    0
                                else
                                    {3712}let (=OpenSecureChannelResponse,PartS_3596: bitstring,ST_3597: bitstring,TTL_3598: bitstring) = m2_3595 in
                                    {3713}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3714}event endCli(Sess,Cli,PartS_3596)
                    )
                    else
                        {3715}let pkSess_3599: bitstring = fail-any in
                        {3716}out(c, GetEndpointRequest);
                        {3717}in(c, (=GetEndpointResponse,=pkSess_3599,=SignAndEncrypt,SP_3600: bitstring,UP_3601: bitstring));
                        {3718}new Nc_3602: bitstring;
                        {3719}let gNc_3603: bitstring = exp(g,Nc_3602) in
                        {3720}let m1_3604: bitstring = (OpenSecureChannelRequest,pkCli_2991,gNc_3603) in
                        {3721}event beginCli(Cli,Sess,gNc_3603);
                        {3722}out(c, (pkCli_2991,enc(m1_3604,pkSess_3599),sign(h(m1_3604),skCli_2990)));
                        {3723}in(c, (em2_3605: bitstring,sigM2_3606: bitstring));
                        {3724}let m2_3607: bitstring = dec(em2_3605,skCli_2990) in
                        {3725}if (verify(h(m2_3607),sigM2_3606,pkSess_3599) <> true) then
                            0
                        else
                            {3726}let (=OpenSecureChannelResponse,PartS_3608: bitstring,ST_3609: bitstring,TTL_3610: bitstring) = m2_3607 in
                            {3727}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3728}event endCli(Sess,Cli,PartS_3608)
    )
    else
        {3729}let skCli_3611: bitstring = fail-any in
        {3730}let pkCli_3612: bitstring = pub(skCli_3611) in
        {3731}let v_3613: bool = (Disco = A) in
        (
            {3732}if v_3613 then
            (
                {3733}let pkDisco_3614: bitstring = pub(skA) in
                {3734}let v_3615: bool = (Sess = A) in
                (
                    {3735}if v_3615 then
                    (
                        {3736}let pkSess_3616: bitstring = pub(skA) in
                        {3737}out(c, GetEndpointRequest);
                        {3738}in(c, (=GetEndpointResponse,=pkSess_3616,=SignAndEncrypt,SP_3617: bitstring,UP_3618: bitstring));
                        {3739}new Nc_3619: bitstring;
                        {3740}let gNc_3620: bitstring = exp(g,Nc_3619) in
                        {3741}let m1_3621: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3620) in
                        {3742}event beginCli(Cli,Sess,gNc_3620);
                        {3743}out(c, (pkCli_3612,enc(m1_3621,pkSess_3616),sign(h(m1_3621),skCli_3611)));
                        {3744}in(c, (em2_3622: bitstring,sigM2_3623: bitstring));
                        {3745}let m2_3624: bitstring = dec(em2_3622,skCli_3611) in
                        {3746}if (verify(h(m2_3624),sigM2_3623,pkSess_3616) <> true) then
                            0
                        else
                            {3747}let (=OpenSecureChannelResponse,PartS_3625: bitstring,ST_3626: bitstring,TTL_3627: bitstring) = m2_3624 in
                            {3748}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3749}event endCli(Sess,Cli,PartS_3625)
                    )
                    else
                        {3750}let v_3628: bool = (Sess = B) in
                        (
                            {3751}if v_3628 then
                            (
                                {3752}let pkSess_3629: bitstring = pub(skB) in
                                {3753}out(c, GetEndpointRequest);
                                {3754}in(c, (=GetEndpointResponse,=pkSess_3629,=SignAndEncrypt,SP_3630: bitstring,UP_3631: bitstring));
                                {3755}new Nc_3632: bitstring;
                                {3756}let gNc_3633: bitstring = exp(g,Nc_3632) in
                                {3757}let m1_3634: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3633) in
                                {3758}event beginCli(Cli,Sess,gNc_3633);
                                {3759}out(c, (pkCli_3612,enc(m1_3634,pkSess_3629),sign(h(m1_3634),skCli_3611)));
                                {3760}in(c, (em2_3635: bitstring,sigM2_3636: bitstring));
                                {3761}let m2_3637: bitstring = dec(em2_3635,skCli_3611) in
                                {3762}if (verify(h(m2_3637),sigM2_3636,pkSess_3629) <> true) then
                                    0
                                else
                                    {3763}let (=OpenSecureChannelResponse,PartS_3638: bitstring,ST_3639: bitstring,TTL_3640: bitstring) = m2_3637 in
                                    {3764}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3765}event endCli(Sess,Cli,PartS_3638)
                            )
                            else
                                {3766}let v_3641: bool = (Sess = C) in
                                (
                                    {3767}if v_3641 then
                                    (
                                        {3768}let pkSess_3642: bitstring = pub(skC) in
                                        {3769}out(c, GetEndpointRequest);
                                        {3770}in(c, (=GetEndpointResponse,=pkSess_3642,=SignAndEncrypt,SP_3643: bitstring,UP_3644: bitstring));
                                        {3771}new Nc_3645: bitstring;
                                        {3772}let gNc_3646: bitstring = exp(g,Nc_3645) in
                                        {3773}let m1_3647: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3646) in
                                        {3774}event beginCli(Cli,Sess,gNc_3646);
                                        {3775}out(c, (pkCli_3612,enc(m1_3647,pkSess_3642),sign(h(m1_3647),skCli_3611)));
                                        {3776}in(c, (em2_3648: bitstring,sigM2_3649: bitstring));
                                        {3777}let m2_3650: bitstring = dec(em2_3648,skCli_3611) in
                                        {3778}if (verify(h(m2_3650),sigM2_3649,pkSess_3642) <> true) then
                                            0
                                        else
                                            {3779}let (=OpenSecureChannelResponse,PartS_3651: bitstring,ST_3652: bitstring,TTL_3653: bitstring) = m2_3650 in
                                            {3780}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3781}event endCli(Sess,Cli,PartS_3651)
                                    )
                                    else
                                        {3782}let pkSess_3654: bitstring = pub(sk(Sess)) in
                                        {3783}out(c, GetEndpointRequest);
                                        {3784}in(c, (=GetEndpointResponse,=pkSess_3654,=SignAndEncrypt,SP_3655: bitstring,UP_3656: bitstring));
                                        {3785}new Nc_3657: bitstring;
                                        {3786}let gNc_3658: bitstring = exp(g,Nc_3657) in
                                        {3787}let m1_3659: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3658) in
                                        {3788}event beginCli(Cli,Sess,gNc_3658);
                                        {3789}out(c, (pkCli_3612,enc(m1_3659,pkSess_3654),sign(h(m1_3659),skCli_3611)));
                                        {3790}in(c, (em2_3660: bitstring,sigM2_3661: bitstring));
                                        {3791}let m2_3662: bitstring = dec(em2_3660,skCli_3611) in
                                        {3792}if (verify(h(m2_3662),sigM2_3661,pkSess_3654) <> true) then
                                            0
                                        else
                                            {3793}let (=OpenSecureChannelResponse,PartS_3663: bitstring,ST_3664: bitstring,TTL_3665: bitstring) = m2_3662 in
                                            {3794}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3795}event endCli(Sess,Cli,PartS_3663)
                                )
                                else
                                    {3796}let pkSess_3666: bitstring = fail-any in
                                    {3797}out(c, GetEndpointRequest);
                                    {3798}in(c, (=GetEndpointResponse,=pkSess_3666,=SignAndEncrypt,SP_3667: bitstring,UP_3668: bitstring));
                                    {3799}new Nc_3669: bitstring;
                                    {3800}let gNc_3670: bitstring = exp(g,Nc_3669) in
                                    {3801}let m1_3671: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3670) in
                                    {3802}event beginCli(Cli,Sess,gNc_3670);
                                    {3803}out(c, (pkCli_3612,enc(m1_3671,pkSess_3666),sign(h(m1_3671),skCli_3611)));
                                    {3804}in(c, (em2_3672: bitstring,sigM2_3673: bitstring));
                                    {3805}let m2_3674: bitstring = dec(em2_3672,skCli_3611) in
                                    {3806}if (verify(h(m2_3674),sigM2_3673,pkSess_3666) <> true) then
                                        0
                                    else
                                        {3807}let (=OpenSecureChannelResponse,PartS_3675: bitstring,ST_3676: bitstring,TTL_3677: bitstring) = m2_3674 in
                                        {3808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3809}event endCli(Sess,Cli,PartS_3675)
                        )
                        else
                            {3810}let pkSess_3678: bitstring = fail-any in
                            {3811}out(c, GetEndpointRequest);
                            {3812}in(c, (=GetEndpointResponse,=pkSess_3678,=SignAndEncrypt,SP_3679: bitstring,UP_3680: bitstring));
                            {3813}new Nc_3681: bitstring;
                            {3814}let gNc_3682: bitstring = exp(g,Nc_3681) in
                            {3815}let m1_3683: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3682) in
                            {3816}event beginCli(Cli,Sess,gNc_3682);
                            {3817}out(c, (pkCli_3612,enc(m1_3683,pkSess_3678),sign(h(m1_3683),skCli_3611)));
                            {3818}in(c, (em2_3684: bitstring,sigM2_3685: bitstring));
                            {3819}let m2_3686: bitstring = dec(em2_3684,skCli_3611) in
                            {3820}if (verify(h(m2_3686),sigM2_3685,pkSess_3678) <> true) then
                                0
                            else
                                {3821}let (=OpenSecureChannelResponse,PartS_3687: bitstring,ST_3688: bitstring,TTL_3689: bitstring) = m2_3686 in
                                {3822}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3823}event endCli(Sess,Cli,PartS_3687)
                )
                else
                    {3824}let pkSess_3690: bitstring = fail-any in
                    {3825}out(c, GetEndpointRequest);
                    {3826}in(c, (=GetEndpointResponse,=pkSess_3690,=SignAndEncrypt,SP_3691: bitstring,UP_3692: bitstring));
                    {3827}new Nc_3693: bitstring;
                    {3828}let gNc_3694: bitstring = exp(g,Nc_3693) in
                    {3829}let m1_3695: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3694) in
                    {3830}event beginCli(Cli,Sess,gNc_3694);
                    {3831}out(c, (pkCli_3612,enc(m1_3695,pkSess_3690),sign(h(m1_3695),skCli_3611)));
                    {3832}in(c, (em2_3696: bitstring,sigM2_3697: bitstring));
                    {3833}let m2_3698: bitstring = dec(em2_3696,skCli_3611) in
                    {3834}if (verify(h(m2_3698),sigM2_3697,pkSess_3690) <> true) then
                        0
                    else
                        {3835}let (=OpenSecureChannelResponse,PartS_3699: bitstring,ST_3700: bitstring,TTL_3701: bitstring) = m2_3698 in
                        {3836}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3837}event endCli(Sess,Cli,PartS_3699)
            )
            else
                {3838}let v_3702: bool = (Disco = B) in
                (
                    {3839}if v_3702 then
                    (
                        {3840}let pkDisco_3703: bitstring = pub(skB) in
                        {3841}let v_3704: bool = (Sess = A) in
                        (
                            {3842}if v_3704 then
                            (
                                {3843}let pkSess_3705: bitstring = pub(skA) in
                                {3844}out(c, GetEndpointRequest);
                                {3845}in(c, (=GetEndpointResponse,=pkSess_3705,=SignAndEncrypt,SP_3706: bitstring,UP_3707: bitstring));
                                {3846}new Nc_3708: bitstring;
                                {3847}let gNc_3709: bitstring = exp(g,Nc_3708) in
                                {3848}let m1_3710: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3709) in
                                {3849}event beginCli(Cli,Sess,gNc_3709);
                                {3850}out(c, (pkCli_3612,enc(m1_3710,pkSess_3705),sign(h(m1_3710),skCli_3611)));
                                {3851}in(c, (em2_3711: bitstring,sigM2_3712: bitstring));
                                {3852}let m2_3713: bitstring = dec(em2_3711,skCli_3611) in
                                {3853}if (verify(h(m2_3713),sigM2_3712,pkSess_3705) <> true) then
                                    0
                                else
                                    {3854}let (=OpenSecureChannelResponse,PartS_3714: bitstring,ST_3715: bitstring,TTL_3716: bitstring) = m2_3713 in
                                    {3855}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3856}event endCli(Sess,Cli,PartS_3714)
                            )
                            else
                                {3857}let v_3717: bool = (Sess = B) in
                                (
                                    {3858}if v_3717 then
                                    (
                                        {3859}let pkSess_3718: bitstring = pub(skB) in
                                        {3860}out(c, GetEndpointRequest);
                                        {3861}in(c, (=GetEndpointResponse,=pkSess_3718,=SignAndEncrypt,SP_3719: bitstring,UP_3720: bitstring));
                                        {3862}new Nc_3721: bitstring;
                                        {3863}let gNc_3722: bitstring = exp(g,Nc_3721) in
                                        {3864}let m1_3723: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3722) in
                                        {3865}event beginCli(Cli,Sess,gNc_3722);
                                        {3866}out(c, (pkCli_3612,enc(m1_3723,pkSess_3718),sign(h(m1_3723),skCli_3611)));
                                        {3867}in(c, (em2_3724: bitstring,sigM2_3725: bitstring));
                                        {3868}let m2_3726: bitstring = dec(em2_3724,skCli_3611) in
                                        {3869}if (verify(h(m2_3726),sigM2_3725,pkSess_3718) <> true) then
                                            0
                                        else
                                            {3870}let (=OpenSecureChannelResponse,PartS_3727: bitstring,ST_3728: bitstring,TTL_3729: bitstring) = m2_3726 in
                                            {3871}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3872}event endCli(Sess,Cli,PartS_3727)
                                    )
                                    else
                                        {3873}let v_3730: bool = (Sess = C) in
                                        (
                                            {3874}if v_3730 then
                                            (
                                                {3875}let pkSess_3731: bitstring = pub(skC) in
                                                {3876}out(c, GetEndpointRequest);
                                                {3877}in(c, (=GetEndpointResponse,=pkSess_3731,=SignAndEncrypt,SP_3732: bitstring,UP_3733: bitstring));
                                                {3878}new Nc_3734: bitstring;
                                                {3879}let gNc_3735: bitstring = exp(g,Nc_3734) in
                                                {3880}let m1_3736: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3735) in
                                                {3881}event beginCli(Cli,Sess,gNc_3735);
                                                {3882}out(c, (pkCli_3612,enc(m1_3736,pkSess_3731),sign(h(m1_3736),skCli_3611)));
                                                {3883}in(c, (em2_3737: bitstring,sigM2_3738: bitstring));
                                                {3884}let m2_3739: bitstring = dec(em2_3737,skCli_3611) in
                                                {3885}if (verify(h(m2_3739),sigM2_3738,pkSess_3731) <> true) then
                                                    0
                                                else
                                                    {3886}let (=OpenSecureChannelResponse,PartS_3740: bitstring,ST_3741: bitstring,TTL_3742: bitstring) = m2_3739 in
                                                    {3887}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3888}event endCli(Sess,Cli,PartS_3740)
                                            )
                                            else
                                                {3889}let pkSess_3743: bitstring = pub(sk(Sess)) in
                                                {3890}out(c, GetEndpointRequest);
                                                {3891}in(c, (=GetEndpointResponse,=pkSess_3743,=SignAndEncrypt,SP_3744: bitstring,UP_3745: bitstring));
                                                {3892}new Nc_3746: bitstring;
                                                {3893}let gNc_3747: bitstring = exp(g,Nc_3746) in
                                                {3894}let m1_3748: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3747) in
                                                {3895}event beginCli(Cli,Sess,gNc_3747);
                                                {3896}out(c, (pkCli_3612,enc(m1_3748,pkSess_3743),sign(h(m1_3748),skCli_3611)));
                                                {3897}in(c, (em2_3749: bitstring,sigM2_3750: bitstring));
                                                {3898}let m2_3751: bitstring = dec(em2_3749,skCli_3611) in
                                                {3899}if (verify(h(m2_3751),sigM2_3750,pkSess_3743) <> true) then
                                                    0
                                                else
                                                    {3900}let (=OpenSecureChannelResponse,PartS_3752: bitstring,ST_3753: bitstring,TTL_3754: bitstring) = m2_3751 in
                                                    {3901}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3902}event endCli(Sess,Cli,PartS_3752)
                                        )
                                        else
                                            {3903}let pkSess_3755: bitstring = fail-any in
                                            {3904}out(c, GetEndpointRequest);
                                            {3905}in(c, (=GetEndpointResponse,=pkSess_3755,=SignAndEncrypt,SP_3756: bitstring,UP_3757: bitstring));
                                            {3906}new Nc_3758: bitstring;
                                            {3907}let gNc_3759: bitstring = exp(g,Nc_3758) in
                                            {3908}let m1_3760: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3759) in
                                            {3909}event beginCli(Cli,Sess,gNc_3759);
                                            {3910}out(c, (pkCli_3612,enc(m1_3760,pkSess_3755),sign(h(m1_3760),skCli_3611)));
                                            {3911}in(c, (em2_3761: bitstring,sigM2_3762: bitstring));
                                            {3912}let m2_3763: bitstring = dec(em2_3761,skCli_3611) in
                                            {3913}if (verify(h(m2_3763),sigM2_3762,pkSess_3755) <> true) then
                                                0
                                            else
                                                {3914}let (=OpenSecureChannelResponse,PartS_3764: bitstring,ST_3765: bitstring,TTL_3766: bitstring) = m2_3763 in
                                                {3915}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3916}event endCli(Sess,Cli,PartS_3764)
                                )
                                else
                                    {3917}let pkSess_3767: bitstring = fail-any in
                                    {3918}out(c, GetEndpointRequest);
                                    {3919}in(c, (=GetEndpointResponse,=pkSess_3767,=SignAndEncrypt,SP_3768: bitstring,UP_3769: bitstring));
                                    {3920}new Nc_3770: bitstring;
                                    {3921}let gNc_3771: bitstring = exp(g,Nc_3770) in
                                    {3922}let m1_3772: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3771) in
                                    {3923}event beginCli(Cli,Sess,gNc_3771);
                                    {3924}out(c, (pkCli_3612,enc(m1_3772,pkSess_3767),sign(h(m1_3772),skCli_3611)));
                                    {3925}in(c, (em2_3773: bitstring,sigM2_3774: bitstring));
                                    {3926}let m2_3775: bitstring = dec(em2_3773,skCli_3611) in
                                    {3927}if (verify(h(m2_3775),sigM2_3774,pkSess_3767) <> true) then
                                        0
                                    else
                                        {3928}let (=OpenSecureChannelResponse,PartS_3776: bitstring,ST_3777: bitstring,TTL_3778: bitstring) = m2_3775 in
                                        {3929}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3930}event endCli(Sess,Cli,PartS_3776)
                        )
                        else
                            {3931}let pkSess_3779: bitstring = fail-any in
                            {3932}out(c, GetEndpointRequest);
                            {3933}in(c, (=GetEndpointResponse,=pkSess_3779,=SignAndEncrypt,SP_3780: bitstring,UP_3781: bitstring));
                            {3934}new Nc_3782: bitstring;
                            {3935}let gNc_3783: bitstring = exp(g,Nc_3782) in
                            {3936}let m1_3784: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3783) in
                            {3937}event beginCli(Cli,Sess,gNc_3783);
                            {3938}out(c, (pkCli_3612,enc(m1_3784,pkSess_3779),sign(h(m1_3784),skCli_3611)));
                            {3939}in(c, (em2_3785: bitstring,sigM2_3786: bitstring));
                            {3940}let m2_3787: bitstring = dec(em2_3785,skCli_3611) in
                            {3941}if (verify(h(m2_3787),sigM2_3786,pkSess_3779) <> true) then
                                0
                            else
                                {3942}let (=OpenSecureChannelResponse,PartS_3788: bitstring,ST_3789: bitstring,TTL_3790: bitstring) = m2_3787 in
                                {3943}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3944}event endCli(Sess,Cli,PartS_3788)
                    )
                    else
                        {3945}let v_3791: bool = (Disco = C) in
                        (
                            {3946}if v_3791 then
                            (
                                {3947}let pkDisco_3792: bitstring = pub(skC) in
                                {3948}let v_3793: bool = (Sess = A) in
                                (
                                    {3949}if v_3793 then
                                    (
                                        {3950}let pkSess_3794: bitstring = pub(skA) in
                                        {3951}out(c, GetEndpointRequest);
                                        {3952}in(c, (=GetEndpointResponse,=pkSess_3794,=SignAndEncrypt,SP_3795: bitstring,UP_3796: bitstring));
                                        {3953}new Nc_3797: bitstring;
                                        {3954}let gNc_3798: bitstring = exp(g,Nc_3797) in
                                        {3955}let m1_3799: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3798) in
                                        {3956}event beginCli(Cli,Sess,gNc_3798);
                                        {3957}out(c, (pkCli_3612,enc(m1_3799,pkSess_3794),sign(h(m1_3799),skCli_3611)));
                                        {3958}in(c, (em2_3800: bitstring,sigM2_3801: bitstring));
                                        {3959}let m2_3802: bitstring = dec(em2_3800,skCli_3611) in
                                        {3960}if (verify(h(m2_3802),sigM2_3801,pkSess_3794) <> true) then
                                            0
                                        else
                                            {3961}let (=OpenSecureChannelResponse,PartS_3803: bitstring,ST_3804: bitstring,TTL_3805: bitstring) = m2_3802 in
                                            {3962}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3963}event endCli(Sess,Cli,PartS_3803)
                                    )
                                    else
                                        {3964}let v_3806: bool = (Sess = B) in
                                        (
                                            {3965}if v_3806 then
                                            (
                                                {3966}let pkSess_3807: bitstring = pub(skB) in
                                                {3967}out(c, GetEndpointRequest);
                                                {3968}in(c, (=GetEndpointResponse,=pkSess_3807,=SignAndEncrypt,SP_3808: bitstring,UP_3809: bitstring));
                                                {3969}new Nc_3810: bitstring;
                                                {3970}let gNc_3811: bitstring = exp(g,Nc_3810) in
                                                {3971}let m1_3812: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3811) in
                                                {3972}event beginCli(Cli,Sess,gNc_3811);
                                                {3973}out(c, (pkCli_3612,enc(m1_3812,pkSess_3807),sign(h(m1_3812),skCli_3611)));
                                                {3974}in(c, (em2_3813: bitstring,sigM2_3814: bitstring));
                                                {3975}let m2_3815: bitstring = dec(em2_3813,skCli_3611) in
                                                {3976}if (verify(h(m2_3815),sigM2_3814,pkSess_3807) <> true) then
                                                    0
                                                else
                                                    {3977}let (=OpenSecureChannelResponse,PartS_3816: bitstring,ST_3817: bitstring,TTL_3818: bitstring) = m2_3815 in
                                                    {3978}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3979}event endCli(Sess,Cli,PartS_3816)
                                            )
                                            else
                                                {3980}let v_3819: bool = (Sess = C) in
                                                (
                                                    {3981}if v_3819 then
                                                    (
                                                        {3982}let pkSess_3820: bitstring = pub(skC) in
                                                        {3983}out(c, GetEndpointRequest);
                                                        {3984}in(c, (=GetEndpointResponse,=pkSess_3820,=SignAndEncrypt,SP_3821: bitstring,UP_3822: bitstring));
                                                        {3985}new Nc_3823: bitstring;
                                                        {3986}let gNc_3824: bitstring = exp(g,Nc_3823) in
                                                        {3987}let m1_3825: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3824) in
                                                        {3988}event beginCli(Cli,Sess,gNc_3824);
                                                        {3989}out(c, (pkCli_3612,enc(m1_3825,pkSess_3820),sign(h(m1_3825),skCli_3611)));
                                                        {3990}in(c, (em2_3826: bitstring,sigM2_3827: bitstring));
                                                        {3991}let m2_3828: bitstring = dec(em2_3826,skCli_3611) in
                                                        {3992}if (verify(h(m2_3828),sigM2_3827,pkSess_3820) <> true) then
                                                            0
                                                        else
                                                            {3993}let (=OpenSecureChannelResponse,PartS_3829: bitstring,ST_3830: bitstring,TTL_3831: bitstring) = m2_3828 in
                                                            {3994}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3995}event endCli(Sess,Cli,PartS_3829)
                                                    )
                                                    else
                                                        {3996}let pkSess_3832: bitstring = pub(sk(Sess)) in
                                                        {3997}out(c, GetEndpointRequest);
                                                        {3998}in(c, (=GetEndpointResponse,=pkSess_3832,=SignAndEncrypt,SP_3833: bitstring,UP_3834: bitstring));
                                                        {3999}new Nc_3835: bitstring;
                                                        {4000}let gNc_3836: bitstring = exp(g,Nc_3835) in
                                                        {4001}let m1_3837: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3836) in
                                                        {4002}event beginCli(Cli,Sess,gNc_3836);
                                                        {4003}out(c, (pkCli_3612,enc(m1_3837,pkSess_3832),sign(h(m1_3837),skCli_3611)));
                                                        {4004}in(c, (em2_3838: bitstring,sigM2_3839: bitstring));
                                                        {4005}let m2_3840: bitstring = dec(em2_3838,skCli_3611) in
                                                        {4006}if (verify(h(m2_3840),sigM2_3839,pkSess_3832) <> true) then
                                                            0
                                                        else
                                                            {4007}let (=OpenSecureChannelResponse,PartS_3841: bitstring,ST_3842: bitstring,TTL_3843: bitstring) = m2_3840 in
                                                            {4008}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {4009}event endCli(Sess,Cli,PartS_3841)
                                                )
                                                else
                                                    {4010}let pkSess_3844: bitstring = fail-any in
                                                    {4011}out(c, GetEndpointRequest);
                                                    {4012}in(c, (=GetEndpointResponse,=pkSess_3844,=SignAndEncrypt,SP_3845: bitstring,UP_3846: bitstring));
                                                    {4013}new Nc_3847: bitstring;
                                                    {4014}let gNc_3848: bitstring = exp(g,Nc_3847) in
                                                    {4015}let m1_3849: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3848) in
                                                    {4016}event beginCli(Cli,Sess,gNc_3848);
                                                    {4017}out(c, (pkCli_3612,enc(m1_3849,pkSess_3844),sign(h(m1_3849),skCli_3611)));
                                                    {4018}in(c, (em2_3850: bitstring,sigM2_3851: bitstring));
                                                    {4019}let m2_3852: bitstring = dec(em2_3850,skCli_3611) in
                                                    {4020}if (verify(h(m2_3852),sigM2_3851,pkSess_3844) <> true) then
                                                        0
                                                    else
                                                        {4021}let (=OpenSecureChannelResponse,PartS_3853: bitstring,ST_3854: bitstring,TTL_3855: bitstring) = m2_3852 in
                                                        {4022}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {4023}event endCli(Sess,Cli,PartS_3853)
                                        )
                                        else
                                            {4024}let pkSess_3856: bitstring = fail-any in
                                            {4025}out(c, GetEndpointRequest);
                                            {4026}in(c, (=GetEndpointResponse,=pkSess_3856,=SignAndEncrypt,SP_3857: bitstring,UP_3858: bitstring));
                                            {4027}new Nc_3859: bitstring;
                                            {4028}let gNc_3860: bitstring = exp(g,Nc_3859) in
                                            {4029}let m1_3861: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3860) in
                                            {4030}event beginCli(Cli,Sess,gNc_3860);
                                            {4031}out(c, (pkCli_3612,enc(m1_3861,pkSess_3856),sign(h(m1_3861),skCli_3611)));
                                            {4032}in(c, (em2_3862: bitstring,sigM2_3863: bitstring));
                                            {4033}let m2_3864: bitstring = dec(em2_3862,skCli_3611) in
                                            {4034}if (verify(h(m2_3864),sigM2_3863,pkSess_3856) <> true) then
                                                0
                                            else
                                                {4035}let (=OpenSecureChannelResponse,PartS_3865: bitstring,ST_3866: bitstring,TTL_3867: bitstring) = m2_3864 in
                                                {4036}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4037}event endCli(Sess,Cli,PartS_3865)
                                )
                                else
                                    {4038}let pkSess_3868: bitstring = fail-any in
                                    {4039}out(c, GetEndpointRequest);
                                    {4040}in(c, (=GetEndpointResponse,=pkSess_3868,=SignAndEncrypt,SP_3869: bitstring,UP_3870: bitstring));
                                    {4041}new Nc_3871: bitstring;
                                    {4042}let gNc_3872: bitstring = exp(g,Nc_3871) in
                                    {4043}let m1_3873: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3872) in
                                    {4044}event beginCli(Cli,Sess,gNc_3872);
                                    {4045}out(c, (pkCli_3612,enc(m1_3873,pkSess_3868),sign(h(m1_3873),skCli_3611)));
                                    {4046}in(c, (em2_3874: bitstring,sigM2_3875: bitstring));
                                    {4047}let m2_3876: bitstring = dec(em2_3874,skCli_3611) in
                                    {4048}if (verify(h(m2_3876),sigM2_3875,pkSess_3868) <> true) then
                                        0
                                    else
                                        {4049}let (=OpenSecureChannelResponse,PartS_3877: bitstring,ST_3878: bitstring,TTL_3879: bitstring) = m2_3876 in
                                        {4050}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4051}event endCli(Sess,Cli,PartS_3877)
                            )
                            else
                                {4052}let pkDisco_3880: bitstring = pub(sk(Disco)) in
                                {4053}let v_3881: bool = (Sess = A) in
                                (
                                    {4054}if v_3881 then
                                    (
                                        {4055}let pkSess_3882: bitstring = pub(skA) in
                                        {4056}out(c, GetEndpointRequest);
                                        {4057}in(c, (=GetEndpointResponse,=pkSess_3882,=SignAndEncrypt,SP_3883: bitstring,UP_3884: bitstring));
                                        {4058}new Nc_3885: bitstring;
                                        {4059}let gNc_3886: bitstring = exp(g,Nc_3885) in
                                        {4060}let m1_3887: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3886) in
                                        {4061}event beginCli(Cli,Sess,gNc_3886);
                                        {4062}out(c, (pkCli_3612,enc(m1_3887,pkSess_3882),sign(h(m1_3887),skCli_3611)));
                                        {4063}in(c, (em2_3888: bitstring,sigM2_3889: bitstring));
                                        {4064}let m2_3890: bitstring = dec(em2_3888,skCli_3611) in
                                        {4065}if (verify(h(m2_3890),sigM2_3889,pkSess_3882) <> true) then
                                            0
                                        else
                                            {4066}let (=OpenSecureChannelResponse,PartS_3891: bitstring,ST_3892: bitstring,TTL_3893: bitstring) = m2_3890 in
                                            {4067}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4068}event endCli(Sess,Cli,PartS_3891)
                                    )
                                    else
                                        {4069}let v_3894: bool = (Sess = B) in
                                        (
                                            {4070}if v_3894 then
                                            (
                                                {4071}let pkSess_3895: bitstring = pub(skB) in
                                                {4072}out(c, GetEndpointRequest);
                                                {4073}in(c, (=GetEndpointResponse,=pkSess_3895,=SignAndEncrypt,SP_3896: bitstring,UP_3897: bitstring));
                                                {4074}new Nc_3898: bitstring;
                                                {4075}let gNc_3899: bitstring = exp(g,Nc_3898) in
                                                {4076}let m1_3900: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3899) in
                                                {4077}event beginCli(Cli,Sess,gNc_3899);
                                                {4078}out(c, (pkCli_3612,enc(m1_3900,pkSess_3895),sign(h(m1_3900),skCli_3611)));
                                                {4079}in(c, (em2_3901: bitstring,sigM2_3902: bitstring));
                                                {4080}let m2_3903: bitstring = dec(em2_3901,skCli_3611) in
                                                {4081}if (verify(h(m2_3903),sigM2_3902,pkSess_3895) <> true) then
                                                    0
                                                else
                                                    {4082}let (=OpenSecureChannelResponse,PartS_3904: bitstring,ST_3905: bitstring,TTL_3906: bitstring) = m2_3903 in
                                                    {4083}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {4084}event endCli(Sess,Cli,PartS_3904)
                                            )
                                            else
                                                {4085}let v_3907: bool = (Sess = C) in
                                                (
                                                    {4086}if v_3907 then
                                                    (
                                                        {4087}let pkSess_3908: bitstring = pub(skC) in
                                                        {4088}out(c, GetEndpointRequest);
                                                        {4089}in(c, (=GetEndpointResponse,=pkSess_3908,=SignAndEncrypt,SP_3909: bitstring,UP_3910: bitstring));
                                                        {4090}new Nc_3911: bitstring;
                                                        {4091}let gNc_3912: bitstring = exp(g,Nc_3911) in
                                                        {4092}let m1_3913: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3912) in
                                                        {4093}event beginCli(Cli,Sess,gNc_3912);
                                                        {4094}out(c, (pkCli_3612,enc(m1_3913,pkSess_3908),sign(h(m1_3913),skCli_3611)));
                                                        {4095}in(c, (em2_3914: bitstring,sigM2_3915: bitstring));
                                                        {4096}let m2_3916: bitstring = dec(em2_3914,skCli_3611) in
                                                        {4097}if (verify(h(m2_3916),sigM2_3915,pkSess_3908) <> true) then
                                                            0
                                                        else
                                                            {4098}let (=OpenSecureChannelResponse,PartS_3917: bitstring,ST_3918: bitstring,TTL_3919: bitstring) = m2_3916 in
                                                            {4099}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {4100}event endCli(Sess,Cli,PartS_3917)
                                                    )
                                                    else
                                                        {4101}let pkSess_3920: bitstring = pub(sk(Sess)) in
                                                        {4102}out(c, GetEndpointRequest);
                                                        {4103}in(c, (=GetEndpointResponse,=pkSess_3920,=SignAndEncrypt,SP_3921: bitstring,UP_3922: bitstring));
                                                        {4104}new Nc_3923: bitstring;
                                                        {4105}let gNc_3924: bitstring = exp(g,Nc_3923) in
                                                        {4106}let m1_3925: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3924) in
                                                        {4107}event beginCli(Cli,Sess,gNc_3924);
                                                        {4108}out(c, (pkCli_3612,enc(m1_3925,pkSess_3920),sign(h(m1_3925),skCli_3611)));
                                                        {4109}in(c, (em2_3926: bitstring,sigM2_3927: bitstring));
                                                        {4110}let m2_3928: bitstring = dec(em2_3926,skCli_3611) in
                                                        {4111}if (verify(h(m2_3928),sigM2_3927,pkSess_3920) <> true) then
                                                            0
                                                        else
                                                            {4112}let (=OpenSecureChannelResponse,PartS_3929: bitstring,ST_3930: bitstring,TTL_3931: bitstring) = m2_3928 in
                                                            {4113}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {4114}event endCli(Sess,Cli,PartS_3929)
                                                )
                                                else
                                                    {4115}let pkSess_3932: bitstring = fail-any in
                                                    {4116}out(c, GetEndpointRequest);
                                                    {4117}in(c, (=GetEndpointResponse,=pkSess_3932,=SignAndEncrypt,SP_3933: bitstring,UP_3934: bitstring));
                                                    {4118}new Nc_3935: bitstring;
                                                    {4119}let gNc_3936: bitstring = exp(g,Nc_3935) in
                                                    {4120}let m1_3937: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3936) in
                                                    {4121}event beginCli(Cli,Sess,gNc_3936);
                                                    {4122}out(c, (pkCli_3612,enc(m1_3937,pkSess_3932),sign(h(m1_3937),skCli_3611)));
                                                    {4123}in(c, (em2_3938: bitstring,sigM2_3939: bitstring));
                                                    {4124}let m2_3940: bitstring = dec(em2_3938,skCli_3611) in
                                                    {4125}if (verify(h(m2_3940),sigM2_3939,pkSess_3932) <> true) then
                                                        0
                                                    else
                                                        {4126}let (=OpenSecureChannelResponse,PartS_3941: bitstring,ST_3942: bitstring,TTL_3943: bitstring) = m2_3940 in
                                                        {4127}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {4128}event endCli(Sess,Cli,PartS_3941)
                                        )
                                        else
                                            {4129}let pkSess_3944: bitstring = fail-any in
                                            {4130}out(c, GetEndpointRequest);
                                            {4131}in(c, (=GetEndpointResponse,=pkSess_3944,=SignAndEncrypt,SP_3945: bitstring,UP_3946: bitstring));
                                            {4132}new Nc_3947: bitstring;
                                            {4133}let gNc_3948: bitstring = exp(g,Nc_3947) in
                                            {4134}let m1_3949: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3948) in
                                            {4135}event beginCli(Cli,Sess,gNc_3948);
                                            {4136}out(c, (pkCli_3612,enc(m1_3949,pkSess_3944),sign(h(m1_3949),skCli_3611)));
                                            {4137}in(c, (em2_3950: bitstring,sigM2_3951: bitstring));
                                            {4138}let m2_3952: bitstring = dec(em2_3950,skCli_3611) in
                                            {4139}if (verify(h(m2_3952),sigM2_3951,pkSess_3944) <> true) then
                                                0
                                            else
                                                {4140}let (=OpenSecureChannelResponse,PartS_3953: bitstring,ST_3954: bitstring,TTL_3955: bitstring) = m2_3952 in
                                                {4141}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4142}event endCli(Sess,Cli,PartS_3953)
                                )
                                else
                                    {4143}let pkSess_3956: bitstring = fail-any in
                                    {4144}out(c, GetEndpointRequest);
                                    {4145}in(c, (=GetEndpointResponse,=pkSess_3956,=SignAndEncrypt,SP_3957: bitstring,UP_3958: bitstring));
                                    {4146}new Nc_3959: bitstring;
                                    {4147}let gNc_3960: bitstring = exp(g,Nc_3959) in
                                    {4148}let m1_3961: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3960) in
                                    {4149}event beginCli(Cli,Sess,gNc_3960);
                                    {4150}out(c, (pkCli_3612,enc(m1_3961,pkSess_3956),sign(h(m1_3961),skCli_3611)));
                                    {4151}in(c, (em2_3962: bitstring,sigM2_3963: bitstring));
                                    {4152}let m2_3964: bitstring = dec(em2_3962,skCli_3611) in
                                    {4153}if (verify(h(m2_3964),sigM2_3963,pkSess_3956) <> true) then
                                        0
                                    else
                                        {4154}let (=OpenSecureChannelResponse,PartS_3965: bitstring,ST_3966: bitstring,TTL_3967: bitstring) = m2_3964 in
                                        {4155}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4156}event endCli(Sess,Cli,PartS_3965)
                        )
                        else
                            {4157}let pkDisco_3968: bitstring = fail-any in
                            {4158}let v_3969: bool = (Sess = A) in
                            (
                                {4159}if v_3969 then
                                (
                                    {4160}let pkSess_3970: bitstring = pub(skA) in
                                    {4161}out(c, GetEndpointRequest);
                                    {4162}in(c, (=GetEndpointResponse,=pkSess_3970,=SignAndEncrypt,SP_3971: bitstring,UP_3972: bitstring));
                                    {4163}new Nc_3973: bitstring;
                                    {4164}let gNc_3974: bitstring = exp(g,Nc_3973) in
                                    {4165}let m1_3975: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3974) in
                                    {4166}event beginCli(Cli,Sess,gNc_3974);
                                    {4167}out(c, (pkCli_3612,enc(m1_3975,pkSess_3970),sign(h(m1_3975),skCli_3611)));
                                    {4168}in(c, (em2_3976: bitstring,sigM2_3977: bitstring));
                                    {4169}let m2_3978: bitstring = dec(em2_3976,skCli_3611) in
                                    {4170}if (verify(h(m2_3978),sigM2_3977,pkSess_3970) <> true) then
                                        0
                                    else
                                        {4171}let (=OpenSecureChannelResponse,PartS_3979: bitstring,ST_3980: bitstring,TTL_3981: bitstring) = m2_3978 in
                                        {4172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4173}event endCli(Sess,Cli,PartS_3979)
                                )
                                else
                                    {4174}let v_3982: bool = (Sess = B) in
                                    (
                                        {4175}if v_3982 then
                                        (
                                            {4176}let pkSess_3983: bitstring = pub(skB) in
                                            {4177}out(c, GetEndpointRequest);
                                            {4178}in(c, (=GetEndpointResponse,=pkSess_3983,=SignAndEncrypt,SP_3984: bitstring,UP_3985: bitstring));
                                            {4179}new Nc_3986: bitstring;
                                            {4180}let gNc_3987: bitstring = exp(g,Nc_3986) in
                                            {4181}let m1_3988: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_3987) in
                                            {4182}event beginCli(Cli,Sess,gNc_3987);
                                            {4183}out(c, (pkCli_3612,enc(m1_3988,pkSess_3983),sign(h(m1_3988),skCli_3611)));
                                            {4184}in(c, (em2_3989: bitstring,sigM2_3990: bitstring));
                                            {4185}let m2_3991: bitstring = dec(em2_3989,skCli_3611) in
                                            {4186}if (verify(h(m2_3991),sigM2_3990,pkSess_3983) <> true) then
                                                0
                                            else
                                                {4187}let (=OpenSecureChannelResponse,PartS_3992: bitstring,ST_3993: bitstring,TTL_3994: bitstring) = m2_3991 in
                                                {4188}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4189}event endCli(Sess,Cli,PartS_3992)
                                        )
                                        else
                                            {4190}let v_3995: bool = (Sess = C) in
                                            (
                                                {4191}if v_3995 then
                                                (
                                                    {4192}let pkSess_3996: bitstring = pub(skC) in
                                                    {4193}out(c, GetEndpointRequest);
                                                    {4194}in(c, (=GetEndpointResponse,=pkSess_3996,=SignAndEncrypt,SP_3997: bitstring,UP_3998: bitstring));
                                                    {4195}new Nc_3999: bitstring;
                                                    {4196}let gNc_4000: bitstring = exp(g,Nc_3999) in
                                                    {4197}let m1_4001: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4000) in
                                                    {4198}event beginCli(Cli,Sess,gNc_4000);
                                                    {4199}out(c, (pkCli_3612,enc(m1_4001,pkSess_3996),sign(h(m1_4001),skCli_3611)));
                                                    {4200}in(c, (em2_4002: bitstring,sigM2_4003: bitstring));
                                                    {4201}let m2_4004: bitstring = dec(em2_4002,skCli_3611) in
                                                    {4202}if (verify(h(m2_4004),sigM2_4003,pkSess_3996) <> true) then
                                                        0
                                                    else
                                                        {4203}let (=OpenSecureChannelResponse,PartS_4005: bitstring,ST_4006: bitstring,TTL_4007: bitstring) = m2_4004 in
                                                        {4204}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {4205}event endCli(Sess,Cli,PartS_4005)
                                                )
                                                else
                                                    {4206}let pkSess_4008: bitstring = pub(sk(Sess)) in
                                                    {4207}out(c, GetEndpointRequest);
                                                    {4208}in(c, (=GetEndpointResponse,=pkSess_4008,=SignAndEncrypt,SP_4009: bitstring,UP_4010: bitstring));
                                                    {4209}new Nc_4011: bitstring;
                                                    {4210}let gNc_4012: bitstring = exp(g,Nc_4011) in
                                                    {4211}let m1_4013: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4012) in
                                                    {4212}event beginCli(Cli,Sess,gNc_4012);
                                                    {4213}out(c, (pkCli_3612,enc(m1_4013,pkSess_4008),sign(h(m1_4013),skCli_3611)));
                                                    {4214}in(c, (em2_4014: bitstring,sigM2_4015: bitstring));
                                                    {4215}let m2_4016: bitstring = dec(em2_4014,skCli_3611) in
                                                    {4216}if (verify(h(m2_4016),sigM2_4015,pkSess_4008) <> true) then
                                                        0
                                                    else
                                                        {4217}let (=OpenSecureChannelResponse,PartS_4017: bitstring,ST_4018: bitstring,TTL_4019: bitstring) = m2_4016 in
                                                        {4218}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {4219}event endCli(Sess,Cli,PartS_4017)
                                            )
                                            else
                                                {4220}let pkSess_4020: bitstring = fail-any in
                                                {4221}out(c, GetEndpointRequest);
                                                {4222}in(c, (=GetEndpointResponse,=pkSess_4020,=SignAndEncrypt,SP_4021: bitstring,UP_4022: bitstring));
                                                {4223}new Nc_4023: bitstring;
                                                {4224}let gNc_4024: bitstring = exp(g,Nc_4023) in
                                                {4225}let m1_4025: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4024) in
                                                {4226}event beginCli(Cli,Sess,gNc_4024);
                                                {4227}out(c, (pkCli_3612,enc(m1_4025,pkSess_4020),sign(h(m1_4025),skCli_3611)));
                                                {4228}in(c, (em2_4026: bitstring,sigM2_4027: bitstring));
                                                {4229}let m2_4028: bitstring = dec(em2_4026,skCli_3611) in
                                                {4230}if (verify(h(m2_4028),sigM2_4027,pkSess_4020) <> true) then
                                                    0
                                                else
                                                    {4231}let (=OpenSecureChannelResponse,PartS_4029: bitstring,ST_4030: bitstring,TTL_4031: bitstring) = m2_4028 in
                                                    {4232}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {4233}event endCli(Sess,Cli,PartS_4029)
                                    )
                                    else
                                        {4234}let pkSess_4032: bitstring = fail-any in
                                        {4235}out(c, GetEndpointRequest);
                                        {4236}in(c, (=GetEndpointResponse,=pkSess_4032,=SignAndEncrypt,SP_4033: bitstring,UP_4034: bitstring));
                                        {4237}new Nc_4035: bitstring;
                                        {4238}let gNc_4036: bitstring = exp(g,Nc_4035) in
                                        {4239}let m1_4037: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4036) in
                                        {4240}event beginCli(Cli,Sess,gNc_4036);
                                        {4241}out(c, (pkCli_3612,enc(m1_4037,pkSess_4032),sign(h(m1_4037),skCli_3611)));
                                        {4242}in(c, (em2_4038: bitstring,sigM2_4039: bitstring));
                                        {4243}let m2_4040: bitstring = dec(em2_4038,skCli_3611) in
                                        {4244}if (verify(h(m2_4040),sigM2_4039,pkSess_4032) <> true) then
                                            0
                                        else
                                            {4245}let (=OpenSecureChannelResponse,PartS_4041: bitstring,ST_4042: bitstring,TTL_4043: bitstring) = m2_4040 in
                                            {4246}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4247}event endCli(Sess,Cli,PartS_4041)
                            )
                            else
                                {4248}let pkSess_4044: bitstring = fail-any in
                                {4249}out(c, GetEndpointRequest);
                                {4250}in(c, (=GetEndpointResponse,=pkSess_4044,=SignAndEncrypt,SP_4045: bitstring,UP_4046: bitstring));
                                {4251}new Nc_4047: bitstring;
                                {4252}let gNc_4048: bitstring = exp(g,Nc_4047) in
                                {4253}let m1_4049: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4048) in
                                {4254}event beginCli(Cli,Sess,gNc_4048);
                                {4255}out(c, (pkCli_3612,enc(m1_4049,pkSess_4044),sign(h(m1_4049),skCli_3611)));
                                {4256}in(c, (em2_4050: bitstring,sigM2_4051: bitstring));
                                {4257}let m2_4052: bitstring = dec(em2_4050,skCli_3611) in
                                {4258}if (verify(h(m2_4052),sigM2_4051,pkSess_4044) <> true) then
                                    0
                                else
                                    {4259}let (=OpenSecureChannelResponse,PartS_4053: bitstring,ST_4054: bitstring,TTL_4055: bitstring) = m2_4052 in
                                    {4260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4261}event endCli(Sess,Cli,PartS_4053)
                )
                else
                    {4262}let pkDisco_4056: bitstring = fail-any in
                    {4263}let v_4057: bool = (Sess = A) in
                    (
                        {4264}if v_4057 then
                        (
                            {4265}let pkSess_4058: bitstring = pub(skA) in
                            {4266}out(c, GetEndpointRequest);
                            {4267}in(c, (=GetEndpointResponse,=pkSess_4058,=SignAndEncrypt,SP_4059: bitstring,UP_4060: bitstring));
                            {4268}new Nc_4061: bitstring;
                            {4269}let gNc_4062: bitstring = exp(g,Nc_4061) in
                            {4270}let m1_4063: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4062) in
                            {4271}event beginCli(Cli,Sess,gNc_4062);
                            {4272}out(c, (pkCli_3612,enc(m1_4063,pkSess_4058),sign(h(m1_4063),skCli_3611)));
                            {4273}in(c, (em2_4064: bitstring,sigM2_4065: bitstring));
                            {4274}let m2_4066: bitstring = dec(em2_4064,skCli_3611) in
                            {4275}if (verify(h(m2_4066),sigM2_4065,pkSess_4058) <> true) then
                                0
                            else
                                {4276}let (=OpenSecureChannelResponse,PartS_4067: bitstring,ST_4068: bitstring,TTL_4069: bitstring) = m2_4066 in
                                {4277}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4278}event endCli(Sess,Cli,PartS_4067)
                        )
                        else
                            {4279}let v_4070: bool = (Sess = B) in
                            (
                                {4280}if v_4070 then
                                (
                                    {4281}let pkSess_4071: bitstring = pub(skB) in
                                    {4282}out(c, GetEndpointRequest);
                                    {4283}in(c, (=GetEndpointResponse,=pkSess_4071,=SignAndEncrypt,SP_4072: bitstring,UP_4073: bitstring));
                                    {4284}new Nc_4074: bitstring;
                                    {4285}let gNc_4075: bitstring = exp(g,Nc_4074) in
                                    {4286}let m1_4076: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4075) in
                                    {4287}event beginCli(Cli,Sess,gNc_4075);
                                    {4288}out(c, (pkCli_3612,enc(m1_4076,pkSess_4071),sign(h(m1_4076),skCli_3611)));
                                    {4289}in(c, (em2_4077: bitstring,sigM2_4078: bitstring));
                                    {4290}let m2_4079: bitstring = dec(em2_4077,skCli_3611) in
                                    {4291}if (verify(h(m2_4079),sigM2_4078,pkSess_4071) <> true) then
                                        0
                                    else
                                        {4292}let (=OpenSecureChannelResponse,PartS_4080: bitstring,ST_4081: bitstring,TTL_4082: bitstring) = m2_4079 in
                                        {4293}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4294}event endCli(Sess,Cli,PartS_4080)
                                )
                                else
                                    {4295}let v_4083: bool = (Sess = C) in
                                    (
                                        {4296}if v_4083 then
                                        (
                                            {4297}let pkSess_4084: bitstring = pub(skC) in
                                            {4298}out(c, GetEndpointRequest);
                                            {4299}in(c, (=GetEndpointResponse,=pkSess_4084,=SignAndEncrypt,SP_4085: bitstring,UP_4086: bitstring));
                                            {4300}new Nc_4087: bitstring;
                                            {4301}let gNc_4088: bitstring = exp(g,Nc_4087) in
                                            {4302}let m1_4089: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4088) in
                                            {4303}event beginCli(Cli,Sess,gNc_4088);
                                            {4304}out(c, (pkCli_3612,enc(m1_4089,pkSess_4084),sign(h(m1_4089),skCli_3611)));
                                            {4305}in(c, (em2_4090: bitstring,sigM2_4091: bitstring));
                                            {4306}let m2_4092: bitstring = dec(em2_4090,skCli_3611) in
                                            {4307}if (verify(h(m2_4092),sigM2_4091,pkSess_4084) <> true) then
                                                0
                                            else
                                                {4308}let (=OpenSecureChannelResponse,PartS_4093: bitstring,ST_4094: bitstring,TTL_4095: bitstring) = m2_4092 in
                                                {4309}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4310}event endCli(Sess,Cli,PartS_4093)
                                        )
                                        else
                                            {4311}let pkSess_4096: bitstring = pub(sk(Sess)) in
                                            {4312}out(c, GetEndpointRequest);
                                            {4313}in(c, (=GetEndpointResponse,=pkSess_4096,=SignAndEncrypt,SP_4097: bitstring,UP_4098: bitstring));
                                            {4314}new Nc_4099: bitstring;
                                            {4315}let gNc_4100: bitstring = exp(g,Nc_4099) in
                                            {4316}let m1_4101: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4100) in
                                            {4317}event beginCli(Cli,Sess,gNc_4100);
                                            {4318}out(c, (pkCli_3612,enc(m1_4101,pkSess_4096),sign(h(m1_4101),skCli_3611)));
                                            {4319}in(c, (em2_4102: bitstring,sigM2_4103: bitstring));
                                            {4320}let m2_4104: bitstring = dec(em2_4102,skCli_3611) in
                                            {4321}if (verify(h(m2_4104),sigM2_4103,pkSess_4096) <> true) then
                                                0
                                            else
                                                {4322}let (=OpenSecureChannelResponse,PartS_4105: bitstring,ST_4106: bitstring,TTL_4107: bitstring) = m2_4104 in
                                                {4323}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {4324}event endCli(Sess,Cli,PartS_4105)
                                    )
                                    else
                                        {4325}let pkSess_4108: bitstring = fail-any in
                                        {4326}out(c, GetEndpointRequest);
                                        {4327}in(c, (=GetEndpointResponse,=pkSess_4108,=SignAndEncrypt,SP_4109: bitstring,UP_4110: bitstring));
                                        {4328}new Nc_4111: bitstring;
                                        {4329}let gNc_4112: bitstring = exp(g,Nc_4111) in
                                        {4330}let m1_4113: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4112) in
                                        {4331}event beginCli(Cli,Sess,gNc_4112);
                                        {4332}out(c, (pkCli_3612,enc(m1_4113,pkSess_4108),sign(h(m1_4113),skCli_3611)));
                                        {4333}in(c, (em2_4114: bitstring,sigM2_4115: bitstring));
                                        {4334}let m2_4116: bitstring = dec(em2_4114,skCli_3611) in
                                        {4335}if (verify(h(m2_4116),sigM2_4115,pkSess_4108) <> true) then
                                            0
                                        else
                                            {4336}let (=OpenSecureChannelResponse,PartS_4117: bitstring,ST_4118: bitstring,TTL_4119: bitstring) = m2_4116 in
                                            {4337}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4338}event endCli(Sess,Cli,PartS_4117)
                            )
                            else
                                {4339}let pkSess_4120: bitstring = fail-any in
                                {4340}out(c, GetEndpointRequest);
                                {4341}in(c, (=GetEndpointResponse,=pkSess_4120,=SignAndEncrypt,SP_4121: bitstring,UP_4122: bitstring));
                                {4342}new Nc_4123: bitstring;
                                {4343}let gNc_4124: bitstring = exp(g,Nc_4123) in
                                {4344}let m1_4125: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4124) in
                                {4345}event beginCli(Cli,Sess,gNc_4124);
                                {4346}out(c, (pkCli_3612,enc(m1_4125,pkSess_4120),sign(h(m1_4125),skCli_3611)));
                                {4347}in(c, (em2_4126: bitstring,sigM2_4127: bitstring));
                                {4348}let m2_4128: bitstring = dec(em2_4126,skCli_3611) in
                                {4349}if (verify(h(m2_4128),sigM2_4127,pkSess_4120) <> true) then
                                    0
                                else
                                    {4350}let (=OpenSecureChannelResponse,PartS_4129: bitstring,ST_4130: bitstring,TTL_4131: bitstring) = m2_4128 in
                                    {4351}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4352}event endCli(Sess,Cli,PartS_4129)
                    )
                    else
                        {4353}let pkSess_4132: bitstring = fail-any in
                        {4354}out(c, GetEndpointRequest);
                        {4355}in(c, (=GetEndpointResponse,=pkSess_4132,=SignAndEncrypt,SP_4133: bitstring,UP_4134: bitstring));
                        {4356}new Nc_4135: bitstring;
                        {4357}let gNc_4136: bitstring = exp(g,Nc_4135) in
                        {4358}let m1_4137: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4136) in
                        {4359}event beginCli(Cli,Sess,gNc_4136);
                        {4360}out(c, (pkCli_3612,enc(m1_4137,pkSess_4132),sign(h(m1_4137),skCli_3611)));
                        {4361}in(c, (em2_4138: bitstring,sigM2_4139: bitstring));
                        {4362}let m2_4140: bitstring = dec(em2_4138,skCli_3611) in
                        {4363}if (verify(h(m2_4140),sigM2_4139,pkSess_4132) <> true) then
                            0
                        else
                            {4364}let (=OpenSecureChannelResponse,PartS_4141: bitstring,ST_4142: bitstring,TTL_4143: bitstring) = m2_4140 in
                            {4365}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4366}event endCli(Sess,Cli,PartS_4141)
        )
        else
            {4367}let pkDisco_4144: bitstring = fail-any in
            {4368}let v_4145: bool = (Sess = A) in
            (
                {4369}if v_4145 then
                (
                    {4370}let pkSess_4146: bitstring = pub(skA) in
                    {4371}out(c, GetEndpointRequest);
                    {4372}in(c, (=GetEndpointResponse,=pkSess_4146,=SignAndEncrypt,SP_4147: bitstring,UP_4148: bitstring));
                    {4373}new Nc_4149: bitstring;
                    {4374}let gNc_4150: bitstring = exp(g,Nc_4149) in
                    {4375}let m1_4151: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4150) in
                    {4376}event beginCli(Cli,Sess,gNc_4150);
                    {4377}out(c, (pkCli_3612,enc(m1_4151,pkSess_4146),sign(h(m1_4151),skCli_3611)));
                    {4378}in(c, (em2_4152: bitstring,sigM2_4153: bitstring));
                    {4379}let m2_4154: bitstring = dec(em2_4152,skCli_3611) in
                    {4380}if (verify(h(m2_4154),sigM2_4153,pkSess_4146) <> true) then
                        0
                    else
                        {4381}let (=OpenSecureChannelResponse,PartS_4155: bitstring,ST_4156: bitstring,TTL_4157: bitstring) = m2_4154 in
                        {4382}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4383}event endCli(Sess,Cli,PartS_4155)
                )
                else
                    {4384}let v_4158: bool = (Sess = B) in
                    (
                        {4385}if v_4158 then
                        (
                            {4386}let pkSess_4159: bitstring = pub(skB) in
                            {4387}out(c, GetEndpointRequest);
                            {4388}in(c, (=GetEndpointResponse,=pkSess_4159,=SignAndEncrypt,SP_4160: bitstring,UP_4161: bitstring));
                            {4389}new Nc_4162: bitstring;
                            {4390}let gNc_4163: bitstring = exp(g,Nc_4162) in
                            {4391}let m1_4164: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4163) in
                            {4392}event beginCli(Cli,Sess,gNc_4163);
                            {4393}out(c, (pkCli_3612,enc(m1_4164,pkSess_4159),sign(h(m1_4164),skCli_3611)));
                            {4394}in(c, (em2_4165: bitstring,sigM2_4166: bitstring));
                            {4395}let m2_4167: bitstring = dec(em2_4165,skCli_3611) in
                            {4396}if (verify(h(m2_4167),sigM2_4166,pkSess_4159) <> true) then
                                0
                            else
                                {4397}let (=OpenSecureChannelResponse,PartS_4168: bitstring,ST_4169: bitstring,TTL_4170: bitstring) = m2_4167 in
                                {4398}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4399}event endCli(Sess,Cli,PartS_4168)
                        )
                        else
                            {4400}let v_4171: bool = (Sess = C) in
                            (
                                {4401}if v_4171 then
                                (
                                    {4402}let pkSess_4172: bitstring = pub(skC) in
                                    {4403}out(c, GetEndpointRequest);
                                    {4404}in(c, (=GetEndpointResponse,=pkSess_4172,=SignAndEncrypt,SP_4173: bitstring,UP_4174: bitstring));
                                    {4405}new Nc_4175: bitstring;
                                    {4406}let gNc_4176: bitstring = exp(g,Nc_4175) in
                                    {4407}let m1_4177: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4176) in
                                    {4408}event beginCli(Cli,Sess,gNc_4176);
                                    {4409}out(c, (pkCli_3612,enc(m1_4177,pkSess_4172),sign(h(m1_4177),skCli_3611)));
                                    {4410}in(c, (em2_4178: bitstring,sigM2_4179: bitstring));
                                    {4411}let m2_4180: bitstring = dec(em2_4178,skCli_3611) in
                                    {4412}if (verify(h(m2_4180),sigM2_4179,pkSess_4172) <> true) then
                                        0
                                    else
                                        {4413}let (=OpenSecureChannelResponse,PartS_4181: bitstring,ST_4182: bitstring,TTL_4183: bitstring) = m2_4180 in
                                        {4414}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4415}event endCli(Sess,Cli,PartS_4181)
                                )
                                else
                                    {4416}let pkSess_4184: bitstring = pub(sk(Sess)) in
                                    {4417}out(c, GetEndpointRequest);
                                    {4418}in(c, (=GetEndpointResponse,=pkSess_4184,=SignAndEncrypt,SP_4185: bitstring,UP_4186: bitstring));
                                    {4419}new Nc_4187: bitstring;
                                    {4420}let gNc_4188: bitstring = exp(g,Nc_4187) in
                                    {4421}let m1_4189: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4188) in
                                    {4422}event beginCli(Cli,Sess,gNc_4188);
                                    {4423}out(c, (pkCli_3612,enc(m1_4189,pkSess_4184),sign(h(m1_4189),skCli_3611)));
                                    {4424}in(c, (em2_4190: bitstring,sigM2_4191: bitstring));
                                    {4425}let m2_4192: bitstring = dec(em2_4190,skCli_3611) in
                                    {4426}if (verify(h(m2_4192),sigM2_4191,pkSess_4184) <> true) then
                                        0
                                    else
                                        {4427}let (=OpenSecureChannelResponse,PartS_4193: bitstring,ST_4194: bitstring,TTL_4195: bitstring) = m2_4192 in
                                        {4428}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4429}event endCli(Sess,Cli,PartS_4193)
                            )
                            else
                                {4430}let pkSess_4196: bitstring = fail-any in
                                {4431}out(c, GetEndpointRequest);
                                {4432}in(c, (=GetEndpointResponse,=pkSess_4196,=SignAndEncrypt,SP_4197: bitstring,UP_4198: bitstring));
                                {4433}new Nc_4199: bitstring;
                                {4434}let gNc_4200: bitstring = exp(g,Nc_4199) in
                                {4435}let m1_4201: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4200) in
                                {4436}event beginCli(Cli,Sess,gNc_4200);
                                {4437}out(c, (pkCli_3612,enc(m1_4201,pkSess_4196),sign(h(m1_4201),skCli_3611)));
                                {4438}in(c, (em2_4202: bitstring,sigM2_4203: bitstring));
                                {4439}let m2_4204: bitstring = dec(em2_4202,skCli_3611) in
                                {4440}if (verify(h(m2_4204),sigM2_4203,pkSess_4196) <> true) then
                                    0
                                else
                                    {4441}let (=OpenSecureChannelResponse,PartS_4205: bitstring,ST_4206: bitstring,TTL_4207: bitstring) = m2_4204 in
                                    {4442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4443}event endCli(Sess,Cli,PartS_4205)
                    )
                    else
                        {4444}let pkSess_4208: bitstring = fail-any in
                        {4445}out(c, GetEndpointRequest);
                        {4446}in(c, (=GetEndpointResponse,=pkSess_4208,=SignAndEncrypt,SP_4209: bitstring,UP_4210: bitstring));
                        {4447}new Nc_4211: bitstring;
                        {4448}let gNc_4212: bitstring = exp(g,Nc_4211) in
                        {4449}let m1_4213: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4212) in
                        {4450}event beginCli(Cli,Sess,gNc_4212);
                        {4451}out(c, (pkCli_3612,enc(m1_4213,pkSess_4208),sign(h(m1_4213),skCli_3611)));
                        {4452}in(c, (em2_4214: bitstring,sigM2_4215: bitstring));
                        {4453}let m2_4216: bitstring = dec(em2_4214,skCli_3611) in
                        {4454}if (verify(h(m2_4216),sigM2_4215,pkSess_4208) <> true) then
                            0
                        else
                            {4455}let (=OpenSecureChannelResponse,PartS_4217: bitstring,ST_4218: bitstring,TTL_4219: bitstring) = m2_4216 in
                            {4456}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4457}event endCli(Sess,Cli,PartS_4217)
            )
            else
                {4458}let pkSess_4220: bitstring = fail-any in
                {4459}out(c, GetEndpointRequest);
                {4460}in(c, (=GetEndpointResponse,=pkSess_4220,=SignAndEncrypt,SP_4221: bitstring,UP_4222: bitstring));
                {4461}new Nc_4223: bitstring;
                {4462}let gNc_4224: bitstring = exp(g,Nc_4223) in
                {4463}let m1_4225: bitstring = (OpenSecureChannelRequest,pkCli_3612,gNc_4224) in
                {4464}event beginCli(Cli,Sess,gNc_4224);
                {4465}out(c, (pkCli_3612,enc(m1_4225,pkSess_4220),sign(h(m1_4225),skCli_3611)));
                {4466}in(c, (em2_4226: bitstring,sigM2_4227: bitstring));
                {4467}let m2_4228: bitstring = dec(em2_4226,skCli_3611) in
                {4468}if (verify(h(m2_4228),sigM2_4227,pkSess_4220) <> true) then
                    0
                else
                    {4469}let (=OpenSecureChannelResponse,PartS_4229: bitstring,ST_4230: bitstring,TTL_4231: bitstring) = m2_4228 in
                    {4470}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {4471}event endCli(Sess,Cli,PartS_4229)
) | (
    {4472}!
    {4473}in(c, (Cli_4232: host,Disco_4233: host,Sess_4234: host));
    {4474}let v_4235: bool = (Disco_4233 = A) in
    (
        {4475}if v_4235 then
        (
            {4476}let skDisco: bitstring = skA in
            {4477}let pkDisco_4236: bitstring = pub(skDisco) in
            {4478}let v_4237: bool = (Cli_4232 = A) in
            (
                {4479}if v_4237 then
                (
                    {4480}let pkCli_4238: bitstring = pub(skA) in
                    {4481}let v_4239: bool = (Sess_4234 = A) in
                    (
                        {4482}if v_4239 then
                        (
                            {4483}let pkSess_4240: bitstring = pub(skA) in
                            {4484}in(c, =GetEndpointRequest);
                            {4485}new SP_4241: bitstring;
                            {4486}new UP_4242: bitstring;
                            {4487}out(c, (GetEndpointResponse,pkSess_4240,None,SP_4241,UP_4242))
                        )
                        else
                            {4488}let v_4243: bool = (Sess_4234 = B) in
                            (
                                {4489}if v_4243 then
                                (
                                    {4490}let pkSess_4244: bitstring = pub(skB) in
                                    {4491}in(c, =GetEndpointRequest);
                                    {4492}new SP_4245: bitstring;
                                    {4493}new UP_4246: bitstring;
                                    {4494}out(c, (GetEndpointResponse,pkSess_4244,None,SP_4245,UP_4246))
                                )
                                else
                                    {4495}let v_4247: bool = (Sess_4234 = C) in
                                    (
                                        {4496}if v_4247 then
                                        (
                                            {4497}let pkSess_4248: bitstring = pub(skC) in
                                            {4498}in(c, =GetEndpointRequest);
                                            {4499}new SP_4249: bitstring;
                                            {4500}new UP_4250: bitstring;
                                            {4501}out(c, (GetEndpointResponse,pkSess_4248,None,SP_4249,UP_4250))
                                        )
                                        else
                                            {4502}let pkSess_4251: bitstring = pub(sk(Sess_4234)) in
                                            {4503}in(c, =GetEndpointRequest);
                                            {4504}new SP_4252: bitstring;
                                            {4505}new UP_4253: bitstring;
                                            {4506}out(c, (GetEndpointResponse,pkSess_4251,None,SP_4252,UP_4253))
                                    )
                                    else
                                        {4507}let pkSess_4254: bitstring = fail-any in
                                        {4508}in(c, =GetEndpointRequest);
                                        {4509}new SP_4255: bitstring;
                                        {4510}new UP_4256: bitstring;
                                        {4511}out(c, (GetEndpointResponse,pkSess_4254,None,SP_4255,UP_4256))
                            )
                            else
                                {4512}let pkSess_4257: bitstring = fail-any in
                                {4513}in(c, =GetEndpointRequest);
                                {4514}new SP_4258: bitstring;
                                {4515}new UP_4259: bitstring;
                                {4516}out(c, (GetEndpointResponse,pkSess_4257,None,SP_4258,UP_4259))
                    )
                    else
                        {4517}let pkSess_4260: bitstring = fail-any in
                        {4518}in(c, =GetEndpointRequest);
                        {4519}new SP_4261: bitstring;
                        {4520}new UP_4262: bitstring;
                        {4521}out(c, (GetEndpointResponse,pkSess_4260,None,SP_4261,UP_4262))
                )
                else
                    {4522}let v_4263: bool = (Cli_4232 = B) in
                    (
                        {4523}if v_4263 then
                        (
                            {4524}let pkCli_4264: bitstring = pub(skB) in
                            {4525}let v_4265: bool = (Sess_4234 = A) in
                            (
                                {4526}if v_4265 then
                                (
                                    {4527}let pkSess_4266: bitstring = pub(skA) in
                                    {4528}in(c, =GetEndpointRequest);
                                    {4529}new SP_4267: bitstring;
                                    {4530}new UP_4268: bitstring;
                                    {4531}out(c, (GetEndpointResponse,pkSess_4266,None,SP_4267,UP_4268))
                                )
                                else
                                    {4532}let v_4269: bool = (Sess_4234 = B) in
                                    (
                                        {4533}if v_4269 then
                                        (
                                            {4534}let pkSess_4270: bitstring = pub(skB) in
                                            {4535}in(c, =GetEndpointRequest);
                                            {4536}new SP_4271: bitstring;
                                            {4537}new UP_4272: bitstring;
                                            {4538}out(c, (GetEndpointResponse,pkSess_4270,None,SP_4271,UP_4272))
                                        )
                                        else
                                            {4539}let v_4273: bool = (Sess_4234 = C) in
                                            (
                                                {4540}if v_4273 then
                                                (
                                                    {4541}let pkSess_4274: bitstring = pub(skC) in
                                                    {4542}in(c, =GetEndpointRequest);
                                                    {4543}new SP_4275: bitstring;
                                                    {4544}new UP_4276: bitstring;
                                                    {4545}out(c, (GetEndpointResponse,pkSess_4274,None,SP_4275,UP_4276))
                                                )
                                                else
                                                    {4546}let pkSess_4277: bitstring = pub(sk(Sess_4234)) in
                                                    {4547}in(c, =GetEndpointRequest);
                                                    {4548}new SP_4278: bitstring;
                                                    {4549}new UP_4279: bitstring;
                                                    {4550}out(c, (GetEndpointResponse,pkSess_4277,None,SP_4278,UP_4279))
                                            )
                                            else
                                                {4551}let pkSess_4280: bitstring = fail-any in
                                                {4552}in(c, =GetEndpointRequest);
                                                {4553}new SP_4281: bitstring;
                                                {4554}new UP_4282: bitstring;
                                                {4555}out(c, (GetEndpointResponse,pkSess_4280,None,SP_4281,UP_4282))
                                    )
                                    else
                                        {4556}let pkSess_4283: bitstring = fail-any in
                                        {4557}in(c, =GetEndpointRequest);
                                        {4558}new SP_4284: bitstring;
                                        {4559}new UP_4285: bitstring;
                                        {4560}out(c, (GetEndpointResponse,pkSess_4283,None,SP_4284,UP_4285))
                            )
                            else
                                {4561}let pkSess_4286: bitstring = fail-any in
                                {4562}in(c, =GetEndpointRequest);
                                {4563}new SP_4287: bitstring;
                                {4564}new UP_4288: bitstring;
                                {4565}out(c, (GetEndpointResponse,pkSess_4286,None,SP_4287,UP_4288))
                        )
                        else
                            {4566}let v_4289: bool = (Cli_4232 = C) in
                            (
                                {4567}if v_4289 then
                                (
                                    {4568}let pkCli_4290: bitstring = pub(skC) in
                                    {4569}let v_4291: bool = (Sess_4234 = A) in
                                    (
                                        {4570}if v_4291 then
                                        (
                                            {4571}let pkSess_4292: bitstring = pub(skA) in
                                            {4572}in(c, =GetEndpointRequest);
                                            {4573}new SP_4293: bitstring;
                                            {4574}new UP_4294: bitstring;
                                            {4575}out(c, (GetEndpointResponse,pkSess_4292,None,SP_4293,UP_4294))
                                        )
                                        else
                                            {4576}let v_4295: bool = (Sess_4234 = B) in
                                            (
                                                {4577}if v_4295 then
                                                (
                                                    {4578}let pkSess_4296: bitstring = pub(skB) in
                                                    {4579}in(c, =GetEndpointRequest);
                                                    {4580}new SP_4297: bitstring;
                                                    {4581}new UP_4298: bitstring;
                                                    {4582}out(c, (GetEndpointResponse,pkSess_4296,None,SP_4297,UP_4298))
                                                )
                                                else
                                                    {4583}let v_4299: bool = (Sess_4234 = C) in
                                                    (
                                                        {4584}if v_4299 then
                                                        (
                                                            {4585}let pkSess_4300: bitstring = pub(skC) in
                                                            {4586}in(c, =GetEndpointRequest);
                                                            {4587}new SP_4301: bitstring;
                                                            {4588}new UP_4302: bitstring;
                                                            {4589}out(c, (GetEndpointResponse,pkSess_4300,None,SP_4301,UP_4302))
                                                        )
                                                        else
                                                            {4590}let pkSess_4303: bitstring = pub(sk(Sess_4234)) in
                                                            {4591}in(c, =GetEndpointRequest);
                                                            {4592}new SP_4304: bitstring;
                                                            {4593}new UP_4305: bitstring;
                                                            {4594}out(c, (GetEndpointResponse,pkSess_4303,None,SP_4304,UP_4305))
                                                    )
                                                    else
                                                        {4595}let pkSess_4306: bitstring = fail-any in
                                                        {4596}in(c, =GetEndpointRequest);
                                                        {4597}new SP_4307: bitstring;
                                                        {4598}new UP_4308: bitstring;
                                                        {4599}out(c, (GetEndpointResponse,pkSess_4306,None,SP_4307,UP_4308))
                                            )
                                            else
                                                {4600}let pkSess_4309: bitstring = fail-any in
                                                {4601}in(c, =GetEndpointRequest);
                                                {4602}new SP_4310: bitstring;
                                                {4603}new UP_4311: bitstring;
                                                {4604}out(c, (GetEndpointResponse,pkSess_4309,None,SP_4310,UP_4311))
                                    )
                                    else
                                        {4605}let pkSess_4312: bitstring = fail-any in
                                        {4606}in(c, =GetEndpointRequest);
                                        {4607}new SP_4313: bitstring;
                                        {4608}new UP_4314: bitstring;
                                        {4609}out(c, (GetEndpointResponse,pkSess_4312,None,SP_4313,UP_4314))
                                )
                                else
                                    {4610}let pkCli_4315: bitstring = pub(sk(Cli_4232)) in
                                    {4611}let v_4316: bool = (Sess_4234 = A) in
                                    (
                                        {4612}if v_4316 then
                                        (
                                            {4613}let pkSess_4317: bitstring = pub(skA) in
                                            {4614}in(c, =GetEndpointRequest);
                                            {4615}new SP_4318: bitstring;
                                            {4616}new UP_4319: bitstring;
                                            {4617}out(c, (GetEndpointResponse,pkSess_4317,None,SP_4318,UP_4319))
                                        )
                                        else
                                            {4618}let v_4320: bool = (Sess_4234 = B) in
                                            (
                                                {4619}if v_4320 then
                                                (
                                                    {4620}let pkSess_4321: bitstring = pub(skB) in
                                                    {4621}in(c, =GetEndpointRequest);
                                                    {4622}new SP_4322: bitstring;
                                                    {4623}new UP_4323: bitstring;
                                                    {4624}out(c, (GetEndpointResponse,pkSess_4321,None,SP_4322,UP_4323))
                                                )
                                                else
                                                    {4625}let v_4324: bool = (Sess_4234 = C) in
                                                    (
                                                        {4626}if v_4324 then
                                                        (
                                                            {4627}let pkSess_4325: bitstring = pub(skC) in
                                                            {4628}in(c, =GetEndpointRequest);
                                                            {4629}new SP_4326: bitstring;
                                                            {4630}new UP_4327: bitstring;
                                                            {4631}out(c, (GetEndpointResponse,pkSess_4325,None,SP_4326,UP_4327))
                                                        )
                                                        else
                                                            {4632}let pkSess_4328: bitstring = pub(sk(Sess_4234)) in
                                                            {4633}in(c, =GetEndpointRequest);
                                                            {4634}new SP_4329: bitstring;
                                                            {4635}new UP_4330: bitstring;
                                                            {4636}out(c, (GetEndpointResponse,pkSess_4328,None,SP_4329,UP_4330))
                                                    )
                                                    else
                                                        {4637}let pkSess_4331: bitstring = fail-any in
                                                        {4638}in(c, =GetEndpointRequest);
                                                        {4639}new SP_4332: bitstring;
                                                        {4640}new UP_4333: bitstring;
                                                        {4641}out(c, (GetEndpointResponse,pkSess_4331,None,SP_4332,UP_4333))
                                            )
                                            else
                                                {4642}let pkSess_4334: bitstring = fail-any in
                                                {4643}in(c, =GetEndpointRequest);
                                                {4644}new SP_4335: bitstring;
                                                {4645}new UP_4336: bitstring;
                                                {4646}out(c, (GetEndpointResponse,pkSess_4334,None,SP_4335,UP_4336))
                                    )
                                    else
                                        {4647}let pkSess_4337: bitstring = fail-any in
                                        {4648}in(c, =GetEndpointRequest);
                                        {4649}new SP_4338: bitstring;
                                        {4650}new UP_4339: bitstring;
                                        {4651}out(c, (GetEndpointResponse,pkSess_4337,None,SP_4338,UP_4339))
                            )
                            else
                                {4652}let pkCli_4340: bitstring = fail-any in
                                {4653}let v_4341: bool = (Sess_4234 = A) in
                                (
                                    {4654}if v_4341 then
                                    (
                                        {4655}let pkSess_4342: bitstring = pub(skA) in
                                        {4656}in(c, =GetEndpointRequest);
                                        {4657}new SP_4343: bitstring;
                                        {4658}new UP_4344: bitstring;
                                        {4659}out(c, (GetEndpointResponse,pkSess_4342,None,SP_4343,UP_4344))
                                    )
                                    else
                                        {4660}let v_4345: bool = (Sess_4234 = B) in
                                        (
                                            {4661}if v_4345 then
                                            (
                                                {4662}let pkSess_4346: bitstring = pub(skB) in
                                                {4663}in(c, =GetEndpointRequest);
                                                {4664}new SP_4347: bitstring;
                                                {4665}new UP_4348: bitstring;
                                                {4666}out(c, (GetEndpointResponse,pkSess_4346,None,SP_4347,UP_4348))
                                            )
                                            else
                                                {4667}let v_4349: bool = (Sess_4234 = C) in
                                                (
                                                    {4668}if v_4349 then
                                                    (
                                                        {4669}let pkSess_4350: bitstring = pub(skC) in
                                                        {4670}in(c, =GetEndpointRequest);
                                                        {4671}new SP_4351: bitstring;
                                                        {4672}new UP_4352: bitstring;
                                                        {4673}out(c, (GetEndpointResponse,pkSess_4350,None,SP_4351,UP_4352))
                                                    )
                                                    else
                                                        {4674}let pkSess_4353: bitstring = pub(sk(Sess_4234)) in
                                                        {4675}in(c, =GetEndpointRequest);
                                                        {4676}new SP_4354: bitstring;
                                                        {4677}new UP_4355: bitstring;
                                                        {4678}out(c, (GetEndpointResponse,pkSess_4353,None,SP_4354,UP_4355))
                                                )
                                                else
                                                    {4679}let pkSess_4356: bitstring = fail-any in
                                                    {4680}in(c, =GetEndpointRequest);
                                                    {4681}new SP_4357: bitstring;
                                                    {4682}new UP_4358: bitstring;
                                                    {4683}out(c, (GetEndpointResponse,pkSess_4356,None,SP_4357,UP_4358))
                                        )
                                        else
                                            {4684}let pkSess_4359: bitstring = fail-any in
                                            {4685}in(c, =GetEndpointRequest);
                                            {4686}new SP_4360: bitstring;
                                            {4687}new UP_4361: bitstring;
                                            {4688}out(c, (GetEndpointResponse,pkSess_4359,None,SP_4360,UP_4361))
                                )
                                else
                                    {4689}let pkSess_4362: bitstring = fail-any in
                                    {4690}in(c, =GetEndpointRequest);
                                    {4691}new SP_4363: bitstring;
                                    {4692}new UP_4364: bitstring;
                                    {4693}out(c, (GetEndpointResponse,pkSess_4362,None,SP_4363,UP_4364))
                    )
                    else
                        {4694}let pkCli_4365: bitstring = fail-any in
                        {4695}let v_4366: bool = (Sess_4234 = A) in
                        (
                            {4696}if v_4366 then
                            (
                                {4697}let pkSess_4367: bitstring = pub(skA) in
                                {4698}in(c, =GetEndpointRequest);
                                {4699}new SP_4368: bitstring;
                                {4700}new UP_4369: bitstring;
                                {4701}out(c, (GetEndpointResponse,pkSess_4367,None,SP_4368,UP_4369))
                            )
                            else
                                {4702}let v_4370: bool = (Sess_4234 = B) in
                                (
                                    {4703}if v_4370 then
                                    (
                                        {4704}let pkSess_4371: bitstring = pub(skB) in
                                        {4705}in(c, =GetEndpointRequest);
                                        {4706}new SP_4372: bitstring;
                                        {4707}new UP_4373: bitstring;
                                        {4708}out(c, (GetEndpointResponse,pkSess_4371,None,SP_4372,UP_4373))
                                    )
                                    else
                                        {4709}let v_4374: bool = (Sess_4234 = C) in
                                        (
                                            {4710}if v_4374 then
                                            (
                                                {4711}let pkSess_4375: bitstring = pub(skC) in
                                                {4712}in(c, =GetEndpointRequest);
                                                {4713}new SP_4376: bitstring;
                                                {4714}new UP_4377: bitstring;
                                                {4715}out(c, (GetEndpointResponse,pkSess_4375,None,SP_4376,UP_4377))
                                            )
                                            else
                                                {4716}let pkSess_4378: bitstring = pub(sk(Sess_4234)) in
                                                {4717}in(c, =GetEndpointRequest);
                                                {4718}new SP_4379: bitstring;
                                                {4719}new UP_4380: bitstring;
                                                {4720}out(c, (GetEndpointResponse,pkSess_4378,None,SP_4379,UP_4380))
                                        )
                                        else
                                            {4721}let pkSess_4381: bitstring = fail-any in
                                            {4722}in(c, =GetEndpointRequest);
                                            {4723}new SP_4382: bitstring;
                                            {4724}new UP_4383: bitstring;
                                            {4725}out(c, (GetEndpointResponse,pkSess_4381,None,SP_4382,UP_4383))
                                )
                                else
                                    {4726}let pkSess_4384: bitstring = fail-any in
                                    {4727}in(c, =GetEndpointRequest);
                                    {4728}new SP_4385: bitstring;
                                    {4729}new UP_4386: bitstring;
                                    {4730}out(c, (GetEndpointResponse,pkSess_4384,None,SP_4385,UP_4386))
                        )
                        else
                            {4731}let pkSess_4387: bitstring = fail-any in
                            {4732}in(c, =GetEndpointRequest);
                            {4733}new SP_4388: bitstring;
                            {4734}new UP_4389: bitstring;
                            {4735}out(c, (GetEndpointResponse,pkSess_4387,None,SP_4388,UP_4389))
            )
            else
                {4736}let pkCli_4390: bitstring = fail-any in
                {4737}let v_4391: bool = (Sess_4234 = A) in
                (
                    {4738}if v_4391 then
                    (
                        {4739}let pkSess_4392: bitstring = pub(skA) in
                        {4740}in(c, =GetEndpointRequest);
                        {4741}new SP_4393: bitstring;
                        {4742}new UP_4394: bitstring;
                        {4743}out(c, (GetEndpointResponse,pkSess_4392,None,SP_4393,UP_4394))
                    )
                    else
                        {4744}let v_4395: bool = (Sess_4234 = B) in
                        (
                            {4745}if v_4395 then
                            (
                                {4746}let pkSess_4396: bitstring = pub(skB) in
                                {4747}in(c, =GetEndpointRequest);
                                {4748}new SP_4397: bitstring;
                                {4749}new UP_4398: bitstring;
                                {4750}out(c, (GetEndpointResponse,pkSess_4396,None,SP_4397,UP_4398))
                            )
                            else
                                {4751}let v_4399: bool = (Sess_4234 = C) in
                                (
                                    {4752}if v_4399 then
                                    (
                                        {4753}let pkSess_4400: bitstring = pub(skC) in
                                        {4754}in(c, =GetEndpointRequest);
                                        {4755}new SP_4401: bitstring;
                                        {4756}new UP_4402: bitstring;
                                        {4757}out(c, (GetEndpointResponse,pkSess_4400,None,SP_4401,UP_4402))
                                    )
                                    else
                                        {4758}let pkSess_4403: bitstring = pub(sk(Sess_4234)) in
                                        {4759}in(c, =GetEndpointRequest);
                                        {4760}new SP_4404: bitstring;
                                        {4761}new UP_4405: bitstring;
                                        {4762}out(c, (GetEndpointResponse,pkSess_4403,None,SP_4404,UP_4405))
                                )
                                else
                                    {4763}let pkSess_4406: bitstring = fail-any in
                                    {4764}in(c, =GetEndpointRequest);
                                    {4765}new SP_4407: bitstring;
                                    {4766}new UP_4408: bitstring;
                                    {4767}out(c, (GetEndpointResponse,pkSess_4406,None,SP_4407,UP_4408))
                        )
                        else
                            {4768}let pkSess_4409: bitstring = fail-any in
                            {4769}in(c, =GetEndpointRequest);
                            {4770}new SP_4410: bitstring;
                            {4771}new UP_4411: bitstring;
                            {4772}out(c, (GetEndpointResponse,pkSess_4409,None,SP_4410,UP_4411))
                )
                else
                    {4773}let pkSess_4412: bitstring = fail-any in
                    {4774}in(c, =GetEndpointRequest);
                    {4775}new SP_4413: bitstring;
                    {4776}new UP_4414: bitstring;
                    {4777}out(c, (GetEndpointResponse,pkSess_4412,None,SP_4413,UP_4414))
        )
        else
            {4778}let v_4415: bool = (Disco_4233 = B) in
            (
                {4779}if v_4415 then
                (
                    {4780}let skDisco_4416: bitstring = skB in
                    {4781}let pkDisco_4417: bitstring = pub(skDisco_4416) in
                    {4782}let v_4418: bool = (Cli_4232 = A) in
                    (
                        {4783}if v_4418 then
                        (
                            {4784}let pkCli_4419: bitstring = pub(skA) in
                            {4785}let v_4420: bool = (Sess_4234 = A) in
                            (
                                {4786}if v_4420 then
                                (
                                    {4787}let pkSess_4421: bitstring = pub(skA) in
                                    {4788}in(c, =GetEndpointRequest);
                                    {4789}new SP_4422: bitstring;
                                    {4790}new UP_4423: bitstring;
                                    {4791}out(c, (GetEndpointResponse,pkSess_4421,None,SP_4422,UP_4423))
                                )
                                else
                                    {4792}let v_4424: bool = (Sess_4234 = B) in
                                    (
                                        {4793}if v_4424 then
                                        (
                                            {4794}let pkSess_4425: bitstring = pub(skB) in
                                            {4795}in(c, =GetEndpointRequest);
                                            {4796}new SP_4426: bitstring;
                                            {4797}new UP_4427: bitstring;
                                            {4798}out(c, (GetEndpointResponse,pkSess_4425,None,SP_4426,UP_4427))
                                        )
                                        else
                                            {4799}let v_4428: bool = (Sess_4234 = C) in
                                            (
                                                {4800}if v_4428 then
                                                (
                                                    {4801}let pkSess_4429: bitstring = pub(skC) in
                                                    {4802}in(c, =GetEndpointRequest);
                                                    {4803}new SP_4430: bitstring;
                                                    {4804}new UP_4431: bitstring;
                                                    {4805}out(c, (GetEndpointResponse,pkSess_4429,None,SP_4430,UP_4431))
                                                )
                                                else
                                                    {4806}let pkSess_4432: bitstring = pub(sk(Sess_4234)) in
                                                    {4807}in(c, =GetEndpointRequest);
                                                    {4808}new SP_4433: bitstring;
                                                    {4809}new UP_4434: bitstring;
                                                    {4810}out(c, (GetEndpointResponse,pkSess_4432,None,SP_4433,UP_4434))
                                            )
                                            else
                                                {4811}let pkSess_4435: bitstring = fail-any in
                                                {4812}in(c, =GetEndpointRequest);
                                                {4813}new SP_4436: bitstring;
                                                {4814}new UP_4437: bitstring;
                                                {4815}out(c, (GetEndpointResponse,pkSess_4435,None,SP_4436,UP_4437))
                                    )
                                    else
                                        {4816}let pkSess_4438: bitstring = fail-any in
                                        {4817}in(c, =GetEndpointRequest);
                                        {4818}new SP_4439: bitstring;
                                        {4819}new UP_4440: bitstring;
                                        {4820}out(c, (GetEndpointResponse,pkSess_4438,None,SP_4439,UP_4440))
                            )
                            else
                                {4821}let pkSess_4441: bitstring = fail-any in
                                {4822}in(c, =GetEndpointRequest);
                                {4823}new SP_4442: bitstring;
                                {4824}new UP_4443: bitstring;
                                {4825}out(c, (GetEndpointResponse,pkSess_4441,None,SP_4442,UP_4443))
                        )
                        else
                            {4826}let v_4444: bool = (Cli_4232 = B) in
                            (
                                {4827}if v_4444 then
                                (
                                    {4828}let pkCli_4445: bitstring = pub(skB) in
                                    {4829}let v_4446: bool = (Sess_4234 = A) in
                                    (
                                        {4830}if v_4446 then
                                        (
                                            {4831}let pkSess_4447: bitstring = pub(skA) in
                                            {4832}in(c, =GetEndpointRequest);
                                            {4833}new SP_4448: bitstring;
                                            {4834}new UP_4449: bitstring;
                                            {4835}out(c, (GetEndpointResponse,pkSess_4447,None,SP_4448,UP_4449))
                                        )
                                        else
                                            {4836}let v_4450: bool = (Sess_4234 = B) in
                                            (
                                                {4837}if v_4450 then
                                                (
                                                    {4838}let pkSess_4451: bitstring = pub(skB) in
                                                    {4839}in(c, =GetEndpointRequest);
                                                    {4840}new SP_4452: bitstring;
                                                    {4841}new UP_4453: bitstring;
                                                    {4842}out(c, (GetEndpointResponse,pkSess_4451,None,SP_4452,UP_4453))
                                                )
                                                else
                                                    {4843}let v_4454: bool = (Sess_4234 = C) in
                                                    (
                                                        {4844}if v_4454 then
                                                        (
                                                            {4845}let pkSess_4455: bitstring = pub(skC) in
                                                            {4846}in(c, =GetEndpointRequest);
                                                            {4847}new SP_4456: bitstring;
                                                            {4848}new UP_4457: bitstring;
                                                            {4849}out(c, (GetEndpointResponse,pkSess_4455,None,SP_4456,UP_4457))
                                                        )
                                                        else
                                                            {4850}let pkSess_4458: bitstring = pub(sk(Sess_4234)) in
                                                            {4851}in(c, =GetEndpointRequest);
                                                            {4852}new SP_4459: bitstring;
                                                            {4853}new UP_4460: bitstring;
                                                            {4854}out(c, (GetEndpointResponse,pkSess_4458,None,SP_4459,UP_4460))
                                                    )
                                                    else
                                                        {4855}let pkSess_4461: bitstring = fail-any in
                                                        {4856}in(c, =GetEndpointRequest);
                                                        {4857}new SP_4462: bitstring;
                                                        {4858}new UP_4463: bitstring;
                                                        {4859}out(c, (GetEndpointResponse,pkSess_4461,None,SP_4462,UP_4463))
                                            )
                                            else
                                                {4860}let pkSess_4464: bitstring = fail-any in
                                                {4861}in(c, =GetEndpointRequest);
                                                {4862}new SP_4465: bitstring;
                                                {4863}new UP_4466: bitstring;
                                                {4864}out(c, (GetEndpointResponse,pkSess_4464,None,SP_4465,UP_4466))
                                    )
                                    else
                                        {4865}let pkSess_4467: bitstring = fail-any in
                                        {4866}in(c, =GetEndpointRequest);
                                        {4867}new SP_4468: bitstring;
                                        {4868}new UP_4469: bitstring;
                                        {4869}out(c, (GetEndpointResponse,pkSess_4467,None,SP_4468,UP_4469))
                                )
                                else
                                    {4870}let v_4470: bool = (Cli_4232 = C) in
                                    (
                                        {4871}if v_4470 then
                                        (
                                            {4872}let pkCli_4471: bitstring = pub(skC) in
                                            {4873}let v_4472: bool = (Sess_4234 = A) in
                                            (
                                                {4874}if v_4472 then
                                                (
                                                    {4875}let pkSess_4473: bitstring = pub(skA) in
                                                    {4876}in(c, =GetEndpointRequest);
                                                    {4877}new SP_4474: bitstring;
                                                    {4878}new UP_4475: bitstring;
                                                    {4879}out(c, (GetEndpointResponse,pkSess_4473,None,SP_4474,UP_4475))
                                                )
                                                else
                                                    {4880}let v_4476: bool = (Sess_4234 = B) in
                                                    (
                                                        {4881}if v_4476 then
                                                        (
                                                            {4882}let pkSess_4477: bitstring = pub(skB) in
                                                            {4883}in(c, =GetEndpointRequest);
                                                            {4884}new SP_4478: bitstring;
                                                            {4885}new UP_4479: bitstring;
                                                            {4886}out(c, (GetEndpointResponse,pkSess_4477,None,SP_4478,UP_4479))
                                                        )
                                                        else
                                                            {4887}let v_4480: bool = (Sess_4234 = C) in
                                                            (
                                                                {4888}if v_4480 then
                                                                (
                                                                    {4889}let pkSess_4481: bitstring = pub(skC) in
                                                                    {4890}in(c, =GetEndpointRequest);
                                                                    {4891}new SP_4482: bitstring;
                                                                    {4892}new UP_4483: bitstring;
                                                                    {4893}out(c, (GetEndpointResponse,pkSess_4481,None,SP_4482,UP_4483))
                                                                )
                                                                else
                                                                    {4894}let pkSess_4484: bitstring = pub(sk(Sess_4234)) in
                                                                    {4895}in(c, =GetEndpointRequest);
                                                                    {4896}new SP_4485: bitstring;
                                                                    {4897}new UP_4486: bitstring;
                                                                    {4898}out(c, (GetEndpointResponse,pkSess_4484,None,SP_4485,UP_4486))
                                                            )
                                                            else
                                                                {4899}let pkSess_4487: bitstring = fail-any in
                                                                {4900}in(c, =GetEndpointRequest);
                                                                {4901}new SP_4488: bitstring;
                                                                {4902}new UP_4489: bitstring;
                                                                {4903}out(c, (GetEndpointResponse,pkSess_4487,None,SP_4488,UP_4489))
                                                    )
                                                    else
                                                        {4904}let pkSess_4490: bitstring = fail-any in
                                                        {4905}in(c, =GetEndpointRequest);
                                                        {4906}new SP_4491: bitstring;
                                                        {4907}new UP_4492: bitstring;
                                                        {4908}out(c, (GetEndpointResponse,pkSess_4490,None,SP_4491,UP_4492))
                                            )
                                            else
                                                {4909}let pkSess_4493: bitstring = fail-any in
                                                {4910}in(c, =GetEndpointRequest);
                                                {4911}new SP_4494: bitstring;
                                                {4912}new UP_4495: bitstring;
                                                {4913}out(c, (GetEndpointResponse,pkSess_4493,None,SP_4494,UP_4495))
                                        )
                                        else
                                            {4914}let pkCli_4496: bitstring = pub(sk(Cli_4232)) in
                                            {4915}let v_4497: bool = (Sess_4234 = A) in
                                            (
                                                {4916}if v_4497 then
                                                (
                                                    {4917}let pkSess_4498: bitstring = pub(skA) in
                                                    {4918}in(c, =GetEndpointRequest);
                                                    {4919}new SP_4499: bitstring;
                                                    {4920}new UP_4500: bitstring;
                                                    {4921}out(c, (GetEndpointResponse,pkSess_4498,None,SP_4499,UP_4500))
                                                )
                                                else
                                                    {4922}let v_4501: bool = (Sess_4234 = B) in
                                                    (
                                                        {4923}if v_4501 then
                                                        (
                                                            {4924}let pkSess_4502: bitstring = pub(skB) in
                                                            {4925}in(c, =GetEndpointRequest);
                                                            {4926}new SP_4503: bitstring;
                                                            {4927}new UP_4504: bitstring;
                                                            {4928}out(c, (GetEndpointResponse,pkSess_4502,None,SP_4503,UP_4504))
                                                        )
                                                        else
                                                            {4929}let v_4505: bool = (Sess_4234 = C) in
                                                            (
                                                                {4930}if v_4505 then
                                                                (
                                                                    {4931}let pkSess_4506: bitstring = pub(skC) in
                                                                    {4932}in(c, =GetEndpointRequest);
                                                                    {4933}new SP_4507: bitstring;
                                                                    {4934}new UP_4508: bitstring;
                                                                    {4935}out(c, (GetEndpointResponse,pkSess_4506,None,SP_4507,UP_4508))
                                                                )
                                                                else
                                                                    {4936}let pkSess_4509: bitstring = pub(sk(Sess_4234)) in
                                                                    {4937}in(c, =GetEndpointRequest);
                                                                    {4938}new SP_4510: bitstring;
                                                                    {4939}new UP_4511: bitstring;
                                                                    {4940}out(c, (GetEndpointResponse,pkSess_4509,None,SP_4510,UP_4511))
                                                            )
                                                            else
                                                                {4941}let pkSess_4512: bitstring = fail-any in
                                                                {4942}in(c, =GetEndpointRequest);
                                                                {4943}new SP_4513: bitstring;
                                                                {4944}new UP_4514: bitstring;
                                                                {4945}out(c, (GetEndpointResponse,pkSess_4512,None,SP_4513,UP_4514))
                                                    )
                                                    else
                                                        {4946}let pkSess_4515: bitstring = fail-any in
                                                        {4947}in(c, =GetEndpointRequest);
                                                        {4948}new SP_4516: bitstring;
                                                        {4949}new UP_4517: bitstring;
                                                        {4950}out(c, (GetEndpointResponse,pkSess_4515,None,SP_4516,UP_4517))
                                            )
                                            else
                                                {4951}let pkSess_4518: bitstring = fail-any in
                                                {4952}in(c, =GetEndpointRequest);
                                                {4953}new SP_4519: bitstring;
                                                {4954}new UP_4520: bitstring;
                                                {4955}out(c, (GetEndpointResponse,pkSess_4518,None,SP_4519,UP_4520))
                                    )
                                    else
                                        {4956}let pkCli_4521: bitstring = fail-any in
                                        {4957}let v_4522: bool = (Sess_4234 = A) in
                                        (
                                            {4958}if v_4522 then
                                            (
                                                {4959}let pkSess_4523: bitstring = pub(skA) in
                                                {4960}in(c, =GetEndpointRequest);
                                                {4961}new SP_4524: bitstring;
                                                {4962}new UP_4525: bitstring;
                                                {4963}out(c, (GetEndpointResponse,pkSess_4523,None,SP_4524,UP_4525))
                                            )
                                            else
                                                {4964}let v_4526: bool = (Sess_4234 = B) in
                                                (
                                                    {4965}if v_4526 then
                                                    (
                                                        {4966}let pkSess_4527: bitstring = pub(skB) in
                                                        {4967}in(c, =GetEndpointRequest);
                                                        {4968}new SP_4528: bitstring;
                                                        {4969}new UP_4529: bitstring;
                                                        {4970}out(c, (GetEndpointResponse,pkSess_4527,None,SP_4528,UP_4529))
                                                    )
                                                    else
                                                        {4971}let v_4530: bool = (Sess_4234 = C) in
                                                        (
                                                            {4972}if v_4530 then
                                                            (
                                                                {4973}let pkSess_4531: bitstring = pub(skC) in
                                                                {4974}in(c, =GetEndpointRequest);
                                                                {4975}new SP_4532: bitstring;
                                                                {4976}new UP_4533: bitstring;
                                                                {4977}out(c, (GetEndpointResponse,pkSess_4531,None,SP_4532,UP_4533))
                                                            )
                                                            else
                                                                {4978}let pkSess_4534: bitstring = pub(sk(Sess_4234)) in
                                                                {4979}in(c, =GetEndpointRequest);
                                                                {4980}new SP_4535: bitstring;
                                                                {4981}new UP_4536: bitstring;
                                                                {4982}out(c, (GetEndpointResponse,pkSess_4534,None,SP_4535,UP_4536))
                                                        )
                                                        else
                                                            {4983}let pkSess_4537: bitstring = fail-any in
                                                            {4984}in(c, =GetEndpointRequest);
                                                            {4985}new SP_4538: bitstring;
                                                            {4986}new UP_4539: bitstring;
                                                            {4987}out(c, (GetEndpointResponse,pkSess_4537,None,SP_4538,UP_4539))
                                                )
                                                else
                                                    {4988}let pkSess_4540: bitstring = fail-any in
                                                    {4989}in(c, =GetEndpointRequest);
                                                    {4990}new SP_4541: bitstring;
                                                    {4991}new UP_4542: bitstring;
                                                    {4992}out(c, (GetEndpointResponse,pkSess_4540,None,SP_4541,UP_4542))
                                        )
                                        else
                                            {4993}let pkSess_4543: bitstring = fail-any in
                                            {4994}in(c, =GetEndpointRequest);
                                            {4995}new SP_4544: bitstring;
                                            {4996}new UP_4545: bitstring;
                                            {4997}out(c, (GetEndpointResponse,pkSess_4543,None,SP_4544,UP_4545))
                            )
                            else
                                {4998}let pkCli_4546: bitstring = fail-any in
                                {4999}let v_4547: bool = (Sess_4234 = A) in
                                (
                                    {5000}if v_4547 then
                                    (
                                        {5001}let pkSess_4548: bitstring = pub(skA) in
                                        {5002}in(c, =GetEndpointRequest);
                                        {5003}new SP_4549: bitstring;
                                        {5004}new UP_4550: bitstring;
                                        {5005}out(c, (GetEndpointResponse,pkSess_4548,None,SP_4549,UP_4550))
                                    )
                                    else
                                        {5006}let v_4551: bool = (Sess_4234 = B) in
                                        (
                                            {5007}if v_4551 then
                                            (
                                                {5008}let pkSess_4552: bitstring = pub(skB) in
                                                {5009}in(c, =GetEndpointRequest);
                                                {5010}new SP_4553: bitstring;
                                                {5011}new UP_4554: bitstring;
                                                {5012}out(c, (GetEndpointResponse,pkSess_4552,None,SP_4553,UP_4554))
                                            )
                                            else
                                                {5013}let v_4555: bool = (Sess_4234 = C) in
                                                (
                                                    {5014}if v_4555 then
                                                    (
                                                        {5015}let pkSess_4556: bitstring = pub(skC) in
                                                        {5016}in(c, =GetEndpointRequest);
                                                        {5017}new SP_4557: bitstring;
                                                        {5018}new UP_4558: bitstring;
                                                        {5019}out(c, (GetEndpointResponse,pkSess_4556,None,SP_4557,UP_4558))
                                                    )
                                                    else
                                                        {5020}let pkSess_4559: bitstring = pub(sk(Sess_4234)) in
                                                        {5021}in(c, =GetEndpointRequest);
                                                        {5022}new SP_4560: bitstring;
                                                        {5023}new UP_4561: bitstring;
                                                        {5024}out(c, (GetEndpointResponse,pkSess_4559,None,SP_4560,UP_4561))
                                                )
                                                else
                                                    {5025}let pkSess_4562: bitstring = fail-any in
                                                    {5026}in(c, =GetEndpointRequest);
                                                    {5027}new SP_4563: bitstring;
                                                    {5028}new UP_4564: bitstring;
                                                    {5029}out(c, (GetEndpointResponse,pkSess_4562,None,SP_4563,UP_4564))
                                        )
                                        else
                                            {5030}let pkSess_4565: bitstring = fail-any in
                                            {5031}in(c, =GetEndpointRequest);
                                            {5032}new SP_4566: bitstring;
                                            {5033}new UP_4567: bitstring;
                                            {5034}out(c, (GetEndpointResponse,pkSess_4565,None,SP_4566,UP_4567))
                                )
                                else
                                    {5035}let pkSess_4568: bitstring = fail-any in
                                    {5036}in(c, =GetEndpointRequest);
                                    {5037}new SP_4569: bitstring;
                                    {5038}new UP_4570: bitstring;
                                    {5039}out(c, (GetEndpointResponse,pkSess_4568,None,SP_4569,UP_4570))
                    )
                    else
                        {5040}let pkCli_4571: bitstring = fail-any in
                        {5041}let v_4572: bool = (Sess_4234 = A) in
                        (
                            {5042}if v_4572 then
                            (
                                {5043}let pkSess_4573: bitstring = pub(skA) in
                                {5044}in(c, =GetEndpointRequest);
                                {5045}new SP_4574: bitstring;
                                {5046}new UP_4575: bitstring;
                                {5047}out(c, (GetEndpointResponse,pkSess_4573,None,SP_4574,UP_4575))
                            )
                            else
                                {5048}let v_4576: bool = (Sess_4234 = B) in
                                (
                                    {5049}if v_4576 then
                                    (
                                        {5050}let pkSess_4577: bitstring = pub(skB) in
                                        {5051}in(c, =GetEndpointRequest);
                                        {5052}new SP_4578: bitstring;
                                        {5053}new UP_4579: bitstring;
                                        {5054}out(c, (GetEndpointResponse,pkSess_4577,None,SP_4578,UP_4579))
                                    )
                                    else
                                        {5055}let v_4580: bool = (Sess_4234 = C) in
                                        (
                                            {5056}if v_4580 then
                                            (
                                                {5057}let pkSess_4581: bitstring = pub(skC) in
                                                {5058}in(c, =GetEndpointRequest);
                                                {5059}new SP_4582: bitstring;
                                                {5060}new UP_4583: bitstring;
                                                {5061}out(c, (GetEndpointResponse,pkSess_4581,None,SP_4582,UP_4583))
                                            )
                                            else
                                                {5062}let pkSess_4584: bitstring = pub(sk(Sess_4234)) in
                                                {5063}in(c, =GetEndpointRequest);
                                                {5064}new SP_4585: bitstring;
                                                {5065}new UP_4586: bitstring;
                                                {5066}out(c, (GetEndpointResponse,pkSess_4584,None,SP_4585,UP_4586))
                                        )
                                        else
                                            {5067}let pkSess_4587: bitstring = fail-any in
                                            {5068}in(c, =GetEndpointRequest);
                                            {5069}new SP_4588: bitstring;
                                            {5070}new UP_4589: bitstring;
                                            {5071}out(c, (GetEndpointResponse,pkSess_4587,None,SP_4588,UP_4589))
                                )
                                else
                                    {5072}let pkSess_4590: bitstring = fail-any in
                                    {5073}in(c, =GetEndpointRequest);
                                    {5074}new SP_4591: bitstring;
                                    {5075}new UP_4592: bitstring;
                                    {5076}out(c, (GetEndpointResponse,pkSess_4590,None,SP_4591,UP_4592))
                        )
                        else
                            {5077}let pkSess_4593: bitstring = fail-any in
                            {5078}in(c, =GetEndpointRequest);
                            {5079}new SP_4594: bitstring;
                            {5080}new UP_4595: bitstring;
                            {5081}out(c, (GetEndpointResponse,pkSess_4593,None,SP_4594,UP_4595))
                )
                else
                    {5082}let =true = (Disco_4233 = C) in
                    (
                        {5083}let skDisco_4596: bitstring = skC in
                        {5084}let pkDisco_4597: bitstring = pub(skDisco_4596) in
                        {5085}let v_4598: bool = (Cli_4232 = A) in
                        (
                            {5086}if v_4598 then
                            (
                                {5087}let pkCli_4599: bitstring = pub(skA) in
                                {5088}let v_4600: bool = (Sess_4234 = A) in
                                (
                                    {5089}if v_4600 then
                                    (
                                        {5090}let pkSess_4601: bitstring = pub(skA) in
                                        {5091}in(c, =GetEndpointRequest);
                                        {5092}new SP_4602: bitstring;
                                        {5093}new UP_4603: bitstring;
                                        {5094}out(c, (GetEndpointResponse,pkSess_4601,None,SP_4602,UP_4603))
                                    )
                                    else
                                        {5095}let v_4604: bool = (Sess_4234 = B) in
                                        (
                                            {5096}if v_4604 then
                                            (
                                                {5097}let pkSess_4605: bitstring = pub(skB) in
                                                {5098}in(c, =GetEndpointRequest);
                                                {5099}new SP_4606: bitstring;
                                                {5100}new UP_4607: bitstring;
                                                {5101}out(c, (GetEndpointResponse,pkSess_4605,None,SP_4606,UP_4607))
                                            )
                                            else
                                                {5102}let v_4608: bool = (Sess_4234 = C) in
                                                (
                                                    {5103}if v_4608 then
                                                    (
                                                        {5104}let pkSess_4609: bitstring = pub(skC) in
                                                        {5105}in(c, =GetEndpointRequest);
                                                        {5106}new SP_4610: bitstring;
                                                        {5107}new UP_4611: bitstring;
                                                        {5108}out(c, (GetEndpointResponse,pkSess_4609,None,SP_4610,UP_4611))
                                                    )
                                                    else
                                                        {5109}let pkSess_4612: bitstring = pub(sk(Sess_4234)) in
                                                        {5110}in(c, =GetEndpointRequest);
                                                        {5111}new SP_4613: bitstring;
                                                        {5112}new UP_4614: bitstring;
                                                        {5113}out(c, (GetEndpointResponse,pkSess_4612,None,SP_4613,UP_4614))
                                                )
                                                else
                                                    {5114}let pkSess_4615: bitstring = fail-any in
                                                    {5115}in(c, =GetEndpointRequest);
                                                    {5116}new SP_4616: bitstring;
                                                    {5117}new UP_4617: bitstring;
                                                    {5118}out(c, (GetEndpointResponse,pkSess_4615,None,SP_4616,UP_4617))
                                        )
                                        else
                                            {5119}let pkSess_4618: bitstring = fail-any in
                                            {5120}in(c, =GetEndpointRequest);
                                            {5121}new SP_4619: bitstring;
                                            {5122}new UP_4620: bitstring;
                                            {5123}out(c, (GetEndpointResponse,pkSess_4618,None,SP_4619,UP_4620))
                                )
                                else
                                    {5124}let pkSess_4621: bitstring = fail-any in
                                    {5125}in(c, =GetEndpointRequest);
                                    {5126}new SP_4622: bitstring;
                                    {5127}new UP_4623: bitstring;
                                    {5128}out(c, (GetEndpointResponse,pkSess_4621,None,SP_4622,UP_4623))
                            )
                            else
                                {5129}let v_4624: bool = (Cli_4232 = B) in
                                (
                                    {5130}if v_4624 then
                                    (
                                        {5131}let pkCli_4625: bitstring = pub(skB) in
                                        {5132}let v_4626: bool = (Sess_4234 = A) in
                                        (
                                            {5133}if v_4626 then
                                            (
                                                {5134}let pkSess_4627: bitstring = pub(skA) in
                                                {5135}in(c, =GetEndpointRequest);
                                                {5136}new SP_4628: bitstring;
                                                {5137}new UP_4629: bitstring;
                                                {5138}out(c, (GetEndpointResponse,pkSess_4627,None,SP_4628,UP_4629))
                                            )
                                            else
                                                {5139}let v_4630: bool = (Sess_4234 = B) in
                                                (
                                                    {5140}if v_4630 then
                                                    (
                                                        {5141}let pkSess_4631: bitstring = pub(skB) in
                                                        {5142}in(c, =GetEndpointRequest);
                                                        {5143}new SP_4632: bitstring;
                                                        {5144}new UP_4633: bitstring;
                                                        {5145}out(c, (GetEndpointResponse,pkSess_4631,None,SP_4632,UP_4633))
                                                    )
                                                    else
                                                        {5146}let v_4634: bool = (Sess_4234 = C) in
                                                        (
                                                            {5147}if v_4634 then
                                                            (
                                                                {5148}let pkSess_4635: bitstring = pub(skC) in
                                                                {5149}in(c, =GetEndpointRequest);
                                                                {5150}new SP_4636: bitstring;
                                                                {5151}new UP_4637: bitstring;
                                                                {5152}out(c, (GetEndpointResponse,pkSess_4635,None,SP_4636,UP_4637))
                                                            )
                                                            else
                                                                {5153}let pkSess_4638: bitstring = pub(sk(Sess_4234)) in
                                                                {5154}in(c, =GetEndpointRequest);
                                                                {5155}new SP_4639: bitstring;
                                                                {5156}new UP_4640: bitstring;
                                                                {5157}out(c, (GetEndpointResponse,pkSess_4638,None,SP_4639,UP_4640))
                                                        )
                                                        else
                                                            {5158}let pkSess_4641: bitstring = fail-any in
                                                            {5159}in(c, =GetEndpointRequest);
                                                            {5160}new SP_4642: bitstring;
                                                            {5161}new UP_4643: bitstring;
                                                            {5162}out(c, (GetEndpointResponse,pkSess_4641,None,SP_4642,UP_4643))
                                                )
                                                else
                                                    {5163}let pkSess_4644: bitstring = fail-any in
                                                    {5164}in(c, =GetEndpointRequest);
                                                    {5165}new SP_4645: bitstring;
                                                    {5166}new UP_4646: bitstring;
                                                    {5167}out(c, (GetEndpointResponse,pkSess_4644,None,SP_4645,UP_4646))
                                        )
                                        else
                                            {5168}let pkSess_4647: bitstring = fail-any in
                                            {5169}in(c, =GetEndpointRequest);
                                            {5170}new SP_4648: bitstring;
                                            {5171}new UP_4649: bitstring;
                                            {5172}out(c, (GetEndpointResponse,pkSess_4647,None,SP_4648,UP_4649))
                                    )
                                    else
                                        {5173}let v_4650: bool = (Cli_4232 = C) in
                                        (
                                            {5174}if v_4650 then
                                            (
                                                {5175}let pkCli_4651: bitstring = pub(skC) in
                                                {5176}let v_4652: bool = (Sess_4234 = A) in
                                                (
                                                    {5177}if v_4652 then
                                                    (
                                                        {5178}let pkSess_4653: bitstring = pub(skA) in
                                                        {5179}in(c, =GetEndpointRequest);
                                                        {5180}new SP_4654: bitstring;
                                                        {5181}new UP_4655: bitstring;
                                                        {5182}out(c, (GetEndpointResponse,pkSess_4653,None,SP_4654,UP_4655))
                                                    )
                                                    else
                                                        {5183}let v_4656: bool = (Sess_4234 = B) in
                                                        (
                                                            {5184}if v_4656 then
                                                            (
                                                                {5185}let pkSess_4657: bitstring = pub(skB) in
                                                                {5186}in(c, =GetEndpointRequest);
                                                                {5187}new SP_4658: bitstring;
                                                                {5188}new UP_4659: bitstring;
                                                                {5189}out(c, (GetEndpointResponse,pkSess_4657,None,SP_4658,UP_4659))
                                                            )
                                                            else
                                                                {5190}let v_4660: bool = (Sess_4234 = C) in
                                                                (
                                                                    {5191}if v_4660 then
                                                                    (
                                                                        {5192}let pkSess_4661: bitstring = pub(skC) in
                                                                        {5193}in(c, =GetEndpointRequest);
                                                                        {5194}new SP_4662: bitstring;
                                                                        {5195}new UP_4663: bitstring;
                                                                        {5196}out(c, (GetEndpointResponse,pkSess_4661,None,SP_4662,UP_4663))
                                                                    )
                                                                    else
                                                                        {5197}let pkSess_4664: bitstring = pub(sk(Sess_4234)) in
                                                                        {5198}in(c, =GetEndpointRequest);
                                                                        {5199}new SP_4665: bitstring;
                                                                        {5200}new UP_4666: bitstring;
                                                                        {5201}out(c, (GetEndpointResponse,pkSess_4664,None,SP_4665,UP_4666))
                                                                )
                                                                else
                                                                    {5202}let pkSess_4667: bitstring = fail-any in
                                                                    {5203}in(c, =GetEndpointRequest);
                                                                    {5204}new SP_4668: bitstring;
                                                                    {5205}new UP_4669: bitstring;
                                                                    {5206}out(c, (GetEndpointResponse,pkSess_4667,None,SP_4668,UP_4669))
                                                        )
                                                        else
                                                            {5207}let pkSess_4670: bitstring = fail-any in
                                                            {5208}in(c, =GetEndpointRequest);
                                                            {5209}new SP_4671: bitstring;
                                                            {5210}new UP_4672: bitstring;
                                                            {5211}out(c, (GetEndpointResponse,pkSess_4670,None,SP_4671,UP_4672))
                                                )
                                                else
                                                    {5212}let pkSess_4673: bitstring = fail-any in
                                                    {5213}in(c, =GetEndpointRequest);
                                                    {5214}new SP_4674: bitstring;
                                                    {5215}new UP_4675: bitstring;
                                                    {5216}out(c, (GetEndpointResponse,pkSess_4673,None,SP_4674,UP_4675))
                                            )
                                            else
                                                {5217}let pkCli_4676: bitstring = pub(sk(Cli_4232)) in
                                                {5218}let v_4677: bool = (Sess_4234 = A) in
                                                (
                                                    {5219}if v_4677 then
                                                    (
                                                        {5220}let pkSess_4678: bitstring = pub(skA) in
                                                        {5221}in(c, =GetEndpointRequest);
                                                        {5222}new SP_4679: bitstring;
                                                        {5223}new UP_4680: bitstring;
                                                        {5224}out(c, (GetEndpointResponse,pkSess_4678,None,SP_4679,UP_4680))
                                                    )
                                                    else
                                                        {5225}let v_4681: bool = (Sess_4234 = B) in
                                                        (
                                                            {5226}if v_4681 then
                                                            (
                                                                {5227}let pkSess_4682: bitstring = pub(skB) in
                                                                {5228}in(c, =GetEndpointRequest);
                                                                {5229}new SP_4683: bitstring;
                                                                {5230}new UP_4684: bitstring;
                                                                {5231}out(c, (GetEndpointResponse,pkSess_4682,None,SP_4683,UP_4684))
                                                            )
                                                            else
                                                                {5232}let v_4685: bool = (Sess_4234 = C) in
                                                                (
                                                                    {5233}if v_4685 then
                                                                    (
                                                                        {5234}let pkSess_4686: bitstring = pub(skC) in
                                                                        {5235}in(c, =GetEndpointRequest);
                                                                        {5236}new SP_4687: bitstring;
                                                                        {5237}new UP_4688: bitstring;
                                                                        {5238}out(c, (GetEndpointResponse,pkSess_4686,None,SP_4687,UP_4688))
                                                                    )
                                                                    else
                                                                        {5239}let pkSess_4689: bitstring = pub(sk(Sess_4234)) in
                                                                        {5240}in(c, =GetEndpointRequest);
                                                                        {5241}new SP_4690: bitstring;
                                                                        {5242}new UP_4691: bitstring;
                                                                        {5243}out(c, (GetEndpointResponse,pkSess_4689,None,SP_4690,UP_4691))
                                                                )
                                                                else
                                                                    {5244}let pkSess_4692: bitstring = fail-any in
                                                                    {5245}in(c, =GetEndpointRequest);
                                                                    {5246}new SP_4693: bitstring;
                                                                    {5247}new UP_4694: bitstring;
                                                                    {5248}out(c, (GetEndpointResponse,pkSess_4692,None,SP_4693,UP_4694))
                                                        )
                                                        else
                                                            {5249}let pkSess_4695: bitstring = fail-any in
                                                            {5250}in(c, =GetEndpointRequest);
                                                            {5251}new SP_4696: bitstring;
                                                            {5252}new UP_4697: bitstring;
                                                            {5253}out(c, (GetEndpointResponse,pkSess_4695,None,SP_4696,UP_4697))
                                                )
                                                else
                                                    {5254}let pkSess_4698: bitstring = fail-any in
                                                    {5255}in(c, =GetEndpointRequest);
                                                    {5256}new SP_4699: bitstring;
                                                    {5257}new UP_4700: bitstring;
                                                    {5258}out(c, (GetEndpointResponse,pkSess_4698,None,SP_4699,UP_4700))
                                        )
                                        else
                                            {5259}let pkCli_4701: bitstring = fail-any in
                                            {5260}let v_4702: bool = (Sess_4234 = A) in
                                            (
                                                {5261}if v_4702 then
                                                (
                                                    {5262}let pkSess_4703: bitstring = pub(skA) in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_4704: bitstring;
                                                    {5265}new UP_4705: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_4703,None,SP_4704,UP_4705))
                                                )
                                                else
                                                    {5267}let v_4706: bool = (Sess_4234 = B) in
                                                    (
                                                        {5268}if v_4706 then
                                                        (
                                                            {5269}let pkSess_4707: bitstring = pub(skB) in
                                                            {5270}in(c, =GetEndpointRequest);
                                                            {5271}new SP_4708: bitstring;
                                                            {5272}new UP_4709: bitstring;
                                                            {5273}out(c, (GetEndpointResponse,pkSess_4707,None,SP_4708,UP_4709))
                                                        )
                                                        else
                                                            {5274}let v_4710: bool = (Sess_4234 = C) in
                                                            (
                                                                {5275}if v_4710 then
                                                                (
                                                                    {5276}let pkSess_4711: bitstring = pub(skC) in
                                                                    {5277}in(c, =GetEndpointRequest);
                                                                    {5278}new SP_4712: bitstring;
                                                                    {5279}new UP_4713: bitstring;
                                                                    {5280}out(c, (GetEndpointResponse,pkSess_4711,None,SP_4712,UP_4713))
                                                                )
                                                                else
                                                                    {5281}let pkSess_4714: bitstring = pub(sk(Sess_4234)) in
                                                                    {5282}in(c, =GetEndpointRequest);
                                                                    {5283}new SP_4715: bitstring;
                                                                    {5284}new UP_4716: bitstring;
                                                                    {5285}out(c, (GetEndpointResponse,pkSess_4714,None,SP_4715,UP_4716))
                                                            )
                                                            else
                                                                {5286}let pkSess_4717: bitstring = fail-any in
                                                                {5287}in(c, =GetEndpointRequest);
                                                                {5288}new SP_4718: bitstring;
                                                                {5289}new UP_4719: bitstring;
                                                                {5290}out(c, (GetEndpointResponse,pkSess_4717,None,SP_4718,UP_4719))
                                                    )
                                                    else
                                                        {5291}let pkSess_4720: bitstring = fail-any in
                                                        {5292}in(c, =GetEndpointRequest);
                                                        {5293}new SP_4721: bitstring;
                                                        {5294}new UP_4722: bitstring;
                                                        {5295}out(c, (GetEndpointResponse,pkSess_4720,None,SP_4721,UP_4722))
                                            )
                                            else
                                                {5296}let pkSess_4723: bitstring = fail-any in
                                                {5297}in(c, =GetEndpointRequest);
                                                {5298}new SP_4724: bitstring;
                                                {5299}new UP_4725: bitstring;
                                                {5300}out(c, (GetEndpointResponse,pkSess_4723,None,SP_4724,UP_4725))
                                )
                                else
                                    {5301}let pkCli_4726: bitstring = fail-any in
                                    {5302}let v_4727: bool = (Sess_4234 = A) in
                                    (
                                        {5303}if v_4727 then
                                        (
                                            {5304}let pkSess_4728: bitstring = pub(skA) in
                                            {5305}in(c, =GetEndpointRequest);
                                            {5306}new SP_4729: bitstring;
                                            {5307}new UP_4730: bitstring;
                                            {5308}out(c, (GetEndpointResponse,pkSess_4728,None,SP_4729,UP_4730))
                                        )
                                        else
                                            {5309}let v_4731: bool = (Sess_4234 = B) in
                                            (
                                                {5310}if v_4731 then
                                                (
                                                    {5311}let pkSess_4732: bitstring = pub(skB) in
                                                    {5312}in(c, =GetEndpointRequest);
                                                    {5313}new SP_4733: bitstring;
                                                    {5314}new UP_4734: bitstring;
                                                    {5315}out(c, (GetEndpointResponse,pkSess_4732,None,SP_4733,UP_4734))
                                                )
                                                else
                                                    {5316}let v_4735: bool = (Sess_4234 = C) in
                                                    (
                                                        {5317}if v_4735 then
                                                        (
                                                            {5318}let pkSess_4736: bitstring = pub(skC) in
                                                            {5319}in(c, =GetEndpointRequest);
                                                            {5320}new SP_4737: bitstring;
                                                            {5321}new UP_4738: bitstring;
                                                            {5322}out(c, (GetEndpointResponse,pkSess_4736,None,SP_4737,UP_4738))
                                                        )
                                                        else
                                                            {5323}let pkSess_4739: bitstring = pub(sk(Sess_4234)) in
                                                            {5324}in(c, =GetEndpointRequest);
                                                            {5325}new SP_4740: bitstring;
                                                            {5326}new UP_4741: bitstring;
                                                            {5327}out(c, (GetEndpointResponse,pkSess_4739,None,SP_4740,UP_4741))
                                                    )
                                                    else
                                                        {5328}let pkSess_4742: bitstring = fail-any in
                                                        {5329}in(c, =GetEndpointRequest);
                                                        {5330}new SP_4743: bitstring;
                                                        {5331}new UP_4744: bitstring;
                                                        {5332}out(c, (GetEndpointResponse,pkSess_4742,None,SP_4743,UP_4744))
                                            )
                                            else
                                                {5333}let pkSess_4745: bitstring = fail-any in
                                                {5334}in(c, =GetEndpointRequest);
                                                {5335}new SP_4746: bitstring;
                                                {5336}new UP_4747: bitstring;
                                                {5337}out(c, (GetEndpointResponse,pkSess_4745,None,SP_4746,UP_4747))
                                    )
                                    else
                                        {5338}let pkSess_4748: bitstring = fail-any in
                                        {5339}in(c, =GetEndpointRequest);
                                        {5340}new SP_4749: bitstring;
                                        {5341}new UP_4750: bitstring;
                                        {5342}out(c, (GetEndpointResponse,pkSess_4748,None,SP_4749,UP_4750))
                        )
                        else
                            {5343}let pkCli_4751: bitstring = fail-any in
                            {5344}let v_4752: bool = (Sess_4234 = A) in
                            (
                                {5345}if v_4752 then
                                (
                                    {5346}let pkSess_4753: bitstring = pub(skA) in
                                    {5347}in(c, =GetEndpointRequest);
                                    {5348}new SP_4754: bitstring;
                                    {5349}new UP_4755: bitstring;
                                    {5350}out(c, (GetEndpointResponse,pkSess_4753,None,SP_4754,UP_4755))
                                )
                                else
                                    {5351}let v_4756: bool = (Sess_4234 = B) in
                                    (
                                        {5352}if v_4756 then
                                        (
                                            {5353}let pkSess_4757: bitstring = pub(skB) in
                                            {5354}in(c, =GetEndpointRequest);
                                            {5355}new SP_4758: bitstring;
                                            {5356}new UP_4759: bitstring;
                                            {5357}out(c, (GetEndpointResponse,pkSess_4757,None,SP_4758,UP_4759))
                                        )
                                        else
                                            {5358}let v_4760: bool = (Sess_4234 = C) in
                                            (
                                                {5359}if v_4760 then
                                                (
                                                    {5360}let pkSess_4761: bitstring = pub(skC) in
                                                    {5361}in(c, =GetEndpointRequest);
                                                    {5362}new SP_4762: bitstring;
                                                    {5363}new UP_4763: bitstring;
                                                    {5364}out(c, (GetEndpointResponse,pkSess_4761,None,SP_4762,UP_4763))
                                                )
                                                else
                                                    {5365}let pkSess_4764: bitstring = pub(sk(Sess_4234)) in
                                                    {5366}in(c, =GetEndpointRequest);
                                                    {5367}new SP_4765: bitstring;
                                                    {5368}new UP_4766: bitstring;
                                                    {5369}out(c, (GetEndpointResponse,pkSess_4764,None,SP_4765,UP_4766))
                                            )
                                            else
                                                {5370}let pkSess_4767: bitstring = fail-any in
                                                {5371}in(c, =GetEndpointRequest);
                                                {5372}new SP_4768: bitstring;
                                                {5373}new UP_4769: bitstring;
                                                {5374}out(c, (GetEndpointResponse,pkSess_4767,None,SP_4768,UP_4769))
                                    )
                                    else
                                        {5375}let pkSess_4770: bitstring = fail-any in
                                        {5376}in(c, =GetEndpointRequest);
                                        {5377}new SP_4771: bitstring;
                                        {5378}new UP_4772: bitstring;
                                        {5379}out(c, (GetEndpointResponse,pkSess_4770,None,SP_4771,UP_4772))
                            )
                            else
                                {5380}let pkSess_4773: bitstring = fail-any in
                                {5381}in(c, =GetEndpointRequest);
                                {5382}new SP_4774: bitstring;
                                {5383}new UP_4775: bitstring;
                                {5384}out(c, (GetEndpointResponse,pkSess_4773,None,SP_4774,UP_4775))
                    )
                    else
                        {5385}let skDisco_4776: bitstring = fail-any in
                        {5386}let pkDisco_4777: bitstring = pub(skDisco_4776) in
                        {5387}let v_4778: bool = (Cli_4232 = A) in
                        (
                            {5388}if v_4778 then
                            (
                                {5389}let pkCli_4779: bitstring = pub(skA) in
                                {5390}let v_4780: bool = (Sess_4234 = A) in
                                (
                                    {5391}if v_4780 then
                                    (
                                        {5392}let pkSess_4781: bitstring = pub(skA) in
                                        {5393}in(c, =GetEndpointRequest);
                                        {5394}new SP_4782: bitstring;
                                        {5395}new UP_4783: bitstring;
                                        {5396}out(c, (GetEndpointResponse,pkSess_4781,None,SP_4782,UP_4783))
                                    )
                                    else
                                        {5397}let v_4784: bool = (Sess_4234 = B) in
                                        (
                                            {5398}if v_4784 then
                                            (
                                                {5399}let pkSess_4785: bitstring = pub(skB) in
                                                {5400}in(c, =GetEndpointRequest);
                                                {5401}new SP_4786: bitstring;
                                                {5402}new UP_4787: bitstring;
                                                {5403}out(c, (GetEndpointResponse,pkSess_4785,None,SP_4786,UP_4787))
                                            )
                                            else
                                                {5404}let v_4788: bool = (Sess_4234 = C) in
                                                (
                                                    {5405}if v_4788 then
                                                    (
                                                        {5406}let pkSess_4789: bitstring = pub(skC) in
                                                        {5407}in(c, =GetEndpointRequest);
                                                        {5408}new SP_4790: bitstring;
                                                        {5409}new UP_4791: bitstring;
                                                        {5410}out(c, (GetEndpointResponse,pkSess_4789,None,SP_4790,UP_4791))
                                                    )
                                                    else
                                                        {5411}let pkSess_4792: bitstring = pub(sk(Sess_4234)) in
                                                        {5412}in(c, =GetEndpointRequest);
                                                        {5413}new SP_4793: bitstring;
                                                        {5414}new UP_4794: bitstring;
                                                        {5415}out(c, (GetEndpointResponse,pkSess_4792,None,SP_4793,UP_4794))
                                                )
                                                else
                                                    {5416}let pkSess_4795: bitstring = fail-any in
                                                    {5417}in(c, =GetEndpointRequest);
                                                    {5418}new SP_4796: bitstring;
                                                    {5419}new UP_4797: bitstring;
                                                    {5420}out(c, (GetEndpointResponse,pkSess_4795,None,SP_4796,UP_4797))
                                        )
                                        else
                                            {5421}let pkSess_4798: bitstring = fail-any in
                                            {5422}in(c, =GetEndpointRequest);
                                            {5423}new SP_4799: bitstring;
                                            {5424}new UP_4800: bitstring;
                                            {5425}out(c, (GetEndpointResponse,pkSess_4798,None,SP_4799,UP_4800))
                                )
                                else
                                    {5426}let pkSess_4801: bitstring = fail-any in
                                    {5427}in(c, =GetEndpointRequest);
                                    {5428}new SP_4802: bitstring;
                                    {5429}new UP_4803: bitstring;
                                    {5430}out(c, (GetEndpointResponse,pkSess_4801,None,SP_4802,UP_4803))
                            )
                            else
                                {5431}let v_4804: bool = (Cli_4232 = B) in
                                (
                                    {5432}if v_4804 then
                                    (
                                        {5433}let pkCli_4805: bitstring = pub(skB) in
                                        {5434}let v_4806: bool = (Sess_4234 = A) in
                                        (
                                            {5435}if v_4806 then
                                            (
                                                {5436}let pkSess_4807: bitstring = pub(skA) in
                                                {5437}in(c, =GetEndpointRequest);
                                                {5438}new SP_4808: bitstring;
                                                {5439}new UP_4809: bitstring;
                                                {5440}out(c, (GetEndpointResponse,pkSess_4807,None,SP_4808,UP_4809))
                                            )
                                            else
                                                {5441}let v_4810: bool = (Sess_4234 = B) in
                                                (
                                                    {5442}if v_4810 then
                                                    (
                                                        {5443}let pkSess_4811: bitstring = pub(skB) in
                                                        {5444}in(c, =GetEndpointRequest);
                                                        {5445}new SP_4812: bitstring;
                                                        {5446}new UP_4813: bitstring;
                                                        {5447}out(c, (GetEndpointResponse,pkSess_4811,None,SP_4812,UP_4813))
                                                    )
                                                    else
                                                        {5448}let v_4814: bool = (Sess_4234 = C) in
                                                        (
                                                            {5449}if v_4814 then
                                                            (
                                                                {5450}let pkSess_4815: bitstring = pub(skC) in
                                                                {5451}in(c, =GetEndpointRequest);
                                                                {5452}new SP_4816: bitstring;
                                                                {5453}new UP_4817: bitstring;
                                                                {5454}out(c, (GetEndpointResponse,pkSess_4815,None,SP_4816,UP_4817))
                                                            )
                                                            else
                                                                {5455}let pkSess_4818: bitstring = pub(sk(Sess_4234)) in
                                                                {5456}in(c, =GetEndpointRequest);
                                                                {5457}new SP_4819: bitstring;
                                                                {5458}new UP_4820: bitstring;
                                                                {5459}out(c, (GetEndpointResponse,pkSess_4818,None,SP_4819,UP_4820))
                                                        )
                                                        else
                                                            {5460}let pkSess_4821: bitstring = fail-any in
                                                            {5461}in(c, =GetEndpointRequest);
                                                            {5462}new SP_4822: bitstring;
                                                            {5463}new UP_4823: bitstring;
                                                            {5464}out(c, (GetEndpointResponse,pkSess_4821,None,SP_4822,UP_4823))
                                                )
                                                else
                                                    {5465}let pkSess_4824: bitstring = fail-any in
                                                    {5466}in(c, =GetEndpointRequest);
                                                    {5467}new SP_4825: bitstring;
                                                    {5468}new UP_4826: bitstring;
                                                    {5469}out(c, (GetEndpointResponse,pkSess_4824,None,SP_4825,UP_4826))
                                        )
                                        else
                                            {5470}let pkSess_4827: bitstring = fail-any in
                                            {5471}in(c, =GetEndpointRequest);
                                            {5472}new SP_4828: bitstring;
                                            {5473}new UP_4829: bitstring;
                                            {5474}out(c, (GetEndpointResponse,pkSess_4827,None,SP_4828,UP_4829))
                                    )
                                    else
                                        {5475}let v_4830: bool = (Cli_4232 = C) in
                                        (
                                            {5476}if v_4830 then
                                            (
                                                {5477}let pkCli_4831: bitstring = pub(skC) in
                                                {5478}let v_4832: bool = (Sess_4234 = A) in
                                                (
                                                    {5479}if v_4832 then
                                                    (
                                                        {5480}let pkSess_4833: bitstring = pub(skA) in
                                                        {5481}in(c, =GetEndpointRequest);
                                                        {5482}new SP_4834: bitstring;
                                                        {5483}new UP_4835: bitstring;
                                                        {5484}out(c, (GetEndpointResponse,pkSess_4833,None,SP_4834,UP_4835))
                                                    )
                                                    else
                                                        {5485}let v_4836: bool = (Sess_4234 = B) in
                                                        (
                                                            {5486}if v_4836 then
                                                            (
                                                                {5487}let pkSess_4837: bitstring = pub(skB) in
                                                                {5488}in(c, =GetEndpointRequest);
                                                                {5489}new SP_4838: bitstring;
                                                                {5490}new UP_4839: bitstring;
                                                                {5491}out(c, (GetEndpointResponse,pkSess_4837,None,SP_4838,UP_4839))
                                                            )
                                                            else
                                                                {5492}let v_4840: bool = (Sess_4234 = C) in
                                                                (
                                                                    {5493}if v_4840 then
                                                                    (
                                                                        {5494}let pkSess_4841: bitstring = pub(skC) in
                                                                        {5495}in(c, =GetEndpointRequest);
                                                                        {5496}new SP_4842: bitstring;
                                                                        {5497}new UP_4843: bitstring;
                                                                        {5498}out(c, (GetEndpointResponse,pkSess_4841,None,SP_4842,UP_4843))
                                                                    )
                                                                    else
                                                                        {5499}let pkSess_4844: bitstring = pub(sk(Sess_4234)) in
                                                                        {5500}in(c, =GetEndpointRequest);
                                                                        {5501}new SP_4845: bitstring;
                                                                        {5502}new UP_4846: bitstring;
                                                                        {5503}out(c, (GetEndpointResponse,pkSess_4844,None,SP_4845,UP_4846))
                                                                )
                                                                else
                                                                    {5504}let pkSess_4847: bitstring = fail-any in
                                                                    {5505}in(c, =GetEndpointRequest);
                                                                    {5506}new SP_4848: bitstring;
                                                                    {5507}new UP_4849: bitstring;
                                                                    {5508}out(c, (GetEndpointResponse,pkSess_4847,None,SP_4848,UP_4849))
                                                        )
                                                        else
                                                            {5509}let pkSess_4850: bitstring = fail-any in
                                                            {5510}in(c, =GetEndpointRequest);
                                                            {5511}new SP_4851: bitstring;
                                                            {5512}new UP_4852: bitstring;
                                                            {5513}out(c, (GetEndpointResponse,pkSess_4850,None,SP_4851,UP_4852))
                                                )
                                                else
                                                    {5514}let pkSess_4853: bitstring = fail-any in
                                                    {5515}in(c, =GetEndpointRequest);
                                                    {5516}new SP_4854: bitstring;
                                                    {5517}new UP_4855: bitstring;
                                                    {5518}out(c, (GetEndpointResponse,pkSess_4853,None,SP_4854,UP_4855))
                                            )
                                            else
                                                {5519}let pkCli_4856: bitstring = pub(sk(Cli_4232)) in
                                                {5520}let v_4857: bool = (Sess_4234 = A) in
                                                (
                                                    {5521}if v_4857 then
                                                    (
                                                        {5522}let pkSess_4858: bitstring = pub(skA) in
                                                        {5523}in(c, =GetEndpointRequest);
                                                        {5524}new SP_4859: bitstring;
                                                        {5525}new UP_4860: bitstring;
                                                        {5526}out(c, (GetEndpointResponse,pkSess_4858,None,SP_4859,UP_4860))
                                                    )
                                                    else
                                                        {5527}let v_4861: bool = (Sess_4234 = B) in
                                                        (
                                                            {5528}if v_4861 then
                                                            (
                                                                {5529}let pkSess_4862: bitstring = pub(skB) in
                                                                {5530}in(c, =GetEndpointRequest);
                                                                {5531}new SP_4863: bitstring;
                                                                {5532}new UP_4864: bitstring;
                                                                {5533}out(c, (GetEndpointResponse,pkSess_4862,None,SP_4863,UP_4864))
                                                            )
                                                            else
                                                                {5534}let v_4865: bool = (Sess_4234 = C) in
                                                                (
                                                                    {5535}if v_4865 then
                                                                    (
                                                                        {5536}let pkSess_4866: bitstring = pub(skC) in
                                                                        {5537}in(c, =GetEndpointRequest);
                                                                        {5538}new SP_4867: bitstring;
                                                                        {5539}new UP_4868: bitstring;
                                                                        {5540}out(c, (GetEndpointResponse,pkSess_4866,None,SP_4867,UP_4868))
                                                                    )
                                                                    else
                                                                        {5541}let pkSess_4869: bitstring = pub(sk(Sess_4234)) in
                                                                        {5542}in(c, =GetEndpointRequest);
                                                                        {5543}new SP_4870: bitstring;
                                                                        {5544}new UP_4871: bitstring;
                                                                        {5545}out(c, (GetEndpointResponse,pkSess_4869,None,SP_4870,UP_4871))
                                                                )
                                                                else
                                                                    {5546}let pkSess_4872: bitstring = fail-any in
                                                                    {5547}in(c, =GetEndpointRequest);
                                                                    {5548}new SP_4873: bitstring;
                                                                    {5549}new UP_4874: bitstring;
                                                                    {5550}out(c, (GetEndpointResponse,pkSess_4872,None,SP_4873,UP_4874))
                                                        )
                                                        else
                                                            {5551}let pkSess_4875: bitstring = fail-any in
                                                            {5552}in(c, =GetEndpointRequest);
                                                            {5553}new SP_4876: bitstring;
                                                            {5554}new UP_4877: bitstring;
                                                            {5555}out(c, (GetEndpointResponse,pkSess_4875,None,SP_4876,UP_4877))
                                                )
                                                else
                                                    {5556}let pkSess_4878: bitstring = fail-any in
                                                    {5557}in(c, =GetEndpointRequest);
                                                    {5558}new SP_4879: bitstring;
                                                    {5559}new UP_4880: bitstring;
                                                    {5560}out(c, (GetEndpointResponse,pkSess_4878,None,SP_4879,UP_4880))
                                        )
                                        else
                                            {5561}let pkCli_4881: bitstring = fail-any in
                                            {5562}let v_4882: bool = (Sess_4234 = A) in
                                            (
                                                {5563}if v_4882 then
                                                (
                                                    {5564}let pkSess_4883: bitstring = pub(skA) in
                                                    {5565}in(c, =GetEndpointRequest);
                                                    {5566}new SP_4884: bitstring;
                                                    {5567}new UP_4885: bitstring;
                                                    {5568}out(c, (GetEndpointResponse,pkSess_4883,None,SP_4884,UP_4885))
                                                )
                                                else
                                                    {5569}let v_4886: bool = (Sess_4234 = B) in
                                                    (
                                                        {5570}if v_4886 then
                                                        (
                                                            {5571}let pkSess_4887: bitstring = pub(skB) in
                                                            {5572}in(c, =GetEndpointRequest);
                                                            {5573}new SP_4888: bitstring;
                                                            {5574}new UP_4889: bitstring;
                                                            {5575}out(c, (GetEndpointResponse,pkSess_4887,None,SP_4888,UP_4889))
                                                        )
                                                        else
                                                            {5576}let v_4890: bool = (Sess_4234 = C) in
                                                            (
                                                                {5577}if v_4890 then
                                                                (
                                                                    {5578}let pkSess_4891: bitstring = pub(skC) in
                                                                    {5579}in(c, =GetEndpointRequest);
                                                                    {5580}new SP_4892: bitstring;
                                                                    {5581}new UP_4893: bitstring;
                                                                    {5582}out(c, (GetEndpointResponse,pkSess_4891,None,SP_4892,UP_4893))
                                                                )
                                                                else
                                                                    {5583}let pkSess_4894: bitstring = pub(sk(Sess_4234)) in
                                                                    {5584}in(c, =GetEndpointRequest);
                                                                    {5585}new SP_4895: bitstring;
                                                                    {5586}new UP_4896: bitstring;
                                                                    {5587}out(c, (GetEndpointResponse,pkSess_4894,None,SP_4895,UP_4896))
                                                            )
                                                            else
                                                                {5588}let pkSess_4897: bitstring = fail-any in
                                                                {5589}in(c, =GetEndpointRequest);
                                                                {5590}new SP_4898: bitstring;
                                                                {5591}new UP_4899: bitstring;
                                                                {5592}out(c, (GetEndpointResponse,pkSess_4897,None,SP_4898,UP_4899))
                                                    )
                                                    else
                                                        {5593}let pkSess_4900: bitstring = fail-any in
                                                        {5594}in(c, =GetEndpointRequest);
                                                        {5595}new SP_4901: bitstring;
                                                        {5596}new UP_4902: bitstring;
                                                        {5597}out(c, (GetEndpointResponse,pkSess_4900,None,SP_4901,UP_4902))
                                            )
                                            else
                                                {5598}let pkSess_4903: bitstring = fail-any in
                                                {5599}in(c, =GetEndpointRequest);
                                                {5600}new SP_4904: bitstring;
                                                {5601}new UP_4905: bitstring;
                                                {5602}out(c, (GetEndpointResponse,pkSess_4903,None,SP_4904,UP_4905))
                                )
                                else
                                    {5603}let pkCli_4906: bitstring = fail-any in
                                    {5604}let v_4907: bool = (Sess_4234 = A) in
                                    (
                                        {5605}if v_4907 then
                                        (
                                            {5606}let pkSess_4908: bitstring = pub(skA) in
                                            {5607}in(c, =GetEndpointRequest);
                                            {5608}new SP_4909: bitstring;
                                            {5609}new UP_4910: bitstring;
                                            {5610}out(c, (GetEndpointResponse,pkSess_4908,None,SP_4909,UP_4910))
                                        )
                                        else
                                            {5611}let v_4911: bool = (Sess_4234 = B) in
                                            (
                                                {5612}if v_4911 then
                                                (
                                                    {5613}let pkSess_4912: bitstring = pub(skB) in
                                                    {5614}in(c, =GetEndpointRequest);
                                                    {5615}new SP_4913: bitstring;
                                                    {5616}new UP_4914: bitstring;
                                                    {5617}out(c, (GetEndpointResponse,pkSess_4912,None,SP_4913,UP_4914))
                                                )
                                                else
                                                    {5618}let v_4915: bool = (Sess_4234 = C) in
                                                    (
                                                        {5619}if v_4915 then
                                                        (
                                                            {5620}let pkSess_4916: bitstring = pub(skC) in
                                                            {5621}in(c, =GetEndpointRequest);
                                                            {5622}new SP_4917: bitstring;
                                                            {5623}new UP_4918: bitstring;
                                                            {5624}out(c, (GetEndpointResponse,pkSess_4916,None,SP_4917,UP_4918))
                                                        )
                                                        else
                                                            {5625}let pkSess_4919: bitstring = pub(sk(Sess_4234)) in
                                                            {5626}in(c, =GetEndpointRequest);
                                                            {5627}new SP_4920: bitstring;
                                                            {5628}new UP_4921: bitstring;
                                                            {5629}out(c, (GetEndpointResponse,pkSess_4919,None,SP_4920,UP_4921))
                                                    )
                                                    else
                                                        {5630}let pkSess_4922: bitstring = fail-any in
                                                        {5631}in(c, =GetEndpointRequest);
                                                        {5632}new SP_4923: bitstring;
                                                        {5633}new UP_4924: bitstring;
                                                        {5634}out(c, (GetEndpointResponse,pkSess_4922,None,SP_4923,UP_4924))
                                            )
                                            else
                                                {5635}let pkSess_4925: bitstring = fail-any in
                                                {5636}in(c, =GetEndpointRequest);
                                                {5637}new SP_4926: bitstring;
                                                {5638}new UP_4927: bitstring;
                                                {5639}out(c, (GetEndpointResponse,pkSess_4925,None,SP_4926,UP_4927))
                                    )
                                    else
                                        {5640}let pkSess_4928: bitstring = fail-any in
                                        {5641}in(c, =GetEndpointRequest);
                                        {5642}new SP_4929: bitstring;
                                        {5643}new UP_4930: bitstring;
                                        {5644}out(c, (GetEndpointResponse,pkSess_4928,None,SP_4929,UP_4930))
                        )
                        else
                            {5645}let pkCli_4931: bitstring = fail-any in
                            {5646}let v_4932: bool = (Sess_4234 = A) in
                            (
                                {5647}if v_4932 then
                                (
                                    {5648}let pkSess_4933: bitstring = pub(skA) in
                                    {5649}in(c, =GetEndpointRequest);
                                    {5650}new SP_4934: bitstring;
                                    {5651}new UP_4935: bitstring;
                                    {5652}out(c, (GetEndpointResponse,pkSess_4933,None,SP_4934,UP_4935))
                                )
                                else
                                    {5653}let v_4936: bool = (Sess_4234 = B) in
                                    (
                                        {5654}if v_4936 then
                                        (
                                            {5655}let pkSess_4937: bitstring = pub(skB) in
                                            {5656}in(c, =GetEndpointRequest);
                                            {5657}new SP_4938: bitstring;
                                            {5658}new UP_4939: bitstring;
                                            {5659}out(c, (GetEndpointResponse,pkSess_4937,None,SP_4938,UP_4939))
                                        )
                                        else
                                            {5660}let v_4940: bool = (Sess_4234 = C) in
                                            (
                                                {5661}if v_4940 then
                                                (
                                                    {5662}let pkSess_4941: bitstring = pub(skC) in
                                                    {5663}in(c, =GetEndpointRequest);
                                                    {5664}new SP_4942: bitstring;
                                                    {5665}new UP_4943: bitstring;
                                                    {5666}out(c, (GetEndpointResponse,pkSess_4941,None,SP_4942,UP_4943))
                                                )
                                                else
                                                    {5667}let pkSess_4944: bitstring = pub(sk(Sess_4234)) in
                                                    {5668}in(c, =GetEndpointRequest);
                                                    {5669}new SP_4945: bitstring;
                                                    {5670}new UP_4946: bitstring;
                                                    {5671}out(c, (GetEndpointResponse,pkSess_4944,None,SP_4945,UP_4946))
                                            )
                                            else
                                                {5672}let pkSess_4947: bitstring = fail-any in
                                                {5673}in(c, =GetEndpointRequest);
                                                {5674}new SP_4948: bitstring;
                                                {5675}new UP_4949: bitstring;
                                                {5676}out(c, (GetEndpointResponse,pkSess_4947,None,SP_4948,UP_4949))
                                    )
                                    else
                                        {5677}let pkSess_4950: bitstring = fail-any in
                                        {5678}in(c, =GetEndpointRequest);
                                        {5679}new SP_4951: bitstring;
                                        {5680}new UP_4952: bitstring;
                                        {5681}out(c, (GetEndpointResponse,pkSess_4950,None,SP_4951,UP_4952))
                            )
                            else
                                {5682}let pkSess_4953: bitstring = fail-any in
                                {5683}in(c, =GetEndpointRequest);
                                {5684}new SP_4954: bitstring;
                                {5685}new UP_4955: bitstring;
                                {5686}out(c, (GetEndpointResponse,pkSess_4953,None,SP_4954,UP_4955))
            )
            else
                {5687}let skDisco_4956: bitstring = fail-any in
                {5688}let pkDisco_4957: bitstring = pub(skDisco_4956) in
                {5689}let v_4958: bool = (Cli_4232 = A) in
                (
                    {5690}if v_4958 then
                    (
                        {5691}let pkCli_4959: bitstring = pub(skA) in
                        {5692}let v_4960: bool = (Sess_4234 = A) in
                        (
                            {5693}if v_4960 then
                            (
                                {5694}let pkSess_4961: bitstring = pub(skA) in
                                {5695}in(c, =GetEndpointRequest);
                                {5696}new SP_4962: bitstring;
                                {5697}new UP_4963: bitstring;
                                {5698}out(c, (GetEndpointResponse,pkSess_4961,None,SP_4962,UP_4963))
                            )
                            else
                                {5699}let v_4964: bool = (Sess_4234 = B) in
                                (
                                    {5700}if v_4964 then
                                    (
                                        {5701}let pkSess_4965: bitstring = pub(skB) in
                                        {5702}in(c, =GetEndpointRequest);
                                        {5703}new SP_4966: bitstring;
                                        {5704}new UP_4967: bitstring;
                                        {5705}out(c, (GetEndpointResponse,pkSess_4965,None,SP_4966,UP_4967))
                                    )
                                    else
                                        {5706}let v_4968: bool = (Sess_4234 = C) in
                                        (
                                            {5707}if v_4968 then
                                            (
                                                {5708}let pkSess_4969: bitstring = pub(skC) in
                                                {5709}in(c, =GetEndpointRequest);
                                                {5710}new SP_4970: bitstring;
                                                {5711}new UP_4971: bitstring;
                                                {5712}out(c, (GetEndpointResponse,pkSess_4969,None,SP_4970,UP_4971))
                                            )
                                            else
                                                {5713}let pkSess_4972: bitstring = pub(sk(Sess_4234)) in
                                                {5714}in(c, =GetEndpointRequest);
                                                {5715}new SP_4973: bitstring;
                                                {5716}new UP_4974: bitstring;
                                                {5717}out(c, (GetEndpointResponse,pkSess_4972,None,SP_4973,UP_4974))
                                        )
                                        else
                                            {5718}let pkSess_4975: bitstring = fail-any in
                                            {5719}in(c, =GetEndpointRequest);
                                            {5720}new SP_4976: bitstring;
                                            {5721}new UP_4977: bitstring;
                                            {5722}out(c, (GetEndpointResponse,pkSess_4975,None,SP_4976,UP_4977))
                                )
                                else
                                    {5723}let pkSess_4978: bitstring = fail-any in
                                    {5724}in(c, =GetEndpointRequest);
                                    {5725}new SP_4979: bitstring;
                                    {5726}new UP_4980: bitstring;
                                    {5727}out(c, (GetEndpointResponse,pkSess_4978,None,SP_4979,UP_4980))
                        )
                        else
                            {5728}let pkSess_4981: bitstring = fail-any in
                            {5729}in(c, =GetEndpointRequest);
                            {5730}new SP_4982: bitstring;
                            {5731}new UP_4983: bitstring;
                            {5732}out(c, (GetEndpointResponse,pkSess_4981,None,SP_4982,UP_4983))
                    )
                    else
                        {5733}let v_4984: bool = (Cli_4232 = B) in
                        (
                            {5734}if v_4984 then
                            (
                                {5735}let pkCli_4985: bitstring = pub(skB) in
                                {5736}let v_4986: bool = (Sess_4234 = A) in
                                (
                                    {5737}if v_4986 then
                                    (
                                        {5738}let pkSess_4987: bitstring = pub(skA) in
                                        {5739}in(c, =GetEndpointRequest);
                                        {5740}new SP_4988: bitstring;
                                        {5741}new UP_4989: bitstring;
                                        {5742}out(c, (GetEndpointResponse,pkSess_4987,None,SP_4988,UP_4989))
                                    )
                                    else
                                        {5743}let v_4990: bool = (Sess_4234 = B) in
                                        (
                                            {5744}if v_4990 then
                                            (
                                                {5745}let pkSess_4991: bitstring = pub(skB) in
                                                {5746}in(c, =GetEndpointRequest);
                                                {5747}new SP_4992: bitstring;
                                                {5748}new UP_4993: bitstring;
                                                {5749}out(c, (GetEndpointResponse,pkSess_4991,None,SP_4992,UP_4993))
                                            )
                                            else
                                                {5750}let v_4994: bool = (Sess_4234 = C) in
                                                (
                                                    {5751}if v_4994 then
                                                    (
                                                        {5752}let pkSess_4995: bitstring = pub(skC) in
                                                        {5753}in(c, =GetEndpointRequest);
                                                        {5754}new SP_4996: bitstring;
                                                        {5755}new UP_4997: bitstring;
                                                        {5756}out(c, (GetEndpointResponse,pkSess_4995,None,SP_4996,UP_4997))
                                                    )
                                                    else
                                                        {5757}let pkSess_4998: bitstring = pub(sk(Sess_4234)) in
                                                        {5758}in(c, =GetEndpointRequest);
                                                        {5759}new SP_4999: bitstring;
                                                        {5760}new UP_5000: bitstring;
                                                        {5761}out(c, (GetEndpointResponse,pkSess_4998,None,SP_4999,UP_5000))
                                                )
                                                else
                                                    {5762}let pkSess_5001: bitstring = fail-any in
                                                    {5763}in(c, =GetEndpointRequest);
                                                    {5764}new SP_5002: bitstring;
                                                    {5765}new UP_5003: bitstring;
                                                    {5766}out(c, (GetEndpointResponse,pkSess_5001,None,SP_5002,UP_5003))
                                        )
                                        else
                                            {5767}let pkSess_5004: bitstring = fail-any in
                                            {5768}in(c, =GetEndpointRequest);
                                            {5769}new SP_5005: bitstring;
                                            {5770}new UP_5006: bitstring;
                                            {5771}out(c, (GetEndpointResponse,pkSess_5004,None,SP_5005,UP_5006))
                                )
                                else
                                    {5772}let pkSess_5007: bitstring = fail-any in
                                    {5773}in(c, =GetEndpointRequest);
                                    {5774}new SP_5008: bitstring;
                                    {5775}new UP_5009: bitstring;
                                    {5776}out(c, (GetEndpointResponse,pkSess_5007,None,SP_5008,UP_5009))
                            )
                            else
                                {5777}let v_5010: bool = (Cli_4232 = C) in
                                (
                                    {5778}if v_5010 then
                                    (
                                        {5779}let pkCli_5011: bitstring = pub(skC) in
                                        {5780}let v_5012: bool = (Sess_4234 = A) in
                                        (
                                            {5781}if v_5012 then
                                            (
                                                {5782}let pkSess_5013: bitstring = pub(skA) in
                                                {5783}in(c, =GetEndpointRequest);
                                                {5784}new SP_5014: bitstring;
                                                {5785}new UP_5015: bitstring;
                                                {5786}out(c, (GetEndpointResponse,pkSess_5013,None,SP_5014,UP_5015))
                                            )
                                            else
                                                {5787}let v_5016: bool = (Sess_4234 = B) in
                                                (
                                                    {5788}if v_5016 then
                                                    (
                                                        {5789}let pkSess_5017: bitstring = pub(skB) in
                                                        {5790}in(c, =GetEndpointRequest);
                                                        {5791}new SP_5018: bitstring;
                                                        {5792}new UP_5019: bitstring;
                                                        {5793}out(c, (GetEndpointResponse,pkSess_5017,None,SP_5018,UP_5019))
                                                    )
                                                    else
                                                        {5794}let v_5020: bool = (Sess_4234 = C) in
                                                        (
                                                            {5795}if v_5020 then
                                                            (
                                                                {5796}let pkSess_5021: bitstring = pub(skC) in
                                                                {5797}in(c, =GetEndpointRequest);
                                                                {5798}new SP_5022: bitstring;
                                                                {5799}new UP_5023: bitstring;
                                                                {5800}out(c, (GetEndpointResponse,pkSess_5021,None,SP_5022,UP_5023))
                                                            )
                                                            else
                                                                {5801}let pkSess_5024: bitstring = pub(sk(Sess_4234)) in
                                                                {5802}in(c, =GetEndpointRequest);
                                                                {5803}new SP_5025: bitstring;
                                                                {5804}new UP_5026: bitstring;
                                                                {5805}out(c, (GetEndpointResponse,pkSess_5024,None,SP_5025,UP_5026))
                                                        )
                                                        else
                                                            {5806}let pkSess_5027: bitstring = fail-any in
                                                            {5807}in(c, =GetEndpointRequest);
                                                            {5808}new SP_5028: bitstring;
                                                            {5809}new UP_5029: bitstring;
                                                            {5810}out(c, (GetEndpointResponse,pkSess_5027,None,SP_5028,UP_5029))
                                                )
                                                else
                                                    {5811}let pkSess_5030: bitstring = fail-any in
                                                    {5812}in(c, =GetEndpointRequest);
                                                    {5813}new SP_5031: bitstring;
                                                    {5814}new UP_5032: bitstring;
                                                    {5815}out(c, (GetEndpointResponse,pkSess_5030,None,SP_5031,UP_5032))
                                        )
                                        else
                                            {5816}let pkSess_5033: bitstring = fail-any in
                                            {5817}in(c, =GetEndpointRequest);
                                            {5818}new SP_5034: bitstring;
                                            {5819}new UP_5035: bitstring;
                                            {5820}out(c, (GetEndpointResponse,pkSess_5033,None,SP_5034,UP_5035))
                                    )
                                    else
                                        {5821}let pkCli_5036: bitstring = pub(sk(Cli_4232)) in
                                        {5822}let v_5037: bool = (Sess_4234 = A) in
                                        (
                                            {5823}if v_5037 then
                                            (
                                                {5824}let pkSess_5038: bitstring = pub(skA) in
                                                {5825}in(c, =GetEndpointRequest);
                                                {5826}new SP_5039: bitstring;
                                                {5827}new UP_5040: bitstring;
                                                {5828}out(c, (GetEndpointResponse,pkSess_5038,None,SP_5039,UP_5040))
                                            )
                                            else
                                                {5829}let v_5041: bool = (Sess_4234 = B) in
                                                (
                                                    {5830}if v_5041 then
                                                    (
                                                        {5831}let pkSess_5042: bitstring = pub(skB) in
                                                        {5832}in(c, =GetEndpointRequest);
                                                        {5833}new SP_5043: bitstring;
                                                        {5834}new UP_5044: bitstring;
                                                        {5835}out(c, (GetEndpointResponse,pkSess_5042,None,SP_5043,UP_5044))
                                                    )
                                                    else
                                                        {5836}let v_5045: bool = (Sess_4234 = C) in
                                                        (
                                                            {5837}if v_5045 then
                                                            (
                                                                {5838}let pkSess_5046: bitstring = pub(skC) in
                                                                {5839}in(c, =GetEndpointRequest);
                                                                {5840}new SP_5047: bitstring;
                                                                {5841}new UP_5048: bitstring;
                                                                {5842}out(c, (GetEndpointResponse,pkSess_5046,None,SP_5047,UP_5048))
                                                            )
                                                            else
                                                                {5843}let pkSess_5049: bitstring = pub(sk(Sess_4234)) in
                                                                {5844}in(c, =GetEndpointRequest);
                                                                {5845}new SP_5050: bitstring;
                                                                {5846}new UP_5051: bitstring;
                                                                {5847}out(c, (GetEndpointResponse,pkSess_5049,None,SP_5050,UP_5051))
                                                        )
                                                        else
                                                            {5848}let pkSess_5052: bitstring = fail-any in
                                                            {5849}in(c, =GetEndpointRequest);
                                                            {5850}new SP_5053: bitstring;
                                                            {5851}new UP_5054: bitstring;
                                                            {5852}out(c, (GetEndpointResponse,pkSess_5052,None,SP_5053,UP_5054))
                                                )
                                                else
                                                    {5853}let pkSess_5055: bitstring = fail-any in
                                                    {5854}in(c, =GetEndpointRequest);
                                                    {5855}new SP_5056: bitstring;
                                                    {5856}new UP_5057: bitstring;
                                                    {5857}out(c, (GetEndpointResponse,pkSess_5055,None,SP_5056,UP_5057))
                                        )
                                        else
                                            {5858}let pkSess_5058: bitstring = fail-any in
                                            {5859}in(c, =GetEndpointRequest);
                                            {5860}new SP_5059: bitstring;
                                            {5861}new UP_5060: bitstring;
                                            {5862}out(c, (GetEndpointResponse,pkSess_5058,None,SP_5059,UP_5060))
                                )
                                else
                                    {5863}let pkCli_5061: bitstring = fail-any in
                                    {5864}let v_5062: bool = (Sess_4234 = A) in
                                    (
                                        {5865}if v_5062 then
                                        (
                                            {5866}let pkSess_5063: bitstring = pub(skA) in
                                            {5867}in(c, =GetEndpointRequest);
                                            {5868}new SP_5064: bitstring;
                                            {5869}new UP_5065: bitstring;
                                            {5870}out(c, (GetEndpointResponse,pkSess_5063,None,SP_5064,UP_5065))
                                        )
                                        else
                                            {5871}let v_5066: bool = (Sess_4234 = B) in
                                            (
                                                {5872}if v_5066 then
                                                (
                                                    {5873}let pkSess_5067: bitstring = pub(skB) in
                                                    {5874}in(c, =GetEndpointRequest);
                                                    {5875}new SP_5068: bitstring;
                                                    {5876}new UP_5069: bitstring;
                                                    {5877}out(c, (GetEndpointResponse,pkSess_5067,None,SP_5068,UP_5069))
                                                )
                                                else
                                                    {5878}let v_5070: bool = (Sess_4234 = C) in
                                                    (
                                                        {5879}if v_5070 then
                                                        (
                                                            {5880}let pkSess_5071: bitstring = pub(skC) in
                                                            {5881}in(c, =GetEndpointRequest);
                                                            {5882}new SP_5072: bitstring;
                                                            {5883}new UP_5073: bitstring;
                                                            {5884}out(c, (GetEndpointResponse,pkSess_5071,None,SP_5072,UP_5073))
                                                        )
                                                        else
                                                            {5885}let pkSess_5074: bitstring = pub(sk(Sess_4234)) in
                                                            {5886}in(c, =GetEndpointRequest);
                                                            {5887}new SP_5075: bitstring;
                                                            {5888}new UP_5076: bitstring;
                                                            {5889}out(c, (GetEndpointResponse,pkSess_5074,None,SP_5075,UP_5076))
                                                    )
                                                    else
                                                        {5890}let pkSess_5077: bitstring = fail-any in
                                                        {5891}in(c, =GetEndpointRequest);
                                                        {5892}new SP_5078: bitstring;
                                                        {5893}new UP_5079: bitstring;
                                                        {5894}out(c, (GetEndpointResponse,pkSess_5077,None,SP_5078,UP_5079))
                                            )
                                            else
                                                {5895}let pkSess_5080: bitstring = fail-any in
                                                {5896}in(c, =GetEndpointRequest);
                                                {5897}new SP_5081: bitstring;
                                                {5898}new UP_5082: bitstring;
                                                {5899}out(c, (GetEndpointResponse,pkSess_5080,None,SP_5081,UP_5082))
                                    )
                                    else
                                        {5900}let pkSess_5083: bitstring = fail-any in
                                        {5901}in(c, =GetEndpointRequest);
                                        {5902}new SP_5084: bitstring;
                                        {5903}new UP_5085: bitstring;
                                        {5904}out(c, (GetEndpointResponse,pkSess_5083,None,SP_5084,UP_5085))
                        )
                        else
                            {5905}let pkCli_5086: bitstring = fail-any in
                            {5906}let v_5087: bool = (Sess_4234 = A) in
                            (
                                {5907}if v_5087 then
                                (
                                    {5908}let pkSess_5088: bitstring = pub(skA) in
                                    {5909}in(c, =GetEndpointRequest);
                                    {5910}new SP_5089: bitstring;
                                    {5911}new UP_5090: bitstring;
                                    {5912}out(c, (GetEndpointResponse,pkSess_5088,None,SP_5089,UP_5090))
                                )
                                else
                                    {5913}let v_5091: bool = (Sess_4234 = B) in
                                    (
                                        {5914}if v_5091 then
                                        (
                                            {5915}let pkSess_5092: bitstring = pub(skB) in
                                            {5916}in(c, =GetEndpointRequest);
                                            {5917}new SP_5093: bitstring;
                                            {5918}new UP_5094: bitstring;
                                            {5919}out(c, (GetEndpointResponse,pkSess_5092,None,SP_5093,UP_5094))
                                        )
                                        else
                                            {5920}let v_5095: bool = (Sess_4234 = C) in
                                            (
                                                {5921}if v_5095 then
                                                (
                                                    {5922}let pkSess_5096: bitstring = pub(skC) in
                                                    {5923}in(c, =GetEndpointRequest);
                                                    {5924}new SP_5097: bitstring;
                                                    {5925}new UP_5098: bitstring;
                                                    {5926}out(c, (GetEndpointResponse,pkSess_5096,None,SP_5097,UP_5098))
                                                )
                                                else
                                                    {5927}let pkSess_5099: bitstring = pub(sk(Sess_4234)) in
                                                    {5928}in(c, =GetEndpointRequest);
                                                    {5929}new SP_5100: bitstring;
                                                    {5930}new UP_5101: bitstring;
                                                    {5931}out(c, (GetEndpointResponse,pkSess_5099,None,SP_5100,UP_5101))
                                            )
                                            else
                                                {5932}let pkSess_5102: bitstring = fail-any in
                                                {5933}in(c, =GetEndpointRequest);
                                                {5934}new SP_5103: bitstring;
                                                {5935}new UP_5104: bitstring;
                                                {5936}out(c, (GetEndpointResponse,pkSess_5102,None,SP_5103,UP_5104))
                                    )
                                    else
                                        {5937}let pkSess_5105: bitstring = fail-any in
                                        {5938}in(c, =GetEndpointRequest);
                                        {5939}new SP_5106: bitstring;
                                        {5940}new UP_5107: bitstring;
                                        {5941}out(c, (GetEndpointResponse,pkSess_5105,None,SP_5106,UP_5107))
                            )
                            else
                                {5942}let pkSess_5108: bitstring = fail-any in
                                {5943}in(c, =GetEndpointRequest);
                                {5944}new SP_5109: bitstring;
                                {5945}new UP_5110: bitstring;
                                {5946}out(c, (GetEndpointResponse,pkSess_5108,None,SP_5109,UP_5110))
                )
                else
                    {5947}let pkCli_5111: bitstring = fail-any in
                    {5948}let v_5112: bool = (Sess_4234 = A) in
                    (
                        {5949}if v_5112 then
                        (
                            {5950}let pkSess_5113: bitstring = pub(skA) in
                            {5951}in(c, =GetEndpointRequest);
                            {5952}new SP_5114: bitstring;
                            {5953}new UP_5115: bitstring;
                            {5954}out(c, (GetEndpointResponse,pkSess_5113,None,SP_5114,UP_5115))
                        )
                        else
                            {5955}let v_5116: bool = (Sess_4234 = B) in
                            (
                                {5956}if v_5116 then
                                (
                                    {5957}let pkSess_5117: bitstring = pub(skB) in
                                    {5958}in(c, =GetEndpointRequest);
                                    {5959}new SP_5118: bitstring;
                                    {5960}new UP_5119: bitstring;
                                    {5961}out(c, (GetEndpointResponse,pkSess_5117,None,SP_5118,UP_5119))
                                )
                                else
                                    {5962}let v_5120: bool = (Sess_4234 = C) in
                                    (
                                        {5963}if v_5120 then
                                        (
                                            {5964}let pkSess_5121: bitstring = pub(skC) in
                                            {5965}in(c, =GetEndpointRequest);
                                            {5966}new SP_5122: bitstring;
                                            {5967}new UP_5123: bitstring;
                                            {5968}out(c, (GetEndpointResponse,pkSess_5121,None,SP_5122,UP_5123))
                                        )
                                        else
                                            {5969}let pkSess_5124: bitstring = pub(sk(Sess_4234)) in
                                            {5970}in(c, =GetEndpointRequest);
                                            {5971}new SP_5125: bitstring;
                                            {5972}new UP_5126: bitstring;
                                            {5973}out(c, (GetEndpointResponse,pkSess_5124,None,SP_5125,UP_5126))
                                    )
                                    else
                                        {5974}let pkSess_5127: bitstring = fail-any in
                                        {5975}in(c, =GetEndpointRequest);
                                        {5976}new SP_5128: bitstring;
                                        {5977}new UP_5129: bitstring;
                                        {5978}out(c, (GetEndpointResponse,pkSess_5127,None,SP_5128,UP_5129))
                            )
                            else
                                {5979}let pkSess_5130: bitstring = fail-any in
                                {5980}in(c, =GetEndpointRequest);
                                {5981}new SP_5131: bitstring;
                                {5982}new UP_5132: bitstring;
                                {5983}out(c, (GetEndpointResponse,pkSess_5130,None,SP_5131,UP_5132))
                    )
                    else
                        {5984}let pkSess_5133: bitstring = fail-any in
                        {5985}in(c, =GetEndpointRequest);
                        {5986}new SP_5134: bitstring;
                        {5987}new UP_5135: bitstring;
                        {5988}out(c, (GetEndpointResponse,pkSess_5133,None,SP_5134,UP_5135))
    )
    else
        {5989}let skDisco_5136: bitstring = fail-any in
        {5990}let pkDisco_5137: bitstring = pub(skDisco_5136) in
        {5991}let v_5138: bool = (Cli_4232 = A) in
        (
            {5992}if v_5138 then
            (
                {5993}let pkCli_5139: bitstring = pub(skA) in
                {5994}let v_5140: bool = (Sess_4234 = A) in
                (
                    {5995}if v_5140 then
                    (
                        {5996}let pkSess_5141: bitstring = pub(skA) in
                        {5997}in(c, =GetEndpointRequest);
                        {5998}new SP_5142: bitstring;
                        {5999}new UP_5143: bitstring;
                        {6000}out(c, (GetEndpointResponse,pkSess_5141,None,SP_5142,UP_5143))
                    )
                    else
                        {6001}let v_5144: bool = (Sess_4234 = B) in
                        (
                            {6002}if v_5144 then
                            (
                                {6003}let pkSess_5145: bitstring = pub(skB) in
                                {6004}in(c, =GetEndpointRequest);
                                {6005}new SP_5146: bitstring;
                                {6006}new UP_5147: bitstring;
                                {6007}out(c, (GetEndpointResponse,pkSess_5145,None,SP_5146,UP_5147))
                            )
                            else
                                {6008}let v_5148: bool = (Sess_4234 = C) in
                                (
                                    {6009}if v_5148 then
                                    (
                                        {6010}let pkSess_5149: bitstring = pub(skC) in
                                        {6011}in(c, =GetEndpointRequest);
                                        {6012}new SP_5150: bitstring;
                                        {6013}new UP_5151: bitstring;
                                        {6014}out(c, (GetEndpointResponse,pkSess_5149,None,SP_5150,UP_5151))
                                    )
                                    else
                                        {6015}let pkSess_5152: bitstring = pub(sk(Sess_4234)) in
                                        {6016}in(c, =GetEndpointRequest);
                                        {6017}new SP_5153: bitstring;
                                        {6018}new UP_5154: bitstring;
                                        {6019}out(c, (GetEndpointResponse,pkSess_5152,None,SP_5153,UP_5154))
                                )
                                else
                                    {6020}let pkSess_5155: bitstring = fail-any in
                                    {6021}in(c, =GetEndpointRequest);
                                    {6022}new SP_5156: bitstring;
                                    {6023}new UP_5157: bitstring;
                                    {6024}out(c, (GetEndpointResponse,pkSess_5155,None,SP_5156,UP_5157))
                        )
                        else
                            {6025}let pkSess_5158: bitstring = fail-any in
                            {6026}in(c, =GetEndpointRequest);
                            {6027}new SP_5159: bitstring;
                            {6028}new UP_5160: bitstring;
                            {6029}out(c, (GetEndpointResponse,pkSess_5158,None,SP_5159,UP_5160))
                )
                else
                    {6030}let pkSess_5161: bitstring = fail-any in
                    {6031}in(c, =GetEndpointRequest);
                    {6032}new SP_5162: bitstring;
                    {6033}new UP_5163: bitstring;
                    {6034}out(c, (GetEndpointResponse,pkSess_5161,None,SP_5162,UP_5163))
            )
            else
                {6035}let v_5164: bool = (Cli_4232 = B) in
                (
                    {6036}if v_5164 then
                    (
                        {6037}let pkCli_5165: bitstring = pub(skB) in
                        {6038}let v_5166: bool = (Sess_4234 = A) in
                        (
                            {6039}if v_5166 then
                            (
                                {6040}let pkSess_5167: bitstring = pub(skA) in
                                {6041}in(c, =GetEndpointRequest);
                                {6042}new SP_5168: bitstring;
                                {6043}new UP_5169: bitstring;
                                {6044}out(c, (GetEndpointResponse,pkSess_5167,None,SP_5168,UP_5169))
                            )
                            else
                                {6045}let v_5170: bool = (Sess_4234 = B) in
                                (
                                    {6046}if v_5170 then
                                    (
                                        {6047}let pkSess_5171: bitstring = pub(skB) in
                                        {6048}in(c, =GetEndpointRequest);
                                        {6049}new SP_5172: bitstring;
                                        {6050}new UP_5173: bitstring;
                                        {6051}out(c, (GetEndpointResponse,pkSess_5171,None,SP_5172,UP_5173))
                                    )
                                    else
                                        {6052}let v_5174: bool = (Sess_4234 = C) in
                                        (
                                            {6053}if v_5174 then
                                            (
                                                {6054}let pkSess_5175: bitstring = pub(skC) in
                                                {6055}in(c, =GetEndpointRequest);
                                                {6056}new SP_5176: bitstring;
                                                {6057}new UP_5177: bitstring;
                                                {6058}out(c, (GetEndpointResponse,pkSess_5175,None,SP_5176,UP_5177))
                                            )
                                            else
                                                {6059}let pkSess_5178: bitstring = pub(sk(Sess_4234)) in
                                                {6060}in(c, =GetEndpointRequest);
                                                {6061}new SP_5179: bitstring;
                                                {6062}new UP_5180: bitstring;
                                                {6063}out(c, (GetEndpointResponse,pkSess_5178,None,SP_5179,UP_5180))
                                        )
                                        else
                                            {6064}let pkSess_5181: bitstring = fail-any in
                                            {6065}in(c, =GetEndpointRequest);
                                            {6066}new SP_5182: bitstring;
                                            {6067}new UP_5183: bitstring;
                                            {6068}out(c, (GetEndpointResponse,pkSess_5181,None,SP_5182,UP_5183))
                                )
                                else
                                    {6069}let pkSess_5184: bitstring = fail-any in
                                    {6070}in(c, =GetEndpointRequest);
                                    {6071}new SP_5185: bitstring;
                                    {6072}new UP_5186: bitstring;
                                    {6073}out(c, (GetEndpointResponse,pkSess_5184,None,SP_5185,UP_5186))
                        )
                        else
                            {6074}let pkSess_5187: bitstring = fail-any in
                            {6075}in(c, =GetEndpointRequest);
                            {6076}new SP_5188: bitstring;
                            {6077}new UP_5189: bitstring;
                            {6078}out(c, (GetEndpointResponse,pkSess_5187,None,SP_5188,UP_5189))
                    )
                    else
                        {6079}let v_5190: bool = (Cli_4232 = C) in
                        (
                            {6080}if v_5190 then
                            (
                                {6081}let pkCli_5191: bitstring = pub(skC) in
                                {6082}let v_5192: bool = (Sess_4234 = A) in
                                (
                                    {6083}if v_5192 then
                                    (
                                        {6084}let pkSess_5193: bitstring = pub(skA) in
                                        {6085}in(c, =GetEndpointRequest);
                                        {6086}new SP_5194: bitstring;
                                        {6087}new UP_5195: bitstring;
                                        {6088}out(c, (GetEndpointResponse,pkSess_5193,None,SP_5194,UP_5195))
                                    )
                                    else
                                        {6089}let v_5196: bool = (Sess_4234 = B) in
                                        (
                                            {6090}if v_5196 then
                                            (
                                                {6091}let pkSess_5197: bitstring = pub(skB) in
                                                {6092}in(c, =GetEndpointRequest);
                                                {6093}new SP_5198: bitstring;
                                                {6094}new UP_5199: bitstring;
                                                {6095}out(c, (GetEndpointResponse,pkSess_5197,None,SP_5198,UP_5199))
                                            )
                                            else
                                                {6096}let v_5200: bool = (Sess_4234 = C) in
                                                (
                                                    {6097}if v_5200 then
                                                    (
                                                        {6098}let pkSess_5201: bitstring = pub(skC) in
                                                        {6099}in(c, =GetEndpointRequest);
                                                        {6100}new SP_5202: bitstring;
                                                        {6101}new UP_5203: bitstring;
                                                        {6102}out(c, (GetEndpointResponse,pkSess_5201,None,SP_5202,UP_5203))
                                                    )
                                                    else
                                                        {6103}let pkSess_5204: bitstring = pub(sk(Sess_4234)) in
                                                        {6104}in(c, =GetEndpointRequest);
                                                        {6105}new SP_5205: bitstring;
                                                        {6106}new UP_5206: bitstring;
                                                        {6107}out(c, (GetEndpointResponse,pkSess_5204,None,SP_5205,UP_5206))
                                                )
                                                else
                                                    {6108}let pkSess_5207: bitstring = fail-any in
                                                    {6109}in(c, =GetEndpointRequest);
                                                    {6110}new SP_5208: bitstring;
                                                    {6111}new UP_5209: bitstring;
                                                    {6112}out(c, (GetEndpointResponse,pkSess_5207,None,SP_5208,UP_5209))
                                        )
                                        else
                                            {6113}let pkSess_5210: bitstring = fail-any in
                                            {6114}in(c, =GetEndpointRequest);
                                            {6115}new SP_5211: bitstring;
                                            {6116}new UP_5212: bitstring;
                                            {6117}out(c, (GetEndpointResponse,pkSess_5210,None,SP_5211,UP_5212))
                                )
                                else
                                    {6118}let pkSess_5213: bitstring = fail-any in
                                    {6119}in(c, =GetEndpointRequest);
                                    {6120}new SP_5214: bitstring;
                                    {6121}new UP_5215: bitstring;
                                    {6122}out(c, (GetEndpointResponse,pkSess_5213,None,SP_5214,UP_5215))
                            )
                            else
                                {6123}let pkCli_5216: bitstring = pub(sk(Cli_4232)) in
                                {6124}let v_5217: bool = (Sess_4234 = A) in
                                (
                                    {6125}if v_5217 then
                                    (
                                        {6126}let pkSess_5218: bitstring = pub(skA) in
                                        {6127}in(c, =GetEndpointRequest);
                                        {6128}new SP_5219: bitstring;
                                        {6129}new UP_5220: bitstring;
                                        {6130}out(c, (GetEndpointResponse,pkSess_5218,None,SP_5219,UP_5220))
                                    )
                                    else
                                        {6131}let v_5221: bool = (Sess_4234 = B) in
                                        (
                                            {6132}if v_5221 then
                                            (
                                                {6133}let pkSess_5222: bitstring = pub(skB) in
                                                {6134}in(c, =GetEndpointRequest);
                                                {6135}new SP_5223: bitstring;
                                                {6136}new UP_5224: bitstring;
                                                {6137}out(c, (GetEndpointResponse,pkSess_5222,None,SP_5223,UP_5224))
                                            )
                                            else
                                                {6138}let v_5225: bool = (Sess_4234 = C) in
                                                (
                                                    {6139}if v_5225 then
                                                    (
                                                        {6140}let pkSess_5226: bitstring = pub(skC) in
                                                        {6141}in(c, =GetEndpointRequest);
                                                        {6142}new SP_5227: bitstring;
                                                        {6143}new UP_5228: bitstring;
                                                        {6144}out(c, (GetEndpointResponse,pkSess_5226,None,SP_5227,UP_5228))
                                                    )
                                                    else
                                                        {6145}let pkSess_5229: bitstring = pub(sk(Sess_4234)) in
                                                        {6146}in(c, =GetEndpointRequest);
                                                        {6147}new SP_5230: bitstring;
                                                        {6148}new UP_5231: bitstring;
                                                        {6149}out(c, (GetEndpointResponse,pkSess_5229,None,SP_5230,UP_5231))
                                                )
                                                else
                                                    {6150}let pkSess_5232: bitstring = fail-any in
                                                    {6151}in(c, =GetEndpointRequest);
                                                    {6152}new SP_5233: bitstring;
                                                    {6153}new UP_5234: bitstring;
                                                    {6154}out(c, (GetEndpointResponse,pkSess_5232,None,SP_5233,UP_5234))
                                        )
                                        else
                                            {6155}let pkSess_5235: bitstring = fail-any in
                                            {6156}in(c, =GetEndpointRequest);
                                            {6157}new SP_5236: bitstring;
                                            {6158}new UP_5237: bitstring;
                                            {6159}out(c, (GetEndpointResponse,pkSess_5235,None,SP_5236,UP_5237))
                                )
                                else
                                    {6160}let pkSess_5238: bitstring = fail-any in
                                    {6161}in(c, =GetEndpointRequest);
                                    {6162}new SP_5239: bitstring;
                                    {6163}new UP_5240: bitstring;
                                    {6164}out(c, (GetEndpointResponse,pkSess_5238,None,SP_5239,UP_5240))
                        )
                        else
                            {6165}let pkCli_5241: bitstring = fail-any in
                            {6166}let v_5242: bool = (Sess_4234 = A) in
                            (
                                {6167}if v_5242 then
                                (
                                    {6168}let pkSess_5243: bitstring = pub(skA) in
                                    {6169}in(c, =GetEndpointRequest);
                                    {6170}new SP_5244: bitstring;
                                    {6171}new UP_5245: bitstring;
                                    {6172}out(c, (GetEndpointResponse,pkSess_5243,None,SP_5244,UP_5245))
                                )
                                else
                                    {6173}let v_5246: bool = (Sess_4234 = B) in
                                    (
                                        {6174}if v_5246 then
                                        (
                                            {6175}let pkSess_5247: bitstring = pub(skB) in
                                            {6176}in(c, =GetEndpointRequest);
                                            {6177}new SP_5248: bitstring;
                                            {6178}new UP_5249: bitstring;
                                            {6179}out(c, (GetEndpointResponse,pkSess_5247,None,SP_5248,UP_5249))
                                        )
                                        else
                                            {6180}let v_5250: bool = (Sess_4234 = C) in
                                            (
                                                {6181}if v_5250 then
                                                (
                                                    {6182}let pkSess_5251: bitstring = pub(skC) in
                                                    {6183}in(c, =GetEndpointRequest);
                                                    {6184}new SP_5252: bitstring;
                                                    {6185}new UP_5253: bitstring;
                                                    {6186}out(c, (GetEndpointResponse,pkSess_5251,None,SP_5252,UP_5253))
                                                )
                                                else
                                                    {6187}let pkSess_5254: bitstring = pub(sk(Sess_4234)) in
                                                    {6188}in(c, =GetEndpointRequest);
                                                    {6189}new SP_5255: bitstring;
                                                    {6190}new UP_5256: bitstring;
                                                    {6191}out(c, (GetEndpointResponse,pkSess_5254,None,SP_5255,UP_5256))
                                            )
                                            else
                                                {6192}let pkSess_5257: bitstring = fail-any in
                                                {6193}in(c, =GetEndpointRequest);
                                                {6194}new SP_5258: bitstring;
                                                {6195}new UP_5259: bitstring;
                                                {6196}out(c, (GetEndpointResponse,pkSess_5257,None,SP_5258,UP_5259))
                                    )
                                    else
                                        {6197}let pkSess_5260: bitstring = fail-any in
                                        {6198}in(c, =GetEndpointRequest);
                                        {6199}new SP_5261: bitstring;
                                        {6200}new UP_5262: bitstring;
                                        {6201}out(c, (GetEndpointResponse,pkSess_5260,None,SP_5261,UP_5262))
                            )
                            else
                                {6202}let pkSess_5263: bitstring = fail-any in
                                {6203}in(c, =GetEndpointRequest);
                                {6204}new SP_5264: bitstring;
                                {6205}new UP_5265: bitstring;
                                {6206}out(c, (GetEndpointResponse,pkSess_5263,None,SP_5264,UP_5265))
                )
                else
                    {6207}let pkCli_5266: bitstring = fail-any in
                    {6208}let v_5267: bool = (Sess_4234 = A) in
                    (
                        {6209}if v_5267 then
                        (
                            {6210}let pkSess_5268: bitstring = pub(skA) in
                            {6211}in(c, =GetEndpointRequest);
                            {6212}new SP_5269: bitstring;
                            {6213}new UP_5270: bitstring;
                            {6214}out(c, (GetEndpointResponse,pkSess_5268,None,SP_5269,UP_5270))
                        )
                        else
                            {6215}let v_5271: bool = (Sess_4234 = B) in
                            (
                                {6216}if v_5271 then
                                (
                                    {6217}let pkSess_5272: bitstring = pub(skB) in
                                    {6218}in(c, =GetEndpointRequest);
                                    {6219}new SP_5273: bitstring;
                                    {6220}new UP_5274: bitstring;
                                    {6221}out(c, (GetEndpointResponse,pkSess_5272,None,SP_5273,UP_5274))
                                )
                                else
                                    {6222}let v_5275: bool = (Sess_4234 = C) in
                                    (
                                        {6223}if v_5275 then
                                        (
                                            {6224}let pkSess_5276: bitstring = pub(skC) in
                                            {6225}in(c, =GetEndpointRequest);
                                            {6226}new SP_5277: bitstring;
                                            {6227}new UP_5278: bitstring;
                                            {6228}out(c, (GetEndpointResponse,pkSess_5276,None,SP_5277,UP_5278))
                                        )
                                        else
                                            {6229}let pkSess_5279: bitstring = pub(sk(Sess_4234)) in
                                            {6230}in(c, =GetEndpointRequest);
                                            {6231}new SP_5280: bitstring;
                                            {6232}new UP_5281: bitstring;
                                            {6233}out(c, (GetEndpointResponse,pkSess_5279,None,SP_5280,UP_5281))
                                    )
                                    else
                                        {6234}let pkSess_5282: bitstring = fail-any in
                                        {6235}in(c, =GetEndpointRequest);
                                        {6236}new SP_5283: bitstring;
                                        {6237}new UP_5284: bitstring;
                                        {6238}out(c, (GetEndpointResponse,pkSess_5282,None,SP_5283,UP_5284))
                            )
                            else
                                {6239}let pkSess_5285: bitstring = fail-any in
                                {6240}in(c, =GetEndpointRequest);
                                {6241}new SP_5286: bitstring;
                                {6242}new UP_5287: bitstring;
                                {6243}out(c, (GetEndpointResponse,pkSess_5285,None,SP_5286,UP_5287))
                    )
                    else
                        {6244}let pkSess_5288: bitstring = fail-any in
                        {6245}in(c, =GetEndpointRequest);
                        {6246}new SP_5289: bitstring;
                        {6247}new UP_5290: bitstring;
                        {6248}out(c, (GetEndpointResponse,pkSess_5288,None,SP_5289,UP_5290))
        )
        else
            {6249}let pkCli_5291: bitstring = fail-any in
            {6250}let v_5292: bool = (Sess_4234 = A) in
            (
                {6251}if v_5292 then
                (
                    {6252}let pkSess_5293: bitstring = pub(skA) in
                    {6253}in(c, =GetEndpointRequest);
                    {6254}new SP_5294: bitstring;
                    {6255}new UP_5295: bitstring;
                    {6256}out(c, (GetEndpointResponse,pkSess_5293,None,SP_5294,UP_5295))
                )
                else
                    {6257}let v_5296: bool = (Sess_4234 = B) in
                    (
                        {6258}if v_5296 then
                        (
                            {6259}let pkSess_5297: bitstring = pub(skB) in
                            {6260}in(c, =GetEndpointRequest);
                            {6261}new SP_5298: bitstring;
                            {6262}new UP_5299: bitstring;
                            {6263}out(c, (GetEndpointResponse,pkSess_5297,None,SP_5298,UP_5299))
                        )
                        else
                            {6264}let v_5300: bool = (Sess_4234 = C) in
                            (
                                {6265}if v_5300 then
                                (
                                    {6266}let pkSess_5301: bitstring = pub(skC) in
                                    {6267}in(c, =GetEndpointRequest);
                                    {6268}new SP_5302: bitstring;
                                    {6269}new UP_5303: bitstring;
                                    {6270}out(c, (GetEndpointResponse,pkSess_5301,None,SP_5302,UP_5303))
                                )
                                else
                                    {6271}let pkSess_5304: bitstring = pub(sk(Sess_4234)) in
                                    {6272}in(c, =GetEndpointRequest);
                                    {6273}new SP_5305: bitstring;
                                    {6274}new UP_5306: bitstring;
                                    {6275}out(c, (GetEndpointResponse,pkSess_5304,None,SP_5305,UP_5306))
                            )
                            else
                                {6276}let pkSess_5307: bitstring = fail-any in
                                {6277}in(c, =GetEndpointRequest);
                                {6278}new SP_5308: bitstring;
                                {6279}new UP_5309: bitstring;
                                {6280}out(c, (GetEndpointResponse,pkSess_5307,None,SP_5308,UP_5309))
                    )
                    else
                        {6281}let pkSess_5310: bitstring = fail-any in
                        {6282}in(c, =GetEndpointRequest);
                        {6283}new SP_5311: bitstring;
                        {6284}new UP_5312: bitstring;
                        {6285}out(c, (GetEndpointResponse,pkSess_5310,None,SP_5311,UP_5312))
            )
            else
                {6286}let pkSess_5313: bitstring = fail-any in
                {6287}in(c, =GetEndpointRequest);
                {6288}new SP_5314: bitstring;
                {6289}new UP_5315: bitstring;
                {6290}out(c, (GetEndpointResponse,pkSess_5313,None,SP_5314,UP_5315))
) | (
    {6291}!
    {6292}in(c, (Cli_5316: host,Disco_5317: host,Sess_5318: host));
    {6293}let v_5319: bool = (Sess_5318 = A) in
    (
        {6294}if v_5319 then
        (
            {6295}let skSess: bitstring = skA in
            {6296}let pkSess_5320: bitstring = pub(skSess) in
            {6297}let v_5321: bool = (Cli_5316 = A) in
            (
                {6298}if v_5321 then
                (
                    {6299}let pkCli_5322: bitstring = pub(skA) in
                    {6300}let v_5323: bool = (Disco_5317 = A) in
                    (
                        {6301}if v_5323 then
                        (
                            {6302}let pkDisco_5324: bitstring = pub(skA) in
                            {6303}in(c, (=pkCli_5322,em1: bitstring));
                            {6304}let m1_5325: bitstring = em1 in
                            {6305}let (=OpenSecureChannelRequest,=pkCli_5322,PartC: bitstring) = m1_5325 in
                            {6306}new Ns: bitstring;
                            {6307}new ST_5326: bitstring;
                            {6308}new TTL_5327: bitstring;
                            {6309}let gNs: bitstring = exp(g,Ns) in
                            {6310}let m2_5328: bitstring = (OpenSecureChannelResponse,gNs,ST_5326,TTL_5327) in
                            {6311}event beginSrv(Sess_5318,Cli_5316,gNs);
                            {6312}out(c, m2_5328);
                            {6313}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {6314}event endSrv(Cli_5316,Sess_5318,PartC)
                        )
                        else
                            {6315}let v_5329: bool = (Disco_5317 = B) in
                            (
                                {6316}if v_5329 then
                                (
                                    {6317}let pkDisco_5330: bitstring = pub(skB) in
                                    {6318}in(c, (=pkCli_5322,em1_5331: bitstring));
                                    {6319}let m1_5332: bitstring = em1_5331 in
                                    {6320}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5333: bitstring) = m1_5332 in
                                    {6321}new Ns_5334: bitstring;
                                    {6322}new ST_5335: bitstring;
                                    {6323}new TTL_5336: bitstring;
                                    {6324}let gNs_5337: bitstring = exp(g,Ns_5334) in
                                    {6325}let m2_5338: bitstring = (OpenSecureChannelResponse,gNs_5337,ST_5335,TTL_5336) in
                                    {6326}event beginSrv(Sess_5318,Cli_5316,gNs_5337);
                                    {6327}out(c, m2_5338);
                                    {6328}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {6329}event endSrv(Cli_5316,Sess_5318,PartC_5333)
                                )
                                else
                                    {6330}let v_5339: bool = (Disco_5317 = C) in
                                    (
                                        {6331}if v_5339 then
                                        (
                                            {6332}let pkDisco_5340: bitstring = pub(skC) in
                                            {6333}in(c, (=pkCli_5322,em1_5341: bitstring));
                                            {6334}let m1_5342: bitstring = em1_5341 in
                                            {6335}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5343: bitstring) = m1_5342 in
                                            {6336}new Ns_5344: bitstring;
                                            {6337}new ST_5345: bitstring;
                                            {6338}new TTL_5346: bitstring;
                                            {6339}let gNs_5347: bitstring = exp(g,Ns_5344) in
                                            {6340}let m2_5348: bitstring = (OpenSecureChannelResponse,gNs_5347,ST_5345,TTL_5346) in
                                            {6341}event beginSrv(Sess_5318,Cli_5316,gNs_5347);
                                            {6342}out(c, m2_5348);
                                            {6343}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {6344}event endSrv(Cli_5316,Sess_5318,PartC_5343)
                                        )
                                        else
                                            {6345}let pkDisco_5349: bitstring = pub(sk(Disco_5317)) in
                                            {6346}in(c, (=pkCli_5322,em1_5350: bitstring));
                                            {6347}let m1_5351: bitstring = em1_5350 in
                                            {6348}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5352: bitstring) = m1_5351 in
                                            {6349}new Ns_5353: bitstring;
                                            {6350}new ST_5354: bitstring;
                                            {6351}new TTL_5355: bitstring;
                                            {6352}let gNs_5356: bitstring = exp(g,Ns_5353) in
                                            {6353}let m2_5357: bitstring = (OpenSecureChannelResponse,gNs_5356,ST_5354,TTL_5355) in
                                            {6354}event beginSrv(Sess_5318,Cli_5316,gNs_5356);
                                            {6355}out(c, m2_5357);
                                            {6356}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {6357}event endSrv(Cli_5316,Sess_5318,PartC_5352)
                                    )
                                    else
                                        {6358}let pkDisco_5358: bitstring = fail-any in
                                        {6359}in(c, (=pkCli_5322,em1_5359: bitstring));
                                        {6360}let m1_5360: bitstring = em1_5359 in
                                        {6361}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5361: bitstring) = m1_5360 in
                                        {6362}new Ns_5362: bitstring;
                                        {6363}new ST_5363: bitstring;
                                        {6364}new TTL_5364: bitstring;
                                        {6365}let gNs_5365: bitstring = exp(g,Ns_5362) in
                                        {6366}let m2_5366: bitstring = (OpenSecureChannelResponse,gNs_5365,ST_5363,TTL_5364) in
                                        {6367}event beginSrv(Sess_5318,Cli_5316,gNs_5365);
                                        {6368}out(c, m2_5366);
                                        {6369}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6370}event endSrv(Cli_5316,Sess_5318,PartC_5361)
                            )
                            else
                                {6371}let pkDisco_5367: bitstring = fail-any in
                                {6372}in(c, (=pkCli_5322,em1_5368: bitstring));
                                {6373}let m1_5369: bitstring = em1_5368 in
                                {6374}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5370: bitstring) = m1_5369 in
                                {6375}new Ns_5371: bitstring;
                                {6376}new ST_5372: bitstring;
                                {6377}new TTL_5373: bitstring;
                                {6378}let gNs_5374: bitstring = exp(g,Ns_5371) in
                                {6379}let m2_5375: bitstring = (OpenSecureChannelResponse,gNs_5374,ST_5372,TTL_5373) in
                                {6380}event beginSrv(Sess_5318,Cli_5316,gNs_5374);
                                {6381}out(c, m2_5375);
                                {6382}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {6383}event endSrv(Cli_5316,Sess_5318,PartC_5370)
                    )
                    else
                        {6384}let pkDisco_5376: bitstring = fail-any in
                        {6385}in(c, (=pkCli_5322,em1_5377: bitstring));
                        {6386}let m1_5378: bitstring = em1_5377 in
                        {6387}let (=OpenSecureChannelRequest,=pkCli_5322,PartC_5379: bitstring) = m1_5378 in
                        {6388}new Ns_5380: bitstring;
                        {6389}new ST_5381: bitstring;
                        {6390}new TTL_5382: bitstring;
                        {6391}let gNs_5383: bitstring = exp(g,Ns_5380) in
                        {6392}let m2_5384: bitstring = (OpenSecureChannelResponse,gNs_5383,ST_5381,TTL_5382) in
                        {6393}event beginSrv(Sess_5318,Cli_5316,gNs_5383);
                        {6394}out(c, m2_5384);
                        {6395}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                        {6396}event endSrv(Cli_5316,Sess_5318,PartC_5379)
                )
                else
                    {6397}let v_5385: bool = (Cli_5316 = B) in
                    (
                        {6398}if v_5385 then
                        (
                            {6399}let pkCli_5386: bitstring = pub(skB) in
                            {6400}let v_5387: bool = (Disco_5317 = A) in
                            (
                                {6401}if v_5387 then
                                (
                                    {6402}let pkDisco_5388: bitstring = pub(skA) in
                                    {6403}in(c, (=pkCli_5386,em1_5389: bitstring));
                                    {6404}let m1_5390: bitstring = em1_5389 in
                                    {6405}let (=OpenSecureChannelRequest,=pkCli_5386,PartC_5391: bitstring) = m1_5390 in
                                    {6406}new Ns_5392: bitstring;
                                    {6407}new ST_5393: bitstring;
                                    {6408}new TTL_5394: bitstring;
                                    {6409}let gNs_5395: bitstring = exp(g,Ns_5392) in
                                    {6410}let m2_5396: bitstring = (OpenSecureChannelResponse,gNs_5395,ST_5393,TTL_5394) in
                                    {6411}event beginSrv(Sess_5318,Cli_5316,gNs_5395);
                                    {6412}out(c, m2_5396);
                                    {6413}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {6414}event endSrv(Cli_5316,Sess_5318,PartC_5391)
                                )
                                else
                                    {6415}let v_5397: bool = (Disco_5317 = B) in
                                    (
                                        {6416}if v_5397 then
                                        (
                                            {6417}let pkDisco_5398: bitstring = pub(skB) in
                                            {6418}in(c, (=pkCli_5386,em1_5399: bitstring));
                                            {6419}let m1_5400: bitstring = em1_5399 in
                                            {6420}let (=OpenSecureChannelRequest,=pkCli_5386,PartC_5401: bitstring) = m1_5400 in
                                            {6421}new Ns_5402: bitstring;
                                            {6422}new ST_5403: bitstring;
                                            {6423}new TTL_5404: bitstring;
                                            {6424}let gNs_5405: bitstring = exp(g,Ns_5402) in
                                            {6425}let m2_5406: bitstring = (OpenSecureChannelResponse,gNs_5405,ST_5403,TTL_5404) in
                                            {6426}event beginSrv(Sess_5318,Cli_5316,gNs_5405);
                                            {6427}out(c, m2_5406);
                                            {6428}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {6429}event endSrv(Cli_5316,Sess_5318,PartC_5401)
                                        )
                                        else
                                            {6430}let v_5407: bool = (Disco_5317 = C) in
                                            (
                                                {6431}if v_5407 then
                                                (
                                                    {6432}let pkDisco_5408: bitstring = pub(skC) in
                                                    {6433}in(c, (=pkCli_5386,em1_5409: bitstring));
                                                    {6434}let m1_5410: bitstring = em1_5409 in
                                                    {6435}let (=OpenSecureChannelRequest,=pkCli_5386,PartC_5411: bitstring) = m1_5410 in
                                                    {6436}new Ns_5412: bitstring;
                                                    {6437}new ST_5413: bitstring;
                                                    {6438}new TTL_5414: bitstring;
                                                    {6439}let gNs_5415: bitstring = exp(g,Ns_5412) in
                                                    {6440}let m2_5416: bitstring = (OpenSecureChannelResponse,gNs_5415,ST_5413,TTL_5414) in
                                                    {6441}event beginSrv(Sess_5318,Cli_5316,gNs_5415);
                                                    {6442}out(c, m2_5416);
                                                    {6443}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {6444}event endSrv(Cli_5316,Sess_5318,PartC_5411)
                                                )
                                                else
                                                    {6445}let pkDisco_5417: bitstring = pub(sk(Disco_5317)) in
                                                    {6446}in(c, (=pkCli_5386,em1_5418: bitstring));
                                                    {6447}let m1_5419: bitstring = em1_5418 in
                                                    {6448}let (=OpenSecureChannelRequest,=pkCli_5386,PartC_5420: bitstring) = m1_5419 in
                                                    {6449}new Ns_5421: bitstring;
                                                    {6450}new ST_5422: bitstring;
                                                    {6451}new TTL_5423: bitstring;
                                                    {6452}let gNs_5424: bitstring = exp(g,Ns_5421) in
                                                    {6453}let m2_5425: bitstring = (OpenSecureChannelResponse,gNs_5424,ST_5422,TTL_5423) in
                                                    {6454}event beginSrv(Sess_5318,Cli_5316,gNs_5424);
                                                    {6455}out(c, m2_5425);
                                                    {6456}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {6457}event endSrv(Cli_5316,Sess_5318,PartC_5420)
                                            )
                                            else
                                                {6458}let pkDisco_5426: bitstring = fail-any in
                                                {6459}in(c, (=pkCli_5386,em1_5427: bitstring));
                                                {6460}let m1_5428: bitstring = em1_5427 in
                                                {6461}let (=OpenSecureChannelRequest,=pkCli_5386,PartC_5429: bitstring) = m1_5428 in
                                                {6462}new Ns_5430: bitstring;
                                                {6463}new ST_5431: bitstring;
                                                {6464}new TTL_5432: bitstring;
                                                {6465}let gNs_5433: bitstring = exp(g,Ns_5430) in
                                                {6466}let m2_5434: bitstring = (OpenSecureChannelResponse,gNs_5433,ST_5431,TTL_5432) in
                                                {6467}event beginSrv(Sess_5318,Cli_5316,gNs_5433);
                                                {6468}out(c, m2_5434);
                                                {6469}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {6470}event endSrv(Cli_5316,Sess_5318,PartC_5429)
                                    )
                                    else
                                        {6471}let pkDisco_5435: bitstring = fail-any in
                                        {6472}in(c, (=pkCli_5386,em1_5436: bitstring));
                                        {6473}let m1_5437: bitstring = em1_5436 in
                                        {6474}let (=OpenSecureChannelRequest,=pkCli_5386,PartC_5438: bitstring) = m1_5437 in
                                        {6475}new Ns_5439: bitstring;
                                        {6476}new ST_5440: bitstring;
                                        {6477}new TTL_5441: bitstring;
                                        {6478}let gNs_5442: bitstring = exp(g,Ns_5439) in
                                        {6479}let m2_5443: bitstring = (OpenSecureChannelResponse,gNs_5442,ST_5440,TTL_5441) in
                                        {6480}event beginSrv(Sess_5318,Cli_5316,gNs_5442);
                                        {6481}out(c, m2_5443);
                                        {6482}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6483}event endSrv(Cli_5316,Sess_5318,PartC_5438)
                            )
                            else
                                {6484}let pkDisco_5444: bitstring = fail-any in
                                {6485}in(c, (=pkCli_5386,em1_5445: bitstring));
                                {6486}let m1_5446: bitstring = em1_5445 in
                                {6487}let (=OpenSecureChannelRequest,=pkCli_5386,PartC_5447: bitstring) = m1_5446 in
                                {6488}new Ns_5448: bitstring;
                                {6489}new ST_5449: bitstring;
                                {6490}new TTL_5450: bitstring;
                                {6491}let gNs_5451: bitstring = exp(g,Ns_5448) in
                                {6492}let m2_5452: bitstring = (OpenSecureChannelResponse,gNs_5451,ST_5449,TTL_5450) in
                                {6493}event beginSrv(Sess_5318,Cli_5316,gNs_5451);
                                {6494}out(c, m2_5452);
                                {6495}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {6496}event endSrv(Cli_5316,Sess_5318,PartC_5447)
                        )
                        else
                            {6497}let v_5453: bool = (Cli_5316 = C) in
                            (
                                {6498}if v_5453 then
                                (
                                    {6499}let pkCli_5454: bitstring = pub(skC) in
                                    {6500}let v_5455: bool = (Disco_5317 = A) in
                                    (
                                        {6501}if v_5455 then
                                        (
                                            {6502}let pkDisco_5456: bitstring = pub(skA) in
                                            {6503}in(c, (=pkCli_5454,em1_5457: bitstring));
                                            {6504}let m1_5458: bitstring = em1_5457 in
                                            {6505}let (=OpenSecureChannelRequest,=pkCli_5454,PartC_5459: bitstring) = m1_5458 in
                                            {6506}new Ns_5460: bitstring;
                                            {6507}new ST_5461: bitstring;
                                            {6508}new TTL_5462: bitstring;
                                            {6509}let gNs_5463: bitstring = exp(g,Ns_5460) in
                                            {6510}let m2_5464: bitstring = (OpenSecureChannelResponse,gNs_5463,ST_5461,TTL_5462) in
                                            {6511}event beginSrv(Sess_5318,Cli_5316,gNs_5463);
                                            {6512}out(c, m2_5464);
                                            {6513}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {6514}event endSrv(Cli_5316,Sess_5318,PartC_5459)
                                        )
                                        else
                                            {6515}let v_5465: bool = (Disco_5317 = B) in
                                            (
                                                {6516}if v_5465 then
                                                (
                                                    {6517}let pkDisco_5466: bitstring = pub(skB) in
                                                    {6518}in(c, (=pkCli_5454,em1_5467: bitstring));
                                                    {6519}let m1_5468: bitstring = em1_5467 in
                                                    {6520}let (=OpenSecureChannelRequest,=pkCli_5454,PartC_5469: bitstring) = m1_5468 in
                                                    {6521}new Ns_5470: bitstring;
                                                    {6522}new ST_5471: bitstring;
                                                    {6523}new TTL_5472: bitstring;
                                                    {6524}let gNs_5473: bitstring = exp(g,Ns_5470) in
                                                    {6525}let m2_5474: bitstring = (OpenSecureChannelResponse,gNs_5473,ST_5471,TTL_5472) in
                                                    {6526}event beginSrv(Sess_5318,Cli_5316,gNs_5473);
                                                    {6527}out(c, m2_5474);
                                                    {6528}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {6529}event endSrv(Cli_5316,Sess_5318,PartC_5469)
                                                )
                                                else
                                                    {6530}let v_5475: bool = (Disco_5317 = C) in
                                                    (
                                                        {6531}if v_5475 then
                                                        (
                                                            {6532}let pkDisco_5476: bitstring = pub(skC) in
                                                            {6533}in(c, (=pkCli_5454,em1_5477: bitstring));
                                                            {6534}let m1_5478: bitstring = em1_5477 in
                                                            {6535}let (=OpenSecureChannelRequest,=pkCli_5454,PartC_5479: bitstring) = m1_5478 in
                                                            {6536}new Ns_5480: bitstring;
                                                            {6537}new ST_5481: bitstring;
                                                            {6538}new TTL_5482: bitstring;
                                                            {6539}let gNs_5483: bitstring = exp(g,Ns_5480) in
                                                            {6540}let m2_5484: bitstring = (OpenSecureChannelResponse,gNs_5483,ST_5481,TTL_5482) in
                                                            {6541}event beginSrv(Sess_5318,Cli_5316,gNs_5483);
                                                            {6542}out(c, m2_5484);
                                                            {6543}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {6544}event endSrv(Cli_5316,Sess_5318,PartC_5479)
                                                        )
                                                        else
                                                            {6545}let pkDisco_5485: bitstring = pub(sk(Disco_5317)) in
                                                            {6546}in(c, (=pkCli_5454,em1_5486: bitstring));
                                                            {6547}let m1_5487: bitstring = em1_5486 in
                                                            {6548}let (=OpenSecureChannelRequest,=pkCli_5454,PartC_5488: bitstring) = m1_5487 in
                                                            {6549}new Ns_5489: bitstring;
                                                            {6550}new ST_5490: bitstring;
                                                            {6551}new TTL_5491: bitstring;
                                                            {6552}let gNs_5492: bitstring = exp(g,Ns_5489) in
                                                            {6553}let m2_5493: bitstring = (OpenSecureChannelResponse,gNs_5492,ST_5490,TTL_5491) in
                                                            {6554}event beginSrv(Sess_5318,Cli_5316,gNs_5492);
                                                            {6555}out(c, m2_5493);
                                                            {6556}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {6557}event endSrv(Cli_5316,Sess_5318,PartC_5488)
                                                    )
                                                    else
                                                        {6558}let pkDisco_5494: bitstring = fail-any in
                                                        {6559}in(c, (=pkCli_5454,em1_5495: bitstring));
                                                        {6560}let m1_5496: bitstring = em1_5495 in
                                                        {6561}let (=OpenSecureChannelRequest,=pkCli_5454,PartC_5497: bitstring) = m1_5496 in
                                                        {6562}new Ns_5498: bitstring;
                                                        {6563}new ST_5499: bitstring;
                                                        {6564}new TTL_5500: bitstring;
                                                        {6565}let gNs_5501: bitstring = exp(g,Ns_5498) in
                                                        {6566}let m2_5502: bitstring = (OpenSecureChannelResponse,gNs_5501,ST_5499,TTL_5500) in
                                                        {6567}event beginSrv(Sess_5318,Cli_5316,gNs_5501);
                                                        {6568}out(c, m2_5502);
                                                        {6569}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {6570}event endSrv(Cli_5316,Sess_5318,PartC_5497)
                                            )
                                            else
                                                {6571}let pkDisco_5503: bitstring = fail-any in
                                                {6572}in(c, (=pkCli_5454,em1_5504: bitstring));
                                                {6573}let m1_5505: bitstring = em1_5504 in
                                                {6574}let (=OpenSecureChannelRequest,=pkCli_5454,PartC_5506: bitstring) = m1_5505 in
                                                {6575}new Ns_5507: bitstring;
                                                {6576}new ST_5508: bitstring;
                                                {6577}new TTL_5509: bitstring;
                                                {6578}let gNs_5510: bitstring = exp(g,Ns_5507) in
                                                {6579}let m2_5511: bitstring = (OpenSecureChannelResponse,gNs_5510,ST_5508,TTL_5509) in
                                                {6580}event beginSrv(Sess_5318,Cli_5316,gNs_5510);
                                                {6581}out(c, m2_5511);
                                                {6582}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {6583}event endSrv(Cli_5316,Sess_5318,PartC_5506)
                                    )
                                    else
                                        {6584}let pkDisco_5512: bitstring = fail-any in
                                        {6585}in(c, (=pkCli_5454,em1_5513: bitstring));
                                        {6586}let m1_5514: bitstring = em1_5513 in
                                        {6587}let (=OpenSecureChannelRequest,=pkCli_5454,PartC_5515: bitstring) = m1_5514 in
                                        {6588}new Ns_5516: bitstring;
                                        {6589}new ST_5517: bitstring;
                                        {6590}new TTL_5518: bitstring;
                                        {6591}let gNs_5519: bitstring = exp(g,Ns_5516) in
                                        {6592}let m2_5520: bitstring = (OpenSecureChannelResponse,gNs_5519,ST_5517,TTL_5518) in
                                        {6593}event beginSrv(Sess_5318,Cli_5316,gNs_5519);
                                        {6594}out(c, m2_5520);
                                        {6595}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6596}event endSrv(Cli_5316,Sess_5318,PartC_5515)
                                )
                                else
                                    {6597}let pkCli_5521: bitstring = pub(sk(Cli_5316)) in
                                    {6598}let v_5522: bool = (Disco_5317 = A) in
                                    (
                                        {6599}if v_5522 then
                                        (
                                            {6600}let pkDisco_5523: bitstring = pub(skA) in
                                            {6601}in(c, (=pkCli_5521,em1_5524: bitstring));
                                            {6602}let m1_5525: bitstring = em1_5524 in
                                            {6603}let (=OpenSecureChannelRequest,=pkCli_5521,PartC_5526: bitstring) = m1_5525 in
                                            {6604}new Ns_5527: bitstring;
                                            {6605}new ST_5528: bitstring;
                                            {6606}new TTL_5529: bitstring;
                                            {6607}let gNs_5530: bitstring = exp(g,Ns_5527) in
                                            {6608}let m2_5531: bitstring = (OpenSecureChannelResponse,gNs_5530,ST_5528,TTL_5529) in
                                            {6609}event beginSrv(Sess_5318,Cli_5316,gNs_5530);
                                            {6610}out(c, m2_5531);
                                            {6611}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {6612}event endSrv(Cli_5316,Sess_5318,PartC_5526)
                                        )
                                        else
                                            {6613}let v_5532: bool = (Disco_5317 = B) in
                                            (
                                                {6614}if v_5532 then
                                                (
                                                    {6615}let pkDisco_5533: bitstring = pub(skB) in
                                                    {6616}in(c, (=pkCli_5521,em1_5534: bitstring));
                                                    {6617}let m1_5535: bitstring = em1_5534 in
                                                    {6618}let (=OpenSecureChannelRequest,=pkCli_5521,PartC_5536: bitstring) = m1_5535 in
                                                    {6619}new Ns_5537: bitstring;
                                                    {6620}new ST_5538: bitstring;
                                                    {6621}new TTL_5539: bitstring;
                                                    {6622}let gNs_5540: bitstring = exp(g,Ns_5537) in
                                                    {6623}let m2_5541: bitstring = (OpenSecureChannelResponse,gNs_5540,ST_5538,TTL_5539) in
                                                    {6624}event beginSrv(Sess_5318,Cli_5316,gNs_5540);
                                                    {6625}out(c, m2_5541);
                                                    {6626}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {6627}event endSrv(Cli_5316,Sess_5318,PartC_5536)
                                                )
                                                else
                                                    {6628}let v_5542: bool = (Disco_5317 = C) in
                                                    (
                                                        {6629}if v_5542 then
                                                        (
                                                            {6630}let pkDisco_5543: bitstring = pub(skC) in
                                                            {6631}in(c, (=pkCli_5521,em1_5544: bitstring));
                                                            {6632}let m1_5545: bitstring = em1_5544 in
                                                            {6633}let (=OpenSecureChannelRequest,=pkCli_5521,PartC_5546: bitstring) = m1_5545 in
                                                            {6634}new Ns_5547: bitstring;
                                                            {6635}new ST_5548: bitstring;
                                                            {6636}new TTL_5549: bitstring;
                                                            {6637}let gNs_5550: bitstring = exp(g,Ns_5547) in
                                                            {6638}let m2_5551: bitstring = (OpenSecureChannelResponse,gNs_5550,ST_5548,TTL_5549) in
                                                            {6639}event beginSrv(Sess_5318,Cli_5316,gNs_5550);
                                                            {6640}out(c, m2_5551);
                                                            {6641}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {6642}event endSrv(Cli_5316,Sess_5318,PartC_5546)
                                                        )
                                                        else
                                                            {6643}let pkDisco_5552: bitstring = pub(sk(Disco_5317)) in
                                                            {6644}in(c, (=pkCli_5521,em1_5553: bitstring));
                                                            {6645}let m1_5554: bitstring = em1_5553 in
                                                            {6646}let (=OpenSecureChannelRequest,=pkCli_5521,PartC_5555: bitstring) = m1_5554 in
                                                            {6647}new Ns_5556: bitstring;
                                                            {6648}new ST_5557: bitstring;
                                                            {6649}new TTL_5558: bitstring;
                                                            {6650}let gNs_5559: bitstring = exp(g,Ns_5556) in
                                                            {6651}let m2_5560: bitstring = (OpenSecureChannelResponse,gNs_5559,ST_5557,TTL_5558) in
                                                            {6652}event beginSrv(Sess_5318,Cli_5316,gNs_5559);
                                                            {6653}out(c, m2_5560);
                                                            {6654}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {6655}event endSrv(Cli_5316,Sess_5318,PartC_5555)
                                                    )
                                                    else
                                                        {6656}let pkDisco_5561: bitstring = fail-any in
                                                        {6657}in(c, (=pkCli_5521,em1_5562: bitstring));
                                                        {6658}let m1_5563: bitstring = em1_5562 in
                                                        {6659}let (=OpenSecureChannelRequest,=pkCli_5521,PartC_5564: bitstring) = m1_5563 in
                                                        {6660}new Ns_5565: bitstring;
                                                        {6661}new ST_5566: bitstring;
                                                        {6662}new TTL_5567: bitstring;
                                                        {6663}let gNs_5568: bitstring = exp(g,Ns_5565) in
                                                        {6664}let m2_5569: bitstring = (OpenSecureChannelResponse,gNs_5568,ST_5566,TTL_5567) in
                                                        {6665}event beginSrv(Sess_5318,Cli_5316,gNs_5568);
                                                        {6666}out(c, m2_5569);
                                                        {6667}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {6668}event endSrv(Cli_5316,Sess_5318,PartC_5564)
                                            )
                                            else
                                                {6669}let pkDisco_5570: bitstring = fail-any in
                                                {6670}in(c, (=pkCli_5521,em1_5571: bitstring));
                                                {6671}let m1_5572: bitstring = em1_5571 in
                                                {6672}let (=OpenSecureChannelRequest,=pkCli_5521,PartC_5573: bitstring) = m1_5572 in
                                                {6673}new Ns_5574: bitstring;
                                                {6674}new ST_5575: bitstring;
                                                {6675}new TTL_5576: bitstring;
                                                {6676}let gNs_5577: bitstring = exp(g,Ns_5574) in
                                                {6677}let m2_5578: bitstring = (OpenSecureChannelResponse,gNs_5577,ST_5575,TTL_5576) in
                                                {6678}event beginSrv(Sess_5318,Cli_5316,gNs_5577);
                                                {6679}out(c, m2_5578);
                                                {6680}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {6681}event endSrv(Cli_5316,Sess_5318,PartC_5573)
                                    )
                                    else
                                        {6682}let pkDisco_5579: bitstring = fail-any in
                                        {6683}in(c, (=pkCli_5521,em1_5580: bitstring));
                                        {6684}let m1_5581: bitstring = em1_5580 in
                                        {6685}let (=OpenSecureChannelRequest,=pkCli_5521,PartC_5582: bitstring) = m1_5581 in
                                        {6686}new Ns_5583: bitstring;
                                        {6687}new ST_5584: bitstring;
                                        {6688}new TTL_5585: bitstring;
                                        {6689}let gNs_5586: bitstring = exp(g,Ns_5583) in
                                        {6690}let m2_5587: bitstring = (OpenSecureChannelResponse,gNs_5586,ST_5584,TTL_5585) in
                                        {6691}event beginSrv(Sess_5318,Cli_5316,gNs_5586);
                                        {6692}out(c, m2_5587);
                                        {6693}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6694}event endSrv(Cli_5316,Sess_5318,PartC_5582)
                            )
                            else
                                {6695}let pkCli_5588: bitstring = fail-any in
                                {6696}let v_5589: bool = (Disco_5317 = A) in
                                (
                                    {6697}if v_5589 then
                                    (
                                        {6698}let pkDisco_5590: bitstring = pub(skA) in
                                        {6699}in(c, (=pkCli_5588,em1_5591: bitstring));
                                        {6700}let m1_5592: bitstring = em1_5591 in
                                        {6701}let (=OpenSecureChannelRequest,=pkCli_5588,PartC_5593: bitstring) = m1_5592 in
                                        {6702}new Ns_5594: bitstring;
                                        {6703}new ST_5595: bitstring;
                                        {6704}new TTL_5596: bitstring;
                                        {6705}let gNs_5597: bitstring = exp(g,Ns_5594) in
                                        {6706}let m2_5598: bitstring = (OpenSecureChannelResponse,gNs_5597,ST_5595,TTL_5596) in
                                        {6707}event beginSrv(Sess_5318,Cli_5316,gNs_5597);
                                        {6708}out(c, m2_5598);
                                        {6709}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6710}event endSrv(Cli_5316,Sess_5318,PartC_5593)
                                    )
                                    else
                                        {6711}let v_5599: bool = (Disco_5317 = B) in
                                        (
                                            {6712}if v_5599 then
                                            (
                                                {6713}let pkDisco_5600: bitstring = pub(skB) in
                                                {6714}in(c, (=pkCli_5588,em1_5601: bitstring));
                                                {6715}let m1_5602: bitstring = em1_5601 in
                                                {6716}let (=OpenSecureChannelRequest,=pkCli_5588,PartC_5603: bitstring) = m1_5602 in
                                                {6717}new Ns_5604: bitstring;
                                                {6718}new ST_5605: bitstring;
                                                {6719}new TTL_5606: bitstring;
                                                {6720}let gNs_5607: bitstring = exp(g,Ns_5604) in
                                                {6721}let m2_5608: bitstring = (OpenSecureChannelResponse,gNs_5607,ST_5605,TTL_5606) in
                                                {6722}event beginSrv(Sess_5318,Cli_5316,gNs_5607);
                                                {6723}out(c, m2_5608);
                                                {6724}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {6725}event endSrv(Cli_5316,Sess_5318,PartC_5603)
                                            )
                                            else
                                                {6726}let v_5609: bool = (Disco_5317 = C) in
                                                (
                                                    {6727}if v_5609 then
                                                    (
                                                        {6728}let pkDisco_5610: bitstring = pub(skC) in
                                                        {6729}in(c, (=pkCli_5588,em1_5611: bitstring));
                                                        {6730}let m1_5612: bitstring = em1_5611 in
                                                        {6731}let (=OpenSecureChannelRequest,=pkCli_5588,PartC_5613: bitstring) = m1_5612 in
                                                        {6732}new Ns_5614: bitstring;
                                                        {6733}new ST_5615: bitstring;
                                                        {6734}new TTL_5616: bitstring;
                                                        {6735}let gNs_5617: bitstring = exp(g,Ns_5614) in
                                                        {6736}let m2_5618: bitstring = (OpenSecureChannelResponse,gNs_5617,ST_5615,TTL_5616) in
                                                        {6737}event beginSrv(Sess_5318,Cli_5316,gNs_5617);
                                                        {6738}out(c, m2_5618);
                                                        {6739}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {6740}event endSrv(Cli_5316,Sess_5318,PartC_5613)
                                                    )
                                                    else
                                                        {6741}let pkDisco_5619: bitstring = pub(sk(Disco_5317)) in
                                                        {6742}in(c, (=pkCli_5588,em1_5620: bitstring));
                                                        {6743}let m1_5621: bitstring = em1_5620 in
                                                        {6744}let (=OpenSecureChannelRequest,=pkCli_5588,PartC_5622: bitstring) = m1_5621 in
                                                        {6745}new Ns_5623: bitstring;
                                                        {6746}new ST_5624: bitstring;
                                                        {6747}new TTL_5625: bitstring;
                                                        {6748}let gNs_5626: bitstring = exp(g,Ns_5623) in
                                                        {6749}let m2_5627: bitstring = (OpenSecureChannelResponse,gNs_5626,ST_5624,TTL_5625) in
                                                        {6750}event beginSrv(Sess_5318,Cli_5316,gNs_5626);
                                                        {6751}out(c, m2_5627);
                                                        {6752}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {6753}event endSrv(Cli_5316,Sess_5318,PartC_5622)
                                                )
                                                else
                                                    {6754}let pkDisco_5628: bitstring = fail-any in
                                                    {6755}in(c, (=pkCli_5588,em1_5629: bitstring));
                                                    {6756}let m1_5630: bitstring = em1_5629 in
                                                    {6757}let (=OpenSecureChannelRequest,=pkCli_5588,PartC_5631: bitstring) = m1_5630 in
                                                    {6758}new Ns_5632: bitstring;
                                                    {6759}new ST_5633: bitstring;
                                                    {6760}new TTL_5634: bitstring;
                                                    {6761}let gNs_5635: bitstring = exp(g,Ns_5632) in
                                                    {6762}let m2_5636: bitstring = (OpenSecureChannelResponse,gNs_5635,ST_5633,TTL_5634) in
                                                    {6763}event beginSrv(Sess_5318,Cli_5316,gNs_5635);
                                                    {6764}out(c, m2_5636);
                                                    {6765}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {6766}event endSrv(Cli_5316,Sess_5318,PartC_5631)
                                        )
                                        else
                                            {6767}let pkDisco_5637: bitstring = fail-any in
                                            {6768}in(c, (=pkCli_5588,em1_5638: bitstring));
                                            {6769}let m1_5639: bitstring = em1_5638 in
                                            {6770}let (=OpenSecureChannelRequest,=pkCli_5588,PartC_5640: bitstring) = m1_5639 in
                                            {6771}new Ns_5641: bitstring;
                                            {6772}new ST_5642: bitstring;
                                            {6773}new TTL_5643: bitstring;
                                            {6774}let gNs_5644: bitstring = exp(g,Ns_5641) in
                                            {6775}let m2_5645: bitstring = (OpenSecureChannelResponse,gNs_5644,ST_5642,TTL_5643) in
                                            {6776}event beginSrv(Sess_5318,Cli_5316,gNs_5644);
                                            {6777}out(c, m2_5645);
                                            {6778}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {6779}event endSrv(Cli_5316,Sess_5318,PartC_5640)
                                )
                                else
                                    {6780}let pkDisco_5646: bitstring = fail-any in
                                    {6781}in(c, (=pkCli_5588,em1_5647: bitstring));
                                    {6782}let m1_5648: bitstring = em1_5647 in
                                    {6783}let (=OpenSecureChannelRequest,=pkCli_5588,PartC_5649: bitstring) = m1_5648 in
                                    {6784}new Ns_5650: bitstring;
                                    {6785}new ST_5651: bitstring;
                                    {6786}new TTL_5652: bitstring;
                                    {6787}let gNs_5653: bitstring = exp(g,Ns_5650) in
                                    {6788}let m2_5654: bitstring = (OpenSecureChannelResponse,gNs_5653,ST_5651,TTL_5652) in
                                    {6789}event beginSrv(Sess_5318,Cli_5316,gNs_5653);
                                    {6790}out(c, m2_5654);
                                    {6791}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {6792}event endSrv(Cli_5316,Sess_5318,PartC_5649)
                    )
                    else
                        {6793}let pkCli_5655: bitstring = fail-any in
                        {6794}let v_5656: bool = (Disco_5317 = A) in
                        (
                            {6795}if v_5656 then
                            (
                                {6796}let pkDisco_5657: bitstring = pub(skA) in
                                {6797}in(c, (=pkCli_5655,em1_5658: bitstring));
                                {6798}let m1_5659: bitstring = em1_5658 in
                                {6799}let (=OpenSecureChannelRequest,=pkCli_5655,PartC_5660: bitstring) = m1_5659 in
                                {6800}new Ns_5661: bitstring;
                                {6801}new ST_5662: bitstring;
                                {6802}new TTL_5663: bitstring;
                                {6803}let gNs_5664: bitstring = exp(g,Ns_5661) in
                                {6804}let m2_5665: bitstring = (OpenSecureChannelResponse,gNs_5664,ST_5662,TTL_5663) in
                                {6805}event beginSrv(Sess_5318,Cli_5316,gNs_5664);
                                {6806}out(c, m2_5665);
                                {6807}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {6808}event endSrv(Cli_5316,Sess_5318,PartC_5660)
                            )
                            else
                                {6809}let v_5666: bool = (Disco_5317 = B) in
                                (
                                    {6810}if v_5666 then
                                    (
                                        {6811}let pkDisco_5667: bitstring = pub(skB) in
                                        {6812}in(c, (=pkCli_5655,em1_5668: bitstring));
                                        {6813}let m1_5669: bitstring = em1_5668 in
                                        {6814}let (=OpenSecureChannelRequest,=pkCli_5655,PartC_5670: bitstring) = m1_5669 in
                                        {6815}new Ns_5671: bitstring;
                                        {6816}new ST_5672: bitstring;
                                        {6817}new TTL_5673: bitstring;
                                        {6818}let gNs_5674: bitstring = exp(g,Ns_5671) in
                                        {6819}let m2_5675: bitstring = (OpenSecureChannelResponse,gNs_5674,ST_5672,TTL_5673) in
                                        {6820}event beginSrv(Sess_5318,Cli_5316,gNs_5674);
                                        {6821}out(c, m2_5675);
                                        {6822}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6823}event endSrv(Cli_5316,Sess_5318,PartC_5670)
                                    )
                                    else
                                        {6824}let v_5676: bool = (Disco_5317 = C) in
                                        (
                                            {6825}if v_5676 then
                                            (
                                                {6826}let pkDisco_5677: bitstring = pub(skC) in
                                                {6827}in(c, (=pkCli_5655,em1_5678: bitstring));
                                                {6828}let m1_5679: bitstring = em1_5678 in
                                                {6829}let (=OpenSecureChannelRequest,=pkCli_5655,PartC_5680: bitstring) = m1_5679 in
                                                {6830}new Ns_5681: bitstring;
                                                {6831}new ST_5682: bitstring;
                                                {6832}new TTL_5683: bitstring;
                                                {6833}let gNs_5684: bitstring = exp(g,Ns_5681) in
                                                {6834}let m2_5685: bitstring = (OpenSecureChannelResponse,gNs_5684,ST_5682,TTL_5683) in
                                                {6835}event beginSrv(Sess_5318,Cli_5316,gNs_5684);
                                                {6836}out(c, m2_5685);
                                                {6837}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {6838}event endSrv(Cli_5316,Sess_5318,PartC_5680)
                                            )
                                            else
                                                {6839}let pkDisco_5686: bitstring = pub(sk(Disco_5317)) in
                                                {6840}in(c, (=pkCli_5655,em1_5687: bitstring));
                                                {6841}let m1_5688: bitstring = em1_5687 in
                                                {6842}let (=OpenSecureChannelRequest,=pkCli_5655,PartC_5689: bitstring) = m1_5688 in
                                                {6843}new Ns_5690: bitstring;
                                                {6844}new ST_5691: bitstring;
                                                {6845}new TTL_5692: bitstring;
                                                {6846}let gNs_5693: bitstring = exp(g,Ns_5690) in
                                                {6847}let m2_5694: bitstring = (OpenSecureChannelResponse,gNs_5693,ST_5691,TTL_5692) in
                                                {6848}event beginSrv(Sess_5318,Cli_5316,gNs_5693);
                                                {6849}out(c, m2_5694);
                                                {6850}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {6851}event endSrv(Cli_5316,Sess_5318,PartC_5689)
                                        )
                                        else
                                            {6852}let pkDisco_5695: bitstring = fail-any in
                                            {6853}in(c, (=pkCli_5655,em1_5696: bitstring));
                                            {6854}let m1_5697: bitstring = em1_5696 in
                                            {6855}let (=OpenSecureChannelRequest,=pkCli_5655,PartC_5698: bitstring) = m1_5697 in
                                            {6856}new Ns_5699: bitstring;
                                            {6857}new ST_5700: bitstring;
                                            {6858}new TTL_5701: bitstring;
                                            {6859}let gNs_5702: bitstring = exp(g,Ns_5699) in
                                            {6860}let m2_5703: bitstring = (OpenSecureChannelResponse,gNs_5702,ST_5700,TTL_5701) in
                                            {6861}event beginSrv(Sess_5318,Cli_5316,gNs_5702);
                                            {6862}out(c, m2_5703);
                                            {6863}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {6864}event endSrv(Cli_5316,Sess_5318,PartC_5698)
                                )
                                else
                                    {6865}let pkDisco_5704: bitstring = fail-any in
                                    {6866}in(c, (=pkCli_5655,em1_5705: bitstring));
                                    {6867}let m1_5706: bitstring = em1_5705 in
                                    {6868}let (=OpenSecureChannelRequest,=pkCli_5655,PartC_5707: bitstring) = m1_5706 in
                                    {6869}new Ns_5708: bitstring;
                                    {6870}new ST_5709: bitstring;
                                    {6871}new TTL_5710: bitstring;
                                    {6872}let gNs_5711: bitstring = exp(g,Ns_5708) in
                                    {6873}let m2_5712: bitstring = (OpenSecureChannelResponse,gNs_5711,ST_5709,TTL_5710) in
                                    {6874}event beginSrv(Sess_5318,Cli_5316,gNs_5711);
                                    {6875}out(c, m2_5712);
                                    {6876}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {6877}event endSrv(Cli_5316,Sess_5318,PartC_5707)
                        )
                        else
                            {6878}let pkDisco_5713: bitstring = fail-any in
                            {6879}in(c, (=pkCli_5655,em1_5714: bitstring));
                            {6880}let m1_5715: bitstring = em1_5714 in
                            {6881}let (=OpenSecureChannelRequest,=pkCli_5655,PartC_5716: bitstring) = m1_5715 in
                            {6882}new Ns_5717: bitstring;
                            {6883}new ST_5718: bitstring;
                            {6884}new TTL_5719: bitstring;
                            {6885}let gNs_5720: bitstring = exp(g,Ns_5717) in
                            {6886}let m2_5721: bitstring = (OpenSecureChannelResponse,gNs_5720,ST_5718,TTL_5719) in
                            {6887}event beginSrv(Sess_5318,Cli_5316,gNs_5720);
                            {6888}out(c, m2_5721);
                            {6889}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {6890}event endSrv(Cli_5316,Sess_5318,PartC_5716)
            )
            else
                {6891}let pkCli_5722: bitstring = fail-any in
                {6892}let v_5723: bool = (Disco_5317 = A) in
                (
                    {6893}if v_5723 then
                    (
                        {6894}let pkDisco_5724: bitstring = pub(skA) in
                        {6895}in(c, (=pkCli_5722,em1_5725: bitstring));
                        {6896}let m1_5726: bitstring = em1_5725 in
                        {6897}let (=OpenSecureChannelRequest,=pkCli_5722,PartC_5727: bitstring) = m1_5726 in
                        {6898}new Ns_5728: bitstring;
                        {6899}new ST_5729: bitstring;
                        {6900}new TTL_5730: bitstring;
                        {6901}let gNs_5731: bitstring = exp(g,Ns_5728) in
                        {6902}let m2_5732: bitstring = (OpenSecureChannelResponse,gNs_5731,ST_5729,TTL_5730) in
                        {6903}event beginSrv(Sess_5318,Cli_5316,gNs_5731);
                        {6904}out(c, m2_5732);
                        {6905}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                        {6906}event endSrv(Cli_5316,Sess_5318,PartC_5727)
                    )
                    else
                        {6907}let v_5733: bool = (Disco_5317 = B) in
                        (
                            {6908}if v_5733 then
                            (
                                {6909}let pkDisco_5734: bitstring = pub(skB) in
                                {6910}in(c, (=pkCli_5722,em1_5735: bitstring));
                                {6911}let m1_5736: bitstring = em1_5735 in
                                {6912}let (=OpenSecureChannelRequest,=pkCli_5722,PartC_5737: bitstring) = m1_5736 in
                                {6913}new Ns_5738: bitstring;
                                {6914}new ST_5739: bitstring;
                                {6915}new TTL_5740: bitstring;
                                {6916}let gNs_5741: bitstring = exp(g,Ns_5738) in
                                {6917}let m2_5742: bitstring = (OpenSecureChannelResponse,gNs_5741,ST_5739,TTL_5740) in
                                {6918}event beginSrv(Sess_5318,Cli_5316,gNs_5741);
                                {6919}out(c, m2_5742);
                                {6920}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {6921}event endSrv(Cli_5316,Sess_5318,PartC_5737)
                            )
                            else
                                {6922}let v_5743: bool = (Disco_5317 = C) in
                                (
                                    {6923}if v_5743 then
                                    (
                                        {6924}let pkDisco_5744: bitstring = pub(skC) in
                                        {6925}in(c, (=pkCli_5722,em1_5745: bitstring));
                                        {6926}let m1_5746: bitstring = em1_5745 in
                                        {6927}let (=OpenSecureChannelRequest,=pkCli_5722,PartC_5747: bitstring) = m1_5746 in
                                        {6928}new Ns_5748: bitstring;
                                        {6929}new ST_5749: bitstring;
                                        {6930}new TTL_5750: bitstring;
                                        {6931}let gNs_5751: bitstring = exp(g,Ns_5748) in
                                        {6932}let m2_5752: bitstring = (OpenSecureChannelResponse,gNs_5751,ST_5749,TTL_5750) in
                                        {6933}event beginSrv(Sess_5318,Cli_5316,gNs_5751);
                                        {6934}out(c, m2_5752);
                                        {6935}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6936}event endSrv(Cli_5316,Sess_5318,PartC_5747)
                                    )
                                    else
                                        {6937}let pkDisco_5753: bitstring = pub(sk(Disco_5317)) in
                                        {6938}in(c, (=pkCli_5722,em1_5754: bitstring));
                                        {6939}let m1_5755: bitstring = em1_5754 in
                                        {6940}let (=OpenSecureChannelRequest,=pkCli_5722,PartC_5756: bitstring) = m1_5755 in
                                        {6941}new Ns_5757: bitstring;
                                        {6942}new ST_5758: bitstring;
                                        {6943}new TTL_5759: bitstring;
                                        {6944}let gNs_5760: bitstring = exp(g,Ns_5757) in
                                        {6945}let m2_5761: bitstring = (OpenSecureChannelResponse,gNs_5760,ST_5758,TTL_5759) in
                                        {6946}event beginSrv(Sess_5318,Cli_5316,gNs_5760);
                                        {6947}out(c, m2_5761);
                                        {6948}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {6949}event endSrv(Cli_5316,Sess_5318,PartC_5756)
                                )
                                else
                                    {6950}let pkDisco_5762: bitstring = fail-any in
                                    {6951}in(c, (=pkCli_5722,em1_5763: bitstring));
                                    {6952}let m1_5764: bitstring = em1_5763 in
                                    {6953}let (=OpenSecureChannelRequest,=pkCli_5722,PartC_5765: bitstring) = m1_5764 in
                                    {6954}new Ns_5766: bitstring;
                                    {6955}new ST_5767: bitstring;
                                    {6956}new TTL_5768: bitstring;
                                    {6957}let gNs_5769: bitstring = exp(g,Ns_5766) in
                                    {6958}let m2_5770: bitstring = (OpenSecureChannelResponse,gNs_5769,ST_5767,TTL_5768) in
                                    {6959}event beginSrv(Sess_5318,Cli_5316,gNs_5769);
                                    {6960}out(c, m2_5770);
                                    {6961}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {6962}event endSrv(Cli_5316,Sess_5318,PartC_5765)
                        )
                        else
                            {6963}let pkDisco_5771: bitstring = fail-any in
                            {6964}in(c, (=pkCli_5722,em1_5772: bitstring));
                            {6965}let m1_5773: bitstring = em1_5772 in
                            {6966}let (=OpenSecureChannelRequest,=pkCli_5722,PartC_5774: bitstring) = m1_5773 in
                            {6967}new Ns_5775: bitstring;
                            {6968}new ST_5776: bitstring;
                            {6969}new TTL_5777: bitstring;
                            {6970}let gNs_5778: bitstring = exp(g,Ns_5775) in
                            {6971}let m2_5779: bitstring = (OpenSecureChannelResponse,gNs_5778,ST_5776,TTL_5777) in
                            {6972}event beginSrv(Sess_5318,Cli_5316,gNs_5778);
                            {6973}out(c, m2_5779);
                            {6974}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {6975}event endSrv(Cli_5316,Sess_5318,PartC_5774)
                )
                else
                    {6976}let pkDisco_5780: bitstring = fail-any in
                    {6977}in(c, (=pkCli_5722,em1_5781: bitstring));
                    {6978}let m1_5782: bitstring = em1_5781 in
                    {6979}let (=OpenSecureChannelRequest,=pkCli_5722,PartC_5783: bitstring) = m1_5782 in
                    {6980}new Ns_5784: bitstring;
                    {6981}new ST_5785: bitstring;
                    {6982}new TTL_5786: bitstring;
                    {6983}let gNs_5787: bitstring = exp(g,Ns_5784) in
                    {6984}let m2_5788: bitstring = (OpenSecureChannelResponse,gNs_5787,ST_5785,TTL_5786) in
                    {6985}event beginSrv(Sess_5318,Cli_5316,gNs_5787);
                    {6986}out(c, m2_5788);
                    {6987}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                    {6988}event endSrv(Cli_5316,Sess_5318,PartC_5783)
        )
        else
            {6989}let v_5789: bool = (Sess_5318 = B) in
            (
                {6990}if v_5789 then
                (
                    {6991}let skSess_5790: bitstring = skB in
                    {6992}let pkSess_5791: bitstring = pub(skSess_5790) in
                    {6993}let v_5792: bool = (Cli_5316 = A) in
                    (
                        {6994}if v_5792 then
                        (
                            {6995}let pkCli_5793: bitstring = pub(skA) in
                            {6996}let v_5794: bool = (Disco_5317 = A) in
                            (
                                {6997}if v_5794 then
                                (
                                    {6998}let pkDisco_5795: bitstring = pub(skA) in
                                    {6999}in(c, (=pkCli_5793,em1_5796: bitstring));
                                    {7000}let m1_5797: bitstring = em1_5796 in
                                    {7001}let (=OpenSecureChannelRequest,=pkCli_5793,PartC_5798: bitstring) = m1_5797 in
                                    {7002}new Ns_5799: bitstring;
                                    {7003}new ST_5800: bitstring;
                                    {7004}new TTL_5801: bitstring;
                                    {7005}let gNs_5802: bitstring = exp(g,Ns_5799) in
                                    {7006}let m2_5803: bitstring = (OpenSecureChannelResponse,gNs_5802,ST_5800,TTL_5801) in
                                    {7007}event beginSrv(Sess_5318,Cli_5316,gNs_5802);
                                    {7008}out(c, m2_5803);
                                    {7009}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {7010}event endSrv(Cli_5316,Sess_5318,PartC_5798)
                                )
                                else
                                    {7011}let v_5804: bool = (Disco_5317 = B) in
                                    (
                                        {7012}if v_5804 then
                                        (
                                            {7013}let pkDisco_5805: bitstring = pub(skB) in
                                            {7014}in(c, (=pkCli_5793,em1_5806: bitstring));
                                            {7015}let m1_5807: bitstring = em1_5806 in
                                            {7016}let (=OpenSecureChannelRequest,=pkCli_5793,PartC_5808: bitstring) = m1_5807 in
                                            {7017}new Ns_5809: bitstring;
                                            {7018}new ST_5810: bitstring;
                                            {7019}new TTL_5811: bitstring;
                                            {7020}let gNs_5812: bitstring = exp(g,Ns_5809) in
                                            {7021}let m2_5813: bitstring = (OpenSecureChannelResponse,gNs_5812,ST_5810,TTL_5811) in
                                            {7022}event beginSrv(Sess_5318,Cli_5316,gNs_5812);
                                            {7023}out(c, m2_5813);
                                            {7024}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {7025}event endSrv(Cli_5316,Sess_5318,PartC_5808)
                                        )
                                        else
                                            {7026}let v_5814: bool = (Disco_5317 = C) in
                                            (
                                                {7027}if v_5814 then
                                                (
                                                    {7028}let pkDisco_5815: bitstring = pub(skC) in
                                                    {7029}in(c, (=pkCli_5793,em1_5816: bitstring));
                                                    {7030}let m1_5817: bitstring = em1_5816 in
                                                    {7031}let (=OpenSecureChannelRequest,=pkCli_5793,PartC_5818: bitstring) = m1_5817 in
                                                    {7032}new Ns_5819: bitstring;
                                                    {7033}new ST_5820: bitstring;
                                                    {7034}new TTL_5821: bitstring;
                                                    {7035}let gNs_5822: bitstring = exp(g,Ns_5819) in
                                                    {7036}let m2_5823: bitstring = (OpenSecureChannelResponse,gNs_5822,ST_5820,TTL_5821) in
                                                    {7037}event beginSrv(Sess_5318,Cli_5316,gNs_5822);
                                                    {7038}out(c, m2_5823);
                                                    {7039}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7040}event endSrv(Cli_5316,Sess_5318,PartC_5818)
                                                )
                                                else
                                                    {7041}let pkDisco_5824: bitstring = pub(sk(Disco_5317)) in
                                                    {7042}in(c, (=pkCli_5793,em1_5825: bitstring));
                                                    {7043}let m1_5826: bitstring = em1_5825 in
                                                    {7044}let (=OpenSecureChannelRequest,=pkCli_5793,PartC_5827: bitstring) = m1_5826 in
                                                    {7045}new Ns_5828: bitstring;
                                                    {7046}new ST_5829: bitstring;
                                                    {7047}new TTL_5830: bitstring;
                                                    {7048}let gNs_5831: bitstring = exp(g,Ns_5828) in
                                                    {7049}let m2_5832: bitstring = (OpenSecureChannelResponse,gNs_5831,ST_5829,TTL_5830) in
                                                    {7050}event beginSrv(Sess_5318,Cli_5316,gNs_5831);
                                                    {7051}out(c, m2_5832);
                                                    {7052}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7053}event endSrv(Cli_5316,Sess_5318,PartC_5827)
                                            )
                                            else
                                                {7054}let pkDisco_5833: bitstring = fail-any in
                                                {7055}in(c, (=pkCli_5793,em1_5834: bitstring));
                                                {7056}let m1_5835: bitstring = em1_5834 in
                                                {7057}let (=OpenSecureChannelRequest,=pkCli_5793,PartC_5836: bitstring) = m1_5835 in
                                                {7058}new Ns_5837: bitstring;
                                                {7059}new ST_5838: bitstring;
                                                {7060}new TTL_5839: bitstring;
                                                {7061}let gNs_5840: bitstring = exp(g,Ns_5837) in
                                                {7062}let m2_5841: bitstring = (OpenSecureChannelResponse,gNs_5840,ST_5838,TTL_5839) in
                                                {7063}event beginSrv(Sess_5318,Cli_5316,gNs_5840);
                                                {7064}out(c, m2_5841);
                                                {7065}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7066}event endSrv(Cli_5316,Sess_5318,PartC_5836)
                                    )
                                    else
                                        {7067}let pkDisco_5842: bitstring = fail-any in
                                        {7068}in(c, (=pkCli_5793,em1_5843: bitstring));
                                        {7069}let m1_5844: bitstring = em1_5843 in
                                        {7070}let (=OpenSecureChannelRequest,=pkCli_5793,PartC_5845: bitstring) = m1_5844 in
                                        {7071}new Ns_5846: bitstring;
                                        {7072}new ST_5847: bitstring;
                                        {7073}new TTL_5848: bitstring;
                                        {7074}let gNs_5849: bitstring = exp(g,Ns_5846) in
                                        {7075}let m2_5850: bitstring = (OpenSecureChannelResponse,gNs_5849,ST_5847,TTL_5848) in
                                        {7076}event beginSrv(Sess_5318,Cli_5316,gNs_5849);
                                        {7077}out(c, m2_5850);
                                        {7078}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {7079}event endSrv(Cli_5316,Sess_5318,PartC_5845)
                            )
                            else
                                {7080}let pkDisco_5851: bitstring = fail-any in
                                {7081}in(c, (=pkCli_5793,em1_5852: bitstring));
                                {7082}let m1_5853: bitstring = em1_5852 in
                                {7083}let (=OpenSecureChannelRequest,=pkCli_5793,PartC_5854: bitstring) = m1_5853 in
                                {7084}new Ns_5855: bitstring;
                                {7085}new ST_5856: bitstring;
                                {7086}new TTL_5857: bitstring;
                                {7087}let gNs_5858: bitstring = exp(g,Ns_5855) in
                                {7088}let m2_5859: bitstring = (OpenSecureChannelResponse,gNs_5858,ST_5856,TTL_5857) in
                                {7089}event beginSrv(Sess_5318,Cli_5316,gNs_5858);
                                {7090}out(c, m2_5859);
                                {7091}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {7092}event endSrv(Cli_5316,Sess_5318,PartC_5854)
                        )
                        else
                            {7093}let v_5860: bool = (Cli_5316 = B) in
                            (
                                {7094}if v_5860 then
                                (
                                    {7095}let pkCli_5861: bitstring = pub(skB) in
                                    {7096}let v_5862: bool = (Disco_5317 = A) in
                                    (
                                        {7097}if v_5862 then
                                        (
                                            {7098}let pkDisco_5863: bitstring = pub(skA) in
                                            {7099}in(c, (=pkCli_5861,em1_5864: bitstring));
                                            {7100}let m1_5865: bitstring = em1_5864 in
                                            {7101}let (=OpenSecureChannelRequest,=pkCli_5861,PartC_5866: bitstring) = m1_5865 in
                                            {7102}new Ns_5867: bitstring;
                                            {7103}new ST_5868: bitstring;
                                            {7104}new TTL_5869: bitstring;
                                            {7105}let gNs_5870: bitstring = exp(g,Ns_5867) in
                                            {7106}let m2_5871: bitstring = (OpenSecureChannelResponse,gNs_5870,ST_5868,TTL_5869) in
                                            {7107}event beginSrv(Sess_5318,Cli_5316,gNs_5870);
                                            {7108}out(c, m2_5871);
                                            {7109}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {7110}event endSrv(Cli_5316,Sess_5318,PartC_5866)
                                        )
                                        else
                                            {7111}let v_5872: bool = (Disco_5317 = B) in
                                            (
                                                {7112}if v_5872 then
                                                (
                                                    {7113}let pkDisco_5873: bitstring = pub(skB) in
                                                    {7114}in(c, (=pkCli_5861,em1_5874: bitstring));
                                                    {7115}let m1_5875: bitstring = em1_5874 in
                                                    {7116}let (=OpenSecureChannelRequest,=pkCli_5861,PartC_5876: bitstring) = m1_5875 in
                                                    {7117}new Ns_5877: bitstring;
                                                    {7118}new ST_5878: bitstring;
                                                    {7119}new TTL_5879: bitstring;
                                                    {7120}let gNs_5880: bitstring = exp(g,Ns_5877) in
                                                    {7121}let m2_5881: bitstring = (OpenSecureChannelResponse,gNs_5880,ST_5878,TTL_5879) in
                                                    {7122}event beginSrv(Sess_5318,Cli_5316,gNs_5880);
                                                    {7123}out(c, m2_5881);
                                                    {7124}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7125}event endSrv(Cli_5316,Sess_5318,PartC_5876)
                                                )
                                                else
                                                    {7126}let v_5882: bool = (Disco_5317 = C) in
                                                    (
                                                        {7127}if v_5882 then
                                                        (
                                                            {7128}let pkDisco_5883: bitstring = pub(skC) in
                                                            {7129}in(c, (=pkCli_5861,em1_5884: bitstring));
                                                            {7130}let m1_5885: bitstring = em1_5884 in
                                                            {7131}let (=OpenSecureChannelRequest,=pkCli_5861,PartC_5886: bitstring) = m1_5885 in
                                                            {7132}new Ns_5887: bitstring;
                                                            {7133}new ST_5888: bitstring;
                                                            {7134}new TTL_5889: bitstring;
                                                            {7135}let gNs_5890: bitstring = exp(g,Ns_5887) in
                                                            {7136}let m2_5891: bitstring = (OpenSecureChannelResponse,gNs_5890,ST_5888,TTL_5889) in
                                                            {7137}event beginSrv(Sess_5318,Cli_5316,gNs_5890);
                                                            {7138}out(c, m2_5891);
                                                            {7139}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {7140}event endSrv(Cli_5316,Sess_5318,PartC_5886)
                                                        )
                                                        else
                                                            {7141}let pkDisco_5892: bitstring = pub(sk(Disco_5317)) in
                                                            {7142}in(c, (=pkCli_5861,em1_5893: bitstring));
                                                            {7143}let m1_5894: bitstring = em1_5893 in
                                                            {7144}let (=OpenSecureChannelRequest,=pkCli_5861,PartC_5895: bitstring) = m1_5894 in
                                                            {7145}new Ns_5896: bitstring;
                                                            {7146}new ST_5897: bitstring;
                                                            {7147}new TTL_5898: bitstring;
                                                            {7148}let gNs_5899: bitstring = exp(g,Ns_5896) in
                                                            {7149}let m2_5900: bitstring = (OpenSecureChannelResponse,gNs_5899,ST_5897,TTL_5898) in
                                                            {7150}event beginSrv(Sess_5318,Cli_5316,gNs_5899);
                                                            {7151}out(c, m2_5900);
                                                            {7152}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {7153}event endSrv(Cli_5316,Sess_5318,PartC_5895)
                                                    )
                                                    else
                                                        {7154}let pkDisco_5901: bitstring = fail-any in
                                                        {7155}in(c, (=pkCli_5861,em1_5902: bitstring));
                                                        {7156}let m1_5903: bitstring = em1_5902 in
                                                        {7157}let (=OpenSecureChannelRequest,=pkCli_5861,PartC_5904: bitstring) = m1_5903 in
                                                        {7158}new Ns_5905: bitstring;
                                                        {7159}new ST_5906: bitstring;
                                                        {7160}new TTL_5907: bitstring;
                                                        {7161}let gNs_5908: bitstring = exp(g,Ns_5905) in
                                                        {7162}let m2_5909: bitstring = (OpenSecureChannelResponse,gNs_5908,ST_5906,TTL_5907) in
                                                        {7163}event beginSrv(Sess_5318,Cli_5316,gNs_5908);
                                                        {7164}out(c, m2_5909);
                                                        {7165}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7166}event endSrv(Cli_5316,Sess_5318,PartC_5904)
                                            )
                                            else
                                                {7167}let pkDisco_5910: bitstring = fail-any in
                                                {7168}in(c, (=pkCli_5861,em1_5911: bitstring));
                                                {7169}let m1_5912: bitstring = em1_5911 in
                                                {7170}let (=OpenSecureChannelRequest,=pkCli_5861,PartC_5913: bitstring) = m1_5912 in
                                                {7171}new Ns_5914: bitstring;
                                                {7172}new ST_5915: bitstring;
                                                {7173}new TTL_5916: bitstring;
                                                {7174}let gNs_5917: bitstring = exp(g,Ns_5914) in
                                                {7175}let m2_5918: bitstring = (OpenSecureChannelResponse,gNs_5917,ST_5915,TTL_5916) in
                                                {7176}event beginSrv(Sess_5318,Cli_5316,gNs_5917);
                                                {7177}out(c, m2_5918);
                                                {7178}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7179}event endSrv(Cli_5316,Sess_5318,PartC_5913)
                                    )
                                    else
                                        {7180}let pkDisco_5919: bitstring = fail-any in
                                        {7181}in(c, (=pkCli_5861,em1_5920: bitstring));
                                        {7182}let m1_5921: bitstring = em1_5920 in
                                        {7183}let (=OpenSecureChannelRequest,=pkCli_5861,PartC_5922: bitstring) = m1_5921 in
                                        {7184}new Ns_5923: bitstring;
                                        {7185}new ST_5924: bitstring;
                                        {7186}new TTL_5925: bitstring;
                                        {7187}let gNs_5926: bitstring = exp(g,Ns_5923) in
                                        {7188}let m2_5927: bitstring = (OpenSecureChannelResponse,gNs_5926,ST_5924,TTL_5925) in
                                        {7189}event beginSrv(Sess_5318,Cli_5316,gNs_5926);
                                        {7190}out(c, m2_5927);
                                        {7191}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {7192}event endSrv(Cli_5316,Sess_5318,PartC_5922)
                                )
                                else
                                    {7193}let v_5928: bool = (Cli_5316 = C) in
                                    (
                                        {7194}if v_5928 then
                                        (
                                            {7195}let pkCli_5929: bitstring = pub(skC) in
                                            {7196}let v_5930: bool = (Disco_5317 = A) in
                                            (
                                                {7197}if v_5930 then
                                                (
                                                    {7198}let pkDisco_5931: bitstring = pub(skA) in
                                                    {7199}in(c, (=pkCli_5929,em1_5932: bitstring));
                                                    {7200}let m1_5933: bitstring = em1_5932 in
                                                    {7201}let (=OpenSecureChannelRequest,=pkCli_5929,PartC_5934: bitstring) = m1_5933 in
                                                    {7202}new Ns_5935: bitstring;
                                                    {7203}new ST_5936: bitstring;
                                                    {7204}new TTL_5937: bitstring;
                                                    {7205}let gNs_5938: bitstring = exp(g,Ns_5935) in
                                                    {7206}let m2_5939: bitstring = (OpenSecureChannelResponse,gNs_5938,ST_5936,TTL_5937) in
                                                    {7207}event beginSrv(Sess_5318,Cli_5316,gNs_5938);
                                                    {7208}out(c, m2_5939);
                                                    {7209}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7210}event endSrv(Cli_5316,Sess_5318,PartC_5934)
                                                )
                                                else
                                                    {7211}let v_5940: bool = (Disco_5317 = B) in
                                                    (
                                                        {7212}if v_5940 then
                                                        (
                                                            {7213}let pkDisco_5941: bitstring = pub(skB) in
                                                            {7214}in(c, (=pkCli_5929,em1_5942: bitstring));
                                                            {7215}let m1_5943: bitstring = em1_5942 in
                                                            {7216}let (=OpenSecureChannelRequest,=pkCli_5929,PartC_5944: bitstring) = m1_5943 in
                                                            {7217}new Ns_5945: bitstring;
                                                            {7218}new ST_5946: bitstring;
                                                            {7219}new TTL_5947: bitstring;
                                                            {7220}let gNs_5948: bitstring = exp(g,Ns_5945) in
                                                            {7221}let m2_5949: bitstring = (OpenSecureChannelResponse,gNs_5948,ST_5946,TTL_5947) in
                                                            {7222}event beginSrv(Sess_5318,Cli_5316,gNs_5948);
                                                            {7223}out(c, m2_5949);
                                                            {7224}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {7225}event endSrv(Cli_5316,Sess_5318,PartC_5944)
                                                        )
                                                        else
                                                            {7226}let v_5950: bool = (Disco_5317 = C) in
                                                            (
                                                                {7227}if v_5950 then
                                                                (
                                                                    {7228}let pkDisco_5951: bitstring = pub(skC) in
                                                                    {7229}in(c, (=pkCli_5929,em1_5952: bitstring));
                                                                    {7230}let m1_5953: bitstring = em1_5952 in
                                                                    {7231}let (=OpenSecureChannelRequest,=pkCli_5929,PartC_5954: bitstring) = m1_5953 in
                                                                    {7232}new Ns_5955: bitstring;
                                                                    {7233}new ST_5956: bitstring;
                                                                    {7234}new TTL_5957: bitstring;
                                                                    {7235}let gNs_5958: bitstring = exp(g,Ns_5955) in
                                                                    {7236}let m2_5959: bitstring = (OpenSecureChannelResponse,gNs_5958,ST_5956,TTL_5957) in
                                                                    {7237}event beginSrv(Sess_5318,Cli_5316,gNs_5958);
                                                                    {7238}out(c, m2_5959);
                                                                    {7239}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {7240}event endSrv(Cli_5316,Sess_5318,PartC_5954)
                                                                )
                                                                else
                                                                    {7241}let pkDisco_5960: bitstring = pub(sk(Disco_5317)) in
                                                                    {7242}in(c, (=pkCli_5929,em1_5961: bitstring));
                                                                    {7243}let m1_5962: bitstring = em1_5961 in
                                                                    {7244}let (=OpenSecureChannelRequest,=pkCli_5929,PartC_5963: bitstring) = m1_5962 in
                                                                    {7245}new Ns_5964: bitstring;
                                                                    {7246}new ST_5965: bitstring;
                                                                    {7247}new TTL_5966: bitstring;
                                                                    {7248}let gNs_5967: bitstring = exp(g,Ns_5964) in
                                                                    {7249}let m2_5968: bitstring = (OpenSecureChannelResponse,gNs_5967,ST_5965,TTL_5966) in
                                                                    {7250}event beginSrv(Sess_5318,Cli_5316,gNs_5967);
                                                                    {7251}out(c, m2_5968);
                                                                    {7252}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {7253}event endSrv(Cli_5316,Sess_5318,PartC_5963)
                                                            )
                                                            else
                                                                {7254}let pkDisco_5969: bitstring = fail-any in
                                                                {7255}in(c, (=pkCli_5929,em1_5970: bitstring));
                                                                {7256}let m1_5971: bitstring = em1_5970 in
                                                                {7257}let (=OpenSecureChannelRequest,=pkCli_5929,PartC_5972: bitstring) = m1_5971 in
                                                                {7258}new Ns_5973: bitstring;
                                                                {7259}new ST_5974: bitstring;
                                                                {7260}new TTL_5975: bitstring;
                                                                {7261}let gNs_5976: bitstring = exp(g,Ns_5973) in
                                                                {7262}let m2_5977: bitstring = (OpenSecureChannelResponse,gNs_5976,ST_5974,TTL_5975) in
                                                                {7263}event beginSrv(Sess_5318,Cli_5316,gNs_5976);
                                                                {7264}out(c, m2_5977);
                                                                {7265}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {7266}event endSrv(Cli_5316,Sess_5318,PartC_5972)
                                                    )
                                                    else
                                                        {7267}let pkDisco_5978: bitstring = fail-any in
                                                        {7268}in(c, (=pkCli_5929,em1_5979: bitstring));
                                                        {7269}let m1_5980: bitstring = em1_5979 in
                                                        {7270}let (=OpenSecureChannelRequest,=pkCli_5929,PartC_5981: bitstring) = m1_5980 in
                                                        {7271}new Ns_5982: bitstring;
                                                        {7272}new ST_5983: bitstring;
                                                        {7273}new TTL_5984: bitstring;
                                                        {7274}let gNs_5985: bitstring = exp(g,Ns_5982) in
                                                        {7275}let m2_5986: bitstring = (OpenSecureChannelResponse,gNs_5985,ST_5983,TTL_5984) in
                                                        {7276}event beginSrv(Sess_5318,Cli_5316,gNs_5985);
                                                        {7277}out(c, m2_5986);
                                                        {7278}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7279}event endSrv(Cli_5316,Sess_5318,PartC_5981)
                                            )
                                            else
                                                {7280}let pkDisco_5987: bitstring = fail-any in
                                                {7281}in(c, (=pkCli_5929,em1_5988: bitstring));
                                                {7282}let m1_5989: bitstring = em1_5988 in
                                                {7283}let (=OpenSecureChannelRequest,=pkCli_5929,PartC_5990: bitstring) = m1_5989 in
                                                {7284}new Ns_5991: bitstring;
                                                {7285}new ST_5992: bitstring;
                                                {7286}new TTL_5993: bitstring;
                                                {7287}let gNs_5994: bitstring = exp(g,Ns_5991) in
                                                {7288}let m2_5995: bitstring = (OpenSecureChannelResponse,gNs_5994,ST_5992,TTL_5993) in
                                                {7289}event beginSrv(Sess_5318,Cli_5316,gNs_5994);
                                                {7290}out(c, m2_5995);
                                                {7291}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7292}event endSrv(Cli_5316,Sess_5318,PartC_5990)
                                        )
                                        else
                                            {7293}let pkCli_5996: bitstring = pub(sk(Cli_5316)) in
                                            {7294}let v_5997: bool = (Disco_5317 = A) in
                                            (
                                                {7295}if v_5997 then
                                                (
                                                    {7296}let pkDisco_5998: bitstring = pub(skA) in
                                                    {7297}in(c, (=pkCli_5996,em1_5999: bitstring));
                                                    {7298}let m1_6000: bitstring = em1_5999 in
                                                    {7299}let (=OpenSecureChannelRequest,=pkCli_5996,PartC_6001: bitstring) = m1_6000 in
                                                    {7300}new Ns_6002: bitstring;
                                                    {7301}new ST_6003: bitstring;
                                                    {7302}new TTL_6004: bitstring;
                                                    {7303}let gNs_6005: bitstring = exp(g,Ns_6002) in
                                                    {7304}let m2_6006: bitstring = (OpenSecureChannelResponse,gNs_6005,ST_6003,TTL_6004) in
                                                    {7305}event beginSrv(Sess_5318,Cli_5316,gNs_6005);
                                                    {7306}out(c, m2_6006);
                                                    {7307}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7308}event endSrv(Cli_5316,Sess_5318,PartC_6001)
                                                )
                                                else
                                                    {7309}let v_6007: bool = (Disco_5317 = B) in
                                                    (
                                                        {7310}if v_6007 then
                                                        (
                                                            {7311}let pkDisco_6008: bitstring = pub(skB) in
                                                            {7312}in(c, (=pkCli_5996,em1_6009: bitstring));
                                                            {7313}let m1_6010: bitstring = em1_6009 in
                                                            {7314}let (=OpenSecureChannelRequest,=pkCli_5996,PartC_6011: bitstring) = m1_6010 in
                                                            {7315}new Ns_6012: bitstring;
                                                            {7316}new ST_6013: bitstring;
                                                            {7317}new TTL_6014: bitstring;
                                                            {7318}let gNs_6015: bitstring = exp(g,Ns_6012) in
                                                            {7319}let m2_6016: bitstring = (OpenSecureChannelResponse,gNs_6015,ST_6013,TTL_6014) in
                                                            {7320}event beginSrv(Sess_5318,Cli_5316,gNs_6015);
                                                            {7321}out(c, m2_6016);
                                                            {7322}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {7323}event endSrv(Cli_5316,Sess_5318,PartC_6011)
                                                        )
                                                        else
                                                            {7324}let v_6017: bool = (Disco_5317 = C) in
                                                            (
                                                                {7325}if v_6017 then
                                                                (
                                                                    {7326}let pkDisco_6018: bitstring = pub(skC) in
                                                                    {7327}in(c, (=pkCli_5996,em1_6019: bitstring));
                                                                    {7328}let m1_6020: bitstring = em1_6019 in
                                                                    {7329}let (=OpenSecureChannelRequest,=pkCli_5996,PartC_6021: bitstring) = m1_6020 in
                                                                    {7330}new Ns_6022: bitstring;
                                                                    {7331}new ST_6023: bitstring;
                                                                    {7332}new TTL_6024: bitstring;
                                                                    {7333}let gNs_6025: bitstring = exp(g,Ns_6022) in
                                                                    {7334}let m2_6026: bitstring = (OpenSecureChannelResponse,gNs_6025,ST_6023,TTL_6024) in
                                                                    {7335}event beginSrv(Sess_5318,Cli_5316,gNs_6025);
                                                                    {7336}out(c, m2_6026);
                                                                    {7337}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {7338}event endSrv(Cli_5316,Sess_5318,PartC_6021)
                                                                )
                                                                else
                                                                    {7339}let pkDisco_6027: bitstring = pub(sk(Disco_5317)) in
                                                                    {7340}in(c, (=pkCli_5996,em1_6028: bitstring));
                                                                    {7341}let m1_6029: bitstring = em1_6028 in
                                                                    {7342}let (=OpenSecureChannelRequest,=pkCli_5996,PartC_6030: bitstring) = m1_6029 in
                                                                    {7343}new Ns_6031: bitstring;
                                                                    {7344}new ST_6032: bitstring;
                                                                    {7345}new TTL_6033: bitstring;
                                                                    {7346}let gNs_6034: bitstring = exp(g,Ns_6031) in
                                                                    {7347}let m2_6035: bitstring = (OpenSecureChannelResponse,gNs_6034,ST_6032,TTL_6033) in
                                                                    {7348}event beginSrv(Sess_5318,Cli_5316,gNs_6034);
                                                                    {7349}out(c, m2_6035);
                                                                    {7350}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {7351}event endSrv(Cli_5316,Sess_5318,PartC_6030)
                                                            )
                                                            else
                                                                {7352}let pkDisco_6036: bitstring = fail-any in
                                                                {7353}in(c, (=pkCli_5996,em1_6037: bitstring));
                                                                {7354}let m1_6038: bitstring = em1_6037 in
                                                                {7355}let (=OpenSecureChannelRequest,=pkCli_5996,PartC_6039: bitstring) = m1_6038 in
                                                                {7356}new Ns_6040: bitstring;
                                                                {7357}new ST_6041: bitstring;
                                                                {7358}new TTL_6042: bitstring;
                                                                {7359}let gNs_6043: bitstring = exp(g,Ns_6040) in
                                                                {7360}let m2_6044: bitstring = (OpenSecureChannelResponse,gNs_6043,ST_6041,TTL_6042) in
                                                                {7361}event beginSrv(Sess_5318,Cli_5316,gNs_6043);
                                                                {7362}out(c, m2_6044);
                                                                {7363}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {7364}event endSrv(Cli_5316,Sess_5318,PartC_6039)
                                                    )
                                                    else
                                                        {7365}let pkDisco_6045: bitstring = fail-any in
                                                        {7366}in(c, (=pkCli_5996,em1_6046: bitstring));
                                                        {7367}let m1_6047: bitstring = em1_6046 in
                                                        {7368}let (=OpenSecureChannelRequest,=pkCli_5996,PartC_6048: bitstring) = m1_6047 in
                                                        {7369}new Ns_6049: bitstring;
                                                        {7370}new ST_6050: bitstring;
                                                        {7371}new TTL_6051: bitstring;
                                                        {7372}let gNs_6052: bitstring = exp(g,Ns_6049) in
                                                        {7373}let m2_6053: bitstring = (OpenSecureChannelResponse,gNs_6052,ST_6050,TTL_6051) in
                                                        {7374}event beginSrv(Sess_5318,Cli_5316,gNs_6052);
                                                        {7375}out(c, m2_6053);
                                                        {7376}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7377}event endSrv(Cli_5316,Sess_5318,PartC_6048)
                                            )
                                            else
                                                {7378}let pkDisco_6054: bitstring = fail-any in
                                                {7379}in(c, (=pkCli_5996,em1_6055: bitstring));
                                                {7380}let m1_6056: bitstring = em1_6055 in
                                                {7381}let (=OpenSecureChannelRequest,=pkCli_5996,PartC_6057: bitstring) = m1_6056 in
                                                {7382}new Ns_6058: bitstring;
                                                {7383}new ST_6059: bitstring;
                                                {7384}new TTL_6060: bitstring;
                                                {7385}let gNs_6061: bitstring = exp(g,Ns_6058) in
                                                {7386}let m2_6062: bitstring = (OpenSecureChannelResponse,gNs_6061,ST_6059,TTL_6060) in
                                                {7387}event beginSrv(Sess_5318,Cli_5316,gNs_6061);
                                                {7388}out(c, m2_6062);
                                                {7389}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7390}event endSrv(Cli_5316,Sess_5318,PartC_6057)
                                    )
                                    else
                                        {7391}let pkCli_6063: bitstring = fail-any in
                                        {7392}let v_6064: bool = (Disco_5317 = A) in
                                        (
                                            {7393}if v_6064 then
                                            (
                                                {7394}let pkDisco_6065: bitstring = pub(skA) in
                                                {7395}in(c, (=pkCli_6063,em1_6066: bitstring));
                                                {7396}let m1_6067: bitstring = em1_6066 in
                                                {7397}let (=OpenSecureChannelRequest,=pkCli_6063,PartC_6068: bitstring) = m1_6067 in
                                                {7398}new Ns_6069: bitstring;
                                                {7399}new ST_6070: bitstring;
                                                {7400}new TTL_6071: bitstring;
                                                {7401}let gNs_6072: bitstring = exp(g,Ns_6069) in
                                                {7402}let m2_6073: bitstring = (OpenSecureChannelResponse,gNs_6072,ST_6070,TTL_6071) in
                                                {7403}event beginSrv(Sess_5318,Cli_5316,gNs_6072);
                                                {7404}out(c, m2_6073);
                                                {7405}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7406}event endSrv(Cli_5316,Sess_5318,PartC_6068)
                                            )
                                            else
                                                {7407}let v_6074: bool = (Disco_5317 = B) in
                                                (
                                                    {7408}if v_6074 then
                                                    (
                                                        {7409}let pkDisco_6075: bitstring = pub(skB) in
                                                        {7410}in(c, (=pkCli_6063,em1_6076: bitstring));
                                                        {7411}let m1_6077: bitstring = em1_6076 in
                                                        {7412}let (=OpenSecureChannelRequest,=pkCli_6063,PartC_6078: bitstring) = m1_6077 in
                                                        {7413}new Ns_6079: bitstring;
                                                        {7414}new ST_6080: bitstring;
                                                        {7415}new TTL_6081: bitstring;
                                                        {7416}let gNs_6082: bitstring = exp(g,Ns_6079) in
                                                        {7417}let m2_6083: bitstring = (OpenSecureChannelResponse,gNs_6082,ST_6080,TTL_6081) in
                                                        {7418}event beginSrv(Sess_5318,Cli_5316,gNs_6082);
                                                        {7419}out(c, m2_6083);
                                                        {7420}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7421}event endSrv(Cli_5316,Sess_5318,PartC_6078)
                                                    )
                                                    else
                                                        {7422}let v_6084: bool = (Disco_5317 = C) in
                                                        (
                                                            {7423}if v_6084 then
                                                            (
                                                                {7424}let pkDisco_6085: bitstring = pub(skC) in
                                                                {7425}in(c, (=pkCli_6063,em1_6086: bitstring));
                                                                {7426}let m1_6087: bitstring = em1_6086 in
                                                                {7427}let (=OpenSecureChannelRequest,=pkCli_6063,PartC_6088: bitstring) = m1_6087 in
                                                                {7428}new Ns_6089: bitstring;
                                                                {7429}new ST_6090: bitstring;
                                                                {7430}new TTL_6091: bitstring;
                                                                {7431}let gNs_6092: bitstring = exp(g,Ns_6089) in
                                                                {7432}let m2_6093: bitstring = (OpenSecureChannelResponse,gNs_6092,ST_6090,TTL_6091) in
                                                                {7433}event beginSrv(Sess_5318,Cli_5316,gNs_6092);
                                                                {7434}out(c, m2_6093);
                                                                {7435}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {7436}event endSrv(Cli_5316,Sess_5318,PartC_6088)
                                                            )
                                                            else
                                                                {7437}let pkDisco_6094: bitstring = pub(sk(Disco_5317)) in
                                                                {7438}in(c, (=pkCli_6063,em1_6095: bitstring));
                                                                {7439}let m1_6096: bitstring = em1_6095 in
                                                                {7440}let (=OpenSecureChannelRequest,=pkCli_6063,PartC_6097: bitstring) = m1_6096 in
                                                                {7441}new Ns_6098: bitstring;
                                                                {7442}new ST_6099: bitstring;
                                                                {7443}new TTL_6100: bitstring;
                                                                {7444}let gNs_6101: bitstring = exp(g,Ns_6098) in
                                                                {7445}let m2_6102: bitstring = (OpenSecureChannelResponse,gNs_6101,ST_6099,TTL_6100) in
                                                                {7446}event beginSrv(Sess_5318,Cli_5316,gNs_6101);
                                                                {7447}out(c, m2_6102);
                                                                {7448}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {7449}event endSrv(Cli_5316,Sess_5318,PartC_6097)
                                                        )
                                                        else
                                                            {7450}let pkDisco_6103: bitstring = fail-any in
                                                            {7451}in(c, (=pkCli_6063,em1_6104: bitstring));
                                                            {7452}let m1_6105: bitstring = em1_6104 in
                                                            {7453}let (=OpenSecureChannelRequest,=pkCli_6063,PartC_6106: bitstring) = m1_6105 in
                                                            {7454}new Ns_6107: bitstring;
                                                            {7455}new ST_6108: bitstring;
                                                            {7456}new TTL_6109: bitstring;
                                                            {7457}let gNs_6110: bitstring = exp(g,Ns_6107) in
                                                            {7458}let m2_6111: bitstring = (OpenSecureChannelResponse,gNs_6110,ST_6108,TTL_6109) in
                                                            {7459}event beginSrv(Sess_5318,Cli_5316,gNs_6110);
                                                            {7460}out(c, m2_6111);
                                                            {7461}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {7462}event endSrv(Cli_5316,Sess_5318,PartC_6106)
                                                )
                                                else
                                                    {7463}let pkDisco_6112: bitstring = fail-any in
                                                    {7464}in(c, (=pkCli_6063,em1_6113: bitstring));
                                                    {7465}let m1_6114: bitstring = em1_6113 in
                                                    {7466}let (=OpenSecureChannelRequest,=pkCli_6063,PartC_6115: bitstring) = m1_6114 in
                                                    {7467}new Ns_6116: bitstring;
                                                    {7468}new ST_6117: bitstring;
                                                    {7469}new TTL_6118: bitstring;
                                                    {7470}let gNs_6119: bitstring = exp(g,Ns_6116) in
                                                    {7471}let m2_6120: bitstring = (OpenSecureChannelResponse,gNs_6119,ST_6117,TTL_6118) in
                                                    {7472}event beginSrv(Sess_5318,Cli_5316,gNs_6119);
                                                    {7473}out(c, m2_6120);
                                                    {7474}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7475}event endSrv(Cli_5316,Sess_5318,PartC_6115)
                                        )
                                        else
                                            {7476}let pkDisco_6121: bitstring = fail-any in
                                            {7477}in(c, (=pkCli_6063,em1_6122: bitstring));
                                            {7478}let m1_6123: bitstring = em1_6122 in
                                            {7479}let (=OpenSecureChannelRequest,=pkCli_6063,PartC_6124: bitstring) = m1_6123 in
                                            {7480}new Ns_6125: bitstring;
                                            {7481}new ST_6126: bitstring;
                                            {7482}new TTL_6127: bitstring;
                                            {7483}let gNs_6128: bitstring = exp(g,Ns_6125) in
                                            {7484}let m2_6129: bitstring = (OpenSecureChannelResponse,gNs_6128,ST_6126,TTL_6127) in
                                            {7485}event beginSrv(Sess_5318,Cli_5316,gNs_6128);
                                            {7486}out(c, m2_6129);
                                            {7487}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {7488}event endSrv(Cli_5316,Sess_5318,PartC_6124)
                            )
                            else
                                {7489}let pkCli_6130: bitstring = fail-any in
                                {7490}let v_6131: bool = (Disco_5317 = A) in
                                (
                                    {7491}if v_6131 then
                                    (
                                        {7492}let pkDisco_6132: bitstring = pub(skA) in
                                        {7493}in(c, (=pkCli_6130,em1_6133: bitstring));
                                        {7494}let m1_6134: bitstring = em1_6133 in
                                        {7495}let (=OpenSecureChannelRequest,=pkCli_6130,PartC_6135: bitstring) = m1_6134 in
                                        {7496}new Ns_6136: bitstring;
                                        {7497}new ST_6137: bitstring;
                                        {7498}new TTL_6138: bitstring;
                                        {7499}let gNs_6139: bitstring = exp(g,Ns_6136) in
                                        {7500}let m2_6140: bitstring = (OpenSecureChannelResponse,gNs_6139,ST_6137,TTL_6138) in
                                        {7501}event beginSrv(Sess_5318,Cli_5316,gNs_6139);
                                        {7502}out(c, m2_6140);
                                        {7503}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {7504}event endSrv(Cli_5316,Sess_5318,PartC_6135)
                                    )
                                    else
                                        {7505}let v_6141: bool = (Disco_5317 = B) in
                                        (
                                            {7506}if v_6141 then
                                            (
                                                {7507}let pkDisco_6142: bitstring = pub(skB) in
                                                {7508}in(c, (=pkCli_6130,em1_6143: bitstring));
                                                {7509}let m1_6144: bitstring = em1_6143 in
                                                {7510}let (=OpenSecureChannelRequest,=pkCli_6130,PartC_6145: bitstring) = m1_6144 in
                                                {7511}new Ns_6146: bitstring;
                                                {7512}new ST_6147: bitstring;
                                                {7513}new TTL_6148: bitstring;
                                                {7514}let gNs_6149: bitstring = exp(g,Ns_6146) in
                                                {7515}let m2_6150: bitstring = (OpenSecureChannelResponse,gNs_6149,ST_6147,TTL_6148) in
                                                {7516}event beginSrv(Sess_5318,Cli_5316,gNs_6149);
                                                {7517}out(c, m2_6150);
                                                {7518}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7519}event endSrv(Cli_5316,Sess_5318,PartC_6145)
                                            )
                                            else
                                                {7520}let v_6151: bool = (Disco_5317 = C) in
                                                (
                                                    {7521}if v_6151 then
                                                    (
                                                        {7522}let pkDisco_6152: bitstring = pub(skC) in
                                                        {7523}in(c, (=pkCli_6130,em1_6153: bitstring));
                                                        {7524}let m1_6154: bitstring = em1_6153 in
                                                        {7525}let (=OpenSecureChannelRequest,=pkCli_6130,PartC_6155: bitstring) = m1_6154 in
                                                        {7526}new Ns_6156: bitstring;
                                                        {7527}new ST_6157: bitstring;
                                                        {7528}new TTL_6158: bitstring;
                                                        {7529}let gNs_6159: bitstring = exp(g,Ns_6156) in
                                                        {7530}let m2_6160: bitstring = (OpenSecureChannelResponse,gNs_6159,ST_6157,TTL_6158) in
                                                        {7531}event beginSrv(Sess_5318,Cli_5316,gNs_6159);
                                                        {7532}out(c, m2_6160);
                                                        {7533}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7534}event endSrv(Cli_5316,Sess_5318,PartC_6155)
                                                    )
                                                    else
                                                        {7535}let pkDisco_6161: bitstring = pub(sk(Disco_5317)) in
                                                        {7536}in(c, (=pkCli_6130,em1_6162: bitstring));
                                                        {7537}let m1_6163: bitstring = em1_6162 in
                                                        {7538}let (=OpenSecureChannelRequest,=pkCli_6130,PartC_6164: bitstring) = m1_6163 in
                                                        {7539}new Ns_6165: bitstring;
                                                        {7540}new ST_6166: bitstring;
                                                        {7541}new TTL_6167: bitstring;
                                                        {7542}let gNs_6168: bitstring = exp(g,Ns_6165) in
                                                        {7543}let m2_6169: bitstring = (OpenSecureChannelResponse,gNs_6168,ST_6166,TTL_6167) in
                                                        {7544}event beginSrv(Sess_5318,Cli_5316,gNs_6168);
                                                        {7545}out(c, m2_6169);
                                                        {7546}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7547}event endSrv(Cli_5316,Sess_5318,PartC_6164)
                                                )
                                                else
                                                    {7548}let pkDisco_6170: bitstring = fail-any in
                                                    {7549}in(c, (=pkCli_6130,em1_6171: bitstring));
                                                    {7550}let m1_6172: bitstring = em1_6171 in
                                                    {7551}let (=OpenSecureChannelRequest,=pkCli_6130,PartC_6173: bitstring) = m1_6172 in
                                                    {7552}new Ns_6174: bitstring;
                                                    {7553}new ST_6175: bitstring;
                                                    {7554}new TTL_6176: bitstring;
                                                    {7555}let gNs_6177: bitstring = exp(g,Ns_6174) in
                                                    {7556}let m2_6178: bitstring = (OpenSecureChannelResponse,gNs_6177,ST_6175,TTL_6176) in
                                                    {7557}event beginSrv(Sess_5318,Cli_5316,gNs_6177);
                                                    {7558}out(c, m2_6178);
                                                    {7559}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7560}event endSrv(Cli_5316,Sess_5318,PartC_6173)
                                        )
                                        else
                                            {7561}let pkDisco_6179: bitstring = fail-any in
                                            {7562}in(c, (=pkCli_6130,em1_6180: bitstring));
                                            {7563}let m1_6181: bitstring = em1_6180 in
                                            {7564}let (=OpenSecureChannelRequest,=pkCli_6130,PartC_6182: bitstring) = m1_6181 in
                                            {7565}new Ns_6183: bitstring;
                                            {7566}new ST_6184: bitstring;
                                            {7567}new TTL_6185: bitstring;
                                            {7568}let gNs_6186: bitstring = exp(g,Ns_6183) in
                                            {7569}let m2_6187: bitstring = (OpenSecureChannelResponse,gNs_6186,ST_6184,TTL_6185) in
                                            {7570}event beginSrv(Sess_5318,Cli_5316,gNs_6186);
                                            {7571}out(c, m2_6187);
                                            {7572}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {7573}event endSrv(Cli_5316,Sess_5318,PartC_6182)
                                )
                                else
                                    {7574}let pkDisco_6188: bitstring = fail-any in
                                    {7575}in(c, (=pkCli_6130,em1_6189: bitstring));
                                    {7576}let m1_6190: bitstring = em1_6189 in
                                    {7577}let (=OpenSecureChannelRequest,=pkCli_6130,PartC_6191: bitstring) = m1_6190 in
                                    {7578}new Ns_6192: bitstring;
                                    {7579}new ST_6193: bitstring;
                                    {7580}new TTL_6194: bitstring;
                                    {7581}let gNs_6195: bitstring = exp(g,Ns_6192) in
                                    {7582}let m2_6196: bitstring = (OpenSecureChannelResponse,gNs_6195,ST_6193,TTL_6194) in
                                    {7583}event beginSrv(Sess_5318,Cli_5316,gNs_6195);
                                    {7584}out(c, m2_6196);
                                    {7585}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {7586}event endSrv(Cli_5316,Sess_5318,PartC_6191)
                    )
                    else
                        {7587}let pkCli_6197: bitstring = fail-any in
                        {7588}let v_6198: bool = (Disco_5317 = A) in
                        (
                            {7589}if v_6198 then
                            (
                                {7590}let pkDisco_6199: bitstring = pub(skA) in
                                {7591}in(c, (=pkCli_6197,em1_6200: bitstring));
                                {7592}let m1_6201: bitstring = em1_6200 in
                                {7593}let (=OpenSecureChannelRequest,=pkCli_6197,PartC_6202: bitstring) = m1_6201 in
                                {7594}new Ns_6203: bitstring;
                                {7595}new ST_6204: bitstring;
                                {7596}new TTL_6205: bitstring;
                                {7597}let gNs_6206: bitstring = exp(g,Ns_6203) in
                                {7598}let m2_6207: bitstring = (OpenSecureChannelResponse,gNs_6206,ST_6204,TTL_6205) in
                                {7599}event beginSrv(Sess_5318,Cli_5316,gNs_6206);
                                {7600}out(c, m2_6207);
                                {7601}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {7602}event endSrv(Cli_5316,Sess_5318,PartC_6202)
                            )
                            else
                                {7603}let v_6208: bool = (Disco_5317 = B) in
                                (
                                    {7604}if v_6208 then
                                    (
                                        {7605}let pkDisco_6209: bitstring = pub(skB) in
                                        {7606}in(c, (=pkCli_6197,em1_6210: bitstring));
                                        {7607}let m1_6211: bitstring = em1_6210 in
                                        {7608}let (=OpenSecureChannelRequest,=pkCli_6197,PartC_6212: bitstring) = m1_6211 in
                                        {7609}new Ns_6213: bitstring;
                                        {7610}new ST_6214: bitstring;
                                        {7611}new TTL_6215: bitstring;
                                        {7612}let gNs_6216: bitstring = exp(g,Ns_6213) in
                                        {7613}let m2_6217: bitstring = (OpenSecureChannelResponse,gNs_6216,ST_6214,TTL_6215) in
                                        {7614}event beginSrv(Sess_5318,Cli_5316,gNs_6216);
                                        {7615}out(c, m2_6217);
                                        {7616}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {7617}event endSrv(Cli_5316,Sess_5318,PartC_6212)
                                    )
                                    else
                                        {7618}let v_6218: bool = (Disco_5317 = C) in
                                        (
                                            {7619}if v_6218 then
                                            (
                                                {7620}let pkDisco_6219: bitstring = pub(skC) in
                                                {7621}in(c, (=pkCli_6197,em1_6220: bitstring));
                                                {7622}let m1_6221: bitstring = em1_6220 in
                                                {7623}let (=OpenSecureChannelRequest,=pkCli_6197,PartC_6222: bitstring) = m1_6221 in
                                                {7624}new Ns_6223: bitstring;
                                                {7625}new ST_6224: bitstring;
                                                {7626}new TTL_6225: bitstring;
                                                {7627}let gNs_6226: bitstring = exp(g,Ns_6223) in
                                                {7628}let m2_6227: bitstring = (OpenSecureChannelResponse,gNs_6226,ST_6224,TTL_6225) in
                                                {7629}event beginSrv(Sess_5318,Cli_5316,gNs_6226);
                                                {7630}out(c, m2_6227);
                                                {7631}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7632}event endSrv(Cli_5316,Sess_5318,PartC_6222)
                                            )
                                            else
                                                {7633}let pkDisco_6228: bitstring = pub(sk(Disco_5317)) in
                                                {7634}in(c, (=pkCli_6197,em1_6229: bitstring));
                                                {7635}let m1_6230: bitstring = em1_6229 in
                                                {7636}let (=OpenSecureChannelRequest,=pkCli_6197,PartC_6231: bitstring) = m1_6230 in
                                                {7637}new Ns_6232: bitstring;
                                                {7638}new ST_6233: bitstring;
                                                {7639}new TTL_6234: bitstring;
                                                {7640}let gNs_6235: bitstring = exp(g,Ns_6232) in
                                                {7641}let m2_6236: bitstring = (OpenSecureChannelResponse,gNs_6235,ST_6233,TTL_6234) in
                                                {7642}event beginSrv(Sess_5318,Cli_5316,gNs_6235);
                                                {7643}out(c, m2_6236);
                                                {7644}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7645}event endSrv(Cli_5316,Sess_5318,PartC_6231)
                                        )
                                        else
                                            {7646}let pkDisco_6237: bitstring = fail-any in
                                            {7647}in(c, (=pkCli_6197,em1_6238: bitstring));
                                            {7648}let m1_6239: bitstring = em1_6238 in
                                            {7649}let (=OpenSecureChannelRequest,=pkCli_6197,PartC_6240: bitstring) = m1_6239 in
                                            {7650}new Ns_6241: bitstring;
                                            {7651}new ST_6242: bitstring;
                                            {7652}new TTL_6243: bitstring;
                                            {7653}let gNs_6244: bitstring = exp(g,Ns_6241) in
                                            {7654}let m2_6245: bitstring = (OpenSecureChannelResponse,gNs_6244,ST_6242,TTL_6243) in
                                            {7655}event beginSrv(Sess_5318,Cli_5316,gNs_6244);
                                            {7656}out(c, m2_6245);
                                            {7657}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {7658}event endSrv(Cli_5316,Sess_5318,PartC_6240)
                                )
                                else
                                    {7659}let pkDisco_6246: bitstring = fail-any in
                                    {7660}in(c, (=pkCli_6197,em1_6247: bitstring));
                                    {7661}let m1_6248: bitstring = em1_6247 in
                                    {7662}let (=OpenSecureChannelRequest,=pkCli_6197,PartC_6249: bitstring) = m1_6248 in
                                    {7663}new Ns_6250: bitstring;
                                    {7664}new ST_6251: bitstring;
                                    {7665}new TTL_6252: bitstring;
                                    {7666}let gNs_6253: bitstring = exp(g,Ns_6250) in
                                    {7667}let m2_6254: bitstring = (OpenSecureChannelResponse,gNs_6253,ST_6251,TTL_6252) in
                                    {7668}event beginSrv(Sess_5318,Cli_5316,gNs_6253);
                                    {7669}out(c, m2_6254);
                                    {7670}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {7671}event endSrv(Cli_5316,Sess_5318,PartC_6249)
                        )
                        else
                            {7672}let pkDisco_6255: bitstring = fail-any in
                            {7673}in(c, (=pkCli_6197,em1_6256: bitstring));
                            {7674}let m1_6257: bitstring = em1_6256 in
                            {7675}let (=OpenSecureChannelRequest,=pkCli_6197,PartC_6258: bitstring) = m1_6257 in
                            {7676}new Ns_6259: bitstring;
                            {7677}new ST_6260: bitstring;
                            {7678}new TTL_6261: bitstring;
                            {7679}let gNs_6262: bitstring = exp(g,Ns_6259) in
                            {7680}let m2_6263: bitstring = (OpenSecureChannelResponse,gNs_6262,ST_6260,TTL_6261) in
                            {7681}event beginSrv(Sess_5318,Cli_5316,gNs_6262);
                            {7682}out(c, m2_6263);
                            {7683}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {7684}event endSrv(Cli_5316,Sess_5318,PartC_6258)
                )
                else
                    {7685}let =true = (Sess_5318 = C) in
                    (
                        {7686}let skSess_6264: bitstring = skC in
                        {7687}let pkSess_6265: bitstring = pub(skSess_6264) in
                        {7688}let v_6266: bool = (Cli_5316 = A) in
                        (
                            {7689}if v_6266 then
                            (
                                {7690}let pkCli_6267: bitstring = pub(skA) in
                                {7691}let v_6268: bool = (Disco_5317 = A) in
                                (
                                    {7692}if v_6268 then
                                    (
                                        {7693}let pkDisco_6269: bitstring = pub(skA) in
                                        {7694}in(c, (=pkCli_6267,em1_6270: bitstring));
                                        {7695}let m1_6271: bitstring = em1_6270 in
                                        {7696}let (=OpenSecureChannelRequest,=pkCli_6267,PartC_6272: bitstring) = m1_6271 in
                                        {7697}new Ns_6273: bitstring;
                                        {7698}new ST_6274: bitstring;
                                        {7699}new TTL_6275: bitstring;
                                        {7700}let gNs_6276: bitstring = exp(g,Ns_6273) in
                                        {7701}let m2_6277: bitstring = (OpenSecureChannelResponse,gNs_6276,ST_6274,TTL_6275) in
                                        {7702}event beginSrv(Sess_5318,Cli_5316,gNs_6276);
                                        {7703}out(c, m2_6277);
                                        {7704}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {7705}event endSrv(Cli_5316,Sess_5318,PartC_6272)
                                    )
                                    else
                                        {7706}let v_6278: bool = (Disco_5317 = B) in
                                        (
                                            {7707}if v_6278 then
                                            (
                                                {7708}let pkDisco_6279: bitstring = pub(skB) in
                                                {7709}in(c, (=pkCli_6267,em1_6280: bitstring));
                                                {7710}let m1_6281: bitstring = em1_6280 in
                                                {7711}let (=OpenSecureChannelRequest,=pkCli_6267,PartC_6282: bitstring) = m1_6281 in
                                                {7712}new Ns_6283: bitstring;
                                                {7713}new ST_6284: bitstring;
                                                {7714}new TTL_6285: bitstring;
                                                {7715}let gNs_6286: bitstring = exp(g,Ns_6283) in
                                                {7716}let m2_6287: bitstring = (OpenSecureChannelResponse,gNs_6286,ST_6284,TTL_6285) in
                                                {7717}event beginSrv(Sess_5318,Cli_5316,gNs_6286);
                                                {7718}out(c, m2_6287);
                                                {7719}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7720}event endSrv(Cli_5316,Sess_5318,PartC_6282)
                                            )
                                            else
                                                {7721}let v_6288: bool = (Disco_5317 = C) in
                                                (
                                                    {7722}if v_6288 then
                                                    (
                                                        {7723}let pkDisco_6289: bitstring = pub(skC) in
                                                        {7724}in(c, (=pkCli_6267,em1_6290: bitstring));
                                                        {7725}let m1_6291: bitstring = em1_6290 in
                                                        {7726}let (=OpenSecureChannelRequest,=pkCli_6267,PartC_6292: bitstring) = m1_6291 in
                                                        {7727}new Ns_6293: bitstring;
                                                        {7728}new ST_6294: bitstring;
                                                        {7729}new TTL_6295: bitstring;
                                                        {7730}let gNs_6296: bitstring = exp(g,Ns_6293) in
                                                        {7731}let m2_6297: bitstring = (OpenSecureChannelResponse,gNs_6296,ST_6294,TTL_6295) in
                                                        {7732}event beginSrv(Sess_5318,Cli_5316,gNs_6296);
                                                        {7733}out(c, m2_6297);
                                                        {7734}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7735}event endSrv(Cli_5316,Sess_5318,PartC_6292)
                                                    )
                                                    else
                                                        {7736}let pkDisco_6298: bitstring = pub(sk(Disco_5317)) in
                                                        {7737}in(c, (=pkCli_6267,em1_6299: bitstring));
                                                        {7738}let m1_6300: bitstring = em1_6299 in
                                                        {7739}let (=OpenSecureChannelRequest,=pkCli_6267,PartC_6301: bitstring) = m1_6300 in
                                                        {7740}new Ns_6302: bitstring;
                                                        {7741}new ST_6303: bitstring;
                                                        {7742}new TTL_6304: bitstring;
                                                        {7743}let gNs_6305: bitstring = exp(g,Ns_6302) in
                                                        {7744}let m2_6306: bitstring = (OpenSecureChannelResponse,gNs_6305,ST_6303,TTL_6304) in
                                                        {7745}event beginSrv(Sess_5318,Cli_5316,gNs_6305);
                                                        {7746}out(c, m2_6306);
                                                        {7747}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7748}event endSrv(Cli_5316,Sess_5318,PartC_6301)
                                                )
                                                else
                                                    {7749}let pkDisco_6307: bitstring = fail-any in
                                                    {7750}in(c, (=pkCli_6267,em1_6308: bitstring));
                                                    {7751}let m1_6309: bitstring = em1_6308 in
                                                    {7752}let (=OpenSecureChannelRequest,=pkCli_6267,PartC_6310: bitstring) = m1_6309 in
                                                    {7753}new Ns_6311: bitstring;
                                                    {7754}new ST_6312: bitstring;
                                                    {7755}new TTL_6313: bitstring;
                                                    {7756}let gNs_6314: bitstring = exp(g,Ns_6311) in
                                                    {7757}let m2_6315: bitstring = (OpenSecureChannelResponse,gNs_6314,ST_6312,TTL_6313) in
                                                    {7758}event beginSrv(Sess_5318,Cli_5316,gNs_6314);
                                                    {7759}out(c, m2_6315);
                                                    {7760}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7761}event endSrv(Cli_5316,Sess_5318,PartC_6310)
                                        )
                                        else
                                            {7762}let pkDisco_6316: bitstring = fail-any in
                                            {7763}in(c, (=pkCli_6267,em1_6317: bitstring));
                                            {7764}let m1_6318: bitstring = em1_6317 in
                                            {7765}let (=OpenSecureChannelRequest,=pkCli_6267,PartC_6319: bitstring) = m1_6318 in
                                            {7766}new Ns_6320: bitstring;
                                            {7767}new ST_6321: bitstring;
                                            {7768}new TTL_6322: bitstring;
                                            {7769}let gNs_6323: bitstring = exp(g,Ns_6320) in
                                            {7770}let m2_6324: bitstring = (OpenSecureChannelResponse,gNs_6323,ST_6321,TTL_6322) in
                                            {7771}event beginSrv(Sess_5318,Cli_5316,gNs_6323);
                                            {7772}out(c, m2_6324);
                                            {7773}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {7774}event endSrv(Cli_5316,Sess_5318,PartC_6319)
                                )
                                else
                                    {7775}let pkDisco_6325: bitstring = fail-any in
                                    {7776}in(c, (=pkCli_6267,em1_6326: bitstring));
                                    {7777}let m1_6327: bitstring = em1_6326 in
                                    {7778}let (=OpenSecureChannelRequest,=pkCli_6267,PartC_6328: bitstring) = m1_6327 in
                                    {7779}new Ns_6329: bitstring;
                                    {7780}new ST_6330: bitstring;
                                    {7781}new TTL_6331: bitstring;
                                    {7782}let gNs_6332: bitstring = exp(g,Ns_6329) in
                                    {7783}let m2_6333: bitstring = (OpenSecureChannelResponse,gNs_6332,ST_6330,TTL_6331) in
                                    {7784}event beginSrv(Sess_5318,Cli_5316,gNs_6332);
                                    {7785}out(c, m2_6333);
                                    {7786}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {7787}event endSrv(Cli_5316,Sess_5318,PartC_6328)
                            )
                            else
                                {7788}let v_6334: bool = (Cli_5316 = B) in
                                (
                                    {7789}if v_6334 then
                                    (
                                        {7790}let pkCli_6335: bitstring = pub(skB) in
                                        {7791}let v_6336: bool = (Disco_5317 = A) in
                                        (
                                            {7792}if v_6336 then
                                            (
                                                {7793}let pkDisco_6337: bitstring = pub(skA) in
                                                {7794}in(c, (=pkCli_6335,em1_6338: bitstring));
                                                {7795}let m1_6339: bitstring = em1_6338 in
                                                {7796}let (=OpenSecureChannelRequest,=pkCli_6335,PartC_6340: bitstring) = m1_6339 in
                                                {7797}new Ns_6341: bitstring;
                                                {7798}new ST_6342: bitstring;
                                                {7799}new TTL_6343: bitstring;
                                                {7800}let gNs_6344: bitstring = exp(g,Ns_6341) in
                                                {7801}let m2_6345: bitstring = (OpenSecureChannelResponse,gNs_6344,ST_6342,TTL_6343) in
                                                {7802}event beginSrv(Sess_5318,Cli_5316,gNs_6344);
                                                {7803}out(c, m2_6345);
                                                {7804}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {7805}event endSrv(Cli_5316,Sess_5318,PartC_6340)
                                            )
                                            else
                                                {7806}let v_6346: bool = (Disco_5317 = B) in
                                                (
                                                    {7807}if v_6346 then
                                                    (
                                                        {7808}let pkDisco_6347: bitstring = pub(skB) in
                                                        {7809}in(c, (=pkCli_6335,em1_6348: bitstring));
                                                        {7810}let m1_6349: bitstring = em1_6348 in
                                                        {7811}let (=OpenSecureChannelRequest,=pkCli_6335,PartC_6350: bitstring) = m1_6349 in
                                                        {7812}new Ns_6351: bitstring;
                                                        {7813}new ST_6352: bitstring;
                                                        {7814}new TTL_6353: bitstring;
                                                        {7815}let gNs_6354: bitstring = exp(g,Ns_6351) in
                                                        {7816}let m2_6355: bitstring = (OpenSecureChannelResponse,gNs_6354,ST_6352,TTL_6353) in
                                                        {7817}event beginSrv(Sess_5318,Cli_5316,gNs_6354);
                                                        {7818}out(c, m2_6355);
                                                        {7819}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7820}event endSrv(Cli_5316,Sess_5318,PartC_6350)
                                                    )
                                                    else
                                                        {7821}let v_6356: bool = (Disco_5317 = C) in
                                                        (
                                                            {7822}if v_6356 then
                                                            (
                                                                {7823}let pkDisco_6357: bitstring = pub(skC) in
                                                                {7824}in(c, (=pkCli_6335,em1_6358: bitstring));
                                                                {7825}let m1_6359: bitstring = em1_6358 in
                                                                {7826}let (=OpenSecureChannelRequest,=pkCli_6335,PartC_6360: bitstring) = m1_6359 in
                                                                {7827}new Ns_6361: bitstring;
                                                                {7828}new ST_6362: bitstring;
                                                                {7829}new TTL_6363: bitstring;
                                                                {7830}let gNs_6364: bitstring = exp(g,Ns_6361) in
                                                                {7831}let m2_6365: bitstring = (OpenSecureChannelResponse,gNs_6364,ST_6362,TTL_6363) in
                                                                {7832}event beginSrv(Sess_5318,Cli_5316,gNs_6364);
                                                                {7833}out(c, m2_6365);
                                                                {7834}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {7835}event endSrv(Cli_5316,Sess_5318,PartC_6360)
                                                            )
                                                            else
                                                                {7836}let pkDisco_6366: bitstring = pub(sk(Disco_5317)) in
                                                                {7837}in(c, (=pkCli_6335,em1_6367: bitstring));
                                                                {7838}let m1_6368: bitstring = em1_6367 in
                                                                {7839}let (=OpenSecureChannelRequest,=pkCli_6335,PartC_6369: bitstring) = m1_6368 in
                                                                {7840}new Ns_6370: bitstring;
                                                                {7841}new ST_6371: bitstring;
                                                                {7842}new TTL_6372: bitstring;
                                                                {7843}let gNs_6373: bitstring = exp(g,Ns_6370) in
                                                                {7844}let m2_6374: bitstring = (OpenSecureChannelResponse,gNs_6373,ST_6371,TTL_6372) in
                                                                {7845}event beginSrv(Sess_5318,Cli_5316,gNs_6373);
                                                                {7846}out(c, m2_6374);
                                                                {7847}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {7848}event endSrv(Cli_5316,Sess_5318,PartC_6369)
                                                        )
                                                        else
                                                            {7849}let pkDisco_6375: bitstring = fail-any in
                                                            {7850}in(c, (=pkCli_6335,em1_6376: bitstring));
                                                            {7851}let m1_6377: bitstring = em1_6376 in
                                                            {7852}let (=OpenSecureChannelRequest,=pkCli_6335,PartC_6378: bitstring) = m1_6377 in
                                                            {7853}new Ns_6379: bitstring;
                                                            {7854}new ST_6380: bitstring;
                                                            {7855}new TTL_6381: bitstring;
                                                            {7856}let gNs_6382: bitstring = exp(g,Ns_6379) in
                                                            {7857}let m2_6383: bitstring = (OpenSecureChannelResponse,gNs_6382,ST_6380,TTL_6381) in
                                                            {7858}event beginSrv(Sess_5318,Cli_5316,gNs_6382);
                                                            {7859}out(c, m2_6383);
                                                            {7860}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {7861}event endSrv(Cli_5316,Sess_5318,PartC_6378)
                                                )
                                                else
                                                    {7862}let pkDisco_6384: bitstring = fail-any in
                                                    {7863}in(c, (=pkCli_6335,em1_6385: bitstring));
                                                    {7864}let m1_6386: bitstring = em1_6385 in
                                                    {7865}let (=OpenSecureChannelRequest,=pkCli_6335,PartC_6387: bitstring) = m1_6386 in
                                                    {7866}new Ns_6388: bitstring;
                                                    {7867}new ST_6389: bitstring;
                                                    {7868}new TTL_6390: bitstring;
                                                    {7869}let gNs_6391: bitstring = exp(g,Ns_6388) in
                                                    {7870}let m2_6392: bitstring = (OpenSecureChannelResponse,gNs_6391,ST_6389,TTL_6390) in
                                                    {7871}event beginSrv(Sess_5318,Cli_5316,gNs_6391);
                                                    {7872}out(c, m2_6392);
                                                    {7873}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7874}event endSrv(Cli_5316,Sess_5318,PartC_6387)
                                        )
                                        else
                                            {7875}let pkDisco_6393: bitstring = fail-any in
                                            {7876}in(c, (=pkCli_6335,em1_6394: bitstring));
                                            {7877}let m1_6395: bitstring = em1_6394 in
                                            {7878}let (=OpenSecureChannelRequest,=pkCli_6335,PartC_6396: bitstring) = m1_6395 in
                                            {7879}new Ns_6397: bitstring;
                                            {7880}new ST_6398: bitstring;
                                            {7881}new TTL_6399: bitstring;
                                            {7882}let gNs_6400: bitstring = exp(g,Ns_6397) in
                                            {7883}let m2_6401: bitstring = (OpenSecureChannelResponse,gNs_6400,ST_6398,TTL_6399) in
                                            {7884}event beginSrv(Sess_5318,Cli_5316,gNs_6400);
                                            {7885}out(c, m2_6401);
                                            {7886}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {7887}event endSrv(Cli_5316,Sess_5318,PartC_6396)
                                    )
                                    else
                                        {7888}let v_6402: bool = (Cli_5316 = C) in
                                        (
                                            {7889}if v_6402 then
                                            (
                                                {7890}let pkCli_6403: bitstring = pub(skC) in
                                                {7891}let v_6404: bool = (Disco_5317 = A) in
                                                (
                                                    {7892}if v_6404 then
                                                    (
                                                        {7893}let pkDisco_6405: bitstring = pub(skA) in
                                                        {7894}in(c, (=pkCli_6403,em1_6406: bitstring));
                                                        {7895}let m1_6407: bitstring = em1_6406 in
                                                        {7896}let (=OpenSecureChannelRequest,=pkCli_6403,PartC_6408: bitstring) = m1_6407 in
                                                        {7897}new Ns_6409: bitstring;
                                                        {7898}new ST_6410: bitstring;
                                                        {7899}new TTL_6411: bitstring;
                                                        {7900}let gNs_6412: bitstring = exp(g,Ns_6409) in
                                                        {7901}let m2_6413: bitstring = (OpenSecureChannelResponse,gNs_6412,ST_6410,TTL_6411) in
                                                        {7902}event beginSrv(Sess_5318,Cli_5316,gNs_6412);
                                                        {7903}out(c, m2_6413);
                                                        {7904}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {7905}event endSrv(Cli_5316,Sess_5318,PartC_6408)
                                                    )
                                                    else
                                                        {7906}let v_6414: bool = (Disco_5317 = B) in
                                                        (
                                                            {7907}if v_6414 then
                                                            (
                                                                {7908}let pkDisco_6415: bitstring = pub(skB) in
                                                                {7909}in(c, (=pkCli_6403,em1_6416: bitstring));
                                                                {7910}let m1_6417: bitstring = em1_6416 in
                                                                {7911}let (=OpenSecureChannelRequest,=pkCli_6403,PartC_6418: bitstring) = m1_6417 in
                                                                {7912}new Ns_6419: bitstring;
                                                                {7913}new ST_6420: bitstring;
                                                                {7914}new TTL_6421: bitstring;
                                                                {7915}let gNs_6422: bitstring = exp(g,Ns_6419) in
                                                                {7916}let m2_6423: bitstring = (OpenSecureChannelResponse,gNs_6422,ST_6420,TTL_6421) in
                                                                {7917}event beginSrv(Sess_5318,Cli_5316,gNs_6422);
                                                                {7918}out(c, m2_6423);
                                                                {7919}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {7920}event endSrv(Cli_5316,Sess_5318,PartC_6418)
                                                            )
                                                            else
                                                                {7921}let v_6424: bool = (Disco_5317 = C) in
                                                                (
                                                                    {7922}if v_6424 then
                                                                    (
                                                                        {7923}let pkDisco_6425: bitstring = pub(skC) in
                                                                        {7924}in(c, (=pkCli_6403,em1_6426: bitstring));
                                                                        {7925}let m1_6427: bitstring = em1_6426 in
                                                                        {7926}let (=OpenSecureChannelRequest,=pkCli_6403,PartC_6428: bitstring) = m1_6427 in
                                                                        {7927}new Ns_6429: bitstring;
                                                                        {7928}new ST_6430: bitstring;
                                                                        {7929}new TTL_6431: bitstring;
                                                                        {7930}let gNs_6432: bitstring = exp(g,Ns_6429) in
                                                                        {7931}let m2_6433: bitstring = (OpenSecureChannelResponse,gNs_6432,ST_6430,TTL_6431) in
                                                                        {7932}event beginSrv(Sess_5318,Cli_5316,gNs_6432);
                                                                        {7933}out(c, m2_6433);
                                                                        {7934}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {7935}event endSrv(Cli_5316,Sess_5318,PartC_6428)
                                                                    )
                                                                    else
                                                                        {7936}let pkDisco_6434: bitstring = pub(sk(Disco_5317)) in
                                                                        {7937}in(c, (=pkCli_6403,em1_6435: bitstring));
                                                                        {7938}let m1_6436: bitstring = em1_6435 in
                                                                        {7939}let (=OpenSecureChannelRequest,=pkCli_6403,PartC_6437: bitstring) = m1_6436 in
                                                                        {7940}new Ns_6438: bitstring;
                                                                        {7941}new ST_6439: bitstring;
                                                                        {7942}new TTL_6440: bitstring;
                                                                        {7943}let gNs_6441: bitstring = exp(g,Ns_6438) in
                                                                        {7944}let m2_6442: bitstring = (OpenSecureChannelResponse,gNs_6441,ST_6439,TTL_6440) in
                                                                        {7945}event beginSrv(Sess_5318,Cli_5316,gNs_6441);
                                                                        {7946}out(c, m2_6442);
                                                                        {7947}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {7948}event endSrv(Cli_5316,Sess_5318,PartC_6437)
                                                                )
                                                                else
                                                                    {7949}let pkDisco_6443: bitstring = fail-any in
                                                                    {7950}in(c, (=pkCli_6403,em1_6444: bitstring));
                                                                    {7951}let m1_6445: bitstring = em1_6444 in
                                                                    {7952}let (=OpenSecureChannelRequest,=pkCli_6403,PartC_6446: bitstring) = m1_6445 in
                                                                    {7953}new Ns_6447: bitstring;
                                                                    {7954}new ST_6448: bitstring;
                                                                    {7955}new TTL_6449: bitstring;
                                                                    {7956}let gNs_6450: bitstring = exp(g,Ns_6447) in
                                                                    {7957}let m2_6451: bitstring = (OpenSecureChannelResponse,gNs_6450,ST_6448,TTL_6449) in
                                                                    {7958}event beginSrv(Sess_5318,Cli_5316,gNs_6450);
                                                                    {7959}out(c, m2_6451);
                                                                    {7960}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {7961}event endSrv(Cli_5316,Sess_5318,PartC_6446)
                                                        )
                                                        else
                                                            {7962}let pkDisco_6452: bitstring = fail-any in
                                                            {7963}in(c, (=pkCli_6403,em1_6453: bitstring));
                                                            {7964}let m1_6454: bitstring = em1_6453 in
                                                            {7965}let (=OpenSecureChannelRequest,=pkCli_6403,PartC_6455: bitstring) = m1_6454 in
                                                            {7966}new Ns_6456: bitstring;
                                                            {7967}new ST_6457: bitstring;
                                                            {7968}new TTL_6458: bitstring;
                                                            {7969}let gNs_6459: bitstring = exp(g,Ns_6456) in
                                                            {7970}let m2_6460: bitstring = (OpenSecureChannelResponse,gNs_6459,ST_6457,TTL_6458) in
                                                            {7971}event beginSrv(Sess_5318,Cli_5316,gNs_6459);
                                                            {7972}out(c, m2_6460);
                                                            {7973}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {7974}event endSrv(Cli_5316,Sess_5318,PartC_6455)
                                                )
                                                else
                                                    {7975}let pkDisco_6461: bitstring = fail-any in
                                                    {7976}in(c, (=pkCli_6403,em1_6462: bitstring));
                                                    {7977}let m1_6463: bitstring = em1_6462 in
                                                    {7978}let (=OpenSecureChannelRequest,=pkCli_6403,PartC_6464: bitstring) = m1_6463 in
                                                    {7979}new Ns_6465: bitstring;
                                                    {7980}new ST_6466: bitstring;
                                                    {7981}new TTL_6467: bitstring;
                                                    {7982}let gNs_6468: bitstring = exp(g,Ns_6465) in
                                                    {7983}let m2_6469: bitstring = (OpenSecureChannelResponse,gNs_6468,ST_6466,TTL_6467) in
                                                    {7984}event beginSrv(Sess_5318,Cli_5316,gNs_6468);
                                                    {7985}out(c, m2_6469);
                                                    {7986}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {7987}event endSrv(Cli_5316,Sess_5318,PartC_6464)
                                            )
                                            else
                                                {7988}let pkCli_6470: bitstring = pub(sk(Cli_5316)) in
                                                {7989}let v_6471: bool = (Disco_5317 = A) in
                                                (
                                                    {7990}if v_6471 then
                                                    (
                                                        {7991}let pkDisco_6472: bitstring = pub(skA) in
                                                        {7992}in(c, (=pkCli_6470,em1_6473: bitstring));
                                                        {7993}let m1_6474: bitstring = em1_6473 in
                                                        {7994}let (=OpenSecureChannelRequest,=pkCli_6470,PartC_6475: bitstring) = m1_6474 in
                                                        {7995}new Ns_6476: bitstring;
                                                        {7996}new ST_6477: bitstring;
                                                        {7997}new TTL_6478: bitstring;
                                                        {7998}let gNs_6479: bitstring = exp(g,Ns_6476) in
                                                        {7999}let m2_6480: bitstring = (OpenSecureChannelResponse,gNs_6479,ST_6477,TTL_6478) in
                                                        {8000}event beginSrv(Sess_5318,Cli_5316,gNs_6479);
                                                        {8001}out(c, m2_6480);
                                                        {8002}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8003}event endSrv(Cli_5316,Sess_5318,PartC_6475)
                                                    )
                                                    else
                                                        {8004}let v_6481: bool = (Disco_5317 = B) in
                                                        (
                                                            {8005}if v_6481 then
                                                            (
                                                                {8006}let pkDisco_6482: bitstring = pub(skB) in
                                                                {8007}in(c, (=pkCli_6470,em1_6483: bitstring));
                                                                {8008}let m1_6484: bitstring = em1_6483 in
                                                                {8009}let (=OpenSecureChannelRequest,=pkCli_6470,PartC_6485: bitstring) = m1_6484 in
                                                                {8010}new Ns_6486: bitstring;
                                                                {8011}new ST_6487: bitstring;
                                                                {8012}new TTL_6488: bitstring;
                                                                {8013}let gNs_6489: bitstring = exp(g,Ns_6486) in
                                                                {8014}let m2_6490: bitstring = (OpenSecureChannelResponse,gNs_6489,ST_6487,TTL_6488) in
                                                                {8015}event beginSrv(Sess_5318,Cli_5316,gNs_6489);
                                                                {8016}out(c, m2_6490);
                                                                {8017}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {8018}event endSrv(Cli_5316,Sess_5318,PartC_6485)
                                                            )
                                                            else
                                                                {8019}let v_6491: bool = (Disco_5317 = C) in
                                                                (
                                                                    {8020}if v_6491 then
                                                                    (
                                                                        {8021}let pkDisco_6492: bitstring = pub(skC) in
                                                                        {8022}in(c, (=pkCli_6470,em1_6493: bitstring));
                                                                        {8023}let m1_6494: bitstring = em1_6493 in
                                                                        {8024}let (=OpenSecureChannelRequest,=pkCli_6470,PartC_6495: bitstring) = m1_6494 in
                                                                        {8025}new Ns_6496: bitstring;
                                                                        {8026}new ST_6497: bitstring;
                                                                        {8027}new TTL_6498: bitstring;
                                                                        {8028}let gNs_6499: bitstring = exp(g,Ns_6496) in
                                                                        {8029}let m2_6500: bitstring = (OpenSecureChannelResponse,gNs_6499,ST_6497,TTL_6498) in
                                                                        {8030}event beginSrv(Sess_5318,Cli_5316,gNs_6499);
                                                                        {8031}out(c, m2_6500);
                                                                        {8032}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {8033}event endSrv(Cli_5316,Sess_5318,PartC_6495)
                                                                    )
                                                                    else
                                                                        {8034}let pkDisco_6501: bitstring = pub(sk(Disco_5317)) in
                                                                        {8035}in(c, (=pkCli_6470,em1_6502: bitstring));
                                                                        {8036}let m1_6503: bitstring = em1_6502 in
                                                                        {8037}let (=OpenSecureChannelRequest,=pkCli_6470,PartC_6504: bitstring) = m1_6503 in
                                                                        {8038}new Ns_6505: bitstring;
                                                                        {8039}new ST_6506: bitstring;
                                                                        {8040}new TTL_6507: bitstring;
                                                                        {8041}let gNs_6508: bitstring = exp(g,Ns_6505) in
                                                                        {8042}let m2_6509: bitstring = (OpenSecureChannelResponse,gNs_6508,ST_6506,TTL_6507) in
                                                                        {8043}event beginSrv(Sess_5318,Cli_5316,gNs_6508);
                                                                        {8044}out(c, m2_6509);
                                                                        {8045}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {8046}event endSrv(Cli_5316,Sess_5318,PartC_6504)
                                                                )
                                                                else
                                                                    {8047}let pkDisco_6510: bitstring = fail-any in
                                                                    {8048}in(c, (=pkCli_6470,em1_6511: bitstring));
                                                                    {8049}let m1_6512: bitstring = em1_6511 in
                                                                    {8050}let (=OpenSecureChannelRequest,=pkCli_6470,PartC_6513: bitstring) = m1_6512 in
                                                                    {8051}new Ns_6514: bitstring;
                                                                    {8052}new ST_6515: bitstring;
                                                                    {8053}new TTL_6516: bitstring;
                                                                    {8054}let gNs_6517: bitstring = exp(g,Ns_6514) in
                                                                    {8055}let m2_6518: bitstring = (OpenSecureChannelResponse,gNs_6517,ST_6515,TTL_6516) in
                                                                    {8056}event beginSrv(Sess_5318,Cli_5316,gNs_6517);
                                                                    {8057}out(c, m2_6518);
                                                                    {8058}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {8059}event endSrv(Cli_5316,Sess_5318,PartC_6513)
                                                        )
                                                        else
                                                            {8060}let pkDisco_6519: bitstring = fail-any in
                                                            {8061}in(c, (=pkCli_6470,em1_6520: bitstring));
                                                            {8062}let m1_6521: bitstring = em1_6520 in
                                                            {8063}let (=OpenSecureChannelRequest,=pkCli_6470,PartC_6522: bitstring) = m1_6521 in
                                                            {8064}new Ns_6523: bitstring;
                                                            {8065}new ST_6524: bitstring;
                                                            {8066}new TTL_6525: bitstring;
                                                            {8067}let gNs_6526: bitstring = exp(g,Ns_6523) in
                                                            {8068}let m2_6527: bitstring = (OpenSecureChannelResponse,gNs_6526,ST_6524,TTL_6525) in
                                                            {8069}event beginSrv(Sess_5318,Cli_5316,gNs_6526);
                                                            {8070}out(c, m2_6527);
                                                            {8071}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8072}event endSrv(Cli_5316,Sess_5318,PartC_6522)
                                                )
                                                else
                                                    {8073}let pkDisco_6528: bitstring = fail-any in
                                                    {8074}in(c, (=pkCli_6470,em1_6529: bitstring));
                                                    {8075}let m1_6530: bitstring = em1_6529 in
                                                    {8076}let (=OpenSecureChannelRequest,=pkCli_6470,PartC_6531: bitstring) = m1_6530 in
                                                    {8077}new Ns_6532: bitstring;
                                                    {8078}new ST_6533: bitstring;
                                                    {8079}new TTL_6534: bitstring;
                                                    {8080}let gNs_6535: bitstring = exp(g,Ns_6532) in
                                                    {8081}let m2_6536: bitstring = (OpenSecureChannelResponse,gNs_6535,ST_6533,TTL_6534) in
                                                    {8082}event beginSrv(Sess_5318,Cli_5316,gNs_6535);
                                                    {8083}out(c, m2_6536);
                                                    {8084}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8085}event endSrv(Cli_5316,Sess_5318,PartC_6531)
                                        )
                                        else
                                            {8086}let pkCli_6537: bitstring = fail-any in
                                            {8087}let v_6538: bool = (Disco_5317 = A) in
                                            (
                                                {8088}if v_6538 then
                                                (
                                                    {8089}let pkDisco_6539: bitstring = pub(skA) in
                                                    {8090}in(c, (=pkCli_6537,em1_6540: bitstring));
                                                    {8091}let m1_6541: bitstring = em1_6540 in
                                                    {8092}let (=OpenSecureChannelRequest,=pkCli_6537,PartC_6542: bitstring) = m1_6541 in
                                                    {8093}new Ns_6543: bitstring;
                                                    {8094}new ST_6544: bitstring;
                                                    {8095}new TTL_6545: bitstring;
                                                    {8096}let gNs_6546: bitstring = exp(g,Ns_6543) in
                                                    {8097}let m2_6547: bitstring = (OpenSecureChannelResponse,gNs_6546,ST_6544,TTL_6545) in
                                                    {8098}event beginSrv(Sess_5318,Cli_5316,gNs_6546);
                                                    {8099}out(c, m2_6547);
                                                    {8100}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8101}event endSrv(Cli_5316,Sess_5318,PartC_6542)
                                                )
                                                else
                                                    {8102}let v_6548: bool = (Disco_5317 = B) in
                                                    (
                                                        {8103}if v_6548 then
                                                        (
                                                            {8104}let pkDisco_6549: bitstring = pub(skB) in
                                                            {8105}in(c, (=pkCli_6537,em1_6550: bitstring));
                                                            {8106}let m1_6551: bitstring = em1_6550 in
                                                            {8107}let (=OpenSecureChannelRequest,=pkCli_6537,PartC_6552: bitstring) = m1_6551 in
                                                            {8108}new Ns_6553: bitstring;
                                                            {8109}new ST_6554: bitstring;
                                                            {8110}new TTL_6555: bitstring;
                                                            {8111}let gNs_6556: bitstring = exp(g,Ns_6553) in
                                                            {8112}let m2_6557: bitstring = (OpenSecureChannelResponse,gNs_6556,ST_6554,TTL_6555) in
                                                            {8113}event beginSrv(Sess_5318,Cli_5316,gNs_6556);
                                                            {8114}out(c, m2_6557);
                                                            {8115}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8116}event endSrv(Cli_5316,Sess_5318,PartC_6552)
                                                        )
                                                        else
                                                            {8117}let v_6558: bool = (Disco_5317 = C) in
                                                            (
                                                                {8118}if v_6558 then
                                                                (
                                                                    {8119}let pkDisco_6559: bitstring = pub(skC) in
                                                                    {8120}in(c, (=pkCli_6537,em1_6560: bitstring));
                                                                    {8121}let m1_6561: bitstring = em1_6560 in
                                                                    {8122}let (=OpenSecureChannelRequest,=pkCli_6537,PartC_6562: bitstring) = m1_6561 in
                                                                    {8123}new Ns_6563: bitstring;
                                                                    {8124}new ST_6564: bitstring;
                                                                    {8125}new TTL_6565: bitstring;
                                                                    {8126}let gNs_6566: bitstring = exp(g,Ns_6563) in
                                                                    {8127}let m2_6567: bitstring = (OpenSecureChannelResponse,gNs_6566,ST_6564,TTL_6565) in
                                                                    {8128}event beginSrv(Sess_5318,Cli_5316,gNs_6566);
                                                                    {8129}out(c, m2_6567);
                                                                    {8130}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {8131}event endSrv(Cli_5316,Sess_5318,PartC_6562)
                                                                )
                                                                else
                                                                    {8132}let pkDisco_6568: bitstring = pub(sk(Disco_5317)) in
                                                                    {8133}in(c, (=pkCli_6537,em1_6569: bitstring));
                                                                    {8134}let m1_6570: bitstring = em1_6569 in
                                                                    {8135}let (=OpenSecureChannelRequest,=pkCli_6537,PartC_6571: bitstring) = m1_6570 in
                                                                    {8136}new Ns_6572: bitstring;
                                                                    {8137}new ST_6573: bitstring;
                                                                    {8138}new TTL_6574: bitstring;
                                                                    {8139}let gNs_6575: bitstring = exp(g,Ns_6572) in
                                                                    {8140}let m2_6576: bitstring = (OpenSecureChannelResponse,gNs_6575,ST_6573,TTL_6574) in
                                                                    {8141}event beginSrv(Sess_5318,Cli_5316,gNs_6575);
                                                                    {8142}out(c, m2_6576);
                                                                    {8143}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {8144}event endSrv(Cli_5316,Sess_5318,PartC_6571)
                                                            )
                                                            else
                                                                {8145}let pkDisco_6577: bitstring = fail-any in
                                                                {8146}in(c, (=pkCli_6537,em1_6578: bitstring));
                                                                {8147}let m1_6579: bitstring = em1_6578 in
                                                                {8148}let (=OpenSecureChannelRequest,=pkCli_6537,PartC_6580: bitstring) = m1_6579 in
                                                                {8149}new Ns_6581: bitstring;
                                                                {8150}new ST_6582: bitstring;
                                                                {8151}new TTL_6583: bitstring;
                                                                {8152}let gNs_6584: bitstring = exp(g,Ns_6581) in
                                                                {8153}let m2_6585: bitstring = (OpenSecureChannelResponse,gNs_6584,ST_6582,TTL_6583) in
                                                                {8154}event beginSrv(Sess_5318,Cli_5316,gNs_6584);
                                                                {8155}out(c, m2_6585);
                                                                {8156}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {8157}event endSrv(Cli_5316,Sess_5318,PartC_6580)
                                                    )
                                                    else
                                                        {8158}let pkDisco_6586: bitstring = fail-any in
                                                        {8159}in(c, (=pkCli_6537,em1_6587: bitstring));
                                                        {8160}let m1_6588: bitstring = em1_6587 in
                                                        {8161}let (=OpenSecureChannelRequest,=pkCli_6537,PartC_6589: bitstring) = m1_6588 in
                                                        {8162}new Ns_6590: bitstring;
                                                        {8163}new ST_6591: bitstring;
                                                        {8164}new TTL_6592: bitstring;
                                                        {8165}let gNs_6593: bitstring = exp(g,Ns_6590) in
                                                        {8166}let m2_6594: bitstring = (OpenSecureChannelResponse,gNs_6593,ST_6591,TTL_6592) in
                                                        {8167}event beginSrv(Sess_5318,Cli_5316,gNs_6593);
                                                        {8168}out(c, m2_6594);
                                                        {8169}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8170}event endSrv(Cli_5316,Sess_5318,PartC_6589)
                                            )
                                            else
                                                {8171}let pkDisco_6595: bitstring = fail-any in
                                                {8172}in(c, (=pkCli_6537,em1_6596: bitstring));
                                                {8173}let m1_6597: bitstring = em1_6596 in
                                                {8174}let (=OpenSecureChannelRequest,=pkCli_6537,PartC_6598: bitstring) = m1_6597 in
                                                {8175}new Ns_6599: bitstring;
                                                {8176}new ST_6600: bitstring;
                                                {8177}new TTL_6601: bitstring;
                                                {8178}let gNs_6602: bitstring = exp(g,Ns_6599) in
                                                {8179}let m2_6603: bitstring = (OpenSecureChannelResponse,gNs_6602,ST_6600,TTL_6601) in
                                                {8180}event beginSrv(Sess_5318,Cli_5316,gNs_6602);
                                                {8181}out(c, m2_6603);
                                                {8182}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {8183}event endSrv(Cli_5316,Sess_5318,PartC_6598)
                                )
                                else
                                    {8184}let pkCli_6604: bitstring = fail-any in
                                    {8185}let v_6605: bool = (Disco_5317 = A) in
                                    (
                                        {8186}if v_6605 then
                                        (
                                            {8187}let pkDisco_6606: bitstring = pub(skA) in
                                            {8188}in(c, (=pkCli_6604,em1_6607: bitstring));
                                            {8189}let m1_6608: bitstring = em1_6607 in
                                            {8190}let (=OpenSecureChannelRequest,=pkCli_6604,PartC_6609: bitstring) = m1_6608 in
                                            {8191}new Ns_6610: bitstring;
                                            {8192}new ST_6611: bitstring;
                                            {8193}new TTL_6612: bitstring;
                                            {8194}let gNs_6613: bitstring = exp(g,Ns_6610) in
                                            {8195}let m2_6614: bitstring = (OpenSecureChannelResponse,gNs_6613,ST_6611,TTL_6612) in
                                            {8196}event beginSrv(Sess_5318,Cli_5316,gNs_6613);
                                            {8197}out(c, m2_6614);
                                            {8198}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {8199}event endSrv(Cli_5316,Sess_5318,PartC_6609)
                                        )
                                        else
                                            {8200}let v_6615: bool = (Disco_5317 = B) in
                                            (
                                                {8201}if v_6615 then
                                                (
                                                    {8202}let pkDisco_6616: bitstring = pub(skB) in
                                                    {8203}in(c, (=pkCli_6604,em1_6617: bitstring));
                                                    {8204}let m1_6618: bitstring = em1_6617 in
                                                    {8205}let (=OpenSecureChannelRequest,=pkCli_6604,PartC_6619: bitstring) = m1_6618 in
                                                    {8206}new Ns_6620: bitstring;
                                                    {8207}new ST_6621: bitstring;
                                                    {8208}new TTL_6622: bitstring;
                                                    {8209}let gNs_6623: bitstring = exp(g,Ns_6620) in
                                                    {8210}let m2_6624: bitstring = (OpenSecureChannelResponse,gNs_6623,ST_6621,TTL_6622) in
                                                    {8211}event beginSrv(Sess_5318,Cli_5316,gNs_6623);
                                                    {8212}out(c, m2_6624);
                                                    {8213}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8214}event endSrv(Cli_5316,Sess_5318,PartC_6619)
                                                )
                                                else
                                                    {8215}let v_6625: bool = (Disco_5317 = C) in
                                                    (
                                                        {8216}if v_6625 then
                                                        (
                                                            {8217}let pkDisco_6626: bitstring = pub(skC) in
                                                            {8218}in(c, (=pkCli_6604,em1_6627: bitstring));
                                                            {8219}let m1_6628: bitstring = em1_6627 in
                                                            {8220}let (=OpenSecureChannelRequest,=pkCli_6604,PartC_6629: bitstring) = m1_6628 in
                                                            {8221}new Ns_6630: bitstring;
                                                            {8222}new ST_6631: bitstring;
                                                            {8223}new TTL_6632: bitstring;
                                                            {8224}let gNs_6633: bitstring = exp(g,Ns_6630) in
                                                            {8225}let m2_6634: bitstring = (OpenSecureChannelResponse,gNs_6633,ST_6631,TTL_6632) in
                                                            {8226}event beginSrv(Sess_5318,Cli_5316,gNs_6633);
                                                            {8227}out(c, m2_6634);
                                                            {8228}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8229}event endSrv(Cli_5316,Sess_5318,PartC_6629)
                                                        )
                                                        else
                                                            {8230}let pkDisco_6635: bitstring = pub(sk(Disco_5317)) in
                                                            {8231}in(c, (=pkCli_6604,em1_6636: bitstring));
                                                            {8232}let m1_6637: bitstring = em1_6636 in
                                                            {8233}let (=OpenSecureChannelRequest,=pkCli_6604,PartC_6638: bitstring) = m1_6637 in
                                                            {8234}new Ns_6639: bitstring;
                                                            {8235}new ST_6640: bitstring;
                                                            {8236}new TTL_6641: bitstring;
                                                            {8237}let gNs_6642: bitstring = exp(g,Ns_6639) in
                                                            {8238}let m2_6643: bitstring = (OpenSecureChannelResponse,gNs_6642,ST_6640,TTL_6641) in
                                                            {8239}event beginSrv(Sess_5318,Cli_5316,gNs_6642);
                                                            {8240}out(c, m2_6643);
                                                            {8241}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8242}event endSrv(Cli_5316,Sess_5318,PartC_6638)
                                                    )
                                                    else
                                                        {8243}let pkDisco_6644: bitstring = fail-any in
                                                        {8244}in(c, (=pkCli_6604,em1_6645: bitstring));
                                                        {8245}let m1_6646: bitstring = em1_6645 in
                                                        {8246}let (=OpenSecureChannelRequest,=pkCli_6604,PartC_6647: bitstring) = m1_6646 in
                                                        {8247}new Ns_6648: bitstring;
                                                        {8248}new ST_6649: bitstring;
                                                        {8249}new TTL_6650: bitstring;
                                                        {8250}let gNs_6651: bitstring = exp(g,Ns_6648) in
                                                        {8251}let m2_6652: bitstring = (OpenSecureChannelResponse,gNs_6651,ST_6649,TTL_6650) in
                                                        {8252}event beginSrv(Sess_5318,Cli_5316,gNs_6651);
                                                        {8253}out(c, m2_6652);
                                                        {8254}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8255}event endSrv(Cli_5316,Sess_5318,PartC_6647)
                                            )
                                            else
                                                {8256}let pkDisco_6653: bitstring = fail-any in
                                                {8257}in(c, (=pkCli_6604,em1_6654: bitstring));
                                                {8258}let m1_6655: bitstring = em1_6654 in
                                                {8259}let (=OpenSecureChannelRequest,=pkCli_6604,PartC_6656: bitstring) = m1_6655 in
                                                {8260}new Ns_6657: bitstring;
                                                {8261}new ST_6658: bitstring;
                                                {8262}new TTL_6659: bitstring;
                                                {8263}let gNs_6660: bitstring = exp(g,Ns_6657) in
                                                {8264}let m2_6661: bitstring = (OpenSecureChannelResponse,gNs_6660,ST_6658,TTL_6659) in
                                                {8265}event beginSrv(Sess_5318,Cli_5316,gNs_6660);
                                                {8266}out(c, m2_6661);
                                                {8267}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {8268}event endSrv(Cli_5316,Sess_5318,PartC_6656)
                                    )
                                    else
                                        {8269}let pkDisco_6662: bitstring = fail-any in
                                        {8270}in(c, (=pkCli_6604,em1_6663: bitstring));
                                        {8271}let m1_6664: bitstring = em1_6663 in
                                        {8272}let (=OpenSecureChannelRequest,=pkCli_6604,PartC_6665: bitstring) = m1_6664 in
                                        {8273}new Ns_6666: bitstring;
                                        {8274}new ST_6667: bitstring;
                                        {8275}new TTL_6668: bitstring;
                                        {8276}let gNs_6669: bitstring = exp(g,Ns_6666) in
                                        {8277}let m2_6670: bitstring = (OpenSecureChannelResponse,gNs_6669,ST_6667,TTL_6668) in
                                        {8278}event beginSrv(Sess_5318,Cli_5316,gNs_6669);
                                        {8279}out(c, m2_6670);
                                        {8280}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {8281}event endSrv(Cli_5316,Sess_5318,PartC_6665)
                        )
                        else
                            {8282}let pkCli_6671: bitstring = fail-any in
                            {8283}let v_6672: bool = (Disco_5317 = A) in
                            (
                                {8284}if v_6672 then
                                (
                                    {8285}let pkDisco_6673: bitstring = pub(skA) in
                                    {8286}in(c, (=pkCli_6671,em1_6674: bitstring));
                                    {8287}let m1_6675: bitstring = em1_6674 in
                                    {8288}let (=OpenSecureChannelRequest,=pkCli_6671,PartC_6676: bitstring) = m1_6675 in
                                    {8289}new Ns_6677: bitstring;
                                    {8290}new ST_6678: bitstring;
                                    {8291}new TTL_6679: bitstring;
                                    {8292}let gNs_6680: bitstring = exp(g,Ns_6677) in
                                    {8293}let m2_6681: bitstring = (OpenSecureChannelResponse,gNs_6680,ST_6678,TTL_6679) in
                                    {8294}event beginSrv(Sess_5318,Cli_5316,gNs_6680);
                                    {8295}out(c, m2_6681);
                                    {8296}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {8297}event endSrv(Cli_5316,Sess_5318,PartC_6676)
                                )
                                else
                                    {8298}let v_6682: bool = (Disco_5317 = B) in
                                    (
                                        {8299}if v_6682 then
                                        (
                                            {8300}let pkDisco_6683: bitstring = pub(skB) in
                                            {8301}in(c, (=pkCli_6671,em1_6684: bitstring));
                                            {8302}let m1_6685: bitstring = em1_6684 in
                                            {8303}let (=OpenSecureChannelRequest,=pkCli_6671,PartC_6686: bitstring) = m1_6685 in
                                            {8304}new Ns_6687: bitstring;
                                            {8305}new ST_6688: bitstring;
                                            {8306}new TTL_6689: bitstring;
                                            {8307}let gNs_6690: bitstring = exp(g,Ns_6687) in
                                            {8308}let m2_6691: bitstring = (OpenSecureChannelResponse,gNs_6690,ST_6688,TTL_6689) in
                                            {8309}event beginSrv(Sess_5318,Cli_5316,gNs_6690);
                                            {8310}out(c, m2_6691);
                                            {8311}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {8312}event endSrv(Cli_5316,Sess_5318,PartC_6686)
                                        )
                                        else
                                            {8313}let v_6692: bool = (Disco_5317 = C) in
                                            (
                                                {8314}if v_6692 then
                                                (
                                                    {8315}let pkDisco_6693: bitstring = pub(skC) in
                                                    {8316}in(c, (=pkCli_6671,em1_6694: bitstring));
                                                    {8317}let m1_6695: bitstring = em1_6694 in
                                                    {8318}let (=OpenSecureChannelRequest,=pkCli_6671,PartC_6696: bitstring) = m1_6695 in
                                                    {8319}new Ns_6697: bitstring;
                                                    {8320}new ST_6698: bitstring;
                                                    {8321}new TTL_6699: bitstring;
                                                    {8322}let gNs_6700: bitstring = exp(g,Ns_6697) in
                                                    {8323}let m2_6701: bitstring = (OpenSecureChannelResponse,gNs_6700,ST_6698,TTL_6699) in
                                                    {8324}event beginSrv(Sess_5318,Cli_5316,gNs_6700);
                                                    {8325}out(c, m2_6701);
                                                    {8326}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8327}event endSrv(Cli_5316,Sess_5318,PartC_6696)
                                                )
                                                else
                                                    {8328}let pkDisco_6702: bitstring = pub(sk(Disco_5317)) in
                                                    {8329}in(c, (=pkCli_6671,em1_6703: bitstring));
                                                    {8330}let m1_6704: bitstring = em1_6703 in
                                                    {8331}let (=OpenSecureChannelRequest,=pkCli_6671,PartC_6705: bitstring) = m1_6704 in
                                                    {8332}new Ns_6706: bitstring;
                                                    {8333}new ST_6707: bitstring;
                                                    {8334}new TTL_6708: bitstring;
                                                    {8335}let gNs_6709: bitstring = exp(g,Ns_6706) in
                                                    {8336}let m2_6710: bitstring = (OpenSecureChannelResponse,gNs_6709,ST_6707,TTL_6708) in
                                                    {8337}event beginSrv(Sess_5318,Cli_5316,gNs_6709);
                                                    {8338}out(c, m2_6710);
                                                    {8339}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8340}event endSrv(Cli_5316,Sess_5318,PartC_6705)
                                            )
                                            else
                                                {8341}let pkDisco_6711: bitstring = fail-any in
                                                {8342}in(c, (=pkCli_6671,em1_6712: bitstring));
                                                {8343}let m1_6713: bitstring = em1_6712 in
                                                {8344}let (=OpenSecureChannelRequest,=pkCli_6671,PartC_6714: bitstring) = m1_6713 in
                                                {8345}new Ns_6715: bitstring;
                                                {8346}new ST_6716: bitstring;
                                                {8347}new TTL_6717: bitstring;
                                                {8348}let gNs_6718: bitstring = exp(g,Ns_6715) in
                                                {8349}let m2_6719: bitstring = (OpenSecureChannelResponse,gNs_6718,ST_6716,TTL_6717) in
                                                {8350}event beginSrv(Sess_5318,Cli_5316,gNs_6718);
                                                {8351}out(c, m2_6719);
                                                {8352}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {8353}event endSrv(Cli_5316,Sess_5318,PartC_6714)
                                    )
                                    else
                                        {8354}let pkDisco_6720: bitstring = fail-any in
                                        {8355}in(c, (=pkCli_6671,em1_6721: bitstring));
                                        {8356}let m1_6722: bitstring = em1_6721 in
                                        {8357}let (=OpenSecureChannelRequest,=pkCli_6671,PartC_6723: bitstring) = m1_6722 in
                                        {8358}new Ns_6724: bitstring;
                                        {8359}new ST_6725: bitstring;
                                        {8360}new TTL_6726: bitstring;
                                        {8361}let gNs_6727: bitstring = exp(g,Ns_6724) in
                                        {8362}let m2_6728: bitstring = (OpenSecureChannelResponse,gNs_6727,ST_6725,TTL_6726) in
                                        {8363}event beginSrv(Sess_5318,Cli_5316,gNs_6727);
                                        {8364}out(c, m2_6728);
                                        {8365}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {8366}event endSrv(Cli_5316,Sess_5318,PartC_6723)
                            )
                            else
                                {8367}let pkDisco_6729: bitstring = fail-any in
                                {8368}in(c, (=pkCli_6671,em1_6730: bitstring));
                                {8369}let m1_6731: bitstring = em1_6730 in
                                {8370}let (=OpenSecureChannelRequest,=pkCli_6671,PartC_6732: bitstring) = m1_6731 in
                                {8371}new Ns_6733: bitstring;
                                {8372}new ST_6734: bitstring;
                                {8373}new TTL_6735: bitstring;
                                {8374}let gNs_6736: bitstring = exp(g,Ns_6733) in
                                {8375}let m2_6737: bitstring = (OpenSecureChannelResponse,gNs_6736,ST_6734,TTL_6735) in
                                {8376}event beginSrv(Sess_5318,Cli_5316,gNs_6736);
                                {8377}out(c, m2_6737);
                                {8378}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {8379}event endSrv(Cli_5316,Sess_5318,PartC_6732)
                    )
                    else
                        {8380}let skSess_6738: bitstring = fail-any in
                        {8381}let pkSess_6739: bitstring = pub(skSess_6738) in
                        {8382}let v_6740: bool = (Cli_5316 = A) in
                        (
                            {8383}if v_6740 then
                            (
                                {8384}let pkCli_6741: bitstring = pub(skA) in
                                {8385}let v_6742: bool = (Disco_5317 = A) in
                                (
                                    {8386}if v_6742 then
                                    (
                                        {8387}let pkDisco_6743: bitstring = pub(skA) in
                                        {8388}in(c, (=pkCli_6741,em1_6744: bitstring));
                                        {8389}let m1_6745: bitstring = em1_6744 in
                                        {8390}let (=OpenSecureChannelRequest,=pkCli_6741,PartC_6746: bitstring) = m1_6745 in
                                        {8391}new Ns_6747: bitstring;
                                        {8392}new ST_6748: bitstring;
                                        {8393}new TTL_6749: bitstring;
                                        {8394}let gNs_6750: bitstring = exp(g,Ns_6747) in
                                        {8395}let m2_6751: bitstring = (OpenSecureChannelResponse,gNs_6750,ST_6748,TTL_6749) in
                                        {8396}event beginSrv(Sess_5318,Cli_5316,gNs_6750);
                                        {8397}out(c, m2_6751);
                                        {8398}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {8399}event endSrv(Cli_5316,Sess_5318,PartC_6746)
                                    )
                                    else
                                        {8400}let v_6752: bool = (Disco_5317 = B) in
                                        (
                                            {8401}if v_6752 then
                                            (
                                                {8402}let pkDisco_6753: bitstring = pub(skB) in
                                                {8403}in(c, (=pkCli_6741,em1_6754: bitstring));
                                                {8404}let m1_6755: bitstring = em1_6754 in
                                                {8405}let (=OpenSecureChannelRequest,=pkCli_6741,PartC_6756: bitstring) = m1_6755 in
                                                {8406}new Ns_6757: bitstring;
                                                {8407}new ST_6758: bitstring;
                                                {8408}new TTL_6759: bitstring;
                                                {8409}let gNs_6760: bitstring = exp(g,Ns_6757) in
                                                {8410}let m2_6761: bitstring = (OpenSecureChannelResponse,gNs_6760,ST_6758,TTL_6759) in
                                                {8411}event beginSrv(Sess_5318,Cli_5316,gNs_6760);
                                                {8412}out(c, m2_6761);
                                                {8413}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {8414}event endSrv(Cli_5316,Sess_5318,PartC_6756)
                                            )
                                            else
                                                {8415}let v_6762: bool = (Disco_5317 = C) in
                                                (
                                                    {8416}if v_6762 then
                                                    (
                                                        {8417}let pkDisco_6763: bitstring = pub(skC) in
                                                        {8418}in(c, (=pkCli_6741,em1_6764: bitstring));
                                                        {8419}let m1_6765: bitstring = em1_6764 in
                                                        {8420}let (=OpenSecureChannelRequest,=pkCli_6741,PartC_6766: bitstring) = m1_6765 in
                                                        {8421}new Ns_6767: bitstring;
                                                        {8422}new ST_6768: bitstring;
                                                        {8423}new TTL_6769: bitstring;
                                                        {8424}let gNs_6770: bitstring = exp(g,Ns_6767) in
                                                        {8425}let m2_6771: bitstring = (OpenSecureChannelResponse,gNs_6770,ST_6768,TTL_6769) in
                                                        {8426}event beginSrv(Sess_5318,Cli_5316,gNs_6770);
                                                        {8427}out(c, m2_6771);
                                                        {8428}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8429}event endSrv(Cli_5316,Sess_5318,PartC_6766)
                                                    )
                                                    else
                                                        {8430}let pkDisco_6772: bitstring = pub(sk(Disco_5317)) in
                                                        {8431}in(c, (=pkCli_6741,em1_6773: bitstring));
                                                        {8432}let m1_6774: bitstring = em1_6773 in
                                                        {8433}let (=OpenSecureChannelRequest,=pkCli_6741,PartC_6775: bitstring) = m1_6774 in
                                                        {8434}new Ns_6776: bitstring;
                                                        {8435}new ST_6777: bitstring;
                                                        {8436}new TTL_6778: bitstring;
                                                        {8437}let gNs_6779: bitstring = exp(g,Ns_6776) in
                                                        {8438}let m2_6780: bitstring = (OpenSecureChannelResponse,gNs_6779,ST_6777,TTL_6778) in
                                                        {8439}event beginSrv(Sess_5318,Cli_5316,gNs_6779);
                                                        {8440}out(c, m2_6780);
                                                        {8441}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8442}event endSrv(Cli_5316,Sess_5318,PartC_6775)
                                                )
                                                else
                                                    {8443}let pkDisco_6781: bitstring = fail-any in
                                                    {8444}in(c, (=pkCli_6741,em1_6782: bitstring));
                                                    {8445}let m1_6783: bitstring = em1_6782 in
                                                    {8446}let (=OpenSecureChannelRequest,=pkCli_6741,PartC_6784: bitstring) = m1_6783 in
                                                    {8447}new Ns_6785: bitstring;
                                                    {8448}new ST_6786: bitstring;
                                                    {8449}new TTL_6787: bitstring;
                                                    {8450}let gNs_6788: bitstring = exp(g,Ns_6785) in
                                                    {8451}let m2_6789: bitstring = (OpenSecureChannelResponse,gNs_6788,ST_6786,TTL_6787) in
                                                    {8452}event beginSrv(Sess_5318,Cli_5316,gNs_6788);
                                                    {8453}out(c, m2_6789);
                                                    {8454}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8455}event endSrv(Cli_5316,Sess_5318,PartC_6784)
                                        )
                                        else
                                            {8456}let pkDisco_6790: bitstring = fail-any in
                                            {8457}in(c, (=pkCli_6741,em1_6791: bitstring));
                                            {8458}let m1_6792: bitstring = em1_6791 in
                                            {8459}let (=OpenSecureChannelRequest,=pkCli_6741,PartC_6793: bitstring) = m1_6792 in
                                            {8460}new Ns_6794: bitstring;
                                            {8461}new ST_6795: bitstring;
                                            {8462}new TTL_6796: bitstring;
                                            {8463}let gNs_6797: bitstring = exp(g,Ns_6794) in
                                            {8464}let m2_6798: bitstring = (OpenSecureChannelResponse,gNs_6797,ST_6795,TTL_6796) in
                                            {8465}event beginSrv(Sess_5318,Cli_5316,gNs_6797);
                                            {8466}out(c, m2_6798);
                                            {8467}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {8468}event endSrv(Cli_5316,Sess_5318,PartC_6793)
                                )
                                else
                                    {8469}let pkDisco_6799: bitstring = fail-any in
                                    {8470}in(c, (=pkCli_6741,em1_6800: bitstring));
                                    {8471}let m1_6801: bitstring = em1_6800 in
                                    {8472}let (=OpenSecureChannelRequest,=pkCli_6741,PartC_6802: bitstring) = m1_6801 in
                                    {8473}new Ns_6803: bitstring;
                                    {8474}new ST_6804: bitstring;
                                    {8475}new TTL_6805: bitstring;
                                    {8476}let gNs_6806: bitstring = exp(g,Ns_6803) in
                                    {8477}let m2_6807: bitstring = (OpenSecureChannelResponse,gNs_6806,ST_6804,TTL_6805) in
                                    {8478}event beginSrv(Sess_5318,Cli_5316,gNs_6806);
                                    {8479}out(c, m2_6807);
                                    {8480}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {8481}event endSrv(Cli_5316,Sess_5318,PartC_6802)
                            )
                            else
                                {8482}let v_6808: bool = (Cli_5316 = B) in
                                (
                                    {8483}if v_6808 then
                                    (
                                        {8484}let pkCli_6809: bitstring = pub(skB) in
                                        {8485}let v_6810: bool = (Disco_5317 = A) in
                                        (
                                            {8486}if v_6810 then
                                            (
                                                {8487}let pkDisco_6811: bitstring = pub(skA) in
                                                {8488}in(c, (=pkCli_6809,em1_6812: bitstring));
                                                {8489}let m1_6813: bitstring = em1_6812 in
                                                {8490}let (=OpenSecureChannelRequest,=pkCli_6809,PartC_6814: bitstring) = m1_6813 in
                                                {8491}new Ns_6815: bitstring;
                                                {8492}new ST_6816: bitstring;
                                                {8493}new TTL_6817: bitstring;
                                                {8494}let gNs_6818: bitstring = exp(g,Ns_6815) in
                                                {8495}let m2_6819: bitstring = (OpenSecureChannelResponse,gNs_6818,ST_6816,TTL_6817) in
                                                {8496}event beginSrv(Sess_5318,Cli_5316,gNs_6818);
                                                {8497}out(c, m2_6819);
                                                {8498}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {8499}event endSrv(Cli_5316,Sess_5318,PartC_6814)
                                            )
                                            else
                                                {8500}let v_6820: bool = (Disco_5317 = B) in
                                                (
                                                    {8501}if v_6820 then
                                                    (
                                                        {8502}let pkDisco_6821: bitstring = pub(skB) in
                                                        {8503}in(c, (=pkCli_6809,em1_6822: bitstring));
                                                        {8504}let m1_6823: bitstring = em1_6822 in
                                                        {8505}let (=OpenSecureChannelRequest,=pkCli_6809,PartC_6824: bitstring) = m1_6823 in
                                                        {8506}new Ns_6825: bitstring;
                                                        {8507}new ST_6826: bitstring;
                                                        {8508}new TTL_6827: bitstring;
                                                        {8509}let gNs_6828: bitstring = exp(g,Ns_6825) in
                                                        {8510}let m2_6829: bitstring = (OpenSecureChannelResponse,gNs_6828,ST_6826,TTL_6827) in
                                                        {8511}event beginSrv(Sess_5318,Cli_5316,gNs_6828);
                                                        {8512}out(c, m2_6829);
                                                        {8513}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8514}event endSrv(Cli_5316,Sess_5318,PartC_6824)
                                                    )
                                                    else
                                                        {8515}let v_6830: bool = (Disco_5317 = C) in
                                                        (
                                                            {8516}if v_6830 then
                                                            (
                                                                {8517}let pkDisco_6831: bitstring = pub(skC) in
                                                                {8518}in(c, (=pkCli_6809,em1_6832: bitstring));
                                                                {8519}let m1_6833: bitstring = em1_6832 in
                                                                {8520}let (=OpenSecureChannelRequest,=pkCli_6809,PartC_6834: bitstring) = m1_6833 in
                                                                {8521}new Ns_6835: bitstring;
                                                                {8522}new ST_6836: bitstring;
                                                                {8523}new TTL_6837: bitstring;
                                                                {8524}let gNs_6838: bitstring = exp(g,Ns_6835) in
                                                                {8525}let m2_6839: bitstring = (OpenSecureChannelResponse,gNs_6838,ST_6836,TTL_6837) in
                                                                {8526}event beginSrv(Sess_5318,Cli_5316,gNs_6838);
                                                                {8527}out(c, m2_6839);
                                                                {8528}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {8529}event endSrv(Cli_5316,Sess_5318,PartC_6834)
                                                            )
                                                            else
                                                                {8530}let pkDisco_6840: bitstring = pub(sk(Disco_5317)) in
                                                                {8531}in(c, (=pkCli_6809,em1_6841: bitstring));
                                                                {8532}let m1_6842: bitstring = em1_6841 in
                                                                {8533}let (=OpenSecureChannelRequest,=pkCli_6809,PartC_6843: bitstring) = m1_6842 in
                                                                {8534}new Ns_6844: bitstring;
                                                                {8535}new ST_6845: bitstring;
                                                                {8536}new TTL_6846: bitstring;
                                                                {8537}let gNs_6847: bitstring = exp(g,Ns_6844) in
                                                                {8538}let m2_6848: bitstring = (OpenSecureChannelResponse,gNs_6847,ST_6845,TTL_6846) in
                                                                {8539}event beginSrv(Sess_5318,Cli_5316,gNs_6847);
                                                                {8540}out(c, m2_6848);
                                                                {8541}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {8542}event endSrv(Cli_5316,Sess_5318,PartC_6843)
                                                        )
                                                        else
                                                            {8543}let pkDisco_6849: bitstring = fail-any in
                                                            {8544}in(c, (=pkCli_6809,em1_6850: bitstring));
                                                            {8545}let m1_6851: bitstring = em1_6850 in
                                                            {8546}let (=OpenSecureChannelRequest,=pkCli_6809,PartC_6852: bitstring) = m1_6851 in
                                                            {8547}new Ns_6853: bitstring;
                                                            {8548}new ST_6854: bitstring;
                                                            {8549}new TTL_6855: bitstring;
                                                            {8550}let gNs_6856: bitstring = exp(g,Ns_6853) in
                                                            {8551}let m2_6857: bitstring = (OpenSecureChannelResponse,gNs_6856,ST_6854,TTL_6855) in
                                                            {8552}event beginSrv(Sess_5318,Cli_5316,gNs_6856);
                                                            {8553}out(c, m2_6857);
                                                            {8554}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8555}event endSrv(Cli_5316,Sess_5318,PartC_6852)
                                                )
                                                else
                                                    {8556}let pkDisco_6858: bitstring = fail-any in
                                                    {8557}in(c, (=pkCli_6809,em1_6859: bitstring));
                                                    {8558}let m1_6860: bitstring = em1_6859 in
                                                    {8559}let (=OpenSecureChannelRequest,=pkCli_6809,PartC_6861: bitstring) = m1_6860 in
                                                    {8560}new Ns_6862: bitstring;
                                                    {8561}new ST_6863: bitstring;
                                                    {8562}new TTL_6864: bitstring;
                                                    {8563}let gNs_6865: bitstring = exp(g,Ns_6862) in
                                                    {8564}let m2_6866: bitstring = (OpenSecureChannelResponse,gNs_6865,ST_6863,TTL_6864) in
                                                    {8565}event beginSrv(Sess_5318,Cli_5316,gNs_6865);
                                                    {8566}out(c, m2_6866);
                                                    {8567}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8568}event endSrv(Cli_5316,Sess_5318,PartC_6861)
                                        )
                                        else
                                            {8569}let pkDisco_6867: bitstring = fail-any in
                                            {8570}in(c, (=pkCli_6809,em1_6868: bitstring));
                                            {8571}let m1_6869: bitstring = em1_6868 in
                                            {8572}let (=OpenSecureChannelRequest,=pkCli_6809,PartC_6870: bitstring) = m1_6869 in
                                            {8573}new Ns_6871: bitstring;
                                            {8574}new ST_6872: bitstring;
                                            {8575}new TTL_6873: bitstring;
                                            {8576}let gNs_6874: bitstring = exp(g,Ns_6871) in
                                            {8577}let m2_6875: bitstring = (OpenSecureChannelResponse,gNs_6874,ST_6872,TTL_6873) in
                                            {8578}event beginSrv(Sess_5318,Cli_5316,gNs_6874);
                                            {8579}out(c, m2_6875);
                                            {8580}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {8581}event endSrv(Cli_5316,Sess_5318,PartC_6870)
                                    )
                                    else
                                        {8582}let v_6876: bool = (Cli_5316 = C) in
                                        (
                                            {8583}if v_6876 then
                                            (
                                                {8584}let pkCli_6877: bitstring = pub(skC) in
                                                {8585}let v_6878: bool = (Disco_5317 = A) in
                                                (
                                                    {8586}if v_6878 then
                                                    (
                                                        {8587}let pkDisco_6879: bitstring = pub(skA) in
                                                        {8588}in(c, (=pkCli_6877,em1_6880: bitstring));
                                                        {8589}let m1_6881: bitstring = em1_6880 in
                                                        {8590}let (=OpenSecureChannelRequest,=pkCli_6877,PartC_6882: bitstring) = m1_6881 in
                                                        {8591}new Ns_6883: bitstring;
                                                        {8592}new ST_6884: bitstring;
                                                        {8593}new TTL_6885: bitstring;
                                                        {8594}let gNs_6886: bitstring = exp(g,Ns_6883) in
                                                        {8595}let m2_6887: bitstring = (OpenSecureChannelResponse,gNs_6886,ST_6884,TTL_6885) in
                                                        {8596}event beginSrv(Sess_5318,Cli_5316,gNs_6886);
                                                        {8597}out(c, m2_6887);
                                                        {8598}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8599}event endSrv(Cli_5316,Sess_5318,PartC_6882)
                                                    )
                                                    else
                                                        {8600}let v_6888: bool = (Disco_5317 = B) in
                                                        (
                                                            {8601}if v_6888 then
                                                            (
                                                                {8602}let pkDisco_6889: bitstring = pub(skB) in
                                                                {8603}in(c, (=pkCli_6877,em1_6890: bitstring));
                                                                {8604}let m1_6891: bitstring = em1_6890 in
                                                                {8605}let (=OpenSecureChannelRequest,=pkCli_6877,PartC_6892: bitstring) = m1_6891 in
                                                                {8606}new Ns_6893: bitstring;
                                                                {8607}new ST_6894: bitstring;
                                                                {8608}new TTL_6895: bitstring;
                                                                {8609}let gNs_6896: bitstring = exp(g,Ns_6893) in
                                                                {8610}let m2_6897: bitstring = (OpenSecureChannelResponse,gNs_6896,ST_6894,TTL_6895) in
                                                                {8611}event beginSrv(Sess_5318,Cli_5316,gNs_6896);
                                                                {8612}out(c, m2_6897);
                                                                {8613}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {8614}event endSrv(Cli_5316,Sess_5318,PartC_6892)
                                                            )
                                                            else
                                                                {8615}let v_6898: bool = (Disco_5317 = C) in
                                                                (
                                                                    {8616}if v_6898 then
                                                                    (
                                                                        {8617}let pkDisco_6899: bitstring = pub(skC) in
                                                                        {8618}in(c, (=pkCli_6877,em1_6900: bitstring));
                                                                        {8619}let m1_6901: bitstring = em1_6900 in
                                                                        {8620}let (=OpenSecureChannelRequest,=pkCli_6877,PartC_6902: bitstring) = m1_6901 in
                                                                        {8621}new Ns_6903: bitstring;
                                                                        {8622}new ST_6904: bitstring;
                                                                        {8623}new TTL_6905: bitstring;
                                                                        {8624}let gNs_6906: bitstring = exp(g,Ns_6903) in
                                                                        {8625}let m2_6907: bitstring = (OpenSecureChannelResponse,gNs_6906,ST_6904,TTL_6905) in
                                                                        {8626}event beginSrv(Sess_5318,Cli_5316,gNs_6906);
                                                                        {8627}out(c, m2_6907);
                                                                        {8628}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {8629}event endSrv(Cli_5316,Sess_5318,PartC_6902)
                                                                    )
                                                                    else
                                                                        {8630}let pkDisco_6908: bitstring = pub(sk(Disco_5317)) in
                                                                        {8631}in(c, (=pkCli_6877,em1_6909: bitstring));
                                                                        {8632}let m1_6910: bitstring = em1_6909 in
                                                                        {8633}let (=OpenSecureChannelRequest,=pkCli_6877,PartC_6911: bitstring) = m1_6910 in
                                                                        {8634}new Ns_6912: bitstring;
                                                                        {8635}new ST_6913: bitstring;
                                                                        {8636}new TTL_6914: bitstring;
                                                                        {8637}let gNs_6915: bitstring = exp(g,Ns_6912) in
                                                                        {8638}let m2_6916: bitstring = (OpenSecureChannelResponse,gNs_6915,ST_6913,TTL_6914) in
                                                                        {8639}event beginSrv(Sess_5318,Cli_5316,gNs_6915);
                                                                        {8640}out(c, m2_6916);
                                                                        {8641}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {8642}event endSrv(Cli_5316,Sess_5318,PartC_6911)
                                                                )
                                                                else
                                                                    {8643}let pkDisco_6917: bitstring = fail-any in
                                                                    {8644}in(c, (=pkCli_6877,em1_6918: bitstring));
                                                                    {8645}let m1_6919: bitstring = em1_6918 in
                                                                    {8646}let (=OpenSecureChannelRequest,=pkCli_6877,PartC_6920: bitstring) = m1_6919 in
                                                                    {8647}new Ns_6921: bitstring;
                                                                    {8648}new ST_6922: bitstring;
                                                                    {8649}new TTL_6923: bitstring;
                                                                    {8650}let gNs_6924: bitstring = exp(g,Ns_6921) in
                                                                    {8651}let m2_6925: bitstring = (OpenSecureChannelResponse,gNs_6924,ST_6922,TTL_6923) in
                                                                    {8652}event beginSrv(Sess_5318,Cli_5316,gNs_6924);
                                                                    {8653}out(c, m2_6925);
                                                                    {8654}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {8655}event endSrv(Cli_5316,Sess_5318,PartC_6920)
                                                        )
                                                        else
                                                            {8656}let pkDisco_6926: bitstring = fail-any in
                                                            {8657}in(c, (=pkCli_6877,em1_6927: bitstring));
                                                            {8658}let m1_6928: bitstring = em1_6927 in
                                                            {8659}let (=OpenSecureChannelRequest,=pkCli_6877,PartC_6929: bitstring) = m1_6928 in
                                                            {8660}new Ns_6930: bitstring;
                                                            {8661}new ST_6931: bitstring;
                                                            {8662}new TTL_6932: bitstring;
                                                            {8663}let gNs_6933: bitstring = exp(g,Ns_6930) in
                                                            {8664}let m2_6934: bitstring = (OpenSecureChannelResponse,gNs_6933,ST_6931,TTL_6932) in
                                                            {8665}event beginSrv(Sess_5318,Cli_5316,gNs_6933);
                                                            {8666}out(c, m2_6934);
                                                            {8667}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8668}event endSrv(Cli_5316,Sess_5318,PartC_6929)
                                                )
                                                else
                                                    {8669}let pkDisco_6935: bitstring = fail-any in
                                                    {8670}in(c, (=pkCli_6877,em1_6936: bitstring));
                                                    {8671}let m1_6937: bitstring = em1_6936 in
                                                    {8672}let (=OpenSecureChannelRequest,=pkCli_6877,PartC_6938: bitstring) = m1_6937 in
                                                    {8673}new Ns_6939: bitstring;
                                                    {8674}new ST_6940: bitstring;
                                                    {8675}new TTL_6941: bitstring;
                                                    {8676}let gNs_6942: bitstring = exp(g,Ns_6939) in
                                                    {8677}let m2_6943: bitstring = (OpenSecureChannelResponse,gNs_6942,ST_6940,TTL_6941) in
                                                    {8678}event beginSrv(Sess_5318,Cli_5316,gNs_6942);
                                                    {8679}out(c, m2_6943);
                                                    {8680}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8681}event endSrv(Cli_5316,Sess_5318,PartC_6938)
                                            )
                                            else
                                                {8682}let pkCli_6944: bitstring = pub(sk(Cli_5316)) in
                                                {8683}let v_6945: bool = (Disco_5317 = A) in
                                                (
                                                    {8684}if v_6945 then
                                                    (
                                                        {8685}let pkDisco_6946: bitstring = pub(skA) in
                                                        {8686}in(c, (=pkCli_6944,em1_6947: bitstring));
                                                        {8687}let m1_6948: bitstring = em1_6947 in
                                                        {8688}let (=OpenSecureChannelRequest,=pkCli_6944,PartC_6949: bitstring) = m1_6948 in
                                                        {8689}new Ns_6950: bitstring;
                                                        {8690}new ST_6951: bitstring;
                                                        {8691}new TTL_6952: bitstring;
                                                        {8692}let gNs_6953: bitstring = exp(g,Ns_6950) in
                                                        {8693}let m2_6954: bitstring = (OpenSecureChannelResponse,gNs_6953,ST_6951,TTL_6952) in
                                                        {8694}event beginSrv(Sess_5318,Cli_5316,gNs_6953);
                                                        {8695}out(c, m2_6954);
                                                        {8696}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8697}event endSrv(Cli_5316,Sess_5318,PartC_6949)
                                                    )
                                                    else
                                                        {8698}let v_6955: bool = (Disco_5317 = B) in
                                                        (
                                                            {8699}if v_6955 then
                                                            (
                                                                {8700}let pkDisco_6956: bitstring = pub(skB) in
                                                                {8701}in(c, (=pkCli_6944,em1_6957: bitstring));
                                                                {8702}let m1_6958: bitstring = em1_6957 in
                                                                {8703}let (=OpenSecureChannelRequest,=pkCli_6944,PartC_6959: bitstring) = m1_6958 in
                                                                {8704}new Ns_6960: bitstring;
                                                                {8705}new ST_6961: bitstring;
                                                                {8706}new TTL_6962: bitstring;
                                                                {8707}let gNs_6963: bitstring = exp(g,Ns_6960) in
                                                                {8708}let m2_6964: bitstring = (OpenSecureChannelResponse,gNs_6963,ST_6961,TTL_6962) in
                                                                {8709}event beginSrv(Sess_5318,Cli_5316,gNs_6963);
                                                                {8710}out(c, m2_6964);
                                                                {8711}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {8712}event endSrv(Cli_5316,Sess_5318,PartC_6959)
                                                            )
                                                            else
                                                                {8713}let v_6965: bool = (Disco_5317 = C) in
                                                                (
                                                                    {8714}if v_6965 then
                                                                    (
                                                                        {8715}let pkDisco_6966: bitstring = pub(skC) in
                                                                        {8716}in(c, (=pkCli_6944,em1_6967: bitstring));
                                                                        {8717}let m1_6968: bitstring = em1_6967 in
                                                                        {8718}let (=OpenSecureChannelRequest,=pkCli_6944,PartC_6969: bitstring) = m1_6968 in
                                                                        {8719}new Ns_6970: bitstring;
                                                                        {8720}new ST_6971: bitstring;
                                                                        {8721}new TTL_6972: bitstring;
                                                                        {8722}let gNs_6973: bitstring = exp(g,Ns_6970) in
                                                                        {8723}let m2_6974: bitstring = (OpenSecureChannelResponse,gNs_6973,ST_6971,TTL_6972) in
                                                                        {8724}event beginSrv(Sess_5318,Cli_5316,gNs_6973);
                                                                        {8725}out(c, m2_6974);
                                                                        {8726}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {8727}event endSrv(Cli_5316,Sess_5318,PartC_6969)
                                                                    )
                                                                    else
                                                                        {8728}let pkDisco_6975: bitstring = pub(sk(Disco_5317)) in
                                                                        {8729}in(c, (=pkCli_6944,em1_6976: bitstring));
                                                                        {8730}let m1_6977: bitstring = em1_6976 in
                                                                        {8731}let (=OpenSecureChannelRequest,=pkCli_6944,PartC_6978: bitstring) = m1_6977 in
                                                                        {8732}new Ns_6979: bitstring;
                                                                        {8733}new ST_6980: bitstring;
                                                                        {8734}new TTL_6981: bitstring;
                                                                        {8735}let gNs_6982: bitstring = exp(g,Ns_6979) in
                                                                        {8736}let m2_6983: bitstring = (OpenSecureChannelResponse,gNs_6982,ST_6980,TTL_6981) in
                                                                        {8737}event beginSrv(Sess_5318,Cli_5316,gNs_6982);
                                                                        {8738}out(c, m2_6983);
                                                                        {8739}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                        {8740}event endSrv(Cli_5316,Sess_5318,PartC_6978)
                                                                )
                                                                else
                                                                    {8741}let pkDisco_6984: bitstring = fail-any in
                                                                    {8742}in(c, (=pkCli_6944,em1_6985: bitstring));
                                                                    {8743}let m1_6986: bitstring = em1_6985 in
                                                                    {8744}let (=OpenSecureChannelRequest,=pkCli_6944,PartC_6987: bitstring) = m1_6986 in
                                                                    {8745}new Ns_6988: bitstring;
                                                                    {8746}new ST_6989: bitstring;
                                                                    {8747}new TTL_6990: bitstring;
                                                                    {8748}let gNs_6991: bitstring = exp(g,Ns_6988) in
                                                                    {8749}let m2_6992: bitstring = (OpenSecureChannelResponse,gNs_6991,ST_6989,TTL_6990) in
                                                                    {8750}event beginSrv(Sess_5318,Cli_5316,gNs_6991);
                                                                    {8751}out(c, m2_6992);
                                                                    {8752}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {8753}event endSrv(Cli_5316,Sess_5318,PartC_6987)
                                                        )
                                                        else
                                                            {8754}let pkDisco_6993: bitstring = fail-any in
                                                            {8755}in(c, (=pkCli_6944,em1_6994: bitstring));
                                                            {8756}let m1_6995: bitstring = em1_6994 in
                                                            {8757}let (=OpenSecureChannelRequest,=pkCli_6944,PartC_6996: bitstring) = m1_6995 in
                                                            {8758}new Ns_6997: bitstring;
                                                            {8759}new ST_6998: bitstring;
                                                            {8760}new TTL_6999: bitstring;
                                                            {8761}let gNs_7000: bitstring = exp(g,Ns_6997) in
                                                            {8762}let m2_7001: bitstring = (OpenSecureChannelResponse,gNs_7000,ST_6998,TTL_6999) in
                                                            {8763}event beginSrv(Sess_5318,Cli_5316,gNs_7000);
                                                            {8764}out(c, m2_7001);
                                                            {8765}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8766}event endSrv(Cli_5316,Sess_5318,PartC_6996)
                                                )
                                                else
                                                    {8767}let pkDisco_7002: bitstring = fail-any in
                                                    {8768}in(c, (=pkCli_6944,em1_7003: bitstring));
                                                    {8769}let m1_7004: bitstring = em1_7003 in
                                                    {8770}let (=OpenSecureChannelRequest,=pkCli_6944,PartC_7005: bitstring) = m1_7004 in
                                                    {8771}new Ns_7006: bitstring;
                                                    {8772}new ST_7007: bitstring;
                                                    {8773}new TTL_7008: bitstring;
                                                    {8774}let gNs_7009: bitstring = exp(g,Ns_7006) in
                                                    {8775}let m2_7010: bitstring = (OpenSecureChannelResponse,gNs_7009,ST_7007,TTL_7008) in
                                                    {8776}event beginSrv(Sess_5318,Cli_5316,gNs_7009);
                                                    {8777}out(c, m2_7010);
                                                    {8778}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8779}event endSrv(Cli_5316,Sess_5318,PartC_7005)
                                        )
                                        else
                                            {8780}let pkCli_7011: bitstring = fail-any in
                                            {8781}let v_7012: bool = (Disco_5317 = A) in
                                            (
                                                {8782}if v_7012 then
                                                (
                                                    {8783}let pkDisco_7013: bitstring = pub(skA) in
                                                    {8784}in(c, (=pkCli_7011,em1_7014: bitstring));
                                                    {8785}let m1_7015: bitstring = em1_7014 in
                                                    {8786}let (=OpenSecureChannelRequest,=pkCli_7011,PartC_7016: bitstring) = m1_7015 in
                                                    {8787}new Ns_7017: bitstring;
                                                    {8788}new ST_7018: bitstring;
                                                    {8789}new TTL_7019: bitstring;
                                                    {8790}let gNs_7020: bitstring = exp(g,Ns_7017) in
                                                    {8791}let m2_7021: bitstring = (OpenSecureChannelResponse,gNs_7020,ST_7018,TTL_7019) in
                                                    {8792}event beginSrv(Sess_5318,Cli_5316,gNs_7020);
                                                    {8793}out(c, m2_7021);
                                                    {8794}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8795}event endSrv(Cli_5316,Sess_5318,PartC_7016)
                                                )
                                                else
                                                    {8796}let v_7022: bool = (Disco_5317 = B) in
                                                    (
                                                        {8797}if v_7022 then
                                                        (
                                                            {8798}let pkDisco_7023: bitstring = pub(skB) in
                                                            {8799}in(c, (=pkCli_7011,em1_7024: bitstring));
                                                            {8800}let m1_7025: bitstring = em1_7024 in
                                                            {8801}let (=OpenSecureChannelRequest,=pkCli_7011,PartC_7026: bitstring) = m1_7025 in
                                                            {8802}new Ns_7027: bitstring;
                                                            {8803}new ST_7028: bitstring;
                                                            {8804}new TTL_7029: bitstring;
                                                            {8805}let gNs_7030: bitstring = exp(g,Ns_7027) in
                                                            {8806}let m2_7031: bitstring = (OpenSecureChannelResponse,gNs_7030,ST_7028,TTL_7029) in
                                                            {8807}event beginSrv(Sess_5318,Cli_5316,gNs_7030);
                                                            {8808}out(c, m2_7031);
                                                            {8809}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8810}event endSrv(Cli_5316,Sess_5318,PartC_7026)
                                                        )
                                                        else
                                                            {8811}let v_7032: bool = (Disco_5317 = C) in
                                                            (
                                                                {8812}if v_7032 then
                                                                (
                                                                    {8813}let pkDisco_7033: bitstring = pub(skC) in
                                                                    {8814}in(c, (=pkCli_7011,em1_7034: bitstring));
                                                                    {8815}let m1_7035: bitstring = em1_7034 in
                                                                    {8816}let (=OpenSecureChannelRequest,=pkCli_7011,PartC_7036: bitstring) = m1_7035 in
                                                                    {8817}new Ns_7037: bitstring;
                                                                    {8818}new ST_7038: bitstring;
                                                                    {8819}new TTL_7039: bitstring;
                                                                    {8820}let gNs_7040: bitstring = exp(g,Ns_7037) in
                                                                    {8821}let m2_7041: bitstring = (OpenSecureChannelResponse,gNs_7040,ST_7038,TTL_7039) in
                                                                    {8822}event beginSrv(Sess_5318,Cli_5316,gNs_7040);
                                                                    {8823}out(c, m2_7041);
                                                                    {8824}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {8825}event endSrv(Cli_5316,Sess_5318,PartC_7036)
                                                                )
                                                                else
                                                                    {8826}let pkDisco_7042: bitstring = pub(sk(Disco_5317)) in
                                                                    {8827}in(c, (=pkCli_7011,em1_7043: bitstring));
                                                                    {8828}let m1_7044: bitstring = em1_7043 in
                                                                    {8829}let (=OpenSecureChannelRequest,=pkCli_7011,PartC_7045: bitstring) = m1_7044 in
                                                                    {8830}new Ns_7046: bitstring;
                                                                    {8831}new ST_7047: bitstring;
                                                                    {8832}new TTL_7048: bitstring;
                                                                    {8833}let gNs_7049: bitstring = exp(g,Ns_7046) in
                                                                    {8834}let m2_7050: bitstring = (OpenSecureChannelResponse,gNs_7049,ST_7047,TTL_7048) in
                                                                    {8835}event beginSrv(Sess_5318,Cli_5316,gNs_7049);
                                                                    {8836}out(c, m2_7050);
                                                                    {8837}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                    {8838}event endSrv(Cli_5316,Sess_5318,PartC_7045)
                                                            )
                                                            else
                                                                {8839}let pkDisco_7051: bitstring = fail-any in
                                                                {8840}in(c, (=pkCli_7011,em1_7052: bitstring));
                                                                {8841}let m1_7053: bitstring = em1_7052 in
                                                                {8842}let (=OpenSecureChannelRequest,=pkCli_7011,PartC_7054: bitstring) = m1_7053 in
                                                                {8843}new Ns_7055: bitstring;
                                                                {8844}new ST_7056: bitstring;
                                                                {8845}new TTL_7057: bitstring;
                                                                {8846}let gNs_7058: bitstring = exp(g,Ns_7055) in
                                                                {8847}let m2_7059: bitstring = (OpenSecureChannelResponse,gNs_7058,ST_7056,TTL_7057) in
                                                                {8848}event beginSrv(Sess_5318,Cli_5316,gNs_7058);
                                                                {8849}out(c, m2_7059);
                                                                {8850}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {8851}event endSrv(Cli_5316,Sess_5318,PartC_7054)
                                                    )
                                                    else
                                                        {8852}let pkDisco_7060: bitstring = fail-any in
                                                        {8853}in(c, (=pkCli_7011,em1_7061: bitstring));
                                                        {8854}let m1_7062: bitstring = em1_7061 in
                                                        {8855}let (=OpenSecureChannelRequest,=pkCli_7011,PartC_7063: bitstring) = m1_7062 in
                                                        {8856}new Ns_7064: bitstring;
                                                        {8857}new ST_7065: bitstring;
                                                        {8858}new TTL_7066: bitstring;
                                                        {8859}let gNs_7067: bitstring = exp(g,Ns_7064) in
                                                        {8860}let m2_7068: bitstring = (OpenSecureChannelResponse,gNs_7067,ST_7065,TTL_7066) in
                                                        {8861}event beginSrv(Sess_5318,Cli_5316,gNs_7067);
                                                        {8862}out(c, m2_7068);
                                                        {8863}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8864}event endSrv(Cli_5316,Sess_5318,PartC_7063)
                                            )
                                            else
                                                {8865}let pkDisco_7069: bitstring = fail-any in
                                                {8866}in(c, (=pkCli_7011,em1_7070: bitstring));
                                                {8867}let m1_7071: bitstring = em1_7070 in
                                                {8868}let (=OpenSecureChannelRequest,=pkCli_7011,PartC_7072: bitstring) = m1_7071 in
                                                {8869}new Ns_7073: bitstring;
                                                {8870}new ST_7074: bitstring;
                                                {8871}new TTL_7075: bitstring;
                                                {8872}let gNs_7076: bitstring = exp(g,Ns_7073) in
                                                {8873}let m2_7077: bitstring = (OpenSecureChannelResponse,gNs_7076,ST_7074,TTL_7075) in
                                                {8874}event beginSrv(Sess_5318,Cli_5316,gNs_7076);
                                                {8875}out(c, m2_7077);
                                                {8876}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {8877}event endSrv(Cli_5316,Sess_5318,PartC_7072)
                                )
                                else
                                    {8878}let pkCli_7078: bitstring = fail-any in
                                    {8879}let v_7079: bool = (Disco_5317 = A) in
                                    (
                                        {8880}if v_7079 then
                                        (
                                            {8881}let pkDisco_7080: bitstring = pub(skA) in
                                            {8882}in(c, (=pkCli_7078,em1_7081: bitstring));
                                            {8883}let m1_7082: bitstring = em1_7081 in
                                            {8884}let (=OpenSecureChannelRequest,=pkCli_7078,PartC_7083: bitstring) = m1_7082 in
                                            {8885}new Ns_7084: bitstring;
                                            {8886}new ST_7085: bitstring;
                                            {8887}new TTL_7086: bitstring;
                                            {8888}let gNs_7087: bitstring = exp(g,Ns_7084) in
                                            {8889}let m2_7088: bitstring = (OpenSecureChannelResponse,gNs_7087,ST_7085,TTL_7086) in
                                            {8890}event beginSrv(Sess_5318,Cli_5316,gNs_7087);
                                            {8891}out(c, m2_7088);
                                            {8892}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {8893}event endSrv(Cli_5316,Sess_5318,PartC_7083)
                                        )
                                        else
                                            {8894}let v_7089: bool = (Disco_5317 = B) in
                                            (
                                                {8895}if v_7089 then
                                                (
                                                    {8896}let pkDisco_7090: bitstring = pub(skB) in
                                                    {8897}in(c, (=pkCli_7078,em1_7091: bitstring));
                                                    {8898}let m1_7092: bitstring = em1_7091 in
                                                    {8899}let (=OpenSecureChannelRequest,=pkCli_7078,PartC_7093: bitstring) = m1_7092 in
                                                    {8900}new Ns_7094: bitstring;
                                                    {8901}new ST_7095: bitstring;
                                                    {8902}new TTL_7096: bitstring;
                                                    {8903}let gNs_7097: bitstring = exp(g,Ns_7094) in
                                                    {8904}let m2_7098: bitstring = (OpenSecureChannelResponse,gNs_7097,ST_7095,TTL_7096) in
                                                    {8905}event beginSrv(Sess_5318,Cli_5316,gNs_7097);
                                                    {8906}out(c, m2_7098);
                                                    {8907}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {8908}event endSrv(Cli_5316,Sess_5318,PartC_7093)
                                                )
                                                else
                                                    {8909}let v_7099: bool = (Disco_5317 = C) in
                                                    (
                                                        {8910}if v_7099 then
                                                        (
                                                            {8911}let pkDisco_7100: bitstring = pub(skC) in
                                                            {8912}in(c, (=pkCli_7078,em1_7101: bitstring));
                                                            {8913}let m1_7102: bitstring = em1_7101 in
                                                            {8914}let (=OpenSecureChannelRequest,=pkCli_7078,PartC_7103: bitstring) = m1_7102 in
                                                            {8915}new Ns_7104: bitstring;
                                                            {8916}new ST_7105: bitstring;
                                                            {8917}new TTL_7106: bitstring;
                                                            {8918}let gNs_7107: bitstring = exp(g,Ns_7104) in
                                                            {8919}let m2_7108: bitstring = (OpenSecureChannelResponse,gNs_7107,ST_7105,TTL_7106) in
                                                            {8920}event beginSrv(Sess_5318,Cli_5316,gNs_7107);
                                                            {8921}out(c, m2_7108);
                                                            {8922}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8923}event endSrv(Cli_5316,Sess_5318,PartC_7103)
                                                        )
                                                        else
                                                            {8924}let pkDisco_7109: bitstring = pub(sk(Disco_5317)) in
                                                            {8925}in(c, (=pkCli_7078,em1_7110: bitstring));
                                                            {8926}let m1_7111: bitstring = em1_7110 in
                                                            {8927}let (=OpenSecureChannelRequest,=pkCli_7078,PartC_7112: bitstring) = m1_7111 in
                                                            {8928}new Ns_7113: bitstring;
                                                            {8929}new ST_7114: bitstring;
                                                            {8930}new TTL_7115: bitstring;
                                                            {8931}let gNs_7116: bitstring = exp(g,Ns_7113) in
                                                            {8932}let m2_7117: bitstring = (OpenSecureChannelResponse,gNs_7116,ST_7114,TTL_7115) in
                                                            {8933}event beginSrv(Sess_5318,Cli_5316,gNs_7116);
                                                            {8934}out(c, m2_7117);
                                                            {8935}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {8936}event endSrv(Cli_5316,Sess_5318,PartC_7112)
                                                    )
                                                    else
                                                        {8937}let pkDisco_7118: bitstring = fail-any in
                                                        {8938}in(c, (=pkCli_7078,em1_7119: bitstring));
                                                        {8939}let m1_7120: bitstring = em1_7119 in
                                                        {8940}let (=OpenSecureChannelRequest,=pkCli_7078,PartC_7121: bitstring) = m1_7120 in
                                                        {8941}new Ns_7122: bitstring;
                                                        {8942}new ST_7123: bitstring;
                                                        {8943}new TTL_7124: bitstring;
                                                        {8944}let gNs_7125: bitstring = exp(g,Ns_7122) in
                                                        {8945}let m2_7126: bitstring = (OpenSecureChannelResponse,gNs_7125,ST_7123,TTL_7124) in
                                                        {8946}event beginSrv(Sess_5318,Cli_5316,gNs_7125);
                                                        {8947}out(c, m2_7126);
                                                        {8948}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {8949}event endSrv(Cli_5316,Sess_5318,PartC_7121)
                                            )
                                            else
                                                {8950}let pkDisco_7127: bitstring = fail-any in
                                                {8951}in(c, (=pkCli_7078,em1_7128: bitstring));
                                                {8952}let m1_7129: bitstring = em1_7128 in
                                                {8953}let (=OpenSecureChannelRequest,=pkCli_7078,PartC_7130: bitstring) = m1_7129 in
                                                {8954}new Ns_7131: bitstring;
                                                {8955}new ST_7132: bitstring;
                                                {8956}new TTL_7133: bitstring;
                                                {8957}let gNs_7134: bitstring = exp(g,Ns_7131) in
                                                {8958}let m2_7135: bitstring = (OpenSecureChannelResponse,gNs_7134,ST_7132,TTL_7133) in
                                                {8959}event beginSrv(Sess_5318,Cli_5316,gNs_7134);
                                                {8960}out(c, m2_7135);
                                                {8961}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {8962}event endSrv(Cli_5316,Sess_5318,PartC_7130)
                                    )
                                    else
                                        {8963}let pkDisco_7136: bitstring = fail-any in
                                        {8964}in(c, (=pkCli_7078,em1_7137: bitstring));
                                        {8965}let m1_7138: bitstring = em1_7137 in
                                        {8966}let (=OpenSecureChannelRequest,=pkCli_7078,PartC_7139: bitstring) = m1_7138 in
                                        {8967}new Ns_7140: bitstring;
                                        {8968}new ST_7141: bitstring;
                                        {8969}new TTL_7142: bitstring;
                                        {8970}let gNs_7143: bitstring = exp(g,Ns_7140) in
                                        {8971}let m2_7144: bitstring = (OpenSecureChannelResponse,gNs_7143,ST_7141,TTL_7142) in
                                        {8972}event beginSrv(Sess_5318,Cli_5316,gNs_7143);
                                        {8973}out(c, m2_7144);
                                        {8974}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {8975}event endSrv(Cli_5316,Sess_5318,PartC_7139)
                        )
                        else
                            {8976}let pkCli_7145: bitstring = fail-any in
                            {8977}let v_7146: bool = (Disco_5317 = A) in
                            (
                                {8978}if v_7146 then
                                (
                                    {8979}let pkDisco_7147: bitstring = pub(skA) in
                                    {8980}in(c, (=pkCli_7145,em1_7148: bitstring));
                                    {8981}let m1_7149: bitstring = em1_7148 in
                                    {8982}let (=OpenSecureChannelRequest,=pkCli_7145,PartC_7150: bitstring) = m1_7149 in
                                    {8983}new Ns_7151: bitstring;
                                    {8984}new ST_7152: bitstring;
                                    {8985}new TTL_7153: bitstring;
                                    {8986}let gNs_7154: bitstring = exp(g,Ns_7151) in
                                    {8987}let m2_7155: bitstring = (OpenSecureChannelResponse,gNs_7154,ST_7152,TTL_7153) in
                                    {8988}event beginSrv(Sess_5318,Cli_5316,gNs_7154);
                                    {8989}out(c, m2_7155);
                                    {8990}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {8991}event endSrv(Cli_5316,Sess_5318,PartC_7150)
                                )
                                else
                                    {8992}let v_7156: bool = (Disco_5317 = B) in
                                    (
                                        {8993}if v_7156 then
                                        (
                                            {8994}let pkDisco_7157: bitstring = pub(skB) in
                                            {8995}in(c, (=pkCli_7145,em1_7158: bitstring));
                                            {8996}let m1_7159: bitstring = em1_7158 in
                                            {8997}let (=OpenSecureChannelRequest,=pkCli_7145,PartC_7160: bitstring) = m1_7159 in
                                            {8998}new Ns_7161: bitstring;
                                            {8999}new ST_7162: bitstring;
                                            {9000}new TTL_7163: bitstring;
                                            {9001}let gNs_7164: bitstring = exp(g,Ns_7161) in
                                            {9002}let m2_7165: bitstring = (OpenSecureChannelResponse,gNs_7164,ST_7162,TTL_7163) in
                                            {9003}event beginSrv(Sess_5318,Cli_5316,gNs_7164);
                                            {9004}out(c, m2_7165);
                                            {9005}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9006}event endSrv(Cli_5316,Sess_5318,PartC_7160)
                                        )
                                        else
                                            {9007}let v_7166: bool = (Disco_5317 = C) in
                                            (
                                                {9008}if v_7166 then
                                                (
                                                    {9009}let pkDisco_7167: bitstring = pub(skC) in
                                                    {9010}in(c, (=pkCli_7145,em1_7168: bitstring));
                                                    {9011}let m1_7169: bitstring = em1_7168 in
                                                    {9012}let (=OpenSecureChannelRequest,=pkCli_7145,PartC_7170: bitstring) = m1_7169 in
                                                    {9013}new Ns_7171: bitstring;
                                                    {9014}new ST_7172: bitstring;
                                                    {9015}new TTL_7173: bitstring;
                                                    {9016}let gNs_7174: bitstring = exp(g,Ns_7171) in
                                                    {9017}let m2_7175: bitstring = (OpenSecureChannelResponse,gNs_7174,ST_7172,TTL_7173) in
                                                    {9018}event beginSrv(Sess_5318,Cli_5316,gNs_7174);
                                                    {9019}out(c, m2_7175);
                                                    {9020}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9021}event endSrv(Cli_5316,Sess_5318,PartC_7170)
                                                )
                                                else
                                                    {9022}let pkDisco_7176: bitstring = pub(sk(Disco_5317)) in
                                                    {9023}in(c, (=pkCli_7145,em1_7177: bitstring));
                                                    {9024}let m1_7178: bitstring = em1_7177 in
                                                    {9025}let (=OpenSecureChannelRequest,=pkCli_7145,PartC_7179: bitstring) = m1_7178 in
                                                    {9026}new Ns_7180: bitstring;
                                                    {9027}new ST_7181: bitstring;
                                                    {9028}new TTL_7182: bitstring;
                                                    {9029}let gNs_7183: bitstring = exp(g,Ns_7180) in
                                                    {9030}let m2_7184: bitstring = (OpenSecureChannelResponse,gNs_7183,ST_7181,TTL_7182) in
                                                    {9031}event beginSrv(Sess_5318,Cli_5316,gNs_7183);
                                                    {9032}out(c, m2_7184);
                                                    {9033}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9034}event endSrv(Cli_5316,Sess_5318,PartC_7179)
                                            )
                                            else
                                                {9035}let pkDisco_7185: bitstring = fail-any in
                                                {9036}in(c, (=pkCli_7145,em1_7186: bitstring));
                                                {9037}let m1_7187: bitstring = em1_7186 in
                                                {9038}let (=OpenSecureChannelRequest,=pkCli_7145,PartC_7188: bitstring) = m1_7187 in
                                                {9039}new Ns_7189: bitstring;
                                                {9040}new ST_7190: bitstring;
                                                {9041}new TTL_7191: bitstring;
                                                {9042}let gNs_7192: bitstring = exp(g,Ns_7189) in
                                                {9043}let m2_7193: bitstring = (OpenSecureChannelResponse,gNs_7192,ST_7190,TTL_7191) in
                                                {9044}event beginSrv(Sess_5318,Cli_5316,gNs_7192);
                                                {9045}out(c, m2_7193);
                                                {9046}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9047}event endSrv(Cli_5316,Sess_5318,PartC_7188)
                                    )
                                    else
                                        {9048}let pkDisco_7194: bitstring = fail-any in
                                        {9049}in(c, (=pkCli_7145,em1_7195: bitstring));
                                        {9050}let m1_7196: bitstring = em1_7195 in
                                        {9051}let (=OpenSecureChannelRequest,=pkCli_7145,PartC_7197: bitstring) = m1_7196 in
                                        {9052}new Ns_7198: bitstring;
                                        {9053}new ST_7199: bitstring;
                                        {9054}new TTL_7200: bitstring;
                                        {9055}let gNs_7201: bitstring = exp(g,Ns_7198) in
                                        {9056}let m2_7202: bitstring = (OpenSecureChannelResponse,gNs_7201,ST_7199,TTL_7200) in
                                        {9057}event beginSrv(Sess_5318,Cli_5316,gNs_7201);
                                        {9058}out(c, m2_7202);
                                        {9059}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9060}event endSrv(Cli_5316,Sess_5318,PartC_7197)
                            )
                            else
                                {9061}let pkDisco_7203: bitstring = fail-any in
                                {9062}in(c, (=pkCli_7145,em1_7204: bitstring));
                                {9063}let m1_7205: bitstring = em1_7204 in
                                {9064}let (=OpenSecureChannelRequest,=pkCli_7145,PartC_7206: bitstring) = m1_7205 in
                                {9065}new Ns_7207: bitstring;
                                {9066}new ST_7208: bitstring;
                                {9067}new TTL_7209: bitstring;
                                {9068}let gNs_7210: bitstring = exp(g,Ns_7207) in
                                {9069}let m2_7211: bitstring = (OpenSecureChannelResponse,gNs_7210,ST_7208,TTL_7209) in
                                {9070}event beginSrv(Sess_5318,Cli_5316,gNs_7210);
                                {9071}out(c, m2_7211);
                                {9072}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {9073}event endSrv(Cli_5316,Sess_5318,PartC_7206)
            )
            else
                {9074}let skSess_7212: bitstring = fail-any in
                {9075}let pkSess_7213: bitstring = pub(skSess_7212) in
                {9076}let v_7214: bool = (Cli_5316 = A) in
                (
                    {9077}if v_7214 then
                    (
                        {9078}let pkCli_7215: bitstring = pub(skA) in
                        {9079}let v_7216: bool = (Disco_5317 = A) in
                        (
                            {9080}if v_7216 then
                            (
                                {9081}let pkDisco_7217: bitstring = pub(skA) in
                                {9082}in(c, (=pkCli_7215,em1_7218: bitstring));
                                {9083}let m1_7219: bitstring = em1_7218 in
                                {9084}let (=OpenSecureChannelRequest,=pkCli_7215,PartC_7220: bitstring) = m1_7219 in
                                {9085}new Ns_7221: bitstring;
                                {9086}new ST_7222: bitstring;
                                {9087}new TTL_7223: bitstring;
                                {9088}let gNs_7224: bitstring = exp(g,Ns_7221) in
                                {9089}let m2_7225: bitstring = (OpenSecureChannelResponse,gNs_7224,ST_7222,TTL_7223) in
                                {9090}event beginSrv(Sess_5318,Cli_5316,gNs_7224);
                                {9091}out(c, m2_7225);
                                {9092}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {9093}event endSrv(Cli_5316,Sess_5318,PartC_7220)
                            )
                            else
                                {9094}let v_7226: bool = (Disco_5317 = B) in
                                (
                                    {9095}if v_7226 then
                                    (
                                        {9096}let pkDisco_7227: bitstring = pub(skB) in
                                        {9097}in(c, (=pkCli_7215,em1_7228: bitstring));
                                        {9098}let m1_7229: bitstring = em1_7228 in
                                        {9099}let (=OpenSecureChannelRequest,=pkCli_7215,PartC_7230: bitstring) = m1_7229 in
                                        {9100}new Ns_7231: bitstring;
                                        {9101}new ST_7232: bitstring;
                                        {9102}new TTL_7233: bitstring;
                                        {9103}let gNs_7234: bitstring = exp(g,Ns_7231) in
                                        {9104}let m2_7235: bitstring = (OpenSecureChannelResponse,gNs_7234,ST_7232,TTL_7233) in
                                        {9105}event beginSrv(Sess_5318,Cli_5316,gNs_7234);
                                        {9106}out(c, m2_7235);
                                        {9107}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9108}event endSrv(Cli_5316,Sess_5318,PartC_7230)
                                    )
                                    else
                                        {9109}let v_7236: bool = (Disco_5317 = C) in
                                        (
                                            {9110}if v_7236 then
                                            (
                                                {9111}let pkDisco_7237: bitstring = pub(skC) in
                                                {9112}in(c, (=pkCli_7215,em1_7238: bitstring));
                                                {9113}let m1_7239: bitstring = em1_7238 in
                                                {9114}let (=OpenSecureChannelRequest,=pkCli_7215,PartC_7240: bitstring) = m1_7239 in
                                                {9115}new Ns_7241: bitstring;
                                                {9116}new ST_7242: bitstring;
                                                {9117}new TTL_7243: bitstring;
                                                {9118}let gNs_7244: bitstring = exp(g,Ns_7241) in
                                                {9119}let m2_7245: bitstring = (OpenSecureChannelResponse,gNs_7244,ST_7242,TTL_7243) in
                                                {9120}event beginSrv(Sess_5318,Cli_5316,gNs_7244);
                                                {9121}out(c, m2_7245);
                                                {9122}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9123}event endSrv(Cli_5316,Sess_5318,PartC_7240)
                                            )
                                            else
                                                {9124}let pkDisco_7246: bitstring = pub(sk(Disco_5317)) in
                                                {9125}in(c, (=pkCli_7215,em1_7247: bitstring));
                                                {9126}let m1_7248: bitstring = em1_7247 in
                                                {9127}let (=OpenSecureChannelRequest,=pkCli_7215,PartC_7249: bitstring) = m1_7248 in
                                                {9128}new Ns_7250: bitstring;
                                                {9129}new ST_7251: bitstring;
                                                {9130}new TTL_7252: bitstring;
                                                {9131}let gNs_7253: bitstring = exp(g,Ns_7250) in
                                                {9132}let m2_7254: bitstring = (OpenSecureChannelResponse,gNs_7253,ST_7251,TTL_7252) in
                                                {9133}event beginSrv(Sess_5318,Cli_5316,gNs_7253);
                                                {9134}out(c, m2_7254);
                                                {9135}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9136}event endSrv(Cli_5316,Sess_5318,PartC_7249)
                                        )
                                        else
                                            {9137}let pkDisco_7255: bitstring = fail-any in
                                            {9138}in(c, (=pkCli_7215,em1_7256: bitstring));
                                            {9139}let m1_7257: bitstring = em1_7256 in
                                            {9140}let (=OpenSecureChannelRequest,=pkCli_7215,PartC_7258: bitstring) = m1_7257 in
                                            {9141}new Ns_7259: bitstring;
                                            {9142}new ST_7260: bitstring;
                                            {9143}new TTL_7261: bitstring;
                                            {9144}let gNs_7262: bitstring = exp(g,Ns_7259) in
                                            {9145}let m2_7263: bitstring = (OpenSecureChannelResponse,gNs_7262,ST_7260,TTL_7261) in
                                            {9146}event beginSrv(Sess_5318,Cli_5316,gNs_7262);
                                            {9147}out(c, m2_7263);
                                            {9148}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9149}event endSrv(Cli_5316,Sess_5318,PartC_7258)
                                )
                                else
                                    {9150}let pkDisco_7264: bitstring = fail-any in
                                    {9151}in(c, (=pkCli_7215,em1_7265: bitstring));
                                    {9152}let m1_7266: bitstring = em1_7265 in
                                    {9153}let (=OpenSecureChannelRequest,=pkCli_7215,PartC_7267: bitstring) = m1_7266 in
                                    {9154}new Ns_7268: bitstring;
                                    {9155}new ST_7269: bitstring;
                                    {9156}new TTL_7270: bitstring;
                                    {9157}let gNs_7271: bitstring = exp(g,Ns_7268) in
                                    {9158}let m2_7272: bitstring = (OpenSecureChannelResponse,gNs_7271,ST_7269,TTL_7270) in
                                    {9159}event beginSrv(Sess_5318,Cli_5316,gNs_7271);
                                    {9160}out(c, m2_7272);
                                    {9161}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {9162}event endSrv(Cli_5316,Sess_5318,PartC_7267)
                        )
                        else
                            {9163}let pkDisco_7273: bitstring = fail-any in
                            {9164}in(c, (=pkCli_7215,em1_7274: bitstring));
                            {9165}let m1_7275: bitstring = em1_7274 in
                            {9166}let (=OpenSecureChannelRequest,=pkCli_7215,PartC_7276: bitstring) = m1_7275 in
                            {9167}new Ns_7277: bitstring;
                            {9168}new ST_7278: bitstring;
                            {9169}new TTL_7279: bitstring;
                            {9170}let gNs_7280: bitstring = exp(g,Ns_7277) in
                            {9171}let m2_7281: bitstring = (OpenSecureChannelResponse,gNs_7280,ST_7278,TTL_7279) in
                            {9172}event beginSrv(Sess_5318,Cli_5316,gNs_7280);
                            {9173}out(c, m2_7281);
                            {9174}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {9175}event endSrv(Cli_5316,Sess_5318,PartC_7276)
                    )
                    else
                        {9176}let v_7282: bool = (Cli_5316 = B) in
                        (
                            {9177}if v_7282 then
                            (
                                {9178}let pkCli_7283: bitstring = pub(skB) in
                                {9179}let v_7284: bool = (Disco_5317 = A) in
                                (
                                    {9180}if v_7284 then
                                    (
                                        {9181}let pkDisco_7285: bitstring = pub(skA) in
                                        {9182}in(c, (=pkCli_7283,em1_7286: bitstring));
                                        {9183}let m1_7287: bitstring = em1_7286 in
                                        {9184}let (=OpenSecureChannelRequest,=pkCli_7283,PartC_7288: bitstring) = m1_7287 in
                                        {9185}new Ns_7289: bitstring;
                                        {9186}new ST_7290: bitstring;
                                        {9187}new TTL_7291: bitstring;
                                        {9188}let gNs_7292: bitstring = exp(g,Ns_7289) in
                                        {9189}let m2_7293: bitstring = (OpenSecureChannelResponse,gNs_7292,ST_7290,TTL_7291) in
                                        {9190}event beginSrv(Sess_5318,Cli_5316,gNs_7292);
                                        {9191}out(c, m2_7293);
                                        {9192}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9193}event endSrv(Cli_5316,Sess_5318,PartC_7288)
                                    )
                                    else
                                        {9194}let v_7294: bool = (Disco_5317 = B) in
                                        (
                                            {9195}if v_7294 then
                                            (
                                                {9196}let pkDisco_7295: bitstring = pub(skB) in
                                                {9197}in(c, (=pkCli_7283,em1_7296: bitstring));
                                                {9198}let m1_7297: bitstring = em1_7296 in
                                                {9199}let (=OpenSecureChannelRequest,=pkCli_7283,PartC_7298: bitstring) = m1_7297 in
                                                {9200}new Ns_7299: bitstring;
                                                {9201}new ST_7300: bitstring;
                                                {9202}new TTL_7301: bitstring;
                                                {9203}let gNs_7302: bitstring = exp(g,Ns_7299) in
                                                {9204}let m2_7303: bitstring = (OpenSecureChannelResponse,gNs_7302,ST_7300,TTL_7301) in
                                                {9205}event beginSrv(Sess_5318,Cli_5316,gNs_7302);
                                                {9206}out(c, m2_7303);
                                                {9207}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9208}event endSrv(Cli_5316,Sess_5318,PartC_7298)
                                            )
                                            else
                                                {9209}let v_7304: bool = (Disco_5317 = C) in
                                                (
                                                    {9210}if v_7304 then
                                                    (
                                                        {9211}let pkDisco_7305: bitstring = pub(skC) in
                                                        {9212}in(c, (=pkCli_7283,em1_7306: bitstring));
                                                        {9213}let m1_7307: bitstring = em1_7306 in
                                                        {9214}let (=OpenSecureChannelRequest,=pkCli_7283,PartC_7308: bitstring) = m1_7307 in
                                                        {9215}new Ns_7309: bitstring;
                                                        {9216}new ST_7310: bitstring;
                                                        {9217}new TTL_7311: bitstring;
                                                        {9218}let gNs_7312: bitstring = exp(g,Ns_7309) in
                                                        {9219}let m2_7313: bitstring = (OpenSecureChannelResponse,gNs_7312,ST_7310,TTL_7311) in
                                                        {9220}event beginSrv(Sess_5318,Cli_5316,gNs_7312);
                                                        {9221}out(c, m2_7313);
                                                        {9222}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {9223}event endSrv(Cli_5316,Sess_5318,PartC_7308)
                                                    )
                                                    else
                                                        {9224}let pkDisco_7314: bitstring = pub(sk(Disco_5317)) in
                                                        {9225}in(c, (=pkCli_7283,em1_7315: bitstring));
                                                        {9226}let m1_7316: bitstring = em1_7315 in
                                                        {9227}let (=OpenSecureChannelRequest,=pkCli_7283,PartC_7317: bitstring) = m1_7316 in
                                                        {9228}new Ns_7318: bitstring;
                                                        {9229}new ST_7319: bitstring;
                                                        {9230}new TTL_7320: bitstring;
                                                        {9231}let gNs_7321: bitstring = exp(g,Ns_7318) in
                                                        {9232}let m2_7322: bitstring = (OpenSecureChannelResponse,gNs_7321,ST_7319,TTL_7320) in
                                                        {9233}event beginSrv(Sess_5318,Cli_5316,gNs_7321);
                                                        {9234}out(c, m2_7322);
                                                        {9235}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {9236}event endSrv(Cli_5316,Sess_5318,PartC_7317)
                                                )
                                                else
                                                    {9237}let pkDisco_7323: bitstring = fail-any in
                                                    {9238}in(c, (=pkCli_7283,em1_7324: bitstring));
                                                    {9239}let m1_7325: bitstring = em1_7324 in
                                                    {9240}let (=OpenSecureChannelRequest,=pkCli_7283,PartC_7326: bitstring) = m1_7325 in
                                                    {9241}new Ns_7327: bitstring;
                                                    {9242}new ST_7328: bitstring;
                                                    {9243}new TTL_7329: bitstring;
                                                    {9244}let gNs_7330: bitstring = exp(g,Ns_7327) in
                                                    {9245}let m2_7331: bitstring = (OpenSecureChannelResponse,gNs_7330,ST_7328,TTL_7329) in
                                                    {9246}event beginSrv(Sess_5318,Cli_5316,gNs_7330);
                                                    {9247}out(c, m2_7331);
                                                    {9248}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9249}event endSrv(Cli_5316,Sess_5318,PartC_7326)
                                        )
                                        else
                                            {9250}let pkDisco_7332: bitstring = fail-any in
                                            {9251}in(c, (=pkCli_7283,em1_7333: bitstring));
                                            {9252}let m1_7334: bitstring = em1_7333 in
                                            {9253}let (=OpenSecureChannelRequest,=pkCli_7283,PartC_7335: bitstring) = m1_7334 in
                                            {9254}new Ns_7336: bitstring;
                                            {9255}new ST_7337: bitstring;
                                            {9256}new TTL_7338: bitstring;
                                            {9257}let gNs_7339: bitstring = exp(g,Ns_7336) in
                                            {9258}let m2_7340: bitstring = (OpenSecureChannelResponse,gNs_7339,ST_7337,TTL_7338) in
                                            {9259}event beginSrv(Sess_5318,Cli_5316,gNs_7339);
                                            {9260}out(c, m2_7340);
                                            {9261}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9262}event endSrv(Cli_5316,Sess_5318,PartC_7335)
                                )
                                else
                                    {9263}let pkDisco_7341: bitstring = fail-any in
                                    {9264}in(c, (=pkCli_7283,em1_7342: bitstring));
                                    {9265}let m1_7343: bitstring = em1_7342 in
                                    {9266}let (=OpenSecureChannelRequest,=pkCli_7283,PartC_7344: bitstring) = m1_7343 in
                                    {9267}new Ns_7345: bitstring;
                                    {9268}new ST_7346: bitstring;
                                    {9269}new TTL_7347: bitstring;
                                    {9270}let gNs_7348: bitstring = exp(g,Ns_7345) in
                                    {9271}let m2_7349: bitstring = (OpenSecureChannelResponse,gNs_7348,ST_7346,TTL_7347) in
                                    {9272}event beginSrv(Sess_5318,Cli_5316,gNs_7348);
                                    {9273}out(c, m2_7349);
                                    {9274}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {9275}event endSrv(Cli_5316,Sess_5318,PartC_7344)
                            )
                            else
                                {9276}let v_7350: bool = (Cli_5316 = C) in
                                (
                                    {9277}if v_7350 then
                                    (
                                        {9278}let pkCli_7351: bitstring = pub(skC) in
                                        {9279}let v_7352: bool = (Disco_5317 = A) in
                                        (
                                            {9280}if v_7352 then
                                            (
                                                {9281}let pkDisco_7353: bitstring = pub(skA) in
                                                {9282}in(c, (=pkCli_7351,em1_7354: bitstring));
                                                {9283}let m1_7355: bitstring = em1_7354 in
                                                {9284}let (=OpenSecureChannelRequest,=pkCli_7351,PartC_7356: bitstring) = m1_7355 in
                                                {9285}new Ns_7357: bitstring;
                                                {9286}new ST_7358: bitstring;
                                                {9287}new TTL_7359: bitstring;
                                                {9288}let gNs_7360: bitstring = exp(g,Ns_7357) in
                                                {9289}let m2_7361: bitstring = (OpenSecureChannelResponse,gNs_7360,ST_7358,TTL_7359) in
                                                {9290}event beginSrv(Sess_5318,Cli_5316,gNs_7360);
                                                {9291}out(c, m2_7361);
                                                {9292}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9293}event endSrv(Cli_5316,Sess_5318,PartC_7356)
                                            )
                                            else
                                                {9294}let v_7362: bool = (Disco_5317 = B) in
                                                (
                                                    {9295}if v_7362 then
                                                    (
                                                        {9296}let pkDisco_7363: bitstring = pub(skB) in
                                                        {9297}in(c, (=pkCli_7351,em1_7364: bitstring));
                                                        {9298}let m1_7365: bitstring = em1_7364 in
                                                        {9299}let (=OpenSecureChannelRequest,=pkCli_7351,PartC_7366: bitstring) = m1_7365 in
                                                        {9300}new Ns_7367: bitstring;
                                                        {9301}new ST_7368: bitstring;
                                                        {9302}new TTL_7369: bitstring;
                                                        {9303}let gNs_7370: bitstring = exp(g,Ns_7367) in
                                                        {9304}let m2_7371: bitstring = (OpenSecureChannelResponse,gNs_7370,ST_7368,TTL_7369) in
                                                        {9305}event beginSrv(Sess_5318,Cli_5316,gNs_7370);
                                                        {9306}out(c, m2_7371);
                                                        {9307}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {9308}event endSrv(Cli_5316,Sess_5318,PartC_7366)
                                                    )
                                                    else
                                                        {9309}let v_7372: bool = (Disco_5317 = C) in
                                                        (
                                                            {9310}if v_7372 then
                                                            (
                                                                {9311}let pkDisco_7373: bitstring = pub(skC) in
                                                                {9312}in(c, (=pkCli_7351,em1_7374: bitstring));
                                                                {9313}let m1_7375: bitstring = em1_7374 in
                                                                {9314}let (=OpenSecureChannelRequest,=pkCli_7351,PartC_7376: bitstring) = m1_7375 in
                                                                {9315}new Ns_7377: bitstring;
                                                                {9316}new ST_7378: bitstring;
                                                                {9317}new TTL_7379: bitstring;
                                                                {9318}let gNs_7380: bitstring = exp(g,Ns_7377) in
                                                                {9319}let m2_7381: bitstring = (OpenSecureChannelResponse,gNs_7380,ST_7378,TTL_7379) in
                                                                {9320}event beginSrv(Sess_5318,Cli_5316,gNs_7380);
                                                                {9321}out(c, m2_7381);
                                                                {9322}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {9323}event endSrv(Cli_5316,Sess_5318,PartC_7376)
                                                            )
                                                            else
                                                                {9324}let pkDisco_7382: bitstring = pub(sk(Disco_5317)) in
                                                                {9325}in(c, (=pkCli_7351,em1_7383: bitstring));
                                                                {9326}let m1_7384: bitstring = em1_7383 in
                                                                {9327}let (=OpenSecureChannelRequest,=pkCli_7351,PartC_7385: bitstring) = m1_7384 in
                                                                {9328}new Ns_7386: bitstring;
                                                                {9329}new ST_7387: bitstring;
                                                                {9330}new TTL_7388: bitstring;
                                                                {9331}let gNs_7389: bitstring = exp(g,Ns_7386) in
                                                                {9332}let m2_7390: bitstring = (OpenSecureChannelResponse,gNs_7389,ST_7387,TTL_7388) in
                                                                {9333}event beginSrv(Sess_5318,Cli_5316,gNs_7389);
                                                                {9334}out(c, m2_7390);
                                                                {9335}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {9336}event endSrv(Cli_5316,Sess_5318,PartC_7385)
                                                        )
                                                        else
                                                            {9337}let pkDisco_7391: bitstring = fail-any in
                                                            {9338}in(c, (=pkCli_7351,em1_7392: bitstring));
                                                            {9339}let m1_7393: bitstring = em1_7392 in
                                                            {9340}let (=OpenSecureChannelRequest,=pkCli_7351,PartC_7394: bitstring) = m1_7393 in
                                                            {9341}new Ns_7395: bitstring;
                                                            {9342}new ST_7396: bitstring;
                                                            {9343}new TTL_7397: bitstring;
                                                            {9344}let gNs_7398: bitstring = exp(g,Ns_7395) in
                                                            {9345}let m2_7399: bitstring = (OpenSecureChannelResponse,gNs_7398,ST_7396,TTL_7397) in
                                                            {9346}event beginSrv(Sess_5318,Cli_5316,gNs_7398);
                                                            {9347}out(c, m2_7399);
                                                            {9348}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {9349}event endSrv(Cli_5316,Sess_5318,PartC_7394)
                                                )
                                                else
                                                    {9350}let pkDisco_7400: bitstring = fail-any in
                                                    {9351}in(c, (=pkCli_7351,em1_7401: bitstring));
                                                    {9352}let m1_7402: bitstring = em1_7401 in
                                                    {9353}let (=OpenSecureChannelRequest,=pkCli_7351,PartC_7403: bitstring) = m1_7402 in
                                                    {9354}new Ns_7404: bitstring;
                                                    {9355}new ST_7405: bitstring;
                                                    {9356}new TTL_7406: bitstring;
                                                    {9357}let gNs_7407: bitstring = exp(g,Ns_7404) in
                                                    {9358}let m2_7408: bitstring = (OpenSecureChannelResponse,gNs_7407,ST_7405,TTL_7406) in
                                                    {9359}event beginSrv(Sess_5318,Cli_5316,gNs_7407);
                                                    {9360}out(c, m2_7408);
                                                    {9361}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9362}event endSrv(Cli_5316,Sess_5318,PartC_7403)
                                        )
                                        else
                                            {9363}let pkDisco_7409: bitstring = fail-any in
                                            {9364}in(c, (=pkCli_7351,em1_7410: bitstring));
                                            {9365}let m1_7411: bitstring = em1_7410 in
                                            {9366}let (=OpenSecureChannelRequest,=pkCli_7351,PartC_7412: bitstring) = m1_7411 in
                                            {9367}new Ns_7413: bitstring;
                                            {9368}new ST_7414: bitstring;
                                            {9369}new TTL_7415: bitstring;
                                            {9370}let gNs_7416: bitstring = exp(g,Ns_7413) in
                                            {9371}let m2_7417: bitstring = (OpenSecureChannelResponse,gNs_7416,ST_7414,TTL_7415) in
                                            {9372}event beginSrv(Sess_5318,Cli_5316,gNs_7416);
                                            {9373}out(c, m2_7417);
                                            {9374}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9375}event endSrv(Cli_5316,Sess_5318,PartC_7412)
                                    )
                                    else
                                        {9376}let pkCli_7418: bitstring = pub(sk(Cli_5316)) in
                                        {9377}let v_7419: bool = (Disco_5317 = A) in
                                        (
                                            {9378}if v_7419 then
                                            (
                                                {9379}let pkDisco_7420: bitstring = pub(skA) in
                                                {9380}in(c, (=pkCli_7418,em1_7421: bitstring));
                                                {9381}let m1_7422: bitstring = em1_7421 in
                                                {9382}let (=OpenSecureChannelRequest,=pkCli_7418,PartC_7423: bitstring) = m1_7422 in
                                                {9383}new Ns_7424: bitstring;
                                                {9384}new ST_7425: bitstring;
                                                {9385}new TTL_7426: bitstring;
                                                {9386}let gNs_7427: bitstring = exp(g,Ns_7424) in
                                                {9387}let m2_7428: bitstring = (OpenSecureChannelResponse,gNs_7427,ST_7425,TTL_7426) in
                                                {9388}event beginSrv(Sess_5318,Cli_5316,gNs_7427);
                                                {9389}out(c, m2_7428);
                                                {9390}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9391}event endSrv(Cli_5316,Sess_5318,PartC_7423)
                                            )
                                            else
                                                {9392}let v_7429: bool = (Disco_5317 = B) in
                                                (
                                                    {9393}if v_7429 then
                                                    (
                                                        {9394}let pkDisco_7430: bitstring = pub(skB) in
                                                        {9395}in(c, (=pkCli_7418,em1_7431: bitstring));
                                                        {9396}let m1_7432: bitstring = em1_7431 in
                                                        {9397}let (=OpenSecureChannelRequest,=pkCli_7418,PartC_7433: bitstring) = m1_7432 in
                                                        {9398}new Ns_7434: bitstring;
                                                        {9399}new ST_7435: bitstring;
                                                        {9400}new TTL_7436: bitstring;
                                                        {9401}let gNs_7437: bitstring = exp(g,Ns_7434) in
                                                        {9402}let m2_7438: bitstring = (OpenSecureChannelResponse,gNs_7437,ST_7435,TTL_7436) in
                                                        {9403}event beginSrv(Sess_5318,Cli_5316,gNs_7437);
                                                        {9404}out(c, m2_7438);
                                                        {9405}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {9406}event endSrv(Cli_5316,Sess_5318,PartC_7433)
                                                    )
                                                    else
                                                        {9407}let v_7439: bool = (Disco_5317 = C) in
                                                        (
                                                            {9408}if v_7439 then
                                                            (
                                                                {9409}let pkDisco_7440: bitstring = pub(skC) in
                                                                {9410}in(c, (=pkCli_7418,em1_7441: bitstring));
                                                                {9411}let m1_7442: bitstring = em1_7441 in
                                                                {9412}let (=OpenSecureChannelRequest,=pkCli_7418,PartC_7443: bitstring) = m1_7442 in
                                                                {9413}new Ns_7444: bitstring;
                                                                {9414}new ST_7445: bitstring;
                                                                {9415}new TTL_7446: bitstring;
                                                                {9416}let gNs_7447: bitstring = exp(g,Ns_7444) in
                                                                {9417}let m2_7448: bitstring = (OpenSecureChannelResponse,gNs_7447,ST_7445,TTL_7446) in
                                                                {9418}event beginSrv(Sess_5318,Cli_5316,gNs_7447);
                                                                {9419}out(c, m2_7448);
                                                                {9420}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {9421}event endSrv(Cli_5316,Sess_5318,PartC_7443)
                                                            )
                                                            else
                                                                {9422}let pkDisco_7449: bitstring = pub(sk(Disco_5317)) in
                                                                {9423}in(c, (=pkCli_7418,em1_7450: bitstring));
                                                                {9424}let m1_7451: bitstring = em1_7450 in
                                                                {9425}let (=OpenSecureChannelRequest,=pkCli_7418,PartC_7452: bitstring) = m1_7451 in
                                                                {9426}new Ns_7453: bitstring;
                                                                {9427}new ST_7454: bitstring;
                                                                {9428}new TTL_7455: bitstring;
                                                                {9429}let gNs_7456: bitstring = exp(g,Ns_7453) in
                                                                {9430}let m2_7457: bitstring = (OpenSecureChannelResponse,gNs_7456,ST_7454,TTL_7455) in
                                                                {9431}event beginSrv(Sess_5318,Cli_5316,gNs_7456);
                                                                {9432}out(c, m2_7457);
                                                                {9433}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                                {9434}event endSrv(Cli_5316,Sess_5318,PartC_7452)
                                                        )
                                                        else
                                                            {9435}let pkDisco_7458: bitstring = fail-any in
                                                            {9436}in(c, (=pkCli_7418,em1_7459: bitstring));
                                                            {9437}let m1_7460: bitstring = em1_7459 in
                                                            {9438}let (=OpenSecureChannelRequest,=pkCli_7418,PartC_7461: bitstring) = m1_7460 in
                                                            {9439}new Ns_7462: bitstring;
                                                            {9440}new ST_7463: bitstring;
                                                            {9441}new TTL_7464: bitstring;
                                                            {9442}let gNs_7465: bitstring = exp(g,Ns_7462) in
                                                            {9443}let m2_7466: bitstring = (OpenSecureChannelResponse,gNs_7465,ST_7463,TTL_7464) in
                                                            {9444}event beginSrv(Sess_5318,Cli_5316,gNs_7465);
                                                            {9445}out(c, m2_7466);
                                                            {9446}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {9447}event endSrv(Cli_5316,Sess_5318,PartC_7461)
                                                )
                                                else
                                                    {9448}let pkDisco_7467: bitstring = fail-any in
                                                    {9449}in(c, (=pkCli_7418,em1_7468: bitstring));
                                                    {9450}let m1_7469: bitstring = em1_7468 in
                                                    {9451}let (=OpenSecureChannelRequest,=pkCli_7418,PartC_7470: bitstring) = m1_7469 in
                                                    {9452}new Ns_7471: bitstring;
                                                    {9453}new ST_7472: bitstring;
                                                    {9454}new TTL_7473: bitstring;
                                                    {9455}let gNs_7474: bitstring = exp(g,Ns_7471) in
                                                    {9456}let m2_7475: bitstring = (OpenSecureChannelResponse,gNs_7474,ST_7472,TTL_7473) in
                                                    {9457}event beginSrv(Sess_5318,Cli_5316,gNs_7474);
                                                    {9458}out(c, m2_7475);
                                                    {9459}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9460}event endSrv(Cli_5316,Sess_5318,PartC_7470)
                                        )
                                        else
                                            {9461}let pkDisco_7476: bitstring = fail-any in
                                            {9462}in(c, (=pkCli_7418,em1_7477: bitstring));
                                            {9463}let m1_7478: bitstring = em1_7477 in
                                            {9464}let (=OpenSecureChannelRequest,=pkCli_7418,PartC_7479: bitstring) = m1_7478 in
                                            {9465}new Ns_7480: bitstring;
                                            {9466}new ST_7481: bitstring;
                                            {9467}new TTL_7482: bitstring;
                                            {9468}let gNs_7483: bitstring = exp(g,Ns_7480) in
                                            {9469}let m2_7484: bitstring = (OpenSecureChannelResponse,gNs_7483,ST_7481,TTL_7482) in
                                            {9470}event beginSrv(Sess_5318,Cli_5316,gNs_7483);
                                            {9471}out(c, m2_7484);
                                            {9472}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9473}event endSrv(Cli_5316,Sess_5318,PartC_7479)
                                )
                                else
                                    {9474}let pkCli_7485: bitstring = fail-any in
                                    {9475}let v_7486: bool = (Disco_5317 = A) in
                                    (
                                        {9476}if v_7486 then
                                        (
                                            {9477}let pkDisco_7487: bitstring = pub(skA) in
                                            {9478}in(c, (=pkCli_7485,em1_7488: bitstring));
                                            {9479}let m1_7489: bitstring = em1_7488 in
                                            {9480}let (=OpenSecureChannelRequest,=pkCli_7485,PartC_7490: bitstring) = m1_7489 in
                                            {9481}new Ns_7491: bitstring;
                                            {9482}new ST_7492: bitstring;
                                            {9483}new TTL_7493: bitstring;
                                            {9484}let gNs_7494: bitstring = exp(g,Ns_7491) in
                                            {9485}let m2_7495: bitstring = (OpenSecureChannelResponse,gNs_7494,ST_7492,TTL_7493) in
                                            {9486}event beginSrv(Sess_5318,Cli_5316,gNs_7494);
                                            {9487}out(c, m2_7495);
                                            {9488}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9489}event endSrv(Cli_5316,Sess_5318,PartC_7490)
                                        )
                                        else
                                            {9490}let v_7496: bool = (Disco_5317 = B) in
                                            (
                                                {9491}if v_7496 then
                                                (
                                                    {9492}let pkDisco_7497: bitstring = pub(skB) in
                                                    {9493}in(c, (=pkCli_7485,em1_7498: bitstring));
                                                    {9494}let m1_7499: bitstring = em1_7498 in
                                                    {9495}let (=OpenSecureChannelRequest,=pkCli_7485,PartC_7500: bitstring) = m1_7499 in
                                                    {9496}new Ns_7501: bitstring;
                                                    {9497}new ST_7502: bitstring;
                                                    {9498}new TTL_7503: bitstring;
                                                    {9499}let gNs_7504: bitstring = exp(g,Ns_7501) in
                                                    {9500}let m2_7505: bitstring = (OpenSecureChannelResponse,gNs_7504,ST_7502,TTL_7503) in
                                                    {9501}event beginSrv(Sess_5318,Cli_5316,gNs_7504);
                                                    {9502}out(c, m2_7505);
                                                    {9503}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9504}event endSrv(Cli_5316,Sess_5318,PartC_7500)
                                                )
                                                else
                                                    {9505}let v_7506: bool = (Disco_5317 = C) in
                                                    (
                                                        {9506}if v_7506 then
                                                        (
                                                            {9507}let pkDisco_7507: bitstring = pub(skC) in
                                                            {9508}in(c, (=pkCli_7485,em1_7508: bitstring));
                                                            {9509}let m1_7509: bitstring = em1_7508 in
                                                            {9510}let (=OpenSecureChannelRequest,=pkCli_7485,PartC_7510: bitstring) = m1_7509 in
                                                            {9511}new Ns_7511: bitstring;
                                                            {9512}new ST_7512: bitstring;
                                                            {9513}new TTL_7513: bitstring;
                                                            {9514}let gNs_7514: bitstring = exp(g,Ns_7511) in
                                                            {9515}let m2_7515: bitstring = (OpenSecureChannelResponse,gNs_7514,ST_7512,TTL_7513) in
                                                            {9516}event beginSrv(Sess_5318,Cli_5316,gNs_7514);
                                                            {9517}out(c, m2_7515);
                                                            {9518}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {9519}event endSrv(Cli_5316,Sess_5318,PartC_7510)
                                                        )
                                                        else
                                                            {9520}let pkDisco_7516: bitstring = pub(sk(Disco_5317)) in
                                                            {9521}in(c, (=pkCli_7485,em1_7517: bitstring));
                                                            {9522}let m1_7518: bitstring = em1_7517 in
                                                            {9523}let (=OpenSecureChannelRequest,=pkCli_7485,PartC_7519: bitstring) = m1_7518 in
                                                            {9524}new Ns_7520: bitstring;
                                                            {9525}new ST_7521: bitstring;
                                                            {9526}new TTL_7522: bitstring;
                                                            {9527}let gNs_7523: bitstring = exp(g,Ns_7520) in
                                                            {9528}let m2_7524: bitstring = (OpenSecureChannelResponse,gNs_7523,ST_7521,TTL_7522) in
                                                            {9529}event beginSrv(Sess_5318,Cli_5316,gNs_7523);
                                                            {9530}out(c, m2_7524);
                                                            {9531}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                            {9532}event endSrv(Cli_5316,Sess_5318,PartC_7519)
                                                    )
                                                    else
                                                        {9533}let pkDisco_7525: bitstring = fail-any in
                                                        {9534}in(c, (=pkCli_7485,em1_7526: bitstring));
                                                        {9535}let m1_7527: bitstring = em1_7526 in
                                                        {9536}let (=OpenSecureChannelRequest,=pkCli_7485,PartC_7528: bitstring) = m1_7527 in
                                                        {9537}new Ns_7529: bitstring;
                                                        {9538}new ST_7530: bitstring;
                                                        {9539}new TTL_7531: bitstring;
                                                        {9540}let gNs_7532: bitstring = exp(g,Ns_7529) in
                                                        {9541}let m2_7533: bitstring = (OpenSecureChannelResponse,gNs_7532,ST_7530,TTL_7531) in
                                                        {9542}event beginSrv(Sess_5318,Cli_5316,gNs_7532);
                                                        {9543}out(c, m2_7533);
                                                        {9544}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {9545}event endSrv(Cli_5316,Sess_5318,PartC_7528)
                                            )
                                            else
                                                {9546}let pkDisco_7534: bitstring = fail-any in
                                                {9547}in(c, (=pkCli_7485,em1_7535: bitstring));
                                                {9548}let m1_7536: bitstring = em1_7535 in
                                                {9549}let (=OpenSecureChannelRequest,=pkCli_7485,PartC_7537: bitstring) = m1_7536 in
                                                {9550}new Ns_7538: bitstring;
                                                {9551}new ST_7539: bitstring;
                                                {9552}new TTL_7540: bitstring;
                                                {9553}let gNs_7541: bitstring = exp(g,Ns_7538) in
                                                {9554}let m2_7542: bitstring = (OpenSecureChannelResponse,gNs_7541,ST_7539,TTL_7540) in
                                                {9555}event beginSrv(Sess_5318,Cli_5316,gNs_7541);
                                                {9556}out(c, m2_7542);
                                                {9557}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9558}event endSrv(Cli_5316,Sess_5318,PartC_7537)
                                    )
                                    else
                                        {9559}let pkDisco_7543: bitstring = fail-any in
                                        {9560}in(c, (=pkCli_7485,em1_7544: bitstring));
                                        {9561}let m1_7545: bitstring = em1_7544 in
                                        {9562}let (=OpenSecureChannelRequest,=pkCli_7485,PartC_7546: bitstring) = m1_7545 in
                                        {9563}new Ns_7547: bitstring;
                                        {9564}new ST_7548: bitstring;
                                        {9565}new TTL_7549: bitstring;
                                        {9566}let gNs_7550: bitstring = exp(g,Ns_7547) in
                                        {9567}let m2_7551: bitstring = (OpenSecureChannelResponse,gNs_7550,ST_7548,TTL_7549) in
                                        {9568}event beginSrv(Sess_5318,Cli_5316,gNs_7550);
                                        {9569}out(c, m2_7551);
                                        {9570}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9571}event endSrv(Cli_5316,Sess_5318,PartC_7546)
                        )
                        else
                            {9572}let pkCli_7552: bitstring = fail-any in
                            {9573}let v_7553: bool = (Disco_5317 = A) in
                            (
                                {9574}if v_7553 then
                                (
                                    {9575}let pkDisco_7554: bitstring = pub(skA) in
                                    {9576}in(c, (=pkCli_7552,em1_7555: bitstring));
                                    {9577}let m1_7556: bitstring = em1_7555 in
                                    {9578}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7557: bitstring) = m1_7556 in
                                    {9579}new Ns_7558: bitstring;
                                    {9580}new ST_7559: bitstring;
                                    {9581}new TTL_7560: bitstring;
                                    {9582}let gNs_7561: bitstring = exp(g,Ns_7558) in
                                    {9583}let m2_7562: bitstring = (OpenSecureChannelResponse,gNs_7561,ST_7559,TTL_7560) in
                                    {9584}event beginSrv(Sess_5318,Cli_5316,gNs_7561);
                                    {9585}out(c, m2_7562);
                                    {9586}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {9587}event endSrv(Cli_5316,Sess_5318,PartC_7557)
                                )
                                else
                                    {9588}let v_7563: bool = (Disco_5317 = B) in
                                    (
                                        {9589}if v_7563 then
                                        (
                                            {9590}let pkDisco_7564: bitstring = pub(skB) in
                                            {9591}in(c, (=pkCli_7552,em1_7565: bitstring));
                                            {9592}let m1_7566: bitstring = em1_7565 in
                                            {9593}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7567: bitstring) = m1_7566 in
                                            {9594}new Ns_7568: bitstring;
                                            {9595}new ST_7569: bitstring;
                                            {9596}new TTL_7570: bitstring;
                                            {9597}let gNs_7571: bitstring = exp(g,Ns_7568) in
                                            {9598}let m2_7572: bitstring = (OpenSecureChannelResponse,gNs_7571,ST_7569,TTL_7570) in
                                            {9599}event beginSrv(Sess_5318,Cli_5316,gNs_7571);
                                            {9600}out(c, m2_7572);
                                            {9601}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9602}event endSrv(Cli_5316,Sess_5318,PartC_7567)
                                        )
                                        else
                                            {9603}let v_7573: bool = (Disco_5317 = C) in
                                            (
                                                {9604}if v_7573 then
                                                (
                                                    {9605}let pkDisco_7574: bitstring = pub(skC) in
                                                    {9606}in(c, (=pkCli_7552,em1_7575: bitstring));
                                                    {9607}let m1_7576: bitstring = em1_7575 in
                                                    {9608}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7577: bitstring) = m1_7576 in
                                                    {9609}new Ns_7578: bitstring;
                                                    {9610}new ST_7579: bitstring;
                                                    {9611}new TTL_7580: bitstring;
                                                    {9612}let gNs_7581: bitstring = exp(g,Ns_7578) in
                                                    {9613}let m2_7582: bitstring = (OpenSecureChannelResponse,gNs_7581,ST_7579,TTL_7580) in
                                                    {9614}event beginSrv(Sess_5318,Cli_5316,gNs_7581);
                                                    {9615}out(c, m2_7582);
                                                    {9616}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9617}event endSrv(Cli_5316,Sess_5318,PartC_7577)
                                                )
                                                else
                                                    {9618}let pkDisco_7583: bitstring = pub(sk(Disco_5317)) in
                                                    {9619}in(c, (=pkCli_7552,em1_7584: bitstring));
                                                    {9620}let m1_7585: bitstring = em1_7584 in
                                                    {9621}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7586: bitstring) = m1_7585 in
                                                    {9622}new Ns_7587: bitstring;
                                                    {9623}new ST_7588: bitstring;
                                                    {9624}new TTL_7589: bitstring;
                                                    {9625}let gNs_7590: bitstring = exp(g,Ns_7587) in
                                                    {9626}let m2_7591: bitstring = (OpenSecureChannelResponse,gNs_7590,ST_7588,TTL_7589) in
                                                    {9627}event beginSrv(Sess_5318,Cli_5316,gNs_7590);
                                                    {9628}out(c, m2_7591);
                                                    {9629}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {9630}event endSrv(Cli_5316,Sess_5318,PartC_7586)
                                            )
                                            else
                                                {9631}let pkDisco_7592: bitstring = fail-any in
                                                {9632}in(c, (=pkCli_7552,em1_7593: bitstring));
                                                {9633}let m1_7594: bitstring = em1_7593 in
                                                {9634}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7595: bitstring) = m1_7594 in
                                                {9635}new Ns_7596: bitstring;
                                                {9636}new ST_7597: bitstring;
                                                {9637}new TTL_7598: bitstring;
                                                {9638}let gNs_7599: bitstring = exp(g,Ns_7596) in
                                                {9639}let m2_7600: bitstring = (OpenSecureChannelResponse,gNs_7599,ST_7597,TTL_7598) in
                                                {9640}event beginSrv(Sess_5318,Cli_5316,gNs_7599);
                                                {9641}out(c, m2_7600);
                                                {9642}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9643}event endSrv(Cli_5316,Sess_5318,PartC_7595)
                                    )
                                    else
                                        {9644}let pkDisco_7601: bitstring = fail-any in
                                        {9645}in(c, (=pkCli_7552,em1_7602: bitstring));
                                        {9646}let m1_7603: bitstring = em1_7602 in
                                        {9647}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7604: bitstring) = m1_7603 in
                                        {9648}new Ns_7605: bitstring;
                                        {9649}new ST_7606: bitstring;
                                        {9650}new TTL_7607: bitstring;
                                        {9651}let gNs_7608: bitstring = exp(g,Ns_7605) in
                                        {9652}let m2_7609: bitstring = (OpenSecureChannelResponse,gNs_7608,ST_7606,TTL_7607) in
                                        {9653}event beginSrv(Sess_5318,Cli_5316,gNs_7608);
                                        {9654}out(c, m2_7609);
                                        {9655}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9656}event endSrv(Cli_5316,Sess_5318,PartC_7604)
                            )
                            else
                                {9657}let pkDisco_7610: bitstring = fail-any in
                                {9658}in(c, (=pkCli_7552,em1_7611: bitstring));
                                {9659}let m1_7612: bitstring = em1_7611 in
                                {9660}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7613: bitstring) = m1_7612 in
                                {9661}new Ns_7614: bitstring;
                                {9662}new ST_7615: bitstring;
                                {9663}new TTL_7616: bitstring;
                                {9664}let gNs_7617: bitstring = exp(g,Ns_7614) in
                                {9665}let m2_7618: bitstring = (OpenSecureChannelResponse,gNs_7617,ST_7615,TTL_7616) in
                                {9666}event beginSrv(Sess_5318,Cli_5316,gNs_7617);
                                {9667}out(c, m2_7618);
                                {9668}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {9669}event endSrv(Cli_5316,Sess_5318,PartC_7613)
                )
                else
                    {9670}let pkCli_7619: bitstring = fail-any in
                    {9671}let v_7620: bool = (Disco_5317 = A) in
                    (
                        {9672}if v_7620 then
                        (
                            {9673}let pkDisco_7621: bitstring = pub(skA) in
                            {9674}in(c, (=pkCli_7619,em1_7622: bitstring));
                            {9675}let m1_7623: bitstring = em1_7622 in
                            {9676}let (=OpenSecureChannelRequest,=pkCli_7619,PartC_7624: bitstring) = m1_7623 in
                            {9677}new Ns_7625: bitstring;
                            {9678}new ST_7626: bitstring;
                            {9679}new TTL_7627: bitstring;
                            {9680}let gNs_7628: bitstring = exp(g,Ns_7625) in
                            {9681}let m2_7629: bitstring = (OpenSecureChannelResponse,gNs_7628,ST_7626,TTL_7627) in
                            {9682}event beginSrv(Sess_5318,Cli_5316,gNs_7628);
                            {9683}out(c, m2_7629);
                            {9684}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {9685}event endSrv(Cli_5316,Sess_5318,PartC_7624)
                        )
                        else
                            {9686}let v_7630: bool = (Disco_5317 = B) in
                            (
                                {9687}if v_7630 then
                                (
                                    {9688}let pkDisco_7631: bitstring = pub(skB) in
                                    {9689}in(c, (=pkCli_7619,em1_7632: bitstring));
                                    {9690}let m1_7633: bitstring = em1_7632 in
                                    {9691}let (=OpenSecureChannelRequest,=pkCli_7619,PartC_7634: bitstring) = m1_7633 in
                                    {9692}new Ns_7635: bitstring;
                                    {9693}new ST_7636: bitstring;
                                    {9694}new TTL_7637: bitstring;
                                    {9695}let gNs_7638: bitstring = exp(g,Ns_7635) in
                                    {9696}let m2_7639: bitstring = (OpenSecureChannelResponse,gNs_7638,ST_7636,TTL_7637) in
                                    {9697}event beginSrv(Sess_5318,Cli_5316,gNs_7638);
                                    {9698}out(c, m2_7639);
                                    {9699}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {9700}event endSrv(Cli_5316,Sess_5318,PartC_7634)
                                )
                                else
                                    {9701}let v_7640: bool = (Disco_5317 = C) in
                                    (
                                        {9702}if v_7640 then
                                        (
                                            {9703}let pkDisco_7641: bitstring = pub(skC) in
                                            {9704}in(c, (=pkCli_7619,em1_7642: bitstring));
                                            {9705}let m1_7643: bitstring = em1_7642 in
                                            {9706}let (=OpenSecureChannelRequest,=pkCli_7619,PartC_7644: bitstring) = m1_7643 in
                                            {9707}new Ns_7645: bitstring;
                                            {9708}new ST_7646: bitstring;
                                            {9709}new TTL_7647: bitstring;
                                            {9710}let gNs_7648: bitstring = exp(g,Ns_7645) in
                                            {9711}let m2_7649: bitstring = (OpenSecureChannelResponse,gNs_7648,ST_7646,TTL_7647) in
                                            {9712}event beginSrv(Sess_5318,Cli_5316,gNs_7648);
                                            {9713}out(c, m2_7649);
                                            {9714}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9715}event endSrv(Cli_5316,Sess_5318,PartC_7644)
                                        )
                                        else
                                            {9716}let pkDisco_7650: bitstring = pub(sk(Disco_5317)) in
                                            {9717}in(c, (=pkCli_7619,em1_7651: bitstring));
                                            {9718}let m1_7652: bitstring = em1_7651 in
                                            {9719}let (=OpenSecureChannelRequest,=pkCli_7619,PartC_7653: bitstring) = m1_7652 in
                                            {9720}new Ns_7654: bitstring;
                                            {9721}new ST_7655: bitstring;
                                            {9722}new TTL_7656: bitstring;
                                            {9723}let gNs_7657: bitstring = exp(g,Ns_7654) in
                                            {9724}let m2_7658: bitstring = (OpenSecureChannelResponse,gNs_7657,ST_7655,TTL_7656) in
                                            {9725}event beginSrv(Sess_5318,Cli_5316,gNs_7657);
                                            {9726}out(c, m2_7658);
                                            {9727}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9728}event endSrv(Cli_5316,Sess_5318,PartC_7653)
                                    )
                                    else
                                        {9729}let pkDisco_7659: bitstring = fail-any in
                                        {9730}in(c, (=pkCli_7619,em1_7660: bitstring));
                                        {9731}let m1_7661: bitstring = em1_7660 in
                                        {9732}let (=OpenSecureChannelRequest,=pkCli_7619,PartC_7662: bitstring) = m1_7661 in
                                        {9733}new Ns_7663: bitstring;
                                        {9734}new ST_7664: bitstring;
                                        {9735}new TTL_7665: bitstring;
                                        {9736}let gNs_7666: bitstring = exp(g,Ns_7663) in
                                        {9737}let m2_7667: bitstring = (OpenSecureChannelResponse,gNs_7666,ST_7664,TTL_7665) in
                                        {9738}event beginSrv(Sess_5318,Cli_5316,gNs_7666);
                                        {9739}out(c, m2_7667);
                                        {9740}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9741}event endSrv(Cli_5316,Sess_5318,PartC_7662)
                            )
                            else
                                {9742}let pkDisco_7668: bitstring = fail-any in
                                {9743}in(c, (=pkCli_7619,em1_7669: bitstring));
                                {9744}let m1_7670: bitstring = em1_7669 in
                                {9745}let (=OpenSecureChannelRequest,=pkCli_7619,PartC_7671: bitstring) = m1_7670 in
                                {9746}new Ns_7672: bitstring;
                                {9747}new ST_7673: bitstring;
                                {9748}new TTL_7674: bitstring;
                                {9749}let gNs_7675: bitstring = exp(g,Ns_7672) in
                                {9750}let m2_7676: bitstring = (OpenSecureChannelResponse,gNs_7675,ST_7673,TTL_7674) in
                                {9751}event beginSrv(Sess_5318,Cli_5316,gNs_7675);
                                {9752}out(c, m2_7676);
                                {9753}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {9754}event endSrv(Cli_5316,Sess_5318,PartC_7671)
                    )
                    else
                        {9755}let pkDisco_7677: bitstring = fail-any in
                        {9756}in(c, (=pkCli_7619,em1_7678: bitstring));
                        {9757}let m1_7679: bitstring = em1_7678 in
                        {9758}let (=OpenSecureChannelRequest,=pkCli_7619,PartC_7680: bitstring) = m1_7679 in
                        {9759}new Ns_7681: bitstring;
                        {9760}new ST_7682: bitstring;
                        {9761}new TTL_7683: bitstring;
                        {9762}let gNs_7684: bitstring = exp(g,Ns_7681) in
                        {9763}let m2_7685: bitstring = (OpenSecureChannelResponse,gNs_7684,ST_7682,TTL_7683) in
                        {9764}event beginSrv(Sess_5318,Cli_5316,gNs_7684);
                        {9765}out(c, m2_7685);
                        {9766}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                        {9767}event endSrv(Cli_5316,Sess_5318,PartC_7680)
    )
    else
        {9768}let skSess_7686: bitstring = fail-any in
        {9769}let pkSess_7687: bitstring = pub(skSess_7686) in
        {9770}let v_7688: bool = (Cli_5316 = A) in
        (
            {9771}if v_7688 then
            (
                {9772}let pkCli_7689: bitstring = pub(skA) in
                {9773}let v_7690: bool = (Disco_5317 = A) in
                (
                    {9774}if v_7690 then
                    (
                        {9775}let pkDisco_7691: bitstring = pub(skA) in
                        {9776}in(c, (=pkCli_7689,em1_7692: bitstring));
                        {9777}let m1_7693: bitstring = em1_7692 in
                        {9778}let (=OpenSecureChannelRequest,=pkCli_7689,PartC_7694: bitstring) = m1_7693 in
                        {9779}new Ns_7695: bitstring;
                        {9780}new ST_7696: bitstring;
                        {9781}new TTL_7697: bitstring;
                        {9782}let gNs_7698: bitstring = exp(g,Ns_7695) in
                        {9783}let m2_7699: bitstring = (OpenSecureChannelResponse,gNs_7698,ST_7696,TTL_7697) in
                        {9784}event beginSrv(Sess_5318,Cli_5316,gNs_7698);
                        {9785}out(c, m2_7699);
                        {9786}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                        {9787}event endSrv(Cli_5316,Sess_5318,PartC_7694)
                    )
                    else
                        {9788}let v_7700: bool = (Disco_5317 = B) in
                        (
                            {9789}if v_7700 then
                            (
                                {9790}let pkDisco_7701: bitstring = pub(skB) in
                                {9791}in(c, (=pkCli_7689,em1_7702: bitstring));
                                {9792}let m1_7703: bitstring = em1_7702 in
                                {9793}let (=OpenSecureChannelRequest,=pkCli_7689,PartC_7704: bitstring) = m1_7703 in
                                {9794}new Ns_7705: bitstring;
                                {9795}new ST_7706: bitstring;
                                {9796}new TTL_7707: bitstring;
                                {9797}let gNs_7708: bitstring = exp(g,Ns_7705) in
                                {9798}let m2_7709: bitstring = (OpenSecureChannelResponse,gNs_7708,ST_7706,TTL_7707) in
                                {9799}event beginSrv(Sess_5318,Cli_5316,gNs_7708);
                                {9800}out(c, m2_7709);
                                {9801}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {9802}event endSrv(Cli_5316,Sess_5318,PartC_7704)
                            )
                            else
                                {9803}let v_7710: bool = (Disco_5317 = C) in
                                (
                                    {9804}if v_7710 then
                                    (
                                        {9805}let pkDisco_7711: bitstring = pub(skC) in
                                        {9806}in(c, (=pkCli_7689,em1_7712: bitstring));
                                        {9807}let m1_7713: bitstring = em1_7712 in
                                        {9808}let (=OpenSecureChannelRequest,=pkCli_7689,PartC_7714: bitstring) = m1_7713 in
                                        {9809}new Ns_7715: bitstring;
                                        {9810}new ST_7716: bitstring;
                                        {9811}new TTL_7717: bitstring;
                                        {9812}let gNs_7718: bitstring = exp(g,Ns_7715) in
                                        {9813}let m2_7719: bitstring = (OpenSecureChannelResponse,gNs_7718,ST_7716,TTL_7717) in
                                        {9814}event beginSrv(Sess_5318,Cli_5316,gNs_7718);
                                        {9815}out(c, m2_7719);
                                        {9816}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9817}event endSrv(Cli_5316,Sess_5318,PartC_7714)
                                    )
                                    else
                                        {9818}let pkDisco_7720: bitstring = pub(sk(Disco_5317)) in
                                        {9819}in(c, (=pkCli_7689,em1_7721: bitstring));
                                        {9820}let m1_7722: bitstring = em1_7721 in
                                        {9821}let (=OpenSecureChannelRequest,=pkCli_7689,PartC_7723: bitstring) = m1_7722 in
                                        {9822}new Ns_7724: bitstring;
                                        {9823}new ST_7725: bitstring;
                                        {9824}new TTL_7726: bitstring;
                                        {9825}let gNs_7727: bitstring = exp(g,Ns_7724) in
                                        {9826}let m2_7728: bitstring = (OpenSecureChannelResponse,gNs_7727,ST_7725,TTL_7726) in
                                        {9827}event beginSrv(Sess_5318,Cli_5316,gNs_7727);
                                        {9828}out(c, m2_7728);
                                        {9829}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9830}event endSrv(Cli_5316,Sess_5318,PartC_7723)
                                )
                                else
                                    {9831}let pkDisco_7729: bitstring = fail-any in
                                    {9832}in(c, (=pkCli_7689,em1_7730: bitstring));
                                    {9833}let m1_7731: bitstring = em1_7730 in
                                    {9834}let (=OpenSecureChannelRequest,=pkCli_7689,PartC_7732: bitstring) = m1_7731 in
                                    {9835}new Ns_7733: bitstring;
                                    {9836}new ST_7734: bitstring;
                                    {9837}new TTL_7735: bitstring;
                                    {9838}let gNs_7736: bitstring = exp(g,Ns_7733) in
                                    {9839}let m2_7737: bitstring = (OpenSecureChannelResponse,gNs_7736,ST_7734,TTL_7735) in
                                    {9840}event beginSrv(Sess_5318,Cli_5316,gNs_7736);
                                    {9841}out(c, m2_7737);
                                    {9842}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {9843}event endSrv(Cli_5316,Sess_5318,PartC_7732)
                        )
                        else
                            {9844}let pkDisco_7738: bitstring = fail-any in
                            {9845}in(c, (=pkCli_7689,em1_7739: bitstring));
                            {9846}let m1_7740: bitstring = em1_7739 in
                            {9847}let (=OpenSecureChannelRequest,=pkCli_7689,PartC_7741: bitstring) = m1_7740 in
                            {9848}new Ns_7742: bitstring;
                            {9849}new ST_7743: bitstring;
                            {9850}new TTL_7744: bitstring;
                            {9851}let gNs_7745: bitstring = exp(g,Ns_7742) in
                            {9852}let m2_7746: bitstring = (OpenSecureChannelResponse,gNs_7745,ST_7743,TTL_7744) in
                            {9853}event beginSrv(Sess_5318,Cli_5316,gNs_7745);
                            {9854}out(c, m2_7746);
                            {9855}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {9856}event endSrv(Cli_5316,Sess_5318,PartC_7741)
                )
                else
                    {9857}let pkDisco_7747: bitstring = fail-any in
                    {9858}in(c, (=pkCli_7689,em1_7748: bitstring));
                    {9859}let m1_7749: bitstring = em1_7748 in
                    {9860}let (=OpenSecureChannelRequest,=pkCli_7689,PartC_7750: bitstring) = m1_7749 in
                    {9861}new Ns_7751: bitstring;
                    {9862}new ST_7752: bitstring;
                    {9863}new TTL_7753: bitstring;
                    {9864}let gNs_7754: bitstring = exp(g,Ns_7751) in
                    {9865}let m2_7755: bitstring = (OpenSecureChannelResponse,gNs_7754,ST_7752,TTL_7753) in
                    {9866}event beginSrv(Sess_5318,Cli_5316,gNs_7754);
                    {9867}out(c, m2_7755);
                    {9868}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                    {9869}event endSrv(Cli_5316,Sess_5318,PartC_7750)
            )
            else
                {9870}let v_7756: bool = (Cli_5316 = B) in
                (
                    {9871}if v_7756 then
                    (
                        {9872}let pkCli_7757: bitstring = pub(skB) in
                        {9873}let v_7758: bool = (Disco_5317 = A) in
                        (
                            {9874}if v_7758 then
                            (
                                {9875}let pkDisco_7759: bitstring = pub(skA) in
                                {9876}in(c, (=pkCli_7757,em1_7760: bitstring));
                                {9877}let m1_7761: bitstring = em1_7760 in
                                {9878}let (=OpenSecureChannelRequest,=pkCli_7757,PartC_7762: bitstring) = m1_7761 in
                                {9879}new Ns_7763: bitstring;
                                {9880}new ST_7764: bitstring;
                                {9881}new TTL_7765: bitstring;
                                {9882}let gNs_7766: bitstring = exp(g,Ns_7763) in
                                {9883}let m2_7767: bitstring = (OpenSecureChannelResponse,gNs_7766,ST_7764,TTL_7765) in
                                {9884}event beginSrv(Sess_5318,Cli_5316,gNs_7766);
                                {9885}out(c, m2_7767);
                                {9886}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {9887}event endSrv(Cli_5316,Sess_5318,PartC_7762)
                            )
                            else
                                {9888}let v_7768: bool = (Disco_5317 = B) in
                                (
                                    {9889}if v_7768 then
                                    (
                                        {9890}let pkDisco_7769: bitstring = pub(skB) in
                                        {9891}in(c, (=pkCli_7757,em1_7770: bitstring));
                                        {9892}let m1_7771: bitstring = em1_7770 in
                                        {9893}let (=OpenSecureChannelRequest,=pkCli_7757,PartC_7772: bitstring) = m1_7771 in
                                        {9894}new Ns_7773: bitstring;
                                        {9895}new ST_7774: bitstring;
                                        {9896}new TTL_7775: bitstring;
                                        {9897}let gNs_7776: bitstring = exp(g,Ns_7773) in
                                        {9898}let m2_7777: bitstring = (OpenSecureChannelResponse,gNs_7776,ST_7774,TTL_7775) in
                                        {9899}event beginSrv(Sess_5318,Cli_5316,gNs_7776);
                                        {9900}out(c, m2_7777);
                                        {9901}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9902}event endSrv(Cli_5316,Sess_5318,PartC_7772)
                                    )
                                    else
                                        {9903}let v_7778: bool = (Disco_5317 = C) in
                                        (
                                            {9904}if v_7778 then
                                            (
                                                {9905}let pkDisco_7779: bitstring = pub(skC) in
                                                {9906}in(c, (=pkCli_7757,em1_7780: bitstring));
                                                {9907}let m1_7781: bitstring = em1_7780 in
                                                {9908}let (=OpenSecureChannelRequest,=pkCli_7757,PartC_7782: bitstring) = m1_7781 in
                                                {9909}new Ns_7783: bitstring;
                                                {9910}new ST_7784: bitstring;
                                                {9911}new TTL_7785: bitstring;
                                                {9912}let gNs_7786: bitstring = exp(g,Ns_7783) in
                                                {9913}let m2_7787: bitstring = (OpenSecureChannelResponse,gNs_7786,ST_7784,TTL_7785) in
                                                {9914}event beginSrv(Sess_5318,Cli_5316,gNs_7786);
                                                {9915}out(c, m2_7787);
                                                {9916}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9917}event endSrv(Cli_5316,Sess_5318,PartC_7782)
                                            )
                                            else
                                                {9918}let pkDisco_7788: bitstring = pub(sk(Disco_5317)) in
                                                {9919}in(c, (=pkCli_7757,em1_7789: bitstring));
                                                {9920}let m1_7790: bitstring = em1_7789 in
                                                {9921}let (=OpenSecureChannelRequest,=pkCli_7757,PartC_7791: bitstring) = m1_7790 in
                                                {9922}new Ns_7792: bitstring;
                                                {9923}new ST_7793: bitstring;
                                                {9924}new TTL_7794: bitstring;
                                                {9925}let gNs_7795: bitstring = exp(g,Ns_7792) in
                                                {9926}let m2_7796: bitstring = (OpenSecureChannelResponse,gNs_7795,ST_7793,TTL_7794) in
                                                {9927}event beginSrv(Sess_5318,Cli_5316,gNs_7795);
                                                {9928}out(c, m2_7796);
                                                {9929}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {9930}event endSrv(Cli_5316,Sess_5318,PartC_7791)
                                        )
                                        else
                                            {9931}let pkDisco_7797: bitstring = fail-any in
                                            {9932}in(c, (=pkCli_7757,em1_7798: bitstring));
                                            {9933}let m1_7799: bitstring = em1_7798 in
                                            {9934}let (=OpenSecureChannelRequest,=pkCli_7757,PartC_7800: bitstring) = m1_7799 in
                                            {9935}new Ns_7801: bitstring;
                                            {9936}new ST_7802: bitstring;
                                            {9937}new TTL_7803: bitstring;
                                            {9938}let gNs_7804: bitstring = exp(g,Ns_7801) in
                                            {9939}let m2_7805: bitstring = (OpenSecureChannelResponse,gNs_7804,ST_7802,TTL_7803) in
                                            {9940}event beginSrv(Sess_5318,Cli_5316,gNs_7804);
                                            {9941}out(c, m2_7805);
                                            {9942}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {9943}event endSrv(Cli_5316,Sess_5318,PartC_7800)
                                )
                                else
                                    {9944}let pkDisco_7806: bitstring = fail-any in
                                    {9945}in(c, (=pkCli_7757,em1_7807: bitstring));
                                    {9946}let m1_7808: bitstring = em1_7807 in
                                    {9947}let (=OpenSecureChannelRequest,=pkCli_7757,PartC_7809: bitstring) = m1_7808 in
                                    {9948}new Ns_7810: bitstring;
                                    {9949}new ST_7811: bitstring;
                                    {9950}new TTL_7812: bitstring;
                                    {9951}let gNs_7813: bitstring = exp(g,Ns_7810) in
                                    {9952}let m2_7814: bitstring = (OpenSecureChannelResponse,gNs_7813,ST_7811,TTL_7812) in
                                    {9953}event beginSrv(Sess_5318,Cli_5316,gNs_7813);
                                    {9954}out(c, m2_7814);
                                    {9955}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {9956}event endSrv(Cli_5316,Sess_5318,PartC_7809)
                        )
                        else
                            {9957}let pkDisco_7815: bitstring = fail-any in
                            {9958}in(c, (=pkCli_7757,em1_7816: bitstring));
                            {9959}let m1_7817: bitstring = em1_7816 in
                            {9960}let (=OpenSecureChannelRequest,=pkCli_7757,PartC_7818: bitstring) = m1_7817 in
                            {9961}new Ns_7819: bitstring;
                            {9962}new ST_7820: bitstring;
                            {9963}new TTL_7821: bitstring;
                            {9964}let gNs_7822: bitstring = exp(g,Ns_7819) in
                            {9965}let m2_7823: bitstring = (OpenSecureChannelResponse,gNs_7822,ST_7820,TTL_7821) in
                            {9966}event beginSrv(Sess_5318,Cli_5316,gNs_7822);
                            {9967}out(c, m2_7823);
                            {9968}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {9969}event endSrv(Cli_5316,Sess_5318,PartC_7818)
                    )
                    else
                        {9970}let v_7824: bool = (Cli_5316 = C) in
                        (
                            {9971}if v_7824 then
                            (
                                {9972}let pkCli_7825: bitstring = pub(skC) in
                                {9973}let v_7826: bool = (Disco_5317 = A) in
                                (
                                    {9974}if v_7826 then
                                    (
                                        {9975}let pkDisco_7827: bitstring = pub(skA) in
                                        {9976}in(c, (=pkCli_7825,em1_7828: bitstring));
                                        {9977}let m1_7829: bitstring = em1_7828 in
                                        {9978}let (=OpenSecureChannelRequest,=pkCli_7825,PartC_7830: bitstring) = m1_7829 in
                                        {9979}new Ns_7831: bitstring;
                                        {9980}new ST_7832: bitstring;
                                        {9981}new TTL_7833: bitstring;
                                        {9982}let gNs_7834: bitstring = exp(g,Ns_7831) in
                                        {9983}let m2_7835: bitstring = (OpenSecureChannelResponse,gNs_7834,ST_7832,TTL_7833) in
                                        {9984}event beginSrv(Sess_5318,Cli_5316,gNs_7834);
                                        {9985}out(c, m2_7835);
                                        {9986}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {9987}event endSrv(Cli_5316,Sess_5318,PartC_7830)
                                    )
                                    else
                                        {9988}let v_7836: bool = (Disco_5317 = B) in
                                        (
                                            {9989}if v_7836 then
                                            (
                                                {9990}let pkDisco_7837: bitstring = pub(skB) in
                                                {9991}in(c, (=pkCli_7825,em1_7838: bitstring));
                                                {9992}let m1_7839: bitstring = em1_7838 in
                                                {9993}let (=OpenSecureChannelRequest,=pkCli_7825,PartC_7840: bitstring) = m1_7839 in
                                                {9994}new Ns_7841: bitstring;
                                                {9995}new ST_7842: bitstring;
                                                {9996}new TTL_7843: bitstring;
                                                {9997}let gNs_7844: bitstring = exp(g,Ns_7841) in
                                                {9998}let m2_7845: bitstring = (OpenSecureChannelResponse,gNs_7844,ST_7842,TTL_7843) in
                                                {9999}event beginSrv(Sess_5318,Cli_5316,gNs_7844);
                                                {10000}out(c, m2_7845);
                                                {10001}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {10002}event endSrv(Cli_5316,Sess_5318,PartC_7840)
                                            )
                                            else
                                                {10003}let v_7846: bool = (Disco_5317 = C) in
                                                (
                                                    {10004}if v_7846 then
                                                    (
                                                        {10005}let pkDisco_7847: bitstring = pub(skC) in
                                                        {10006}in(c, (=pkCli_7825,em1_7848: bitstring));
                                                        {10007}let m1_7849: bitstring = em1_7848 in
                                                        {10008}let (=OpenSecureChannelRequest,=pkCli_7825,PartC_7850: bitstring) = m1_7849 in
                                                        {10009}new Ns_7851: bitstring;
                                                        {10010}new ST_7852: bitstring;
                                                        {10011}new TTL_7853: bitstring;
                                                        {10012}let gNs_7854: bitstring = exp(g,Ns_7851) in
                                                        {10013}let m2_7855: bitstring = (OpenSecureChannelResponse,gNs_7854,ST_7852,TTL_7853) in
                                                        {10014}event beginSrv(Sess_5318,Cli_5316,gNs_7854);
                                                        {10015}out(c, m2_7855);
                                                        {10016}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {10017}event endSrv(Cli_5316,Sess_5318,PartC_7850)
                                                    )
                                                    else
                                                        {10018}let pkDisco_7856: bitstring = pub(sk(Disco_5317)) in
                                                        {10019}in(c, (=pkCli_7825,em1_7857: bitstring));
                                                        {10020}let m1_7858: bitstring = em1_7857 in
                                                        {10021}let (=OpenSecureChannelRequest,=pkCli_7825,PartC_7859: bitstring) = m1_7858 in
                                                        {10022}new Ns_7860: bitstring;
                                                        {10023}new ST_7861: bitstring;
                                                        {10024}new TTL_7862: bitstring;
                                                        {10025}let gNs_7863: bitstring = exp(g,Ns_7860) in
                                                        {10026}let m2_7864: bitstring = (OpenSecureChannelResponse,gNs_7863,ST_7861,TTL_7862) in
                                                        {10027}event beginSrv(Sess_5318,Cli_5316,gNs_7863);
                                                        {10028}out(c, m2_7864);
                                                        {10029}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {10030}event endSrv(Cli_5316,Sess_5318,PartC_7859)
                                                )
                                                else
                                                    {10031}let pkDisco_7865: bitstring = fail-any in
                                                    {10032}in(c, (=pkCli_7825,em1_7866: bitstring));
                                                    {10033}let m1_7867: bitstring = em1_7866 in
                                                    {10034}let (=OpenSecureChannelRequest,=pkCli_7825,PartC_7868: bitstring) = m1_7867 in
                                                    {10035}new Ns_7869: bitstring;
                                                    {10036}new ST_7870: bitstring;
                                                    {10037}new TTL_7871: bitstring;
                                                    {10038}let gNs_7872: bitstring = exp(g,Ns_7869) in
                                                    {10039}let m2_7873: bitstring = (OpenSecureChannelResponse,gNs_7872,ST_7870,TTL_7871) in
                                                    {10040}event beginSrv(Sess_5318,Cli_5316,gNs_7872);
                                                    {10041}out(c, m2_7873);
                                                    {10042}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {10043}event endSrv(Cli_5316,Sess_5318,PartC_7868)
                                        )
                                        else
                                            {10044}let pkDisco_7874: bitstring = fail-any in
                                            {10045}in(c, (=pkCli_7825,em1_7875: bitstring));
                                            {10046}let m1_7876: bitstring = em1_7875 in
                                            {10047}let (=OpenSecureChannelRequest,=pkCli_7825,PartC_7877: bitstring) = m1_7876 in
                                            {10048}new Ns_7878: bitstring;
                                            {10049}new ST_7879: bitstring;
                                            {10050}new TTL_7880: bitstring;
                                            {10051}let gNs_7881: bitstring = exp(g,Ns_7878) in
                                            {10052}let m2_7882: bitstring = (OpenSecureChannelResponse,gNs_7881,ST_7879,TTL_7880) in
                                            {10053}event beginSrv(Sess_5318,Cli_5316,gNs_7881);
                                            {10054}out(c, m2_7882);
                                            {10055}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {10056}event endSrv(Cli_5316,Sess_5318,PartC_7877)
                                )
                                else
                                    {10057}let pkDisco_7883: bitstring = fail-any in
                                    {10058}in(c, (=pkCli_7825,em1_7884: bitstring));
                                    {10059}let m1_7885: bitstring = em1_7884 in
                                    {10060}let (=OpenSecureChannelRequest,=pkCli_7825,PartC_7886: bitstring) = m1_7885 in
                                    {10061}new Ns_7887: bitstring;
                                    {10062}new ST_7888: bitstring;
                                    {10063}new TTL_7889: bitstring;
                                    {10064}let gNs_7890: bitstring = exp(g,Ns_7887) in
                                    {10065}let m2_7891: bitstring = (OpenSecureChannelResponse,gNs_7890,ST_7888,TTL_7889) in
                                    {10066}event beginSrv(Sess_5318,Cli_5316,gNs_7890);
                                    {10067}out(c, m2_7891);
                                    {10068}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {10069}event endSrv(Cli_5316,Sess_5318,PartC_7886)
                            )
                            else
                                {10070}let pkCli_7892: bitstring = pub(sk(Cli_5316)) in
                                {10071}let v_7893: bool = (Disco_5317 = A) in
                                (
                                    {10072}if v_7893 then
                                    (
                                        {10073}let pkDisco_7894: bitstring = pub(skA) in
                                        {10074}in(c, (=pkCli_7892,em1_7895: bitstring));
                                        {10075}let m1_7896: bitstring = em1_7895 in
                                        {10076}let (=OpenSecureChannelRequest,=pkCli_7892,PartC_7897: bitstring) = m1_7896 in
                                        {10077}new Ns_7898: bitstring;
                                        {10078}new ST_7899: bitstring;
                                        {10079}new TTL_7900: bitstring;
                                        {10080}let gNs_7901: bitstring = exp(g,Ns_7898) in
                                        {10081}let m2_7902: bitstring = (OpenSecureChannelResponse,gNs_7901,ST_7899,TTL_7900) in
                                        {10082}event beginSrv(Sess_5318,Cli_5316,gNs_7901);
                                        {10083}out(c, m2_7902);
                                        {10084}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {10085}event endSrv(Cli_5316,Sess_5318,PartC_7897)
                                    )
                                    else
                                        {10086}let v_7903: bool = (Disco_5317 = B) in
                                        (
                                            {10087}if v_7903 then
                                            (
                                                {10088}let pkDisco_7904: bitstring = pub(skB) in
                                                {10089}in(c, (=pkCli_7892,em1_7905: bitstring));
                                                {10090}let m1_7906: bitstring = em1_7905 in
                                                {10091}let (=OpenSecureChannelRequest,=pkCli_7892,PartC_7907: bitstring) = m1_7906 in
                                                {10092}new Ns_7908: bitstring;
                                                {10093}new ST_7909: bitstring;
                                                {10094}new TTL_7910: bitstring;
                                                {10095}let gNs_7911: bitstring = exp(g,Ns_7908) in
                                                {10096}let m2_7912: bitstring = (OpenSecureChannelResponse,gNs_7911,ST_7909,TTL_7910) in
                                                {10097}event beginSrv(Sess_5318,Cli_5316,gNs_7911);
                                                {10098}out(c, m2_7912);
                                                {10099}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {10100}event endSrv(Cli_5316,Sess_5318,PartC_7907)
                                            )
                                            else
                                                {10101}let v_7913: bool = (Disco_5317 = C) in
                                                (
                                                    {10102}if v_7913 then
                                                    (
                                                        {10103}let pkDisco_7914: bitstring = pub(skC) in
                                                        {10104}in(c, (=pkCli_7892,em1_7915: bitstring));
                                                        {10105}let m1_7916: bitstring = em1_7915 in
                                                        {10106}let (=OpenSecureChannelRequest,=pkCli_7892,PartC_7917: bitstring) = m1_7916 in
                                                        {10107}new Ns_7918: bitstring;
                                                        {10108}new ST_7919: bitstring;
                                                        {10109}new TTL_7920: bitstring;
                                                        {10110}let gNs_7921: bitstring = exp(g,Ns_7918) in
                                                        {10111}let m2_7922: bitstring = (OpenSecureChannelResponse,gNs_7921,ST_7919,TTL_7920) in
                                                        {10112}event beginSrv(Sess_5318,Cli_5316,gNs_7921);
                                                        {10113}out(c, m2_7922);
                                                        {10114}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {10115}event endSrv(Cli_5316,Sess_5318,PartC_7917)
                                                    )
                                                    else
                                                        {10116}let pkDisco_7923: bitstring = pub(sk(Disco_5317)) in
                                                        {10117}in(c, (=pkCli_7892,em1_7924: bitstring));
                                                        {10118}let m1_7925: bitstring = em1_7924 in
                                                        {10119}let (=OpenSecureChannelRequest,=pkCli_7892,PartC_7926: bitstring) = m1_7925 in
                                                        {10120}new Ns_7927: bitstring;
                                                        {10121}new ST_7928: bitstring;
                                                        {10122}new TTL_7929: bitstring;
                                                        {10123}let gNs_7930: bitstring = exp(g,Ns_7927) in
                                                        {10124}let m2_7931: bitstring = (OpenSecureChannelResponse,gNs_7930,ST_7928,TTL_7929) in
                                                        {10125}event beginSrv(Sess_5318,Cli_5316,gNs_7930);
                                                        {10126}out(c, m2_7931);
                                                        {10127}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                        {10128}event endSrv(Cli_5316,Sess_5318,PartC_7926)
                                                )
                                                else
                                                    {10129}let pkDisco_7932: bitstring = fail-any in
                                                    {10130}in(c, (=pkCli_7892,em1_7933: bitstring));
                                                    {10131}let m1_7934: bitstring = em1_7933 in
                                                    {10132}let (=OpenSecureChannelRequest,=pkCli_7892,PartC_7935: bitstring) = m1_7934 in
                                                    {10133}new Ns_7936: bitstring;
                                                    {10134}new ST_7937: bitstring;
                                                    {10135}new TTL_7938: bitstring;
                                                    {10136}let gNs_7939: bitstring = exp(g,Ns_7936) in
                                                    {10137}let m2_7940: bitstring = (OpenSecureChannelResponse,gNs_7939,ST_7937,TTL_7938) in
                                                    {10138}event beginSrv(Sess_5318,Cli_5316,gNs_7939);
                                                    {10139}out(c, m2_7940);
                                                    {10140}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {10141}event endSrv(Cli_5316,Sess_5318,PartC_7935)
                                        )
                                        else
                                            {10142}let pkDisco_7941: bitstring = fail-any in
                                            {10143}in(c, (=pkCli_7892,em1_7942: bitstring));
                                            {10144}let m1_7943: bitstring = em1_7942 in
                                            {10145}let (=OpenSecureChannelRequest,=pkCli_7892,PartC_7944: bitstring) = m1_7943 in
                                            {10146}new Ns_7945: bitstring;
                                            {10147}new ST_7946: bitstring;
                                            {10148}new TTL_7947: bitstring;
                                            {10149}let gNs_7948: bitstring = exp(g,Ns_7945) in
                                            {10150}let m2_7949: bitstring = (OpenSecureChannelResponse,gNs_7948,ST_7946,TTL_7947) in
                                            {10151}event beginSrv(Sess_5318,Cli_5316,gNs_7948);
                                            {10152}out(c, m2_7949);
                                            {10153}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {10154}event endSrv(Cli_5316,Sess_5318,PartC_7944)
                                )
                                else
                                    {10155}let pkDisco_7950: bitstring = fail-any in
                                    {10156}in(c, (=pkCli_7892,em1_7951: bitstring));
                                    {10157}let m1_7952: bitstring = em1_7951 in
                                    {10158}let (=OpenSecureChannelRequest,=pkCli_7892,PartC_7953: bitstring) = m1_7952 in
                                    {10159}new Ns_7954: bitstring;
                                    {10160}new ST_7955: bitstring;
                                    {10161}new TTL_7956: bitstring;
                                    {10162}let gNs_7957: bitstring = exp(g,Ns_7954) in
                                    {10163}let m2_7958: bitstring = (OpenSecureChannelResponse,gNs_7957,ST_7955,TTL_7956) in
                                    {10164}event beginSrv(Sess_5318,Cli_5316,gNs_7957);
                                    {10165}out(c, m2_7958);
                                    {10166}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {10167}event endSrv(Cli_5316,Sess_5318,PartC_7953)
                        )
                        else
                            {10168}let pkCli_7959: bitstring = fail-any in
                            {10169}let v_7960: bool = (Disco_5317 = A) in
                            (
                                {10170}if v_7960 then
                                (
                                    {10171}let pkDisco_7961: bitstring = pub(skA) in
                                    {10172}in(c, (=pkCli_7959,em1_7962: bitstring));
                                    {10173}let m1_7963: bitstring = em1_7962 in
                                    {10174}let (=OpenSecureChannelRequest,=pkCli_7959,PartC_7964: bitstring) = m1_7963 in
                                    {10175}new Ns_7965: bitstring;
                                    {10176}new ST_7966: bitstring;
                                    {10177}new TTL_7967: bitstring;
                                    {10178}let gNs_7968: bitstring = exp(g,Ns_7965) in
                                    {10179}let m2_7969: bitstring = (OpenSecureChannelResponse,gNs_7968,ST_7966,TTL_7967) in
                                    {10180}event beginSrv(Sess_5318,Cli_5316,gNs_7968);
                                    {10181}out(c, m2_7969);
                                    {10182}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {10183}event endSrv(Cli_5316,Sess_5318,PartC_7964)
                                )
                                else
                                    {10184}let v_7970: bool = (Disco_5317 = B) in
                                    (
                                        {10185}if v_7970 then
                                        (
                                            {10186}let pkDisco_7971: bitstring = pub(skB) in
                                            {10187}in(c, (=pkCli_7959,em1_7972: bitstring));
                                            {10188}let m1_7973: bitstring = em1_7972 in
                                            {10189}let (=OpenSecureChannelRequest,=pkCli_7959,PartC_7974: bitstring) = m1_7973 in
                                            {10190}new Ns_7975: bitstring;
                                            {10191}new ST_7976: bitstring;
                                            {10192}new TTL_7977: bitstring;
                                            {10193}let gNs_7978: bitstring = exp(g,Ns_7975) in
                                            {10194}let m2_7979: bitstring = (OpenSecureChannelResponse,gNs_7978,ST_7976,TTL_7977) in
                                            {10195}event beginSrv(Sess_5318,Cli_5316,gNs_7978);
                                            {10196}out(c, m2_7979);
                                            {10197}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {10198}event endSrv(Cli_5316,Sess_5318,PartC_7974)
                                        )
                                        else
                                            {10199}let v_7980: bool = (Disco_5317 = C) in
                                            (
                                                {10200}if v_7980 then
                                                (
                                                    {10201}let pkDisco_7981: bitstring = pub(skC) in
                                                    {10202}in(c, (=pkCli_7959,em1_7982: bitstring));
                                                    {10203}let m1_7983: bitstring = em1_7982 in
                                                    {10204}let (=OpenSecureChannelRequest,=pkCli_7959,PartC_7984: bitstring) = m1_7983 in
                                                    {10205}new Ns_7985: bitstring;
                                                    {10206}new ST_7986: bitstring;
                                                    {10207}new TTL_7987: bitstring;
                                                    {10208}let gNs_7988: bitstring = exp(g,Ns_7985) in
                                                    {10209}let m2_7989: bitstring = (OpenSecureChannelResponse,gNs_7988,ST_7986,TTL_7987) in
                                                    {10210}event beginSrv(Sess_5318,Cli_5316,gNs_7988);
                                                    {10211}out(c, m2_7989);
                                                    {10212}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {10213}event endSrv(Cli_5316,Sess_5318,PartC_7984)
                                                )
                                                else
                                                    {10214}let pkDisco_7990: bitstring = pub(sk(Disco_5317)) in
                                                    {10215}in(c, (=pkCli_7959,em1_7991: bitstring));
                                                    {10216}let m1_7992: bitstring = em1_7991 in
                                                    {10217}let (=OpenSecureChannelRequest,=pkCli_7959,PartC_7993: bitstring) = m1_7992 in
                                                    {10218}new Ns_7994: bitstring;
                                                    {10219}new ST_7995: bitstring;
                                                    {10220}new TTL_7996: bitstring;
                                                    {10221}let gNs_7997: bitstring = exp(g,Ns_7994) in
                                                    {10222}let m2_7998: bitstring = (OpenSecureChannelResponse,gNs_7997,ST_7995,TTL_7996) in
                                                    {10223}event beginSrv(Sess_5318,Cli_5316,gNs_7997);
                                                    {10224}out(c, m2_7998);
                                                    {10225}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                    {10226}event endSrv(Cli_5316,Sess_5318,PartC_7993)
                                            )
                                            else
                                                {10227}let pkDisco_7999: bitstring = fail-any in
                                                {10228}in(c, (=pkCli_7959,em1_8000: bitstring));
                                                {10229}let m1_8001: bitstring = em1_8000 in
                                                {10230}let (=OpenSecureChannelRequest,=pkCli_7959,PartC_8002: bitstring) = m1_8001 in
                                                {10231}new Ns_8003: bitstring;
                                                {10232}new ST_8004: bitstring;
                                                {10233}new TTL_8005: bitstring;
                                                {10234}let gNs_8006: bitstring = exp(g,Ns_8003) in
                                                {10235}let m2_8007: bitstring = (OpenSecureChannelResponse,gNs_8006,ST_8004,TTL_8005) in
                                                {10236}event beginSrv(Sess_5318,Cli_5316,gNs_8006);
                                                {10237}out(c, m2_8007);
                                                {10238}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                                {10239}event endSrv(Cli_5316,Sess_5318,PartC_8002)
                                    )
                                    else
                                        {10240}let pkDisco_8008: bitstring = fail-any in
                                        {10241}in(c, (=pkCli_7959,em1_8009: bitstring));
                                        {10242}let m1_8010: bitstring = em1_8009 in
                                        {10243}let (=OpenSecureChannelRequest,=pkCli_7959,PartC_8011: bitstring) = m1_8010 in
                                        {10244}new Ns_8012: bitstring;
                                        {10245}new ST_8013: bitstring;
                                        {10246}new TTL_8014: bitstring;
                                        {10247}let gNs_8015: bitstring = exp(g,Ns_8012) in
                                        {10248}let m2_8016: bitstring = (OpenSecureChannelResponse,gNs_8015,ST_8013,TTL_8014) in
                                        {10249}event beginSrv(Sess_5318,Cli_5316,gNs_8015);
                                        {10250}out(c, m2_8016);
                                        {10251}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {10252}event endSrv(Cli_5316,Sess_5318,PartC_8011)
                            )
                            else
                                {10253}let pkDisco_8017: bitstring = fail-any in
                                {10254}in(c, (=pkCli_7959,em1_8018: bitstring));
                                {10255}let m1_8019: bitstring = em1_8018 in
                                {10256}let (=OpenSecureChannelRequest,=pkCli_7959,PartC_8020: bitstring) = m1_8019 in
                                {10257}new Ns_8021: bitstring;
                                {10258}new ST_8022: bitstring;
                                {10259}new TTL_8023: bitstring;
                                {10260}let gNs_8024: bitstring = exp(g,Ns_8021) in
                                {10261}let m2_8025: bitstring = (OpenSecureChannelResponse,gNs_8024,ST_8022,TTL_8023) in
                                {10262}event beginSrv(Sess_5318,Cli_5316,gNs_8024);
                                {10263}out(c, m2_8025);
                                {10264}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {10265}event endSrv(Cli_5316,Sess_5318,PartC_8020)
                )
                else
                    {10266}let pkCli_8026: bitstring = fail-any in
                    {10267}let v_8027: bool = (Disco_5317 = A) in
                    (
                        {10268}if v_8027 then
                        (
                            {10269}let pkDisco_8028: bitstring = pub(skA) in
                            {10270}in(c, (=pkCli_8026,em1_8029: bitstring));
                            {10271}let m1_8030: bitstring = em1_8029 in
                            {10272}let (=OpenSecureChannelRequest,=pkCli_8026,PartC_8031: bitstring) = m1_8030 in
                            {10273}new Ns_8032: bitstring;
                            {10274}new ST_8033: bitstring;
                            {10275}new TTL_8034: bitstring;
                            {10276}let gNs_8035: bitstring = exp(g,Ns_8032) in
                            {10277}let m2_8036: bitstring = (OpenSecureChannelResponse,gNs_8035,ST_8033,TTL_8034) in
                            {10278}event beginSrv(Sess_5318,Cli_5316,gNs_8035);
                            {10279}out(c, m2_8036);
                            {10280}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {10281}event endSrv(Cli_5316,Sess_5318,PartC_8031)
                        )
                        else
                            {10282}let v_8037: bool = (Disco_5317 = B) in
                            (
                                {10283}if v_8037 then
                                (
                                    {10284}let pkDisco_8038: bitstring = pub(skB) in
                                    {10285}in(c, (=pkCli_8026,em1_8039: bitstring));
                                    {10286}let m1_8040: bitstring = em1_8039 in
                                    {10287}let (=OpenSecureChannelRequest,=pkCli_8026,PartC_8041: bitstring) = m1_8040 in
                                    {10288}new Ns_8042: bitstring;
                                    {10289}new ST_8043: bitstring;
                                    {10290}new TTL_8044: bitstring;
                                    {10291}let gNs_8045: bitstring = exp(g,Ns_8042) in
                                    {10292}let m2_8046: bitstring = (OpenSecureChannelResponse,gNs_8045,ST_8043,TTL_8044) in
                                    {10293}event beginSrv(Sess_5318,Cli_5316,gNs_8045);
                                    {10294}out(c, m2_8046);
                                    {10295}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {10296}event endSrv(Cli_5316,Sess_5318,PartC_8041)
                                )
                                else
                                    {10297}let v_8047: bool = (Disco_5317 = C) in
                                    (
                                        {10298}if v_8047 then
                                        (
                                            {10299}let pkDisco_8048: bitstring = pub(skC) in
                                            {10300}in(c, (=pkCli_8026,em1_8049: bitstring));
                                            {10301}let m1_8050: bitstring = em1_8049 in
                                            {10302}let (=OpenSecureChannelRequest,=pkCli_8026,PartC_8051: bitstring) = m1_8050 in
                                            {10303}new Ns_8052: bitstring;
                                            {10304}new ST_8053: bitstring;
                                            {10305}new TTL_8054: bitstring;
                                            {10306}let gNs_8055: bitstring = exp(g,Ns_8052) in
                                            {10307}let m2_8056: bitstring = (OpenSecureChannelResponse,gNs_8055,ST_8053,TTL_8054) in
                                            {10308}event beginSrv(Sess_5318,Cli_5316,gNs_8055);
                                            {10309}out(c, m2_8056);
                                            {10310}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {10311}event endSrv(Cli_5316,Sess_5318,PartC_8051)
                                        )
                                        else
                                            {10312}let pkDisco_8057: bitstring = pub(sk(Disco_5317)) in
                                            {10313}in(c, (=pkCli_8026,em1_8058: bitstring));
                                            {10314}let m1_8059: bitstring = em1_8058 in
                                            {10315}let (=OpenSecureChannelRequest,=pkCli_8026,PartC_8060: bitstring) = m1_8059 in
                                            {10316}new Ns_8061: bitstring;
                                            {10317}new ST_8062: bitstring;
                                            {10318}new TTL_8063: bitstring;
                                            {10319}let gNs_8064: bitstring = exp(g,Ns_8061) in
                                            {10320}let m2_8065: bitstring = (OpenSecureChannelResponse,gNs_8064,ST_8062,TTL_8063) in
                                            {10321}event beginSrv(Sess_5318,Cli_5316,gNs_8064);
                                            {10322}out(c, m2_8065);
                                            {10323}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                            {10324}event endSrv(Cli_5316,Sess_5318,PartC_8060)
                                    )
                                    else
                                        {10325}let pkDisco_8066: bitstring = fail-any in
                                        {10326}in(c, (=pkCli_8026,em1_8067: bitstring));
                                        {10327}let m1_8068: bitstring = em1_8067 in
                                        {10328}let (=OpenSecureChannelRequest,=pkCli_8026,PartC_8069: bitstring) = m1_8068 in
                                        {10329}new Ns_8070: bitstring;
                                        {10330}new ST_8071: bitstring;
                                        {10331}new TTL_8072: bitstring;
                                        {10332}let gNs_8073: bitstring = exp(g,Ns_8070) in
                                        {10333}let m2_8074: bitstring = (OpenSecureChannelResponse,gNs_8073,ST_8071,TTL_8072) in
                                        {10334}event beginSrv(Sess_5318,Cli_5316,gNs_8073);
                                        {10335}out(c, m2_8074);
                                        {10336}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                        {10337}event endSrv(Cli_5316,Sess_5318,PartC_8069)
                            )
                            else
                                {10338}let pkDisco_8075: bitstring = fail-any in
                                {10339}in(c, (=pkCli_8026,em1_8076: bitstring));
                                {10340}let m1_8077: bitstring = em1_8076 in
                                {10341}let (=OpenSecureChannelRequest,=pkCli_8026,PartC_8078: bitstring) = m1_8077 in
                                {10342}new Ns_8079: bitstring;
                                {10343}new ST_8080: bitstring;
                                {10344}new TTL_8081: bitstring;
                                {10345}let gNs_8082: bitstring = exp(g,Ns_8079) in
                                {10346}let m2_8083: bitstring = (OpenSecureChannelResponse,gNs_8082,ST_8080,TTL_8081) in
                                {10347}event beginSrv(Sess_5318,Cli_5316,gNs_8082);
                                {10348}out(c, m2_8083);
                                {10349}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {10350}event endSrv(Cli_5316,Sess_5318,PartC_8078)
                    )
                    else
                        {10351}let pkDisco_8084: bitstring = fail-any in
                        {10352}in(c, (=pkCli_8026,em1_8085: bitstring));
                        {10353}let m1_8086: bitstring = em1_8085 in
                        {10354}let (=OpenSecureChannelRequest,=pkCli_8026,PartC_8087: bitstring) = m1_8086 in
                        {10355}new Ns_8088: bitstring;
                        {10356}new ST_8089: bitstring;
                        {10357}new TTL_8090: bitstring;
                        {10358}let gNs_8091: bitstring = exp(g,Ns_8088) in
                        {10359}let m2_8092: bitstring = (OpenSecureChannelResponse,gNs_8091,ST_8089,TTL_8090) in
                        {10360}event beginSrv(Sess_5318,Cli_5316,gNs_8091);
                        {10361}out(c, m2_8092);
                        {10362}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                        {10363}event endSrv(Cli_5316,Sess_5318,PartC_8087)
        )
        else
            {10364}let pkCli_8093: bitstring = fail-any in
            {10365}let v_8094: bool = (Disco_5317 = A) in
            (
                {10366}if v_8094 then
                (
                    {10367}let pkDisco_8095: bitstring = pub(skA) in
                    {10368}in(c, (=pkCli_8093,em1_8096: bitstring));
                    {10369}let m1_8097: bitstring = em1_8096 in
                    {10370}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8098: bitstring) = m1_8097 in
                    {10371}new Ns_8099: bitstring;
                    {10372}new ST_8100: bitstring;
                    {10373}new TTL_8101: bitstring;
                    {10374}let gNs_8102: bitstring = exp(g,Ns_8099) in
                    {10375}let m2_8103: bitstring = (OpenSecureChannelResponse,gNs_8102,ST_8100,TTL_8101) in
                    {10376}event beginSrv(Sess_5318,Cli_5316,gNs_8102);
                    {10377}out(c, m2_8103);
                    {10378}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                    {10379}event endSrv(Cli_5316,Sess_5318,PartC_8098)
                )
                else
                    {10380}let v_8104: bool = (Disco_5317 = B) in
                    (
                        {10381}if v_8104 then
                        (
                            {10382}let pkDisco_8105: bitstring = pub(skB) in
                            {10383}in(c, (=pkCli_8093,em1_8106: bitstring));
                            {10384}let m1_8107: bitstring = em1_8106 in
                            {10385}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8108: bitstring) = m1_8107 in
                            {10386}new Ns_8109: bitstring;
                            {10387}new ST_8110: bitstring;
                            {10388}new TTL_8111: bitstring;
                            {10389}let gNs_8112: bitstring = exp(g,Ns_8109) in
                            {10390}let m2_8113: bitstring = (OpenSecureChannelResponse,gNs_8112,ST_8110,TTL_8111) in
                            {10391}event beginSrv(Sess_5318,Cli_5316,gNs_8112);
                            {10392}out(c, m2_8113);
                            {10393}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                            {10394}event endSrv(Cli_5316,Sess_5318,PartC_8108)
                        )
                        else
                            {10395}let v_8114: bool = (Disco_5317 = C) in
                            (
                                {10396}if v_8114 then
                                (
                                    {10397}let pkDisco_8115: bitstring = pub(skC) in
                                    {10398}in(c, (=pkCli_8093,em1_8116: bitstring));
                                    {10399}let m1_8117: bitstring = em1_8116 in
                                    {10400}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8118: bitstring) = m1_8117 in
                                    {10401}new Ns_8119: bitstring;
                                    {10402}new ST_8120: bitstring;
                                    {10403}new TTL_8121: bitstring;
                                    {10404}let gNs_8122: bitstring = exp(g,Ns_8119) in
                                    {10405}let m2_8123: bitstring = (OpenSecureChannelResponse,gNs_8122,ST_8120,TTL_8121) in
                                    {10406}event beginSrv(Sess_5318,Cli_5316,gNs_8122);
                                    {10407}out(c, m2_8123);
                                    {10408}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {10409}event endSrv(Cli_5316,Sess_5318,PartC_8118)
                                )
                                else
                                    {10410}let pkDisco_8124: bitstring = pub(sk(Disco_5317)) in
                                    {10411}in(c, (=pkCli_8093,em1_8125: bitstring));
                                    {10412}let m1_8126: bitstring = em1_8125 in
                                    {10413}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8127: bitstring) = m1_8126 in
                                    {10414}new Ns_8128: bitstring;
                                    {10415}new ST_8129: bitstring;
                                    {10416}new TTL_8130: bitstring;
                                    {10417}let gNs_8131: bitstring = exp(g,Ns_8128) in
                                    {10418}let m2_8132: bitstring = (OpenSecureChannelResponse,gNs_8131,ST_8129,TTL_8130) in
                                    {10419}event beginSrv(Sess_5318,Cli_5316,gNs_8131);
                                    {10420}out(c, m2_8132);
                                    {10421}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                    {10422}event endSrv(Cli_5316,Sess_5318,PartC_8127)
                            )
                            else
                                {10423}let pkDisco_8133: bitstring = fail-any in
                                {10424}in(c, (=pkCli_8093,em1_8134: bitstring));
                                {10425}let m1_8135: bitstring = em1_8134 in
                                {10426}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8136: bitstring) = m1_8135 in
                                {10427}new Ns_8137: bitstring;
                                {10428}new ST_8138: bitstring;
                                {10429}new TTL_8139: bitstring;
                                {10430}let gNs_8140: bitstring = exp(g,Ns_8137) in
                                {10431}let m2_8141: bitstring = (OpenSecureChannelResponse,gNs_8140,ST_8138,TTL_8139) in
                                {10432}event beginSrv(Sess_5318,Cli_5316,gNs_8140);
                                {10433}out(c, m2_8141);
                                {10434}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                                {10435}event endSrv(Cli_5316,Sess_5318,PartC_8136)
                    )
                    else
                        {10436}let pkDisco_8142: bitstring = fail-any in
                        {10437}in(c, (=pkCli_8093,em1_8143: bitstring));
                        {10438}let m1_8144: bitstring = em1_8143 in
                        {10439}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8145: bitstring) = m1_8144 in
                        {10440}new Ns_8146: bitstring;
                        {10441}new ST_8147: bitstring;
                        {10442}new TTL_8148: bitstring;
                        {10443}let gNs_8149: bitstring = exp(g,Ns_8146) in
                        {10444}let m2_8150: bitstring = (OpenSecureChannelResponse,gNs_8149,ST_8147,TTL_8148) in
                        {10445}event beginSrv(Sess_5318,Cli_5316,gNs_8149);
                        {10446}out(c, m2_8150);
                        {10447}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                        {10448}event endSrv(Cli_5316,Sess_5318,PartC_8145)
            )
            else
                {10449}let pkDisco_8151: bitstring = fail-any in
                {10450}in(c, (=pkCli_8093,em1_8152: bitstring));
                {10451}let m1_8153: bitstring = em1_8152 in
                {10452}let (=OpenSecureChannelRequest,=pkCli_8093,PartC_8154: bitstring) = m1_8153 in
                {10453}new Ns_8155: bitstring;
                {10454}new ST_8156: bitstring;
                {10455}new TTL_8157: bitstring;
                {10456}let gNs_8158: bitstring = exp(g,Ns_8155) in
                {10457}let m2_8159: bitstring = (OpenSecureChannelResponse,gNs_8158,ST_8156,TTL_8157) in
                {10458}event beginSrv(Sess_5318,Cli_5316,gNs_8158);
                {10459}out(c, m2_8159);
                {10460}if ((Cli_5316 = A) || ((Cli_5316 = B) || (Cli_5316 = C))) then
                {10461}event endSrv(Cli_5316,Sess_5318,PartC_8154)
)

-- Query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
Completing...
200 rules inserted. The rule base contains 84 rules. 349 rules in the queue.
400 rules inserted. The rule base contains 120 rules. 349 rules in the queue.
600 rules inserted. The rule base contains 129 rules. 347 rules in the queue.
800 rules inserted. The rule base contains 118 rules. 346 rules in the queue.
1000 rules inserted. The rule base contains 117 rules. 321 rules in the queue.
1200 rules inserted. The rule base contains 95 rules. 319 rules in the queue.
1400 rules inserted. The rule base contains 169 rules. 250 rules in the queue.
1600 rules inserted. The rule base contains 246 rules. 195 rules in the queue.
1800 rules inserted. The rule base contains 398 rules. 94 rules in the queue.
Starting query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
RESULT event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N)) is true.
-- Query event(endSrv(X_45444,Y_45445,N_45446)) ==> event(beginCli(X_45444,Y_45445,N_45446))
Completing...
200 rules inserted. The rule base contains 75 rules. 349 rules in the queue.
400 rules inserted. The rule base contains 111 rules. 349 rules in the queue.
600 rules inserted. The rule base contains 111 rules. 347 rules in the queue.
800 rules inserted. The rule base contains 99 rules. 346 rules in the queue.
1000 rules inserted. The rule base contains 99 rules. 321 rules in the queue.
1200 rules inserted. The rule base contains 84 rules. 312 rules in the queue.
1400 rules inserted. The rule base contains 154 rules. 247 rules in the queue.
1600 rules inserted. The rule base contains 240 rules. 185 rules in the queue.
1800 rules inserted. The rule base contains 398 rules. 79 rules in the queue.
Starting query event(endSrv(X_45444,Y_45445,N_45446)) ==> event(beginCli(X_45444,Y_45445,N_45446))
goal reachable: attacker(N_83134) -> end(endSrv(B[],C[],N_83134))

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (B[],B[],C[]).
attacker((B[],B[],C[])).

4. We assume as hypothesis that
attacker(N_83158).

5. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

6. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

7. By 6, the attacker may know OpenSecureChannelRequest.
By 5, the attacker may know pub(skB[]).
By 4, the attacker may know N_83158.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skB[]),N_83158).
attacker((OpenSecureChannelRequest,pub(skB[]),N_83158)).

8. By 5, the attacker may know pub(skB[]).
By 7, the attacker may know (OpenSecureChannelRequest,pub(skB[]),N_83158).
Using the function 2-tuple the attacker may obtain (pub(skB[]),(OpenSecureChannelRequest,pub(skB[]),N_83158)).
attacker((pub(skB[]),(OpenSecureChannelRequest,pub(skB[]),N_83158))).

9. The message (B[],B[],C[]) that the attacker may have by 3 may be received at input {6292}.
The message (pub(skB[]),(OpenSecureChannelRequest,pub(skB[]),N_83158)) that the attacker may have by 8 may be received at input {7809}.
So event endSrv(B[],C[],N_83158) may be executed at {7820}.
end(endSrv(B[],C[],N_83158)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (B,B,C)) at {6292} in copy a_83159

in(c, (pub(skB),(OpenSecureChannelRequest,pub(skB),a))) at {7809} in copy a_83159

new Ns_6351 creating Ns_109004 at {7812} in copy a_83159

new ST_6352 creating ST_109005 at {7813} in copy a_83159

new TTL_6353 creating TTL_109006 at {7814} in copy a_83159

event(beginSrv(C,B,exp(g,Ns_109004))) at {7817} in copy a_83159

out(c, (OpenSecureChannelResponse,exp(g,Ns_109004),ST_109005,TTL_109006)) at {7818} in copy a_83159

event(endSrv(B,C,a)) at {7820} in copy a_83159

The event endSrv(B,C,a) is executed.
A trace has been found.
RESULT event(endSrv(X_45444,Y_45445,N_45446)) ==> event(beginCli(X_45444,Y_45445,N_45446)) is false.
