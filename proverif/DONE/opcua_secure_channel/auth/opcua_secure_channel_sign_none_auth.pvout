Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
{7}new skI: bitstring;
{8}out(c, skI);
(
    {9}!
    {10}in(c, (Cli: host,Disco: host,Sess: host));
    {11}let v_594: bool = (Cli = A) in
    (
        {12}if v_594 then
        (
            {13}let skCli: bitstring = skA in
            {14}let pkCli: bitstring = pub(skCli) in
            {15}let v_595: bool = (Disco = A) in
            (
                {16}if v_595 then
                (
                    {17}let pkDisco: bitstring = pub(skA) in
                    {18}let v_596: bool = (Sess = A) in
                    (
                        {19}if v_596 then
                        (
                            {20}let pkSess: bitstring = pub(skA) in
                            {21}out(c, GetEndpointRequest);
                            {22}in(c, (SPs: bitstring,=Sign,UP: bitstring,=pkSess));
                            {23}new SPc: bitstring;
                            {24}new Nc: bitstring;
                            {25}let gNc: bitstring = exp(g,Nc) in
                            {26}let m1: bitstring = (SPc,gNc) in
                            {27}event beginCli(Cli,Sess,gNc);
                            {28}out(c, (pkCli,m1,sign(m1,skCli)));
                            {29}in(c, (PartS: bitstring,sigPartS: bitstring));
                            {30}if (verify(PartS,sigPartS,pkSess) <> true) then
                                0
                            else
                                {31}event endCli(Sess,Cli,PartS)
                        )
                        else
                            {32}let v_597: bool = (Sess = B) in
                            (
                                {33}if v_597 then
                                (
                                    {34}let pkSess_598: bitstring = pub(skB) in
                                    {35}out(c, GetEndpointRequest);
                                    {36}in(c, (SPs_599: bitstring,=Sign,UP_600: bitstring,=pkSess_598));
                                    {37}new SPc_601: bitstring;
                                    {38}new Nc_602: bitstring;
                                    {39}let gNc_603: bitstring = exp(g,Nc_602) in
                                    {40}let m1_604: bitstring = (SPc_601,gNc_603) in
                                    {41}event beginCli(Cli,Sess,gNc_603);
                                    {42}out(c, (pkCli,m1_604,sign(m1_604,skCli)));
                                    {43}in(c, (PartS_605: bitstring,sigPartS_606: bitstring));
                                    {44}if (verify(PartS_605,sigPartS_606,pkSess_598) <> true) then
                                        0
                                    else
                                        {45}event endCli(Sess,Cli,PartS_605)
                                )
                                else
                                    {46}let v_607: bool = (Sess = C) in
                                    (
                                        {47}if v_607 then
                                        (
                                            {48}let pkSess_608: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (SPs_609: bitstring,=Sign,UP_610: bitstring,=pkSess_608));
                                            {51}new SPc_611: bitstring;
                                            {52}new Nc_612: bitstring;
                                            {53}let gNc_613: bitstring = exp(g,Nc_612) in
                                            {54}let m1_614: bitstring = (SPc_611,gNc_613) in
                                            {55}event beginCli(Cli,Sess,gNc_613);
                                            {56}out(c, (pkCli,m1_614,sign(m1_614,skCli)));
                                            {57}in(c, (PartS_615: bitstring,sigPartS_616: bitstring));
                                            {58}if (verify(PartS_615,sigPartS_616,pkSess_608) <> true) then
                                                0
                                            else
                                                {59}event endCli(Sess,Cli,PartS_615)
                                        )
                                        else
                                            {60}let pkSess_617: bitstring = pub(skI) in
                                            {61}out(c, GetEndpointRequest);
                                            {62}in(c, (SPs_618: bitstring,=Sign,UP_619: bitstring,=pkSess_617));
                                            {63}new SPc_620: bitstring;
                                            {64}new Nc_621: bitstring;
                                            {65}let gNc_622: bitstring = exp(g,Nc_621) in
                                            {66}let m1_623: bitstring = (SPc_620,gNc_622) in
                                            {67}event beginCli(Cli,Sess,gNc_622);
                                            {68}out(c, (pkCli,m1_623,sign(m1_623,skCli)));
                                            {69}in(c, (PartS_624: bitstring,sigPartS_625: bitstring));
                                            {70}if (verify(PartS_624,sigPartS_625,pkSess_617) <> true) then
                                                0
                                            else
                                                {71}event endCli(Sess,Cli,PartS_624)
                                    )
                                    else
                                        {72}let pkSess_626: bitstring = fail-any in
                                        {73}out(c, GetEndpointRequest);
                                        {74}in(c, (SPs_627: bitstring,=Sign,UP_628: bitstring,=pkSess_626));
                                        {75}new SPc_629: bitstring;
                                        {76}new Nc_630: bitstring;
                                        {77}let gNc_631: bitstring = exp(g,Nc_630) in
                                        {78}let m1_632: bitstring = (SPc_629,gNc_631) in
                                        {79}event beginCli(Cli,Sess,gNc_631);
                                        {80}out(c, (pkCli,m1_632,sign(m1_632,skCli)));
                                        {81}in(c, (PartS_633: bitstring,sigPartS_634: bitstring));
                                        {82}if (verify(PartS_633,sigPartS_634,pkSess_626) <> true) then
                                            0
                                        else
                                            {83}event endCli(Sess,Cli,PartS_633)
                            )
                            else
                                {84}let pkSess_635: bitstring = fail-any in
                                {85}out(c, GetEndpointRequest);
                                {86}in(c, (SPs_636: bitstring,=Sign,UP_637: bitstring,=pkSess_635));
                                {87}new SPc_638: bitstring;
                                {88}new Nc_639: bitstring;
                                {89}let gNc_640: bitstring = exp(g,Nc_639) in
                                {90}let m1_641: bitstring = (SPc_638,gNc_640) in
                                {91}event beginCli(Cli,Sess,gNc_640);
                                {92}out(c, (pkCli,m1_641,sign(m1_641,skCli)));
                                {93}in(c, (PartS_642: bitstring,sigPartS_643: bitstring));
                                {94}if (verify(PartS_642,sigPartS_643,pkSess_635) <> true) then
                                    0
                                else
                                    {95}event endCli(Sess,Cli,PartS_642)
                    )
                    else
                        {96}let pkSess_644: bitstring = fail-any in
                        {97}out(c, GetEndpointRequest);
                        {98}in(c, (SPs_645: bitstring,=Sign,UP_646: bitstring,=pkSess_644));
                        {99}new SPc_647: bitstring;
                        {100}new Nc_648: bitstring;
                        {101}let gNc_649: bitstring = exp(g,Nc_648) in
                        {102}let m1_650: bitstring = (SPc_647,gNc_649) in
                        {103}event beginCli(Cli,Sess,gNc_649);
                        {104}out(c, (pkCli,m1_650,sign(m1_650,skCli)));
                        {105}in(c, (PartS_651: bitstring,sigPartS_652: bitstring));
                        {106}if (verify(PartS_651,sigPartS_652,pkSess_644) <> true) then
                            0
                        else
                            {107}event endCli(Sess,Cli,PartS_651)
                )
                else
                    {108}let v_653: bool = (Disco = B) in
                    (
                        {109}if v_653 then
                        (
                            {110}let pkDisco_654: bitstring = pub(skB) in
                            {111}let v_655: bool = (Sess = A) in
                            (
                                {112}if v_655 then
                                (
                                    {113}let pkSess_656: bitstring = pub(skA) in
                                    {114}out(c, GetEndpointRequest);
                                    {115}in(c, (SPs_657: bitstring,=Sign,UP_658: bitstring,=pkSess_656));
                                    {116}new SPc_659: bitstring;
                                    {117}new Nc_660: bitstring;
                                    {118}let gNc_661: bitstring = exp(g,Nc_660) in
                                    {119}let m1_662: bitstring = (SPc_659,gNc_661) in
                                    {120}event beginCli(Cli,Sess,gNc_661);
                                    {121}out(c, (pkCli,m1_662,sign(m1_662,skCli)));
                                    {122}in(c, (PartS_663: bitstring,sigPartS_664: bitstring));
                                    {123}if (verify(PartS_663,sigPartS_664,pkSess_656) <> true) then
                                        0
                                    else
                                        {124}event endCli(Sess,Cli,PartS_663)
                                )
                                else
                                    {125}let v_665: bool = (Sess = B) in
                                    (
                                        {126}if v_665 then
                                        (
                                            {127}let pkSess_666: bitstring = pub(skB) in
                                            {128}out(c, GetEndpointRequest);
                                            {129}in(c, (SPs_667: bitstring,=Sign,UP_668: bitstring,=pkSess_666));
                                            {130}new SPc_669: bitstring;
                                            {131}new Nc_670: bitstring;
                                            {132}let gNc_671: bitstring = exp(g,Nc_670) in
                                            {133}let m1_672: bitstring = (SPc_669,gNc_671) in
                                            {134}event beginCli(Cli,Sess,gNc_671);
                                            {135}out(c, (pkCli,m1_672,sign(m1_672,skCli)));
                                            {136}in(c, (PartS_673: bitstring,sigPartS_674: bitstring));
                                            {137}if (verify(PartS_673,sigPartS_674,pkSess_666) <> true) then
                                                0
                                            else
                                                {138}event endCli(Sess,Cli,PartS_673)
                                        )
                                        else
                                            {139}let v_675: bool = (Sess = C) in
                                            (
                                                {140}if v_675 then
                                                (
                                                    {141}let pkSess_676: bitstring = pub(skC) in
                                                    {142}out(c, GetEndpointRequest);
                                                    {143}in(c, (SPs_677: bitstring,=Sign,UP_678: bitstring,=pkSess_676));
                                                    {144}new SPc_679: bitstring;
                                                    {145}new Nc_680: bitstring;
                                                    {146}let gNc_681: bitstring = exp(g,Nc_680) in
                                                    {147}let m1_682: bitstring = (SPc_679,gNc_681) in
                                                    {148}event beginCli(Cli,Sess,gNc_681);
                                                    {149}out(c, (pkCli,m1_682,sign(m1_682,skCli)));
                                                    {150}in(c, (PartS_683: bitstring,sigPartS_684: bitstring));
                                                    {151}if (verify(PartS_683,sigPartS_684,pkSess_676) <> true) then
                                                        0
                                                    else
                                                        {152}event endCli(Sess,Cli,PartS_683)
                                                )
                                                else
                                                    {153}let pkSess_685: bitstring = pub(skI) in
                                                    {154}out(c, GetEndpointRequest);
                                                    {155}in(c, (SPs_686: bitstring,=Sign,UP_687: bitstring,=pkSess_685));
                                                    {156}new SPc_688: bitstring;
                                                    {157}new Nc_689: bitstring;
                                                    {158}let gNc_690: bitstring = exp(g,Nc_689) in
                                                    {159}let m1_691: bitstring = (SPc_688,gNc_690) in
                                                    {160}event beginCli(Cli,Sess,gNc_690);
                                                    {161}out(c, (pkCli,m1_691,sign(m1_691,skCli)));
                                                    {162}in(c, (PartS_692: bitstring,sigPartS_693: bitstring));
                                                    {163}if (verify(PartS_692,sigPartS_693,pkSess_685) <> true) then
                                                        0
                                                    else
                                                        {164}event endCli(Sess,Cli,PartS_692)
                                            )
                                            else
                                                {165}let pkSess_694: bitstring = fail-any in
                                                {166}out(c, GetEndpointRequest);
                                                {167}in(c, (SPs_695: bitstring,=Sign,UP_696: bitstring,=pkSess_694));
                                                {168}new SPc_697: bitstring;
                                                {169}new Nc_698: bitstring;
                                                {170}let gNc_699: bitstring = exp(g,Nc_698) in
                                                {171}let m1_700: bitstring = (SPc_697,gNc_699) in
                                                {172}event beginCli(Cli,Sess,gNc_699);
                                                {173}out(c, (pkCli,m1_700,sign(m1_700,skCli)));
                                                {174}in(c, (PartS_701: bitstring,sigPartS_702: bitstring));
                                                {175}if (verify(PartS_701,sigPartS_702,pkSess_694) <> true) then
                                                    0
                                                else
                                                    {176}event endCli(Sess,Cli,PartS_701)
                                    )
                                    else
                                        {177}let pkSess_703: bitstring = fail-any in
                                        {178}out(c, GetEndpointRequest);
                                        {179}in(c, (SPs_704: bitstring,=Sign,UP_705: bitstring,=pkSess_703));
                                        {180}new SPc_706: bitstring;
                                        {181}new Nc_707: bitstring;
                                        {182}let gNc_708: bitstring = exp(g,Nc_707) in
                                        {183}let m1_709: bitstring = (SPc_706,gNc_708) in
                                        {184}event beginCli(Cli,Sess,gNc_708);
                                        {185}out(c, (pkCli,m1_709,sign(m1_709,skCli)));
                                        {186}in(c, (PartS_710: bitstring,sigPartS_711: bitstring));
                                        {187}if (verify(PartS_710,sigPartS_711,pkSess_703) <> true) then
                                            0
                                        else
                                            {188}event endCli(Sess,Cli,PartS_710)
                            )
                            else
                                {189}let pkSess_712: bitstring = fail-any in
                                {190}out(c, GetEndpointRequest);
                                {191}in(c, (SPs_713: bitstring,=Sign,UP_714: bitstring,=pkSess_712));
                                {192}new SPc_715: bitstring;
                                {193}new Nc_716: bitstring;
                                {194}let gNc_717: bitstring = exp(g,Nc_716) in
                                {195}let m1_718: bitstring = (SPc_715,gNc_717) in
                                {196}event beginCli(Cli,Sess,gNc_717);
                                {197}out(c, (pkCli,m1_718,sign(m1_718,skCli)));
                                {198}in(c, (PartS_719: bitstring,sigPartS_720: bitstring));
                                {199}if (verify(PartS_719,sigPartS_720,pkSess_712) <> true) then
                                    0
                                else
                                    {200}event endCli(Sess,Cli,PartS_719)
                        )
                        else
                            {201}let v_721: bool = (Disco = C) in
                            (
                                {202}if v_721 then
                                (
                                    {203}let pkDisco_722: bitstring = pub(skC) in
                                    {204}let v_723: bool = (Sess = A) in
                                    (
                                        {205}if v_723 then
                                        (
                                            {206}let pkSess_724: bitstring = pub(skA) in
                                            {207}out(c, GetEndpointRequest);
                                            {208}in(c, (SPs_725: bitstring,=Sign,UP_726: bitstring,=pkSess_724));
                                            {209}new SPc_727: bitstring;
                                            {210}new Nc_728: bitstring;
                                            {211}let gNc_729: bitstring = exp(g,Nc_728) in
                                            {212}let m1_730: bitstring = (SPc_727,gNc_729) in
                                            {213}event beginCli(Cli,Sess,gNc_729);
                                            {214}out(c, (pkCli,m1_730,sign(m1_730,skCli)));
                                            {215}in(c, (PartS_731: bitstring,sigPartS_732: bitstring));
                                            {216}if (verify(PartS_731,sigPartS_732,pkSess_724) <> true) then
                                                0
                                            else
                                                {217}event endCli(Sess,Cli,PartS_731)
                                        )
                                        else
                                            {218}let v_733: bool = (Sess = B) in
                                            (
                                                {219}if v_733 then
                                                (
                                                    {220}let pkSess_734: bitstring = pub(skB) in
                                                    {221}out(c, GetEndpointRequest);
                                                    {222}in(c, (SPs_735: bitstring,=Sign,UP_736: bitstring,=pkSess_734));
                                                    {223}new SPc_737: bitstring;
                                                    {224}new Nc_738: bitstring;
                                                    {225}let gNc_739: bitstring = exp(g,Nc_738) in
                                                    {226}let m1_740: bitstring = (SPc_737,gNc_739) in
                                                    {227}event beginCli(Cli,Sess,gNc_739);
                                                    {228}out(c, (pkCli,m1_740,sign(m1_740,skCli)));
                                                    {229}in(c, (PartS_741: bitstring,sigPartS_742: bitstring));
                                                    {230}if (verify(PartS_741,sigPartS_742,pkSess_734) <> true) then
                                                        0
                                                    else
                                                        {231}event endCli(Sess,Cli,PartS_741)
                                                )
                                                else
                                                    {232}let v_743: bool = (Sess = C) in
                                                    (
                                                        {233}if v_743 then
                                                        (
                                                            {234}let pkSess_744: bitstring = pub(skC) in
                                                            {235}out(c, GetEndpointRequest);
                                                            {236}in(c, (SPs_745: bitstring,=Sign,UP_746: bitstring,=pkSess_744));
                                                            {237}new SPc_747: bitstring;
                                                            {238}new Nc_748: bitstring;
                                                            {239}let gNc_749: bitstring = exp(g,Nc_748) in
                                                            {240}let m1_750: bitstring = (SPc_747,gNc_749) in
                                                            {241}event beginCli(Cli,Sess,gNc_749);
                                                            {242}out(c, (pkCli,m1_750,sign(m1_750,skCli)));
                                                            {243}in(c, (PartS_751: bitstring,sigPartS_752: bitstring));
                                                            {244}if (verify(PartS_751,sigPartS_752,pkSess_744) <> true) then
                                                                0
                                                            else
                                                                {245}event endCli(Sess,Cli,PartS_751)
                                                        )
                                                        else
                                                            {246}let pkSess_753: bitstring = pub(skI) in
                                                            {247}out(c, GetEndpointRequest);
                                                            {248}in(c, (SPs_754: bitstring,=Sign,UP_755: bitstring,=pkSess_753));
                                                            {249}new SPc_756: bitstring;
                                                            {250}new Nc_757: bitstring;
                                                            {251}let gNc_758: bitstring = exp(g,Nc_757) in
                                                            {252}let m1_759: bitstring = (SPc_756,gNc_758) in
                                                            {253}event beginCli(Cli,Sess,gNc_758);
                                                            {254}out(c, (pkCli,m1_759,sign(m1_759,skCli)));
                                                            {255}in(c, (PartS_760: bitstring,sigPartS_761: bitstring));
                                                            {256}if (verify(PartS_760,sigPartS_761,pkSess_753) <> true) then
                                                                0
                                                            else
                                                                {257}event endCli(Sess,Cli,PartS_760)
                                                    )
                                                    else
                                                        {258}let pkSess_762: bitstring = fail-any in
                                                        {259}out(c, GetEndpointRequest);
                                                        {260}in(c, (SPs_763: bitstring,=Sign,UP_764: bitstring,=pkSess_762));
                                                        {261}new SPc_765: bitstring;
                                                        {262}new Nc_766: bitstring;
                                                        {263}let gNc_767: bitstring = exp(g,Nc_766) in
                                                        {264}let m1_768: bitstring = (SPc_765,gNc_767) in
                                                        {265}event beginCli(Cli,Sess,gNc_767);
                                                        {266}out(c, (pkCli,m1_768,sign(m1_768,skCli)));
                                                        {267}in(c, (PartS_769: bitstring,sigPartS_770: bitstring));
                                                        {268}if (verify(PartS_769,sigPartS_770,pkSess_762) <> true) then
                                                            0
                                                        else
                                                            {269}event endCli(Sess,Cli,PartS_769)
                                            )
                                            else
                                                {270}let pkSess_771: bitstring = fail-any in
                                                {271}out(c, GetEndpointRequest);
                                                {272}in(c, (SPs_772: bitstring,=Sign,UP_773: bitstring,=pkSess_771));
                                                {273}new SPc_774: bitstring;
                                                {274}new Nc_775: bitstring;
                                                {275}let gNc_776: bitstring = exp(g,Nc_775) in
                                                {276}let m1_777: bitstring = (SPc_774,gNc_776) in
                                                {277}event beginCli(Cli,Sess,gNc_776);
                                                {278}out(c, (pkCli,m1_777,sign(m1_777,skCli)));
                                                {279}in(c, (PartS_778: bitstring,sigPartS_779: bitstring));
                                                {280}if (verify(PartS_778,sigPartS_779,pkSess_771) <> true) then
                                                    0
                                                else
                                                    {281}event endCli(Sess,Cli,PartS_778)
                                    )
                                    else
                                        {282}let pkSess_780: bitstring = fail-any in
                                        {283}out(c, GetEndpointRequest);
                                        {284}in(c, (SPs_781: bitstring,=Sign,UP_782: bitstring,=pkSess_780));
                                        {285}new SPc_783: bitstring;
                                        {286}new Nc_784: bitstring;
                                        {287}let gNc_785: bitstring = exp(g,Nc_784) in
                                        {288}let m1_786: bitstring = (SPc_783,gNc_785) in
                                        {289}event beginCli(Cli,Sess,gNc_785);
                                        {290}out(c, (pkCli,m1_786,sign(m1_786,skCli)));
                                        {291}in(c, (PartS_787: bitstring,sigPartS_788: bitstring));
                                        {292}if (verify(PartS_787,sigPartS_788,pkSess_780) <> true) then
                                            0
                                        else
                                            {293}event endCli(Sess,Cli,PartS_787)
                                )
                                else
                                    {294}let pkDisco_789: bitstring = pub(skI) in
                                    {295}let v_790: bool = (Sess = A) in
                                    (
                                        {296}if v_790 then
                                        (
                                            {297}let pkSess_791: bitstring = pub(skA) in
                                            {298}out(c, GetEndpointRequest);
                                            {299}in(c, (SPs_792: bitstring,=Sign,UP_793: bitstring,=pkSess_791));
                                            {300}new SPc_794: bitstring;
                                            {301}new Nc_795: bitstring;
                                            {302}let gNc_796: bitstring = exp(g,Nc_795) in
                                            {303}let m1_797: bitstring = (SPc_794,gNc_796) in
                                            {304}event beginCli(Cli,Sess,gNc_796);
                                            {305}out(c, (pkCli,m1_797,sign(m1_797,skCli)));
                                            {306}in(c, (PartS_798: bitstring,sigPartS_799: bitstring));
                                            {307}if (verify(PartS_798,sigPartS_799,pkSess_791) <> true) then
                                                0
                                            else
                                                {308}event endCli(Sess,Cli,PartS_798)
                                        )
                                        else
                                            {309}let v_800: bool = (Sess = B) in
                                            (
                                                {310}if v_800 then
                                                (
                                                    {311}let pkSess_801: bitstring = pub(skB) in
                                                    {312}out(c, GetEndpointRequest);
                                                    {313}in(c, (SPs_802: bitstring,=Sign,UP_803: bitstring,=pkSess_801));
                                                    {314}new SPc_804: bitstring;
                                                    {315}new Nc_805: bitstring;
                                                    {316}let gNc_806: bitstring = exp(g,Nc_805) in
                                                    {317}let m1_807: bitstring = (SPc_804,gNc_806) in
                                                    {318}event beginCli(Cli,Sess,gNc_806);
                                                    {319}out(c, (pkCli,m1_807,sign(m1_807,skCli)));
                                                    {320}in(c, (PartS_808: bitstring,sigPartS_809: bitstring));
                                                    {321}if (verify(PartS_808,sigPartS_809,pkSess_801) <> true) then
                                                        0
                                                    else
                                                        {322}event endCli(Sess,Cli,PartS_808)
                                                )
                                                else
                                                    {323}let v_810: bool = (Sess = C) in
                                                    (
                                                        {324}if v_810 then
                                                        (
                                                            {325}let pkSess_811: bitstring = pub(skC) in
                                                            {326}out(c, GetEndpointRequest);
                                                            {327}in(c, (SPs_812: bitstring,=Sign,UP_813: bitstring,=pkSess_811));
                                                            {328}new SPc_814: bitstring;
                                                            {329}new Nc_815: bitstring;
                                                            {330}let gNc_816: bitstring = exp(g,Nc_815) in
                                                            {331}let m1_817: bitstring = (SPc_814,gNc_816) in
                                                            {332}event beginCli(Cli,Sess,gNc_816);
                                                            {333}out(c, (pkCli,m1_817,sign(m1_817,skCli)));
                                                            {334}in(c, (PartS_818: bitstring,sigPartS_819: bitstring));
                                                            {335}if (verify(PartS_818,sigPartS_819,pkSess_811) <> true) then
                                                                0
                                                            else
                                                                {336}event endCli(Sess,Cli,PartS_818)
                                                        )
                                                        else
                                                            {337}let pkSess_820: bitstring = pub(skI) in
                                                            {338}out(c, GetEndpointRequest);
                                                            {339}in(c, (SPs_821: bitstring,=Sign,UP_822: bitstring,=pkSess_820));
                                                            {340}new SPc_823: bitstring;
                                                            {341}new Nc_824: bitstring;
                                                            {342}let gNc_825: bitstring = exp(g,Nc_824) in
                                                            {343}let m1_826: bitstring = (SPc_823,gNc_825) in
                                                            {344}event beginCli(Cli,Sess,gNc_825);
                                                            {345}out(c, (pkCli,m1_826,sign(m1_826,skCli)));
                                                            {346}in(c, (PartS_827: bitstring,sigPartS_828: bitstring));
                                                            {347}if (verify(PartS_827,sigPartS_828,pkSess_820) <> true) then
                                                                0
                                                            else
                                                                {348}event endCli(Sess,Cli,PartS_827)
                                                    )
                                                    else
                                                        {349}let pkSess_829: bitstring = fail-any in
                                                        {350}out(c, GetEndpointRequest);
                                                        {351}in(c, (SPs_830: bitstring,=Sign,UP_831: bitstring,=pkSess_829));
                                                        {352}new SPc_832: bitstring;
                                                        {353}new Nc_833: bitstring;
                                                        {354}let gNc_834: bitstring = exp(g,Nc_833) in
                                                        {355}let m1_835: bitstring = (SPc_832,gNc_834) in
                                                        {356}event beginCli(Cli,Sess,gNc_834);
                                                        {357}out(c, (pkCli,m1_835,sign(m1_835,skCli)));
                                                        {358}in(c, (PartS_836: bitstring,sigPartS_837: bitstring));
                                                        {359}if (verify(PartS_836,sigPartS_837,pkSess_829) <> true) then
                                                            0
                                                        else
                                                            {360}event endCli(Sess,Cli,PartS_836)
                                            )
                                            else
                                                {361}let pkSess_838: bitstring = fail-any in
                                                {362}out(c, GetEndpointRequest);
                                                {363}in(c, (SPs_839: bitstring,=Sign,UP_840: bitstring,=pkSess_838));
                                                {364}new SPc_841: bitstring;
                                                {365}new Nc_842: bitstring;
                                                {366}let gNc_843: bitstring = exp(g,Nc_842) in
                                                {367}let m1_844: bitstring = (SPc_841,gNc_843) in
                                                {368}event beginCli(Cli,Sess,gNc_843);
                                                {369}out(c, (pkCli,m1_844,sign(m1_844,skCli)));
                                                {370}in(c, (PartS_845: bitstring,sigPartS_846: bitstring));
                                                {371}if (verify(PartS_845,sigPartS_846,pkSess_838) <> true) then
                                                    0
                                                else
                                                    {372}event endCli(Sess,Cli,PartS_845)
                                    )
                                    else
                                        {373}let pkSess_847: bitstring = fail-any in
                                        {374}out(c, GetEndpointRequest);
                                        {375}in(c, (SPs_848: bitstring,=Sign,UP_849: bitstring,=pkSess_847));
                                        {376}new SPc_850: bitstring;
                                        {377}new Nc_851: bitstring;
                                        {378}let gNc_852: bitstring = exp(g,Nc_851) in
                                        {379}let m1_853: bitstring = (SPc_850,gNc_852) in
                                        {380}event beginCli(Cli,Sess,gNc_852);
                                        {381}out(c, (pkCli,m1_853,sign(m1_853,skCli)));
                                        {382}in(c, (PartS_854: bitstring,sigPartS_855: bitstring));
                                        {383}if (verify(PartS_854,sigPartS_855,pkSess_847) <> true) then
                                            0
                                        else
                                            {384}event endCli(Sess,Cli,PartS_854)
                            )
                            else
                                {385}let pkDisco_856: bitstring = fail-any in
                                {386}let v_857: bool = (Sess = A) in
                                (
                                    {387}if v_857 then
                                    (
                                        {388}let pkSess_858: bitstring = pub(skA) in
                                        {389}out(c, GetEndpointRequest);
                                        {390}in(c, (SPs_859: bitstring,=Sign,UP_860: bitstring,=pkSess_858));
                                        {391}new SPc_861: bitstring;
                                        {392}new Nc_862: bitstring;
                                        {393}let gNc_863: bitstring = exp(g,Nc_862) in
                                        {394}let m1_864: bitstring = (SPc_861,gNc_863) in
                                        {395}event beginCli(Cli,Sess,gNc_863);
                                        {396}out(c, (pkCli,m1_864,sign(m1_864,skCli)));
                                        {397}in(c, (PartS_865: bitstring,sigPartS_866: bitstring));
                                        {398}if (verify(PartS_865,sigPartS_866,pkSess_858) <> true) then
                                            0
                                        else
                                            {399}event endCli(Sess,Cli,PartS_865)
                                    )
                                    else
                                        {400}let v_867: bool = (Sess = B) in
                                        (
                                            {401}if v_867 then
                                            (
                                                {402}let pkSess_868: bitstring = pub(skB) in
                                                {403}out(c, GetEndpointRequest);
                                                {404}in(c, (SPs_869: bitstring,=Sign,UP_870: bitstring,=pkSess_868));
                                                {405}new SPc_871: bitstring;
                                                {406}new Nc_872: bitstring;
                                                {407}let gNc_873: bitstring = exp(g,Nc_872) in
                                                {408}let m1_874: bitstring = (SPc_871,gNc_873) in
                                                {409}event beginCli(Cli,Sess,gNc_873);
                                                {410}out(c, (pkCli,m1_874,sign(m1_874,skCli)));
                                                {411}in(c, (PartS_875: bitstring,sigPartS_876: bitstring));
                                                {412}if (verify(PartS_875,sigPartS_876,pkSess_868) <> true) then
                                                    0
                                                else
                                                    {413}event endCli(Sess,Cli,PartS_875)
                                            )
                                            else
                                                {414}let v_877: bool = (Sess = C) in
                                                (
                                                    {415}if v_877 then
                                                    (
                                                        {416}let pkSess_878: bitstring = pub(skC) in
                                                        {417}out(c, GetEndpointRequest);
                                                        {418}in(c, (SPs_879: bitstring,=Sign,UP_880: bitstring,=pkSess_878));
                                                        {419}new SPc_881: bitstring;
                                                        {420}new Nc_882: bitstring;
                                                        {421}let gNc_883: bitstring = exp(g,Nc_882) in
                                                        {422}let m1_884: bitstring = (SPc_881,gNc_883) in
                                                        {423}event beginCli(Cli,Sess,gNc_883);
                                                        {424}out(c, (pkCli,m1_884,sign(m1_884,skCli)));
                                                        {425}in(c, (PartS_885: bitstring,sigPartS_886: bitstring));
                                                        {426}if (verify(PartS_885,sigPartS_886,pkSess_878) <> true) then
                                                            0
                                                        else
                                                            {427}event endCli(Sess,Cli,PartS_885)
                                                    )
                                                    else
                                                        {428}let pkSess_887: bitstring = pub(skI) in
                                                        {429}out(c, GetEndpointRequest);
                                                        {430}in(c, (SPs_888: bitstring,=Sign,UP_889: bitstring,=pkSess_887));
                                                        {431}new SPc_890: bitstring;
                                                        {432}new Nc_891: bitstring;
                                                        {433}let gNc_892: bitstring = exp(g,Nc_891) in
                                                        {434}let m1_893: bitstring = (SPc_890,gNc_892) in
                                                        {435}event beginCli(Cli,Sess,gNc_892);
                                                        {436}out(c, (pkCli,m1_893,sign(m1_893,skCli)));
                                                        {437}in(c, (PartS_894: bitstring,sigPartS_895: bitstring));
                                                        {438}if (verify(PartS_894,sigPartS_895,pkSess_887) <> true) then
                                                            0
                                                        else
                                                            {439}event endCli(Sess,Cli,PartS_894)
                                                )
                                                else
                                                    {440}let pkSess_896: bitstring = fail-any in
                                                    {441}out(c, GetEndpointRequest);
                                                    {442}in(c, (SPs_897: bitstring,=Sign,UP_898: bitstring,=pkSess_896));
                                                    {443}new SPc_899: bitstring;
                                                    {444}new Nc_900: bitstring;
                                                    {445}let gNc_901: bitstring = exp(g,Nc_900) in
                                                    {446}let m1_902: bitstring = (SPc_899,gNc_901) in
                                                    {447}event beginCli(Cli,Sess,gNc_901);
                                                    {448}out(c, (pkCli,m1_902,sign(m1_902,skCli)));
                                                    {449}in(c, (PartS_903: bitstring,sigPartS_904: bitstring));
                                                    {450}if (verify(PartS_903,sigPartS_904,pkSess_896) <> true) then
                                                        0
                                                    else
                                                        {451}event endCli(Sess,Cli,PartS_903)
                                        )
                                        else
                                            {452}let pkSess_905: bitstring = fail-any in
                                            {453}out(c, GetEndpointRequest);
                                            {454}in(c, (SPs_906: bitstring,=Sign,UP_907: bitstring,=pkSess_905));
                                            {455}new SPc_908: bitstring;
                                            {456}new Nc_909: bitstring;
                                            {457}let gNc_910: bitstring = exp(g,Nc_909) in
                                            {458}let m1_911: bitstring = (SPc_908,gNc_910) in
                                            {459}event beginCli(Cli,Sess,gNc_910);
                                            {460}out(c, (pkCli,m1_911,sign(m1_911,skCli)));
                                            {461}in(c, (PartS_912: bitstring,sigPartS_913: bitstring));
                                            {462}if (verify(PartS_912,sigPartS_913,pkSess_905) <> true) then
                                                0
                                            else
                                                {463}event endCli(Sess,Cli,PartS_912)
                                )
                                else
                                    {464}let pkSess_914: bitstring = fail-any in
                                    {465}out(c, GetEndpointRequest);
                                    {466}in(c, (SPs_915: bitstring,=Sign,UP_916: bitstring,=pkSess_914));
                                    {467}new SPc_917: bitstring;
                                    {468}new Nc_918: bitstring;
                                    {469}let gNc_919: bitstring = exp(g,Nc_918) in
                                    {470}let m1_920: bitstring = (SPc_917,gNc_919) in
                                    {471}event beginCli(Cli,Sess,gNc_919);
                                    {472}out(c, (pkCli,m1_920,sign(m1_920,skCli)));
                                    {473}in(c, (PartS_921: bitstring,sigPartS_922: bitstring));
                                    {474}if (verify(PartS_921,sigPartS_922,pkSess_914) <> true) then
                                        0
                                    else
                                        {475}event endCli(Sess,Cli,PartS_921)
                    )
                    else
                        {476}let pkDisco_923: bitstring = fail-any in
                        {477}let v_924: bool = (Sess = A) in
                        (
                            {478}if v_924 then
                            (
                                {479}let pkSess_925: bitstring = pub(skA) in
                                {480}out(c, GetEndpointRequest);
                                {481}in(c, (SPs_926: bitstring,=Sign,UP_927: bitstring,=pkSess_925));
                                {482}new SPc_928: bitstring;
                                {483}new Nc_929: bitstring;
                                {484}let gNc_930: bitstring = exp(g,Nc_929) in
                                {485}let m1_931: bitstring = (SPc_928,gNc_930) in
                                {486}event beginCli(Cli,Sess,gNc_930);
                                {487}out(c, (pkCli,m1_931,sign(m1_931,skCli)));
                                {488}in(c, (PartS_932: bitstring,sigPartS_933: bitstring));
                                {489}if (verify(PartS_932,sigPartS_933,pkSess_925) <> true) then
                                    0
                                else
                                    {490}event endCli(Sess,Cli,PartS_932)
                            )
                            else
                                {491}let v_934: bool = (Sess = B) in
                                (
                                    {492}if v_934 then
                                    (
                                        {493}let pkSess_935: bitstring = pub(skB) in
                                        {494}out(c, GetEndpointRequest);
                                        {495}in(c, (SPs_936: bitstring,=Sign,UP_937: bitstring,=pkSess_935));
                                        {496}new SPc_938: bitstring;
                                        {497}new Nc_939: bitstring;
                                        {498}let gNc_940: bitstring = exp(g,Nc_939) in
                                        {499}let m1_941: bitstring = (SPc_938,gNc_940) in
                                        {500}event beginCli(Cli,Sess,gNc_940);
                                        {501}out(c, (pkCli,m1_941,sign(m1_941,skCli)));
                                        {502}in(c, (PartS_942: bitstring,sigPartS_943: bitstring));
                                        {503}if (verify(PartS_942,sigPartS_943,pkSess_935) <> true) then
                                            0
                                        else
                                            {504}event endCli(Sess,Cli,PartS_942)
                                    )
                                    else
                                        {505}let v_944: bool = (Sess = C) in
                                        (
                                            {506}if v_944 then
                                            (
                                                {507}let pkSess_945: bitstring = pub(skC) in
                                                {508}out(c, GetEndpointRequest);
                                                {509}in(c, (SPs_946: bitstring,=Sign,UP_947: bitstring,=pkSess_945));
                                                {510}new SPc_948: bitstring;
                                                {511}new Nc_949: bitstring;
                                                {512}let gNc_950: bitstring = exp(g,Nc_949) in
                                                {513}let m1_951: bitstring = (SPc_948,gNc_950) in
                                                {514}event beginCli(Cli,Sess,gNc_950);
                                                {515}out(c, (pkCli,m1_951,sign(m1_951,skCli)));
                                                {516}in(c, (PartS_952: bitstring,sigPartS_953: bitstring));
                                                {517}if (verify(PartS_952,sigPartS_953,pkSess_945) <> true) then
                                                    0
                                                else
                                                    {518}event endCli(Sess,Cli,PartS_952)
                                            )
                                            else
                                                {519}let pkSess_954: bitstring = pub(skI) in
                                                {520}out(c, GetEndpointRequest);
                                                {521}in(c, (SPs_955: bitstring,=Sign,UP_956: bitstring,=pkSess_954));
                                                {522}new SPc_957: bitstring;
                                                {523}new Nc_958: bitstring;
                                                {524}let gNc_959: bitstring = exp(g,Nc_958) in
                                                {525}let m1_960: bitstring = (SPc_957,gNc_959) in
                                                {526}event beginCli(Cli,Sess,gNc_959);
                                                {527}out(c, (pkCli,m1_960,sign(m1_960,skCli)));
                                                {528}in(c, (PartS_961: bitstring,sigPartS_962: bitstring));
                                                {529}if (verify(PartS_961,sigPartS_962,pkSess_954) <> true) then
                                                    0
                                                else
                                                    {530}event endCli(Sess,Cli,PartS_961)
                                        )
                                        else
                                            {531}let pkSess_963: bitstring = fail-any in
                                            {532}out(c, GetEndpointRequest);
                                            {533}in(c, (SPs_964: bitstring,=Sign,UP_965: bitstring,=pkSess_963));
                                            {534}new SPc_966: bitstring;
                                            {535}new Nc_967: bitstring;
                                            {536}let gNc_968: bitstring = exp(g,Nc_967) in
                                            {537}let m1_969: bitstring = (SPc_966,gNc_968) in
                                            {538}event beginCli(Cli,Sess,gNc_968);
                                            {539}out(c, (pkCli,m1_969,sign(m1_969,skCli)));
                                            {540}in(c, (PartS_970: bitstring,sigPartS_971: bitstring));
                                            {541}if (verify(PartS_970,sigPartS_971,pkSess_963) <> true) then
                                                0
                                            else
                                                {542}event endCli(Sess,Cli,PartS_970)
                                )
                                else
                                    {543}let pkSess_972: bitstring = fail-any in
                                    {544}out(c, GetEndpointRequest);
                                    {545}in(c, (SPs_973: bitstring,=Sign,UP_974: bitstring,=pkSess_972));
                                    {546}new SPc_975: bitstring;
                                    {547}new Nc_976: bitstring;
                                    {548}let gNc_977: bitstring = exp(g,Nc_976) in
                                    {549}let m1_978: bitstring = (SPc_975,gNc_977) in
                                    {550}event beginCli(Cli,Sess,gNc_977);
                                    {551}out(c, (pkCli,m1_978,sign(m1_978,skCli)));
                                    {552}in(c, (PartS_979: bitstring,sigPartS_980: bitstring));
                                    {553}if (verify(PartS_979,sigPartS_980,pkSess_972) <> true) then
                                        0
                                    else
                                        {554}event endCli(Sess,Cli,PartS_979)
                        )
                        else
                            {555}let pkSess_981: bitstring = fail-any in
                            {556}out(c, GetEndpointRequest);
                            {557}in(c, (SPs_982: bitstring,=Sign,UP_983: bitstring,=pkSess_981));
                            {558}new SPc_984: bitstring;
                            {559}new Nc_985: bitstring;
                            {560}let gNc_986: bitstring = exp(g,Nc_985) in
                            {561}let m1_987: bitstring = (SPc_984,gNc_986) in
                            {562}event beginCli(Cli,Sess,gNc_986);
                            {563}out(c, (pkCli,m1_987,sign(m1_987,skCli)));
                            {564}in(c, (PartS_988: bitstring,sigPartS_989: bitstring));
                            {565}if (verify(PartS_988,sigPartS_989,pkSess_981) <> true) then
                                0
                            else
                                {566}event endCli(Sess,Cli,PartS_988)
            )
            else
                {567}let pkDisco_990: bitstring = fail-any in
                {568}let v_991: bool = (Sess = A) in
                (
                    {569}if v_991 then
                    (
                        {570}let pkSess_992: bitstring = pub(skA) in
                        {571}out(c, GetEndpointRequest);
                        {572}in(c, (SPs_993: bitstring,=Sign,UP_994: bitstring,=pkSess_992));
                        {573}new SPc_995: bitstring;
                        {574}new Nc_996: bitstring;
                        {575}let gNc_997: bitstring = exp(g,Nc_996) in
                        {576}let m1_998: bitstring = (SPc_995,gNc_997) in
                        {577}event beginCli(Cli,Sess,gNc_997);
                        {578}out(c, (pkCli,m1_998,sign(m1_998,skCli)));
                        {579}in(c, (PartS_999: bitstring,sigPartS_1000: bitstring));
                        {580}if (verify(PartS_999,sigPartS_1000,pkSess_992) <> true) then
                            0
                        else
                            {581}event endCli(Sess,Cli,PartS_999)
                    )
                    else
                        {582}let v_1001: bool = (Sess = B) in
                        (
                            {583}if v_1001 then
                            (
                                {584}let pkSess_1002: bitstring = pub(skB) in
                                {585}out(c, GetEndpointRequest);
                                {586}in(c, (SPs_1003: bitstring,=Sign,UP_1004: bitstring,=pkSess_1002));
                                {587}new SPc_1005: bitstring;
                                {588}new Nc_1006: bitstring;
                                {589}let gNc_1007: bitstring = exp(g,Nc_1006) in
                                {590}let m1_1008: bitstring = (SPc_1005,gNc_1007) in
                                {591}event beginCli(Cli,Sess,gNc_1007);
                                {592}out(c, (pkCli,m1_1008,sign(m1_1008,skCli)));
                                {593}in(c, (PartS_1009: bitstring,sigPartS_1010: bitstring));
                                {594}if (verify(PartS_1009,sigPartS_1010,pkSess_1002) <> true) then
                                    0
                                else
                                    {595}event endCli(Sess,Cli,PartS_1009)
                            )
                            else
                                {596}let v_1011: bool = (Sess = C) in
                                (
                                    {597}if v_1011 then
                                    (
                                        {598}let pkSess_1012: bitstring = pub(skC) in
                                        {599}out(c, GetEndpointRequest);
                                        {600}in(c, (SPs_1013: bitstring,=Sign,UP_1014: bitstring,=pkSess_1012));
                                        {601}new SPc_1015: bitstring;
                                        {602}new Nc_1016: bitstring;
                                        {603}let gNc_1017: bitstring = exp(g,Nc_1016) in
                                        {604}let m1_1018: bitstring = (SPc_1015,gNc_1017) in
                                        {605}event beginCli(Cli,Sess,gNc_1017);
                                        {606}out(c, (pkCli,m1_1018,sign(m1_1018,skCli)));
                                        {607}in(c, (PartS_1019: bitstring,sigPartS_1020: bitstring));
                                        {608}if (verify(PartS_1019,sigPartS_1020,pkSess_1012) <> true) then
                                            0
                                        else
                                            {609}event endCli(Sess,Cli,PartS_1019)
                                    )
                                    else
                                        {610}let pkSess_1021: bitstring = pub(skI) in
                                        {611}out(c, GetEndpointRequest);
                                        {612}in(c, (SPs_1022: bitstring,=Sign,UP_1023: bitstring,=pkSess_1021));
                                        {613}new SPc_1024: bitstring;
                                        {614}new Nc_1025: bitstring;
                                        {615}let gNc_1026: bitstring = exp(g,Nc_1025) in
                                        {616}let m1_1027: bitstring = (SPc_1024,gNc_1026) in
                                        {617}event beginCli(Cli,Sess,gNc_1026);
                                        {618}out(c, (pkCli,m1_1027,sign(m1_1027,skCli)));
                                        {619}in(c, (PartS_1028: bitstring,sigPartS_1029: bitstring));
                                        {620}if (verify(PartS_1028,sigPartS_1029,pkSess_1021) <> true) then
                                            0
                                        else
                                            {621}event endCli(Sess,Cli,PartS_1028)
                                )
                                else
                                    {622}let pkSess_1030: bitstring = fail-any in
                                    {623}out(c, GetEndpointRequest);
                                    {624}in(c, (SPs_1031: bitstring,=Sign,UP_1032: bitstring,=pkSess_1030));
                                    {625}new SPc_1033: bitstring;
                                    {626}new Nc_1034: bitstring;
                                    {627}let gNc_1035: bitstring = exp(g,Nc_1034) in
                                    {628}let m1_1036: bitstring = (SPc_1033,gNc_1035) in
                                    {629}event beginCli(Cli,Sess,gNc_1035);
                                    {630}out(c, (pkCli,m1_1036,sign(m1_1036,skCli)));
                                    {631}in(c, (PartS_1037: bitstring,sigPartS_1038: bitstring));
                                    {632}if (verify(PartS_1037,sigPartS_1038,pkSess_1030) <> true) then
                                        0
                                    else
                                        {633}event endCli(Sess,Cli,PartS_1037)
                        )
                        else
                            {634}let pkSess_1039: bitstring = fail-any in
                            {635}out(c, GetEndpointRequest);
                            {636}in(c, (SPs_1040: bitstring,=Sign,UP_1041: bitstring,=pkSess_1039));
                            {637}new SPc_1042: bitstring;
                            {638}new Nc_1043: bitstring;
                            {639}let gNc_1044: bitstring = exp(g,Nc_1043) in
                            {640}let m1_1045: bitstring = (SPc_1042,gNc_1044) in
                            {641}event beginCli(Cli,Sess,gNc_1044);
                            {642}out(c, (pkCli,m1_1045,sign(m1_1045,skCli)));
                            {643}in(c, (PartS_1046: bitstring,sigPartS_1047: bitstring));
                            {644}if (verify(PartS_1046,sigPartS_1047,pkSess_1039) <> true) then
                                0
                            else
                                {645}event endCli(Sess,Cli,PartS_1046)
                )
                else
                    {646}let pkSess_1048: bitstring = fail-any in
                    {647}out(c, GetEndpointRequest);
                    {648}in(c, (SPs_1049: bitstring,=Sign,UP_1050: bitstring,=pkSess_1048));
                    {649}new SPc_1051: bitstring;
                    {650}new Nc_1052: bitstring;
                    {651}let gNc_1053: bitstring = exp(g,Nc_1052) in
                    {652}let m1_1054: bitstring = (SPc_1051,gNc_1053) in
                    {653}event beginCli(Cli,Sess,gNc_1053);
                    {654}out(c, (pkCli,m1_1054,sign(m1_1054,skCli)));
                    {655}in(c, (PartS_1055: bitstring,sigPartS_1056: bitstring));
                    {656}if (verify(PartS_1055,sigPartS_1056,pkSess_1048) <> true) then
                        0
                    else
                        {657}event endCli(Sess,Cli,PartS_1055)
        )
        else
            {658}let v_1057: bool = (Cli = B) in
            (
                {659}if v_1057 then
                (
                    {660}let skCli_1058: bitstring = skB in
                    {661}let pkCli_1059: bitstring = pub(skCli_1058) in
                    {662}let v_1060: bool = (Disco = A) in
                    (
                        {663}if v_1060 then
                        (
                            {664}let pkDisco_1061: bitstring = pub(skA) in
                            {665}let v_1062: bool = (Sess = A) in
                            (
                                {666}if v_1062 then
                                (
                                    {667}let pkSess_1063: bitstring = pub(skA) in
                                    {668}out(c, GetEndpointRequest);
                                    {669}in(c, (SPs_1064: bitstring,=Sign,UP_1065: bitstring,=pkSess_1063));
                                    {670}new SPc_1066: bitstring;
                                    {671}new Nc_1067: bitstring;
                                    {672}let gNc_1068: bitstring = exp(g,Nc_1067) in
                                    {673}let m1_1069: bitstring = (SPc_1066,gNc_1068) in
                                    {674}event beginCli(Cli,Sess,gNc_1068);
                                    {675}out(c, (pkCli_1059,m1_1069,sign(m1_1069,skCli_1058)));
                                    {676}in(c, (PartS_1070: bitstring,sigPartS_1071: bitstring));
                                    {677}if (verify(PartS_1070,sigPartS_1071,pkSess_1063) <> true) then
                                        0
                                    else
                                        {678}event endCli(Sess,Cli,PartS_1070)
                                )
                                else
                                    {679}let v_1072: bool = (Sess = B) in
                                    (
                                        {680}if v_1072 then
                                        (
                                            {681}let pkSess_1073: bitstring = pub(skB) in
                                            {682}out(c, GetEndpointRequest);
                                            {683}in(c, (SPs_1074: bitstring,=Sign,UP_1075: bitstring,=pkSess_1073));
                                            {684}new SPc_1076: bitstring;
                                            {685}new Nc_1077: bitstring;
                                            {686}let gNc_1078: bitstring = exp(g,Nc_1077) in
                                            {687}let m1_1079: bitstring = (SPc_1076,gNc_1078) in
                                            {688}event beginCli(Cli,Sess,gNc_1078);
                                            {689}out(c, (pkCli_1059,m1_1079,sign(m1_1079,skCli_1058)));
                                            {690}in(c, (PartS_1080: bitstring,sigPartS_1081: bitstring));
                                            {691}if (verify(PartS_1080,sigPartS_1081,pkSess_1073) <> true) then
                                                0
                                            else
                                                {692}event endCli(Sess,Cli,PartS_1080)
                                        )
                                        else
                                            {693}let v_1082: bool = (Sess = C) in
                                            (
                                                {694}if v_1082 then
                                                (
                                                    {695}let pkSess_1083: bitstring = pub(skC) in
                                                    {696}out(c, GetEndpointRequest);
                                                    {697}in(c, (SPs_1084: bitstring,=Sign,UP_1085: bitstring,=pkSess_1083));
                                                    {698}new SPc_1086: bitstring;
                                                    {699}new Nc_1087: bitstring;
                                                    {700}let gNc_1088: bitstring = exp(g,Nc_1087) in
                                                    {701}let m1_1089: bitstring = (SPc_1086,gNc_1088) in
                                                    {702}event beginCli(Cli,Sess,gNc_1088);
                                                    {703}out(c, (pkCli_1059,m1_1089,sign(m1_1089,skCli_1058)));
                                                    {704}in(c, (PartS_1090: bitstring,sigPartS_1091: bitstring));
                                                    {705}if (verify(PartS_1090,sigPartS_1091,pkSess_1083) <> true) then
                                                        0
                                                    else
                                                        {706}event endCli(Sess,Cli,PartS_1090)
                                                )
                                                else
                                                    {707}let pkSess_1092: bitstring = pub(skI) in
                                                    {708}out(c, GetEndpointRequest);
                                                    {709}in(c, (SPs_1093: bitstring,=Sign,UP_1094: bitstring,=pkSess_1092));
                                                    {710}new SPc_1095: bitstring;
                                                    {711}new Nc_1096: bitstring;
                                                    {712}let gNc_1097: bitstring = exp(g,Nc_1096) in
                                                    {713}let m1_1098: bitstring = (SPc_1095,gNc_1097) in
                                                    {714}event beginCli(Cli,Sess,gNc_1097);
                                                    {715}out(c, (pkCli_1059,m1_1098,sign(m1_1098,skCli_1058)));
                                                    {716}in(c, (PartS_1099: bitstring,sigPartS_1100: bitstring));
                                                    {717}if (verify(PartS_1099,sigPartS_1100,pkSess_1092) <> true) then
                                                        0
                                                    else
                                                        {718}event endCli(Sess,Cli,PartS_1099)
                                            )
                                            else
                                                {719}let pkSess_1101: bitstring = fail-any in
                                                {720}out(c, GetEndpointRequest);
                                                {721}in(c, (SPs_1102: bitstring,=Sign,UP_1103: bitstring,=pkSess_1101));
                                                {722}new SPc_1104: bitstring;
                                                {723}new Nc_1105: bitstring;
                                                {724}let gNc_1106: bitstring = exp(g,Nc_1105) in
                                                {725}let m1_1107: bitstring = (SPc_1104,gNc_1106) in
                                                {726}event beginCli(Cli,Sess,gNc_1106);
                                                {727}out(c, (pkCli_1059,m1_1107,sign(m1_1107,skCli_1058)));
                                                {728}in(c, (PartS_1108: bitstring,sigPartS_1109: bitstring));
                                                {729}if (verify(PartS_1108,sigPartS_1109,pkSess_1101) <> true) then
                                                    0
                                                else
                                                    {730}event endCli(Sess,Cli,PartS_1108)
                                    )
                                    else
                                        {731}let pkSess_1110: bitstring = fail-any in
                                        {732}out(c, GetEndpointRequest);
                                        {733}in(c, (SPs_1111: bitstring,=Sign,UP_1112: bitstring,=pkSess_1110));
                                        {734}new SPc_1113: bitstring;
                                        {735}new Nc_1114: bitstring;
                                        {736}let gNc_1115: bitstring = exp(g,Nc_1114) in
                                        {737}let m1_1116: bitstring = (SPc_1113,gNc_1115) in
                                        {738}event beginCli(Cli,Sess,gNc_1115);
                                        {739}out(c, (pkCli_1059,m1_1116,sign(m1_1116,skCli_1058)));
                                        {740}in(c, (PartS_1117: bitstring,sigPartS_1118: bitstring));
                                        {741}if (verify(PartS_1117,sigPartS_1118,pkSess_1110) <> true) then
                                            0
                                        else
                                            {742}event endCli(Sess,Cli,PartS_1117)
                            )
                            else
                                {743}let pkSess_1119: bitstring = fail-any in
                                {744}out(c, GetEndpointRequest);
                                {745}in(c, (SPs_1120: bitstring,=Sign,UP_1121: bitstring,=pkSess_1119));
                                {746}new SPc_1122: bitstring;
                                {747}new Nc_1123: bitstring;
                                {748}let gNc_1124: bitstring = exp(g,Nc_1123) in
                                {749}let m1_1125: bitstring = (SPc_1122,gNc_1124) in
                                {750}event beginCli(Cli,Sess,gNc_1124);
                                {751}out(c, (pkCli_1059,m1_1125,sign(m1_1125,skCli_1058)));
                                {752}in(c, (PartS_1126: bitstring,sigPartS_1127: bitstring));
                                {753}if (verify(PartS_1126,sigPartS_1127,pkSess_1119) <> true) then
                                    0
                                else
                                    {754}event endCli(Sess,Cli,PartS_1126)
                        )
                        else
                            {755}let v_1128: bool = (Disco = B) in
                            (
                                {756}if v_1128 then
                                (
                                    {757}let pkDisco_1129: bitstring = pub(skB) in
                                    {758}let v_1130: bool = (Sess = A) in
                                    (
                                        {759}if v_1130 then
                                        (
                                            {760}let pkSess_1131: bitstring = pub(skA) in
                                            {761}out(c, GetEndpointRequest);
                                            {762}in(c, (SPs_1132: bitstring,=Sign,UP_1133: bitstring,=pkSess_1131));
                                            {763}new SPc_1134: bitstring;
                                            {764}new Nc_1135: bitstring;
                                            {765}let gNc_1136: bitstring = exp(g,Nc_1135) in
                                            {766}let m1_1137: bitstring = (SPc_1134,gNc_1136) in
                                            {767}event beginCli(Cli,Sess,gNc_1136);
                                            {768}out(c, (pkCli_1059,m1_1137,sign(m1_1137,skCli_1058)));
                                            {769}in(c, (PartS_1138: bitstring,sigPartS_1139: bitstring));
                                            {770}if (verify(PartS_1138,sigPartS_1139,pkSess_1131) <> true) then
                                                0
                                            else
                                                {771}event endCli(Sess,Cli,PartS_1138)
                                        )
                                        else
                                            {772}let v_1140: bool = (Sess = B) in
                                            (
                                                {773}if v_1140 then
                                                (
                                                    {774}let pkSess_1141: bitstring = pub(skB) in
                                                    {775}out(c, GetEndpointRequest);
                                                    {776}in(c, (SPs_1142: bitstring,=Sign,UP_1143: bitstring,=pkSess_1141));
                                                    {777}new SPc_1144: bitstring;
                                                    {778}new Nc_1145: bitstring;
                                                    {779}let gNc_1146: bitstring = exp(g,Nc_1145) in
                                                    {780}let m1_1147: bitstring = (SPc_1144,gNc_1146) in
                                                    {781}event beginCli(Cli,Sess,gNc_1146);
                                                    {782}out(c, (pkCli_1059,m1_1147,sign(m1_1147,skCli_1058)));
                                                    {783}in(c, (PartS_1148: bitstring,sigPartS_1149: bitstring));
                                                    {784}if (verify(PartS_1148,sigPartS_1149,pkSess_1141) <> true) then
                                                        0
                                                    else
                                                        {785}event endCli(Sess,Cli,PartS_1148)
                                                )
                                                else
                                                    {786}let v_1150: bool = (Sess = C) in
                                                    (
                                                        {787}if v_1150 then
                                                        (
                                                            {788}let pkSess_1151: bitstring = pub(skC) in
                                                            {789}out(c, GetEndpointRequest);
                                                            {790}in(c, (SPs_1152: bitstring,=Sign,UP_1153: bitstring,=pkSess_1151));
                                                            {791}new SPc_1154: bitstring;
                                                            {792}new Nc_1155: bitstring;
                                                            {793}let gNc_1156: bitstring = exp(g,Nc_1155) in
                                                            {794}let m1_1157: bitstring = (SPc_1154,gNc_1156) in
                                                            {795}event beginCli(Cli,Sess,gNc_1156);
                                                            {796}out(c, (pkCli_1059,m1_1157,sign(m1_1157,skCli_1058)));
                                                            {797}in(c, (PartS_1158: bitstring,sigPartS_1159: bitstring));
                                                            {798}if (verify(PartS_1158,sigPartS_1159,pkSess_1151) <> true) then
                                                                0
                                                            else
                                                                {799}event endCli(Sess,Cli,PartS_1158)
                                                        )
                                                        else
                                                            {800}let pkSess_1160: bitstring = pub(skI) in
                                                            {801}out(c, GetEndpointRequest);
                                                            {802}in(c, (SPs_1161: bitstring,=Sign,UP_1162: bitstring,=pkSess_1160));
                                                            {803}new SPc_1163: bitstring;
                                                            {804}new Nc_1164: bitstring;
                                                            {805}let gNc_1165: bitstring = exp(g,Nc_1164) in
                                                            {806}let m1_1166: bitstring = (SPc_1163,gNc_1165) in
                                                            {807}event beginCli(Cli,Sess,gNc_1165);
                                                            {808}out(c, (pkCli_1059,m1_1166,sign(m1_1166,skCli_1058)));
                                                            {809}in(c, (PartS_1167: bitstring,sigPartS_1168: bitstring));
                                                            {810}if (verify(PartS_1167,sigPartS_1168,pkSess_1160) <> true) then
                                                                0
                                                            else
                                                                {811}event endCli(Sess,Cli,PartS_1167)
                                                    )
                                                    else
                                                        {812}let pkSess_1169: bitstring = fail-any in
                                                        {813}out(c, GetEndpointRequest);
                                                        {814}in(c, (SPs_1170: bitstring,=Sign,UP_1171: bitstring,=pkSess_1169));
                                                        {815}new SPc_1172: bitstring;
                                                        {816}new Nc_1173: bitstring;
                                                        {817}let gNc_1174: bitstring = exp(g,Nc_1173) in
                                                        {818}let m1_1175: bitstring = (SPc_1172,gNc_1174) in
                                                        {819}event beginCli(Cli,Sess,gNc_1174);
                                                        {820}out(c, (pkCli_1059,m1_1175,sign(m1_1175,skCli_1058)));
                                                        {821}in(c, (PartS_1176: bitstring,sigPartS_1177: bitstring));
                                                        {822}if (verify(PartS_1176,sigPartS_1177,pkSess_1169) <> true) then
                                                            0
                                                        else
                                                            {823}event endCli(Sess,Cli,PartS_1176)
                                            )
                                            else
                                                {824}let pkSess_1178: bitstring = fail-any in
                                                {825}out(c, GetEndpointRequest);
                                                {826}in(c, (SPs_1179: bitstring,=Sign,UP_1180: bitstring,=pkSess_1178));
                                                {827}new SPc_1181: bitstring;
                                                {828}new Nc_1182: bitstring;
                                                {829}let gNc_1183: bitstring = exp(g,Nc_1182) in
                                                {830}let m1_1184: bitstring = (SPc_1181,gNc_1183) in
                                                {831}event beginCli(Cli,Sess,gNc_1183);
                                                {832}out(c, (pkCli_1059,m1_1184,sign(m1_1184,skCli_1058)));
                                                {833}in(c, (PartS_1185: bitstring,sigPartS_1186: bitstring));
                                                {834}if (verify(PartS_1185,sigPartS_1186,pkSess_1178) <> true) then
                                                    0
                                                else
                                                    {835}event endCli(Sess,Cli,PartS_1185)
                                    )
                                    else
                                        {836}let pkSess_1187: bitstring = fail-any in
                                        {837}out(c, GetEndpointRequest);
                                        {838}in(c, (SPs_1188: bitstring,=Sign,UP_1189: bitstring,=pkSess_1187));
                                        {839}new SPc_1190: bitstring;
                                        {840}new Nc_1191: bitstring;
                                        {841}let gNc_1192: bitstring = exp(g,Nc_1191) in
                                        {842}let m1_1193: bitstring = (SPc_1190,gNc_1192) in
                                        {843}event beginCli(Cli,Sess,gNc_1192);
                                        {844}out(c, (pkCli_1059,m1_1193,sign(m1_1193,skCli_1058)));
                                        {845}in(c, (PartS_1194: bitstring,sigPartS_1195: bitstring));
                                        {846}if (verify(PartS_1194,sigPartS_1195,pkSess_1187) <> true) then
                                            0
                                        else
                                            {847}event endCli(Sess,Cli,PartS_1194)
                                )
                                else
                                    {848}let v_1196: bool = (Disco = C) in
                                    (
                                        {849}if v_1196 then
                                        (
                                            {850}let pkDisco_1197: bitstring = pub(skC) in
                                            {851}let v_1198: bool = (Sess = A) in
                                            (
                                                {852}if v_1198 then
                                                (
                                                    {853}let pkSess_1199: bitstring = pub(skA) in
                                                    {854}out(c, GetEndpointRequest);
                                                    {855}in(c, (SPs_1200: bitstring,=Sign,UP_1201: bitstring,=pkSess_1199));
                                                    {856}new SPc_1202: bitstring;
                                                    {857}new Nc_1203: bitstring;
                                                    {858}let gNc_1204: bitstring = exp(g,Nc_1203) in
                                                    {859}let m1_1205: bitstring = (SPc_1202,gNc_1204) in
                                                    {860}event beginCli(Cli,Sess,gNc_1204);
                                                    {861}out(c, (pkCli_1059,m1_1205,sign(m1_1205,skCli_1058)));
                                                    {862}in(c, (PartS_1206: bitstring,sigPartS_1207: bitstring));
                                                    {863}if (verify(PartS_1206,sigPartS_1207,pkSess_1199) <> true) then
                                                        0
                                                    else
                                                        {864}event endCli(Sess,Cli,PartS_1206)
                                                )
                                                else
                                                    {865}let v_1208: bool = (Sess = B) in
                                                    (
                                                        {866}if v_1208 then
                                                        (
                                                            {867}let pkSess_1209: bitstring = pub(skB) in
                                                            {868}out(c, GetEndpointRequest);
                                                            {869}in(c, (SPs_1210: bitstring,=Sign,UP_1211: bitstring,=pkSess_1209));
                                                            {870}new SPc_1212: bitstring;
                                                            {871}new Nc_1213: bitstring;
                                                            {872}let gNc_1214: bitstring = exp(g,Nc_1213) in
                                                            {873}let m1_1215: bitstring = (SPc_1212,gNc_1214) in
                                                            {874}event beginCli(Cli,Sess,gNc_1214);
                                                            {875}out(c, (pkCli_1059,m1_1215,sign(m1_1215,skCli_1058)));
                                                            {876}in(c, (PartS_1216: bitstring,sigPartS_1217: bitstring));
                                                            {877}if (verify(PartS_1216,sigPartS_1217,pkSess_1209) <> true) then
                                                                0
                                                            else
                                                                {878}event endCli(Sess,Cli,PartS_1216)
                                                        )
                                                        else
                                                            {879}let v_1218: bool = (Sess = C) in
                                                            (
                                                                {880}if v_1218 then
                                                                (
                                                                    {881}let pkSess_1219: bitstring = pub(skC) in
                                                                    {882}out(c, GetEndpointRequest);
                                                                    {883}in(c, (SPs_1220: bitstring,=Sign,UP_1221: bitstring,=pkSess_1219));
                                                                    {884}new SPc_1222: bitstring;
                                                                    {885}new Nc_1223: bitstring;
                                                                    {886}let gNc_1224: bitstring = exp(g,Nc_1223) in
                                                                    {887}let m1_1225: bitstring = (SPc_1222,gNc_1224) in
                                                                    {888}event beginCli(Cli,Sess,gNc_1224);
                                                                    {889}out(c, (pkCli_1059,m1_1225,sign(m1_1225,skCli_1058)));
                                                                    {890}in(c, (PartS_1226: bitstring,sigPartS_1227: bitstring));
                                                                    {891}if (verify(PartS_1226,sigPartS_1227,pkSess_1219) <> true) then
                                                                        0
                                                                    else
                                                                        {892}event endCli(Sess,Cli,PartS_1226)
                                                                )
                                                                else
                                                                    {893}let pkSess_1228: bitstring = pub(skI) in
                                                                    {894}out(c, GetEndpointRequest);
                                                                    {895}in(c, (SPs_1229: bitstring,=Sign,UP_1230: bitstring,=pkSess_1228));
                                                                    {896}new SPc_1231: bitstring;
                                                                    {897}new Nc_1232: bitstring;
                                                                    {898}let gNc_1233: bitstring = exp(g,Nc_1232) in
                                                                    {899}let m1_1234: bitstring = (SPc_1231,gNc_1233) in
                                                                    {900}event beginCli(Cli,Sess,gNc_1233);
                                                                    {901}out(c, (pkCli_1059,m1_1234,sign(m1_1234,skCli_1058)));
                                                                    {902}in(c, (PartS_1235: bitstring,sigPartS_1236: bitstring));
                                                                    {903}if (verify(PartS_1235,sigPartS_1236,pkSess_1228) <> true) then
                                                                        0
                                                                    else
                                                                        {904}event endCli(Sess,Cli,PartS_1235)
                                                            )
                                                            else
                                                                {905}let pkSess_1237: bitstring = fail-any in
                                                                {906}out(c, GetEndpointRequest);
                                                                {907}in(c, (SPs_1238: bitstring,=Sign,UP_1239: bitstring,=pkSess_1237));
                                                                {908}new SPc_1240: bitstring;
                                                                {909}new Nc_1241: bitstring;
                                                                {910}let gNc_1242: bitstring = exp(g,Nc_1241) in
                                                                {911}let m1_1243: bitstring = (SPc_1240,gNc_1242) in
                                                                {912}event beginCli(Cli,Sess,gNc_1242);
                                                                {913}out(c, (pkCli_1059,m1_1243,sign(m1_1243,skCli_1058)));
                                                                {914}in(c, (PartS_1244: bitstring,sigPartS_1245: bitstring));
                                                                {915}if (verify(PartS_1244,sigPartS_1245,pkSess_1237) <> true) then
                                                                    0
                                                                else
                                                                    {916}event endCli(Sess,Cli,PartS_1244)
                                                    )
                                                    else
                                                        {917}let pkSess_1246: bitstring = fail-any in
                                                        {918}out(c, GetEndpointRequest);
                                                        {919}in(c, (SPs_1247: bitstring,=Sign,UP_1248: bitstring,=pkSess_1246));
                                                        {920}new SPc_1249: bitstring;
                                                        {921}new Nc_1250: bitstring;
                                                        {922}let gNc_1251: bitstring = exp(g,Nc_1250) in
                                                        {923}let m1_1252: bitstring = (SPc_1249,gNc_1251) in
                                                        {924}event beginCli(Cli,Sess,gNc_1251);
                                                        {925}out(c, (pkCli_1059,m1_1252,sign(m1_1252,skCli_1058)));
                                                        {926}in(c, (PartS_1253: bitstring,sigPartS_1254: bitstring));
                                                        {927}if (verify(PartS_1253,sigPartS_1254,pkSess_1246) <> true) then
                                                            0
                                                        else
                                                            {928}event endCli(Sess,Cli,PartS_1253)
                                            )
                                            else
                                                {929}let pkSess_1255: bitstring = fail-any in
                                                {930}out(c, GetEndpointRequest);
                                                {931}in(c, (SPs_1256: bitstring,=Sign,UP_1257: bitstring,=pkSess_1255));
                                                {932}new SPc_1258: bitstring;
                                                {933}new Nc_1259: bitstring;
                                                {934}let gNc_1260: bitstring = exp(g,Nc_1259) in
                                                {935}let m1_1261: bitstring = (SPc_1258,gNc_1260) in
                                                {936}event beginCli(Cli,Sess,gNc_1260);
                                                {937}out(c, (pkCli_1059,m1_1261,sign(m1_1261,skCli_1058)));
                                                {938}in(c, (PartS_1262: bitstring,sigPartS_1263: bitstring));
                                                {939}if (verify(PartS_1262,sigPartS_1263,pkSess_1255) <> true) then
                                                    0
                                                else
                                                    {940}event endCli(Sess,Cli,PartS_1262)
                                        )
                                        else
                                            {941}let pkDisco_1264: bitstring = pub(skI) in
                                            {942}let v_1265: bool = (Sess = A) in
                                            (
                                                {943}if v_1265 then
                                                (
                                                    {944}let pkSess_1266: bitstring = pub(skA) in
                                                    {945}out(c, GetEndpointRequest);
                                                    {946}in(c, (SPs_1267: bitstring,=Sign,UP_1268: bitstring,=pkSess_1266));
                                                    {947}new SPc_1269: bitstring;
                                                    {948}new Nc_1270: bitstring;
                                                    {949}let gNc_1271: bitstring = exp(g,Nc_1270) in
                                                    {950}let m1_1272: bitstring = (SPc_1269,gNc_1271) in
                                                    {951}event beginCli(Cli,Sess,gNc_1271);
                                                    {952}out(c, (pkCli_1059,m1_1272,sign(m1_1272,skCli_1058)));
                                                    {953}in(c, (PartS_1273: bitstring,sigPartS_1274: bitstring));
                                                    {954}if (verify(PartS_1273,sigPartS_1274,pkSess_1266) <> true) then
                                                        0
                                                    else
                                                        {955}event endCli(Sess,Cli,PartS_1273)
                                                )
                                                else
                                                    {956}let v_1275: bool = (Sess = B) in
                                                    (
                                                        {957}if v_1275 then
                                                        (
                                                            {958}let pkSess_1276: bitstring = pub(skB) in
                                                            {959}out(c, GetEndpointRequest);
                                                            {960}in(c, (SPs_1277: bitstring,=Sign,UP_1278: bitstring,=pkSess_1276));
                                                            {961}new SPc_1279: bitstring;
                                                            {962}new Nc_1280: bitstring;
                                                            {963}let gNc_1281: bitstring = exp(g,Nc_1280) in
                                                            {964}let m1_1282: bitstring = (SPc_1279,gNc_1281) in
                                                            {965}event beginCli(Cli,Sess,gNc_1281);
                                                            {966}out(c, (pkCli_1059,m1_1282,sign(m1_1282,skCli_1058)));
                                                            {967}in(c, (PartS_1283: bitstring,sigPartS_1284: bitstring));
                                                            {968}if (verify(PartS_1283,sigPartS_1284,pkSess_1276) <> true) then
                                                                0
                                                            else
                                                                {969}event endCli(Sess,Cli,PartS_1283)
                                                        )
                                                        else
                                                            {970}let v_1285: bool = (Sess = C) in
                                                            (
                                                                {971}if v_1285 then
                                                                (
                                                                    {972}let pkSess_1286: bitstring = pub(skC) in
                                                                    {973}out(c, GetEndpointRequest);
                                                                    {974}in(c, (SPs_1287: bitstring,=Sign,UP_1288: bitstring,=pkSess_1286));
                                                                    {975}new SPc_1289: bitstring;
                                                                    {976}new Nc_1290: bitstring;
                                                                    {977}let gNc_1291: bitstring = exp(g,Nc_1290) in
                                                                    {978}let m1_1292: bitstring = (SPc_1289,gNc_1291) in
                                                                    {979}event beginCli(Cli,Sess,gNc_1291);
                                                                    {980}out(c, (pkCli_1059,m1_1292,sign(m1_1292,skCli_1058)));
                                                                    {981}in(c, (PartS_1293: bitstring,sigPartS_1294: bitstring));
                                                                    {982}if (verify(PartS_1293,sigPartS_1294,pkSess_1286) <> true) then
                                                                        0
                                                                    else
                                                                        {983}event endCli(Sess,Cli,PartS_1293)
                                                                )
                                                                else
                                                                    {984}let pkSess_1295: bitstring = pub(skI) in
                                                                    {985}out(c, GetEndpointRequest);
                                                                    {986}in(c, (SPs_1296: bitstring,=Sign,UP_1297: bitstring,=pkSess_1295));
                                                                    {987}new SPc_1298: bitstring;
                                                                    {988}new Nc_1299: bitstring;
                                                                    {989}let gNc_1300: bitstring = exp(g,Nc_1299) in
                                                                    {990}let m1_1301: bitstring = (SPc_1298,gNc_1300) in
                                                                    {991}event beginCli(Cli,Sess,gNc_1300);
                                                                    {992}out(c, (pkCli_1059,m1_1301,sign(m1_1301,skCli_1058)));
                                                                    {993}in(c, (PartS_1302: bitstring,sigPartS_1303: bitstring));
                                                                    {994}if (verify(PartS_1302,sigPartS_1303,pkSess_1295) <> true) then
                                                                        0
                                                                    else
                                                                        {995}event endCli(Sess,Cli,PartS_1302)
                                                            )
                                                            else
                                                                {996}let pkSess_1304: bitstring = fail-any in
                                                                {997}out(c, GetEndpointRequest);
                                                                {998}in(c, (SPs_1305: bitstring,=Sign,UP_1306: bitstring,=pkSess_1304));
                                                                {999}new SPc_1307: bitstring;
                                                                {1000}new Nc_1308: bitstring;
                                                                {1001}let gNc_1309: bitstring = exp(g,Nc_1308) in
                                                                {1002}let m1_1310: bitstring = (SPc_1307,gNc_1309) in
                                                                {1003}event beginCli(Cli,Sess,gNc_1309);
                                                                {1004}out(c, (pkCli_1059,m1_1310,sign(m1_1310,skCli_1058)));
                                                                {1005}in(c, (PartS_1311: bitstring,sigPartS_1312: bitstring));
                                                                {1006}if (verify(PartS_1311,sigPartS_1312,pkSess_1304) <> true) then
                                                                    0
                                                                else
                                                                    {1007}event endCli(Sess,Cli,PartS_1311)
                                                    )
                                                    else
                                                        {1008}let pkSess_1313: bitstring = fail-any in
                                                        {1009}out(c, GetEndpointRequest);
                                                        {1010}in(c, (SPs_1314: bitstring,=Sign,UP_1315: bitstring,=pkSess_1313));
                                                        {1011}new SPc_1316: bitstring;
                                                        {1012}new Nc_1317: bitstring;
                                                        {1013}let gNc_1318: bitstring = exp(g,Nc_1317) in
                                                        {1014}let m1_1319: bitstring = (SPc_1316,gNc_1318) in
                                                        {1015}event beginCli(Cli,Sess,gNc_1318);
                                                        {1016}out(c, (pkCli_1059,m1_1319,sign(m1_1319,skCli_1058)));
                                                        {1017}in(c, (PartS_1320: bitstring,sigPartS_1321: bitstring));
                                                        {1018}if (verify(PartS_1320,sigPartS_1321,pkSess_1313) <> true) then
                                                            0
                                                        else
                                                            {1019}event endCli(Sess,Cli,PartS_1320)
                                            )
                                            else
                                                {1020}let pkSess_1322: bitstring = fail-any in
                                                {1021}out(c, GetEndpointRequest);
                                                {1022}in(c, (SPs_1323: bitstring,=Sign,UP_1324: bitstring,=pkSess_1322));
                                                {1023}new SPc_1325: bitstring;
                                                {1024}new Nc_1326: bitstring;
                                                {1025}let gNc_1327: bitstring = exp(g,Nc_1326) in
                                                {1026}let m1_1328: bitstring = (SPc_1325,gNc_1327) in
                                                {1027}event beginCli(Cli,Sess,gNc_1327);
                                                {1028}out(c, (pkCli_1059,m1_1328,sign(m1_1328,skCli_1058)));
                                                {1029}in(c, (PartS_1329: bitstring,sigPartS_1330: bitstring));
                                                {1030}if (verify(PartS_1329,sigPartS_1330,pkSess_1322) <> true) then
                                                    0
                                                else
                                                    {1031}event endCli(Sess,Cli,PartS_1329)
                                    )
                                    else
                                        {1032}let pkDisco_1331: bitstring = fail-any in
                                        {1033}let v_1332: bool = (Sess = A) in
                                        (
                                            {1034}if v_1332 then
                                            (
                                                {1035}let pkSess_1333: bitstring = pub(skA) in
                                                {1036}out(c, GetEndpointRequest);
                                                {1037}in(c, (SPs_1334: bitstring,=Sign,UP_1335: bitstring,=pkSess_1333));
                                                {1038}new SPc_1336: bitstring;
                                                {1039}new Nc_1337: bitstring;
                                                {1040}let gNc_1338: bitstring = exp(g,Nc_1337) in
                                                {1041}let m1_1339: bitstring = (SPc_1336,gNc_1338) in
                                                {1042}event beginCli(Cli,Sess,gNc_1338);
                                                {1043}out(c, (pkCli_1059,m1_1339,sign(m1_1339,skCli_1058)));
                                                {1044}in(c, (PartS_1340: bitstring,sigPartS_1341: bitstring));
                                                {1045}if (verify(PartS_1340,sigPartS_1341,pkSess_1333) <> true) then
                                                    0
                                                else
                                                    {1046}event endCli(Sess,Cli,PartS_1340)
                                            )
                                            else
                                                {1047}let v_1342: bool = (Sess = B) in
                                                (
                                                    {1048}if v_1342 then
                                                    (
                                                        {1049}let pkSess_1343: bitstring = pub(skB) in
                                                        {1050}out(c, GetEndpointRequest);
                                                        {1051}in(c, (SPs_1344: bitstring,=Sign,UP_1345: bitstring,=pkSess_1343));
                                                        {1052}new SPc_1346: bitstring;
                                                        {1053}new Nc_1347: bitstring;
                                                        {1054}let gNc_1348: bitstring = exp(g,Nc_1347) in
                                                        {1055}let m1_1349: bitstring = (SPc_1346,gNc_1348) in
                                                        {1056}event beginCli(Cli,Sess,gNc_1348);
                                                        {1057}out(c, (pkCli_1059,m1_1349,sign(m1_1349,skCli_1058)));
                                                        {1058}in(c, (PartS_1350: bitstring,sigPartS_1351: bitstring));
                                                        {1059}if (verify(PartS_1350,sigPartS_1351,pkSess_1343) <> true) then
                                                            0
                                                        else
                                                            {1060}event endCli(Sess,Cli,PartS_1350)
                                                    )
                                                    else
                                                        {1061}let v_1352: bool = (Sess = C) in
                                                        (
                                                            {1062}if v_1352 then
                                                            (
                                                                {1063}let pkSess_1353: bitstring = pub(skC) in
                                                                {1064}out(c, GetEndpointRequest);
                                                                {1065}in(c, (SPs_1354: bitstring,=Sign,UP_1355: bitstring,=pkSess_1353));
                                                                {1066}new SPc_1356: bitstring;
                                                                {1067}new Nc_1357: bitstring;
                                                                {1068}let gNc_1358: bitstring = exp(g,Nc_1357) in
                                                                {1069}let m1_1359: bitstring = (SPc_1356,gNc_1358) in
                                                                {1070}event beginCli(Cli,Sess,gNc_1358);
                                                                {1071}out(c, (pkCli_1059,m1_1359,sign(m1_1359,skCli_1058)));
                                                                {1072}in(c, (PartS_1360: bitstring,sigPartS_1361: bitstring));
                                                                {1073}if (verify(PartS_1360,sigPartS_1361,pkSess_1353) <> true) then
                                                                    0
                                                                else
                                                                    {1074}event endCli(Sess,Cli,PartS_1360)
                                                            )
                                                            else
                                                                {1075}let pkSess_1362: bitstring = pub(skI) in
                                                                {1076}out(c, GetEndpointRequest);
                                                                {1077}in(c, (SPs_1363: bitstring,=Sign,UP_1364: bitstring,=pkSess_1362));
                                                                {1078}new SPc_1365: bitstring;
                                                                {1079}new Nc_1366: bitstring;
                                                                {1080}let gNc_1367: bitstring = exp(g,Nc_1366) in
                                                                {1081}let m1_1368: bitstring = (SPc_1365,gNc_1367) in
                                                                {1082}event beginCli(Cli,Sess,gNc_1367);
                                                                {1083}out(c, (pkCli_1059,m1_1368,sign(m1_1368,skCli_1058)));
                                                                {1084}in(c, (PartS_1369: bitstring,sigPartS_1370: bitstring));
                                                                {1085}if (verify(PartS_1369,sigPartS_1370,pkSess_1362) <> true) then
                                                                    0
                                                                else
                                                                    {1086}event endCli(Sess,Cli,PartS_1369)
                                                        )
                                                        else
                                                            {1087}let pkSess_1371: bitstring = fail-any in
                                                            {1088}out(c, GetEndpointRequest);
                                                            {1089}in(c, (SPs_1372: bitstring,=Sign,UP_1373: bitstring,=pkSess_1371));
                                                            {1090}new SPc_1374: bitstring;
                                                            {1091}new Nc_1375: bitstring;
                                                            {1092}let gNc_1376: bitstring = exp(g,Nc_1375) in
                                                            {1093}let m1_1377: bitstring = (SPc_1374,gNc_1376) in
                                                            {1094}event beginCli(Cli,Sess,gNc_1376);
                                                            {1095}out(c, (pkCli_1059,m1_1377,sign(m1_1377,skCli_1058)));
                                                            {1096}in(c, (PartS_1378: bitstring,sigPartS_1379: bitstring));
                                                            {1097}if (verify(PartS_1378,sigPartS_1379,pkSess_1371) <> true) then
                                                                0
                                                            else
                                                                {1098}event endCli(Sess,Cli,PartS_1378)
                                                )
                                                else
                                                    {1099}let pkSess_1380: bitstring = fail-any in
                                                    {1100}out(c, GetEndpointRequest);
                                                    {1101}in(c, (SPs_1381: bitstring,=Sign,UP_1382: bitstring,=pkSess_1380));
                                                    {1102}new SPc_1383: bitstring;
                                                    {1103}new Nc_1384: bitstring;
                                                    {1104}let gNc_1385: bitstring = exp(g,Nc_1384) in
                                                    {1105}let m1_1386: bitstring = (SPc_1383,gNc_1385) in
                                                    {1106}event beginCli(Cli,Sess,gNc_1385);
                                                    {1107}out(c, (pkCli_1059,m1_1386,sign(m1_1386,skCli_1058)));
                                                    {1108}in(c, (PartS_1387: bitstring,sigPartS_1388: bitstring));
                                                    {1109}if (verify(PartS_1387,sigPartS_1388,pkSess_1380) <> true) then
                                                        0
                                                    else
                                                        {1110}event endCli(Sess,Cli,PartS_1387)
                                        )
                                        else
                                            {1111}let pkSess_1389: bitstring = fail-any in
                                            {1112}out(c, GetEndpointRequest);
                                            {1113}in(c, (SPs_1390: bitstring,=Sign,UP_1391: bitstring,=pkSess_1389));
                                            {1114}new SPc_1392: bitstring;
                                            {1115}new Nc_1393: bitstring;
                                            {1116}let gNc_1394: bitstring = exp(g,Nc_1393) in
                                            {1117}let m1_1395: bitstring = (SPc_1392,gNc_1394) in
                                            {1118}event beginCli(Cli,Sess,gNc_1394);
                                            {1119}out(c, (pkCli_1059,m1_1395,sign(m1_1395,skCli_1058)));
                                            {1120}in(c, (PartS_1396: bitstring,sigPartS_1397: bitstring));
                                            {1121}if (verify(PartS_1396,sigPartS_1397,pkSess_1389) <> true) then
                                                0
                                            else
                                                {1122}event endCli(Sess,Cli,PartS_1396)
                            )
                            else
                                {1123}let pkDisco_1398: bitstring = fail-any in
                                {1124}let v_1399: bool = (Sess = A) in
                                (
                                    {1125}if v_1399 then
                                    (
                                        {1126}let pkSess_1400: bitstring = pub(skA) in
                                        {1127}out(c, GetEndpointRequest);
                                        {1128}in(c, (SPs_1401: bitstring,=Sign,UP_1402: bitstring,=pkSess_1400));
                                        {1129}new SPc_1403: bitstring;
                                        {1130}new Nc_1404: bitstring;
                                        {1131}let gNc_1405: bitstring = exp(g,Nc_1404) in
                                        {1132}let m1_1406: bitstring = (SPc_1403,gNc_1405) in
                                        {1133}event beginCli(Cli,Sess,gNc_1405);
                                        {1134}out(c, (pkCli_1059,m1_1406,sign(m1_1406,skCli_1058)));
                                        {1135}in(c, (PartS_1407: bitstring,sigPartS_1408: bitstring));
                                        {1136}if (verify(PartS_1407,sigPartS_1408,pkSess_1400) <> true) then
                                            0
                                        else
                                            {1137}event endCli(Sess,Cli,PartS_1407)
                                    )
                                    else
                                        {1138}let v_1409: bool = (Sess = B) in
                                        (
                                            {1139}if v_1409 then
                                            (
                                                {1140}let pkSess_1410: bitstring = pub(skB) in
                                                {1141}out(c, GetEndpointRequest);
                                                {1142}in(c, (SPs_1411: bitstring,=Sign,UP_1412: bitstring,=pkSess_1410));
                                                {1143}new SPc_1413: bitstring;
                                                {1144}new Nc_1414: bitstring;
                                                {1145}let gNc_1415: bitstring = exp(g,Nc_1414) in
                                                {1146}let m1_1416: bitstring = (SPc_1413,gNc_1415) in
                                                {1147}event beginCli(Cli,Sess,gNc_1415);
                                                {1148}out(c, (pkCli_1059,m1_1416,sign(m1_1416,skCli_1058)));
                                                {1149}in(c, (PartS_1417: bitstring,sigPartS_1418: bitstring));
                                                {1150}if (verify(PartS_1417,sigPartS_1418,pkSess_1410) <> true) then
                                                    0
                                                else
                                                    {1151}event endCli(Sess,Cli,PartS_1417)
                                            )
                                            else
                                                {1152}let v_1419: bool = (Sess = C) in
                                                (
                                                    {1153}if v_1419 then
                                                    (
                                                        {1154}let pkSess_1420: bitstring = pub(skC) in
                                                        {1155}out(c, GetEndpointRequest);
                                                        {1156}in(c, (SPs_1421: bitstring,=Sign,UP_1422: bitstring,=pkSess_1420));
                                                        {1157}new SPc_1423: bitstring;
                                                        {1158}new Nc_1424: bitstring;
                                                        {1159}let gNc_1425: bitstring = exp(g,Nc_1424) in
                                                        {1160}let m1_1426: bitstring = (SPc_1423,gNc_1425) in
                                                        {1161}event beginCli(Cli,Sess,gNc_1425);
                                                        {1162}out(c, (pkCli_1059,m1_1426,sign(m1_1426,skCli_1058)));
                                                        {1163}in(c, (PartS_1427: bitstring,sigPartS_1428: bitstring));
                                                        {1164}if (verify(PartS_1427,sigPartS_1428,pkSess_1420) <> true) then
                                                            0
                                                        else
                                                            {1165}event endCli(Sess,Cli,PartS_1427)
                                                    )
                                                    else
                                                        {1166}let pkSess_1429: bitstring = pub(skI) in
                                                        {1167}out(c, GetEndpointRequest);
                                                        {1168}in(c, (SPs_1430: bitstring,=Sign,UP_1431: bitstring,=pkSess_1429));
                                                        {1169}new SPc_1432: bitstring;
                                                        {1170}new Nc_1433: bitstring;
                                                        {1171}let gNc_1434: bitstring = exp(g,Nc_1433) in
                                                        {1172}let m1_1435: bitstring = (SPc_1432,gNc_1434) in
                                                        {1173}event beginCli(Cli,Sess,gNc_1434);
                                                        {1174}out(c, (pkCli_1059,m1_1435,sign(m1_1435,skCli_1058)));
                                                        {1175}in(c, (PartS_1436: bitstring,sigPartS_1437: bitstring));
                                                        {1176}if (verify(PartS_1436,sigPartS_1437,pkSess_1429) <> true) then
                                                            0
                                                        else
                                                            {1177}event endCli(Sess,Cli,PartS_1436)
                                                )
                                                else
                                                    {1178}let pkSess_1438: bitstring = fail-any in
                                                    {1179}out(c, GetEndpointRequest);
                                                    {1180}in(c, (SPs_1439: bitstring,=Sign,UP_1440: bitstring,=pkSess_1438));
                                                    {1181}new SPc_1441: bitstring;
                                                    {1182}new Nc_1442: bitstring;
                                                    {1183}let gNc_1443: bitstring = exp(g,Nc_1442) in
                                                    {1184}let m1_1444: bitstring = (SPc_1441,gNc_1443) in
                                                    {1185}event beginCli(Cli,Sess,gNc_1443);
                                                    {1186}out(c, (pkCli_1059,m1_1444,sign(m1_1444,skCli_1058)));
                                                    {1187}in(c, (PartS_1445: bitstring,sigPartS_1446: bitstring));
                                                    {1188}if (verify(PartS_1445,sigPartS_1446,pkSess_1438) <> true) then
                                                        0
                                                    else
                                                        {1189}event endCli(Sess,Cli,PartS_1445)
                                        )
                                        else
                                            {1190}let pkSess_1447: bitstring = fail-any in
                                            {1191}out(c, GetEndpointRequest);
                                            {1192}in(c, (SPs_1448: bitstring,=Sign,UP_1449: bitstring,=pkSess_1447));
                                            {1193}new SPc_1450: bitstring;
                                            {1194}new Nc_1451: bitstring;
                                            {1195}let gNc_1452: bitstring = exp(g,Nc_1451) in
                                            {1196}let m1_1453: bitstring = (SPc_1450,gNc_1452) in
                                            {1197}event beginCli(Cli,Sess,gNc_1452);
                                            {1198}out(c, (pkCli_1059,m1_1453,sign(m1_1453,skCli_1058)));
                                            {1199}in(c, (PartS_1454: bitstring,sigPartS_1455: bitstring));
                                            {1200}if (verify(PartS_1454,sigPartS_1455,pkSess_1447) <> true) then
                                                0
                                            else
                                                {1201}event endCli(Sess,Cli,PartS_1454)
                                )
                                else
                                    {1202}let pkSess_1456: bitstring = fail-any in
                                    {1203}out(c, GetEndpointRequest);
                                    {1204}in(c, (SPs_1457: bitstring,=Sign,UP_1458: bitstring,=pkSess_1456));
                                    {1205}new SPc_1459: bitstring;
                                    {1206}new Nc_1460: bitstring;
                                    {1207}let gNc_1461: bitstring = exp(g,Nc_1460) in
                                    {1208}let m1_1462: bitstring = (SPc_1459,gNc_1461) in
                                    {1209}event beginCli(Cli,Sess,gNc_1461);
                                    {1210}out(c, (pkCli_1059,m1_1462,sign(m1_1462,skCli_1058)));
                                    {1211}in(c, (PartS_1463: bitstring,sigPartS_1464: bitstring));
                                    {1212}if (verify(PartS_1463,sigPartS_1464,pkSess_1456) <> true) then
                                        0
                                    else
                                        {1213}event endCli(Sess,Cli,PartS_1463)
                    )
                    else
                        {1214}let pkDisco_1465: bitstring = fail-any in
                        {1215}let v_1466: bool = (Sess = A) in
                        (
                            {1216}if v_1466 then
                            (
                                {1217}let pkSess_1467: bitstring = pub(skA) in
                                {1218}out(c, GetEndpointRequest);
                                {1219}in(c, (SPs_1468: bitstring,=Sign,UP_1469: bitstring,=pkSess_1467));
                                {1220}new SPc_1470: bitstring;
                                {1221}new Nc_1471: bitstring;
                                {1222}let gNc_1472: bitstring = exp(g,Nc_1471) in
                                {1223}let m1_1473: bitstring = (SPc_1470,gNc_1472) in
                                {1224}event beginCli(Cli,Sess,gNc_1472);
                                {1225}out(c, (pkCli_1059,m1_1473,sign(m1_1473,skCli_1058)));
                                {1226}in(c, (PartS_1474: bitstring,sigPartS_1475: bitstring));
                                {1227}if (verify(PartS_1474,sigPartS_1475,pkSess_1467) <> true) then
                                    0
                                else
                                    {1228}event endCli(Sess,Cli,PartS_1474)
                            )
                            else
                                {1229}let v_1476: bool = (Sess = B) in
                                (
                                    {1230}if v_1476 then
                                    (
                                        {1231}let pkSess_1477: bitstring = pub(skB) in
                                        {1232}out(c, GetEndpointRequest);
                                        {1233}in(c, (SPs_1478: bitstring,=Sign,UP_1479: bitstring,=pkSess_1477));
                                        {1234}new SPc_1480: bitstring;
                                        {1235}new Nc_1481: bitstring;
                                        {1236}let gNc_1482: bitstring = exp(g,Nc_1481) in
                                        {1237}let m1_1483: bitstring = (SPc_1480,gNc_1482) in
                                        {1238}event beginCli(Cli,Sess,gNc_1482);
                                        {1239}out(c, (pkCli_1059,m1_1483,sign(m1_1483,skCli_1058)));
                                        {1240}in(c, (PartS_1484: bitstring,sigPartS_1485: bitstring));
                                        {1241}if (verify(PartS_1484,sigPartS_1485,pkSess_1477) <> true) then
                                            0
                                        else
                                            {1242}event endCli(Sess,Cli,PartS_1484)
                                    )
                                    else
                                        {1243}let v_1486: bool = (Sess = C) in
                                        (
                                            {1244}if v_1486 then
                                            (
                                                {1245}let pkSess_1487: bitstring = pub(skC) in
                                                {1246}out(c, GetEndpointRequest);
                                                {1247}in(c, (SPs_1488: bitstring,=Sign,UP_1489: bitstring,=pkSess_1487));
                                                {1248}new SPc_1490: bitstring;
                                                {1249}new Nc_1491: bitstring;
                                                {1250}let gNc_1492: bitstring = exp(g,Nc_1491) in
                                                {1251}let m1_1493: bitstring = (SPc_1490,gNc_1492) in
                                                {1252}event beginCli(Cli,Sess,gNc_1492);
                                                {1253}out(c, (pkCli_1059,m1_1493,sign(m1_1493,skCli_1058)));
                                                {1254}in(c, (PartS_1494: bitstring,sigPartS_1495: bitstring));
                                                {1255}if (verify(PartS_1494,sigPartS_1495,pkSess_1487) <> true) then
                                                    0
                                                else
                                                    {1256}event endCli(Sess,Cli,PartS_1494)
                                            )
                                            else
                                                {1257}let pkSess_1496: bitstring = pub(skI) in
                                                {1258}out(c, GetEndpointRequest);
                                                {1259}in(c, (SPs_1497: bitstring,=Sign,UP_1498: bitstring,=pkSess_1496));
                                                {1260}new SPc_1499: bitstring;
                                                {1261}new Nc_1500: bitstring;
                                                {1262}let gNc_1501: bitstring = exp(g,Nc_1500) in
                                                {1263}let m1_1502: bitstring = (SPc_1499,gNc_1501) in
                                                {1264}event beginCli(Cli,Sess,gNc_1501);
                                                {1265}out(c, (pkCli_1059,m1_1502,sign(m1_1502,skCli_1058)));
                                                {1266}in(c, (PartS_1503: bitstring,sigPartS_1504: bitstring));
                                                {1267}if (verify(PartS_1503,sigPartS_1504,pkSess_1496) <> true) then
                                                    0
                                                else
                                                    {1268}event endCli(Sess,Cli,PartS_1503)
                                        )
                                        else
                                            {1269}let pkSess_1505: bitstring = fail-any in
                                            {1270}out(c, GetEndpointRequest);
                                            {1271}in(c, (SPs_1506: bitstring,=Sign,UP_1507: bitstring,=pkSess_1505));
                                            {1272}new SPc_1508: bitstring;
                                            {1273}new Nc_1509: bitstring;
                                            {1274}let gNc_1510: bitstring = exp(g,Nc_1509) in
                                            {1275}let m1_1511: bitstring = (SPc_1508,gNc_1510) in
                                            {1276}event beginCli(Cli,Sess,gNc_1510);
                                            {1277}out(c, (pkCli_1059,m1_1511,sign(m1_1511,skCli_1058)));
                                            {1278}in(c, (PartS_1512: bitstring,sigPartS_1513: bitstring));
                                            {1279}if (verify(PartS_1512,sigPartS_1513,pkSess_1505) <> true) then
                                                0
                                            else
                                                {1280}event endCli(Sess,Cli,PartS_1512)
                                )
                                else
                                    {1281}let pkSess_1514: bitstring = fail-any in
                                    {1282}out(c, GetEndpointRequest);
                                    {1283}in(c, (SPs_1515: bitstring,=Sign,UP_1516: bitstring,=pkSess_1514));
                                    {1284}new SPc_1517: bitstring;
                                    {1285}new Nc_1518: bitstring;
                                    {1286}let gNc_1519: bitstring = exp(g,Nc_1518) in
                                    {1287}let m1_1520: bitstring = (SPc_1517,gNc_1519) in
                                    {1288}event beginCli(Cli,Sess,gNc_1519);
                                    {1289}out(c, (pkCli_1059,m1_1520,sign(m1_1520,skCli_1058)));
                                    {1290}in(c, (PartS_1521: bitstring,sigPartS_1522: bitstring));
                                    {1291}if (verify(PartS_1521,sigPartS_1522,pkSess_1514) <> true) then
                                        0
                                    else
                                        {1292}event endCli(Sess,Cli,PartS_1521)
                        )
                        else
                            {1293}let pkSess_1523: bitstring = fail-any in
                            {1294}out(c, GetEndpointRequest);
                            {1295}in(c, (SPs_1524: bitstring,=Sign,UP_1525: bitstring,=pkSess_1523));
                            {1296}new SPc_1526: bitstring;
                            {1297}new Nc_1527: bitstring;
                            {1298}let gNc_1528: bitstring = exp(g,Nc_1527) in
                            {1299}let m1_1529: bitstring = (SPc_1526,gNc_1528) in
                            {1300}event beginCli(Cli,Sess,gNc_1528);
                            {1301}out(c, (pkCli_1059,m1_1529,sign(m1_1529,skCli_1058)));
                            {1302}in(c, (PartS_1530: bitstring,sigPartS_1531: bitstring));
                            {1303}if (verify(PartS_1530,sigPartS_1531,pkSess_1523) <> true) then
                                0
                            else
                                {1304}event endCli(Sess,Cli,PartS_1530)
                )
                else
                    {1305}let v_1532: bool = (Cli = C) in
                    (
                        {1306}if v_1532 then
                        (
                            {1307}let skCli_1533: bitstring = skC in
                            {1308}let pkCli_1534: bitstring = pub(skCli_1533) in
                            {1309}let v_1535: bool = (Disco = A) in
                            (
                                {1310}if v_1535 then
                                (
                                    {1311}let pkDisco_1536: bitstring = pub(skA) in
                                    {1312}let v_1537: bool = (Sess = A) in
                                    (
                                        {1313}if v_1537 then
                                        (
                                            {1314}let pkSess_1538: bitstring = pub(skA) in
                                            {1315}out(c, GetEndpointRequest);
                                            {1316}in(c, (SPs_1539: bitstring,=Sign,UP_1540: bitstring,=pkSess_1538));
                                            {1317}new SPc_1541: bitstring;
                                            {1318}new Nc_1542: bitstring;
                                            {1319}let gNc_1543: bitstring = exp(g,Nc_1542) in
                                            {1320}let m1_1544: bitstring = (SPc_1541,gNc_1543) in
                                            {1321}event beginCli(Cli,Sess,gNc_1543);
                                            {1322}out(c, (pkCli_1534,m1_1544,sign(m1_1544,skCli_1533)));
                                            {1323}in(c, (PartS_1545: bitstring,sigPartS_1546: bitstring));
                                            {1324}if (verify(PartS_1545,sigPartS_1546,pkSess_1538) <> true) then
                                                0
                                            else
                                                {1325}event endCli(Sess,Cli,PartS_1545)
                                        )
                                        else
                                            {1326}let v_1547: bool = (Sess = B) in
                                            (
                                                {1327}if v_1547 then
                                                (
                                                    {1328}let pkSess_1548: bitstring = pub(skB) in
                                                    {1329}out(c, GetEndpointRequest);
                                                    {1330}in(c, (SPs_1549: bitstring,=Sign,UP_1550: bitstring,=pkSess_1548));
                                                    {1331}new SPc_1551: bitstring;
                                                    {1332}new Nc_1552: bitstring;
                                                    {1333}let gNc_1553: bitstring = exp(g,Nc_1552) in
                                                    {1334}let m1_1554: bitstring = (SPc_1551,gNc_1553) in
                                                    {1335}event beginCli(Cli,Sess,gNc_1553);
                                                    {1336}out(c, (pkCli_1534,m1_1554,sign(m1_1554,skCli_1533)));
                                                    {1337}in(c, (PartS_1555: bitstring,sigPartS_1556: bitstring));
                                                    {1338}if (verify(PartS_1555,sigPartS_1556,pkSess_1548) <> true) then
                                                        0
                                                    else
                                                        {1339}event endCli(Sess,Cli,PartS_1555)
                                                )
                                                else
                                                    {1340}let v_1557: bool = (Sess = C) in
                                                    (
                                                        {1341}if v_1557 then
                                                        (
                                                            {1342}let pkSess_1558: bitstring = pub(skC) in
                                                            {1343}out(c, GetEndpointRequest);
                                                            {1344}in(c, (SPs_1559: bitstring,=Sign,UP_1560: bitstring,=pkSess_1558));
                                                            {1345}new SPc_1561: bitstring;
                                                            {1346}new Nc_1562: bitstring;
                                                            {1347}let gNc_1563: bitstring = exp(g,Nc_1562) in
                                                            {1348}let m1_1564: bitstring = (SPc_1561,gNc_1563) in
                                                            {1349}event beginCli(Cli,Sess,gNc_1563);
                                                            {1350}out(c, (pkCli_1534,m1_1564,sign(m1_1564,skCli_1533)));
                                                            {1351}in(c, (PartS_1565: bitstring,sigPartS_1566: bitstring));
                                                            {1352}if (verify(PartS_1565,sigPartS_1566,pkSess_1558) <> true) then
                                                                0
                                                            else
                                                                {1353}event endCli(Sess,Cli,PartS_1565)
                                                        )
                                                        else
                                                            {1354}let pkSess_1567: bitstring = pub(skI) in
                                                            {1355}out(c, GetEndpointRequest);
                                                            {1356}in(c, (SPs_1568: bitstring,=Sign,UP_1569: bitstring,=pkSess_1567));
                                                            {1357}new SPc_1570: bitstring;
                                                            {1358}new Nc_1571: bitstring;
                                                            {1359}let gNc_1572: bitstring = exp(g,Nc_1571) in
                                                            {1360}let m1_1573: bitstring = (SPc_1570,gNc_1572) in
                                                            {1361}event beginCli(Cli,Sess,gNc_1572);
                                                            {1362}out(c, (pkCli_1534,m1_1573,sign(m1_1573,skCli_1533)));
                                                            {1363}in(c, (PartS_1574: bitstring,sigPartS_1575: bitstring));
                                                            {1364}if (verify(PartS_1574,sigPartS_1575,pkSess_1567) <> true) then
                                                                0
                                                            else
                                                                {1365}event endCli(Sess,Cli,PartS_1574)
                                                    )
                                                    else
                                                        {1366}let pkSess_1576: bitstring = fail-any in
                                                        {1367}out(c, GetEndpointRequest);
                                                        {1368}in(c, (SPs_1577: bitstring,=Sign,UP_1578: bitstring,=pkSess_1576));
                                                        {1369}new SPc_1579: bitstring;
                                                        {1370}new Nc_1580: bitstring;
                                                        {1371}let gNc_1581: bitstring = exp(g,Nc_1580) in
                                                        {1372}let m1_1582: bitstring = (SPc_1579,gNc_1581) in
                                                        {1373}event beginCli(Cli,Sess,gNc_1581);
                                                        {1374}out(c, (pkCli_1534,m1_1582,sign(m1_1582,skCli_1533)));
                                                        {1375}in(c, (PartS_1583: bitstring,sigPartS_1584: bitstring));
                                                        {1376}if (verify(PartS_1583,sigPartS_1584,pkSess_1576) <> true) then
                                                            0
                                                        else
                                                            {1377}event endCli(Sess,Cli,PartS_1583)
                                            )
                                            else
                                                {1378}let pkSess_1585: bitstring = fail-any in
                                                {1379}out(c, GetEndpointRequest);
                                                {1380}in(c, (SPs_1586: bitstring,=Sign,UP_1587: bitstring,=pkSess_1585));
                                                {1381}new SPc_1588: bitstring;
                                                {1382}new Nc_1589: bitstring;
                                                {1383}let gNc_1590: bitstring = exp(g,Nc_1589) in
                                                {1384}let m1_1591: bitstring = (SPc_1588,gNc_1590) in
                                                {1385}event beginCli(Cli,Sess,gNc_1590);
                                                {1386}out(c, (pkCli_1534,m1_1591,sign(m1_1591,skCli_1533)));
                                                {1387}in(c, (PartS_1592: bitstring,sigPartS_1593: bitstring));
                                                {1388}if (verify(PartS_1592,sigPartS_1593,pkSess_1585) <> true) then
                                                    0
                                                else
                                                    {1389}event endCli(Sess,Cli,PartS_1592)
                                    )
                                    else
                                        {1390}let pkSess_1594: bitstring = fail-any in
                                        {1391}out(c, GetEndpointRequest);
                                        {1392}in(c, (SPs_1595: bitstring,=Sign,UP_1596: bitstring,=pkSess_1594));
                                        {1393}new SPc_1597: bitstring;
                                        {1394}new Nc_1598: bitstring;
                                        {1395}let gNc_1599: bitstring = exp(g,Nc_1598) in
                                        {1396}let m1_1600: bitstring = (SPc_1597,gNc_1599) in
                                        {1397}event beginCli(Cli,Sess,gNc_1599);
                                        {1398}out(c, (pkCli_1534,m1_1600,sign(m1_1600,skCli_1533)));
                                        {1399}in(c, (PartS_1601: bitstring,sigPartS_1602: bitstring));
                                        {1400}if (verify(PartS_1601,sigPartS_1602,pkSess_1594) <> true) then
                                            0
                                        else
                                            {1401}event endCli(Sess,Cli,PartS_1601)
                                )
                                else
                                    {1402}let v_1603: bool = (Disco = B) in
                                    (
                                        {1403}if v_1603 then
                                        (
                                            {1404}let pkDisco_1604: bitstring = pub(skB) in
                                            {1405}let v_1605: bool = (Sess = A) in
                                            (
                                                {1406}if v_1605 then
                                                (
                                                    {1407}let pkSess_1606: bitstring = pub(skA) in
                                                    {1408}out(c, GetEndpointRequest);
                                                    {1409}in(c, (SPs_1607: bitstring,=Sign,UP_1608: bitstring,=pkSess_1606));
                                                    {1410}new SPc_1609: bitstring;
                                                    {1411}new Nc_1610: bitstring;
                                                    {1412}let gNc_1611: bitstring = exp(g,Nc_1610) in
                                                    {1413}let m1_1612: bitstring = (SPc_1609,gNc_1611) in
                                                    {1414}event beginCli(Cli,Sess,gNc_1611);
                                                    {1415}out(c, (pkCli_1534,m1_1612,sign(m1_1612,skCli_1533)));
                                                    {1416}in(c, (PartS_1613: bitstring,sigPartS_1614: bitstring));
                                                    {1417}if (verify(PartS_1613,sigPartS_1614,pkSess_1606) <> true) then
                                                        0
                                                    else
                                                        {1418}event endCli(Sess,Cli,PartS_1613)
                                                )
                                                else
                                                    {1419}let v_1615: bool = (Sess = B) in
                                                    (
                                                        {1420}if v_1615 then
                                                        (
                                                            {1421}let pkSess_1616: bitstring = pub(skB) in
                                                            {1422}out(c, GetEndpointRequest);
                                                            {1423}in(c, (SPs_1617: bitstring,=Sign,UP_1618: bitstring,=pkSess_1616));
                                                            {1424}new SPc_1619: bitstring;
                                                            {1425}new Nc_1620: bitstring;
                                                            {1426}let gNc_1621: bitstring = exp(g,Nc_1620) in
                                                            {1427}let m1_1622: bitstring = (SPc_1619,gNc_1621) in
                                                            {1428}event beginCli(Cli,Sess,gNc_1621);
                                                            {1429}out(c, (pkCli_1534,m1_1622,sign(m1_1622,skCli_1533)));
                                                            {1430}in(c, (PartS_1623: bitstring,sigPartS_1624: bitstring));
                                                            {1431}if (verify(PartS_1623,sigPartS_1624,pkSess_1616) <> true) then
                                                                0
                                                            else
                                                                {1432}event endCli(Sess,Cli,PartS_1623)
                                                        )
                                                        else
                                                            {1433}let v_1625: bool = (Sess = C) in
                                                            (
                                                                {1434}if v_1625 then
                                                                (
                                                                    {1435}let pkSess_1626: bitstring = pub(skC) in
                                                                    {1436}out(c, GetEndpointRequest);
                                                                    {1437}in(c, (SPs_1627: bitstring,=Sign,UP_1628: bitstring,=pkSess_1626));
                                                                    {1438}new SPc_1629: bitstring;
                                                                    {1439}new Nc_1630: bitstring;
                                                                    {1440}let gNc_1631: bitstring = exp(g,Nc_1630) in
                                                                    {1441}let m1_1632: bitstring = (SPc_1629,gNc_1631) in
                                                                    {1442}event beginCli(Cli,Sess,gNc_1631);
                                                                    {1443}out(c, (pkCli_1534,m1_1632,sign(m1_1632,skCli_1533)));
                                                                    {1444}in(c, (PartS_1633: bitstring,sigPartS_1634: bitstring));
                                                                    {1445}if (verify(PartS_1633,sigPartS_1634,pkSess_1626) <> true) then
                                                                        0
                                                                    else
                                                                        {1446}event endCli(Sess,Cli,PartS_1633)
                                                                )
                                                                else
                                                                    {1447}let pkSess_1635: bitstring = pub(skI) in
                                                                    {1448}out(c, GetEndpointRequest);
                                                                    {1449}in(c, (SPs_1636: bitstring,=Sign,UP_1637: bitstring,=pkSess_1635));
                                                                    {1450}new SPc_1638: bitstring;
                                                                    {1451}new Nc_1639: bitstring;
                                                                    {1452}let gNc_1640: bitstring = exp(g,Nc_1639) in
                                                                    {1453}let m1_1641: bitstring = (SPc_1638,gNc_1640) in
                                                                    {1454}event beginCli(Cli,Sess,gNc_1640);
                                                                    {1455}out(c, (pkCli_1534,m1_1641,sign(m1_1641,skCli_1533)));
                                                                    {1456}in(c, (PartS_1642: bitstring,sigPartS_1643: bitstring));
                                                                    {1457}if (verify(PartS_1642,sigPartS_1643,pkSess_1635) <> true) then
                                                                        0
                                                                    else
                                                                        {1458}event endCli(Sess,Cli,PartS_1642)
                                                            )
                                                            else
                                                                {1459}let pkSess_1644: bitstring = fail-any in
                                                                {1460}out(c, GetEndpointRequest);
                                                                {1461}in(c, (SPs_1645: bitstring,=Sign,UP_1646: bitstring,=pkSess_1644));
                                                                {1462}new SPc_1647: bitstring;
                                                                {1463}new Nc_1648: bitstring;
                                                                {1464}let gNc_1649: bitstring = exp(g,Nc_1648) in
                                                                {1465}let m1_1650: bitstring = (SPc_1647,gNc_1649) in
                                                                {1466}event beginCli(Cli,Sess,gNc_1649);
                                                                {1467}out(c, (pkCli_1534,m1_1650,sign(m1_1650,skCli_1533)));
                                                                {1468}in(c, (PartS_1651: bitstring,sigPartS_1652: bitstring));
                                                                {1469}if (verify(PartS_1651,sigPartS_1652,pkSess_1644) <> true) then
                                                                    0
                                                                else
                                                                    {1470}event endCli(Sess,Cli,PartS_1651)
                                                    )
                                                    else
                                                        {1471}let pkSess_1653: bitstring = fail-any in
                                                        {1472}out(c, GetEndpointRequest);
                                                        {1473}in(c, (SPs_1654: bitstring,=Sign,UP_1655: bitstring,=pkSess_1653));
                                                        {1474}new SPc_1656: bitstring;
                                                        {1475}new Nc_1657: bitstring;
                                                        {1476}let gNc_1658: bitstring = exp(g,Nc_1657) in
                                                        {1477}let m1_1659: bitstring = (SPc_1656,gNc_1658) in
                                                        {1478}event beginCli(Cli,Sess,gNc_1658);
                                                        {1479}out(c, (pkCli_1534,m1_1659,sign(m1_1659,skCli_1533)));
                                                        {1480}in(c, (PartS_1660: bitstring,sigPartS_1661: bitstring));
                                                        {1481}if (verify(PartS_1660,sigPartS_1661,pkSess_1653) <> true) then
                                                            0
                                                        else
                                                            {1482}event endCli(Sess,Cli,PartS_1660)
                                            )
                                            else
                                                {1483}let pkSess_1662: bitstring = fail-any in
                                                {1484}out(c, GetEndpointRequest);
                                                {1485}in(c, (SPs_1663: bitstring,=Sign,UP_1664: bitstring,=pkSess_1662));
                                                {1486}new SPc_1665: bitstring;
                                                {1487}new Nc_1666: bitstring;
                                                {1488}let gNc_1667: bitstring = exp(g,Nc_1666) in
                                                {1489}let m1_1668: bitstring = (SPc_1665,gNc_1667) in
                                                {1490}event beginCli(Cli,Sess,gNc_1667);
                                                {1491}out(c, (pkCli_1534,m1_1668,sign(m1_1668,skCli_1533)));
                                                {1492}in(c, (PartS_1669: bitstring,sigPartS_1670: bitstring));
                                                {1493}if (verify(PartS_1669,sigPartS_1670,pkSess_1662) <> true) then
                                                    0
                                                else
                                                    {1494}event endCli(Sess,Cli,PartS_1669)
                                        )
                                        else
                                            {1495}let v_1671: bool = (Disco = C) in
                                            (
                                                {1496}if v_1671 then
                                                (
                                                    {1497}let pkDisco_1672: bitstring = pub(skC) in
                                                    {1498}let v_1673: bool = (Sess = A) in
                                                    (
                                                        {1499}if v_1673 then
                                                        (
                                                            {1500}let pkSess_1674: bitstring = pub(skA) in
                                                            {1501}out(c, GetEndpointRequest);
                                                            {1502}in(c, (SPs_1675: bitstring,=Sign,UP_1676: bitstring,=pkSess_1674));
                                                            {1503}new SPc_1677: bitstring;
                                                            {1504}new Nc_1678: bitstring;
                                                            {1505}let gNc_1679: bitstring = exp(g,Nc_1678) in
                                                            {1506}let m1_1680: bitstring = (SPc_1677,gNc_1679) in
                                                            {1507}event beginCli(Cli,Sess,gNc_1679);
                                                            {1508}out(c, (pkCli_1534,m1_1680,sign(m1_1680,skCli_1533)));
                                                            {1509}in(c, (PartS_1681: bitstring,sigPartS_1682: bitstring));
                                                            {1510}if (verify(PartS_1681,sigPartS_1682,pkSess_1674) <> true) then
                                                                0
                                                            else
                                                                {1511}event endCli(Sess,Cli,PartS_1681)
                                                        )
                                                        else
                                                            {1512}let v_1683: bool = (Sess = B) in
                                                            (
                                                                {1513}if v_1683 then
                                                                (
                                                                    {1514}let pkSess_1684: bitstring = pub(skB) in
                                                                    {1515}out(c, GetEndpointRequest);
                                                                    {1516}in(c, (SPs_1685: bitstring,=Sign,UP_1686: bitstring,=pkSess_1684));
                                                                    {1517}new SPc_1687: bitstring;
                                                                    {1518}new Nc_1688: bitstring;
                                                                    {1519}let gNc_1689: bitstring = exp(g,Nc_1688) in
                                                                    {1520}let m1_1690: bitstring = (SPc_1687,gNc_1689) in
                                                                    {1521}event beginCli(Cli,Sess,gNc_1689);
                                                                    {1522}out(c, (pkCli_1534,m1_1690,sign(m1_1690,skCli_1533)));
                                                                    {1523}in(c, (PartS_1691: bitstring,sigPartS_1692: bitstring));
                                                                    {1524}if (verify(PartS_1691,sigPartS_1692,pkSess_1684) <> true) then
                                                                        0
                                                                    else
                                                                        {1525}event endCli(Sess,Cli,PartS_1691)
                                                                )
                                                                else
                                                                    {1526}let v_1693: bool = (Sess = C) in
                                                                    (
                                                                        {1527}if v_1693 then
                                                                        (
                                                                            {1528}let pkSess_1694: bitstring = pub(skC) in
                                                                            {1529}out(c, GetEndpointRequest);
                                                                            {1530}in(c, (SPs_1695: bitstring,=Sign,UP_1696: bitstring,=pkSess_1694));
                                                                            {1531}new SPc_1697: bitstring;
                                                                            {1532}new Nc_1698: bitstring;
                                                                            {1533}let gNc_1699: bitstring = exp(g,Nc_1698) in
                                                                            {1534}let m1_1700: bitstring = (SPc_1697,gNc_1699) in
                                                                            {1535}event beginCli(Cli,Sess,gNc_1699);
                                                                            {1536}out(c, (pkCli_1534,m1_1700,sign(m1_1700,skCli_1533)));
                                                                            {1537}in(c, (PartS_1701: bitstring,sigPartS_1702: bitstring));
                                                                            {1538}if (verify(PartS_1701,sigPartS_1702,pkSess_1694) <> true) then
                                                                                0
                                                                            else
                                                                                {1539}event endCli(Sess,Cli,PartS_1701)
                                                                        )
                                                                        else
                                                                            {1540}let pkSess_1703: bitstring = pub(skI) in
                                                                            {1541}out(c, GetEndpointRequest);
                                                                            {1542}in(c, (SPs_1704: bitstring,=Sign,UP_1705: bitstring,=pkSess_1703));
                                                                            {1543}new SPc_1706: bitstring;
                                                                            {1544}new Nc_1707: bitstring;
                                                                            {1545}let gNc_1708: bitstring = exp(g,Nc_1707) in
                                                                            {1546}let m1_1709: bitstring = (SPc_1706,gNc_1708) in
                                                                            {1547}event beginCli(Cli,Sess,gNc_1708);
                                                                            {1548}out(c, (pkCli_1534,m1_1709,sign(m1_1709,skCli_1533)));
                                                                            {1549}in(c, (PartS_1710: bitstring,sigPartS_1711: bitstring));
                                                                            {1550}if (verify(PartS_1710,sigPartS_1711,pkSess_1703) <> true) then
                                                                                0
                                                                            else
                                                                                {1551}event endCli(Sess,Cli,PartS_1710)
                                                                    )
                                                                    else
                                                                        {1552}let pkSess_1712: bitstring = fail-any in
                                                                        {1553}out(c, GetEndpointRequest);
                                                                        {1554}in(c, (SPs_1713: bitstring,=Sign,UP_1714: bitstring,=pkSess_1712));
                                                                        {1555}new SPc_1715: bitstring;
                                                                        {1556}new Nc_1716: bitstring;
                                                                        {1557}let gNc_1717: bitstring = exp(g,Nc_1716) in
                                                                        {1558}let m1_1718: bitstring = (SPc_1715,gNc_1717) in
                                                                        {1559}event beginCli(Cli,Sess,gNc_1717);
                                                                        {1560}out(c, (pkCli_1534,m1_1718,sign(m1_1718,skCli_1533)));
                                                                        {1561}in(c, (PartS_1719: bitstring,sigPartS_1720: bitstring));
                                                                        {1562}if (verify(PartS_1719,sigPartS_1720,pkSess_1712) <> true) then
                                                                            0
                                                                        else
                                                                            {1563}event endCli(Sess,Cli,PartS_1719)
                                                            )
                                                            else
                                                                {1564}let pkSess_1721: bitstring = fail-any in
                                                                {1565}out(c, GetEndpointRequest);
                                                                {1566}in(c, (SPs_1722: bitstring,=Sign,UP_1723: bitstring,=pkSess_1721));
                                                                {1567}new SPc_1724: bitstring;
                                                                {1568}new Nc_1725: bitstring;
                                                                {1569}let gNc_1726: bitstring = exp(g,Nc_1725) in
                                                                {1570}let m1_1727: bitstring = (SPc_1724,gNc_1726) in
                                                                {1571}event beginCli(Cli,Sess,gNc_1726);
                                                                {1572}out(c, (pkCli_1534,m1_1727,sign(m1_1727,skCli_1533)));
                                                                {1573}in(c, (PartS_1728: bitstring,sigPartS_1729: bitstring));
                                                                {1574}if (verify(PartS_1728,sigPartS_1729,pkSess_1721) <> true) then
                                                                    0
                                                                else
                                                                    {1575}event endCli(Sess,Cli,PartS_1728)
                                                    )
                                                    else
                                                        {1576}let pkSess_1730: bitstring = fail-any in
                                                        {1577}out(c, GetEndpointRequest);
                                                        {1578}in(c, (SPs_1731: bitstring,=Sign,UP_1732: bitstring,=pkSess_1730));
                                                        {1579}new SPc_1733: bitstring;
                                                        {1580}new Nc_1734: bitstring;
                                                        {1581}let gNc_1735: bitstring = exp(g,Nc_1734) in
                                                        {1582}let m1_1736: bitstring = (SPc_1733,gNc_1735) in
                                                        {1583}event beginCli(Cli,Sess,gNc_1735);
                                                        {1584}out(c, (pkCli_1534,m1_1736,sign(m1_1736,skCli_1533)));
                                                        {1585}in(c, (PartS_1737: bitstring,sigPartS_1738: bitstring));
                                                        {1586}if (verify(PartS_1737,sigPartS_1738,pkSess_1730) <> true) then
                                                            0
                                                        else
                                                            {1587}event endCli(Sess,Cli,PartS_1737)
                                                )
                                                else
                                                    {1588}let pkDisco_1739: bitstring = pub(skI) in
                                                    {1589}let v_1740: bool = (Sess = A) in
                                                    (
                                                        {1590}if v_1740 then
                                                        (
                                                            {1591}let pkSess_1741: bitstring = pub(skA) in
                                                            {1592}out(c, GetEndpointRequest);
                                                            {1593}in(c, (SPs_1742: bitstring,=Sign,UP_1743: bitstring,=pkSess_1741));
                                                            {1594}new SPc_1744: bitstring;
                                                            {1595}new Nc_1745: bitstring;
                                                            {1596}let gNc_1746: bitstring = exp(g,Nc_1745) in
                                                            {1597}let m1_1747: bitstring = (SPc_1744,gNc_1746) in
                                                            {1598}event beginCli(Cli,Sess,gNc_1746);
                                                            {1599}out(c, (pkCli_1534,m1_1747,sign(m1_1747,skCli_1533)));
                                                            {1600}in(c, (PartS_1748: bitstring,sigPartS_1749: bitstring));
                                                            {1601}if (verify(PartS_1748,sigPartS_1749,pkSess_1741) <> true) then
                                                                0
                                                            else
                                                                {1602}event endCli(Sess,Cli,PartS_1748)
                                                        )
                                                        else
                                                            {1603}let v_1750: bool = (Sess = B) in
                                                            (
                                                                {1604}if v_1750 then
                                                                (
                                                                    {1605}let pkSess_1751: bitstring = pub(skB) in
                                                                    {1606}out(c, GetEndpointRequest);
                                                                    {1607}in(c, (SPs_1752: bitstring,=Sign,UP_1753: bitstring,=pkSess_1751));
                                                                    {1608}new SPc_1754: bitstring;
                                                                    {1609}new Nc_1755: bitstring;
                                                                    {1610}let gNc_1756: bitstring = exp(g,Nc_1755) in
                                                                    {1611}let m1_1757: bitstring = (SPc_1754,gNc_1756) in
                                                                    {1612}event beginCli(Cli,Sess,gNc_1756);
                                                                    {1613}out(c, (pkCli_1534,m1_1757,sign(m1_1757,skCli_1533)));
                                                                    {1614}in(c, (PartS_1758: bitstring,sigPartS_1759: bitstring));
                                                                    {1615}if (verify(PartS_1758,sigPartS_1759,pkSess_1751) <> true) then
                                                                        0
                                                                    else
                                                                        {1616}event endCli(Sess,Cli,PartS_1758)
                                                                )
                                                                else
                                                                    {1617}let v_1760: bool = (Sess = C) in
                                                                    (
                                                                        {1618}if v_1760 then
                                                                        (
                                                                            {1619}let pkSess_1761: bitstring = pub(skC) in
                                                                            {1620}out(c, GetEndpointRequest);
                                                                            {1621}in(c, (SPs_1762: bitstring,=Sign,UP_1763: bitstring,=pkSess_1761));
                                                                            {1622}new SPc_1764: bitstring;
                                                                            {1623}new Nc_1765: bitstring;
                                                                            {1624}let gNc_1766: bitstring = exp(g,Nc_1765) in
                                                                            {1625}let m1_1767: bitstring = (SPc_1764,gNc_1766) in
                                                                            {1626}event beginCli(Cli,Sess,gNc_1766);
                                                                            {1627}out(c, (pkCli_1534,m1_1767,sign(m1_1767,skCli_1533)));
                                                                            {1628}in(c, (PartS_1768: bitstring,sigPartS_1769: bitstring));
                                                                            {1629}if (verify(PartS_1768,sigPartS_1769,pkSess_1761) <> true) then
                                                                                0
                                                                            else
                                                                                {1630}event endCli(Sess,Cli,PartS_1768)
                                                                        )
                                                                        else
                                                                            {1631}let pkSess_1770: bitstring = pub(skI) in
                                                                            {1632}out(c, GetEndpointRequest);
                                                                            {1633}in(c, (SPs_1771: bitstring,=Sign,UP_1772: bitstring,=pkSess_1770));
                                                                            {1634}new SPc_1773: bitstring;
                                                                            {1635}new Nc_1774: bitstring;
                                                                            {1636}let gNc_1775: bitstring = exp(g,Nc_1774) in
                                                                            {1637}let m1_1776: bitstring = (SPc_1773,gNc_1775) in
                                                                            {1638}event beginCli(Cli,Sess,gNc_1775);
                                                                            {1639}out(c, (pkCli_1534,m1_1776,sign(m1_1776,skCli_1533)));
                                                                            {1640}in(c, (PartS_1777: bitstring,sigPartS_1778: bitstring));
                                                                            {1641}if (verify(PartS_1777,sigPartS_1778,pkSess_1770) <> true) then
                                                                                0
                                                                            else
                                                                                {1642}event endCli(Sess,Cli,PartS_1777)
                                                                    )
                                                                    else
                                                                        {1643}let pkSess_1779: bitstring = fail-any in
                                                                        {1644}out(c, GetEndpointRequest);
                                                                        {1645}in(c, (SPs_1780: bitstring,=Sign,UP_1781: bitstring,=pkSess_1779));
                                                                        {1646}new SPc_1782: bitstring;
                                                                        {1647}new Nc_1783: bitstring;
                                                                        {1648}let gNc_1784: bitstring = exp(g,Nc_1783) in
                                                                        {1649}let m1_1785: bitstring = (SPc_1782,gNc_1784) in
                                                                        {1650}event beginCli(Cli,Sess,gNc_1784);
                                                                        {1651}out(c, (pkCli_1534,m1_1785,sign(m1_1785,skCli_1533)));
                                                                        {1652}in(c, (PartS_1786: bitstring,sigPartS_1787: bitstring));
                                                                        {1653}if (verify(PartS_1786,sigPartS_1787,pkSess_1779) <> true) then
                                                                            0
                                                                        else
                                                                            {1654}event endCli(Sess,Cli,PartS_1786)
                                                            )
                                                            else
                                                                {1655}let pkSess_1788: bitstring = fail-any in
                                                                {1656}out(c, GetEndpointRequest);
                                                                {1657}in(c, (SPs_1789: bitstring,=Sign,UP_1790: bitstring,=pkSess_1788));
                                                                {1658}new SPc_1791: bitstring;
                                                                {1659}new Nc_1792: bitstring;
                                                                {1660}let gNc_1793: bitstring = exp(g,Nc_1792) in
                                                                {1661}let m1_1794: bitstring = (SPc_1791,gNc_1793) in
                                                                {1662}event beginCli(Cli,Sess,gNc_1793);
                                                                {1663}out(c, (pkCli_1534,m1_1794,sign(m1_1794,skCli_1533)));
                                                                {1664}in(c, (PartS_1795: bitstring,sigPartS_1796: bitstring));
                                                                {1665}if (verify(PartS_1795,sigPartS_1796,pkSess_1788) <> true) then
                                                                    0
                                                                else
                                                                    {1666}event endCli(Sess,Cli,PartS_1795)
                                                    )
                                                    else
                                                        {1667}let pkSess_1797: bitstring = fail-any in
                                                        {1668}out(c, GetEndpointRequest);
                                                        {1669}in(c, (SPs_1798: bitstring,=Sign,UP_1799: bitstring,=pkSess_1797));
                                                        {1670}new SPc_1800: bitstring;
                                                        {1671}new Nc_1801: bitstring;
                                                        {1672}let gNc_1802: bitstring = exp(g,Nc_1801) in
                                                        {1673}let m1_1803: bitstring = (SPc_1800,gNc_1802) in
                                                        {1674}event beginCli(Cli,Sess,gNc_1802);
                                                        {1675}out(c, (pkCli_1534,m1_1803,sign(m1_1803,skCli_1533)));
                                                        {1676}in(c, (PartS_1804: bitstring,sigPartS_1805: bitstring));
                                                        {1677}if (verify(PartS_1804,sigPartS_1805,pkSess_1797) <> true) then
                                                            0
                                                        else
                                                            {1678}event endCli(Sess,Cli,PartS_1804)
                                            )
                                            else
                                                {1679}let pkDisco_1806: bitstring = fail-any in
                                                {1680}let v_1807: bool = (Sess = A) in
                                                (
                                                    {1681}if v_1807 then
                                                    (
                                                        {1682}let pkSess_1808: bitstring = pub(skA) in
                                                        {1683}out(c, GetEndpointRequest);
                                                        {1684}in(c, (SPs_1809: bitstring,=Sign,UP_1810: bitstring,=pkSess_1808));
                                                        {1685}new SPc_1811: bitstring;
                                                        {1686}new Nc_1812: bitstring;
                                                        {1687}let gNc_1813: bitstring = exp(g,Nc_1812) in
                                                        {1688}let m1_1814: bitstring = (SPc_1811,gNc_1813) in
                                                        {1689}event beginCli(Cli,Sess,gNc_1813);
                                                        {1690}out(c, (pkCli_1534,m1_1814,sign(m1_1814,skCli_1533)));
                                                        {1691}in(c, (PartS_1815: bitstring,sigPartS_1816: bitstring));
                                                        {1692}if (verify(PartS_1815,sigPartS_1816,pkSess_1808) <> true) then
                                                            0
                                                        else
                                                            {1693}event endCli(Sess,Cli,PartS_1815)
                                                    )
                                                    else
                                                        {1694}let v_1817: bool = (Sess = B) in
                                                        (
                                                            {1695}if v_1817 then
                                                            (
                                                                {1696}let pkSess_1818: bitstring = pub(skB) in
                                                                {1697}out(c, GetEndpointRequest);
                                                                {1698}in(c, (SPs_1819: bitstring,=Sign,UP_1820: bitstring,=pkSess_1818));
                                                                {1699}new SPc_1821: bitstring;
                                                                {1700}new Nc_1822: bitstring;
                                                                {1701}let gNc_1823: bitstring = exp(g,Nc_1822) in
                                                                {1702}let m1_1824: bitstring = (SPc_1821,gNc_1823) in
                                                                {1703}event beginCli(Cli,Sess,gNc_1823);
                                                                {1704}out(c, (pkCli_1534,m1_1824,sign(m1_1824,skCli_1533)));
                                                                {1705}in(c, (PartS_1825: bitstring,sigPartS_1826: bitstring));
                                                                {1706}if (verify(PartS_1825,sigPartS_1826,pkSess_1818) <> true) then
                                                                    0
                                                                else
                                                                    {1707}event endCli(Sess,Cli,PartS_1825)
                                                            )
                                                            else
                                                                {1708}let v_1827: bool = (Sess = C) in
                                                                (
                                                                    {1709}if v_1827 then
                                                                    (
                                                                        {1710}let pkSess_1828: bitstring = pub(skC) in
                                                                        {1711}out(c, GetEndpointRequest);
                                                                        {1712}in(c, (SPs_1829: bitstring,=Sign,UP_1830: bitstring,=pkSess_1828));
                                                                        {1713}new SPc_1831: bitstring;
                                                                        {1714}new Nc_1832: bitstring;
                                                                        {1715}let gNc_1833: bitstring = exp(g,Nc_1832) in
                                                                        {1716}let m1_1834: bitstring = (SPc_1831,gNc_1833) in
                                                                        {1717}event beginCli(Cli,Sess,gNc_1833);
                                                                        {1718}out(c, (pkCli_1534,m1_1834,sign(m1_1834,skCli_1533)));
                                                                        {1719}in(c, (PartS_1835: bitstring,sigPartS_1836: bitstring));
                                                                        {1720}if (verify(PartS_1835,sigPartS_1836,pkSess_1828) <> true) then
                                                                            0
                                                                        else
                                                                            {1721}event endCli(Sess,Cli,PartS_1835)
                                                                    )
                                                                    else
                                                                        {1722}let pkSess_1837: bitstring = pub(skI) in
                                                                        {1723}out(c, GetEndpointRequest);
                                                                        {1724}in(c, (SPs_1838: bitstring,=Sign,UP_1839: bitstring,=pkSess_1837));
                                                                        {1725}new SPc_1840: bitstring;
                                                                        {1726}new Nc_1841: bitstring;
                                                                        {1727}let gNc_1842: bitstring = exp(g,Nc_1841) in
                                                                        {1728}let m1_1843: bitstring = (SPc_1840,gNc_1842) in
                                                                        {1729}event beginCli(Cli,Sess,gNc_1842);
                                                                        {1730}out(c, (pkCli_1534,m1_1843,sign(m1_1843,skCli_1533)));
                                                                        {1731}in(c, (PartS_1844: bitstring,sigPartS_1845: bitstring));
                                                                        {1732}if (verify(PartS_1844,sigPartS_1845,pkSess_1837) <> true) then
                                                                            0
                                                                        else
                                                                            {1733}event endCli(Sess,Cli,PartS_1844)
                                                                )
                                                                else
                                                                    {1734}let pkSess_1846: bitstring = fail-any in
                                                                    {1735}out(c, GetEndpointRequest);
                                                                    {1736}in(c, (SPs_1847: bitstring,=Sign,UP_1848: bitstring,=pkSess_1846));
                                                                    {1737}new SPc_1849: bitstring;
                                                                    {1738}new Nc_1850: bitstring;
                                                                    {1739}let gNc_1851: bitstring = exp(g,Nc_1850) in
                                                                    {1740}let m1_1852: bitstring = (SPc_1849,gNc_1851) in
                                                                    {1741}event beginCli(Cli,Sess,gNc_1851);
                                                                    {1742}out(c, (pkCli_1534,m1_1852,sign(m1_1852,skCli_1533)));
                                                                    {1743}in(c, (PartS_1853: bitstring,sigPartS_1854: bitstring));
                                                                    {1744}if (verify(PartS_1853,sigPartS_1854,pkSess_1846) <> true) then
                                                                        0
                                                                    else
                                                                        {1745}event endCli(Sess,Cli,PartS_1853)
                                                        )
                                                        else
                                                            {1746}let pkSess_1855: bitstring = fail-any in
                                                            {1747}out(c, GetEndpointRequest);
                                                            {1748}in(c, (SPs_1856: bitstring,=Sign,UP_1857: bitstring,=pkSess_1855));
                                                            {1749}new SPc_1858: bitstring;
                                                            {1750}new Nc_1859: bitstring;
                                                            {1751}let gNc_1860: bitstring = exp(g,Nc_1859) in
                                                            {1752}let m1_1861: bitstring = (SPc_1858,gNc_1860) in
                                                            {1753}event beginCli(Cli,Sess,gNc_1860);
                                                            {1754}out(c, (pkCli_1534,m1_1861,sign(m1_1861,skCli_1533)));
                                                            {1755}in(c, (PartS_1862: bitstring,sigPartS_1863: bitstring));
                                                            {1756}if (verify(PartS_1862,sigPartS_1863,pkSess_1855) <> true) then
                                                                0
                                                            else
                                                                {1757}event endCli(Sess,Cli,PartS_1862)
                                                )
                                                else
                                                    {1758}let pkSess_1864: bitstring = fail-any in
                                                    {1759}out(c, GetEndpointRequest);
                                                    {1760}in(c, (SPs_1865: bitstring,=Sign,UP_1866: bitstring,=pkSess_1864));
                                                    {1761}new SPc_1867: bitstring;
                                                    {1762}new Nc_1868: bitstring;
                                                    {1763}let gNc_1869: bitstring = exp(g,Nc_1868) in
                                                    {1764}let m1_1870: bitstring = (SPc_1867,gNc_1869) in
                                                    {1765}event beginCli(Cli,Sess,gNc_1869);
                                                    {1766}out(c, (pkCli_1534,m1_1870,sign(m1_1870,skCli_1533)));
                                                    {1767}in(c, (PartS_1871: bitstring,sigPartS_1872: bitstring));
                                                    {1768}if (verify(PartS_1871,sigPartS_1872,pkSess_1864) <> true) then
                                                        0
                                                    else
                                                        {1769}event endCli(Sess,Cli,PartS_1871)
                                    )
                                    else
                                        {1770}let pkDisco_1873: bitstring = fail-any in
                                        {1771}let v_1874: bool = (Sess = A) in
                                        (
                                            {1772}if v_1874 then
                                            (
                                                {1773}let pkSess_1875: bitstring = pub(skA) in
                                                {1774}out(c, GetEndpointRequest);
                                                {1775}in(c, (SPs_1876: bitstring,=Sign,UP_1877: bitstring,=pkSess_1875));
                                                {1776}new SPc_1878: bitstring;
                                                {1777}new Nc_1879: bitstring;
                                                {1778}let gNc_1880: bitstring = exp(g,Nc_1879) in
                                                {1779}let m1_1881: bitstring = (SPc_1878,gNc_1880) in
                                                {1780}event beginCli(Cli,Sess,gNc_1880);
                                                {1781}out(c, (pkCli_1534,m1_1881,sign(m1_1881,skCli_1533)));
                                                {1782}in(c, (PartS_1882: bitstring,sigPartS_1883: bitstring));
                                                {1783}if (verify(PartS_1882,sigPartS_1883,pkSess_1875) <> true) then
                                                    0
                                                else
                                                    {1784}event endCli(Sess,Cli,PartS_1882)
                                            )
                                            else
                                                {1785}let v_1884: bool = (Sess = B) in
                                                (
                                                    {1786}if v_1884 then
                                                    (
                                                        {1787}let pkSess_1885: bitstring = pub(skB) in
                                                        {1788}out(c, GetEndpointRequest);
                                                        {1789}in(c, (SPs_1886: bitstring,=Sign,UP_1887: bitstring,=pkSess_1885));
                                                        {1790}new SPc_1888: bitstring;
                                                        {1791}new Nc_1889: bitstring;
                                                        {1792}let gNc_1890: bitstring = exp(g,Nc_1889) in
                                                        {1793}let m1_1891: bitstring = (SPc_1888,gNc_1890) in
                                                        {1794}event beginCli(Cli,Sess,gNc_1890);
                                                        {1795}out(c, (pkCli_1534,m1_1891,sign(m1_1891,skCli_1533)));
                                                        {1796}in(c, (PartS_1892: bitstring,sigPartS_1893: bitstring));
                                                        {1797}if (verify(PartS_1892,sigPartS_1893,pkSess_1885) <> true) then
                                                            0
                                                        else
                                                            {1798}event endCli(Sess,Cli,PartS_1892)
                                                    )
                                                    else
                                                        {1799}let v_1894: bool = (Sess = C) in
                                                        (
                                                            {1800}if v_1894 then
                                                            (
                                                                {1801}let pkSess_1895: bitstring = pub(skC) in
                                                                {1802}out(c, GetEndpointRequest);
                                                                {1803}in(c, (SPs_1896: bitstring,=Sign,UP_1897: bitstring,=pkSess_1895));
                                                                {1804}new SPc_1898: bitstring;
                                                                {1805}new Nc_1899: bitstring;
                                                                {1806}let gNc_1900: bitstring = exp(g,Nc_1899) in
                                                                {1807}let m1_1901: bitstring = (SPc_1898,gNc_1900) in
                                                                {1808}event beginCli(Cli,Sess,gNc_1900);
                                                                {1809}out(c, (pkCli_1534,m1_1901,sign(m1_1901,skCli_1533)));
                                                                {1810}in(c, (PartS_1902: bitstring,sigPartS_1903: bitstring));
                                                                {1811}if (verify(PartS_1902,sigPartS_1903,pkSess_1895) <> true) then
                                                                    0
                                                                else
                                                                    {1812}event endCli(Sess,Cli,PartS_1902)
                                                            )
                                                            else
                                                                {1813}let pkSess_1904: bitstring = pub(skI) in
                                                                {1814}out(c, GetEndpointRequest);
                                                                {1815}in(c, (SPs_1905: bitstring,=Sign,UP_1906: bitstring,=pkSess_1904));
                                                                {1816}new SPc_1907: bitstring;
                                                                {1817}new Nc_1908: bitstring;
                                                                {1818}let gNc_1909: bitstring = exp(g,Nc_1908) in
                                                                {1819}let m1_1910: bitstring = (SPc_1907,gNc_1909) in
                                                                {1820}event beginCli(Cli,Sess,gNc_1909);
                                                                {1821}out(c, (pkCli_1534,m1_1910,sign(m1_1910,skCli_1533)));
                                                                {1822}in(c, (PartS_1911: bitstring,sigPartS_1912: bitstring));
                                                                {1823}if (verify(PartS_1911,sigPartS_1912,pkSess_1904) <> true) then
                                                                    0
                                                                else
                                                                    {1824}event endCli(Sess,Cli,PartS_1911)
                                                        )
                                                        else
                                                            {1825}let pkSess_1913: bitstring = fail-any in
                                                            {1826}out(c, GetEndpointRequest);
                                                            {1827}in(c, (SPs_1914: bitstring,=Sign,UP_1915: bitstring,=pkSess_1913));
                                                            {1828}new SPc_1916: bitstring;
                                                            {1829}new Nc_1917: bitstring;
                                                            {1830}let gNc_1918: bitstring = exp(g,Nc_1917) in
                                                            {1831}let m1_1919: bitstring = (SPc_1916,gNc_1918) in
                                                            {1832}event beginCli(Cli,Sess,gNc_1918);
                                                            {1833}out(c, (pkCli_1534,m1_1919,sign(m1_1919,skCli_1533)));
                                                            {1834}in(c, (PartS_1920: bitstring,sigPartS_1921: bitstring));
                                                            {1835}if (verify(PartS_1920,sigPartS_1921,pkSess_1913) <> true) then
                                                                0
                                                            else
                                                                {1836}event endCli(Sess,Cli,PartS_1920)
                                                )
                                                else
                                                    {1837}let pkSess_1922: bitstring = fail-any in
                                                    {1838}out(c, GetEndpointRequest);
                                                    {1839}in(c, (SPs_1923: bitstring,=Sign,UP_1924: bitstring,=pkSess_1922));
                                                    {1840}new SPc_1925: bitstring;
                                                    {1841}new Nc_1926: bitstring;
                                                    {1842}let gNc_1927: bitstring = exp(g,Nc_1926) in
                                                    {1843}let m1_1928: bitstring = (SPc_1925,gNc_1927) in
                                                    {1844}event beginCli(Cli,Sess,gNc_1927);
                                                    {1845}out(c, (pkCli_1534,m1_1928,sign(m1_1928,skCli_1533)));
                                                    {1846}in(c, (PartS_1929: bitstring,sigPartS_1930: bitstring));
                                                    {1847}if (verify(PartS_1929,sigPartS_1930,pkSess_1922) <> true) then
                                                        0
                                                    else
                                                        {1848}event endCli(Sess,Cli,PartS_1929)
                                        )
                                        else
                                            {1849}let pkSess_1931: bitstring = fail-any in
                                            {1850}out(c, GetEndpointRequest);
                                            {1851}in(c, (SPs_1932: bitstring,=Sign,UP_1933: bitstring,=pkSess_1931));
                                            {1852}new SPc_1934: bitstring;
                                            {1853}new Nc_1935: bitstring;
                                            {1854}let gNc_1936: bitstring = exp(g,Nc_1935) in
                                            {1855}let m1_1937: bitstring = (SPc_1934,gNc_1936) in
                                            {1856}event beginCli(Cli,Sess,gNc_1936);
                                            {1857}out(c, (pkCli_1534,m1_1937,sign(m1_1937,skCli_1533)));
                                            {1858}in(c, (PartS_1938: bitstring,sigPartS_1939: bitstring));
                                            {1859}if (verify(PartS_1938,sigPartS_1939,pkSess_1931) <> true) then
                                                0
                                            else
                                                {1860}event endCli(Sess,Cli,PartS_1938)
                            )
                            else
                                {1861}let pkDisco_1940: bitstring = fail-any in
                                {1862}let v_1941: bool = (Sess = A) in
                                (
                                    {1863}if v_1941 then
                                    (
                                        {1864}let pkSess_1942: bitstring = pub(skA) in
                                        {1865}out(c, GetEndpointRequest);
                                        {1866}in(c, (SPs_1943: bitstring,=Sign,UP_1944: bitstring,=pkSess_1942));
                                        {1867}new SPc_1945: bitstring;
                                        {1868}new Nc_1946: bitstring;
                                        {1869}let gNc_1947: bitstring = exp(g,Nc_1946) in
                                        {1870}let m1_1948: bitstring = (SPc_1945,gNc_1947) in
                                        {1871}event beginCli(Cli,Sess,gNc_1947);
                                        {1872}out(c, (pkCli_1534,m1_1948,sign(m1_1948,skCli_1533)));
                                        {1873}in(c, (PartS_1949: bitstring,sigPartS_1950: bitstring));
                                        {1874}if (verify(PartS_1949,sigPartS_1950,pkSess_1942) <> true) then
                                            0
                                        else
                                            {1875}event endCli(Sess,Cli,PartS_1949)
                                    )
                                    else
                                        {1876}let v_1951: bool = (Sess = B) in
                                        (
                                            {1877}if v_1951 then
                                            (
                                                {1878}let pkSess_1952: bitstring = pub(skB) in
                                                {1879}out(c, GetEndpointRequest);
                                                {1880}in(c, (SPs_1953: bitstring,=Sign,UP_1954: bitstring,=pkSess_1952));
                                                {1881}new SPc_1955: bitstring;
                                                {1882}new Nc_1956: bitstring;
                                                {1883}let gNc_1957: bitstring = exp(g,Nc_1956) in
                                                {1884}let m1_1958: bitstring = (SPc_1955,gNc_1957) in
                                                {1885}event beginCli(Cli,Sess,gNc_1957);
                                                {1886}out(c, (pkCli_1534,m1_1958,sign(m1_1958,skCli_1533)));
                                                {1887}in(c, (PartS_1959: bitstring,sigPartS_1960: bitstring));
                                                {1888}if (verify(PartS_1959,sigPartS_1960,pkSess_1952) <> true) then
                                                    0
                                                else
                                                    {1889}event endCli(Sess,Cli,PartS_1959)
                                            )
                                            else
                                                {1890}let v_1961: bool = (Sess = C) in
                                                (
                                                    {1891}if v_1961 then
                                                    (
                                                        {1892}let pkSess_1962: bitstring = pub(skC) in
                                                        {1893}out(c, GetEndpointRequest);
                                                        {1894}in(c, (SPs_1963: bitstring,=Sign,UP_1964: bitstring,=pkSess_1962));
                                                        {1895}new SPc_1965: bitstring;
                                                        {1896}new Nc_1966: bitstring;
                                                        {1897}let gNc_1967: bitstring = exp(g,Nc_1966) in
                                                        {1898}let m1_1968: bitstring = (SPc_1965,gNc_1967) in
                                                        {1899}event beginCli(Cli,Sess,gNc_1967);
                                                        {1900}out(c, (pkCli_1534,m1_1968,sign(m1_1968,skCli_1533)));
                                                        {1901}in(c, (PartS_1969: bitstring,sigPartS_1970: bitstring));
                                                        {1902}if (verify(PartS_1969,sigPartS_1970,pkSess_1962) <> true) then
                                                            0
                                                        else
                                                            {1903}event endCli(Sess,Cli,PartS_1969)
                                                    )
                                                    else
                                                        {1904}let pkSess_1971: bitstring = pub(skI) in
                                                        {1905}out(c, GetEndpointRequest);
                                                        {1906}in(c, (SPs_1972: bitstring,=Sign,UP_1973: bitstring,=pkSess_1971));
                                                        {1907}new SPc_1974: bitstring;
                                                        {1908}new Nc_1975: bitstring;
                                                        {1909}let gNc_1976: bitstring = exp(g,Nc_1975) in
                                                        {1910}let m1_1977: bitstring = (SPc_1974,gNc_1976) in
                                                        {1911}event beginCli(Cli,Sess,gNc_1976);
                                                        {1912}out(c, (pkCli_1534,m1_1977,sign(m1_1977,skCli_1533)));
                                                        {1913}in(c, (PartS_1978: bitstring,sigPartS_1979: bitstring));
                                                        {1914}if (verify(PartS_1978,sigPartS_1979,pkSess_1971) <> true) then
                                                            0
                                                        else
                                                            {1915}event endCli(Sess,Cli,PartS_1978)
                                                )
                                                else
                                                    {1916}let pkSess_1980: bitstring = fail-any in
                                                    {1917}out(c, GetEndpointRequest);
                                                    {1918}in(c, (SPs_1981: bitstring,=Sign,UP_1982: bitstring,=pkSess_1980));
                                                    {1919}new SPc_1983: bitstring;
                                                    {1920}new Nc_1984: bitstring;
                                                    {1921}let gNc_1985: bitstring = exp(g,Nc_1984) in
                                                    {1922}let m1_1986: bitstring = (SPc_1983,gNc_1985) in
                                                    {1923}event beginCli(Cli,Sess,gNc_1985);
                                                    {1924}out(c, (pkCli_1534,m1_1986,sign(m1_1986,skCli_1533)));
                                                    {1925}in(c, (PartS_1987: bitstring,sigPartS_1988: bitstring));
                                                    {1926}if (verify(PartS_1987,sigPartS_1988,pkSess_1980) <> true) then
                                                        0
                                                    else
                                                        {1927}event endCli(Sess,Cli,PartS_1987)
                                        )
                                        else
                                            {1928}let pkSess_1989: bitstring = fail-any in
                                            {1929}out(c, GetEndpointRequest);
                                            {1930}in(c, (SPs_1990: bitstring,=Sign,UP_1991: bitstring,=pkSess_1989));
                                            {1931}new SPc_1992: bitstring;
                                            {1932}new Nc_1993: bitstring;
                                            {1933}let gNc_1994: bitstring = exp(g,Nc_1993) in
                                            {1934}let m1_1995: bitstring = (SPc_1992,gNc_1994) in
                                            {1935}event beginCli(Cli,Sess,gNc_1994);
                                            {1936}out(c, (pkCli_1534,m1_1995,sign(m1_1995,skCli_1533)));
                                            {1937}in(c, (PartS_1996: bitstring,sigPartS_1997: bitstring));
                                            {1938}if (verify(PartS_1996,sigPartS_1997,pkSess_1989) <> true) then
                                                0
                                            else
                                                {1939}event endCli(Sess,Cli,PartS_1996)
                                )
                                else
                                    {1940}let pkSess_1998: bitstring = fail-any in
                                    {1941}out(c, GetEndpointRequest);
                                    {1942}in(c, (SPs_1999: bitstring,=Sign,UP_2000: bitstring,=pkSess_1998));
                                    {1943}new SPc_2001: bitstring;
                                    {1944}new Nc_2002: bitstring;
                                    {1945}let gNc_2003: bitstring = exp(g,Nc_2002) in
                                    {1946}let m1_2004: bitstring = (SPc_2001,gNc_2003) in
                                    {1947}event beginCli(Cli,Sess,gNc_2003);
                                    {1948}out(c, (pkCli_1534,m1_2004,sign(m1_2004,skCli_1533)));
                                    {1949}in(c, (PartS_2005: bitstring,sigPartS_2006: bitstring));
                                    {1950}if (verify(PartS_2005,sigPartS_2006,pkSess_1998) <> true) then
                                        0
                                    else
                                        {1951}event endCli(Sess,Cli,PartS_2005)
                        )
                        else
                            {1952}let skCli_2007: bitstring = skI in
                            {1953}let pkCli_2008: bitstring = pub(skCli_2007) in
                            {1954}let v_2009: bool = (Disco = A) in
                            (
                                {1955}if v_2009 then
                                (
                                    {1956}let pkDisco_2010: bitstring = pub(skA) in
                                    {1957}let v_2011: bool = (Sess = A) in
                                    (
                                        {1958}if v_2011 then
                                        (
                                            {1959}let pkSess_2012: bitstring = pub(skA) in
                                            {1960}out(c, GetEndpointRequest);
                                            {1961}in(c, (SPs_2013: bitstring,=Sign,UP_2014: bitstring,=pkSess_2012));
                                            {1962}new SPc_2015: bitstring;
                                            {1963}new Nc_2016: bitstring;
                                            {1964}let gNc_2017: bitstring = exp(g,Nc_2016) in
                                            {1965}let m1_2018: bitstring = (SPc_2015,gNc_2017) in
                                            {1966}event beginCli(Cli,Sess,gNc_2017);
                                            {1967}out(c, (pkCli_2008,m1_2018,sign(m1_2018,skCli_2007)));
                                            {1968}in(c, (PartS_2019: bitstring,sigPartS_2020: bitstring));
                                            {1969}if (verify(PartS_2019,sigPartS_2020,pkSess_2012) <> true) then
                                                0
                                            else
                                                {1970}event endCli(Sess,Cli,PartS_2019)
                                        )
                                        else
                                            {1971}let v_2021: bool = (Sess = B) in
                                            (
                                                {1972}if v_2021 then
                                                (
                                                    {1973}let pkSess_2022: bitstring = pub(skB) in
                                                    {1974}out(c, GetEndpointRequest);
                                                    {1975}in(c, (SPs_2023: bitstring,=Sign,UP_2024: bitstring,=pkSess_2022));
                                                    {1976}new SPc_2025: bitstring;
                                                    {1977}new Nc_2026: bitstring;
                                                    {1978}let gNc_2027: bitstring = exp(g,Nc_2026) in
                                                    {1979}let m1_2028: bitstring = (SPc_2025,gNc_2027) in
                                                    {1980}event beginCli(Cli,Sess,gNc_2027);
                                                    {1981}out(c, (pkCli_2008,m1_2028,sign(m1_2028,skCli_2007)));
                                                    {1982}in(c, (PartS_2029: bitstring,sigPartS_2030: bitstring));
                                                    {1983}if (verify(PartS_2029,sigPartS_2030,pkSess_2022) <> true) then
                                                        0
                                                    else
                                                        {1984}event endCli(Sess,Cli,PartS_2029)
                                                )
                                                else
                                                    {1985}let v_2031: bool = (Sess = C) in
                                                    (
                                                        {1986}if v_2031 then
                                                        (
                                                            {1987}let pkSess_2032: bitstring = pub(skC) in
                                                            {1988}out(c, GetEndpointRequest);
                                                            {1989}in(c, (SPs_2033: bitstring,=Sign,UP_2034: bitstring,=pkSess_2032));
                                                            {1990}new SPc_2035: bitstring;
                                                            {1991}new Nc_2036: bitstring;
                                                            {1992}let gNc_2037: bitstring = exp(g,Nc_2036) in
                                                            {1993}let m1_2038: bitstring = (SPc_2035,gNc_2037) in
                                                            {1994}event beginCli(Cli,Sess,gNc_2037);
                                                            {1995}out(c, (pkCli_2008,m1_2038,sign(m1_2038,skCli_2007)));
                                                            {1996}in(c, (PartS_2039: bitstring,sigPartS_2040: bitstring));
                                                            {1997}if (verify(PartS_2039,sigPartS_2040,pkSess_2032) <> true) then
                                                                0
                                                            else
                                                                {1998}event endCli(Sess,Cli,PartS_2039)
                                                        )
                                                        else
                                                            {1999}let pkSess_2041: bitstring = pub(skI) in
                                                            {2000}out(c, GetEndpointRequest);
                                                            {2001}in(c, (SPs_2042: bitstring,=Sign,UP_2043: bitstring,=pkSess_2041));
                                                            {2002}new SPc_2044: bitstring;
                                                            {2003}new Nc_2045: bitstring;
                                                            {2004}let gNc_2046: bitstring = exp(g,Nc_2045) in
                                                            {2005}let m1_2047: bitstring = (SPc_2044,gNc_2046) in
                                                            {2006}event beginCli(Cli,Sess,gNc_2046);
                                                            {2007}out(c, (pkCli_2008,m1_2047,sign(m1_2047,skCli_2007)));
                                                            {2008}in(c, (PartS_2048: bitstring,sigPartS_2049: bitstring));
                                                            {2009}if (verify(PartS_2048,sigPartS_2049,pkSess_2041) <> true) then
                                                                0
                                                            else
                                                                {2010}event endCli(Sess,Cli,PartS_2048)
                                                    )
                                                    else
                                                        {2011}let pkSess_2050: bitstring = fail-any in
                                                        {2012}out(c, GetEndpointRequest);
                                                        {2013}in(c, (SPs_2051: bitstring,=Sign,UP_2052: bitstring,=pkSess_2050));
                                                        {2014}new SPc_2053: bitstring;
                                                        {2015}new Nc_2054: bitstring;
                                                        {2016}let gNc_2055: bitstring = exp(g,Nc_2054) in
                                                        {2017}let m1_2056: bitstring = (SPc_2053,gNc_2055) in
                                                        {2018}event beginCli(Cli,Sess,gNc_2055);
                                                        {2019}out(c, (pkCli_2008,m1_2056,sign(m1_2056,skCli_2007)));
                                                        {2020}in(c, (PartS_2057: bitstring,sigPartS_2058: bitstring));
                                                        {2021}if (verify(PartS_2057,sigPartS_2058,pkSess_2050) <> true) then
                                                            0
                                                        else
                                                            {2022}event endCli(Sess,Cli,PartS_2057)
                                            )
                                            else
                                                {2023}let pkSess_2059: bitstring = fail-any in
                                                {2024}out(c, GetEndpointRequest);
                                                {2025}in(c, (SPs_2060: bitstring,=Sign,UP_2061: bitstring,=pkSess_2059));
                                                {2026}new SPc_2062: bitstring;
                                                {2027}new Nc_2063: bitstring;
                                                {2028}let gNc_2064: bitstring = exp(g,Nc_2063) in
                                                {2029}let m1_2065: bitstring = (SPc_2062,gNc_2064) in
                                                {2030}event beginCli(Cli,Sess,gNc_2064);
                                                {2031}out(c, (pkCli_2008,m1_2065,sign(m1_2065,skCli_2007)));
                                                {2032}in(c, (PartS_2066: bitstring,sigPartS_2067: bitstring));
                                                {2033}if (verify(PartS_2066,sigPartS_2067,pkSess_2059) <> true) then
                                                    0
                                                else
                                                    {2034}event endCli(Sess,Cli,PartS_2066)
                                    )
                                    else
                                        {2035}let pkSess_2068: bitstring = fail-any in
                                        {2036}out(c, GetEndpointRequest);
                                        {2037}in(c, (SPs_2069: bitstring,=Sign,UP_2070: bitstring,=pkSess_2068));
                                        {2038}new SPc_2071: bitstring;
                                        {2039}new Nc_2072: bitstring;
                                        {2040}let gNc_2073: bitstring = exp(g,Nc_2072) in
                                        {2041}let m1_2074: bitstring = (SPc_2071,gNc_2073) in
                                        {2042}event beginCli(Cli,Sess,gNc_2073);
                                        {2043}out(c, (pkCli_2008,m1_2074,sign(m1_2074,skCli_2007)));
                                        {2044}in(c, (PartS_2075: bitstring,sigPartS_2076: bitstring));
                                        {2045}if (verify(PartS_2075,sigPartS_2076,pkSess_2068) <> true) then
                                            0
                                        else
                                            {2046}event endCli(Sess,Cli,PartS_2075)
                                )
                                else
                                    {2047}let v_2077: bool = (Disco = B) in
                                    (
                                        {2048}if v_2077 then
                                        (
                                            {2049}let pkDisco_2078: bitstring = pub(skB) in
                                            {2050}let v_2079: bool = (Sess = A) in
                                            (
                                                {2051}if v_2079 then
                                                (
                                                    {2052}let pkSess_2080: bitstring = pub(skA) in
                                                    {2053}out(c, GetEndpointRequest);
                                                    {2054}in(c, (SPs_2081: bitstring,=Sign,UP_2082: bitstring,=pkSess_2080));
                                                    {2055}new SPc_2083: bitstring;
                                                    {2056}new Nc_2084: bitstring;
                                                    {2057}let gNc_2085: bitstring = exp(g,Nc_2084) in
                                                    {2058}let m1_2086: bitstring = (SPc_2083,gNc_2085) in
                                                    {2059}event beginCli(Cli,Sess,gNc_2085);
                                                    {2060}out(c, (pkCli_2008,m1_2086,sign(m1_2086,skCli_2007)));
                                                    {2061}in(c, (PartS_2087: bitstring,sigPartS_2088: bitstring));
                                                    {2062}if (verify(PartS_2087,sigPartS_2088,pkSess_2080) <> true) then
                                                        0
                                                    else
                                                        {2063}event endCli(Sess,Cli,PartS_2087)
                                                )
                                                else
                                                    {2064}let v_2089: bool = (Sess = B) in
                                                    (
                                                        {2065}if v_2089 then
                                                        (
                                                            {2066}let pkSess_2090: bitstring = pub(skB) in
                                                            {2067}out(c, GetEndpointRequest);
                                                            {2068}in(c, (SPs_2091: bitstring,=Sign,UP_2092: bitstring,=pkSess_2090));
                                                            {2069}new SPc_2093: bitstring;
                                                            {2070}new Nc_2094: bitstring;
                                                            {2071}let gNc_2095: bitstring = exp(g,Nc_2094) in
                                                            {2072}let m1_2096: bitstring = (SPc_2093,gNc_2095) in
                                                            {2073}event beginCli(Cli,Sess,gNc_2095);
                                                            {2074}out(c, (pkCli_2008,m1_2096,sign(m1_2096,skCli_2007)));
                                                            {2075}in(c, (PartS_2097: bitstring,sigPartS_2098: bitstring));
                                                            {2076}if (verify(PartS_2097,sigPartS_2098,pkSess_2090) <> true) then
                                                                0
                                                            else
                                                                {2077}event endCli(Sess,Cli,PartS_2097)
                                                        )
                                                        else
                                                            {2078}let v_2099: bool = (Sess = C) in
                                                            (
                                                                {2079}if v_2099 then
                                                                (
                                                                    {2080}let pkSess_2100: bitstring = pub(skC) in
                                                                    {2081}out(c, GetEndpointRequest);
                                                                    {2082}in(c, (SPs_2101: bitstring,=Sign,UP_2102: bitstring,=pkSess_2100));
                                                                    {2083}new SPc_2103: bitstring;
                                                                    {2084}new Nc_2104: bitstring;
                                                                    {2085}let gNc_2105: bitstring = exp(g,Nc_2104) in
                                                                    {2086}let m1_2106: bitstring = (SPc_2103,gNc_2105) in
                                                                    {2087}event beginCli(Cli,Sess,gNc_2105);
                                                                    {2088}out(c, (pkCli_2008,m1_2106,sign(m1_2106,skCli_2007)));
                                                                    {2089}in(c, (PartS_2107: bitstring,sigPartS_2108: bitstring));
                                                                    {2090}if (verify(PartS_2107,sigPartS_2108,pkSess_2100) <> true) then
                                                                        0
                                                                    else
                                                                        {2091}event endCli(Sess,Cli,PartS_2107)
                                                                )
                                                                else
                                                                    {2092}let pkSess_2109: bitstring = pub(skI) in
                                                                    {2093}out(c, GetEndpointRequest);
                                                                    {2094}in(c, (SPs_2110: bitstring,=Sign,UP_2111: bitstring,=pkSess_2109));
                                                                    {2095}new SPc_2112: bitstring;
                                                                    {2096}new Nc_2113: bitstring;
                                                                    {2097}let gNc_2114: bitstring = exp(g,Nc_2113) in
                                                                    {2098}let m1_2115: bitstring = (SPc_2112,gNc_2114) in
                                                                    {2099}event beginCli(Cli,Sess,gNc_2114);
                                                                    {2100}out(c, (pkCli_2008,m1_2115,sign(m1_2115,skCli_2007)));
                                                                    {2101}in(c, (PartS_2116: bitstring,sigPartS_2117: bitstring));
                                                                    {2102}if (verify(PartS_2116,sigPartS_2117,pkSess_2109) <> true) then
                                                                        0
                                                                    else
                                                                        {2103}event endCli(Sess,Cli,PartS_2116)
                                                            )
                                                            else
                                                                {2104}let pkSess_2118: bitstring = fail-any in
                                                                {2105}out(c, GetEndpointRequest);
                                                                {2106}in(c, (SPs_2119: bitstring,=Sign,UP_2120: bitstring,=pkSess_2118));
                                                                {2107}new SPc_2121: bitstring;
                                                                {2108}new Nc_2122: bitstring;
                                                                {2109}let gNc_2123: bitstring = exp(g,Nc_2122) in
                                                                {2110}let m1_2124: bitstring = (SPc_2121,gNc_2123) in
                                                                {2111}event beginCli(Cli,Sess,gNc_2123);
                                                                {2112}out(c, (pkCli_2008,m1_2124,sign(m1_2124,skCli_2007)));
                                                                {2113}in(c, (PartS_2125: bitstring,sigPartS_2126: bitstring));
                                                                {2114}if (verify(PartS_2125,sigPartS_2126,pkSess_2118) <> true) then
                                                                    0
                                                                else
                                                                    {2115}event endCli(Sess,Cli,PartS_2125)
                                                    )
                                                    else
                                                        {2116}let pkSess_2127: bitstring = fail-any in
                                                        {2117}out(c, GetEndpointRequest);
                                                        {2118}in(c, (SPs_2128: bitstring,=Sign,UP_2129: bitstring,=pkSess_2127));
                                                        {2119}new SPc_2130: bitstring;
                                                        {2120}new Nc_2131: bitstring;
                                                        {2121}let gNc_2132: bitstring = exp(g,Nc_2131) in
                                                        {2122}let m1_2133: bitstring = (SPc_2130,gNc_2132) in
                                                        {2123}event beginCli(Cli,Sess,gNc_2132);
                                                        {2124}out(c, (pkCli_2008,m1_2133,sign(m1_2133,skCli_2007)));
                                                        {2125}in(c, (PartS_2134: bitstring,sigPartS_2135: bitstring));
                                                        {2126}if (verify(PartS_2134,sigPartS_2135,pkSess_2127) <> true) then
                                                            0
                                                        else
                                                            {2127}event endCli(Sess,Cli,PartS_2134)
                                            )
                                            else
                                                {2128}let pkSess_2136: bitstring = fail-any in
                                                {2129}out(c, GetEndpointRequest);
                                                {2130}in(c, (SPs_2137: bitstring,=Sign,UP_2138: bitstring,=pkSess_2136));
                                                {2131}new SPc_2139: bitstring;
                                                {2132}new Nc_2140: bitstring;
                                                {2133}let gNc_2141: bitstring = exp(g,Nc_2140) in
                                                {2134}let m1_2142: bitstring = (SPc_2139,gNc_2141) in
                                                {2135}event beginCli(Cli,Sess,gNc_2141);
                                                {2136}out(c, (pkCli_2008,m1_2142,sign(m1_2142,skCli_2007)));
                                                {2137}in(c, (PartS_2143: bitstring,sigPartS_2144: bitstring));
                                                {2138}if (verify(PartS_2143,sigPartS_2144,pkSess_2136) <> true) then
                                                    0
                                                else
                                                    {2139}event endCli(Sess,Cli,PartS_2143)
                                        )
                                        else
                                            {2140}let v_2145: bool = (Disco = C) in
                                            (
                                                {2141}if v_2145 then
                                                (
                                                    {2142}let pkDisco_2146: bitstring = pub(skC) in
                                                    {2143}let v_2147: bool = (Sess = A) in
                                                    (
                                                        {2144}if v_2147 then
                                                        (
                                                            {2145}let pkSess_2148: bitstring = pub(skA) in
                                                            {2146}out(c, GetEndpointRequest);
                                                            {2147}in(c, (SPs_2149: bitstring,=Sign,UP_2150: bitstring,=pkSess_2148));
                                                            {2148}new SPc_2151: bitstring;
                                                            {2149}new Nc_2152: bitstring;
                                                            {2150}let gNc_2153: bitstring = exp(g,Nc_2152) in
                                                            {2151}let m1_2154: bitstring = (SPc_2151,gNc_2153) in
                                                            {2152}event beginCli(Cli,Sess,gNc_2153);
                                                            {2153}out(c, (pkCli_2008,m1_2154,sign(m1_2154,skCli_2007)));
                                                            {2154}in(c, (PartS_2155: bitstring,sigPartS_2156: bitstring));
                                                            {2155}if (verify(PartS_2155,sigPartS_2156,pkSess_2148) <> true) then
                                                                0
                                                            else
                                                                {2156}event endCli(Sess,Cli,PartS_2155)
                                                        )
                                                        else
                                                            {2157}let v_2157: bool = (Sess = B) in
                                                            (
                                                                {2158}if v_2157 then
                                                                (
                                                                    {2159}let pkSess_2158: bitstring = pub(skB) in
                                                                    {2160}out(c, GetEndpointRequest);
                                                                    {2161}in(c, (SPs_2159: bitstring,=Sign,UP_2160: bitstring,=pkSess_2158));
                                                                    {2162}new SPc_2161: bitstring;
                                                                    {2163}new Nc_2162: bitstring;
                                                                    {2164}let gNc_2163: bitstring = exp(g,Nc_2162) in
                                                                    {2165}let m1_2164: bitstring = (SPc_2161,gNc_2163) in
                                                                    {2166}event beginCli(Cli,Sess,gNc_2163);
                                                                    {2167}out(c, (pkCli_2008,m1_2164,sign(m1_2164,skCli_2007)));
                                                                    {2168}in(c, (PartS_2165: bitstring,sigPartS_2166: bitstring));
                                                                    {2169}if (verify(PartS_2165,sigPartS_2166,pkSess_2158) <> true) then
                                                                        0
                                                                    else
                                                                        {2170}event endCli(Sess,Cli,PartS_2165)
                                                                )
                                                                else
                                                                    {2171}let v_2167: bool = (Sess = C) in
                                                                    (
                                                                        {2172}if v_2167 then
                                                                        (
                                                                            {2173}let pkSess_2168: bitstring = pub(skC) in
                                                                            {2174}out(c, GetEndpointRequest);
                                                                            {2175}in(c, (SPs_2169: bitstring,=Sign,UP_2170: bitstring,=pkSess_2168));
                                                                            {2176}new SPc_2171: bitstring;
                                                                            {2177}new Nc_2172: bitstring;
                                                                            {2178}let gNc_2173: bitstring = exp(g,Nc_2172) in
                                                                            {2179}let m1_2174: bitstring = (SPc_2171,gNc_2173) in
                                                                            {2180}event beginCli(Cli,Sess,gNc_2173);
                                                                            {2181}out(c, (pkCli_2008,m1_2174,sign(m1_2174,skCli_2007)));
                                                                            {2182}in(c, (PartS_2175: bitstring,sigPartS_2176: bitstring));
                                                                            {2183}if (verify(PartS_2175,sigPartS_2176,pkSess_2168) <> true) then
                                                                                0
                                                                            else
                                                                                {2184}event endCli(Sess,Cli,PartS_2175)
                                                                        )
                                                                        else
                                                                            {2185}let pkSess_2177: bitstring = pub(skI) in
                                                                            {2186}out(c, GetEndpointRequest);
                                                                            {2187}in(c, (SPs_2178: bitstring,=Sign,UP_2179: bitstring,=pkSess_2177));
                                                                            {2188}new SPc_2180: bitstring;
                                                                            {2189}new Nc_2181: bitstring;
                                                                            {2190}let gNc_2182: bitstring = exp(g,Nc_2181) in
                                                                            {2191}let m1_2183: bitstring = (SPc_2180,gNc_2182) in
                                                                            {2192}event beginCli(Cli,Sess,gNc_2182);
                                                                            {2193}out(c, (pkCli_2008,m1_2183,sign(m1_2183,skCli_2007)));
                                                                            {2194}in(c, (PartS_2184: bitstring,sigPartS_2185: bitstring));
                                                                            {2195}if (verify(PartS_2184,sigPartS_2185,pkSess_2177) <> true) then
                                                                                0
                                                                            else
                                                                                {2196}event endCli(Sess,Cli,PartS_2184)
                                                                    )
                                                                    else
                                                                        {2197}let pkSess_2186: bitstring = fail-any in
                                                                        {2198}out(c, GetEndpointRequest);
                                                                        {2199}in(c, (SPs_2187: bitstring,=Sign,UP_2188: bitstring,=pkSess_2186));
                                                                        {2200}new SPc_2189: bitstring;
                                                                        {2201}new Nc_2190: bitstring;
                                                                        {2202}let gNc_2191: bitstring = exp(g,Nc_2190) in
                                                                        {2203}let m1_2192: bitstring = (SPc_2189,gNc_2191) in
                                                                        {2204}event beginCli(Cli,Sess,gNc_2191);
                                                                        {2205}out(c, (pkCli_2008,m1_2192,sign(m1_2192,skCli_2007)));
                                                                        {2206}in(c, (PartS_2193: bitstring,sigPartS_2194: bitstring));
                                                                        {2207}if (verify(PartS_2193,sigPartS_2194,pkSess_2186) <> true) then
                                                                            0
                                                                        else
                                                                            {2208}event endCli(Sess,Cli,PartS_2193)
                                                            )
                                                            else
                                                                {2209}let pkSess_2195: bitstring = fail-any in
                                                                {2210}out(c, GetEndpointRequest);
                                                                {2211}in(c, (SPs_2196: bitstring,=Sign,UP_2197: bitstring,=pkSess_2195));
                                                                {2212}new SPc_2198: bitstring;
                                                                {2213}new Nc_2199: bitstring;
                                                                {2214}let gNc_2200: bitstring = exp(g,Nc_2199) in
                                                                {2215}let m1_2201: bitstring = (SPc_2198,gNc_2200) in
                                                                {2216}event beginCli(Cli,Sess,gNc_2200);
                                                                {2217}out(c, (pkCli_2008,m1_2201,sign(m1_2201,skCli_2007)));
                                                                {2218}in(c, (PartS_2202: bitstring,sigPartS_2203: bitstring));
                                                                {2219}if (verify(PartS_2202,sigPartS_2203,pkSess_2195) <> true) then
                                                                    0
                                                                else
                                                                    {2220}event endCli(Sess,Cli,PartS_2202)
                                                    )
                                                    else
                                                        {2221}let pkSess_2204: bitstring = fail-any in
                                                        {2222}out(c, GetEndpointRequest);
                                                        {2223}in(c, (SPs_2205: bitstring,=Sign,UP_2206: bitstring,=pkSess_2204));
                                                        {2224}new SPc_2207: bitstring;
                                                        {2225}new Nc_2208: bitstring;
                                                        {2226}let gNc_2209: bitstring = exp(g,Nc_2208) in
                                                        {2227}let m1_2210: bitstring = (SPc_2207,gNc_2209) in
                                                        {2228}event beginCli(Cli,Sess,gNc_2209);
                                                        {2229}out(c, (pkCli_2008,m1_2210,sign(m1_2210,skCli_2007)));
                                                        {2230}in(c, (PartS_2211: bitstring,sigPartS_2212: bitstring));
                                                        {2231}if (verify(PartS_2211,sigPartS_2212,pkSess_2204) <> true) then
                                                            0
                                                        else
                                                            {2232}event endCli(Sess,Cli,PartS_2211)
                                                )
                                                else
                                                    {2233}let pkDisco_2213: bitstring = pub(skI) in
                                                    {2234}let v_2214: bool = (Sess = A) in
                                                    (
                                                        {2235}if v_2214 then
                                                        (
                                                            {2236}let pkSess_2215: bitstring = pub(skA) in
                                                            {2237}out(c, GetEndpointRequest);
                                                            {2238}in(c, (SPs_2216: bitstring,=Sign,UP_2217: bitstring,=pkSess_2215));
                                                            {2239}new SPc_2218: bitstring;
                                                            {2240}new Nc_2219: bitstring;
                                                            {2241}let gNc_2220: bitstring = exp(g,Nc_2219) in
                                                            {2242}let m1_2221: bitstring = (SPc_2218,gNc_2220) in
                                                            {2243}event beginCli(Cli,Sess,gNc_2220);
                                                            {2244}out(c, (pkCli_2008,m1_2221,sign(m1_2221,skCli_2007)));
                                                            {2245}in(c, (PartS_2222: bitstring,sigPartS_2223: bitstring));
                                                            {2246}if (verify(PartS_2222,sigPartS_2223,pkSess_2215) <> true) then
                                                                0
                                                            else
                                                                {2247}event endCli(Sess,Cli,PartS_2222)
                                                        )
                                                        else
                                                            {2248}let v_2224: bool = (Sess = B) in
                                                            (
                                                                {2249}if v_2224 then
                                                                (
                                                                    {2250}let pkSess_2225: bitstring = pub(skB) in
                                                                    {2251}out(c, GetEndpointRequest);
                                                                    {2252}in(c, (SPs_2226: bitstring,=Sign,UP_2227: bitstring,=pkSess_2225));
                                                                    {2253}new SPc_2228: bitstring;
                                                                    {2254}new Nc_2229: bitstring;
                                                                    {2255}let gNc_2230: bitstring = exp(g,Nc_2229) in
                                                                    {2256}let m1_2231: bitstring = (SPc_2228,gNc_2230) in
                                                                    {2257}event beginCli(Cli,Sess,gNc_2230);
                                                                    {2258}out(c, (pkCli_2008,m1_2231,sign(m1_2231,skCli_2007)));
                                                                    {2259}in(c, (PartS_2232: bitstring,sigPartS_2233: bitstring));
                                                                    {2260}if (verify(PartS_2232,sigPartS_2233,pkSess_2225) <> true) then
                                                                        0
                                                                    else
                                                                        {2261}event endCli(Sess,Cli,PartS_2232)
                                                                )
                                                                else
                                                                    {2262}let v_2234: bool = (Sess = C) in
                                                                    (
                                                                        {2263}if v_2234 then
                                                                        (
                                                                            {2264}let pkSess_2235: bitstring = pub(skC) in
                                                                            {2265}out(c, GetEndpointRequest);
                                                                            {2266}in(c, (SPs_2236: bitstring,=Sign,UP_2237: bitstring,=pkSess_2235));
                                                                            {2267}new SPc_2238: bitstring;
                                                                            {2268}new Nc_2239: bitstring;
                                                                            {2269}let gNc_2240: bitstring = exp(g,Nc_2239) in
                                                                            {2270}let m1_2241: bitstring = (SPc_2238,gNc_2240) in
                                                                            {2271}event beginCli(Cli,Sess,gNc_2240);
                                                                            {2272}out(c, (pkCli_2008,m1_2241,sign(m1_2241,skCli_2007)));
                                                                            {2273}in(c, (PartS_2242: bitstring,sigPartS_2243: bitstring));
                                                                            {2274}if (verify(PartS_2242,sigPartS_2243,pkSess_2235) <> true) then
                                                                                0
                                                                            else
                                                                                {2275}event endCli(Sess,Cli,PartS_2242)
                                                                        )
                                                                        else
                                                                            {2276}let pkSess_2244: bitstring = pub(skI) in
                                                                            {2277}out(c, GetEndpointRequest);
                                                                            {2278}in(c, (SPs_2245: bitstring,=Sign,UP_2246: bitstring,=pkSess_2244));
                                                                            {2279}new SPc_2247: bitstring;
                                                                            {2280}new Nc_2248: bitstring;
                                                                            {2281}let gNc_2249: bitstring = exp(g,Nc_2248) in
                                                                            {2282}let m1_2250: bitstring = (SPc_2247,gNc_2249) in
                                                                            {2283}event beginCli(Cli,Sess,gNc_2249);
                                                                            {2284}out(c, (pkCli_2008,m1_2250,sign(m1_2250,skCli_2007)));
                                                                            {2285}in(c, (PartS_2251: bitstring,sigPartS_2252: bitstring));
                                                                            {2286}if (verify(PartS_2251,sigPartS_2252,pkSess_2244) <> true) then
                                                                                0
                                                                            else
                                                                                {2287}event endCli(Sess,Cli,PartS_2251)
                                                                    )
                                                                    else
                                                                        {2288}let pkSess_2253: bitstring = fail-any in
                                                                        {2289}out(c, GetEndpointRequest);
                                                                        {2290}in(c, (SPs_2254: bitstring,=Sign,UP_2255: bitstring,=pkSess_2253));
                                                                        {2291}new SPc_2256: bitstring;
                                                                        {2292}new Nc_2257: bitstring;
                                                                        {2293}let gNc_2258: bitstring = exp(g,Nc_2257) in
                                                                        {2294}let m1_2259: bitstring = (SPc_2256,gNc_2258) in
                                                                        {2295}event beginCli(Cli,Sess,gNc_2258);
                                                                        {2296}out(c, (pkCli_2008,m1_2259,sign(m1_2259,skCli_2007)));
                                                                        {2297}in(c, (PartS_2260: bitstring,sigPartS_2261: bitstring));
                                                                        {2298}if (verify(PartS_2260,sigPartS_2261,pkSess_2253) <> true) then
                                                                            0
                                                                        else
                                                                            {2299}event endCli(Sess,Cli,PartS_2260)
                                                            )
                                                            else
                                                                {2300}let pkSess_2262: bitstring = fail-any in
                                                                {2301}out(c, GetEndpointRequest);
                                                                {2302}in(c, (SPs_2263: bitstring,=Sign,UP_2264: bitstring,=pkSess_2262));
                                                                {2303}new SPc_2265: bitstring;
                                                                {2304}new Nc_2266: bitstring;
                                                                {2305}let gNc_2267: bitstring = exp(g,Nc_2266) in
                                                                {2306}let m1_2268: bitstring = (SPc_2265,gNc_2267) in
                                                                {2307}event beginCli(Cli,Sess,gNc_2267);
                                                                {2308}out(c, (pkCli_2008,m1_2268,sign(m1_2268,skCli_2007)));
                                                                {2309}in(c, (PartS_2269: bitstring,sigPartS_2270: bitstring));
                                                                {2310}if (verify(PartS_2269,sigPartS_2270,pkSess_2262) <> true) then
                                                                    0
                                                                else
                                                                    {2311}event endCli(Sess,Cli,PartS_2269)
                                                    )
                                                    else
                                                        {2312}let pkSess_2271: bitstring = fail-any in
                                                        {2313}out(c, GetEndpointRequest);
                                                        {2314}in(c, (SPs_2272: bitstring,=Sign,UP_2273: bitstring,=pkSess_2271));
                                                        {2315}new SPc_2274: bitstring;
                                                        {2316}new Nc_2275: bitstring;
                                                        {2317}let gNc_2276: bitstring = exp(g,Nc_2275) in
                                                        {2318}let m1_2277: bitstring = (SPc_2274,gNc_2276) in
                                                        {2319}event beginCli(Cli,Sess,gNc_2276);
                                                        {2320}out(c, (pkCli_2008,m1_2277,sign(m1_2277,skCli_2007)));
                                                        {2321}in(c, (PartS_2278: bitstring,sigPartS_2279: bitstring));
                                                        {2322}if (verify(PartS_2278,sigPartS_2279,pkSess_2271) <> true) then
                                                            0
                                                        else
                                                            {2323}event endCli(Sess,Cli,PartS_2278)
                                            )
                                            else
                                                {2324}let pkDisco_2280: bitstring = fail-any in
                                                {2325}let v_2281: bool = (Sess = A) in
                                                (
                                                    {2326}if v_2281 then
                                                    (
                                                        {2327}let pkSess_2282: bitstring = pub(skA) in
                                                        {2328}out(c, GetEndpointRequest);
                                                        {2329}in(c, (SPs_2283: bitstring,=Sign,UP_2284: bitstring,=pkSess_2282));
                                                        {2330}new SPc_2285: bitstring;
                                                        {2331}new Nc_2286: bitstring;
                                                        {2332}let gNc_2287: bitstring = exp(g,Nc_2286) in
                                                        {2333}let m1_2288: bitstring = (SPc_2285,gNc_2287) in
                                                        {2334}event beginCli(Cli,Sess,gNc_2287);
                                                        {2335}out(c, (pkCli_2008,m1_2288,sign(m1_2288,skCli_2007)));
                                                        {2336}in(c, (PartS_2289: bitstring,sigPartS_2290: bitstring));
                                                        {2337}if (verify(PartS_2289,sigPartS_2290,pkSess_2282) <> true) then
                                                            0
                                                        else
                                                            {2338}event endCli(Sess,Cli,PartS_2289)
                                                    )
                                                    else
                                                        {2339}let v_2291: bool = (Sess = B) in
                                                        (
                                                            {2340}if v_2291 then
                                                            (
                                                                {2341}let pkSess_2292: bitstring = pub(skB) in
                                                                {2342}out(c, GetEndpointRequest);
                                                                {2343}in(c, (SPs_2293: bitstring,=Sign,UP_2294: bitstring,=pkSess_2292));
                                                                {2344}new SPc_2295: bitstring;
                                                                {2345}new Nc_2296: bitstring;
                                                                {2346}let gNc_2297: bitstring = exp(g,Nc_2296) in
                                                                {2347}let m1_2298: bitstring = (SPc_2295,gNc_2297) in
                                                                {2348}event beginCli(Cli,Sess,gNc_2297);
                                                                {2349}out(c, (pkCli_2008,m1_2298,sign(m1_2298,skCli_2007)));
                                                                {2350}in(c, (PartS_2299: bitstring,sigPartS_2300: bitstring));
                                                                {2351}if (verify(PartS_2299,sigPartS_2300,pkSess_2292) <> true) then
                                                                    0
                                                                else
                                                                    {2352}event endCli(Sess,Cli,PartS_2299)
                                                            )
                                                            else
                                                                {2353}let v_2301: bool = (Sess = C) in
                                                                (
                                                                    {2354}if v_2301 then
                                                                    (
                                                                        {2355}let pkSess_2302: bitstring = pub(skC) in
                                                                        {2356}out(c, GetEndpointRequest);
                                                                        {2357}in(c, (SPs_2303: bitstring,=Sign,UP_2304: bitstring,=pkSess_2302));
                                                                        {2358}new SPc_2305: bitstring;
                                                                        {2359}new Nc_2306: bitstring;
                                                                        {2360}let gNc_2307: bitstring = exp(g,Nc_2306) in
                                                                        {2361}let m1_2308: bitstring = (SPc_2305,gNc_2307) in
                                                                        {2362}event beginCli(Cli,Sess,gNc_2307);
                                                                        {2363}out(c, (pkCli_2008,m1_2308,sign(m1_2308,skCli_2007)));
                                                                        {2364}in(c, (PartS_2309: bitstring,sigPartS_2310: bitstring));
                                                                        {2365}if (verify(PartS_2309,sigPartS_2310,pkSess_2302) <> true) then
                                                                            0
                                                                        else
                                                                            {2366}event endCli(Sess,Cli,PartS_2309)
                                                                    )
                                                                    else
                                                                        {2367}let pkSess_2311: bitstring = pub(skI) in
                                                                        {2368}out(c, GetEndpointRequest);
                                                                        {2369}in(c, (SPs_2312: bitstring,=Sign,UP_2313: bitstring,=pkSess_2311));
                                                                        {2370}new SPc_2314: bitstring;
                                                                        {2371}new Nc_2315: bitstring;
                                                                        {2372}let gNc_2316: bitstring = exp(g,Nc_2315) in
                                                                        {2373}let m1_2317: bitstring = (SPc_2314,gNc_2316) in
                                                                        {2374}event beginCli(Cli,Sess,gNc_2316);
                                                                        {2375}out(c, (pkCli_2008,m1_2317,sign(m1_2317,skCli_2007)));
                                                                        {2376}in(c, (PartS_2318: bitstring,sigPartS_2319: bitstring));
                                                                        {2377}if (verify(PartS_2318,sigPartS_2319,pkSess_2311) <> true) then
                                                                            0
                                                                        else
                                                                            {2378}event endCli(Sess,Cli,PartS_2318)
                                                                )
                                                                else
                                                                    {2379}let pkSess_2320: bitstring = fail-any in
                                                                    {2380}out(c, GetEndpointRequest);
                                                                    {2381}in(c, (SPs_2321: bitstring,=Sign,UP_2322: bitstring,=pkSess_2320));
                                                                    {2382}new SPc_2323: bitstring;
                                                                    {2383}new Nc_2324: bitstring;
                                                                    {2384}let gNc_2325: bitstring = exp(g,Nc_2324) in
                                                                    {2385}let m1_2326: bitstring = (SPc_2323,gNc_2325) in
                                                                    {2386}event beginCli(Cli,Sess,gNc_2325);
                                                                    {2387}out(c, (pkCli_2008,m1_2326,sign(m1_2326,skCli_2007)));
                                                                    {2388}in(c, (PartS_2327: bitstring,sigPartS_2328: bitstring));
                                                                    {2389}if (verify(PartS_2327,sigPartS_2328,pkSess_2320) <> true) then
                                                                        0
                                                                    else
                                                                        {2390}event endCli(Sess,Cli,PartS_2327)
                                                        )
                                                        else
                                                            {2391}let pkSess_2329: bitstring = fail-any in
                                                            {2392}out(c, GetEndpointRequest);
                                                            {2393}in(c, (SPs_2330: bitstring,=Sign,UP_2331: bitstring,=pkSess_2329));
                                                            {2394}new SPc_2332: bitstring;
                                                            {2395}new Nc_2333: bitstring;
                                                            {2396}let gNc_2334: bitstring = exp(g,Nc_2333) in
                                                            {2397}let m1_2335: bitstring = (SPc_2332,gNc_2334) in
                                                            {2398}event beginCli(Cli,Sess,gNc_2334);
                                                            {2399}out(c, (pkCli_2008,m1_2335,sign(m1_2335,skCli_2007)));
                                                            {2400}in(c, (PartS_2336: bitstring,sigPartS_2337: bitstring));
                                                            {2401}if (verify(PartS_2336,sigPartS_2337,pkSess_2329) <> true) then
                                                                0
                                                            else
                                                                {2402}event endCli(Sess,Cli,PartS_2336)
                                                )
                                                else
                                                    {2403}let pkSess_2338: bitstring = fail-any in
                                                    {2404}out(c, GetEndpointRequest);
                                                    {2405}in(c, (SPs_2339: bitstring,=Sign,UP_2340: bitstring,=pkSess_2338));
                                                    {2406}new SPc_2341: bitstring;
                                                    {2407}new Nc_2342: bitstring;
                                                    {2408}let gNc_2343: bitstring = exp(g,Nc_2342) in
                                                    {2409}let m1_2344: bitstring = (SPc_2341,gNc_2343) in
                                                    {2410}event beginCli(Cli,Sess,gNc_2343);
                                                    {2411}out(c, (pkCli_2008,m1_2344,sign(m1_2344,skCli_2007)));
                                                    {2412}in(c, (PartS_2345: bitstring,sigPartS_2346: bitstring));
                                                    {2413}if (verify(PartS_2345,sigPartS_2346,pkSess_2338) <> true) then
                                                        0
                                                    else
                                                        {2414}event endCli(Sess,Cli,PartS_2345)
                                    )
                                    else
                                        {2415}let pkDisco_2347: bitstring = fail-any in
                                        {2416}let v_2348: bool = (Sess = A) in
                                        (
                                            {2417}if v_2348 then
                                            (
                                                {2418}let pkSess_2349: bitstring = pub(skA) in
                                                {2419}out(c, GetEndpointRequest);
                                                {2420}in(c, (SPs_2350: bitstring,=Sign,UP_2351: bitstring,=pkSess_2349));
                                                {2421}new SPc_2352: bitstring;
                                                {2422}new Nc_2353: bitstring;
                                                {2423}let gNc_2354: bitstring = exp(g,Nc_2353) in
                                                {2424}let m1_2355: bitstring = (SPc_2352,gNc_2354) in
                                                {2425}event beginCli(Cli,Sess,gNc_2354);
                                                {2426}out(c, (pkCli_2008,m1_2355,sign(m1_2355,skCli_2007)));
                                                {2427}in(c, (PartS_2356: bitstring,sigPartS_2357: bitstring));
                                                {2428}if (verify(PartS_2356,sigPartS_2357,pkSess_2349) <> true) then
                                                    0
                                                else
                                                    {2429}event endCli(Sess,Cli,PartS_2356)
                                            )
                                            else
                                                {2430}let v_2358: bool = (Sess = B) in
                                                (
                                                    {2431}if v_2358 then
                                                    (
                                                        {2432}let pkSess_2359: bitstring = pub(skB) in
                                                        {2433}out(c, GetEndpointRequest);
                                                        {2434}in(c, (SPs_2360: bitstring,=Sign,UP_2361: bitstring,=pkSess_2359));
                                                        {2435}new SPc_2362: bitstring;
                                                        {2436}new Nc_2363: bitstring;
                                                        {2437}let gNc_2364: bitstring = exp(g,Nc_2363) in
                                                        {2438}let m1_2365: bitstring = (SPc_2362,gNc_2364) in
                                                        {2439}event beginCli(Cli,Sess,gNc_2364);
                                                        {2440}out(c, (pkCli_2008,m1_2365,sign(m1_2365,skCli_2007)));
                                                        {2441}in(c, (PartS_2366: bitstring,sigPartS_2367: bitstring));
                                                        {2442}if (verify(PartS_2366,sigPartS_2367,pkSess_2359) <> true) then
                                                            0
                                                        else
                                                            {2443}event endCli(Sess,Cli,PartS_2366)
                                                    )
                                                    else
                                                        {2444}let v_2368: bool = (Sess = C) in
                                                        (
                                                            {2445}if v_2368 then
                                                            (
                                                                {2446}let pkSess_2369: bitstring = pub(skC) in
                                                                {2447}out(c, GetEndpointRequest);
                                                                {2448}in(c, (SPs_2370: bitstring,=Sign,UP_2371: bitstring,=pkSess_2369));
                                                                {2449}new SPc_2372: bitstring;
                                                                {2450}new Nc_2373: bitstring;
                                                                {2451}let gNc_2374: bitstring = exp(g,Nc_2373) in
                                                                {2452}let m1_2375: bitstring = (SPc_2372,gNc_2374) in
                                                                {2453}event beginCli(Cli,Sess,gNc_2374);
                                                                {2454}out(c, (pkCli_2008,m1_2375,sign(m1_2375,skCli_2007)));
                                                                {2455}in(c, (PartS_2376: bitstring,sigPartS_2377: bitstring));
                                                                {2456}if (verify(PartS_2376,sigPartS_2377,pkSess_2369) <> true) then
                                                                    0
                                                                else
                                                                    {2457}event endCli(Sess,Cli,PartS_2376)
                                                            )
                                                            else
                                                                {2458}let pkSess_2378: bitstring = pub(skI) in
                                                                {2459}out(c, GetEndpointRequest);
                                                                {2460}in(c, (SPs_2379: bitstring,=Sign,UP_2380: bitstring,=pkSess_2378));
                                                                {2461}new SPc_2381: bitstring;
                                                                {2462}new Nc_2382: bitstring;
                                                                {2463}let gNc_2383: bitstring = exp(g,Nc_2382) in
                                                                {2464}let m1_2384: bitstring = (SPc_2381,gNc_2383) in
                                                                {2465}event beginCli(Cli,Sess,gNc_2383);
                                                                {2466}out(c, (pkCli_2008,m1_2384,sign(m1_2384,skCli_2007)));
                                                                {2467}in(c, (PartS_2385: bitstring,sigPartS_2386: bitstring));
                                                                {2468}if (verify(PartS_2385,sigPartS_2386,pkSess_2378) <> true) then
                                                                    0
                                                                else
                                                                    {2469}event endCli(Sess,Cli,PartS_2385)
                                                        )
                                                        else
                                                            {2470}let pkSess_2387: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (SPs_2388: bitstring,=Sign,UP_2389: bitstring,=pkSess_2387));
                                                            {2473}new SPc_2390: bitstring;
                                                            {2474}new Nc_2391: bitstring;
                                                            {2475}let gNc_2392: bitstring = exp(g,Nc_2391) in
                                                            {2476}let m1_2393: bitstring = (SPc_2390,gNc_2392) in
                                                            {2477}event beginCli(Cli,Sess,gNc_2392);
                                                            {2478}out(c, (pkCli_2008,m1_2393,sign(m1_2393,skCli_2007)));
                                                            {2479}in(c, (PartS_2394: bitstring,sigPartS_2395: bitstring));
                                                            {2480}if (verify(PartS_2394,sigPartS_2395,pkSess_2387) <> true) then
                                                                0
                                                            else
                                                                {2481}event endCli(Sess,Cli,PartS_2394)
                                                )
                                                else
                                                    {2482}let pkSess_2396: bitstring = fail-any in
                                                    {2483}out(c, GetEndpointRequest);
                                                    {2484}in(c, (SPs_2397: bitstring,=Sign,UP_2398: bitstring,=pkSess_2396));
                                                    {2485}new SPc_2399: bitstring;
                                                    {2486}new Nc_2400: bitstring;
                                                    {2487}let gNc_2401: bitstring = exp(g,Nc_2400) in
                                                    {2488}let m1_2402: bitstring = (SPc_2399,gNc_2401) in
                                                    {2489}event beginCli(Cli,Sess,gNc_2401);
                                                    {2490}out(c, (pkCli_2008,m1_2402,sign(m1_2402,skCli_2007)));
                                                    {2491}in(c, (PartS_2403: bitstring,sigPartS_2404: bitstring));
                                                    {2492}if (verify(PartS_2403,sigPartS_2404,pkSess_2396) <> true) then
                                                        0
                                                    else
                                                        {2493}event endCli(Sess,Cli,PartS_2403)
                                        )
                                        else
                                            {2494}let pkSess_2405: bitstring = fail-any in
                                            {2495}out(c, GetEndpointRequest);
                                            {2496}in(c, (SPs_2406: bitstring,=Sign,UP_2407: bitstring,=pkSess_2405));
                                            {2497}new SPc_2408: bitstring;
                                            {2498}new Nc_2409: bitstring;
                                            {2499}let gNc_2410: bitstring = exp(g,Nc_2409) in
                                            {2500}let m1_2411: bitstring = (SPc_2408,gNc_2410) in
                                            {2501}event beginCli(Cli,Sess,gNc_2410);
                                            {2502}out(c, (pkCli_2008,m1_2411,sign(m1_2411,skCli_2007)));
                                            {2503}in(c, (PartS_2412: bitstring,sigPartS_2413: bitstring));
                                            {2504}if (verify(PartS_2412,sigPartS_2413,pkSess_2405) <> true) then
                                                0
                                            else
                                                {2505}event endCli(Sess,Cli,PartS_2412)
                            )
                            else
                                {2506}let pkDisco_2414: bitstring = fail-any in
                                {2507}let v_2415: bool = (Sess = A) in
                                (
                                    {2508}if v_2415 then
                                    (
                                        {2509}let pkSess_2416: bitstring = pub(skA) in
                                        {2510}out(c, GetEndpointRequest);
                                        {2511}in(c, (SPs_2417: bitstring,=Sign,UP_2418: bitstring,=pkSess_2416));
                                        {2512}new SPc_2419: bitstring;
                                        {2513}new Nc_2420: bitstring;
                                        {2514}let gNc_2421: bitstring = exp(g,Nc_2420) in
                                        {2515}let m1_2422: bitstring = (SPc_2419,gNc_2421) in
                                        {2516}event beginCli(Cli,Sess,gNc_2421);
                                        {2517}out(c, (pkCli_2008,m1_2422,sign(m1_2422,skCli_2007)));
                                        {2518}in(c, (PartS_2423: bitstring,sigPartS_2424: bitstring));
                                        {2519}if (verify(PartS_2423,sigPartS_2424,pkSess_2416) <> true) then
                                            0
                                        else
                                            {2520}event endCli(Sess,Cli,PartS_2423)
                                    )
                                    else
                                        {2521}let v_2425: bool = (Sess = B) in
                                        (
                                            {2522}if v_2425 then
                                            (
                                                {2523}let pkSess_2426: bitstring = pub(skB) in
                                                {2524}out(c, GetEndpointRequest);
                                                {2525}in(c, (SPs_2427: bitstring,=Sign,UP_2428: bitstring,=pkSess_2426));
                                                {2526}new SPc_2429: bitstring;
                                                {2527}new Nc_2430: bitstring;
                                                {2528}let gNc_2431: bitstring = exp(g,Nc_2430) in
                                                {2529}let m1_2432: bitstring = (SPc_2429,gNc_2431) in
                                                {2530}event beginCli(Cli,Sess,gNc_2431);
                                                {2531}out(c, (pkCli_2008,m1_2432,sign(m1_2432,skCli_2007)));
                                                {2532}in(c, (PartS_2433: bitstring,sigPartS_2434: bitstring));
                                                {2533}if (verify(PartS_2433,sigPartS_2434,pkSess_2426) <> true) then
                                                    0
                                                else
                                                    {2534}event endCli(Sess,Cli,PartS_2433)
                                            )
                                            else
                                                {2535}let v_2435: bool = (Sess = C) in
                                                (
                                                    {2536}if v_2435 then
                                                    (
                                                        {2537}let pkSess_2436: bitstring = pub(skC) in
                                                        {2538}out(c, GetEndpointRequest);
                                                        {2539}in(c, (SPs_2437: bitstring,=Sign,UP_2438: bitstring,=pkSess_2436));
                                                        {2540}new SPc_2439: bitstring;
                                                        {2541}new Nc_2440: bitstring;
                                                        {2542}let gNc_2441: bitstring = exp(g,Nc_2440) in
                                                        {2543}let m1_2442: bitstring = (SPc_2439,gNc_2441) in
                                                        {2544}event beginCli(Cli,Sess,gNc_2441);
                                                        {2545}out(c, (pkCli_2008,m1_2442,sign(m1_2442,skCli_2007)));
                                                        {2546}in(c, (PartS_2443: bitstring,sigPartS_2444: bitstring));
                                                        {2547}if (verify(PartS_2443,sigPartS_2444,pkSess_2436) <> true) then
                                                            0
                                                        else
                                                            {2548}event endCli(Sess,Cli,PartS_2443)
                                                    )
                                                    else
                                                        {2549}let pkSess_2445: bitstring = pub(skI) in
                                                        {2550}out(c, GetEndpointRequest);
                                                        {2551}in(c, (SPs_2446: bitstring,=Sign,UP_2447: bitstring,=pkSess_2445));
                                                        {2552}new SPc_2448: bitstring;
                                                        {2553}new Nc_2449: bitstring;
                                                        {2554}let gNc_2450: bitstring = exp(g,Nc_2449) in
                                                        {2555}let m1_2451: bitstring = (SPc_2448,gNc_2450) in
                                                        {2556}event beginCli(Cli,Sess,gNc_2450);
                                                        {2557}out(c, (pkCli_2008,m1_2451,sign(m1_2451,skCli_2007)));
                                                        {2558}in(c, (PartS_2452: bitstring,sigPartS_2453: bitstring));
                                                        {2559}if (verify(PartS_2452,sigPartS_2453,pkSess_2445) <> true) then
                                                            0
                                                        else
                                                            {2560}event endCli(Sess,Cli,PartS_2452)
                                                )
                                                else
                                                    {2561}let pkSess_2454: bitstring = fail-any in
                                                    {2562}out(c, GetEndpointRequest);
                                                    {2563}in(c, (SPs_2455: bitstring,=Sign,UP_2456: bitstring,=pkSess_2454));
                                                    {2564}new SPc_2457: bitstring;
                                                    {2565}new Nc_2458: bitstring;
                                                    {2566}let gNc_2459: bitstring = exp(g,Nc_2458) in
                                                    {2567}let m1_2460: bitstring = (SPc_2457,gNc_2459) in
                                                    {2568}event beginCli(Cli,Sess,gNc_2459);
                                                    {2569}out(c, (pkCli_2008,m1_2460,sign(m1_2460,skCli_2007)));
                                                    {2570}in(c, (PartS_2461: bitstring,sigPartS_2462: bitstring));
                                                    {2571}if (verify(PartS_2461,sigPartS_2462,pkSess_2454) <> true) then
                                                        0
                                                    else
                                                        {2572}event endCli(Sess,Cli,PartS_2461)
                                        )
                                        else
                                            {2573}let pkSess_2463: bitstring = fail-any in
                                            {2574}out(c, GetEndpointRequest);
                                            {2575}in(c, (SPs_2464: bitstring,=Sign,UP_2465: bitstring,=pkSess_2463));
                                            {2576}new SPc_2466: bitstring;
                                            {2577}new Nc_2467: bitstring;
                                            {2578}let gNc_2468: bitstring = exp(g,Nc_2467) in
                                            {2579}let m1_2469: bitstring = (SPc_2466,gNc_2468) in
                                            {2580}event beginCli(Cli,Sess,gNc_2468);
                                            {2581}out(c, (pkCli_2008,m1_2469,sign(m1_2469,skCli_2007)));
                                            {2582}in(c, (PartS_2470: bitstring,sigPartS_2471: bitstring));
                                            {2583}if (verify(PartS_2470,sigPartS_2471,pkSess_2463) <> true) then
                                                0
                                            else
                                                {2584}event endCli(Sess,Cli,PartS_2470)
                                )
                                else
                                    {2585}let pkSess_2472: bitstring = fail-any in
                                    {2586}out(c, GetEndpointRequest);
                                    {2587}in(c, (SPs_2473: bitstring,=Sign,UP_2474: bitstring,=pkSess_2472));
                                    {2588}new SPc_2475: bitstring;
                                    {2589}new Nc_2476: bitstring;
                                    {2590}let gNc_2477: bitstring = exp(g,Nc_2476) in
                                    {2591}let m1_2478: bitstring = (SPc_2475,gNc_2477) in
                                    {2592}event beginCli(Cli,Sess,gNc_2477);
                                    {2593}out(c, (pkCli_2008,m1_2478,sign(m1_2478,skCli_2007)));
                                    {2594}in(c, (PartS_2479: bitstring,sigPartS_2480: bitstring));
                                    {2595}if (verify(PartS_2479,sigPartS_2480,pkSess_2472) <> true) then
                                        0
                                    else
                                        {2596}event endCli(Sess,Cli,PartS_2479)
                    )
                    else
                        {2597}let skCli_2481: bitstring = fail-any in
                        {2598}let pkCli_2482: bitstring = pub(skCli_2481) in
                        {2599}let v_2483: bool = (Disco = A) in
                        (
                            {2600}if v_2483 then
                            (
                                {2601}let pkDisco_2484: bitstring = pub(skA) in
                                {2602}let v_2485: bool = (Sess = A) in
                                (
                                    {2603}if v_2485 then
                                    (
                                        {2604}let pkSess_2486: bitstring = pub(skA) in
                                        {2605}out(c, GetEndpointRequest);
                                        {2606}in(c, (SPs_2487: bitstring,=Sign,UP_2488: bitstring,=pkSess_2486));
                                        {2607}new SPc_2489: bitstring;
                                        {2608}new Nc_2490: bitstring;
                                        {2609}let gNc_2491: bitstring = exp(g,Nc_2490) in
                                        {2610}let m1_2492: bitstring = (SPc_2489,gNc_2491) in
                                        {2611}event beginCli(Cli,Sess,gNc_2491);
                                        {2612}out(c, (pkCli_2482,m1_2492,sign(m1_2492,skCli_2481)));
                                        {2613}in(c, (PartS_2493: bitstring,sigPartS_2494: bitstring));
                                        {2614}if (verify(PartS_2493,sigPartS_2494,pkSess_2486) <> true) then
                                            0
                                        else
                                            {2615}event endCli(Sess,Cli,PartS_2493)
                                    )
                                    else
                                        {2616}let v_2495: bool = (Sess = B) in
                                        (
                                            {2617}if v_2495 then
                                            (
                                                {2618}let pkSess_2496: bitstring = pub(skB) in
                                                {2619}out(c, GetEndpointRequest);
                                                {2620}in(c, (SPs_2497: bitstring,=Sign,UP_2498: bitstring,=pkSess_2496));
                                                {2621}new SPc_2499: bitstring;
                                                {2622}new Nc_2500: bitstring;
                                                {2623}let gNc_2501: bitstring = exp(g,Nc_2500) in
                                                {2624}let m1_2502: bitstring = (SPc_2499,gNc_2501) in
                                                {2625}event beginCli(Cli,Sess,gNc_2501);
                                                {2626}out(c, (pkCli_2482,m1_2502,sign(m1_2502,skCli_2481)));
                                                {2627}in(c, (PartS_2503: bitstring,sigPartS_2504: bitstring));
                                                {2628}if (verify(PartS_2503,sigPartS_2504,pkSess_2496) <> true) then
                                                    0
                                                else
                                                    {2629}event endCli(Sess,Cli,PartS_2503)
                                            )
                                            else
                                                {2630}let v_2505: bool = (Sess = C) in
                                                (
                                                    {2631}if v_2505 then
                                                    (
                                                        {2632}let pkSess_2506: bitstring = pub(skC) in
                                                        {2633}out(c, GetEndpointRequest);
                                                        {2634}in(c, (SPs_2507: bitstring,=Sign,UP_2508: bitstring,=pkSess_2506));
                                                        {2635}new SPc_2509: bitstring;
                                                        {2636}new Nc_2510: bitstring;
                                                        {2637}let gNc_2511: bitstring = exp(g,Nc_2510) in
                                                        {2638}let m1_2512: bitstring = (SPc_2509,gNc_2511) in
                                                        {2639}event beginCli(Cli,Sess,gNc_2511);
                                                        {2640}out(c, (pkCli_2482,m1_2512,sign(m1_2512,skCli_2481)));
                                                        {2641}in(c, (PartS_2513: bitstring,sigPartS_2514: bitstring));
                                                        {2642}if (verify(PartS_2513,sigPartS_2514,pkSess_2506) <> true) then
                                                            0
                                                        else
                                                            {2643}event endCli(Sess,Cli,PartS_2513)
                                                    )
                                                    else
                                                        {2644}let pkSess_2515: bitstring = pub(skI) in
                                                        {2645}out(c, GetEndpointRequest);
                                                        {2646}in(c, (SPs_2516: bitstring,=Sign,UP_2517: bitstring,=pkSess_2515));
                                                        {2647}new SPc_2518: bitstring;
                                                        {2648}new Nc_2519: bitstring;
                                                        {2649}let gNc_2520: bitstring = exp(g,Nc_2519) in
                                                        {2650}let m1_2521: bitstring = (SPc_2518,gNc_2520) in
                                                        {2651}event beginCli(Cli,Sess,gNc_2520);
                                                        {2652}out(c, (pkCli_2482,m1_2521,sign(m1_2521,skCli_2481)));
                                                        {2653}in(c, (PartS_2522: bitstring,sigPartS_2523: bitstring));
                                                        {2654}if (verify(PartS_2522,sigPartS_2523,pkSess_2515) <> true) then
                                                            0
                                                        else
                                                            {2655}event endCli(Sess,Cli,PartS_2522)
                                                )
                                                else
                                                    {2656}let pkSess_2524: bitstring = fail-any in
                                                    {2657}out(c, GetEndpointRequest);
                                                    {2658}in(c, (SPs_2525: bitstring,=Sign,UP_2526: bitstring,=pkSess_2524));
                                                    {2659}new SPc_2527: bitstring;
                                                    {2660}new Nc_2528: bitstring;
                                                    {2661}let gNc_2529: bitstring = exp(g,Nc_2528) in
                                                    {2662}let m1_2530: bitstring = (SPc_2527,gNc_2529) in
                                                    {2663}event beginCli(Cli,Sess,gNc_2529);
                                                    {2664}out(c, (pkCli_2482,m1_2530,sign(m1_2530,skCli_2481)));
                                                    {2665}in(c, (PartS_2531: bitstring,sigPartS_2532: bitstring));
                                                    {2666}if (verify(PartS_2531,sigPartS_2532,pkSess_2524) <> true) then
                                                        0
                                                    else
                                                        {2667}event endCli(Sess,Cli,PartS_2531)
                                        )
                                        else
                                            {2668}let pkSess_2533: bitstring = fail-any in
                                            {2669}out(c, GetEndpointRequest);
                                            {2670}in(c, (SPs_2534: bitstring,=Sign,UP_2535: bitstring,=pkSess_2533));
                                            {2671}new SPc_2536: bitstring;
                                            {2672}new Nc_2537: bitstring;
                                            {2673}let gNc_2538: bitstring = exp(g,Nc_2537) in
                                            {2674}let m1_2539: bitstring = (SPc_2536,gNc_2538) in
                                            {2675}event beginCli(Cli,Sess,gNc_2538);
                                            {2676}out(c, (pkCli_2482,m1_2539,sign(m1_2539,skCli_2481)));
                                            {2677}in(c, (PartS_2540: bitstring,sigPartS_2541: bitstring));
                                            {2678}if (verify(PartS_2540,sigPartS_2541,pkSess_2533) <> true) then
                                                0
                                            else
                                                {2679}event endCli(Sess,Cli,PartS_2540)
                                )
                                else
                                    {2680}let pkSess_2542: bitstring = fail-any in
                                    {2681}out(c, GetEndpointRequest);
                                    {2682}in(c, (SPs_2543: bitstring,=Sign,UP_2544: bitstring,=pkSess_2542));
                                    {2683}new SPc_2545: bitstring;
                                    {2684}new Nc_2546: bitstring;
                                    {2685}let gNc_2547: bitstring = exp(g,Nc_2546) in
                                    {2686}let m1_2548: bitstring = (SPc_2545,gNc_2547) in
                                    {2687}event beginCli(Cli,Sess,gNc_2547);
                                    {2688}out(c, (pkCli_2482,m1_2548,sign(m1_2548,skCli_2481)));
                                    {2689}in(c, (PartS_2549: bitstring,sigPartS_2550: bitstring));
                                    {2690}if (verify(PartS_2549,sigPartS_2550,pkSess_2542) <> true) then
                                        0
                                    else
                                        {2691}event endCli(Sess,Cli,PartS_2549)
                            )
                            else
                                {2692}let v_2551: bool = (Disco = B) in
                                (
                                    {2693}if v_2551 then
                                    (
                                        {2694}let pkDisco_2552: bitstring = pub(skB) in
                                        {2695}let v_2553: bool = (Sess = A) in
                                        (
                                            {2696}if v_2553 then
                                            (
                                                {2697}let pkSess_2554: bitstring = pub(skA) in
                                                {2698}out(c, GetEndpointRequest);
                                                {2699}in(c, (SPs_2555: bitstring,=Sign,UP_2556: bitstring,=pkSess_2554));
                                                {2700}new SPc_2557: bitstring;
                                                {2701}new Nc_2558: bitstring;
                                                {2702}let gNc_2559: bitstring = exp(g,Nc_2558) in
                                                {2703}let m1_2560: bitstring = (SPc_2557,gNc_2559) in
                                                {2704}event beginCli(Cli,Sess,gNc_2559);
                                                {2705}out(c, (pkCli_2482,m1_2560,sign(m1_2560,skCli_2481)));
                                                {2706}in(c, (PartS_2561: bitstring,sigPartS_2562: bitstring));
                                                {2707}if (verify(PartS_2561,sigPartS_2562,pkSess_2554) <> true) then
                                                    0
                                                else
                                                    {2708}event endCli(Sess,Cli,PartS_2561)
                                            )
                                            else
                                                {2709}let v_2563: bool = (Sess = B) in
                                                (
                                                    {2710}if v_2563 then
                                                    (
                                                        {2711}let pkSess_2564: bitstring = pub(skB) in
                                                        {2712}out(c, GetEndpointRequest);
                                                        {2713}in(c, (SPs_2565: bitstring,=Sign,UP_2566: bitstring,=pkSess_2564));
                                                        {2714}new SPc_2567: bitstring;
                                                        {2715}new Nc_2568: bitstring;
                                                        {2716}let gNc_2569: bitstring = exp(g,Nc_2568) in
                                                        {2717}let m1_2570: bitstring = (SPc_2567,gNc_2569) in
                                                        {2718}event beginCli(Cli,Sess,gNc_2569);
                                                        {2719}out(c, (pkCli_2482,m1_2570,sign(m1_2570,skCli_2481)));
                                                        {2720}in(c, (PartS_2571: bitstring,sigPartS_2572: bitstring));
                                                        {2721}if (verify(PartS_2571,sigPartS_2572,pkSess_2564) <> true) then
                                                            0
                                                        else
                                                            {2722}event endCli(Sess,Cli,PartS_2571)
                                                    )
                                                    else
                                                        {2723}let v_2573: bool = (Sess = C) in
                                                        (
                                                            {2724}if v_2573 then
                                                            (
                                                                {2725}let pkSess_2574: bitstring = pub(skC) in
                                                                {2726}out(c, GetEndpointRequest);
                                                                {2727}in(c, (SPs_2575: bitstring,=Sign,UP_2576: bitstring,=pkSess_2574));
                                                                {2728}new SPc_2577: bitstring;
                                                                {2729}new Nc_2578: bitstring;
                                                                {2730}let gNc_2579: bitstring = exp(g,Nc_2578) in
                                                                {2731}let m1_2580: bitstring = (SPc_2577,gNc_2579) in
                                                                {2732}event beginCli(Cli,Sess,gNc_2579);
                                                                {2733}out(c, (pkCli_2482,m1_2580,sign(m1_2580,skCli_2481)));
                                                                {2734}in(c, (PartS_2581: bitstring,sigPartS_2582: bitstring));
                                                                {2735}if (verify(PartS_2581,sigPartS_2582,pkSess_2574) <> true) then
                                                                    0
                                                                else
                                                                    {2736}event endCli(Sess,Cli,PartS_2581)
                                                            )
                                                            else
                                                                {2737}let pkSess_2583: bitstring = pub(skI) in
                                                                {2738}out(c, GetEndpointRequest);
                                                                {2739}in(c, (SPs_2584: bitstring,=Sign,UP_2585: bitstring,=pkSess_2583));
                                                                {2740}new SPc_2586: bitstring;
                                                                {2741}new Nc_2587: bitstring;
                                                                {2742}let gNc_2588: bitstring = exp(g,Nc_2587) in
                                                                {2743}let m1_2589: bitstring = (SPc_2586,gNc_2588) in
                                                                {2744}event beginCli(Cli,Sess,gNc_2588);
                                                                {2745}out(c, (pkCli_2482,m1_2589,sign(m1_2589,skCli_2481)));
                                                                {2746}in(c, (PartS_2590: bitstring,sigPartS_2591: bitstring));
                                                                {2747}if (verify(PartS_2590,sigPartS_2591,pkSess_2583) <> true) then
                                                                    0
                                                                else
                                                                    {2748}event endCli(Sess,Cli,PartS_2590)
                                                        )
                                                        else
                                                            {2749}let pkSess_2592: bitstring = fail-any in
                                                            {2750}out(c, GetEndpointRequest);
                                                            {2751}in(c, (SPs_2593: bitstring,=Sign,UP_2594: bitstring,=pkSess_2592));
                                                            {2752}new SPc_2595: bitstring;
                                                            {2753}new Nc_2596: bitstring;
                                                            {2754}let gNc_2597: bitstring = exp(g,Nc_2596) in
                                                            {2755}let m1_2598: bitstring = (SPc_2595,gNc_2597) in
                                                            {2756}event beginCli(Cli,Sess,gNc_2597);
                                                            {2757}out(c, (pkCli_2482,m1_2598,sign(m1_2598,skCli_2481)));
                                                            {2758}in(c, (PartS_2599: bitstring,sigPartS_2600: bitstring));
                                                            {2759}if (verify(PartS_2599,sigPartS_2600,pkSess_2592) <> true) then
                                                                0
                                                            else
                                                                {2760}event endCli(Sess,Cli,PartS_2599)
                                                )
                                                else
                                                    {2761}let pkSess_2601: bitstring = fail-any in
                                                    {2762}out(c, GetEndpointRequest);
                                                    {2763}in(c, (SPs_2602: bitstring,=Sign,UP_2603: bitstring,=pkSess_2601));
                                                    {2764}new SPc_2604: bitstring;
                                                    {2765}new Nc_2605: bitstring;
                                                    {2766}let gNc_2606: bitstring = exp(g,Nc_2605) in
                                                    {2767}let m1_2607: bitstring = (SPc_2604,gNc_2606) in
                                                    {2768}event beginCli(Cli,Sess,gNc_2606);
                                                    {2769}out(c, (pkCli_2482,m1_2607,sign(m1_2607,skCli_2481)));
                                                    {2770}in(c, (PartS_2608: bitstring,sigPartS_2609: bitstring));
                                                    {2771}if (verify(PartS_2608,sigPartS_2609,pkSess_2601) <> true) then
                                                        0
                                                    else
                                                        {2772}event endCli(Sess,Cli,PartS_2608)
                                        )
                                        else
                                            {2773}let pkSess_2610: bitstring = fail-any in
                                            {2774}out(c, GetEndpointRequest);
                                            {2775}in(c, (SPs_2611: bitstring,=Sign,UP_2612: bitstring,=pkSess_2610));
                                            {2776}new SPc_2613: bitstring;
                                            {2777}new Nc_2614: bitstring;
                                            {2778}let gNc_2615: bitstring = exp(g,Nc_2614) in
                                            {2779}let m1_2616: bitstring = (SPc_2613,gNc_2615) in
                                            {2780}event beginCli(Cli,Sess,gNc_2615);
                                            {2781}out(c, (pkCli_2482,m1_2616,sign(m1_2616,skCli_2481)));
                                            {2782}in(c, (PartS_2617: bitstring,sigPartS_2618: bitstring));
                                            {2783}if (verify(PartS_2617,sigPartS_2618,pkSess_2610) <> true) then
                                                0
                                            else
                                                {2784}event endCli(Sess,Cli,PartS_2617)
                                    )
                                    else
                                        {2785}let v_2619: bool = (Disco = C) in
                                        (
                                            {2786}if v_2619 then
                                            (
                                                {2787}let pkDisco_2620: bitstring = pub(skC) in
                                                {2788}let v_2621: bool = (Sess = A) in
                                                (
                                                    {2789}if v_2621 then
                                                    (
                                                        {2790}let pkSess_2622: bitstring = pub(skA) in
                                                        {2791}out(c, GetEndpointRequest);
                                                        {2792}in(c, (SPs_2623: bitstring,=Sign,UP_2624: bitstring,=pkSess_2622));
                                                        {2793}new SPc_2625: bitstring;
                                                        {2794}new Nc_2626: bitstring;
                                                        {2795}let gNc_2627: bitstring = exp(g,Nc_2626) in
                                                        {2796}let m1_2628: bitstring = (SPc_2625,gNc_2627) in
                                                        {2797}event beginCli(Cli,Sess,gNc_2627);
                                                        {2798}out(c, (pkCli_2482,m1_2628,sign(m1_2628,skCli_2481)));
                                                        {2799}in(c, (PartS_2629: bitstring,sigPartS_2630: bitstring));
                                                        {2800}if (verify(PartS_2629,sigPartS_2630,pkSess_2622) <> true) then
                                                            0
                                                        else
                                                            {2801}event endCli(Sess,Cli,PartS_2629)
                                                    )
                                                    else
                                                        {2802}let v_2631: bool = (Sess = B) in
                                                        (
                                                            {2803}if v_2631 then
                                                            (
                                                                {2804}let pkSess_2632: bitstring = pub(skB) in
                                                                {2805}out(c, GetEndpointRequest);
                                                                {2806}in(c, (SPs_2633: bitstring,=Sign,UP_2634: bitstring,=pkSess_2632));
                                                                {2807}new SPc_2635: bitstring;
                                                                {2808}new Nc_2636: bitstring;
                                                                {2809}let gNc_2637: bitstring = exp(g,Nc_2636) in
                                                                {2810}let m1_2638: bitstring = (SPc_2635,gNc_2637) in
                                                                {2811}event beginCli(Cli,Sess,gNc_2637);
                                                                {2812}out(c, (pkCli_2482,m1_2638,sign(m1_2638,skCli_2481)));
                                                                {2813}in(c, (PartS_2639: bitstring,sigPartS_2640: bitstring));
                                                                {2814}if (verify(PartS_2639,sigPartS_2640,pkSess_2632) <> true) then
                                                                    0
                                                                else
                                                                    {2815}event endCli(Sess,Cli,PartS_2639)
                                                            )
                                                            else
                                                                {2816}let v_2641: bool = (Sess = C) in
                                                                (
                                                                    {2817}if v_2641 then
                                                                    (
                                                                        {2818}let pkSess_2642: bitstring = pub(skC) in
                                                                        {2819}out(c, GetEndpointRequest);
                                                                        {2820}in(c, (SPs_2643: bitstring,=Sign,UP_2644: bitstring,=pkSess_2642));
                                                                        {2821}new SPc_2645: bitstring;
                                                                        {2822}new Nc_2646: bitstring;
                                                                        {2823}let gNc_2647: bitstring = exp(g,Nc_2646) in
                                                                        {2824}let m1_2648: bitstring = (SPc_2645,gNc_2647) in
                                                                        {2825}event beginCli(Cli,Sess,gNc_2647);
                                                                        {2826}out(c, (pkCli_2482,m1_2648,sign(m1_2648,skCli_2481)));
                                                                        {2827}in(c, (PartS_2649: bitstring,sigPartS_2650: bitstring));
                                                                        {2828}if (verify(PartS_2649,sigPartS_2650,pkSess_2642) <> true) then
                                                                            0
                                                                        else
                                                                            {2829}event endCli(Sess,Cli,PartS_2649)
                                                                    )
                                                                    else
                                                                        {2830}let pkSess_2651: bitstring = pub(skI) in
                                                                        {2831}out(c, GetEndpointRequest);
                                                                        {2832}in(c, (SPs_2652: bitstring,=Sign,UP_2653: bitstring,=pkSess_2651));
                                                                        {2833}new SPc_2654: bitstring;
                                                                        {2834}new Nc_2655: bitstring;
                                                                        {2835}let gNc_2656: bitstring = exp(g,Nc_2655) in
                                                                        {2836}let m1_2657: bitstring = (SPc_2654,gNc_2656) in
                                                                        {2837}event beginCli(Cli,Sess,gNc_2656);
                                                                        {2838}out(c, (pkCli_2482,m1_2657,sign(m1_2657,skCli_2481)));
                                                                        {2839}in(c, (PartS_2658: bitstring,sigPartS_2659: bitstring));
                                                                        {2840}if (verify(PartS_2658,sigPartS_2659,pkSess_2651) <> true) then
                                                                            0
                                                                        else
                                                                            {2841}event endCli(Sess,Cli,PartS_2658)
                                                                )
                                                                else
                                                                    {2842}let pkSess_2660: bitstring = fail-any in
                                                                    {2843}out(c, GetEndpointRequest);
                                                                    {2844}in(c, (SPs_2661: bitstring,=Sign,UP_2662: bitstring,=pkSess_2660));
                                                                    {2845}new SPc_2663: bitstring;
                                                                    {2846}new Nc_2664: bitstring;
                                                                    {2847}let gNc_2665: bitstring = exp(g,Nc_2664) in
                                                                    {2848}let m1_2666: bitstring = (SPc_2663,gNc_2665) in
                                                                    {2849}event beginCli(Cli,Sess,gNc_2665);
                                                                    {2850}out(c, (pkCli_2482,m1_2666,sign(m1_2666,skCli_2481)));
                                                                    {2851}in(c, (PartS_2667: bitstring,sigPartS_2668: bitstring));
                                                                    {2852}if (verify(PartS_2667,sigPartS_2668,pkSess_2660) <> true) then
                                                                        0
                                                                    else
                                                                        {2853}event endCli(Sess,Cli,PartS_2667)
                                                        )
                                                        else
                                                            {2854}let pkSess_2669: bitstring = fail-any in
                                                            {2855}out(c, GetEndpointRequest);
                                                            {2856}in(c, (SPs_2670: bitstring,=Sign,UP_2671: bitstring,=pkSess_2669));
                                                            {2857}new SPc_2672: bitstring;
                                                            {2858}new Nc_2673: bitstring;
                                                            {2859}let gNc_2674: bitstring = exp(g,Nc_2673) in
                                                            {2860}let m1_2675: bitstring = (SPc_2672,gNc_2674) in
                                                            {2861}event beginCli(Cli,Sess,gNc_2674);
                                                            {2862}out(c, (pkCli_2482,m1_2675,sign(m1_2675,skCli_2481)));
                                                            {2863}in(c, (PartS_2676: bitstring,sigPartS_2677: bitstring));
                                                            {2864}if (verify(PartS_2676,sigPartS_2677,pkSess_2669) <> true) then
                                                                0
                                                            else
                                                                {2865}event endCli(Sess,Cli,PartS_2676)
                                                )
                                                else
                                                    {2866}let pkSess_2678: bitstring = fail-any in
                                                    {2867}out(c, GetEndpointRequest);
                                                    {2868}in(c, (SPs_2679: bitstring,=Sign,UP_2680: bitstring,=pkSess_2678));
                                                    {2869}new SPc_2681: bitstring;
                                                    {2870}new Nc_2682: bitstring;
                                                    {2871}let gNc_2683: bitstring = exp(g,Nc_2682) in
                                                    {2872}let m1_2684: bitstring = (SPc_2681,gNc_2683) in
                                                    {2873}event beginCli(Cli,Sess,gNc_2683);
                                                    {2874}out(c, (pkCli_2482,m1_2684,sign(m1_2684,skCli_2481)));
                                                    {2875}in(c, (PartS_2685: bitstring,sigPartS_2686: bitstring));
                                                    {2876}if (verify(PartS_2685,sigPartS_2686,pkSess_2678) <> true) then
                                                        0
                                                    else
                                                        {2877}event endCli(Sess,Cli,PartS_2685)
                                            )
                                            else
                                                {2878}let pkDisco_2687: bitstring = pub(skI) in
                                                {2879}let v_2688: bool = (Sess = A) in
                                                (
                                                    {2880}if v_2688 then
                                                    (
                                                        {2881}let pkSess_2689: bitstring = pub(skA) in
                                                        {2882}out(c, GetEndpointRequest);
                                                        {2883}in(c, (SPs_2690: bitstring,=Sign,UP_2691: bitstring,=pkSess_2689));
                                                        {2884}new SPc_2692: bitstring;
                                                        {2885}new Nc_2693: bitstring;
                                                        {2886}let gNc_2694: bitstring = exp(g,Nc_2693) in
                                                        {2887}let m1_2695: bitstring = (SPc_2692,gNc_2694) in
                                                        {2888}event beginCli(Cli,Sess,gNc_2694);
                                                        {2889}out(c, (pkCli_2482,m1_2695,sign(m1_2695,skCli_2481)));
                                                        {2890}in(c, (PartS_2696: bitstring,sigPartS_2697: bitstring));
                                                        {2891}if (verify(PartS_2696,sigPartS_2697,pkSess_2689) <> true) then
                                                            0
                                                        else
                                                            {2892}event endCli(Sess,Cli,PartS_2696)
                                                    )
                                                    else
                                                        {2893}let v_2698: bool = (Sess = B) in
                                                        (
                                                            {2894}if v_2698 then
                                                            (
                                                                {2895}let pkSess_2699: bitstring = pub(skB) in
                                                                {2896}out(c, GetEndpointRequest);
                                                                {2897}in(c, (SPs_2700: bitstring,=Sign,UP_2701: bitstring,=pkSess_2699));
                                                                {2898}new SPc_2702: bitstring;
                                                                {2899}new Nc_2703: bitstring;
                                                                {2900}let gNc_2704: bitstring = exp(g,Nc_2703) in
                                                                {2901}let m1_2705: bitstring = (SPc_2702,gNc_2704) in
                                                                {2902}event beginCli(Cli,Sess,gNc_2704);
                                                                {2903}out(c, (pkCli_2482,m1_2705,sign(m1_2705,skCli_2481)));
                                                                {2904}in(c, (PartS_2706: bitstring,sigPartS_2707: bitstring));
                                                                {2905}if (verify(PartS_2706,sigPartS_2707,pkSess_2699) <> true) then
                                                                    0
                                                                else
                                                                    {2906}event endCli(Sess,Cli,PartS_2706)
                                                            )
                                                            else
                                                                {2907}let v_2708: bool = (Sess = C) in
                                                                (
                                                                    {2908}if v_2708 then
                                                                    (
                                                                        {2909}let pkSess_2709: bitstring = pub(skC) in
                                                                        {2910}out(c, GetEndpointRequest);
                                                                        {2911}in(c, (SPs_2710: bitstring,=Sign,UP_2711: bitstring,=pkSess_2709));
                                                                        {2912}new SPc_2712: bitstring;
                                                                        {2913}new Nc_2713: bitstring;
                                                                        {2914}let gNc_2714: bitstring = exp(g,Nc_2713) in
                                                                        {2915}let m1_2715: bitstring = (SPc_2712,gNc_2714) in
                                                                        {2916}event beginCli(Cli,Sess,gNc_2714);
                                                                        {2917}out(c, (pkCli_2482,m1_2715,sign(m1_2715,skCli_2481)));
                                                                        {2918}in(c, (PartS_2716: bitstring,sigPartS_2717: bitstring));
                                                                        {2919}if (verify(PartS_2716,sigPartS_2717,pkSess_2709) <> true) then
                                                                            0
                                                                        else
                                                                            {2920}event endCli(Sess,Cli,PartS_2716)
                                                                    )
                                                                    else
                                                                        {2921}let pkSess_2718: bitstring = pub(skI) in
                                                                        {2922}out(c, GetEndpointRequest);
                                                                        {2923}in(c, (SPs_2719: bitstring,=Sign,UP_2720: bitstring,=pkSess_2718));
                                                                        {2924}new SPc_2721: bitstring;
                                                                        {2925}new Nc_2722: bitstring;
                                                                        {2926}let gNc_2723: bitstring = exp(g,Nc_2722) in
                                                                        {2927}let m1_2724: bitstring = (SPc_2721,gNc_2723) in
                                                                        {2928}event beginCli(Cli,Sess,gNc_2723);
                                                                        {2929}out(c, (pkCli_2482,m1_2724,sign(m1_2724,skCli_2481)));
                                                                        {2930}in(c, (PartS_2725: bitstring,sigPartS_2726: bitstring));
                                                                        {2931}if (verify(PartS_2725,sigPartS_2726,pkSess_2718) <> true) then
                                                                            0
                                                                        else
                                                                            {2932}event endCli(Sess,Cli,PartS_2725)
                                                                )
                                                                else
                                                                    {2933}let pkSess_2727: bitstring = fail-any in
                                                                    {2934}out(c, GetEndpointRequest);
                                                                    {2935}in(c, (SPs_2728: bitstring,=Sign,UP_2729: bitstring,=pkSess_2727));
                                                                    {2936}new SPc_2730: bitstring;
                                                                    {2937}new Nc_2731: bitstring;
                                                                    {2938}let gNc_2732: bitstring = exp(g,Nc_2731) in
                                                                    {2939}let m1_2733: bitstring = (SPc_2730,gNc_2732) in
                                                                    {2940}event beginCli(Cli,Sess,gNc_2732);
                                                                    {2941}out(c, (pkCli_2482,m1_2733,sign(m1_2733,skCli_2481)));
                                                                    {2942}in(c, (PartS_2734: bitstring,sigPartS_2735: bitstring));
                                                                    {2943}if (verify(PartS_2734,sigPartS_2735,pkSess_2727) <> true) then
                                                                        0
                                                                    else
                                                                        {2944}event endCli(Sess,Cli,PartS_2734)
                                                        )
                                                        else
                                                            {2945}let pkSess_2736: bitstring = fail-any in
                                                            {2946}out(c, GetEndpointRequest);
                                                            {2947}in(c, (SPs_2737: bitstring,=Sign,UP_2738: bitstring,=pkSess_2736));
                                                            {2948}new SPc_2739: bitstring;
                                                            {2949}new Nc_2740: bitstring;
                                                            {2950}let gNc_2741: bitstring = exp(g,Nc_2740) in
                                                            {2951}let m1_2742: bitstring = (SPc_2739,gNc_2741) in
                                                            {2952}event beginCli(Cli,Sess,gNc_2741);
                                                            {2953}out(c, (pkCli_2482,m1_2742,sign(m1_2742,skCli_2481)));
                                                            {2954}in(c, (PartS_2743: bitstring,sigPartS_2744: bitstring));
                                                            {2955}if (verify(PartS_2743,sigPartS_2744,pkSess_2736) <> true) then
                                                                0
                                                            else
                                                                {2956}event endCli(Sess,Cli,PartS_2743)
                                                )
                                                else
                                                    {2957}let pkSess_2745: bitstring = fail-any in
                                                    {2958}out(c, GetEndpointRequest);
                                                    {2959}in(c, (SPs_2746: bitstring,=Sign,UP_2747: bitstring,=pkSess_2745));
                                                    {2960}new SPc_2748: bitstring;
                                                    {2961}new Nc_2749: bitstring;
                                                    {2962}let gNc_2750: bitstring = exp(g,Nc_2749) in
                                                    {2963}let m1_2751: bitstring = (SPc_2748,gNc_2750) in
                                                    {2964}event beginCli(Cli,Sess,gNc_2750);
                                                    {2965}out(c, (pkCli_2482,m1_2751,sign(m1_2751,skCli_2481)));
                                                    {2966}in(c, (PartS_2752: bitstring,sigPartS_2753: bitstring));
                                                    {2967}if (verify(PartS_2752,sigPartS_2753,pkSess_2745) <> true) then
                                                        0
                                                    else
                                                        {2968}event endCli(Sess,Cli,PartS_2752)
                                        )
                                        else
                                            {2969}let pkDisco_2754: bitstring = fail-any in
                                            {2970}let v_2755: bool = (Sess = A) in
                                            (
                                                {2971}if v_2755 then
                                                (
                                                    {2972}let pkSess_2756: bitstring = pub(skA) in
                                                    {2973}out(c, GetEndpointRequest);
                                                    {2974}in(c, (SPs_2757: bitstring,=Sign,UP_2758: bitstring,=pkSess_2756));
                                                    {2975}new SPc_2759: bitstring;
                                                    {2976}new Nc_2760: bitstring;
                                                    {2977}let gNc_2761: bitstring = exp(g,Nc_2760) in
                                                    {2978}let m1_2762: bitstring = (SPc_2759,gNc_2761) in
                                                    {2979}event beginCli(Cli,Sess,gNc_2761);
                                                    {2980}out(c, (pkCli_2482,m1_2762,sign(m1_2762,skCli_2481)));
                                                    {2981}in(c, (PartS_2763: bitstring,sigPartS_2764: bitstring));
                                                    {2982}if (verify(PartS_2763,sigPartS_2764,pkSess_2756) <> true) then
                                                        0
                                                    else
                                                        {2983}event endCli(Sess,Cli,PartS_2763)
                                                )
                                                else
                                                    {2984}let v_2765: bool = (Sess = B) in
                                                    (
                                                        {2985}if v_2765 then
                                                        (
                                                            {2986}let pkSess_2766: bitstring = pub(skB) in
                                                            {2987}out(c, GetEndpointRequest);
                                                            {2988}in(c, (SPs_2767: bitstring,=Sign,UP_2768: bitstring,=pkSess_2766));
                                                            {2989}new SPc_2769: bitstring;
                                                            {2990}new Nc_2770: bitstring;
                                                            {2991}let gNc_2771: bitstring = exp(g,Nc_2770) in
                                                            {2992}let m1_2772: bitstring = (SPc_2769,gNc_2771) in
                                                            {2993}event beginCli(Cli,Sess,gNc_2771);
                                                            {2994}out(c, (pkCli_2482,m1_2772,sign(m1_2772,skCli_2481)));
                                                            {2995}in(c, (PartS_2773: bitstring,sigPartS_2774: bitstring));
                                                            {2996}if (verify(PartS_2773,sigPartS_2774,pkSess_2766) <> true) then
                                                                0
                                                            else
                                                                {2997}event endCli(Sess,Cli,PartS_2773)
                                                        )
                                                        else
                                                            {2998}let v_2775: bool = (Sess = C) in
                                                            (
                                                                {2999}if v_2775 then
                                                                (
                                                                    {3000}let pkSess_2776: bitstring = pub(skC) in
                                                                    {3001}out(c, GetEndpointRequest);
                                                                    {3002}in(c, (SPs_2777: bitstring,=Sign,UP_2778: bitstring,=pkSess_2776));
                                                                    {3003}new SPc_2779: bitstring;
                                                                    {3004}new Nc_2780: bitstring;
                                                                    {3005}let gNc_2781: bitstring = exp(g,Nc_2780) in
                                                                    {3006}let m1_2782: bitstring = (SPc_2779,gNc_2781) in
                                                                    {3007}event beginCli(Cli,Sess,gNc_2781);
                                                                    {3008}out(c, (pkCli_2482,m1_2782,sign(m1_2782,skCli_2481)));
                                                                    {3009}in(c, (PartS_2783: bitstring,sigPartS_2784: bitstring));
                                                                    {3010}if (verify(PartS_2783,sigPartS_2784,pkSess_2776) <> true) then
                                                                        0
                                                                    else
                                                                        {3011}event endCli(Sess,Cli,PartS_2783)
                                                                )
                                                                else
                                                                    {3012}let pkSess_2785: bitstring = pub(skI) in
                                                                    {3013}out(c, GetEndpointRequest);
                                                                    {3014}in(c, (SPs_2786: bitstring,=Sign,UP_2787: bitstring,=pkSess_2785));
                                                                    {3015}new SPc_2788: bitstring;
                                                                    {3016}new Nc_2789: bitstring;
                                                                    {3017}let gNc_2790: bitstring = exp(g,Nc_2789) in
                                                                    {3018}let m1_2791: bitstring = (SPc_2788,gNc_2790) in
                                                                    {3019}event beginCli(Cli,Sess,gNc_2790);
                                                                    {3020}out(c, (pkCli_2482,m1_2791,sign(m1_2791,skCli_2481)));
                                                                    {3021}in(c, (PartS_2792: bitstring,sigPartS_2793: bitstring));
                                                                    {3022}if (verify(PartS_2792,sigPartS_2793,pkSess_2785) <> true) then
                                                                        0
                                                                    else
                                                                        {3023}event endCli(Sess,Cli,PartS_2792)
                                                            )
                                                            else
                                                                {3024}let pkSess_2794: bitstring = fail-any in
                                                                {3025}out(c, GetEndpointRequest);
                                                                {3026}in(c, (SPs_2795: bitstring,=Sign,UP_2796: bitstring,=pkSess_2794));
                                                                {3027}new SPc_2797: bitstring;
                                                                {3028}new Nc_2798: bitstring;
                                                                {3029}let gNc_2799: bitstring = exp(g,Nc_2798) in
                                                                {3030}let m1_2800: bitstring = (SPc_2797,gNc_2799) in
                                                                {3031}event beginCli(Cli,Sess,gNc_2799);
                                                                {3032}out(c, (pkCli_2482,m1_2800,sign(m1_2800,skCli_2481)));
                                                                {3033}in(c, (PartS_2801: bitstring,sigPartS_2802: bitstring));
                                                                {3034}if (verify(PartS_2801,sigPartS_2802,pkSess_2794) <> true) then
                                                                    0
                                                                else
                                                                    {3035}event endCli(Sess,Cli,PartS_2801)
                                                    )
                                                    else
                                                        {3036}let pkSess_2803: bitstring = fail-any in
                                                        {3037}out(c, GetEndpointRequest);
                                                        {3038}in(c, (SPs_2804: bitstring,=Sign,UP_2805: bitstring,=pkSess_2803));
                                                        {3039}new SPc_2806: bitstring;
                                                        {3040}new Nc_2807: bitstring;
                                                        {3041}let gNc_2808: bitstring = exp(g,Nc_2807) in
                                                        {3042}let m1_2809: bitstring = (SPc_2806,gNc_2808) in
                                                        {3043}event beginCli(Cli,Sess,gNc_2808);
                                                        {3044}out(c, (pkCli_2482,m1_2809,sign(m1_2809,skCli_2481)));
                                                        {3045}in(c, (PartS_2810: bitstring,sigPartS_2811: bitstring));
                                                        {3046}if (verify(PartS_2810,sigPartS_2811,pkSess_2803) <> true) then
                                                            0
                                                        else
                                                            {3047}event endCli(Sess,Cli,PartS_2810)
                                            )
                                            else
                                                {3048}let pkSess_2812: bitstring = fail-any in
                                                {3049}out(c, GetEndpointRequest);
                                                {3050}in(c, (SPs_2813: bitstring,=Sign,UP_2814: bitstring,=pkSess_2812));
                                                {3051}new SPc_2815: bitstring;
                                                {3052}new Nc_2816: bitstring;
                                                {3053}let gNc_2817: bitstring = exp(g,Nc_2816) in
                                                {3054}let m1_2818: bitstring = (SPc_2815,gNc_2817) in
                                                {3055}event beginCli(Cli,Sess,gNc_2817);
                                                {3056}out(c, (pkCli_2482,m1_2818,sign(m1_2818,skCli_2481)));
                                                {3057}in(c, (PartS_2819: bitstring,sigPartS_2820: bitstring));
                                                {3058}if (verify(PartS_2819,sigPartS_2820,pkSess_2812) <> true) then
                                                    0
                                                else
                                                    {3059}event endCli(Sess,Cli,PartS_2819)
                                )
                                else
                                    {3060}let pkDisco_2821: bitstring = fail-any in
                                    {3061}let v_2822: bool = (Sess = A) in
                                    (
                                        {3062}if v_2822 then
                                        (
                                            {3063}let pkSess_2823: bitstring = pub(skA) in
                                            {3064}out(c, GetEndpointRequest);
                                            {3065}in(c, (SPs_2824: bitstring,=Sign,UP_2825: bitstring,=pkSess_2823));
                                            {3066}new SPc_2826: bitstring;
                                            {3067}new Nc_2827: bitstring;
                                            {3068}let gNc_2828: bitstring = exp(g,Nc_2827) in
                                            {3069}let m1_2829: bitstring = (SPc_2826,gNc_2828) in
                                            {3070}event beginCli(Cli,Sess,gNc_2828);
                                            {3071}out(c, (pkCli_2482,m1_2829,sign(m1_2829,skCli_2481)));
                                            {3072}in(c, (PartS_2830: bitstring,sigPartS_2831: bitstring));
                                            {3073}if (verify(PartS_2830,sigPartS_2831,pkSess_2823) <> true) then
                                                0
                                            else
                                                {3074}event endCli(Sess,Cli,PartS_2830)
                                        )
                                        else
                                            {3075}let v_2832: bool = (Sess = B) in
                                            (
                                                {3076}if v_2832 then
                                                (
                                                    {3077}let pkSess_2833: bitstring = pub(skB) in
                                                    {3078}out(c, GetEndpointRequest);
                                                    {3079}in(c, (SPs_2834: bitstring,=Sign,UP_2835: bitstring,=pkSess_2833));
                                                    {3080}new SPc_2836: bitstring;
                                                    {3081}new Nc_2837: bitstring;
                                                    {3082}let gNc_2838: bitstring = exp(g,Nc_2837) in
                                                    {3083}let m1_2839: bitstring = (SPc_2836,gNc_2838) in
                                                    {3084}event beginCli(Cli,Sess,gNc_2838);
                                                    {3085}out(c, (pkCli_2482,m1_2839,sign(m1_2839,skCli_2481)));
                                                    {3086}in(c, (PartS_2840: bitstring,sigPartS_2841: bitstring));
                                                    {3087}if (verify(PartS_2840,sigPartS_2841,pkSess_2833) <> true) then
                                                        0
                                                    else
                                                        {3088}event endCli(Sess,Cli,PartS_2840)
                                                )
                                                else
                                                    {3089}let v_2842: bool = (Sess = C) in
                                                    (
                                                        {3090}if v_2842 then
                                                        (
                                                            {3091}let pkSess_2843: bitstring = pub(skC) in
                                                            {3092}out(c, GetEndpointRequest);
                                                            {3093}in(c, (SPs_2844: bitstring,=Sign,UP_2845: bitstring,=pkSess_2843));
                                                            {3094}new SPc_2846: bitstring;
                                                            {3095}new Nc_2847: bitstring;
                                                            {3096}let gNc_2848: bitstring = exp(g,Nc_2847) in
                                                            {3097}let m1_2849: bitstring = (SPc_2846,gNc_2848) in
                                                            {3098}event beginCli(Cli,Sess,gNc_2848);
                                                            {3099}out(c, (pkCli_2482,m1_2849,sign(m1_2849,skCli_2481)));
                                                            {3100}in(c, (PartS_2850: bitstring,sigPartS_2851: bitstring));
                                                            {3101}if (verify(PartS_2850,sigPartS_2851,pkSess_2843) <> true) then
                                                                0
                                                            else
                                                                {3102}event endCli(Sess,Cli,PartS_2850)
                                                        )
                                                        else
                                                            {3103}let pkSess_2852: bitstring = pub(skI) in
                                                            {3104}out(c, GetEndpointRequest);
                                                            {3105}in(c, (SPs_2853: bitstring,=Sign,UP_2854: bitstring,=pkSess_2852));
                                                            {3106}new SPc_2855: bitstring;
                                                            {3107}new Nc_2856: bitstring;
                                                            {3108}let gNc_2857: bitstring = exp(g,Nc_2856) in
                                                            {3109}let m1_2858: bitstring = (SPc_2855,gNc_2857) in
                                                            {3110}event beginCli(Cli,Sess,gNc_2857);
                                                            {3111}out(c, (pkCli_2482,m1_2858,sign(m1_2858,skCli_2481)));
                                                            {3112}in(c, (PartS_2859: bitstring,sigPartS_2860: bitstring));
                                                            {3113}if (verify(PartS_2859,sigPartS_2860,pkSess_2852) <> true) then
                                                                0
                                                            else
                                                                {3114}event endCli(Sess,Cli,PartS_2859)
                                                    )
                                                    else
                                                        {3115}let pkSess_2861: bitstring = fail-any in
                                                        {3116}out(c, GetEndpointRequest);
                                                        {3117}in(c, (SPs_2862: bitstring,=Sign,UP_2863: bitstring,=pkSess_2861));
                                                        {3118}new SPc_2864: bitstring;
                                                        {3119}new Nc_2865: bitstring;
                                                        {3120}let gNc_2866: bitstring = exp(g,Nc_2865) in
                                                        {3121}let m1_2867: bitstring = (SPc_2864,gNc_2866) in
                                                        {3122}event beginCli(Cli,Sess,gNc_2866);
                                                        {3123}out(c, (pkCli_2482,m1_2867,sign(m1_2867,skCli_2481)));
                                                        {3124}in(c, (PartS_2868: bitstring,sigPartS_2869: bitstring));
                                                        {3125}if (verify(PartS_2868,sigPartS_2869,pkSess_2861) <> true) then
                                                            0
                                                        else
                                                            {3126}event endCli(Sess,Cli,PartS_2868)
                                            )
                                            else
                                                {3127}let pkSess_2870: bitstring = fail-any in
                                                {3128}out(c, GetEndpointRequest);
                                                {3129}in(c, (SPs_2871: bitstring,=Sign,UP_2872: bitstring,=pkSess_2870));
                                                {3130}new SPc_2873: bitstring;
                                                {3131}new Nc_2874: bitstring;
                                                {3132}let gNc_2875: bitstring = exp(g,Nc_2874) in
                                                {3133}let m1_2876: bitstring = (SPc_2873,gNc_2875) in
                                                {3134}event beginCli(Cli,Sess,gNc_2875);
                                                {3135}out(c, (pkCli_2482,m1_2876,sign(m1_2876,skCli_2481)));
                                                {3136}in(c, (PartS_2877: bitstring,sigPartS_2878: bitstring));
                                                {3137}if (verify(PartS_2877,sigPartS_2878,pkSess_2870) <> true) then
                                                    0
                                                else
                                                    {3138}event endCli(Sess,Cli,PartS_2877)
                                    )
                                    else
                                        {3139}let pkSess_2879: bitstring = fail-any in
                                        {3140}out(c, GetEndpointRequest);
                                        {3141}in(c, (SPs_2880: bitstring,=Sign,UP_2881: bitstring,=pkSess_2879));
                                        {3142}new SPc_2882: bitstring;
                                        {3143}new Nc_2883: bitstring;
                                        {3144}let gNc_2884: bitstring = exp(g,Nc_2883) in
                                        {3145}let m1_2885: bitstring = (SPc_2882,gNc_2884) in
                                        {3146}event beginCli(Cli,Sess,gNc_2884);
                                        {3147}out(c, (pkCli_2482,m1_2885,sign(m1_2885,skCli_2481)));
                                        {3148}in(c, (PartS_2886: bitstring,sigPartS_2887: bitstring));
                                        {3149}if (verify(PartS_2886,sigPartS_2887,pkSess_2879) <> true) then
                                            0
                                        else
                                            {3150}event endCli(Sess,Cli,PartS_2886)
                        )
                        else
                            {3151}let pkDisco_2888: bitstring = fail-any in
                            {3152}let v_2889: bool = (Sess = A) in
                            (
                                {3153}if v_2889 then
                                (
                                    {3154}let pkSess_2890: bitstring = pub(skA) in
                                    {3155}out(c, GetEndpointRequest);
                                    {3156}in(c, (SPs_2891: bitstring,=Sign,UP_2892: bitstring,=pkSess_2890));
                                    {3157}new SPc_2893: bitstring;
                                    {3158}new Nc_2894: bitstring;
                                    {3159}let gNc_2895: bitstring = exp(g,Nc_2894) in
                                    {3160}let m1_2896: bitstring = (SPc_2893,gNc_2895) in
                                    {3161}event beginCli(Cli,Sess,gNc_2895);
                                    {3162}out(c, (pkCli_2482,m1_2896,sign(m1_2896,skCli_2481)));
                                    {3163}in(c, (PartS_2897: bitstring,sigPartS_2898: bitstring));
                                    {3164}if (verify(PartS_2897,sigPartS_2898,pkSess_2890) <> true) then
                                        0
                                    else
                                        {3165}event endCli(Sess,Cli,PartS_2897)
                                )
                                else
                                    {3166}let v_2899: bool = (Sess = B) in
                                    (
                                        {3167}if v_2899 then
                                        (
                                            {3168}let pkSess_2900: bitstring = pub(skB) in
                                            {3169}out(c, GetEndpointRequest);
                                            {3170}in(c, (SPs_2901: bitstring,=Sign,UP_2902: bitstring,=pkSess_2900));
                                            {3171}new SPc_2903: bitstring;
                                            {3172}new Nc_2904: bitstring;
                                            {3173}let gNc_2905: bitstring = exp(g,Nc_2904) in
                                            {3174}let m1_2906: bitstring = (SPc_2903,gNc_2905) in
                                            {3175}event beginCli(Cli,Sess,gNc_2905);
                                            {3176}out(c, (pkCli_2482,m1_2906,sign(m1_2906,skCli_2481)));
                                            {3177}in(c, (PartS_2907: bitstring,sigPartS_2908: bitstring));
                                            {3178}if (verify(PartS_2907,sigPartS_2908,pkSess_2900) <> true) then
                                                0
                                            else
                                                {3179}event endCli(Sess,Cli,PartS_2907)
                                        )
                                        else
                                            {3180}let v_2909: bool = (Sess = C) in
                                            (
                                                {3181}if v_2909 then
                                                (
                                                    {3182}let pkSess_2910: bitstring = pub(skC) in
                                                    {3183}out(c, GetEndpointRequest);
                                                    {3184}in(c, (SPs_2911: bitstring,=Sign,UP_2912: bitstring,=pkSess_2910));
                                                    {3185}new SPc_2913: bitstring;
                                                    {3186}new Nc_2914: bitstring;
                                                    {3187}let gNc_2915: bitstring = exp(g,Nc_2914) in
                                                    {3188}let m1_2916: bitstring = (SPc_2913,gNc_2915) in
                                                    {3189}event beginCli(Cli,Sess,gNc_2915);
                                                    {3190}out(c, (pkCli_2482,m1_2916,sign(m1_2916,skCli_2481)));
                                                    {3191}in(c, (PartS_2917: bitstring,sigPartS_2918: bitstring));
                                                    {3192}if (verify(PartS_2917,sigPartS_2918,pkSess_2910) <> true) then
                                                        0
                                                    else
                                                        {3193}event endCli(Sess,Cli,PartS_2917)
                                                )
                                                else
                                                    {3194}let pkSess_2919: bitstring = pub(skI) in
                                                    {3195}out(c, GetEndpointRequest);
                                                    {3196}in(c, (SPs_2920: bitstring,=Sign,UP_2921: bitstring,=pkSess_2919));
                                                    {3197}new SPc_2922: bitstring;
                                                    {3198}new Nc_2923: bitstring;
                                                    {3199}let gNc_2924: bitstring = exp(g,Nc_2923) in
                                                    {3200}let m1_2925: bitstring = (SPc_2922,gNc_2924) in
                                                    {3201}event beginCli(Cli,Sess,gNc_2924);
                                                    {3202}out(c, (pkCli_2482,m1_2925,sign(m1_2925,skCli_2481)));
                                                    {3203}in(c, (PartS_2926: bitstring,sigPartS_2927: bitstring));
                                                    {3204}if (verify(PartS_2926,sigPartS_2927,pkSess_2919) <> true) then
                                                        0
                                                    else
                                                        {3205}event endCli(Sess,Cli,PartS_2926)
                                            )
                                            else
                                                {3206}let pkSess_2928: bitstring = fail-any in
                                                {3207}out(c, GetEndpointRequest);
                                                {3208}in(c, (SPs_2929: bitstring,=Sign,UP_2930: bitstring,=pkSess_2928));
                                                {3209}new SPc_2931: bitstring;
                                                {3210}new Nc_2932: bitstring;
                                                {3211}let gNc_2933: bitstring = exp(g,Nc_2932) in
                                                {3212}let m1_2934: bitstring = (SPc_2931,gNc_2933) in
                                                {3213}event beginCli(Cli,Sess,gNc_2933);
                                                {3214}out(c, (pkCli_2482,m1_2934,sign(m1_2934,skCli_2481)));
                                                {3215}in(c, (PartS_2935: bitstring,sigPartS_2936: bitstring));
                                                {3216}if (verify(PartS_2935,sigPartS_2936,pkSess_2928) <> true) then
                                                    0
                                                else
                                                    {3217}event endCli(Sess,Cli,PartS_2935)
                                    )
                                    else
                                        {3218}let pkSess_2937: bitstring = fail-any in
                                        {3219}out(c, GetEndpointRequest);
                                        {3220}in(c, (SPs_2938: bitstring,=Sign,UP_2939: bitstring,=pkSess_2937));
                                        {3221}new SPc_2940: bitstring;
                                        {3222}new Nc_2941: bitstring;
                                        {3223}let gNc_2942: bitstring = exp(g,Nc_2941) in
                                        {3224}let m1_2943: bitstring = (SPc_2940,gNc_2942) in
                                        {3225}event beginCli(Cli,Sess,gNc_2942);
                                        {3226}out(c, (pkCli_2482,m1_2943,sign(m1_2943,skCli_2481)));
                                        {3227}in(c, (PartS_2944: bitstring,sigPartS_2945: bitstring));
                                        {3228}if (verify(PartS_2944,sigPartS_2945,pkSess_2937) <> true) then
                                            0
                                        else
                                            {3229}event endCli(Sess,Cli,PartS_2944)
                            )
                            else
                                {3230}let pkSess_2946: bitstring = fail-any in
                                {3231}out(c, GetEndpointRequest);
                                {3232}in(c, (SPs_2947: bitstring,=Sign,UP_2948: bitstring,=pkSess_2946));
                                {3233}new SPc_2949: bitstring;
                                {3234}new Nc_2950: bitstring;
                                {3235}let gNc_2951: bitstring = exp(g,Nc_2950) in
                                {3236}let m1_2952: bitstring = (SPc_2949,gNc_2951) in
                                {3237}event beginCli(Cli,Sess,gNc_2951);
                                {3238}out(c, (pkCli_2482,m1_2952,sign(m1_2952,skCli_2481)));
                                {3239}in(c, (PartS_2953: bitstring,sigPartS_2954: bitstring));
                                {3240}if (verify(PartS_2953,sigPartS_2954,pkSess_2946) <> true) then
                                    0
                                else
                                    {3241}event endCli(Sess,Cli,PartS_2953)
            )
            else
                {3242}let skCli_2955: bitstring = fail-any in
                {3243}let pkCli_2956: bitstring = pub(skCli_2955) in
                {3244}let v_2957: bool = (Disco = A) in
                (
                    {3245}if v_2957 then
                    (
                        {3246}let pkDisco_2958: bitstring = pub(skA) in
                        {3247}let v_2959: bool = (Sess = A) in
                        (
                            {3248}if v_2959 then
                            (
                                {3249}let pkSess_2960: bitstring = pub(skA) in
                                {3250}out(c, GetEndpointRequest);
                                {3251}in(c, (SPs_2961: bitstring,=Sign,UP_2962: bitstring,=pkSess_2960));
                                {3252}new SPc_2963: bitstring;
                                {3253}new Nc_2964: bitstring;
                                {3254}let gNc_2965: bitstring = exp(g,Nc_2964) in
                                {3255}let m1_2966: bitstring = (SPc_2963,gNc_2965) in
                                {3256}event beginCli(Cli,Sess,gNc_2965);
                                {3257}out(c, (pkCli_2956,m1_2966,sign(m1_2966,skCli_2955)));
                                {3258}in(c, (PartS_2967: bitstring,sigPartS_2968: bitstring));
                                {3259}if (verify(PartS_2967,sigPartS_2968,pkSess_2960) <> true) then
                                    0
                                else
                                    {3260}event endCli(Sess,Cli,PartS_2967)
                            )
                            else
                                {3261}let v_2969: bool = (Sess = B) in
                                (
                                    {3262}if v_2969 then
                                    (
                                        {3263}let pkSess_2970: bitstring = pub(skB) in
                                        {3264}out(c, GetEndpointRequest);
                                        {3265}in(c, (SPs_2971: bitstring,=Sign,UP_2972: bitstring,=pkSess_2970));
                                        {3266}new SPc_2973: bitstring;
                                        {3267}new Nc_2974: bitstring;
                                        {3268}let gNc_2975: bitstring = exp(g,Nc_2974) in
                                        {3269}let m1_2976: bitstring = (SPc_2973,gNc_2975) in
                                        {3270}event beginCli(Cli,Sess,gNc_2975);
                                        {3271}out(c, (pkCli_2956,m1_2976,sign(m1_2976,skCli_2955)));
                                        {3272}in(c, (PartS_2977: bitstring,sigPartS_2978: bitstring));
                                        {3273}if (verify(PartS_2977,sigPartS_2978,pkSess_2970) <> true) then
                                            0
                                        else
                                            {3274}event endCli(Sess,Cli,PartS_2977)
                                    )
                                    else
                                        {3275}let v_2979: bool = (Sess = C) in
                                        (
                                            {3276}if v_2979 then
                                            (
                                                {3277}let pkSess_2980: bitstring = pub(skC) in
                                                {3278}out(c, GetEndpointRequest);
                                                {3279}in(c, (SPs_2981: bitstring,=Sign,UP_2982: bitstring,=pkSess_2980));
                                                {3280}new SPc_2983: bitstring;
                                                {3281}new Nc_2984: bitstring;
                                                {3282}let gNc_2985: bitstring = exp(g,Nc_2984) in
                                                {3283}let m1_2986: bitstring = (SPc_2983,gNc_2985) in
                                                {3284}event beginCli(Cli,Sess,gNc_2985);
                                                {3285}out(c, (pkCli_2956,m1_2986,sign(m1_2986,skCli_2955)));
                                                {3286}in(c, (PartS_2987: bitstring,sigPartS_2988: bitstring));
                                                {3287}if (verify(PartS_2987,sigPartS_2988,pkSess_2980) <> true) then
                                                    0
                                                else
                                                    {3288}event endCli(Sess,Cli,PartS_2987)
                                            )
                                            else
                                                {3289}let pkSess_2989: bitstring = pub(skI) in
                                                {3290}out(c, GetEndpointRequest);
                                                {3291}in(c, (SPs_2990: bitstring,=Sign,UP_2991: bitstring,=pkSess_2989));
                                                {3292}new SPc_2992: bitstring;
                                                {3293}new Nc_2993: bitstring;
                                                {3294}let gNc_2994: bitstring = exp(g,Nc_2993) in
                                                {3295}let m1_2995: bitstring = (SPc_2992,gNc_2994) in
                                                {3296}event beginCli(Cli,Sess,gNc_2994);
                                                {3297}out(c, (pkCli_2956,m1_2995,sign(m1_2995,skCli_2955)));
                                                {3298}in(c, (PartS_2996: bitstring,sigPartS_2997: bitstring));
                                                {3299}if (verify(PartS_2996,sigPartS_2997,pkSess_2989) <> true) then
                                                    0
                                                else
                                                    {3300}event endCli(Sess,Cli,PartS_2996)
                                        )
                                        else
                                            {3301}let pkSess_2998: bitstring = fail-any in
                                            {3302}out(c, GetEndpointRequest);
                                            {3303}in(c, (SPs_2999: bitstring,=Sign,UP_3000: bitstring,=pkSess_2998));
                                            {3304}new SPc_3001: bitstring;
                                            {3305}new Nc_3002: bitstring;
                                            {3306}let gNc_3003: bitstring = exp(g,Nc_3002) in
                                            {3307}let m1_3004: bitstring = (SPc_3001,gNc_3003) in
                                            {3308}event beginCli(Cli,Sess,gNc_3003);
                                            {3309}out(c, (pkCli_2956,m1_3004,sign(m1_3004,skCli_2955)));
                                            {3310}in(c, (PartS_3005: bitstring,sigPartS_3006: bitstring));
                                            {3311}if (verify(PartS_3005,sigPartS_3006,pkSess_2998) <> true) then
                                                0
                                            else
                                                {3312}event endCli(Sess,Cli,PartS_3005)
                                )
                                else
                                    {3313}let pkSess_3007: bitstring = fail-any in
                                    {3314}out(c, GetEndpointRequest);
                                    {3315}in(c, (SPs_3008: bitstring,=Sign,UP_3009: bitstring,=pkSess_3007));
                                    {3316}new SPc_3010: bitstring;
                                    {3317}new Nc_3011: bitstring;
                                    {3318}let gNc_3012: bitstring = exp(g,Nc_3011) in
                                    {3319}let m1_3013: bitstring = (SPc_3010,gNc_3012) in
                                    {3320}event beginCli(Cli,Sess,gNc_3012);
                                    {3321}out(c, (pkCli_2956,m1_3013,sign(m1_3013,skCli_2955)));
                                    {3322}in(c, (PartS_3014: bitstring,sigPartS_3015: bitstring));
                                    {3323}if (verify(PartS_3014,sigPartS_3015,pkSess_3007) <> true) then
                                        0
                                    else
                                        {3324}event endCli(Sess,Cli,PartS_3014)
                        )
                        else
                            {3325}let pkSess_3016: bitstring = fail-any in
                            {3326}out(c, GetEndpointRequest);
                            {3327}in(c, (SPs_3017: bitstring,=Sign,UP_3018: bitstring,=pkSess_3016));
                            {3328}new SPc_3019: bitstring;
                            {3329}new Nc_3020: bitstring;
                            {3330}let gNc_3021: bitstring = exp(g,Nc_3020) in
                            {3331}let m1_3022: bitstring = (SPc_3019,gNc_3021) in
                            {3332}event beginCli(Cli,Sess,gNc_3021);
                            {3333}out(c, (pkCli_2956,m1_3022,sign(m1_3022,skCli_2955)));
                            {3334}in(c, (PartS_3023: bitstring,sigPartS_3024: bitstring));
                            {3335}if (verify(PartS_3023,sigPartS_3024,pkSess_3016) <> true) then
                                0
                            else
                                {3336}event endCli(Sess,Cli,PartS_3023)
                    )
                    else
                        {3337}let v_3025: bool = (Disco = B) in
                        (
                            {3338}if v_3025 then
                            (
                                {3339}let pkDisco_3026: bitstring = pub(skB) in
                                {3340}let v_3027: bool = (Sess = A) in
                                (
                                    {3341}if v_3027 then
                                    (
                                        {3342}let pkSess_3028: bitstring = pub(skA) in
                                        {3343}out(c, GetEndpointRequest);
                                        {3344}in(c, (SPs_3029: bitstring,=Sign,UP_3030: bitstring,=pkSess_3028));
                                        {3345}new SPc_3031: bitstring;
                                        {3346}new Nc_3032: bitstring;
                                        {3347}let gNc_3033: bitstring = exp(g,Nc_3032) in
                                        {3348}let m1_3034: bitstring = (SPc_3031,gNc_3033) in
                                        {3349}event beginCli(Cli,Sess,gNc_3033);
                                        {3350}out(c, (pkCli_2956,m1_3034,sign(m1_3034,skCli_2955)));
                                        {3351}in(c, (PartS_3035: bitstring,sigPartS_3036: bitstring));
                                        {3352}if (verify(PartS_3035,sigPartS_3036,pkSess_3028) <> true) then
                                            0
                                        else
                                            {3353}event endCli(Sess,Cli,PartS_3035)
                                    )
                                    else
                                        {3354}let v_3037: bool = (Sess = B) in
                                        (
                                            {3355}if v_3037 then
                                            (
                                                {3356}let pkSess_3038: bitstring = pub(skB) in
                                                {3357}out(c, GetEndpointRequest);
                                                {3358}in(c, (SPs_3039: bitstring,=Sign,UP_3040: bitstring,=pkSess_3038));
                                                {3359}new SPc_3041: bitstring;
                                                {3360}new Nc_3042: bitstring;
                                                {3361}let gNc_3043: bitstring = exp(g,Nc_3042) in
                                                {3362}let m1_3044: bitstring = (SPc_3041,gNc_3043) in
                                                {3363}event beginCli(Cli,Sess,gNc_3043);
                                                {3364}out(c, (pkCli_2956,m1_3044,sign(m1_3044,skCli_2955)));
                                                {3365}in(c, (PartS_3045: bitstring,sigPartS_3046: bitstring));
                                                {3366}if (verify(PartS_3045,sigPartS_3046,pkSess_3038) <> true) then
                                                    0
                                                else
                                                    {3367}event endCli(Sess,Cli,PartS_3045)
                                            )
                                            else
                                                {3368}let v_3047: bool = (Sess = C) in
                                                (
                                                    {3369}if v_3047 then
                                                    (
                                                        {3370}let pkSess_3048: bitstring = pub(skC) in
                                                        {3371}out(c, GetEndpointRequest);
                                                        {3372}in(c, (SPs_3049: bitstring,=Sign,UP_3050: bitstring,=pkSess_3048));
                                                        {3373}new SPc_3051: bitstring;
                                                        {3374}new Nc_3052: bitstring;
                                                        {3375}let gNc_3053: bitstring = exp(g,Nc_3052) in
                                                        {3376}let m1_3054: bitstring = (SPc_3051,gNc_3053) in
                                                        {3377}event beginCli(Cli,Sess,gNc_3053);
                                                        {3378}out(c, (pkCli_2956,m1_3054,sign(m1_3054,skCli_2955)));
                                                        {3379}in(c, (PartS_3055: bitstring,sigPartS_3056: bitstring));
                                                        {3380}if (verify(PartS_3055,sigPartS_3056,pkSess_3048) <> true) then
                                                            0
                                                        else
                                                            {3381}event endCli(Sess,Cli,PartS_3055)
                                                    )
                                                    else
                                                        {3382}let pkSess_3057: bitstring = pub(skI) in
                                                        {3383}out(c, GetEndpointRequest);
                                                        {3384}in(c, (SPs_3058: bitstring,=Sign,UP_3059: bitstring,=pkSess_3057));
                                                        {3385}new SPc_3060: bitstring;
                                                        {3386}new Nc_3061: bitstring;
                                                        {3387}let gNc_3062: bitstring = exp(g,Nc_3061) in
                                                        {3388}let m1_3063: bitstring = (SPc_3060,gNc_3062) in
                                                        {3389}event beginCli(Cli,Sess,gNc_3062);
                                                        {3390}out(c, (pkCli_2956,m1_3063,sign(m1_3063,skCli_2955)));
                                                        {3391}in(c, (PartS_3064: bitstring,sigPartS_3065: bitstring));
                                                        {3392}if (verify(PartS_3064,sigPartS_3065,pkSess_3057) <> true) then
                                                            0
                                                        else
                                                            {3393}event endCli(Sess,Cli,PartS_3064)
                                                )
                                                else
                                                    {3394}let pkSess_3066: bitstring = fail-any in
                                                    {3395}out(c, GetEndpointRequest);
                                                    {3396}in(c, (SPs_3067: bitstring,=Sign,UP_3068: bitstring,=pkSess_3066));
                                                    {3397}new SPc_3069: bitstring;
                                                    {3398}new Nc_3070: bitstring;
                                                    {3399}let gNc_3071: bitstring = exp(g,Nc_3070) in
                                                    {3400}let m1_3072: bitstring = (SPc_3069,gNc_3071) in
                                                    {3401}event beginCli(Cli,Sess,gNc_3071);
                                                    {3402}out(c, (pkCli_2956,m1_3072,sign(m1_3072,skCli_2955)));
                                                    {3403}in(c, (PartS_3073: bitstring,sigPartS_3074: bitstring));
                                                    {3404}if (verify(PartS_3073,sigPartS_3074,pkSess_3066) <> true) then
                                                        0
                                                    else
                                                        {3405}event endCli(Sess,Cli,PartS_3073)
                                        )
                                        else
                                            {3406}let pkSess_3075: bitstring = fail-any in
                                            {3407}out(c, GetEndpointRequest);
                                            {3408}in(c, (SPs_3076: bitstring,=Sign,UP_3077: bitstring,=pkSess_3075));
                                            {3409}new SPc_3078: bitstring;
                                            {3410}new Nc_3079: bitstring;
                                            {3411}let gNc_3080: bitstring = exp(g,Nc_3079) in
                                            {3412}let m1_3081: bitstring = (SPc_3078,gNc_3080) in
                                            {3413}event beginCli(Cli,Sess,gNc_3080);
                                            {3414}out(c, (pkCli_2956,m1_3081,sign(m1_3081,skCli_2955)));
                                            {3415}in(c, (PartS_3082: bitstring,sigPartS_3083: bitstring));
                                            {3416}if (verify(PartS_3082,sigPartS_3083,pkSess_3075) <> true) then
                                                0
                                            else
                                                {3417}event endCli(Sess,Cli,PartS_3082)
                                )
                                else
                                    {3418}let pkSess_3084: bitstring = fail-any in
                                    {3419}out(c, GetEndpointRequest);
                                    {3420}in(c, (SPs_3085: bitstring,=Sign,UP_3086: bitstring,=pkSess_3084));
                                    {3421}new SPc_3087: bitstring;
                                    {3422}new Nc_3088: bitstring;
                                    {3423}let gNc_3089: bitstring = exp(g,Nc_3088) in
                                    {3424}let m1_3090: bitstring = (SPc_3087,gNc_3089) in
                                    {3425}event beginCli(Cli,Sess,gNc_3089);
                                    {3426}out(c, (pkCli_2956,m1_3090,sign(m1_3090,skCli_2955)));
                                    {3427}in(c, (PartS_3091: bitstring,sigPartS_3092: bitstring));
                                    {3428}if (verify(PartS_3091,sigPartS_3092,pkSess_3084) <> true) then
                                        0
                                    else
                                        {3429}event endCli(Sess,Cli,PartS_3091)
                            )
                            else
                                {3430}let v_3093: bool = (Disco = C) in
                                (
                                    {3431}if v_3093 then
                                    (
                                        {3432}let pkDisco_3094: bitstring = pub(skC) in
                                        {3433}let v_3095: bool = (Sess = A) in
                                        (
                                            {3434}if v_3095 then
                                            (
                                                {3435}let pkSess_3096: bitstring = pub(skA) in
                                                {3436}out(c, GetEndpointRequest);
                                                {3437}in(c, (SPs_3097: bitstring,=Sign,UP_3098: bitstring,=pkSess_3096));
                                                {3438}new SPc_3099: bitstring;
                                                {3439}new Nc_3100: bitstring;
                                                {3440}let gNc_3101: bitstring = exp(g,Nc_3100) in
                                                {3441}let m1_3102: bitstring = (SPc_3099,gNc_3101) in
                                                {3442}event beginCli(Cli,Sess,gNc_3101);
                                                {3443}out(c, (pkCli_2956,m1_3102,sign(m1_3102,skCli_2955)));
                                                {3444}in(c, (PartS_3103: bitstring,sigPartS_3104: bitstring));
                                                {3445}if (verify(PartS_3103,sigPartS_3104,pkSess_3096) <> true) then
                                                    0
                                                else
                                                    {3446}event endCli(Sess,Cli,PartS_3103)
                                            )
                                            else
                                                {3447}let v_3105: bool = (Sess = B) in
                                                (
                                                    {3448}if v_3105 then
                                                    (
                                                        {3449}let pkSess_3106: bitstring = pub(skB) in
                                                        {3450}out(c, GetEndpointRequest);
                                                        {3451}in(c, (SPs_3107: bitstring,=Sign,UP_3108: bitstring,=pkSess_3106));
                                                        {3452}new SPc_3109: bitstring;
                                                        {3453}new Nc_3110: bitstring;
                                                        {3454}let gNc_3111: bitstring = exp(g,Nc_3110) in
                                                        {3455}let m1_3112: bitstring = (SPc_3109,gNc_3111) in
                                                        {3456}event beginCli(Cli,Sess,gNc_3111);
                                                        {3457}out(c, (pkCli_2956,m1_3112,sign(m1_3112,skCli_2955)));
                                                        {3458}in(c, (PartS_3113: bitstring,sigPartS_3114: bitstring));
                                                        {3459}if (verify(PartS_3113,sigPartS_3114,pkSess_3106) <> true) then
                                                            0
                                                        else
                                                            {3460}event endCli(Sess,Cli,PartS_3113)
                                                    )
                                                    else
                                                        {3461}let v_3115: bool = (Sess = C) in
                                                        (
                                                            {3462}if v_3115 then
                                                            (
                                                                {3463}let pkSess_3116: bitstring = pub(skC) in
                                                                {3464}out(c, GetEndpointRequest);
                                                                {3465}in(c, (SPs_3117: bitstring,=Sign,UP_3118: bitstring,=pkSess_3116));
                                                                {3466}new SPc_3119: bitstring;
                                                                {3467}new Nc_3120: bitstring;
                                                                {3468}let gNc_3121: bitstring = exp(g,Nc_3120) in
                                                                {3469}let m1_3122: bitstring = (SPc_3119,gNc_3121) in
                                                                {3470}event beginCli(Cli,Sess,gNc_3121);
                                                                {3471}out(c, (pkCli_2956,m1_3122,sign(m1_3122,skCli_2955)));
                                                                {3472}in(c, (PartS_3123: bitstring,sigPartS_3124: bitstring));
                                                                {3473}if (verify(PartS_3123,sigPartS_3124,pkSess_3116) <> true) then
                                                                    0
                                                                else
                                                                    {3474}event endCli(Sess,Cli,PartS_3123)
                                                            )
                                                            else
                                                                {3475}let pkSess_3125: bitstring = pub(skI) in
                                                                {3476}out(c, GetEndpointRequest);
                                                                {3477}in(c, (SPs_3126: bitstring,=Sign,UP_3127: bitstring,=pkSess_3125));
                                                                {3478}new SPc_3128: bitstring;
                                                                {3479}new Nc_3129: bitstring;
                                                                {3480}let gNc_3130: bitstring = exp(g,Nc_3129) in
                                                                {3481}let m1_3131: bitstring = (SPc_3128,gNc_3130) in
                                                                {3482}event beginCli(Cli,Sess,gNc_3130);
                                                                {3483}out(c, (pkCli_2956,m1_3131,sign(m1_3131,skCli_2955)));
                                                                {3484}in(c, (PartS_3132: bitstring,sigPartS_3133: bitstring));
                                                                {3485}if (verify(PartS_3132,sigPartS_3133,pkSess_3125) <> true) then
                                                                    0
                                                                else
                                                                    {3486}event endCli(Sess,Cli,PartS_3132)
                                                        )
                                                        else
                                                            {3487}let pkSess_3134: bitstring = fail-any in
                                                            {3488}out(c, GetEndpointRequest);
                                                            {3489}in(c, (SPs_3135: bitstring,=Sign,UP_3136: bitstring,=pkSess_3134));
                                                            {3490}new SPc_3137: bitstring;
                                                            {3491}new Nc_3138: bitstring;
                                                            {3492}let gNc_3139: bitstring = exp(g,Nc_3138) in
                                                            {3493}let m1_3140: bitstring = (SPc_3137,gNc_3139) in
                                                            {3494}event beginCli(Cli,Sess,gNc_3139);
                                                            {3495}out(c, (pkCli_2956,m1_3140,sign(m1_3140,skCli_2955)));
                                                            {3496}in(c, (PartS_3141: bitstring,sigPartS_3142: bitstring));
                                                            {3497}if (verify(PartS_3141,sigPartS_3142,pkSess_3134) <> true) then
                                                                0
                                                            else
                                                                {3498}event endCli(Sess,Cli,PartS_3141)
                                                )
                                                else
                                                    {3499}let pkSess_3143: bitstring = fail-any in
                                                    {3500}out(c, GetEndpointRequest);
                                                    {3501}in(c, (SPs_3144: bitstring,=Sign,UP_3145: bitstring,=pkSess_3143));
                                                    {3502}new SPc_3146: bitstring;
                                                    {3503}new Nc_3147: bitstring;
                                                    {3504}let gNc_3148: bitstring = exp(g,Nc_3147) in
                                                    {3505}let m1_3149: bitstring = (SPc_3146,gNc_3148) in
                                                    {3506}event beginCli(Cli,Sess,gNc_3148);
                                                    {3507}out(c, (pkCli_2956,m1_3149,sign(m1_3149,skCli_2955)));
                                                    {3508}in(c, (PartS_3150: bitstring,sigPartS_3151: bitstring));
                                                    {3509}if (verify(PartS_3150,sigPartS_3151,pkSess_3143) <> true) then
                                                        0
                                                    else
                                                        {3510}event endCli(Sess,Cli,PartS_3150)
                                        )
                                        else
                                            {3511}let pkSess_3152: bitstring = fail-any in
                                            {3512}out(c, GetEndpointRequest);
                                            {3513}in(c, (SPs_3153: bitstring,=Sign,UP_3154: bitstring,=pkSess_3152));
                                            {3514}new SPc_3155: bitstring;
                                            {3515}new Nc_3156: bitstring;
                                            {3516}let gNc_3157: bitstring = exp(g,Nc_3156) in
                                            {3517}let m1_3158: bitstring = (SPc_3155,gNc_3157) in
                                            {3518}event beginCli(Cli,Sess,gNc_3157);
                                            {3519}out(c, (pkCli_2956,m1_3158,sign(m1_3158,skCli_2955)));
                                            {3520}in(c, (PartS_3159: bitstring,sigPartS_3160: bitstring));
                                            {3521}if (verify(PartS_3159,sigPartS_3160,pkSess_3152) <> true) then
                                                0
                                            else
                                                {3522}event endCli(Sess,Cli,PartS_3159)
                                    )
                                    else
                                        {3523}let pkDisco_3161: bitstring = pub(skI) in
                                        {3524}let v_3162: bool = (Sess = A) in
                                        (
                                            {3525}if v_3162 then
                                            (
                                                {3526}let pkSess_3163: bitstring = pub(skA) in
                                                {3527}out(c, GetEndpointRequest);
                                                {3528}in(c, (SPs_3164: bitstring,=Sign,UP_3165: bitstring,=pkSess_3163));
                                                {3529}new SPc_3166: bitstring;
                                                {3530}new Nc_3167: bitstring;
                                                {3531}let gNc_3168: bitstring = exp(g,Nc_3167) in
                                                {3532}let m1_3169: bitstring = (SPc_3166,gNc_3168) in
                                                {3533}event beginCli(Cli,Sess,gNc_3168);
                                                {3534}out(c, (pkCli_2956,m1_3169,sign(m1_3169,skCli_2955)));
                                                {3535}in(c, (PartS_3170: bitstring,sigPartS_3171: bitstring));
                                                {3536}if (verify(PartS_3170,sigPartS_3171,pkSess_3163) <> true) then
                                                    0
                                                else
                                                    {3537}event endCli(Sess,Cli,PartS_3170)
                                            )
                                            else
                                                {3538}let v_3172: bool = (Sess = B) in
                                                (
                                                    {3539}if v_3172 then
                                                    (
                                                        {3540}let pkSess_3173: bitstring = pub(skB) in
                                                        {3541}out(c, GetEndpointRequest);
                                                        {3542}in(c, (SPs_3174: bitstring,=Sign,UP_3175: bitstring,=pkSess_3173));
                                                        {3543}new SPc_3176: bitstring;
                                                        {3544}new Nc_3177: bitstring;
                                                        {3545}let gNc_3178: bitstring = exp(g,Nc_3177) in
                                                        {3546}let m1_3179: bitstring = (SPc_3176,gNc_3178) in
                                                        {3547}event beginCli(Cli,Sess,gNc_3178);
                                                        {3548}out(c, (pkCli_2956,m1_3179,sign(m1_3179,skCli_2955)));
                                                        {3549}in(c, (PartS_3180: bitstring,sigPartS_3181: bitstring));
                                                        {3550}if (verify(PartS_3180,sigPartS_3181,pkSess_3173) <> true) then
                                                            0
                                                        else
                                                            {3551}event endCli(Sess,Cli,PartS_3180)
                                                    )
                                                    else
                                                        {3552}let v_3182: bool = (Sess = C) in
                                                        (
                                                            {3553}if v_3182 then
                                                            (
                                                                {3554}let pkSess_3183: bitstring = pub(skC) in
                                                                {3555}out(c, GetEndpointRequest);
                                                                {3556}in(c, (SPs_3184: bitstring,=Sign,UP_3185: bitstring,=pkSess_3183));
                                                                {3557}new SPc_3186: bitstring;
                                                                {3558}new Nc_3187: bitstring;
                                                                {3559}let gNc_3188: bitstring = exp(g,Nc_3187) in
                                                                {3560}let m1_3189: bitstring = (SPc_3186,gNc_3188) in
                                                                {3561}event beginCli(Cli,Sess,gNc_3188);
                                                                {3562}out(c, (pkCli_2956,m1_3189,sign(m1_3189,skCli_2955)));
                                                                {3563}in(c, (PartS_3190: bitstring,sigPartS_3191: bitstring));
                                                                {3564}if (verify(PartS_3190,sigPartS_3191,pkSess_3183) <> true) then
                                                                    0
                                                                else
                                                                    {3565}event endCli(Sess,Cli,PartS_3190)
                                                            )
                                                            else
                                                                {3566}let pkSess_3192: bitstring = pub(skI) in
                                                                {3567}out(c, GetEndpointRequest);
                                                                {3568}in(c, (SPs_3193: bitstring,=Sign,UP_3194: bitstring,=pkSess_3192));
                                                                {3569}new SPc_3195: bitstring;
                                                                {3570}new Nc_3196: bitstring;
                                                                {3571}let gNc_3197: bitstring = exp(g,Nc_3196) in
                                                                {3572}let m1_3198: bitstring = (SPc_3195,gNc_3197) in
                                                                {3573}event beginCli(Cli,Sess,gNc_3197);
                                                                {3574}out(c, (pkCli_2956,m1_3198,sign(m1_3198,skCli_2955)));
                                                                {3575}in(c, (PartS_3199: bitstring,sigPartS_3200: bitstring));
                                                                {3576}if (verify(PartS_3199,sigPartS_3200,pkSess_3192) <> true) then
                                                                    0
                                                                else
                                                                    {3577}event endCli(Sess,Cli,PartS_3199)
                                                        )
                                                        else
                                                            {3578}let pkSess_3201: bitstring = fail-any in
                                                            {3579}out(c, GetEndpointRequest);
                                                            {3580}in(c, (SPs_3202: bitstring,=Sign,UP_3203: bitstring,=pkSess_3201));
                                                            {3581}new SPc_3204: bitstring;
                                                            {3582}new Nc_3205: bitstring;
                                                            {3583}let gNc_3206: bitstring = exp(g,Nc_3205) in
                                                            {3584}let m1_3207: bitstring = (SPc_3204,gNc_3206) in
                                                            {3585}event beginCli(Cli,Sess,gNc_3206);
                                                            {3586}out(c, (pkCli_2956,m1_3207,sign(m1_3207,skCli_2955)));
                                                            {3587}in(c, (PartS_3208: bitstring,sigPartS_3209: bitstring));
                                                            {3588}if (verify(PartS_3208,sigPartS_3209,pkSess_3201) <> true) then
                                                                0
                                                            else
                                                                {3589}event endCli(Sess,Cli,PartS_3208)
                                                )
                                                else
                                                    {3590}let pkSess_3210: bitstring = fail-any in
                                                    {3591}out(c, GetEndpointRequest);
                                                    {3592}in(c, (SPs_3211: bitstring,=Sign,UP_3212: bitstring,=pkSess_3210));
                                                    {3593}new SPc_3213: bitstring;
                                                    {3594}new Nc_3214: bitstring;
                                                    {3595}let gNc_3215: bitstring = exp(g,Nc_3214) in
                                                    {3596}let m1_3216: bitstring = (SPc_3213,gNc_3215) in
                                                    {3597}event beginCli(Cli,Sess,gNc_3215);
                                                    {3598}out(c, (pkCli_2956,m1_3216,sign(m1_3216,skCli_2955)));
                                                    {3599}in(c, (PartS_3217: bitstring,sigPartS_3218: bitstring));
                                                    {3600}if (verify(PartS_3217,sigPartS_3218,pkSess_3210) <> true) then
                                                        0
                                                    else
                                                        {3601}event endCli(Sess,Cli,PartS_3217)
                                        )
                                        else
                                            {3602}let pkSess_3219: bitstring = fail-any in
                                            {3603}out(c, GetEndpointRequest);
                                            {3604}in(c, (SPs_3220: bitstring,=Sign,UP_3221: bitstring,=pkSess_3219));
                                            {3605}new SPc_3222: bitstring;
                                            {3606}new Nc_3223: bitstring;
                                            {3607}let gNc_3224: bitstring = exp(g,Nc_3223) in
                                            {3608}let m1_3225: bitstring = (SPc_3222,gNc_3224) in
                                            {3609}event beginCli(Cli,Sess,gNc_3224);
                                            {3610}out(c, (pkCli_2956,m1_3225,sign(m1_3225,skCli_2955)));
                                            {3611}in(c, (PartS_3226: bitstring,sigPartS_3227: bitstring));
                                            {3612}if (verify(PartS_3226,sigPartS_3227,pkSess_3219) <> true) then
                                                0
                                            else
                                                {3613}event endCli(Sess,Cli,PartS_3226)
                                )
                                else
                                    {3614}let pkDisco_3228: bitstring = fail-any in
                                    {3615}let v_3229: bool = (Sess = A) in
                                    (
                                        {3616}if v_3229 then
                                        (
                                            {3617}let pkSess_3230: bitstring = pub(skA) in
                                            {3618}out(c, GetEndpointRequest);
                                            {3619}in(c, (SPs_3231: bitstring,=Sign,UP_3232: bitstring,=pkSess_3230));
                                            {3620}new SPc_3233: bitstring;
                                            {3621}new Nc_3234: bitstring;
                                            {3622}let gNc_3235: bitstring = exp(g,Nc_3234) in
                                            {3623}let m1_3236: bitstring = (SPc_3233,gNc_3235) in
                                            {3624}event beginCli(Cli,Sess,gNc_3235);
                                            {3625}out(c, (pkCli_2956,m1_3236,sign(m1_3236,skCli_2955)));
                                            {3626}in(c, (PartS_3237: bitstring,sigPartS_3238: bitstring));
                                            {3627}if (verify(PartS_3237,sigPartS_3238,pkSess_3230) <> true) then
                                                0
                                            else
                                                {3628}event endCli(Sess,Cli,PartS_3237)
                                        )
                                        else
                                            {3629}let v_3239: bool = (Sess = B) in
                                            (
                                                {3630}if v_3239 then
                                                (
                                                    {3631}let pkSess_3240: bitstring = pub(skB) in
                                                    {3632}out(c, GetEndpointRequest);
                                                    {3633}in(c, (SPs_3241: bitstring,=Sign,UP_3242: bitstring,=pkSess_3240));
                                                    {3634}new SPc_3243: bitstring;
                                                    {3635}new Nc_3244: bitstring;
                                                    {3636}let gNc_3245: bitstring = exp(g,Nc_3244) in
                                                    {3637}let m1_3246: bitstring = (SPc_3243,gNc_3245) in
                                                    {3638}event beginCli(Cli,Sess,gNc_3245);
                                                    {3639}out(c, (pkCli_2956,m1_3246,sign(m1_3246,skCli_2955)));
                                                    {3640}in(c, (PartS_3247: bitstring,sigPartS_3248: bitstring));
                                                    {3641}if (verify(PartS_3247,sigPartS_3248,pkSess_3240) <> true) then
                                                        0
                                                    else
                                                        {3642}event endCli(Sess,Cli,PartS_3247)
                                                )
                                                else
                                                    {3643}let v_3249: bool = (Sess = C) in
                                                    (
                                                        {3644}if v_3249 then
                                                        (
                                                            {3645}let pkSess_3250: bitstring = pub(skC) in
                                                            {3646}out(c, GetEndpointRequest);
                                                            {3647}in(c, (SPs_3251: bitstring,=Sign,UP_3252: bitstring,=pkSess_3250));
                                                            {3648}new SPc_3253: bitstring;
                                                            {3649}new Nc_3254: bitstring;
                                                            {3650}let gNc_3255: bitstring = exp(g,Nc_3254) in
                                                            {3651}let m1_3256: bitstring = (SPc_3253,gNc_3255) in
                                                            {3652}event beginCli(Cli,Sess,gNc_3255);
                                                            {3653}out(c, (pkCli_2956,m1_3256,sign(m1_3256,skCli_2955)));
                                                            {3654}in(c, (PartS_3257: bitstring,sigPartS_3258: bitstring));
                                                            {3655}if (verify(PartS_3257,sigPartS_3258,pkSess_3250) <> true) then
                                                                0
                                                            else
                                                                {3656}event endCli(Sess,Cli,PartS_3257)
                                                        )
                                                        else
                                                            {3657}let pkSess_3259: bitstring = pub(skI) in
                                                            {3658}out(c, GetEndpointRequest);
                                                            {3659}in(c, (SPs_3260: bitstring,=Sign,UP_3261: bitstring,=pkSess_3259));
                                                            {3660}new SPc_3262: bitstring;
                                                            {3661}new Nc_3263: bitstring;
                                                            {3662}let gNc_3264: bitstring = exp(g,Nc_3263) in
                                                            {3663}let m1_3265: bitstring = (SPc_3262,gNc_3264) in
                                                            {3664}event beginCli(Cli,Sess,gNc_3264);
                                                            {3665}out(c, (pkCli_2956,m1_3265,sign(m1_3265,skCli_2955)));
                                                            {3666}in(c, (PartS_3266: bitstring,sigPartS_3267: bitstring));
                                                            {3667}if (verify(PartS_3266,sigPartS_3267,pkSess_3259) <> true) then
                                                                0
                                                            else
                                                                {3668}event endCli(Sess,Cli,PartS_3266)
                                                    )
                                                    else
                                                        {3669}let pkSess_3268: bitstring = fail-any in
                                                        {3670}out(c, GetEndpointRequest);
                                                        {3671}in(c, (SPs_3269: bitstring,=Sign,UP_3270: bitstring,=pkSess_3268));
                                                        {3672}new SPc_3271: bitstring;
                                                        {3673}new Nc_3272: bitstring;
                                                        {3674}let gNc_3273: bitstring = exp(g,Nc_3272) in
                                                        {3675}let m1_3274: bitstring = (SPc_3271,gNc_3273) in
                                                        {3676}event beginCli(Cli,Sess,gNc_3273);
                                                        {3677}out(c, (pkCli_2956,m1_3274,sign(m1_3274,skCli_2955)));
                                                        {3678}in(c, (PartS_3275: bitstring,sigPartS_3276: bitstring));
                                                        {3679}if (verify(PartS_3275,sigPartS_3276,pkSess_3268) <> true) then
                                                            0
                                                        else
                                                            {3680}event endCli(Sess,Cli,PartS_3275)
                                            )
                                            else
                                                {3681}let pkSess_3277: bitstring = fail-any in
                                                {3682}out(c, GetEndpointRequest);
                                                {3683}in(c, (SPs_3278: bitstring,=Sign,UP_3279: bitstring,=pkSess_3277));
                                                {3684}new SPc_3280: bitstring;
                                                {3685}new Nc_3281: bitstring;
                                                {3686}let gNc_3282: bitstring = exp(g,Nc_3281) in
                                                {3687}let m1_3283: bitstring = (SPc_3280,gNc_3282) in
                                                {3688}event beginCli(Cli,Sess,gNc_3282);
                                                {3689}out(c, (pkCli_2956,m1_3283,sign(m1_3283,skCli_2955)));
                                                {3690}in(c, (PartS_3284: bitstring,sigPartS_3285: bitstring));
                                                {3691}if (verify(PartS_3284,sigPartS_3285,pkSess_3277) <> true) then
                                                    0
                                                else
                                                    {3692}event endCli(Sess,Cli,PartS_3284)
                                    )
                                    else
                                        {3693}let pkSess_3286: bitstring = fail-any in
                                        {3694}out(c, GetEndpointRequest);
                                        {3695}in(c, (SPs_3287: bitstring,=Sign,UP_3288: bitstring,=pkSess_3286));
                                        {3696}new SPc_3289: bitstring;
                                        {3697}new Nc_3290: bitstring;
                                        {3698}let gNc_3291: bitstring = exp(g,Nc_3290) in
                                        {3699}let m1_3292: bitstring = (SPc_3289,gNc_3291) in
                                        {3700}event beginCli(Cli,Sess,gNc_3291);
                                        {3701}out(c, (pkCli_2956,m1_3292,sign(m1_3292,skCli_2955)));
                                        {3702}in(c, (PartS_3293: bitstring,sigPartS_3294: bitstring));
                                        {3703}if (verify(PartS_3293,sigPartS_3294,pkSess_3286) <> true) then
                                            0
                                        else
                                            {3704}event endCli(Sess,Cli,PartS_3293)
                        )
                        else
                            {3705}let pkDisco_3295: bitstring = fail-any in
                            {3706}let v_3296: bool = (Sess = A) in
                            (
                                {3707}if v_3296 then
                                (
                                    {3708}let pkSess_3297: bitstring = pub(skA) in
                                    {3709}out(c, GetEndpointRequest);
                                    {3710}in(c, (SPs_3298: bitstring,=Sign,UP_3299: bitstring,=pkSess_3297));
                                    {3711}new SPc_3300: bitstring;
                                    {3712}new Nc_3301: bitstring;
                                    {3713}let gNc_3302: bitstring = exp(g,Nc_3301) in
                                    {3714}let m1_3303: bitstring = (SPc_3300,gNc_3302) in
                                    {3715}event beginCli(Cli,Sess,gNc_3302);
                                    {3716}out(c, (pkCli_2956,m1_3303,sign(m1_3303,skCli_2955)));
                                    {3717}in(c, (PartS_3304: bitstring,sigPartS_3305: bitstring));
                                    {3718}if (verify(PartS_3304,sigPartS_3305,pkSess_3297) <> true) then
                                        0
                                    else
                                        {3719}event endCli(Sess,Cli,PartS_3304)
                                )
                                else
                                    {3720}let v_3306: bool = (Sess = B) in
                                    (
                                        {3721}if v_3306 then
                                        (
                                            {3722}let pkSess_3307: bitstring = pub(skB) in
                                            {3723}out(c, GetEndpointRequest);
                                            {3724}in(c, (SPs_3308: bitstring,=Sign,UP_3309: bitstring,=pkSess_3307));
                                            {3725}new SPc_3310: bitstring;
                                            {3726}new Nc_3311: bitstring;
                                            {3727}let gNc_3312: bitstring = exp(g,Nc_3311) in
                                            {3728}let m1_3313: bitstring = (SPc_3310,gNc_3312) in
                                            {3729}event beginCli(Cli,Sess,gNc_3312);
                                            {3730}out(c, (pkCli_2956,m1_3313,sign(m1_3313,skCli_2955)));
                                            {3731}in(c, (PartS_3314: bitstring,sigPartS_3315: bitstring));
                                            {3732}if (verify(PartS_3314,sigPartS_3315,pkSess_3307) <> true) then
                                                0
                                            else
                                                {3733}event endCli(Sess,Cli,PartS_3314)
                                        )
                                        else
                                            {3734}let v_3316: bool = (Sess = C) in
                                            (
                                                {3735}if v_3316 then
                                                (
                                                    {3736}let pkSess_3317: bitstring = pub(skC) in
                                                    {3737}out(c, GetEndpointRequest);
                                                    {3738}in(c, (SPs_3318: bitstring,=Sign,UP_3319: bitstring,=pkSess_3317));
                                                    {3739}new SPc_3320: bitstring;
                                                    {3740}new Nc_3321: bitstring;
                                                    {3741}let gNc_3322: bitstring = exp(g,Nc_3321) in
                                                    {3742}let m1_3323: bitstring = (SPc_3320,gNc_3322) in
                                                    {3743}event beginCli(Cli,Sess,gNc_3322);
                                                    {3744}out(c, (pkCli_2956,m1_3323,sign(m1_3323,skCli_2955)));
                                                    {3745}in(c, (PartS_3324: bitstring,sigPartS_3325: bitstring));
                                                    {3746}if (verify(PartS_3324,sigPartS_3325,pkSess_3317) <> true) then
                                                        0
                                                    else
                                                        {3747}event endCli(Sess,Cli,PartS_3324)
                                                )
                                                else
                                                    {3748}let pkSess_3326: bitstring = pub(skI) in
                                                    {3749}out(c, GetEndpointRequest);
                                                    {3750}in(c, (SPs_3327: bitstring,=Sign,UP_3328: bitstring,=pkSess_3326));
                                                    {3751}new SPc_3329: bitstring;
                                                    {3752}new Nc_3330: bitstring;
                                                    {3753}let gNc_3331: bitstring = exp(g,Nc_3330) in
                                                    {3754}let m1_3332: bitstring = (SPc_3329,gNc_3331) in
                                                    {3755}event beginCli(Cli,Sess,gNc_3331);
                                                    {3756}out(c, (pkCli_2956,m1_3332,sign(m1_3332,skCli_2955)));
                                                    {3757}in(c, (PartS_3333: bitstring,sigPartS_3334: bitstring));
                                                    {3758}if (verify(PartS_3333,sigPartS_3334,pkSess_3326) <> true) then
                                                        0
                                                    else
                                                        {3759}event endCli(Sess,Cli,PartS_3333)
                                            )
                                            else
                                                {3760}let pkSess_3335: bitstring = fail-any in
                                                {3761}out(c, GetEndpointRequest);
                                                {3762}in(c, (SPs_3336: bitstring,=Sign,UP_3337: bitstring,=pkSess_3335));
                                                {3763}new SPc_3338: bitstring;
                                                {3764}new Nc_3339: bitstring;
                                                {3765}let gNc_3340: bitstring = exp(g,Nc_3339) in
                                                {3766}let m1_3341: bitstring = (SPc_3338,gNc_3340) in
                                                {3767}event beginCli(Cli,Sess,gNc_3340);
                                                {3768}out(c, (pkCli_2956,m1_3341,sign(m1_3341,skCli_2955)));
                                                {3769}in(c, (PartS_3342: bitstring,sigPartS_3343: bitstring));
                                                {3770}if (verify(PartS_3342,sigPartS_3343,pkSess_3335) <> true) then
                                                    0
                                                else
                                                    {3771}event endCli(Sess,Cli,PartS_3342)
                                    )
                                    else
                                        {3772}let pkSess_3344: bitstring = fail-any in
                                        {3773}out(c, GetEndpointRequest);
                                        {3774}in(c, (SPs_3345: bitstring,=Sign,UP_3346: bitstring,=pkSess_3344));
                                        {3775}new SPc_3347: bitstring;
                                        {3776}new Nc_3348: bitstring;
                                        {3777}let gNc_3349: bitstring = exp(g,Nc_3348) in
                                        {3778}let m1_3350: bitstring = (SPc_3347,gNc_3349) in
                                        {3779}event beginCli(Cli,Sess,gNc_3349);
                                        {3780}out(c, (pkCli_2956,m1_3350,sign(m1_3350,skCli_2955)));
                                        {3781}in(c, (PartS_3351: bitstring,sigPartS_3352: bitstring));
                                        {3782}if (verify(PartS_3351,sigPartS_3352,pkSess_3344) <> true) then
                                            0
                                        else
                                            {3783}event endCli(Sess,Cli,PartS_3351)
                            )
                            else
                                {3784}let pkSess_3353: bitstring = fail-any in
                                {3785}out(c, GetEndpointRequest);
                                {3786}in(c, (SPs_3354: bitstring,=Sign,UP_3355: bitstring,=pkSess_3353));
                                {3787}new SPc_3356: bitstring;
                                {3788}new Nc_3357: bitstring;
                                {3789}let gNc_3358: bitstring = exp(g,Nc_3357) in
                                {3790}let m1_3359: bitstring = (SPc_3356,gNc_3358) in
                                {3791}event beginCli(Cli,Sess,gNc_3358);
                                {3792}out(c, (pkCli_2956,m1_3359,sign(m1_3359,skCli_2955)));
                                {3793}in(c, (PartS_3360: bitstring,sigPartS_3361: bitstring));
                                {3794}if (verify(PartS_3360,sigPartS_3361,pkSess_3353) <> true) then
                                    0
                                else
                                    {3795}event endCli(Sess,Cli,PartS_3360)
                )
                else
                    {3796}let pkDisco_3362: bitstring = fail-any in
                    {3797}let v_3363: bool = (Sess = A) in
                    (
                        {3798}if v_3363 then
                        (
                            {3799}let pkSess_3364: bitstring = pub(skA) in
                            {3800}out(c, GetEndpointRequest);
                            {3801}in(c, (SPs_3365: bitstring,=Sign,UP_3366: bitstring,=pkSess_3364));
                            {3802}new SPc_3367: bitstring;
                            {3803}new Nc_3368: bitstring;
                            {3804}let gNc_3369: bitstring = exp(g,Nc_3368) in
                            {3805}let m1_3370: bitstring = (SPc_3367,gNc_3369) in
                            {3806}event beginCli(Cli,Sess,gNc_3369);
                            {3807}out(c, (pkCli_2956,m1_3370,sign(m1_3370,skCli_2955)));
                            {3808}in(c, (PartS_3371: bitstring,sigPartS_3372: bitstring));
                            {3809}if (verify(PartS_3371,sigPartS_3372,pkSess_3364) <> true) then
                                0
                            else
                                {3810}event endCli(Sess,Cli,PartS_3371)
                        )
                        else
                            {3811}let v_3373: bool = (Sess = B) in
                            (
                                {3812}if v_3373 then
                                (
                                    {3813}let pkSess_3374: bitstring = pub(skB) in
                                    {3814}out(c, GetEndpointRequest);
                                    {3815}in(c, (SPs_3375: bitstring,=Sign,UP_3376: bitstring,=pkSess_3374));
                                    {3816}new SPc_3377: bitstring;
                                    {3817}new Nc_3378: bitstring;
                                    {3818}let gNc_3379: bitstring = exp(g,Nc_3378) in
                                    {3819}let m1_3380: bitstring = (SPc_3377,gNc_3379) in
                                    {3820}event beginCli(Cli,Sess,gNc_3379);
                                    {3821}out(c, (pkCli_2956,m1_3380,sign(m1_3380,skCli_2955)));
                                    {3822}in(c, (PartS_3381: bitstring,sigPartS_3382: bitstring));
                                    {3823}if (verify(PartS_3381,sigPartS_3382,pkSess_3374) <> true) then
                                        0
                                    else
                                        {3824}event endCli(Sess,Cli,PartS_3381)
                                )
                                else
                                    {3825}let v_3383: bool = (Sess = C) in
                                    (
                                        {3826}if v_3383 then
                                        (
                                            {3827}let pkSess_3384: bitstring = pub(skC) in
                                            {3828}out(c, GetEndpointRequest);
                                            {3829}in(c, (SPs_3385: bitstring,=Sign,UP_3386: bitstring,=pkSess_3384));
                                            {3830}new SPc_3387: bitstring;
                                            {3831}new Nc_3388: bitstring;
                                            {3832}let gNc_3389: bitstring = exp(g,Nc_3388) in
                                            {3833}let m1_3390: bitstring = (SPc_3387,gNc_3389) in
                                            {3834}event beginCli(Cli,Sess,gNc_3389);
                                            {3835}out(c, (pkCli_2956,m1_3390,sign(m1_3390,skCli_2955)));
                                            {3836}in(c, (PartS_3391: bitstring,sigPartS_3392: bitstring));
                                            {3837}if (verify(PartS_3391,sigPartS_3392,pkSess_3384) <> true) then
                                                0
                                            else
                                                {3838}event endCli(Sess,Cli,PartS_3391)
                                        )
                                        else
                                            {3839}let pkSess_3393: bitstring = pub(skI) in
                                            {3840}out(c, GetEndpointRequest);
                                            {3841}in(c, (SPs_3394: bitstring,=Sign,UP_3395: bitstring,=pkSess_3393));
                                            {3842}new SPc_3396: bitstring;
                                            {3843}new Nc_3397: bitstring;
                                            {3844}let gNc_3398: bitstring = exp(g,Nc_3397) in
                                            {3845}let m1_3399: bitstring = (SPc_3396,gNc_3398) in
                                            {3846}event beginCli(Cli,Sess,gNc_3398);
                                            {3847}out(c, (pkCli_2956,m1_3399,sign(m1_3399,skCli_2955)));
                                            {3848}in(c, (PartS_3400: bitstring,sigPartS_3401: bitstring));
                                            {3849}if (verify(PartS_3400,sigPartS_3401,pkSess_3393) <> true) then
                                                0
                                            else
                                                {3850}event endCli(Sess,Cli,PartS_3400)
                                    )
                                    else
                                        {3851}let pkSess_3402: bitstring = fail-any in
                                        {3852}out(c, GetEndpointRequest);
                                        {3853}in(c, (SPs_3403: bitstring,=Sign,UP_3404: bitstring,=pkSess_3402));
                                        {3854}new SPc_3405: bitstring;
                                        {3855}new Nc_3406: bitstring;
                                        {3856}let gNc_3407: bitstring = exp(g,Nc_3406) in
                                        {3857}let m1_3408: bitstring = (SPc_3405,gNc_3407) in
                                        {3858}event beginCli(Cli,Sess,gNc_3407);
                                        {3859}out(c, (pkCli_2956,m1_3408,sign(m1_3408,skCli_2955)));
                                        {3860}in(c, (PartS_3409: bitstring,sigPartS_3410: bitstring));
                                        {3861}if (verify(PartS_3409,sigPartS_3410,pkSess_3402) <> true) then
                                            0
                                        else
                                            {3862}event endCli(Sess,Cli,PartS_3409)
                            )
                            else
                                {3863}let pkSess_3411: bitstring = fail-any in
                                {3864}out(c, GetEndpointRequest);
                                {3865}in(c, (SPs_3412: bitstring,=Sign,UP_3413: bitstring,=pkSess_3411));
                                {3866}new SPc_3414: bitstring;
                                {3867}new Nc_3415: bitstring;
                                {3868}let gNc_3416: bitstring = exp(g,Nc_3415) in
                                {3869}let m1_3417: bitstring = (SPc_3414,gNc_3416) in
                                {3870}event beginCli(Cli,Sess,gNc_3416);
                                {3871}out(c, (pkCli_2956,m1_3417,sign(m1_3417,skCli_2955)));
                                {3872}in(c, (PartS_3418: bitstring,sigPartS_3419: bitstring));
                                {3873}if (verify(PartS_3418,sigPartS_3419,pkSess_3411) <> true) then
                                    0
                                else
                                    {3874}event endCli(Sess,Cli,PartS_3418)
                    )
                    else
                        {3875}let pkSess_3420: bitstring = fail-any in
                        {3876}out(c, GetEndpointRequest);
                        {3877}in(c, (SPs_3421: bitstring,=Sign,UP_3422: bitstring,=pkSess_3420));
                        {3878}new SPc_3423: bitstring;
                        {3879}new Nc_3424: bitstring;
                        {3880}let gNc_3425: bitstring = exp(g,Nc_3424) in
                        {3881}let m1_3426: bitstring = (SPc_3423,gNc_3425) in
                        {3882}event beginCli(Cli,Sess,gNc_3425);
                        {3883}out(c, (pkCli_2956,m1_3426,sign(m1_3426,skCli_2955)));
                        {3884}in(c, (PartS_3427: bitstring,sigPartS_3428: bitstring));
                        {3885}if (verify(PartS_3427,sigPartS_3428,pkSess_3420) <> true) then
                            0
                        else
                            {3886}event endCli(Sess,Cli,PartS_3427)
    )
    else
        {3887}let skCli_3429: bitstring = fail-any in
        {3888}let pkCli_3430: bitstring = pub(skCli_3429) in
        {3889}let v_3431: bool = (Disco = A) in
        (
            {3890}if v_3431 then
            (
                {3891}let pkDisco_3432: bitstring = pub(skA) in
                {3892}let v_3433: bool = (Sess = A) in
                (
                    {3893}if v_3433 then
                    (
                        {3894}let pkSess_3434: bitstring = pub(skA) in
                        {3895}out(c, GetEndpointRequest);
                        {3896}in(c, (SPs_3435: bitstring,=Sign,UP_3436: bitstring,=pkSess_3434));
                        {3897}new SPc_3437: bitstring;
                        {3898}new Nc_3438: bitstring;
                        {3899}let gNc_3439: bitstring = exp(g,Nc_3438) in
                        {3900}let m1_3440: bitstring = (SPc_3437,gNc_3439) in
                        {3901}event beginCli(Cli,Sess,gNc_3439);
                        {3902}out(c, (pkCli_3430,m1_3440,sign(m1_3440,skCli_3429)));
                        {3903}in(c, (PartS_3441: bitstring,sigPartS_3442: bitstring));
                        {3904}if (verify(PartS_3441,sigPartS_3442,pkSess_3434) <> true) then
                            0
                        else
                            {3905}event endCli(Sess,Cli,PartS_3441)
                    )
                    else
                        {3906}let v_3443: bool = (Sess = B) in
                        (
                            {3907}if v_3443 then
                            (
                                {3908}let pkSess_3444: bitstring = pub(skB) in
                                {3909}out(c, GetEndpointRequest);
                                {3910}in(c, (SPs_3445: bitstring,=Sign,UP_3446: bitstring,=pkSess_3444));
                                {3911}new SPc_3447: bitstring;
                                {3912}new Nc_3448: bitstring;
                                {3913}let gNc_3449: bitstring = exp(g,Nc_3448) in
                                {3914}let m1_3450: bitstring = (SPc_3447,gNc_3449) in
                                {3915}event beginCli(Cli,Sess,gNc_3449);
                                {3916}out(c, (pkCli_3430,m1_3450,sign(m1_3450,skCli_3429)));
                                {3917}in(c, (PartS_3451: bitstring,sigPartS_3452: bitstring));
                                {3918}if (verify(PartS_3451,sigPartS_3452,pkSess_3444) <> true) then
                                    0
                                else
                                    {3919}event endCli(Sess,Cli,PartS_3451)
                            )
                            else
                                {3920}let v_3453: bool = (Sess = C) in
                                (
                                    {3921}if v_3453 then
                                    (
                                        {3922}let pkSess_3454: bitstring = pub(skC) in
                                        {3923}out(c, GetEndpointRequest);
                                        {3924}in(c, (SPs_3455: bitstring,=Sign,UP_3456: bitstring,=pkSess_3454));
                                        {3925}new SPc_3457: bitstring;
                                        {3926}new Nc_3458: bitstring;
                                        {3927}let gNc_3459: bitstring = exp(g,Nc_3458) in
                                        {3928}let m1_3460: bitstring = (SPc_3457,gNc_3459) in
                                        {3929}event beginCli(Cli,Sess,gNc_3459);
                                        {3930}out(c, (pkCli_3430,m1_3460,sign(m1_3460,skCli_3429)));
                                        {3931}in(c, (PartS_3461: bitstring,sigPartS_3462: bitstring));
                                        {3932}if (verify(PartS_3461,sigPartS_3462,pkSess_3454) <> true) then
                                            0
                                        else
                                            {3933}event endCli(Sess,Cli,PartS_3461)
                                    )
                                    else
                                        {3934}let pkSess_3463: bitstring = pub(skI) in
                                        {3935}out(c, GetEndpointRequest);
                                        {3936}in(c, (SPs_3464: bitstring,=Sign,UP_3465: bitstring,=pkSess_3463));
                                        {3937}new SPc_3466: bitstring;
                                        {3938}new Nc_3467: bitstring;
                                        {3939}let gNc_3468: bitstring = exp(g,Nc_3467) in
                                        {3940}let m1_3469: bitstring = (SPc_3466,gNc_3468) in
                                        {3941}event beginCli(Cli,Sess,gNc_3468);
                                        {3942}out(c, (pkCli_3430,m1_3469,sign(m1_3469,skCli_3429)));
                                        {3943}in(c, (PartS_3470: bitstring,sigPartS_3471: bitstring));
                                        {3944}if (verify(PartS_3470,sigPartS_3471,pkSess_3463) <> true) then
                                            0
                                        else
                                            {3945}event endCli(Sess,Cli,PartS_3470)
                                )
                                else
                                    {3946}let pkSess_3472: bitstring = fail-any in
                                    {3947}out(c, GetEndpointRequest);
                                    {3948}in(c, (SPs_3473: bitstring,=Sign,UP_3474: bitstring,=pkSess_3472));
                                    {3949}new SPc_3475: bitstring;
                                    {3950}new Nc_3476: bitstring;
                                    {3951}let gNc_3477: bitstring = exp(g,Nc_3476) in
                                    {3952}let m1_3478: bitstring = (SPc_3475,gNc_3477) in
                                    {3953}event beginCli(Cli,Sess,gNc_3477);
                                    {3954}out(c, (pkCli_3430,m1_3478,sign(m1_3478,skCli_3429)));
                                    {3955}in(c, (PartS_3479: bitstring,sigPartS_3480: bitstring));
                                    {3956}if (verify(PartS_3479,sigPartS_3480,pkSess_3472) <> true) then
                                        0
                                    else
                                        {3957}event endCli(Sess,Cli,PartS_3479)
                        )
                        else
                            {3958}let pkSess_3481: bitstring = fail-any in
                            {3959}out(c, GetEndpointRequest);
                            {3960}in(c, (SPs_3482: bitstring,=Sign,UP_3483: bitstring,=pkSess_3481));
                            {3961}new SPc_3484: bitstring;
                            {3962}new Nc_3485: bitstring;
                            {3963}let gNc_3486: bitstring = exp(g,Nc_3485) in
                            {3964}let m1_3487: bitstring = (SPc_3484,gNc_3486) in
                            {3965}event beginCli(Cli,Sess,gNc_3486);
                            {3966}out(c, (pkCli_3430,m1_3487,sign(m1_3487,skCli_3429)));
                            {3967}in(c, (PartS_3488: bitstring,sigPartS_3489: bitstring));
                            {3968}if (verify(PartS_3488,sigPartS_3489,pkSess_3481) <> true) then
                                0
                            else
                                {3969}event endCli(Sess,Cli,PartS_3488)
                )
                else
                    {3970}let pkSess_3490: bitstring = fail-any in
                    {3971}out(c, GetEndpointRequest);
                    {3972}in(c, (SPs_3491: bitstring,=Sign,UP_3492: bitstring,=pkSess_3490));
                    {3973}new SPc_3493: bitstring;
                    {3974}new Nc_3494: bitstring;
                    {3975}let gNc_3495: bitstring = exp(g,Nc_3494) in
                    {3976}let m1_3496: bitstring = (SPc_3493,gNc_3495) in
                    {3977}event beginCli(Cli,Sess,gNc_3495);
                    {3978}out(c, (pkCli_3430,m1_3496,sign(m1_3496,skCli_3429)));
                    {3979}in(c, (PartS_3497: bitstring,sigPartS_3498: bitstring));
                    {3980}if (verify(PartS_3497,sigPartS_3498,pkSess_3490) <> true) then
                        0
                    else
                        {3981}event endCli(Sess,Cli,PartS_3497)
            )
            else
                {3982}let v_3499: bool = (Disco = B) in
                (
                    {3983}if v_3499 then
                    (
                        {3984}let pkDisco_3500: bitstring = pub(skB) in
                        {3985}let v_3501: bool = (Sess = A) in
                        (
                            {3986}if v_3501 then
                            (
                                {3987}let pkSess_3502: bitstring = pub(skA) in
                                {3988}out(c, GetEndpointRequest);
                                {3989}in(c, (SPs_3503: bitstring,=Sign,UP_3504: bitstring,=pkSess_3502));
                                {3990}new SPc_3505: bitstring;
                                {3991}new Nc_3506: bitstring;
                                {3992}let gNc_3507: bitstring = exp(g,Nc_3506) in
                                {3993}let m1_3508: bitstring = (SPc_3505,gNc_3507) in
                                {3994}event beginCli(Cli,Sess,gNc_3507);
                                {3995}out(c, (pkCli_3430,m1_3508,sign(m1_3508,skCli_3429)));
                                {3996}in(c, (PartS_3509: bitstring,sigPartS_3510: bitstring));
                                {3997}if (verify(PartS_3509,sigPartS_3510,pkSess_3502) <> true) then
                                    0
                                else
                                    {3998}event endCli(Sess,Cli,PartS_3509)
                            )
                            else
                                {3999}let v_3511: bool = (Sess = B) in
                                (
                                    {4000}if v_3511 then
                                    (
                                        {4001}let pkSess_3512: bitstring = pub(skB) in
                                        {4002}out(c, GetEndpointRequest);
                                        {4003}in(c, (SPs_3513: bitstring,=Sign,UP_3514: bitstring,=pkSess_3512));
                                        {4004}new SPc_3515: bitstring;
                                        {4005}new Nc_3516: bitstring;
                                        {4006}let gNc_3517: bitstring = exp(g,Nc_3516) in
                                        {4007}let m1_3518: bitstring = (SPc_3515,gNc_3517) in
                                        {4008}event beginCli(Cli,Sess,gNc_3517);
                                        {4009}out(c, (pkCli_3430,m1_3518,sign(m1_3518,skCli_3429)));
                                        {4010}in(c, (PartS_3519: bitstring,sigPartS_3520: bitstring));
                                        {4011}if (verify(PartS_3519,sigPartS_3520,pkSess_3512) <> true) then
                                            0
                                        else
                                            {4012}event endCli(Sess,Cli,PartS_3519)
                                    )
                                    else
                                        {4013}let v_3521: bool = (Sess = C) in
                                        (
                                            {4014}if v_3521 then
                                            (
                                                {4015}let pkSess_3522: bitstring = pub(skC) in
                                                {4016}out(c, GetEndpointRequest);
                                                {4017}in(c, (SPs_3523: bitstring,=Sign,UP_3524: bitstring,=pkSess_3522));
                                                {4018}new SPc_3525: bitstring;
                                                {4019}new Nc_3526: bitstring;
                                                {4020}let gNc_3527: bitstring = exp(g,Nc_3526) in
                                                {4021}let m1_3528: bitstring = (SPc_3525,gNc_3527) in
                                                {4022}event beginCli(Cli,Sess,gNc_3527);
                                                {4023}out(c, (pkCli_3430,m1_3528,sign(m1_3528,skCli_3429)));
                                                {4024}in(c, (PartS_3529: bitstring,sigPartS_3530: bitstring));
                                                {4025}if (verify(PartS_3529,sigPartS_3530,pkSess_3522) <> true) then
                                                    0
                                                else
                                                    {4026}event endCli(Sess,Cli,PartS_3529)
                                            )
                                            else
                                                {4027}let pkSess_3531: bitstring = pub(skI) in
                                                {4028}out(c, GetEndpointRequest);
                                                {4029}in(c, (SPs_3532: bitstring,=Sign,UP_3533: bitstring,=pkSess_3531));
                                                {4030}new SPc_3534: bitstring;
                                                {4031}new Nc_3535: bitstring;
                                                {4032}let gNc_3536: bitstring = exp(g,Nc_3535) in
                                                {4033}let m1_3537: bitstring = (SPc_3534,gNc_3536) in
                                                {4034}event beginCli(Cli,Sess,gNc_3536);
                                                {4035}out(c, (pkCli_3430,m1_3537,sign(m1_3537,skCli_3429)));
                                                {4036}in(c, (PartS_3538: bitstring,sigPartS_3539: bitstring));
                                                {4037}if (verify(PartS_3538,sigPartS_3539,pkSess_3531) <> true) then
                                                    0
                                                else
                                                    {4038}event endCli(Sess,Cli,PartS_3538)
                                        )
                                        else
                                            {4039}let pkSess_3540: bitstring = fail-any in
                                            {4040}out(c, GetEndpointRequest);
                                            {4041}in(c, (SPs_3541: bitstring,=Sign,UP_3542: bitstring,=pkSess_3540));
                                            {4042}new SPc_3543: bitstring;
                                            {4043}new Nc_3544: bitstring;
                                            {4044}let gNc_3545: bitstring = exp(g,Nc_3544) in
                                            {4045}let m1_3546: bitstring = (SPc_3543,gNc_3545) in
                                            {4046}event beginCli(Cli,Sess,gNc_3545);
                                            {4047}out(c, (pkCli_3430,m1_3546,sign(m1_3546,skCli_3429)));
                                            {4048}in(c, (PartS_3547: bitstring,sigPartS_3548: bitstring));
                                            {4049}if (verify(PartS_3547,sigPartS_3548,pkSess_3540) <> true) then
                                                0
                                            else
                                                {4050}event endCli(Sess,Cli,PartS_3547)
                                )
                                else
                                    {4051}let pkSess_3549: bitstring = fail-any in
                                    {4052}out(c, GetEndpointRequest);
                                    {4053}in(c, (SPs_3550: bitstring,=Sign,UP_3551: bitstring,=pkSess_3549));
                                    {4054}new SPc_3552: bitstring;
                                    {4055}new Nc_3553: bitstring;
                                    {4056}let gNc_3554: bitstring = exp(g,Nc_3553) in
                                    {4057}let m1_3555: bitstring = (SPc_3552,gNc_3554) in
                                    {4058}event beginCli(Cli,Sess,gNc_3554);
                                    {4059}out(c, (pkCli_3430,m1_3555,sign(m1_3555,skCli_3429)));
                                    {4060}in(c, (PartS_3556: bitstring,sigPartS_3557: bitstring));
                                    {4061}if (verify(PartS_3556,sigPartS_3557,pkSess_3549) <> true) then
                                        0
                                    else
                                        {4062}event endCli(Sess,Cli,PartS_3556)
                        )
                        else
                            {4063}let pkSess_3558: bitstring = fail-any in
                            {4064}out(c, GetEndpointRequest);
                            {4065}in(c, (SPs_3559: bitstring,=Sign,UP_3560: bitstring,=pkSess_3558));
                            {4066}new SPc_3561: bitstring;
                            {4067}new Nc_3562: bitstring;
                            {4068}let gNc_3563: bitstring = exp(g,Nc_3562) in
                            {4069}let m1_3564: bitstring = (SPc_3561,gNc_3563) in
                            {4070}event beginCli(Cli,Sess,gNc_3563);
                            {4071}out(c, (pkCli_3430,m1_3564,sign(m1_3564,skCli_3429)));
                            {4072}in(c, (PartS_3565: bitstring,sigPartS_3566: bitstring));
                            {4073}if (verify(PartS_3565,sigPartS_3566,pkSess_3558) <> true) then
                                0
                            else
                                {4074}event endCli(Sess,Cli,PartS_3565)
                    )
                    else
                        {4075}let v_3567: bool = (Disco = C) in
                        (
                            {4076}if v_3567 then
                            (
                                {4077}let pkDisco_3568: bitstring = pub(skC) in
                                {4078}let v_3569: bool = (Sess = A) in
                                (
                                    {4079}if v_3569 then
                                    (
                                        {4080}let pkSess_3570: bitstring = pub(skA) in
                                        {4081}out(c, GetEndpointRequest);
                                        {4082}in(c, (SPs_3571: bitstring,=Sign,UP_3572: bitstring,=pkSess_3570));
                                        {4083}new SPc_3573: bitstring;
                                        {4084}new Nc_3574: bitstring;
                                        {4085}let gNc_3575: bitstring = exp(g,Nc_3574) in
                                        {4086}let m1_3576: bitstring = (SPc_3573,gNc_3575) in
                                        {4087}event beginCli(Cli,Sess,gNc_3575);
                                        {4088}out(c, (pkCli_3430,m1_3576,sign(m1_3576,skCli_3429)));
                                        {4089}in(c, (PartS_3577: bitstring,sigPartS_3578: bitstring));
                                        {4090}if (verify(PartS_3577,sigPartS_3578,pkSess_3570) <> true) then
                                            0
                                        else
                                            {4091}event endCli(Sess,Cli,PartS_3577)
                                    )
                                    else
                                        {4092}let v_3579: bool = (Sess = B) in
                                        (
                                            {4093}if v_3579 then
                                            (
                                                {4094}let pkSess_3580: bitstring = pub(skB) in
                                                {4095}out(c, GetEndpointRequest);
                                                {4096}in(c, (SPs_3581: bitstring,=Sign,UP_3582: bitstring,=pkSess_3580));
                                                {4097}new SPc_3583: bitstring;
                                                {4098}new Nc_3584: bitstring;
                                                {4099}let gNc_3585: bitstring = exp(g,Nc_3584) in
                                                {4100}let m1_3586: bitstring = (SPc_3583,gNc_3585) in
                                                {4101}event beginCli(Cli,Sess,gNc_3585);
                                                {4102}out(c, (pkCli_3430,m1_3586,sign(m1_3586,skCli_3429)));
                                                {4103}in(c, (PartS_3587: bitstring,sigPartS_3588: bitstring));
                                                {4104}if (verify(PartS_3587,sigPartS_3588,pkSess_3580) <> true) then
                                                    0
                                                else
                                                    {4105}event endCli(Sess,Cli,PartS_3587)
                                            )
                                            else
                                                {4106}let v_3589: bool = (Sess = C) in
                                                (
                                                    {4107}if v_3589 then
                                                    (
                                                        {4108}let pkSess_3590: bitstring = pub(skC) in
                                                        {4109}out(c, GetEndpointRequest);
                                                        {4110}in(c, (SPs_3591: bitstring,=Sign,UP_3592: bitstring,=pkSess_3590));
                                                        {4111}new SPc_3593: bitstring;
                                                        {4112}new Nc_3594: bitstring;
                                                        {4113}let gNc_3595: bitstring = exp(g,Nc_3594) in
                                                        {4114}let m1_3596: bitstring = (SPc_3593,gNc_3595) in
                                                        {4115}event beginCli(Cli,Sess,gNc_3595);
                                                        {4116}out(c, (pkCli_3430,m1_3596,sign(m1_3596,skCli_3429)));
                                                        {4117}in(c, (PartS_3597: bitstring,sigPartS_3598: bitstring));
                                                        {4118}if (verify(PartS_3597,sigPartS_3598,pkSess_3590) <> true) then
                                                            0
                                                        else
                                                            {4119}event endCli(Sess,Cli,PartS_3597)
                                                    )
                                                    else
                                                        {4120}let pkSess_3599: bitstring = pub(skI) in
                                                        {4121}out(c, GetEndpointRequest);
                                                        {4122}in(c, (SPs_3600: bitstring,=Sign,UP_3601: bitstring,=pkSess_3599));
                                                        {4123}new SPc_3602: bitstring;
                                                        {4124}new Nc_3603: bitstring;
                                                        {4125}let gNc_3604: bitstring = exp(g,Nc_3603) in
                                                        {4126}let m1_3605: bitstring = (SPc_3602,gNc_3604) in
                                                        {4127}event beginCli(Cli,Sess,gNc_3604);
                                                        {4128}out(c, (pkCli_3430,m1_3605,sign(m1_3605,skCli_3429)));
                                                        {4129}in(c, (PartS_3606: bitstring,sigPartS_3607: bitstring));
                                                        {4130}if (verify(PartS_3606,sigPartS_3607,pkSess_3599) <> true) then
                                                            0
                                                        else
                                                            {4131}event endCli(Sess,Cli,PartS_3606)
                                                )
                                                else
                                                    {4132}let pkSess_3608: bitstring = fail-any in
                                                    {4133}out(c, GetEndpointRequest);
                                                    {4134}in(c, (SPs_3609: bitstring,=Sign,UP_3610: bitstring,=pkSess_3608));
                                                    {4135}new SPc_3611: bitstring;
                                                    {4136}new Nc_3612: bitstring;
                                                    {4137}let gNc_3613: bitstring = exp(g,Nc_3612) in
                                                    {4138}let m1_3614: bitstring = (SPc_3611,gNc_3613) in
                                                    {4139}event beginCli(Cli,Sess,gNc_3613);
                                                    {4140}out(c, (pkCli_3430,m1_3614,sign(m1_3614,skCli_3429)));
                                                    {4141}in(c, (PartS_3615: bitstring,sigPartS_3616: bitstring));
                                                    {4142}if (verify(PartS_3615,sigPartS_3616,pkSess_3608) <> true) then
                                                        0
                                                    else
                                                        {4143}event endCli(Sess,Cli,PartS_3615)
                                        )
                                        else
                                            {4144}let pkSess_3617: bitstring = fail-any in
                                            {4145}out(c, GetEndpointRequest);
                                            {4146}in(c, (SPs_3618: bitstring,=Sign,UP_3619: bitstring,=pkSess_3617));
                                            {4147}new SPc_3620: bitstring;
                                            {4148}new Nc_3621: bitstring;
                                            {4149}let gNc_3622: bitstring = exp(g,Nc_3621) in
                                            {4150}let m1_3623: bitstring = (SPc_3620,gNc_3622) in
                                            {4151}event beginCli(Cli,Sess,gNc_3622);
                                            {4152}out(c, (pkCli_3430,m1_3623,sign(m1_3623,skCli_3429)));
                                            {4153}in(c, (PartS_3624: bitstring,sigPartS_3625: bitstring));
                                            {4154}if (verify(PartS_3624,sigPartS_3625,pkSess_3617) <> true) then
                                                0
                                            else
                                                {4155}event endCli(Sess,Cli,PartS_3624)
                                )
                                else
                                    {4156}let pkSess_3626: bitstring = fail-any in
                                    {4157}out(c, GetEndpointRequest);
                                    {4158}in(c, (SPs_3627: bitstring,=Sign,UP_3628: bitstring,=pkSess_3626));
                                    {4159}new SPc_3629: bitstring;
                                    {4160}new Nc_3630: bitstring;
                                    {4161}let gNc_3631: bitstring = exp(g,Nc_3630) in
                                    {4162}let m1_3632: bitstring = (SPc_3629,gNc_3631) in
                                    {4163}event beginCli(Cli,Sess,gNc_3631);
                                    {4164}out(c, (pkCli_3430,m1_3632,sign(m1_3632,skCli_3429)));
                                    {4165}in(c, (PartS_3633: bitstring,sigPartS_3634: bitstring));
                                    {4166}if (verify(PartS_3633,sigPartS_3634,pkSess_3626) <> true) then
                                        0
                                    else
                                        {4167}event endCli(Sess,Cli,PartS_3633)
                            )
                            else
                                {4168}let pkDisco_3635: bitstring = pub(skI) in
                                {4169}let v_3636: bool = (Sess = A) in
                                (
                                    {4170}if v_3636 then
                                    (
                                        {4171}let pkSess_3637: bitstring = pub(skA) in
                                        {4172}out(c, GetEndpointRequest);
                                        {4173}in(c, (SPs_3638: bitstring,=Sign,UP_3639: bitstring,=pkSess_3637));
                                        {4174}new SPc_3640: bitstring;
                                        {4175}new Nc_3641: bitstring;
                                        {4176}let gNc_3642: bitstring = exp(g,Nc_3641) in
                                        {4177}let m1_3643: bitstring = (SPc_3640,gNc_3642) in
                                        {4178}event beginCli(Cli,Sess,gNc_3642);
                                        {4179}out(c, (pkCli_3430,m1_3643,sign(m1_3643,skCli_3429)));
                                        {4180}in(c, (PartS_3644: bitstring,sigPartS_3645: bitstring));
                                        {4181}if (verify(PartS_3644,sigPartS_3645,pkSess_3637) <> true) then
                                            0
                                        else
                                            {4182}event endCli(Sess,Cli,PartS_3644)
                                    )
                                    else
                                        {4183}let v_3646: bool = (Sess = B) in
                                        (
                                            {4184}if v_3646 then
                                            (
                                                {4185}let pkSess_3647: bitstring = pub(skB) in
                                                {4186}out(c, GetEndpointRequest);
                                                {4187}in(c, (SPs_3648: bitstring,=Sign,UP_3649: bitstring,=pkSess_3647));
                                                {4188}new SPc_3650: bitstring;
                                                {4189}new Nc_3651: bitstring;
                                                {4190}let gNc_3652: bitstring = exp(g,Nc_3651) in
                                                {4191}let m1_3653: bitstring = (SPc_3650,gNc_3652) in
                                                {4192}event beginCli(Cli,Sess,gNc_3652);
                                                {4193}out(c, (pkCli_3430,m1_3653,sign(m1_3653,skCli_3429)));
                                                {4194}in(c, (PartS_3654: bitstring,sigPartS_3655: bitstring));
                                                {4195}if (verify(PartS_3654,sigPartS_3655,pkSess_3647) <> true) then
                                                    0
                                                else
                                                    {4196}event endCli(Sess,Cli,PartS_3654)
                                            )
                                            else
                                                {4197}let v_3656: bool = (Sess = C) in
                                                (
                                                    {4198}if v_3656 then
                                                    (
                                                        {4199}let pkSess_3657: bitstring = pub(skC) in
                                                        {4200}out(c, GetEndpointRequest);
                                                        {4201}in(c, (SPs_3658: bitstring,=Sign,UP_3659: bitstring,=pkSess_3657));
                                                        {4202}new SPc_3660: bitstring;
                                                        {4203}new Nc_3661: bitstring;
                                                        {4204}let gNc_3662: bitstring = exp(g,Nc_3661) in
                                                        {4205}let m1_3663: bitstring = (SPc_3660,gNc_3662) in
                                                        {4206}event beginCli(Cli,Sess,gNc_3662);
                                                        {4207}out(c, (pkCli_3430,m1_3663,sign(m1_3663,skCli_3429)));
                                                        {4208}in(c, (PartS_3664: bitstring,sigPartS_3665: bitstring));
                                                        {4209}if (verify(PartS_3664,sigPartS_3665,pkSess_3657) <> true) then
                                                            0
                                                        else
                                                            {4210}event endCli(Sess,Cli,PartS_3664)
                                                    )
                                                    else
                                                        {4211}let pkSess_3666: bitstring = pub(skI) in
                                                        {4212}out(c, GetEndpointRequest);
                                                        {4213}in(c, (SPs_3667: bitstring,=Sign,UP_3668: bitstring,=pkSess_3666));
                                                        {4214}new SPc_3669: bitstring;
                                                        {4215}new Nc_3670: bitstring;
                                                        {4216}let gNc_3671: bitstring = exp(g,Nc_3670) in
                                                        {4217}let m1_3672: bitstring = (SPc_3669,gNc_3671) in
                                                        {4218}event beginCli(Cli,Sess,gNc_3671);
                                                        {4219}out(c, (pkCli_3430,m1_3672,sign(m1_3672,skCli_3429)));
                                                        {4220}in(c, (PartS_3673: bitstring,sigPartS_3674: bitstring));
                                                        {4221}if (verify(PartS_3673,sigPartS_3674,pkSess_3666) <> true) then
                                                            0
                                                        else
                                                            {4222}event endCli(Sess,Cli,PartS_3673)
                                                )
                                                else
                                                    {4223}let pkSess_3675: bitstring = fail-any in
                                                    {4224}out(c, GetEndpointRequest);
                                                    {4225}in(c, (SPs_3676: bitstring,=Sign,UP_3677: bitstring,=pkSess_3675));
                                                    {4226}new SPc_3678: bitstring;
                                                    {4227}new Nc_3679: bitstring;
                                                    {4228}let gNc_3680: bitstring = exp(g,Nc_3679) in
                                                    {4229}let m1_3681: bitstring = (SPc_3678,gNc_3680) in
                                                    {4230}event beginCli(Cli,Sess,gNc_3680);
                                                    {4231}out(c, (pkCli_3430,m1_3681,sign(m1_3681,skCli_3429)));
                                                    {4232}in(c, (PartS_3682: bitstring,sigPartS_3683: bitstring));
                                                    {4233}if (verify(PartS_3682,sigPartS_3683,pkSess_3675) <> true) then
                                                        0
                                                    else
                                                        {4234}event endCli(Sess,Cli,PartS_3682)
                                        )
                                        else
                                            {4235}let pkSess_3684: bitstring = fail-any in
                                            {4236}out(c, GetEndpointRequest);
                                            {4237}in(c, (SPs_3685: bitstring,=Sign,UP_3686: bitstring,=pkSess_3684));
                                            {4238}new SPc_3687: bitstring;
                                            {4239}new Nc_3688: bitstring;
                                            {4240}let gNc_3689: bitstring = exp(g,Nc_3688) in
                                            {4241}let m1_3690: bitstring = (SPc_3687,gNc_3689) in
                                            {4242}event beginCli(Cli,Sess,gNc_3689);
                                            {4243}out(c, (pkCli_3430,m1_3690,sign(m1_3690,skCli_3429)));
                                            {4244}in(c, (PartS_3691: bitstring,sigPartS_3692: bitstring));
                                            {4245}if (verify(PartS_3691,sigPartS_3692,pkSess_3684) <> true) then
                                                0
                                            else
                                                {4246}event endCli(Sess,Cli,PartS_3691)
                                )
                                else
                                    {4247}let pkSess_3693: bitstring = fail-any in
                                    {4248}out(c, GetEndpointRequest);
                                    {4249}in(c, (SPs_3694: bitstring,=Sign,UP_3695: bitstring,=pkSess_3693));
                                    {4250}new SPc_3696: bitstring;
                                    {4251}new Nc_3697: bitstring;
                                    {4252}let gNc_3698: bitstring = exp(g,Nc_3697) in
                                    {4253}let m1_3699: bitstring = (SPc_3696,gNc_3698) in
                                    {4254}event beginCli(Cli,Sess,gNc_3698);
                                    {4255}out(c, (pkCli_3430,m1_3699,sign(m1_3699,skCli_3429)));
                                    {4256}in(c, (PartS_3700: bitstring,sigPartS_3701: bitstring));
                                    {4257}if (verify(PartS_3700,sigPartS_3701,pkSess_3693) <> true) then
                                        0
                                    else
                                        {4258}event endCli(Sess,Cli,PartS_3700)
                        )
                        else
                            {4259}let pkDisco_3702: bitstring = fail-any in
                            {4260}let v_3703: bool = (Sess = A) in
                            (
                                {4261}if v_3703 then
                                (
                                    {4262}let pkSess_3704: bitstring = pub(skA) in
                                    {4263}out(c, GetEndpointRequest);
                                    {4264}in(c, (SPs_3705: bitstring,=Sign,UP_3706: bitstring,=pkSess_3704));
                                    {4265}new SPc_3707: bitstring;
                                    {4266}new Nc_3708: bitstring;
                                    {4267}let gNc_3709: bitstring = exp(g,Nc_3708) in
                                    {4268}let m1_3710: bitstring = (SPc_3707,gNc_3709) in
                                    {4269}event beginCli(Cli,Sess,gNc_3709);
                                    {4270}out(c, (pkCli_3430,m1_3710,sign(m1_3710,skCli_3429)));
                                    {4271}in(c, (PartS_3711: bitstring,sigPartS_3712: bitstring));
                                    {4272}if (verify(PartS_3711,sigPartS_3712,pkSess_3704) <> true) then
                                        0
                                    else
                                        {4273}event endCli(Sess,Cli,PartS_3711)
                                )
                                else
                                    {4274}let v_3713: bool = (Sess = B) in
                                    (
                                        {4275}if v_3713 then
                                        (
                                            {4276}let pkSess_3714: bitstring = pub(skB) in
                                            {4277}out(c, GetEndpointRequest);
                                            {4278}in(c, (SPs_3715: bitstring,=Sign,UP_3716: bitstring,=pkSess_3714));
                                            {4279}new SPc_3717: bitstring;
                                            {4280}new Nc_3718: bitstring;
                                            {4281}let gNc_3719: bitstring = exp(g,Nc_3718) in
                                            {4282}let m1_3720: bitstring = (SPc_3717,gNc_3719) in
                                            {4283}event beginCli(Cli,Sess,gNc_3719);
                                            {4284}out(c, (pkCli_3430,m1_3720,sign(m1_3720,skCli_3429)));
                                            {4285}in(c, (PartS_3721: bitstring,sigPartS_3722: bitstring));
                                            {4286}if (verify(PartS_3721,sigPartS_3722,pkSess_3714) <> true) then
                                                0
                                            else
                                                {4287}event endCli(Sess,Cli,PartS_3721)
                                        )
                                        else
                                            {4288}let v_3723: bool = (Sess = C) in
                                            (
                                                {4289}if v_3723 then
                                                (
                                                    {4290}let pkSess_3724: bitstring = pub(skC) in
                                                    {4291}out(c, GetEndpointRequest);
                                                    {4292}in(c, (SPs_3725: bitstring,=Sign,UP_3726: bitstring,=pkSess_3724));
                                                    {4293}new SPc_3727: bitstring;
                                                    {4294}new Nc_3728: bitstring;
                                                    {4295}let gNc_3729: bitstring = exp(g,Nc_3728) in
                                                    {4296}let m1_3730: bitstring = (SPc_3727,gNc_3729) in
                                                    {4297}event beginCli(Cli,Sess,gNc_3729);
                                                    {4298}out(c, (pkCli_3430,m1_3730,sign(m1_3730,skCli_3429)));
                                                    {4299}in(c, (PartS_3731: bitstring,sigPartS_3732: bitstring));
                                                    {4300}if (verify(PartS_3731,sigPartS_3732,pkSess_3724) <> true) then
                                                        0
                                                    else
                                                        {4301}event endCli(Sess,Cli,PartS_3731)
                                                )
                                                else
                                                    {4302}let pkSess_3733: bitstring = pub(skI) in
                                                    {4303}out(c, GetEndpointRequest);
                                                    {4304}in(c, (SPs_3734: bitstring,=Sign,UP_3735: bitstring,=pkSess_3733));
                                                    {4305}new SPc_3736: bitstring;
                                                    {4306}new Nc_3737: bitstring;
                                                    {4307}let gNc_3738: bitstring = exp(g,Nc_3737) in
                                                    {4308}let m1_3739: bitstring = (SPc_3736,gNc_3738) in
                                                    {4309}event beginCli(Cli,Sess,gNc_3738);
                                                    {4310}out(c, (pkCli_3430,m1_3739,sign(m1_3739,skCli_3429)));
                                                    {4311}in(c, (PartS_3740: bitstring,sigPartS_3741: bitstring));
                                                    {4312}if (verify(PartS_3740,sigPartS_3741,pkSess_3733) <> true) then
                                                        0
                                                    else
                                                        {4313}event endCli(Sess,Cli,PartS_3740)
                                            )
                                            else
                                                {4314}let pkSess_3742: bitstring = fail-any in
                                                {4315}out(c, GetEndpointRequest);
                                                {4316}in(c, (SPs_3743: bitstring,=Sign,UP_3744: bitstring,=pkSess_3742));
                                                {4317}new SPc_3745: bitstring;
                                                {4318}new Nc_3746: bitstring;
                                                {4319}let gNc_3747: bitstring = exp(g,Nc_3746) in
                                                {4320}let m1_3748: bitstring = (SPc_3745,gNc_3747) in
                                                {4321}event beginCli(Cli,Sess,gNc_3747);
                                                {4322}out(c, (pkCli_3430,m1_3748,sign(m1_3748,skCli_3429)));
                                                {4323}in(c, (PartS_3749: bitstring,sigPartS_3750: bitstring));
                                                {4324}if (verify(PartS_3749,sigPartS_3750,pkSess_3742) <> true) then
                                                    0
                                                else
                                                    {4325}event endCli(Sess,Cli,PartS_3749)
                                    )
                                    else
                                        {4326}let pkSess_3751: bitstring = fail-any in
                                        {4327}out(c, GetEndpointRequest);
                                        {4328}in(c, (SPs_3752: bitstring,=Sign,UP_3753: bitstring,=pkSess_3751));
                                        {4329}new SPc_3754: bitstring;
                                        {4330}new Nc_3755: bitstring;
                                        {4331}let gNc_3756: bitstring = exp(g,Nc_3755) in
                                        {4332}let m1_3757: bitstring = (SPc_3754,gNc_3756) in
                                        {4333}event beginCli(Cli,Sess,gNc_3756);
                                        {4334}out(c, (pkCli_3430,m1_3757,sign(m1_3757,skCli_3429)));
                                        {4335}in(c, (PartS_3758: bitstring,sigPartS_3759: bitstring));
                                        {4336}if (verify(PartS_3758,sigPartS_3759,pkSess_3751) <> true) then
                                            0
                                        else
                                            {4337}event endCli(Sess,Cli,PartS_3758)
                            )
                            else
                                {4338}let pkSess_3760: bitstring = fail-any in
                                {4339}out(c, GetEndpointRequest);
                                {4340}in(c, (SPs_3761: bitstring,=Sign,UP_3762: bitstring,=pkSess_3760));
                                {4341}new SPc_3763: bitstring;
                                {4342}new Nc_3764: bitstring;
                                {4343}let gNc_3765: bitstring = exp(g,Nc_3764) in
                                {4344}let m1_3766: bitstring = (SPc_3763,gNc_3765) in
                                {4345}event beginCli(Cli,Sess,gNc_3765);
                                {4346}out(c, (pkCli_3430,m1_3766,sign(m1_3766,skCli_3429)));
                                {4347}in(c, (PartS_3767: bitstring,sigPartS_3768: bitstring));
                                {4348}if (verify(PartS_3767,sigPartS_3768,pkSess_3760) <> true) then
                                    0
                                else
                                    {4349}event endCli(Sess,Cli,PartS_3767)
                )
                else
                    {4350}let pkDisco_3769: bitstring = fail-any in
                    {4351}let v_3770: bool = (Sess = A) in
                    (
                        {4352}if v_3770 then
                        (
                            {4353}let pkSess_3771: bitstring = pub(skA) in
                            {4354}out(c, GetEndpointRequest);
                            {4355}in(c, (SPs_3772: bitstring,=Sign,UP_3773: bitstring,=pkSess_3771));
                            {4356}new SPc_3774: bitstring;
                            {4357}new Nc_3775: bitstring;
                            {4358}let gNc_3776: bitstring = exp(g,Nc_3775) in
                            {4359}let m1_3777: bitstring = (SPc_3774,gNc_3776) in
                            {4360}event beginCli(Cli,Sess,gNc_3776);
                            {4361}out(c, (pkCli_3430,m1_3777,sign(m1_3777,skCli_3429)));
                            {4362}in(c, (PartS_3778: bitstring,sigPartS_3779: bitstring));
                            {4363}if (verify(PartS_3778,sigPartS_3779,pkSess_3771) <> true) then
                                0
                            else
                                {4364}event endCli(Sess,Cli,PartS_3778)
                        )
                        else
                            {4365}let v_3780: bool = (Sess = B) in
                            (
                                {4366}if v_3780 then
                                (
                                    {4367}let pkSess_3781: bitstring = pub(skB) in
                                    {4368}out(c, GetEndpointRequest);
                                    {4369}in(c, (SPs_3782: bitstring,=Sign,UP_3783: bitstring,=pkSess_3781));
                                    {4370}new SPc_3784: bitstring;
                                    {4371}new Nc_3785: bitstring;
                                    {4372}let gNc_3786: bitstring = exp(g,Nc_3785) in
                                    {4373}let m1_3787: bitstring = (SPc_3784,gNc_3786) in
                                    {4374}event beginCli(Cli,Sess,gNc_3786);
                                    {4375}out(c, (pkCli_3430,m1_3787,sign(m1_3787,skCli_3429)));
                                    {4376}in(c, (PartS_3788: bitstring,sigPartS_3789: bitstring));
                                    {4377}if (verify(PartS_3788,sigPartS_3789,pkSess_3781) <> true) then
                                        0
                                    else
                                        {4378}event endCli(Sess,Cli,PartS_3788)
                                )
                                else
                                    {4379}let v_3790: bool = (Sess = C) in
                                    (
                                        {4380}if v_3790 then
                                        (
                                            {4381}let pkSess_3791: bitstring = pub(skC) in
                                            {4382}out(c, GetEndpointRequest);
                                            {4383}in(c, (SPs_3792: bitstring,=Sign,UP_3793: bitstring,=pkSess_3791));
                                            {4384}new SPc_3794: bitstring;
                                            {4385}new Nc_3795: bitstring;
                                            {4386}let gNc_3796: bitstring = exp(g,Nc_3795) in
                                            {4387}let m1_3797: bitstring = (SPc_3794,gNc_3796) in
                                            {4388}event beginCli(Cli,Sess,gNc_3796);
                                            {4389}out(c, (pkCli_3430,m1_3797,sign(m1_3797,skCli_3429)));
                                            {4390}in(c, (PartS_3798: bitstring,sigPartS_3799: bitstring));
                                            {4391}if (verify(PartS_3798,sigPartS_3799,pkSess_3791) <> true) then
                                                0
                                            else
                                                {4392}event endCli(Sess,Cli,PartS_3798)
                                        )
                                        else
                                            {4393}let pkSess_3800: bitstring = pub(skI) in
                                            {4394}out(c, GetEndpointRequest);
                                            {4395}in(c, (SPs_3801: bitstring,=Sign,UP_3802: bitstring,=pkSess_3800));
                                            {4396}new SPc_3803: bitstring;
                                            {4397}new Nc_3804: bitstring;
                                            {4398}let gNc_3805: bitstring = exp(g,Nc_3804) in
                                            {4399}let m1_3806: bitstring = (SPc_3803,gNc_3805) in
                                            {4400}event beginCli(Cli,Sess,gNc_3805);
                                            {4401}out(c, (pkCli_3430,m1_3806,sign(m1_3806,skCli_3429)));
                                            {4402}in(c, (PartS_3807: bitstring,sigPartS_3808: bitstring));
                                            {4403}if (verify(PartS_3807,sigPartS_3808,pkSess_3800) <> true) then
                                                0
                                            else
                                                {4404}event endCli(Sess,Cli,PartS_3807)
                                    )
                                    else
                                        {4405}let pkSess_3809: bitstring = fail-any in
                                        {4406}out(c, GetEndpointRequest);
                                        {4407}in(c, (SPs_3810: bitstring,=Sign,UP_3811: bitstring,=pkSess_3809));
                                        {4408}new SPc_3812: bitstring;
                                        {4409}new Nc_3813: bitstring;
                                        {4410}let gNc_3814: bitstring = exp(g,Nc_3813) in
                                        {4411}let m1_3815: bitstring = (SPc_3812,gNc_3814) in
                                        {4412}event beginCli(Cli,Sess,gNc_3814);
                                        {4413}out(c, (pkCli_3430,m1_3815,sign(m1_3815,skCli_3429)));
                                        {4414}in(c, (PartS_3816: bitstring,sigPartS_3817: bitstring));
                                        {4415}if (verify(PartS_3816,sigPartS_3817,pkSess_3809) <> true) then
                                            0
                                        else
                                            {4416}event endCli(Sess,Cli,PartS_3816)
                            )
                            else
                                {4417}let pkSess_3818: bitstring = fail-any in
                                {4418}out(c, GetEndpointRequest);
                                {4419}in(c, (SPs_3819: bitstring,=Sign,UP_3820: bitstring,=pkSess_3818));
                                {4420}new SPc_3821: bitstring;
                                {4421}new Nc_3822: bitstring;
                                {4422}let gNc_3823: bitstring = exp(g,Nc_3822) in
                                {4423}let m1_3824: bitstring = (SPc_3821,gNc_3823) in
                                {4424}event beginCli(Cli,Sess,gNc_3823);
                                {4425}out(c, (pkCli_3430,m1_3824,sign(m1_3824,skCli_3429)));
                                {4426}in(c, (PartS_3825: bitstring,sigPartS_3826: bitstring));
                                {4427}if (verify(PartS_3825,sigPartS_3826,pkSess_3818) <> true) then
                                    0
                                else
                                    {4428}event endCli(Sess,Cli,PartS_3825)
                    )
                    else
                        {4429}let pkSess_3827: bitstring = fail-any in
                        {4430}out(c, GetEndpointRequest);
                        {4431}in(c, (SPs_3828: bitstring,=Sign,UP_3829: bitstring,=pkSess_3827));
                        {4432}new SPc_3830: bitstring;
                        {4433}new Nc_3831: bitstring;
                        {4434}let gNc_3832: bitstring = exp(g,Nc_3831) in
                        {4435}let m1_3833: bitstring = (SPc_3830,gNc_3832) in
                        {4436}event beginCli(Cli,Sess,gNc_3832);
                        {4437}out(c, (pkCli_3430,m1_3833,sign(m1_3833,skCli_3429)));
                        {4438}in(c, (PartS_3834: bitstring,sigPartS_3835: bitstring));
                        {4439}if (verify(PartS_3834,sigPartS_3835,pkSess_3827) <> true) then
                            0
                        else
                            {4440}event endCli(Sess,Cli,PartS_3834)
        )
        else
            {4441}let pkDisco_3836: bitstring = fail-any in
            {4442}let v_3837: bool = (Sess = A) in
            (
                {4443}if v_3837 then
                (
                    {4444}let pkSess_3838: bitstring = pub(skA) in
                    {4445}out(c, GetEndpointRequest);
                    {4446}in(c, (SPs_3839: bitstring,=Sign,UP_3840: bitstring,=pkSess_3838));
                    {4447}new SPc_3841: bitstring;
                    {4448}new Nc_3842: bitstring;
                    {4449}let gNc_3843: bitstring = exp(g,Nc_3842) in
                    {4450}let m1_3844: bitstring = (SPc_3841,gNc_3843) in
                    {4451}event beginCli(Cli,Sess,gNc_3843);
                    {4452}out(c, (pkCli_3430,m1_3844,sign(m1_3844,skCli_3429)));
                    {4453}in(c, (PartS_3845: bitstring,sigPartS_3846: bitstring));
                    {4454}if (verify(PartS_3845,sigPartS_3846,pkSess_3838) <> true) then
                        0
                    else
                        {4455}event endCli(Sess,Cli,PartS_3845)
                )
                else
                    {4456}let v_3847: bool = (Sess = B) in
                    (
                        {4457}if v_3847 then
                        (
                            {4458}let pkSess_3848: bitstring = pub(skB) in
                            {4459}out(c, GetEndpointRequest);
                            {4460}in(c, (SPs_3849: bitstring,=Sign,UP_3850: bitstring,=pkSess_3848));
                            {4461}new SPc_3851: bitstring;
                            {4462}new Nc_3852: bitstring;
                            {4463}let gNc_3853: bitstring = exp(g,Nc_3852) in
                            {4464}let m1_3854: bitstring = (SPc_3851,gNc_3853) in
                            {4465}event beginCli(Cli,Sess,gNc_3853);
                            {4466}out(c, (pkCli_3430,m1_3854,sign(m1_3854,skCli_3429)));
                            {4467}in(c, (PartS_3855: bitstring,sigPartS_3856: bitstring));
                            {4468}if (verify(PartS_3855,sigPartS_3856,pkSess_3848) <> true) then
                                0
                            else
                                {4469}event endCli(Sess,Cli,PartS_3855)
                        )
                        else
                            {4470}let v_3857: bool = (Sess = C) in
                            (
                                {4471}if v_3857 then
                                (
                                    {4472}let pkSess_3858: bitstring = pub(skC) in
                                    {4473}out(c, GetEndpointRequest);
                                    {4474}in(c, (SPs_3859: bitstring,=Sign,UP_3860: bitstring,=pkSess_3858));
                                    {4475}new SPc_3861: bitstring;
                                    {4476}new Nc_3862: bitstring;
                                    {4477}let gNc_3863: bitstring = exp(g,Nc_3862) in
                                    {4478}let m1_3864: bitstring = (SPc_3861,gNc_3863) in
                                    {4479}event beginCli(Cli,Sess,gNc_3863);
                                    {4480}out(c, (pkCli_3430,m1_3864,sign(m1_3864,skCli_3429)));
                                    {4481}in(c, (PartS_3865: bitstring,sigPartS_3866: bitstring));
                                    {4482}if (verify(PartS_3865,sigPartS_3866,pkSess_3858) <> true) then
                                        0
                                    else
                                        {4483}event endCli(Sess,Cli,PartS_3865)
                                )
                                else
                                    {4484}let pkSess_3867: bitstring = pub(skI) in
                                    {4485}out(c, GetEndpointRequest);
                                    {4486}in(c, (SPs_3868: bitstring,=Sign,UP_3869: bitstring,=pkSess_3867));
                                    {4487}new SPc_3870: bitstring;
                                    {4488}new Nc_3871: bitstring;
                                    {4489}let gNc_3872: bitstring = exp(g,Nc_3871) in
                                    {4490}let m1_3873: bitstring = (SPc_3870,gNc_3872) in
                                    {4491}event beginCli(Cli,Sess,gNc_3872);
                                    {4492}out(c, (pkCli_3430,m1_3873,sign(m1_3873,skCli_3429)));
                                    {4493}in(c, (PartS_3874: bitstring,sigPartS_3875: bitstring));
                                    {4494}if (verify(PartS_3874,sigPartS_3875,pkSess_3867) <> true) then
                                        0
                                    else
                                        {4495}event endCli(Sess,Cli,PartS_3874)
                            )
                            else
                                {4496}let pkSess_3876: bitstring = fail-any in
                                {4497}out(c, GetEndpointRequest);
                                {4498}in(c, (SPs_3877: bitstring,=Sign,UP_3878: bitstring,=pkSess_3876));
                                {4499}new SPc_3879: bitstring;
                                {4500}new Nc_3880: bitstring;
                                {4501}let gNc_3881: bitstring = exp(g,Nc_3880) in
                                {4502}let m1_3882: bitstring = (SPc_3879,gNc_3881) in
                                {4503}event beginCli(Cli,Sess,gNc_3881);
                                {4504}out(c, (pkCli_3430,m1_3882,sign(m1_3882,skCli_3429)));
                                {4505}in(c, (PartS_3883: bitstring,sigPartS_3884: bitstring));
                                {4506}if (verify(PartS_3883,sigPartS_3884,pkSess_3876) <> true) then
                                    0
                                else
                                    {4507}event endCli(Sess,Cli,PartS_3883)
                    )
                    else
                        {4508}let pkSess_3885: bitstring = fail-any in
                        {4509}out(c, GetEndpointRequest);
                        {4510}in(c, (SPs_3886: bitstring,=Sign,UP_3887: bitstring,=pkSess_3885));
                        {4511}new SPc_3888: bitstring;
                        {4512}new Nc_3889: bitstring;
                        {4513}let gNc_3890: bitstring = exp(g,Nc_3889) in
                        {4514}let m1_3891: bitstring = (SPc_3888,gNc_3890) in
                        {4515}event beginCli(Cli,Sess,gNc_3890);
                        {4516}out(c, (pkCli_3430,m1_3891,sign(m1_3891,skCli_3429)));
                        {4517}in(c, (PartS_3892: bitstring,sigPartS_3893: bitstring));
                        {4518}if (verify(PartS_3892,sigPartS_3893,pkSess_3885) <> true) then
                            0
                        else
                            {4519}event endCli(Sess,Cli,PartS_3892)
            )
            else
                {4520}let pkSess_3894: bitstring = fail-any in
                {4521}out(c, GetEndpointRequest);
                {4522}in(c, (SPs_3895: bitstring,=Sign,UP_3896: bitstring,=pkSess_3894));
                {4523}new SPc_3897: bitstring;
                {4524}new Nc_3898: bitstring;
                {4525}let gNc_3899: bitstring = exp(g,Nc_3898) in
                {4526}let m1_3900: bitstring = (SPc_3897,gNc_3899) in
                {4527}event beginCli(Cli,Sess,gNc_3899);
                {4528}out(c, (pkCli_3430,m1_3900,sign(m1_3900,skCli_3429)));
                {4529}in(c, (PartS_3901: bitstring,sigPartS_3902: bitstring));
                {4530}if (verify(PartS_3901,sigPartS_3902,pkSess_3894) <> true) then
                    0
                else
                    {4531}event endCli(Sess,Cli,PartS_3901)
) | (
    {4532}!
    {4533}in(c, (Cli_3903: host,Disco_3904: host,Sess_3905: host));
    {4534}let v_3906: bool = (Disco_3904 = A) in
    (
        {4535}if v_3906 then
        (
            {4536}let skDisco: bitstring = skA in
            {4537}let pkDisco_3907: bitstring = pub(skDisco) in
            {4538}let v_3908: bool = (Cli_3903 = A) in
            (
                {4539}if v_3908 then
                (
                    {4540}let pkCli_3909: bitstring = pub(skA) in
                    {4541}let v_3910: bool = (Sess_3905 = A) in
                    (
                        {4542}if v_3910 then
                        (
                            {4543}let pkSess_3911: bitstring = pub(skA) in
                            {4544}in(c, =GetEndpointRequest);
                            {4545}new SPs_3912: bitstring;
                            {4546}new UP_3913: bitstring;
                            {4547}out(c, (SPs_3912,None,UP_3913,pkSess_3911))
                        )
                        else
                            {4548}let v_3914: bool = (Sess_3905 = B) in
                            (
                                {4549}if v_3914 then
                                (
                                    {4550}let pkSess_3915: bitstring = pub(skB) in
                                    {4551}in(c, =GetEndpointRequest);
                                    {4552}new SPs_3916: bitstring;
                                    {4553}new UP_3917: bitstring;
                                    {4554}out(c, (SPs_3916,None,UP_3917,pkSess_3915))
                                )
                                else
                                    {4555}let v_3918: bool = (Sess_3905 = C) in
                                    (
                                        {4556}if v_3918 then
                                        (
                                            {4557}let pkSess_3919: bitstring = pub(skC) in
                                            {4558}in(c, =GetEndpointRequest);
                                            {4559}new SPs_3920: bitstring;
                                            {4560}new UP_3921: bitstring;
                                            {4561}out(c, (SPs_3920,None,UP_3921,pkSess_3919))
                                        )
                                        else
                                            {4562}let pkSess_3922: bitstring = pub(skI) in
                                            {4563}in(c, =GetEndpointRequest);
                                            {4564}new SPs_3923: bitstring;
                                            {4565}new UP_3924: bitstring;
                                            {4566}out(c, (SPs_3923,None,UP_3924,pkSess_3922))
                                    )
                                    else
                                        {4567}let pkSess_3925: bitstring = fail-any in
                                        {4568}in(c, =GetEndpointRequest);
                                        {4569}new SPs_3926: bitstring;
                                        {4570}new UP_3927: bitstring;
                                        {4571}out(c, (SPs_3926,None,UP_3927,pkSess_3925))
                            )
                            else
                                {4572}let pkSess_3928: bitstring = fail-any in
                                {4573}in(c, =GetEndpointRequest);
                                {4574}new SPs_3929: bitstring;
                                {4575}new UP_3930: bitstring;
                                {4576}out(c, (SPs_3929,None,UP_3930,pkSess_3928))
                    )
                    else
                        {4577}let pkSess_3931: bitstring = fail-any in
                        {4578}in(c, =GetEndpointRequest);
                        {4579}new SPs_3932: bitstring;
                        {4580}new UP_3933: bitstring;
                        {4581}out(c, (SPs_3932,None,UP_3933,pkSess_3931))
                )
                else
                    {4582}let v_3934: bool = (Cli_3903 = B) in
                    (
                        {4583}if v_3934 then
                        (
                            {4584}let pkCli_3935: bitstring = pub(skB) in
                            {4585}let v_3936: bool = (Sess_3905 = A) in
                            (
                                {4586}if v_3936 then
                                (
                                    {4587}let pkSess_3937: bitstring = pub(skA) in
                                    {4588}in(c, =GetEndpointRequest);
                                    {4589}new SPs_3938: bitstring;
                                    {4590}new UP_3939: bitstring;
                                    {4591}out(c, (SPs_3938,None,UP_3939,pkSess_3937))
                                )
                                else
                                    {4592}let v_3940: bool = (Sess_3905 = B) in
                                    (
                                        {4593}if v_3940 then
                                        (
                                            {4594}let pkSess_3941: bitstring = pub(skB) in
                                            {4595}in(c, =GetEndpointRequest);
                                            {4596}new SPs_3942: bitstring;
                                            {4597}new UP_3943: bitstring;
                                            {4598}out(c, (SPs_3942,None,UP_3943,pkSess_3941))
                                        )
                                        else
                                            {4599}let v_3944: bool = (Sess_3905 = C) in
                                            (
                                                {4600}if v_3944 then
                                                (
                                                    {4601}let pkSess_3945: bitstring = pub(skC) in
                                                    {4602}in(c, =GetEndpointRequest);
                                                    {4603}new SPs_3946: bitstring;
                                                    {4604}new UP_3947: bitstring;
                                                    {4605}out(c, (SPs_3946,None,UP_3947,pkSess_3945))
                                                )
                                                else
                                                    {4606}let pkSess_3948: bitstring = pub(skI) in
                                                    {4607}in(c, =GetEndpointRequest);
                                                    {4608}new SPs_3949: bitstring;
                                                    {4609}new UP_3950: bitstring;
                                                    {4610}out(c, (SPs_3949,None,UP_3950,pkSess_3948))
                                            )
                                            else
                                                {4611}let pkSess_3951: bitstring = fail-any in
                                                {4612}in(c, =GetEndpointRequest);
                                                {4613}new SPs_3952: bitstring;
                                                {4614}new UP_3953: bitstring;
                                                {4615}out(c, (SPs_3952,None,UP_3953,pkSess_3951))
                                    )
                                    else
                                        {4616}let pkSess_3954: bitstring = fail-any in
                                        {4617}in(c, =GetEndpointRequest);
                                        {4618}new SPs_3955: bitstring;
                                        {4619}new UP_3956: bitstring;
                                        {4620}out(c, (SPs_3955,None,UP_3956,pkSess_3954))
                            )
                            else
                                {4621}let pkSess_3957: bitstring = fail-any in
                                {4622}in(c, =GetEndpointRequest);
                                {4623}new SPs_3958: bitstring;
                                {4624}new UP_3959: bitstring;
                                {4625}out(c, (SPs_3958,None,UP_3959,pkSess_3957))
                        )
                        else
                            {4626}let v_3960: bool = (Cli_3903 = C) in
                            (
                                {4627}if v_3960 then
                                (
                                    {4628}let pkCli_3961: bitstring = pub(skC) in
                                    {4629}let v_3962: bool = (Sess_3905 = A) in
                                    (
                                        {4630}if v_3962 then
                                        (
                                            {4631}let pkSess_3963: bitstring = pub(skA) in
                                            {4632}in(c, =GetEndpointRequest);
                                            {4633}new SPs_3964: bitstring;
                                            {4634}new UP_3965: bitstring;
                                            {4635}out(c, (SPs_3964,None,UP_3965,pkSess_3963))
                                        )
                                        else
                                            {4636}let v_3966: bool = (Sess_3905 = B) in
                                            (
                                                {4637}if v_3966 then
                                                (
                                                    {4638}let pkSess_3967: bitstring = pub(skB) in
                                                    {4639}in(c, =GetEndpointRequest);
                                                    {4640}new SPs_3968: bitstring;
                                                    {4641}new UP_3969: bitstring;
                                                    {4642}out(c, (SPs_3968,None,UP_3969,pkSess_3967))
                                                )
                                                else
                                                    {4643}let v_3970: bool = (Sess_3905 = C) in
                                                    (
                                                        {4644}if v_3970 then
                                                        (
                                                            {4645}let pkSess_3971: bitstring = pub(skC) in
                                                            {4646}in(c, =GetEndpointRequest);
                                                            {4647}new SPs_3972: bitstring;
                                                            {4648}new UP_3973: bitstring;
                                                            {4649}out(c, (SPs_3972,None,UP_3973,pkSess_3971))
                                                        )
                                                        else
                                                            {4650}let pkSess_3974: bitstring = pub(skI) in
                                                            {4651}in(c, =GetEndpointRequest);
                                                            {4652}new SPs_3975: bitstring;
                                                            {4653}new UP_3976: bitstring;
                                                            {4654}out(c, (SPs_3975,None,UP_3976,pkSess_3974))
                                                    )
                                                    else
                                                        {4655}let pkSess_3977: bitstring = fail-any in
                                                        {4656}in(c, =GetEndpointRequest);
                                                        {4657}new SPs_3978: bitstring;
                                                        {4658}new UP_3979: bitstring;
                                                        {4659}out(c, (SPs_3978,None,UP_3979,pkSess_3977))
                                            )
                                            else
                                                {4660}let pkSess_3980: bitstring = fail-any in
                                                {4661}in(c, =GetEndpointRequest);
                                                {4662}new SPs_3981: bitstring;
                                                {4663}new UP_3982: bitstring;
                                                {4664}out(c, (SPs_3981,None,UP_3982,pkSess_3980))
                                    )
                                    else
                                        {4665}let pkSess_3983: bitstring = fail-any in
                                        {4666}in(c, =GetEndpointRequest);
                                        {4667}new SPs_3984: bitstring;
                                        {4668}new UP_3985: bitstring;
                                        {4669}out(c, (SPs_3984,None,UP_3985,pkSess_3983))
                                )
                                else
                                    {4670}let pkCli_3986: bitstring = pub(skI) in
                                    {4671}let v_3987: bool = (Sess_3905 = A) in
                                    (
                                        {4672}if v_3987 then
                                        (
                                            {4673}let pkSess_3988: bitstring = pub(skA) in
                                            {4674}in(c, =GetEndpointRequest);
                                            {4675}new SPs_3989: bitstring;
                                            {4676}new UP_3990: bitstring;
                                            {4677}out(c, (SPs_3989,None,UP_3990,pkSess_3988))
                                        )
                                        else
                                            {4678}let v_3991: bool = (Sess_3905 = B) in
                                            (
                                                {4679}if v_3991 then
                                                (
                                                    {4680}let pkSess_3992: bitstring = pub(skB) in
                                                    {4681}in(c, =GetEndpointRequest);
                                                    {4682}new SPs_3993: bitstring;
                                                    {4683}new UP_3994: bitstring;
                                                    {4684}out(c, (SPs_3993,None,UP_3994,pkSess_3992))
                                                )
                                                else
                                                    {4685}let v_3995: bool = (Sess_3905 = C) in
                                                    (
                                                        {4686}if v_3995 then
                                                        (
                                                            {4687}let pkSess_3996: bitstring = pub(skC) in
                                                            {4688}in(c, =GetEndpointRequest);
                                                            {4689}new SPs_3997: bitstring;
                                                            {4690}new UP_3998: bitstring;
                                                            {4691}out(c, (SPs_3997,None,UP_3998,pkSess_3996))
                                                        )
                                                        else
                                                            {4692}let pkSess_3999: bitstring = pub(skI) in
                                                            {4693}in(c, =GetEndpointRequest);
                                                            {4694}new SPs_4000: bitstring;
                                                            {4695}new UP_4001: bitstring;
                                                            {4696}out(c, (SPs_4000,None,UP_4001,pkSess_3999))
                                                    )
                                                    else
                                                        {4697}let pkSess_4002: bitstring = fail-any in
                                                        {4698}in(c, =GetEndpointRequest);
                                                        {4699}new SPs_4003: bitstring;
                                                        {4700}new UP_4004: bitstring;
                                                        {4701}out(c, (SPs_4003,None,UP_4004,pkSess_4002))
                                            )
                                            else
                                                {4702}let pkSess_4005: bitstring = fail-any in
                                                {4703}in(c, =GetEndpointRequest);
                                                {4704}new SPs_4006: bitstring;
                                                {4705}new UP_4007: bitstring;
                                                {4706}out(c, (SPs_4006,None,UP_4007,pkSess_4005))
                                    )
                                    else
                                        {4707}let pkSess_4008: bitstring = fail-any in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SPs_4009: bitstring;
                                        {4710}new UP_4010: bitstring;
                                        {4711}out(c, (SPs_4009,None,UP_4010,pkSess_4008))
                            )
                            else
                                {4712}let pkCli_4011: bitstring = fail-any in
                                {4713}let v_4012: bool = (Sess_3905 = A) in
                                (
                                    {4714}if v_4012 then
                                    (
                                        {4715}let pkSess_4013: bitstring = pub(skA) in
                                        {4716}in(c, =GetEndpointRequest);
                                        {4717}new SPs_4014: bitstring;
                                        {4718}new UP_4015: bitstring;
                                        {4719}out(c, (SPs_4014,None,UP_4015,pkSess_4013))
                                    )
                                    else
                                        {4720}let v_4016: bool = (Sess_3905 = B) in
                                        (
                                            {4721}if v_4016 then
                                            (
                                                {4722}let pkSess_4017: bitstring = pub(skB) in
                                                {4723}in(c, =GetEndpointRequest);
                                                {4724}new SPs_4018: bitstring;
                                                {4725}new UP_4019: bitstring;
                                                {4726}out(c, (SPs_4018,None,UP_4019,pkSess_4017))
                                            )
                                            else
                                                {4727}let v_4020: bool = (Sess_3905 = C) in
                                                (
                                                    {4728}if v_4020 then
                                                    (
                                                        {4729}let pkSess_4021: bitstring = pub(skC) in
                                                        {4730}in(c, =GetEndpointRequest);
                                                        {4731}new SPs_4022: bitstring;
                                                        {4732}new UP_4023: bitstring;
                                                        {4733}out(c, (SPs_4022,None,UP_4023,pkSess_4021))
                                                    )
                                                    else
                                                        {4734}let pkSess_4024: bitstring = pub(skI) in
                                                        {4735}in(c, =GetEndpointRequest);
                                                        {4736}new SPs_4025: bitstring;
                                                        {4737}new UP_4026: bitstring;
                                                        {4738}out(c, (SPs_4025,None,UP_4026,pkSess_4024))
                                                )
                                                else
                                                    {4739}let pkSess_4027: bitstring = fail-any in
                                                    {4740}in(c, =GetEndpointRequest);
                                                    {4741}new SPs_4028: bitstring;
                                                    {4742}new UP_4029: bitstring;
                                                    {4743}out(c, (SPs_4028,None,UP_4029,pkSess_4027))
                                        )
                                        else
                                            {4744}let pkSess_4030: bitstring = fail-any in
                                            {4745}in(c, =GetEndpointRequest);
                                            {4746}new SPs_4031: bitstring;
                                            {4747}new UP_4032: bitstring;
                                            {4748}out(c, (SPs_4031,None,UP_4032,pkSess_4030))
                                )
                                else
                                    {4749}let pkSess_4033: bitstring = fail-any in
                                    {4750}in(c, =GetEndpointRequest);
                                    {4751}new SPs_4034: bitstring;
                                    {4752}new UP_4035: bitstring;
                                    {4753}out(c, (SPs_4034,None,UP_4035,pkSess_4033))
                    )
                    else
                        {4754}let pkCli_4036: bitstring = fail-any in
                        {4755}let v_4037: bool = (Sess_3905 = A) in
                        (
                            {4756}if v_4037 then
                            (
                                {4757}let pkSess_4038: bitstring = pub(skA) in
                                {4758}in(c, =GetEndpointRequest);
                                {4759}new SPs_4039: bitstring;
                                {4760}new UP_4040: bitstring;
                                {4761}out(c, (SPs_4039,None,UP_4040,pkSess_4038))
                            )
                            else
                                {4762}let v_4041: bool = (Sess_3905 = B) in
                                (
                                    {4763}if v_4041 then
                                    (
                                        {4764}let pkSess_4042: bitstring = pub(skB) in
                                        {4765}in(c, =GetEndpointRequest);
                                        {4766}new SPs_4043: bitstring;
                                        {4767}new UP_4044: bitstring;
                                        {4768}out(c, (SPs_4043,None,UP_4044,pkSess_4042))
                                    )
                                    else
                                        {4769}let v_4045: bool = (Sess_3905 = C) in
                                        (
                                            {4770}if v_4045 then
                                            (
                                                {4771}let pkSess_4046: bitstring = pub(skC) in
                                                {4772}in(c, =GetEndpointRequest);
                                                {4773}new SPs_4047: bitstring;
                                                {4774}new UP_4048: bitstring;
                                                {4775}out(c, (SPs_4047,None,UP_4048,pkSess_4046))
                                            )
                                            else
                                                {4776}let pkSess_4049: bitstring = pub(skI) in
                                                {4777}in(c, =GetEndpointRequest);
                                                {4778}new SPs_4050: bitstring;
                                                {4779}new UP_4051: bitstring;
                                                {4780}out(c, (SPs_4050,None,UP_4051,pkSess_4049))
                                        )
                                        else
                                            {4781}let pkSess_4052: bitstring = fail-any in
                                            {4782}in(c, =GetEndpointRequest);
                                            {4783}new SPs_4053: bitstring;
                                            {4784}new UP_4054: bitstring;
                                            {4785}out(c, (SPs_4053,None,UP_4054,pkSess_4052))
                                )
                                else
                                    {4786}let pkSess_4055: bitstring = fail-any in
                                    {4787}in(c, =GetEndpointRequest);
                                    {4788}new SPs_4056: bitstring;
                                    {4789}new UP_4057: bitstring;
                                    {4790}out(c, (SPs_4056,None,UP_4057,pkSess_4055))
                        )
                        else
                            {4791}let pkSess_4058: bitstring = fail-any in
                            {4792}in(c, =GetEndpointRequest);
                            {4793}new SPs_4059: bitstring;
                            {4794}new UP_4060: bitstring;
                            {4795}out(c, (SPs_4059,None,UP_4060,pkSess_4058))
            )
            else
                {4796}let pkCli_4061: bitstring = fail-any in
                {4797}let v_4062: bool = (Sess_3905 = A) in
                (
                    {4798}if v_4062 then
                    (
                        {4799}let pkSess_4063: bitstring = pub(skA) in
                        {4800}in(c, =GetEndpointRequest);
                        {4801}new SPs_4064: bitstring;
                        {4802}new UP_4065: bitstring;
                        {4803}out(c, (SPs_4064,None,UP_4065,pkSess_4063))
                    )
                    else
                        {4804}let v_4066: bool = (Sess_3905 = B) in
                        (
                            {4805}if v_4066 then
                            (
                                {4806}let pkSess_4067: bitstring = pub(skB) in
                                {4807}in(c, =GetEndpointRequest);
                                {4808}new SPs_4068: bitstring;
                                {4809}new UP_4069: bitstring;
                                {4810}out(c, (SPs_4068,None,UP_4069,pkSess_4067))
                            )
                            else
                                {4811}let v_4070: bool = (Sess_3905 = C) in
                                (
                                    {4812}if v_4070 then
                                    (
                                        {4813}let pkSess_4071: bitstring = pub(skC) in
                                        {4814}in(c, =GetEndpointRequest);
                                        {4815}new SPs_4072: bitstring;
                                        {4816}new UP_4073: bitstring;
                                        {4817}out(c, (SPs_4072,None,UP_4073,pkSess_4071))
                                    )
                                    else
                                        {4818}let pkSess_4074: bitstring = pub(skI) in
                                        {4819}in(c, =GetEndpointRequest);
                                        {4820}new SPs_4075: bitstring;
                                        {4821}new UP_4076: bitstring;
                                        {4822}out(c, (SPs_4075,None,UP_4076,pkSess_4074))
                                )
                                else
                                    {4823}let pkSess_4077: bitstring = fail-any in
                                    {4824}in(c, =GetEndpointRequest);
                                    {4825}new SPs_4078: bitstring;
                                    {4826}new UP_4079: bitstring;
                                    {4827}out(c, (SPs_4078,None,UP_4079,pkSess_4077))
                        )
                        else
                            {4828}let pkSess_4080: bitstring = fail-any in
                            {4829}in(c, =GetEndpointRequest);
                            {4830}new SPs_4081: bitstring;
                            {4831}new UP_4082: bitstring;
                            {4832}out(c, (SPs_4081,None,UP_4082,pkSess_4080))
                )
                else
                    {4833}let pkSess_4083: bitstring = fail-any in
                    {4834}in(c, =GetEndpointRequest);
                    {4835}new SPs_4084: bitstring;
                    {4836}new UP_4085: bitstring;
                    {4837}out(c, (SPs_4084,None,UP_4085,pkSess_4083))
        )
        else
            {4838}let v_4086: bool = (Disco_3904 = B) in
            (
                {4839}if v_4086 then
                (
                    {4840}let skDisco_4087: bitstring = skB in
                    {4841}let pkDisco_4088: bitstring = pub(skDisco_4087) in
                    {4842}let v_4089: bool = (Cli_3903 = A) in
                    (
                        {4843}if v_4089 then
                        (
                            {4844}let pkCli_4090: bitstring = pub(skA) in
                            {4845}let v_4091: bool = (Sess_3905 = A) in
                            (
                                {4846}if v_4091 then
                                (
                                    {4847}let pkSess_4092: bitstring = pub(skA) in
                                    {4848}in(c, =GetEndpointRequest);
                                    {4849}new SPs_4093: bitstring;
                                    {4850}new UP_4094: bitstring;
                                    {4851}out(c, (SPs_4093,None,UP_4094,pkSess_4092))
                                )
                                else
                                    {4852}let v_4095: bool = (Sess_3905 = B) in
                                    (
                                        {4853}if v_4095 then
                                        (
                                            {4854}let pkSess_4096: bitstring = pub(skB) in
                                            {4855}in(c, =GetEndpointRequest);
                                            {4856}new SPs_4097: bitstring;
                                            {4857}new UP_4098: bitstring;
                                            {4858}out(c, (SPs_4097,None,UP_4098,pkSess_4096))
                                        )
                                        else
                                            {4859}let v_4099: bool = (Sess_3905 = C) in
                                            (
                                                {4860}if v_4099 then
                                                (
                                                    {4861}let pkSess_4100: bitstring = pub(skC) in
                                                    {4862}in(c, =GetEndpointRequest);
                                                    {4863}new SPs_4101: bitstring;
                                                    {4864}new UP_4102: bitstring;
                                                    {4865}out(c, (SPs_4101,None,UP_4102,pkSess_4100))
                                                )
                                                else
                                                    {4866}let pkSess_4103: bitstring = pub(skI) in
                                                    {4867}in(c, =GetEndpointRequest);
                                                    {4868}new SPs_4104: bitstring;
                                                    {4869}new UP_4105: bitstring;
                                                    {4870}out(c, (SPs_4104,None,UP_4105,pkSess_4103))
                                            )
                                            else
                                                {4871}let pkSess_4106: bitstring = fail-any in
                                                {4872}in(c, =GetEndpointRequest);
                                                {4873}new SPs_4107: bitstring;
                                                {4874}new UP_4108: bitstring;
                                                {4875}out(c, (SPs_4107,None,UP_4108,pkSess_4106))
                                    )
                                    else
                                        {4876}let pkSess_4109: bitstring = fail-any in
                                        {4877}in(c, =GetEndpointRequest);
                                        {4878}new SPs_4110: bitstring;
                                        {4879}new UP_4111: bitstring;
                                        {4880}out(c, (SPs_4110,None,UP_4111,pkSess_4109))
                            )
                            else
                                {4881}let pkSess_4112: bitstring = fail-any in
                                {4882}in(c, =GetEndpointRequest);
                                {4883}new SPs_4113: bitstring;
                                {4884}new UP_4114: bitstring;
                                {4885}out(c, (SPs_4113,None,UP_4114,pkSess_4112))
                        )
                        else
                            {4886}let v_4115: bool = (Cli_3903 = B) in
                            (
                                {4887}if v_4115 then
                                (
                                    {4888}let pkCli_4116: bitstring = pub(skB) in
                                    {4889}let v_4117: bool = (Sess_3905 = A) in
                                    (
                                        {4890}if v_4117 then
                                        (
                                            {4891}let pkSess_4118: bitstring = pub(skA) in
                                            {4892}in(c, =GetEndpointRequest);
                                            {4893}new SPs_4119: bitstring;
                                            {4894}new UP_4120: bitstring;
                                            {4895}out(c, (SPs_4119,None,UP_4120,pkSess_4118))
                                        )
                                        else
                                            {4896}let v_4121: bool = (Sess_3905 = B) in
                                            (
                                                {4897}if v_4121 then
                                                (
                                                    {4898}let pkSess_4122: bitstring = pub(skB) in
                                                    {4899}in(c, =GetEndpointRequest);
                                                    {4900}new SPs_4123: bitstring;
                                                    {4901}new UP_4124: bitstring;
                                                    {4902}out(c, (SPs_4123,None,UP_4124,pkSess_4122))
                                                )
                                                else
                                                    {4903}let v_4125: bool = (Sess_3905 = C) in
                                                    (
                                                        {4904}if v_4125 then
                                                        (
                                                            {4905}let pkSess_4126: bitstring = pub(skC) in
                                                            {4906}in(c, =GetEndpointRequest);
                                                            {4907}new SPs_4127: bitstring;
                                                            {4908}new UP_4128: bitstring;
                                                            {4909}out(c, (SPs_4127,None,UP_4128,pkSess_4126))
                                                        )
                                                        else
                                                            {4910}let pkSess_4129: bitstring = pub(skI) in
                                                            {4911}in(c, =GetEndpointRequest);
                                                            {4912}new SPs_4130: bitstring;
                                                            {4913}new UP_4131: bitstring;
                                                            {4914}out(c, (SPs_4130,None,UP_4131,pkSess_4129))
                                                    )
                                                    else
                                                        {4915}let pkSess_4132: bitstring = fail-any in
                                                        {4916}in(c, =GetEndpointRequest);
                                                        {4917}new SPs_4133: bitstring;
                                                        {4918}new UP_4134: bitstring;
                                                        {4919}out(c, (SPs_4133,None,UP_4134,pkSess_4132))
                                            )
                                            else
                                                {4920}let pkSess_4135: bitstring = fail-any in
                                                {4921}in(c, =GetEndpointRequest);
                                                {4922}new SPs_4136: bitstring;
                                                {4923}new UP_4137: bitstring;
                                                {4924}out(c, (SPs_4136,None,UP_4137,pkSess_4135))
                                    )
                                    else
                                        {4925}let pkSess_4138: bitstring = fail-any in
                                        {4926}in(c, =GetEndpointRequest);
                                        {4927}new SPs_4139: bitstring;
                                        {4928}new UP_4140: bitstring;
                                        {4929}out(c, (SPs_4139,None,UP_4140,pkSess_4138))
                                )
                                else
                                    {4930}let v_4141: bool = (Cli_3903 = C) in
                                    (
                                        {4931}if v_4141 then
                                        (
                                            {4932}let pkCli_4142: bitstring = pub(skC) in
                                            {4933}let v_4143: bool = (Sess_3905 = A) in
                                            (
                                                {4934}if v_4143 then
                                                (
                                                    {4935}let pkSess_4144: bitstring = pub(skA) in
                                                    {4936}in(c, =GetEndpointRequest);
                                                    {4937}new SPs_4145: bitstring;
                                                    {4938}new UP_4146: bitstring;
                                                    {4939}out(c, (SPs_4145,None,UP_4146,pkSess_4144))
                                                )
                                                else
                                                    {4940}let v_4147: bool = (Sess_3905 = B) in
                                                    (
                                                        {4941}if v_4147 then
                                                        (
                                                            {4942}let pkSess_4148: bitstring = pub(skB) in
                                                            {4943}in(c, =GetEndpointRequest);
                                                            {4944}new SPs_4149: bitstring;
                                                            {4945}new UP_4150: bitstring;
                                                            {4946}out(c, (SPs_4149,None,UP_4150,pkSess_4148))
                                                        )
                                                        else
                                                            {4947}let v_4151: bool = (Sess_3905 = C) in
                                                            (
                                                                {4948}if v_4151 then
                                                                (
                                                                    {4949}let pkSess_4152: bitstring = pub(skC) in
                                                                    {4950}in(c, =GetEndpointRequest);
                                                                    {4951}new SPs_4153: bitstring;
                                                                    {4952}new UP_4154: bitstring;
                                                                    {4953}out(c, (SPs_4153,None,UP_4154,pkSess_4152))
                                                                )
                                                                else
                                                                    {4954}let pkSess_4155: bitstring = pub(skI) in
                                                                    {4955}in(c, =GetEndpointRequest);
                                                                    {4956}new SPs_4156: bitstring;
                                                                    {4957}new UP_4157: bitstring;
                                                                    {4958}out(c, (SPs_4156,None,UP_4157,pkSess_4155))
                                                            )
                                                            else
                                                                {4959}let pkSess_4158: bitstring = fail-any in
                                                                {4960}in(c, =GetEndpointRequest);
                                                                {4961}new SPs_4159: bitstring;
                                                                {4962}new UP_4160: bitstring;
                                                                {4963}out(c, (SPs_4159,None,UP_4160,pkSess_4158))
                                                    )
                                                    else
                                                        {4964}let pkSess_4161: bitstring = fail-any in
                                                        {4965}in(c, =GetEndpointRequest);
                                                        {4966}new SPs_4162: bitstring;
                                                        {4967}new UP_4163: bitstring;
                                                        {4968}out(c, (SPs_4162,None,UP_4163,pkSess_4161))
                                            )
                                            else
                                                {4969}let pkSess_4164: bitstring = fail-any in
                                                {4970}in(c, =GetEndpointRequest);
                                                {4971}new SPs_4165: bitstring;
                                                {4972}new UP_4166: bitstring;
                                                {4973}out(c, (SPs_4165,None,UP_4166,pkSess_4164))
                                        )
                                        else
                                            {4974}let pkCli_4167: bitstring = pub(skI) in
                                            {4975}let v_4168: bool = (Sess_3905 = A) in
                                            (
                                                {4976}if v_4168 then
                                                (
                                                    {4977}let pkSess_4169: bitstring = pub(skA) in
                                                    {4978}in(c, =GetEndpointRequest);
                                                    {4979}new SPs_4170: bitstring;
                                                    {4980}new UP_4171: bitstring;
                                                    {4981}out(c, (SPs_4170,None,UP_4171,pkSess_4169))
                                                )
                                                else
                                                    {4982}let v_4172: bool = (Sess_3905 = B) in
                                                    (
                                                        {4983}if v_4172 then
                                                        (
                                                            {4984}let pkSess_4173: bitstring = pub(skB) in
                                                            {4985}in(c, =GetEndpointRequest);
                                                            {4986}new SPs_4174: bitstring;
                                                            {4987}new UP_4175: bitstring;
                                                            {4988}out(c, (SPs_4174,None,UP_4175,pkSess_4173))
                                                        )
                                                        else
                                                            {4989}let v_4176: bool = (Sess_3905 = C) in
                                                            (
                                                                {4990}if v_4176 then
                                                                (
                                                                    {4991}let pkSess_4177: bitstring = pub(skC) in
                                                                    {4992}in(c, =GetEndpointRequest);
                                                                    {4993}new SPs_4178: bitstring;
                                                                    {4994}new UP_4179: bitstring;
                                                                    {4995}out(c, (SPs_4178,None,UP_4179,pkSess_4177))
                                                                )
                                                                else
                                                                    {4996}let pkSess_4180: bitstring = pub(skI) in
                                                                    {4997}in(c, =GetEndpointRequest);
                                                                    {4998}new SPs_4181: bitstring;
                                                                    {4999}new UP_4182: bitstring;
                                                                    {5000}out(c, (SPs_4181,None,UP_4182,pkSess_4180))
                                                            )
                                                            else
                                                                {5001}let pkSess_4183: bitstring = fail-any in
                                                                {5002}in(c, =GetEndpointRequest);
                                                                {5003}new SPs_4184: bitstring;
                                                                {5004}new UP_4185: bitstring;
                                                                {5005}out(c, (SPs_4184,None,UP_4185,pkSess_4183))
                                                    )
                                                    else
                                                        {5006}let pkSess_4186: bitstring = fail-any in
                                                        {5007}in(c, =GetEndpointRequest);
                                                        {5008}new SPs_4187: bitstring;
                                                        {5009}new UP_4188: bitstring;
                                                        {5010}out(c, (SPs_4187,None,UP_4188,pkSess_4186))
                                            )
                                            else
                                                {5011}let pkSess_4189: bitstring = fail-any in
                                                {5012}in(c, =GetEndpointRequest);
                                                {5013}new SPs_4190: bitstring;
                                                {5014}new UP_4191: bitstring;
                                                {5015}out(c, (SPs_4190,None,UP_4191,pkSess_4189))
                                    )
                                    else
                                        {5016}let pkCli_4192: bitstring = fail-any in
                                        {5017}let v_4193: bool = (Sess_3905 = A) in
                                        (
                                            {5018}if v_4193 then
                                            (
                                                {5019}let pkSess_4194: bitstring = pub(skA) in
                                                {5020}in(c, =GetEndpointRequest);
                                                {5021}new SPs_4195: bitstring;
                                                {5022}new UP_4196: bitstring;
                                                {5023}out(c, (SPs_4195,None,UP_4196,pkSess_4194))
                                            )
                                            else
                                                {5024}let v_4197: bool = (Sess_3905 = B) in
                                                (
                                                    {5025}if v_4197 then
                                                    (
                                                        {5026}let pkSess_4198: bitstring = pub(skB) in
                                                        {5027}in(c, =GetEndpointRequest);
                                                        {5028}new SPs_4199: bitstring;
                                                        {5029}new UP_4200: bitstring;
                                                        {5030}out(c, (SPs_4199,None,UP_4200,pkSess_4198))
                                                    )
                                                    else
                                                        {5031}let v_4201: bool = (Sess_3905 = C) in
                                                        (
                                                            {5032}if v_4201 then
                                                            (
                                                                {5033}let pkSess_4202: bitstring = pub(skC) in
                                                                {5034}in(c, =GetEndpointRequest);
                                                                {5035}new SPs_4203: bitstring;
                                                                {5036}new UP_4204: bitstring;
                                                                {5037}out(c, (SPs_4203,None,UP_4204,pkSess_4202))
                                                            )
                                                            else
                                                                {5038}let pkSess_4205: bitstring = pub(skI) in
                                                                {5039}in(c, =GetEndpointRequest);
                                                                {5040}new SPs_4206: bitstring;
                                                                {5041}new UP_4207: bitstring;
                                                                {5042}out(c, (SPs_4206,None,UP_4207,pkSess_4205))
                                                        )
                                                        else
                                                            {5043}let pkSess_4208: bitstring = fail-any in
                                                            {5044}in(c, =GetEndpointRequest);
                                                            {5045}new SPs_4209: bitstring;
                                                            {5046}new UP_4210: bitstring;
                                                            {5047}out(c, (SPs_4209,None,UP_4210,pkSess_4208))
                                                )
                                                else
                                                    {5048}let pkSess_4211: bitstring = fail-any in
                                                    {5049}in(c, =GetEndpointRequest);
                                                    {5050}new SPs_4212: bitstring;
                                                    {5051}new UP_4213: bitstring;
                                                    {5052}out(c, (SPs_4212,None,UP_4213,pkSess_4211))
                                        )
                                        else
                                            {5053}let pkSess_4214: bitstring = fail-any in
                                            {5054}in(c, =GetEndpointRequest);
                                            {5055}new SPs_4215: bitstring;
                                            {5056}new UP_4216: bitstring;
                                            {5057}out(c, (SPs_4215,None,UP_4216,pkSess_4214))
                            )
                            else
                                {5058}let pkCli_4217: bitstring = fail-any in
                                {5059}let v_4218: bool = (Sess_3905 = A) in
                                (
                                    {5060}if v_4218 then
                                    (
                                        {5061}let pkSess_4219: bitstring = pub(skA) in
                                        {5062}in(c, =GetEndpointRequest);
                                        {5063}new SPs_4220: bitstring;
                                        {5064}new UP_4221: bitstring;
                                        {5065}out(c, (SPs_4220,None,UP_4221,pkSess_4219))
                                    )
                                    else
                                        {5066}let v_4222: bool = (Sess_3905 = B) in
                                        (
                                            {5067}if v_4222 then
                                            (
                                                {5068}let pkSess_4223: bitstring = pub(skB) in
                                                {5069}in(c, =GetEndpointRequest);
                                                {5070}new SPs_4224: bitstring;
                                                {5071}new UP_4225: bitstring;
                                                {5072}out(c, (SPs_4224,None,UP_4225,pkSess_4223))
                                            )
                                            else
                                                {5073}let v_4226: bool = (Sess_3905 = C) in
                                                (
                                                    {5074}if v_4226 then
                                                    (
                                                        {5075}let pkSess_4227: bitstring = pub(skC) in
                                                        {5076}in(c, =GetEndpointRequest);
                                                        {5077}new SPs_4228: bitstring;
                                                        {5078}new UP_4229: bitstring;
                                                        {5079}out(c, (SPs_4228,None,UP_4229,pkSess_4227))
                                                    )
                                                    else
                                                        {5080}let pkSess_4230: bitstring = pub(skI) in
                                                        {5081}in(c, =GetEndpointRequest);
                                                        {5082}new SPs_4231: bitstring;
                                                        {5083}new UP_4232: bitstring;
                                                        {5084}out(c, (SPs_4231,None,UP_4232,pkSess_4230))
                                                )
                                                else
                                                    {5085}let pkSess_4233: bitstring = fail-any in
                                                    {5086}in(c, =GetEndpointRequest);
                                                    {5087}new SPs_4234: bitstring;
                                                    {5088}new UP_4235: bitstring;
                                                    {5089}out(c, (SPs_4234,None,UP_4235,pkSess_4233))
                                        )
                                        else
                                            {5090}let pkSess_4236: bitstring = fail-any in
                                            {5091}in(c, =GetEndpointRequest);
                                            {5092}new SPs_4237: bitstring;
                                            {5093}new UP_4238: bitstring;
                                            {5094}out(c, (SPs_4237,None,UP_4238,pkSess_4236))
                                )
                                else
                                    {5095}let pkSess_4239: bitstring = fail-any in
                                    {5096}in(c, =GetEndpointRequest);
                                    {5097}new SPs_4240: bitstring;
                                    {5098}new UP_4241: bitstring;
                                    {5099}out(c, (SPs_4240,None,UP_4241,pkSess_4239))
                    )
                    else
                        {5100}let pkCli_4242: bitstring = fail-any in
                        {5101}let v_4243: bool = (Sess_3905 = A) in
                        (
                            {5102}if v_4243 then
                            (
                                {5103}let pkSess_4244: bitstring = pub(skA) in
                                {5104}in(c, =GetEndpointRequest);
                                {5105}new SPs_4245: bitstring;
                                {5106}new UP_4246: bitstring;
                                {5107}out(c, (SPs_4245,None,UP_4246,pkSess_4244))
                            )
                            else
                                {5108}let v_4247: bool = (Sess_3905 = B) in
                                (
                                    {5109}if v_4247 then
                                    (
                                        {5110}let pkSess_4248: bitstring = pub(skB) in
                                        {5111}in(c, =GetEndpointRequest);
                                        {5112}new SPs_4249: bitstring;
                                        {5113}new UP_4250: bitstring;
                                        {5114}out(c, (SPs_4249,None,UP_4250,pkSess_4248))
                                    )
                                    else
                                        {5115}let v_4251: bool = (Sess_3905 = C) in
                                        (
                                            {5116}if v_4251 then
                                            (
                                                {5117}let pkSess_4252: bitstring = pub(skC) in
                                                {5118}in(c, =GetEndpointRequest);
                                                {5119}new SPs_4253: bitstring;
                                                {5120}new UP_4254: bitstring;
                                                {5121}out(c, (SPs_4253,None,UP_4254,pkSess_4252))
                                            )
                                            else
                                                {5122}let pkSess_4255: bitstring = pub(skI) in
                                                {5123}in(c, =GetEndpointRequest);
                                                {5124}new SPs_4256: bitstring;
                                                {5125}new UP_4257: bitstring;
                                                {5126}out(c, (SPs_4256,None,UP_4257,pkSess_4255))
                                        )
                                        else
                                            {5127}let pkSess_4258: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SPs_4259: bitstring;
                                            {5130}new UP_4260: bitstring;
                                            {5131}out(c, (SPs_4259,None,UP_4260,pkSess_4258))
                                )
                                else
                                    {5132}let pkSess_4261: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SPs_4262: bitstring;
                                    {5135}new UP_4263: bitstring;
                                    {5136}out(c, (SPs_4262,None,UP_4263,pkSess_4261))
                        )
                        else
                            {5137}let pkSess_4264: bitstring = fail-any in
                            {5138}in(c, =GetEndpointRequest);
                            {5139}new SPs_4265: bitstring;
                            {5140}new UP_4266: bitstring;
                            {5141}out(c, (SPs_4265,None,UP_4266,pkSess_4264))
                )
                else
                    {5142}let v_4267: bool = (Disco_3904 = C) in
                    (
                        {5143}if v_4267 then
                        (
                            {5144}let skDisco_4268: bitstring = skC in
                            {5145}let pkDisco_4269: bitstring = pub(skDisco_4268) in
                            {5146}let v_4270: bool = (Cli_3903 = A) in
                            (
                                {5147}if v_4270 then
                                (
                                    {5148}let pkCli_4271: bitstring = pub(skA) in
                                    {5149}let v_4272: bool = (Sess_3905 = A) in
                                    (
                                        {5150}if v_4272 then
                                        (
                                            {5151}let pkSess_4273: bitstring = pub(skA) in
                                            {5152}in(c, =GetEndpointRequest);
                                            {5153}new SPs_4274: bitstring;
                                            {5154}new UP_4275: bitstring;
                                            {5155}out(c, (SPs_4274,None,UP_4275,pkSess_4273))
                                        )
                                        else
                                            {5156}let v_4276: bool = (Sess_3905 = B) in
                                            (
                                                {5157}if v_4276 then
                                                (
                                                    {5158}let pkSess_4277: bitstring = pub(skB) in
                                                    {5159}in(c, =GetEndpointRequest);
                                                    {5160}new SPs_4278: bitstring;
                                                    {5161}new UP_4279: bitstring;
                                                    {5162}out(c, (SPs_4278,None,UP_4279,pkSess_4277))
                                                )
                                                else
                                                    {5163}let v_4280: bool = (Sess_3905 = C) in
                                                    (
                                                        {5164}if v_4280 then
                                                        (
                                                            {5165}let pkSess_4281: bitstring = pub(skC) in
                                                            {5166}in(c, =GetEndpointRequest);
                                                            {5167}new SPs_4282: bitstring;
                                                            {5168}new UP_4283: bitstring;
                                                            {5169}out(c, (SPs_4282,None,UP_4283,pkSess_4281))
                                                        )
                                                        else
                                                            {5170}let pkSess_4284: bitstring = pub(skI) in
                                                            {5171}in(c, =GetEndpointRequest);
                                                            {5172}new SPs_4285: bitstring;
                                                            {5173}new UP_4286: bitstring;
                                                            {5174}out(c, (SPs_4285,None,UP_4286,pkSess_4284))
                                                    )
                                                    else
                                                        {5175}let pkSess_4287: bitstring = fail-any in
                                                        {5176}in(c, =GetEndpointRequest);
                                                        {5177}new SPs_4288: bitstring;
                                                        {5178}new UP_4289: bitstring;
                                                        {5179}out(c, (SPs_4288,None,UP_4289,pkSess_4287))
                                            )
                                            else
                                                {5180}let pkSess_4290: bitstring = fail-any in
                                                {5181}in(c, =GetEndpointRequest);
                                                {5182}new SPs_4291: bitstring;
                                                {5183}new UP_4292: bitstring;
                                                {5184}out(c, (SPs_4291,None,UP_4292,pkSess_4290))
                                    )
                                    else
                                        {5185}let pkSess_4293: bitstring = fail-any in
                                        {5186}in(c, =GetEndpointRequest);
                                        {5187}new SPs_4294: bitstring;
                                        {5188}new UP_4295: bitstring;
                                        {5189}out(c, (SPs_4294,None,UP_4295,pkSess_4293))
                                )
                                else
                                    {5190}let v_4296: bool = (Cli_3903 = B) in
                                    (
                                        {5191}if v_4296 then
                                        (
                                            {5192}let pkCli_4297: bitstring = pub(skB) in
                                            {5193}let v_4298: bool = (Sess_3905 = A) in
                                            (
                                                {5194}if v_4298 then
                                                (
                                                    {5195}let pkSess_4299: bitstring = pub(skA) in
                                                    {5196}in(c, =GetEndpointRequest);
                                                    {5197}new SPs_4300: bitstring;
                                                    {5198}new UP_4301: bitstring;
                                                    {5199}out(c, (SPs_4300,None,UP_4301,pkSess_4299))
                                                )
                                                else
                                                    {5200}let v_4302: bool = (Sess_3905 = B) in
                                                    (
                                                        {5201}if v_4302 then
                                                        (
                                                            {5202}let pkSess_4303: bitstring = pub(skB) in
                                                            {5203}in(c, =GetEndpointRequest);
                                                            {5204}new SPs_4304: bitstring;
                                                            {5205}new UP_4305: bitstring;
                                                            {5206}out(c, (SPs_4304,None,UP_4305,pkSess_4303))
                                                        )
                                                        else
                                                            {5207}let v_4306: bool = (Sess_3905 = C) in
                                                            (
                                                                {5208}if v_4306 then
                                                                (
                                                                    {5209}let pkSess_4307: bitstring = pub(skC) in
                                                                    {5210}in(c, =GetEndpointRequest);
                                                                    {5211}new SPs_4308: bitstring;
                                                                    {5212}new UP_4309: bitstring;
                                                                    {5213}out(c, (SPs_4308,None,UP_4309,pkSess_4307))
                                                                )
                                                                else
                                                                    {5214}let pkSess_4310: bitstring = pub(skI) in
                                                                    {5215}in(c, =GetEndpointRequest);
                                                                    {5216}new SPs_4311: bitstring;
                                                                    {5217}new UP_4312: bitstring;
                                                                    {5218}out(c, (SPs_4311,None,UP_4312,pkSess_4310))
                                                            )
                                                            else
                                                                {5219}let pkSess_4313: bitstring = fail-any in
                                                                {5220}in(c, =GetEndpointRequest);
                                                                {5221}new SPs_4314: bitstring;
                                                                {5222}new UP_4315: bitstring;
                                                                {5223}out(c, (SPs_4314,None,UP_4315,pkSess_4313))
                                                    )
                                                    else
                                                        {5224}let pkSess_4316: bitstring = fail-any in
                                                        {5225}in(c, =GetEndpointRequest);
                                                        {5226}new SPs_4317: bitstring;
                                                        {5227}new UP_4318: bitstring;
                                                        {5228}out(c, (SPs_4317,None,UP_4318,pkSess_4316))
                                            )
                                            else
                                                {5229}let pkSess_4319: bitstring = fail-any in
                                                {5230}in(c, =GetEndpointRequest);
                                                {5231}new SPs_4320: bitstring;
                                                {5232}new UP_4321: bitstring;
                                                {5233}out(c, (SPs_4320,None,UP_4321,pkSess_4319))
                                        )
                                        else
                                            {5234}let v_4322: bool = (Cli_3903 = C) in
                                            (
                                                {5235}if v_4322 then
                                                (
                                                    {5236}let pkCli_4323: bitstring = pub(skC) in
                                                    {5237}let v_4324: bool = (Sess_3905 = A) in
                                                    (
                                                        {5238}if v_4324 then
                                                        (
                                                            {5239}let pkSess_4325: bitstring = pub(skA) in
                                                            {5240}in(c, =GetEndpointRequest);
                                                            {5241}new SPs_4326: bitstring;
                                                            {5242}new UP_4327: bitstring;
                                                            {5243}out(c, (SPs_4326,None,UP_4327,pkSess_4325))
                                                        )
                                                        else
                                                            {5244}let v_4328: bool = (Sess_3905 = B) in
                                                            (
                                                                {5245}if v_4328 then
                                                                (
                                                                    {5246}let pkSess_4329: bitstring = pub(skB) in
                                                                    {5247}in(c, =GetEndpointRequest);
                                                                    {5248}new SPs_4330: bitstring;
                                                                    {5249}new UP_4331: bitstring;
                                                                    {5250}out(c, (SPs_4330,None,UP_4331,pkSess_4329))
                                                                )
                                                                else
                                                                    {5251}let v_4332: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5252}if v_4332 then
                                                                        (
                                                                            {5253}let pkSess_4333: bitstring = pub(skC) in
                                                                            {5254}in(c, =GetEndpointRequest);
                                                                            {5255}new SPs_4334: bitstring;
                                                                            {5256}new UP_4335: bitstring;
                                                                            {5257}out(c, (SPs_4334,None,UP_4335,pkSess_4333))
                                                                        )
                                                                        else
                                                                            {5258}let pkSess_4336: bitstring = pub(skI) in
                                                                            {5259}in(c, =GetEndpointRequest);
                                                                            {5260}new SPs_4337: bitstring;
                                                                            {5261}new UP_4338: bitstring;
                                                                            {5262}out(c, (SPs_4337,None,UP_4338,pkSess_4336))
                                                                    )
                                                                    else
                                                                        {5263}let pkSess_4339: bitstring = fail-any in
                                                                        {5264}in(c, =GetEndpointRequest);
                                                                        {5265}new SPs_4340: bitstring;
                                                                        {5266}new UP_4341: bitstring;
                                                                        {5267}out(c, (SPs_4340,None,UP_4341,pkSess_4339))
                                                            )
                                                            else
                                                                {5268}let pkSess_4342: bitstring = fail-any in
                                                                {5269}in(c, =GetEndpointRequest);
                                                                {5270}new SPs_4343: bitstring;
                                                                {5271}new UP_4344: bitstring;
                                                                {5272}out(c, (SPs_4343,None,UP_4344,pkSess_4342))
                                                    )
                                                    else
                                                        {5273}let pkSess_4345: bitstring = fail-any in
                                                        {5274}in(c, =GetEndpointRequest);
                                                        {5275}new SPs_4346: bitstring;
                                                        {5276}new UP_4347: bitstring;
                                                        {5277}out(c, (SPs_4346,None,UP_4347,pkSess_4345))
                                                )
                                                else
                                                    {5278}let pkCli_4348: bitstring = pub(skI) in
                                                    {5279}let v_4349: bool = (Sess_3905 = A) in
                                                    (
                                                        {5280}if v_4349 then
                                                        (
                                                            {5281}let pkSess_4350: bitstring = pub(skA) in
                                                            {5282}in(c, =GetEndpointRequest);
                                                            {5283}new SPs_4351: bitstring;
                                                            {5284}new UP_4352: bitstring;
                                                            {5285}out(c, (SPs_4351,None,UP_4352,pkSess_4350))
                                                        )
                                                        else
                                                            {5286}let v_4353: bool = (Sess_3905 = B) in
                                                            (
                                                                {5287}if v_4353 then
                                                                (
                                                                    {5288}let pkSess_4354: bitstring = pub(skB) in
                                                                    {5289}in(c, =GetEndpointRequest);
                                                                    {5290}new SPs_4355: bitstring;
                                                                    {5291}new UP_4356: bitstring;
                                                                    {5292}out(c, (SPs_4355,None,UP_4356,pkSess_4354))
                                                                )
                                                                else
                                                                    {5293}let v_4357: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5294}if v_4357 then
                                                                        (
                                                                            {5295}let pkSess_4358: bitstring = pub(skC) in
                                                                            {5296}in(c, =GetEndpointRequest);
                                                                            {5297}new SPs_4359: bitstring;
                                                                            {5298}new UP_4360: bitstring;
                                                                            {5299}out(c, (SPs_4359,None,UP_4360,pkSess_4358))
                                                                        )
                                                                        else
                                                                            {5300}let pkSess_4361: bitstring = pub(skI) in
                                                                            {5301}in(c, =GetEndpointRequest);
                                                                            {5302}new SPs_4362: bitstring;
                                                                            {5303}new UP_4363: bitstring;
                                                                            {5304}out(c, (SPs_4362,None,UP_4363,pkSess_4361))
                                                                    )
                                                                    else
                                                                        {5305}let pkSess_4364: bitstring = fail-any in
                                                                        {5306}in(c, =GetEndpointRequest);
                                                                        {5307}new SPs_4365: bitstring;
                                                                        {5308}new UP_4366: bitstring;
                                                                        {5309}out(c, (SPs_4365,None,UP_4366,pkSess_4364))
                                                            )
                                                            else
                                                                {5310}let pkSess_4367: bitstring = fail-any in
                                                                {5311}in(c, =GetEndpointRequest);
                                                                {5312}new SPs_4368: bitstring;
                                                                {5313}new UP_4369: bitstring;
                                                                {5314}out(c, (SPs_4368,None,UP_4369,pkSess_4367))
                                                    )
                                                    else
                                                        {5315}let pkSess_4370: bitstring = fail-any in
                                                        {5316}in(c, =GetEndpointRequest);
                                                        {5317}new SPs_4371: bitstring;
                                                        {5318}new UP_4372: bitstring;
                                                        {5319}out(c, (SPs_4371,None,UP_4372,pkSess_4370))
                                            )
                                            else
                                                {5320}let pkCli_4373: bitstring = fail-any in
                                                {5321}let v_4374: bool = (Sess_3905 = A) in
                                                (
                                                    {5322}if v_4374 then
                                                    (
                                                        {5323}let pkSess_4375: bitstring = pub(skA) in
                                                        {5324}in(c, =GetEndpointRequest);
                                                        {5325}new SPs_4376: bitstring;
                                                        {5326}new UP_4377: bitstring;
                                                        {5327}out(c, (SPs_4376,None,UP_4377,pkSess_4375))
                                                    )
                                                    else
                                                        {5328}let v_4378: bool = (Sess_3905 = B) in
                                                        (
                                                            {5329}if v_4378 then
                                                            (
                                                                {5330}let pkSess_4379: bitstring = pub(skB) in
                                                                {5331}in(c, =GetEndpointRequest);
                                                                {5332}new SPs_4380: bitstring;
                                                                {5333}new UP_4381: bitstring;
                                                                {5334}out(c, (SPs_4380,None,UP_4381,pkSess_4379))
                                                            )
                                                            else
                                                                {5335}let v_4382: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5336}if v_4382 then
                                                                    (
                                                                        {5337}let pkSess_4383: bitstring = pub(skC) in
                                                                        {5338}in(c, =GetEndpointRequest);
                                                                        {5339}new SPs_4384: bitstring;
                                                                        {5340}new UP_4385: bitstring;
                                                                        {5341}out(c, (SPs_4384,None,UP_4385,pkSess_4383))
                                                                    )
                                                                    else
                                                                        {5342}let pkSess_4386: bitstring = pub(skI) in
                                                                        {5343}in(c, =GetEndpointRequest);
                                                                        {5344}new SPs_4387: bitstring;
                                                                        {5345}new UP_4388: bitstring;
                                                                        {5346}out(c, (SPs_4387,None,UP_4388,pkSess_4386))
                                                                )
                                                                else
                                                                    {5347}let pkSess_4389: bitstring = fail-any in
                                                                    {5348}in(c, =GetEndpointRequest);
                                                                    {5349}new SPs_4390: bitstring;
                                                                    {5350}new UP_4391: bitstring;
                                                                    {5351}out(c, (SPs_4390,None,UP_4391,pkSess_4389))
                                                        )
                                                        else
                                                            {5352}let pkSess_4392: bitstring = fail-any in
                                                            {5353}in(c, =GetEndpointRequest);
                                                            {5354}new SPs_4393: bitstring;
                                                            {5355}new UP_4394: bitstring;
                                                            {5356}out(c, (SPs_4393,None,UP_4394,pkSess_4392))
                                                )
                                                else
                                                    {5357}let pkSess_4395: bitstring = fail-any in
                                                    {5358}in(c, =GetEndpointRequest);
                                                    {5359}new SPs_4396: bitstring;
                                                    {5360}new UP_4397: bitstring;
                                                    {5361}out(c, (SPs_4396,None,UP_4397,pkSess_4395))
                                    )
                                    else
                                        {5362}let pkCli_4398: bitstring = fail-any in
                                        {5363}let v_4399: bool = (Sess_3905 = A) in
                                        (
                                            {5364}if v_4399 then
                                            (
                                                {5365}let pkSess_4400: bitstring = pub(skA) in
                                                {5366}in(c, =GetEndpointRequest);
                                                {5367}new SPs_4401: bitstring;
                                                {5368}new UP_4402: bitstring;
                                                {5369}out(c, (SPs_4401,None,UP_4402,pkSess_4400))
                                            )
                                            else
                                                {5370}let v_4403: bool = (Sess_3905 = B) in
                                                (
                                                    {5371}if v_4403 then
                                                    (
                                                        {5372}let pkSess_4404: bitstring = pub(skB) in
                                                        {5373}in(c, =GetEndpointRequest);
                                                        {5374}new SPs_4405: bitstring;
                                                        {5375}new UP_4406: bitstring;
                                                        {5376}out(c, (SPs_4405,None,UP_4406,pkSess_4404))
                                                    )
                                                    else
                                                        {5377}let v_4407: bool = (Sess_3905 = C) in
                                                        (
                                                            {5378}if v_4407 then
                                                            (
                                                                {5379}let pkSess_4408: bitstring = pub(skC) in
                                                                {5380}in(c, =GetEndpointRequest);
                                                                {5381}new SPs_4409: bitstring;
                                                                {5382}new UP_4410: bitstring;
                                                                {5383}out(c, (SPs_4409,None,UP_4410,pkSess_4408))
                                                            )
                                                            else
                                                                {5384}let pkSess_4411: bitstring = pub(skI) in
                                                                {5385}in(c, =GetEndpointRequest);
                                                                {5386}new SPs_4412: bitstring;
                                                                {5387}new UP_4413: bitstring;
                                                                {5388}out(c, (SPs_4412,None,UP_4413,pkSess_4411))
                                                        )
                                                        else
                                                            {5389}let pkSess_4414: bitstring = fail-any in
                                                            {5390}in(c, =GetEndpointRequest);
                                                            {5391}new SPs_4415: bitstring;
                                                            {5392}new UP_4416: bitstring;
                                                            {5393}out(c, (SPs_4415,None,UP_4416,pkSess_4414))
                                                )
                                                else
                                                    {5394}let pkSess_4417: bitstring = fail-any in
                                                    {5395}in(c, =GetEndpointRequest);
                                                    {5396}new SPs_4418: bitstring;
                                                    {5397}new UP_4419: bitstring;
                                                    {5398}out(c, (SPs_4418,None,UP_4419,pkSess_4417))
                                        )
                                        else
                                            {5399}let pkSess_4420: bitstring = fail-any in
                                            {5400}in(c, =GetEndpointRequest);
                                            {5401}new SPs_4421: bitstring;
                                            {5402}new UP_4422: bitstring;
                                            {5403}out(c, (SPs_4421,None,UP_4422,pkSess_4420))
                            )
                            else
                                {5404}let pkCli_4423: bitstring = fail-any in
                                {5405}let v_4424: bool = (Sess_3905 = A) in
                                (
                                    {5406}if v_4424 then
                                    (
                                        {5407}let pkSess_4425: bitstring = pub(skA) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SPs_4426: bitstring;
                                        {5410}new UP_4427: bitstring;
                                        {5411}out(c, (SPs_4426,None,UP_4427,pkSess_4425))
                                    )
                                    else
                                        {5412}let v_4428: bool = (Sess_3905 = B) in
                                        (
                                            {5413}if v_4428 then
                                            (
                                                {5414}let pkSess_4429: bitstring = pub(skB) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SPs_4430: bitstring;
                                                {5417}new UP_4431: bitstring;
                                                {5418}out(c, (SPs_4430,None,UP_4431,pkSess_4429))
                                            )
                                            else
                                                {5419}let v_4432: bool = (Sess_3905 = C) in
                                                (
                                                    {5420}if v_4432 then
                                                    (
                                                        {5421}let pkSess_4433: bitstring = pub(skC) in
                                                        {5422}in(c, =GetEndpointRequest);
                                                        {5423}new SPs_4434: bitstring;
                                                        {5424}new UP_4435: bitstring;
                                                        {5425}out(c, (SPs_4434,None,UP_4435,pkSess_4433))
                                                    )
                                                    else
                                                        {5426}let pkSess_4436: bitstring = pub(skI) in
                                                        {5427}in(c, =GetEndpointRequest);
                                                        {5428}new SPs_4437: bitstring;
                                                        {5429}new UP_4438: bitstring;
                                                        {5430}out(c, (SPs_4437,None,UP_4438,pkSess_4436))
                                                )
                                                else
                                                    {5431}let pkSess_4439: bitstring = fail-any in
                                                    {5432}in(c, =GetEndpointRequest);
                                                    {5433}new SPs_4440: bitstring;
                                                    {5434}new UP_4441: bitstring;
                                                    {5435}out(c, (SPs_4440,None,UP_4441,pkSess_4439))
                                        )
                                        else
                                            {5436}let pkSess_4442: bitstring = fail-any in
                                            {5437}in(c, =GetEndpointRequest);
                                            {5438}new SPs_4443: bitstring;
                                            {5439}new UP_4444: bitstring;
                                            {5440}out(c, (SPs_4443,None,UP_4444,pkSess_4442))
                                )
                                else
                                    {5441}let pkSess_4445: bitstring = fail-any in
                                    {5442}in(c, =GetEndpointRequest);
                                    {5443}new SPs_4446: bitstring;
                                    {5444}new UP_4447: bitstring;
                                    {5445}out(c, (SPs_4446,None,UP_4447,pkSess_4445))
                        )
                        else
                            {5446}let skDisco_4448: bitstring = skI in
                            {5447}let pkDisco_4449: bitstring = pub(skDisco_4448) in
                            {5448}let v_4450: bool = (Cli_3903 = A) in
                            (
                                {5449}if v_4450 then
                                (
                                    {5450}let pkCli_4451: bitstring = pub(skA) in
                                    {5451}let v_4452: bool = (Sess_3905 = A) in
                                    (
                                        {5452}if v_4452 then
                                        (
                                            {5453}let pkSess_4453: bitstring = pub(skA) in
                                            {5454}in(c, =GetEndpointRequest);
                                            {5455}new SPs_4454: bitstring;
                                            {5456}new UP_4455: bitstring;
                                            {5457}out(c, (SPs_4454,None,UP_4455,pkSess_4453))
                                        )
                                        else
                                            {5458}let v_4456: bool = (Sess_3905 = B) in
                                            (
                                                {5459}if v_4456 then
                                                (
                                                    {5460}let pkSess_4457: bitstring = pub(skB) in
                                                    {5461}in(c, =GetEndpointRequest);
                                                    {5462}new SPs_4458: bitstring;
                                                    {5463}new UP_4459: bitstring;
                                                    {5464}out(c, (SPs_4458,None,UP_4459,pkSess_4457))
                                                )
                                                else
                                                    {5465}let v_4460: bool = (Sess_3905 = C) in
                                                    (
                                                        {5466}if v_4460 then
                                                        (
                                                            {5467}let pkSess_4461: bitstring = pub(skC) in
                                                            {5468}in(c, =GetEndpointRequest);
                                                            {5469}new SPs_4462: bitstring;
                                                            {5470}new UP_4463: bitstring;
                                                            {5471}out(c, (SPs_4462,None,UP_4463,pkSess_4461))
                                                        )
                                                        else
                                                            {5472}let pkSess_4464: bitstring = pub(skI) in
                                                            {5473}in(c, =GetEndpointRequest);
                                                            {5474}new SPs_4465: bitstring;
                                                            {5475}new UP_4466: bitstring;
                                                            {5476}out(c, (SPs_4465,None,UP_4466,pkSess_4464))
                                                    )
                                                    else
                                                        {5477}let pkSess_4467: bitstring = fail-any in
                                                        {5478}in(c, =GetEndpointRequest);
                                                        {5479}new SPs_4468: bitstring;
                                                        {5480}new UP_4469: bitstring;
                                                        {5481}out(c, (SPs_4468,None,UP_4469,pkSess_4467))
                                            )
                                            else
                                                {5482}let pkSess_4470: bitstring = fail-any in
                                                {5483}in(c, =GetEndpointRequest);
                                                {5484}new SPs_4471: bitstring;
                                                {5485}new UP_4472: bitstring;
                                                {5486}out(c, (SPs_4471,None,UP_4472,pkSess_4470))
                                    )
                                    else
                                        {5487}let pkSess_4473: bitstring = fail-any in
                                        {5488}in(c, =GetEndpointRequest);
                                        {5489}new SPs_4474: bitstring;
                                        {5490}new UP_4475: bitstring;
                                        {5491}out(c, (SPs_4474,None,UP_4475,pkSess_4473))
                                )
                                else
                                    {5492}let v_4476: bool = (Cli_3903 = B) in
                                    (
                                        {5493}if v_4476 then
                                        (
                                            {5494}let pkCli_4477: bitstring = pub(skB) in
                                            {5495}let v_4478: bool = (Sess_3905 = A) in
                                            (
                                                {5496}if v_4478 then
                                                (
                                                    {5497}let pkSess_4479: bitstring = pub(skA) in
                                                    {5498}in(c, =GetEndpointRequest);
                                                    {5499}new SPs_4480: bitstring;
                                                    {5500}new UP_4481: bitstring;
                                                    {5501}out(c, (SPs_4480,None,UP_4481,pkSess_4479))
                                                )
                                                else
                                                    {5502}let v_4482: bool = (Sess_3905 = B) in
                                                    (
                                                        {5503}if v_4482 then
                                                        (
                                                            {5504}let pkSess_4483: bitstring = pub(skB) in
                                                            {5505}in(c, =GetEndpointRequest);
                                                            {5506}new SPs_4484: bitstring;
                                                            {5507}new UP_4485: bitstring;
                                                            {5508}out(c, (SPs_4484,None,UP_4485,pkSess_4483))
                                                        )
                                                        else
                                                            {5509}let v_4486: bool = (Sess_3905 = C) in
                                                            (
                                                                {5510}if v_4486 then
                                                                (
                                                                    {5511}let pkSess_4487: bitstring = pub(skC) in
                                                                    {5512}in(c, =GetEndpointRequest);
                                                                    {5513}new SPs_4488: bitstring;
                                                                    {5514}new UP_4489: bitstring;
                                                                    {5515}out(c, (SPs_4488,None,UP_4489,pkSess_4487))
                                                                )
                                                                else
                                                                    {5516}let pkSess_4490: bitstring = pub(skI) in
                                                                    {5517}in(c, =GetEndpointRequest);
                                                                    {5518}new SPs_4491: bitstring;
                                                                    {5519}new UP_4492: bitstring;
                                                                    {5520}out(c, (SPs_4491,None,UP_4492,pkSess_4490))
                                                            )
                                                            else
                                                                {5521}let pkSess_4493: bitstring = fail-any in
                                                                {5522}in(c, =GetEndpointRequest);
                                                                {5523}new SPs_4494: bitstring;
                                                                {5524}new UP_4495: bitstring;
                                                                {5525}out(c, (SPs_4494,None,UP_4495,pkSess_4493))
                                                    )
                                                    else
                                                        {5526}let pkSess_4496: bitstring = fail-any in
                                                        {5527}in(c, =GetEndpointRequest);
                                                        {5528}new SPs_4497: bitstring;
                                                        {5529}new UP_4498: bitstring;
                                                        {5530}out(c, (SPs_4497,None,UP_4498,pkSess_4496))
                                            )
                                            else
                                                {5531}let pkSess_4499: bitstring = fail-any in
                                                {5532}in(c, =GetEndpointRequest);
                                                {5533}new SPs_4500: bitstring;
                                                {5534}new UP_4501: bitstring;
                                                {5535}out(c, (SPs_4500,None,UP_4501,pkSess_4499))
                                        )
                                        else
                                            {5536}let v_4502: bool = (Cli_3903 = C) in
                                            (
                                                {5537}if v_4502 then
                                                (
                                                    {5538}let pkCli_4503: bitstring = pub(skC) in
                                                    {5539}let v_4504: bool = (Sess_3905 = A) in
                                                    (
                                                        {5540}if v_4504 then
                                                        (
                                                            {5541}let pkSess_4505: bitstring = pub(skA) in
                                                            {5542}in(c, =GetEndpointRequest);
                                                            {5543}new SPs_4506: bitstring;
                                                            {5544}new UP_4507: bitstring;
                                                            {5545}out(c, (SPs_4506,None,UP_4507,pkSess_4505))
                                                        )
                                                        else
                                                            {5546}let v_4508: bool = (Sess_3905 = B) in
                                                            (
                                                                {5547}if v_4508 then
                                                                (
                                                                    {5548}let pkSess_4509: bitstring = pub(skB) in
                                                                    {5549}in(c, =GetEndpointRequest);
                                                                    {5550}new SPs_4510: bitstring;
                                                                    {5551}new UP_4511: bitstring;
                                                                    {5552}out(c, (SPs_4510,None,UP_4511,pkSess_4509))
                                                                )
                                                                else
                                                                    {5553}let v_4512: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5554}if v_4512 then
                                                                        (
                                                                            {5555}let pkSess_4513: bitstring = pub(skC) in
                                                                            {5556}in(c, =GetEndpointRequest);
                                                                            {5557}new SPs_4514: bitstring;
                                                                            {5558}new UP_4515: bitstring;
                                                                            {5559}out(c, (SPs_4514,None,UP_4515,pkSess_4513))
                                                                        )
                                                                        else
                                                                            {5560}let pkSess_4516: bitstring = pub(skI) in
                                                                            {5561}in(c, =GetEndpointRequest);
                                                                            {5562}new SPs_4517: bitstring;
                                                                            {5563}new UP_4518: bitstring;
                                                                            {5564}out(c, (SPs_4517,None,UP_4518,pkSess_4516))
                                                                    )
                                                                    else
                                                                        {5565}let pkSess_4519: bitstring = fail-any in
                                                                        {5566}in(c, =GetEndpointRequest);
                                                                        {5567}new SPs_4520: bitstring;
                                                                        {5568}new UP_4521: bitstring;
                                                                        {5569}out(c, (SPs_4520,None,UP_4521,pkSess_4519))
                                                            )
                                                            else
                                                                {5570}let pkSess_4522: bitstring = fail-any in
                                                                {5571}in(c, =GetEndpointRequest);
                                                                {5572}new SPs_4523: bitstring;
                                                                {5573}new UP_4524: bitstring;
                                                                {5574}out(c, (SPs_4523,None,UP_4524,pkSess_4522))
                                                    )
                                                    else
                                                        {5575}let pkSess_4525: bitstring = fail-any in
                                                        {5576}in(c, =GetEndpointRequest);
                                                        {5577}new SPs_4526: bitstring;
                                                        {5578}new UP_4527: bitstring;
                                                        {5579}out(c, (SPs_4526,None,UP_4527,pkSess_4525))
                                                )
                                                else
                                                    {5580}let pkCli_4528: bitstring = pub(skI) in
                                                    {5581}let v_4529: bool = (Sess_3905 = A) in
                                                    (
                                                        {5582}if v_4529 then
                                                        (
                                                            {5583}let pkSess_4530: bitstring = pub(skA) in
                                                            {5584}in(c, =GetEndpointRequest);
                                                            {5585}new SPs_4531: bitstring;
                                                            {5586}new UP_4532: bitstring;
                                                            {5587}out(c, (SPs_4531,None,UP_4532,pkSess_4530))
                                                        )
                                                        else
                                                            {5588}let v_4533: bool = (Sess_3905 = B) in
                                                            (
                                                                {5589}if v_4533 then
                                                                (
                                                                    {5590}let pkSess_4534: bitstring = pub(skB) in
                                                                    {5591}in(c, =GetEndpointRequest);
                                                                    {5592}new SPs_4535: bitstring;
                                                                    {5593}new UP_4536: bitstring;
                                                                    {5594}out(c, (SPs_4535,None,UP_4536,pkSess_4534))
                                                                )
                                                                else
                                                                    {5595}let v_4537: bool = (Sess_3905 = C) in
                                                                    (
                                                                        {5596}if v_4537 then
                                                                        (
                                                                            {5597}let pkSess_4538: bitstring = pub(skC) in
                                                                            {5598}in(c, =GetEndpointRequest);
                                                                            {5599}new SPs_4539: bitstring;
                                                                            {5600}new UP_4540: bitstring;
                                                                            {5601}out(c, (SPs_4539,None,UP_4540,pkSess_4538))
                                                                        )
                                                                        else
                                                                            {5602}let pkSess_4541: bitstring = pub(skI) in
                                                                            {5603}in(c, =GetEndpointRequest);
                                                                            {5604}new SPs_4542: bitstring;
                                                                            {5605}new UP_4543: bitstring;
                                                                            {5606}out(c, (SPs_4542,None,UP_4543,pkSess_4541))
                                                                    )
                                                                    else
                                                                        {5607}let pkSess_4544: bitstring = fail-any in
                                                                        {5608}in(c, =GetEndpointRequest);
                                                                        {5609}new SPs_4545: bitstring;
                                                                        {5610}new UP_4546: bitstring;
                                                                        {5611}out(c, (SPs_4545,None,UP_4546,pkSess_4544))
                                                            )
                                                            else
                                                                {5612}let pkSess_4547: bitstring = fail-any in
                                                                {5613}in(c, =GetEndpointRequest);
                                                                {5614}new SPs_4548: bitstring;
                                                                {5615}new UP_4549: bitstring;
                                                                {5616}out(c, (SPs_4548,None,UP_4549,pkSess_4547))
                                                    )
                                                    else
                                                        {5617}let pkSess_4550: bitstring = fail-any in
                                                        {5618}in(c, =GetEndpointRequest);
                                                        {5619}new SPs_4551: bitstring;
                                                        {5620}new UP_4552: bitstring;
                                                        {5621}out(c, (SPs_4551,None,UP_4552,pkSess_4550))
                                            )
                                            else
                                                {5622}let pkCli_4553: bitstring = fail-any in
                                                {5623}let v_4554: bool = (Sess_3905 = A) in
                                                (
                                                    {5624}if v_4554 then
                                                    (
                                                        {5625}let pkSess_4555: bitstring = pub(skA) in
                                                        {5626}in(c, =GetEndpointRequest);
                                                        {5627}new SPs_4556: bitstring;
                                                        {5628}new UP_4557: bitstring;
                                                        {5629}out(c, (SPs_4556,None,UP_4557,pkSess_4555))
                                                    )
                                                    else
                                                        {5630}let v_4558: bool = (Sess_3905 = B) in
                                                        (
                                                            {5631}if v_4558 then
                                                            (
                                                                {5632}let pkSess_4559: bitstring = pub(skB) in
                                                                {5633}in(c, =GetEndpointRequest);
                                                                {5634}new SPs_4560: bitstring;
                                                                {5635}new UP_4561: bitstring;
                                                                {5636}out(c, (SPs_4560,None,UP_4561,pkSess_4559))
                                                            )
                                                            else
                                                                {5637}let v_4562: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5638}if v_4562 then
                                                                    (
                                                                        {5639}let pkSess_4563: bitstring = pub(skC) in
                                                                        {5640}in(c, =GetEndpointRequest);
                                                                        {5641}new SPs_4564: bitstring;
                                                                        {5642}new UP_4565: bitstring;
                                                                        {5643}out(c, (SPs_4564,None,UP_4565,pkSess_4563))
                                                                    )
                                                                    else
                                                                        {5644}let pkSess_4566: bitstring = pub(skI) in
                                                                        {5645}in(c, =GetEndpointRequest);
                                                                        {5646}new SPs_4567: bitstring;
                                                                        {5647}new UP_4568: bitstring;
                                                                        {5648}out(c, (SPs_4567,None,UP_4568,pkSess_4566))
                                                                )
                                                                else
                                                                    {5649}let pkSess_4569: bitstring = fail-any in
                                                                    {5650}in(c, =GetEndpointRequest);
                                                                    {5651}new SPs_4570: bitstring;
                                                                    {5652}new UP_4571: bitstring;
                                                                    {5653}out(c, (SPs_4570,None,UP_4571,pkSess_4569))
                                                        )
                                                        else
                                                            {5654}let pkSess_4572: bitstring = fail-any in
                                                            {5655}in(c, =GetEndpointRequest);
                                                            {5656}new SPs_4573: bitstring;
                                                            {5657}new UP_4574: bitstring;
                                                            {5658}out(c, (SPs_4573,None,UP_4574,pkSess_4572))
                                                )
                                                else
                                                    {5659}let pkSess_4575: bitstring = fail-any in
                                                    {5660}in(c, =GetEndpointRequest);
                                                    {5661}new SPs_4576: bitstring;
                                                    {5662}new UP_4577: bitstring;
                                                    {5663}out(c, (SPs_4576,None,UP_4577,pkSess_4575))
                                    )
                                    else
                                        {5664}let pkCli_4578: bitstring = fail-any in
                                        {5665}let v_4579: bool = (Sess_3905 = A) in
                                        (
                                            {5666}if v_4579 then
                                            (
                                                {5667}let pkSess_4580: bitstring = pub(skA) in
                                                {5668}in(c, =GetEndpointRequest);
                                                {5669}new SPs_4581: bitstring;
                                                {5670}new UP_4582: bitstring;
                                                {5671}out(c, (SPs_4581,None,UP_4582,pkSess_4580))
                                            )
                                            else
                                                {5672}let v_4583: bool = (Sess_3905 = B) in
                                                (
                                                    {5673}if v_4583 then
                                                    (
                                                        {5674}let pkSess_4584: bitstring = pub(skB) in
                                                        {5675}in(c, =GetEndpointRequest);
                                                        {5676}new SPs_4585: bitstring;
                                                        {5677}new UP_4586: bitstring;
                                                        {5678}out(c, (SPs_4585,None,UP_4586,pkSess_4584))
                                                    )
                                                    else
                                                        {5679}let v_4587: bool = (Sess_3905 = C) in
                                                        (
                                                            {5680}if v_4587 then
                                                            (
                                                                {5681}let pkSess_4588: bitstring = pub(skC) in
                                                                {5682}in(c, =GetEndpointRequest);
                                                                {5683}new SPs_4589: bitstring;
                                                                {5684}new UP_4590: bitstring;
                                                                {5685}out(c, (SPs_4589,None,UP_4590,pkSess_4588))
                                                            )
                                                            else
                                                                {5686}let pkSess_4591: bitstring = pub(skI) in
                                                                {5687}in(c, =GetEndpointRequest);
                                                                {5688}new SPs_4592: bitstring;
                                                                {5689}new UP_4593: bitstring;
                                                                {5690}out(c, (SPs_4592,None,UP_4593,pkSess_4591))
                                                        )
                                                        else
                                                            {5691}let pkSess_4594: bitstring = fail-any in
                                                            {5692}in(c, =GetEndpointRequest);
                                                            {5693}new SPs_4595: bitstring;
                                                            {5694}new UP_4596: bitstring;
                                                            {5695}out(c, (SPs_4595,None,UP_4596,pkSess_4594))
                                                )
                                                else
                                                    {5696}let pkSess_4597: bitstring = fail-any in
                                                    {5697}in(c, =GetEndpointRequest);
                                                    {5698}new SPs_4598: bitstring;
                                                    {5699}new UP_4599: bitstring;
                                                    {5700}out(c, (SPs_4598,None,UP_4599,pkSess_4597))
                                        )
                                        else
                                            {5701}let pkSess_4600: bitstring = fail-any in
                                            {5702}in(c, =GetEndpointRequest);
                                            {5703}new SPs_4601: bitstring;
                                            {5704}new UP_4602: bitstring;
                                            {5705}out(c, (SPs_4601,None,UP_4602,pkSess_4600))
                            )
                            else
                                {5706}let pkCli_4603: bitstring = fail-any in
                                {5707}let v_4604: bool = (Sess_3905 = A) in
                                (
                                    {5708}if v_4604 then
                                    (
                                        {5709}let pkSess_4605: bitstring = pub(skA) in
                                        {5710}in(c, =GetEndpointRequest);
                                        {5711}new SPs_4606: bitstring;
                                        {5712}new UP_4607: bitstring;
                                        {5713}out(c, (SPs_4606,None,UP_4607,pkSess_4605))
                                    )
                                    else
                                        {5714}let v_4608: bool = (Sess_3905 = B) in
                                        (
                                            {5715}if v_4608 then
                                            (
                                                {5716}let pkSess_4609: bitstring = pub(skB) in
                                                {5717}in(c, =GetEndpointRequest);
                                                {5718}new SPs_4610: bitstring;
                                                {5719}new UP_4611: bitstring;
                                                {5720}out(c, (SPs_4610,None,UP_4611,pkSess_4609))
                                            )
                                            else
                                                {5721}let v_4612: bool = (Sess_3905 = C) in
                                                (
                                                    {5722}if v_4612 then
                                                    (
                                                        {5723}let pkSess_4613: bitstring = pub(skC) in
                                                        {5724}in(c, =GetEndpointRequest);
                                                        {5725}new SPs_4614: bitstring;
                                                        {5726}new UP_4615: bitstring;
                                                        {5727}out(c, (SPs_4614,None,UP_4615,pkSess_4613))
                                                    )
                                                    else
                                                        {5728}let pkSess_4616: bitstring = pub(skI) in
                                                        {5729}in(c, =GetEndpointRequest);
                                                        {5730}new SPs_4617: bitstring;
                                                        {5731}new UP_4618: bitstring;
                                                        {5732}out(c, (SPs_4617,None,UP_4618,pkSess_4616))
                                                )
                                                else
                                                    {5733}let pkSess_4619: bitstring = fail-any in
                                                    {5734}in(c, =GetEndpointRequest);
                                                    {5735}new SPs_4620: bitstring;
                                                    {5736}new UP_4621: bitstring;
                                                    {5737}out(c, (SPs_4620,None,UP_4621,pkSess_4619))
                                        )
                                        else
                                            {5738}let pkSess_4622: bitstring = fail-any in
                                            {5739}in(c, =GetEndpointRequest);
                                            {5740}new SPs_4623: bitstring;
                                            {5741}new UP_4624: bitstring;
                                            {5742}out(c, (SPs_4623,None,UP_4624,pkSess_4622))
                                )
                                else
                                    {5743}let pkSess_4625: bitstring = fail-any in
                                    {5744}in(c, =GetEndpointRequest);
                                    {5745}new SPs_4626: bitstring;
                                    {5746}new UP_4627: bitstring;
                                    {5747}out(c, (SPs_4626,None,UP_4627,pkSess_4625))
                    )
                    else
                        {5748}let skDisco_4628: bitstring = fail-any in
                        {5749}let pkDisco_4629: bitstring = pub(skDisco_4628) in
                        {5750}let v_4630: bool = (Cli_3903 = A) in
                        (
                            {5751}if v_4630 then
                            (
                                {5752}let pkCli_4631: bitstring = pub(skA) in
                                {5753}let v_4632: bool = (Sess_3905 = A) in
                                (
                                    {5754}if v_4632 then
                                    (
                                        {5755}let pkSess_4633: bitstring = pub(skA) in
                                        {5756}in(c, =GetEndpointRequest);
                                        {5757}new SPs_4634: bitstring;
                                        {5758}new UP_4635: bitstring;
                                        {5759}out(c, (SPs_4634,None,UP_4635,pkSess_4633))
                                    )
                                    else
                                        {5760}let v_4636: bool = (Sess_3905 = B) in
                                        (
                                            {5761}if v_4636 then
                                            (
                                                {5762}let pkSess_4637: bitstring = pub(skB) in
                                                {5763}in(c, =GetEndpointRequest);
                                                {5764}new SPs_4638: bitstring;
                                                {5765}new UP_4639: bitstring;
                                                {5766}out(c, (SPs_4638,None,UP_4639,pkSess_4637))
                                            )
                                            else
                                                {5767}let v_4640: bool = (Sess_3905 = C) in
                                                (
                                                    {5768}if v_4640 then
                                                    (
                                                        {5769}let pkSess_4641: bitstring = pub(skC) in
                                                        {5770}in(c, =GetEndpointRequest);
                                                        {5771}new SPs_4642: bitstring;
                                                        {5772}new UP_4643: bitstring;
                                                        {5773}out(c, (SPs_4642,None,UP_4643,pkSess_4641))
                                                    )
                                                    else
                                                        {5774}let pkSess_4644: bitstring = pub(skI) in
                                                        {5775}in(c, =GetEndpointRequest);
                                                        {5776}new SPs_4645: bitstring;
                                                        {5777}new UP_4646: bitstring;
                                                        {5778}out(c, (SPs_4645,None,UP_4646,pkSess_4644))
                                                )
                                                else
                                                    {5779}let pkSess_4647: bitstring = fail-any in
                                                    {5780}in(c, =GetEndpointRequest);
                                                    {5781}new SPs_4648: bitstring;
                                                    {5782}new UP_4649: bitstring;
                                                    {5783}out(c, (SPs_4648,None,UP_4649,pkSess_4647))
                                        )
                                        else
                                            {5784}let pkSess_4650: bitstring = fail-any in
                                            {5785}in(c, =GetEndpointRequest);
                                            {5786}new SPs_4651: bitstring;
                                            {5787}new UP_4652: bitstring;
                                            {5788}out(c, (SPs_4651,None,UP_4652,pkSess_4650))
                                )
                                else
                                    {5789}let pkSess_4653: bitstring = fail-any in
                                    {5790}in(c, =GetEndpointRequest);
                                    {5791}new SPs_4654: bitstring;
                                    {5792}new UP_4655: bitstring;
                                    {5793}out(c, (SPs_4654,None,UP_4655,pkSess_4653))
                            )
                            else
                                {5794}let v_4656: bool = (Cli_3903 = B) in
                                (
                                    {5795}if v_4656 then
                                    (
                                        {5796}let pkCli_4657: bitstring = pub(skB) in
                                        {5797}let v_4658: bool = (Sess_3905 = A) in
                                        (
                                            {5798}if v_4658 then
                                            (
                                                {5799}let pkSess_4659: bitstring = pub(skA) in
                                                {5800}in(c, =GetEndpointRequest);
                                                {5801}new SPs_4660: bitstring;
                                                {5802}new UP_4661: bitstring;
                                                {5803}out(c, (SPs_4660,None,UP_4661,pkSess_4659))
                                            )
                                            else
                                                {5804}let v_4662: bool = (Sess_3905 = B) in
                                                (
                                                    {5805}if v_4662 then
                                                    (
                                                        {5806}let pkSess_4663: bitstring = pub(skB) in
                                                        {5807}in(c, =GetEndpointRequest);
                                                        {5808}new SPs_4664: bitstring;
                                                        {5809}new UP_4665: bitstring;
                                                        {5810}out(c, (SPs_4664,None,UP_4665,pkSess_4663))
                                                    )
                                                    else
                                                        {5811}let v_4666: bool = (Sess_3905 = C) in
                                                        (
                                                            {5812}if v_4666 then
                                                            (
                                                                {5813}let pkSess_4667: bitstring = pub(skC) in
                                                                {5814}in(c, =GetEndpointRequest);
                                                                {5815}new SPs_4668: bitstring;
                                                                {5816}new UP_4669: bitstring;
                                                                {5817}out(c, (SPs_4668,None,UP_4669,pkSess_4667))
                                                            )
                                                            else
                                                                {5818}let pkSess_4670: bitstring = pub(skI) in
                                                                {5819}in(c, =GetEndpointRequest);
                                                                {5820}new SPs_4671: bitstring;
                                                                {5821}new UP_4672: bitstring;
                                                                {5822}out(c, (SPs_4671,None,UP_4672,pkSess_4670))
                                                        )
                                                        else
                                                            {5823}let pkSess_4673: bitstring = fail-any in
                                                            {5824}in(c, =GetEndpointRequest);
                                                            {5825}new SPs_4674: bitstring;
                                                            {5826}new UP_4675: bitstring;
                                                            {5827}out(c, (SPs_4674,None,UP_4675,pkSess_4673))
                                                )
                                                else
                                                    {5828}let pkSess_4676: bitstring = fail-any in
                                                    {5829}in(c, =GetEndpointRequest);
                                                    {5830}new SPs_4677: bitstring;
                                                    {5831}new UP_4678: bitstring;
                                                    {5832}out(c, (SPs_4677,None,UP_4678,pkSess_4676))
                                        )
                                        else
                                            {5833}let pkSess_4679: bitstring = fail-any in
                                            {5834}in(c, =GetEndpointRequest);
                                            {5835}new SPs_4680: bitstring;
                                            {5836}new UP_4681: bitstring;
                                            {5837}out(c, (SPs_4680,None,UP_4681,pkSess_4679))
                                    )
                                    else
                                        {5838}let v_4682: bool = (Cli_3903 = C) in
                                        (
                                            {5839}if v_4682 then
                                            (
                                                {5840}let pkCli_4683: bitstring = pub(skC) in
                                                {5841}let v_4684: bool = (Sess_3905 = A) in
                                                (
                                                    {5842}if v_4684 then
                                                    (
                                                        {5843}let pkSess_4685: bitstring = pub(skA) in
                                                        {5844}in(c, =GetEndpointRequest);
                                                        {5845}new SPs_4686: bitstring;
                                                        {5846}new UP_4687: bitstring;
                                                        {5847}out(c, (SPs_4686,None,UP_4687,pkSess_4685))
                                                    )
                                                    else
                                                        {5848}let v_4688: bool = (Sess_3905 = B) in
                                                        (
                                                            {5849}if v_4688 then
                                                            (
                                                                {5850}let pkSess_4689: bitstring = pub(skB) in
                                                                {5851}in(c, =GetEndpointRequest);
                                                                {5852}new SPs_4690: bitstring;
                                                                {5853}new UP_4691: bitstring;
                                                                {5854}out(c, (SPs_4690,None,UP_4691,pkSess_4689))
                                                            )
                                                            else
                                                                {5855}let v_4692: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5856}if v_4692 then
                                                                    (
                                                                        {5857}let pkSess_4693: bitstring = pub(skC) in
                                                                        {5858}in(c, =GetEndpointRequest);
                                                                        {5859}new SPs_4694: bitstring;
                                                                        {5860}new UP_4695: bitstring;
                                                                        {5861}out(c, (SPs_4694,None,UP_4695,pkSess_4693))
                                                                    )
                                                                    else
                                                                        {5862}let pkSess_4696: bitstring = pub(skI) in
                                                                        {5863}in(c, =GetEndpointRequest);
                                                                        {5864}new SPs_4697: bitstring;
                                                                        {5865}new UP_4698: bitstring;
                                                                        {5866}out(c, (SPs_4697,None,UP_4698,pkSess_4696))
                                                                )
                                                                else
                                                                    {5867}let pkSess_4699: bitstring = fail-any in
                                                                    {5868}in(c, =GetEndpointRequest);
                                                                    {5869}new SPs_4700: bitstring;
                                                                    {5870}new UP_4701: bitstring;
                                                                    {5871}out(c, (SPs_4700,None,UP_4701,pkSess_4699))
                                                        )
                                                        else
                                                            {5872}let pkSess_4702: bitstring = fail-any in
                                                            {5873}in(c, =GetEndpointRequest);
                                                            {5874}new SPs_4703: bitstring;
                                                            {5875}new UP_4704: bitstring;
                                                            {5876}out(c, (SPs_4703,None,UP_4704,pkSess_4702))
                                                )
                                                else
                                                    {5877}let pkSess_4705: bitstring = fail-any in
                                                    {5878}in(c, =GetEndpointRequest);
                                                    {5879}new SPs_4706: bitstring;
                                                    {5880}new UP_4707: bitstring;
                                                    {5881}out(c, (SPs_4706,None,UP_4707,pkSess_4705))
                                            )
                                            else
                                                {5882}let pkCli_4708: bitstring = pub(skI) in
                                                {5883}let v_4709: bool = (Sess_3905 = A) in
                                                (
                                                    {5884}if v_4709 then
                                                    (
                                                        {5885}let pkSess_4710: bitstring = pub(skA) in
                                                        {5886}in(c, =GetEndpointRequest);
                                                        {5887}new SPs_4711: bitstring;
                                                        {5888}new UP_4712: bitstring;
                                                        {5889}out(c, (SPs_4711,None,UP_4712,pkSess_4710))
                                                    )
                                                    else
                                                        {5890}let v_4713: bool = (Sess_3905 = B) in
                                                        (
                                                            {5891}if v_4713 then
                                                            (
                                                                {5892}let pkSess_4714: bitstring = pub(skB) in
                                                                {5893}in(c, =GetEndpointRequest);
                                                                {5894}new SPs_4715: bitstring;
                                                                {5895}new UP_4716: bitstring;
                                                                {5896}out(c, (SPs_4715,None,UP_4716,pkSess_4714))
                                                            )
                                                            else
                                                                {5897}let v_4717: bool = (Sess_3905 = C) in
                                                                (
                                                                    {5898}if v_4717 then
                                                                    (
                                                                        {5899}let pkSess_4718: bitstring = pub(skC) in
                                                                        {5900}in(c, =GetEndpointRequest);
                                                                        {5901}new SPs_4719: bitstring;
                                                                        {5902}new UP_4720: bitstring;
                                                                        {5903}out(c, (SPs_4719,None,UP_4720,pkSess_4718))
                                                                    )
                                                                    else
                                                                        {5904}let pkSess_4721: bitstring = pub(skI) in
                                                                        {5905}in(c, =GetEndpointRequest);
                                                                        {5906}new SPs_4722: bitstring;
                                                                        {5907}new UP_4723: bitstring;
                                                                        {5908}out(c, (SPs_4722,None,UP_4723,pkSess_4721))
                                                                )
                                                                else
                                                                    {5909}let pkSess_4724: bitstring = fail-any in
                                                                    {5910}in(c, =GetEndpointRequest);
                                                                    {5911}new SPs_4725: bitstring;
                                                                    {5912}new UP_4726: bitstring;
                                                                    {5913}out(c, (SPs_4725,None,UP_4726,pkSess_4724))
                                                        )
                                                        else
                                                            {5914}let pkSess_4727: bitstring = fail-any in
                                                            {5915}in(c, =GetEndpointRequest);
                                                            {5916}new SPs_4728: bitstring;
                                                            {5917}new UP_4729: bitstring;
                                                            {5918}out(c, (SPs_4728,None,UP_4729,pkSess_4727))
                                                )
                                                else
                                                    {5919}let pkSess_4730: bitstring = fail-any in
                                                    {5920}in(c, =GetEndpointRequest);
                                                    {5921}new SPs_4731: bitstring;
                                                    {5922}new UP_4732: bitstring;
                                                    {5923}out(c, (SPs_4731,None,UP_4732,pkSess_4730))
                                        )
                                        else
                                            {5924}let pkCli_4733: bitstring = fail-any in
                                            {5925}let v_4734: bool = (Sess_3905 = A) in
                                            (
                                                {5926}if v_4734 then
                                                (
                                                    {5927}let pkSess_4735: bitstring = pub(skA) in
                                                    {5928}in(c, =GetEndpointRequest);
                                                    {5929}new SPs_4736: bitstring;
                                                    {5930}new UP_4737: bitstring;
                                                    {5931}out(c, (SPs_4736,None,UP_4737,pkSess_4735))
                                                )
                                                else
                                                    {5932}let v_4738: bool = (Sess_3905 = B) in
                                                    (
                                                        {5933}if v_4738 then
                                                        (
                                                            {5934}let pkSess_4739: bitstring = pub(skB) in
                                                            {5935}in(c, =GetEndpointRequest);
                                                            {5936}new SPs_4740: bitstring;
                                                            {5937}new UP_4741: bitstring;
                                                            {5938}out(c, (SPs_4740,None,UP_4741,pkSess_4739))
                                                        )
                                                        else
                                                            {5939}let v_4742: bool = (Sess_3905 = C) in
                                                            (
                                                                {5940}if v_4742 then
                                                                (
                                                                    {5941}let pkSess_4743: bitstring = pub(skC) in
                                                                    {5942}in(c, =GetEndpointRequest);
                                                                    {5943}new SPs_4744: bitstring;
                                                                    {5944}new UP_4745: bitstring;
                                                                    {5945}out(c, (SPs_4744,None,UP_4745,pkSess_4743))
                                                                )
                                                                else
                                                                    {5946}let pkSess_4746: bitstring = pub(skI) in
                                                                    {5947}in(c, =GetEndpointRequest);
                                                                    {5948}new SPs_4747: bitstring;
                                                                    {5949}new UP_4748: bitstring;
                                                                    {5950}out(c, (SPs_4747,None,UP_4748,pkSess_4746))
                                                            )
                                                            else
                                                                {5951}let pkSess_4749: bitstring = fail-any in
                                                                {5952}in(c, =GetEndpointRequest);
                                                                {5953}new SPs_4750: bitstring;
                                                                {5954}new UP_4751: bitstring;
                                                                {5955}out(c, (SPs_4750,None,UP_4751,pkSess_4749))
                                                    )
                                                    else
                                                        {5956}let pkSess_4752: bitstring = fail-any in
                                                        {5957}in(c, =GetEndpointRequest);
                                                        {5958}new SPs_4753: bitstring;
                                                        {5959}new UP_4754: bitstring;
                                                        {5960}out(c, (SPs_4753,None,UP_4754,pkSess_4752))
                                            )
                                            else
                                                {5961}let pkSess_4755: bitstring = fail-any in
                                                {5962}in(c, =GetEndpointRequest);
                                                {5963}new SPs_4756: bitstring;
                                                {5964}new UP_4757: bitstring;
                                                {5965}out(c, (SPs_4756,None,UP_4757,pkSess_4755))
                                )
                                else
                                    {5966}let pkCli_4758: bitstring = fail-any in
                                    {5967}let v_4759: bool = (Sess_3905 = A) in
                                    (
                                        {5968}if v_4759 then
                                        (
                                            {5969}let pkSess_4760: bitstring = pub(skA) in
                                            {5970}in(c, =GetEndpointRequest);
                                            {5971}new SPs_4761: bitstring;
                                            {5972}new UP_4762: bitstring;
                                            {5973}out(c, (SPs_4761,None,UP_4762,pkSess_4760))
                                        )
                                        else
                                            {5974}let v_4763: bool = (Sess_3905 = B) in
                                            (
                                                {5975}if v_4763 then
                                                (
                                                    {5976}let pkSess_4764: bitstring = pub(skB) in
                                                    {5977}in(c, =GetEndpointRequest);
                                                    {5978}new SPs_4765: bitstring;
                                                    {5979}new UP_4766: bitstring;
                                                    {5980}out(c, (SPs_4765,None,UP_4766,pkSess_4764))
                                                )
                                                else
                                                    {5981}let v_4767: bool = (Sess_3905 = C) in
                                                    (
                                                        {5982}if v_4767 then
                                                        (
                                                            {5983}let pkSess_4768: bitstring = pub(skC) in
                                                            {5984}in(c, =GetEndpointRequest);
                                                            {5985}new SPs_4769: bitstring;
                                                            {5986}new UP_4770: bitstring;
                                                            {5987}out(c, (SPs_4769,None,UP_4770,pkSess_4768))
                                                        )
                                                        else
                                                            {5988}let pkSess_4771: bitstring = pub(skI) in
                                                            {5989}in(c, =GetEndpointRequest);
                                                            {5990}new SPs_4772: bitstring;
                                                            {5991}new UP_4773: bitstring;
                                                            {5992}out(c, (SPs_4772,None,UP_4773,pkSess_4771))
                                                    )
                                                    else
                                                        {5993}let pkSess_4774: bitstring = fail-any in
                                                        {5994}in(c, =GetEndpointRequest);
                                                        {5995}new SPs_4775: bitstring;
                                                        {5996}new UP_4776: bitstring;
                                                        {5997}out(c, (SPs_4775,None,UP_4776,pkSess_4774))
                                            )
                                            else
                                                {5998}let pkSess_4777: bitstring = fail-any in
                                                {5999}in(c, =GetEndpointRequest);
                                                {6000}new SPs_4778: bitstring;
                                                {6001}new UP_4779: bitstring;
                                                {6002}out(c, (SPs_4778,None,UP_4779,pkSess_4777))
                                    )
                                    else
                                        {6003}let pkSess_4780: bitstring = fail-any in
                                        {6004}in(c, =GetEndpointRequest);
                                        {6005}new SPs_4781: bitstring;
                                        {6006}new UP_4782: bitstring;
                                        {6007}out(c, (SPs_4781,None,UP_4782,pkSess_4780))
                        )
                        else
                            {6008}let pkCli_4783: bitstring = fail-any in
                            {6009}let v_4784: bool = (Sess_3905 = A) in
                            (
                                {6010}if v_4784 then
                                (
                                    {6011}let pkSess_4785: bitstring = pub(skA) in
                                    {6012}in(c, =GetEndpointRequest);
                                    {6013}new SPs_4786: bitstring;
                                    {6014}new UP_4787: bitstring;
                                    {6015}out(c, (SPs_4786,None,UP_4787,pkSess_4785))
                                )
                                else
                                    {6016}let v_4788: bool = (Sess_3905 = B) in
                                    (
                                        {6017}if v_4788 then
                                        (
                                            {6018}let pkSess_4789: bitstring = pub(skB) in
                                            {6019}in(c, =GetEndpointRequest);
                                            {6020}new SPs_4790: bitstring;
                                            {6021}new UP_4791: bitstring;
                                            {6022}out(c, (SPs_4790,None,UP_4791,pkSess_4789))
                                        )
                                        else
                                            {6023}let v_4792: bool = (Sess_3905 = C) in
                                            (
                                                {6024}if v_4792 then
                                                (
                                                    {6025}let pkSess_4793: bitstring = pub(skC) in
                                                    {6026}in(c, =GetEndpointRequest);
                                                    {6027}new SPs_4794: bitstring;
                                                    {6028}new UP_4795: bitstring;
                                                    {6029}out(c, (SPs_4794,None,UP_4795,pkSess_4793))
                                                )
                                                else
                                                    {6030}let pkSess_4796: bitstring = pub(skI) in
                                                    {6031}in(c, =GetEndpointRequest);
                                                    {6032}new SPs_4797: bitstring;
                                                    {6033}new UP_4798: bitstring;
                                                    {6034}out(c, (SPs_4797,None,UP_4798,pkSess_4796))
                                            )
                                            else
                                                {6035}let pkSess_4799: bitstring = fail-any in
                                                {6036}in(c, =GetEndpointRequest);
                                                {6037}new SPs_4800: bitstring;
                                                {6038}new UP_4801: bitstring;
                                                {6039}out(c, (SPs_4800,None,UP_4801,pkSess_4799))
                                    )
                                    else
                                        {6040}let pkSess_4802: bitstring = fail-any in
                                        {6041}in(c, =GetEndpointRequest);
                                        {6042}new SPs_4803: bitstring;
                                        {6043}new UP_4804: bitstring;
                                        {6044}out(c, (SPs_4803,None,UP_4804,pkSess_4802))
                            )
                            else
                                {6045}let pkSess_4805: bitstring = fail-any in
                                {6046}in(c, =GetEndpointRequest);
                                {6047}new SPs_4806: bitstring;
                                {6048}new UP_4807: bitstring;
                                {6049}out(c, (SPs_4806,None,UP_4807,pkSess_4805))
            )
            else
                {6050}let skDisco_4808: bitstring = fail-any in
                {6051}let pkDisco_4809: bitstring = pub(skDisco_4808) in
                {6052}let v_4810: bool = (Cli_3903 = A) in
                (
                    {6053}if v_4810 then
                    (
                        {6054}let pkCli_4811: bitstring = pub(skA) in
                        {6055}let v_4812: bool = (Sess_3905 = A) in
                        (
                            {6056}if v_4812 then
                            (
                                {6057}let pkSess_4813: bitstring = pub(skA) in
                                {6058}in(c, =GetEndpointRequest);
                                {6059}new SPs_4814: bitstring;
                                {6060}new UP_4815: bitstring;
                                {6061}out(c, (SPs_4814,None,UP_4815,pkSess_4813))
                            )
                            else
                                {6062}let v_4816: bool = (Sess_3905 = B) in
                                (
                                    {6063}if v_4816 then
                                    (
                                        {6064}let pkSess_4817: bitstring = pub(skB) in
                                        {6065}in(c, =GetEndpointRequest);
                                        {6066}new SPs_4818: bitstring;
                                        {6067}new UP_4819: bitstring;
                                        {6068}out(c, (SPs_4818,None,UP_4819,pkSess_4817))
                                    )
                                    else
                                        {6069}let v_4820: bool = (Sess_3905 = C) in
                                        (
                                            {6070}if v_4820 then
                                            (
                                                {6071}let pkSess_4821: bitstring = pub(skC) in
                                                {6072}in(c, =GetEndpointRequest);
                                                {6073}new SPs_4822: bitstring;
                                                {6074}new UP_4823: bitstring;
                                                {6075}out(c, (SPs_4822,None,UP_4823,pkSess_4821))
                                            )
                                            else
                                                {6076}let pkSess_4824: bitstring = pub(skI) in
                                                {6077}in(c, =GetEndpointRequest);
                                                {6078}new SPs_4825: bitstring;
                                                {6079}new UP_4826: bitstring;
                                                {6080}out(c, (SPs_4825,None,UP_4826,pkSess_4824))
                                        )
                                        else
                                            {6081}let pkSess_4827: bitstring = fail-any in
                                            {6082}in(c, =GetEndpointRequest);
                                            {6083}new SPs_4828: bitstring;
                                            {6084}new UP_4829: bitstring;
                                            {6085}out(c, (SPs_4828,None,UP_4829,pkSess_4827))
                                )
                                else
                                    {6086}let pkSess_4830: bitstring = fail-any in
                                    {6087}in(c, =GetEndpointRequest);
                                    {6088}new SPs_4831: bitstring;
                                    {6089}new UP_4832: bitstring;
                                    {6090}out(c, (SPs_4831,None,UP_4832,pkSess_4830))
                        )
                        else
                            {6091}let pkSess_4833: bitstring = fail-any in
                            {6092}in(c, =GetEndpointRequest);
                            {6093}new SPs_4834: bitstring;
                            {6094}new UP_4835: bitstring;
                            {6095}out(c, (SPs_4834,None,UP_4835,pkSess_4833))
                    )
                    else
                        {6096}let v_4836: bool = (Cli_3903 = B) in
                        (
                            {6097}if v_4836 then
                            (
                                {6098}let pkCli_4837: bitstring = pub(skB) in
                                {6099}let v_4838: bool = (Sess_3905 = A) in
                                (
                                    {6100}if v_4838 then
                                    (
                                        {6101}let pkSess_4839: bitstring = pub(skA) in
                                        {6102}in(c, =GetEndpointRequest);
                                        {6103}new SPs_4840: bitstring;
                                        {6104}new UP_4841: bitstring;
                                        {6105}out(c, (SPs_4840,None,UP_4841,pkSess_4839))
                                    )
                                    else
                                        {6106}let v_4842: bool = (Sess_3905 = B) in
                                        (
                                            {6107}if v_4842 then
                                            (
                                                {6108}let pkSess_4843: bitstring = pub(skB) in
                                                {6109}in(c, =GetEndpointRequest);
                                                {6110}new SPs_4844: bitstring;
                                                {6111}new UP_4845: bitstring;
                                                {6112}out(c, (SPs_4844,None,UP_4845,pkSess_4843))
                                            )
                                            else
                                                {6113}let v_4846: bool = (Sess_3905 = C) in
                                                (
                                                    {6114}if v_4846 then
                                                    (
                                                        {6115}let pkSess_4847: bitstring = pub(skC) in
                                                        {6116}in(c, =GetEndpointRequest);
                                                        {6117}new SPs_4848: bitstring;
                                                        {6118}new UP_4849: bitstring;
                                                        {6119}out(c, (SPs_4848,None,UP_4849,pkSess_4847))
                                                    )
                                                    else
                                                        {6120}let pkSess_4850: bitstring = pub(skI) in
                                                        {6121}in(c, =GetEndpointRequest);
                                                        {6122}new SPs_4851: bitstring;
                                                        {6123}new UP_4852: bitstring;
                                                        {6124}out(c, (SPs_4851,None,UP_4852,pkSess_4850))
                                                )
                                                else
                                                    {6125}let pkSess_4853: bitstring = fail-any in
                                                    {6126}in(c, =GetEndpointRequest);
                                                    {6127}new SPs_4854: bitstring;
                                                    {6128}new UP_4855: bitstring;
                                                    {6129}out(c, (SPs_4854,None,UP_4855,pkSess_4853))
                                        )
                                        else
                                            {6130}let pkSess_4856: bitstring = fail-any in
                                            {6131}in(c, =GetEndpointRequest);
                                            {6132}new SPs_4857: bitstring;
                                            {6133}new UP_4858: bitstring;
                                            {6134}out(c, (SPs_4857,None,UP_4858,pkSess_4856))
                                )
                                else
                                    {6135}let pkSess_4859: bitstring = fail-any in
                                    {6136}in(c, =GetEndpointRequest);
                                    {6137}new SPs_4860: bitstring;
                                    {6138}new UP_4861: bitstring;
                                    {6139}out(c, (SPs_4860,None,UP_4861,pkSess_4859))
                            )
                            else
                                {6140}let v_4862: bool = (Cli_3903 = C) in
                                (
                                    {6141}if v_4862 then
                                    (
                                        {6142}let pkCli_4863: bitstring = pub(skC) in
                                        {6143}let v_4864: bool = (Sess_3905 = A) in
                                        (
                                            {6144}if v_4864 then
                                            (
                                                {6145}let pkSess_4865: bitstring = pub(skA) in
                                                {6146}in(c, =GetEndpointRequest);
                                                {6147}new SPs_4866: bitstring;
                                                {6148}new UP_4867: bitstring;
                                                {6149}out(c, (SPs_4866,None,UP_4867,pkSess_4865))
                                            )
                                            else
                                                {6150}let v_4868: bool = (Sess_3905 = B) in
                                                (
                                                    {6151}if v_4868 then
                                                    (
                                                        {6152}let pkSess_4869: bitstring = pub(skB) in
                                                        {6153}in(c, =GetEndpointRequest);
                                                        {6154}new SPs_4870: bitstring;
                                                        {6155}new UP_4871: bitstring;
                                                        {6156}out(c, (SPs_4870,None,UP_4871,pkSess_4869))
                                                    )
                                                    else
                                                        {6157}let v_4872: bool = (Sess_3905 = C) in
                                                        (
                                                            {6158}if v_4872 then
                                                            (
                                                                {6159}let pkSess_4873: bitstring = pub(skC) in
                                                                {6160}in(c, =GetEndpointRequest);
                                                                {6161}new SPs_4874: bitstring;
                                                                {6162}new UP_4875: bitstring;
                                                                {6163}out(c, (SPs_4874,None,UP_4875,pkSess_4873))
                                                            )
                                                            else
                                                                {6164}let pkSess_4876: bitstring = pub(skI) in
                                                                {6165}in(c, =GetEndpointRequest);
                                                                {6166}new SPs_4877: bitstring;
                                                                {6167}new UP_4878: bitstring;
                                                                {6168}out(c, (SPs_4877,None,UP_4878,pkSess_4876))
                                                        )
                                                        else
                                                            {6169}let pkSess_4879: bitstring = fail-any in
                                                            {6170}in(c, =GetEndpointRequest);
                                                            {6171}new SPs_4880: bitstring;
                                                            {6172}new UP_4881: bitstring;
                                                            {6173}out(c, (SPs_4880,None,UP_4881,pkSess_4879))
                                                )
                                                else
                                                    {6174}let pkSess_4882: bitstring = fail-any in
                                                    {6175}in(c, =GetEndpointRequest);
                                                    {6176}new SPs_4883: bitstring;
                                                    {6177}new UP_4884: bitstring;
                                                    {6178}out(c, (SPs_4883,None,UP_4884,pkSess_4882))
                                        )
                                        else
                                            {6179}let pkSess_4885: bitstring = fail-any in
                                            {6180}in(c, =GetEndpointRequest);
                                            {6181}new SPs_4886: bitstring;
                                            {6182}new UP_4887: bitstring;
                                            {6183}out(c, (SPs_4886,None,UP_4887,pkSess_4885))
                                    )
                                    else
                                        {6184}let pkCli_4888: bitstring = pub(skI) in
                                        {6185}let v_4889: bool = (Sess_3905 = A) in
                                        (
                                            {6186}if v_4889 then
                                            (
                                                {6187}let pkSess_4890: bitstring = pub(skA) in
                                                {6188}in(c, =GetEndpointRequest);
                                                {6189}new SPs_4891: bitstring;
                                                {6190}new UP_4892: bitstring;
                                                {6191}out(c, (SPs_4891,None,UP_4892,pkSess_4890))
                                            )
                                            else
                                                {6192}let v_4893: bool = (Sess_3905 = B) in
                                                (
                                                    {6193}if v_4893 then
                                                    (
                                                        {6194}let pkSess_4894: bitstring = pub(skB) in
                                                        {6195}in(c, =GetEndpointRequest);
                                                        {6196}new SPs_4895: bitstring;
                                                        {6197}new UP_4896: bitstring;
                                                        {6198}out(c, (SPs_4895,None,UP_4896,pkSess_4894))
                                                    )
                                                    else
                                                        {6199}let v_4897: bool = (Sess_3905 = C) in
                                                        (
                                                            {6200}if v_4897 then
                                                            (
                                                                {6201}let pkSess_4898: bitstring = pub(skC) in
                                                                {6202}in(c, =GetEndpointRequest);
                                                                {6203}new SPs_4899: bitstring;
                                                                {6204}new UP_4900: bitstring;
                                                                {6205}out(c, (SPs_4899,None,UP_4900,pkSess_4898))
                                                            )
                                                            else
                                                                {6206}let pkSess_4901: bitstring = pub(skI) in
                                                                {6207}in(c, =GetEndpointRequest);
                                                                {6208}new SPs_4902: bitstring;
                                                                {6209}new UP_4903: bitstring;
                                                                {6210}out(c, (SPs_4902,None,UP_4903,pkSess_4901))
                                                        )
                                                        else
                                                            {6211}let pkSess_4904: bitstring = fail-any in
                                                            {6212}in(c, =GetEndpointRequest);
                                                            {6213}new SPs_4905: bitstring;
                                                            {6214}new UP_4906: bitstring;
                                                            {6215}out(c, (SPs_4905,None,UP_4906,pkSess_4904))
                                                )
                                                else
                                                    {6216}let pkSess_4907: bitstring = fail-any in
                                                    {6217}in(c, =GetEndpointRequest);
                                                    {6218}new SPs_4908: bitstring;
                                                    {6219}new UP_4909: bitstring;
                                                    {6220}out(c, (SPs_4908,None,UP_4909,pkSess_4907))
                                        )
                                        else
                                            {6221}let pkSess_4910: bitstring = fail-any in
                                            {6222}in(c, =GetEndpointRequest);
                                            {6223}new SPs_4911: bitstring;
                                            {6224}new UP_4912: bitstring;
                                            {6225}out(c, (SPs_4911,None,UP_4912,pkSess_4910))
                                )
                                else
                                    {6226}let pkCli_4913: bitstring = fail-any in
                                    {6227}let v_4914: bool = (Sess_3905 = A) in
                                    (
                                        {6228}if v_4914 then
                                        (
                                            {6229}let pkSess_4915: bitstring = pub(skA) in
                                            {6230}in(c, =GetEndpointRequest);
                                            {6231}new SPs_4916: bitstring;
                                            {6232}new UP_4917: bitstring;
                                            {6233}out(c, (SPs_4916,None,UP_4917,pkSess_4915))
                                        )
                                        else
                                            {6234}let v_4918: bool = (Sess_3905 = B) in
                                            (
                                                {6235}if v_4918 then
                                                (
                                                    {6236}let pkSess_4919: bitstring = pub(skB) in
                                                    {6237}in(c, =GetEndpointRequest);
                                                    {6238}new SPs_4920: bitstring;
                                                    {6239}new UP_4921: bitstring;
                                                    {6240}out(c, (SPs_4920,None,UP_4921,pkSess_4919))
                                                )
                                                else
                                                    {6241}let v_4922: bool = (Sess_3905 = C) in
                                                    (
                                                        {6242}if v_4922 then
                                                        (
                                                            {6243}let pkSess_4923: bitstring = pub(skC) in
                                                            {6244}in(c, =GetEndpointRequest);
                                                            {6245}new SPs_4924: bitstring;
                                                            {6246}new UP_4925: bitstring;
                                                            {6247}out(c, (SPs_4924,None,UP_4925,pkSess_4923))
                                                        )
                                                        else
                                                            {6248}let pkSess_4926: bitstring = pub(skI) in
                                                            {6249}in(c, =GetEndpointRequest);
                                                            {6250}new SPs_4927: bitstring;
                                                            {6251}new UP_4928: bitstring;
                                                            {6252}out(c, (SPs_4927,None,UP_4928,pkSess_4926))
                                                    )
                                                    else
                                                        {6253}let pkSess_4929: bitstring = fail-any in
                                                        {6254}in(c, =GetEndpointRequest);
                                                        {6255}new SPs_4930: bitstring;
                                                        {6256}new UP_4931: bitstring;
                                                        {6257}out(c, (SPs_4930,None,UP_4931,pkSess_4929))
                                            )
                                            else
                                                {6258}let pkSess_4932: bitstring = fail-any in
                                                {6259}in(c, =GetEndpointRequest);
                                                {6260}new SPs_4933: bitstring;
                                                {6261}new UP_4934: bitstring;
                                                {6262}out(c, (SPs_4933,None,UP_4934,pkSess_4932))
                                    )
                                    else
                                        {6263}let pkSess_4935: bitstring = fail-any in
                                        {6264}in(c, =GetEndpointRequest);
                                        {6265}new SPs_4936: bitstring;
                                        {6266}new UP_4937: bitstring;
                                        {6267}out(c, (SPs_4936,None,UP_4937,pkSess_4935))
                        )
                        else
                            {6268}let pkCli_4938: bitstring = fail-any in
                            {6269}let v_4939: bool = (Sess_3905 = A) in
                            (
                                {6270}if v_4939 then
                                (
                                    {6271}let pkSess_4940: bitstring = pub(skA) in
                                    {6272}in(c, =GetEndpointRequest);
                                    {6273}new SPs_4941: bitstring;
                                    {6274}new UP_4942: bitstring;
                                    {6275}out(c, (SPs_4941,None,UP_4942,pkSess_4940))
                                )
                                else
                                    {6276}let v_4943: bool = (Sess_3905 = B) in
                                    (
                                        {6277}if v_4943 then
                                        (
                                            {6278}let pkSess_4944: bitstring = pub(skB) in
                                            {6279}in(c, =GetEndpointRequest);
                                            {6280}new SPs_4945: bitstring;
                                            {6281}new UP_4946: bitstring;
                                            {6282}out(c, (SPs_4945,None,UP_4946,pkSess_4944))
                                        )
                                        else
                                            {6283}let v_4947: bool = (Sess_3905 = C) in
                                            (
                                                {6284}if v_4947 then
                                                (
                                                    {6285}let pkSess_4948: bitstring = pub(skC) in
                                                    {6286}in(c, =GetEndpointRequest);
                                                    {6287}new SPs_4949: bitstring;
                                                    {6288}new UP_4950: bitstring;
                                                    {6289}out(c, (SPs_4949,None,UP_4950,pkSess_4948))
                                                )
                                                else
                                                    {6290}let pkSess_4951: bitstring = pub(skI) in
                                                    {6291}in(c, =GetEndpointRequest);
                                                    {6292}new SPs_4952: bitstring;
                                                    {6293}new UP_4953: bitstring;
                                                    {6294}out(c, (SPs_4952,None,UP_4953,pkSess_4951))
                                            )
                                            else
                                                {6295}let pkSess_4954: bitstring = fail-any in
                                                {6296}in(c, =GetEndpointRequest);
                                                {6297}new SPs_4955: bitstring;
                                                {6298}new UP_4956: bitstring;
                                                {6299}out(c, (SPs_4955,None,UP_4956,pkSess_4954))
                                    )
                                    else
                                        {6300}let pkSess_4957: bitstring = fail-any in
                                        {6301}in(c, =GetEndpointRequest);
                                        {6302}new SPs_4958: bitstring;
                                        {6303}new UP_4959: bitstring;
                                        {6304}out(c, (SPs_4958,None,UP_4959,pkSess_4957))
                            )
                            else
                                {6305}let pkSess_4960: bitstring = fail-any in
                                {6306}in(c, =GetEndpointRequest);
                                {6307}new SPs_4961: bitstring;
                                {6308}new UP_4962: bitstring;
                                {6309}out(c, (SPs_4961,None,UP_4962,pkSess_4960))
                )
                else
                    {6310}let pkCli_4963: bitstring = fail-any in
                    {6311}let v_4964: bool = (Sess_3905 = A) in
                    (
                        {6312}if v_4964 then
                        (
                            {6313}let pkSess_4965: bitstring = pub(skA) in
                            {6314}in(c, =GetEndpointRequest);
                            {6315}new SPs_4966: bitstring;
                            {6316}new UP_4967: bitstring;
                            {6317}out(c, (SPs_4966,None,UP_4967,pkSess_4965))
                        )
                        else
                            {6318}let v_4968: bool = (Sess_3905 = B) in
                            (
                                {6319}if v_4968 then
                                (
                                    {6320}let pkSess_4969: bitstring = pub(skB) in
                                    {6321}in(c, =GetEndpointRequest);
                                    {6322}new SPs_4970: bitstring;
                                    {6323}new UP_4971: bitstring;
                                    {6324}out(c, (SPs_4970,None,UP_4971,pkSess_4969))
                                )
                                else
                                    {6325}let v_4972: bool = (Sess_3905 = C) in
                                    (
                                        {6326}if v_4972 then
                                        (
                                            {6327}let pkSess_4973: bitstring = pub(skC) in
                                            {6328}in(c, =GetEndpointRequest);
                                            {6329}new SPs_4974: bitstring;
                                            {6330}new UP_4975: bitstring;
                                            {6331}out(c, (SPs_4974,None,UP_4975,pkSess_4973))
                                        )
                                        else
                                            {6332}let pkSess_4976: bitstring = pub(skI) in
                                            {6333}in(c, =GetEndpointRequest);
                                            {6334}new SPs_4977: bitstring;
                                            {6335}new UP_4978: bitstring;
                                            {6336}out(c, (SPs_4977,None,UP_4978,pkSess_4976))
                                    )
                                    else
                                        {6337}let pkSess_4979: bitstring = fail-any in
                                        {6338}in(c, =GetEndpointRequest);
                                        {6339}new SPs_4980: bitstring;
                                        {6340}new UP_4981: bitstring;
                                        {6341}out(c, (SPs_4980,None,UP_4981,pkSess_4979))
                            )
                            else
                                {6342}let pkSess_4982: bitstring = fail-any in
                                {6343}in(c, =GetEndpointRequest);
                                {6344}new SPs_4983: bitstring;
                                {6345}new UP_4984: bitstring;
                                {6346}out(c, (SPs_4983,None,UP_4984,pkSess_4982))
                    )
                    else
                        {6347}let pkSess_4985: bitstring = fail-any in
                        {6348}in(c, =GetEndpointRequest);
                        {6349}new SPs_4986: bitstring;
                        {6350}new UP_4987: bitstring;
                        {6351}out(c, (SPs_4986,None,UP_4987,pkSess_4985))
    )
    else
        {6352}let skDisco_4988: bitstring = fail-any in
        {6353}let pkDisco_4989: bitstring = pub(skDisco_4988) in
        {6354}let v_4990: bool = (Cli_3903 = A) in
        (
            {6355}if v_4990 then
            (
                {6356}let pkCli_4991: bitstring = pub(skA) in
                {6357}let v_4992: bool = (Sess_3905 = A) in
                (
                    {6358}if v_4992 then
                    (
                        {6359}let pkSess_4993: bitstring = pub(skA) in
                        {6360}in(c, =GetEndpointRequest);
                        {6361}new SPs_4994: bitstring;
                        {6362}new UP_4995: bitstring;
                        {6363}out(c, (SPs_4994,None,UP_4995,pkSess_4993))
                    )
                    else
                        {6364}let v_4996: bool = (Sess_3905 = B) in
                        (
                            {6365}if v_4996 then
                            (
                                {6366}let pkSess_4997: bitstring = pub(skB) in
                                {6367}in(c, =GetEndpointRequest);
                                {6368}new SPs_4998: bitstring;
                                {6369}new UP_4999: bitstring;
                                {6370}out(c, (SPs_4998,None,UP_4999,pkSess_4997))
                            )
                            else
                                {6371}let v_5000: bool = (Sess_3905 = C) in
                                (
                                    {6372}if v_5000 then
                                    (
                                        {6373}let pkSess_5001: bitstring = pub(skC) in
                                        {6374}in(c, =GetEndpointRequest);
                                        {6375}new SPs_5002: bitstring;
                                        {6376}new UP_5003: bitstring;
                                        {6377}out(c, (SPs_5002,None,UP_5003,pkSess_5001))
                                    )
                                    else
                                        {6378}let pkSess_5004: bitstring = pub(skI) in
                                        {6379}in(c, =GetEndpointRequest);
                                        {6380}new SPs_5005: bitstring;
                                        {6381}new UP_5006: bitstring;
                                        {6382}out(c, (SPs_5005,None,UP_5006,pkSess_5004))
                                )
                                else
                                    {6383}let pkSess_5007: bitstring = fail-any in
                                    {6384}in(c, =GetEndpointRequest);
                                    {6385}new SPs_5008: bitstring;
                                    {6386}new UP_5009: bitstring;
                                    {6387}out(c, (SPs_5008,None,UP_5009,pkSess_5007))
                        )
                        else
                            {6388}let pkSess_5010: bitstring = fail-any in
                            {6389}in(c, =GetEndpointRequest);
                            {6390}new SPs_5011: bitstring;
                            {6391}new UP_5012: bitstring;
                            {6392}out(c, (SPs_5011,None,UP_5012,pkSess_5010))
                )
                else
                    {6393}let pkSess_5013: bitstring = fail-any in
                    {6394}in(c, =GetEndpointRequest);
                    {6395}new SPs_5014: bitstring;
                    {6396}new UP_5015: bitstring;
                    {6397}out(c, (SPs_5014,None,UP_5015,pkSess_5013))
            )
            else
                {6398}let v_5016: bool = (Cli_3903 = B) in
                (
                    {6399}if v_5016 then
                    (
                        {6400}let pkCli_5017: bitstring = pub(skB) in
                        {6401}let v_5018: bool = (Sess_3905 = A) in
                        (
                            {6402}if v_5018 then
                            (
                                {6403}let pkSess_5019: bitstring = pub(skA) in
                                {6404}in(c, =GetEndpointRequest);
                                {6405}new SPs_5020: bitstring;
                                {6406}new UP_5021: bitstring;
                                {6407}out(c, (SPs_5020,None,UP_5021,pkSess_5019))
                            )
                            else
                                {6408}let v_5022: bool = (Sess_3905 = B) in
                                (
                                    {6409}if v_5022 then
                                    (
                                        {6410}let pkSess_5023: bitstring = pub(skB) in
                                        {6411}in(c, =GetEndpointRequest);
                                        {6412}new SPs_5024: bitstring;
                                        {6413}new UP_5025: bitstring;
                                        {6414}out(c, (SPs_5024,None,UP_5025,pkSess_5023))
                                    )
                                    else
                                        {6415}let v_5026: bool = (Sess_3905 = C) in
                                        (
                                            {6416}if v_5026 then
                                            (
                                                {6417}let pkSess_5027: bitstring = pub(skC) in
                                                {6418}in(c, =GetEndpointRequest);
                                                {6419}new SPs_5028: bitstring;
                                                {6420}new UP_5029: bitstring;
                                                {6421}out(c, (SPs_5028,None,UP_5029,pkSess_5027))
                                            )
                                            else
                                                {6422}let pkSess_5030: bitstring = pub(skI) in
                                                {6423}in(c, =GetEndpointRequest);
                                                {6424}new SPs_5031: bitstring;
                                                {6425}new UP_5032: bitstring;
                                                {6426}out(c, (SPs_5031,None,UP_5032,pkSess_5030))
                                        )
                                        else
                                            {6427}let pkSess_5033: bitstring = fail-any in
                                            {6428}in(c, =GetEndpointRequest);
                                            {6429}new SPs_5034: bitstring;
                                            {6430}new UP_5035: bitstring;
                                            {6431}out(c, (SPs_5034,None,UP_5035,pkSess_5033))
                                )
                                else
                                    {6432}let pkSess_5036: bitstring = fail-any in
                                    {6433}in(c, =GetEndpointRequest);
                                    {6434}new SPs_5037: bitstring;
                                    {6435}new UP_5038: bitstring;
                                    {6436}out(c, (SPs_5037,None,UP_5038,pkSess_5036))
                        )
                        else
                            {6437}let pkSess_5039: bitstring = fail-any in
                            {6438}in(c, =GetEndpointRequest);
                            {6439}new SPs_5040: bitstring;
                            {6440}new UP_5041: bitstring;
                            {6441}out(c, (SPs_5040,None,UP_5041,pkSess_5039))
                    )
                    else
                        {6442}let v_5042: bool = (Cli_3903 = C) in
                        (
                            {6443}if v_5042 then
                            (
                                {6444}let pkCli_5043: bitstring = pub(skC) in
                                {6445}let v_5044: bool = (Sess_3905 = A) in
                                (
                                    {6446}if v_5044 then
                                    (
                                        {6447}let pkSess_5045: bitstring = pub(skA) in
                                        {6448}in(c, =GetEndpointRequest);
                                        {6449}new SPs_5046: bitstring;
                                        {6450}new UP_5047: bitstring;
                                        {6451}out(c, (SPs_5046,None,UP_5047,pkSess_5045))
                                    )
                                    else
                                        {6452}let v_5048: bool = (Sess_3905 = B) in
                                        (
                                            {6453}if v_5048 then
                                            (
                                                {6454}let pkSess_5049: bitstring = pub(skB) in
                                                {6455}in(c, =GetEndpointRequest);
                                                {6456}new SPs_5050: bitstring;
                                                {6457}new UP_5051: bitstring;
                                                {6458}out(c, (SPs_5050,None,UP_5051,pkSess_5049))
                                            )
                                            else
                                                {6459}let v_5052: bool = (Sess_3905 = C) in
                                                (
                                                    {6460}if v_5052 then
                                                    (
                                                        {6461}let pkSess_5053: bitstring = pub(skC) in
                                                        {6462}in(c, =GetEndpointRequest);
                                                        {6463}new SPs_5054: bitstring;
                                                        {6464}new UP_5055: bitstring;
                                                        {6465}out(c, (SPs_5054,None,UP_5055,pkSess_5053))
                                                    )
                                                    else
                                                        {6466}let pkSess_5056: bitstring = pub(skI) in
                                                        {6467}in(c, =GetEndpointRequest);
                                                        {6468}new SPs_5057: bitstring;
                                                        {6469}new UP_5058: bitstring;
                                                        {6470}out(c, (SPs_5057,None,UP_5058,pkSess_5056))
                                                )
                                                else
                                                    {6471}let pkSess_5059: bitstring = fail-any in
                                                    {6472}in(c, =GetEndpointRequest);
                                                    {6473}new SPs_5060: bitstring;
                                                    {6474}new UP_5061: bitstring;
                                                    {6475}out(c, (SPs_5060,None,UP_5061,pkSess_5059))
                                        )
                                        else
                                            {6476}let pkSess_5062: bitstring = fail-any in
                                            {6477}in(c, =GetEndpointRequest);
                                            {6478}new SPs_5063: bitstring;
                                            {6479}new UP_5064: bitstring;
                                            {6480}out(c, (SPs_5063,None,UP_5064,pkSess_5062))
                                )
                                else
                                    {6481}let pkSess_5065: bitstring = fail-any in
                                    {6482}in(c, =GetEndpointRequest);
                                    {6483}new SPs_5066: bitstring;
                                    {6484}new UP_5067: bitstring;
                                    {6485}out(c, (SPs_5066,None,UP_5067,pkSess_5065))
                            )
                            else
                                {6486}let pkCli_5068: bitstring = pub(skI) in
                                {6487}let v_5069: bool = (Sess_3905 = A) in
                                (
                                    {6488}if v_5069 then
                                    (
                                        {6489}let pkSess_5070: bitstring = pub(skA) in
                                        {6490}in(c, =GetEndpointRequest);
                                        {6491}new SPs_5071: bitstring;
                                        {6492}new UP_5072: bitstring;
                                        {6493}out(c, (SPs_5071,None,UP_5072,pkSess_5070))
                                    )
                                    else
                                        {6494}let v_5073: bool = (Sess_3905 = B) in
                                        (
                                            {6495}if v_5073 then
                                            (
                                                {6496}let pkSess_5074: bitstring = pub(skB) in
                                                {6497}in(c, =GetEndpointRequest);
                                                {6498}new SPs_5075: bitstring;
                                                {6499}new UP_5076: bitstring;
                                                {6500}out(c, (SPs_5075,None,UP_5076,pkSess_5074))
                                            )
                                            else
                                                {6501}let v_5077: bool = (Sess_3905 = C) in
                                                (
                                                    {6502}if v_5077 then
                                                    (
                                                        {6503}let pkSess_5078: bitstring = pub(skC) in
                                                        {6504}in(c, =GetEndpointRequest);
                                                        {6505}new SPs_5079: bitstring;
                                                        {6506}new UP_5080: bitstring;
                                                        {6507}out(c, (SPs_5079,None,UP_5080,pkSess_5078))
                                                    )
                                                    else
                                                        {6508}let pkSess_5081: bitstring = pub(skI) in
                                                        {6509}in(c, =GetEndpointRequest);
                                                        {6510}new SPs_5082: bitstring;
                                                        {6511}new UP_5083: bitstring;
                                                        {6512}out(c, (SPs_5082,None,UP_5083,pkSess_5081))
                                                )
                                                else
                                                    {6513}let pkSess_5084: bitstring = fail-any in
                                                    {6514}in(c, =GetEndpointRequest);
                                                    {6515}new SPs_5085: bitstring;
                                                    {6516}new UP_5086: bitstring;
                                                    {6517}out(c, (SPs_5085,None,UP_5086,pkSess_5084))
                                        )
                                        else
                                            {6518}let pkSess_5087: bitstring = fail-any in
                                            {6519}in(c, =GetEndpointRequest);
                                            {6520}new SPs_5088: bitstring;
                                            {6521}new UP_5089: bitstring;
                                            {6522}out(c, (SPs_5088,None,UP_5089,pkSess_5087))
                                )
                                else
                                    {6523}let pkSess_5090: bitstring = fail-any in
                                    {6524}in(c, =GetEndpointRequest);
                                    {6525}new SPs_5091: bitstring;
                                    {6526}new UP_5092: bitstring;
                                    {6527}out(c, (SPs_5091,None,UP_5092,pkSess_5090))
                        )
                        else
                            {6528}let pkCli_5093: bitstring = fail-any in
                            {6529}let v_5094: bool = (Sess_3905 = A) in
                            (
                                {6530}if v_5094 then
                                (
                                    {6531}let pkSess_5095: bitstring = pub(skA) in
                                    {6532}in(c, =GetEndpointRequest);
                                    {6533}new SPs_5096: bitstring;
                                    {6534}new UP_5097: bitstring;
                                    {6535}out(c, (SPs_5096,None,UP_5097,pkSess_5095))
                                )
                                else
                                    {6536}let v_5098: bool = (Sess_3905 = B) in
                                    (
                                        {6537}if v_5098 then
                                        (
                                            {6538}let pkSess_5099: bitstring = pub(skB) in
                                            {6539}in(c, =GetEndpointRequest);
                                            {6540}new SPs_5100: bitstring;
                                            {6541}new UP_5101: bitstring;
                                            {6542}out(c, (SPs_5100,None,UP_5101,pkSess_5099))
                                        )
                                        else
                                            {6543}let v_5102: bool = (Sess_3905 = C) in
                                            (
                                                {6544}if v_5102 then
                                                (
                                                    {6545}let pkSess_5103: bitstring = pub(skC) in
                                                    {6546}in(c, =GetEndpointRequest);
                                                    {6547}new SPs_5104: bitstring;
                                                    {6548}new UP_5105: bitstring;
                                                    {6549}out(c, (SPs_5104,None,UP_5105,pkSess_5103))
                                                )
                                                else
                                                    {6550}let pkSess_5106: bitstring = pub(skI) in
                                                    {6551}in(c, =GetEndpointRequest);
                                                    {6552}new SPs_5107: bitstring;
                                                    {6553}new UP_5108: bitstring;
                                                    {6554}out(c, (SPs_5107,None,UP_5108,pkSess_5106))
                                            )
                                            else
                                                {6555}let pkSess_5109: bitstring = fail-any in
                                                {6556}in(c, =GetEndpointRequest);
                                                {6557}new SPs_5110: bitstring;
                                                {6558}new UP_5111: bitstring;
                                                {6559}out(c, (SPs_5110,None,UP_5111,pkSess_5109))
                                    )
                                    else
                                        {6560}let pkSess_5112: bitstring = fail-any in
                                        {6561}in(c, =GetEndpointRequest);
                                        {6562}new SPs_5113: bitstring;
                                        {6563}new UP_5114: bitstring;
                                        {6564}out(c, (SPs_5113,None,UP_5114,pkSess_5112))
                            )
                            else
                                {6565}let pkSess_5115: bitstring = fail-any in
                                {6566}in(c, =GetEndpointRequest);
                                {6567}new SPs_5116: bitstring;
                                {6568}new UP_5117: bitstring;
                                {6569}out(c, (SPs_5116,None,UP_5117,pkSess_5115))
                )
                else
                    {6570}let pkCli_5118: bitstring = fail-any in
                    {6571}let v_5119: bool = (Sess_3905 = A) in
                    (
                        {6572}if v_5119 then
                        (
                            {6573}let pkSess_5120: bitstring = pub(skA) in
                            {6574}in(c, =GetEndpointRequest);
                            {6575}new SPs_5121: bitstring;
                            {6576}new UP_5122: bitstring;
                            {6577}out(c, (SPs_5121,None,UP_5122,pkSess_5120))
                        )
                        else
                            {6578}let v_5123: bool = (Sess_3905 = B) in
                            (
                                {6579}if v_5123 then
                                (
                                    {6580}let pkSess_5124: bitstring = pub(skB) in
                                    {6581}in(c, =GetEndpointRequest);
                                    {6582}new SPs_5125: bitstring;
                                    {6583}new UP_5126: bitstring;
                                    {6584}out(c, (SPs_5125,None,UP_5126,pkSess_5124))
                                )
                                else
                                    {6585}let v_5127: bool = (Sess_3905 = C) in
                                    (
                                        {6586}if v_5127 then
                                        (
                                            {6587}let pkSess_5128: bitstring = pub(skC) in
                                            {6588}in(c, =GetEndpointRequest);
                                            {6589}new SPs_5129: bitstring;
                                            {6590}new UP_5130: bitstring;
                                            {6591}out(c, (SPs_5129,None,UP_5130,pkSess_5128))
                                        )
                                        else
                                            {6592}let pkSess_5131: bitstring = pub(skI) in
                                            {6593}in(c, =GetEndpointRequest);
                                            {6594}new SPs_5132: bitstring;
                                            {6595}new UP_5133: bitstring;
                                            {6596}out(c, (SPs_5132,None,UP_5133,pkSess_5131))
                                    )
                                    else
                                        {6597}let pkSess_5134: bitstring = fail-any in
                                        {6598}in(c, =GetEndpointRequest);
                                        {6599}new SPs_5135: bitstring;
                                        {6600}new UP_5136: bitstring;
                                        {6601}out(c, (SPs_5135,None,UP_5136,pkSess_5134))
                            )
                            else
                                {6602}let pkSess_5137: bitstring = fail-any in
                                {6603}in(c, =GetEndpointRequest);
                                {6604}new SPs_5138: bitstring;
                                {6605}new UP_5139: bitstring;
                                {6606}out(c, (SPs_5138,None,UP_5139,pkSess_5137))
                    )
                    else
                        {6607}let pkSess_5140: bitstring = fail-any in
                        {6608}in(c, =GetEndpointRequest);
                        {6609}new SPs_5141: bitstring;
                        {6610}new UP_5142: bitstring;
                        {6611}out(c, (SPs_5141,None,UP_5142,pkSess_5140))
        )
        else
            {6612}let pkCli_5143: bitstring = fail-any in
            {6613}let v_5144: bool = (Sess_3905 = A) in
            (
                {6614}if v_5144 then
                (
                    {6615}let pkSess_5145: bitstring = pub(skA) in
                    {6616}in(c, =GetEndpointRequest);
                    {6617}new SPs_5146: bitstring;
                    {6618}new UP_5147: bitstring;
                    {6619}out(c, (SPs_5146,None,UP_5147,pkSess_5145))
                )
                else
                    {6620}let v_5148: bool = (Sess_3905 = B) in
                    (
                        {6621}if v_5148 then
                        (
                            {6622}let pkSess_5149: bitstring = pub(skB) in
                            {6623}in(c, =GetEndpointRequest);
                            {6624}new SPs_5150: bitstring;
                            {6625}new UP_5151: bitstring;
                            {6626}out(c, (SPs_5150,None,UP_5151,pkSess_5149))
                        )
                        else
                            {6627}let v_5152: bool = (Sess_3905 = C) in
                            (
                                {6628}if v_5152 then
                                (
                                    {6629}let pkSess_5153: bitstring = pub(skC) in
                                    {6630}in(c, =GetEndpointRequest);
                                    {6631}new SPs_5154: bitstring;
                                    {6632}new UP_5155: bitstring;
                                    {6633}out(c, (SPs_5154,None,UP_5155,pkSess_5153))
                                )
                                else
                                    {6634}let pkSess_5156: bitstring = pub(skI) in
                                    {6635}in(c, =GetEndpointRequest);
                                    {6636}new SPs_5157: bitstring;
                                    {6637}new UP_5158: bitstring;
                                    {6638}out(c, (SPs_5157,None,UP_5158,pkSess_5156))
                            )
                            else
                                {6639}let pkSess_5159: bitstring = fail-any in
                                {6640}in(c, =GetEndpointRequest);
                                {6641}new SPs_5160: bitstring;
                                {6642}new UP_5161: bitstring;
                                {6643}out(c, (SPs_5160,None,UP_5161,pkSess_5159))
                    )
                    else
                        {6644}let pkSess_5162: bitstring = fail-any in
                        {6645}in(c, =GetEndpointRequest);
                        {6646}new SPs_5163: bitstring;
                        {6647}new UP_5164: bitstring;
                        {6648}out(c, (SPs_5163,None,UP_5164,pkSess_5162))
            )
            else
                {6649}let pkSess_5165: bitstring = fail-any in
                {6650}in(c, =GetEndpointRequest);
                {6651}new SPs_5166: bitstring;
                {6652}new UP_5167: bitstring;
                {6653}out(c, (SPs_5166,None,UP_5167,pkSess_5165))
) | (
    {6654}!
    {6655}in(c, (Cli_5168: host,Disco_5169: host,Sess_5170: host));
    {6656}let v_5171: bool = (Sess_5170 = A) in
    (
        {6657}if v_5171 then
        (
            {6658}let skSess: bitstring = skA in
            {6659}let pkSess_5172: bitstring = pub(skSess) in
            {6660}let v_5173: bool = (Cli_5168 = A) in
            (
                {6661}if v_5173 then
                (
                    {6662}let pkCli_5174: bitstring = pub(skA) in
                    {6663}let v_5175: bool = (Disco_5169 = A) in
                    (
                        {6664}if v_5175 then
                        (
                            {6665}let pkDisco_5176: bitstring = pub(skA) in
                            {6666}in(c, (=pkCli_5174,m1_5177: bitstring));
                            {6667}let (SPc_5178: bitstring,PartC: bitstring) = m1_5177 in
                            {6668}event endSrv(Cli_5168,Sess_5170,PartC);
                            {6669}new Ns: bitstring;
                            {6670}let gNs: bitstring = exp(g,Ns) in
                            {6671}let m2: bitstring = gNs in
                            {6672}event beginSrv(Sess_5170,Cli_5168,gNs);
                            {6673}out(c, m2)
                        )
                        else
                            {6674}let v_5179: bool = (Disco_5169 = B) in
                            (
                                {6675}if v_5179 then
                                (
                                    {6676}let pkDisco_5180: bitstring = pub(skB) in
                                    {6677}in(c, (=pkCli_5174,m1_5181: bitstring));
                                    {6678}let (SPc_5182: bitstring,PartC_5183: bitstring) = m1_5181 in
                                    {6679}event endSrv(Cli_5168,Sess_5170,PartC_5183);
                                    {6680}new Ns_5184: bitstring;
                                    {6681}let gNs_5185: bitstring = exp(g,Ns_5184) in
                                    {6682}let m2_5186: bitstring = gNs_5185 in
                                    {6683}event beginSrv(Sess_5170,Cli_5168,gNs_5185);
                                    {6684}out(c, m2_5186)
                                )
                                else
                                    {6685}let v_5187: bool = (Disco_5169 = C) in
                                    (
                                        {6686}if v_5187 then
                                        (
                                            {6687}let pkDisco_5188: bitstring = pub(skC) in
                                            {6688}in(c, (=pkCli_5174,m1_5189: bitstring));
                                            {6689}let (SPc_5190: bitstring,PartC_5191: bitstring) = m1_5189 in
                                            {6690}event endSrv(Cli_5168,Sess_5170,PartC_5191);
                                            {6691}new Ns_5192: bitstring;
                                            {6692}let gNs_5193: bitstring = exp(g,Ns_5192) in
                                            {6693}let m2_5194: bitstring = gNs_5193 in
                                            {6694}event beginSrv(Sess_5170,Cli_5168,gNs_5193);
                                            {6695}out(c, m2_5194)
                                        )
                                        else
                                            {6696}let pkDisco_5195: bitstring = pub(skI) in
                                            {6697}in(c, (=pkCli_5174,m1_5196: bitstring));
                                            {6698}let (SPc_5197: bitstring,PartC_5198: bitstring) = m1_5196 in
                                            {6699}event endSrv(Cli_5168,Sess_5170,PartC_5198);
                                            {6700}new Ns_5199: bitstring;
                                            {6701}let gNs_5200: bitstring = exp(g,Ns_5199) in
                                            {6702}let m2_5201: bitstring = gNs_5200 in
                                            {6703}event beginSrv(Sess_5170,Cli_5168,gNs_5200);
                                            {6704}out(c, m2_5201)
                                    )
                                    else
                                        {6705}let pkDisco_5202: bitstring = fail-any in
                                        {6706}in(c, (=pkCli_5174,m1_5203: bitstring));
                                        {6707}let (SPc_5204: bitstring,PartC_5205: bitstring) = m1_5203 in
                                        {6708}event endSrv(Cli_5168,Sess_5170,PartC_5205);
                                        {6709}new Ns_5206: bitstring;
                                        {6710}let gNs_5207: bitstring = exp(g,Ns_5206) in
                                        {6711}let m2_5208: bitstring = gNs_5207 in
                                        {6712}event beginSrv(Sess_5170,Cli_5168,gNs_5207);
                                        {6713}out(c, m2_5208)
                            )
                            else
                                {6714}let pkDisco_5209: bitstring = fail-any in
                                {6715}in(c, (=pkCli_5174,m1_5210: bitstring));
                                {6716}let (SPc_5211: bitstring,PartC_5212: bitstring) = m1_5210 in
                                {6717}event endSrv(Cli_5168,Sess_5170,PartC_5212);
                                {6718}new Ns_5213: bitstring;
                                {6719}let gNs_5214: bitstring = exp(g,Ns_5213) in
                                {6720}let m2_5215: bitstring = gNs_5214 in
                                {6721}event beginSrv(Sess_5170,Cli_5168,gNs_5214);
                                {6722}out(c, m2_5215)
                    )
                    else
                        {6723}let pkDisco_5216: bitstring = fail-any in
                        {6724}in(c, (=pkCli_5174,m1_5217: bitstring));
                        {6725}let (SPc_5218: bitstring,PartC_5219: bitstring) = m1_5217 in
                        {6726}event endSrv(Cli_5168,Sess_5170,PartC_5219);
                        {6727}new Ns_5220: bitstring;
                        {6728}let gNs_5221: bitstring = exp(g,Ns_5220) in
                        {6729}let m2_5222: bitstring = gNs_5221 in
                        {6730}event beginSrv(Sess_5170,Cli_5168,gNs_5221);
                        {6731}out(c, m2_5222)
                )
                else
                    {6732}let v_5223: bool = (Cli_5168 = B) in
                    (
                        {6733}if v_5223 then
                        (
                            {6734}let pkCli_5224: bitstring = pub(skB) in
                            {6735}let v_5225: bool = (Disco_5169 = A) in
                            (
                                {6736}if v_5225 then
                                (
                                    {6737}let pkDisco_5226: bitstring = pub(skA) in
                                    {6738}in(c, (=pkCli_5224,m1_5227: bitstring));
                                    {6739}let (SPc_5228: bitstring,PartC_5229: bitstring) = m1_5227 in
                                    {6740}event endSrv(Cli_5168,Sess_5170,PartC_5229);
                                    {6741}new Ns_5230: bitstring;
                                    {6742}let gNs_5231: bitstring = exp(g,Ns_5230) in
                                    {6743}let m2_5232: bitstring = gNs_5231 in
                                    {6744}event beginSrv(Sess_5170,Cli_5168,gNs_5231);
                                    {6745}out(c, m2_5232)
                                )
                                else
                                    {6746}let v_5233: bool = (Disco_5169 = B) in
                                    (
                                        {6747}if v_5233 then
                                        (
                                            {6748}let pkDisco_5234: bitstring = pub(skB) in
                                            {6749}in(c, (=pkCli_5224,m1_5235: bitstring));
                                            {6750}let (SPc_5236: bitstring,PartC_5237: bitstring) = m1_5235 in
                                            {6751}event endSrv(Cli_5168,Sess_5170,PartC_5237);
                                            {6752}new Ns_5238: bitstring;
                                            {6753}let gNs_5239: bitstring = exp(g,Ns_5238) in
                                            {6754}let m2_5240: bitstring = gNs_5239 in
                                            {6755}event beginSrv(Sess_5170,Cli_5168,gNs_5239);
                                            {6756}out(c, m2_5240)
                                        )
                                        else
                                            {6757}let v_5241: bool = (Disco_5169 = C) in
                                            (
                                                {6758}if v_5241 then
                                                (
                                                    {6759}let pkDisco_5242: bitstring = pub(skC) in
                                                    {6760}in(c, (=pkCli_5224,m1_5243: bitstring));
                                                    {6761}let (SPc_5244: bitstring,PartC_5245: bitstring) = m1_5243 in
                                                    {6762}event endSrv(Cli_5168,Sess_5170,PartC_5245);
                                                    {6763}new Ns_5246: bitstring;
                                                    {6764}let gNs_5247: bitstring = exp(g,Ns_5246) in
                                                    {6765}let m2_5248: bitstring = gNs_5247 in
                                                    {6766}event beginSrv(Sess_5170,Cli_5168,gNs_5247);
                                                    {6767}out(c, m2_5248)
                                                )
                                                else
                                                    {6768}let pkDisco_5249: bitstring = pub(skI) in
                                                    {6769}in(c, (=pkCli_5224,m1_5250: bitstring));
                                                    {6770}let (SPc_5251: bitstring,PartC_5252: bitstring) = m1_5250 in
                                                    {6771}event endSrv(Cli_5168,Sess_5170,PartC_5252);
                                                    {6772}new Ns_5253: bitstring;
                                                    {6773}let gNs_5254: bitstring = exp(g,Ns_5253) in
                                                    {6774}let m2_5255: bitstring = gNs_5254 in
                                                    {6775}event beginSrv(Sess_5170,Cli_5168,gNs_5254);
                                                    {6776}out(c, m2_5255)
                                            )
                                            else
                                                {6777}let pkDisco_5256: bitstring = fail-any in
                                                {6778}in(c, (=pkCli_5224,m1_5257: bitstring));
                                                {6779}let (SPc_5258: bitstring,PartC_5259: bitstring) = m1_5257 in
                                                {6780}event endSrv(Cli_5168,Sess_5170,PartC_5259);
                                                {6781}new Ns_5260: bitstring;
                                                {6782}let gNs_5261: bitstring = exp(g,Ns_5260) in
                                                {6783}let m2_5262: bitstring = gNs_5261 in
                                                {6784}event beginSrv(Sess_5170,Cli_5168,gNs_5261);
                                                {6785}out(c, m2_5262)
                                    )
                                    else
                                        {6786}let pkDisco_5263: bitstring = fail-any in
                                        {6787}in(c, (=pkCli_5224,m1_5264: bitstring));
                                        {6788}let (SPc_5265: bitstring,PartC_5266: bitstring) = m1_5264 in
                                        {6789}event endSrv(Cli_5168,Sess_5170,PartC_5266);
                                        {6790}new Ns_5267: bitstring;
                                        {6791}let gNs_5268: bitstring = exp(g,Ns_5267) in
                                        {6792}let m2_5269: bitstring = gNs_5268 in
                                        {6793}event beginSrv(Sess_5170,Cli_5168,gNs_5268);
                                        {6794}out(c, m2_5269)
                            )
                            else
                                {6795}let pkDisco_5270: bitstring = fail-any in
                                {6796}in(c, (=pkCli_5224,m1_5271: bitstring));
                                {6797}let (SPc_5272: bitstring,PartC_5273: bitstring) = m1_5271 in
                                {6798}event endSrv(Cli_5168,Sess_5170,PartC_5273);
                                {6799}new Ns_5274: bitstring;
                                {6800}let gNs_5275: bitstring = exp(g,Ns_5274) in
                                {6801}let m2_5276: bitstring = gNs_5275 in
                                {6802}event beginSrv(Sess_5170,Cli_5168,gNs_5275);
                                {6803}out(c, m2_5276)
                        )
                        else
                            {6804}let v_5277: bool = (Cli_5168 = C) in
                            (
                                {6805}if v_5277 then
                                (
                                    {6806}let pkCli_5278: bitstring = pub(skC) in
                                    {6807}let v_5279: bool = (Disco_5169 = A) in
                                    (
                                        {6808}if v_5279 then
                                        (
                                            {6809}let pkDisco_5280: bitstring = pub(skA) in
                                            {6810}in(c, (=pkCli_5278,m1_5281: bitstring));
                                            {6811}let (SPc_5282: bitstring,PartC_5283: bitstring) = m1_5281 in
                                            {6812}event endSrv(Cli_5168,Sess_5170,PartC_5283);
                                            {6813}new Ns_5284: bitstring;
                                            {6814}let gNs_5285: bitstring = exp(g,Ns_5284) in
                                            {6815}let m2_5286: bitstring = gNs_5285 in
                                            {6816}event beginSrv(Sess_5170,Cli_5168,gNs_5285);
                                            {6817}out(c, m2_5286)
                                        )
                                        else
                                            {6818}let v_5287: bool = (Disco_5169 = B) in
                                            (
                                                {6819}if v_5287 then
                                                (
                                                    {6820}let pkDisco_5288: bitstring = pub(skB) in
                                                    {6821}in(c, (=pkCli_5278,m1_5289: bitstring));
                                                    {6822}let (SPc_5290: bitstring,PartC_5291: bitstring) = m1_5289 in
                                                    {6823}event endSrv(Cli_5168,Sess_5170,PartC_5291);
                                                    {6824}new Ns_5292: bitstring;
                                                    {6825}let gNs_5293: bitstring = exp(g,Ns_5292) in
                                                    {6826}let m2_5294: bitstring = gNs_5293 in
                                                    {6827}event beginSrv(Sess_5170,Cli_5168,gNs_5293);
                                                    {6828}out(c, m2_5294)
                                                )
                                                else
                                                    {6829}let v_5295: bool = (Disco_5169 = C) in
                                                    (
                                                        {6830}if v_5295 then
                                                        (
                                                            {6831}let pkDisco_5296: bitstring = pub(skC) in
                                                            {6832}in(c, (=pkCli_5278,m1_5297: bitstring));
                                                            {6833}let (SPc_5298: bitstring,PartC_5299: bitstring) = m1_5297 in
                                                            {6834}event endSrv(Cli_5168,Sess_5170,PartC_5299);
                                                            {6835}new Ns_5300: bitstring;
                                                            {6836}let gNs_5301: bitstring = exp(g,Ns_5300) in
                                                            {6837}let m2_5302: bitstring = gNs_5301 in
                                                            {6838}event beginSrv(Sess_5170,Cli_5168,gNs_5301);
                                                            {6839}out(c, m2_5302)
                                                        )
                                                        else
                                                            {6840}let pkDisco_5303: bitstring = pub(skI) in
                                                            {6841}in(c, (=pkCli_5278,m1_5304: bitstring));
                                                            {6842}let (SPc_5305: bitstring,PartC_5306: bitstring) = m1_5304 in
                                                            {6843}event endSrv(Cli_5168,Sess_5170,PartC_5306);
                                                            {6844}new Ns_5307: bitstring;
                                                            {6845}let gNs_5308: bitstring = exp(g,Ns_5307) in
                                                            {6846}let m2_5309: bitstring = gNs_5308 in
                                                            {6847}event beginSrv(Sess_5170,Cli_5168,gNs_5308);
                                                            {6848}out(c, m2_5309)
                                                    )
                                                    else
                                                        {6849}let pkDisco_5310: bitstring = fail-any in
                                                        {6850}in(c, (=pkCli_5278,m1_5311: bitstring));
                                                        {6851}let (SPc_5312: bitstring,PartC_5313: bitstring) = m1_5311 in
                                                        {6852}event endSrv(Cli_5168,Sess_5170,PartC_5313);
                                                        {6853}new Ns_5314: bitstring;
                                                        {6854}let gNs_5315: bitstring = exp(g,Ns_5314) in
                                                        {6855}let m2_5316: bitstring = gNs_5315 in
                                                        {6856}event beginSrv(Sess_5170,Cli_5168,gNs_5315);
                                                        {6857}out(c, m2_5316)
                                            )
                                            else
                                                {6858}let pkDisco_5317: bitstring = fail-any in
                                                {6859}in(c, (=pkCli_5278,m1_5318: bitstring));
                                                {6860}let (SPc_5319: bitstring,PartC_5320: bitstring) = m1_5318 in
                                                {6861}event endSrv(Cli_5168,Sess_5170,PartC_5320);
                                                {6862}new Ns_5321: bitstring;
                                                {6863}let gNs_5322: bitstring = exp(g,Ns_5321) in
                                                {6864}let m2_5323: bitstring = gNs_5322 in
                                                {6865}event beginSrv(Sess_5170,Cli_5168,gNs_5322);
                                                {6866}out(c, m2_5323)
                                    )
                                    else
                                        {6867}let pkDisco_5324: bitstring = fail-any in
                                        {6868}in(c, (=pkCli_5278,m1_5325: bitstring));
                                        {6869}let (SPc_5326: bitstring,PartC_5327: bitstring) = m1_5325 in
                                        {6870}event endSrv(Cli_5168,Sess_5170,PartC_5327);
                                        {6871}new Ns_5328: bitstring;
                                        {6872}let gNs_5329: bitstring = exp(g,Ns_5328) in
                                        {6873}let m2_5330: bitstring = gNs_5329 in
                                        {6874}event beginSrv(Sess_5170,Cli_5168,gNs_5329);
                                        {6875}out(c, m2_5330)
                                )
                                else
                                    {6876}let pkCli_5331: bitstring = pub(skI) in
                                    {6877}let v_5332: bool = (Disco_5169 = A) in
                                    (
                                        {6878}if v_5332 then
                                        (
                                            {6879}let pkDisco_5333: bitstring = pub(skA) in
                                            {6880}in(c, (=pkCli_5331,m1_5334: bitstring));
                                            {6881}let (SPc_5335: bitstring,PartC_5336: bitstring) = m1_5334 in
                                            {6882}event endSrv(Cli_5168,Sess_5170,PartC_5336);
                                            {6883}new Ns_5337: bitstring;
                                            {6884}let gNs_5338: bitstring = exp(g,Ns_5337) in
                                            {6885}let m2_5339: bitstring = gNs_5338 in
                                            {6886}event beginSrv(Sess_5170,Cli_5168,gNs_5338);
                                            {6887}out(c, m2_5339)
                                        )
                                        else
                                            {6888}let v_5340: bool = (Disco_5169 = B) in
                                            (
                                                {6889}if v_5340 then
                                                (
                                                    {6890}let pkDisco_5341: bitstring = pub(skB) in
                                                    {6891}in(c, (=pkCli_5331,m1_5342: bitstring));
                                                    {6892}let (SPc_5343: bitstring,PartC_5344: bitstring) = m1_5342 in
                                                    {6893}event endSrv(Cli_5168,Sess_5170,PartC_5344);
                                                    {6894}new Ns_5345: bitstring;
                                                    {6895}let gNs_5346: bitstring = exp(g,Ns_5345) in
                                                    {6896}let m2_5347: bitstring = gNs_5346 in
                                                    {6897}event beginSrv(Sess_5170,Cli_5168,gNs_5346);
                                                    {6898}out(c, m2_5347)
                                                )
                                                else
                                                    {6899}let v_5348: bool = (Disco_5169 = C) in
                                                    (
                                                        {6900}if v_5348 then
                                                        (
                                                            {6901}let pkDisco_5349: bitstring = pub(skC) in
                                                            {6902}in(c, (=pkCli_5331,m1_5350: bitstring));
                                                            {6903}let (SPc_5351: bitstring,PartC_5352: bitstring) = m1_5350 in
                                                            {6904}event endSrv(Cli_5168,Sess_5170,PartC_5352);
                                                            {6905}new Ns_5353: bitstring;
                                                            {6906}let gNs_5354: bitstring = exp(g,Ns_5353) in
                                                            {6907}let m2_5355: bitstring = gNs_5354 in
                                                            {6908}event beginSrv(Sess_5170,Cli_5168,gNs_5354);
                                                            {6909}out(c, m2_5355)
                                                        )
                                                        else
                                                            {6910}let pkDisco_5356: bitstring = pub(skI) in
                                                            {6911}in(c, (=pkCli_5331,m1_5357: bitstring));
                                                            {6912}let (SPc_5358: bitstring,PartC_5359: bitstring) = m1_5357 in
                                                            {6913}event endSrv(Cli_5168,Sess_5170,PartC_5359);
                                                            {6914}new Ns_5360: bitstring;
                                                            {6915}let gNs_5361: bitstring = exp(g,Ns_5360) in
                                                            {6916}let m2_5362: bitstring = gNs_5361 in
                                                            {6917}event beginSrv(Sess_5170,Cli_5168,gNs_5361);
                                                            {6918}out(c, m2_5362)
                                                    )
                                                    else
                                                        {6919}let pkDisco_5363: bitstring = fail-any in
                                                        {6920}in(c, (=pkCli_5331,m1_5364: bitstring));
                                                        {6921}let (SPc_5365: bitstring,PartC_5366: bitstring) = m1_5364 in
                                                        {6922}event endSrv(Cli_5168,Sess_5170,PartC_5366);
                                                        {6923}new Ns_5367: bitstring;
                                                        {6924}let gNs_5368: bitstring = exp(g,Ns_5367) in
                                                        {6925}let m2_5369: bitstring = gNs_5368 in
                                                        {6926}event beginSrv(Sess_5170,Cli_5168,gNs_5368);
                                                        {6927}out(c, m2_5369)
                                            )
                                            else
                                                {6928}let pkDisco_5370: bitstring = fail-any in
                                                {6929}in(c, (=pkCli_5331,m1_5371: bitstring));
                                                {6930}let (SPc_5372: bitstring,PartC_5373: bitstring) = m1_5371 in
                                                {6931}event endSrv(Cli_5168,Sess_5170,PartC_5373);
                                                {6932}new Ns_5374: bitstring;
                                                {6933}let gNs_5375: bitstring = exp(g,Ns_5374) in
                                                {6934}let m2_5376: bitstring = gNs_5375 in
                                                {6935}event beginSrv(Sess_5170,Cli_5168,gNs_5375);
                                                {6936}out(c, m2_5376)
                                    )
                                    else
                                        {6937}let pkDisco_5377: bitstring = fail-any in
                                        {6938}in(c, (=pkCli_5331,m1_5378: bitstring));
                                        {6939}let (SPc_5379: bitstring,PartC_5380: bitstring) = m1_5378 in
                                        {6940}event endSrv(Cli_5168,Sess_5170,PartC_5380);
                                        {6941}new Ns_5381: bitstring;
                                        {6942}let gNs_5382: bitstring = exp(g,Ns_5381) in
                                        {6943}let m2_5383: bitstring = gNs_5382 in
                                        {6944}event beginSrv(Sess_5170,Cli_5168,gNs_5382);
                                        {6945}out(c, m2_5383)
                            )
                            else
                                {6946}let pkCli_5384: bitstring = fail-any in
                                {6947}let v_5385: bool = (Disco_5169 = A) in
                                (
                                    {6948}if v_5385 then
                                    (
                                        {6949}let pkDisco_5386: bitstring = pub(skA) in
                                        {6950}in(c, (=pkCli_5384,m1_5387: bitstring));
                                        {6951}let (SPc_5388: bitstring,PartC_5389: bitstring) = m1_5387 in
                                        {6952}event endSrv(Cli_5168,Sess_5170,PartC_5389);
                                        {6953}new Ns_5390: bitstring;
                                        {6954}let gNs_5391: bitstring = exp(g,Ns_5390) in
                                        {6955}let m2_5392: bitstring = gNs_5391 in
                                        {6956}event beginSrv(Sess_5170,Cli_5168,gNs_5391);
                                        {6957}out(c, m2_5392)
                                    )
                                    else
                                        {6958}let v_5393: bool = (Disco_5169 = B) in
                                        (
                                            {6959}if v_5393 then
                                            (
                                                {6960}let pkDisco_5394: bitstring = pub(skB) in
                                                {6961}in(c, (=pkCli_5384,m1_5395: bitstring));
                                                {6962}let (SPc_5396: bitstring,PartC_5397: bitstring) = m1_5395 in
                                                {6963}event endSrv(Cli_5168,Sess_5170,PartC_5397);
                                                {6964}new Ns_5398: bitstring;
                                                {6965}let gNs_5399: bitstring = exp(g,Ns_5398) in
                                                {6966}let m2_5400: bitstring = gNs_5399 in
                                                {6967}event beginSrv(Sess_5170,Cli_5168,gNs_5399);
                                                {6968}out(c, m2_5400)
                                            )
                                            else
                                                {6969}let v_5401: bool = (Disco_5169 = C) in
                                                (
                                                    {6970}if v_5401 then
                                                    (
                                                        {6971}let pkDisco_5402: bitstring = pub(skC) in
                                                        {6972}in(c, (=pkCli_5384,m1_5403: bitstring));
                                                        {6973}let (SPc_5404: bitstring,PartC_5405: bitstring) = m1_5403 in
                                                        {6974}event endSrv(Cli_5168,Sess_5170,PartC_5405);
                                                        {6975}new Ns_5406: bitstring;
                                                        {6976}let gNs_5407: bitstring = exp(g,Ns_5406) in
                                                        {6977}let m2_5408: bitstring = gNs_5407 in
                                                        {6978}event beginSrv(Sess_5170,Cli_5168,gNs_5407);
                                                        {6979}out(c, m2_5408)
                                                    )
                                                    else
                                                        {6980}let pkDisco_5409: bitstring = pub(skI) in
                                                        {6981}in(c, (=pkCli_5384,m1_5410: bitstring));
                                                        {6982}let (SPc_5411: bitstring,PartC_5412: bitstring) = m1_5410 in
                                                        {6983}event endSrv(Cli_5168,Sess_5170,PartC_5412);
                                                        {6984}new Ns_5413: bitstring;
                                                        {6985}let gNs_5414: bitstring = exp(g,Ns_5413) in
                                                        {6986}let m2_5415: bitstring = gNs_5414 in
                                                        {6987}event beginSrv(Sess_5170,Cli_5168,gNs_5414);
                                                        {6988}out(c, m2_5415)
                                                )
                                                else
                                                    {6989}let pkDisco_5416: bitstring = fail-any in
                                                    {6990}in(c, (=pkCli_5384,m1_5417: bitstring));
                                                    {6991}let (SPc_5418: bitstring,PartC_5419: bitstring) = m1_5417 in
                                                    {6992}event endSrv(Cli_5168,Sess_5170,PartC_5419);
                                                    {6993}new Ns_5420: bitstring;
                                                    {6994}let gNs_5421: bitstring = exp(g,Ns_5420) in
                                                    {6995}let m2_5422: bitstring = gNs_5421 in
                                                    {6996}event beginSrv(Sess_5170,Cli_5168,gNs_5421);
                                                    {6997}out(c, m2_5422)
                                        )
                                        else
                                            {6998}let pkDisco_5423: bitstring = fail-any in
                                            {6999}in(c, (=pkCli_5384,m1_5424: bitstring));
                                            {7000}let (SPc_5425: bitstring,PartC_5426: bitstring) = m1_5424 in
                                            {7001}event endSrv(Cli_5168,Sess_5170,PartC_5426);
                                            {7002}new Ns_5427: bitstring;
                                            {7003}let gNs_5428: bitstring = exp(g,Ns_5427) in
                                            {7004}let m2_5429: bitstring = gNs_5428 in
                                            {7005}event beginSrv(Sess_5170,Cli_5168,gNs_5428);
                                            {7006}out(c, m2_5429)
                                )
                                else
                                    {7007}let pkDisco_5430: bitstring = fail-any in
                                    {7008}in(c, (=pkCli_5384,m1_5431: bitstring));
                                    {7009}let (SPc_5432: bitstring,PartC_5433: bitstring) = m1_5431 in
                                    {7010}event endSrv(Cli_5168,Sess_5170,PartC_5433);
                                    {7011}new Ns_5434: bitstring;
                                    {7012}let gNs_5435: bitstring = exp(g,Ns_5434) in
                                    {7013}let m2_5436: bitstring = gNs_5435 in
                                    {7014}event beginSrv(Sess_5170,Cli_5168,gNs_5435);
                                    {7015}out(c, m2_5436)
                    )
                    else
                        {7016}let pkCli_5437: bitstring = fail-any in
                        {7017}let v_5438: bool = (Disco_5169 = A) in
                        (
                            {7018}if v_5438 then
                            (
                                {7019}let pkDisco_5439: bitstring = pub(skA) in
                                {7020}in(c, (=pkCli_5437,m1_5440: bitstring));
                                {7021}let (SPc_5441: bitstring,PartC_5442: bitstring) = m1_5440 in
                                {7022}event endSrv(Cli_5168,Sess_5170,PartC_5442);
                                {7023}new Ns_5443: bitstring;
                                {7024}let gNs_5444: bitstring = exp(g,Ns_5443) in
                                {7025}let m2_5445: bitstring = gNs_5444 in
                                {7026}event beginSrv(Sess_5170,Cli_5168,gNs_5444);
                                {7027}out(c, m2_5445)
                            )
                            else
                                {7028}let v_5446: bool = (Disco_5169 = B) in
                                (
                                    {7029}if v_5446 then
                                    (
                                        {7030}let pkDisco_5447: bitstring = pub(skB) in
                                        {7031}in(c, (=pkCli_5437,m1_5448: bitstring));
                                        {7032}let (SPc_5449: bitstring,PartC_5450: bitstring) = m1_5448 in
                                        {7033}event endSrv(Cli_5168,Sess_5170,PartC_5450);
                                        {7034}new Ns_5451: bitstring;
                                        {7035}let gNs_5452: bitstring = exp(g,Ns_5451) in
                                        {7036}let m2_5453: bitstring = gNs_5452 in
                                        {7037}event beginSrv(Sess_5170,Cli_5168,gNs_5452);
                                        {7038}out(c, m2_5453)
                                    )
                                    else
                                        {7039}let v_5454: bool = (Disco_5169 = C) in
                                        (
                                            {7040}if v_5454 then
                                            (
                                                {7041}let pkDisco_5455: bitstring = pub(skC) in
                                                {7042}in(c, (=pkCli_5437,m1_5456: bitstring));
                                                {7043}let (SPc_5457: bitstring,PartC_5458: bitstring) = m1_5456 in
                                                {7044}event endSrv(Cli_5168,Sess_5170,PartC_5458);
                                                {7045}new Ns_5459: bitstring;
                                                {7046}let gNs_5460: bitstring = exp(g,Ns_5459) in
                                                {7047}let m2_5461: bitstring = gNs_5460 in
                                                {7048}event beginSrv(Sess_5170,Cli_5168,gNs_5460);
                                                {7049}out(c, m2_5461)
                                            )
                                            else
                                                {7050}let pkDisco_5462: bitstring = pub(skI) in
                                                {7051}in(c, (=pkCli_5437,m1_5463: bitstring));
                                                {7052}let (SPc_5464: bitstring,PartC_5465: bitstring) = m1_5463 in
                                                {7053}event endSrv(Cli_5168,Sess_5170,PartC_5465);
                                                {7054}new Ns_5466: bitstring;
                                                {7055}let gNs_5467: bitstring = exp(g,Ns_5466) in
                                                {7056}let m2_5468: bitstring = gNs_5467 in
                                                {7057}event beginSrv(Sess_5170,Cli_5168,gNs_5467);
                                                {7058}out(c, m2_5468)
                                        )
                                        else
                                            {7059}let pkDisco_5469: bitstring = fail-any in
                                            {7060}in(c, (=pkCli_5437,m1_5470: bitstring));
                                            {7061}let (SPc_5471: bitstring,PartC_5472: bitstring) = m1_5470 in
                                            {7062}event endSrv(Cli_5168,Sess_5170,PartC_5472);
                                            {7063}new Ns_5473: bitstring;
                                            {7064}let gNs_5474: bitstring = exp(g,Ns_5473) in
                                            {7065}let m2_5475: bitstring = gNs_5474 in
                                            {7066}event beginSrv(Sess_5170,Cli_5168,gNs_5474);
                                            {7067}out(c, m2_5475)
                                )
                                else
                                    {7068}let pkDisco_5476: bitstring = fail-any in
                                    {7069}in(c, (=pkCli_5437,m1_5477: bitstring));
                                    {7070}let (SPc_5478: bitstring,PartC_5479: bitstring) = m1_5477 in
                                    {7071}event endSrv(Cli_5168,Sess_5170,PartC_5479);
                                    {7072}new Ns_5480: bitstring;
                                    {7073}let gNs_5481: bitstring = exp(g,Ns_5480) in
                                    {7074}let m2_5482: bitstring = gNs_5481 in
                                    {7075}event beginSrv(Sess_5170,Cli_5168,gNs_5481);
                                    {7076}out(c, m2_5482)
                        )
                        else
                            {7077}let pkDisco_5483: bitstring = fail-any in
                            {7078}in(c, (=pkCli_5437,m1_5484: bitstring));
                            {7079}let (SPc_5485: bitstring,PartC_5486: bitstring) = m1_5484 in
                            {7080}event endSrv(Cli_5168,Sess_5170,PartC_5486);
                            {7081}new Ns_5487: bitstring;
                            {7082}let gNs_5488: bitstring = exp(g,Ns_5487) in
                            {7083}let m2_5489: bitstring = gNs_5488 in
                            {7084}event beginSrv(Sess_5170,Cli_5168,gNs_5488);
                            {7085}out(c, m2_5489)
            )
            else
                {7086}let pkCli_5490: bitstring = fail-any in
                {7087}let v_5491: bool = (Disco_5169 = A) in
                (
                    {7088}if v_5491 then
                    (
                        {7089}let pkDisco_5492: bitstring = pub(skA) in
                        {7090}in(c, (=pkCli_5490,m1_5493: bitstring));
                        {7091}let (SPc_5494: bitstring,PartC_5495: bitstring) = m1_5493 in
                        {7092}event endSrv(Cli_5168,Sess_5170,PartC_5495);
                        {7093}new Ns_5496: bitstring;
                        {7094}let gNs_5497: bitstring = exp(g,Ns_5496) in
                        {7095}let m2_5498: bitstring = gNs_5497 in
                        {7096}event beginSrv(Sess_5170,Cli_5168,gNs_5497);
                        {7097}out(c, m2_5498)
                    )
                    else
                        {7098}let v_5499: bool = (Disco_5169 = B) in
                        (
                            {7099}if v_5499 then
                            (
                                {7100}let pkDisco_5500: bitstring = pub(skB) in
                                {7101}in(c, (=pkCli_5490,m1_5501: bitstring));
                                {7102}let (SPc_5502: bitstring,PartC_5503: bitstring) = m1_5501 in
                                {7103}event endSrv(Cli_5168,Sess_5170,PartC_5503);
                                {7104}new Ns_5504: bitstring;
                                {7105}let gNs_5505: bitstring = exp(g,Ns_5504) in
                                {7106}let m2_5506: bitstring = gNs_5505 in
                                {7107}event beginSrv(Sess_5170,Cli_5168,gNs_5505);
                                {7108}out(c, m2_5506)
                            )
                            else
                                {7109}let v_5507: bool = (Disco_5169 = C) in
                                (
                                    {7110}if v_5507 then
                                    (
                                        {7111}let pkDisco_5508: bitstring = pub(skC) in
                                        {7112}in(c, (=pkCli_5490,m1_5509: bitstring));
                                        {7113}let (SPc_5510: bitstring,PartC_5511: bitstring) = m1_5509 in
                                        {7114}event endSrv(Cli_5168,Sess_5170,PartC_5511);
                                        {7115}new Ns_5512: bitstring;
                                        {7116}let gNs_5513: bitstring = exp(g,Ns_5512) in
                                        {7117}let m2_5514: bitstring = gNs_5513 in
                                        {7118}event beginSrv(Sess_5170,Cli_5168,gNs_5513);
                                        {7119}out(c, m2_5514)
                                    )
                                    else
                                        {7120}let pkDisco_5515: bitstring = pub(skI) in
                                        {7121}in(c, (=pkCli_5490,m1_5516: bitstring));
                                        {7122}let (SPc_5517: bitstring,PartC_5518: bitstring) = m1_5516 in
                                        {7123}event endSrv(Cli_5168,Sess_5170,PartC_5518);
                                        {7124}new Ns_5519: bitstring;
                                        {7125}let gNs_5520: bitstring = exp(g,Ns_5519) in
                                        {7126}let m2_5521: bitstring = gNs_5520 in
                                        {7127}event beginSrv(Sess_5170,Cli_5168,gNs_5520);
                                        {7128}out(c, m2_5521)
                                )
                                else
                                    {7129}let pkDisco_5522: bitstring = fail-any in
                                    {7130}in(c, (=pkCli_5490,m1_5523: bitstring));
                                    {7131}let (SPc_5524: bitstring,PartC_5525: bitstring) = m1_5523 in
                                    {7132}event endSrv(Cli_5168,Sess_5170,PartC_5525);
                                    {7133}new Ns_5526: bitstring;
                                    {7134}let gNs_5527: bitstring = exp(g,Ns_5526) in
                                    {7135}let m2_5528: bitstring = gNs_5527 in
                                    {7136}event beginSrv(Sess_5170,Cli_5168,gNs_5527);
                                    {7137}out(c, m2_5528)
                        )
                        else
                            {7138}let pkDisco_5529: bitstring = fail-any in
                            {7139}in(c, (=pkCli_5490,m1_5530: bitstring));
                            {7140}let (SPc_5531: bitstring,PartC_5532: bitstring) = m1_5530 in
                            {7141}event endSrv(Cli_5168,Sess_5170,PartC_5532);
                            {7142}new Ns_5533: bitstring;
                            {7143}let gNs_5534: bitstring = exp(g,Ns_5533) in
                            {7144}let m2_5535: bitstring = gNs_5534 in
                            {7145}event beginSrv(Sess_5170,Cli_5168,gNs_5534);
                            {7146}out(c, m2_5535)
                )
                else
                    {7147}let pkDisco_5536: bitstring = fail-any in
                    {7148}in(c, (=pkCli_5490,m1_5537: bitstring));
                    {7149}let (SPc_5538: bitstring,PartC_5539: bitstring) = m1_5537 in
                    {7150}event endSrv(Cli_5168,Sess_5170,PartC_5539);
                    {7151}new Ns_5540: bitstring;
                    {7152}let gNs_5541: bitstring = exp(g,Ns_5540) in
                    {7153}let m2_5542: bitstring = gNs_5541 in
                    {7154}event beginSrv(Sess_5170,Cli_5168,gNs_5541);
                    {7155}out(c, m2_5542)
        )
        else
            {7156}let v_5543: bool = (Sess_5170 = B) in
            (
                {7157}if v_5543 then
                (
                    {7158}let skSess_5544: bitstring = skB in
                    {7159}let pkSess_5545: bitstring = pub(skSess_5544) in
                    {7160}let v_5546: bool = (Cli_5168 = A) in
                    (
                        {7161}if v_5546 then
                        (
                            {7162}let pkCli_5547: bitstring = pub(skA) in
                            {7163}let v_5548: bool = (Disco_5169 = A) in
                            (
                                {7164}if v_5548 then
                                (
                                    {7165}let pkDisco_5549: bitstring = pub(skA) in
                                    {7166}in(c, (=pkCli_5547,m1_5550: bitstring));
                                    {7167}let (SPc_5551: bitstring,PartC_5552: bitstring) = m1_5550 in
                                    {7168}event endSrv(Cli_5168,Sess_5170,PartC_5552);
                                    {7169}new Ns_5553: bitstring;
                                    {7170}let gNs_5554: bitstring = exp(g,Ns_5553) in
                                    {7171}let m2_5555: bitstring = gNs_5554 in
                                    {7172}event beginSrv(Sess_5170,Cli_5168,gNs_5554);
                                    {7173}out(c, m2_5555)
                                )
                                else
                                    {7174}let v_5556: bool = (Disco_5169 = B) in
                                    (
                                        {7175}if v_5556 then
                                        (
                                            {7176}let pkDisco_5557: bitstring = pub(skB) in
                                            {7177}in(c, (=pkCli_5547,m1_5558: bitstring));
                                            {7178}let (SPc_5559: bitstring,PartC_5560: bitstring) = m1_5558 in
                                            {7179}event endSrv(Cli_5168,Sess_5170,PartC_5560);
                                            {7180}new Ns_5561: bitstring;
                                            {7181}let gNs_5562: bitstring = exp(g,Ns_5561) in
                                            {7182}let m2_5563: bitstring = gNs_5562 in
                                            {7183}event beginSrv(Sess_5170,Cli_5168,gNs_5562);
                                            {7184}out(c, m2_5563)
                                        )
                                        else
                                            {7185}let v_5564: bool = (Disco_5169 = C) in
                                            (
                                                {7186}if v_5564 then
                                                (
                                                    {7187}let pkDisco_5565: bitstring = pub(skC) in
                                                    {7188}in(c, (=pkCli_5547,m1_5566: bitstring));
                                                    {7189}let (SPc_5567: bitstring,PartC_5568: bitstring) = m1_5566 in
                                                    {7190}event endSrv(Cli_5168,Sess_5170,PartC_5568);
                                                    {7191}new Ns_5569: bitstring;
                                                    {7192}let gNs_5570: bitstring = exp(g,Ns_5569) in
                                                    {7193}let m2_5571: bitstring = gNs_5570 in
                                                    {7194}event beginSrv(Sess_5170,Cli_5168,gNs_5570);
                                                    {7195}out(c, m2_5571)
                                                )
                                                else
                                                    {7196}let pkDisco_5572: bitstring = pub(skI) in
                                                    {7197}in(c, (=pkCli_5547,m1_5573: bitstring));
                                                    {7198}let (SPc_5574: bitstring,PartC_5575: bitstring) = m1_5573 in
                                                    {7199}event endSrv(Cli_5168,Sess_5170,PartC_5575);
                                                    {7200}new Ns_5576: bitstring;
                                                    {7201}let gNs_5577: bitstring = exp(g,Ns_5576) in
                                                    {7202}let m2_5578: bitstring = gNs_5577 in
                                                    {7203}event beginSrv(Sess_5170,Cli_5168,gNs_5577);
                                                    {7204}out(c, m2_5578)
                                            )
                                            else
                                                {7205}let pkDisco_5579: bitstring = fail-any in
                                                {7206}in(c, (=pkCli_5547,m1_5580: bitstring));
                                                {7207}let (SPc_5581: bitstring,PartC_5582: bitstring) = m1_5580 in
                                                {7208}event endSrv(Cli_5168,Sess_5170,PartC_5582);
                                                {7209}new Ns_5583: bitstring;
                                                {7210}let gNs_5584: bitstring = exp(g,Ns_5583) in
                                                {7211}let m2_5585: bitstring = gNs_5584 in
                                                {7212}event beginSrv(Sess_5170,Cli_5168,gNs_5584);
                                                {7213}out(c, m2_5585)
                                    )
                                    else
                                        {7214}let pkDisco_5586: bitstring = fail-any in
                                        {7215}in(c, (=pkCli_5547,m1_5587: bitstring));
                                        {7216}let (SPc_5588: bitstring,PartC_5589: bitstring) = m1_5587 in
                                        {7217}event endSrv(Cli_5168,Sess_5170,PartC_5589);
                                        {7218}new Ns_5590: bitstring;
                                        {7219}let gNs_5591: bitstring = exp(g,Ns_5590) in
                                        {7220}let m2_5592: bitstring = gNs_5591 in
                                        {7221}event beginSrv(Sess_5170,Cli_5168,gNs_5591);
                                        {7222}out(c, m2_5592)
                            )
                            else
                                {7223}let pkDisco_5593: bitstring = fail-any in
                                {7224}in(c, (=pkCli_5547,m1_5594: bitstring));
                                {7225}let (SPc_5595: bitstring,PartC_5596: bitstring) = m1_5594 in
                                {7226}event endSrv(Cli_5168,Sess_5170,PartC_5596);
                                {7227}new Ns_5597: bitstring;
                                {7228}let gNs_5598: bitstring = exp(g,Ns_5597) in
                                {7229}let m2_5599: bitstring = gNs_5598 in
                                {7230}event beginSrv(Sess_5170,Cli_5168,gNs_5598);
                                {7231}out(c, m2_5599)
                        )
                        else
                            {7232}let v_5600: bool = (Cli_5168 = B) in
                            (
                                {7233}if v_5600 then
                                (
                                    {7234}let pkCli_5601: bitstring = pub(skB) in
                                    {7235}let v_5602: bool = (Disco_5169 = A) in
                                    (
                                        {7236}if v_5602 then
                                        (
                                            {7237}let pkDisco_5603: bitstring = pub(skA) in
                                            {7238}in(c, (=pkCli_5601,m1_5604: bitstring));
                                            {7239}let (SPc_5605: bitstring,PartC_5606: bitstring) = m1_5604 in
                                            {7240}event endSrv(Cli_5168,Sess_5170,PartC_5606);
                                            {7241}new Ns_5607: bitstring;
                                            {7242}let gNs_5608: bitstring = exp(g,Ns_5607) in
                                            {7243}let m2_5609: bitstring = gNs_5608 in
                                            {7244}event beginSrv(Sess_5170,Cli_5168,gNs_5608);
                                            {7245}out(c, m2_5609)
                                        )
                                        else
                                            {7246}let v_5610: bool = (Disco_5169 = B) in
                                            (
                                                {7247}if v_5610 then
                                                (
                                                    {7248}let pkDisco_5611: bitstring = pub(skB) in
                                                    {7249}in(c, (=pkCli_5601,m1_5612: bitstring));
                                                    {7250}let (SPc_5613: bitstring,PartC_5614: bitstring) = m1_5612 in
                                                    {7251}event endSrv(Cli_5168,Sess_5170,PartC_5614);
                                                    {7252}new Ns_5615: bitstring;
                                                    {7253}let gNs_5616: bitstring = exp(g,Ns_5615) in
                                                    {7254}let m2_5617: bitstring = gNs_5616 in
                                                    {7255}event beginSrv(Sess_5170,Cli_5168,gNs_5616);
                                                    {7256}out(c, m2_5617)
                                                )
                                                else
                                                    {7257}let v_5618: bool = (Disco_5169 = C) in
                                                    (
                                                        {7258}if v_5618 then
                                                        (
                                                            {7259}let pkDisco_5619: bitstring = pub(skC) in
                                                            {7260}in(c, (=pkCli_5601,m1_5620: bitstring));
                                                            {7261}let (SPc_5621: bitstring,PartC_5622: bitstring) = m1_5620 in
                                                            {7262}event endSrv(Cli_5168,Sess_5170,PartC_5622);
                                                            {7263}new Ns_5623: bitstring;
                                                            {7264}let gNs_5624: bitstring = exp(g,Ns_5623) in
                                                            {7265}let m2_5625: bitstring = gNs_5624 in
                                                            {7266}event beginSrv(Sess_5170,Cli_5168,gNs_5624);
                                                            {7267}out(c, m2_5625)
                                                        )
                                                        else
                                                            {7268}let pkDisco_5626: bitstring = pub(skI) in
                                                            {7269}in(c, (=pkCli_5601,m1_5627: bitstring));
                                                            {7270}let (SPc_5628: bitstring,PartC_5629: bitstring) = m1_5627 in
                                                            {7271}event endSrv(Cli_5168,Sess_5170,PartC_5629);
                                                            {7272}new Ns_5630: bitstring;
                                                            {7273}let gNs_5631: bitstring = exp(g,Ns_5630) in
                                                            {7274}let m2_5632: bitstring = gNs_5631 in
                                                            {7275}event beginSrv(Sess_5170,Cli_5168,gNs_5631);
                                                            {7276}out(c, m2_5632)
                                                    )
                                                    else
                                                        {7277}let pkDisco_5633: bitstring = fail-any in
                                                        {7278}in(c, (=pkCli_5601,m1_5634: bitstring));
                                                        {7279}let (SPc_5635: bitstring,PartC_5636: bitstring) = m1_5634 in
                                                        {7280}event endSrv(Cli_5168,Sess_5170,PartC_5636);
                                                        {7281}new Ns_5637: bitstring;
                                                        {7282}let gNs_5638: bitstring = exp(g,Ns_5637) in
                                                        {7283}let m2_5639: bitstring = gNs_5638 in
                                                        {7284}event beginSrv(Sess_5170,Cli_5168,gNs_5638);
                                                        {7285}out(c, m2_5639)
                                            )
                                            else
                                                {7286}let pkDisco_5640: bitstring = fail-any in
                                                {7287}in(c, (=pkCli_5601,m1_5641: bitstring));
                                                {7288}let (SPc_5642: bitstring,PartC_5643: bitstring) = m1_5641 in
                                                {7289}event endSrv(Cli_5168,Sess_5170,PartC_5643);
                                                {7290}new Ns_5644: bitstring;
                                                {7291}let gNs_5645: bitstring = exp(g,Ns_5644) in
                                                {7292}let m2_5646: bitstring = gNs_5645 in
                                                {7293}event beginSrv(Sess_5170,Cli_5168,gNs_5645);
                                                {7294}out(c, m2_5646)
                                    )
                                    else
                                        {7295}let pkDisco_5647: bitstring = fail-any in
                                        {7296}in(c, (=pkCli_5601,m1_5648: bitstring));
                                        {7297}let (SPc_5649: bitstring,PartC_5650: bitstring) = m1_5648 in
                                        {7298}event endSrv(Cli_5168,Sess_5170,PartC_5650);
                                        {7299}new Ns_5651: bitstring;
                                        {7300}let gNs_5652: bitstring = exp(g,Ns_5651) in
                                        {7301}let m2_5653: bitstring = gNs_5652 in
                                        {7302}event beginSrv(Sess_5170,Cli_5168,gNs_5652);
                                        {7303}out(c, m2_5653)
                                )
                                else
                                    {7304}let v_5654: bool = (Cli_5168 = C) in
                                    (
                                        {7305}if v_5654 then
                                        (
                                            {7306}let pkCli_5655: bitstring = pub(skC) in
                                            {7307}let v_5656: bool = (Disco_5169 = A) in
                                            (
                                                {7308}if v_5656 then
                                                (
                                                    {7309}let pkDisco_5657: bitstring = pub(skA) in
                                                    {7310}in(c, (=pkCli_5655,m1_5658: bitstring));
                                                    {7311}let (SPc_5659: bitstring,PartC_5660: bitstring) = m1_5658 in
                                                    {7312}event endSrv(Cli_5168,Sess_5170,PartC_5660);
                                                    {7313}new Ns_5661: bitstring;
                                                    {7314}let gNs_5662: bitstring = exp(g,Ns_5661) in
                                                    {7315}let m2_5663: bitstring = gNs_5662 in
                                                    {7316}event beginSrv(Sess_5170,Cli_5168,gNs_5662);
                                                    {7317}out(c, m2_5663)
                                                )
                                                else
                                                    {7318}let v_5664: bool = (Disco_5169 = B) in
                                                    (
                                                        {7319}if v_5664 then
                                                        (
                                                            {7320}let pkDisco_5665: bitstring = pub(skB) in
                                                            {7321}in(c, (=pkCli_5655,m1_5666: bitstring));
                                                            {7322}let (SPc_5667: bitstring,PartC_5668: bitstring) = m1_5666 in
                                                            {7323}event endSrv(Cli_5168,Sess_5170,PartC_5668);
                                                            {7324}new Ns_5669: bitstring;
                                                            {7325}let gNs_5670: bitstring = exp(g,Ns_5669) in
                                                            {7326}let m2_5671: bitstring = gNs_5670 in
                                                            {7327}event beginSrv(Sess_5170,Cli_5168,gNs_5670);
                                                            {7328}out(c, m2_5671)
                                                        )
                                                        else
                                                            {7329}let v_5672: bool = (Disco_5169 = C) in
                                                            (
                                                                {7330}if v_5672 then
                                                                (
                                                                    {7331}let pkDisco_5673: bitstring = pub(skC) in
                                                                    {7332}in(c, (=pkCli_5655,m1_5674: bitstring));
                                                                    {7333}let (SPc_5675: bitstring,PartC_5676: bitstring) = m1_5674 in
                                                                    {7334}event endSrv(Cli_5168,Sess_5170,PartC_5676);
                                                                    {7335}new Ns_5677: bitstring;
                                                                    {7336}let gNs_5678: bitstring = exp(g,Ns_5677) in
                                                                    {7337}let m2_5679: bitstring = gNs_5678 in
                                                                    {7338}event beginSrv(Sess_5170,Cli_5168,gNs_5678);
                                                                    {7339}out(c, m2_5679)
                                                                )
                                                                else
                                                                    {7340}let pkDisco_5680: bitstring = pub(skI) in
                                                                    {7341}in(c, (=pkCli_5655,m1_5681: bitstring));
                                                                    {7342}let (SPc_5682: bitstring,PartC_5683: bitstring) = m1_5681 in
                                                                    {7343}event endSrv(Cli_5168,Sess_5170,PartC_5683);
                                                                    {7344}new Ns_5684: bitstring;
                                                                    {7345}let gNs_5685: bitstring = exp(g,Ns_5684) in
                                                                    {7346}let m2_5686: bitstring = gNs_5685 in
                                                                    {7347}event beginSrv(Sess_5170,Cli_5168,gNs_5685);
                                                                    {7348}out(c, m2_5686)
                                                            )
                                                            else
                                                                {7349}let pkDisco_5687: bitstring = fail-any in
                                                                {7350}in(c, (=pkCli_5655,m1_5688: bitstring));
                                                                {7351}let (SPc_5689: bitstring,PartC_5690: bitstring) = m1_5688 in
                                                                {7352}event endSrv(Cli_5168,Sess_5170,PartC_5690);
                                                                {7353}new Ns_5691: bitstring;
                                                                {7354}let gNs_5692: bitstring = exp(g,Ns_5691) in
                                                                {7355}let m2_5693: bitstring = gNs_5692 in
                                                                {7356}event beginSrv(Sess_5170,Cli_5168,gNs_5692);
                                                                {7357}out(c, m2_5693)
                                                    )
                                                    else
                                                        {7358}let pkDisco_5694: bitstring = fail-any in
                                                        {7359}in(c, (=pkCli_5655,m1_5695: bitstring));
                                                        {7360}let (SPc_5696: bitstring,PartC_5697: bitstring) = m1_5695 in
                                                        {7361}event endSrv(Cli_5168,Sess_5170,PartC_5697);
                                                        {7362}new Ns_5698: bitstring;
                                                        {7363}let gNs_5699: bitstring = exp(g,Ns_5698) in
                                                        {7364}let m2_5700: bitstring = gNs_5699 in
                                                        {7365}event beginSrv(Sess_5170,Cli_5168,gNs_5699);
                                                        {7366}out(c, m2_5700)
                                            )
                                            else
                                                {7367}let pkDisco_5701: bitstring = fail-any in
                                                {7368}in(c, (=pkCli_5655,m1_5702: bitstring));
                                                {7369}let (SPc_5703: bitstring,PartC_5704: bitstring) = m1_5702 in
                                                {7370}event endSrv(Cli_5168,Sess_5170,PartC_5704);
                                                {7371}new Ns_5705: bitstring;
                                                {7372}let gNs_5706: bitstring = exp(g,Ns_5705) in
                                                {7373}let m2_5707: bitstring = gNs_5706 in
                                                {7374}event beginSrv(Sess_5170,Cli_5168,gNs_5706);
                                                {7375}out(c, m2_5707)
                                        )
                                        else
                                            {7376}let pkCli_5708: bitstring = pub(skI) in
                                            {7377}let v_5709: bool = (Disco_5169 = A) in
                                            (
                                                {7378}if v_5709 then
                                                (
                                                    {7379}let pkDisco_5710: bitstring = pub(skA) in
                                                    {7380}in(c, (=pkCli_5708,m1_5711: bitstring));
                                                    {7381}let (SPc_5712: bitstring,PartC_5713: bitstring) = m1_5711 in
                                                    {7382}event endSrv(Cli_5168,Sess_5170,PartC_5713);
                                                    {7383}new Ns_5714: bitstring;
                                                    {7384}let gNs_5715: bitstring = exp(g,Ns_5714) in
                                                    {7385}let m2_5716: bitstring = gNs_5715 in
                                                    {7386}event beginSrv(Sess_5170,Cli_5168,gNs_5715);
                                                    {7387}out(c, m2_5716)
                                                )
                                                else
                                                    {7388}let v_5717: bool = (Disco_5169 = B) in
                                                    (
                                                        {7389}if v_5717 then
                                                        (
                                                            {7390}let pkDisco_5718: bitstring = pub(skB) in
                                                            {7391}in(c, (=pkCli_5708,m1_5719: bitstring));
                                                            {7392}let (SPc_5720: bitstring,PartC_5721: bitstring) = m1_5719 in
                                                            {7393}event endSrv(Cli_5168,Sess_5170,PartC_5721);
                                                            {7394}new Ns_5722: bitstring;
                                                            {7395}let gNs_5723: bitstring = exp(g,Ns_5722) in
                                                            {7396}let m2_5724: bitstring = gNs_5723 in
                                                            {7397}event beginSrv(Sess_5170,Cli_5168,gNs_5723);
                                                            {7398}out(c, m2_5724)
                                                        )
                                                        else
                                                            {7399}let v_5725: bool = (Disco_5169 = C) in
                                                            (
                                                                {7400}if v_5725 then
                                                                (
                                                                    {7401}let pkDisco_5726: bitstring = pub(skC) in
                                                                    {7402}in(c, (=pkCli_5708,m1_5727: bitstring));
                                                                    {7403}let (SPc_5728: bitstring,PartC_5729: bitstring) = m1_5727 in
                                                                    {7404}event endSrv(Cli_5168,Sess_5170,PartC_5729);
                                                                    {7405}new Ns_5730: bitstring;
                                                                    {7406}let gNs_5731: bitstring = exp(g,Ns_5730) in
                                                                    {7407}let m2_5732: bitstring = gNs_5731 in
                                                                    {7408}event beginSrv(Sess_5170,Cli_5168,gNs_5731);
                                                                    {7409}out(c, m2_5732)
                                                                )
                                                                else
                                                                    {7410}let pkDisco_5733: bitstring = pub(skI) in
                                                                    {7411}in(c, (=pkCli_5708,m1_5734: bitstring));
                                                                    {7412}let (SPc_5735: bitstring,PartC_5736: bitstring) = m1_5734 in
                                                                    {7413}event endSrv(Cli_5168,Sess_5170,PartC_5736);
                                                                    {7414}new Ns_5737: bitstring;
                                                                    {7415}let gNs_5738: bitstring = exp(g,Ns_5737) in
                                                                    {7416}let m2_5739: bitstring = gNs_5738 in
                                                                    {7417}event beginSrv(Sess_5170,Cli_5168,gNs_5738);
                                                                    {7418}out(c, m2_5739)
                                                            )
                                                            else
                                                                {7419}let pkDisco_5740: bitstring = fail-any in
                                                                {7420}in(c, (=pkCli_5708,m1_5741: bitstring));
                                                                {7421}let (SPc_5742: bitstring,PartC_5743: bitstring) = m1_5741 in
                                                                {7422}event endSrv(Cli_5168,Sess_5170,PartC_5743);
                                                                {7423}new Ns_5744: bitstring;
                                                                {7424}let gNs_5745: bitstring = exp(g,Ns_5744) in
                                                                {7425}let m2_5746: bitstring = gNs_5745 in
                                                                {7426}event beginSrv(Sess_5170,Cli_5168,gNs_5745);
                                                                {7427}out(c, m2_5746)
                                                    )
                                                    else
                                                        {7428}let pkDisco_5747: bitstring = fail-any in
                                                        {7429}in(c, (=pkCli_5708,m1_5748: bitstring));
                                                        {7430}let (SPc_5749: bitstring,PartC_5750: bitstring) = m1_5748 in
                                                        {7431}event endSrv(Cli_5168,Sess_5170,PartC_5750);
                                                        {7432}new Ns_5751: bitstring;
                                                        {7433}let gNs_5752: bitstring = exp(g,Ns_5751) in
                                                        {7434}let m2_5753: bitstring = gNs_5752 in
                                                        {7435}event beginSrv(Sess_5170,Cli_5168,gNs_5752);
                                                        {7436}out(c, m2_5753)
                                            )
                                            else
                                                {7437}let pkDisco_5754: bitstring = fail-any in
                                                {7438}in(c, (=pkCli_5708,m1_5755: bitstring));
                                                {7439}let (SPc_5756: bitstring,PartC_5757: bitstring) = m1_5755 in
                                                {7440}event endSrv(Cli_5168,Sess_5170,PartC_5757);
                                                {7441}new Ns_5758: bitstring;
                                                {7442}let gNs_5759: bitstring = exp(g,Ns_5758) in
                                                {7443}let m2_5760: bitstring = gNs_5759 in
                                                {7444}event beginSrv(Sess_5170,Cli_5168,gNs_5759);
                                                {7445}out(c, m2_5760)
                                    )
                                    else
                                        {7446}let pkCli_5761: bitstring = fail-any in
                                        {7447}let v_5762: bool = (Disco_5169 = A) in
                                        (
                                            {7448}if v_5762 then
                                            (
                                                {7449}let pkDisco_5763: bitstring = pub(skA) in
                                                {7450}in(c, (=pkCli_5761,m1_5764: bitstring));
                                                {7451}let (SPc_5765: bitstring,PartC_5766: bitstring) = m1_5764 in
                                                {7452}event endSrv(Cli_5168,Sess_5170,PartC_5766);
                                                {7453}new Ns_5767: bitstring;
                                                {7454}let gNs_5768: bitstring = exp(g,Ns_5767) in
                                                {7455}let m2_5769: bitstring = gNs_5768 in
                                                {7456}event beginSrv(Sess_5170,Cli_5168,gNs_5768);
                                                {7457}out(c, m2_5769)
                                            )
                                            else
                                                {7458}let v_5770: bool = (Disco_5169 = B) in
                                                (
                                                    {7459}if v_5770 then
                                                    (
                                                        {7460}let pkDisco_5771: bitstring = pub(skB) in
                                                        {7461}in(c, (=pkCli_5761,m1_5772: bitstring));
                                                        {7462}let (SPc_5773: bitstring,PartC_5774: bitstring) = m1_5772 in
                                                        {7463}event endSrv(Cli_5168,Sess_5170,PartC_5774);
                                                        {7464}new Ns_5775: bitstring;
                                                        {7465}let gNs_5776: bitstring = exp(g,Ns_5775) in
                                                        {7466}let m2_5777: bitstring = gNs_5776 in
                                                        {7467}event beginSrv(Sess_5170,Cli_5168,gNs_5776);
                                                        {7468}out(c, m2_5777)
                                                    )
                                                    else
                                                        {7469}let v_5778: bool = (Disco_5169 = C) in
                                                        (
                                                            {7470}if v_5778 then
                                                            (
                                                                {7471}let pkDisco_5779: bitstring = pub(skC) in
                                                                {7472}in(c, (=pkCli_5761,m1_5780: bitstring));
                                                                {7473}let (SPc_5781: bitstring,PartC_5782: bitstring) = m1_5780 in
                                                                {7474}event endSrv(Cli_5168,Sess_5170,PartC_5782);
                                                                {7475}new Ns_5783: bitstring;
                                                                {7476}let gNs_5784: bitstring = exp(g,Ns_5783) in
                                                                {7477}let m2_5785: bitstring = gNs_5784 in
                                                                {7478}event beginSrv(Sess_5170,Cli_5168,gNs_5784);
                                                                {7479}out(c, m2_5785)
                                                            )
                                                            else
                                                                {7480}let pkDisco_5786: bitstring = pub(skI) in
                                                                {7481}in(c, (=pkCli_5761,m1_5787: bitstring));
                                                                {7482}let (SPc_5788: bitstring,PartC_5789: bitstring) = m1_5787 in
                                                                {7483}event endSrv(Cli_5168,Sess_5170,PartC_5789);
                                                                {7484}new Ns_5790: bitstring;
                                                                {7485}let gNs_5791: bitstring = exp(g,Ns_5790) in
                                                                {7486}let m2_5792: bitstring = gNs_5791 in
                                                                {7487}event beginSrv(Sess_5170,Cli_5168,gNs_5791);
                                                                {7488}out(c, m2_5792)
                                                        )
                                                        else
                                                            {7489}let pkDisco_5793: bitstring = fail-any in
                                                            {7490}in(c, (=pkCli_5761,m1_5794: bitstring));
                                                            {7491}let (SPc_5795: bitstring,PartC_5796: bitstring) = m1_5794 in
                                                            {7492}event endSrv(Cli_5168,Sess_5170,PartC_5796);
                                                            {7493}new Ns_5797: bitstring;
                                                            {7494}let gNs_5798: bitstring = exp(g,Ns_5797) in
                                                            {7495}let m2_5799: bitstring = gNs_5798 in
                                                            {7496}event beginSrv(Sess_5170,Cli_5168,gNs_5798);
                                                            {7497}out(c, m2_5799)
                                                )
                                                else
                                                    {7498}let pkDisco_5800: bitstring = fail-any in
                                                    {7499}in(c, (=pkCli_5761,m1_5801: bitstring));
                                                    {7500}let (SPc_5802: bitstring,PartC_5803: bitstring) = m1_5801 in
                                                    {7501}event endSrv(Cli_5168,Sess_5170,PartC_5803);
                                                    {7502}new Ns_5804: bitstring;
                                                    {7503}let gNs_5805: bitstring = exp(g,Ns_5804) in
                                                    {7504}let m2_5806: bitstring = gNs_5805 in
                                                    {7505}event beginSrv(Sess_5170,Cli_5168,gNs_5805);
                                                    {7506}out(c, m2_5806)
                                        )
                                        else
                                            {7507}let pkDisco_5807: bitstring = fail-any in
                                            {7508}in(c, (=pkCli_5761,m1_5808: bitstring));
                                            {7509}let (SPc_5809: bitstring,PartC_5810: bitstring) = m1_5808 in
                                            {7510}event endSrv(Cli_5168,Sess_5170,PartC_5810);
                                            {7511}new Ns_5811: bitstring;
                                            {7512}let gNs_5812: bitstring = exp(g,Ns_5811) in
                                            {7513}let m2_5813: bitstring = gNs_5812 in
                                            {7514}event beginSrv(Sess_5170,Cli_5168,gNs_5812);
                                            {7515}out(c, m2_5813)
                            )
                            else
                                {7516}let pkCli_5814: bitstring = fail-any in
                                {7517}let v_5815: bool = (Disco_5169 = A) in
                                (
                                    {7518}if v_5815 then
                                    (
                                        {7519}let pkDisco_5816: bitstring = pub(skA) in
                                        {7520}in(c, (=pkCli_5814,m1_5817: bitstring));
                                        {7521}let (SPc_5818: bitstring,PartC_5819: bitstring) = m1_5817 in
                                        {7522}event endSrv(Cli_5168,Sess_5170,PartC_5819);
                                        {7523}new Ns_5820: bitstring;
                                        {7524}let gNs_5821: bitstring = exp(g,Ns_5820) in
                                        {7525}let m2_5822: bitstring = gNs_5821 in
                                        {7526}event beginSrv(Sess_5170,Cli_5168,gNs_5821);
                                        {7527}out(c, m2_5822)
                                    )
                                    else
                                        {7528}let v_5823: bool = (Disco_5169 = B) in
                                        (
                                            {7529}if v_5823 then
                                            (
                                                {7530}let pkDisco_5824: bitstring = pub(skB) in
                                                {7531}in(c, (=pkCli_5814,m1_5825: bitstring));
                                                {7532}let (SPc_5826: bitstring,PartC_5827: bitstring) = m1_5825 in
                                                {7533}event endSrv(Cli_5168,Sess_5170,PartC_5827);
                                                {7534}new Ns_5828: bitstring;
                                                {7535}let gNs_5829: bitstring = exp(g,Ns_5828) in
                                                {7536}let m2_5830: bitstring = gNs_5829 in
                                                {7537}event beginSrv(Sess_5170,Cli_5168,gNs_5829);
                                                {7538}out(c, m2_5830)
                                            )
                                            else
                                                {7539}let v_5831: bool = (Disco_5169 = C) in
                                                (
                                                    {7540}if v_5831 then
                                                    (
                                                        {7541}let pkDisco_5832: bitstring = pub(skC) in
                                                        {7542}in(c, (=pkCli_5814,m1_5833: bitstring));
                                                        {7543}let (SPc_5834: bitstring,PartC_5835: bitstring) = m1_5833 in
                                                        {7544}event endSrv(Cli_5168,Sess_5170,PartC_5835);
                                                        {7545}new Ns_5836: bitstring;
                                                        {7546}let gNs_5837: bitstring = exp(g,Ns_5836) in
                                                        {7547}let m2_5838: bitstring = gNs_5837 in
                                                        {7548}event beginSrv(Sess_5170,Cli_5168,gNs_5837);
                                                        {7549}out(c, m2_5838)
                                                    )
                                                    else
                                                        {7550}let pkDisco_5839: bitstring = pub(skI) in
                                                        {7551}in(c, (=pkCli_5814,m1_5840: bitstring));
                                                        {7552}let (SPc_5841: bitstring,PartC_5842: bitstring) = m1_5840 in
                                                        {7553}event endSrv(Cli_5168,Sess_5170,PartC_5842);
                                                        {7554}new Ns_5843: bitstring;
                                                        {7555}let gNs_5844: bitstring = exp(g,Ns_5843) in
                                                        {7556}let m2_5845: bitstring = gNs_5844 in
                                                        {7557}event beginSrv(Sess_5170,Cli_5168,gNs_5844);
                                                        {7558}out(c, m2_5845)
                                                )
                                                else
                                                    {7559}let pkDisco_5846: bitstring = fail-any in
                                                    {7560}in(c, (=pkCli_5814,m1_5847: bitstring));
                                                    {7561}let (SPc_5848: bitstring,PartC_5849: bitstring) = m1_5847 in
                                                    {7562}event endSrv(Cli_5168,Sess_5170,PartC_5849);
                                                    {7563}new Ns_5850: bitstring;
                                                    {7564}let gNs_5851: bitstring = exp(g,Ns_5850) in
                                                    {7565}let m2_5852: bitstring = gNs_5851 in
                                                    {7566}event beginSrv(Sess_5170,Cli_5168,gNs_5851);
                                                    {7567}out(c, m2_5852)
                                        )
                                        else
                                            {7568}let pkDisco_5853: bitstring = fail-any in
                                            {7569}in(c, (=pkCli_5814,m1_5854: bitstring));
                                            {7570}let (SPc_5855: bitstring,PartC_5856: bitstring) = m1_5854 in
                                            {7571}event endSrv(Cli_5168,Sess_5170,PartC_5856);
                                            {7572}new Ns_5857: bitstring;
                                            {7573}let gNs_5858: bitstring = exp(g,Ns_5857) in
                                            {7574}let m2_5859: bitstring = gNs_5858 in
                                            {7575}event beginSrv(Sess_5170,Cli_5168,gNs_5858);
                                            {7576}out(c, m2_5859)
                                )
                                else
                                    {7577}let pkDisco_5860: bitstring = fail-any in
                                    {7578}in(c, (=pkCli_5814,m1_5861: bitstring));
                                    {7579}let (SPc_5862: bitstring,PartC_5863: bitstring) = m1_5861 in
                                    {7580}event endSrv(Cli_5168,Sess_5170,PartC_5863);
                                    {7581}new Ns_5864: bitstring;
                                    {7582}let gNs_5865: bitstring = exp(g,Ns_5864) in
                                    {7583}let m2_5866: bitstring = gNs_5865 in
                                    {7584}event beginSrv(Sess_5170,Cli_5168,gNs_5865);
                                    {7585}out(c, m2_5866)
                    )
                    else
                        {7586}let pkCli_5867: bitstring = fail-any in
                        {7587}let v_5868: bool = (Disco_5169 = A) in
                        (
                            {7588}if v_5868 then
                            (
                                {7589}let pkDisco_5869: bitstring = pub(skA) in
                                {7590}in(c, (=pkCli_5867,m1_5870: bitstring));
                                {7591}let (SPc_5871: bitstring,PartC_5872: bitstring) = m1_5870 in
                                {7592}event endSrv(Cli_5168,Sess_5170,PartC_5872);
                                {7593}new Ns_5873: bitstring;
                                {7594}let gNs_5874: bitstring = exp(g,Ns_5873) in
                                {7595}let m2_5875: bitstring = gNs_5874 in
                                {7596}event beginSrv(Sess_5170,Cli_5168,gNs_5874);
                                {7597}out(c, m2_5875)
                            )
                            else
                                {7598}let v_5876: bool = (Disco_5169 = B) in
                                (
                                    {7599}if v_5876 then
                                    (
                                        {7600}let pkDisco_5877: bitstring = pub(skB) in
                                        {7601}in(c, (=pkCli_5867,m1_5878: bitstring));
                                        {7602}let (SPc_5879: bitstring,PartC_5880: bitstring) = m1_5878 in
                                        {7603}event endSrv(Cli_5168,Sess_5170,PartC_5880);
                                        {7604}new Ns_5881: bitstring;
                                        {7605}let gNs_5882: bitstring = exp(g,Ns_5881) in
                                        {7606}let m2_5883: bitstring = gNs_5882 in
                                        {7607}event beginSrv(Sess_5170,Cli_5168,gNs_5882);
                                        {7608}out(c, m2_5883)
                                    )
                                    else
                                        {7609}let v_5884: bool = (Disco_5169 = C) in
                                        (
                                            {7610}if v_5884 then
                                            (
                                                {7611}let pkDisco_5885: bitstring = pub(skC) in
                                                {7612}in(c, (=pkCli_5867,m1_5886: bitstring));
                                                {7613}let (SPc_5887: bitstring,PartC_5888: bitstring) = m1_5886 in
                                                {7614}event endSrv(Cli_5168,Sess_5170,PartC_5888);
                                                {7615}new Ns_5889: bitstring;
                                                {7616}let gNs_5890: bitstring = exp(g,Ns_5889) in
                                                {7617}let m2_5891: bitstring = gNs_5890 in
                                                {7618}event beginSrv(Sess_5170,Cli_5168,gNs_5890);
                                                {7619}out(c, m2_5891)
                                            )
                                            else
                                                {7620}let pkDisco_5892: bitstring = pub(skI) in
                                                {7621}in(c, (=pkCli_5867,m1_5893: bitstring));
                                                {7622}let (SPc_5894: bitstring,PartC_5895: bitstring) = m1_5893 in
                                                {7623}event endSrv(Cli_5168,Sess_5170,PartC_5895);
                                                {7624}new Ns_5896: bitstring;
                                                {7625}let gNs_5897: bitstring = exp(g,Ns_5896) in
                                                {7626}let m2_5898: bitstring = gNs_5897 in
                                                {7627}event beginSrv(Sess_5170,Cli_5168,gNs_5897);
                                                {7628}out(c, m2_5898)
                                        )
                                        else
                                            {7629}let pkDisco_5899: bitstring = fail-any in
                                            {7630}in(c, (=pkCli_5867,m1_5900: bitstring));
                                            {7631}let (SPc_5901: bitstring,PartC_5902: bitstring) = m1_5900 in
                                            {7632}event endSrv(Cli_5168,Sess_5170,PartC_5902);
                                            {7633}new Ns_5903: bitstring;
                                            {7634}let gNs_5904: bitstring = exp(g,Ns_5903) in
                                            {7635}let m2_5905: bitstring = gNs_5904 in
                                            {7636}event beginSrv(Sess_5170,Cli_5168,gNs_5904);
                                            {7637}out(c, m2_5905)
                                )
                                else
                                    {7638}let pkDisco_5906: bitstring = fail-any in
                                    {7639}in(c, (=pkCli_5867,m1_5907: bitstring));
                                    {7640}let (SPc_5908: bitstring,PartC_5909: bitstring) = m1_5907 in
                                    {7641}event endSrv(Cli_5168,Sess_5170,PartC_5909);
                                    {7642}new Ns_5910: bitstring;
                                    {7643}let gNs_5911: bitstring = exp(g,Ns_5910) in
                                    {7644}let m2_5912: bitstring = gNs_5911 in
                                    {7645}event beginSrv(Sess_5170,Cli_5168,gNs_5911);
                                    {7646}out(c, m2_5912)
                        )
                        else
                            {7647}let pkDisco_5913: bitstring = fail-any in
                            {7648}in(c, (=pkCli_5867,m1_5914: bitstring));
                            {7649}let (SPc_5915: bitstring,PartC_5916: bitstring) = m1_5914 in
                            {7650}event endSrv(Cli_5168,Sess_5170,PartC_5916);
                            {7651}new Ns_5917: bitstring;
                            {7652}let gNs_5918: bitstring = exp(g,Ns_5917) in
                            {7653}let m2_5919: bitstring = gNs_5918 in
                            {7654}event beginSrv(Sess_5170,Cli_5168,gNs_5918);
                            {7655}out(c, m2_5919)
                )
                else
                    {7656}let v_5920: bool = (Sess_5170 = C) in
                    (
                        {7657}if v_5920 then
                        (
                            {7658}let skSess_5921: bitstring = skC in
                            {7659}let pkSess_5922: bitstring = pub(skSess_5921) in
                            {7660}let v_5923: bool = (Cli_5168 = A) in
                            (
                                {7661}if v_5923 then
                                (
                                    {7662}let pkCli_5924: bitstring = pub(skA) in
                                    {7663}let v_5925: bool = (Disco_5169 = A) in
                                    (
                                        {7664}if v_5925 then
                                        (
                                            {7665}let pkDisco_5926: bitstring = pub(skA) in
                                            {7666}in(c, (=pkCli_5924,m1_5927: bitstring));
                                            {7667}let (SPc_5928: bitstring,PartC_5929: bitstring) = m1_5927 in
                                            {7668}event endSrv(Cli_5168,Sess_5170,PartC_5929);
                                            {7669}new Ns_5930: bitstring;
                                            {7670}let gNs_5931: bitstring = exp(g,Ns_5930) in
                                            {7671}let m2_5932: bitstring = gNs_5931 in
                                            {7672}event beginSrv(Sess_5170,Cli_5168,gNs_5931);
                                            {7673}out(c, m2_5932)
                                        )
                                        else
                                            {7674}let v_5933: bool = (Disco_5169 = B) in
                                            (
                                                {7675}if v_5933 then
                                                (
                                                    {7676}let pkDisco_5934: bitstring = pub(skB) in
                                                    {7677}in(c, (=pkCli_5924,m1_5935: bitstring));
                                                    {7678}let (SPc_5936: bitstring,PartC_5937: bitstring) = m1_5935 in
                                                    {7679}event endSrv(Cli_5168,Sess_5170,PartC_5937);
                                                    {7680}new Ns_5938: bitstring;
                                                    {7681}let gNs_5939: bitstring = exp(g,Ns_5938) in
                                                    {7682}let m2_5940: bitstring = gNs_5939 in
                                                    {7683}event beginSrv(Sess_5170,Cli_5168,gNs_5939);
                                                    {7684}out(c, m2_5940)
                                                )
                                                else
                                                    {7685}let v_5941: bool = (Disco_5169 = C) in
                                                    (
                                                        {7686}if v_5941 then
                                                        (
                                                            {7687}let pkDisco_5942: bitstring = pub(skC) in
                                                            {7688}in(c, (=pkCli_5924,m1_5943: bitstring));
                                                            {7689}let (SPc_5944: bitstring,PartC_5945: bitstring) = m1_5943 in
                                                            {7690}event endSrv(Cli_5168,Sess_5170,PartC_5945);
                                                            {7691}new Ns_5946: bitstring;
                                                            {7692}let gNs_5947: bitstring = exp(g,Ns_5946) in
                                                            {7693}let m2_5948: bitstring = gNs_5947 in
                                                            {7694}event beginSrv(Sess_5170,Cli_5168,gNs_5947);
                                                            {7695}out(c, m2_5948)
                                                        )
                                                        else
                                                            {7696}let pkDisco_5949: bitstring = pub(skI) in
                                                            {7697}in(c, (=pkCli_5924,m1_5950: bitstring));
                                                            {7698}let (SPc_5951: bitstring,PartC_5952: bitstring) = m1_5950 in
                                                            {7699}event endSrv(Cli_5168,Sess_5170,PartC_5952);
                                                            {7700}new Ns_5953: bitstring;
                                                            {7701}let gNs_5954: bitstring = exp(g,Ns_5953) in
                                                            {7702}let m2_5955: bitstring = gNs_5954 in
                                                            {7703}event beginSrv(Sess_5170,Cli_5168,gNs_5954);
                                                            {7704}out(c, m2_5955)
                                                    )
                                                    else
                                                        {7705}let pkDisco_5956: bitstring = fail-any in
                                                        {7706}in(c, (=pkCli_5924,m1_5957: bitstring));
                                                        {7707}let (SPc_5958: bitstring,PartC_5959: bitstring) = m1_5957 in
                                                        {7708}event endSrv(Cli_5168,Sess_5170,PartC_5959);
                                                        {7709}new Ns_5960: bitstring;
                                                        {7710}let gNs_5961: bitstring = exp(g,Ns_5960) in
                                                        {7711}let m2_5962: bitstring = gNs_5961 in
                                                        {7712}event beginSrv(Sess_5170,Cli_5168,gNs_5961);
                                                        {7713}out(c, m2_5962)
                                            )
                                            else
                                                {7714}let pkDisco_5963: bitstring = fail-any in
                                                {7715}in(c, (=pkCli_5924,m1_5964: bitstring));
                                                {7716}let (SPc_5965: bitstring,PartC_5966: bitstring) = m1_5964 in
                                                {7717}event endSrv(Cli_5168,Sess_5170,PartC_5966);
                                                {7718}new Ns_5967: bitstring;
                                                {7719}let gNs_5968: bitstring = exp(g,Ns_5967) in
                                                {7720}let m2_5969: bitstring = gNs_5968 in
                                                {7721}event beginSrv(Sess_5170,Cli_5168,gNs_5968);
                                                {7722}out(c, m2_5969)
                                    )
                                    else
                                        {7723}let pkDisco_5970: bitstring = fail-any in
                                        {7724}in(c, (=pkCli_5924,m1_5971: bitstring));
                                        {7725}let (SPc_5972: bitstring,PartC_5973: bitstring) = m1_5971 in
                                        {7726}event endSrv(Cli_5168,Sess_5170,PartC_5973);
                                        {7727}new Ns_5974: bitstring;
                                        {7728}let gNs_5975: bitstring = exp(g,Ns_5974) in
                                        {7729}let m2_5976: bitstring = gNs_5975 in
                                        {7730}event beginSrv(Sess_5170,Cli_5168,gNs_5975);
                                        {7731}out(c, m2_5976)
                                )
                                else
                                    {7732}let v_5977: bool = (Cli_5168 = B) in
                                    (
                                        {7733}if v_5977 then
                                        (
                                            {7734}let pkCli_5978: bitstring = pub(skB) in
                                            {7735}let v_5979: bool = (Disco_5169 = A) in
                                            (
                                                {7736}if v_5979 then
                                                (
                                                    {7737}let pkDisco_5980: bitstring = pub(skA) in
                                                    {7738}in(c, (=pkCli_5978,m1_5981: bitstring));
                                                    {7739}let (SPc_5982: bitstring,PartC_5983: bitstring) = m1_5981 in
                                                    {7740}event endSrv(Cli_5168,Sess_5170,PartC_5983);
                                                    {7741}new Ns_5984: bitstring;
                                                    {7742}let gNs_5985: bitstring = exp(g,Ns_5984) in
                                                    {7743}let m2_5986: bitstring = gNs_5985 in
                                                    {7744}event beginSrv(Sess_5170,Cli_5168,gNs_5985);
                                                    {7745}out(c, m2_5986)
                                                )
                                                else
                                                    {7746}let v_5987: bool = (Disco_5169 = B) in
                                                    (
                                                        {7747}if v_5987 then
                                                        (
                                                            {7748}let pkDisco_5988: bitstring = pub(skB) in
                                                            {7749}in(c, (=pkCli_5978,m1_5989: bitstring));
                                                            {7750}let (SPc_5990: bitstring,PartC_5991: bitstring) = m1_5989 in
                                                            {7751}event endSrv(Cli_5168,Sess_5170,PartC_5991);
                                                            {7752}new Ns_5992: bitstring;
                                                            {7753}let gNs_5993: bitstring = exp(g,Ns_5992) in
                                                            {7754}let m2_5994: bitstring = gNs_5993 in
                                                            {7755}event beginSrv(Sess_5170,Cli_5168,gNs_5993);
                                                            {7756}out(c, m2_5994)
                                                        )
                                                        else
                                                            {7757}let v_5995: bool = (Disco_5169 = C) in
                                                            (
                                                                {7758}if v_5995 then
                                                                (
                                                                    {7759}let pkDisco_5996: bitstring = pub(skC) in
                                                                    {7760}in(c, (=pkCli_5978,m1_5997: bitstring));
                                                                    {7761}let (SPc_5998: bitstring,PartC_5999: bitstring) = m1_5997 in
                                                                    {7762}event endSrv(Cli_5168,Sess_5170,PartC_5999);
                                                                    {7763}new Ns_6000: bitstring;
                                                                    {7764}let gNs_6001: bitstring = exp(g,Ns_6000) in
                                                                    {7765}let m2_6002: bitstring = gNs_6001 in
                                                                    {7766}event beginSrv(Sess_5170,Cli_5168,gNs_6001);
                                                                    {7767}out(c, m2_6002)
                                                                )
                                                                else
                                                                    {7768}let pkDisco_6003: bitstring = pub(skI) in
                                                                    {7769}in(c, (=pkCli_5978,m1_6004: bitstring));
                                                                    {7770}let (SPc_6005: bitstring,PartC_6006: bitstring) = m1_6004 in
                                                                    {7771}event endSrv(Cli_5168,Sess_5170,PartC_6006);
                                                                    {7772}new Ns_6007: bitstring;
                                                                    {7773}let gNs_6008: bitstring = exp(g,Ns_6007) in
                                                                    {7774}let m2_6009: bitstring = gNs_6008 in
                                                                    {7775}event beginSrv(Sess_5170,Cli_5168,gNs_6008);
                                                                    {7776}out(c, m2_6009)
                                                            )
                                                            else
                                                                {7777}let pkDisco_6010: bitstring = fail-any in
                                                                {7778}in(c, (=pkCli_5978,m1_6011: bitstring));
                                                                {7779}let (SPc_6012: bitstring,PartC_6013: bitstring) = m1_6011 in
                                                                {7780}event endSrv(Cli_5168,Sess_5170,PartC_6013);
                                                                {7781}new Ns_6014: bitstring;
                                                                {7782}let gNs_6015: bitstring = exp(g,Ns_6014) in
                                                                {7783}let m2_6016: bitstring = gNs_6015 in
                                                                {7784}event beginSrv(Sess_5170,Cli_5168,gNs_6015);
                                                                {7785}out(c, m2_6016)
                                                    )
                                                    else
                                                        {7786}let pkDisco_6017: bitstring = fail-any in
                                                        {7787}in(c, (=pkCli_5978,m1_6018: bitstring));
                                                        {7788}let (SPc_6019: bitstring,PartC_6020: bitstring) = m1_6018 in
                                                        {7789}event endSrv(Cli_5168,Sess_5170,PartC_6020);
                                                        {7790}new Ns_6021: bitstring;
                                                        {7791}let gNs_6022: bitstring = exp(g,Ns_6021) in
                                                        {7792}let m2_6023: bitstring = gNs_6022 in
                                                        {7793}event beginSrv(Sess_5170,Cli_5168,gNs_6022);
                                                        {7794}out(c, m2_6023)
                                            )
                                            else
                                                {7795}let pkDisco_6024: bitstring = fail-any in
                                                {7796}in(c, (=pkCli_5978,m1_6025: bitstring));
                                                {7797}let (SPc_6026: bitstring,PartC_6027: bitstring) = m1_6025 in
                                                {7798}event endSrv(Cli_5168,Sess_5170,PartC_6027);
                                                {7799}new Ns_6028: bitstring;
                                                {7800}let gNs_6029: bitstring = exp(g,Ns_6028) in
                                                {7801}let m2_6030: bitstring = gNs_6029 in
                                                {7802}event beginSrv(Sess_5170,Cli_5168,gNs_6029);
                                                {7803}out(c, m2_6030)
                                        )
                                        else
                                            {7804}let v_6031: bool = (Cli_5168 = C) in
                                            (
                                                {7805}if v_6031 then
                                                (
                                                    {7806}let pkCli_6032: bitstring = pub(skC) in
                                                    {7807}let v_6033: bool = (Disco_5169 = A) in
                                                    (
                                                        {7808}if v_6033 then
                                                        (
                                                            {7809}let pkDisco_6034: bitstring = pub(skA) in
                                                            {7810}in(c, (=pkCli_6032,m1_6035: bitstring));
                                                            {7811}let (SPc_6036: bitstring,PartC_6037: bitstring) = m1_6035 in
                                                            {7812}event endSrv(Cli_5168,Sess_5170,PartC_6037);
                                                            {7813}new Ns_6038: bitstring;
                                                            {7814}let gNs_6039: bitstring = exp(g,Ns_6038) in
                                                            {7815}let m2_6040: bitstring = gNs_6039 in
                                                            {7816}event beginSrv(Sess_5170,Cli_5168,gNs_6039);
                                                            {7817}out(c, m2_6040)
                                                        )
                                                        else
                                                            {7818}let v_6041: bool = (Disco_5169 = B) in
                                                            (
                                                                {7819}if v_6041 then
                                                                (
                                                                    {7820}let pkDisco_6042: bitstring = pub(skB) in
                                                                    {7821}in(c, (=pkCli_6032,m1_6043: bitstring));
                                                                    {7822}let (SPc_6044: bitstring,PartC_6045: bitstring) = m1_6043 in
                                                                    {7823}event endSrv(Cli_5168,Sess_5170,PartC_6045);
                                                                    {7824}new Ns_6046: bitstring;
                                                                    {7825}let gNs_6047: bitstring = exp(g,Ns_6046) in
                                                                    {7826}let m2_6048: bitstring = gNs_6047 in
                                                                    {7827}event beginSrv(Sess_5170,Cli_5168,gNs_6047);
                                                                    {7828}out(c, m2_6048)
                                                                )
                                                                else
                                                                    {7829}let v_6049: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {7830}if v_6049 then
                                                                        (
                                                                            {7831}let pkDisco_6050: bitstring = pub(skC) in
                                                                            {7832}in(c, (=pkCli_6032,m1_6051: bitstring));
                                                                            {7833}let (SPc_6052: bitstring,PartC_6053: bitstring) = m1_6051 in
                                                                            {7834}event endSrv(Cli_5168,Sess_5170,PartC_6053);
                                                                            {7835}new Ns_6054: bitstring;
                                                                            {7836}let gNs_6055: bitstring = exp(g,Ns_6054) in
                                                                            {7837}let m2_6056: bitstring = gNs_6055 in
                                                                            {7838}event beginSrv(Sess_5170,Cli_5168,gNs_6055);
                                                                            {7839}out(c, m2_6056)
                                                                        )
                                                                        else
                                                                            {7840}let pkDisco_6057: bitstring = pub(skI) in
                                                                            {7841}in(c, (=pkCli_6032,m1_6058: bitstring));
                                                                            {7842}let (SPc_6059: bitstring,PartC_6060: bitstring) = m1_6058 in
                                                                            {7843}event endSrv(Cli_5168,Sess_5170,PartC_6060);
                                                                            {7844}new Ns_6061: bitstring;
                                                                            {7845}let gNs_6062: bitstring = exp(g,Ns_6061) in
                                                                            {7846}let m2_6063: bitstring = gNs_6062 in
                                                                            {7847}event beginSrv(Sess_5170,Cli_5168,gNs_6062);
                                                                            {7848}out(c, m2_6063)
                                                                    )
                                                                    else
                                                                        {7849}let pkDisco_6064: bitstring = fail-any in
                                                                        {7850}in(c, (=pkCli_6032,m1_6065: bitstring));
                                                                        {7851}let (SPc_6066: bitstring,PartC_6067: bitstring) = m1_6065 in
                                                                        {7852}event endSrv(Cli_5168,Sess_5170,PartC_6067);
                                                                        {7853}new Ns_6068: bitstring;
                                                                        {7854}let gNs_6069: bitstring = exp(g,Ns_6068) in
                                                                        {7855}let m2_6070: bitstring = gNs_6069 in
                                                                        {7856}event beginSrv(Sess_5170,Cli_5168,gNs_6069);
                                                                        {7857}out(c, m2_6070)
                                                            )
                                                            else
                                                                {7858}let pkDisco_6071: bitstring = fail-any in
                                                                {7859}in(c, (=pkCli_6032,m1_6072: bitstring));
                                                                {7860}let (SPc_6073: bitstring,PartC_6074: bitstring) = m1_6072 in
                                                                {7861}event endSrv(Cli_5168,Sess_5170,PartC_6074);
                                                                {7862}new Ns_6075: bitstring;
                                                                {7863}let gNs_6076: bitstring = exp(g,Ns_6075) in
                                                                {7864}let m2_6077: bitstring = gNs_6076 in
                                                                {7865}event beginSrv(Sess_5170,Cli_5168,gNs_6076);
                                                                {7866}out(c, m2_6077)
                                                    )
                                                    else
                                                        {7867}let pkDisco_6078: bitstring = fail-any in
                                                        {7868}in(c, (=pkCli_6032,m1_6079: bitstring));
                                                        {7869}let (SPc_6080: bitstring,PartC_6081: bitstring) = m1_6079 in
                                                        {7870}event endSrv(Cli_5168,Sess_5170,PartC_6081);
                                                        {7871}new Ns_6082: bitstring;
                                                        {7872}let gNs_6083: bitstring = exp(g,Ns_6082) in
                                                        {7873}let m2_6084: bitstring = gNs_6083 in
                                                        {7874}event beginSrv(Sess_5170,Cli_5168,gNs_6083);
                                                        {7875}out(c, m2_6084)
                                                )
                                                else
                                                    {7876}let pkCli_6085: bitstring = pub(skI) in
                                                    {7877}let v_6086: bool = (Disco_5169 = A) in
                                                    (
                                                        {7878}if v_6086 then
                                                        (
                                                            {7879}let pkDisco_6087: bitstring = pub(skA) in
                                                            {7880}in(c, (=pkCli_6085,m1_6088: bitstring));
                                                            {7881}let (SPc_6089: bitstring,PartC_6090: bitstring) = m1_6088 in
                                                            {7882}event endSrv(Cli_5168,Sess_5170,PartC_6090);
                                                            {7883}new Ns_6091: bitstring;
                                                            {7884}let gNs_6092: bitstring = exp(g,Ns_6091) in
                                                            {7885}let m2_6093: bitstring = gNs_6092 in
                                                            {7886}event beginSrv(Sess_5170,Cli_5168,gNs_6092);
                                                            {7887}out(c, m2_6093)
                                                        )
                                                        else
                                                            {7888}let v_6094: bool = (Disco_5169 = B) in
                                                            (
                                                                {7889}if v_6094 then
                                                                (
                                                                    {7890}let pkDisco_6095: bitstring = pub(skB) in
                                                                    {7891}in(c, (=pkCli_6085,m1_6096: bitstring));
                                                                    {7892}let (SPc_6097: bitstring,PartC_6098: bitstring) = m1_6096 in
                                                                    {7893}event endSrv(Cli_5168,Sess_5170,PartC_6098);
                                                                    {7894}new Ns_6099: bitstring;
                                                                    {7895}let gNs_6100: bitstring = exp(g,Ns_6099) in
                                                                    {7896}let m2_6101: bitstring = gNs_6100 in
                                                                    {7897}event beginSrv(Sess_5170,Cli_5168,gNs_6100);
                                                                    {7898}out(c, m2_6101)
                                                                )
                                                                else
                                                                    {7899}let v_6102: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {7900}if v_6102 then
                                                                        (
                                                                            {7901}let pkDisco_6103: bitstring = pub(skC) in
                                                                            {7902}in(c, (=pkCli_6085,m1_6104: bitstring));
                                                                            {7903}let (SPc_6105: bitstring,PartC_6106: bitstring) = m1_6104 in
                                                                            {7904}event endSrv(Cli_5168,Sess_5170,PartC_6106);
                                                                            {7905}new Ns_6107: bitstring;
                                                                            {7906}let gNs_6108: bitstring = exp(g,Ns_6107) in
                                                                            {7907}let m2_6109: bitstring = gNs_6108 in
                                                                            {7908}event beginSrv(Sess_5170,Cli_5168,gNs_6108);
                                                                            {7909}out(c, m2_6109)
                                                                        )
                                                                        else
                                                                            {7910}let pkDisco_6110: bitstring = pub(skI) in
                                                                            {7911}in(c, (=pkCli_6085,m1_6111: bitstring));
                                                                            {7912}let (SPc_6112: bitstring,PartC_6113: bitstring) = m1_6111 in
                                                                            {7913}event endSrv(Cli_5168,Sess_5170,PartC_6113);
                                                                            {7914}new Ns_6114: bitstring;
                                                                            {7915}let gNs_6115: bitstring = exp(g,Ns_6114) in
                                                                            {7916}let m2_6116: bitstring = gNs_6115 in
                                                                            {7917}event beginSrv(Sess_5170,Cli_5168,gNs_6115);
                                                                            {7918}out(c, m2_6116)
                                                                    )
                                                                    else
                                                                        {7919}let pkDisco_6117: bitstring = fail-any in
                                                                        {7920}in(c, (=pkCli_6085,m1_6118: bitstring));
                                                                        {7921}let (SPc_6119: bitstring,PartC_6120: bitstring) = m1_6118 in
                                                                        {7922}event endSrv(Cli_5168,Sess_5170,PartC_6120);
                                                                        {7923}new Ns_6121: bitstring;
                                                                        {7924}let gNs_6122: bitstring = exp(g,Ns_6121) in
                                                                        {7925}let m2_6123: bitstring = gNs_6122 in
                                                                        {7926}event beginSrv(Sess_5170,Cli_5168,gNs_6122);
                                                                        {7927}out(c, m2_6123)
                                                            )
                                                            else
                                                                {7928}let pkDisco_6124: bitstring = fail-any in
                                                                {7929}in(c, (=pkCli_6085,m1_6125: bitstring));
                                                                {7930}let (SPc_6126: bitstring,PartC_6127: bitstring) = m1_6125 in
                                                                {7931}event endSrv(Cli_5168,Sess_5170,PartC_6127);
                                                                {7932}new Ns_6128: bitstring;
                                                                {7933}let gNs_6129: bitstring = exp(g,Ns_6128) in
                                                                {7934}let m2_6130: bitstring = gNs_6129 in
                                                                {7935}event beginSrv(Sess_5170,Cli_5168,gNs_6129);
                                                                {7936}out(c, m2_6130)
                                                    )
                                                    else
                                                        {7937}let pkDisco_6131: bitstring = fail-any in
                                                        {7938}in(c, (=pkCli_6085,m1_6132: bitstring));
                                                        {7939}let (SPc_6133: bitstring,PartC_6134: bitstring) = m1_6132 in
                                                        {7940}event endSrv(Cli_5168,Sess_5170,PartC_6134);
                                                        {7941}new Ns_6135: bitstring;
                                                        {7942}let gNs_6136: bitstring = exp(g,Ns_6135) in
                                                        {7943}let m2_6137: bitstring = gNs_6136 in
                                                        {7944}event beginSrv(Sess_5170,Cli_5168,gNs_6136);
                                                        {7945}out(c, m2_6137)
                                            )
                                            else
                                                {7946}let pkCli_6138: bitstring = fail-any in
                                                {7947}let v_6139: bool = (Disco_5169 = A) in
                                                (
                                                    {7948}if v_6139 then
                                                    (
                                                        {7949}let pkDisco_6140: bitstring = pub(skA) in
                                                        {7950}in(c, (=pkCli_6138,m1_6141: bitstring));
                                                        {7951}let (SPc_6142: bitstring,PartC_6143: bitstring) = m1_6141 in
                                                        {7952}event endSrv(Cli_5168,Sess_5170,PartC_6143);
                                                        {7953}new Ns_6144: bitstring;
                                                        {7954}let gNs_6145: bitstring = exp(g,Ns_6144) in
                                                        {7955}let m2_6146: bitstring = gNs_6145 in
                                                        {7956}event beginSrv(Sess_5170,Cli_5168,gNs_6145);
                                                        {7957}out(c, m2_6146)
                                                    )
                                                    else
                                                        {7958}let v_6147: bool = (Disco_5169 = B) in
                                                        (
                                                            {7959}if v_6147 then
                                                            (
                                                                {7960}let pkDisco_6148: bitstring = pub(skB) in
                                                                {7961}in(c, (=pkCli_6138,m1_6149: bitstring));
                                                                {7962}let (SPc_6150: bitstring,PartC_6151: bitstring) = m1_6149 in
                                                                {7963}event endSrv(Cli_5168,Sess_5170,PartC_6151);
                                                                {7964}new Ns_6152: bitstring;
                                                                {7965}let gNs_6153: bitstring = exp(g,Ns_6152) in
                                                                {7966}let m2_6154: bitstring = gNs_6153 in
                                                                {7967}event beginSrv(Sess_5170,Cli_5168,gNs_6153);
                                                                {7968}out(c, m2_6154)
                                                            )
                                                            else
                                                                {7969}let v_6155: bool = (Disco_5169 = C) in
                                                                (
                                                                    {7970}if v_6155 then
                                                                    (
                                                                        {7971}let pkDisco_6156: bitstring = pub(skC) in
                                                                        {7972}in(c, (=pkCli_6138,m1_6157: bitstring));
                                                                        {7973}let (SPc_6158: bitstring,PartC_6159: bitstring) = m1_6157 in
                                                                        {7974}event endSrv(Cli_5168,Sess_5170,PartC_6159);
                                                                        {7975}new Ns_6160: bitstring;
                                                                        {7976}let gNs_6161: bitstring = exp(g,Ns_6160) in
                                                                        {7977}let m2_6162: bitstring = gNs_6161 in
                                                                        {7978}event beginSrv(Sess_5170,Cli_5168,gNs_6161);
                                                                        {7979}out(c, m2_6162)
                                                                    )
                                                                    else
                                                                        {7980}let pkDisco_6163: bitstring = pub(skI) in
                                                                        {7981}in(c, (=pkCli_6138,m1_6164: bitstring));
                                                                        {7982}let (SPc_6165: bitstring,PartC_6166: bitstring) = m1_6164 in
                                                                        {7983}event endSrv(Cli_5168,Sess_5170,PartC_6166);
                                                                        {7984}new Ns_6167: bitstring;
                                                                        {7985}let gNs_6168: bitstring = exp(g,Ns_6167) in
                                                                        {7986}let m2_6169: bitstring = gNs_6168 in
                                                                        {7987}event beginSrv(Sess_5170,Cli_5168,gNs_6168);
                                                                        {7988}out(c, m2_6169)
                                                                )
                                                                else
                                                                    {7989}let pkDisco_6170: bitstring = fail-any in
                                                                    {7990}in(c, (=pkCli_6138,m1_6171: bitstring));
                                                                    {7991}let (SPc_6172: bitstring,PartC_6173: bitstring) = m1_6171 in
                                                                    {7992}event endSrv(Cli_5168,Sess_5170,PartC_6173);
                                                                    {7993}new Ns_6174: bitstring;
                                                                    {7994}let gNs_6175: bitstring = exp(g,Ns_6174) in
                                                                    {7995}let m2_6176: bitstring = gNs_6175 in
                                                                    {7996}event beginSrv(Sess_5170,Cli_5168,gNs_6175);
                                                                    {7997}out(c, m2_6176)
                                                        )
                                                        else
                                                            {7998}let pkDisco_6177: bitstring = fail-any in
                                                            {7999}in(c, (=pkCli_6138,m1_6178: bitstring));
                                                            {8000}let (SPc_6179: bitstring,PartC_6180: bitstring) = m1_6178 in
                                                            {8001}event endSrv(Cli_5168,Sess_5170,PartC_6180);
                                                            {8002}new Ns_6181: bitstring;
                                                            {8003}let gNs_6182: bitstring = exp(g,Ns_6181) in
                                                            {8004}let m2_6183: bitstring = gNs_6182 in
                                                            {8005}event beginSrv(Sess_5170,Cli_5168,gNs_6182);
                                                            {8006}out(c, m2_6183)
                                                )
                                                else
                                                    {8007}let pkDisco_6184: bitstring = fail-any in
                                                    {8008}in(c, (=pkCli_6138,m1_6185: bitstring));
                                                    {8009}let (SPc_6186: bitstring,PartC_6187: bitstring) = m1_6185 in
                                                    {8010}event endSrv(Cli_5168,Sess_5170,PartC_6187);
                                                    {8011}new Ns_6188: bitstring;
                                                    {8012}let gNs_6189: bitstring = exp(g,Ns_6188) in
                                                    {8013}let m2_6190: bitstring = gNs_6189 in
                                                    {8014}event beginSrv(Sess_5170,Cli_5168,gNs_6189);
                                                    {8015}out(c, m2_6190)
                                    )
                                    else
                                        {8016}let pkCli_6191: bitstring = fail-any in
                                        {8017}let v_6192: bool = (Disco_5169 = A) in
                                        (
                                            {8018}if v_6192 then
                                            (
                                                {8019}let pkDisco_6193: bitstring = pub(skA) in
                                                {8020}in(c, (=pkCli_6191,m1_6194: bitstring));
                                                {8021}let (SPc_6195: bitstring,PartC_6196: bitstring) = m1_6194 in
                                                {8022}event endSrv(Cli_5168,Sess_5170,PartC_6196);
                                                {8023}new Ns_6197: bitstring;
                                                {8024}let gNs_6198: bitstring = exp(g,Ns_6197) in
                                                {8025}let m2_6199: bitstring = gNs_6198 in
                                                {8026}event beginSrv(Sess_5170,Cli_5168,gNs_6198);
                                                {8027}out(c, m2_6199)
                                            )
                                            else
                                                {8028}let v_6200: bool = (Disco_5169 = B) in
                                                (
                                                    {8029}if v_6200 then
                                                    (
                                                        {8030}let pkDisco_6201: bitstring = pub(skB) in
                                                        {8031}in(c, (=pkCli_6191,m1_6202: bitstring));
                                                        {8032}let (SPc_6203: bitstring,PartC_6204: bitstring) = m1_6202 in
                                                        {8033}event endSrv(Cli_5168,Sess_5170,PartC_6204);
                                                        {8034}new Ns_6205: bitstring;
                                                        {8035}let gNs_6206: bitstring = exp(g,Ns_6205) in
                                                        {8036}let m2_6207: bitstring = gNs_6206 in
                                                        {8037}event beginSrv(Sess_5170,Cli_5168,gNs_6206);
                                                        {8038}out(c, m2_6207)
                                                    )
                                                    else
                                                        {8039}let v_6208: bool = (Disco_5169 = C) in
                                                        (
                                                            {8040}if v_6208 then
                                                            (
                                                                {8041}let pkDisco_6209: bitstring = pub(skC) in
                                                                {8042}in(c, (=pkCli_6191,m1_6210: bitstring));
                                                                {8043}let (SPc_6211: bitstring,PartC_6212: bitstring) = m1_6210 in
                                                                {8044}event endSrv(Cli_5168,Sess_5170,PartC_6212);
                                                                {8045}new Ns_6213: bitstring;
                                                                {8046}let gNs_6214: bitstring = exp(g,Ns_6213) in
                                                                {8047}let m2_6215: bitstring = gNs_6214 in
                                                                {8048}event beginSrv(Sess_5170,Cli_5168,gNs_6214);
                                                                {8049}out(c, m2_6215)
                                                            )
                                                            else
                                                                {8050}let pkDisco_6216: bitstring = pub(skI) in
                                                                {8051}in(c, (=pkCli_6191,m1_6217: bitstring));
                                                                {8052}let (SPc_6218: bitstring,PartC_6219: bitstring) = m1_6217 in
                                                                {8053}event endSrv(Cli_5168,Sess_5170,PartC_6219);
                                                                {8054}new Ns_6220: bitstring;
                                                                {8055}let gNs_6221: bitstring = exp(g,Ns_6220) in
                                                                {8056}let m2_6222: bitstring = gNs_6221 in
                                                                {8057}event beginSrv(Sess_5170,Cli_5168,gNs_6221);
                                                                {8058}out(c, m2_6222)
                                                        )
                                                        else
                                                            {8059}let pkDisco_6223: bitstring = fail-any in
                                                            {8060}in(c, (=pkCli_6191,m1_6224: bitstring));
                                                            {8061}let (SPc_6225: bitstring,PartC_6226: bitstring) = m1_6224 in
                                                            {8062}event endSrv(Cli_5168,Sess_5170,PartC_6226);
                                                            {8063}new Ns_6227: bitstring;
                                                            {8064}let gNs_6228: bitstring = exp(g,Ns_6227) in
                                                            {8065}let m2_6229: bitstring = gNs_6228 in
                                                            {8066}event beginSrv(Sess_5170,Cli_5168,gNs_6228);
                                                            {8067}out(c, m2_6229)
                                                )
                                                else
                                                    {8068}let pkDisco_6230: bitstring = fail-any in
                                                    {8069}in(c, (=pkCli_6191,m1_6231: bitstring));
                                                    {8070}let (SPc_6232: bitstring,PartC_6233: bitstring) = m1_6231 in
                                                    {8071}event endSrv(Cli_5168,Sess_5170,PartC_6233);
                                                    {8072}new Ns_6234: bitstring;
                                                    {8073}let gNs_6235: bitstring = exp(g,Ns_6234) in
                                                    {8074}let m2_6236: bitstring = gNs_6235 in
                                                    {8075}event beginSrv(Sess_5170,Cli_5168,gNs_6235);
                                                    {8076}out(c, m2_6236)
                                        )
                                        else
                                            {8077}let pkDisco_6237: bitstring = fail-any in
                                            {8078}in(c, (=pkCli_6191,m1_6238: bitstring));
                                            {8079}let (SPc_6239: bitstring,PartC_6240: bitstring) = m1_6238 in
                                            {8080}event endSrv(Cli_5168,Sess_5170,PartC_6240);
                                            {8081}new Ns_6241: bitstring;
                                            {8082}let gNs_6242: bitstring = exp(g,Ns_6241) in
                                            {8083}let m2_6243: bitstring = gNs_6242 in
                                            {8084}event beginSrv(Sess_5170,Cli_5168,gNs_6242);
                                            {8085}out(c, m2_6243)
                            )
                            else
                                {8086}let pkCli_6244: bitstring = fail-any in
                                {8087}let v_6245: bool = (Disco_5169 = A) in
                                (
                                    {8088}if v_6245 then
                                    (
                                        {8089}let pkDisco_6246: bitstring = pub(skA) in
                                        {8090}in(c, (=pkCli_6244,m1_6247: bitstring));
                                        {8091}let (SPc_6248: bitstring,PartC_6249: bitstring) = m1_6247 in
                                        {8092}event endSrv(Cli_5168,Sess_5170,PartC_6249);
                                        {8093}new Ns_6250: bitstring;
                                        {8094}let gNs_6251: bitstring = exp(g,Ns_6250) in
                                        {8095}let m2_6252: bitstring = gNs_6251 in
                                        {8096}event beginSrv(Sess_5170,Cli_5168,gNs_6251);
                                        {8097}out(c, m2_6252)
                                    )
                                    else
                                        {8098}let v_6253: bool = (Disco_5169 = B) in
                                        (
                                            {8099}if v_6253 then
                                            (
                                                {8100}let pkDisco_6254: bitstring = pub(skB) in
                                                {8101}in(c, (=pkCli_6244,m1_6255: bitstring));
                                                {8102}let (SPc_6256: bitstring,PartC_6257: bitstring) = m1_6255 in
                                                {8103}event endSrv(Cli_5168,Sess_5170,PartC_6257);
                                                {8104}new Ns_6258: bitstring;
                                                {8105}let gNs_6259: bitstring = exp(g,Ns_6258) in
                                                {8106}let m2_6260: bitstring = gNs_6259 in
                                                {8107}event beginSrv(Sess_5170,Cli_5168,gNs_6259);
                                                {8108}out(c, m2_6260)
                                            )
                                            else
                                                {8109}let v_6261: bool = (Disco_5169 = C) in
                                                (
                                                    {8110}if v_6261 then
                                                    (
                                                        {8111}let pkDisco_6262: bitstring = pub(skC) in
                                                        {8112}in(c, (=pkCli_6244,m1_6263: bitstring));
                                                        {8113}let (SPc_6264: bitstring,PartC_6265: bitstring) = m1_6263 in
                                                        {8114}event endSrv(Cli_5168,Sess_5170,PartC_6265);
                                                        {8115}new Ns_6266: bitstring;
                                                        {8116}let gNs_6267: bitstring = exp(g,Ns_6266) in
                                                        {8117}let m2_6268: bitstring = gNs_6267 in
                                                        {8118}event beginSrv(Sess_5170,Cli_5168,gNs_6267);
                                                        {8119}out(c, m2_6268)
                                                    )
                                                    else
                                                        {8120}let pkDisco_6269: bitstring = pub(skI) in
                                                        {8121}in(c, (=pkCli_6244,m1_6270: bitstring));
                                                        {8122}let (SPc_6271: bitstring,PartC_6272: bitstring) = m1_6270 in
                                                        {8123}event endSrv(Cli_5168,Sess_5170,PartC_6272);
                                                        {8124}new Ns_6273: bitstring;
                                                        {8125}let gNs_6274: bitstring = exp(g,Ns_6273) in
                                                        {8126}let m2_6275: bitstring = gNs_6274 in
                                                        {8127}event beginSrv(Sess_5170,Cli_5168,gNs_6274);
                                                        {8128}out(c, m2_6275)
                                                )
                                                else
                                                    {8129}let pkDisco_6276: bitstring = fail-any in
                                                    {8130}in(c, (=pkCli_6244,m1_6277: bitstring));
                                                    {8131}let (SPc_6278: bitstring,PartC_6279: bitstring) = m1_6277 in
                                                    {8132}event endSrv(Cli_5168,Sess_5170,PartC_6279);
                                                    {8133}new Ns_6280: bitstring;
                                                    {8134}let gNs_6281: bitstring = exp(g,Ns_6280) in
                                                    {8135}let m2_6282: bitstring = gNs_6281 in
                                                    {8136}event beginSrv(Sess_5170,Cli_5168,gNs_6281);
                                                    {8137}out(c, m2_6282)
                                        )
                                        else
                                            {8138}let pkDisco_6283: bitstring = fail-any in
                                            {8139}in(c, (=pkCli_6244,m1_6284: bitstring));
                                            {8140}let (SPc_6285: bitstring,PartC_6286: bitstring) = m1_6284 in
                                            {8141}event endSrv(Cli_5168,Sess_5170,PartC_6286);
                                            {8142}new Ns_6287: bitstring;
                                            {8143}let gNs_6288: bitstring = exp(g,Ns_6287) in
                                            {8144}let m2_6289: bitstring = gNs_6288 in
                                            {8145}event beginSrv(Sess_5170,Cli_5168,gNs_6288);
                                            {8146}out(c, m2_6289)
                                )
                                else
                                    {8147}let pkDisco_6290: bitstring = fail-any in
                                    {8148}in(c, (=pkCli_6244,m1_6291: bitstring));
                                    {8149}let (SPc_6292: bitstring,PartC_6293: bitstring) = m1_6291 in
                                    {8150}event endSrv(Cli_5168,Sess_5170,PartC_6293);
                                    {8151}new Ns_6294: bitstring;
                                    {8152}let gNs_6295: bitstring = exp(g,Ns_6294) in
                                    {8153}let m2_6296: bitstring = gNs_6295 in
                                    {8154}event beginSrv(Sess_5170,Cli_5168,gNs_6295);
                                    {8155}out(c, m2_6296)
                        )
                        else
                            {8156}let skSess_6297: bitstring = skI in
                            {8157}let pkSess_6298: bitstring = pub(skSess_6297) in
                            {8158}let v_6299: bool = (Cli_5168 = A) in
                            (
                                {8159}if v_6299 then
                                (
                                    {8160}let pkCli_6300: bitstring = pub(skA) in
                                    {8161}let v_6301: bool = (Disco_5169 = A) in
                                    (
                                        {8162}if v_6301 then
                                        (
                                            {8163}let pkDisco_6302: bitstring = pub(skA) in
                                            {8164}in(c, (=pkCli_6300,m1_6303: bitstring));
                                            {8165}let (SPc_6304: bitstring,PartC_6305: bitstring) = m1_6303 in
                                            {8166}event endSrv(Cli_5168,Sess_5170,PartC_6305);
                                            {8167}new Ns_6306: bitstring;
                                            {8168}let gNs_6307: bitstring = exp(g,Ns_6306) in
                                            {8169}let m2_6308: bitstring = gNs_6307 in
                                            {8170}event beginSrv(Sess_5170,Cli_5168,gNs_6307);
                                            {8171}out(c, m2_6308)
                                        )
                                        else
                                            {8172}let v_6309: bool = (Disco_5169 = B) in
                                            (
                                                {8173}if v_6309 then
                                                (
                                                    {8174}let pkDisco_6310: bitstring = pub(skB) in
                                                    {8175}in(c, (=pkCli_6300,m1_6311: bitstring));
                                                    {8176}let (SPc_6312: bitstring,PartC_6313: bitstring) = m1_6311 in
                                                    {8177}event endSrv(Cli_5168,Sess_5170,PartC_6313);
                                                    {8178}new Ns_6314: bitstring;
                                                    {8179}let gNs_6315: bitstring = exp(g,Ns_6314) in
                                                    {8180}let m2_6316: bitstring = gNs_6315 in
                                                    {8181}event beginSrv(Sess_5170,Cli_5168,gNs_6315);
                                                    {8182}out(c, m2_6316)
                                                )
                                                else
                                                    {8183}let v_6317: bool = (Disco_5169 = C) in
                                                    (
                                                        {8184}if v_6317 then
                                                        (
                                                            {8185}let pkDisco_6318: bitstring = pub(skC) in
                                                            {8186}in(c, (=pkCli_6300,m1_6319: bitstring));
                                                            {8187}let (SPc_6320: bitstring,PartC_6321: bitstring) = m1_6319 in
                                                            {8188}event endSrv(Cli_5168,Sess_5170,PartC_6321);
                                                            {8189}new Ns_6322: bitstring;
                                                            {8190}let gNs_6323: bitstring = exp(g,Ns_6322) in
                                                            {8191}let m2_6324: bitstring = gNs_6323 in
                                                            {8192}event beginSrv(Sess_5170,Cli_5168,gNs_6323);
                                                            {8193}out(c, m2_6324)
                                                        )
                                                        else
                                                            {8194}let pkDisco_6325: bitstring = pub(skI) in
                                                            {8195}in(c, (=pkCli_6300,m1_6326: bitstring));
                                                            {8196}let (SPc_6327: bitstring,PartC_6328: bitstring) = m1_6326 in
                                                            {8197}event endSrv(Cli_5168,Sess_5170,PartC_6328);
                                                            {8198}new Ns_6329: bitstring;
                                                            {8199}let gNs_6330: bitstring = exp(g,Ns_6329) in
                                                            {8200}let m2_6331: bitstring = gNs_6330 in
                                                            {8201}event beginSrv(Sess_5170,Cli_5168,gNs_6330);
                                                            {8202}out(c, m2_6331)
                                                    )
                                                    else
                                                        {8203}let pkDisco_6332: bitstring = fail-any in
                                                        {8204}in(c, (=pkCli_6300,m1_6333: bitstring));
                                                        {8205}let (SPc_6334: bitstring,PartC_6335: bitstring) = m1_6333 in
                                                        {8206}event endSrv(Cli_5168,Sess_5170,PartC_6335);
                                                        {8207}new Ns_6336: bitstring;
                                                        {8208}let gNs_6337: bitstring = exp(g,Ns_6336) in
                                                        {8209}let m2_6338: bitstring = gNs_6337 in
                                                        {8210}event beginSrv(Sess_5170,Cli_5168,gNs_6337);
                                                        {8211}out(c, m2_6338)
                                            )
                                            else
                                                {8212}let pkDisco_6339: bitstring = fail-any in
                                                {8213}in(c, (=pkCli_6300,m1_6340: bitstring));
                                                {8214}let (SPc_6341: bitstring,PartC_6342: bitstring) = m1_6340 in
                                                {8215}event endSrv(Cli_5168,Sess_5170,PartC_6342);
                                                {8216}new Ns_6343: bitstring;
                                                {8217}let gNs_6344: bitstring = exp(g,Ns_6343) in
                                                {8218}let m2_6345: bitstring = gNs_6344 in
                                                {8219}event beginSrv(Sess_5170,Cli_5168,gNs_6344);
                                                {8220}out(c, m2_6345)
                                    )
                                    else
                                        {8221}let pkDisco_6346: bitstring = fail-any in
                                        {8222}in(c, (=pkCli_6300,m1_6347: bitstring));
                                        {8223}let (SPc_6348: bitstring,PartC_6349: bitstring) = m1_6347 in
                                        {8224}event endSrv(Cli_5168,Sess_5170,PartC_6349);
                                        {8225}new Ns_6350: bitstring;
                                        {8226}let gNs_6351: bitstring = exp(g,Ns_6350) in
                                        {8227}let m2_6352: bitstring = gNs_6351 in
                                        {8228}event beginSrv(Sess_5170,Cli_5168,gNs_6351);
                                        {8229}out(c, m2_6352)
                                )
                                else
                                    {8230}let v_6353: bool = (Cli_5168 = B) in
                                    (
                                        {8231}if v_6353 then
                                        (
                                            {8232}let pkCli_6354: bitstring = pub(skB) in
                                            {8233}let v_6355: bool = (Disco_5169 = A) in
                                            (
                                                {8234}if v_6355 then
                                                (
                                                    {8235}let pkDisco_6356: bitstring = pub(skA) in
                                                    {8236}in(c, (=pkCli_6354,m1_6357: bitstring));
                                                    {8237}let (SPc_6358: bitstring,PartC_6359: bitstring) = m1_6357 in
                                                    {8238}event endSrv(Cli_5168,Sess_5170,PartC_6359);
                                                    {8239}new Ns_6360: bitstring;
                                                    {8240}let gNs_6361: bitstring = exp(g,Ns_6360) in
                                                    {8241}let m2_6362: bitstring = gNs_6361 in
                                                    {8242}event beginSrv(Sess_5170,Cli_5168,gNs_6361);
                                                    {8243}out(c, m2_6362)
                                                )
                                                else
                                                    {8244}let v_6363: bool = (Disco_5169 = B) in
                                                    (
                                                        {8245}if v_6363 then
                                                        (
                                                            {8246}let pkDisco_6364: bitstring = pub(skB) in
                                                            {8247}in(c, (=pkCli_6354,m1_6365: bitstring));
                                                            {8248}let (SPc_6366: bitstring,PartC_6367: bitstring) = m1_6365 in
                                                            {8249}event endSrv(Cli_5168,Sess_5170,PartC_6367);
                                                            {8250}new Ns_6368: bitstring;
                                                            {8251}let gNs_6369: bitstring = exp(g,Ns_6368) in
                                                            {8252}let m2_6370: bitstring = gNs_6369 in
                                                            {8253}event beginSrv(Sess_5170,Cli_5168,gNs_6369);
                                                            {8254}out(c, m2_6370)
                                                        )
                                                        else
                                                            {8255}let v_6371: bool = (Disco_5169 = C) in
                                                            (
                                                                {8256}if v_6371 then
                                                                (
                                                                    {8257}let pkDisco_6372: bitstring = pub(skC) in
                                                                    {8258}in(c, (=pkCli_6354,m1_6373: bitstring));
                                                                    {8259}let (SPc_6374: bitstring,PartC_6375: bitstring) = m1_6373 in
                                                                    {8260}event endSrv(Cli_5168,Sess_5170,PartC_6375);
                                                                    {8261}new Ns_6376: bitstring;
                                                                    {8262}let gNs_6377: bitstring = exp(g,Ns_6376) in
                                                                    {8263}let m2_6378: bitstring = gNs_6377 in
                                                                    {8264}event beginSrv(Sess_5170,Cli_5168,gNs_6377);
                                                                    {8265}out(c, m2_6378)
                                                                )
                                                                else
                                                                    {8266}let pkDisco_6379: bitstring = pub(skI) in
                                                                    {8267}in(c, (=pkCli_6354,m1_6380: bitstring));
                                                                    {8268}let (SPc_6381: bitstring,PartC_6382: bitstring) = m1_6380 in
                                                                    {8269}event endSrv(Cli_5168,Sess_5170,PartC_6382);
                                                                    {8270}new Ns_6383: bitstring;
                                                                    {8271}let gNs_6384: bitstring = exp(g,Ns_6383) in
                                                                    {8272}let m2_6385: bitstring = gNs_6384 in
                                                                    {8273}event beginSrv(Sess_5170,Cli_5168,gNs_6384);
                                                                    {8274}out(c, m2_6385)
                                                            )
                                                            else
                                                                {8275}let pkDisco_6386: bitstring = fail-any in
                                                                {8276}in(c, (=pkCli_6354,m1_6387: bitstring));
                                                                {8277}let (SPc_6388: bitstring,PartC_6389: bitstring) = m1_6387 in
                                                                {8278}event endSrv(Cli_5168,Sess_5170,PartC_6389);
                                                                {8279}new Ns_6390: bitstring;
                                                                {8280}let gNs_6391: bitstring = exp(g,Ns_6390) in
                                                                {8281}let m2_6392: bitstring = gNs_6391 in
                                                                {8282}event beginSrv(Sess_5170,Cli_5168,gNs_6391);
                                                                {8283}out(c, m2_6392)
                                                    )
                                                    else
                                                        {8284}let pkDisco_6393: bitstring = fail-any in
                                                        {8285}in(c, (=pkCli_6354,m1_6394: bitstring));
                                                        {8286}let (SPc_6395: bitstring,PartC_6396: bitstring) = m1_6394 in
                                                        {8287}event endSrv(Cli_5168,Sess_5170,PartC_6396);
                                                        {8288}new Ns_6397: bitstring;
                                                        {8289}let gNs_6398: bitstring = exp(g,Ns_6397) in
                                                        {8290}let m2_6399: bitstring = gNs_6398 in
                                                        {8291}event beginSrv(Sess_5170,Cli_5168,gNs_6398);
                                                        {8292}out(c, m2_6399)
                                            )
                                            else
                                                {8293}let pkDisco_6400: bitstring = fail-any in
                                                {8294}in(c, (=pkCli_6354,m1_6401: bitstring));
                                                {8295}let (SPc_6402: bitstring,PartC_6403: bitstring) = m1_6401 in
                                                {8296}event endSrv(Cli_5168,Sess_5170,PartC_6403);
                                                {8297}new Ns_6404: bitstring;
                                                {8298}let gNs_6405: bitstring = exp(g,Ns_6404) in
                                                {8299}let m2_6406: bitstring = gNs_6405 in
                                                {8300}event beginSrv(Sess_5170,Cli_5168,gNs_6405);
                                                {8301}out(c, m2_6406)
                                        )
                                        else
                                            {8302}let v_6407: bool = (Cli_5168 = C) in
                                            (
                                                {8303}if v_6407 then
                                                (
                                                    {8304}let pkCli_6408: bitstring = pub(skC) in
                                                    {8305}let v_6409: bool = (Disco_5169 = A) in
                                                    (
                                                        {8306}if v_6409 then
                                                        (
                                                            {8307}let pkDisco_6410: bitstring = pub(skA) in
                                                            {8308}in(c, (=pkCli_6408,m1_6411: bitstring));
                                                            {8309}let (SPc_6412: bitstring,PartC_6413: bitstring) = m1_6411 in
                                                            {8310}event endSrv(Cli_5168,Sess_5170,PartC_6413);
                                                            {8311}new Ns_6414: bitstring;
                                                            {8312}let gNs_6415: bitstring = exp(g,Ns_6414) in
                                                            {8313}let m2_6416: bitstring = gNs_6415 in
                                                            {8314}event beginSrv(Sess_5170,Cli_5168,gNs_6415);
                                                            {8315}out(c, m2_6416)
                                                        )
                                                        else
                                                            {8316}let v_6417: bool = (Disco_5169 = B) in
                                                            (
                                                                {8317}if v_6417 then
                                                                (
                                                                    {8318}let pkDisco_6418: bitstring = pub(skB) in
                                                                    {8319}in(c, (=pkCli_6408,m1_6419: bitstring));
                                                                    {8320}let (SPc_6420: bitstring,PartC_6421: bitstring) = m1_6419 in
                                                                    {8321}event endSrv(Cli_5168,Sess_5170,PartC_6421);
                                                                    {8322}new Ns_6422: bitstring;
                                                                    {8323}let gNs_6423: bitstring = exp(g,Ns_6422) in
                                                                    {8324}let m2_6424: bitstring = gNs_6423 in
                                                                    {8325}event beginSrv(Sess_5170,Cli_5168,gNs_6423);
                                                                    {8326}out(c, m2_6424)
                                                                )
                                                                else
                                                                    {8327}let v_6425: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {8328}if v_6425 then
                                                                        (
                                                                            {8329}let pkDisco_6426: bitstring = pub(skC) in
                                                                            {8330}in(c, (=pkCli_6408,m1_6427: bitstring));
                                                                            {8331}let (SPc_6428: bitstring,PartC_6429: bitstring) = m1_6427 in
                                                                            {8332}event endSrv(Cli_5168,Sess_5170,PartC_6429);
                                                                            {8333}new Ns_6430: bitstring;
                                                                            {8334}let gNs_6431: bitstring = exp(g,Ns_6430) in
                                                                            {8335}let m2_6432: bitstring = gNs_6431 in
                                                                            {8336}event beginSrv(Sess_5170,Cli_5168,gNs_6431);
                                                                            {8337}out(c, m2_6432)
                                                                        )
                                                                        else
                                                                            {8338}let pkDisco_6433: bitstring = pub(skI) in
                                                                            {8339}in(c, (=pkCli_6408,m1_6434: bitstring));
                                                                            {8340}let (SPc_6435: bitstring,PartC_6436: bitstring) = m1_6434 in
                                                                            {8341}event endSrv(Cli_5168,Sess_5170,PartC_6436);
                                                                            {8342}new Ns_6437: bitstring;
                                                                            {8343}let gNs_6438: bitstring = exp(g,Ns_6437) in
                                                                            {8344}let m2_6439: bitstring = gNs_6438 in
                                                                            {8345}event beginSrv(Sess_5170,Cli_5168,gNs_6438);
                                                                            {8346}out(c, m2_6439)
                                                                    )
                                                                    else
                                                                        {8347}let pkDisco_6440: bitstring = fail-any in
                                                                        {8348}in(c, (=pkCli_6408,m1_6441: bitstring));
                                                                        {8349}let (SPc_6442: bitstring,PartC_6443: bitstring) = m1_6441 in
                                                                        {8350}event endSrv(Cli_5168,Sess_5170,PartC_6443);
                                                                        {8351}new Ns_6444: bitstring;
                                                                        {8352}let gNs_6445: bitstring = exp(g,Ns_6444) in
                                                                        {8353}let m2_6446: bitstring = gNs_6445 in
                                                                        {8354}event beginSrv(Sess_5170,Cli_5168,gNs_6445);
                                                                        {8355}out(c, m2_6446)
                                                            )
                                                            else
                                                                {8356}let pkDisco_6447: bitstring = fail-any in
                                                                {8357}in(c, (=pkCli_6408,m1_6448: bitstring));
                                                                {8358}let (SPc_6449: bitstring,PartC_6450: bitstring) = m1_6448 in
                                                                {8359}event endSrv(Cli_5168,Sess_5170,PartC_6450);
                                                                {8360}new Ns_6451: bitstring;
                                                                {8361}let gNs_6452: bitstring = exp(g,Ns_6451) in
                                                                {8362}let m2_6453: bitstring = gNs_6452 in
                                                                {8363}event beginSrv(Sess_5170,Cli_5168,gNs_6452);
                                                                {8364}out(c, m2_6453)
                                                    )
                                                    else
                                                        {8365}let pkDisco_6454: bitstring = fail-any in
                                                        {8366}in(c, (=pkCli_6408,m1_6455: bitstring));
                                                        {8367}let (SPc_6456: bitstring,PartC_6457: bitstring) = m1_6455 in
                                                        {8368}event endSrv(Cli_5168,Sess_5170,PartC_6457);
                                                        {8369}new Ns_6458: bitstring;
                                                        {8370}let gNs_6459: bitstring = exp(g,Ns_6458) in
                                                        {8371}let m2_6460: bitstring = gNs_6459 in
                                                        {8372}event beginSrv(Sess_5170,Cli_5168,gNs_6459);
                                                        {8373}out(c, m2_6460)
                                                )
                                                else
                                                    {8374}let pkCli_6461: bitstring = pub(skI) in
                                                    {8375}let v_6462: bool = (Disco_5169 = A) in
                                                    (
                                                        {8376}if v_6462 then
                                                        (
                                                            {8377}let pkDisco_6463: bitstring = pub(skA) in
                                                            {8378}in(c, (=pkCli_6461,m1_6464: bitstring));
                                                            {8379}let (SPc_6465: bitstring,PartC_6466: bitstring) = m1_6464 in
                                                            {8380}event endSrv(Cli_5168,Sess_5170,PartC_6466);
                                                            {8381}new Ns_6467: bitstring;
                                                            {8382}let gNs_6468: bitstring = exp(g,Ns_6467) in
                                                            {8383}let m2_6469: bitstring = gNs_6468 in
                                                            {8384}event beginSrv(Sess_5170,Cli_5168,gNs_6468);
                                                            {8385}out(c, m2_6469)
                                                        )
                                                        else
                                                            {8386}let v_6470: bool = (Disco_5169 = B) in
                                                            (
                                                                {8387}if v_6470 then
                                                                (
                                                                    {8388}let pkDisco_6471: bitstring = pub(skB) in
                                                                    {8389}in(c, (=pkCli_6461,m1_6472: bitstring));
                                                                    {8390}let (SPc_6473: bitstring,PartC_6474: bitstring) = m1_6472 in
                                                                    {8391}event endSrv(Cli_5168,Sess_5170,PartC_6474);
                                                                    {8392}new Ns_6475: bitstring;
                                                                    {8393}let gNs_6476: bitstring = exp(g,Ns_6475) in
                                                                    {8394}let m2_6477: bitstring = gNs_6476 in
                                                                    {8395}event beginSrv(Sess_5170,Cli_5168,gNs_6476);
                                                                    {8396}out(c, m2_6477)
                                                                )
                                                                else
                                                                    {8397}let v_6478: bool = (Disco_5169 = C) in
                                                                    (
                                                                        {8398}if v_6478 then
                                                                        (
                                                                            {8399}let pkDisco_6479: bitstring = pub(skC) in
                                                                            {8400}in(c, (=pkCli_6461,m1_6480: bitstring));
                                                                            {8401}let (SPc_6481: bitstring,PartC_6482: bitstring) = m1_6480 in
                                                                            {8402}event endSrv(Cli_5168,Sess_5170,PartC_6482);
                                                                            {8403}new Ns_6483: bitstring;
                                                                            {8404}let gNs_6484: bitstring = exp(g,Ns_6483) in
                                                                            {8405}let m2_6485: bitstring = gNs_6484 in
                                                                            {8406}event beginSrv(Sess_5170,Cli_5168,gNs_6484);
                                                                            {8407}out(c, m2_6485)
                                                                        )
                                                                        else
                                                                            {8408}let pkDisco_6486: bitstring = pub(skI) in
                                                                            {8409}in(c, (=pkCli_6461,m1_6487: bitstring));
                                                                            {8410}let (SPc_6488: bitstring,PartC_6489: bitstring) = m1_6487 in
                                                                            {8411}event endSrv(Cli_5168,Sess_5170,PartC_6489);
                                                                            {8412}new Ns_6490: bitstring;
                                                                            {8413}let gNs_6491: bitstring = exp(g,Ns_6490) in
                                                                            {8414}let m2_6492: bitstring = gNs_6491 in
                                                                            {8415}event beginSrv(Sess_5170,Cli_5168,gNs_6491);
                                                                            {8416}out(c, m2_6492)
                                                                    )
                                                                    else
                                                                        {8417}let pkDisco_6493: bitstring = fail-any in
                                                                        {8418}in(c, (=pkCli_6461,m1_6494: bitstring));
                                                                        {8419}let (SPc_6495: bitstring,PartC_6496: bitstring) = m1_6494 in
                                                                        {8420}event endSrv(Cli_5168,Sess_5170,PartC_6496);
                                                                        {8421}new Ns_6497: bitstring;
                                                                        {8422}let gNs_6498: bitstring = exp(g,Ns_6497) in
                                                                        {8423}let m2_6499: bitstring = gNs_6498 in
                                                                        {8424}event beginSrv(Sess_5170,Cli_5168,gNs_6498);
                                                                        {8425}out(c, m2_6499)
                                                            )
                                                            else
                                                                {8426}let pkDisco_6500: bitstring = fail-any in
                                                                {8427}in(c, (=pkCli_6461,m1_6501: bitstring));
                                                                {8428}let (SPc_6502: bitstring,PartC_6503: bitstring) = m1_6501 in
                                                                {8429}event endSrv(Cli_5168,Sess_5170,PartC_6503);
                                                                {8430}new Ns_6504: bitstring;
                                                                {8431}let gNs_6505: bitstring = exp(g,Ns_6504) in
                                                                {8432}let m2_6506: bitstring = gNs_6505 in
                                                                {8433}event beginSrv(Sess_5170,Cli_5168,gNs_6505);
                                                                {8434}out(c, m2_6506)
                                                    )
                                                    else
                                                        {8435}let pkDisco_6507: bitstring = fail-any in
                                                        {8436}in(c, (=pkCli_6461,m1_6508: bitstring));
                                                        {8437}let (SPc_6509: bitstring,PartC_6510: bitstring) = m1_6508 in
                                                        {8438}event endSrv(Cli_5168,Sess_5170,PartC_6510);
                                                        {8439}new Ns_6511: bitstring;
                                                        {8440}let gNs_6512: bitstring = exp(g,Ns_6511) in
                                                        {8441}let m2_6513: bitstring = gNs_6512 in
                                                        {8442}event beginSrv(Sess_5170,Cli_5168,gNs_6512);
                                                        {8443}out(c, m2_6513)
                                            )
                                            else
                                                {8444}let pkCli_6514: bitstring = fail-any in
                                                {8445}let v_6515: bool = (Disco_5169 = A) in
                                                (
                                                    {8446}if v_6515 then
                                                    (
                                                        {8447}let pkDisco_6516: bitstring = pub(skA) in
                                                        {8448}in(c, (=pkCli_6514,m1_6517: bitstring));
                                                        {8449}let (SPc_6518: bitstring,PartC_6519: bitstring) = m1_6517 in
                                                        {8450}event endSrv(Cli_5168,Sess_5170,PartC_6519);
                                                        {8451}new Ns_6520: bitstring;
                                                        {8452}let gNs_6521: bitstring = exp(g,Ns_6520) in
                                                        {8453}let m2_6522: bitstring = gNs_6521 in
                                                        {8454}event beginSrv(Sess_5170,Cli_5168,gNs_6521);
                                                        {8455}out(c, m2_6522)
                                                    )
                                                    else
                                                        {8456}let v_6523: bool = (Disco_5169 = B) in
                                                        (
                                                            {8457}if v_6523 then
                                                            (
                                                                {8458}let pkDisco_6524: bitstring = pub(skB) in
                                                                {8459}in(c, (=pkCli_6514,m1_6525: bitstring));
                                                                {8460}let (SPc_6526: bitstring,PartC_6527: bitstring) = m1_6525 in
                                                                {8461}event endSrv(Cli_5168,Sess_5170,PartC_6527);
                                                                {8462}new Ns_6528: bitstring;
                                                                {8463}let gNs_6529: bitstring = exp(g,Ns_6528) in
                                                                {8464}let m2_6530: bitstring = gNs_6529 in
                                                                {8465}event beginSrv(Sess_5170,Cli_5168,gNs_6529);
                                                                {8466}out(c, m2_6530)
                                                            )
                                                            else
                                                                {8467}let v_6531: bool = (Disco_5169 = C) in
                                                                (
                                                                    {8468}if v_6531 then
                                                                    (
                                                                        {8469}let pkDisco_6532: bitstring = pub(skC) in
                                                                        {8470}in(c, (=pkCli_6514,m1_6533: bitstring));
                                                                        {8471}let (SPc_6534: bitstring,PartC_6535: bitstring) = m1_6533 in
                                                                        {8472}event endSrv(Cli_5168,Sess_5170,PartC_6535);
                                                                        {8473}new Ns_6536: bitstring;
                                                                        {8474}let gNs_6537: bitstring = exp(g,Ns_6536) in
                                                                        {8475}let m2_6538: bitstring = gNs_6537 in
                                                                        {8476}event beginSrv(Sess_5170,Cli_5168,gNs_6537);
                                                                        {8477}out(c, m2_6538)
                                                                    )
                                                                    else
                                                                        {8478}let pkDisco_6539: bitstring = pub(skI) in
                                                                        {8479}in(c, (=pkCli_6514,m1_6540: bitstring));
                                                                        {8480}let (SPc_6541: bitstring,PartC_6542: bitstring) = m1_6540 in
                                                                        {8481}event endSrv(Cli_5168,Sess_5170,PartC_6542);
                                                                        {8482}new Ns_6543: bitstring;
                                                                        {8483}let gNs_6544: bitstring = exp(g,Ns_6543) in
                                                                        {8484}let m2_6545: bitstring = gNs_6544 in
                                                                        {8485}event beginSrv(Sess_5170,Cli_5168,gNs_6544);
                                                                        {8486}out(c, m2_6545)
                                                                )
                                                                else
                                                                    {8487}let pkDisco_6546: bitstring = fail-any in
                                                                    {8488}in(c, (=pkCli_6514,m1_6547: bitstring));
                                                                    {8489}let (SPc_6548: bitstring,PartC_6549: bitstring) = m1_6547 in
                                                                    {8490}event endSrv(Cli_5168,Sess_5170,PartC_6549);
                                                                    {8491}new Ns_6550: bitstring;
                                                                    {8492}let gNs_6551: bitstring = exp(g,Ns_6550) in
                                                                    {8493}let m2_6552: bitstring = gNs_6551 in
                                                                    {8494}event beginSrv(Sess_5170,Cli_5168,gNs_6551);
                                                                    {8495}out(c, m2_6552)
                                                        )
                                                        else
                                                            {8496}let pkDisco_6553: bitstring = fail-any in
                                                            {8497}in(c, (=pkCli_6514,m1_6554: bitstring));
                                                            {8498}let (SPc_6555: bitstring,PartC_6556: bitstring) = m1_6554 in
                                                            {8499}event endSrv(Cli_5168,Sess_5170,PartC_6556);
                                                            {8500}new Ns_6557: bitstring;
                                                            {8501}let gNs_6558: bitstring = exp(g,Ns_6557) in
                                                            {8502}let m2_6559: bitstring = gNs_6558 in
                                                            {8503}event beginSrv(Sess_5170,Cli_5168,gNs_6558);
                                                            {8504}out(c, m2_6559)
                                                )
                                                else
                                                    {8505}let pkDisco_6560: bitstring = fail-any in
                                                    {8506}in(c, (=pkCli_6514,m1_6561: bitstring));
                                                    {8507}let (SPc_6562: bitstring,PartC_6563: bitstring) = m1_6561 in
                                                    {8508}event endSrv(Cli_5168,Sess_5170,PartC_6563);
                                                    {8509}new Ns_6564: bitstring;
                                                    {8510}let gNs_6565: bitstring = exp(g,Ns_6564) in
                                                    {8511}let m2_6566: bitstring = gNs_6565 in
                                                    {8512}event beginSrv(Sess_5170,Cli_5168,gNs_6565);
                                                    {8513}out(c, m2_6566)
                                    )
                                    else
                                        {8514}let pkCli_6567: bitstring = fail-any in
                                        {8515}let v_6568: bool = (Disco_5169 = A) in
                                        (
                                            {8516}if v_6568 then
                                            (
                                                {8517}let pkDisco_6569: bitstring = pub(skA) in
                                                {8518}in(c, (=pkCli_6567,m1_6570: bitstring));
                                                {8519}let (SPc_6571: bitstring,PartC_6572: bitstring) = m1_6570 in
                                                {8520}event endSrv(Cli_5168,Sess_5170,PartC_6572);
                                                {8521}new Ns_6573: bitstring;
                                                {8522}let gNs_6574: bitstring = exp(g,Ns_6573) in
                                                {8523}let m2_6575: bitstring = gNs_6574 in
                                                {8524}event beginSrv(Sess_5170,Cli_5168,gNs_6574);
                                                {8525}out(c, m2_6575)
                                            )
                                            else
                                                {8526}let v_6576: bool = (Disco_5169 = B) in
                                                (
                                                    {8527}if v_6576 then
                                                    (
                                                        {8528}let pkDisco_6577: bitstring = pub(skB) in
                                                        {8529}in(c, (=pkCli_6567,m1_6578: bitstring));
                                                        {8530}let (SPc_6579: bitstring,PartC_6580: bitstring) = m1_6578 in
                                                        {8531}event endSrv(Cli_5168,Sess_5170,PartC_6580);
                                                        {8532}new Ns_6581: bitstring;
                                                        {8533}let gNs_6582: bitstring = exp(g,Ns_6581) in
                                                        {8534}let m2_6583: bitstring = gNs_6582 in
                                                        {8535}event beginSrv(Sess_5170,Cli_5168,gNs_6582);
                                                        {8536}out(c, m2_6583)
                                                    )
                                                    else
                                                        {8537}let v_6584: bool = (Disco_5169 = C) in
                                                        (
                                                            {8538}if v_6584 then
                                                            (
                                                                {8539}let pkDisco_6585: bitstring = pub(skC) in
                                                                {8540}in(c, (=pkCli_6567,m1_6586: bitstring));
                                                                {8541}let (SPc_6587: bitstring,PartC_6588: bitstring) = m1_6586 in
                                                                {8542}event endSrv(Cli_5168,Sess_5170,PartC_6588);
                                                                {8543}new Ns_6589: bitstring;
                                                                {8544}let gNs_6590: bitstring = exp(g,Ns_6589) in
                                                                {8545}let m2_6591: bitstring = gNs_6590 in
                                                                {8546}event beginSrv(Sess_5170,Cli_5168,gNs_6590);
                                                                {8547}out(c, m2_6591)
                                                            )
                                                            else
                                                                {8548}let pkDisco_6592: bitstring = pub(skI) in
                                                                {8549}in(c, (=pkCli_6567,m1_6593: bitstring));
                                                                {8550}let (SPc_6594: bitstring,PartC_6595: bitstring) = m1_6593 in
                                                                {8551}event endSrv(Cli_5168,Sess_5170,PartC_6595);
                                                                {8552}new Ns_6596: bitstring;
                                                                {8553}let gNs_6597: bitstring = exp(g,Ns_6596) in
                                                                {8554}let m2_6598: bitstring = gNs_6597 in
                                                                {8555}event beginSrv(Sess_5170,Cli_5168,gNs_6597);
                                                                {8556}out(c, m2_6598)
                                                        )
                                                        else
                                                            {8557}let pkDisco_6599: bitstring = fail-any in
                                                            {8558}in(c, (=pkCli_6567,m1_6600: bitstring));
                                                            {8559}let (SPc_6601: bitstring,PartC_6602: bitstring) = m1_6600 in
                                                            {8560}event endSrv(Cli_5168,Sess_5170,PartC_6602);
                                                            {8561}new Ns_6603: bitstring;
                                                            {8562}let gNs_6604: bitstring = exp(g,Ns_6603) in
                                                            {8563}let m2_6605: bitstring = gNs_6604 in
                                                            {8564}event beginSrv(Sess_5170,Cli_5168,gNs_6604);
                                                            {8565}out(c, m2_6605)
                                                )
                                                else
                                                    {8566}let pkDisco_6606: bitstring = fail-any in
                                                    {8567}in(c, (=pkCli_6567,m1_6607: bitstring));
                                                    {8568}let (SPc_6608: bitstring,PartC_6609: bitstring) = m1_6607 in
                                                    {8569}event endSrv(Cli_5168,Sess_5170,PartC_6609);
                                                    {8570}new Ns_6610: bitstring;
                                                    {8571}let gNs_6611: bitstring = exp(g,Ns_6610) in
                                                    {8572}let m2_6612: bitstring = gNs_6611 in
                                                    {8573}event beginSrv(Sess_5170,Cli_5168,gNs_6611);
                                                    {8574}out(c, m2_6612)
                                        )
                                        else
                                            {8575}let pkDisco_6613: bitstring = fail-any in
                                            {8576}in(c, (=pkCli_6567,m1_6614: bitstring));
                                            {8577}let (SPc_6615: bitstring,PartC_6616: bitstring) = m1_6614 in
                                            {8578}event endSrv(Cli_5168,Sess_5170,PartC_6616);
                                            {8579}new Ns_6617: bitstring;
                                            {8580}let gNs_6618: bitstring = exp(g,Ns_6617) in
                                            {8581}let m2_6619: bitstring = gNs_6618 in
                                            {8582}event beginSrv(Sess_5170,Cli_5168,gNs_6618);
                                            {8583}out(c, m2_6619)
                            )
                            else
                                {8584}let pkCli_6620: bitstring = fail-any in
                                {8585}let v_6621: bool = (Disco_5169 = A) in
                                (
                                    {8586}if v_6621 then
                                    (
                                        {8587}let pkDisco_6622: bitstring = pub(skA) in
                                        {8588}in(c, (=pkCli_6620,m1_6623: bitstring));
                                        {8589}let (SPc_6624: bitstring,PartC_6625: bitstring) = m1_6623 in
                                        {8590}event endSrv(Cli_5168,Sess_5170,PartC_6625);
                                        {8591}new Ns_6626: bitstring;
                                        {8592}let gNs_6627: bitstring = exp(g,Ns_6626) in
                                        {8593}let m2_6628: bitstring = gNs_6627 in
                                        {8594}event beginSrv(Sess_5170,Cli_5168,gNs_6627);
                                        {8595}out(c, m2_6628)
                                    )
                                    else
                                        {8596}let v_6629: bool = (Disco_5169 = B) in
                                        (
                                            {8597}if v_6629 then
                                            (
                                                {8598}let pkDisco_6630: bitstring = pub(skB) in
                                                {8599}in(c, (=pkCli_6620,m1_6631: bitstring));
                                                {8600}let (SPc_6632: bitstring,PartC_6633: bitstring) = m1_6631 in
                                                {8601}event endSrv(Cli_5168,Sess_5170,PartC_6633);
                                                {8602}new Ns_6634: bitstring;
                                                {8603}let gNs_6635: bitstring = exp(g,Ns_6634) in
                                                {8604}let m2_6636: bitstring = gNs_6635 in
                                                {8605}event beginSrv(Sess_5170,Cli_5168,gNs_6635);
                                                {8606}out(c, m2_6636)
                                            )
                                            else
                                                {8607}let v_6637: bool = (Disco_5169 = C) in
                                                (
                                                    {8608}if v_6637 then
                                                    (
                                                        {8609}let pkDisco_6638: bitstring = pub(skC) in
                                                        {8610}in(c, (=pkCli_6620,m1_6639: bitstring));
                                                        {8611}let (SPc_6640: bitstring,PartC_6641: bitstring) = m1_6639 in
                                                        {8612}event endSrv(Cli_5168,Sess_5170,PartC_6641);
                                                        {8613}new Ns_6642: bitstring;
                                                        {8614}let gNs_6643: bitstring = exp(g,Ns_6642) in
                                                        {8615}let m2_6644: bitstring = gNs_6643 in
                                                        {8616}event beginSrv(Sess_5170,Cli_5168,gNs_6643);
                                                        {8617}out(c, m2_6644)
                                                    )
                                                    else
                                                        {8618}let pkDisco_6645: bitstring = pub(skI) in
                                                        {8619}in(c, (=pkCli_6620,m1_6646: bitstring));
                                                        {8620}let (SPc_6647: bitstring,PartC_6648: bitstring) = m1_6646 in
                                                        {8621}event endSrv(Cli_5168,Sess_5170,PartC_6648);
                                                        {8622}new Ns_6649: bitstring;
                                                        {8623}let gNs_6650: bitstring = exp(g,Ns_6649) in
                                                        {8624}let m2_6651: bitstring = gNs_6650 in
                                                        {8625}event beginSrv(Sess_5170,Cli_5168,gNs_6650);
                                                        {8626}out(c, m2_6651)
                                                )
                                                else
                                                    {8627}let pkDisco_6652: bitstring = fail-any in
                                                    {8628}in(c, (=pkCli_6620,m1_6653: bitstring));
                                                    {8629}let (SPc_6654: bitstring,PartC_6655: bitstring) = m1_6653 in
                                                    {8630}event endSrv(Cli_5168,Sess_5170,PartC_6655);
                                                    {8631}new Ns_6656: bitstring;
                                                    {8632}let gNs_6657: bitstring = exp(g,Ns_6656) in
                                                    {8633}let m2_6658: bitstring = gNs_6657 in
                                                    {8634}event beginSrv(Sess_5170,Cli_5168,gNs_6657);
                                                    {8635}out(c, m2_6658)
                                        )
                                        else
                                            {8636}let pkDisco_6659: bitstring = fail-any in
                                            {8637}in(c, (=pkCli_6620,m1_6660: bitstring));
                                            {8638}let (SPc_6661: bitstring,PartC_6662: bitstring) = m1_6660 in
                                            {8639}event endSrv(Cli_5168,Sess_5170,PartC_6662);
                                            {8640}new Ns_6663: bitstring;
                                            {8641}let gNs_6664: bitstring = exp(g,Ns_6663) in
                                            {8642}let m2_6665: bitstring = gNs_6664 in
                                            {8643}event beginSrv(Sess_5170,Cli_5168,gNs_6664);
                                            {8644}out(c, m2_6665)
                                )
                                else
                                    {8645}let pkDisco_6666: bitstring = fail-any in
                                    {8646}in(c, (=pkCli_6620,m1_6667: bitstring));
                                    {8647}let (SPc_6668: bitstring,PartC_6669: bitstring) = m1_6667 in
                                    {8648}event endSrv(Cli_5168,Sess_5170,PartC_6669);
                                    {8649}new Ns_6670: bitstring;
                                    {8650}let gNs_6671: bitstring = exp(g,Ns_6670) in
                                    {8651}let m2_6672: bitstring = gNs_6671 in
                                    {8652}event beginSrv(Sess_5170,Cli_5168,gNs_6671);
                                    {8653}out(c, m2_6672)
                    )
                    else
                        {8654}let skSess_6673: bitstring = fail-any in
                        {8655}let pkSess_6674: bitstring = pub(skSess_6673) in
                        {8656}let v_6675: bool = (Cli_5168 = A) in
                        (
                            {8657}if v_6675 then
                            (
                                {8658}let pkCli_6676: bitstring = pub(skA) in
                                {8659}let v_6677: bool = (Disco_5169 = A) in
                                (
                                    {8660}if v_6677 then
                                    (
                                        {8661}let pkDisco_6678: bitstring = pub(skA) in
                                        {8662}in(c, (=pkCli_6676,m1_6679: bitstring));
                                        {8663}let (SPc_6680: bitstring,PartC_6681: bitstring) = m1_6679 in
                                        {8664}event endSrv(Cli_5168,Sess_5170,PartC_6681);
                                        {8665}new Ns_6682: bitstring;
                                        {8666}let gNs_6683: bitstring = exp(g,Ns_6682) in
                                        {8667}let m2_6684: bitstring = gNs_6683 in
                                        {8668}event beginSrv(Sess_5170,Cli_5168,gNs_6683);
                                        {8669}out(c, m2_6684)
                                    )
                                    else
                                        {8670}let v_6685: bool = (Disco_5169 = B) in
                                        (
                                            {8671}if v_6685 then
                                            (
                                                {8672}let pkDisco_6686: bitstring = pub(skB) in
                                                {8673}in(c, (=pkCli_6676,m1_6687: bitstring));
                                                {8674}let (SPc_6688: bitstring,PartC_6689: bitstring) = m1_6687 in
                                                {8675}event endSrv(Cli_5168,Sess_5170,PartC_6689);
                                                {8676}new Ns_6690: bitstring;
                                                {8677}let gNs_6691: bitstring = exp(g,Ns_6690) in
                                                {8678}let m2_6692: bitstring = gNs_6691 in
                                                {8679}event beginSrv(Sess_5170,Cli_5168,gNs_6691);
                                                {8680}out(c, m2_6692)
                                            )
                                            else
                                                {8681}let v_6693: bool = (Disco_5169 = C) in
                                                (
                                                    {8682}if v_6693 then
                                                    (
                                                        {8683}let pkDisco_6694: bitstring = pub(skC) in
                                                        {8684}in(c, (=pkCli_6676,m1_6695: bitstring));
                                                        {8685}let (SPc_6696: bitstring,PartC_6697: bitstring) = m1_6695 in
                                                        {8686}event endSrv(Cli_5168,Sess_5170,PartC_6697);
                                                        {8687}new Ns_6698: bitstring;
                                                        {8688}let gNs_6699: bitstring = exp(g,Ns_6698) in
                                                        {8689}let m2_6700: bitstring = gNs_6699 in
                                                        {8690}event beginSrv(Sess_5170,Cli_5168,gNs_6699);
                                                        {8691}out(c, m2_6700)
                                                    )
                                                    else
                                                        {8692}let pkDisco_6701: bitstring = pub(skI) in
                                                        {8693}in(c, (=pkCli_6676,m1_6702: bitstring));
                                                        {8694}let (SPc_6703: bitstring,PartC_6704: bitstring) = m1_6702 in
                                                        {8695}event endSrv(Cli_5168,Sess_5170,PartC_6704);
                                                        {8696}new Ns_6705: bitstring;
                                                        {8697}let gNs_6706: bitstring = exp(g,Ns_6705) in
                                                        {8698}let m2_6707: bitstring = gNs_6706 in
                                                        {8699}event beginSrv(Sess_5170,Cli_5168,gNs_6706);
                                                        {8700}out(c, m2_6707)
                                                )
                                                else
                                                    {8701}let pkDisco_6708: bitstring = fail-any in
                                                    {8702}in(c, (=pkCli_6676,m1_6709: bitstring));
                                                    {8703}let (SPc_6710: bitstring,PartC_6711: bitstring) = m1_6709 in
                                                    {8704}event endSrv(Cli_5168,Sess_5170,PartC_6711);
                                                    {8705}new Ns_6712: bitstring;
                                                    {8706}let gNs_6713: bitstring = exp(g,Ns_6712) in
                                                    {8707}let m2_6714: bitstring = gNs_6713 in
                                                    {8708}event beginSrv(Sess_5170,Cli_5168,gNs_6713);
                                                    {8709}out(c, m2_6714)
                                        )
                                        else
                                            {8710}let pkDisco_6715: bitstring = fail-any in
                                            {8711}in(c, (=pkCli_6676,m1_6716: bitstring));
                                            {8712}let (SPc_6717: bitstring,PartC_6718: bitstring) = m1_6716 in
                                            {8713}event endSrv(Cli_5168,Sess_5170,PartC_6718);
                                            {8714}new Ns_6719: bitstring;
                                            {8715}let gNs_6720: bitstring = exp(g,Ns_6719) in
                                            {8716}let m2_6721: bitstring = gNs_6720 in
                                            {8717}event beginSrv(Sess_5170,Cli_5168,gNs_6720);
                                            {8718}out(c, m2_6721)
                                )
                                else
                                    {8719}let pkDisco_6722: bitstring = fail-any in
                                    {8720}in(c, (=pkCli_6676,m1_6723: bitstring));
                                    {8721}let (SPc_6724: bitstring,PartC_6725: bitstring) = m1_6723 in
                                    {8722}event endSrv(Cli_5168,Sess_5170,PartC_6725);
                                    {8723}new Ns_6726: bitstring;
                                    {8724}let gNs_6727: bitstring = exp(g,Ns_6726) in
                                    {8725}let m2_6728: bitstring = gNs_6727 in
                                    {8726}event beginSrv(Sess_5170,Cli_5168,gNs_6727);
                                    {8727}out(c, m2_6728)
                            )
                            else
                                {8728}let v_6729: bool = (Cli_5168 = B) in
                                (
                                    {8729}if v_6729 then
                                    (
                                        {8730}let pkCli_6730: bitstring = pub(skB) in
                                        {8731}let v_6731: bool = (Disco_5169 = A) in
                                        (
                                            {8732}if v_6731 then
                                            (
                                                {8733}let pkDisco_6732: bitstring = pub(skA) in
                                                {8734}in(c, (=pkCli_6730,m1_6733: bitstring));
                                                {8735}let (SPc_6734: bitstring,PartC_6735: bitstring) = m1_6733 in
                                                {8736}event endSrv(Cli_5168,Sess_5170,PartC_6735);
                                                {8737}new Ns_6736: bitstring;
                                                {8738}let gNs_6737: bitstring = exp(g,Ns_6736) in
                                                {8739}let m2_6738: bitstring = gNs_6737 in
                                                {8740}event beginSrv(Sess_5170,Cli_5168,gNs_6737);
                                                {8741}out(c, m2_6738)
                                            )
                                            else
                                                {8742}let v_6739: bool = (Disco_5169 = B) in
                                                (
                                                    {8743}if v_6739 then
                                                    (
                                                        {8744}let pkDisco_6740: bitstring = pub(skB) in
                                                        {8745}in(c, (=pkCli_6730,m1_6741: bitstring));
                                                        {8746}let (SPc_6742: bitstring,PartC_6743: bitstring) = m1_6741 in
                                                        {8747}event endSrv(Cli_5168,Sess_5170,PartC_6743);
                                                        {8748}new Ns_6744: bitstring;
                                                        {8749}let gNs_6745: bitstring = exp(g,Ns_6744) in
                                                        {8750}let m2_6746: bitstring = gNs_6745 in
                                                        {8751}event beginSrv(Sess_5170,Cli_5168,gNs_6745);
                                                        {8752}out(c, m2_6746)
                                                    )
                                                    else
                                                        {8753}let v_6747: bool = (Disco_5169 = C) in
                                                        (
                                                            {8754}if v_6747 then
                                                            (
                                                                {8755}let pkDisco_6748: bitstring = pub(skC) in
                                                                {8756}in(c, (=pkCli_6730,m1_6749: bitstring));
                                                                {8757}let (SPc_6750: bitstring,PartC_6751: bitstring) = m1_6749 in
                                                                {8758}event endSrv(Cli_5168,Sess_5170,PartC_6751);
                                                                {8759}new Ns_6752: bitstring;
                                                                {8760}let gNs_6753: bitstring = exp(g,Ns_6752) in
                                                                {8761}let m2_6754: bitstring = gNs_6753 in
                                                                {8762}event beginSrv(Sess_5170,Cli_5168,gNs_6753);
                                                                {8763}out(c, m2_6754)
                                                            )
                                                            else
                                                                {8764}let pkDisco_6755: bitstring = pub(skI) in
                                                                {8765}in(c, (=pkCli_6730,m1_6756: bitstring));
                                                                {8766}let (SPc_6757: bitstring,PartC_6758: bitstring) = m1_6756 in
                                                                {8767}event endSrv(Cli_5168,Sess_5170,PartC_6758);
                                                                {8768}new Ns_6759: bitstring;
                                                                {8769}let gNs_6760: bitstring = exp(g,Ns_6759) in
                                                                {8770}let m2_6761: bitstring = gNs_6760 in
                                                                {8771}event beginSrv(Sess_5170,Cli_5168,gNs_6760);
                                                                {8772}out(c, m2_6761)
                                                        )
                                                        else
                                                            {8773}let pkDisco_6762: bitstring = fail-any in
                                                            {8774}in(c, (=pkCli_6730,m1_6763: bitstring));
                                                            {8775}let (SPc_6764: bitstring,PartC_6765: bitstring) = m1_6763 in
                                                            {8776}event endSrv(Cli_5168,Sess_5170,PartC_6765);
                                                            {8777}new Ns_6766: bitstring;
                                                            {8778}let gNs_6767: bitstring = exp(g,Ns_6766) in
                                                            {8779}let m2_6768: bitstring = gNs_6767 in
                                                            {8780}event beginSrv(Sess_5170,Cli_5168,gNs_6767);
                                                            {8781}out(c, m2_6768)
                                                )
                                                else
                                                    {8782}let pkDisco_6769: bitstring = fail-any in
                                                    {8783}in(c, (=pkCli_6730,m1_6770: bitstring));
                                                    {8784}let (SPc_6771: bitstring,PartC_6772: bitstring) = m1_6770 in
                                                    {8785}event endSrv(Cli_5168,Sess_5170,PartC_6772);
                                                    {8786}new Ns_6773: bitstring;
                                                    {8787}let gNs_6774: bitstring = exp(g,Ns_6773) in
                                                    {8788}let m2_6775: bitstring = gNs_6774 in
                                                    {8789}event beginSrv(Sess_5170,Cli_5168,gNs_6774);
                                                    {8790}out(c, m2_6775)
                                        )
                                        else
                                            {8791}let pkDisco_6776: bitstring = fail-any in
                                            {8792}in(c, (=pkCli_6730,m1_6777: bitstring));
                                            {8793}let (SPc_6778: bitstring,PartC_6779: bitstring) = m1_6777 in
                                            {8794}event endSrv(Cli_5168,Sess_5170,PartC_6779);
                                            {8795}new Ns_6780: bitstring;
                                            {8796}let gNs_6781: bitstring = exp(g,Ns_6780) in
                                            {8797}let m2_6782: bitstring = gNs_6781 in
                                            {8798}event beginSrv(Sess_5170,Cli_5168,gNs_6781);
                                            {8799}out(c, m2_6782)
                                    )
                                    else
                                        {8800}let v_6783: bool = (Cli_5168 = C) in
                                        (
                                            {8801}if v_6783 then
                                            (
                                                {8802}let pkCli_6784: bitstring = pub(skC) in
                                                {8803}let v_6785: bool = (Disco_5169 = A) in
                                                (
                                                    {8804}if v_6785 then
                                                    (
                                                        {8805}let pkDisco_6786: bitstring = pub(skA) in
                                                        {8806}in(c, (=pkCli_6784,m1_6787: bitstring));
                                                        {8807}let (SPc_6788: bitstring,PartC_6789: bitstring) = m1_6787 in
                                                        {8808}event endSrv(Cli_5168,Sess_5170,PartC_6789);
                                                        {8809}new Ns_6790: bitstring;
                                                        {8810}let gNs_6791: bitstring = exp(g,Ns_6790) in
                                                        {8811}let m2_6792: bitstring = gNs_6791 in
                                                        {8812}event beginSrv(Sess_5170,Cli_5168,gNs_6791);
                                                        {8813}out(c, m2_6792)
                                                    )
                                                    else
                                                        {8814}let v_6793: bool = (Disco_5169 = B) in
                                                        (
                                                            {8815}if v_6793 then
                                                            (
                                                                {8816}let pkDisco_6794: bitstring = pub(skB) in
                                                                {8817}in(c, (=pkCli_6784,m1_6795: bitstring));
                                                                {8818}let (SPc_6796: bitstring,PartC_6797: bitstring) = m1_6795 in
                                                                {8819}event endSrv(Cli_5168,Sess_5170,PartC_6797);
                                                                {8820}new Ns_6798: bitstring;
                                                                {8821}let gNs_6799: bitstring = exp(g,Ns_6798) in
                                                                {8822}let m2_6800: bitstring = gNs_6799 in
                                                                {8823}event beginSrv(Sess_5170,Cli_5168,gNs_6799);
                                                                {8824}out(c, m2_6800)
                                                            )
                                                            else
                                                                {8825}let v_6801: bool = (Disco_5169 = C) in
                                                                (
                                                                    {8826}if v_6801 then
                                                                    (
                                                                        {8827}let pkDisco_6802: bitstring = pub(skC) in
                                                                        {8828}in(c, (=pkCli_6784,m1_6803: bitstring));
                                                                        {8829}let (SPc_6804: bitstring,PartC_6805: bitstring) = m1_6803 in
                                                                        {8830}event endSrv(Cli_5168,Sess_5170,PartC_6805);
                                                                        {8831}new Ns_6806: bitstring;
                                                                        {8832}let gNs_6807: bitstring = exp(g,Ns_6806) in
                                                                        {8833}let m2_6808: bitstring = gNs_6807 in
                                                                        {8834}event beginSrv(Sess_5170,Cli_5168,gNs_6807);
                                                                        {8835}out(c, m2_6808)
                                                                    )
                                                                    else
                                                                        {8836}let pkDisco_6809: bitstring = pub(skI) in
                                                                        {8837}in(c, (=pkCli_6784,m1_6810: bitstring));
                                                                        {8838}let (SPc_6811: bitstring,PartC_6812: bitstring) = m1_6810 in
                                                                        {8839}event endSrv(Cli_5168,Sess_5170,PartC_6812);
                                                                        {8840}new Ns_6813: bitstring;
                                                                        {8841}let gNs_6814: bitstring = exp(g,Ns_6813) in
                                                                        {8842}let m2_6815: bitstring = gNs_6814 in
                                                                        {8843}event beginSrv(Sess_5170,Cli_5168,gNs_6814);
                                                                        {8844}out(c, m2_6815)
                                                                )
                                                                else
                                                                    {8845}let pkDisco_6816: bitstring = fail-any in
                                                                    {8846}in(c, (=pkCli_6784,m1_6817: bitstring));
                                                                    {8847}let (SPc_6818: bitstring,PartC_6819: bitstring) = m1_6817 in
                                                                    {8848}event endSrv(Cli_5168,Sess_5170,PartC_6819);
                                                                    {8849}new Ns_6820: bitstring;
                                                                    {8850}let gNs_6821: bitstring = exp(g,Ns_6820) in
                                                                    {8851}let m2_6822: bitstring = gNs_6821 in
                                                                    {8852}event beginSrv(Sess_5170,Cli_5168,gNs_6821);
                                                                    {8853}out(c, m2_6822)
                                                        )
                                                        else
                                                            {8854}let pkDisco_6823: bitstring = fail-any in
                                                            {8855}in(c, (=pkCli_6784,m1_6824: bitstring));
                                                            {8856}let (SPc_6825: bitstring,PartC_6826: bitstring) = m1_6824 in
                                                            {8857}event endSrv(Cli_5168,Sess_5170,PartC_6826);
                                                            {8858}new Ns_6827: bitstring;
                                                            {8859}let gNs_6828: bitstring = exp(g,Ns_6827) in
                                                            {8860}let m2_6829: bitstring = gNs_6828 in
                                                            {8861}event beginSrv(Sess_5170,Cli_5168,gNs_6828);
                                                            {8862}out(c, m2_6829)
                                                )
                                                else
                                                    {8863}let pkDisco_6830: bitstring = fail-any in
                                                    {8864}in(c, (=pkCli_6784,m1_6831: bitstring));
                                                    {8865}let (SPc_6832: bitstring,PartC_6833: bitstring) = m1_6831 in
                                                    {8866}event endSrv(Cli_5168,Sess_5170,PartC_6833);
                                                    {8867}new Ns_6834: bitstring;
                                                    {8868}let gNs_6835: bitstring = exp(g,Ns_6834) in
                                                    {8869}let m2_6836: bitstring = gNs_6835 in
                                                    {8870}event beginSrv(Sess_5170,Cli_5168,gNs_6835);
                                                    {8871}out(c, m2_6836)
                                            )
                                            else
                                                {8872}let pkCli_6837: bitstring = pub(skI) in
                                                {8873}let v_6838: bool = (Disco_5169 = A) in
                                                (
                                                    {8874}if v_6838 then
                                                    (
                                                        {8875}let pkDisco_6839: bitstring = pub(skA) in
                                                        {8876}in(c, (=pkCli_6837,m1_6840: bitstring));
                                                        {8877}let (SPc_6841: bitstring,PartC_6842: bitstring) = m1_6840 in
                                                        {8878}event endSrv(Cli_5168,Sess_5170,PartC_6842);
                                                        {8879}new Ns_6843: bitstring;
                                                        {8880}let gNs_6844: bitstring = exp(g,Ns_6843) in
                                                        {8881}let m2_6845: bitstring = gNs_6844 in
                                                        {8882}event beginSrv(Sess_5170,Cli_5168,gNs_6844);
                                                        {8883}out(c, m2_6845)
                                                    )
                                                    else
                                                        {8884}let v_6846: bool = (Disco_5169 = B) in
                                                        (
                                                            {8885}if v_6846 then
                                                            (
                                                                {8886}let pkDisco_6847: bitstring = pub(skB) in
                                                                {8887}in(c, (=pkCli_6837,m1_6848: bitstring));
                                                                {8888}let (SPc_6849: bitstring,PartC_6850: bitstring) = m1_6848 in
                                                                {8889}event endSrv(Cli_5168,Sess_5170,PartC_6850);
                                                                {8890}new Ns_6851: bitstring;
                                                                {8891}let gNs_6852: bitstring = exp(g,Ns_6851) in
                                                                {8892}let m2_6853: bitstring = gNs_6852 in
                                                                {8893}event beginSrv(Sess_5170,Cli_5168,gNs_6852);
                                                                {8894}out(c, m2_6853)
                                                            )
                                                            else
                                                                {8895}let v_6854: bool = (Disco_5169 = C) in
                                                                (
                                                                    {8896}if v_6854 then
                                                                    (
                                                                        {8897}let pkDisco_6855: bitstring = pub(skC) in
                                                                        {8898}in(c, (=pkCli_6837,m1_6856: bitstring));
                                                                        {8899}let (SPc_6857: bitstring,PartC_6858: bitstring) = m1_6856 in
                                                                        {8900}event endSrv(Cli_5168,Sess_5170,PartC_6858);
                                                                        {8901}new Ns_6859: bitstring;
                                                                        {8902}let gNs_6860: bitstring = exp(g,Ns_6859) in
                                                                        {8903}let m2_6861: bitstring = gNs_6860 in
                                                                        {8904}event beginSrv(Sess_5170,Cli_5168,gNs_6860);
                                                                        {8905}out(c, m2_6861)
                                                                    )
                                                                    else
                                                                        {8906}let pkDisco_6862: bitstring = pub(skI) in
                                                                        {8907}in(c, (=pkCli_6837,m1_6863: bitstring));
                                                                        {8908}let (SPc_6864: bitstring,PartC_6865: bitstring) = m1_6863 in
                                                                        {8909}event endSrv(Cli_5168,Sess_5170,PartC_6865);
                                                                        {8910}new Ns_6866: bitstring;
                                                                        {8911}let gNs_6867: bitstring = exp(g,Ns_6866) in
                                                                        {8912}let m2_6868: bitstring = gNs_6867 in
                                                                        {8913}event beginSrv(Sess_5170,Cli_5168,gNs_6867);
                                                                        {8914}out(c, m2_6868)
                                                                )
                                                                else
                                                                    {8915}let pkDisco_6869: bitstring = fail-any in
                                                                    {8916}in(c, (=pkCli_6837,m1_6870: bitstring));
                                                                    {8917}let (SPc_6871: bitstring,PartC_6872: bitstring) = m1_6870 in
                                                                    {8918}event endSrv(Cli_5168,Sess_5170,PartC_6872);
                                                                    {8919}new Ns_6873: bitstring;
                                                                    {8920}let gNs_6874: bitstring = exp(g,Ns_6873) in
                                                                    {8921}let m2_6875: bitstring = gNs_6874 in
                                                                    {8922}event beginSrv(Sess_5170,Cli_5168,gNs_6874);
                                                                    {8923}out(c, m2_6875)
                                                        )
                                                        else
                                                            {8924}let pkDisco_6876: bitstring = fail-any in
                                                            {8925}in(c, (=pkCli_6837,m1_6877: bitstring));
                                                            {8926}let (SPc_6878: bitstring,PartC_6879: bitstring) = m1_6877 in
                                                            {8927}event endSrv(Cli_5168,Sess_5170,PartC_6879);
                                                            {8928}new Ns_6880: bitstring;
                                                            {8929}let gNs_6881: bitstring = exp(g,Ns_6880) in
                                                            {8930}let m2_6882: bitstring = gNs_6881 in
                                                            {8931}event beginSrv(Sess_5170,Cli_5168,gNs_6881);
                                                            {8932}out(c, m2_6882)
                                                )
                                                else
                                                    {8933}let pkDisco_6883: bitstring = fail-any in
                                                    {8934}in(c, (=pkCli_6837,m1_6884: bitstring));
                                                    {8935}let (SPc_6885: bitstring,PartC_6886: bitstring) = m1_6884 in
                                                    {8936}event endSrv(Cli_5168,Sess_5170,PartC_6886);
                                                    {8937}new Ns_6887: bitstring;
                                                    {8938}let gNs_6888: bitstring = exp(g,Ns_6887) in
                                                    {8939}let m2_6889: bitstring = gNs_6888 in
                                                    {8940}event beginSrv(Sess_5170,Cli_5168,gNs_6888);
                                                    {8941}out(c, m2_6889)
                                        )
                                        else
                                            {8942}let pkCli_6890: bitstring = fail-any in
                                            {8943}let v_6891: bool = (Disco_5169 = A) in
                                            (
                                                {8944}if v_6891 then
                                                (
                                                    {8945}let pkDisco_6892: bitstring = pub(skA) in
                                                    {8946}in(c, (=pkCli_6890,m1_6893: bitstring));
                                                    {8947}let (SPc_6894: bitstring,PartC_6895: bitstring) = m1_6893 in
                                                    {8948}event endSrv(Cli_5168,Sess_5170,PartC_6895);
                                                    {8949}new Ns_6896: bitstring;
                                                    {8950}let gNs_6897: bitstring = exp(g,Ns_6896) in
                                                    {8951}let m2_6898: bitstring = gNs_6897 in
                                                    {8952}event beginSrv(Sess_5170,Cli_5168,gNs_6897);
                                                    {8953}out(c, m2_6898)
                                                )
                                                else
                                                    {8954}let v_6899: bool = (Disco_5169 = B) in
                                                    (
                                                        {8955}if v_6899 then
                                                        (
                                                            {8956}let pkDisco_6900: bitstring = pub(skB) in
                                                            {8957}in(c, (=pkCli_6890,m1_6901: bitstring));
                                                            {8958}let (SPc_6902: bitstring,PartC_6903: bitstring) = m1_6901 in
                                                            {8959}event endSrv(Cli_5168,Sess_5170,PartC_6903);
                                                            {8960}new Ns_6904: bitstring;
                                                            {8961}let gNs_6905: bitstring = exp(g,Ns_6904) in
                                                            {8962}let m2_6906: bitstring = gNs_6905 in
                                                            {8963}event beginSrv(Sess_5170,Cli_5168,gNs_6905);
                                                            {8964}out(c, m2_6906)
                                                        )
                                                        else
                                                            {8965}let v_6907: bool = (Disco_5169 = C) in
                                                            (
                                                                {8966}if v_6907 then
                                                                (
                                                                    {8967}let pkDisco_6908: bitstring = pub(skC) in
                                                                    {8968}in(c, (=pkCli_6890,m1_6909: bitstring));
                                                                    {8969}let (SPc_6910: bitstring,PartC_6911: bitstring) = m1_6909 in
                                                                    {8970}event endSrv(Cli_5168,Sess_5170,PartC_6911);
                                                                    {8971}new Ns_6912: bitstring;
                                                                    {8972}let gNs_6913: bitstring = exp(g,Ns_6912) in
                                                                    {8973}let m2_6914: bitstring = gNs_6913 in
                                                                    {8974}event beginSrv(Sess_5170,Cli_5168,gNs_6913);
                                                                    {8975}out(c, m2_6914)
                                                                )
                                                                else
                                                                    {8976}let pkDisco_6915: bitstring = pub(skI) in
                                                                    {8977}in(c, (=pkCli_6890,m1_6916: bitstring));
                                                                    {8978}let (SPc_6917: bitstring,PartC_6918: bitstring) = m1_6916 in
                                                                    {8979}event endSrv(Cli_5168,Sess_5170,PartC_6918);
                                                                    {8980}new Ns_6919: bitstring;
                                                                    {8981}let gNs_6920: bitstring = exp(g,Ns_6919) in
                                                                    {8982}let m2_6921: bitstring = gNs_6920 in
                                                                    {8983}event beginSrv(Sess_5170,Cli_5168,gNs_6920);
                                                                    {8984}out(c, m2_6921)
                                                            )
                                                            else
                                                                {8985}let pkDisco_6922: bitstring = fail-any in
                                                                {8986}in(c, (=pkCli_6890,m1_6923: bitstring));
                                                                {8987}let (SPc_6924: bitstring,PartC_6925: bitstring) = m1_6923 in
                                                                {8988}event endSrv(Cli_5168,Sess_5170,PartC_6925);
                                                                {8989}new Ns_6926: bitstring;
                                                                {8990}let gNs_6927: bitstring = exp(g,Ns_6926) in
                                                                {8991}let m2_6928: bitstring = gNs_6927 in
                                                                {8992}event beginSrv(Sess_5170,Cli_5168,gNs_6927);
                                                                {8993}out(c, m2_6928)
                                                    )
                                                    else
                                                        {8994}let pkDisco_6929: bitstring = fail-any in
                                                        {8995}in(c, (=pkCli_6890,m1_6930: bitstring));
                                                        {8996}let (SPc_6931: bitstring,PartC_6932: bitstring) = m1_6930 in
                                                        {8997}event endSrv(Cli_5168,Sess_5170,PartC_6932);
                                                        {8998}new Ns_6933: bitstring;
                                                        {8999}let gNs_6934: bitstring = exp(g,Ns_6933) in
                                                        {9000}let m2_6935: bitstring = gNs_6934 in
                                                        {9001}event beginSrv(Sess_5170,Cli_5168,gNs_6934);
                                                        {9002}out(c, m2_6935)
                                            )
                                            else
                                                {9003}let pkDisco_6936: bitstring = fail-any in
                                                {9004}in(c, (=pkCli_6890,m1_6937: bitstring));
                                                {9005}let (SPc_6938: bitstring,PartC_6939: bitstring) = m1_6937 in
                                                {9006}event endSrv(Cli_5168,Sess_5170,PartC_6939);
                                                {9007}new Ns_6940: bitstring;
                                                {9008}let gNs_6941: bitstring = exp(g,Ns_6940) in
                                                {9009}let m2_6942: bitstring = gNs_6941 in
                                                {9010}event beginSrv(Sess_5170,Cli_5168,gNs_6941);
                                                {9011}out(c, m2_6942)
                                )
                                else
                                    {9012}let pkCli_6943: bitstring = fail-any in
                                    {9013}let v_6944: bool = (Disco_5169 = A) in
                                    (
                                        {9014}if v_6944 then
                                        (
                                            {9015}let pkDisco_6945: bitstring = pub(skA) in
                                            {9016}in(c, (=pkCli_6943,m1_6946: bitstring));
                                            {9017}let (SPc_6947: bitstring,PartC_6948: bitstring) = m1_6946 in
                                            {9018}event endSrv(Cli_5168,Sess_5170,PartC_6948);
                                            {9019}new Ns_6949: bitstring;
                                            {9020}let gNs_6950: bitstring = exp(g,Ns_6949) in
                                            {9021}let m2_6951: bitstring = gNs_6950 in
                                            {9022}event beginSrv(Sess_5170,Cli_5168,gNs_6950);
                                            {9023}out(c, m2_6951)
                                        )
                                        else
                                            {9024}let v_6952: bool = (Disco_5169 = B) in
                                            (
                                                {9025}if v_6952 then
                                                (
                                                    {9026}let pkDisco_6953: bitstring = pub(skB) in
                                                    {9027}in(c, (=pkCli_6943,m1_6954: bitstring));
                                                    {9028}let (SPc_6955: bitstring,PartC_6956: bitstring) = m1_6954 in
                                                    {9029}event endSrv(Cli_5168,Sess_5170,PartC_6956);
                                                    {9030}new Ns_6957: bitstring;
                                                    {9031}let gNs_6958: bitstring = exp(g,Ns_6957) in
                                                    {9032}let m2_6959: bitstring = gNs_6958 in
                                                    {9033}event beginSrv(Sess_5170,Cli_5168,gNs_6958);
                                                    {9034}out(c, m2_6959)
                                                )
                                                else
                                                    {9035}let v_6960: bool = (Disco_5169 = C) in
                                                    (
                                                        {9036}if v_6960 then
                                                        (
                                                            {9037}let pkDisco_6961: bitstring = pub(skC) in
                                                            {9038}in(c, (=pkCli_6943,m1_6962: bitstring));
                                                            {9039}let (SPc_6963: bitstring,PartC_6964: bitstring) = m1_6962 in
                                                            {9040}event endSrv(Cli_5168,Sess_5170,PartC_6964);
                                                            {9041}new Ns_6965: bitstring;
                                                            {9042}let gNs_6966: bitstring = exp(g,Ns_6965) in
                                                            {9043}let m2_6967: bitstring = gNs_6966 in
                                                            {9044}event beginSrv(Sess_5170,Cli_5168,gNs_6966);
                                                            {9045}out(c, m2_6967)
                                                        )
                                                        else
                                                            {9046}let pkDisco_6968: bitstring = pub(skI) in
                                                            {9047}in(c, (=pkCli_6943,m1_6969: bitstring));
                                                            {9048}let (SPc_6970: bitstring,PartC_6971: bitstring) = m1_6969 in
                                                            {9049}event endSrv(Cli_5168,Sess_5170,PartC_6971);
                                                            {9050}new Ns_6972: bitstring;
                                                            {9051}let gNs_6973: bitstring = exp(g,Ns_6972) in
                                                            {9052}let m2_6974: bitstring = gNs_6973 in
                                                            {9053}event beginSrv(Sess_5170,Cli_5168,gNs_6973);
                                                            {9054}out(c, m2_6974)
                                                    )
                                                    else
                                                        {9055}let pkDisco_6975: bitstring = fail-any in
                                                        {9056}in(c, (=pkCli_6943,m1_6976: bitstring));
                                                        {9057}let (SPc_6977: bitstring,PartC_6978: bitstring) = m1_6976 in
                                                        {9058}event endSrv(Cli_5168,Sess_5170,PartC_6978);
                                                        {9059}new Ns_6979: bitstring;
                                                        {9060}let gNs_6980: bitstring = exp(g,Ns_6979) in
                                                        {9061}let m2_6981: bitstring = gNs_6980 in
                                                        {9062}event beginSrv(Sess_5170,Cli_5168,gNs_6980);
                                                        {9063}out(c, m2_6981)
                                            )
                                            else
                                                {9064}let pkDisco_6982: bitstring = fail-any in
                                                {9065}in(c, (=pkCli_6943,m1_6983: bitstring));
                                                {9066}let (SPc_6984: bitstring,PartC_6985: bitstring) = m1_6983 in
                                                {9067}event endSrv(Cli_5168,Sess_5170,PartC_6985);
                                                {9068}new Ns_6986: bitstring;
                                                {9069}let gNs_6987: bitstring = exp(g,Ns_6986) in
                                                {9070}let m2_6988: bitstring = gNs_6987 in
                                                {9071}event beginSrv(Sess_5170,Cli_5168,gNs_6987);
                                                {9072}out(c, m2_6988)
                                    )
                                    else
                                        {9073}let pkDisco_6989: bitstring = fail-any in
                                        {9074}in(c, (=pkCli_6943,m1_6990: bitstring));
                                        {9075}let (SPc_6991: bitstring,PartC_6992: bitstring) = m1_6990 in
                                        {9076}event endSrv(Cli_5168,Sess_5170,PartC_6992);
                                        {9077}new Ns_6993: bitstring;
                                        {9078}let gNs_6994: bitstring = exp(g,Ns_6993) in
                                        {9079}let m2_6995: bitstring = gNs_6994 in
                                        {9080}event beginSrv(Sess_5170,Cli_5168,gNs_6994);
                                        {9081}out(c, m2_6995)
                        )
                        else
                            {9082}let pkCli_6996: bitstring = fail-any in
                            {9083}let v_6997: bool = (Disco_5169 = A) in
                            (
                                {9084}if v_6997 then
                                (
                                    {9085}let pkDisco_6998: bitstring = pub(skA) in
                                    {9086}in(c, (=pkCli_6996,m1_6999: bitstring));
                                    {9087}let (SPc_7000: bitstring,PartC_7001: bitstring) = m1_6999 in
                                    {9088}event endSrv(Cli_5168,Sess_5170,PartC_7001);
                                    {9089}new Ns_7002: bitstring;
                                    {9090}let gNs_7003: bitstring = exp(g,Ns_7002) in
                                    {9091}let m2_7004: bitstring = gNs_7003 in
                                    {9092}event beginSrv(Sess_5170,Cli_5168,gNs_7003);
                                    {9093}out(c, m2_7004)
                                )
                                else
                                    {9094}let v_7005: bool = (Disco_5169 = B) in
                                    (
                                        {9095}if v_7005 then
                                        (
                                            {9096}let pkDisco_7006: bitstring = pub(skB) in
                                            {9097}in(c, (=pkCli_6996,m1_7007: bitstring));
                                            {9098}let (SPc_7008: bitstring,PartC_7009: bitstring) = m1_7007 in
                                            {9099}event endSrv(Cli_5168,Sess_5170,PartC_7009);
                                            {9100}new Ns_7010: bitstring;
                                            {9101}let gNs_7011: bitstring = exp(g,Ns_7010) in
                                            {9102}let m2_7012: bitstring = gNs_7011 in
                                            {9103}event beginSrv(Sess_5170,Cli_5168,gNs_7011);
                                            {9104}out(c, m2_7012)
                                        )
                                        else
                                            {9105}let v_7013: bool = (Disco_5169 = C) in
                                            (
                                                {9106}if v_7013 then
                                                (
                                                    {9107}let pkDisco_7014: bitstring = pub(skC) in
                                                    {9108}in(c, (=pkCli_6996,m1_7015: bitstring));
                                                    {9109}let (SPc_7016: bitstring,PartC_7017: bitstring) = m1_7015 in
                                                    {9110}event endSrv(Cli_5168,Sess_5170,PartC_7017);
                                                    {9111}new Ns_7018: bitstring;
                                                    {9112}let gNs_7019: bitstring = exp(g,Ns_7018) in
                                                    {9113}let m2_7020: bitstring = gNs_7019 in
                                                    {9114}event beginSrv(Sess_5170,Cli_5168,gNs_7019);
                                                    {9115}out(c, m2_7020)
                                                )
                                                else
                                                    {9116}let pkDisco_7021: bitstring = pub(skI) in
                                                    {9117}in(c, (=pkCli_6996,m1_7022: bitstring));
                                                    {9118}let (SPc_7023: bitstring,PartC_7024: bitstring) = m1_7022 in
                                                    {9119}event endSrv(Cli_5168,Sess_5170,PartC_7024);
                                                    {9120}new Ns_7025: bitstring;
                                                    {9121}let gNs_7026: bitstring = exp(g,Ns_7025) in
                                                    {9122}let m2_7027: bitstring = gNs_7026 in
                                                    {9123}event beginSrv(Sess_5170,Cli_5168,gNs_7026);
                                                    {9124}out(c, m2_7027)
                                            )
                                            else
                                                {9125}let pkDisco_7028: bitstring = fail-any in
                                                {9126}in(c, (=pkCli_6996,m1_7029: bitstring));
                                                {9127}let (SPc_7030: bitstring,PartC_7031: bitstring) = m1_7029 in
                                                {9128}event endSrv(Cli_5168,Sess_5170,PartC_7031);
                                                {9129}new Ns_7032: bitstring;
                                                {9130}let gNs_7033: bitstring = exp(g,Ns_7032) in
                                                {9131}let m2_7034: bitstring = gNs_7033 in
                                                {9132}event beginSrv(Sess_5170,Cli_5168,gNs_7033);
                                                {9133}out(c, m2_7034)
                                    )
                                    else
                                        {9134}let pkDisco_7035: bitstring = fail-any in
                                        {9135}in(c, (=pkCli_6996,m1_7036: bitstring));
                                        {9136}let (SPc_7037: bitstring,PartC_7038: bitstring) = m1_7036 in
                                        {9137}event endSrv(Cli_5168,Sess_5170,PartC_7038);
                                        {9138}new Ns_7039: bitstring;
                                        {9139}let gNs_7040: bitstring = exp(g,Ns_7039) in
                                        {9140}let m2_7041: bitstring = gNs_7040 in
                                        {9141}event beginSrv(Sess_5170,Cli_5168,gNs_7040);
                                        {9142}out(c, m2_7041)
                            )
                            else
                                {9143}let pkDisco_7042: bitstring = fail-any in
                                {9144}in(c, (=pkCli_6996,m1_7043: bitstring));
                                {9145}let (SPc_7044: bitstring,PartC_7045: bitstring) = m1_7043 in
                                {9146}event endSrv(Cli_5168,Sess_5170,PartC_7045);
                                {9147}new Ns_7046: bitstring;
                                {9148}let gNs_7047: bitstring = exp(g,Ns_7046) in
                                {9149}let m2_7048: bitstring = gNs_7047 in
                                {9150}event beginSrv(Sess_5170,Cli_5168,gNs_7047);
                                {9151}out(c, m2_7048)
            )
            else
                {9152}let skSess_7049: bitstring = fail-any in
                {9153}let pkSess_7050: bitstring = pub(skSess_7049) in
                {9154}let v_7051: bool = (Cli_5168 = A) in
                (
                    {9155}if v_7051 then
                    (
                        {9156}let pkCli_7052: bitstring = pub(skA) in
                        {9157}let v_7053: bool = (Disco_5169 = A) in
                        (
                            {9158}if v_7053 then
                            (
                                {9159}let pkDisco_7054: bitstring = pub(skA) in
                                {9160}in(c, (=pkCli_7052,m1_7055: bitstring));
                                {9161}let (SPc_7056: bitstring,PartC_7057: bitstring) = m1_7055 in
                                {9162}event endSrv(Cli_5168,Sess_5170,PartC_7057);
                                {9163}new Ns_7058: bitstring;
                                {9164}let gNs_7059: bitstring = exp(g,Ns_7058) in
                                {9165}let m2_7060: bitstring = gNs_7059 in
                                {9166}event beginSrv(Sess_5170,Cli_5168,gNs_7059);
                                {9167}out(c, m2_7060)
                            )
                            else
                                {9168}let v_7061: bool = (Disco_5169 = B) in
                                (
                                    {9169}if v_7061 then
                                    (
                                        {9170}let pkDisco_7062: bitstring = pub(skB) in
                                        {9171}in(c, (=pkCli_7052,m1_7063: bitstring));
                                        {9172}let (SPc_7064: bitstring,PartC_7065: bitstring) = m1_7063 in
                                        {9173}event endSrv(Cli_5168,Sess_5170,PartC_7065);
                                        {9174}new Ns_7066: bitstring;
                                        {9175}let gNs_7067: bitstring = exp(g,Ns_7066) in
                                        {9176}let m2_7068: bitstring = gNs_7067 in
                                        {9177}event beginSrv(Sess_5170,Cli_5168,gNs_7067);
                                        {9178}out(c, m2_7068)
                                    )
                                    else
                                        {9179}let v_7069: bool = (Disco_5169 = C) in
                                        (
                                            {9180}if v_7069 then
                                            (
                                                {9181}let pkDisco_7070: bitstring = pub(skC) in
                                                {9182}in(c, (=pkCli_7052,m1_7071: bitstring));
                                                {9183}let (SPc_7072: bitstring,PartC_7073: bitstring) = m1_7071 in
                                                {9184}event endSrv(Cli_5168,Sess_5170,PartC_7073);
                                                {9185}new Ns_7074: bitstring;
                                                {9186}let gNs_7075: bitstring = exp(g,Ns_7074) in
                                                {9187}let m2_7076: bitstring = gNs_7075 in
                                                {9188}event beginSrv(Sess_5170,Cli_5168,gNs_7075);
                                                {9189}out(c, m2_7076)
                                            )
                                            else
                                                {9190}let pkDisco_7077: bitstring = pub(skI) in
                                                {9191}in(c, (=pkCli_7052,m1_7078: bitstring));
                                                {9192}let (SPc_7079: bitstring,PartC_7080: bitstring) = m1_7078 in
                                                {9193}event endSrv(Cli_5168,Sess_5170,PartC_7080);
                                                {9194}new Ns_7081: bitstring;
                                                {9195}let gNs_7082: bitstring = exp(g,Ns_7081) in
                                                {9196}let m2_7083: bitstring = gNs_7082 in
                                                {9197}event beginSrv(Sess_5170,Cli_5168,gNs_7082);
                                                {9198}out(c, m2_7083)
                                        )
                                        else
                                            {9199}let pkDisco_7084: bitstring = fail-any in
                                            {9200}in(c, (=pkCli_7052,m1_7085: bitstring));
                                            {9201}let (SPc_7086: bitstring,PartC_7087: bitstring) = m1_7085 in
                                            {9202}event endSrv(Cli_5168,Sess_5170,PartC_7087);
                                            {9203}new Ns_7088: bitstring;
                                            {9204}let gNs_7089: bitstring = exp(g,Ns_7088) in
                                            {9205}let m2_7090: bitstring = gNs_7089 in
                                            {9206}event beginSrv(Sess_5170,Cli_5168,gNs_7089);
                                            {9207}out(c, m2_7090)
                                )
                                else
                                    {9208}let pkDisco_7091: bitstring = fail-any in
                                    {9209}in(c, (=pkCli_7052,m1_7092: bitstring));
                                    {9210}let (SPc_7093: bitstring,PartC_7094: bitstring) = m1_7092 in
                                    {9211}event endSrv(Cli_5168,Sess_5170,PartC_7094);
                                    {9212}new Ns_7095: bitstring;
                                    {9213}let gNs_7096: bitstring = exp(g,Ns_7095) in
                                    {9214}let m2_7097: bitstring = gNs_7096 in
                                    {9215}event beginSrv(Sess_5170,Cli_5168,gNs_7096);
                                    {9216}out(c, m2_7097)
                        )
                        else
                            {9217}let pkDisco_7098: bitstring = fail-any in
                            {9218}in(c, (=pkCli_7052,m1_7099: bitstring));
                            {9219}let (SPc_7100: bitstring,PartC_7101: bitstring) = m1_7099 in
                            {9220}event endSrv(Cli_5168,Sess_5170,PartC_7101);
                            {9221}new Ns_7102: bitstring;
                            {9222}let gNs_7103: bitstring = exp(g,Ns_7102) in
                            {9223}let m2_7104: bitstring = gNs_7103 in
                            {9224}event beginSrv(Sess_5170,Cli_5168,gNs_7103);
                            {9225}out(c, m2_7104)
                    )
                    else
                        {9226}let v_7105: bool = (Cli_5168 = B) in
                        (
                            {9227}if v_7105 then
                            (
                                {9228}let pkCli_7106: bitstring = pub(skB) in
                                {9229}let v_7107: bool = (Disco_5169 = A) in
                                (
                                    {9230}if v_7107 then
                                    (
                                        {9231}let pkDisco_7108: bitstring = pub(skA) in
                                        {9232}in(c, (=pkCli_7106,m1_7109: bitstring));
                                        {9233}let (SPc_7110: bitstring,PartC_7111: bitstring) = m1_7109 in
                                        {9234}event endSrv(Cli_5168,Sess_5170,PartC_7111);
                                        {9235}new Ns_7112: bitstring;
                                        {9236}let gNs_7113: bitstring = exp(g,Ns_7112) in
                                        {9237}let m2_7114: bitstring = gNs_7113 in
                                        {9238}event beginSrv(Sess_5170,Cli_5168,gNs_7113);
                                        {9239}out(c, m2_7114)
                                    )
                                    else
                                        {9240}let v_7115: bool = (Disco_5169 = B) in
                                        (
                                            {9241}if v_7115 then
                                            (
                                                {9242}let pkDisco_7116: bitstring = pub(skB) in
                                                {9243}in(c, (=pkCli_7106,m1_7117: bitstring));
                                                {9244}let (SPc_7118: bitstring,PartC_7119: bitstring) = m1_7117 in
                                                {9245}event endSrv(Cli_5168,Sess_5170,PartC_7119);
                                                {9246}new Ns_7120: bitstring;
                                                {9247}let gNs_7121: bitstring = exp(g,Ns_7120) in
                                                {9248}let m2_7122: bitstring = gNs_7121 in
                                                {9249}event beginSrv(Sess_5170,Cli_5168,gNs_7121);
                                                {9250}out(c, m2_7122)
                                            )
                                            else
                                                {9251}let v_7123: bool = (Disco_5169 = C) in
                                                (
                                                    {9252}if v_7123 then
                                                    (
                                                        {9253}let pkDisco_7124: bitstring = pub(skC) in
                                                        {9254}in(c, (=pkCli_7106,m1_7125: bitstring));
                                                        {9255}let (SPc_7126: bitstring,PartC_7127: bitstring) = m1_7125 in
                                                        {9256}event endSrv(Cli_5168,Sess_5170,PartC_7127);
                                                        {9257}new Ns_7128: bitstring;
                                                        {9258}let gNs_7129: bitstring = exp(g,Ns_7128) in
                                                        {9259}let m2_7130: bitstring = gNs_7129 in
                                                        {9260}event beginSrv(Sess_5170,Cli_5168,gNs_7129);
                                                        {9261}out(c, m2_7130)
                                                    )
                                                    else
                                                        {9262}let pkDisco_7131: bitstring = pub(skI) in
                                                        {9263}in(c, (=pkCli_7106,m1_7132: bitstring));
                                                        {9264}let (SPc_7133: bitstring,PartC_7134: bitstring) = m1_7132 in
                                                        {9265}event endSrv(Cli_5168,Sess_5170,PartC_7134);
                                                        {9266}new Ns_7135: bitstring;
                                                        {9267}let gNs_7136: bitstring = exp(g,Ns_7135) in
                                                        {9268}let m2_7137: bitstring = gNs_7136 in
                                                        {9269}event beginSrv(Sess_5170,Cli_5168,gNs_7136);
                                                        {9270}out(c, m2_7137)
                                                )
                                                else
                                                    {9271}let pkDisco_7138: bitstring = fail-any in
                                                    {9272}in(c, (=pkCli_7106,m1_7139: bitstring));
                                                    {9273}let (SPc_7140: bitstring,PartC_7141: bitstring) = m1_7139 in
                                                    {9274}event endSrv(Cli_5168,Sess_5170,PartC_7141);
                                                    {9275}new Ns_7142: bitstring;
                                                    {9276}let gNs_7143: bitstring = exp(g,Ns_7142) in
                                                    {9277}let m2_7144: bitstring = gNs_7143 in
                                                    {9278}event beginSrv(Sess_5170,Cli_5168,gNs_7143);
                                                    {9279}out(c, m2_7144)
                                        )
                                        else
                                            {9280}let pkDisco_7145: bitstring = fail-any in
                                            {9281}in(c, (=pkCli_7106,m1_7146: bitstring));
                                            {9282}let (SPc_7147: bitstring,PartC_7148: bitstring) = m1_7146 in
                                            {9283}event endSrv(Cli_5168,Sess_5170,PartC_7148);
                                            {9284}new Ns_7149: bitstring;
                                            {9285}let gNs_7150: bitstring = exp(g,Ns_7149) in
                                            {9286}let m2_7151: bitstring = gNs_7150 in
                                            {9287}event beginSrv(Sess_5170,Cli_5168,gNs_7150);
                                            {9288}out(c, m2_7151)
                                )
                                else
                                    {9289}let pkDisco_7152: bitstring = fail-any in
                                    {9290}in(c, (=pkCli_7106,m1_7153: bitstring));
                                    {9291}let (SPc_7154: bitstring,PartC_7155: bitstring) = m1_7153 in
                                    {9292}event endSrv(Cli_5168,Sess_5170,PartC_7155);
                                    {9293}new Ns_7156: bitstring;
                                    {9294}let gNs_7157: bitstring = exp(g,Ns_7156) in
                                    {9295}let m2_7158: bitstring = gNs_7157 in
                                    {9296}event beginSrv(Sess_5170,Cli_5168,gNs_7157);
                                    {9297}out(c, m2_7158)
                            )
                            else
                                {9298}let v_7159: bool = (Cli_5168 = C) in
                                (
                                    {9299}if v_7159 then
                                    (
                                        {9300}let pkCli_7160: bitstring = pub(skC) in
                                        {9301}let v_7161: bool = (Disco_5169 = A) in
                                        (
                                            {9302}if v_7161 then
                                            (
                                                {9303}let pkDisco_7162: bitstring = pub(skA) in
                                                {9304}in(c, (=pkCli_7160,m1_7163: bitstring));
                                                {9305}let (SPc_7164: bitstring,PartC_7165: bitstring) = m1_7163 in
                                                {9306}event endSrv(Cli_5168,Sess_5170,PartC_7165);
                                                {9307}new Ns_7166: bitstring;
                                                {9308}let gNs_7167: bitstring = exp(g,Ns_7166) in
                                                {9309}let m2_7168: bitstring = gNs_7167 in
                                                {9310}event beginSrv(Sess_5170,Cli_5168,gNs_7167);
                                                {9311}out(c, m2_7168)
                                            )
                                            else
                                                {9312}let v_7169: bool = (Disco_5169 = B) in
                                                (
                                                    {9313}if v_7169 then
                                                    (
                                                        {9314}let pkDisco_7170: bitstring = pub(skB) in
                                                        {9315}in(c, (=pkCli_7160,m1_7171: bitstring));
                                                        {9316}let (SPc_7172: bitstring,PartC_7173: bitstring) = m1_7171 in
                                                        {9317}event endSrv(Cli_5168,Sess_5170,PartC_7173);
                                                        {9318}new Ns_7174: bitstring;
                                                        {9319}let gNs_7175: bitstring = exp(g,Ns_7174) in
                                                        {9320}let m2_7176: bitstring = gNs_7175 in
                                                        {9321}event beginSrv(Sess_5170,Cli_5168,gNs_7175);
                                                        {9322}out(c, m2_7176)
                                                    )
                                                    else
                                                        {9323}let v_7177: bool = (Disco_5169 = C) in
                                                        (
                                                            {9324}if v_7177 then
                                                            (
                                                                {9325}let pkDisco_7178: bitstring = pub(skC) in
                                                                {9326}in(c, (=pkCli_7160,m1_7179: bitstring));
                                                                {9327}let (SPc_7180: bitstring,PartC_7181: bitstring) = m1_7179 in
                                                                {9328}event endSrv(Cli_5168,Sess_5170,PartC_7181);
                                                                {9329}new Ns_7182: bitstring;
                                                                {9330}let gNs_7183: bitstring = exp(g,Ns_7182) in
                                                                {9331}let m2_7184: bitstring = gNs_7183 in
                                                                {9332}event beginSrv(Sess_5170,Cli_5168,gNs_7183);
                                                                {9333}out(c, m2_7184)
                                                            )
                                                            else
                                                                {9334}let pkDisco_7185: bitstring = pub(skI) in
                                                                {9335}in(c, (=pkCli_7160,m1_7186: bitstring));
                                                                {9336}let (SPc_7187: bitstring,PartC_7188: bitstring) = m1_7186 in
                                                                {9337}event endSrv(Cli_5168,Sess_5170,PartC_7188);
                                                                {9338}new Ns_7189: bitstring;
                                                                {9339}let gNs_7190: bitstring = exp(g,Ns_7189) in
                                                                {9340}let m2_7191: bitstring = gNs_7190 in
                                                                {9341}event beginSrv(Sess_5170,Cli_5168,gNs_7190);
                                                                {9342}out(c, m2_7191)
                                                        )
                                                        else
                                                            {9343}let pkDisco_7192: bitstring = fail-any in
                                                            {9344}in(c, (=pkCli_7160,m1_7193: bitstring));
                                                            {9345}let (SPc_7194: bitstring,PartC_7195: bitstring) = m1_7193 in
                                                            {9346}event endSrv(Cli_5168,Sess_5170,PartC_7195);
                                                            {9347}new Ns_7196: bitstring;
                                                            {9348}let gNs_7197: bitstring = exp(g,Ns_7196) in
                                                            {9349}let m2_7198: bitstring = gNs_7197 in
                                                            {9350}event beginSrv(Sess_5170,Cli_5168,gNs_7197);
                                                            {9351}out(c, m2_7198)
                                                )
                                                else
                                                    {9352}let pkDisco_7199: bitstring = fail-any in
                                                    {9353}in(c, (=pkCli_7160,m1_7200: bitstring));
                                                    {9354}let (SPc_7201: bitstring,PartC_7202: bitstring) = m1_7200 in
                                                    {9355}event endSrv(Cli_5168,Sess_5170,PartC_7202);
                                                    {9356}new Ns_7203: bitstring;
                                                    {9357}let gNs_7204: bitstring = exp(g,Ns_7203) in
                                                    {9358}let m2_7205: bitstring = gNs_7204 in
                                                    {9359}event beginSrv(Sess_5170,Cli_5168,gNs_7204);
                                                    {9360}out(c, m2_7205)
                                        )
                                        else
                                            {9361}let pkDisco_7206: bitstring = fail-any in
                                            {9362}in(c, (=pkCli_7160,m1_7207: bitstring));
                                            {9363}let (SPc_7208: bitstring,PartC_7209: bitstring) = m1_7207 in
                                            {9364}event endSrv(Cli_5168,Sess_5170,PartC_7209);
                                            {9365}new Ns_7210: bitstring;
                                            {9366}let gNs_7211: bitstring = exp(g,Ns_7210) in
                                            {9367}let m2_7212: bitstring = gNs_7211 in
                                            {9368}event beginSrv(Sess_5170,Cli_5168,gNs_7211);
                                            {9369}out(c, m2_7212)
                                    )
                                    else
                                        {9370}let pkCli_7213: bitstring = pub(skI) in
                                        {9371}let v_7214: bool = (Disco_5169 = A) in
                                        (
                                            {9372}if v_7214 then
                                            (
                                                {9373}let pkDisco_7215: bitstring = pub(skA) in
                                                {9374}in(c, (=pkCli_7213,m1_7216: bitstring));
                                                {9375}let (SPc_7217: bitstring,PartC_7218: bitstring) = m1_7216 in
                                                {9376}event endSrv(Cli_5168,Sess_5170,PartC_7218);
                                                {9377}new Ns_7219: bitstring;
                                                {9378}let gNs_7220: bitstring = exp(g,Ns_7219) in
                                                {9379}let m2_7221: bitstring = gNs_7220 in
                                                {9380}event beginSrv(Sess_5170,Cli_5168,gNs_7220);
                                                {9381}out(c, m2_7221)
                                            )
                                            else
                                                {9382}let v_7222: bool = (Disco_5169 = B) in
                                                (
                                                    {9383}if v_7222 then
                                                    (
                                                        {9384}let pkDisco_7223: bitstring = pub(skB) in
                                                        {9385}in(c, (=pkCli_7213,m1_7224: bitstring));
                                                        {9386}let (SPc_7225: bitstring,PartC_7226: bitstring) = m1_7224 in
                                                        {9387}event endSrv(Cli_5168,Sess_5170,PartC_7226);
                                                        {9388}new Ns_7227: bitstring;
                                                        {9389}let gNs_7228: bitstring = exp(g,Ns_7227) in
                                                        {9390}let m2_7229: bitstring = gNs_7228 in
                                                        {9391}event beginSrv(Sess_5170,Cli_5168,gNs_7228);
                                                        {9392}out(c, m2_7229)
                                                    )
                                                    else
                                                        {9393}let v_7230: bool = (Disco_5169 = C) in
                                                        (
                                                            {9394}if v_7230 then
                                                            (
                                                                {9395}let pkDisco_7231: bitstring = pub(skC) in
                                                                {9396}in(c, (=pkCli_7213,m1_7232: bitstring));
                                                                {9397}let (SPc_7233: bitstring,PartC_7234: bitstring) = m1_7232 in
                                                                {9398}event endSrv(Cli_5168,Sess_5170,PartC_7234);
                                                                {9399}new Ns_7235: bitstring;
                                                                {9400}let gNs_7236: bitstring = exp(g,Ns_7235) in
                                                                {9401}let m2_7237: bitstring = gNs_7236 in
                                                                {9402}event beginSrv(Sess_5170,Cli_5168,gNs_7236);
                                                                {9403}out(c, m2_7237)
                                                            )
                                                            else
                                                                {9404}let pkDisco_7238: bitstring = pub(skI) in
                                                                {9405}in(c, (=pkCli_7213,m1_7239: bitstring));
                                                                {9406}let (SPc_7240: bitstring,PartC_7241: bitstring) = m1_7239 in
                                                                {9407}event endSrv(Cli_5168,Sess_5170,PartC_7241);
                                                                {9408}new Ns_7242: bitstring;
                                                                {9409}let gNs_7243: bitstring = exp(g,Ns_7242) in
                                                                {9410}let m2_7244: bitstring = gNs_7243 in
                                                                {9411}event beginSrv(Sess_5170,Cli_5168,gNs_7243);
                                                                {9412}out(c, m2_7244)
                                                        )
                                                        else
                                                            {9413}let pkDisco_7245: bitstring = fail-any in
                                                            {9414}in(c, (=pkCli_7213,m1_7246: bitstring));
                                                            {9415}let (SPc_7247: bitstring,PartC_7248: bitstring) = m1_7246 in
                                                            {9416}event endSrv(Cli_5168,Sess_5170,PartC_7248);
                                                            {9417}new Ns_7249: bitstring;
                                                            {9418}let gNs_7250: bitstring = exp(g,Ns_7249) in
                                                            {9419}let m2_7251: bitstring = gNs_7250 in
                                                            {9420}event beginSrv(Sess_5170,Cli_5168,gNs_7250);
                                                            {9421}out(c, m2_7251)
                                                )
                                                else
                                                    {9422}let pkDisco_7252: bitstring = fail-any in
                                                    {9423}in(c, (=pkCli_7213,m1_7253: bitstring));
                                                    {9424}let (SPc_7254: bitstring,PartC_7255: bitstring) = m1_7253 in
                                                    {9425}event endSrv(Cli_5168,Sess_5170,PartC_7255);
                                                    {9426}new Ns_7256: bitstring;
                                                    {9427}let gNs_7257: bitstring = exp(g,Ns_7256) in
                                                    {9428}let m2_7258: bitstring = gNs_7257 in
                                                    {9429}event beginSrv(Sess_5170,Cli_5168,gNs_7257);
                                                    {9430}out(c, m2_7258)
                                        )
                                        else
                                            {9431}let pkDisco_7259: bitstring = fail-any in
                                            {9432}in(c, (=pkCli_7213,m1_7260: bitstring));
                                            {9433}let (SPc_7261: bitstring,PartC_7262: bitstring) = m1_7260 in
                                            {9434}event endSrv(Cli_5168,Sess_5170,PartC_7262);
                                            {9435}new Ns_7263: bitstring;
                                            {9436}let gNs_7264: bitstring = exp(g,Ns_7263) in
                                            {9437}let m2_7265: bitstring = gNs_7264 in
                                            {9438}event beginSrv(Sess_5170,Cli_5168,gNs_7264);
                                            {9439}out(c, m2_7265)
                                )
                                else
                                    {9440}let pkCli_7266: bitstring = fail-any in
                                    {9441}let v_7267: bool = (Disco_5169 = A) in
                                    (
                                        {9442}if v_7267 then
                                        (
                                            {9443}let pkDisco_7268: bitstring = pub(skA) in
                                            {9444}in(c, (=pkCli_7266,m1_7269: bitstring));
                                            {9445}let (SPc_7270: bitstring,PartC_7271: bitstring) = m1_7269 in
                                            {9446}event endSrv(Cli_5168,Sess_5170,PartC_7271);
                                            {9447}new Ns_7272: bitstring;
                                            {9448}let gNs_7273: bitstring = exp(g,Ns_7272) in
                                            {9449}let m2_7274: bitstring = gNs_7273 in
                                            {9450}event beginSrv(Sess_5170,Cli_5168,gNs_7273);
                                            {9451}out(c, m2_7274)
                                        )
                                        else
                                            {9452}let v_7275: bool = (Disco_5169 = B) in
                                            (
                                                {9453}if v_7275 then
                                                (
                                                    {9454}let pkDisco_7276: bitstring = pub(skB) in
                                                    {9455}in(c, (=pkCli_7266,m1_7277: bitstring));
                                                    {9456}let (SPc_7278: bitstring,PartC_7279: bitstring) = m1_7277 in
                                                    {9457}event endSrv(Cli_5168,Sess_5170,PartC_7279);
                                                    {9458}new Ns_7280: bitstring;
                                                    {9459}let gNs_7281: bitstring = exp(g,Ns_7280) in
                                                    {9460}let m2_7282: bitstring = gNs_7281 in
                                                    {9461}event beginSrv(Sess_5170,Cli_5168,gNs_7281);
                                                    {9462}out(c, m2_7282)
                                                )
                                                else
                                                    {9463}let v_7283: bool = (Disco_5169 = C) in
                                                    (
                                                        {9464}if v_7283 then
                                                        (
                                                            {9465}let pkDisco_7284: bitstring = pub(skC) in
                                                            {9466}in(c, (=pkCli_7266,m1_7285: bitstring));
                                                            {9467}let (SPc_7286: bitstring,PartC_7287: bitstring) = m1_7285 in
                                                            {9468}event endSrv(Cli_5168,Sess_5170,PartC_7287);
                                                            {9469}new Ns_7288: bitstring;
                                                            {9470}let gNs_7289: bitstring = exp(g,Ns_7288) in
                                                            {9471}let m2_7290: bitstring = gNs_7289 in
                                                            {9472}event beginSrv(Sess_5170,Cli_5168,gNs_7289);
                                                            {9473}out(c, m2_7290)
                                                        )
                                                        else
                                                            {9474}let pkDisco_7291: bitstring = pub(skI) in
                                                            {9475}in(c, (=pkCli_7266,m1_7292: bitstring));
                                                            {9476}let (SPc_7293: bitstring,PartC_7294: bitstring) = m1_7292 in
                                                            {9477}event endSrv(Cli_5168,Sess_5170,PartC_7294);
                                                            {9478}new Ns_7295: bitstring;
                                                            {9479}let gNs_7296: bitstring = exp(g,Ns_7295) in
                                                            {9480}let m2_7297: bitstring = gNs_7296 in
                                                            {9481}event beginSrv(Sess_5170,Cli_5168,gNs_7296);
                                                            {9482}out(c, m2_7297)
                                                    )
                                                    else
                                                        {9483}let pkDisco_7298: bitstring = fail-any in
                                                        {9484}in(c, (=pkCli_7266,m1_7299: bitstring));
                                                        {9485}let (SPc_7300: bitstring,PartC_7301: bitstring) = m1_7299 in
                                                        {9486}event endSrv(Cli_5168,Sess_5170,PartC_7301);
                                                        {9487}new Ns_7302: bitstring;
                                                        {9488}let gNs_7303: bitstring = exp(g,Ns_7302) in
                                                        {9489}let m2_7304: bitstring = gNs_7303 in
                                                        {9490}event beginSrv(Sess_5170,Cli_5168,gNs_7303);
                                                        {9491}out(c, m2_7304)
                                            )
                                            else
                                                {9492}let pkDisco_7305: bitstring = fail-any in
                                                {9493}in(c, (=pkCli_7266,m1_7306: bitstring));
                                                {9494}let (SPc_7307: bitstring,PartC_7308: bitstring) = m1_7306 in
                                                {9495}event endSrv(Cli_5168,Sess_5170,PartC_7308);
                                                {9496}new Ns_7309: bitstring;
                                                {9497}let gNs_7310: bitstring = exp(g,Ns_7309) in
                                                {9498}let m2_7311: bitstring = gNs_7310 in
                                                {9499}event beginSrv(Sess_5170,Cli_5168,gNs_7310);
                                                {9500}out(c, m2_7311)
                                    )
                                    else
                                        {9501}let pkDisco_7312: bitstring = fail-any in
                                        {9502}in(c, (=pkCli_7266,m1_7313: bitstring));
                                        {9503}let (SPc_7314: bitstring,PartC_7315: bitstring) = m1_7313 in
                                        {9504}event endSrv(Cli_5168,Sess_5170,PartC_7315);
                                        {9505}new Ns_7316: bitstring;
                                        {9506}let gNs_7317: bitstring = exp(g,Ns_7316) in
                                        {9507}let m2_7318: bitstring = gNs_7317 in
                                        {9508}event beginSrv(Sess_5170,Cli_5168,gNs_7317);
                                        {9509}out(c, m2_7318)
                        )
                        else
                            {9510}let pkCli_7319: bitstring = fail-any in
                            {9511}let v_7320: bool = (Disco_5169 = A) in
                            (
                                {9512}if v_7320 then
                                (
                                    {9513}let pkDisco_7321: bitstring = pub(skA) in
                                    {9514}in(c, (=pkCli_7319,m1_7322: bitstring));
                                    {9515}let (SPc_7323: bitstring,PartC_7324: bitstring) = m1_7322 in
                                    {9516}event endSrv(Cli_5168,Sess_5170,PartC_7324);
                                    {9517}new Ns_7325: bitstring;
                                    {9518}let gNs_7326: bitstring = exp(g,Ns_7325) in
                                    {9519}let m2_7327: bitstring = gNs_7326 in
                                    {9520}event beginSrv(Sess_5170,Cli_5168,gNs_7326);
                                    {9521}out(c, m2_7327)
                                )
                                else
                                    {9522}let v_7328: bool = (Disco_5169 = B) in
                                    (
                                        {9523}if v_7328 then
                                        (
                                            {9524}let pkDisco_7329: bitstring = pub(skB) in
                                            {9525}in(c, (=pkCli_7319,m1_7330: bitstring));
                                            {9526}let (SPc_7331: bitstring,PartC_7332: bitstring) = m1_7330 in
                                            {9527}event endSrv(Cli_5168,Sess_5170,PartC_7332);
                                            {9528}new Ns_7333: bitstring;
                                            {9529}let gNs_7334: bitstring = exp(g,Ns_7333) in
                                            {9530}let m2_7335: bitstring = gNs_7334 in
                                            {9531}event beginSrv(Sess_5170,Cli_5168,gNs_7334);
                                            {9532}out(c, m2_7335)
                                        )
                                        else
                                            {9533}let v_7336: bool = (Disco_5169 = C) in
                                            (
                                                {9534}if v_7336 then
                                                (
                                                    {9535}let pkDisco_7337: bitstring = pub(skC) in
                                                    {9536}in(c, (=pkCli_7319,m1_7338: bitstring));
                                                    {9537}let (SPc_7339: bitstring,PartC_7340: bitstring) = m1_7338 in
                                                    {9538}event endSrv(Cli_5168,Sess_5170,PartC_7340);
                                                    {9539}new Ns_7341: bitstring;
                                                    {9540}let gNs_7342: bitstring = exp(g,Ns_7341) in
                                                    {9541}let m2_7343: bitstring = gNs_7342 in
                                                    {9542}event beginSrv(Sess_5170,Cli_5168,gNs_7342);
                                                    {9543}out(c, m2_7343)
                                                )
                                                else
                                                    {9544}let pkDisco_7344: bitstring = pub(skI) in
                                                    {9545}in(c, (=pkCli_7319,m1_7345: bitstring));
                                                    {9546}let (SPc_7346: bitstring,PartC_7347: bitstring) = m1_7345 in
                                                    {9547}event endSrv(Cli_5168,Sess_5170,PartC_7347);
                                                    {9548}new Ns_7348: bitstring;
                                                    {9549}let gNs_7349: bitstring = exp(g,Ns_7348) in
                                                    {9550}let m2_7350: bitstring = gNs_7349 in
                                                    {9551}event beginSrv(Sess_5170,Cli_5168,gNs_7349);
                                                    {9552}out(c, m2_7350)
                                            )
                                            else
                                                {9553}let pkDisco_7351: bitstring = fail-any in
                                                {9554}in(c, (=pkCli_7319,m1_7352: bitstring));
                                                {9555}let (SPc_7353: bitstring,PartC_7354: bitstring) = m1_7352 in
                                                {9556}event endSrv(Cli_5168,Sess_5170,PartC_7354);
                                                {9557}new Ns_7355: bitstring;
                                                {9558}let gNs_7356: bitstring = exp(g,Ns_7355) in
                                                {9559}let m2_7357: bitstring = gNs_7356 in
                                                {9560}event beginSrv(Sess_5170,Cli_5168,gNs_7356);
                                                {9561}out(c, m2_7357)
                                    )
                                    else
                                        {9562}let pkDisco_7358: bitstring = fail-any in
                                        {9563}in(c, (=pkCli_7319,m1_7359: bitstring));
                                        {9564}let (SPc_7360: bitstring,PartC_7361: bitstring) = m1_7359 in
                                        {9565}event endSrv(Cli_5168,Sess_5170,PartC_7361);
                                        {9566}new Ns_7362: bitstring;
                                        {9567}let gNs_7363: bitstring = exp(g,Ns_7362) in
                                        {9568}let m2_7364: bitstring = gNs_7363 in
                                        {9569}event beginSrv(Sess_5170,Cli_5168,gNs_7363);
                                        {9570}out(c, m2_7364)
                            )
                            else
                                {9571}let pkDisco_7365: bitstring = fail-any in
                                {9572}in(c, (=pkCli_7319,m1_7366: bitstring));
                                {9573}let (SPc_7367: bitstring,PartC_7368: bitstring) = m1_7366 in
                                {9574}event endSrv(Cli_5168,Sess_5170,PartC_7368);
                                {9575}new Ns_7369: bitstring;
                                {9576}let gNs_7370: bitstring = exp(g,Ns_7369) in
                                {9577}let m2_7371: bitstring = gNs_7370 in
                                {9578}event beginSrv(Sess_5170,Cli_5168,gNs_7370);
                                {9579}out(c, m2_7371)
                )
                else
                    {9580}let pkCli_7372: bitstring = fail-any in
                    {9581}let v_7373: bool = (Disco_5169 = A) in
                    (
                        {9582}if v_7373 then
                        (
                            {9583}let pkDisco_7374: bitstring = pub(skA) in
                            {9584}in(c, (=pkCli_7372,m1_7375: bitstring));
                            {9585}let (SPc_7376: bitstring,PartC_7377: bitstring) = m1_7375 in
                            {9586}event endSrv(Cli_5168,Sess_5170,PartC_7377);
                            {9587}new Ns_7378: bitstring;
                            {9588}let gNs_7379: bitstring = exp(g,Ns_7378) in
                            {9589}let m2_7380: bitstring = gNs_7379 in
                            {9590}event beginSrv(Sess_5170,Cli_5168,gNs_7379);
                            {9591}out(c, m2_7380)
                        )
                        else
                            {9592}let v_7381: bool = (Disco_5169 = B) in
                            (
                                {9593}if v_7381 then
                                (
                                    {9594}let pkDisco_7382: bitstring = pub(skB) in
                                    {9595}in(c, (=pkCli_7372,m1_7383: bitstring));
                                    {9596}let (SPc_7384: bitstring,PartC_7385: bitstring) = m1_7383 in
                                    {9597}event endSrv(Cli_5168,Sess_5170,PartC_7385);
                                    {9598}new Ns_7386: bitstring;
                                    {9599}let gNs_7387: bitstring = exp(g,Ns_7386) in
                                    {9600}let m2_7388: bitstring = gNs_7387 in
                                    {9601}event beginSrv(Sess_5170,Cli_5168,gNs_7387);
                                    {9602}out(c, m2_7388)
                                )
                                else
                                    {9603}let v_7389: bool = (Disco_5169 = C) in
                                    (
                                        {9604}if v_7389 then
                                        (
                                            {9605}let pkDisco_7390: bitstring = pub(skC) in
                                            {9606}in(c, (=pkCli_7372,m1_7391: bitstring));
                                            {9607}let (SPc_7392: bitstring,PartC_7393: bitstring) = m1_7391 in
                                            {9608}event endSrv(Cli_5168,Sess_5170,PartC_7393);
                                            {9609}new Ns_7394: bitstring;
                                            {9610}let gNs_7395: bitstring = exp(g,Ns_7394) in
                                            {9611}let m2_7396: bitstring = gNs_7395 in
                                            {9612}event beginSrv(Sess_5170,Cli_5168,gNs_7395);
                                            {9613}out(c, m2_7396)
                                        )
                                        else
                                            {9614}let pkDisco_7397: bitstring = pub(skI) in
                                            {9615}in(c, (=pkCli_7372,m1_7398: bitstring));
                                            {9616}let (SPc_7399: bitstring,PartC_7400: bitstring) = m1_7398 in
                                            {9617}event endSrv(Cli_5168,Sess_5170,PartC_7400);
                                            {9618}new Ns_7401: bitstring;
                                            {9619}let gNs_7402: bitstring = exp(g,Ns_7401) in
                                            {9620}let m2_7403: bitstring = gNs_7402 in
                                            {9621}event beginSrv(Sess_5170,Cli_5168,gNs_7402);
                                            {9622}out(c, m2_7403)
                                    )
                                    else
                                        {9623}let pkDisco_7404: bitstring = fail-any in
                                        {9624}in(c, (=pkCli_7372,m1_7405: bitstring));
                                        {9625}let (SPc_7406: bitstring,PartC_7407: bitstring) = m1_7405 in
                                        {9626}event endSrv(Cli_5168,Sess_5170,PartC_7407);
                                        {9627}new Ns_7408: bitstring;
                                        {9628}let gNs_7409: bitstring = exp(g,Ns_7408) in
                                        {9629}let m2_7410: bitstring = gNs_7409 in
                                        {9630}event beginSrv(Sess_5170,Cli_5168,gNs_7409);
                                        {9631}out(c, m2_7410)
                            )
                            else
                                {9632}let pkDisco_7411: bitstring = fail-any in
                                {9633}in(c, (=pkCli_7372,m1_7412: bitstring));
                                {9634}let (SPc_7413: bitstring,PartC_7414: bitstring) = m1_7412 in
                                {9635}event endSrv(Cli_5168,Sess_5170,PartC_7414);
                                {9636}new Ns_7415: bitstring;
                                {9637}let gNs_7416: bitstring = exp(g,Ns_7415) in
                                {9638}let m2_7417: bitstring = gNs_7416 in
                                {9639}event beginSrv(Sess_5170,Cli_5168,gNs_7416);
                                {9640}out(c, m2_7417)
                    )
                    else
                        {9641}let pkDisco_7418: bitstring = fail-any in
                        {9642}in(c, (=pkCli_7372,m1_7419: bitstring));
                        {9643}let (SPc_7420: bitstring,PartC_7421: bitstring) = m1_7419 in
                        {9644}event endSrv(Cli_5168,Sess_5170,PartC_7421);
                        {9645}new Ns_7422: bitstring;
                        {9646}let gNs_7423: bitstring = exp(g,Ns_7422) in
                        {9647}let m2_7424: bitstring = gNs_7423 in
                        {9648}event beginSrv(Sess_5170,Cli_5168,gNs_7423);
                        {9649}out(c, m2_7424)
    )
    else
        {9650}let skSess_7425: bitstring = fail-any in
        {9651}let pkSess_7426: bitstring = pub(skSess_7425) in
        {9652}let v_7427: bool = (Cli_5168 = A) in
        (
            {9653}if v_7427 then
            (
                {9654}let pkCli_7428: bitstring = pub(skA) in
                {9655}let v_7429: bool = (Disco_5169 = A) in
                (
                    {9656}if v_7429 then
                    (
                        {9657}let pkDisco_7430: bitstring = pub(skA) in
                        {9658}in(c, (=pkCli_7428,m1_7431: bitstring));
                        {9659}let (SPc_7432: bitstring,PartC_7433: bitstring) = m1_7431 in
                        {9660}event endSrv(Cli_5168,Sess_5170,PartC_7433);
                        {9661}new Ns_7434: bitstring;
                        {9662}let gNs_7435: bitstring = exp(g,Ns_7434) in
                        {9663}let m2_7436: bitstring = gNs_7435 in
                        {9664}event beginSrv(Sess_5170,Cli_5168,gNs_7435);
                        {9665}out(c, m2_7436)
                    )
                    else
                        {9666}let v_7437: bool = (Disco_5169 = B) in
                        (
                            {9667}if v_7437 then
                            (
                                {9668}let pkDisco_7438: bitstring = pub(skB) in
                                {9669}in(c, (=pkCli_7428,m1_7439: bitstring));
                                {9670}let (SPc_7440: bitstring,PartC_7441: bitstring) = m1_7439 in
                                {9671}event endSrv(Cli_5168,Sess_5170,PartC_7441);
                                {9672}new Ns_7442: bitstring;
                                {9673}let gNs_7443: bitstring = exp(g,Ns_7442) in
                                {9674}let m2_7444: bitstring = gNs_7443 in
                                {9675}event beginSrv(Sess_5170,Cli_5168,gNs_7443);
                                {9676}out(c, m2_7444)
                            )
                            else
                                {9677}let v_7445: bool = (Disco_5169 = C) in
                                (
                                    {9678}if v_7445 then
                                    (
                                        {9679}let pkDisco_7446: bitstring = pub(skC) in
                                        {9680}in(c, (=pkCli_7428,m1_7447: bitstring));
                                        {9681}let (SPc_7448: bitstring,PartC_7449: bitstring) = m1_7447 in
                                        {9682}event endSrv(Cli_5168,Sess_5170,PartC_7449);
                                        {9683}new Ns_7450: bitstring;
                                        {9684}let gNs_7451: bitstring = exp(g,Ns_7450) in
                                        {9685}let m2_7452: bitstring = gNs_7451 in
                                        {9686}event beginSrv(Sess_5170,Cli_5168,gNs_7451);
                                        {9687}out(c, m2_7452)
                                    )
                                    else
                                        {9688}let pkDisco_7453: bitstring = pub(skI) in
                                        {9689}in(c, (=pkCli_7428,m1_7454: bitstring));
                                        {9690}let (SPc_7455: bitstring,PartC_7456: bitstring) = m1_7454 in
                                        {9691}event endSrv(Cli_5168,Sess_5170,PartC_7456);
                                        {9692}new Ns_7457: bitstring;
                                        {9693}let gNs_7458: bitstring = exp(g,Ns_7457) in
                                        {9694}let m2_7459: bitstring = gNs_7458 in
                                        {9695}event beginSrv(Sess_5170,Cli_5168,gNs_7458);
                                        {9696}out(c, m2_7459)
                                )
                                else
                                    {9697}let pkDisco_7460: bitstring = fail-any in
                                    {9698}in(c, (=pkCli_7428,m1_7461: bitstring));
                                    {9699}let (SPc_7462: bitstring,PartC_7463: bitstring) = m1_7461 in
                                    {9700}event endSrv(Cli_5168,Sess_5170,PartC_7463);
                                    {9701}new Ns_7464: bitstring;
                                    {9702}let gNs_7465: bitstring = exp(g,Ns_7464) in
                                    {9703}let m2_7466: bitstring = gNs_7465 in
                                    {9704}event beginSrv(Sess_5170,Cli_5168,gNs_7465);
                                    {9705}out(c, m2_7466)
                        )
                        else
                            {9706}let pkDisco_7467: bitstring = fail-any in
                            {9707}in(c, (=pkCli_7428,m1_7468: bitstring));
                            {9708}let (SPc_7469: bitstring,PartC_7470: bitstring) = m1_7468 in
                            {9709}event endSrv(Cli_5168,Sess_5170,PartC_7470);
                            {9710}new Ns_7471: bitstring;
                            {9711}let gNs_7472: bitstring = exp(g,Ns_7471) in
                            {9712}let m2_7473: bitstring = gNs_7472 in
                            {9713}event beginSrv(Sess_5170,Cli_5168,gNs_7472);
                            {9714}out(c, m2_7473)
                )
                else
                    {9715}let pkDisco_7474: bitstring = fail-any in
                    {9716}in(c, (=pkCli_7428,m1_7475: bitstring));
                    {9717}let (SPc_7476: bitstring,PartC_7477: bitstring) = m1_7475 in
                    {9718}event endSrv(Cli_5168,Sess_5170,PartC_7477);
                    {9719}new Ns_7478: bitstring;
                    {9720}let gNs_7479: bitstring = exp(g,Ns_7478) in
                    {9721}let m2_7480: bitstring = gNs_7479 in
                    {9722}event beginSrv(Sess_5170,Cli_5168,gNs_7479);
                    {9723}out(c, m2_7480)
            )
            else
                {9724}let v_7481: bool = (Cli_5168 = B) in
                (
                    {9725}if v_7481 then
                    (
                        {9726}let pkCli_7482: bitstring = pub(skB) in
                        {9727}let v_7483: bool = (Disco_5169 = A) in
                        (
                            {9728}if v_7483 then
                            (
                                {9729}let pkDisco_7484: bitstring = pub(skA) in
                                {9730}in(c, (=pkCli_7482,m1_7485: bitstring));
                                {9731}let (SPc_7486: bitstring,PartC_7487: bitstring) = m1_7485 in
                                {9732}event endSrv(Cli_5168,Sess_5170,PartC_7487);
                                {9733}new Ns_7488: bitstring;
                                {9734}let gNs_7489: bitstring = exp(g,Ns_7488) in
                                {9735}let m2_7490: bitstring = gNs_7489 in
                                {9736}event beginSrv(Sess_5170,Cli_5168,gNs_7489);
                                {9737}out(c, m2_7490)
                            )
                            else
                                {9738}let v_7491: bool = (Disco_5169 = B) in
                                (
                                    {9739}if v_7491 then
                                    (
                                        {9740}let pkDisco_7492: bitstring = pub(skB) in
                                        {9741}in(c, (=pkCli_7482,m1_7493: bitstring));
                                        {9742}let (SPc_7494: bitstring,PartC_7495: bitstring) = m1_7493 in
                                        {9743}event endSrv(Cli_5168,Sess_5170,PartC_7495);
                                        {9744}new Ns_7496: bitstring;
                                        {9745}let gNs_7497: bitstring = exp(g,Ns_7496) in
                                        {9746}let m2_7498: bitstring = gNs_7497 in
                                        {9747}event beginSrv(Sess_5170,Cli_5168,gNs_7497);
                                        {9748}out(c, m2_7498)
                                    )
                                    else
                                        {9749}let v_7499: bool = (Disco_5169 = C) in
                                        (
                                            {9750}if v_7499 then
                                            (
                                                {9751}let pkDisco_7500: bitstring = pub(skC) in
                                                {9752}in(c, (=pkCli_7482,m1_7501: bitstring));
                                                {9753}let (SPc_7502: bitstring,PartC_7503: bitstring) = m1_7501 in
                                                {9754}event endSrv(Cli_5168,Sess_5170,PartC_7503);
                                                {9755}new Ns_7504: bitstring;
                                                {9756}let gNs_7505: bitstring = exp(g,Ns_7504) in
                                                {9757}let m2_7506: bitstring = gNs_7505 in
                                                {9758}event beginSrv(Sess_5170,Cli_5168,gNs_7505);
                                                {9759}out(c, m2_7506)
                                            )
                                            else
                                                {9760}let pkDisco_7507: bitstring = pub(skI) in
                                                {9761}in(c, (=pkCli_7482,m1_7508: bitstring));
                                                {9762}let (SPc_7509: bitstring,PartC_7510: bitstring) = m1_7508 in
                                                {9763}event endSrv(Cli_5168,Sess_5170,PartC_7510);
                                                {9764}new Ns_7511: bitstring;
                                                {9765}let gNs_7512: bitstring = exp(g,Ns_7511) in
                                                {9766}let m2_7513: bitstring = gNs_7512 in
                                                {9767}event beginSrv(Sess_5170,Cli_5168,gNs_7512);
                                                {9768}out(c, m2_7513)
                                        )
                                        else
                                            {9769}let pkDisco_7514: bitstring = fail-any in
                                            {9770}in(c, (=pkCli_7482,m1_7515: bitstring));
                                            {9771}let (SPc_7516: bitstring,PartC_7517: bitstring) = m1_7515 in
                                            {9772}event endSrv(Cli_5168,Sess_5170,PartC_7517);
                                            {9773}new Ns_7518: bitstring;
                                            {9774}let gNs_7519: bitstring = exp(g,Ns_7518) in
                                            {9775}let m2_7520: bitstring = gNs_7519 in
                                            {9776}event beginSrv(Sess_5170,Cli_5168,gNs_7519);
                                            {9777}out(c, m2_7520)
                                )
                                else
                                    {9778}let pkDisco_7521: bitstring = fail-any in
                                    {9779}in(c, (=pkCli_7482,m1_7522: bitstring));
                                    {9780}let (SPc_7523: bitstring,PartC_7524: bitstring) = m1_7522 in
                                    {9781}event endSrv(Cli_5168,Sess_5170,PartC_7524);
                                    {9782}new Ns_7525: bitstring;
                                    {9783}let gNs_7526: bitstring = exp(g,Ns_7525) in
                                    {9784}let m2_7527: bitstring = gNs_7526 in
                                    {9785}event beginSrv(Sess_5170,Cli_5168,gNs_7526);
                                    {9786}out(c, m2_7527)
                        )
                        else
                            {9787}let pkDisco_7528: bitstring = fail-any in
                            {9788}in(c, (=pkCli_7482,m1_7529: bitstring));
                            {9789}let (SPc_7530: bitstring,PartC_7531: bitstring) = m1_7529 in
                            {9790}event endSrv(Cli_5168,Sess_5170,PartC_7531);
                            {9791}new Ns_7532: bitstring;
                            {9792}let gNs_7533: bitstring = exp(g,Ns_7532) in
                            {9793}let m2_7534: bitstring = gNs_7533 in
                            {9794}event beginSrv(Sess_5170,Cli_5168,gNs_7533);
                            {9795}out(c, m2_7534)
                    )
                    else
                        {9796}let v_7535: bool = (Cli_5168 = C) in
                        (
                            {9797}if v_7535 then
                            (
                                {9798}let pkCli_7536: bitstring = pub(skC) in
                                {9799}let v_7537: bool = (Disco_5169 = A) in
                                (
                                    {9800}if v_7537 then
                                    (
                                        {9801}let pkDisco_7538: bitstring = pub(skA) in
                                        {9802}in(c, (=pkCli_7536,m1_7539: bitstring));
                                        {9803}let (SPc_7540: bitstring,PartC_7541: bitstring) = m1_7539 in
                                        {9804}event endSrv(Cli_5168,Sess_5170,PartC_7541);
                                        {9805}new Ns_7542: bitstring;
                                        {9806}let gNs_7543: bitstring = exp(g,Ns_7542) in
                                        {9807}let m2_7544: bitstring = gNs_7543 in
                                        {9808}event beginSrv(Sess_5170,Cli_5168,gNs_7543);
                                        {9809}out(c, m2_7544)
                                    )
                                    else
                                        {9810}let v_7545: bool = (Disco_5169 = B) in
                                        (
                                            {9811}if v_7545 then
                                            (
                                                {9812}let pkDisco_7546: bitstring = pub(skB) in
                                                {9813}in(c, (=pkCli_7536,m1_7547: bitstring));
                                                {9814}let (SPc_7548: bitstring,PartC_7549: bitstring) = m1_7547 in
                                                {9815}event endSrv(Cli_5168,Sess_5170,PartC_7549);
                                                {9816}new Ns_7550: bitstring;
                                                {9817}let gNs_7551: bitstring = exp(g,Ns_7550) in
                                                {9818}let m2_7552: bitstring = gNs_7551 in
                                                {9819}event beginSrv(Sess_5170,Cli_5168,gNs_7551);
                                                {9820}out(c, m2_7552)
                                            )
                                            else
                                                {9821}let v_7553: bool = (Disco_5169 = C) in
                                                (
                                                    {9822}if v_7553 then
                                                    (
                                                        {9823}let pkDisco_7554: bitstring = pub(skC) in
                                                        {9824}in(c, (=pkCli_7536,m1_7555: bitstring));
                                                        {9825}let (SPc_7556: bitstring,PartC_7557: bitstring) = m1_7555 in
                                                        {9826}event endSrv(Cli_5168,Sess_5170,PartC_7557);
                                                        {9827}new Ns_7558: bitstring;
                                                        {9828}let gNs_7559: bitstring = exp(g,Ns_7558) in
                                                        {9829}let m2_7560: bitstring = gNs_7559 in
                                                        {9830}event beginSrv(Sess_5170,Cli_5168,gNs_7559);
                                                        {9831}out(c, m2_7560)
                                                    )
                                                    else
                                                        {9832}let pkDisco_7561: bitstring = pub(skI) in
                                                        {9833}in(c, (=pkCli_7536,m1_7562: bitstring));
                                                        {9834}let (SPc_7563: bitstring,PartC_7564: bitstring) = m1_7562 in
                                                        {9835}event endSrv(Cli_5168,Sess_5170,PartC_7564);
                                                        {9836}new Ns_7565: bitstring;
                                                        {9837}let gNs_7566: bitstring = exp(g,Ns_7565) in
                                                        {9838}let m2_7567: bitstring = gNs_7566 in
                                                        {9839}event beginSrv(Sess_5170,Cli_5168,gNs_7566);
                                                        {9840}out(c, m2_7567)
                                                )
                                                else
                                                    {9841}let pkDisco_7568: bitstring = fail-any in
                                                    {9842}in(c, (=pkCli_7536,m1_7569: bitstring));
                                                    {9843}let (SPc_7570: bitstring,PartC_7571: bitstring) = m1_7569 in
                                                    {9844}event endSrv(Cli_5168,Sess_5170,PartC_7571);
                                                    {9845}new Ns_7572: bitstring;
                                                    {9846}let gNs_7573: bitstring = exp(g,Ns_7572) in
                                                    {9847}let m2_7574: bitstring = gNs_7573 in
                                                    {9848}event beginSrv(Sess_5170,Cli_5168,gNs_7573);
                                                    {9849}out(c, m2_7574)
                                        )
                                        else
                                            {9850}let pkDisco_7575: bitstring = fail-any in
                                            {9851}in(c, (=pkCli_7536,m1_7576: bitstring));
                                            {9852}let (SPc_7577: bitstring,PartC_7578: bitstring) = m1_7576 in
                                            {9853}event endSrv(Cli_5168,Sess_5170,PartC_7578);
                                            {9854}new Ns_7579: bitstring;
                                            {9855}let gNs_7580: bitstring = exp(g,Ns_7579) in
                                            {9856}let m2_7581: bitstring = gNs_7580 in
                                            {9857}event beginSrv(Sess_5170,Cli_5168,gNs_7580);
                                            {9858}out(c, m2_7581)
                                )
                                else
                                    {9859}let pkDisco_7582: bitstring = fail-any in
                                    {9860}in(c, (=pkCli_7536,m1_7583: bitstring));
                                    {9861}let (SPc_7584: bitstring,PartC_7585: bitstring) = m1_7583 in
                                    {9862}event endSrv(Cli_5168,Sess_5170,PartC_7585);
                                    {9863}new Ns_7586: bitstring;
                                    {9864}let gNs_7587: bitstring = exp(g,Ns_7586) in
                                    {9865}let m2_7588: bitstring = gNs_7587 in
                                    {9866}event beginSrv(Sess_5170,Cli_5168,gNs_7587);
                                    {9867}out(c, m2_7588)
                            )
                            else
                                {9868}let pkCli_7589: bitstring = pub(skI) in
                                {9869}let v_7590: bool = (Disco_5169 = A) in
                                (
                                    {9870}if v_7590 then
                                    (
                                        {9871}let pkDisco_7591: bitstring = pub(skA) in
                                        {9872}in(c, (=pkCli_7589,m1_7592: bitstring));
                                        {9873}let (SPc_7593: bitstring,PartC_7594: bitstring) = m1_7592 in
                                        {9874}event endSrv(Cli_5168,Sess_5170,PartC_7594);
                                        {9875}new Ns_7595: bitstring;
                                        {9876}let gNs_7596: bitstring = exp(g,Ns_7595) in
                                        {9877}let m2_7597: bitstring = gNs_7596 in
                                        {9878}event beginSrv(Sess_5170,Cli_5168,gNs_7596);
                                        {9879}out(c, m2_7597)
                                    )
                                    else
                                        {9880}let v_7598: bool = (Disco_5169 = B) in
                                        (
                                            {9881}if v_7598 then
                                            (
                                                {9882}let pkDisco_7599: bitstring = pub(skB) in
                                                {9883}in(c, (=pkCli_7589,m1_7600: bitstring));
                                                {9884}let (SPc_7601: bitstring,PartC_7602: bitstring) = m1_7600 in
                                                {9885}event endSrv(Cli_5168,Sess_5170,PartC_7602);
                                                {9886}new Ns_7603: bitstring;
                                                {9887}let gNs_7604: bitstring = exp(g,Ns_7603) in
                                                {9888}let m2_7605: bitstring = gNs_7604 in
                                                {9889}event beginSrv(Sess_5170,Cli_5168,gNs_7604);
                                                {9890}out(c, m2_7605)
                                            )
                                            else
                                                {9891}let v_7606: bool = (Disco_5169 = C) in
                                                (
                                                    {9892}if v_7606 then
                                                    (
                                                        {9893}let pkDisco_7607: bitstring = pub(skC) in
                                                        {9894}in(c, (=pkCli_7589,m1_7608: bitstring));
                                                        {9895}let (SPc_7609: bitstring,PartC_7610: bitstring) = m1_7608 in
                                                        {9896}event endSrv(Cli_5168,Sess_5170,PartC_7610);
                                                        {9897}new Ns_7611: bitstring;
                                                        {9898}let gNs_7612: bitstring = exp(g,Ns_7611) in
                                                        {9899}let m2_7613: bitstring = gNs_7612 in
                                                        {9900}event beginSrv(Sess_5170,Cli_5168,gNs_7612);
                                                        {9901}out(c, m2_7613)
                                                    )
                                                    else
                                                        {9902}let pkDisco_7614: bitstring = pub(skI) in
                                                        {9903}in(c, (=pkCli_7589,m1_7615: bitstring));
                                                        {9904}let (SPc_7616: bitstring,PartC_7617: bitstring) = m1_7615 in
                                                        {9905}event endSrv(Cli_5168,Sess_5170,PartC_7617);
                                                        {9906}new Ns_7618: bitstring;
                                                        {9907}let gNs_7619: bitstring = exp(g,Ns_7618) in
                                                        {9908}let m2_7620: bitstring = gNs_7619 in
                                                        {9909}event beginSrv(Sess_5170,Cli_5168,gNs_7619);
                                                        {9910}out(c, m2_7620)
                                                )
                                                else
                                                    {9911}let pkDisco_7621: bitstring = fail-any in
                                                    {9912}in(c, (=pkCli_7589,m1_7622: bitstring));
                                                    {9913}let (SPc_7623: bitstring,PartC_7624: bitstring) = m1_7622 in
                                                    {9914}event endSrv(Cli_5168,Sess_5170,PartC_7624);
                                                    {9915}new Ns_7625: bitstring;
                                                    {9916}let gNs_7626: bitstring = exp(g,Ns_7625) in
                                                    {9917}let m2_7627: bitstring = gNs_7626 in
                                                    {9918}event beginSrv(Sess_5170,Cli_5168,gNs_7626);
                                                    {9919}out(c, m2_7627)
                                        )
                                        else
                                            {9920}let pkDisco_7628: bitstring = fail-any in
                                            {9921}in(c, (=pkCli_7589,m1_7629: bitstring));
                                            {9922}let (SPc_7630: bitstring,PartC_7631: bitstring) = m1_7629 in
                                            {9923}event endSrv(Cli_5168,Sess_5170,PartC_7631);
                                            {9924}new Ns_7632: bitstring;
                                            {9925}let gNs_7633: bitstring = exp(g,Ns_7632) in
                                            {9926}let m2_7634: bitstring = gNs_7633 in
                                            {9927}event beginSrv(Sess_5170,Cli_5168,gNs_7633);
                                            {9928}out(c, m2_7634)
                                )
                                else
                                    {9929}let pkDisco_7635: bitstring = fail-any in
                                    {9930}in(c, (=pkCli_7589,m1_7636: bitstring));
                                    {9931}let (SPc_7637: bitstring,PartC_7638: bitstring) = m1_7636 in
                                    {9932}event endSrv(Cli_5168,Sess_5170,PartC_7638);
                                    {9933}new Ns_7639: bitstring;
                                    {9934}let gNs_7640: bitstring = exp(g,Ns_7639) in
                                    {9935}let m2_7641: bitstring = gNs_7640 in
                                    {9936}event beginSrv(Sess_5170,Cli_5168,gNs_7640);
                                    {9937}out(c, m2_7641)
                        )
                        else
                            {9938}let pkCli_7642: bitstring = fail-any in
                            {9939}let v_7643: bool = (Disco_5169 = A) in
                            (
                                {9940}if v_7643 then
                                (
                                    {9941}let pkDisco_7644: bitstring = pub(skA) in
                                    {9942}in(c, (=pkCli_7642,m1_7645: bitstring));
                                    {9943}let (SPc_7646: bitstring,PartC_7647: bitstring) = m1_7645 in
                                    {9944}event endSrv(Cli_5168,Sess_5170,PartC_7647);
                                    {9945}new Ns_7648: bitstring;
                                    {9946}let gNs_7649: bitstring = exp(g,Ns_7648) in
                                    {9947}let m2_7650: bitstring = gNs_7649 in
                                    {9948}event beginSrv(Sess_5170,Cli_5168,gNs_7649);
                                    {9949}out(c, m2_7650)
                                )
                                else
                                    {9950}let v_7651: bool = (Disco_5169 = B) in
                                    (
                                        {9951}if v_7651 then
                                        (
                                            {9952}let pkDisco_7652: bitstring = pub(skB) in
                                            {9953}in(c, (=pkCli_7642,m1_7653: bitstring));
                                            {9954}let (SPc_7654: bitstring,PartC_7655: bitstring) = m1_7653 in
                                            {9955}event endSrv(Cli_5168,Sess_5170,PartC_7655);
                                            {9956}new Ns_7656: bitstring;
                                            {9957}let gNs_7657: bitstring = exp(g,Ns_7656) in
                                            {9958}let m2_7658: bitstring = gNs_7657 in
                                            {9959}event beginSrv(Sess_5170,Cli_5168,gNs_7657);
                                            {9960}out(c, m2_7658)
                                        )
                                        else
                                            {9961}let v_7659: bool = (Disco_5169 = C) in
                                            (
                                                {9962}if v_7659 then
                                                (
                                                    {9963}let pkDisco_7660: bitstring = pub(skC) in
                                                    {9964}in(c, (=pkCli_7642,m1_7661: bitstring));
                                                    {9965}let (SPc_7662: bitstring,PartC_7663: bitstring) = m1_7661 in
                                                    {9966}event endSrv(Cli_5168,Sess_5170,PartC_7663);
                                                    {9967}new Ns_7664: bitstring;
                                                    {9968}let gNs_7665: bitstring = exp(g,Ns_7664) in
                                                    {9969}let m2_7666: bitstring = gNs_7665 in
                                                    {9970}event beginSrv(Sess_5170,Cli_5168,gNs_7665);
                                                    {9971}out(c, m2_7666)
                                                )
                                                else
                                                    {9972}let pkDisco_7667: bitstring = pub(skI) in
                                                    {9973}in(c, (=pkCli_7642,m1_7668: bitstring));
                                                    {9974}let (SPc_7669: bitstring,PartC_7670: bitstring) = m1_7668 in
                                                    {9975}event endSrv(Cli_5168,Sess_5170,PartC_7670);
                                                    {9976}new Ns_7671: bitstring;
                                                    {9977}let gNs_7672: bitstring = exp(g,Ns_7671) in
                                                    {9978}let m2_7673: bitstring = gNs_7672 in
                                                    {9979}event beginSrv(Sess_5170,Cli_5168,gNs_7672);
                                                    {9980}out(c, m2_7673)
                                            )
                                            else
                                                {9981}let pkDisco_7674: bitstring = fail-any in
                                                {9982}in(c, (=pkCli_7642,m1_7675: bitstring));
                                                {9983}let (SPc_7676: bitstring,PartC_7677: bitstring) = m1_7675 in
                                                {9984}event endSrv(Cli_5168,Sess_5170,PartC_7677);
                                                {9985}new Ns_7678: bitstring;
                                                {9986}let gNs_7679: bitstring = exp(g,Ns_7678) in
                                                {9987}let m2_7680: bitstring = gNs_7679 in
                                                {9988}event beginSrv(Sess_5170,Cli_5168,gNs_7679);
                                                {9989}out(c, m2_7680)
                                    )
                                    else
                                        {9990}let pkDisco_7681: bitstring = fail-any in
                                        {9991}in(c, (=pkCli_7642,m1_7682: bitstring));
                                        {9992}let (SPc_7683: bitstring,PartC_7684: bitstring) = m1_7682 in
                                        {9993}event endSrv(Cli_5168,Sess_5170,PartC_7684);
                                        {9994}new Ns_7685: bitstring;
                                        {9995}let gNs_7686: bitstring = exp(g,Ns_7685) in
                                        {9996}let m2_7687: bitstring = gNs_7686 in
                                        {9997}event beginSrv(Sess_5170,Cli_5168,gNs_7686);
                                        {9998}out(c, m2_7687)
                            )
                            else
                                {9999}let pkDisco_7688: bitstring = fail-any in
                                {10000}in(c, (=pkCli_7642,m1_7689: bitstring));
                                {10001}let (SPc_7690: bitstring,PartC_7691: bitstring) = m1_7689 in
                                {10002}event endSrv(Cli_5168,Sess_5170,PartC_7691);
                                {10003}new Ns_7692: bitstring;
                                {10004}let gNs_7693: bitstring = exp(g,Ns_7692) in
                                {10005}let m2_7694: bitstring = gNs_7693 in
                                {10006}event beginSrv(Sess_5170,Cli_5168,gNs_7693);
                                {10007}out(c, m2_7694)
                )
                else
                    {10008}let pkCli_7695: bitstring = fail-any in
                    {10009}let v_7696: bool = (Disco_5169 = A) in
                    (
                        {10010}if v_7696 then
                        (
                            {10011}let pkDisco_7697: bitstring = pub(skA) in
                            {10012}in(c, (=pkCli_7695,m1_7698: bitstring));
                            {10013}let (SPc_7699: bitstring,PartC_7700: bitstring) = m1_7698 in
                            {10014}event endSrv(Cli_5168,Sess_5170,PartC_7700);
                            {10015}new Ns_7701: bitstring;
                            {10016}let gNs_7702: bitstring = exp(g,Ns_7701) in
                            {10017}let m2_7703: bitstring = gNs_7702 in
                            {10018}event beginSrv(Sess_5170,Cli_5168,gNs_7702);
                            {10019}out(c, m2_7703)
                        )
                        else
                            {10020}let v_7704: bool = (Disco_5169 = B) in
                            (
                                {10021}if v_7704 then
                                (
                                    {10022}let pkDisco_7705: bitstring = pub(skB) in
                                    {10023}in(c, (=pkCli_7695,m1_7706: bitstring));
                                    {10024}let (SPc_7707: bitstring,PartC_7708: bitstring) = m1_7706 in
                                    {10025}event endSrv(Cli_5168,Sess_5170,PartC_7708);
                                    {10026}new Ns_7709: bitstring;
                                    {10027}let gNs_7710: bitstring = exp(g,Ns_7709) in
                                    {10028}let m2_7711: bitstring = gNs_7710 in
                                    {10029}event beginSrv(Sess_5170,Cli_5168,gNs_7710);
                                    {10030}out(c, m2_7711)
                                )
                                else
                                    {10031}let v_7712: bool = (Disco_5169 = C) in
                                    (
                                        {10032}if v_7712 then
                                        (
                                            {10033}let pkDisco_7713: bitstring = pub(skC) in
                                            {10034}in(c, (=pkCli_7695,m1_7714: bitstring));
                                            {10035}let (SPc_7715: bitstring,PartC_7716: bitstring) = m1_7714 in
                                            {10036}event endSrv(Cli_5168,Sess_5170,PartC_7716);
                                            {10037}new Ns_7717: bitstring;
                                            {10038}let gNs_7718: bitstring = exp(g,Ns_7717) in
                                            {10039}let m2_7719: bitstring = gNs_7718 in
                                            {10040}event beginSrv(Sess_5170,Cli_5168,gNs_7718);
                                            {10041}out(c, m2_7719)
                                        )
                                        else
                                            {10042}let pkDisco_7720: bitstring = pub(skI) in
                                            {10043}in(c, (=pkCli_7695,m1_7721: bitstring));
                                            {10044}let (SPc_7722: bitstring,PartC_7723: bitstring) = m1_7721 in
                                            {10045}event endSrv(Cli_5168,Sess_5170,PartC_7723);
                                            {10046}new Ns_7724: bitstring;
                                            {10047}let gNs_7725: bitstring = exp(g,Ns_7724) in
                                            {10048}let m2_7726: bitstring = gNs_7725 in
                                            {10049}event beginSrv(Sess_5170,Cli_5168,gNs_7725);
                                            {10050}out(c, m2_7726)
                                    )
                                    else
                                        {10051}let pkDisco_7727: bitstring = fail-any in
                                        {10052}in(c, (=pkCli_7695,m1_7728: bitstring));
                                        {10053}let (SPc_7729: bitstring,PartC_7730: bitstring) = m1_7728 in
                                        {10054}event endSrv(Cli_5168,Sess_5170,PartC_7730);
                                        {10055}new Ns_7731: bitstring;
                                        {10056}let gNs_7732: bitstring = exp(g,Ns_7731) in
                                        {10057}let m2_7733: bitstring = gNs_7732 in
                                        {10058}event beginSrv(Sess_5170,Cli_5168,gNs_7732);
                                        {10059}out(c, m2_7733)
                            )
                            else
                                {10060}let pkDisco_7734: bitstring = fail-any in
                                {10061}in(c, (=pkCli_7695,m1_7735: bitstring));
                                {10062}let (SPc_7736: bitstring,PartC_7737: bitstring) = m1_7735 in
                                {10063}event endSrv(Cli_5168,Sess_5170,PartC_7737);
                                {10064}new Ns_7738: bitstring;
                                {10065}let gNs_7739: bitstring = exp(g,Ns_7738) in
                                {10066}let m2_7740: bitstring = gNs_7739 in
                                {10067}event beginSrv(Sess_5170,Cli_5168,gNs_7739);
                                {10068}out(c, m2_7740)
                    )
                    else
                        {10069}let pkDisco_7741: bitstring = fail-any in
                        {10070}in(c, (=pkCli_7695,m1_7742: bitstring));
                        {10071}let (SPc_7743: bitstring,PartC_7744: bitstring) = m1_7742 in
                        {10072}event endSrv(Cli_5168,Sess_5170,PartC_7744);
                        {10073}new Ns_7745: bitstring;
                        {10074}let gNs_7746: bitstring = exp(g,Ns_7745) in
                        {10075}let m2_7747: bitstring = gNs_7746 in
                        {10076}event beginSrv(Sess_5170,Cli_5168,gNs_7746);
                        {10077}out(c, m2_7747)
        )
        else
            {10078}let pkCli_7748: bitstring = fail-any in
            {10079}let v_7749: bool = (Disco_5169 = A) in
            (
                {10080}if v_7749 then
                (
                    {10081}let pkDisco_7750: bitstring = pub(skA) in
                    {10082}in(c, (=pkCli_7748,m1_7751: bitstring));
                    {10083}let (SPc_7752: bitstring,PartC_7753: bitstring) = m1_7751 in
                    {10084}event endSrv(Cli_5168,Sess_5170,PartC_7753);
                    {10085}new Ns_7754: bitstring;
                    {10086}let gNs_7755: bitstring = exp(g,Ns_7754) in
                    {10087}let m2_7756: bitstring = gNs_7755 in
                    {10088}event beginSrv(Sess_5170,Cli_5168,gNs_7755);
                    {10089}out(c, m2_7756)
                )
                else
                    {10090}let v_7757: bool = (Disco_5169 = B) in
                    (
                        {10091}if v_7757 then
                        (
                            {10092}let pkDisco_7758: bitstring = pub(skB) in
                            {10093}in(c, (=pkCli_7748,m1_7759: bitstring));
                            {10094}let (SPc_7760: bitstring,PartC_7761: bitstring) = m1_7759 in
                            {10095}event endSrv(Cli_5168,Sess_5170,PartC_7761);
                            {10096}new Ns_7762: bitstring;
                            {10097}let gNs_7763: bitstring = exp(g,Ns_7762) in
                            {10098}let m2_7764: bitstring = gNs_7763 in
                            {10099}event beginSrv(Sess_5170,Cli_5168,gNs_7763);
                            {10100}out(c, m2_7764)
                        )
                        else
                            {10101}let v_7765: bool = (Disco_5169 = C) in
                            (
                                {10102}if v_7765 then
                                (
                                    {10103}let pkDisco_7766: bitstring = pub(skC) in
                                    {10104}in(c, (=pkCli_7748,m1_7767: bitstring));
                                    {10105}let (SPc_7768: bitstring,PartC_7769: bitstring) = m1_7767 in
                                    {10106}event endSrv(Cli_5168,Sess_5170,PartC_7769);
                                    {10107}new Ns_7770: bitstring;
                                    {10108}let gNs_7771: bitstring = exp(g,Ns_7770) in
                                    {10109}let m2_7772: bitstring = gNs_7771 in
                                    {10110}event beginSrv(Sess_5170,Cli_5168,gNs_7771);
                                    {10111}out(c, m2_7772)
                                )
                                else
                                    {10112}let pkDisco_7773: bitstring = pub(skI) in
                                    {10113}in(c, (=pkCli_7748,m1_7774: bitstring));
                                    {10114}let (SPc_7775: bitstring,PartC_7776: bitstring) = m1_7774 in
                                    {10115}event endSrv(Cli_5168,Sess_5170,PartC_7776);
                                    {10116}new Ns_7777: bitstring;
                                    {10117}let gNs_7778: bitstring = exp(g,Ns_7777) in
                                    {10118}let m2_7779: bitstring = gNs_7778 in
                                    {10119}event beginSrv(Sess_5170,Cli_5168,gNs_7778);
                                    {10120}out(c, m2_7779)
                            )
                            else
                                {10121}let pkDisco_7780: bitstring = fail-any in
                                {10122}in(c, (=pkCli_7748,m1_7781: bitstring));
                                {10123}let (SPc_7782: bitstring,PartC_7783: bitstring) = m1_7781 in
                                {10124}event endSrv(Cli_5168,Sess_5170,PartC_7783);
                                {10125}new Ns_7784: bitstring;
                                {10126}let gNs_7785: bitstring = exp(g,Ns_7784) in
                                {10127}let m2_7786: bitstring = gNs_7785 in
                                {10128}event beginSrv(Sess_5170,Cli_5168,gNs_7785);
                                {10129}out(c, m2_7786)
                    )
                    else
                        {10130}let pkDisco_7787: bitstring = fail-any in
                        {10131}in(c, (=pkCli_7748,m1_7788: bitstring));
                        {10132}let (SPc_7789: bitstring,PartC_7790: bitstring) = m1_7788 in
                        {10133}event endSrv(Cli_5168,Sess_5170,PartC_7790);
                        {10134}new Ns_7791: bitstring;
                        {10135}let gNs_7792: bitstring = exp(g,Ns_7791) in
                        {10136}let m2_7793: bitstring = gNs_7792 in
                        {10137}event beginSrv(Sess_5170,Cli_5168,gNs_7792);
                        {10138}out(c, m2_7793)
            )
            else
                {10139}let pkDisco_7794: bitstring = fail-any in
                {10140}in(c, (=pkCli_7748,m1_7795: bitstring));
                {10141}let (SPc_7796: bitstring,PartC_7797: bitstring) = m1_7795 in
                {10142}event endSrv(Cli_5168,Sess_5170,PartC_7797);
                {10143}new Ns_7798: bitstring;
                {10144}let gNs_7799: bitstring = exp(g,Ns_7798) in
                {10145}let m2_7800: bitstring = gNs_7799 in
                {10146}event beginSrv(Sess_5170,Cli_5168,gNs_7799);
                {10147}out(c, m2_7800)
)

-- Query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
Completing...
200 rules inserted. The rule base contains 89 rules. 405 rules in the queue.
400 rules inserted. The rule base contains 109 rules. 402 rules in the queue.
600 rules inserted. The rule base contains 121 rules. 402 rules in the queue.
800 rules inserted. The rule base contains 119 rules. 399 rules in the queue.
1000 rules inserted. The rule base contains 83 rules. 389 rules in the queue.
1200 rules inserted. The rule base contains 115 rules. 344 rules in the queue.
1400 rules inserted. The rule base contains 144 rules. 355 rules in the queue.
1600 rules inserted. The rule base contains 291 rules. 268 rules in the queue.
1800 rules inserted. The rule base contains 425 rules. 283 rules in the queue.
2000 rules inserted. The rule base contains 525 rules. 235 rules in the queue.
2200 rules inserted. The rule base contains 576 rules. 205 rules in the queue.
2400 rules inserted. The rule base contains 588 rules. 199 rules in the queue.
2600 rules inserted. The rule base contains 588 rules. 199 rules in the queue.
2800 rules inserted. The rule base contains 587 rules. 193 rules in the queue.
3000 rules inserted. The rule base contains 631 rules. 142 rules in the queue.
3200 rules inserted. The rule base contains 758 rules. 15 rules in the queue.
Starting query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
goal reachable: Sess_64759 <> C[] && Sess_64759 <> B[] && Sess_64759 <> A[] && attacker(SPs_64757) && attacker(UP_64758) && attacker(Sess_64759) -> end(endCli(C[],A[],(SPc_1638[UP_1637 = UP_64758,SPs_1636 = SPs_64757,Sess = Sess_64759,Disco = B[],Cli = C[],!1 = @sid_64760],exp(g,Nc_1639[UP_1637 = UP_64758,SPs_1636 = SPs_64757,Sess = Sess_64759,Disco = B[],Cli = C[],!1 = @sid_64760]))))
Abbreviations:
SPc_65406 = SPc_1638[UP_1637 = UP_65385,SPs_1636 = SPs_65384,Sess = Sess_65386,Disco = B[],Cli = C[],!1 = @sid_65387]
Nc_65407 = Nc_1639[UP_1637 = UP_65385,SPs_1636 = SPs_65384,Sess = Sess_65386,Disco = B[],Cli = C[],!1 = @sid_65387]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

5. The attacker has some term UP_65402.
attacker(UP_65402).

6. Using the function Sign the attacker may obtain Sign.
attacker(Sign).

7. The attacker has some term SPs_65401.
attacker(SPs_65401).

8. By 7, the attacker may know SPs_65401.
By 6, the attacker may know Sign.
By 5, the attacker may know UP_65402.
By 4, the attacker may know pub(skC[]).
Using the function 4-tuple the attacker may obtain (SPs_65401,Sign,UP_65402,pub(skC[])).
attacker((SPs_65401,Sign,UP_65402,pub(skC[]))).

9. We assume as hypothesis that
attacker(Sess_65386).

10. The attacker initially knows B[].
attacker(B[]).

11. By 1, the attacker may know C[].
By 10, the attacker may know B[].
By 9, the attacker may know Sess_65386.
Using the function 3-tuple the attacker may obtain (C[],B[],Sess_65386).
attacker((C[],B[],Sess_65386)).

12. The message skI[] may be sent to the attacker at output {8}.
attacker(skI[]).

13. By 12, the attacker may know skI[].
Using the function pub the attacker may obtain pub(skI[]).
attacker(pub(skI[])).

14. We assume as hypothesis that
attacker(UP_65385).

15. We assume as hypothesis that
attacker(SPs_65384).

16. By 15, the attacker may know SPs_65384.
By 6, the attacker may know Sign.
By 14, the attacker may know UP_65385.
By 13, the attacker may know pub(skI[]).
Using the function 4-tuple the attacker may obtain (SPs_65384,Sign,UP_65385,pub(skI[])).
attacker((SPs_65384,Sign,UP_65385,pub(skI[]))).

17. The message (C[],B[],Sess_65386) that the attacker may have by 11 may be received at input {10}.
The message (SPs_65384,Sign,UP_65385,pub(skI[])) that the attacker may have by 16 may be received at input {1449}.
We have Sess_65386 <> C[] & Sess_65386 <> B[] & Sess_65386 <> A[].
So the message (pub(skC[]),(SPc_65406,exp(g,Nc_65407)),sign((SPc_65406,exp(g,Nc_65407)),skC[])) may be sent to the attacker at output {1455}.
attacker((pub(skC[]),(SPc_65406,exp(g,Nc_65407)),sign((SPc_65406,exp(g,Nc_65407)),skC[]))).

18. By 17, the attacker may know (pub(skC[]),(SPc_65406,exp(g,Nc_65407)),sign((SPc_65406,exp(g,Nc_65407)),skC[])).
Using the function 3-proj-3-tuple the attacker may obtain sign((SPc_65406,exp(g,Nc_65407)),skC[]).
attacker(sign((SPc_65406,exp(g,Nc_65407)),skC[])).

19. By 17, the attacker may know (pub(skC[]),(SPc_65406,exp(g,Nc_65407)),sign((SPc_65406,exp(g,Nc_65407)),skC[])).
Using the function 2-proj-3-tuple the attacker may obtain (SPc_65406,exp(g,Nc_65407)).
attacker((SPc_65406,exp(g,Nc_65407))).

20. By 19, the attacker may know (SPc_65406,exp(g,Nc_65407)).
Using the function 2-proj-2-tuple the attacker may obtain exp(g,Nc_65407).
attacker(exp(g,Nc_65407)).

21. By 19, the attacker may know (SPc_65406,exp(g,Nc_65407)).
Using the function 1-proj-2-tuple the attacker may obtain SPc_65406.
attacker(SPc_65406).

22. By 21, the attacker may know SPc_65406.
By 20, the attacker may know exp(g,Nc_65407).
Using the function 2-tuple the attacker may obtain (SPc_65406,exp(g,Nc_65407)).
attacker((SPc_65406,exp(g,Nc_65407))).

23. By 22, the attacker may know (SPc_65406,exp(g,Nc_65407)).
By 18, the attacker may know sign((SPc_65406,exp(g,Nc_65407)),skC[]).
Using the function 2-tuple the attacker may obtain ((SPc_65406,exp(g,Nc_65407)),sign((SPc_65406,exp(g,Nc_65407)),skC[])).
attacker(((SPc_65406,exp(g,Nc_65407)),sign((SPc_65406,exp(g,Nc_65407)),skC[]))).

24. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {10}.
The message (SPs_65401,Sign,UP_65402,pub(skC[])) that the attacker may have by 8 may be received at input {50}.
The message ((SPc_65406,exp(g,Nc_65407)),sign((SPc_65406,exp(g,Nc_65407)),skC[])) that the attacker may have by 23 may be received at input {57}.
So event endCli(C[],A[],(SPc_65406,exp(g,Nc_65407))) may be executed at {59}.
end(endCli(C[],A[],(SPc_65406,exp(g,Nc_65407)))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

new skI creating skI_65416 at {7}

out(c, skI_65416) at {8}

in(c, (C,B,a_65409)) at {10} in copy a_65410

out(c, GetEndpointRequest) at {1448} in copy a_65410

in(c, (a_65408,Sign,a,pub(skI_65416))) at {1449} in copy a_65410

new SPc_1638 creating SPc_65414 at {1450} in copy a_65410

new Nc_1639 creating Nc_65415 at {1451} in copy a_65410

event(beginCli(C,a_65409,exp(g,Nc_65415))) at {1454} in copy a_65410

out(c, (pub(skC),(SPc_65414,exp(g,Nc_65415)),sign((SPc_65414,exp(g,Nc_65415)),skC))) at {1455} in copy a_65410

in(c, (A,A,C)) at {10} in copy a_65413

out(c, GetEndpointRequest) at {49} in copy a_65413

in(c, (a_65411,Sign,a_65412,pub(skC))) at {50} in copy a_65413

new SPc_611 creating SPc_101982 at {51} in copy a_65413

new Nc_612 creating Nc_101983 at {52} in copy a_65413

event(beginCli(A,C,exp(g,Nc_101983))) at {55} in copy a_65413

out(c, (pub(skA),(SPc_101982,exp(g,Nc_101983)),sign((SPc_101982,exp(g,Nc_101983)),skA))) at {56} in copy a_65413

in(c, ((SPc_65414,exp(g,Nc_65415)),sign((SPc_65414,exp(g,Nc_65415)),skC))) at {57} in copy a_65413

event(endCli(C,A,(SPc_65414,exp(g,Nc_65415)))) at {59} in copy a_65413

The event endCli(C,A,(SPc_65414,exp(g,Nc_65415))) is executed.
A trace has been found.
RESULT event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N)) is false.
-- Query event(endSrv(A[],X_101995,N_101996)) ==> event(beginCli(A[],X_101995,N_101996))
Completing...
200 rules inserted. The rule base contains 80 rules. 414 rules in the queue.
400 rules inserted. The rule base contains 94 rules. 402 rules in the queue.
600 rules inserted. The rule base contains 109 rules. 402 rules in the queue.
800 rules inserted. The rule base contains 106 rules. 399 rules in the queue.
1000 rules inserted. The rule base contains 56 rules. 398 rules in the queue.
1200 rules inserted. The rule base contains 88 rules. 355 rules in the queue.
1400 rules inserted. The rule base contains 124 rules. 336 rules in the queue.
1600 rules inserted. The rule base contains 273 rules. 230 rules in the queue.
1800 rules inserted. The rule base contains 437 rules. 113 rules in the queue.
Starting query event(endSrv(A[],X_101995,N_101996)) ==> event(beginCli(A[],X_101995,N_101996))
goal reachable: attacker(N_153327) -> end(endSrv(A[],C[],N_153327))

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. We assume as hypothesis that
attacker(N_153355).

5. The attacker has some term SPc_153351.
attacker(SPc_153351).

6. By 5, the attacker may know SPc_153351.
By 4, the attacker may know N_153355.
Using the function 2-tuple the attacker may obtain (SPc_153351,N_153355).
attacker((SPc_153351,N_153355)).

7. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

8. By 7, the attacker may know pub(skA[]).
By 6, the attacker may know (SPc_153351,N_153355).
Using the function 2-tuple the attacker may obtain (pub(skA[]),(SPc_153351,N_153355)).
attacker((pub(skA[]),(SPc_153351,N_153355))).

9. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {6655}.
The message (pub(skA[]),(SPc_153351,N_153355)) that the attacker may have by 8 may be received at input {7666}.
So event endSrv(A[],C[],N_153355) may be executed at {7668}.
end(endSrv(A[],C[],N_153355)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

new skI creating skI_169901 at {7}

out(c, skI_169901) at {8}

in(c, (A,A,C)) at {6655} in copy a_153358

in(c, (pub(skA),(a_153357,a_153356))) at {7666} in copy a_153358

event(endSrv(A,C,a_153356)) at {7668} in copy a_153358

The event endSrv(A,C,a_153356) is executed.
A trace has been found.
RESULT event(endSrv(A[],X_101995,N_101996)) ==> event(beginCli(A[],X_101995,N_101996)) is false.
